!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t=n();for(var r in t)("object"==typeof exports?exports:e)[r]=t[r]}}(this,(()=>(()=>{var __webpack_modules__={3061:function(module,__unused_webpack_exports,__webpack_require__){
/*!
 * OSGJS
 * Cedric Pinson <trigrou@trigrou.com> (http://cedricpinson.com)
 */
var factory;"undefined"!=typeof self&&self,factory=function(__WEBPACK_EXTERNAL_MODULE_11__,__WEBPACK_EXTERNAL_MODULE_132__,__WEBPACK_EXTERNAL_MODULE_137__,__WEBPACK_EXTERNAL_MODULE_235__){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=173)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Timer__ = __webpack_require__(22);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n\n\n\n\nvar utils = {};\n\nutils.extend = function() {\n    // Save a reference to some core methods\n    var toString = window.Object.prototype.toString;\n    var hasOwnPropertyFunc = window.Object.prototype.hasOwnProperty;\n\n    var isFunction = function(obj) {\n        return toString.call(obj) === \'[object Function]\';\n    };\n    var isArray = utils.isArray;\n    var isPlainObject = function(obj) {\n        // Must be an Object.\n        // Because of IE, we also have to check the presence of the constructor property.\n        // Make sure that DOM nodes and window objects don\'t pass through, as well\n        if (!obj || toString.call(obj) !== \'[object Object]\' || obj.nodeType || obj.setInterval) {\n            return false;\n        }\n\n        // Not own constructor property must be Object\n        if (\n            obj.constructor &&\n            !hasOwnPropertyFunc.call(obj, \'constructor\') &&\n            !hasOwnPropertyFunc.call(obj.constructor.prototype, \'isPrototypeOf\')\n        ) {\n            return false;\n        }\n\n        // Own properties are enumerated firstly, so to speed up,\n        // if last one is own, then all properties are own.\n\n        var key;\n        for (key in obj) {\n        }\n\n        return key === undefined || hasOwnPropertyFunc.call(obj, key);\n    };\n\n    // copy reference to target object\n    var target = arguments[0] || {},\n        i = 1,\n        length = arguments.length,\n        deep = false,\n        options,\n        name,\n        src,\n        copy;\n\n    // Handle a deep copy situation\n    if (typeof target === \'boolean\') {\n        deep = target;\n        target = arguments[1] || {};\n        // skip the boolean and the target\n        i = 2;\n    }\n\n    // Handle case when target is a string or something (possible in deep copy)\n    if (typeof target !== \'object\' && !isFunction(target)) {\n        target = {};\n    }\n\n    // extend jQuery itself if only one argument is passed\n    if (length === i) {\n        target = this;\n        --i;\n    }\n\n    for (; i < length; i++) {\n        // Only deal with non-null/undefined values\n        if ((options = arguments[i]) !== null) {\n            // Extend the base object\n            for (name in options) {\n                src = target[name];\n                copy = options[name];\n\n                // Prevent never-ending loop\n                if (target === copy) {\n                    continue;\n                }\n\n                // Recurse if we\'re merging object literal values or arrays\n                if (deep && copy && (isPlainObject(copy) || isArray(copy))) {\n                    var clone =\n                        src && (isPlainObject(src) || isArray(src)) ? src : isArray(copy) ? [] : {};\n\n                    // Never move original objects, clone them\n                    target[name] = utils.extend(deep, clone, copy);\n\n                    // Don\'t bring in undefined values\n                } else if (copy !== undefined) {\n                    target[name] = copy;\n                }\n            }\n        }\n    }\n\n    // Return the modified object\n    return target;\n};\n\nutils.objectInherit = function(base /*, extras*/) {\n    function F() {}\n    F.prototype = base;\n    var obj = new F();\n\n    // let augment object with multiple arguement\n    for (var i = 1; i < arguments.length; i++) {\n        utils.objectMix(obj, arguments[i], false);\n    }\n    return obj;\n};\n\nutils.objectMix = function(obj, properties, test) {\n    for (var key in properties) {\n        if (!(test && obj[key])) {\n            obj[key] = properties[key];\n        }\n    }\n    return obj;\n};\n\nutils.objectType = {};\nutils.objectType.type = 0;\n\nutils.arrayDense = function(index, array, createDefaultType) {\n    var length = array.length;\n    if (index >= length) {\n        for (var i = length; i <= index; i++) {\n            array.push(createDefaultType ? createDefaultType() : null);\n        }\n    }\n};\n\nutils.objectLibraryClass = function(object, libName, className) {\n    object.className = function() {\n        return className;\n    };\n    object.libraryName = function() {\n        return libName;\n    };\n    var libraryClassName = libName + \'::\' + className;\n    object.libraryClassName = function() {\n        return libraryClassName;\n    };\n\n    return object;\n};\n\nutils.setTypeID = function(classObject) {\n    var className = classObject.prototype.libraryClassName();\n    var typeID = utils.generateId(utils.objectType, className);\n    var getTypeID = function() {\n        return typeID;\n    };\n    classObject.typeID = classObject.prototype.typeID = typeID;\n    classObject.getTypeID = classObject.prototype.getTypeID = getTypeID;\n};\n\nutils.createPrototypeObject = function(Constructor, prototype, libraryName, className) {\n    // we need to create an instance of {} if prototype is already used in an object\n    // else we will override typeID ClassName...\n    if (prototype.hasOwnProperty(\'getTypeID\')) {\n        prototype = utils.objectInherit(prototype, {});\n    }\n\n    Constructor.prototype = prototype;\n    prototype.constructor = Constructor;\n\n    // if the user dont provide library name or class name this class will not have typeID\n    // and will inherit the typeID from it\'s parent class if it has one\n    // so all call to getTypeID will be affected, it\'s mostly not a probablem for internal class\n    // but for Node and StateAttribute you have to be aware\n    if (!libraryName || !className) return;\n\n    utils.objectLibraryClass(prototype, libraryName, className);\n    utils.setTypeID(Constructor);\n};\n\n// ============== Node ID =================================\nutils.generateId = function(typeMap, className) {\n    if (typeMap[className] !== undefined) {\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].error(className + \' is already defined, change class name or library name\');\n        return -1;\n    }\n\n    var index = typeMap.type;\n    typeMap[index] = className;\n    typeMap[className] = index;\n    typeMap.type += 1;\n    return index;\n};\n\nutils.objectNodeType = {};\nutils.objectNodeType.type = 0;\n\nutils.setNodeTypeID = function(classObject) {\n    var className = classObject.prototype.libraryClassName();\n    var typeID = utils.generateId(utils.objectNodeType, className);\n    var getTypeID = function() {\n        return typeID;\n    };\n    classObject.nodeTypeID = classObject.prototype.nodeTypeID = typeID;\n    classObject.getNodeTypeID = classObject.prototype.getNodeTypeID = getTypeID;\n};\n\nutils.createPrototypeNode = function(Constructor, prototype, libraryName, className) {\n    var cullVisitorHelper = __webpack_require__(103).default;\n    var parentNodeTypeID = prototype.nodeTypeID;\n    utils.createPrototypeObject(Constructor, prototype, libraryName, className);\n\n    // check the comment in function in utils.createPrototypeObject\n    if (!libraryName || !className) return;\n\n    utils.setNodeTypeID(Constructor);\n    var nodeTypeId = Constructor.nodeTypeID;\n    utils.arrayDense(nodeTypeId, cullVisitorHelper.applyFunctionArray);\n    cullVisitorHelper.registerApplyFunction(\n        nodeTypeId,\n        cullVisitorHelper.getApplyFunction(parentNodeTypeID)\n    );\n};\n\n// ===============================================\n\nvar typeMemberIndex = 0;\nvar textureTypeMemberIndex = 0;\nvar stateAttributeTypeMember = {};\nvar textureStateAttributeTypeMember = {};\nvar attributeTypeIndex = 0;\nvar stateAttributeType = {};\n\nutils.getStateAttributeTypeNameToTypeId = function() {\n    return stateAttributeType;\n};\n\nutils.createPrototypeStateAttribute = function(Constructor, prototype, libraryName, className) {\n    utils.createPrototypeObject(Constructor, prototype, libraryName, className);\n    var attributeId = utils.getOrCreateStateAttributeTypeId(Constructor);\n    Constructor.prototype.attributeTypeId = attributeId;\n};\n\nutils.getMaxStateAttributeTypeID = function() {\n    return attributeTypeIndex;\n};\n\nutils.getOrCreateStateAttributeTypeId = function(Constructor) {\n    var attributeTypeName = Constructor.prototype.getType();\n\n    if (stateAttributeType[attributeTypeName]) return stateAttributeType[attributeTypeName];\n\n    var typeId = attributeTypeIndex++;\n    stateAttributeType[attributeTypeName] = typeId;\n    return typeId;\n};\n\nutils.getOrCreateStateAttributeTypeMemberIndex = function(attribute) {\n    if (attribute._attributeTypeIndex !== undefined) return attribute._attributeTypeIndex;\n    var typeMember = attribute.getTypeMember();\n    attribute._attributeTypeIndex = utils.getOrCreateStateAttributeTypeMemberIndexFromName(\n        typeMember\n    );\n    return attribute._attributeTypeIndex;\n};\n\nutils.getOrCreateStateAttributeTypeMemberIndexFromName = function(typeMemberName) {\n    var type = stateAttributeTypeMember[typeMemberName];\n    if (type !== undefined) return type;\n\n    type = typeMemberIndex++;\n    stateAttributeTypeMember[typeMemberName] = type;\n    return type;\n};\n\nutils.getOrCreateTextureStateAttributeTypeMemberIndex = function(attribute) {\n    if (attribute._attributeTypeIndex !== undefined) return attribute._attributeTypeIndex;\n    var typeMember = attribute.getTypeMember();\n    attribute._attributeTypeIndex = utils.getOrCreateTextureStateAttributeTypeMemberIndexFromName(\n        typeMember\n    );\n    return attribute._attributeTypeIndex;\n};\n\nutils.getOrCreateTextureStateAttributeTypeMemberIndexFromName = function(typeMemberName) {\n    var type = textureStateAttributeTypeMember[typeMemberName];\n    if (type !== undefined) return type;\n\n    type = textureTypeMemberIndex++;\n    textureStateAttributeTypeMember[typeMemberName] = type;\n    return type;\n};\n\nutils.getIdFromTypeMember = function(typeMember) {\n    return stateAttributeTypeMember[typeMember];\n};\n\nutils.getTextureIdFromTypeMember = function(typeMember) {\n    return textureStateAttributeTypeMember[typeMember];\n};\n\nutils.Int8Array = window.Int8Array;\nutils.Uint8Array = window.Uint8Array;\nutils.Uint8ClampedArray = window.Uint8ClampedArray;\nutils.Int16Array = window.Int16Array;\nutils.Uint16Array = window.Uint16Array;\nutils.Int32Array = window.Int32Array;\nutils.Uint32Array = window.Uint32Array;\nutils.Float32Array = window.Float32Array;\nutils.Float64Array = window.Float64Array;\n\nvar times = {};\nvar registeredTimers = {};\n// we bind the function to notify.console once and for all to avoid costly apply function\n\nutils.logTime = (__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console.time ||\n    function(name) {\n        times[name] = __WEBPACK_IMPORTED_MODULE_1_osg_Timer__["a" /* default */].instance().tick();\n    }\n).bind(__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console);\n\nutils.logTimeEnd = (__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console.timeEnd ||\n    function(name) {\n        if (times[name] === undefined) return;\n\n        var duration = __WEBPACK_IMPORTED_MODULE_1_osg_Timer__["a" /* default */].instance().deltaM(times[name], __WEBPACK_IMPORTED_MODULE_1_osg_Timer__["a" /* default */].instance().tick());\n\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].log(name + \': \' + duration + \'ms\');\n        times[name] = undefined;\n    }\n).bind(__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console);\n\nutils.time = function(name, logLevel) {\n    var level = logLevel;\n    if (level === undefined) level = __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].NOTICE;\n    if (level > __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].getNotifyLevel()) return;\n    registeredTimers[name] = 1;\n    utils.logTime(name);\n};\n\nutils.timeEnd = function(name) {\n    if (registeredTimers[name] === undefined) return;\n    utils.logTimeEnd(name);\n};\n\nutils.timeStamp = (__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console.timeStamp || __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console.markTimeline || function() {}).bind(\n    __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console\n);\nutils.profile = (__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console.profile || function() {}).bind(__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console);\nutils.profileEnd = (__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console.profileEnd || function() {}).bind(__WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].console);\n\nutils.arrayUniq = function(a) {\n    var len = a.length;\n    var seen = {};\n    var out = [];\n    var j = 0;\n    for (var i = 0; i < len; i++) {\n        var item = a[i];\n        if (seen[item] !== 1) {\n            seen[item] = 1;\n            out[j++] = item;\n        }\n    }\n    return out;\n};\n\n// mostly used as an osgDB helper to issue a warning and reject a promise\nutils.rejectObject = function(msg, jsonObj) {\n    if (jsonObj) msg = \'Invalid json \' + msg + \' \' + Object.keys(jsonObj);\n    __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].warn(msg); // useful for line debugging\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject(msg); // reject with a message to avoid "undefined" rejection\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (utils);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/utils.js\n// module id = 0\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/utils.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return mat3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return mat4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return quat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return vec2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return vec3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return vec4; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_math__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_gl_matrix__ = __webpack_require__(178);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_gl_matrix__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_config_js__ = __webpack_require__(184);\n/* harmony reexport (default from non-hamory) */ __webpack_require__.d(__webpack_exports__, "a", function() { return __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a; });\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.glMatrix.setMatrixArrayType(__WEBPACK_IMPORTED_MODULE_2_config_js__["a" /* default */].ArrayType);\n__WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.glMatrix.EPSILON = 1e-9;\n\nvar vec2 = __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.vec2;\nvar vec3 = __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.vec3;\nvar vec4 = __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.vec4;\nvar mat4 = __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.mat4;\nvar mat3 = __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.mat3;\nvar quat = __WEBPACK_IMPORTED_MODULE_1_gl_matrix___default.a.quat;\n\n// osg vec3 additions\n\nvec3.create32 = function() {\n    return new Float32Array(3);\n};\n\nvec3.create64 = function() {\n    return new Float64Array(3);\n};\n\nvec3.fromValues32 = function(a, b, c) {\n    var out = new Float32Array(3);\n    out[0] = a;\n    out[1] = b;\n    out[2] = c;\n    return out;\n};\n\nvec3.fromValues64 = function(a, b, c) {\n    var out = new Float64Array(3);\n    out[0] = a;\n    out[1] = b;\n    out[2] = c;\n    return out;\n};\n\nvec3.init = function(out) {\n    return vec3.set(out, 0.0, 0.0, 0.0);\n};\n\nvec3.transformMat4Rotate = function(out, v, m) {\n    var x = v[0],\n        y = v[1],\n        z = v[2];\n    out[0] = m[0] * x + m[1] * y + m[2] * z;\n    out[1] = m[4] * x + m[5] * y + m[6] * z;\n    out[2] = m[8] * x + m[9] * y + m[10] * z;\n    return out;\n};\n\nvec3.valid = function(a) {\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[0])) return false;\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[1])) return false;\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[2])) return false;\n    return true;\n};\nvec3.neg = vec3.negate;\nvec3.ZERO = vec3.create();\nvec3.ONE = vec3.fromValues(1.0, 1.0, 1.0);\nvec3.INFINITY = vec3.fromValues(Infinity, Infinity, Infinity);\nvec3.NEGATIVE_INFINITY = vec3.fromValues(-Infinity, -Infinity, -Infinity);\n\n// osg vec2 additions\n\nvec2.create32 = function() {\n    return new Float32Array(2);\n};\n\nvec2.create64 = function() {\n    return new Float64Array(2);\n};\n\nvec2.fromValues32 = function(a, b) {\n    var out = new Float32Array(2);\n    out[0] = a;\n    out[1] = b;\n    return out;\n};\n\nvec2.fromValues64 = function(a, b) {\n    var out = new Float64Array(2);\n    out[0] = a;\n    out[1] = b;\n    return out;\n};\n\nvec2.init = function(out) {\n    return vec2.set(out, 0.0, 0.0);\n};\n\nvec2.valid = function(a) {\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[0])) return false;\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[1])) return false;\n    return true;\n};\n\nvec2.ZERO = vec2.create();\nvec2.ONE = vec2.fromValues(1.0, 1.0);\nvec2.INFINITY = vec2.fromValues(Infinity, Infinity);\nvec2.NEGATIVE_INFINITY = vec2.fromValues(-Infinity, -Infinity);\n\n// osg vec4 additions\n\nvec4.create32 = function() {\n    return new Float32Array(4);\n};\n\nvec4.create64 = function() {\n    return new Float64Array(4);\n};\n\nvec4.fromValues32 = function(a, b, c, d) {\n    var out = new Float32Array(4);\n    out[0] = a;\n    out[1] = b;\n    out[2] = c;\n    out[3] = d;\n    return out;\n};\n\nvec4.fromValues64 = function(a, b, c, d) {\n    var out = new Float64Array(4);\n    out[0] = a;\n    out[1] = b;\n    out[2] = c;\n    out[3] = d;\n    return out;\n};\n\nvec4.init = function(out) {\n    return vec4.set(out, 0.0, 0.0, 0.0, 0.0);\n};\n\nvec4.valid = function(a) {\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[0])) return false;\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[1])) return false;\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[2])) return false;\n    if (__WEBPACK_IMPORTED_MODULE_0_osg_math__["a" /* default */].isNaN(a[3])) return false;\n    return true;\n};\nvec4.neg = vec4.negate;\nvec4.ZERO = vec4.create();\nvec4.ONE = vec4.fromValues(1.0, 1.0, 1.0, 1.0);\nvec4.INFINITY = vec4.fromValues(Infinity, Infinity, Infinity, Infinity);\nvec4.NEGATIVE_INFINITY = vec4.fromValues(-Infinity, -Infinity, -Infinity, -Infinity);\n\n// quat\n\nquat.IDENTITY = quat.create();\n\nquat.zeroRotation = function(q) {\n    return q[0] === 0.0 && q[1] === 0.0 && q[2] === 0.0 && q[3] === 1.0;\n};\n\nquat.create32 = function() {\n    var out = new Float32Array(4);\n    out[3] = 1.0;\n    return out;\n};\n\nquat.create64 = function() {\n    var out = new Float64Array(4);\n    out[3] = 1.0;\n    return out;\n};\n\nquat.fromValues32 = vec4.fromValues32;\nquat.fromValues64 = vec4.fromValues64;\nquat.init = quat.identity;\n\n// http://physicsforgames.blogspot.fr/2010/02/quaternions.html\n// called quatBlend\n//\n// NLERP is supposed to be\n// - Commutative,\n// - NOT Constant velocity\n// - Torque minimal\n//\n// a and be must be normalized\n// (otherwise they\'re not rotation...)\n// t must be between 0 and 1\nquat.nlerp = function(out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2],\n        aw = a[3],\n        bx = b[0],\n        by = b[1],\n        bz = b[2],\n        bw = b[3];\n    var dot = ax * bx + ay * by + az * bz + aw * bw;\n    var at = 1.0 - t;\n    var outx, outy, outz, outw;\n    // shortest path\n    if (dot < 0.0) {\n        // negates directly b in the 4 equation\n        // this.neg( b, r );\n        outx = ax * at - bx * t;\n        outy = ay * at - by * t;\n        outz = az * at - bz * t;\n        outw = aw * at - bw * t;\n    } else {\n        outx = ax * at + bx * t;\n        outy = ay * at + by * t;\n        outz = az * at + bz * t;\n        outw = aw * at + bw * t;\n    }\n\n    var invLen = 1.0 / Math.sqrt(outx * outx + outy * outy + outz * outz + outw * outw);\n    out[0] = outx * invLen;\n    out[1] = outy * invLen;\n    out[2] = outz * invLen;\n    out[3] = outw * invLen;\n    return out;\n};\n\n// MUST READ on SLERP, NLERP, LOG-LERP\n// http://number-none.com/product/Understanding%20Slerp,%20Then%20Not%20Using%20It/\n// with a slerp implementation (robust)\n//\n// MUST READ Howto enhance lerp, slerp and q normalize\n// http://number-none.com/product/Hacking%20Quaternions/\n//\n// MUST READ The book:\n// Essential Mathematics for Games and Interactive Applications page\n// ( from 10.6.1 Linear Interpolation to 10.6.3 Performance Improvements )\n//\n//  SLERP is:\n// - NOT commutative\n// - constant velocity\n// - torque minimal\n//\n// so not to be used when blending multiple non ordered rotations\n// (as in multiple animation)\n//\n// slerp see glMatrix implementation\n\n// mat3 additions\nmat3.IDENTITY = mat3.create();\nmat3.create32 = function() {\n    var out = new Float32Array(9);\n    out[0] = out[4] = out[8] = 1.0;\n    return out;\n};\n\nmat3.create64 = function() {\n    var out = new Float64Array(9);\n    out[0] = out[4] = out[8] = 1.0;\n    return out;\n};\n\n// mat4 additions\nmat4.IDENTITY = mat4.create();\n\nmat4.create32 = function() {\n    var out = new Float32Array(16);\n    out[0] = out[5] = out[10] = out[15] = 1.0;\n    return out;\n};\n\nmat4.create64 = function() {\n    var out = new Float64Array(16);\n    out[0] = out[5] = out[10] = out[15] = 1.0;\n    return out;\n};\n\nmat4.setTranslation = function(out, a) {\n    out[12] = a[0];\n    out[13] = a[1];\n    out[14] = a[2];\n    return out;\n};\n\nmat4.getFrustum = function(out, matrix) {\n    var right = 0.0;\n    var left = 0.0;\n    var top = 0.0;\n    var bottom = 0.0;\n    var zNear, zFar;\n\n    if (\n        matrix[0 * 4 + 3] !== 0.0 ||\n        matrix[1 * 4 + 3] !== 0.0 ||\n        matrix[2 * 4 + 3] !== -1.0 ||\n        matrix[3 * 4 + 3] !== 0.0\n    ) {\n        return false;\n    }\n\n    // note: near and far must be used inside this method instead of zNear and zFar\n    // because zNear and zFar are references and they may point to the same variable.\n    var tempNear = matrix[3 * 4 + 2] / (matrix[2 * 4 + 2] - 1.0);\n    var tempFar = matrix[3 * 4 + 2] / (1.0 + matrix[2 * 4 + 2]);\n\n    left = tempNear * (matrix[2 * 4] - 1.0) / matrix[0];\n    right = tempNear * (1.0 + matrix[2 * 4]) / matrix[0];\n\n    top = tempNear * (1.0 + matrix[2 * 4 + 1]) / matrix[1 * 4 + 1];\n    bottom = tempNear * (matrix[2 * 4 + 1] - 1.0) / matrix[1 * 4 + 1];\n\n    zNear = tempNear;\n    zFar = tempFar;\n\n    out.left = left;\n    out.right = right;\n    out.top = top;\n    out.bottom = bottom;\n    out.zNear = zNear;\n    out.zFar = zFar;\n\n    return true;\n};\n\nmat4.getPerspective = (function() {\n    var c = {\n        right: 0,\n        left: 0,\n        top: 0,\n        bottom: 0,\n        zNear: 0,\n        zFar: 0\n    };\n    return function(out, matrix) {\n        // get frustum and compute results\n        var r = mat4.getFrustum(c, matrix);\n        if (r) {\n            out.fovy = 180 / Math.PI * (Math.atan(c.top / c.zNear) - Math.atan(c.bottom / c.zNear));\n            out.aspectRatio = (c.right - c.left) / (c.top - c.bottom);\n        }\n        out.zNear = c.zNear;\n        out.zFar = c.zFar;\n        return out;\n    };\n})();\n\nmat4.getLookAt = (function() {\n    var inv = mat4.create();\n    var v1 = vec3.create();\n    var v2 = vec3.fromValues(0.0, 1.0, 0.0);\n    var v3 = vec3.fromValues(0.0, 0.0, -1.0);\n\n    return function(eye, center, up, matrix, distance) {\n        var d = distance !== undefined ? distance : 1.0;\n        mat4.invert(inv, matrix);\n        mat4.getTranslation(eye, inv);\n        vec3.transformMat4Rotate(up, v2, matrix);\n        vec3.transformMat4Rotate(center, v3, matrix);\n        vec3.normalize(center, center);\n        vec3.add(center, vec3.scale(v1, center, d), eye);\n    };\n})();\n\nmat4.getFrustumPlanes = (function() {\n    var mvp = mat4.create();\n\n    return function(out, projection, view, withNearFar) {\n        mat4.mul(mvp, projection, view);\n\n        var computeNearFar = !!withNearFar;\n\n        // Right clipping plane.\n        var right = out[0];\n        right[0] = mvp[3] - mvp[0];\n        right[1] = mvp[7] - mvp[4];\n        right[2] = mvp[11] - mvp[8];\n        right[3] = mvp[15] - mvp[12];\n\n        // Left clipping plane.\n        var left = out[1];\n        left[0] = mvp[3] + mvp[0];\n        left[1] = mvp[7] + mvp[4];\n        left[2] = mvp[11] + mvp[8];\n        left[3] = mvp[15] + mvp[12];\n\n        // Bottom clipping plane.\n        var bottom = out[2];\n        bottom[0] = mvp[3] + mvp[1];\n        bottom[1] = mvp[7] + mvp[5];\n        bottom[2] = mvp[11] + mvp[9];\n        bottom[3] = mvp[15] + mvp[13];\n\n        // Top clipping plane.\n        var top = out[3];\n        top[0] = mvp[3] - mvp[1];\n        top[1] = mvp[7] - mvp[5];\n        top[2] = mvp[11] - mvp[9];\n        top[3] = mvp[15] - mvp[13];\n\n        var nbPlanes = 4;\n        if (computeNearFar) {\n            nbPlanes = 6;\n            // Far clipping plane.\n            var far = out[4];\n            far[0] = mvp[3] - mvp[2];\n            far[1] = mvp[7] - mvp[6];\n            far[2] = mvp[11] - mvp[10];\n            far[3] = mvp[15] - mvp[14];\n\n            // Near clipping plane.\n            var near = out[5];\n            near[0] = mvp[3] + mvp[2];\n            near[1] = mvp[7] + mvp[6];\n            near[2] = mvp[11] + mvp[10];\n            near[3] = mvp[15] + mvp[14];\n        }\n\n        //Normalize the planes, from osg code\n        for (var i = 0; i < nbPlanes; i++) {\n            var p = out[i];\n            // multiply the coefficients of the plane equation with a constant factor so that the equation a^2+b^2+c^2 = 1 holds.\n            var inv = 1.0 / Math.sqrt(p[0] * p[0] + p[1] * p[1] + p[2] * p[2]);\n            p[0] *= inv;\n            p[1] *= inv;\n            p[2] *= inv;\n            p[3] *= inv;\n        }\n    };\n})();\n\n// better precison\n// no far clipping artifacts.\n// no reason not to use.\n// Tightening the Precision of Perspective Rendering\n//http://www.geometry.caltech.edu/pubs/UD12.pdf\n// drop-in, just remove the one below, and rename this one\nmat4.infiniteFrustum = function(out, left, right, bottom, top, znear) {\n    var X = 2.0 * znear / (right - left);\n    var Y = 2.0 * znear / (top - bottom);\n    var A = (right + left) / (right - left);\n    var B = (top + bottom) / (top - bottom);\n    var C = -1.0;\n    out[0] = X;\n    out[1] = 0.0;\n    out[2] = 0.0;\n    out[3] = 0.0;\n\n    out[4] = 0.0;\n    out[5] = Y;\n    out[6] = 0.0;\n    out[7] = 0.0;\n\n    out[8] = A;\n    out[9] = B;\n    out[10] = C;\n    out[11] = -1.0;\n\n    out[12] = 0.0;\n    out[13] = 0.0;\n    out[14] = -2.0 * znear;\n    out[15] = 0.0;\n\n    return out;\n};\n\nmat4.lookAtDirection = (function() {\n    var s = vec3.create();\n    var u = vec3.create();\n    var neg = vec3.create();\n\n    return function(out, eye, eyeDir, up) {\n        var f = eyeDir;\n        vec3.cross(s, f, up);\n        vec3.normalize(s, s);\n\n        vec3.cross(u, s, f);\n        vec3.normalize(u, u);\n\n        // s[0], u[0], -f[0], 0.0,\n        // s[1], u[1], -f[1], 0.0,\n        // s[2], u[2], -f[2], 0.0,\n        // 0,    0,    0,     1.0\n\n        out[0] = s[0];\n        out[1] = u[0];\n        out[2] = -f[0];\n        out[3] = 0.0;\n        out[4] = s[1];\n        out[5] = u[1];\n        out[6] = -f[1];\n        out[7] = 0.0;\n        out[8] = s[2];\n        out[9] = u[2];\n        out[10] = -f[2];\n        out[11] = 0.0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1.0;\n\n        return mat4.translate(out, out, vec3.neg(neg, eye));\n    };\n})();\n\nmat4.getScale = (function() {\n    var sx = vec3.create();\n    var sy = vec3.create();\n    var sz = vec3.create();\n    return function(out, matrix) {\n        sx[0] = matrix[0];\n        sx[1] = matrix[4];\n        sx[2] = matrix[8];\n        sy[0] = matrix[1];\n        sy[1] = matrix[5];\n        sy[2] = matrix[9];\n        sz[0] = matrix[2];\n        sz[1] = matrix[6];\n        sz[2] = matrix[10];\n\n        out[0] = vec3.length(sx);\n        out[1] = vec3.length(sy);\n        out[2] = vec3.length(sz);\n        return out;\n    };\n})();\n\nmat4.getSqrScale = (function() {\n    var sx = vec3.create();\n    var sy = vec3.create();\n    var sz = vec3.create();\n    return function(out, matrix) {\n        sx[0] = matrix[0];\n        sx[1] = matrix[4];\n        sx[2] = matrix[8];\n        sy[0] = matrix[1];\n        sy[1] = matrix[5];\n        sy[2] = matrix[9];\n        sz[0] = matrix[2];\n        sz[1] = matrix[6];\n        sz[2] = matrix[10];\n\n        out[0] = vec3.sqrLen(sx);\n        out[1] = vec3.sqrLen(sy);\n        out[2] = vec3.sqrLen(sz);\n        return out;\n    };\n})();\n\nvar glmRotate = mat4.rotate;\nmat4.rotate = function(out, a, rad, axis) {\n    return glmRotate(out, a, rad, axis) || mat4.identity(out);\n};\n\nvar glmFromRotate = mat4.fromRotation;\nmat4.fromRotation = function(out, rad, axis) {\n    return glmFromRotate(out, rad, axis) || mat4.identity(out);\n};\n\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/glMatrix.js\n// module id = 1\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/glMatrix.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("var notify = {};\n\n// Range of notify levels from DEBUG through to FATAL\n// ALWAYS is reserved for forcing the absorption of all messages.\n// Must be uppercase and match loggers\nnotify.ALWAYS = 0;\nnotify.FATAL = notify.ERROR = 1;\nnotify.WARN = 2;\nnotify.NOTICE = notify.LOG = 3;\nnotify.INFO = 4;\nnotify.DEBUG = 5;\n\nnotify.currentNotifyLevel = notify.LOG;\nnotify.console = window.console;\n\n/** logging with readability in mind.\n * @param { level } what severity is that log (gives text color too )\n * @param { str } actual log text\n * @param { fold  } sometimes you want to hide looooong text\n */\nfunction logSub(intLevel, strLevel, str) {\n    if (!notify.console || intLevel > notify.currentNotifyLevel) return;\n\n    notify.console[strLevel](str);\n    if (notify.traceLogCall && intLevel !== notify.ERROR) console.trace();\n}\n\nfunction logSubFold(intLevel, strLevel, title, str) {\n    if (!notify.console || intLevel > notify.currentNotifyLevel) return;\n\n    if (notify.console.groupCollapsed) notify.console.groupCollapsed(title);\n    notify.console[strLevel](str);\n    if (notify.traceLogCall && intLevel !== notify.ERROR) console.trace();\n\n    if (notify.console.groupEnd) notify.console.groupEnd();\n}\n\nfunction unFlattenMatrix(m, rowMajor) {\n    if (rowMajor) {\n        return [m.slice(0, 4), m.slice(4, 8), m.slice(8, 12), m.slice(12, 16)];\n    }\n\n    return [\n        [m[0], m[4], m[8], m[12]],\n        [m[1], m[5], m[9], m[13]],\n        [m[2], m[6], m[10], m[14]],\n        [m[3], m[7], m[11], m[15]]\n    ];\n}\n\nfunction logMatrix(intLevel, m, rowMajor) {\n    if (intLevel > notify.currentNotifyLevel) return;\n\n    if (notify.console.table) logSub('table', unFlattenMatrix(m, rowMajor));\n}\n\nfunction logMatrixFold(intLevel, title, m, rowMajor) {\n    if (intLevel > notify.currentNotifyLevel) return;\n\n    if (notify.console.table) logSubFold('table', title, unFlattenMatrix(m, rowMajor));\n}\n\nvar levelEntries = ['error', 'warn', 'log', 'info', 'debug'];\n\nfor (var i = 0; i < levelEntries.length; ++i) {\n    var level = levelEntries[i];\n    var intLevel = notify[level.toUpperCase()];\n    notify[level] = logSub.bind(notify, intLevel, level);\n    notify[level + 'Fold'] = logSubFold.bind(notify, intLevel, level);\n    notify[level + 'Matrix'] = logMatrix.bind(notify, intLevel);\n    notify[level + 'MatrixFold'] = logMatrixFold.bind(notify, intLevel);\n}\n\n// alias\nnotify.notice = notify.log;\nnotify.noticeFold = notify.logFold;\nnotify.noticeMatrix = notify.logMatrix;\nnotify.noticeMatrixFold = notify.logMatrixFold;\n\nnotify.assert = function(test, str) {\n    if (this.console !== undefined && !test) {\n        this.console.assert(test, str);\n    }\n};\n\nnotify.setNotifyLevel = function(logLevel, trace) {\n    notify.currentNotifyLevel = logLevel;\n    if (trace !== undefined) notify.traceLogCall = trace;\n};\n\nnotify.getNotifyLevel = function() {\n    return notify.currentNotifyLevel;\n};\n\nnotify.reportWebGLError = false;\n\nnotify.setConsole = function(replacement) {\n    notify.console = replacement;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (notify);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/notify.js\n// module id = 2\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/notify.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var NodeVisitor = function(traversalMode) {\n    /*jshint bitwise: false */\n    this.traversalMask = ~0x0;\n    /*jshint bitwise: true */\n    this.nodeMaskOverride = 0;\n    this.traversalMode = traversalMode;\n    if (traversalMode === undefined) {\n        this.traversalMode = NodeVisitor.TRAVERSE_ALL_CHILDREN;\n    }\n    this.nodePath = [];\n    this.visitorType = NodeVisitor.NODE_VISITOR;\n    this._databaseRequestHandler = undefined;\n    this._frameStamp = undefined;\n\n    this.traverse = NodeVisitor._traversalFunctions[this.traversalMode];\n    this.pushOntoNodePath = NodeVisitor._pushOntoNodePath[this.traversalMode];\n    this.popFromNodePath = NodeVisitor._popFromNodePath[this.traversalMode];\n};\n\n//NodeVisitor.TRAVERSE_NONE = 0;\nNodeVisitor.TRAVERSE_PARENTS = 1;\nNodeVisitor.TRAVERSE_ALL_CHILDREN = 2;\nNodeVisitor.TRAVERSE_ACTIVE_CHILDREN = 3;\n\nNodeVisitor.NODE_VISITOR = 0;\nNodeVisitor.UPDATE_VISITOR = 1;\nNodeVisitor.CULL_VISITOR = 2;\n\n// =================== Traversal functions ===============\nvar traverseParents = function traverseParents(node) {\n    node.ascend(this);\n};\n\nvar traverseChildren = function traverseAllChildren(node) {\n    node.traverse(this);\n};\n\n// must be sync with TRAVERSE_ENUMS\nNodeVisitor._traversalFunctions = [undefined, traverseParents, traverseChildren, traverseChildren];\n\n// =================== PushOntoNodePath functions ===============\nvar pushOntoNodePathParents = function(node) {\n    this.nodePath.unshift(node);\n};\n\nvar pushOntoNodePathChildren = function(node) {\n    this.nodePath.push(node);\n};\n\nNodeVisitor._pushOntoNodePath = [\n    undefined,\n    pushOntoNodePathParents,\n    pushOntoNodePathChildren,\n    pushOntoNodePathChildren\n];\n\n// =================== PopOntoNodePath functions ===============\nvar popFromNodePathParents = function() {\n    return this.nodePath.shift();\n};\n\nvar popFromNodePathChildren = function() {\n    this.nodePath.pop();\n};\n\nNodeVisitor._popFromNodePath = [\n    undefined,\n    popFromNodePathParents,\n    popFromNodePathChildren,\n    popFromNodePathChildren\n];\n\nNodeVisitor.prototype = {\n    reset: function() {\n        // to be used when you want to re-use a nv\n        this.nodePath.length = 0;\n    },\n\n    setFrameStamp: function(frameStamp) {\n        this._frameStamp = frameStamp;\n    },\n\n    getFrameStamp: function() {\n        return this._frameStamp;\n    },\n\n    setNodeMaskOverride: function(m) {\n        this.nodeMaskOverride = m;\n    },\n    getNodeMaskOverride: function() {\n        return this.nodeMaskOverride;\n    },\n\n    setTraversalMask: function(m) {\n        this.traversalMask = m;\n    },\n    getTraversalMask: function() {\n        return this.traversalMask;\n    },\n\n    getNodePath: function() {\n        return this.nodePath;\n    },\n\n    validNodeMask: function(node) {\n        var nm = node.getNodeMask();\n        /*jshint bitwise: false */\n        return (this.traversalMask & (this.nodeMaskOverride | nm)) !== 0;\n        /*jshint bitwise: true */\n    },\n    apply: function(node) {\n        this.traverse(node);\n    },\n    getVisitorType: function() {\n        return this.visitorType;\n    },\n    setDatabaseRequestHandler: function(dbpager) {\n        this._databaseRequestHandler = dbpager;\n    },\n    getDatabaseRequestHandler: function() {\n        return this._databaseRequestHandler;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (NodeVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/NodeVisitor.js\n// module id = 3\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/NodeVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n\n\n\nvar StateAttribute = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    StateAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        _attributeTypeIndex: undefined,\n\n        getType: function() {\n            return this.attributeType;\n        },\n\n        // basically, if you want two StateAttribute with the same attributeType in a stateSet/State\n        // their typeMember should be different\n        getTypeMember: function() {\n            return this.attributeType;\n        },\n\n        apply: function() {},\n\n        // getHash is used by the compiler to know if a change in a StateAttribute\n        // must trigger a shader build\n        // If you create your own attribute you will have to customize this function\n        // a good rule is to that if you change uniform it should not rebuild a shader\n        // but if you change a type or representation of your StateAttribute, then it should\n        // if it impact the rendering.\n        // check other attributes for examples\n        getHash: function() {\n            return this.getType();\n        }\n    }),\n    \'osg\',\n    \'StateAttribute\'\n);\n\nStateAttribute.OFF = 0;\nStateAttribute.ON = 1;\nStateAttribute.OVERRIDE = 2;\nStateAttribute.PROTECTED = 4;\nStateAttribute.INHERIT = 8;\n\n/* harmony default export */ __webpack_exports__["a"] = (StateAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/StateAttribute.js\n// module id = 4\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/StateAttribute.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n\n\n/**\n *  Object class\n *  @class Object\n */\nvar OSGObject = function() {\n    this._name = undefined;\n    this._userdata = undefined;\n    this._instanceID = OSGObject.getInstanceID();\n};\n\n/** @lends Object.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    OSGObject,\n    {\n        // this method works only if constructor is set correctly\n        // see issue https://github.com/cedricpinson/osgjs/issues/494\n        cloneType: function() {\n            var Constructor = this.constructor;\n            return new Constructor();\n        },\n\n        getInstanceID: function() {\n            return this._instanceID;\n        },\n\n        setName: function(name) {\n            this._name = name;\n        },\n\n        getName: function() {\n            return this._name;\n        },\n\n        setUserData: function(data) {\n            this._userdata = data;\n        },\n\n        getUserData: function() {\n            return this._userdata;\n        }\n    },\n    'osg',\n    'Object'\n);\n\n// get an instanceID for each object\nvar instanceID = 0;\nOSGObject.getInstanceID = function() {\n    instanceID += 1;\n    return instanceID;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (OSGObject);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Object.js\n// module id = 5\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Object.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\n/**\n * Uniform manage variable used in glsl shader.\n * @class Uniform\n */\nvar Uniform = function(name) {\n    this._data = undefined;\n    this._transpose = false;\n    this._glCall = '';\n    this._cache = undefined;\n    this._name = name;\n    this._type = undefined;\n    this._isMatrix = false;\n};\n\nUniform.isUniform = function(obj) {\n    if (typeof obj === 'object' && window.Object.getPrototypeOf(obj) === Uniform.prototype) {\n        return true;\n    }\n    return false;\n};\n\n/** @lends Uniform.prototype */\nUniform.prototype = {\n    getName: function() {\n        return this._name;\n    },\n\n    getType: function() {\n        return this._type;\n    },\n\n    apply: function UniformApply(gl, location) {\n        if (!this._cache) this._cache = gl[this._glCall];\n\n        if (this._isMatrix) {\n            this._cache.call(gl, location, this._transpose, this._data);\n        } else {\n            this._cache.call(gl, location, this._data);\n        }\n    },\n\n    // no type checking, so array should be valid\n    setInternalArray: function(array) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn(\n            'setInternalArray deprecated, please use getInternalArray instead: ' + array.length\n        );\n        this._data = array;\n    },\n\n    getInternalArray: function() {\n        return this._data;\n    },\n\n    setFloat: function(f) {\n        this._data[0] = f;\n    },\n\n    setFloat1: function(f) {\n        this._data[0] = f[0];\n    },\n\n    setFloat2: function(f) {\n        this._data[0] = f[0];\n        this._data[1] = f[1];\n    },\n\n    setFloat3: function(f) {\n        this._data[0] = f[0];\n        this._data[1] = f[1];\n        this._data[2] = f[2];\n    },\n\n    setFloat4: function(f) {\n        this._data[0] = f[0];\n        this._data[1] = f[1];\n        this._data[2] = f[2];\n        this._data[3] = f[3];\n    },\n\n    setFloat9: function(f) {\n        this._data[0] = f[0];\n        this._data[1] = f[1];\n        this._data[2] = f[2];\n        this._data[3] = f[3];\n        this._data[4] = f[4];\n        this._data[5] = f[5];\n        this._data[6] = f[6];\n        this._data[7] = f[7];\n        this._data[8] = f[8];\n    },\n\n    setFloat16: function(f) {\n        this._data[0] = f[0];\n        this._data[1] = f[1];\n        this._data[2] = f[2];\n        this._data[3] = f[3];\n        this._data[4] = f[4];\n        this._data[5] = f[5];\n        this._data[6] = f[6];\n        this._data[7] = f[7];\n        this._data[8] = f[8];\n        this._data[9] = f[9];\n        this._data[10] = f[10];\n        this._data[11] = f[11];\n        this._data[12] = f[12];\n        this._data[13] = f[13];\n        this._data[14] = f[14];\n        this._data[15] = f[15];\n    }\n};\nUniform.prototype.setVec2 = Uniform.prototype.setFloat2;\nUniform.prototype.setVec3 = Uniform.prototype.setFloat3;\nUniform.prototype.setVec4 = Uniform.prototype.setFloat4;\nUniform.prototype.setMatrix4 = Uniform.prototype.setFloat16;\nUniform.prototype.setMatrix3 = Uniform.prototype.setFloat9;\nUniform.prototype.setInt = Uniform.prototype.setFloat;\nUniform.prototype.setInt1 = Uniform.prototype.setFloat1;\nUniform.prototype.setInt2 = Uniform.prototype.setFloat2;\nUniform.prototype.setInt3 = Uniform.prototype.setFloat3;\nUniform.prototype.setInt4 = Uniform.prototype.setFloat4;\n\nvar createUniformX = function(\n    dataOrName,\n    nameOrNbItem,\n    internalArray,\n    glSignature,\n    type,\n    isMatrix\n) {\n    var data = nameOrNbItem && nameOrNbItem.length ? dataOrName : undefined;\n    var uniform = new Uniform(data !== undefined ? nameOrNbItem : dataOrName);\n\n    uniform._data = internalArray;\n\n    if (data !== undefined) {\n        if (data.length) {\n            for (var i = 0, nbElts = data.length; i < nbElts; ++i) uniform._data[i] = data[i];\n        } else {\n            uniform._data[0] = data;\n        }\n    }\n\n    uniform._glCall = glSignature;\n    uniform._type = type;\n    uniform._isMatrix = !!isMatrix;\n    return uniform;\n};\n\nvar createMat2 = function(nbItem) {\n    var out = new Float32Array(nbItem * 4);\n    for (var i = 0; i < out.length; i += 4) out[i] = out[i + 3] = 1.0;\n    return out;\n};\n\nvar createMat3 = function(nbItem) {\n    var out = new Float32Array(nbItem * 9);\n    for (var i = 0; i < out.length; i += 9) out[i] = out[i + 4] = out[i + 8] = 1.0;\n    return out;\n};\n\nvar createMat4 = function(nbItem) {\n    var out = new Float32Array(nbItem * 16);\n    for (var i = 0; i < out.length; i += 16) out[i] = out[i + 5] = out[i + 10] = out[i + 15] = 1.0;\n    return out;\n};\n\n// possibles signatures\n// name\n// data, name\n// name, nbItem\nvar _getNbItem = function(itemSize, dataOrName, nameOrNbItem) {\n    if (nameOrNbItem && !nameOrNbItem.length) return nameOrNbItem; // name, nbItem\n    if (typeof dataOrName !== 'string') return (dataOrName.length || 1) / itemSize; // data, name\n    return 1; // name\n};\n\n// works also for float array but data must be given\nUniform.createFloat1 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Float32Array(1 * _getNbItem(1, dataOrName, nameOrNbItem)),\n        'uniform1fv',\n        'float'\n    );\n};\nUniform.createFloat2 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Float32Array(2 * _getNbItem(2, dataOrName, nameOrNbItem)),\n        'uniform2fv',\n        'vec2'\n    );\n};\nUniform.createFloat3 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Float32Array(3 * _getNbItem(3, dataOrName, nameOrNbItem)),\n        'uniform3fv',\n        'vec3'\n    );\n};\nUniform.createFloat4 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Float32Array(4 * _getNbItem(4, dataOrName, nameOrNbItem)),\n        'uniform4fv',\n        'vec4'\n    );\n};\n\nUniform.createInt1 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Int32Array(1 * _getNbItem(1, dataOrName, nameOrNbItem)),\n        'uniform1iv',\n        'int'\n    );\n};\nUniform.createInt2 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Int32Array(2 * _getNbItem(2, dataOrName, nameOrNbItem)),\n        'uniform2iv',\n        'vec2i'\n    );\n};\nUniform.createInt3 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Int32Array(3 * _getNbItem(3, dataOrName, nameOrNbItem)),\n        'uniform3iv',\n        'vec3i'\n    );\n};\nUniform.createInt4 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        new Int32Array(4 * _getNbItem(4, dataOrName, nameOrNbItem)),\n        'uniform4iv',\n        'vec4i'\n    );\n};\n\nUniform.createMatrix2 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        createMat2(_getNbItem(4, dataOrName, nameOrNbItem)),\n        'uniformMatrix2fv',\n        'mat2',\n        true\n    );\n};\n\nUniform.createMatrix3 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        createMat3(_getNbItem(9, dataOrName, nameOrNbItem)),\n        'uniformMatrix3fv',\n        'mat3',\n        true\n    );\n};\n\nUniform.createMatrix4 = function(dataOrName, nameOrNbItem) {\n    return createUniformX(\n        dataOrName,\n        nameOrNbItem,\n        createMat4(_getNbItem(16, dataOrName, nameOrNbItem)),\n        'uniformMatrix4fv',\n        'mat4',\n        true\n    );\n};\n\n// alias\nUniform.float = Uniform.createFloatArray = Uniform.createFloat = Uniform.createFloat1;\nUniform.vec2 = Uniform.createFloat2Array = Uniform.createFloat2;\nUniform.vec3 = Uniform.createFloat3Array = Uniform.createFloat3;\nUniform.vec4 = Uniform.createFloat4Array = Uniform.createFloat4;\n\nUniform.int = Uniform.createIntArray = Uniform.createInt = Uniform.createInt1;\nUniform.vec2i = Uniform.createInt2Array = Uniform.createInt2;\nUniform.vec3i = Uniform.createInt3Array = Uniform.createInt3;\nUniform.vec4i = Uniform.createInt4Array = Uniform.createInt4;\n\nUniform.mat2 = Uniform.createMat2Array = Uniform.createMat2 = Uniform.createMatrix2;\nUniform.mat3 = Uniform.createMat3Array = Uniform.createMat3 = Uniform.createMatrix3;\nUniform.mat4 = Uniform.createMat4Array = Uniform.createMat4 = Uniform.createMatrix4;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Uniform);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Uniform.js\n// module id = 6\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Uniform.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_TextureManager__ = __webpack_require__(185);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_WebGLCaps__ = __webpack_require__(18);\n\n\n\n\n\n\n\n\n\n\nvar ImageBitmap = window.ImageBitmap || function() {};\n\n// helper\nvar isPowerOf2 = function(x) {\n    /*jshint bitwise: false */\n    return x !== 0 && (x & (~x + 1)) === x;\n    /*jshint bitwise: true */\n};\n\n/**\n * Texture encapsulate webgl texture object\n * @class Texture\n * Not that dirty here is mainly for texture binding\n * any dirty will cause re-bind\n * hint: don't dirty a texture attached to a camera/framebuffer\n * it will end blank\n * @inherits StateAttribute\n */\nvar Texture = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_StateAttribute__[\"a\" /* default */].call(this);\n    __WEBPACK_IMPORTED_MODULE_5_osg_GLObject__[\"a\" /* default */].call(this);\n    this.setDefaultParameters();\n    this._dirty = true;\n    this._dirtyMipmap = true;\n    this._applyTexImage2DCallbacks = [];\n    this._textureObject = undefined;\n\n    this._textureNull = true;\n};\n\nvar checkAndFixEnum = function(mode, fallback) {\n    var value = Texture[mode];\n\n    if (value === undefined) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn('bad Texture enum argument ' + mode + '\\n' + 'fallback to ' + fallback);\n        return fallback;\n    }\n\n    return value;\n};\n\nTexture.UNPACK_COLORSPACE_CONVERSION_WEBGL = 0x9243;\nTexture.UNPACK_FLIP_Y_WEBGL = 0x9240;\nTexture.BROWSER_DEFAULT_WEBGL = 0x9244;\nTexture.NONE = 0x0;\n\nTexture.DEPTH_COMPONENT = 0x1902;\nTexture.DEPTH_COMPONENT16 = 0x81a5;\nTexture.DEPTH_STENCIL = 0x84f9;\n// gl2\nTexture.DEPTH24_STENCIL8 = 0x88f0;\nTexture.DEPTH_COMPONENT24 = 0x81a6;\nTexture.DEPTH_COMPONENT32F = 0x8cac;\n\n// DXT formats, from:\n// http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_s3tc/\nTexture.COMPRESSED_RGB_S3TC_DXT1_EXT = 0x83f0;\nTexture.COMPRESSED_RGBA_S3TC_DXT1_EXT = 0x83f1;\nTexture.COMPRESSED_RGBA_S3TC_DXT3_EXT = 0x83f2;\nTexture.COMPRESSED_RGBA_S3TC_DXT5_EXT = 0x83f3;\n\n// ATC formats, from:\n// http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_atc/\nTexture.COMPRESSED_RGB_ATC_WEBGL = 0x8c92;\nTexture.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL = 0x8c93;\nTexture.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL = 0x87ee;\n\n// PVR formats, from:\n// http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_pvrtc/\nTexture.COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 0x8c00;\nTexture.COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 0x8c01;\nTexture.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 0x8c02;\nTexture.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 0x8c03;\n\n// ETC1 format, from:\n// http://www.khronos.org/registry/webgl/extensions/WEBGL_compressed_texture_etc1/\nTexture.COMPRESSED_RGB_ETC1_WEBGL = 0x8d64;\n\n// filter mode\nTexture.LINEAR = 0x2601;\nTexture.NEAREST = 0x2600;\nTexture.NEAREST_MIPMAP_NEAREST = 0x2700;\nTexture.LINEAR_MIPMAP_NEAREST = 0x2701;\nTexture.NEAREST_MIPMAP_LINEAR = 0x2702;\nTexture.LINEAR_MIPMAP_LINEAR = 0x2703;\n// filter anisotropy\nTexture.TEXTURE_MAX_ANISOTROPY_EXT = 0x84fe;\nTexture.MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84ff;\n\n// wrap mode\nTexture.CLAMP_TO_EDGE = 0x812f;\nTexture.REPEAT = 0x2901;\nTexture.MIRRORED_REPEAT = 0x8370;\n\n// target\nTexture.TEXTURE_2D = 0x0de1;\nTexture.TEXTURE_CUBE_MAP = 0x8513;\nTexture.TEXTURE_BINDING_CUBE_MAP = 0x8514;\nTexture.TEXTURE_CUBE_MAP_POSITIVE_X = 0x8515;\nTexture.TEXTURE_CUBE_MAP_NEGATIVE_X = 0x8516;\nTexture.TEXTURE_CUBE_MAP_POSITIVE_Y = 0x8517;\nTexture.TEXTURE_CUBE_MAP_NEGATIVE_Y = 0x8518;\nTexture.TEXTURE_CUBE_MAP_POSITIVE_Z = 0x8519;\nTexture.TEXTURE_CUBE_MAP_NEGATIVE_Z = 0x851a;\nTexture.MAX_CUBE_MAP_TEXTURE_SIZE = 0x851c;\n\n// https: //www.khronos.org/registry/webgl/specs/latest/2.0/#3.7.6\n///////////\n// TYPE GL1\n///////////\nTexture.UNSIGNED_BYTE = 0x1401;\nTexture.UNSIGNED_SHORT = 0x1403;\nTexture.UNSIGNED_SHORT_4_4_4_4 = 0x8033;\nTexture.UNSIGNED_SHORT_5_5_5_1 = 0x8034;\nTexture.UNSIGNED_SHORT_5_6_5 = 0x8363;\nTexture.FLOAT = 0x1406;\nTexture.HALF_FLOAT_OES = 0x8d61;\n// TYPE GL2\nTexture.HALF_FLOAT = 0x140b;\nTexture.UNSIGNED_INT_10F_11F_11F_REV = 0x8c3b;\nTexture.UNSIGNED_INT_24_8 = 0x84fa;\n\n/////////////\n// FORMAT GL1\n/////////////\nTexture.ALPHA = 0x1906;\nTexture.RGB = 0x1907;\nTexture.RGBA = 0x1908;\nTexture.LUMINANCE = 0x1909;\nTexture.LUMINANCE_ALPHA = 0x190a;\n// format gl2\nTexture.RED_INTEGER = 0x8d94;\nTexture.RGB_INTEGER = 0x8d98;\nTexture.RGBA_INTEGER = 0x8d99;\nTexture.RG_INTEGER = 0x8228;\nTexture.RED = 0x1903;\n\n//////////////////////\n// INTERNAL FORMAT GL2\n//////////////////////\nTexture.R8 = 0x8229;\nTexture.R8UI = 0x8232;\nTexture.RG8 = 0x822b;\nTexture.RG8UI = 0x8238;\nTexture.RGB8 = 0x8f96;\nTexture.RGB565 = 0x8d62;\nTexture.RGB9_E5 = 0x8c3d;\nTexture.RGB8UI = 0x8d7d;\nTexture.RGBA8 = 0x8058;\nTexture.RGB5_A1 = 0x8057;\nTexture.RGBA4 = 0x8056;\nTexture.RGBA8UI = 0x8d7c;\nTexture.SRGB8_ALPHA8 = 0x8c43;\nTexture.SRGB8 = 0x8c41;\n\n// HALF FLOAT - FLOAT\nTexture.R16F = 0x822d;\nTexture.RG16F = 0x822f;\nTexture.RGB16F = 0x881b;\nTexture.RGBA16F = 0x881a;\nTexture.R11F_G11F_B10F = 0x8c3a; // and UNSIGNED_INT_10F_11F_11F_REV\n// FLOAT\nTexture.R32F = 0x822e;\nTexture.RG32F = 0x8230;\nTexture.RGB32F = 0x8815;\nTexture.RGBA32F = 0x8814;\n\nvar createMapGl2ToGl1 = function() {\n    var map = {};\n\n    map[Texture.R8] = Texture.LUMINANCE;\n    map[Texture.R8UI] = Texture.LUMINANCE;\n    map[Texture.R16F] = Texture.LUMINANCE;\n    map[Texture.R32F] = Texture.LUMINANCE;\n    map[Texture.SRGB8] = Texture.LUMINANCE;\n    map[Texture.RG8] = Texture.RGB;\n    map[Texture.RG8UI] = Texture.RGB;\n    map[Texture.RG16F] = Texture.RGB;\n    map[Texture.RG32F] = Texture.RGB;\n    map[Texture.RGB8] = Texture.RGB;\n    map[Texture.RGB565] = Texture.RGB;\n    map[Texture.RGB9_E5] = Texture.RGB;\n    map[Texture.RGB8UI] = Texture.RGB;\n    map[Texture.RGB5_A1] = Texture.RGB;\n    map[Texture.RGB16F] = Texture.RGB;\n    map[Texture.RGB32F] = Texture.RGB;\n    map[Texture.RGBA8] = Texture.RGBA;\n    map[Texture.R11F_G11F_B10F] = Texture.RGBA;\n    map[Texture.RGBA16F] = Texture.RGBA;\n    map[Texture.RGBA32F] = Texture.RGBA;\n    map[Texture.SRGB8_ALPHA8] = Texture.RGBA;\n\n    return map;\n};\n\nvar createMapGl1ToGl2 = function() {\n    var map = {};\n\n    var float = {};\n    var halfFloat = {};\n    var ushort = {};\n    var uint = {};\n    var uin24 = {};\n\n    map[Texture.FLOAT] = float;\n    map[Texture.HALF_FLOAT] = map[Texture.HALF_FLOAT_OES] = halfFloat;\n    map[Texture.UNSIGNED_SHORT] = ushort;\n    map[Texture.UNSIGNED_INT] = uint;\n    map[Texture.UNSIGNED_INT_24_8] = uin24;\n\n    halfFloat[Texture.LUMINANCE] = Texture.R16F;\n    halfFloat[Texture.RGB] = Texture.RGB16F;\n    halfFloat[Texture.RGBA] = Texture.RGBA16F;\n\n    float[Texture.LUMINANCE] = Texture.R32F;\n    float[Texture.RGB] = Texture.RGB32F;\n    float[Texture.RGBA] = Texture.RGBA32F;\n\n    ushort[Texture.DEPTH_COMPONENT] = Texture.DEPTH_COMPONENT16;\n    uint[Texture.DEPTH_COMPONENT] = Texture.DEPTH_COMPONENT32F;\n    uin24[Texture.DEPTH_STENCIL] = Texture.DEPTH24_STENCIL8;\n\n    return map;\n};\n\nvar internalFormatGl2ToGl1 = createMapGl2ToGl1();\nvar internalFormatGl1ToGl2 = createMapGl1ToGl2();\n\nTexture._sTextureManager = new window.Map();\n\n// Getter for textureManager\nTexture.getTextureManager = function(gl) {\n    if (!Texture._sTextureManager.has(gl)) Texture._sTextureManager.set(gl, new __WEBPACK_IMPORTED_MODULE_6_osg_TextureManager__[\"a\" /* default */]());\n\n    return Texture._sTextureManager.get(gl);\n};\n\nTexture.getEnumFromString = function(v) {\n    var value = v;\n\n    if (typeof value === 'string') value = checkAndFixEnum(value, v);\n\n    return value;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    Texture,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(\n        __WEBPACK_IMPORTED_MODULE_5_osg_GLObject__[\"a\" /* default */].prototype,\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_StateAttribute__[\"a\" /* default */].prototype, {\n            attributeType: 'Texture',\n\n            cloneType: function() {\n                return new Texture();\n            },\n\n            invalidate: function() {\n                this._textureObject = undefined;\n                this.dirty();\n            },\n\n            dirty: function() {\n                this._dirty = true;\n            },\n\n            isDirty: function() {\n                return this._dirty;\n            },\n\n            isTextureNull: function() {\n                return this._textureNull;\n            },\n\n            getOrCreateUniforms: function(unit) {\n                if (Texture.uniforms === undefined) {\n                    Texture.uniforms = [];\n                }\n                if (Texture.uniforms[unit] === undefined) {\n                    var name = this.getType() + unit;\n                    Texture.uniforms[unit] = {\n                        texture: __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createInt1(unit, name)\n                    };\n                }\n\n                // uniform for an texture attribute should directly in Texture.uniforms[unit]\n                // and not in Texture.uniforms[unit][Texture0]\n\n                // Why it's in Texture.uniforms[unit]['texture'] :\n                // a 'texture' is a texture attribute but you also have old texenv\n                //  that are texture attribute because  they are applied on a texture unit.\n                // I admit that currently we dont have this or we used to but we dont have it anymore.\n                // It's the same design than osg.\n                // We could imagine for example a TextureGreyScale texture attributes,\n                // that would transform the input texture\n                // on unit X into greyscale used in the shader.\n\n                return Texture.uniforms[unit];\n            },\n\n            setDefaultParameters: function() {\n                this._image = undefined;\n                this._magFilter = Texture.LINEAR;\n                this._minFilter = Texture.LINEAR;\n                this._maxAnisotropy = 1.0;\n                this._wrapS = Texture.CLAMP_TO_EDGE;\n                this._wrapT = Texture.CLAMP_TO_EDGE;\n                this._textureWidth = 0;\n                this._textureHeight = 0;\n                this._unrefImageDataAfterApply = false;\n                this._internalFormat = undefined;\n                this._dirtyMipmap = true;\n                this._textureTarget = Texture.TEXTURE_2D;\n                this.setInternalFormatType(Texture.UNSIGNED_BYTE);\n                this._isCompressed = false;\n\n                this._flipY = true;\n                this._colorSpaceConversion = Texture.NONE; //Texture.BROWSER_DEFAULT_WEBGL;\n            },\n\n            // check https://www.khronos.org/registry/webgl/specs/latest/1.0/#PIXEL_STORAGE_PARAMETERS\n            setColorSpaceConversion: function(enumValue) {\n                this._colorSpaceConversion = enumValue;\n            },\n\n            setFlipY: function(bool) {\n                this._flipY = bool;\n            },\n\n            getTextureTarget: function() {\n                return this._textureTarget;\n            },\n\n            getTextureObject: function() {\n                return this._textureObject;\n            },\n\n            setTextureSize: function(w, h) {\n                var maxSize = __WEBPACK_IMPORTED_MODULE_7_osg_WebGLCaps__[\"a\" /* default */].instance().getWebGLParameter('MAX_TEXTURE_SIZE');\n\n                if (w !== this._textureWidth || h !== this._textureHeight) this.dirty();\n\n                if (w !== undefined) {\n                    if (w > maxSize) {\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(\n                            'width (' +\n                                w +\n                                ') too big for GPU. Max Texture Size is \"' +\n                                maxSize +\n                                '\"'\n                        );\n                        this._textureWidth = maxSize;\n                    } else {\n                        this._textureWidth = w;\n                    }\n                }\n\n                if (h !== undefined) {\n                    if (h > maxSize) {\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(\n                            'height (' +\n                                h +\n                                ') too big for GPU. Max Texture Size is \"' +\n                                maxSize +\n                                '\"'\n                        );\n                        this._textureHeight = maxSize;\n                    } else {\n                        this._textureHeight = h;\n                    }\n                }\n\n                this._textureNull = false;\n            },\n\n            init: function(state) {\n                if (!this._gl) {\n                    this.setGraphicContext(state.getGraphicContext());\n                }\n\n                if (!this._textureObject) {\n                    this._textureObject = Texture.getTextureManager(this._gl).generateTextureObject(\n                        this._gl,\n                        this,\n                        this._textureTarget,\n                        this._internalFormat,\n                        this._textureWidth,\n                        this._textureHeight\n                    );\n\n                    this.dirty();\n                    this._dirtyTextureObject = false;\n                    this._textureNull = false;\n                }\n            },\n\n            addApplyTexImage2DCallback: function(callback) {\n                var index = this._applyTexImage2DCallbacks.indexOf(callback);\n                if (index < 0) {\n                    this._applyTexImage2DCallbacks.push(callback);\n                }\n            },\n\n            removeApplyTexImage2DCallback: function(callback) {\n                var index = this._applyTexImage2DCallbacks.indexOf(callback);\n                if (index >= 0) {\n                    this._applyTexImage2DCallbacks.splice(index, 1);\n                }\n            },\n\n            getWidth: function() {\n                return this._textureWidth;\n            },\n\n            getHeight: function() {\n                return this._textureHeight;\n            },\n\n            releaseGLObjects: function() {\n                if (\n                    this._textureObject !== undefined &&\n                    this._textureObject !== null &&\n                    this._gl !== undefined\n                ) {\n                    Texture.getTextureManager(this._gl).releaseTextureObject(this._textureObject);\n                    __WEBPACK_IMPORTED_MODULE_5_osg_GLObject__[\"a\" /* default */].removeObject(this._gl, this);\n                }\n                this.invalidate();\n            },\n\n            getWrapT: function() {\n                return this._wrapT;\n            },\n\n            getWrapS: function() {\n                return this._wrapS;\n            },\n\n            setWrapS: function(value) {\n                if (typeof value === 'string') {\n                    this._wrapS = checkAndFixEnum(value, Texture.CLAMP_TO_EDGE);\n                } else {\n                    this._wrapS = value;\n                }\n\n                this.dirtyTextureParameters();\n            },\n\n            setWrapT: function(value) {\n                if (typeof value === 'string') {\n                    this._wrapT = checkAndFixEnum(value, Texture.CLAMP_TO_EDGE);\n                } else {\n                    this._wrapT = value;\n                }\n\n                this.dirtyTextureParameters();\n            },\n\n            // TODO CP:\n            // we should split dirty texture object of parameters\n            // dirty parameters only regenarate parameter\n            // dirty texture object needs to release a texture and\n            // re allocate one\n            dirtyTextureParameters: function() {\n                this.dirty(); // make everything dirty for now\n                this.dirtyMipmap();\n                this.dirtyTextureObject();\n            },\n\n            dirtyTextureObject: function() {\n                this._dirtyTextureObject = true;\n                this.dirtyMipmap();\n                this.dirty(); // make everything dirty for now\n            },\n\n            getMinFilter: function() {\n                return this._minFilter;\n            },\n\n            getMagFilter: function() {\n                return this._magFilter;\n            },\n\n            // https://www.opengl.org/registry/specs/EXT/texture_filter_anisotropic.txt\n            setMaxAnisotropy: function(multiplier) {\n                this._maxAnisotropy = multiplier;\n                this.dirtyTextureParameters();\n            },\n\n            getMaxAnisotropy: function() {\n                return this._maxAnisotropy;\n            },\n\n            // some value enable mipmapping\n            setMinFilter: function(value) {\n                if (typeof value === 'string') {\n                    this._minFilter = checkAndFixEnum(value, Texture.LINEAR);\n                } else {\n                    this._minFilter = value;\n                }\n\n                this.dirtyTextureParameters();\n            },\n\n            // Either Linear or nearest.\n            setMagFilter: function(value) {\n                if (typeof value === 'string') {\n                    this._magFilter = checkAndFixEnum(value, Texture.LINEAR);\n                } else {\n                    this._magFilter = value;\n                }\n\n                this.dirtyTextureParameters();\n            },\n\n            setImage: function(img, imageFormat) {\n                var image = img;\n                if (\n                    img instanceof window.Image ||\n                    img instanceof HTMLCanvasElement ||\n                    img instanceof ImageBitmap ||\n                    img instanceof Uint8Array ||\n                    img instanceof Uint16Array ||\n                    img instanceof Float32Array\n                ) {\n                    image = new __WEBPACK_IMPORTED_MODULE_4_osg_Image__[\"a\" /* default */](img);\n                }\n\n                this._image = image;\n                this.setImageFormat(imageFormat);\n                if (image) {\n                    if (image.getWidth && image.getHeight) {\n                        this.setTextureSize(image.getWidth(), image.getHeight());\n                    } else if (image.width && image.height) {\n                        this.setTextureSize(image.width, image.height);\n                    }\n                }\n                this._textureNull = false;\n                this.dirty();\n            },\n\n            getImage: function() {\n                return this._image;\n            },\n\n            setImageFormat: function(format) {\n                var imageFormat = format;\n                if (imageFormat) {\n                    if (typeof imageFormat === 'string') imageFormat = Texture[imageFormat];\n\n                    this._imageFormat = imageFormat;\n                } else {\n                    this._imageFormat = Texture.RGBA;\n                }\n            },\n\n            setInternalFormatType: function(value) {\n                // UNSIGNED_BYTE, HALF_FLOAT, FLOAT\n\n                if (typeof value === 'string') {\n                    this._type = Texture[value];\n                } else {\n                    this._type = value;\n                }\n            },\n\n            getInternalFormatType: function() {\n                return this._type;\n            },\n\n            setUnrefImageDataAfterApply: function(bool) {\n                this._unrefImageDataAfterApply = bool;\n            },\n\n            checkIsCompressed: function(format) {\n                var fo = format || this._internalFormat;\n                switch (fo) {\n                    case Texture.COMPRESSED_RGB_S3TC_DXT1_EXT:\n                    case Texture.COMPRESSED_RGBA_S3TC_DXT1_EXT:\n                    case Texture.COMPRESSED_RGBA_S3TC_DXT3_EXT:\n                    case Texture.COMPRESSED_RGBA_S3TC_DXT5_EXT:\n                    case Texture.COMPRESSED_RGB_ATC_WEBGL:\n                    case Texture.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:\n                    case Texture.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:\n                    case Texture.COMPRESSED_RGB_PVRTC_4BPPV1_IMG:\n                    case Texture.COMPRESSED_RGB_PVRTC_2BPPV1_IMG:\n                    case Texture.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:\n                    case Texture.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:\n                    case Texture.COMPRESSED_RGB_ETC1_WEBGL:\n                        return true;\n                    default:\n                        return false;\n                }\n            },\n\n            setInternalFormat: function(formatSource) {\n                // RGB, RGBA, ALPHA, LUMINANCE, LUMINANCE_ALPHA\n                // RGB16F, RGB32F, etc...\n                // DEPTH_COMPONENT, DEPTH_STENCIL\n\n                var format = formatSource;\n                if (format) {\n                    if (typeof format === 'string') format = Texture[format];\n\n                    this._isCompressed = this.checkIsCompressed(format);\n                } else {\n                    this._isCompressed = false;\n                    format = Texture.RGBA;\n                }\n\n                this._internalFormat = format;\n            },\n\n            getInternalFormat: function() {\n                return this._internalFormat;\n            },\n\n            isDirtyMipmap: function() {\n                return this._dirtyMipmap;\n            },\n\n            // Will cause the mipmaps to be regenerated on the next bind of the texture\n            // Nothing will be done if the minFilter is not of the form XXX_MIPMAP_XXX\n            // TODO : not to be used if the texture is compressed !\n            dirtyMipmap: function() {\n                this._dirtyMipmap = true;\n            },\n\n            applyFilterParameter: function(gl, target) {\n                var powerOfTwo = isPowerOf2(this._textureWidth) && isPowerOf2(this._textureHeight);\n                if (!powerOfTwo) {\n                    // NPOT non support in webGL explained here\n                    // https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\n                    // so disabling mipmap...\n                    this._wrapT = Texture.CLAMP_TO_EDGE;\n                    this._wrapS = Texture.CLAMP_TO_EDGE;\n\n                    if (\n                        this._minFilter === Texture.LINEAR_MIPMAP_LINEAR ||\n                        this._minFilter === Texture.LINEAR_MIPMAP_NEAREST\n                    ) {\n                        this._minFilter = Texture.LINEAR;\n                    }\n                }\n                gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, this._magFilter);\n                gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, this._minFilter);\n\n                // handle extension EXT_texture_filter_anisotropic\n                if (this._maxAnisotropy > 1.0 && Texture.ANISOTROPIC_SUPPORT_EXT) {\n                    var multiplier =\n                        this._maxAnisotropy < Texture.ANISOTROPIC_SUPPORT_MAX\n                            ? this._maxAnisotropy\n                            : Texture.ANISOTROPIC_SUPPORT_MAX;\n                    gl.texParameterf(target, Texture.TEXTURE_MAX_ANISOTROPY_EXT, multiplier);\n                }\n\n                gl.texParameteri(target, gl.TEXTURE_WRAP_S, this._wrapS);\n                gl.texParameteri(target, gl.TEXTURE_WRAP_T, this._wrapT);\n            },\n\n            generateMipmap: function(gl, target) {\n                this._dirtyMipmap = false;\n                if (!this.hasMipmapFilter()) return;\n\n                // manual mipmap provided\n                var img = this._image;\n                if (img && img.hasMipmap()) {\n                    var internalFormat = this._getInternalFormatGL();\n                    var mips = img.getMipmap();\n                    for (var level = 1, nbLevel = mips.length; level < nbLevel; level++) {\n                        var imi = mips[level];\n                        if (this._isCompressed)\n                            this.applyTexImage2D(\n                                gl,\n                                this._textureTarget,\n                                level,\n                                internalFormat,\n                                imi.getWidth(),\n                                imi.getHeight(),\n                                0,\n                                imi.getImage()\n                            );\n                        else\n                            this.applyTexImage2D(\n                                gl,\n                                this._textureTarget,\n                                level,\n                                internalFormat,\n                                imi.getWidth(),\n                                imi.getHeight(),\n                                0,\n                                this._internalFormat,\n                                this._type,\n                                imi.getImage()\n                            );\n                    }\n                } else {\n                    // automatic mipmap\n                    gl.generateMipmap(target);\n                }\n            },\n\n            // return true if contains a mipmap filter\n            hasMipmapFilter: function() {\n                return (\n                    this._minFilter === Texture.NEAREST_MIPMAP_NEAREST ||\n                    this._minFilter === Texture.LINEAR_MIPMAP_NEAREST ||\n                    this._minFilter === Texture.NEAREST_MIPMAP_LINEAR ||\n                    this._minFilter === Texture.LINEAR_MIPMAP_LINEAR\n                );\n            },\n\n            applyTexImage2D: function(gl) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].timeStamp('osgjs.metrics:Texture.texImage2d');\n\n                // use parameters of pixel store\n                gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, this._flipY);\n                gl.pixelStorei(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, this._colorSpaceConversion);\n\n                if (this._isCompressed) gl.compressedTexImage2D.apply(gl, args);\n                else gl.texImage2D.apply(gl, args);\n\n                // call a callback when upload is done if there is one\n                var numCallback = this._applyTexImage2DCallbacks.length;\n                if (numCallback > 0) {\n                    for (var i = 0, l = numCallback; i < l; i++) {\n                        this._applyTexImage2DCallbacks[i].call(this);\n                    }\n                }\n            },\n\n            computeTextureFormat: function() {\n                if (!this._internalFormat) {\n                    this._internalFormat = this._imageFormat || Texture.RGBA;\n                    this._imageFormat = this._internalFormat;\n                } else {\n                    this._imageFormat = this._internalFormat;\n                }\n            },\n\n            applyImage: function(gl) {\n                var internalFormat = this._getInternalFormatGL();\n                var image = this._image || null;\n                var data = image && this._image.getImage();\n\n                var type = this._getTypeGL();\n\n                if (this._isCompressed) {\n                    this.applyTexImage2D(\n                        gl,\n                        this._textureTarget,\n                        0,\n                        internalFormat,\n                        this._textureWidth,\n                        this._textureHeight,\n                        0,\n                        data\n                    );\n                } else if (!data || image.isTypedArray()) {\n                    this.applyTexImage2D(\n                        gl,\n                        this._textureTarget,\n                        0,\n                        internalFormat,\n                        this._textureWidth,\n                        this._textureHeight,\n                        0,\n                        this._internalFormat,\n                        type,\n                        data\n                    );\n                } else {\n                    this.applyTexImage2D(\n                        gl,\n                        this._textureTarget,\n                        0,\n                        internalFormat,\n                        this._internalFormat,\n                        type,\n                        data\n                    );\n                }\n\n                if (image) image.setDirty(false);\n            },\n\n            apply: function(state) {\n                var gl = state.getGraphicContext();\n                // if need to release the texture\n                if (this._dirtyTextureObject) {\n                    this.releaseGLObjects();\n                    this._dirtyTextureObject = false;\n                    this.setGraphicContext(gl);\n                }\n\n                if (this._textureObject !== undefined && !this.isDirty()) {\n                    this._textureObject.bind(gl);\n                    // If we have modified the texture via Rtt or texSubImage2D and _need_ updated mipmaps,\n                    // then we must regenerate the mipmaps explicitely.\n                    // In all other cases, don't set this flag because it can be costly\n                    if (this.isDirtyMipmap()) {\n                        this.generateMipmap(gl, this._textureTarget);\n                    }\n\n                    // image update like video\n                    if (this._image !== undefined && this._image.isDirty()) {\n                        this.applyImage(gl);\n                    }\n                } else if (this._textureNull) {\n                    gl.bindTexture(this._textureTarget, null);\n                } else {\n                    var image = this._image;\n                    if (image !== undefined) {\n                        // when data is ready we will upload it to the gpu\n                        if (image.isReady()) {\n                            // must be called before init\n                            this.computeTextureFormat();\n\n                            var imgWidth = image.getWidth() || this._textureWidth;\n                            var imgHeight = image.getHeight() || this._textureHeight;\n\n                            this.setTextureSize(imgWidth, imgHeight);\n\n                            if (!this._textureObject) {\n                                this.init(state);\n                            }\n\n                            this._textureObject.bind(gl);\n\n                            this.applyImage(gl);\n                            this.applyFilterParameter(gl, this._textureTarget);\n                            this.generateMipmap(gl, this._textureTarget);\n\n                            if (this._unrefImageDataAfterApply) {\n                                this._image = undefined;\n                            }\n\n                            this._dirty = false;\n                        } else {\n                            gl.bindTexture(this._textureTarget, null);\n                        }\n                    } else if (this._textureHeight !== 0 && this._textureWidth !== 0) {\n                        // must be called before init\n                        this.computeTextureFormat();\n\n                        if (!this._textureObject) {\n                            this.init(state);\n                        }\n                        this._textureObject.bind(gl);\n\n                        this.applyImage(gl);\n\n                        this.applyFilterParameter(gl, this._textureTarget);\n                        this.generateMipmap(gl, this._textureTarget);\n                        this._dirty = false;\n                    }\n                }\n            },\n\n            _getInternalFormatGL: function() {\n                var internalFormat = this._internalFormat;\n\n                // gl1\n                if (!__WEBPACK_IMPORTED_MODULE_7_osg_WebGLCaps__[\"a\" /* default */].instance().isWebGL2()) {\n                    return internalFormatGl2ToGl1[internalFormat] || internalFormat;\n                }\n\n                // gl2\n                var map = internalFormatGl1ToGl2[this._type];\n                return (map && map[internalFormat]) || internalFormat;\n            },\n\n            _getTypeGL: function() {\n                if (this._type === Texture.HALF_FLOAT && !__WEBPACK_IMPORTED_MODULE_7_osg_WebGLCaps__[\"a\" /* default */].instance().isWebGL2())\n                    return Texture.HALF_FLOAT_OES;\n                return this._type;\n            }\n        })\n    ),\n    'osg',\n    'Texture'\n);\n\nTexture.textureNull = new Texture();\n\nTexture.createFromImage = function(image, format) {\n    var a = new Texture();\n    a.setImage(image, format);\n    return a;\n};\n\nTexture.createFromCanvas = function(canvas, format) {\n    return Texture.createFromImage(canvas, format);\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Texture);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Texture.js\n// module id = 7\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Texture.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var primitiveSet = {};\nprimitiveSet.POINTS = 0x0000;\nprimitiveSet.LINES = 0x0001;\nprimitiveSet.LINE_LOOP = 0x0002;\nprimitiveSet.LINE_STRIP = 0x0003;\nprimitiveSet.TRIANGLES = 0x0004;\nprimitiveSet.TRIANGLE_STRIP = 0x0005;\nprimitiveSet.TRIANGLE_FAN = 0x0006;\n\n/* harmony default export */ __webpack_exports__["a"] = (primitiveSet);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/primitiveSet.js\n// module id = 8\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/primitiveSet.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_BoundingSphere__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_PooledResource__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_computeMatrixFromNodePath__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_transformEnums__ = __webpack_require__(12);\n\n\n\n\n\n\n\n\n\n\n\n/**\n *  Node that can contains child node\n *  @class Node\n */\nvar Node = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n\n    this.children = [];\n    this._parents = [];\n    /*jshint bitwise: false */\n    this.nodeMask = ~0;\n    /*jshint bitwise: true */\n\n    this._boundingSphere = new __WEBPACK_IMPORTED_MODULE_3_osg_BoundingSphere__["a" /* default */]();\n    this._boundingSphereComputed = false;\n\n    this._boundingBox = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n    this._boundingBoxComputed = false;\n\n    this._updateCallbacks = [];\n    this._cullCallback = undefined;\n    this._cullingActive = true;\n    this._numChildrenWithCullingDisabled = 0;\n    this._numChildrenRequiringUpdateTraversal = 0;\n\n    // it\'s a tmp object for internal use, do not use\n    this._tmpBox = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n\n    // $$ SOURCE_CODE_MODIFIED\n    // User callbacks to allow users to override the default computation of bounding volumes\n    this._computeBoundingBoxCallback = undefined;\n    this._computeBoundingSphereCallback = undefined;\n    // $$ SOURCE_CODE_MODIFIED\n};\n\nvar pooledMatrix = new __WEBPACK_IMPORTED_MODULE_7_osg_PooledResource__["a" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create);\nvar nodeGetMat = function() {\n    var matrix = pooledMatrix.getOrCreateObject();\n    return __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].identity(matrix);\n};\n\n/** @lends Node.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Node,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        /**\n      Return StateSet and create it if it does not exist yet\n      @type StateSet\n   */\n        getOrCreateStateSet: function() {\n            if (!this.stateset) this.setStateSet(new __WEBPACK_IMPORTED_MODULE_4_osg_StateSet__["a" /* default */]());\n            return this.stateset;\n        },\n\n        getStateSet: function() {\n            return this.stateset;\n        },\n\n        accept: function(nv) {\n            if (nv.validNodeMask(this)) {\n                nv.pushOntoNodePath(this);\n                nv.apply(this);\n                nv.popFromNodePath();\n            }\n        },\n\n        dirtyBound: function() {\n            if (this._boundingSphereComputed === true || this._boundingBoxComputed === true) {\n                this._boundingSphereComputed = false;\n                this._boundingBoxComputed = false;\n                var parents = this._parents;\n                for (var i = 0, l = parents.length; i < l; i++) {\n                    parents[i].dirtyBound();\n                }\n            }\n        },\n\n        setNodeMask: function(mask) {\n            this.nodeMask = mask;\n        },\n\n        getNodeMask: function() {\n            return this.nodeMask;\n        },\n\n        setStateSet: function(stateSet) {\n            if (this.stateset === stateSet) return;\n\n            var deltaUpdate = 0;\n\n            if (this.stateset) {\n                if (this.stateset.requiresUpdateTraversal()) deltaUpdate--;\n                this.stateset.removeParent(this);\n            }\n\n            if (stateSet) {\n                stateSet.addParent(this);\n                if (stateSet.requiresUpdateTraversal()) ++deltaUpdate;\n            }\n\n            if (deltaUpdate !== 0)\n                this.setNumChildrenRequiringUpdateTraversal(\n                    this.getNumChildrenRequiringUpdateTraversal() + deltaUpdate\n                );\n\n            this.stateset = stateSet;\n        },\n\n        _updateNumChildrenRequeringUpdateTraversal: function(delta) {\n            if (this._numChildrenRequiringUpdateTraversal === 0 && this._parents.length) {\n                // the number of callbacks has changed, need to pass this\n                // on to parents so they know whether app traversal is\n                // required on this subgraph.\n                for (var i = 0, l = this._parents.length; i < l; i++) {\n                    var parent = this._parents[i];\n                    var num = parent.getNumChildrenRequiringUpdateTraversal();\n                    parent.setNumChildrenRequiringUpdateTraversal(num + delta);\n                }\n            }\n        },\n\n        setNumChildrenRequiringUpdateTraversal: function(num) {\n            // if no changes just return.\n            if (this._numChildrenRequiringUpdateTraversal === num) return;\n\n            // note, if _updateCallback is set then the\n            // parents won\'t be affected by any changes to\n            // _numChildrenRequiringUpdateTraversal so no need to inform them.\n            if (!this._updateCallbacks.length && this._parents.length) {\n                // need to pass on changes to parents.\n                var delta = 0;\n                if (this._numChildrenRequiringUpdateTraversal > 0) --delta;\n                if (num > 0) ++delta;\n\n                if (delta !== 0) {\n                    // the number of callbacks has changed, need to pass this\n                    // on to parents so they know whether app traversal is\n                    // required on this subgraph.\n                    var parents = this._parents;\n                    for (var i = 0, l = parents.length; i < l; i++) {\n                        var parent = parents[i];\n                        var parentNum = parent.getNumChildrenRequiringUpdateTraversal();\n                        parent.setNumChildrenRequiringUpdateTraversal(parentNum + delta);\n                    }\n                }\n            }\n\n            // finally update this objects value.\n            this._numChildrenRequiringUpdateTraversal = num;\n        },\n\n        getNumChildrenRequiringUpdateTraversal: function() {\n            return this._numChildrenRequiringUpdateTraversal;\n        },\n\n        /** Get update node callback, called during update traversal.\n      @type Oject\n   */\n        getUpdateCallback: function() {\n            return this._updateCallbacks[0];\n        },\n\n        addUpdateCallback: function(cb) {\n            var hasExistingCallback = Boolean(this._updateCallbacks.length);\n            this._updateCallbacks.push(cb);\n\n            // send the signal on first add\n            if (!hasExistingCallback) this._updateNumChildrenRequeringUpdateTraversal(1);\n        },\n\n        removeUpdateCallback: function(cb) {\n            var arrayIdx = this._updateCallbacks.indexOf(cb);\n            if (arrayIdx === -1) return;\n            this._updateCallbacks.splice(arrayIdx, 1);\n\n            // send the signal when no more callback\n            if (!this._updateCallbacks.length) this._updateNumChildrenRequeringUpdateTraversal(-1);\n        },\n        getUpdateCallbackList: function() {\n            return this._updateCallbacks;\n        },\n\n        /**\n     <p>\n      Set cull node callback, called during cull traversal.\n      The Object must have the following method\n      cull(node, nodeVisitor) {}\n      note, callback is responsible for scenegraph traversal so\n      they must return true to traverse.\n      </p>\n      <p>\n      Here a dummy CullCallback example\n      </p>\n      @example\n      var DummyCullCallback = function() {};\n      DummyCullCallback.prototype = {\n          cull: function(node, nodeVisitor) {\n              return true;\n          }\n      };\n\n      @param Oject callback\n   */\n        setCullCallback: function(cb) {\n            this._cullCallback = cb;\n        },\n        getCullCallback: function() {\n            return this._cullCallback;\n        },\n\n        hasChild: function(child) {\n            for (var i = 0, l = this.children.length; i < l; i++) {\n                if (this.children[i] === child) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        addChild: function(child) {\n            if (this.children.indexOf(child) !== -1) return undefined;\n\n            this.children.push(child);\n            child.addParent(this);\n            this.dirtyBound();\n\n            // could now require app traversal thanks to the new subgraph,\n            // so need to check and update if required.\n            if (\n                child.getNumChildrenRequiringUpdateTraversal() > 0 ||\n                child.getUpdateCallbackList().length\n            ) {\n                this.setNumChildrenRequiringUpdateTraversal(\n                    this.getNumChildrenRequiringUpdateTraversal() + 1\n                );\n            }\n\n            // We need to check if culling is active in the child\n            if (\n                child.getNumChildrenWithCullingDisabled() > 0 ||\n                child.getCullingActive() === false\n            ) {\n                this.setNumChildrenWithCullingDisabled(\n                    this.getNumChildrenWithCullingDisabled() + 1\n                );\n            }\n\n            return child;\n        },\n\n        getChildren: function() {\n            return this.children;\n        },\n        getNumChildren: function() {\n            return this.children.length;\n        },\n        getChild: function(num) {\n            return this.children[num];\n        },\n        getParents: function() {\n            return this._parents;\n        },\n\n        addParent: function(parent) {\n            this._parents.push(parent);\n        },\n\n        removeParent: function(parent) {\n            var idx = this._parents.indexOf(parent);\n            if (idx === -1) return;\n            this._parents.splice(idx, 1);\n        },\n\n        removeChildren: function() {\n            var children = this.children;\n            var nbChildren = children.length;\n            if (!nbChildren) return;\n\n            var updateCallbackRemoved = 0;\n\n            for (var i = 0; i < nbChildren; i++) {\n                var child = children[i];\n                child.removeParent(this);\n                if (\n                    child.getNumChildrenRequiringUpdateTraversal() > 0 ||\n                    child.getUpdateCallbackList().length\n                )\n                    ++updateCallbackRemoved;\n            }\n\n            children.length = 0;\n            if (updateCallbackRemoved)\n                this.setNumChildrenRequiringUpdateTraversal(\n                    this.getNumChildrenRequiringUpdateTraversal() - updateCallbackRemoved\n                );\n\n            this.dirtyBound();\n        },\n\n        // preserve order\n        removeChild: function(child) {\n            var children = this.children;\n            var id = children.indexOf(child);\n            if (id === -1) return;\n\n            child.removeParent(this);\n            children.splice(id, 1);\n            this.dirtyBound();\n\n            if (\n                child.getNumChildrenRequiringUpdateTraversal() > 0 ||\n                child.getUpdateCallbackList().length\n            )\n                this.setNumChildrenRequiringUpdateTraversal(\n                    this.getNumChildrenRequiringUpdateTraversal() - 1\n                );\n        },\n\n        traverse: function(visitor) {\n            var children = this.children;\n            for (var i = 0, l = children.length; i < l; i++) {\n                var child = children[i];\n                child.accept(visitor);\n            }\n        },\n\n        ascend: function(visitor) {\n            var parents = this._parents;\n            for (var i = 0, l = parents.length; i < l; i++) {\n                var parent = parents[i];\n                parent.accept(visitor);\n            }\n        },\n\n        getBoundingBox: function() {\n            if (!this._boundingBoxComputed) {\n                this.computeBoundingBox(this._boundingBox);\n                this._boundingBoxComputed = true;\n            }\n            return this._boundingBox;\n        },\n\n        // $$ SOURCE_CODE_MODIFIED\n        setComputeBoundingBoxCallback: function ( callback ) {\n            this._computeBoundingBoxCallback = callback;\n        },\n        getComputeBoundingBoxCallback: function () {\n            return this._computeBoundingBoxCallback;\n        },\n        // $$ SOURCE_CODE_MODIFIED\n        computeBoundingBox: function(bbox) {\n            // $$ SOURCE_CODE_MODIFIED\n            if ( this._computeBoundingBoxCallback !== undefined ) {\n                return this._computeBoundingBoxCallback( bbox );\n            }\n            // $$ SOURCE_CODE_MODIFIED\n\n            // circular dependency... not sure if the global visitor instance should be instancied here\n            var ComputeBoundsVisitor = __webpack_require__(58).default;\n            var cbv = (ComputeBoundsVisitor.instance =\n                ComputeBoundsVisitor.instance || new ComputeBoundsVisitor());\n            cbv.setNodeMaskOverride(~0x0); // traverse everything to be consistent with computeBoundingSphere\n            cbv.reset();\n\n            cbv.apply(this);\n            bbox.copy(cbv.getBoundingBox());\n            return bbox;\n        },\n\n        getBoundingSphere: function() {\n            return this.getBound();\n        },\n\n        getBound: function() {\n            if (!this._boundingSphereComputed) {\n                this.computeBoundingSphere(this._boundingSphere);\n                this._boundingSphereComputed = true;\n            }\n            return this._boundingSphere;\n        },\n\n        // $$ SOURCE_CODE_MODIFIED\n        setComputeBoundingSphereCallback: function ( callback ) {\n            this._computeBoundingSphereCallback = callback;\n        },\n        getComputeBoundingSphereCallback: function () {\n            return this._computeBoundingSphereCallback;\n        },\n        // $$ SOURCE_CODE_MODIFIED\n        computeBoundingSphere: function(bSphere) {\n            // $$ SOURCE_CODE_MODIFIED\n            if ( this._computeBoundingSphereCallback !== undefined ) {\n                return this._computeBoundingSphereCallback( bSphere );\n            }\n            // $$ SOURCE_CODE_MODIFIED\n\n            var children = this.children;\n            var l = children.length;\n\n            bSphere.init();\n            if (l === 0) return bSphere;\n\n            var cc, i;\n            var bb = this._tmpBox;\n            bb.init();\n            for (i = 0; i < l; i++) {\n                cc = children[i];\n                if (cc.referenceFrame !== __WEBPACK_IMPORTED_MODULE_9_osg_transformEnums__["a" /* default */].ABSOLUTE_RF) {\n                    bb.expandByBoundingSphere(cc.getBound());\n                }\n            }\n            if (!bb.valid()) return bSphere;\n\n            bSphere.set(bb.center(bSphere.center()), 0.0);\n            for (i = 0; i < l; i++) {\n                cc = children[i];\n                if (cc.referenceFrame !== __WEBPACK_IMPORTED_MODULE_9_osg_transformEnums__["a" /* default */].ABSOLUTE_RF) {\n                    bSphere.expandRadiusBySphere(cc.getBound());\n                }\n            }\n            return bSphere;\n        },\n\n        // matrixCreate allow user handling of garbage collection of matrices\n        getWorldMatrices: (function() {\n            var CollectParentPaths = function() {\n                this.nodePaths = [];\n                this.halt = undefined;\n                __WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__["a" /* default */].TRAVERSE_PARENTS);\n            };\n            CollectParentPaths.prototype = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__["a" /* default */].prototype, {\n                reset: function() {\n                    this.nodePath.length = 0;\n                    this.nodePaths.length = 0;\n                },\n                apply: function(node) {\n                    if (\n                        node._parents.length === 0 ||\n                        node === this.halt ||\n                        node.referenceFrame === __WEBPACK_IMPORTED_MODULE_9_osg_transformEnums__["a" /* default */].ABSOLUTE_RF\n                    ) {\n                        // copy\n                        this.nodePaths.push(this.nodePath.slice(0));\n                    } else {\n                        this.traverse(node);\n                    }\n                }\n            });\n            var collected = new CollectParentPaths();\n            collected.setNodeMaskOverride(~0x0); // traverse everything\n\n            return function computeLocalToWorldList(halt, matrixCreate) {\n                collected.reset();\n                collected.halt = halt;\n\n                this.accept(collected);\n                var matrixList = [];\n\n                var matrixGenerator = matrixCreate || __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create;\n                for (var i = 0, l = collected.nodePaths.length; i < l; i++) {\n                    var np = collected.nodePaths[i];\n                    var m = matrixGenerator();\n                    if (np.length !== 0) {\n                        __WEBPACK_IMPORTED_MODULE_8_osg_computeMatrixFromNodePath__["a" /* default */].computeLocalToWorld(np, true, m);\n                    }\n                    matrixList.push(m);\n                }\n\n                return matrixList;\n            };\n        })(),\n\n        // same as getWorldMatrices GC: Perf WIN\n        getWorldMatrix: function(halt, matrix) {\n            // pass allocator on master\n            var matrixList = this.getWorldMatrices(halt, nodeGetMat);\n\n            if (matrixList.length === 0) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].identity(matrix);\n            } else {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].copy(matrix, matrixList[0]);\n            }\n\n            pooledMatrix.reset();\n            return matrix;\n        },\n\n        setCullingActive: function(value) {\n            if (this._cullingActive === value) return;\n            if (this._numChildrenWithCullingDisabled === 0 && this._parents.length > 0) {\n                var delta = 0;\n                if (!this._cullingActive) --delta;\n                if (!value) ++delta;\n                if (delta !== 0) {\n                    for (var i = 0, k = this._parents.length; i < k; i++) {\n                        this._parents[i].setNumChildrenWithCullingDisabled(\n                            this._parents[i].getNumChildrenWithCullingDisabled() + delta\n                        );\n                    }\n                }\n            }\n            this._cullingActive = value;\n        },\n\n        getCullingActive: function() {\n            return this._cullingActive;\n        },\n\n        isCullingActive: function() {\n            return (\n                this._numChildrenWithCullingDisabled === 0 &&\n                this._cullingActive &&\n                this.getBound().valid()\n            );\n        },\n\n        setNumChildrenWithCullingDisabled: function(num) {\n            if (this._numChildrenWithCullingDisabled === num) return;\n            if (this._cullingActive && this._parents.length > 0) {\n                var delta = 0;\n                if (this._numChildrenWithCullingDisabled > 0) --delta;\n                if (num > 0) ++delta;\n                if (delta !== 0) {\n                    for (var i = 0, k = this._parents.length; i < k; i++) {\n                        this._parents[i].setNumChildrenWithCullingDisabled(\n                            this._parents[i].getNumChildrenWithCullingDisabled() + delta\n                        );\n                    }\n                }\n            }\n            this._numChildrenWithCullingDisabled = num;\n        },\n\n        getNumChildrenWithCullingDisabled: function() {\n            return this._numChildrenWithCullingDisabled;\n        },\n\n        releaseGLObjects: function() {\n            if (this.stateset !== undefined) this.stateset.releaseGLObjects();\n        }\n    }),\n    \'osg\',\n    \'Node\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Node);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Node.js\n// module id = 9\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Node.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_WebGLCaps__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_BufferArrayProxy__ = __webpack_require__(76);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_VertexArrayObject__ = __webpack_require__(59);\n\n\n\n\n\n\n\n/**\n * Geometry manage array and primitives to draw a geometry.\n * @class Geometry\n */\n\nvar Geometry = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Node__[\"a\" /* default */].call(this);\n\n    this._attributes = {};\n    this._primitives = [];\n\n    // function is generated for each Shader Program ID\n    // which generates a a special \"draw\"\n    // TODO: could be upon hash of combination of attributes\n    // (as multiple shader Programs can use same combination of attributes)\n    this._cacheDrawCall = {};\n\n    // VAO cached data, per combination of vertex buffer\n    // program id also the cache key\n    this._useVAO = undefined;\n    this._vao = {};\n    this._cacheVertexAttributeBufferList = {};\n\n    // null means the kdTree builder will skip the kdTree creation\n    this._shape = undefined;\n\n    // $$ SOURCE_CODE_MODIFIED\n    // for instanced arrays // DrawElementsInstanced DrawArraysInstanced\n    this._instancedArrayMap = undefined;\n    // $$ SOURCE_CODE_MODIFIED\n};\n\nGeometry.enableVAO = true;\n\n/** @lends Geometry.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeNode(\n    Geometry,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Node__[\"a\" /* default */].prototype, {\n        releaseGLObjects: function() {\n            if (this.stateset !== undefined) this.stateset.releaseGLObjects();\n\n            for (var keyAttribute in this._attributes) {\n                var value = this._attributes[keyAttribute];\n                value.releaseGLObjects();\n            }\n\n            for (var i = 0, h = this._primitives.length; i < h; i++) {\n                var prim = this._primitives[i];\n                if (prim.getIndices !== undefined) {\n                    if (prim.getIndices() !== undefined && prim.getIndices() !== null) {\n                        prim.indices.releaseGLObjects();\n                    }\n                }\n            }\n\n            this.releaseVAO();\n        },\n\n        releaseVAO: function() {\n            if (!this._useVAO || !this._glContext) return;\n\n            for (var prgID in this._vao) {\n                if (this._vao[prgID]) {\n                    this._vao[prgID].releaseGLObjects();\n                    this._vao[prgID] = undefined;\n                }\n            }\n        },\n\n        dirty: function() {\n            this._cacheDrawCall = {};\n            this.releaseVAO();\n        },\n\n        getPrimitives: function() {\n            // Notify.warn( 'deprecated use instead getPrimitiveSetList' );\n            return this.getPrimitiveSetList();\n        },\n\n        getAttributes: function() {\n            // Notify.warn( 'deprecated use instead getVertexAttributeList' );\n            return this.getVertexAttributeList();\n        },\n\n        getShape: function() {\n            return this._shape;\n        },\n\n        setShape: function(shape) {\n            this._shape = shape;\n        },\n\n        getVertexAttributeList: function() {\n            return this._attributes;\n        },\n\n        /**\n         * Return the primitiveset list\n         * If you modify something inside this array\n         * you must call dirty() on the Geometry\n         */\n        getPrimitiveSetList: function() {\n            return this._primitives;\n        },\n\n        /**\n         * Set the buffer array on the attribute name key\n         * key is often something like Vertex, Normal, Color, ...\n         * for classic geometry\n         *\n         * if you change a buffer a dirty will be automatically\n         * called to rebuild the VAO if needed.\n         */\n        setVertexAttribArray: function(key, array) {\n            if (this._attributes[key] !== array) {\n                this._attributes[key] = array;\n                this.dirty();\n            }\n        },\n\n        // $$ SOURCE_CODE_MODIFIED\n        /**\n         * Adds the attributeDivisor to an existing attribArray.\n         */\n        setAttribArrayDivisor: function ( attributeName, divisor ) {\n            if ( this._attributes[ attributeName ] === undefined ) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].error( 'Attribute' + attributeName + 'does not exist.' );\n                return;\n            }\n            if ( this._instancedArrayMap === undefined )\n                this._instancedArrayMap = new window.Map();\n            this._instancedArrayMap.set( attributeName, divisor );\n        },\n        // $$ SOURCE_CODE_MODIFIED\n\n        _generateVertexSetup: function(\n            validAttributeKeyList,\n            validAttributeIndexList,\n            includeFirstIndexBuffer\n        ) {\n            // generate setup for vertex attribute\n            // will be used as setup for vao or as is without vao\n            var vertexAttributeSetup = [\n                '//generated by Geometry::implementation',\n                'state.lazyDisablingOfVertexAttributes();',\n                'var attr;'\n            ];\n\n            for (var i = 0, l = validAttributeKeyList.length; i < l; i++) {\n                vertexAttributeSetup.push(\n                    \"attr = this._attributes['\" + validAttributeKeyList[i] + \"'];\"\n                );\n                vertexAttributeSetup.push(\n                    'if ( attr.BufferArrayProxy ) attr = attr.getBufferArray();'\n                );\n                vertexAttributeSetup.push('if ( !attr.isValid() ) return;');\n\n                // $$ SOURCE_CODE_MODIFIED\n                // Check if the attribute is instanced\n                var divisor = undefined;\n                if ( this._instancedArrayMap && this._instancedArrayMap.has( validAttributeKeyList[ i ] ) ) {\n                    divisor = this._instancedArrayMap.get( validAttributeKeyList[ i ] );\n                }\n                else if ( this._attributes[validAttributeKeyList[ i ]].getAttributeDivisor ) {\n                    divisor = this._attributes[validAttributeKeyList[ i ]].getAttributeDivisor();\n                }\n                else {\n                    divisor = undefined;\n                }\n                // if( 0 === divisor ) {\n                //  divisor = undefined;\n                // }\n                vertexAttributeSetup.push(\n                    'state.setVertexAttribArray(' +\n                        validAttributeIndexList[i] +\n                        // ', attr, attr.getNormalize() );'\n                        ', attr, attr.getNormalize(), ' + divisor + ');'\n                );\n                // $$ SOURCE_CODE_MODIFIED\n            }\n\n            vertexAttributeSetup.push('state.applyDisablingOfVertexAttributes();');\n\n            if (includeFirstIndexBuffer)\n                vertexAttributeSetup.push(\n                    'state.setIndexArray( this._primitives[ 0 ].getIndices() );'\n                );\n\n            return vertexAttributeSetup;\n        },\n\n        _generatePrimitives: function(validPrimitives, hasVertexColor, optimizeVAO) {\n            var primitiveSetup = [\n                hasVertexColor ? 'state.enableVertexColor();' : 'state.disableVertexColor();'\n            ];\n            if (optimizeVAO) {\n                return primitiveSetup.concat([\n                    'var primitive = this._primitives[ ' + validPrimitives[0] + ' ];',\n                    'var indexes = primitive.getIndices();',\n                    'if ( indexes.isDirty() ) {;',\n                    '  indexes.bind( gl );',\n                    '  indexes.compile( gl );',\n                    '};',\n                    'primitive.drawElements( state );'\n                ]);\n            }\n\n            primitiveSetup.push('var primitives = this._primitives;');\n            for (var j = 0, m = validPrimitives.length; j < m; j++) {\n                primitiveSetup.push('primitives[' + validPrimitives[j] + '].draw(state);');\n            }\n\n            return primitiveSetup;\n        },\n\n        /**\n         *  Generate a function specific to the Geometry/Program\n         *  two version one using VAO and a regular one\n         */\n        generateDrawCommand: (function() {\n            var validAttributeList = [];\n            var validAttributeKeyList = [];\n\n            return function(state, program, prgID, validPrimitives) {\n                var attributesCacheMap = program._attributesCache;\n                var geometryVertexAttributes = this.getVertexAttributeList();\n\n                validAttributeKeyList.length = 0;\n                validAttributeList.length = 0;\n\n                // 1 - register valid vertex attributes and color flag\n\n                var attribute, j, m, attr;\n\n                var useVAO = this._useVAO;\n                var listVABuff = useVAO ? [] : undefined;\n\n                var hasVertexColor = false;\n\n                for (var key in attributesCacheMap) {\n                    attribute = attributesCacheMap[key];\n                    attr = geometryVertexAttributes[key];\n\n                    if (attr === undefined) continue;\n\n                    var attributeBuffer = this._attributes[key];\n\n                    // dont use VAO if we have BufferArrayProxy\n                    // typically used for morphing\n                    if (attributeBuffer instanceof __WEBPACK_IMPORTED_MODULE_5_osg_BufferArrayProxy__[\"a\" /* default */]) {\n                        attributeBuffer = attributeBuffer.getBufferArray();\n                        useVAO = false;\n                    }\n\n                    if (!attributeBuffer.isValid()) return undefined;\n\n                    // store for later usage at draw time/update\n                    if (useVAO) listVABuff.push(attributeBuffer);\n\n                    if (!hasVertexColor && key === 'Color') hasVertexColor = true;\n\n                    validAttributeKeyList.push(key);\n                    validAttributeList.push(attribute);\n                }\n\n                var autogeneratedFunction;\n                var functionName;\n\n                // generate specific function using VAO or standard\n                if (useVAO) {\n                    this._cacheVertexAttributeBufferList[prgID] = listVABuff;\n\n                    // if there is only one drawElement we can put the index buffer\n                    // in the vao\n                    var optimizeIndexBufferVAO =\n                        validPrimitives.length === 1 &&\n                        this._primitives[validPrimitives[0]] instanceof __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__[\"a\" /* default */];\n\n                    var vertexAttributeSetup = this._generateVertexSetup(\n                        validAttributeKeyList,\n                        validAttributeList,\n                        optimizeIndexBufferVAO\n                    );\n\n                    state.clearVertexAttribCache();\n\n                    var gl = state.getGraphicContext();\n                    var vao = new __WEBPACK_IMPORTED_MODULE_6_osg_VertexArrayObject__[\"a\" /* default */](gl);\n                    vao.create(gl);\n                    state.setVertexArrayObject(vao);\n                    this._vao[prgID] = vao;\n\n                    // evaluate the vertexAttribute setup to register into the vao\n                    /*jshint evil: true */\n                    var vertexSetupCommand = new Function('state', vertexAttributeSetup.join('\\n'));\n                    /*jshint evil: false */\n                    vertexSetupCommand.call(this, state);\n\n                    // setup the program\n                    var vaoSetup = [\n                        'var gl = state.getGraphicContext();',\n                        'var vao = this._vao[ ' + prgID + ' ]; ',\n                        'var hasChanged = state.setVertexArrayObject( vao );',\n                        'if ( hasChanged ) {',\n                        '  var vaList = this._cacheVertexAttributeBufferList[ ' + prgID + ' ];',\n                        '  var va;'\n                    ];\n                    for (j = 0, m = listVABuff.length; j < m; j++) {\n                        vaoSetup.push('  va = vaList[ ' + j + '];');\n                        vaoSetup.push('  if ( va.isDirty() ) {');\n                        vaoSetup.push('    va.bind( gl );');\n                        vaoSetup.push('    va.compile( gl );');\n                        vaoSetup.push('  }');\n                    }\n                    vaoSetup.push('}');\n\n                    autogeneratedFunction = vaoSetup\n                        .concat(\n                            this._generatePrimitives(\n                                validPrimitives,\n                                hasVertexColor,\n                                optimizeIndexBufferVAO\n                            )\n                        )\n                        .join('\\n');\n                    functionName = 'GeometryDrawImplementationCacheVAO';\n                } else {\n                    autogeneratedFunction = this._generateVertexSetup(\n                        validAttributeKeyList,\n                        validAttributeList,\n                        false\n                    )\n                        .concat(this._generatePrimitives(validPrimitives, hasVertexColor, false))\n                        .join('\\n');\n                    functionName = 'GeometryDrawImplementationCache';\n                }\n\n                /*jshint evil: true */\n                // name the function\n                // http://stackoverflow.com/questions/5905492/dynamic-function-name-in-javascript\n                var drawCommand = new Function(\n                    'state',\n                    'return function ' + functionName + '( state ) { ' + autogeneratedFunction + '}'\n                )();\n                /*jshint evil: false */\n\n                this._cacheDrawCall[prgID] = drawCommand;\n                return drawCommand;\n            };\n        })(),\n\n        _getValidPrimitives: function() {\n            var validPrimitives = [];\n\n            for (var i = 0; i < this._primitives.length; i++) {\n                var primitive = this._primitives[i];\n                if (!primitive.getCount()) {\n                    if (!this._warnInvalidPrimitives) {\n                        __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].warn(\n                            'geometry with instanceID ' +\n                                this._instanceID +\n                                ' has invalid primitives'\n                        );\n                        this._warnInvalidPrimitives = true;\n                    }\n                    continue;\n                }\n                validPrimitives.push(i);\n            }\n\n            return validPrimitives;\n        },\n\n        drawImplementation: function(state) {\n            var program = state.getLastProgramApplied();\n            var prgID = program.getInstanceID();\n\n            state.drawGeometry(this);\n            var cachedDraw = this._cacheDrawCall[prgID];\n\n            if (!this._vao[prgID]) {\n                state.setVertexArrayObject(null);\n            } else {\n                if (this._vao[prgID].isDirty()) {\n                    // need vertex array recreation\n                    // ie: lost context\n                    cachedDraw = undefined;\n                }\n            }\n\n            if (cachedDraw) {\n                cachedDraw.call(this, state);\n                return;\n            }\n\n            if (!this._primitives.length) {\n                if (!this._warnNoPrimitives) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].warn(\n                        'geometry with instanceID ' + this._instanceID + ' has no primitives'\n                    );\n                    this._warnNoPrimitives = true;\n                }\n                return;\n            }\n\n            var validPrimitives = this._getValidPrimitives();\n            if (!validPrimitives.length) return;\n\n            // generate cachedDraw\n            if (this._useVAO === undefined && Geometry.enableVAO) {\n                // will be null if not supported\n                this._useVAO = __WEBPACK_IMPORTED_MODULE_3_osg_WebGLCaps__[\"a\" /* default */].instance().hasVAO();\n                this._glContext = state.getGraphicContext();\n            }\n\n            cachedDraw = this.generateDrawCommand(state, program, prgID, validPrimitives);\n            cachedDraw.call(this, state);\n            state.setVertexArrayObject(null);\n        },\n\n        setBound: function(bb) {\n            this._boundingBox = bb;\n            this._boundingBoxComputed = true;\n        },\n\n        computeBoundingBox: function(boundingBox) {\n            // $$ SOURCE_CODE_MODIFIED\n            if ( this._computeBoundingBoxCallback !== undefined ) {\n                return this._computeBoundingBoxCallback( boundingBox );\n            }\n            // $$ SOURCE_CODE_MODIFIED\n\n            boundingBox.init();\n\n            var vertexArray = this.getVertexAttributeList().Vertex;\n            if (vertexArray && vertexArray.getElements() && vertexArray.getItemSize() > 2) {\n                var vertexes = vertexArray.getElements();\n                var itemSize = vertexArray.getItemSize();\n\n                var min = boundingBox.getMin();\n                var max = boundingBox.getMax();\n\n                var minx = min[0];\n                var miny = min[1];\n                var minz = min[2];\n                var maxx = max[0];\n                var maxy = max[1];\n                var maxz = max[2];\n\n                // if the box is un-initialized min=Inf and max=-Inf\n                // we can't simply write if(x > min) [...] else (x < max) [...]\n                // most of the time the else condition is run so it's a kinda useless\n                // optimization anyway\n                for (var idx = 0, l = vertexes.length; idx < l; idx += itemSize) {\n                    var v1 = vertexes[idx];\n                    var v2 = vertexes[idx + 1];\n                    var v3 = vertexes[idx + 2];\n                    if (v1 < minx) minx = v1;\n                    if (v1 > maxx) maxx = v1;\n                    if (v2 < miny) miny = v2;\n                    if (v2 > maxy) maxy = v2;\n                    if (v3 < minz) minz = v3;\n                    if (v3 > maxz) maxz = v3;\n                }\n\n                min[0] = minx;\n                min[1] = miny;\n                min[2] = minz;\n                max[0] = maxx;\n                max[1] = maxy;\n                max[2] = maxz;\n            }\n\n            return boundingBox;\n        },\n\n        computeBoundingSphere: function(boundingSphere) {\n            // $$ SOURCE_CODE_MODIFIED\n            if ( this._computeBoundingSphereCallback !== undefined ) {\n                return this._computeBoundingSphereCallback( boundingSphere );\n            }\n            // $$ SOURCE_CODE_MODIFIED\n\n            boundingSphere.init();\n            var bb = this.getBoundingBox();\n            boundingSphere.expandByBoundingBox(bb);\n            return boundingSphere;\n        }\n    }),\n    'osg',\n    'Geometry'\n);\n\nGeometry.appendVertexAttributeToList = function(from, to, postfix) {\n    for (var key in from) {\n        var keyPostFix = key;\n        if (postfix !== undefined) keyPostFix += '_' + postfix;\n\n        to[keyPostFix] = from[key];\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Geometry);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Geometry.js\n// module id = 10\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Geometry.js?")},function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n//////////////////\n// WEBPACK FOOTER\n// external {"root":"P","commonjs2":"bluebird","commonjs":"bluebird","amd":"bluebird"}\n// module id = 11\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%7B%22root%22:%22P%22,%22commonjs2%22:%22bluebird%22,%22commonjs%22:%22bluebird%22,%22amd%22:%22bluebird%22%7D?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony default export */ __webpack_exports__["a"] = ({\n    RELATIVE_RF: 0,\n    ABSOLUTE_RF: 1\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/transformEnums.js\n// module id = 12\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/transformEnums.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Timer__ = __webpack_require__(22);\n\n\n\n\n\n\nvar getAttributeType = function(array) {\n    var type;\n\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Float32Array) type = 0x1406;\n\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Int16Array) type = 0x1402;\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Uint16Array) type = 0x1403;\n\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Int8Array) type = 0x1400;\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Uint8Array) type = 0x1401;\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Uint8ClampedArray) type = 0x1401;\n\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Int32Array) type = 0x1404; // webgl2 for vertexAttribPointer\n    if (array instanceof __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Uint32Array) type = 0x1405; // webgl2 for vertexAttribPointer\n\n    return type;\n};\n\n/**\n * BufferArray manage vertex / normal / ... array used by webgl.\n * osgjs automatically converts array buffers to Float32Array and\n * element array buffers to Uint16Array if not said explicitly with\n * preserveArrayType variable in constructor.\n * @class BufferArray\n */\n\nvar BufferArray = function(target, elements, itemSize) {\n    __WEBPACK_IMPORTED_MODULE_3_osg_GLObject__["a" /* default */].call(this);\n    // maybe could inherit from Object\n    this._instanceID = __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].getInstanceID();\n\n    this.dirty();\n\n    this._itemSize = itemSize;\n    this._target = typeof target === \'string\' ? BufferArray[target] : target;\n\n    // initialized by setElements\n    this._type = undefined;\n    this._normalize = false;\n\n    // $$ SOURCE_CODE_MODIFIED\n    // for instanced arrays // DrawElementsInstanced DrawArraysInstanced\n    this._divisor = undefined;\n    // $$ SOURCE_CODE_MODIFIED\n\n    if (elements) {\n        // byteLength should be enough to detect typedArray\n        if (elements.byteLength === undefined) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'BufferArray with non typedArray elements is deprecated\');\n            if (this._target === BufferArray.ELEMENT_ARRAY_BUFFER) {\n                elements = new __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Uint16Array(elements);\n            } else {\n                elements = new __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].Float32Array(elements);\n            }\n        }\n        this.setElements(elements);\n    }\n\n    this._usage = BufferArray.STATIC_DRAW;\n};\n\nBufferArray.ELEMENT_ARRAY_BUFFER = 0x8893;\nBufferArray.ARRAY_BUFFER = 0x8892;\nBufferArray.STATIC_DRAW = 0x88e4;\nBufferArray.DYNAMIC_DRAW = 0x88e8;\nBufferArray.STREAM_DRAW = 0x88e0;\n\n// static cache of glBuffers flagged for deletion, which will actually\n// be deleted in the correct GL context.\nBufferArray._sDeletedGLBufferArrayCache = new window.Map();\n\n// static method to delete Program\nBufferArray.deleteGLBufferArray = function(gl, buffer) {\n    if (!BufferArray._sDeletedGLBufferArrayCache.has(gl))\n        BufferArray._sDeletedGLBufferArrayCache.set(gl, []);\n    BufferArray._sDeletedGLBufferArrayCache.get(gl).push(buffer);\n};\n\n// static method to flush all the cached glPrograms which need to be deleted in the GL context specified\nBufferArray.flushDeletedGLBufferArrays = function(gl, availableTime) {\n    // if no time available don\'t try to flush objects.\n    if (availableTime <= 0.0) return availableTime;\n    if (!BufferArray._sDeletedGLBufferArrayCache.has(gl)) return availableTime;\n    var elapsedTime = 0.0;\n    var beginTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n    var deleteList = BufferArray._sDeletedGLBufferArrayCache.get(gl);\n    var numBuffers = deleteList.length;\n    for (var i = numBuffers - 1; i >= 0 && elapsedTime < availableTime; i--) {\n        gl.deleteBuffer(deleteList[i]);\n        deleteList.splice(i, 1);\n        elapsedTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n    }\n    return availableTime - elapsedTime;\n};\n\nBufferArray.flushAllDeletedGLBufferArrays = function(gl) {\n    if (!BufferArray._sDeletedGLBufferArrayCache.has(gl)) return;\n    var deleteList = BufferArray._sDeletedGLBufferArrayCache.get(gl);\n    var numBuffers = deleteList.length;\n    for (var i = numBuffers - 1; i >= 0; i--) {\n        gl.deleteBuffer(deleteList[i]);\n        deleteList.splice(i, 1);\n    }\n};\n\nBufferArray.onLostContext = function(gl) {\n    if (!BufferArray._sDeletedGLBufferArrayCache.has(gl)) return;\n    var deleteList = BufferArray._sDeletedGLBufferArrayCache.get(gl);\n    deleteList.length = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    BufferArray,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_GLObject__["a" /* default */].prototype, {\n        setUsage: function(usage) {\n            this._usage = usage;\n        },\n        getUsage: function() {\n            return this._usage;\n        },\n        getInstanceID: function() {\n            return this._instanceID;\n        },\n        setItemSize: function(size) {\n            this._itemSize = size;\n        },\n        isValid: function() {\n            if (this._buffer) return true;\n            if (this._elements && this._elements.length) return true;\n            return false;\n        },\n\n        invalidate: function() {\n            this._buffer = undefined;\n            this.dirty();\n        },\n\n        releaseGLObjects: function() {\n            if (this._buffer !== undefined && this._buffer !== null && this._gl !== undefined) {\n                BufferArray.deleteGLBufferArray(this._gl, this._buffer);\n                __WEBPACK_IMPORTED_MODULE_3_osg_GLObject__["a" /* default */].removeObject(this._gl, this);\n            }\n            this.invalidate();\n        },\n\n        setNormalize: function(normalize) {\n            this._normalize = normalize;\n        },\n\n        getNormalize: function() {\n            return this._normalize;\n        },\n\n        bind: function(gl) {\n            if (!this._gl) this.setGraphicContext(gl);\n            var target = this._target;\n            var buffer = this._buffer;\n\n            if (buffer) {\n                gl.bindBuffer(target, buffer);\n                return;\n            }\n\n            if (!buffer && this._elements.length > 0) {\n                this._buffer = gl.createBuffer();\n                this._numItems = this._elements.length / this._itemSize;\n                gl.bindBuffer(target, this._buffer);\n            }\n        },\n\n        // $$ SOURCE_CODE_MODIFIED\n        getAttributeDivisor: function() {\n            return this._divisor;\n        },\n        setAttributeDivisor: function(divisor) {\n            this._divisor = divisor;\n        },\n        // $$ SOURCE_CODE_MODIFIED\n\n        getItemSize: function() {\n            return this._itemSize;\n        },\n        dirty: function() {\n            this._dirty = true;\n        },\n        isDirty: function() {\n            return this._dirty;\n        },\n        compile: function(gl) {\n            if (this._dirty) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].timeStamp(\'osgjs.metrics:bufferData\');\n                gl.bufferData(this._target, this._elements, this._usage);\n                this._dirty = false;\n            }\n        },\n        getElements: function() {\n            return this._elements;\n        },\n        setElements: function(elements) {\n            this._elements = elements;\n            this._type = getAttributeType(elements);\n            this._dirty = true;\n        },\n        getType: function() {\n            return this._type;\n        }\n    }),\n    \'osg\',\n    \'BufferArray\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (BufferArray);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BufferArray.js\n// module id = 13\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BufferArray.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_CullSettings__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__ = __webpack_require__(12);\n\n\n\n\n\n\n\n\n/**\n * Camera - is a subclass of Transform which represents encapsulates the settings of a Camera.\n * @class Camera\n * @inherits Transform CullSettings\n */\nvar Camera = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Transform__["a" /* default */].call(this);\n    __WEBPACK_IMPORTED_MODULE_2_osg_CullSettings__["a" /* default */].call(this);\n\n    this.viewport = undefined;\n    this._graphicContext = undefined;\n    this._scissor = undefined;\n    this.setClearColor(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(0, 0, 0, 1.0));\n    this.setClearDepth(1.0);\n\n    /*jshint bitwise: false */\n    this.setClearMask(Camera.COLOR_BUFFER_BIT | Camera.DEPTH_BUFFER_BIT);\n    /*jshint bitwise: true */\n\n    this.setViewMatrix(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create());\n    this.setProjectionMatrix(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create());\n    this.renderOrder = Camera.NESTED_RENDER;\n    this.renderOrderNum = 0;\n\n    this._view = undefined;\n    this._renderer = undefined;\n    this._attachments = {};\n};\n\nCamera.PRE_RENDER = 0;\nCamera.NESTED_RENDER = 1;\nCamera.POST_RENDER = 2;\n\nCamera.COLOR_BUFFER_BIT = 0x00004000;\nCamera.DEPTH_BUFFER_BIT = 0x00000100;\nCamera.STENCIL_BUFFER_BIT = 0x00000400;\n\n/** @lends Camera.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Camera,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(\n        __WEBPACK_IMPORTED_MODULE_2_osg_CullSettings__["a" /* default */].prototype,\n        __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Transform__["a" /* default */].prototype, {\n            // at which view this camera is attached\n            getView: function() {\n                return this._view;\n            },\n\n            setView: function(view) {\n                this._view = view;\n            },\n\n            getRenderer: function() {\n                return this._renderer;\n            },\n\n            setRenderer: function(renderer) {\n                this._renderer = renderer;\n            },\n\n            // Set the final draw callback for custom operations\n            // to be done after the drawing of\n            // the camera\'s subgraph and pre render stages.\n            setFinalDrawCallback: function(cb) {\n                this._finalDrawCallback = cb;\n            },\n\n            getFinalDrawCallback: function() {\n                return this._finalDrawCallback;\n            },\n\n            // Set the initial draw callback for custom operations\n            // to be done before the drawing of\n            // the camera\'s subgraph and pre render stages.\n            setInitialDrawCallback: function(cb) {\n                this._initialDrawCallback = cb;\n            },\n\n            getInitialDrawCallback: function() {\n                return this._initialDrawCallback;\n            },\n\n            getAttachments: function() {\n                return this._attachments;\n            },\n\n            setGraphicContext: function(gc) {\n                this._graphicContext = gc;\n            },\n            getGraphicContext: function() {\n                return this._graphicContext;\n            },\n            setClearDepth: function(depth) {\n                this.clearDepth = depth;\n            },\n            getClearDepth: function() {\n                return this.clearDepth;\n            },\n\n            setClearMask: function(mask) {\n                this.clearMask = mask;\n            },\n            getClearMask: function() {\n                return this.clearMask;\n            },\n\n            setClearColor: function(color) {\n                this.clearColor = color;\n            },\n            getClearColor: function() {\n                return this.clearColor;\n            },\n\n            setViewport: function(vp) {\n                this.viewport = vp;\n                this.getOrCreateStateSet().setAttributeAndModes(vp);\n            },\n            getViewport: function() {\n                return this.viewport;\n            },\n\n            setScissor: function(scissor) {\n                this._scissor = scissor;\n                this.getOrCreateStateSet().setAttributeAndModes(this._scissor);\n            },\n            getScissor: function() {\n                return this._scissor;\n            },\n\n            setViewMatrix: function(matrix) {\n                this.modelviewMatrix = matrix;\n            },\n            setViewMatrixAsLookAt: function(eye, center, up) {\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].lookAt(this.getViewMatrix(), eye, center, up);\n            },\n            setProjectionMatrix: function(matrix) {\n                this.projectionMatrix = matrix;\n            },\n\n            /** Set to an orthographic projection. See OpenGL glOrtho for documentation further details.*/\n            setProjectionMatrixAsOrtho: function(left, right, bottom, top, zNear, zFar) {\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].ortho(this.getProjectionMatrix(), left, right, bottom, top, zNear, zFar);\n            },\n            isRenderToTextureCamera: function() {\n                return window.Object.keys(this._attachments).length > 0;\n            },\n\n            getViewMatrix: function() {\n                return this.modelviewMatrix;\n            },\n            getProjectionMatrix: function() {\n                return this.projectionMatrix;\n            },\n            getRenderOrder: function() {\n                return this.renderOrder;\n            },\n            setRenderOrder: function(order, orderNum) {\n                this.renderOrder = order;\n                this.renderOrderNum = orderNum;\n            },\n            getFrameBufferObject: function() {\n                return this.frameBufferObject;\n            },\n            setFrameBufferObject: function(fbo) {\n                this.frameBufferObject = fbo;\n            },\n            detachAll: function() {\n                this._attachments = {};\n\n                if (this.frameBufferObject) {\n                    this.frameBufferObject.dirty();\n                }\n            },\n\n            // TODO: fix in case of shared fbo\n            // TODO: fix adding a resize case\n            resetAttachments: function() {\n                if (this.frameBufferObject) {\n                    this.frameBufferObject.reset();\n                    // remove framebuffer\n                    this.frameBufferObject = 0;\n                }\n\n                // removes camera attachement\n                this._attachments = {};\n            },\n\n            attachTexture: function(bufferComponent, texture, textureTarget) {\n                if (this.frameBufferObject) {\n                    this.frameBufferObject.dirty();\n                }\n\n                // because before the argument was level and the spec says\n                // it must always be 0 ! is valid for 0 or undefined\n                if (!textureTarget) {\n                    textureTarget = __WEBPACK_IMPORTED_MODULE_4_osg_Texture__["default"].TEXTURE_2D;\n                }\n\n                this._attachments[bufferComponent] = {\n                    attachment: bufferComponent,\n                    texture: texture,\n                    textureTarget: textureTarget\n                };\n            },\n\n            attachRenderBuffer: function(bufferComponent, internalFormat) {\n                if (this.frameBufferObject) {\n                    this.frameBufferObject.dirty();\n                }\n                this._attachments[bufferComponent] = {\n                    format: internalFormat,\n                    attachment: bufferComponent\n                };\n            },\n\n            computeLocalToWorldMatrix: function(matrix /*,nodeVisitor*/) {\n                if (this.referenceFrame === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, matrix, this.modelviewMatrix);\n                } else {\n                    // absolute\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].copy(matrix, this.modelviewMatrix);\n                }\n                return true;\n            },\n\n            computeWorldToLocalMatrix: (function() {\n                var minverse = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n                return function(matrix /*, nodeVisitor */) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].invert(minverse, this.modelviewMatrix);\n                    if (this.referenceFrame === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, minverse, matrix);\n                    } else {\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].copy(matrix, minverse);\n                    }\n                    return true;\n                };\n            })()\n        })\n    ),\n    \'osg\',\n    \'Camera\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Camera);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Camera.js\n// module id = 14\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Camera.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_transformEnums__ = __webpack_require__(12);\n\n\n\n\n\n/**\n *  MatrixTransform is a Transform Node that can be customized with user matrix\n *  @class MatrixTransform\n */\nvar MatrixTransform = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Transform__["a" /* default */].call(this);\n    this.matrix = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n};\n\n/** @lends MatrixTransform.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    MatrixTransform,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Transform__["a" /* default */].prototype, {\n        getMatrix: function() {\n            return this.matrix;\n        },\n\n        setMatrix: function(m) {\n            this.matrix = m;\n            this.dirtyBound();\n        },\n\n        // local to "local world" (not Global World)\n        computeLocalToWorldMatrix: function(matrix /*, nodeVisitor */) {\n            if (this.referenceFrame === __WEBPACK_IMPORTED_MODULE_3_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].mul(matrix, matrix, this.matrix);\n            } else {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].copy(matrix, this.matrix);\n            }\n            return true;\n        },\n\n        computeWorldToLocalMatrix: (function() {\n            var minverse = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n            return function(matrix /*, nodeVisitor */) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(minverse, this.matrix);\n                if (this.referenceFrame === __WEBPACK_IMPORTED_MODULE_3_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].mul(matrix, minverse, matrix);\n                } else {\n                    // absolute\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].copy(matrix, minverse);\n                }\n                return true;\n            };\n        })()\n    }),\n    \'osg\',\n    \'MatrixTransform\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (MatrixTransform);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/MatrixTransform.js\n// module id = 15\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/MatrixTransform.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__ = __webpack_require__(8);\n\n\n/**\n * DrawElements manage rendering of indexed primitives\n * @class DrawElements\n */\nvar DrawElements = function(mode, indices) {\n    this.mode = __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].POINTS;\n    if (mode !== undefined) {\n        if (typeof mode === \'string\') {\n            mode = __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */][mode];\n        }\n        this.mode = mode;\n    }\n    this.count = 0;\n    this.offset = 0;\n    this.indices = indices;\n    this.uType = DrawElements.UNSIGNED_SHORT;\n    if (indices !== undefined) {\n        this.setIndices(indices);\n    }\n};\n\nDrawElements.UNSIGNED_BYTE = 0x1401;\nDrawElements.UNSIGNED_SHORT = 0x1403;\nDrawElements.UNSIGNED_INT = 0x1405;\n\n/** @lends DrawElements.prototype */\nDrawElements.prototype = {\n    getMode: function() {\n        return this.mode;\n    },\n    draw: function(state) {\n        if (this.count === 0) return;\n        state.setIndexArray(this.indices);\n        this.drawElements(state);\n    },\n    drawElements: function(state) {\n        var gl = state.getGraphicContext();\n        gl.drawElements(this.mode, this.count, this.uType, this.offset);\n    },\n    setIndices: function(indices) {\n        this.indices = indices;\n        var elts = indices.getElements();\n        this.count = elts.length;\n\n        var nbBytes = elts.BYTES_PER_ELEMENT;\n        if (nbBytes === 1) this.uType = DrawElements.UNSIGNED_BYTE;\n        else if (nbBytes === 2) this.uType = DrawElements.UNSIGNED_SHORT;\n        else if (nbBytes === 4) this.uType = DrawElements.UNSIGNED_INT;\n    },\n    getIndices: function() {\n        return this.indices;\n    },\n    setFirst: function(val) {\n        this.offset = val;\n    },\n    getFirst: function() {\n        return this.offset;\n    },\n    setCount: function(val) {\n        this.count = val;\n    },\n    getCount: function() {\n        return this.count;\n    },\n    getNumIndices: function() {\n        return this.indices.getElements().length;\n    },\n    index: function(i) {\n        return this.indices.getElements()[i];\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (DrawElements);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/DrawElements.js\n// module id = 16\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/DrawElements.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__ = __webpack_require__(8);\n\n\n/**\n * DrawArrays manage rendering primitives\n * @class DrawArrays\n */\nvar DrawArrays = function(mode, first, count) {\n    this.mode = mode;\n    if (mode !== undefined) {\n        if (typeof mode === \'string\') {\n            mode = __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */][mode];\n        }\n        this.mode = mode;\n    }\n    this.first = first;\n    this.count = count;\n};\n\n/** @lends DrawArrays.prototype */\nDrawArrays.prototype = {\n    draw: function(state) {\n        if (this.count === 0) return;\n        var gl = state.getGraphicContext();\n        gl.drawArrays(this.mode, this.first, this.count);\n    },\n    getMode: function() {\n        return this.mode;\n    },\n    setCount: function(count) {\n        this.count = count;\n    },\n    getCount: function() {\n        return this.count;\n    },\n    setFirst: function(first) {\n        this.first = first;\n    },\n    getFirst: function() {\n        return this.first;\n    },\n    getNumIndices: function() {\n        return this.count;\n    },\n    index: function(i) {\n        return this.first + i;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (DrawArrays);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/DrawArrays.js\n// module id = 17\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/DrawArrays.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgViewer_webgl_utils__ = __webpack_require__(107);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Options__ = __webpack_require__(75);\n\n\n\nvar Texture;\n\nvar WebGLCaps = function() {\n    // circular deps with texture\n    if (!Texture) Texture = __webpack_require__(7).default;\n\n    this._checkRTT = {};\n    this._webGLExtensions = {};\n    this._webGLParameters = {};\n    this._webGLShaderMaxInt = 'NONE';\n    this._webGLShaderMaxFloat = 'NONE';\n\n    this._bugsDB = {};\n    this._webGLPlatforms = {};\n\n    // webgl minimum requirements as per webgl specs\n    // useful for nodejs env\n    this._webGLParameters['MAX_COMBINED_TEXTURE_IMAGE_UNITS'] = 8;\n    this._webGLParameters['MAX_CUBE_MAP_TEXTURE_SIZE'] = 16;\n    this._webGLParameters['MAX_FRAGMENT_UNIFORM_VECTORS'] = 16;\n    this._webGLParameters['MAX_RENDERBUFFER_SIZE'] = 1;\n    this._webGLParameters['MAX_TEXTURE_IMAGE_UNITS'] = 8;\n    this._webGLParameters['MAX_TEXTURE_SIZE'] = 64;\n    this._webGLParameters['MAX_VARYING_VECTORS'] = 8;\n    this._webGLParameters['MAX_VERTEX_ATTRIBS'] = 8;\n    this._webGLParameters['MAX_VERTEX_TEXTURE_IMAGE_UNITS'] = 0;\n    this._webGLParameters['MAX_VERTEX_UNIFORM_VECTORS'] = 128;\n    this._webGLParameters['MAX_VIEWPORT_DIMS'] = [1, 1];\n    this._webGLParameters['NUM_COMPRESSED_TEXTURE_FORMATS'] = 0;\n    this._webGLParameters['MAX_SHADER_PRECISION_FLOAT'] = 'none';\n    this._webGLParameters['MAX_SHADER_PRECISION_INT'] = 'none';\n\n    // for multiple context\n    // allow checking we're on the good one\n    this._gl = undefined;\n};\n\nWebGLCaps.instance = function(glParam, force) {\n    if (!WebGLCaps._instance) {\n        var oldWebGLInspector;\n        var gl = glParam;\n\n        if (!gl) {\n            // make sure we don't break webglinspector\n            // with our webglcaps canvas\n            var webglInspector = typeof window !== 'undefined' && window.gli;\n\n            if (webglInspector) {\n                oldWebGLInspector = window.gli.host.inspectContext;\n                window.gli.host.inspectContext = false;\n            }\n\n            var c = document.createElement('canvas');\n            c.width = 32;\n            c.height = 32;\n\n            var options = new __WEBPACK_IMPORTED_MODULE_2_osg_Options__[\"a\" /* default */]();\n            // not necessary, but for some reasons it crashed on chromium vr build\n            options.extend({\n                antialias: false\n            });\n            // in case of webgl2\n            options.extendWithOptionsURL();\n\n            gl = __WEBPACK_IMPORTED_MODULE_1_osgViewer_webgl_utils__[\"a\" /* default */].setupWebGL(c, options, function() {});\n        }\n\n        WebGLCaps._instance = new WebGLCaps();\n        if (gl) {\n            WebGLCaps._instance.init(gl);\n        } else {\n            // gracefully handle non webgl\n            // like nodejs, phantomjs\n            // warns but no error so that nodejs/phantomjs\n            // can still has some webglcaps object\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn('no support for webgl context detected.');\n        }\n\n        if (oldWebGLInspector) {\n            window.gli.host.inspectContext = oldWebGLInspector;\n        }\n\n        //delete c;\n    }\n\n    if (glParam && (force || glParam !== WebGLCaps._instance.getContext())) {\n        // webgl caps called with a different context or GPU\n        // than the one we draw in, will result on hard crash\n        // when using extension from another context\n        WebGLCaps._instance.initContextDependant(glParam);\n    }\n\n    return WebGLCaps._instance;\n};\n\nWebGLCaps.prototype = {\n    getContext: function() {\n        return this._gl;\n    },\n\n    initContextDependant: function(gl) {\n        // store context in case of multiple context\n        this._gl = gl;\n        // We need to check if this is a webGL2 context to get the extensions work.\n        this._isGL2 =\n            typeof window.WebGL2RenderingContext !== 'undefined' &&\n            gl instanceof window.WebGL2RenderingContext;\n        // Takes care of circular dependencies on Texture\n        // Texture should be resolved at this point\n        // Texture = require('osg/Texture').default;\n\n        // get extensions\n        this.initWebGLExtensions(gl);\n\n        // get float support\n        this.hasLinearHalfFloatRTT(gl);\n        this.hasLinearFloatRTT(gl);\n        this.hasHalfFloatRTT(gl);\n        this.hasFloatRTT(gl);\n    },\n\n    init: function(gl) {\n        // get capabilites\n        this.initWebGLParameters(gl);\n\n        // order is important\n        // to allow webgl extensions filtering\n        this.initPlatformSupport();\n        this.initBugDB();\n\n        this.initContextDependant(gl);\n\n        if (this._isGL2) {\n            var nativeExtension = [\n                'OES_element_index_uint',\n                'EXT_sRGB',\n                'EXT_blend_minmax',\n                'EXT_frag_depth',\n                'WEBGL_depth_texture',\n                'EXT_shader_texture_lod',\n                'OES_standard_derivatives',\n                'OES_texture_float',\n                'OES_texture_half_float',\n                'OES_texture_half_float_linear',\n                'OES_texture_float_linear',\n                'OES_vertex_array_object',\n                'WEBGL_draw_buffers',\n                'OES_fbo_render_mipmap',\n                'ANGLE_instanced_arrays'\n            ];\n\n            var ext = WebGLCaps._instance.getWebGLExtensions();\n            var dummyFunc = function() {};\n            for (var i = 0, l = nativeExtension.length; i < l; i++) {\n                ext[nativeExtension[i]] = dummyFunc;\n            }\n        }\n    },\n\n    isWebGL2: function() {\n        return this._isGL2;\n    },\n\n    // inevitable bugs per platform (browser/OS/GPU)\n    initBugDB: function() {\n        var p = this._webGLPlatforms;\n        var ext = this._webGLParameters;\n\n        // derivatives gives strange results on Shadow Shaders\n        if (p.Apple) {\n            if (!ext.UNMASKED_VENDOR_WEBGL || ext.UNMASKED_VENDOR_WEBGL.indexOf('Intel') !== -1) {\n                // bug is on INTEL GPU on APPLE\n                // we disable the ext on Apple if we cannot get GPU info\n                this._bugsDB['OES_standard_derivatives'] = true;\n            }\n        }\n    },\n\n    initPlatformSupport: function() {\n        var p = this._webGLPlatforms;\n\n        p.Apple =\n            navigator.vendor.indexOf('Apple') !== -1 || navigator.vendor.indexOf('OS X') !== -1;\n\n        // degrades complexity on handhelds.\n        p.Mobile = /Mobi/.test(navigator.userAgent) || /ablet/.test(navigator.userAgent);\n    },\n\n    getWebGLPlatform: function(str) {\n        return this._webGLPlatforms[str];\n    },\n\n    getWebGLPlatforms: function() {\n        return this._webGLPlatforms;\n    },\n\n    getWebGLParameter: function(str) {\n        return this._webGLParameters[str];\n    },\n\n    getWebGLParameters: function() {\n        return this._webGLParameters;\n    },\n\n    getShaderMaxPrecisionFloat: function() {\n        return this._webGLParameters.MAX_SHADER_PRECISION_FLOAT;\n    },\n\n    getShaderMaxPrecisionInt: function() {\n        return this._webGLParameters.MAX_SHADER_PRECISION_INT;\n    },\n\n    checkSupportRTT: function(gl, typeFloat, typeTexture) {\n        var key = typeFloat + ',' + typeTexture;\n\n        if (this._isGL2) {\n            return !!this._webGLExtensions['EXT_color_buffer_float'];\n        }\n\n        // check once only\n        if (this._checkRTT[key] !== undefined) return this._checkRTT[key];\n\n        // no cached results, need gl context\n        if (!gl) return false;\n\n        // from http://codeflow.org/entries/2013/feb/22/how-to-write-portable-webgl/#how-can-i-detect-if-i-can-render-to-floating-point-textures\n\n        // setup the texture\n        var texture = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 2, 2, 0, gl.RGBA, typeFloat, null);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, typeTexture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, typeTexture);\n\n        // setup the framebuffer\n        var framebuffer = gl.createFramebuffer();\n        gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n\n        // check the framebuffer\n        var status = (this._checkRTT[key] =\n            gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE);\n\n        // cleanup\n        gl.deleteTexture(texture);\n        gl.deleteFramebuffer(framebuffer);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n        return status;\n    },\n\n    hasLinearHalfFloatRTT: function(gl) {\n        return (\n            this._webGLExtensions['OES_texture_half_float_linear'] &&\n            this.checkSupportRTT(gl, Texture.HALF_FLOAT_OES, Texture.LINEAR)\n        );\n    },\n\n    hasLinearFloatRTT: function(gl) {\n        return (\n            this._webGLExtensions['OES_texture_float_linear'] &&\n            this.checkSupportRTT(gl, Texture.FLOAT, Texture.LINEAR)\n        );\n    },\n\n    hasHalfFloatRTT: function(gl) {\n        return (\n            this._webGLExtensions['OES_texture_half_float'] &&\n            this.checkSupportRTT(gl, Texture.HALF_FLOAT_OES, Texture.NEAREST)\n        );\n    },\n\n    hasFloatRTT: function(gl) {\n        return (\n            this._webGLExtensions['OES_texture_float'] &&\n            this.checkSupportRTT(gl, Texture.FLOAT, Texture.NEAREST)\n        );\n    },\n\n    queryPrecision: function(gl, shaderType, precision) {\n        var answer = gl.getShaderPrecisionFormat(shaderType, precision);\n        if (!answer) return false;\n        return answer.precision !== 0;\n    },\n\n    hasVAO: function() {\n        return !!this._webGLExtensions['OES_vertex_array_object'];\n    },\n\n    getDisjointTimerQuery: function() {\n        return (\n            this._webGLExtensions['EXT_disjoint_timer_query_webgl2'] ||\n            this._webGLExtensions['EXT_disjoint_timer_query']\n        );\n    },\n\n    initWebGLParameters: function(gl) {\n        if (!gl) return;\n        var limits = [\n            'MAX_COMBINED_TEXTURE_IMAGE_UNITS',\n            'MAX_CUBE_MAP_TEXTURE_SIZE',\n            'MAX_FRAGMENT_UNIFORM_VECTORS',\n            'MAX_RENDERBUFFER_SIZE',\n            'MAX_TEXTURE_IMAGE_UNITS',\n            'MAX_TEXTURE_SIZE',\n            'MAX_VARYING_VECTORS',\n            'MAX_VERTEX_ATTRIBS',\n            'MAX_VERTEX_TEXTURE_IMAGE_UNITS',\n            'MAX_VERTEX_UNIFORM_VECTORS',\n            'MAX_VIEWPORT_DIMS',\n            'SHADING_LANGUAGE_VERSION',\n            'VERSION',\n            'VENDOR',\n            'RENDERER',\n            'ALIASED_LINE_WIDTH_RANGE',\n            'ALIASED_POINT_SIZE_RANGE',\n            'RED_BITS',\n            'GREEN_BITS',\n            'BLUE_BITS',\n            'ALPHA_BITS',\n            'DEPTH_BITS',\n            'STENCIL_BITS'\n        ];\n        var params = this._webGLParameters;\n        for (var i = 0, len = limits.length; i < len; ++i) {\n            var par = limits[i];\n            params[par] = gl.getParameter(gl[par]);\n        }\n\n        //shader precisions for float\n        if (this.queryPrecision(gl, gl.FRAGMENT_SHADER, gl.HIGH_FLOAT)) {\n            params.MAX_SHADER_PRECISION_FLOAT = 'high';\n        } else if (this.queryPrecision(gl, gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT)) {\n            params.MAX_SHADER_PRECISION_FLOAT = 'medium';\n        } else if (this.queryPrecision(gl, gl.FRAGMENT_SHADER, gl.LOW_FLOAT)) {\n            params.MAX_SHADER_PRECISION_FLOAT = 'low';\n        }\n\n        //shader precisions for float\n        if (this.queryPrecision(gl, gl.FRAGMENT_SHADER, gl.HIGH_INT)) {\n            params.MAX_SHADER_PRECISION_INT = 'high';\n        } else if (this.queryPrecision(gl, gl.FRAGMENT_SHADER, gl.MEDIUM_INT)) {\n            params.MAX_SHADER_PRECISION_INT = 'medium';\n        } else if (this.queryPrecision(gl, gl.FRAGMENT_SHADER, gl.LOW_INT)) {\n            params.MAX_SHADER_PRECISION_INT = 'low';\n        }\n\n        // get GPU, Angle or not, Opengl/directx, etc.\n        //  ffx && chrome only\n        var debugInfo = gl.getExtension('WEBGL_debug_renderer_info');\n        if (debugInfo) {\n            params.UNMASKED_RENDERER_WEBGL = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);\n            params.UNMASKED_VENDOR_WEBGL = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);\n        }\n        // TODO ?\n        // try to compile a small shader to test the spec is respected\n    },\n\n    applyExtension: function(gl, name) {\n        var ext = gl.getExtension(name);\n        // Borrowed from https://webgl2fundamentals.org/webgl/lessons/webgl1-to-webgl2.html\n        // make \"generalized\" functions and name\n        // so that can be used in webgl1 & wegbl2\n        var suffix = name.split('_')[0];\n        var prefix = '_' + suffix;\n        var suffixRE = new RegExp(suffix + '$');\n        var prefixRE = new RegExp(prefix);\n        for (var key in ext) {\n            var val = ext[key];\n            if (typeof val === 'function') {\n                // remove suffix (eg: bindVertexArrayOES -> bindVertexArray)\n                var unsuffixedKey = key.replace(suffixRE, '');\n                if (gl[unsuffixedKey] === undefined) gl[unsuffixedKey] = ext[key].bind(ext);\n            } else {\n                var unprefixedKey = key.replace(prefixRE, '');\n                if (gl[unprefixedKey] === undefined) gl[unprefixedKey] = ext[key];\n            }\n        }\n    },\n\n    getWebGLExtension: function(str) {\n        return this._webGLExtensions[str];\n    },\n\n    getWebGLExtensions: function() {\n        return this._webGLExtensions;\n    },\n\n    _checkShader: function(gl, t, text) {\n        var type = t;\n        if (typeof type === 'string') type = gl[t];\n        var shader = gl.createShader(type);\n        gl.shaderSource(shader, text);\n        gl.compileShader(shader);\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS) && !gl.isContextLost()) {\n            // $$ SOURCE_CODE_MODIFIED\n            // GPU 资源泄露\n            gl.deleteShader(shader);\n            // $$ SOURCE_CODE_MODIFIED\n            return false;\n        }\n        // $$ SOURCE_CODE_MODIFIED\n        // GPU 资源泄露\n        gl.deleteShader(shader);\n        // $$ SOURCE_CODE_MODIFIED\n        return true;\n    },\n\n    // some mobile reuse same driver\n    // GPUs with different capabilities\n    // double check if glsl compiler agree\n    // with driver\n    _doubleCheckExtension: function(gl, extension) {\n        var shader = [\n            '#version 100',\n            '#extension GL_%ext% : require',\n            'precision mediump float;',\n            'varying vec3 vColor;',\n            'void main() {',\n            'gl_FragColor = vec4(vColor, 1.0);',\n            '}'\n        ].join('\\n');\n        return this._checkShader(gl, 'FRAGMENT_SHADER', shader.replace(/\\%ext\\%/g, extension));\n    },\n\n    initWebGLExtensions: function(gl, filterBugs) {\n        // nodejs, phantomjs\n        if (!gl) return;\n\n        var doFilter = filterBugs;\n        if (doFilter === undefined) doFilter = true;\n\n        var supported = gl.getSupportedExtensions();\n        if (!supported) return;\n        var ext = this._webGLExtensions;\n        // we load all the extensions\n        for (var i = 0, len = supported.length; i < len; ++i) {\n            var sup = supported[i];\n\n            if (doFilter && this._bugsDB[sup]) {\n                // bugs on that configuration, do not enable\n                continue;\n            }\n\n            ext[sup] = gl.getExtension(sup);\n            if (!this._isGL2) this.applyExtension(gl, sup);\n        }\n\n        if (!this._isGL2) {\n            // double check extensions support\n            // for now only texture lod... might have to go in loop\n            // and start a DB of ext to check.\n            // time will tell\n            var extToCheck = 'EXT_shader_texture_lod';\n            if (ext[extToCheck] && !this._doubleCheckExtension(gl, extToCheck))\n                delete ext[extToCheck];\n        }\n\n        var anisoExt = this.getWebGLExtension('EXT_texture_filter_anisotropic');\n        if (anisoExt) {\n            Texture.ANISOTROPIC_SUPPORT_EXT = true;\n            Texture.ANISOTROPIC_SUPPORT_MAX = gl.getParameter(\n                anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT\n            );\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WebGLCaps);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/WebGLCaps.js\n// module id = 18\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/WebGLCaps.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var PooledArray = function() {\n    this._pool = [];\n    this._length = 0;\n};\n\nPooledArray.prototype = {\n    clean: function() {\n        this._length = 0;\n        this._pool.length = 0;\n    },\n    reset: function() {\n        this._length = 0;\n    },\n    getLength: function() {\n        return this._length;\n    },\n    getArray: function() {\n        return this._pool;\n    },\n    back: function() {\n        return this._pool[this._length - 1];\n    },\n    pop: function() {\n        this._length--;\n        return this._pool[this._length];\n    },\n    push: function(value) {\n        if (this._length === this._pool.length) {\n            this._pool.push(value);\n        } else {\n            this._pool[this._length] = value;\n        }\n        this._length++;\n    },\n    forEach: function(func) {\n        for (var i = 0; i < this._length; i++) func(this._pool[i]);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (PooledArray);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/PooledArray.js\n// module id = 19\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/PooledArray.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_ShaderProcessor__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_Timer__ = __webpack_require__(22);\n\n\n\n\n\n\n\n// singleton\nvar sp = new __WEBPACK_IMPORTED_MODULE_4_osgShader_ShaderProcessor__["a" /* default */]();\nvar errorCallback;\n\nvar uniformRegexp = /uniform\\s+\\w+\\s+(\\w+)((\\s)?\\[(.*?)\\])?/g;\nvar attributesRegexp = /(in|attribute)\\s+\\w+\\s+(\\w+)\\s*;/g;\n\nvar getAttributeList = function(shaderText) {\n    var attributeMap = {};\n    var r, attr;\n    while ((r = attributesRegexp.exec(shaderText)) !== null) {\n        attr = r[2];\n        attributeMap[attr] = true;\n    }\n\n    return attributeMap;\n};\n\nvar getUniformList = function(shaderText) {\n    var uniformMap = {};\n    var r;\n    while ((r = uniformRegexp.exec(shaderText)) !== null) {\n        var uniform = r[1];\n        uniformMap[uniform] = true;\n    }\n    return uniformMap;\n};\n\n/**\n * Program encapsulate an vertex and fragment shader\n * @class Program\n */\nvar Program = function(vShader, fShader) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].call(this);\n    __WEBPACK_IMPORTED_MODULE_3_osg_StateAttribute__["a" /* default */].call(this);\n    this._program = null;\n\n    // used to know if it\'s a default program\n    // a default program does nothing but avoid to do some\n    // useless logic\n    // if we vertex or fragment shader are set it\'s not a default\n    // program anymore\n    this._nullProgram = true;\n\n    this._vertex = undefined;\n    this._fragment = undefined;\n\n    this._uniformsCache = undefined;\n    this._attributesCache = undefined;\n    // state caches\n    this._activeUniforms = undefined;\n    this._foreignUniforms = undefined;\n    this._trackAttributes = undefined;\n\n    if (vShader) this.setVertexShader(vShader);\n    if (fShader) this.setFragmentShader(fShader);\n\n    this._dirty = true;\n};\n\n// static cache of glPrograms flagged for deletion, which will actually\n// be deleted in the correct GL context.\nProgram._sDeletedGLProgramCache = new window.Map();\n\n// static method to delete Program\nProgram.deleteGLProgram = function(gl, program) {\n    if (!Program._sDeletedGLProgramCache.has(gl)) Program._sDeletedGLProgramCache.set(gl, []);\n\n    Program._sDeletedGLProgramCache.get(gl).push(program);\n};\n\n// static method to flush all the cached glPrograms which need to be deleted in the GL context specified\nProgram.flushDeletedGLPrograms = function(gl, availableTime) {\n    // if no time available don\'t try to flush objects.\n    if (availableTime <= 0.0) return availableTime;\n\n    if (!Program._sDeletedGLProgramCache.has(gl)) return availableTime;\n\n    var elapsedTime = 0.0;\n    var beginTime = __WEBPACK_IMPORTED_MODULE_5_osg_Timer__["a" /* default */].instance().tick();\n    var deleteList = Program._sDeletedGLProgramCache.get(gl);\n    var numPrograms = deleteList.length;\n\n    for (var i = numPrograms - 1; i >= 0 && elapsedTime < availableTime; i--) {\n        gl.deleteProgram(deleteList[i]);\n        deleteList.splice(i, 1);\n        elapsedTime = __WEBPACK_IMPORTED_MODULE_5_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_5_osg_Timer__["a" /* default */].instance().tick());\n    }\n\n    return availableTime - elapsedTime;\n};\n\nProgram.flushAllDeletedGLPrograms = function(gl) {\n    if (!Program._sDeletedGLProgramCache.has(gl)) return;\n\n    var deleteList = Program._sDeletedGLProgramCache.get(gl);\n    var numPrograms = deleteList.length;\n\n    for (var i = numPrograms - 1; i >= 0; i--) {\n        gl.deleteProgram(deleteList[i]);\n        deleteList.splice(i, 1);\n    }\n};\n\nProgram.onLostContext = function(gl) {\n    if (!Program._sDeletedGLProgramCache.has(gl)) return;\n    var deleteList = Program._sDeletedGLProgramCache.get(gl);\n    deleteList.length = 0;\n    return;\n};\n\n/** @lends Program.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    Program,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(\n        __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].prototype,\n        __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_StateAttribute__["a" /* default */].prototype, {\n            attributeType: \'Program\',\n\n            cloneType: function() {\n                return new Program();\n            },\n\n            setVertexShader: function(vs) {\n                this._vertex = vs;\n                this._nullProgram = false;\n                vs.setText(sp.processShader(vs.getText()));\n            },\n\n            setFragmentShader: function(fs) {\n                this._fragment = fs;\n                this._nullProgram = false;\n                fs.setText(sp.processShader(fs.getText()));\n            },\n\n            getVertexShader: function() {\n                return this._vertex;\n            },\n            getFragmentShader: function() {\n                return this._fragment;\n            },\n\n            getProgram: function() {\n                return this._program;\n            },\n\n            setActiveUniforms: function(activeUniforms) {\n                this._activeUniforms = activeUniforms;\n            },\n\n            getActiveUniforms: function() {\n                return this._activeUniforms;\n            },\n\n            setForeignUniforms: function(foreignUniforms) {\n                this._foreignUniforms = foreignUniforms;\n            },\n\n            getForeignUniforms: function() {\n                return this._foreignUniforms;\n            },\n\n            setUniformsCache: function(uniformsCache) {\n                this._uniformsCache = uniformsCache;\n            },\n\n            getUniformsCache: function() {\n                return this._uniformsCache;\n            },\n\n            setAttributesCache: function(attributesCache) {\n                this._attributesCache = attributesCache;\n            },\n\n            getAttributesCache: function() {\n                return this._attributesCache;\n            },\n\n            setTrackAttributes: function(trackAttributes) {\n                this._trackAttributes = trackAttributes;\n            },\n\n            getTrackAttributes: function() {\n                return this._trackAttributes;\n            },\n\n            releaseGLObjects: function() {\n                // Call to releaseGLOBjects on shaders\n                if (this._vertex !== undefined) this._vertex.releaseGLObjects();\n                if (this._fragment !== undefined) this._fragment.releaseGLObjects();\n                if (this._program === null) return;\n                if (this._gl !== undefined) {\n                    Program.deleteGLProgram(this._gl, this._program);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].removeObject(this._gl, this);\n                }\n                this.invalidate();\n            },\n\n            dirty: function() {\n                this._program = undefined;\n            },\n\n            invalidate: function() {\n                this._cacheUniformId = undefined;\n\n                this._uniformsCache = undefined;\n                this._attributesCache = undefined;\n                this._foreignUniforms = undefined;\n                this._trackAttributes = undefined;\n\n                this._program = undefined;\n            },\n\n            _rebuildProgramFromSpector: function(\n                vertexShaderText,\n                fragmentShaderText,\n                onCompiled,\n                onError\n            ) {\n                this._dirty = true;\n                this._vertex.invalidate();\n                this._fragment.invalidate();\n                this.invalidate();\n                this._vertex.setText(vertexShaderText);\n                this._fragment.setText(fragmentShaderText);\n                this._spectorOnCompiled = onCompiled;\n                this._spectorOnError = onError;\n            },\n\n            _onErrorToSpector: function(errLink) {\n                if (!this._spectorOnError) return false;\n                this._spectorOnError(errLink);\n                return true;\n            },\n\n            _onCompilationToSpector: function() {\n                if (!this._spectorOnCompiled) return;\n                this._spectorOnCompiled(this._program);\n            },\n\n            _bindProgramToSpector: function() {\n                if (!window || !window.spector || this._program.__SPECTOR_rebuildProgram) return;\n                this._program.__SPECTOR_rebuildProgram = this._rebuildProgramFromSpector.bind(this);\n            },\n\n            _logDebugShaders: function(gl, errLink) {\n                if (errLink !== \'Failed to create D3D shaders.\\n\') return;\n                // rawgl trick is for webgl inspector\n                var debugShader = gl.rawgl !== undefined ? gl.rawgl : gl;\n                if (debugShader === undefined || debugShader.getExtension !== undefined) return;\n                debugShader = debugShader.getExtension(\'WEBGL_debug_shaders\');\n                if (!debugShader) return;\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].error(debugShader.getTranslatedShaderSource(this._vertex.shader));\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].error(debugShader.getTranslatedShaderSource(this._fragment.shader));\n            },\n\n            _activateFailSafe: function(gl) {\n                var program = gl.createProgram();\n                this._vertex.failSafe(gl, this._vertex.getText());\n                this._fragment.failSafe(gl, this._fragment.getText());\n                this._glAttachAndCompile(gl, program, this._vertex, this._fragment);\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\'FailSafe shader Activated \');\n                this._program = program;\n            },\n\n            _glAttachAndCompile: function(gl, programGL, vertexShader, fragmentShader) {\n                gl.attachShader(programGL, vertexShader.shader);\n                gl.attachShader(programGL, fragmentShader.shader);\n                __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].timeStamp(\'osgjs.metrics:linkShader\');\n                gl.linkProgram(programGL);\n            },\n\n            compile: function() {\n                var gl = this._gl;\n\n                var shaderName = this._fragment\n                    .getText()\n                    .match(/#define[\\s]+SHADER_NAME[\\s]+([\\S]+)(\\n|$)/);\n\n                var compileClean = true;\n\n                this._shaderName = shaderName ? shaderName[1] : \'\';\n\n                if (!this._vertex.shader) {\n                    compileClean = this._vertex.compile(gl, errorCallback);\n                }\n\n                if (!this._fragment.shader) {\n                    compileClean = this._fragment.compile(gl, errorCallback);\n                }\n\n                this._attributeMap = getAttributeList(this._vertex.getText());\n\n                if (!compileClean) {\n                    // Any error, Any\n                    // Pink must die.\n                    return false;\n                }\n\n                this._program = gl.createProgram();\n\n                if (this._attributeMap.Vertex) {\n                    // force Vertex to be on 0\n                    gl.bindAttribLocation(this._program, 0, \'Vertex\');\n                }\n                this._glAttachAndCompile(gl, this._program, this._vertex, this._fragment);\n\n                this._uniformMap = getUniformList(\n                    this._fragment.getText() + \'\\n\' + this._vertex.getText()\n                );\n\n                return true;\n            },\n\n            getCompilationResult: function(compileClean, gl) {\n                if (compileClean) {\n                    if (\n                        !gl.getProgramParameter(this._program, gl.LINK_STATUS) &&\n                        !gl.isContextLost()\n                    ) {\n                        var errLink = gl.getProgramInfoLog(this._program);\n\n                        __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].errorFold(\n                            errLink,\n                            "can\'t link program\\nvertex shader:\\n" +\n                                this._vertex.text +\n                                \'\\n fragment shader:\\n\' +\n                                this._fragment.text\n                        );\n\n                        this._logDebugShaders(gl, errLink);\n                        if (errorCallback) {\n                            errorCallback(this._vertex.text, this._fragment.text, errLink);\n                        }\n                        compileClean = false;\n                        if (this._onErrorToSpector(errLink)) return;\n                    } else {\n                        this._onCompilationToSpector(this._program);\n                    }\n                }\n\n                this._bindProgramToSpector();\n\n                this._uniformsCache = {};\n                this._attributesCache = {};\n\n                if (!compileClean) {\n                    // Any error, Any\n                    // Pink must die.\n                    this._activateFailSafe(gl);\n                } else {\n                    this.cacheAttributeList(gl, window.Object.keys(this._attributeMap));\n                    this.cacheUniformList(gl, window.Object.keys(this._uniformMap));\n                }\n                return compileClean;\n            },\n\n            apply: function(state) {\n                if (this._nullProgram) return;\n\n                if (!this._gl) {\n                    this.setGraphicContext(state.getGraphicContext());\n                }\n\n                if (this._program && !this._dirty) {\n                    state.applyProgram(this._program);\n                    return;\n                }\n\n                this._compileClean = this.compile();\n                this.getCompilationResult(this._compileClean, this._gl);\n                state.applyProgram(this._program);\n                this._dirty = false;\n            },\n\n            cacheUniformList: function(gl, uniformList) {\n                var map = this._uniformsCache;\n                for (var i = 0, l = uniformList.length; i < l; i++) {\n                    var uniform = uniformList[i];\n                    var location = gl.getUniformLocation(this._program, uniform);\n                    if (location !== undefined && location !== null) {\n                        if (map[uniform] === undefined) {\n                            map[uniform] = location;\n                        }\n                    }\n                }\n            },\n\n            cacheAttributeList: function(gl, attributeList) {\n                var map = this._attributesCache;\n                for (var i = 0, l = attributeList.length; i < l; i++) {\n                    var attr = attributeList[i];\n                    var location = gl.getAttribLocation(this._program, attr);\n\n                    if (location !== -1 && location !== undefined) {\n                        if (map[attr] === undefined) {\n                            map[attr] = location;\n                        }\n                    }\n                }\n            }\n        })\n    ),\n    \'osg\',\n    \'Program\'\n);\n\nProgram.registerErrorCallback = function(callback) {\n    errorCallback = callback;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (Program);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Program.js\n// module id = 20\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Program.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var Controller = function(manipulator) {\n    this._manipulator = manipulator;\n    this._enable = true;\n};\n\nController.prototype = {\n\n    // All eventProxy must check isEnabled before injecting\n    // event into Controllers\n    isEnabled: function() {\n        return this._enable;\n    },\n\n    // called to enable/disable a Controller\n    // it should be customized for controller that keeps states\n    // on events\n    setEnable: function(bool) {\n        this._enable = bool;\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (Controller);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/Controller.js\n// module id = 21\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/Controller.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* WEBPACK VAR INJECTION */(function(global) {// user performance if available or fallback\n\nvar now = (function() {\n    var w = window || global; // eslint-disable-line\n\n    // if no window.performance\n    if (w.performance === undefined) {\n        return function() {\n            return Date.now();\n        };\n    }\n\n    var fn =\n        w.performance.now ||\n        w.performance.mozNow ||\n        w.performance.msNow ||\n        w.performance.oNow ||\n        w.performance.webkitNow ||\n        function() {\n            return Date.now();\n        };\n    return function() {\n        return fn.apply(w.performance, arguments);\n    };\n})();\n\nvar Timer = function() {};\n\nTimer.instance = function() {\n    if (!Timer._instance) Timer._instance = new Timer();\n\n    return Timer._instance;\n};\n\nTimer.prototype = {\n    // delta in seconds\n    deltaS: function(t0, t1) {\n        return (t1 - t0) / 1000.0;\n    },\n\n    // delta in milliseconds\n    deltaM: function(t0, t1) {\n        return t1 - t0;\n    },\n\n    tick: function() {\n        return now();\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (Timer);\n\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(177)))\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Timer.js\n// module id = 22\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Timer.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_transformEnums__ = __webpack_require__(12);\n\n\n\n\n\n/**\n * Transform - base class for Transform type node ( Camera, MatrixTransform )\n * @class Transform\n * @inherits Node\n */\nvar Transform = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].call(this);\n    this.referenceFrame = __WEBPACK_IMPORTED_MODULE_3_osg_transformEnums__["a" /* default */].RELATIVE_RF;\n};\n\n/** @lends Transform.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Transform,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype, {\n        setReferenceFrame: function(value) {\n            this.referenceFrame = value;\n        },\n        getReferenceFrame: function() {\n            return this.referenceFrame;\n        },\n\n        computeBoundingSphere: (function() {\n            var matrix = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n            return function(bSphere) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.computeBoundingSphere.call(this, bSphere);\n                if (!bSphere.valid()) {\n                    return bSphere;\n                }\n\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].identity(matrix);\n                // local to local world (not Global World)\n                this.computeLocalToWorldMatrix(matrix);\n                bSphere.transformMat4(bSphere, matrix);\n                return bSphere;\n            };\n        })()\n    }),\n    \'osg\',\n    \'Transform\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Transform);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Transform.js\n// module id = 23\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Transform.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_utils__ = __webpack_require__(0);\n\n\n\n\n/** Stores a set of modes and attributes which represent a set of OpenGL state.\n *  Notice that a \\c StateSet contains just a subset of the whole OpenGL state.\n * <p>In OSG, each \\c Drawable and each \\c Node has a reference to a\n * \\c StateSet. These <tt>StateSet</tt>s can be shared between\n * different <tt>Drawable</tt>s and <tt>Node</tt>s (that is, several\n * <tt>Drawable</tt>s and <tt>Node</tt>s can reference the same \\c StateSet).\n * Indeed, this practice is recommended whenever possible,\n * as this minimizes expensive state changes in the graphics pipeline.\n */\n\nvar StateSet = function() {\n    __WEBPACK_IMPORTED_MODULE_0_osg_Object__["a" /* default */].call(this);\n\n    this._parents = [];\n    this._attributeArray = [];\n    this._textureAttributeArrayList = [];\n\n    // cache what is really used\n    this._activeTextureAttributeUnit = [];\n    this._activeAttribute = [];\n    this._activeTextureAttribute = [];\n\n    this._binName = undefined;\n    this._binNumber = 0;\n\n    // put the shader generator name in an AttributePair\n    // so that we can use the mask value\n    this._shaderGeneratorPair = null;\n\n    this._updateCallbackList = [];\n\n    this.uniforms = {};\n\n    this._hasUniform = false;\n\n    this._drawID = -1; // used by the RenderLeaf to decide if it should apply the stateSet\n};\n\nStateSet.AttributePair = function(attr, value) {\n    this._object = attr;\n    this._value = value;\n};\n\nStateSet.AttributePair.prototype = {\n    getShaderGeneratorName: function() {\n        return this._object;\n    },\n    getAttribute: function() {\n        return this._object;\n    },\n    getUniform: function() {\n        return this._object;\n    },\n    getValue: function() {\n        return this._value;\n    }\n};\n\n__WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].createPrototypeObject(\n    StateSet,\n    __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osg_Object__["a" /* default */].prototype, {\n        setDrawID: function(id) {\n            this._drawID = id;\n        },\n\n        getDrawID: function() {\n            return this._drawID;\n        },\n\n        getAttributePair: function(attribute, value) {\n            return new StateSet.AttributePair(attribute, value);\n        },\n\n        addUniform: function(uniform, originalMode) {\n            var mode = originalMode !== undefined ? originalMode : __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].ON;\n            var name = uniform.getName();\n            this.uniforms[name] = this.getAttributePair(uniform, mode);\n            this._hasUniform = true;\n        },\n\n        addParent: function(node) {\n            this._parents.push(node);\n        },\n\n        removeParent: function(node) {\n            var idx = this._parents.indexOf(node);\n            if (idx === -1) return;\n            this._parents.splice(idx, 1);\n        },\n\n        removeUniform: function(uniform) {\n            this.removeUniformByName(uniform.getName());\n        },\n\n        removeUniformByName: function(uniformName) {\n            delete this.uniforms[uniformName];\n            this._hasUniform = window.Object.keys(this.uniforms).length ? true : false;\n        },\n\n        hasUniform: function() {\n            return this._hasUniform;\n        },\n\n        getUniform: function(uniform) {\n            var uniformMap = this.uniforms;\n            if (uniformMap[uniform]) return uniformMap[uniform].getAttribute();\n            return undefined;\n        },\n\n        getUniformList: function() {\n            return this.uniforms;\n        },\n\n        setTextureAttributeAndModes: function(unit, attribute, mode) {\n            this._setTextureAttribute(\n                unit,\n                this.getAttributePair(attribute, mode !== undefined ? mode : __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].ON)\n            );\n        },\n\n        getNumTextureAttributeLists: function() {\n            return this._textureAttributeArrayList.length;\n        },\n\n        getTextureAttribute: function(unit, typeMember) {\n            var index = __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].getTextureIdFromTypeMember(typeMember);\n            if (index === undefined || !this._hasTextureAttribute(unit, index)) return undefined;\n\n            var textureArray = this._textureAttributeArrayList[unit];\n            if (textureArray[index]) return textureArray[index].getAttribute();\n            return undefined;\n        },\n\n        removeTextureAttribute: function(unit, typeMember) {\n            var index = __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].getTextureIdFromTypeMember(typeMember);\n            if (index === undefined || !this._hasTextureAttribute(unit, index)) return;\n\n            var textureArray = this._textureAttributeArrayList[unit];\n\n            textureArray[index] = undefined;\n            this._computeValidTextureUnit();\n        },\n\n        getAttribute: function(typeMember) {\n            var index = __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].getIdFromTypeMember(typeMember);\n            if (index === undefined || !this._hasAttribute(index)) return undefined;\n\n            return this._attributeArray[index].getAttribute();\n        },\n\n        setAttributeAndModes: function(attribute, mode) {\n            this._setAttribute(\n                this.getAttributePair(attribute, mode !== undefined ? mode : __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].ON)\n            );\n        },\n\n        setAttribute: function(attribute, mode) {\n            this.setAttributeAndModes(attribute, mode);\n        },\n\n        // TODO: check if it\'s an attribute type or a attribute to remove it\n        removeAttribute: function(typeMember) {\n            var index = __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].getIdFromTypeMember(typeMember);\n            if (!this._hasAttribute(index)) return;\n\n            this._attributeArray[index] = undefined;\n            this._computeValidAttribute();\n        },\n\n        setRenderingHint: function(hint) {\n            if (hint === \'OPAQUE_BIN\') {\n                this.setRenderBinDetails(0, \'RenderBin\');\n            } else if (hint === \'TRANSPARENT_BIN\') {\n                this.setRenderBinDetails(10, \'DepthSortedBin\');\n            } else {\n                this.setRenderBinDetails(0, \'\');\n            }\n        },\n\n        getUpdateCallbackList: function() {\n            return this._updateCallbackList;\n        },\n\n        removeUpdateCallback: function(cb) {\n            var idx = this._updateCallbackList.indexOf(cb);\n            if (idx === -1) return;\n            this._updateCallbackList.splice(idx, 1);\n\n            if (this._updateCallbackList.length === 0) {\n                var parents = this._parents;\n                for (var i = 0, l = parents.length; i < l; i++) {\n                    var parent = parents[i];\n                    parent.setNumChildrenRequiringUpdateTraversal(\n                        parent.getNumChildrenRequiringUpdateTraversal() - 1\n                    );\n                }\n            }\n        },\n\n        requiresUpdateTraversal: function() {\n            return !!this._updateCallbackList.length;\n        },\n\n        addUpdateCallback: function(cb) {\n            var dontNoticeParents = Boolean(this._updateCallbackList.length);\n            this._updateCallbackList.push(cb);\n\n            // parent alreay know we have update callback\n            if (dontNoticeParents) return;\n\n            var parents = this._parents;\n            for (var i = 0, l = parents.length; i < l; i++) {\n                var parent = parents[i];\n                parent.setNumChildrenRequiringUpdateTraversal(\n                    parent.getNumChildrenRequiringUpdateTraversal() + 1\n                );\n            }\n        },\n\n        hasUpdateCallback: function(cb) {\n            return this._updateCallbackList.indexOf(cb) !== -1;\n        },\n\n        setRenderBinDetails: function(num, binName) {\n            this._binNumber = num;\n            this._binName = binName;\n        },\n        getAttributeMap: function() {\n            // not efficieant at all but not really critique\n            var obj = {};\n            for (var i = 0, l = this._attributeArray.length; i < l; i++) {\n                var attributePair = this._attributeArray[i];\n                if (!attributePair) continue;\n                var attribute = attributePair.getAttribute();\n                obj[attribute.getTypeMember()] = attributePair;\n            }\n            return obj;\n        },\n        getBinNumber: function() {\n            return this._binNumber;\n        },\n        getBinName: function() {\n            return this._binName;\n        },\n        setBinNumber: function(binNum) {\n            this._binNumber = binNum;\n        },\n        setBinName: function(binName) {\n            this._binName = binName;\n        },\n        getAttributeList: function() {\n            var attributeArray = this._attributeArray;\n            var list = [];\n            for (var i = 0, l = attributeArray.length; i < l; i++) {\n                if (attributeArray[i]) list.push(attributeArray[i]);\n            }\n            return list;\n        },\n        setShaderGeneratorName: function(generatorName, mode) {\n            this._shaderGeneratorPair = this.getAttributePair(\n                generatorName,\n                mode !== undefined ? mode : __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].ON\n            );\n        },\n        getShaderGeneratorPair: function() {\n            return this._shaderGeneratorPair;\n        },\n        getShaderGeneratorName: function() {\n            return this._shaderGeneratorPair\n                ? this._shaderGeneratorPair.getShaderGeneratorName()\n                : undefined;\n        },\n        releaseGLObjects: function() {\n            for (var i = 0, j = this._textureAttributeArrayList.length; i < j; i++) {\n                var attribute = this.getTextureAttribute(i, \'Texture\');\n                if (attribute) attribute.releaseGLObjects();\n            }\n            var list = this.getAttributeList();\n            for (var k = 0, l = list.length; k < l; k++) {\n                // Remove only if we have releaseGLObject method.\n                if (list[k]._object.releaseGLObjects) {\n                    list[k]._object.releaseGLObjects();\n                }\n            }\n        },\n\n        // for internal use, you should not call it directly\n        _setTextureAttribute: function(unit, attributePair) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].arrayDense(unit, this._textureAttributeArrayList);\n            if (!this._textureAttributeArrayList[unit]) this._textureAttributeArrayList[unit] = [];\n\n            var index = __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].getOrCreateTextureStateAttributeTypeMemberIndex(\n                attributePair.getAttribute()\n            );\n            __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].arrayDense(index, this._textureAttributeArrayList[unit]);\n\n            this._textureAttributeArrayList[unit][index] = attributePair;\n            this._computeValidTextureUnit();\n        },\n\n        _computeValidTextureUnit: function() {\n            this._activeTextureAttributeUnit.length = 0;\n            this._activeTextureAttribute.length = 0;\n            var textureAttributeArrayList = this._textureAttributeArrayList;\n            for (var i = 0, l = textureAttributeArrayList.length; i < l; i++) {\n                var attributeList = textureAttributeArrayList[i];\n                if (!attributeList || !attributeList.length) continue;\n                var hasValidAttribute = false;\n                for (var j = 0, k = attributeList.length; j < k; j++) {\n                    if (attributeList[j]) {\n                        hasValidAttribute = true;\n\n                        if (this._activeTextureAttribute.indexOf(j) === -1) {\n                            this._activeTextureAttribute.push(j);\n                        }\n                    }\n                }\n\n                if (hasValidAttribute) this._activeTextureAttributeUnit.push(i);\n            }\n        },\n        _computeValidAttribute: function() {\n            this._activeAttribute.length = 0;\n            var attributeArray = this._attributeArray;\n            for (var i = 0, l = attributeArray.length; i < l; i++) {\n                if (attributeArray[i]) this._activeAttribute.push(i);\n            }\n        },\n        // for internal use, you should not call it directly\n        _setAttribute: function(attributePair) {\n            var index = __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].getOrCreateStateAttributeTypeMemberIndex(\n                attributePair.getAttribute()\n            );\n            __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].arrayDense(index, this._attributeArray);\n            this._attributeArray[index] = attributePair;\n            this._computeValidAttribute();\n        },\n        _hasAttribute: function(typeIndex) {\n            if (typeIndex >= this._attributeArray.length) return false;\n            return !!this._attributeArray[typeIndex];\n        },\n        _hasTextureAttribute: function(unit, typeIndex) {\n            if (\n                unit >= this._textureAttributeArrayList.length ||\n                !this._textureAttributeArrayList[unit]\n            )\n                return false;\n            if (typeIndex >= this._textureAttributeArrayList[unit].length) return false;\n            return !!this._textureAttributeArrayList[unit][typeIndex];\n        }\n    }),\n    \'osg\',\n    \'StateSet\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (StateSet);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/StateSet.js\n// module id = 24\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/StateSet.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var PooledResource = function(createFunction) {\n    this._createFunction = createFunction;\n    this._pool = [];\n    this._length = 0;\n};\n\nPooledResource.prototype = {\n    clean: function() {\n        this._pool.length = 0;\n        this._length = 0;\n    },\n    getLength: function() {\n        return this._length;\n    },\n    reset: function() {\n        this._length = 0;\n    },\n    /**\n     * Creates or returns an existing object.\n     * The returned object could contain invalid data from previous object values. User is responsible to reset/init the returned object for its (re)use.\n     */\n    getOrCreateObject: function() {\n        var obj;\n        if (this._length === this._pool.length) {\n            obj = this._createFunction();\n            this._pool.push(obj);\n        } else {\n            obj = this._pool[this._length];\n        }\n        this._length++;\n        return obj;\n    },\n    forEach: function(func) {\n        for (var i = 0; i < this._length; i++) func(this._pool[i]);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (PooledResource);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/PooledResource.js\n// module id = 25\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/PooledResource.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Timer__ = __webpack_require__(22);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_GLObject__ = __webpack_require__(35);\n\n\n\n\n\n/**\n * Shader manage shader for vertex and fragment, you need both to create a glsl program.\n * @class Shader\n */\nvar Shader = function(type, text) {\n    __WEBPACK_IMPORTED_MODULE_3_osg_GLObject__[\"a\" /* default */].call(this);\n    var t = type;\n    if (typeof type === 'string') {\n        t = Shader[type];\n    }\n    this.type = t;\n    this.setText(text);\n};\n\nShader.VERTEX_SHADER = 0x8b31;\nShader.FRAGMENT_SHADER = 0x8b30;\n\n// Debug Pink shader for when shader fails\nvar debugName = '\\n#define SHADER_NAME FailSafe';\nShader.VS_DBG =\n    '#define _DEBUG 1\\n#ifdef _DEBUG\\nattribute vec3 Vertex;uniform mat4 uModelViewMatrix;uniform mat4 uProjectionMatrix;void main(void) {  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);}\\n';\nShader.FS_DBG =\n    '#define _DEBUG 1\\n#ifdef _DEBUG\\n precision lowp float; void main(void) { gl_FragColor = vec4(1.0, 0.6, 0.6, 1.0);}\\n';\n\n// static cache of glShaders flagged for deletion, which will actually\n// be deleted in the correct GL context.\nShader._sDeletedGLShaderCache = new window.Map();\n\n// static method to delete Program\nShader.deleteGLShader = function(gl, shader) {\n    if (!Shader._sDeletedGLShaderCache.has(gl)) Shader._sDeletedGLShaderCache.set(gl, []);\n    Shader._sDeletedGLShaderCache.get(gl).push(shader);\n};\n\n// static method to flush all the cached glShaders which need to be deleted in the GL context specified\nShader.flushDeletedGLShaders = function(gl, availableTime) {\n    // if no time available don't try to flush objects.\n    if (availableTime <= 0.0) return availableTime;\n    if (!Shader._sDeletedGLShaderCache.has(gl)) return availableTime;\n    var elapsedTime = 0.0;\n    var beginTime = __WEBPACK_IMPORTED_MODULE_2_osg_Timer__[\"a\" /* default */].instance().tick();\n    var deleteList = Shader._sDeletedGLShaderCache.get(gl);\n    var numShaders = deleteList.length;\n    for (var i = numShaders - 1; i >= 0 && elapsedTime < availableTime; i--) {\n        gl.deleteShader(deleteList[i]);\n        deleteList.splice(i, 1);\n        elapsedTime = __WEBPACK_IMPORTED_MODULE_2_osg_Timer__[\"a\" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_2_osg_Timer__[\"a\" /* default */].instance().tick());\n    }\n    return availableTime - elapsedTime;\n};\n\nShader.flushAllDeletedGLShaders = function(gl) {\n    if (!Shader._sDeletedGLShaderCache.has(gl)) return;\n    var deleteList = Shader._sDeletedGLShaderCache.get(gl);\n    var numShaders = deleteList.length;\n    for (var i = numShaders - 1; i >= 0; i--) {\n        gl.deleteShader(deleteList[i]);\n        deleteList.splice(i, 1);\n    }\n    return;\n};\n\nShader.onLostContext = function(gl) {\n    if (!Shader._sDeletedGLShaderCache.has(gl)) return;\n    var deleteList = Shader._sDeletedGLShaderCache.get(gl);\n    deleteList.length = 0;\n    return;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Shader,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_GLObject__[\"a\" /* default */].prototype, {\n        setText: function(text) {\n            this.text = text;\n        },\n        getText: function() {\n            return this.text;\n        },\n        // this is where it creates a fail safe shader that should work everywhere\n        failSafe: function(gl, shaderText) {\n            this.shader = gl.createShader(this.type);\n\n            // concat failsafe and broken shader under separate _DEBUG defines blocks\n            var shaderName = shaderText.match(/#define[\\s]+SHADER_NAME[\\s]+([\\S]+)(\\n|$)/);\n            shaderName = shaderName ? shaderName[1] : '';\n            var debugShaderTxt = this.type === Shader.VERTEX_SHADER ? Shader.VS_DBG : Shader.FS_DBG;\n            debugShaderTxt += debugName + shaderName + '\\n#else\\n' + shaderText + '\\n#endif\\n';\n            gl.shaderSource(this.shader, debugShaderTxt);\n            gl.compileShader(this.shader);\n        },\n        // webgl shader compiler error to source contextualization\n        // for better console log messages\n        processErrors: function(errors, source) {\n            // regex to extract error message and line from webgl compiler reporting\n            var r = /ERROR: [\\d]+:([\\d]+): (.+)/gim;\n            // split sources in indexable per line array\n            var lines = source.split('\\n');\n            var linesLength = lines.length;\n            if (linesLength === 0) return;\n\n            var i, m;\n\n            // IE reporting is not the same\n            if (r.exec(errors) === null) {\n                r = /Shader compilation errors\\n\\((\\d+)\\, \\d+\\): (.+)/gim;\n            }\n\n            // we dont understand error try to print it instead of nothing\n            if (r.exec(errors) === null) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(errors);\n                return;\n            }\n\n            // reset index to start.\n            r.lastIndex = 0;\n\n            while ((m = r.exec(errors)) !== null) {\n                if (m.index === r.lastIndex) {\n                    // moving between errors\n                    r.lastIndex++;\n                }\n                // get error line\n                var line = parseInt(m[1], 10);\n\n                if (line > linesLength) continue;\n                // webgl error report.\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('ERROR ' + m[2] + ' in line ' + line);\n\n                var minLine = Math.max(0, line - 7);\n                var maxLine = Math.max(0, line - 2);\n                // for context\n                // log surrounding line priori to error with bof check\n                for (i = minLine; i <= maxLine; i++) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn(lines[i].replace(/^[ \\t]+/g, ''));\n                }\n\n                // Warn adds a lovely /!\\ icon in front of the culprit line\n                maxLine = Math.max(0, line - 1);\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(lines[maxLine].replace(/^[ \\t]+/g, ''));\n\n                minLine = Math.min(linesLength, line);\n                maxLine = Math.min(linesLength, line + 5);\n                // for context\n                // surrounding line posterior to error (with eof check)\n                for (i = minLine; i < maxLine; i++) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn(lines[i].replace(/^[ \\t]+/g, ''));\n                }\n            }\n        },\n\n        compile: function(gl, errorCallback) {\n            if (!this._gl) this.setGraphicContext(gl);\n            this.shader = gl.createShader(this.type);\n\n            var shaderText = this.text;\n            gl.shaderSource(this.shader, shaderText);\n            __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].timeStamp('osgjs.metrics:compileShader');\n            gl.compileShader(this.shader);\n            if (!gl.getShaderParameter(this.shader, gl.COMPILE_STATUS) && !gl.isContextLost()) {\n                var err = gl.getShaderInfoLog(this.shader);\n\n\n                this.processErrors(err, shaderText);\n\n                var tmpText = shaderText;\n                var splittedText = tmpText.split('\\n');\n                var newText = '\\n';\n                for (var i = 0, l = splittedText.length; i < l; ++i) {\n                    newText += i + ' ' + splittedText[i] + '\\n';\n                }\n                // still logging whole source but folded\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].errorFold(\"can't compile shader\", newText);\n                if (errorCallback) errorCallback(this.shaderText, newText, err);\n\n                return false;\n            }\n            return true;\n        },\n        releaseGLObjects: function() {\n            if (this._gl !== undefined) {\n                Shader.deleteGLShader(this._gl, this.shader);\n                __WEBPACK_IMPORTED_MODULE_3_osg_GLObject__[\"a\" /* default */].removeObject(this._gl, this);\n            }\n            this.invalidate();\n        },\n        invalidate: function() {\n            this.shader = undefined;\n        }\n    }),\n    'osg',\n    'Shader'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Shader);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Shader.js\n// module id = 26\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Shader.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\n/**\n * This is a very simplistic version of the OSG registry, we could\n * expand/improve it in the future\n */\n\nvar Registry = {\n    instance: function() {\n        if (!Registry._instance) {\n            Registry._instance = Registry;\n            Registry._instance.plugins = new window.Map();\n        }\n        return Registry._instance;\n    },\n\n    // We register directly a plugin for a extension.\n    addReaderWriter: function(extension, plugin) {\n        if (Registry.instance().plugins.get(extension) !== undefined)\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn("the \'" + extension + "\' plugin already exists");\n        Registry.instance().plugins.set(extension, plugin);\n    },\n\n    getReaderWriterForExtension: function(name) {\n        return Registry.instance().plugins.get(name);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (Registry);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/Registry.js\n// module id = 27\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/Registry.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\nvar BoundingBox = function() {\n    this._min = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n    this._max = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    BoundingBox,\n    {\n        init: function() {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._min, __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].INFINITY);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._max, __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].NEGATIVE_INFINITY);\n        },\n\n        volume: function() {\n            var v = this._max[0] - this._min[0];\n            v *= this._max[1] - this._min[1];\n            v *= this._max[2] - this._min[2];\n            return v;\n        },\n\n        copy: function(box) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._min, box._min);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._max, box._max);\n        },\n\n        valid: function() {\n            return (\n                this._max[0] >= this._min[0] &&\n                this._max[1] >= this._min[1] &&\n                this._max[2] >= this._min[2]\n            );\n        },\n\n        expandByBoundingSphere: function(bs) {\n            if (!bs.valid()) {\n                return;\n            }\n            var max = this._max;\n            var min = this._min;\n            var radius = bs._radius;\n            var x = bs._center[0];\n            var y = bs._center[1];\n            var z = bs._center[2];\n            min[0] = Math.min(min[0], x - radius);\n            min[1] = Math.min(min[1], y - radius);\n            min[2] = Math.min(min[2], z - radius);\n\n            max[0] = Math.max(max[0], x + radius);\n            max[1] = Math.max(max[1], y + radius);\n            max[2] = Math.max(max[2], z + radius);\n        },\n\n        expandByvec3: function(v) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'deprecated, use expandByVec3\');\n            this.expandByVec3(v);\n        },\n\n        expandByVec3: function(v) {\n            var min = this._min;\n            var max = this._max;\n            min[0] = Math.min(min[0], v[0]);\n            min[1] = Math.min(min[1], v[1]);\n            min[2] = Math.min(min[2], v[2]);\n\n            max[0] = Math.max(max[0], v[0]);\n            max[1] = Math.max(max[1], v[1]);\n            max[2] = Math.max(max[2], v[2]);\n        },\n\n        expandByBoundingBox: function(bb) {\n            if (!bb.valid()) return;\n\n            var min = this._min;\n            var max = this._max;\n            var bbmin = bb._min;\n            var bbmax = bb._max;\n\n            if (bbmin[0] < min[0]) min[0] = bbmin[0];\n            if (bbmax[0] > max[0]) max[0] = bbmax[0];\n\n            if (bbmin[1] < min[1]) min[1] = bbmin[1];\n            if (bbmax[1] > max[1]) max[1] = bbmax[1];\n\n            if (bbmin[2] < min[2]) min[2] = bbmin[2];\n            if (bbmax[2] > max[2]) max[2] = bbmax[2];\n        },\n\n        center: function(result) {\n            var min = this._min;\n            var max = this._max;\n            result[0] = (min[0] + max[0]) * 0.5;\n            result[1] = (min[1] + max[1]) * 0.5;\n            result[2] = (min[2] + max[2]) * 0.5;\n            return result;\n        },\n\n        radius: function() {\n            return Math.sqrt(this.radius2());\n        },\n\n        radius2: function() {\n            var min = this._min;\n            var max = this._max;\n            var dx = max[0] - min[0];\n            var dy = max[1] - min[1];\n            var dz = max[2] - min[2];\n            return 0.25 * (dx * dx + dy * dy + dz * dz);\n        },\n\n        getMin: function() {\n            return this._min;\n        },\n\n        getMax: function() {\n            return this._max;\n        },\n\n        setMin: function(min) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._min, min);\n            return this;\n        },\n\n        setMax: function(max) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._max, max);\n            return this;\n        },\n\n        xMax: function() {\n            return this._max[0];\n        },\n\n        yMax: function() {\n            return this._max[1];\n        },\n\n        zMax: function() {\n            return this._max[2];\n        },\n\n        xMin: function() {\n            return this._min[0];\n        },\n\n        yMin: function() {\n            return this._min[1];\n        },\n\n        zMin: function() {\n            return this._min[2];\n        },\n\n        corner: function(pos, ret) {\n            /*jshint bitwise: false */\n            if (pos & 1) {\n                ret[0] = this._max[0];\n            } else {\n                ret[0] = this._min[0];\n            }\n            if (pos & 2) {\n                ret[1] = this._max[1];\n            } else {\n                ret[1] = this._min[1];\n            }\n            if (pos & 4) {\n                ret[2] = this._max[2];\n            } else {\n                ret[2] = this._min[2];\n            }\n            return ret;\n            /*jshint bitwise: true */\n        },\n\n        // http://dev.theomader.com/transform-bounding-boxes/\n        // https://github.com/erich666/GraphicsGems/blob/master/gems/TransBox.c\n        transformMat4: (function() {\n            var tmpMin = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n            var tmpMax = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n            return function(out, m) {\n                var inMin = this.getMin();\n                var inMax = this.getMax();\n\n                /* Take care of translation by beginning at T. */\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].getTranslation(tmpMin, m);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(tmpMax, tmpMin);\n\n                /* Now find the extreme points by considering the product of the */\n                /* min and max with each component of M.  */\n                for (var i = 0; i < 3; ++i) {\n                    var i4 = i * 4;\n                    var mini = inMin[i];\n                    var maxi = inMax[i];\n                    for (var j = 0; j < 3; ++j) {\n                        var cm = m[i4 + j];\n                        var a = cm * maxi;\n                        var b = cm * mini;\n                        if (a < b) {\n                            tmpMin[j] += a;\n                            tmpMax[j] += b;\n                        } else {\n                            tmpMin[j] += b;\n                            tmpMax[j] += a;\n                        }\n                    }\n                }\n                var outMax = out.getMax();\n                var outMin = out.getMin();\n\n                outMax[0] = tmpMax[0];\n                outMax[1] = tmpMax[1];\n                outMax[2] = tmpMax[2];\n\n                outMin[0] = tmpMin[0];\n                outMin[1] = tmpMin[1];\n                outMin[2] = tmpMin[2];\n\n                return out;\n            };\n        })()\n    },\n    \'osg\',\n    \'BoundingBox\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (BoundingBox);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BoundingBox.js\n// module id = 28\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BoundingBox.js?')},function(module,exports){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\n/**\n * @class Common utilities\n * @name glMatrix\n */\nvar glMatrix = {};\n\n// Configuration Constants\nglMatrix.EPSILON = 0.000001;\nglMatrix.ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\nglMatrix.RANDOM = Math.random;\nglMatrix.ENABLE_SIMD = false;\n\n// Capability detection\nglMatrix.SIMD_AVAILABLE = (glMatrix.ARRAY_TYPE === Float32Array) && ('SIMD' in this);\nglMatrix.USE_SIMD = glMatrix.ENABLE_SIMD && glMatrix.SIMD_AVAILABLE;\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Type} type Array type, such as Float32Array or Array\n */\nglMatrix.setMatrixArrayType = function(type) {\n    glMatrix.ARRAY_TYPE = type;\n}\n\nvar degree = Math.PI / 180;\n\n/**\n* Convert Degree To Radian\n*\n* @param {Number} Angle in Degrees\n*/\nglMatrix.toRadian = function(a){\n     return a * degree;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less \n * than or equal to 1.0, and a relative tolerance is used for larger values)\n * \n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nglMatrix.equals = function(a, b) {\n\treturn Math.abs(a - b) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a), Math.abs(b));\n}\n\nmodule.exports = glMatrix;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/common.js\n// module id = 29\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/common.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\n/**\n *  Manage Blending mode\n *  @class BlendFunc\n */\nvar BlendFunc = function(sourceRGB, destinationRGB, sourceAlpha, destinationAlpha) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].call(this);\n    this._sourceFactor = BlendFunc.DISABLE;\n    this._destinationFactor = BlendFunc.DISABLE;\n    this._sourceFactorAlpha = this._sourceFactor;\n    this._destinationFactorAlpha = this._destinationFactor;\n    this._separate = false;\n    if (sourceRGB !== undefined) {\n        this.setSource(sourceRGB);\n    }\n    if (destinationRGB !== undefined) {\n        this.setDestination(destinationRGB);\n    }\n\n    if (sourceAlpha !== undefined) {\n        this.setSourceAlpha(sourceAlpha);\n    }\n    if (destinationAlpha !== undefined) {\n        this.setDestinationAlpha(destinationAlpha);\n    }\n};\n\nBlendFunc.DISABLE = -1;\nBlendFunc.ZERO = 0;\nBlendFunc.ONE = 1;\nBlendFunc.SRC_COLOR = 0x0300;\nBlendFunc.ONE_MINUS_SRC_COLOR = 0x0301;\nBlendFunc.SRC_ALPHA = 0x0302;\nBlendFunc.ONE_MINUS_SRC_ALPHA = 0x0303;\nBlendFunc.DST_ALPHA = 0x0304;\nBlendFunc.ONE_MINUS_DST_ALPHA = 0x0305;\nBlendFunc.DST_COLOR = 0x0306;\nBlendFunc.ONE_MINUS_DST_COLOR = 0x0307;\nBlendFunc.SRC_ALPHA_SATURATE = 0x0308;\n\n/* Separate Blend Functions */\nBlendFunc.BLEND_DST_RGB = 0x80c8;\nBlendFunc.BLEND_SRC_RGB = 0x80c9;\nBlendFunc.BLEND_DST_ALPHA = 0x80ca;\nBlendFunc.BLEND_SRC_ALPHA = 0x80cb;\nBlendFunc.CONSTANT_COLOR = 0x8001;\nBlendFunc.ONE_MINUS_CONSTANT_COLOR = 0x8002;\nBlendFunc.CONSTANT_ALPHA = 0x8003;\nBlendFunc.ONE_MINUS_CONSTANT_ALPHA = 0x8004;\nBlendFunc.BLEND_COLOR = 0x8005;\n\n/** @lends BlendFunc.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    BlendFunc,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].prototype, {\n        /**\n         * StateAttribute type of BlendFunc\n         * @type String\n         */\n        attributeType: 'BlendFunc',\n        /**\n         * Create an instance of this StateAttribute\n         */\n        cloneType: function() /**BlendFunc*/ {\n            return new BlendFunc();\n        },\n        setSource: function(f) {\n            this.setSourceRGB(f);\n            this.setSourceAlpha(f);\n        },\n        getSource: function() {\n            return this._sourceFactor;\n        },\n        setDestination: function(f) {\n            this.setDestinationRGB(f);\n            this.setDestinationAlpha(f);\n        },\n        getDestination: function() {\n            return this._destinationFactor;\n        },\n        getSeparate: function() {\n            return this._separate;\n        },\n        checkSeparate: function() {\n            return (\n                this._sourceFactor !== this._sourceFactorAlpha ||\n                this._destinationFactor !== this._destinationFactorAlpha\n            );\n        },\n        setSourceRGB: function(f) {\n            if (typeof f === 'string') {\n                this._sourceFactor = BlendFunc[f];\n            } else {\n                this._sourceFactor = f;\n            }\n            this._separate = this.checkSeparate();\n        },\n        getSourceRGB: function() {\n            return this._sourceFactor;\n        },\n        setSourceAlpha: function(f) {\n            if (typeof f === 'string') {\n                this._sourceFactorAlpha = BlendFunc[f];\n            } else {\n                this._sourceFactorAlpha = f;\n            }\n            this._separate = this.checkSeparate();\n        },\n        getSourceAlpha: function() {\n            return this._sourceFactorAlpha;\n        },\n        setDestinationRGB: function(f) {\n            if (typeof f === 'string') {\n                this._destinationFactor = BlendFunc[f];\n            } else {\n                this._destinationFactor = f;\n            }\n            this._separate = this.checkSeparate();\n        },\n        getDestinationRGB: function() {\n            return this._destinationFactor;\n        },\n        setDestinationAlpha: function(f) {\n            if (typeof f === 'string') {\n                this._destinationFactorAlpha = BlendFunc[f];\n            } else {\n                this._destinationFactorAlpha = f;\n            }\n            this._separate = this.checkSeparate();\n        },\n        getDestinationAlpha: function() {\n            return this._destinationFactorAlpha;\n        },\n\n        /**\n         * Apply the mode, must be called in the draw traversal\n         * @param state\n         */\n        apply: function(state) {\n            state.applyBlendFunc(this);\n        }\n    }),\n    'osg',\n    'BlendFunc'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (BlendFunc);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BlendFunc.js\n// module id = 30\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BlendFunc.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Timer__ = __webpack_require__(22);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_WebGLCaps__ = __webpack_require__(18);\n\n\n\n\n\n\n\n/**\n * FrameBufferObject manage fbo / rtt\n * @class FrameBufferObject\n */\nvar FrameBufferObject = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].call(this);\n    __WEBPACK_IMPORTED_MODULE_3_osg_StateAttribute__["a" /* default */].call(this);\n\n    this._fbo = undefined;\n    this._rbo = undefined;\n    this._attachments = [];\n    this._buffers = [];\n    this._dirty = true;\n    this._hasMRT = __WEBPACK_IMPORTED_MODULE_5_osg_WebGLCaps__["a" /* default */].instance().getWebGLExtension(\'WEBGL_draw_buffers\');\n};\n\nFrameBufferObject.COLOR_ATTACHMENT0 = 0x8ce0;\nFrameBufferObject.DEPTH_ATTACHMENT = 0x8d00;\nFrameBufferObject.DEPTH_COMPONENT16 = 0x81a5;\n\n// static cache of glFrameBuffer flagged for deletion, which will actually\n// be deleted in the correct GL context.\nFrameBufferObject._sDeletedGLFrameBufferCache = new window.Map();\n\n// static method to delete FrameBuffers\nFrameBufferObject.deleteGLFrameBuffer = function(gl, fb) {\n    if (!FrameBufferObject._sDeletedGLFrameBufferCache.has(gl))\n        FrameBufferObject._sDeletedGLFrameBufferCache.set(gl, []);\n\n    FrameBufferObject._sDeletedGLFrameBufferCache.get(gl).push(fb);\n};\n\n// static method to flush all the cached glFrameBuffers which need to be deleted in the GL context specified\nFrameBufferObject.flushDeletedGLFrameBuffers = function(gl, availableTime) {\n    // if no time available don\'t try to flush objects.\n    if (availableTime <= 0.0) return availableTime;\n\n    if (!FrameBufferObject._sDeletedGLFrameBufferCache.has(gl)) return availableTime;\n    var deleteList = FrameBufferObject._sDeletedGLFrameBufferCache.get(gl);\n    if (deleteList.length === 0) return availableTime;\n\n    var elapsedTime = 0.0;\n    var beginTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n    var numBuffers = deleteList.length;\n    for (var i = numBuffers - 1; i >= 0 && elapsedTime < availableTime; i--) {\n        gl.deleteFramebuffer(deleteList[i]);\n        deleteList.splice(i, 1);\n        elapsedTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n    }\n\n    return availableTime - elapsedTime;\n};\n\nFrameBufferObject.flushAllDeletedGLFrameBuffers = function(gl) {\n    if (!FrameBufferObject._sDeletedGLFrameBufferCache.has(gl)) return;\n    var deleteList = FrameBufferObject._sDeletedGLFrameBufferCache.get(gl);\n    if (deleteList.length === 0) return;\n    var numBuffers = deleteList.length;\n    for (var i = numBuffers - 1; i >= 0; i--) {\n        gl.deleteFramebuffer(deleteList[i]);\n        deleteList.splice(i, 1);\n    }\n};\n\n// static cache of glRenderBuffer flagged for deletion, which will actually\n// be deleted in the correct GL context.\nFrameBufferObject._sDeletedGLRenderBufferCache = new window.Map();\n\n// static method to delete RenderBuffers\nFrameBufferObject.deleteGLRenderBuffer = function(gl, fb) {\n    if (!FrameBufferObject._sDeletedGLRenderBufferCache.has(gl))\n        FrameBufferObject._sDeletedGLRenderBufferCache.set(gl, []);\n\n    FrameBufferObject._sDeletedGLRenderBufferCache.get(gl).push(fb);\n};\n\n// static method to flush all the cached glRenderBuffers which need to be deleted in the GL context specified\nFrameBufferObject.flushDeletedGLRenderBuffers = function(gl, availableTime) {\n    // if no time available don\'t try to flush objects.\n    if (availableTime <= 0.0) return availableTime;\n\n    if (!FrameBufferObject._sDeletedGLRenderBufferCache.has(gl)) return availableTime;\n\n    var elapsedTime = 0.0;\n    var beginTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n    var deleteList = FrameBufferObject._sDeletedGLRenderBufferCache.get(gl);\n    var numBuffers = deleteList.length;\n\n    for (var i = numBuffers - 1; i >= 0 && elapsedTime < availableTime; i--) {\n        gl.deleteRenderbuffer(deleteList[i]);\n        deleteList.splice(i, 1);\n        elapsedTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n    }\n    return availableTime - elapsedTime;\n};\n\nFrameBufferObject.flushAllDeletedGLRenderBuffers = function(gl) {\n    if (!FrameBufferObject._sDeletedGLRenderBufferCache.has(gl)) return;\n\n    var deleteList = FrameBufferObject._sDeletedGLRenderBufferCache.get(gl);\n    var numBuffers = deleteList.length;\n\n    for (var i = numBuffers - 1; i >= 0; i--) {\n        gl.deleteRenderbuffer(deleteList[i]);\n        deleteList.splice(i, 1);\n    }\n};\n\nFrameBufferObject.onLostContext = function(gl) {\n    if (!FrameBufferObject._sDeletedGLFrameBufferCache.has(gl)) return;\n\n    var deleteList = FrameBufferObject._sDeletedGLFrameBufferCache.get(gl);\n    deleteList.length = 0;\n\n    if (!FrameBufferObject._sDeletedGLRenderBufferCache.has(gl)) return;\n\n    deleteList = FrameBufferObject._sDeletedGLRenderBufferCache.get(gl);\n    deleteList.length = 0;\n};\n\n/** @lends FrameBufferObject.prototype */\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    FrameBufferObject,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(\n        __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].prototype,\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_StateAttribute__["a" /* default */].prototype, {\n            attributeType: \'FrameBufferObject\',\n\n            cloneType: function() {\n                return new FrameBufferObject();\n            },\n\n            invalidate: function() {\n                if (this._rbo && this._attachments) {\n                    for (var i = 0, l = this._attachments.length; i < l; ++i) {\n                        var attachment = this._attachments[i];\n                        // shared renderbuffer object between camera\n                        // must still be set to null as it\'s webgl object\n                        // apply will reshare it when creating it.\n                        if (!attachment.texture) {\n                            attachment.renderBufferObject = undefined;\n                        }\n                    }\n                    this._rbo = undefined;\n                }\n                this._fbo = undefined;\n                this._buffers.length = 0;\n                this._dirty = true;\n            },\n\n            dirty: function() {\n                this._buffers.length = 0;\n                this._dirty = true;\n            },\n\n            isDirty: function() {\n                return this._dirty;\n            },\n\n            setAttachment: function(attachment) {\n                this._attachments.push(attachment);\n            },\n\n            getAttachment: function(attachmentType) {\n                if (!this._attachments) return;\n                for (var i = 0, l = this._attachments.length; i < l; ++i) {\n                    var attachment = this._attachments[i];\n                    // shared renderbuffer object between camera\n                    // must still be set to null as it\'s webgl object\n                    // apply will reshare it when creating it.\n                    if (attachment.attachment === attachmentType) {\n                        return attachment;\n                    }\n                }\n                return;\n            },\n            releaseGLObjects: function() {\n                if (this._fbo !== undefined && this._gl !== undefined) {\n                    FrameBufferObject.deleteGLFrameBuffer(this._gl, this._fbo);\n                }\n                this._fbo = undefined;\n\n                if (this._rbo !== undefined && this._gl !== undefined) {\n                    FrameBufferObject.deleteGLRenderBuffer(this._gl, this._rbo);\n                }\n                this.invalidate();\n            },\n\n            _reportFrameBufferError: function(code) {\n                switch (code) {\n                    case 0x8cd6:\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].debug(\'FRAMEBUFFER_INCOMPLETE_ATTACHMENT\');\n                        break;\n                    case 0x8cd7:\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].debug(\'FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\');\n                        break;\n                    case 0x8cd9:\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].debug(\'FRAMEBUFFER_INCOMPLETE_DIMENSIONS\');\n                        break;\n                    case 0x8cdd:\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].debug(\'FRAMEBUFFER_UNSUPPORTED\');\n                        break;\n                    default:\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].debug(\'FRAMEBUFFER unknown error \' + code.toString(16));\n                }\n            },\n\n            reset: function() {\n                this.releaseGLObjects();\n                this._attachments = [];\n            },\n\n            getFrameBufferObject: function() {\n                return this._fbo;\n            },\n\n            getRenderBufferObject: function() {\n                return this._rbo;\n            },\n\n            createFrameBufferObject: function(state) {\n                this.setGraphicContext(state.getGraphicContext());\n                this._fbo = this._gl.createFramebuffer();\n            },\n\n            createRenderBuffer: function(format, width, height) {\n                var gl = this._gl;\n                var renderBuffer = gl.createRenderbuffer();\n                gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n                gl.renderbufferStorage(gl.RENDERBUFFER, format, width, height);\n\n                return renderBuffer;\n            },\n\n            framebufferRenderBuffer: function(attachment, renderBuffer) {\n                var gl = this._gl;\n                gl.bindRenderbuffer(gl.RENDERBUFFER, renderBuffer);\n                gl.framebufferRenderbuffer(\n                    gl.FRAMEBUFFER,\n                    attachment,\n                    gl.RENDERBUFFER,\n                    renderBuffer\n                );\n\n                /* develblock:start */\n                // only visible with webgl-insector enabled\n                if (gl.rawgl !== undefined) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'FBO: renderBuffer: \' + this._fbo.trackedObject.defaultName);\n                }\n                /* develblock:end */\n            },\n\n            framebufferTexture2D: function(state, attachment, textureTarget, texture) {\n                var gl = this._gl;\n\n                // apply on unit 1 to init it\n                // make sure we do bind it whatever state stack\n                // texture is cached\n                state.applyTextureAttribute(1, texture);\n\n                if (texture.isDirty() || !texture.getTextureObject()) {\n                    // image wasn\'t ready, texture not allocated due to lack of gpu MEM\n                    return false;\n                }\n\n                // gl2 vs gl1\n                var target = gl.DRAW_FRAMEBUFFER || gl.FRAMEBUFFER;\n                gl.framebufferTexture2D(\n                    target,\n                    attachment,\n                    textureTarget,\n                    texture.getTextureObject().id(),\n                    0\n                );\n\n                /* develblock:start */\n                // only visible with webgl-insector enabled\n                // allow trace debug (fb<->texture link)\n                if (gl.rawgl !== undefined) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\n                        \'FBO: texture: \' +\n                            texture.getName() +\n                            \' : \' +\n                            texture.getTextureObject().id().trackedObject.defaultName +\n                            \' fbo: \' +\n                            this._fbo.trackedObject.defaultName\n                    );\n                }\n                /* develblock:end */\n\n                return true;\n            },\n\n            bindFrameBufferObject: function() {\n                var gl = this._gl;\n                gl.bindFramebuffer(gl.FRAMEBUFFER, this._fbo);\n            },\n\n            checkStatus: function() {\n                var gl = this._gl;\n                var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\n                if (status !== gl.FRAMEBUFFER_COMPLETE) {\n                    this._reportFrameBufferError(status);\n                }\n            },\n\n            _checkAllowedSize: function(w, h) {\n                var maxSize = __WEBPACK_IMPORTED_MODULE_5_osg_WebGLCaps__["a" /* default */].instance().getWebGLParameter(\'MAX_RENDERBUFFER_SIZE\');\n\n                if (w === 0 || h === 0 || h > maxSize || w > maxSize) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].error(\n                        \'width (\' +\n                            w +\n                            \') or height (\' +\n                            w +\n                            \') makes frame buffer not bindable. Max RenderBuffer is "\' +\n                            maxSize +\n                            \'"\'\n                    );\n                    return false;\n                }\n\n                return true;\n            },\n\n            apply: function(state) {\n                if (!this._gl) this.setGraphicContext(state.getGraphicContext());\n                var gl = this._gl;\n\n                var attachments = this._attachments;\n\n                // ?\n                if (attachments.length === 0 && !this._fbo) {\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n                    return;\n                }\n\n                // each frame\n                if (!this.isDirty()) {\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, this._fbo);\n                    if (__WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].reportWebGLError === true) this.checkStatus();\n                    return;\n                }\n\n                // if the fbo is created manually, we want to just bind it\n                if (!this._fbo) this.createFrameBufferObject(state);\n\n                this.bindFrameBufferObject();\n\n                // Check extDrawBuffers extension\n                var bufs = this._hasMRT ? this._buffers : undefined;\n                var hasRenderBuffer = false;\n\n                for (var i = 0, l = attachments.length; i < l; ++i) {\n                    var attachment = attachments[i];\n\n                    // render buffer\n                    if (!attachment.texture) {\n                        if (!this._checkAllowedSize(attachment.width, attachment.height)) {\n                            this.releaseGLObjects();\n                            return;\n                        }\n                        if (attachment.renderBufferObject) {\n                            // shared renderbuffer object between camera\n                            // ie: early-z\n                            this._rbo = attachment.renderBufferObject;\n                        } else {\n                            this._rbo = this.createRenderBuffer(\n                                attachment.format,\n                                attachment.width,\n                                attachment.height\n                            );\n                            // necessary for shared attachment between camera\n                            attachment.renderBufferObject = this._rbo;\n                        }\n                        this.framebufferRenderBuffer(attachment.attachment, this._rbo);\n                        hasRenderBuffer = true;\n                    } else {\n                        // use texture\n                        var texture = attachment.texture;\n\n                        if (!this._checkAllowedSize(texture.getWidth(), texture.getHeight())) {\n                            this.releaseGLObjects();\n                            return;\n                        }\n\n                        // Not sure is needed to check the attachment.attachment\n                        if (\n                            this._hasMRT &&\n                            attachment.attachment >= gl.COLOR_ATTACHMENT0 &&\n                            attachment.attachment <= gl.COLOR_ATTACHMENT15 &&\n                            bufs.indexOf(attachment.attachment) === -1\n                        ) {\n                            bufs.push(attachment.attachment);\n                        }\n\n                        if (\n                            !this.framebufferTexture2D(\n                                state,\n                                attachment.attachment,\n                                attachment.textureTarget,\n                                texture\n                            )\n                        ) {\n                            this.releaseGLObjects();\n                            return;\n                        }\n                    }\n                }\n\n                if (bufs && bufs.length > 0) {\n                    gl.drawBuffers(bufs);\n                }\n\n                this.checkStatus();\n\n                // set it to null only if used renderbuffer\n                if (hasRenderBuffer) gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n\n                this._dirty = false;\n            }\n        })\n    ),\n    \'osg\',\n    \'FrameBufferObject\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (FrameBufferObject);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/FrameBufferObject.js\n// module id = 31\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/FrameBufferObject.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\nvar Depth = function(func, near, far, writeMask) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n\n    this._func = Depth.LESS;\n    this._near = 0.0;\n    this._far = 1.0;\n    this._writeMask = true;\n\n    if (func !== undefined) {\n        if (typeof func === \'string\') {\n            this._func = Depth[func];\n        } else {\n            this._func = func;\n        }\n    }\n    if (near !== undefined) {\n        this._near = near;\n    }\n    if (far !== undefined) {\n        this._far = far;\n    }\n    if (writeMask !== undefined) {\n        this._writeMask = writeMask;\n    }\n};\n\nDepth.DISABLE = 0x0000;\nDepth.NEVER = 0x0200;\nDepth.LESS = 0x0201;\nDepth.EQUAL = 0x0202;\nDepth.LEQUAL = 0x0203;\nDepth.GREATER = 0x0204;\nDepth.NOTEQUAL = 0x0205;\nDepth.GEQUAL = 0x0206;\nDepth.ALWAYS = 0x0207;\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    Depth,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Depth\',\n        cloneType: function() {\n            return new Depth();\n        },\n        setRange: function(near, far) {\n            this._near = near;\n            this._far = far;\n        },\n        setWriteMask: function(mask) {\n            this._writeMask = mask;\n        },\n        getWriteMask: function() {\n            return this._writeMask;\n        },\n        getFunc: function() {\n            return this._func;\n        },\n        apply: function(state) {\n            state.applyDepth(this);\n        }\n    }),\n    \'osg\',\n    \'Depth\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Depth);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Depth.js\n// module id = 32\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Depth.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_Projection__ = __webpack_require__(78);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgDB_Registry__ = __webpack_require__(27);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar ReaderParser = {};\n\nReaderParser.ObjectWrapper = {};\nReaderParser.ObjectWrapper.serializers = {};\n\nReaderParser.readImage = function(url, options) {\n    return ReaderParser.registry().readImageURL(url, options);\n};\nReaderParser.readImageURL = ReaderParser.readImage; // alias\n\nReaderParser.readBinaryArrayURL = function(url, options) {\n    return ReaderParser.registry().readBinaryArrayURL(url, options);\n};\n\nReaderParser.readNodeURL = function(url, options) {\n    var extension = url.substr(url.lastIndexOf(\'.\') + 1);\n    var readerWriter = __WEBPACK_IMPORTED_MODULE_14_osgDB_Registry__["a" /* default */].instance().getReaderWriterForExtension(extension);\n    if (readerWriter !== undefined) return readerWriter.readNodeURL(url, options);\n    // If we don\'t have a registered plugin go through the osgjs\n    // FIXME: we should have osgjs also as a plugin in the future\n    return ReaderParser.registry().readNodeURL(url, options);\n};\n\nReaderParser.registry = function() {\n    var Input = __webpack_require__(40).default;\n    if (ReaderParser.registry._input === undefined) {\n        ReaderParser.registry._input = new Input();\n    }\n    return ReaderParser.registry._input;\n};\n\nReaderParser.parseSceneGraph = function(node, options) {\n    if (node.Version !== undefined && node.Version > 0) {\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].time(\'osgjs.metric:ReaderParser.parseSceneGraph\', __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].INFO);\n\n        var key;\n        for (var prop in node) {\n            if (prop !== \'Generator\' && prop !== \'Version\') {\n                key = prop;\n                break;\n            }\n        }\n\n        if (key) {\n            var obj = {};\n            obj[key] = node[key];\n            var input = ReaderParser.registry().clone();\n            input.setJSON(obj);\n\n            // copy global options and override with user options\n            var opt = __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectMix(\n                __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectMix({}, ReaderParser.registry().getOptions()),\n                options || {}\n            );\n            input.setOptions(opt);\n            var object = input.readObject();\n            __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].timeEnd(\'osgjs.metric:ReaderParser.parseSceneGraph\', __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].INFO);\n            return object;\n        } else {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log("can\'t parse scenegraph " + node, __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].INFO);\n        }\n    } else {\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].time(\'osgjs.metric:ReaderParser.parseSceneGraphDeprecated\', __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].INFO);\n        var nodeOld = ReaderParser.parseSceneGraphDeprecated(node);\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].timeEnd(\'osgjs.metric:ReaderParser.parseSceneGraphDeprecated\', __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].INFO);\n        return nodeOld;\n    }\n    return undefined;\n};\n\nReaderParser.parseSceneGraphDeprecated = function(node) {\n    var getFieldBackwardCompatible = function(field, json) {\n        var value = json[field];\n        if (value === undefined) {\n            value = json[field.toLowerCase()];\n        }\n        return value;\n    };\n    var setName = function(osgjs, json) {\n        var name = getFieldBackwardCompatible(\'Name\', json);\n        if (name && osgjs.setName !== undefined) {\n            osgjs.setName(name);\n        }\n    };\n\n    var setMaterial = function(osgjs, json) {\n        setName(osgjs, json);\n        osgjs.setAmbient(getFieldBackwardCompatible(\'Ambient\', json));\n        osgjs.setDiffuse(getFieldBackwardCompatible(\'Diffuse\', json));\n        osgjs.setEmission(getFieldBackwardCompatible(\'Emission\', json));\n        osgjs.setSpecular(getFieldBackwardCompatible(\'Specular\', json));\n        osgjs.setShininess(getFieldBackwardCompatible(\'Shininess\', json));\n    };\n\n    var setBlendFunc = function(osgjs, json) {\n        setName(osgjs, json);\n        osgjs.setSourceRGB(json.SourceRGB);\n        osgjs.setSourceAlpha(json.SourceAlpha);\n        osgjs.setDestinationRGB(json.DestinationRGB);\n        osgjs.setDestinationAlpha(json.DestinationAlpha);\n    };\n\n    var setTexture = function(osgjs, json) {\n        var magFilter = json.MagFilter || json[\'mag_filter\'] || undefined;\n        if (magFilter) {\n            osgjs.setMagFilter(magFilter);\n        }\n        var minFilter = json.MinFilter || json[\'min_filter\'] || undefined;\n        if (minFilter) {\n            osgjs.setMinFilter(minFilter);\n        }\n        var wrapT = json.WrapT || json[\'wrap_t\'] || undefined;\n        if (wrapT) {\n            osgjs.setWrapT(wrapT);\n        }\n        var wrapS = json.WrapS || json[\'wrap_s\'] || undefined;\n        if (wrapS) {\n            osgjs.setWrapS(wrapS);\n        }\n        var file = getFieldBackwardCompatible(\'File\', json);\n        ReaderParser.readImage(file)\n            .then(function(img) {\n                osgjs.setImage(img);\n            })\n            .catch(function() {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log("Can\'t read image");\n            });\n    };\n\n    var setStateSet = function(osgjs, json) {\n        setName(osgjs, json);\n        var textures =\n            getFieldBackwardCompatible(\'Textures\', json) ||\n            getFieldBackwardCompatible(\'TextureAttributeList\', json) ||\n            undefined;\n        if (textures) {\n            for (var t = 0, tl = textures.length; t < tl; t++) {\n                var file = getFieldBackwardCompatible(\'File\', textures[t]);\n                if (!file) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'no texture on unit \' + t + \' skip it\');\n                    continue;\n                }\n                var Texture = __webpack_require__(7).default;\n                var tex = new Texture();\n                setTexture(tex, textures[t]);\n\n                osgjs.setTextureAttributeAndModes(t, tex);\n                osgjs.addUniform(__WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createInt1(t, \'Texture\' + t));\n            }\n        }\n\n        var blendfunc = getFieldBackwardCompatible(\'BlendFunc\', json);\n        if (blendfunc) {\n            var newblendfunc = new __WEBPACK_IMPORTED_MODULE_3_osg_BlendFunc__["a" /* default */]();\n            setBlendFunc(newblendfunc, blendfunc);\n            osgjs.setAttributeAndModes(newblendfunc);\n        }\n\n        var material = getFieldBackwardCompatible(\'Material\', json);\n        if (material) {\n            var Material = __webpack_require__(86).default;\n            var newmaterial = new Material();\n            setMaterial(newmaterial, material);\n            osgjs.setAttributeAndModes(newmaterial);\n        }\n    };\n\n    var newnode;\n    var children = node.children;\n    var primitives = node._primitives || node.primitives || node.Primitives || undefined;\n    var attributes = node._attributes || node.attributes || node.Attributes || undefined;\n    if (primitives || attributes) {\n        var geom = new __WEBPACK_IMPORTED_MODULE_4_osg_Geometry__["a" /* default */]();\n        setName(geom, node);\n        geom.stateset = node.stateset;\n        node = geom;\n\n        for (var p = 0, lp = primitives.length; p < lp; p++) {\n            var mode = primitives[p].mode;\n            if (primitives[p].indices) {\n                var array = primitives[p].indices;\n                array = new __WEBPACK_IMPORTED_MODULE_5_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_5_osg_BufferArray__["a" /* default */][array.type], array.elements, array.itemSize);\n                if (!mode) {\n                    mode = \'TRIANGLES\';\n                } else {\n                    mode = __WEBPACK_IMPORTED_MODULE_6_osg_primitiveSet__["a" /* default */][mode];\n                }\n                geom.getPrimitiveSetList().push(new __WEBPACK_IMPORTED_MODULE_8_osg_DrawElements__["a" /* default */](mode, array));\n            } else {\n                mode = __WEBPACK_IMPORTED_MODULE_6_osg_primitiveSet__["a" /* default */][mode];\n                var first = primitives[p].first;\n                var count = primitives[p].count;\n\n                geom.getPrimitiveSetList().push(new __WEBPACK_IMPORTED_MODULE_7_osg_DrawArrays__["a" /* default */](mode, first, count));\n            }\n        }\n\n        for (var attr in attributes) {\n            var attributeArray = attributes[attr];\n            geom.getVertexAttributeList()[attr] = new __WEBPACK_IMPORTED_MODULE_5_osg_BufferArray__["a" /* default */](\n                attributeArray.type,\n                attributeArray.elements,\n                attributeArray.itemSize\n            );\n        }\n    }\n\n    var stateset = getFieldBackwardCompatible(\'StateSet\', node);\n    if (stateset) {\n        var newstateset = new __WEBPACK_IMPORTED_MODULE_9_osg_StateSet__["a" /* default */]();\n        setStateSet(newstateset, stateset);\n        node.stateset = newstateset;\n    }\n\n    var matrix = node.matrix || node.Matrix || undefined;\n    if (matrix) {\n        newnode = new __WEBPACK_IMPORTED_MODULE_12_osg_MatrixTransform__["a" /* default */]();\n        setName(newnode, node);\n\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].extend(newnode, node);\n        __WEBPACK_IMPORTED_MODULE_11_osg_glMatrix__["c" /* mat4 */].copy(newnode.getMatrix(), matrix);\n        node = newnode;\n    }\n\n    var projection = node.projection || node.Projection || undefined;\n    if (projection) {\n        newnode = new __WEBPACK_IMPORTED_MODULE_13_osg_Projection__["a" /* default */]();\n        setName(newnode, node);\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].extend(newnode, node);\n        __WEBPACK_IMPORTED_MODULE_11_osg_glMatrix__["c" /* mat4 */].copy(newnode.setProjectionMatrix(), projection);\n        node = newnode;\n    }\n\n    // default type\n    if (node.typeID === undefined) {\n        newnode = new __WEBPACK_IMPORTED_MODULE_10_osg_Node__["a" /* default */]();\n        setName(newnode, node);\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].extend(newnode, node);\n        node = newnode;\n    }\n\n    if (children) {\n        // disable children, it will be processed in the end\n        node.children = [];\n\n        for (var child = 0, childLength = children.length; child < childLength; child++) {\n            node.addChild(ReaderParser.parseSceneGraphDeprecated(children[child]));\n        }\n    }\n\n    return node;\n};\n\n// $$ SOURCE_CODE_MODIFIED\n// ---\nReaderParser.readImageURL = function(url, options) {\n    var extension = url.substr(url.lastIndexOf(\'.\') + 1);\n    var readerWriter = __WEBPACK_IMPORTED_MODULE_14_osgDB_Registry__["a" /* default */].instance().getReaderWriterForExtension(extension);\n    if (readerWriter !== undefined) return readerWriter.readImageURL(url, options);\n    return ReaderParser.registry().readImageURL(url, options);\n};\nReaderParser.readImage = ReaderParser.readImageURL;\n// ---加载完节点后，给个机会修改节点\n// 方法一\nvar wrapperOnlyReadNodeURL = function(fn, name) {\n    return function() {\n        // if(!this._fragmentShaderMode) {\n        // }\n        var url = arguments[0];\n        var options = arguments[1];\n        return fn.apply(this, arguments).then(\n            function(node) {\n                if(node instanceof __WEBPACK_IMPORTED_MODULE_10_osg_Node__["a" /* default */] && ReaderParser.readNodeURL.parseNodeCallback) {\n                    ReaderParser.readNodeURL.parseNodeCallback(node);\n                }\n                return node;\n            },\n            function(node) {\n            }\n        );\n    };\n};\nReaderParser[\'readNodeURL\'] = wrapperOnlyReadNodeURL(ReaderParser[\'readNodeURL\'], \'readNodeURL\');\n// 方法二\n/*ReaderParser.readNodeURL = function(url, options) {\n    var promise;\n\n    var extension = url.substr(url.lastIndexOf(\'.\') + 1);\n    var readerWriter = Registry.instance().getReaderWriterForExtension(extension);\n    if (readerWriter !== undefined) promise = readerWriter.readNodeURL(url, options);\n    // If we don\'t have a registered plugin go through the osgjs\n    // FIXME: we should have osgjs also as a plugin in the future\n    promise = ReaderParser.registry().readNodeURL(url, options);\n\n    return promise.then(function(node) {\n        if(ReaderParser.readNodeURL.parseNodeCallback) {\n            ReaderParser.readNodeURL.parseNodeCallback(node);\n        }\n        return node;\n    });\n};*/\n// $$ SOURCE_CODE_MODIFIED\n\n/* harmony default export */ __webpack_exports__["default"] = (ReaderParser);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/readerParser.js\n// module id = 33\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/readerParser.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n\n\n\n\nvar ImageBitmap = window.ImageBitmap || function() {};\n\nvar ImageObject = function(image) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].call(this);\n\n    this._imageObject = undefined;\n    this._url = undefined;\n    this._width = undefined;\n    this._height = undefined;\n    this._dirty = true;\n    this._mipmap = [];\n\n    if (image) {\n        this.setImage(image);\n    }\n\n    this._isGreyscale = undefined;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    ImageObject,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].prototype, {\n        dirty: function() {\n            this._isGreyscale = undefined;\n            this._dirty = true;\n        },\n\n        isDirty: function() {\n            return this._dirty;\n        },\n\n        setDirty: function(bool) {\n            this._dirty = bool;\n        },\n\n        getImage: function() {\n            return this._imageObject instanceof ImageObject\n                ? this._imageObject.getImage()\n                : this._imageObject;\n        },\n\n        getURL: function() {\n            return this._url;\n        },\n\n        setURL: function(url) {\n            this._url = url;\n        },\n\n        useOrCreateImage: function(img) {\n            return img instanceof ImageObject === false ? new ImageObject(img) : img;\n        },\n\n        setImage: function(img) {\n            if (!this._url && img && (img.src || img.currentSrc)) {\n                // TODO what is currentSrc ?\n                this._url = img.src || img.currentSrc;\n            }\n\n            this._mipmap.length = 0;\n\n            // img can be an image or an array of image if specify the\n            // all mipmap levels\n            if (Array.isArray(img)) {\n                for (var i = 0, nbImg = img.length; i < nbImg; i++) {\n                    this._mipmap.push(this.useOrCreateImage(img[i]));\n                }\n                this.setWidth(this._mipmap[0].getWidth());\n                this.setHeight(this._mipmap[0].getHeight());\n            } else {\n                this._mipmap.push(img);\n            }\n\n            this._imageObject = this._mipmap[0];\n            this.dirty();\n        },\n\n        isCanvas: function() {\n            return this.getImage() instanceof window.HTMLCanvasElement;\n        },\n\n        isBitmap: function() {\n            return this.getImage() instanceof ImageBitmap;\n        },\n\n        isVideo: function() {\n            return this.getImage() instanceof window.HTMLVideoElement;\n        },\n\n        isImage: function() {\n            return this.getImage() instanceof window.Image;\n        },\n\n        isTypedArray: function() {\n            var img = this.getImage();\n            return (\n                img instanceof Uint8Array ||\n                img instanceof Float32Array ||\n                img instanceof Uint16Array\n            );\n        },\n\n        setWidth: function(w) {\n            this._width = w;\n        },\n\n        setHeight: function(h) {\n            this._height = h;\n        },\n\n        getWidth: function() {\n            var img = this.getImage();\n            if (this.isImage()) {\n                return img.naturalWidth;\n            } else if (this.isVideo()) {\n                return img.videoWidth;\n            } else if (this.isCanvas() || this.isBitmap()) {\n                return img.width;\n            }\n            return this._width;\n        },\n\n        getHeight: function() {\n            var img = this.getImage();\n            if (this.isImage()) {\n                return img.naturalHeight;\n            } else if (this.isVideo()) {\n                return img.videoHeight;\n            } else if (this.isCanvas() || this.isBitmap()) {\n                return img.height;\n            }\n            return this._height;\n        },\n\n        isGreyscale: function(nbSamples) {\n            if (this._isGreyscale !== undefined) return this._isGreyscale;\n\n            if (\n                this._imageObject !== undefined &&\n                this.isReady() &&\n                this._isGreyscale === undefined\n            ) {\n                var canvas = this._imageObject;\n                if (!this.isCanvas()) {\n                    canvas = document.createElement(\'canvas\');\n                }\n                var ctx = canvas.getContext(\'2d\');\n                canvas.width = this._imageObject.width;\n                canvas.height = this._imageObject.height;\n                ctx.drawImage(this._imageObject, 0, 0);\n\n                var sampleX, sampleY;\n                // cap sample if needed\n                if (!nbSamples) {\n                    sampleX = canvas.width;\n                    sampleY = canvas.height;\n                }\n                if (nbSamples > 0) {\n                    nbSamples = Math.min(Math.min(canvas.width, canvas.height), nbSamples);\n                    sampleX = sampleY = nbSamples;\n                }\n\n                var isGreyscale = true;\n                var xFactor = canvas.width / sampleX;\n                var yFactor = canvas.height / sampleY;\n                for (var i = 0; i < sampleX; i++) {\n                    for (var j = 0; j < sampleY; j++) {\n                        var x = Math.floor(xFactor * (i + 0.5)),\n                            y = Math.floor(yFactor * (j + 0.5));\n                        var data = ctx.getImageData(x, y, 1, 1).data;\n                        if (!(data[0] === data[1] && data[0] === data[2])) {\n                            isGreyscale = false;\n                            break;\n                        }\n                    }\n                }\n                this._isGreyscale = isGreyscale;\n            }\n\n            return this._isGreyscale;\n        },\n\n        isReady: function() {\n            // image is a osgImage\n            if (this._imageObject && this._imageObject instanceof ImageObject) {\n                return this._imageObject.isReady();\n            }\n\n            // image are ready for static data\n            if (this.isCanvas() || this.isTypedArray() || this.isBitmap()) {\n                return true;\n            }\n\n            if (this.isImage()) {\n                var image = this.getImage();\n                if (image.complete) {\n                    if (image.naturalWidth !== undefined && image.naturalWidth === 0) {\n                        return false;\n                    }\n\n                    return true;\n                }\n            }\n\n            if (this.isVideo()) {\n                if (this.getWidth() !== 0) return true;\n            }\n\n            // here means we have something but we don\'t know what\n            // Check if the object is not a image\n            // by "feature" detect it\n            var imageTry = this.getImage();\n            if (imageTry.complete) {\n                if (imageTry.naturalWidth !== undefined && imageTry.naturalWidth === 0) {\n                    return false;\n                }\n                return true;\n            }\n\n            // It\'s not something we recognise\n            /*develblock:start*/\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn("Warning can\'t detect image object ");\n            /*develblock:end*/\n            return false;\n        },\n\n        getMipmap: function() {\n            return this._mipmap;\n        },\n\n        hasMipmap: function() {\n            return this._mipmap.length > 1;\n        },\n\n        release: function() {\n            this._mipmap.length = 0;\n            this._imageObject = undefined;\n        }\n    }),\n    \'osg\',\n    \'Image\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ImageObject);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Image.js\n// module id = 34\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Image.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\n// Base class for GLResources: Textures, Buffers, Programs, Shaders, FrameBuffers and RenderBuffers\n// It holds a reference to the graphic context that is needed for resource deletion\nvar GLObject = function() {\n    this._gl = undefined;\n    this._onLostContextCallback = undefined;\n};\n\nGLObject.prototype = {\n    setGraphicContext: function(gl) {\n        this._gl = gl;\n        GLObject.addObject(this._gl, this);\n    },\n    getGraphicContext: function() {\n        return this._gl;\n    },\n    setLostContextCallback: function(cb) {\n        this._onLostContextCallback = cb;\n    },\n    onLostContext: function() {\n        if (this.invalidate && typeof this.invalidate === 'function') {\n            this.invalidate();\n        }\n        /* develblock:start */\n        if (!this.invalidate || typeof this.invalidate !== 'function') {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('GLObject needs Dirty mechanism for webgl restore');\n        }\n        /* develblock:end */\n        if (this._onLostContextCallback) this._onLostContextCallback();\n    }\n};\n\n// handle webgl restore by indexing all GLObject\nGLObject._sResourcesArrayCache = new window.Map();\n\nGLObject.addObject = function(gl, glObject) {\n    if (!GLObject._sResourcesArrayCache.has(gl)) GLObject._sResourcesArrayCache.set(gl, []);\n    var resourcesArray = GLObject._sResourcesArrayCache.get(gl);\n\n    if (resourcesArray.indexOf(glObject) !== -1) return;\n    resourcesArray.push(glObject);\n};\n\nGLObject.removeObject = function(gl, glObject) {\n    if (!GLObject._sResourcesArrayCache.has(gl)) return;\n\n    var resourcesArray = GLObject._sResourcesArrayCache.get(gl);\n    var i = resourcesArray.indexOf(glObject);\n    if (i === -1) return;\n    resourcesArray.splice(i, 1);\n};\n\nGLObject.onLostContext = function(gl) {\n    if (!GLObject._sResourcesArrayCache.has(gl)) return;\n\n    var resourcesArray = GLObject._sResourcesArrayCache.get(gl);\n    for (var i = 0, l = resourcesArray.length; i < l; i++) {\n        resourcesArray[i].onLostContext();\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GLObject);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/GLObject.js\n// module id = 35\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/GLObject.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_utils__ = __webpack_require__(0);\n\n\n\n\n\n\n\n\n\n\n/**\n * Create a Textured Box on the given center with given size\n * @name createTexturedBox\n */\nvar createTexturedBoxGeometry = function(cx, cy, cz, sx, sy, sz) {\n    var centerx = cx !== undefined ? cx : 0.0;\n    var centery = cy !== undefined ? cy : 0.0;\n    var centerz = cz !== undefined ? cz : 0.0;\n\n    var sizex = sx !== undefined ? sx : 1.0;\n    var sizey = sy !== undefined ? sy : 1.0;\n    var sizez = sz !== undefined ? sz : 1.0;\n\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n    var dx, dy, dz;\n    dx = sizex / 2.0;\n    dy = sizey / 2.0;\n    dz = sizez / 2.0;\n\n    var vertexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(72);\n    var uv = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(48);\n    var normal = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(72);\n\n    // -ve y plane\n    vertexes[0] = centerx - dx;\n    vertexes[1] = centery - dy;\n    vertexes[2] = centerz + dz;\n    normal[0] = 0.0;\n    normal[1] = -1.0;\n    normal[2] = 0.0;\n    uv[0] = 0.0;\n    uv[1] = 1.0;\n\n    vertexes[3] = centerx - dx;\n    vertexes[4] = centery - dy;\n    vertexes[5] = centerz - dz;\n    normal[3] = 0.0;\n    normal[4] = -1.0;\n    normal[5] = 0.0;\n    uv[2] = 0.0;\n    uv[3] = 0.0;\n\n    vertexes[6] = centerx + dx;\n    vertexes[7] = centery - dy;\n    vertexes[8] = centerz - dz;\n    normal[6] = 0.0;\n    normal[7] = -1.0;\n    normal[8] = 0.0;\n    uv[4] = 1.0;\n    uv[5] = 0.0;\n\n    vertexes[9] = centerx + dx;\n    vertexes[10] = centery - dy;\n    vertexes[11] = centerz + dz;\n    normal[9] = 0.0;\n    normal[10] = -1.0;\n    normal[11] = 0.0;\n    uv[6] = 1.0;\n    uv[7] = 1.0;\n\n    // +ve y plane\n    vertexes[12] = centerx + dx;\n    vertexes[13] = centery + dy;\n    vertexes[14] = centerz + dz;\n    normal[12] = 0.0;\n    normal[13] = 1.0;\n    normal[14] = 0.0;\n    uv[8] = 0.0;\n    uv[9] = 1.0;\n\n    vertexes[15] = centerx + dx;\n    vertexes[16] = centery + dy;\n    vertexes[17] = centerz - dz;\n    normal[15] = 0.0;\n    normal[16] = 1.0;\n    normal[17] = 0.0;\n    uv[10] = 0.0;\n    uv[11] = 0.0;\n\n    vertexes[18] = centerx - dx;\n    vertexes[19] = centery + dy;\n    vertexes[20] = centerz - dz;\n    normal[18] = 0.0;\n    normal[19] = 1.0;\n    normal[20] = 0.0;\n    uv[12] = 1.0;\n    uv[13] = 0.0;\n\n    vertexes[21] = centerx - dx;\n    vertexes[22] = centery + dy;\n    vertexes[23] = centerz + dz;\n    normal[21] = 0.0;\n    normal[22] = 1.0;\n    normal[23] = 0.0;\n    uv[14] = 1.0;\n    uv[15] = 1.0;\n\n    // +ve x plane\n    vertexes[24] = centerx + dx;\n    vertexes[25] = centery - dy;\n    vertexes[26] = centerz + dz;\n    normal[24] = 1.0;\n    normal[25] = 0.0;\n    normal[26] = 0.0;\n    uv[16] = 0.0;\n    uv[17] = 1.0;\n\n    vertexes[27] = centerx + dx;\n    vertexes[28] = centery - dy;\n    vertexes[29] = centerz - dz;\n    normal[27] = 1.0;\n    normal[28] = 0.0;\n    normal[29] = 0.0;\n    uv[18] = 0.0;\n    uv[19] = 0.0;\n\n    vertexes[30] = centerx + dx;\n    vertexes[31] = centery + dy;\n    vertexes[32] = centerz - dz;\n    normal[30] = 1.0;\n    normal[31] = 0.0;\n    normal[32] = 0.0;\n    uv[20] = 1.0;\n    uv[21] = 0.0;\n\n    vertexes[33] = centerx + dx;\n    vertexes[34] = centery + dy;\n    vertexes[35] = centerz + dz;\n    normal[33] = 1.0;\n    normal[34] = 0.0;\n    normal[35] = 0.0;\n    uv[22] = 1.0;\n    uv[23] = 1.0;\n\n    // -ve x plane\n    vertexes[36] = centerx - dx;\n    vertexes[37] = centery + dy;\n    vertexes[38] = centerz + dz;\n    normal[36] = -1.0;\n    normal[37] = 0.0;\n    normal[38] = 0.0;\n    uv[24] = 0.0;\n    uv[25] = 1.0;\n\n    vertexes[39] = centerx - dx;\n    vertexes[40] = centery + dy;\n    vertexes[41] = centerz - dz;\n    normal[39] = -1.0;\n    normal[40] = 0.0;\n    normal[41] = 0.0;\n    uv[26] = 0.0;\n    uv[27] = 0.0;\n\n    vertexes[42] = centerx - dx;\n    vertexes[43] = centery - dy;\n    vertexes[44] = centerz - dz;\n    normal[42] = -1.0;\n    normal[43] = 0.0;\n    normal[44] = 0.0;\n    uv[28] = 1.0;\n    uv[29] = 0.0;\n\n    vertexes[45] = centerx - dx;\n    vertexes[46] = centery - dy;\n    vertexes[47] = centerz + dz;\n    normal[45] = -1.0;\n    normal[46] = 0.0;\n    normal[47] = 0.0;\n    uv[30] = 1.0;\n    uv[31] = 1.0;\n\n    // top\n    // +ve z plane\n    vertexes[48] = centerx - dx;\n    vertexes[49] = centery + dy;\n    vertexes[50] = centerz + dz;\n    normal[48] = 0.0;\n    normal[49] = 0.0;\n    normal[50] = 1.0;\n    uv[32] = 0.0;\n    uv[33] = 1.0;\n\n    vertexes[51] = centerx - dx;\n    vertexes[52] = centery - dy;\n    vertexes[53] = centerz + dz;\n    normal[51] = 0.0;\n    normal[52] = 0.0;\n    normal[53] = 1.0;\n    uv[34] = 0.0;\n    uv[35] = 0.0;\n\n    vertexes[54] = centerx + dx;\n    vertexes[55] = centery - dy;\n    vertexes[56] = centerz + dz;\n    normal[54] = 0.0;\n    normal[55] = 0.0;\n    normal[56] = 1.0;\n    uv[36] = 1.0;\n    uv[37] = 0.0;\n\n    vertexes[57] = centerx + dx;\n    vertexes[58] = centery + dy;\n    vertexes[59] = centerz + dz;\n    normal[57] = 0.0;\n    normal[58] = 0.0;\n    normal[59] = 1.0;\n    uv[38] = 1.0;\n    uv[39] = 1.0;\n\n    // bottom\n    // -ve z plane\n    vertexes[60] = centerx + dx;\n    vertexes[61] = centery + dy;\n    vertexes[62] = centerz - dz;\n    normal[60] = 0.0;\n    normal[61] = 0.0;\n    normal[62] = -1.0;\n    uv[40] = 0.0;\n    uv[41] = 1.0;\n\n    vertexes[63] = centerx + dx;\n    vertexes[64] = centery - dy;\n    vertexes[65] = centerz - dz;\n    normal[63] = 0.0;\n    normal[64] = 0.0;\n    normal[65] = -1.0;\n    uv[42] = 0.0;\n    uv[43] = 0.0;\n\n    vertexes[66] = centerx - dx;\n    vertexes[67] = centery - dy;\n    vertexes[68] = centerz - dz;\n    normal[66] = 0.0;\n    normal[67] = 0.0;\n    normal[68] = -1.0;\n    uv[44] = 1.0;\n    uv[45] = 0.0;\n\n    vertexes[69] = centerx - dx;\n    vertexes[70] = centery + dy;\n    vertexes[71] = centerz - dz;\n    normal[69] = 0.0;\n    normal[70] = 0.0;\n    normal[71] = -1.0;\n    uv[46] = 1.0;\n    uv[47] = 1.0;\n\n    var indexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Uint16Array(36);\n    indexes[0] = 0;\n    indexes[1] = 1;\n    indexes[2] = 2;\n    indexes[3] = 0;\n    indexes[4] = 2;\n    indexes[5] = 3;\n\n    indexes[6] = 4;\n    indexes[7] = 5;\n    indexes[8] = 6;\n    indexes[9] = 4;\n    indexes[10] = 6;\n    indexes[11] = 7;\n\n    indexes[12] = 8;\n    indexes[13] = 9;\n    indexes[14] = 10;\n    indexes[15] = 8;\n    indexes[16] = 10;\n    indexes[17] = 11;\n\n    indexes[18] = 12;\n    indexes[19] = 13;\n    indexes[20] = 14;\n    indexes[21] = 12;\n    indexes[22] = 14;\n    indexes[23] = 15;\n\n    indexes[24] = 16;\n    indexes[25] = 17;\n    indexes[26] = 18;\n    indexes[27] = 16;\n    indexes[28] = 18;\n    indexes[29] = 19;\n\n    indexes[30] = 20;\n    indexes[31] = 21;\n    indexes[32] = 22;\n    indexes[33] = 20;\n    indexes[34] = 22;\n    indexes[35] = 23;\n\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, vertexes, 3);\n    g.getAttributes().Normal = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, normal, 3);\n    g.getAttributes().TexCoord0 = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, uv, 2);\n\n    var primitive = new __WEBPACK_IMPORTED_MODULE_5_osg_DrawElements__["a" /* default */](\n        __WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].TRIANGLES,\n        new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ELEMENT_ARRAY_BUFFER, indexes, 1)\n    );\n    g.getPrimitives().push(primitive);\n    return g;\n};\n\n// better perf\n// no more pixel shader hurt for nothing\n// http://michaldrobot.com/2014/04/01/gcn-execution-patterns-in-full-screen-passes/\n// It\'s a Singleton, as it\'s rendering invariant\n// so same remove uneeded state change when same geom\nvar createTexturedFullScreenFakeQuadGeometry = (function() {\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n\n    var vertexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array([4.0, -1.0, -1.0, 4.0, -1.0, -1.0]);\n    var buffer = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, vertexes, 2);\n    // Further optim: (uv.xy = position.xy in vertex shader)\n    g.getAttributes().Vertex = buffer;\n    g.getAttributes().TexCoord0 = buffer;\n\n    var primitive = new __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].TRIANGLES, 0, 3);\n    g.getPrimitives().push(primitive);\n\n    return function() {\n        return g;\n    };\n})();\n\nvar createTexturedQuadGeometry = function(\n    cornerx,\n    cornery,\n    cornerz,\n    wx,\n    wy,\n    wz,\n    hx,\n    hy,\n    hz,\n    l,\n    b,\n    r,\n    t\n) {\n    if (r === undefined && t === undefined) {\n        r = l;\n        t = b;\n        l = 0.0;\n        b = 0.0;\n    }\n\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n\n    var vertexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(12);\n    vertexes[0] = cornerx + hx;\n    vertexes[1] = cornery + hy;\n    vertexes[2] = cornerz + hz;\n\n    vertexes[3] = cornerx;\n    vertexes[4] = cornery;\n    vertexes[5] = cornerz;\n\n    vertexes[6] = cornerx + wx;\n    vertexes[7] = cornery + wy;\n    vertexes[8] = cornerz + wz;\n\n    vertexes[9] = cornerx + wx + hx;\n    vertexes[10] = cornery + wy + hy;\n    vertexes[11] = cornerz + wz + hz;\n\n    if (r === undefined) {\n        r = 1.0;\n    }\n    if (t === undefined) {\n        t = 1.0;\n    }\n\n    var uvs = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(8);\n    uvs[0] = l;\n    uvs[1] = t;\n\n    uvs[2] = l;\n    uvs[3] = b;\n\n    uvs[4] = r;\n    uvs[5] = b;\n\n    uvs[6] = r;\n    uvs[7] = t;\n\n    var n = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].fromValues(wx, wy, wz);\n    __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].cross(n, n, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].fromValues(hx, hy, hz));\n    __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].normalize(n, n);\n\n    var normal = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(12);\n    normal[0] = n[0];\n    normal[1] = n[1];\n    normal[2] = n[2];\n\n    normal[3] = n[0];\n    normal[4] = n[1];\n    normal[5] = n[2];\n\n    normal[6] = n[0];\n    normal[7] = n[1];\n    normal[8] = n[2];\n\n    normal[9] = n[0];\n    normal[10] = n[1];\n    normal[11] = n[2];\n\n    var indexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Uint16Array(6);\n    indexes[0] = 0;\n    indexes[1] = 1;\n    indexes[2] = 2;\n    indexes[3] = 0;\n    indexes[4] = 2;\n    indexes[5] = 3;\n\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, vertexes, 3);\n    g.getAttributes().Normal = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, normal, 3);\n    g.getAttributes().TexCoord0 = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, uvs, 2);\n\n    var primitive = new __WEBPACK_IMPORTED_MODULE_5_osg_DrawElements__["a" /* default */](\n        __WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].TRIANGLES,\n        new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ELEMENT_ARRAY_BUFFER, indexes, 1)\n    );\n    g.getPrimitives().push(primitive);\n    return g;\n};\n\nvar createAxisGeometry = function(size) {\n    if (size === undefined) {\n        size = 1.0;\n    }\n    if (createAxisGeometry.getShader === undefined) {\n        createAxisGeometry.getShader = function() {\n            if (createAxisGeometry.getShader.program === undefined) {\n                var vertexshader = [\n                    \'#ifdef GL_ES\',\n                    \'precision highp float;\',\n                    \'#endif\',\n                    \'attribute vec3 Vertex;\',\n                    \'attribute vec4 Color;\',\n                    \'uniform mat4 uModelViewMatrix;\',\n                    \'uniform mat4 uProjectionMatrix;\',\n                    \'\',\n                    \'varying vec4 vColor;\',\n                    \'\',\n                    \'void main(void) {\',\n                    \'  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex, 1.0));\',\n                    \'  vColor = Color;\',\n                    \'}\'\n                ].join(\'\\n\');\n\n                var fragmentshader = [\n                    \'#ifdef GL_ES\',\n                    \'precision highp float;\',\n                    \'#endif\',\n                    \'varying vec4 vColor;\',\n\n                    \'void main(void) {\',\n                    \'gl_FragColor = vColor;\',\n                    \'}\'\n                ].join(\'\\n\');\n\n                var program = new __WEBPACK_IMPORTED_MODULE_6_osg_Program__["a" /* default */](\n                    new __WEBPACK_IMPORTED_MODULE_7_osg_Shader__["a" /* default */](\'VERTEX_SHADER\', vertexshader),\n                    new __WEBPACK_IMPORTED_MODULE_7_osg_Shader__["a" /* default */](\'FRAGMENT_SHADER\', fragmentshader)\n                );\n                createAxisGeometry.getShader.program = program;\n            }\n            return createAxisGeometry.getShader.program;\n        };\n    }\n\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n\n    var vertexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(18);\n    vertexes[3] = size;\n    vertexes[10] = size;\n    vertexes[17] = size;\n\n    var colors = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(24);\n    //red color\n    colors[0] = colors[3] = 1.0;\n    colors[4] = colors[4 + 3] = 1.0;\n    //green color\n    colors[4 * 2 + 1] = colors[4 * 2 + 3] = 1.0;\n    colors[4 * 3 + 1] = colors[4 * 3 + 3] = 1.0;\n    //blue color\n    colors[4 * 4 + 2] = colors[4 * 4 + 3] = 1.0;\n    colors[4 * 5 + 2] = colors[4 * 5 + 3] = 1.0;\n\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, vertexes, 3);\n    g.getAttributes().Color = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, colors, 4);\n\n    var primitive = new __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].LINES, 0, 6);\n    g.getPrimitives().push(primitive);\n    g.getOrCreateStateSet().setAttributeAndModes(createAxisGeometry.getShader());\n\n    return g;\n};\n\n/**\n * Create a Textured Sphere on the given center with given radius\n * @name createTexturedSphere\n * @author Darrell Esau\n */\nvar createTexturedSphere = function(\n    radius,\n    widthSegments,\n    heightSegments,\n    phiStart,\n    phiLength,\n    thetaStart,\n    thetaLength\n) {\n    radius = radius || 1.0;\n\n    phiStart = phiStart !== undefined ? phiStart : 0.0;\n    phiLength = phiLength !== undefined ? phiLength : Math.PI * 2;\n\n    thetaStart = thetaStart !== undefined ? thetaStart : 0.0;\n    thetaLength = thetaLength !== undefined ? thetaLength : Math.PI;\n\n    var segmentsX = Math.max(3, Math.floor(widthSegments) || 8);\n    var segmentsY = Math.max(2, Math.floor(heightSegments) || 6);\n\n    var useDrawArrays = segmentsX * segmentsY / 3 >= 65536;\n    var nbPrim = useDrawArrays ? segmentsX * segmentsY * 6 : segmentsX * segmentsY * 4;\n    var fullVerticesList = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(nbPrim * 3);\n    var fullNormalsList = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(nbPrim * 3);\n    var fullUVList = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(nbPrim * 2);\n    var indexes = !useDrawArrays ? new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Uint16Array(segmentsX * segmentsY * 6) : undefined;\n    var vtxCount = 0;\n    var triCount = 0;\n\n    var v1 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var v2 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var v3 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var v4 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var n1 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var n2 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var n3 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var n4 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(3);\n    var uv1 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(2);\n    var uv2 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(2);\n    var uv3 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(2);\n    var uv4 = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(2);\n    var getCoordAndUvSphere = function(u, v, coord, norm, uv) {\n        coord[0] =\n            -radius * Math.cos(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\n        coord[1] = radius * Math.cos(thetaStart + v * thetaLength);\n        coord[2] =\n            radius * Math.sin(phiStart + u * phiLength) * Math.sin(thetaStart + v * thetaLength);\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].normalize(norm, coord);\n        uv[0] = u;\n        uv[1] = 1 - v;\n    };\n    for (var y = 0; y < segmentsY; y++) {\n        for (var x = 0; x < segmentsX; x++) {\n            getCoordAndUvSphere((x + 1) / segmentsX, y / segmentsY, v1, n1, uv1);\n            getCoordAndUvSphere(x / segmentsX, y / segmentsY, v2, n2, uv2);\n            getCoordAndUvSphere(x / segmentsX, (y + 1) / segmentsY, v3, n3, uv3);\n            getCoordAndUvSphere((x + 1) / segmentsX, (y + 1) / segmentsY, v4, n4, uv4);\n\n            var idv = vtxCount * 3;\n            fullVerticesList[idv] = v1[0];\n            fullVerticesList[idv + 1] = v1[1];\n            fullVerticesList[idv + 2] = v1[2];\n            fullVerticesList[idv + 3] = v2[0];\n            fullVerticesList[idv + 4] = v2[1];\n            fullVerticesList[idv + 5] = v2[2];\n            fullVerticesList[idv + 6] = v3[0];\n            fullVerticesList[idv + 7] = v3[1];\n            fullVerticesList[idv + 8] = v3[2];\n\n            fullNormalsList[idv] = n1[0];\n            fullNormalsList[idv + 1] = n1[1];\n            fullNormalsList[idv + 2] = n1[2];\n            fullNormalsList[idv + 3] = n2[0];\n            fullNormalsList[idv + 4] = n2[1];\n            fullNormalsList[idv + 5] = n2[2];\n            fullNormalsList[idv + 6] = n3[0];\n            fullNormalsList[idv + 7] = n3[1];\n            fullNormalsList[idv + 8] = n3[2];\n\n            var idu = vtxCount * 2;\n            fullUVList[idu] = uv1[0];\n            fullUVList[idu + 1] = uv1[1];\n            fullUVList[idu + 2] = uv2[0];\n            fullUVList[idu + 3] = uv2[1];\n            fullUVList[idu + 4] = uv3[0];\n            fullUVList[idu + 5] = uv3[1];\n\n            vtxCount += 3;\n            if (useDrawArrays) {\n                idv = vtxCount * 3;\n                fullVerticesList[idv] = v1[0];\n                fullVerticesList[idv + 1] = v1[1];\n                fullVerticesList[idv + 2] = v1[2];\n                fullVerticesList[idv + 3] = v3[0];\n                fullVerticesList[idv + 4] = v3[1];\n                fullVerticesList[idv + 5] = v3[2];\n                fullVerticesList[idv + 6] = v4[0];\n                fullVerticesList[idv + 7] = v4[1];\n                fullVerticesList[idv + 8] = v4[2];\n\n                fullNormalsList[idv] = n1[0];\n                fullNormalsList[idv + 1] = n1[1];\n                fullNormalsList[idv + 2] = n1[2];\n                fullNormalsList[idv + 3] = n3[0];\n                fullNormalsList[idv + 4] = n3[1];\n                fullNormalsList[idv + 5] = n3[2];\n                fullNormalsList[idv + 6] = n4[0];\n                fullNormalsList[idv + 7] = n4[1];\n                fullNormalsList[idv + 8] = n4[2];\n\n                idu = vtxCount * 2;\n                fullUVList[idu] = uv1[0];\n                fullUVList[idu + 1] = uv1[1];\n                fullUVList[idu + 2] = uv3[0];\n                fullUVList[idu + 3] = uv3[1];\n                fullUVList[idu + 4] = uv4[0];\n                fullUVList[idu + 5] = uv4[1];\n                vtxCount += 3;\n            } else {\n                idv = vtxCount * 3;\n                fullVerticesList[idv] = v4[0];\n                fullVerticesList[idv + 1] = v4[1];\n                fullVerticesList[idv + 2] = v4[2];\n\n                fullNormalsList[idv] = n4[0];\n                fullNormalsList[idv + 1] = n4[1];\n                fullNormalsList[idv + 2] = n4[2];\n\n                idu = vtxCount * 2;\n                fullUVList[idu] = uv4[0];\n                fullUVList[idu + 1] = uv4[1];\n\n                var iStart = triCount * 3;\n                var tristart = vtxCount - 3;\n                indexes[iStart] = tristart;\n                indexes[iStart + 1] = tristart + 1;\n                indexes[iStart + 2] = tristart + 2;\n                indexes[iStart + 3] = tristart;\n                indexes[iStart + 4] = tristart + 2;\n                indexes[iStart + 5] = tristart + 3;\n                triCount += 2;\n                vtxCount += 1;\n            }\n        }\n    }\n\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\'ARRAY_BUFFER\', fullVerticesList, 3);\n    g.getAttributes().Normal = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\'ARRAY_BUFFER\', fullNormalsList, 3);\n    g.getAttributes().TexCoord0 = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\'ARRAY_BUFFER\', fullUVList, 2);\n\n    if (useDrawArrays)\n        g\n            .getPrimitives()\n            .push(new __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].TRIANGLES, 0, fullVerticesList.length / 3));\n    else\n        g\n            .getPrimitives()\n            .push(\n                new __WEBPACK_IMPORTED_MODULE_5_osg_DrawElements__["a" /* default */](\n                    __WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].TRIANGLES,\n                    new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\'ELEMENT_ARRAY_BUFFER\', indexes, 1)\n                )\n            );\n    return g;\n};\n\nvar createGridGeometry = function(cx, cy, cz, wx, wy, wz, hx, hy, hz, res1, res2) {\n    cx = cx !== undefined ? cx : -0.5;\n    cy = cy !== undefined ? cy : -0.5;\n    cz = cz !== undefined ? cz : 0.0;\n\n    wx = wx !== undefined ? wx : 1.0;\n    wy = wy !== undefined ? wy : 0.0;\n    wz = wz !== undefined ? wz : 0.0;\n\n    hx = hx !== undefined ? hx : 0.0;\n    hy = hy !== undefined ? hy : 1.0;\n    hz = hz !== undefined ? hz : 0.0;\n\n    res1 = res1 !== undefined ? res1 : 5;\n    res2 = res2 !== undefined ? res2 : res1;\n    res1 += 2;\n    res2 += 2;\n\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n    var vertices = new Float32Array((res1 + res2) * 2 * 3);\n    var i = 0;\n    var j = 0;\n    var sx = wx / (res1 - 1);\n    var sy = wy / (res1 - 1);\n    var sz = wz / (res1 - 1);\n    var ux = cx + wx + hx;\n    var uy = cy + wy + hy;\n    var uz = cz + wz + hz;\n    for (i = 0; i < res1; ++i) {\n        j = i * 6;\n        vertices[j] = cx + sx * i;\n        vertices[j + 1] = cy + sy * i;\n        vertices[j + 2] = cz + sz * i;\n        vertices[j + 3] = ux - sx * (res1 - i - 1);\n        vertices[j + 4] = uy - sy * (res1 - i - 1);\n        vertices[j + 5] = uz - sz * (res1 - i - 1);\n    }\n    sx = hx / (res2 - 1);\n    sy = hy / (res2 - 1);\n    sz = hz / (res2 - 1);\n    for (i = 0; i < res2; ++i) {\n        j = (res1 + i) * 6;\n        vertices[j] = cx + sx * i;\n        vertices[j + 1] = cy + sy * i;\n        vertices[j + 2] = cz + sz * i;\n        vertices[j + 3] = ux - sx * (res2 - i - 1);\n        vertices[j + 4] = uy - sy * (res2 - i - 1);\n        vertices[j + 5] = uz - sz * (res2 - i - 1);\n    }\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, vertices, 3);\n    var primitive = new __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].LINES, 0, (res1 + res2) * 2);\n    g.getPrimitives().push(primitive);\n    return g;\n};\n\n/*\n * debug lines showing bounding box abstraction\n * @param col bbox color\n */\nvar createBoundingBoxGeometry = function(col) {\n    var g = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n    //unit cube centered on 0\n    var vertices = new Float32Array([\n        -0.5,\n        -0.5,\n        -0.5,\n        0.5,\n        -0.5,\n        -0.5,\n        0.5,\n        0.5,\n        -0.5,\n        -0.5,\n        0.5,\n        -0.5,\n        -0.5,\n        -0.5,\n        0.5,\n        0.5,\n        -0.5,\n        0.5,\n        0.5,\n        0.5,\n        0.5,\n        -0.5,\n        0.5,\n        0.5\n    ]);\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, vertices, 3);\n\n    // use color or red\n    if (!col) col = [1.0, 0.0, 0.0, 1.0];\n    var colors = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Float32Array(8 * 4);\n    for (var i = 0; i < 8; i++) {\n        for (var k = 0; k < 4; k++) {\n            colors[i * 3 + k] = col[k];\n        }\n    }\n\n    g.getAttributes().Color = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, colors, 4);\n\n    var indexes = new __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].Uint16Array([\n        //up\n        0,\n        1,\n        1,\n        2,\n        2,\n        3,\n        3,\n        0,\n        //down\n        4,\n        5,\n        5,\n        6,\n        6,\n        7,\n        7,\n        4,\n        // side\n        0,\n        4,\n        1,\n        5,\n        2,\n        6,\n        3,\n        7\n    ]);\n\n    g\n        .getPrimitives()\n        .push(\n            new __WEBPACK_IMPORTED_MODULE_5_osg_DrawElements__["a" /* default */](\n                __WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].LINES,\n                new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\'ELEMENT_ARRAY_BUFFER\', indexes, 1)\n            )\n        );\n\n    return g;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    createTexturedBoxGeometry: createTexturedBoxGeometry,\n    createTexturedQuadGeometry: createTexturedQuadGeometry,\n    createTexturedSphereGeometry: createTexturedSphere,\n    createTexturedFullScreenFakeQuadGeometry: createTexturedFullScreenFakeQuadGeometry,\n    createAxisGeometry: createAxisGeometry,\n    createTexturedSphere: createTexturedSphere,\n    createGridGeometry: createGridGeometry,\n    createBoundingBoxGeometry: createBoundingBoxGeometry\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/shape.js\n// module id = 36\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/shape.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgAnimation_channelType__ = __webpack_require__(124);\n\n\n\n\n\nvar target = {};\ntarget.InvalidTargetID = -1;\n\n// defaultValue is used when no channels affect the value\nvar createTarget = function(type, value, defaultValue) {\n    return {\n        type: type,\n        id: target.InvalidTargetID, // -1 means no id assigned yet\n        channels: [],\n        value: value,\n        defaultValue: defaultValue\n    };\n};\n\nvar createQuatTarget = function(defaultValue) {\n    return createTarget(\n        __WEBPACK_IMPORTED_MODULE_1_osgAnimation_channelType__["a" /* default */].Quat,\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].copy(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create(), defaultValue),\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].copy(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create(), defaultValue)\n    );\n};\n\nvar createMatrixTarget = function(defaultValue) {\n    return createTarget(\n        __WEBPACK_IMPORTED_MODULE_1_osgAnimation_channelType__["a" /* default */].Matrix,\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].copy(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), defaultValue),\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].copy(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), defaultValue)\n    );\n};\n\nvar createVec3Target = function(defaultValue) {\n    return createTarget(\n        __WEBPACK_IMPORTED_MODULE_1_osgAnimation_channelType__["a" /* default */].Vec3,\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].copy(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create(), defaultValue),\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].copy(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create(), defaultValue)\n    );\n};\n\nvar createFloatTarget = function(defaultValue) {\n    return createTarget(__WEBPACK_IMPORTED_MODULE_1_osgAnimation_channelType__["a" /* default */].Float, defaultValue, defaultValue);\n};\n\ntarget.createQuatTarget = createQuatTarget;\ntarget.createVec3Target = createVec3Target;\ntarget.createFloatTarget = createFloatTarget;\ntarget.createMatrixTarget = createMatrixTarget;\n\n/* harmony default export */ __webpack_exports__["a"] = (target);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/target.js\n// module id = 37\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/target.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BufferArrayProxy__ = __webpack_require__(76);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgAnimation_MorphAttribute__ = __webpack_require__(113);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_BoundingBox__ = __webpack_require__(28);\n\n\n\n\n\n\n\n\n\n\n/**\n * MorphGeometry manage up to MorphGeometry.MAX_MORPH_GPU morphTargets\n * @class MorphGeometry\n * @inherits Geometry\n */\n\nvar MorphGeometry = function() {\n    __WEBPACK_IMPORTED_MODULE_4_osg_Geometry__["a" /* default */].call(this);\n\n    this._shape = null; // by default no kdtree/shape for morph\n\n    this._targets = []; // Target list (Geometry)\n    this._stateSetAnimation = new __WEBPACK_IMPORTED_MODULE_5_osg_StateSet__["a" /* default */](); // StateSet to handle morphAttribute\n    this._targetWeights = new Float32Array(MorphGeometry.MAX_MORPH_GPU); // Fixed length array feed by UpdateMorph\n\n    this._morphAttribute = undefined;\n    this._morphTargetNames = undefined;\n\n    this._maxMorphGPU = MorphGeometry.MAX_MORPH_GPU; // used by updateMorph to limit the number of morphed attributes done by the gpu\n\n    this._isInitialized = false;\n};\n\n// sync with UpdateMorph\nMorphGeometry.EFFECTIVE_EPS = 0.05;\n\n// this should be constant, if you change it only do it at parse time, otherwise it\'s better to call setMaximumPossibleMorphGPU\nMorphGeometry.MAX_MORPH_GPU = 4;\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    MorphGeometry,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osg_Geometry__["a" /* default */].prototype, {\n        init: function() {\n            if (this._morphAttribute) {\n                this._isInitialized = true;\n                return false;\n            }\n\n            this._morphAttribute = new __WEBPACK_IMPORTED_MODULE_6_osgAnimation_MorphAttribute__["a" /* default */](\n                Math.min(this._maxMorphGPU, this.getMorphTargets().length)\n            );\n            this.getStateSetAnimation().setAttributeAndModes(\n                this._morphAttribute,\n                __WEBPACK_IMPORTED_MODULE_7_osg_StateAttribute__["a" /* default */].ON\n            );\n            this._morphAttribute.setTargetWeights(this.getTargetsWeight());\n\n            if (this._targets[0]) {\n                this._morphTargetNames = window.Object.keys(\n                    this._targets[0].getVertexAttributeList()\n                );\n                this._morphAttribute.copyTargetNames(this._morphTargetNames);\n            } else {\n                this._morphTargetNames = [];\n                __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].error(\'No Targets in the MorphGeometry !\');\n            }\n\n            this._isInitialized = true;\n            return true;\n        },\n\n        getMaximumPossibleMorphGPU: function() {\n            return this._maxMorphGPU;\n        },\n\n        setMaximumPossibleMorphGPU: function(nb) {\n            this._maxMorphGPU = nb;\n            this._isInitialized = false; // it\'s mostly UpdateMorph that we want to dirty\n            if (this._morphAttribute) this._morphAttribute.setNumTargets(nb);\n        },\n\n        getMorphTargetNames: function() {\n            return this._morphTargetNames;\n        },\n\n        getStateSetAnimation: function() {\n            return this._stateSetAnimation;\n        },\n\n        getMorphTargets: function() {\n            return this._targets;\n        },\n\n        isInitialized: function() {\n            return this._isInitialized;\n        },\n\n        getTargetsWeight: function() {\n            return this._targetWeights;\n        },\n\n        computeBoundingBox: (function() {\n            var tmpBox = new __WEBPACK_IMPORTED_MODULE_8_osg_BoundingBox__["a" /* default */]();\n\n            return function(boundingBox) {\n                __WEBPACK_IMPORTED_MODULE_4_osg_Geometry__["a" /* default */].prototype.computeBoundingBox.call(this, boundingBox);\n\n                // expand bb with targets\n                // Note : if the morphs have many many targets it can be done more smartly in\n                // the UpdateMorph on each frame by just taking into account the "active morphs"\n                for (var i = 0, l = this._targets.length; i < l; i++) {\n                    boundingBox.expandByBoundingBox(this._targets[i].computeBoundingBox(tmpBox));\n                }\n\n                return boundingBox;\n            };\n        })(),\n\n        mergeChildrenVertexAttributeList: function() {\n            for (var i = 0, l = this._targets.length; i < l; i++) {\n                var target = this._targets[i];\n\n                // change BufferArray to BufferArrayProxy\n                var attributeList = target.getVertexAttributeList();\n                for (var keyAttribute in attributeList) {\n                    var att = attributeList[keyAttribute];\n                    // check it\'s a buffer array before swtiching to proxy\n                    if (att && !att.getBufferArray) {\n                        attributeList[keyAttribute] = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArrayProxy__["a" /* default */](att);\n                    }\n                }\n\n                __WEBPACK_IMPORTED_MODULE_4_osg_Geometry__["a" /* default */].appendVertexAttributeToList(\n                    target.getVertexAttributeList(),\n                    this.getVertexAttributeList(),\n                    i\n                );\n            }\n        },\n\n        _computeEffectiveSumWeights: function() {\n            var sum = 0.0;\n            var weights = this._targetWeights;\n            for (var i = 0, nb = weights.length; i < nb; ++i) {\n                var weight = weights[i];\n                if (Math.abs(weight) <= MorphGeometry.EFFECTIVE_EPS) continue;\n\n                sum += weight;\n            }\n            var eps = 1e-5;\n            if (Math.abs(sum) > eps) return sum;\n            return sum < 0.0 ? -eps : eps;\n        },\n\n        computeTransformedVertex: function(id, out) {\n            out = out || __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n\n            var id3 = id * 3;\n\n            var weights = this._targetWeights;\n            var vList = this.getVertexAttributeList();\n\n            var baseVerts = vList.Vertex.getElements();\n\n            var sumWeights = 1.0 - this._computeEffectiveSumWeights();\n            out[0] = sumWeights * baseVerts[id3];\n            out[1] = sumWeights * baseVerts[id3 + 1];\n            out[2] = sumWeights * baseVerts[id3 + 2];\n\n            for (var j = 0, nb = weights.length; j < nb; ++j) {\n                var weight = weights[j];\n                if (Math.abs(weight) <= MorphGeometry.EFFECTIVE_EPS) continue;\n\n                var morphElts = vList[\'Vertex_\' + j].getElements();\n                out[0] += weight * morphElts[id3];\n                out[1] += weight * morphElts[id3 + 1];\n                out[2] += weight * morphElts[id3 + 2];\n            }\n\n            return out;\n        },\n\n        computeTransformedVertices: function() {\n            var weights = this._targetWeights;\n            var vList = this.getVertexAttributeList();\n\n            var baseVerts = vList.Vertex.getElements();\n            var vertexLen = baseVerts.length;\n\n            var morphedVerts = (this._morphedVerts =\n                this._morphedVerts || new Float32Array(vertexLen));\n\n            // base vertex influence\n            var baseWeight = 1.0 - this._computeEffectiveSumWeights();\n            for (var i = 0; i < vertexLen; ++i) {\n                morphedVerts[i] = baseWeight * baseVerts[i];\n            }\n\n            for (var j = 0, nb = weights.length; j < nb; ++j) {\n                var weight = weights[j];\n                if (Math.abs(weight) <= MorphGeometry.EFFECTIVE_EPS) continue;\n\n                // important : we should not take getInitialBufferArray as we should take the partially computed cpu morph from UpdateMorph\n                var morphElts = vList[\'Vertex_\' + j].getElements();\n                for (var k = 0; k < vertexLen; ++k) {\n                    morphedVerts[k] += weight * morphElts[k];\n                }\n            }\n\n            return morphedVerts;\n        }\n    }),\n    \'osgAnimation\',\n    \'MorphGeometry\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (MorphGeometry);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/MorphGeometry.js\n// module id = 38\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/MorphGeometry.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\nvar Viewport = function(x, y, w, h) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n\n    this._x = x !== undefined ? x : 0;\n    this._y = y !== undefined ? y : 0;\n    this._width = w !== undefined ? w : 800;\n    this._height = h !== undefined ? h : 600;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    Viewport,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Viewport\',\n\n        cloneType: function() {\n            return new Viewport();\n        },\n\n        setViewport: function(x, y, width, height) {\n            this._x = x;\n            this._y = y;\n            this._width = width;\n            this._height = height;\n        },\n\n        x: function() {\n            return this._x;\n        },\n\n        y: function() {\n            return this._y;\n        },\n\n        width: function() {\n            return this._width;\n        },\n\n        height: function() {\n            return this._height;\n        },\n\n        computeWindowMatrix: (function() {\n            var translate = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n            var scale = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n            var tmpVec = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(destination) {\n                // res = Matrix offset * Matrix scale * Matrix translate\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromTranslation(translate, __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].ONE);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromScaling(scale, [0.5 * this._width, 0.5 * this._height, 0.5]);\n                var offset = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromTranslation(\n                    destination,\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].set(tmpVec, this._x, this._y, 0.0)\n                );\n\n                return __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(offset, offset, __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(scale, scale, translate));\n            };\n        })(),\n\n        apply: function(state) {\n            state.applyViewport(this);\n        }\n    }),\n    \'osg\',\n    \'Viewport\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Viewport);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Viewport.js\n// module id = 39\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Viewport.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgNameSpace__ = __webpack_require__(101);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_requestFile__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgDB_options__ = __webpack_require__(222);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgDB_zlib__ = __webpack_require__(131);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_DrawArrayLengths__ = __webpack_require__(115);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_primitiveSet__ = __webpack_require__(8);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar rejectObject = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].rejectObject;\n\nvar Input = function(json, identifier) {\n    this._json = json;\n    var map = identifier;\n    if (map === undefined) {\n        map = {};\n    }\n    this._identifierMap = map;\n    this._objectRegistry = {};\n\n    this._cacheReadObject = {}; //wrappers\n\n    // this._progressXHRCallback = undefined;\n    // this._prefixURL = '';\n    // this.setImageLoadingOptions( {\n    //     promise: true,\n    //     onload: undefined\n    // } );\n\n    this.setOptions(__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectMix({}, __WEBPACK_IMPORTED_MODULE_4_osgDB_options__[\"a\" /* default */]));\n\n    // {\n    //     prefixURL: '',\n    //     progressXHRCallback: undefined,\n    //     readImageURL: undefined,\n    //     imageLoadingUsePromise: undefined,\n    //     imageOnload: undefined,\n    // };\n};\n\n// keep one instance of image fallback\nif (!Input.imageFallback) {\n    Input.imageFallback = (function() {\n        var fallback = new window.Image();\n        fallback.src =\n            'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2P8DwQACgAD/il4QJ8AAAAASUVORK5CYII=';\n        return fallback;\n    })();\n}\n\nInput.prototype = {\n    clone: function() {\n        var input = new Input();\n        input._objectRegistry = this._objectRegistry;\n        input._cacheReadObject = this._cacheReadObject;\n        return input;\n    },\n\n    setOptions: function(options) {\n        this._defaultOptions = options;\n    },\n    getOptions: function() {\n        return this._defaultOptions;\n    },\n    setProgressXHRCallback: function(func) {\n        this._defaultOptions.progressXHRCallback = func;\n    },\n    setReadNodeURLCallback: function(func) {\n        this._defaultOptions.readNodeURL = func;\n    },\n    // used to override the type from pathname\n    // typically if you want to create proxy object\n    registerObject: function(fullyQualifiedObjectname, constructor) {\n        this._objectRegistry[fullyQualifiedObjectname] = constructor;\n    },\n\n    getJSON: function() {\n        return this._json;\n    },\n\n    setJSON: function(json) {\n        this._json = json;\n        return this;\n    },\n\n    setPrefixURL: function(prefix) {\n        this._defaultOptions.prefixURL = prefix;\n    },\n\n    getPrefixURL: function() {\n        return this._defaultOptions.prefixURL;\n    },\n\n    setDatabasePath: function(path) {\n        this._defaultOptions.databasePath = path;\n    },\n\n    getDatabasePath: function() {\n        return this._defaultOptions.databasePath;\n    },\n\n    computeURL: function(url) {\n        if (\n            typeof this._defaultOptions.prefixURL === 'string' &&\n            this._defaultOptions.prefixURL.length > 0\n        ) {\n            return this._defaultOptions.prefixURL + url;\n        }\n\n        return url;\n    },\n\n    requestFile: function(url, options) {\n        return Object(__WEBPACK_IMPORTED_MODULE_3_osgDB_requestFile__[\"a\" /* default */])(url, options);\n    },\n\n    getObjectWrapper: function(path) {\n        if (this._objectRegistry[path]) {\n            return new this._objectRegistry[path]();\n        }\n\n        var scope = __WEBPACK_IMPORTED_MODULE_2_osgNameSpace__[\"a\" /* default */];\n        var splittedPath = path.split('.');\n        for (var i = 0, l = splittedPath.length; i < l; i++) {\n            var obj = scope[splittedPath[i]];\n            if (obj === undefined) {\n                return undefined;\n            }\n            scope = obj;\n        }\n        this._objectRegistry[path] = scope;\n        // create the new obj\n        return new scope();\n    },\n\n    fetchImage: function(image, url, options) {\n        var checkInlineImage = 'data:image/';\n        // crossOrigin does not work for inline data image\n        var isInlineImage = url.substring(0, checkInlineImage.length) === checkInlineImage;\n        var img = new window.Image();\n        if (!isInlineImage && options.imageCrossOrigin) {\n            img.crossOrigin = options.imageCrossOrigin;\n        }\n        image.setURL(url);\n        image.setImage(img);\n        img.src = url;\n\n        return new __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a(function(resolve) {\n            img.onerror = function() {\n                __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].warn('warning use white texture as fallback instead of ' + url);\n                image.setImage(Input.imageFallback);\n                resolve(image);\n            };\n\n            img.onload = function() {\n                if (options.imageOnload) options.imageOnload.call(image);\n                resolve(image);\n            };\n        });\n    },\n\n    readImageURL: function(url, options) {\n        if (options === undefined) {\n            options = this._defaultOptions;\n        }\n\n        // hook reader\n        if (options.readImageURL) {\n            // be carefull if you plan to call hook the call and after\n            // call the original readImageURL, you will need to remove\n            // from options the readImageURL if you dont want an infinte\n            // recursion call\n            return options.readImageURL.call(this, url, options);\n        }\n\n        // if image is on inline image skip url computation\n        if (url.substr(0, 10) !== 'data:image') {\n            url = this.computeURL(url);\n        }\n\n        var image = new __WEBPACK_IMPORTED_MODULE_7_osg_Image__[\"a\" /* default */]();\n        return this.fetchImage(image, url, options);\n    },\n\n    readNodeURL: function(url, opt) {\n        var options = opt;\n        if (options === undefined) {\n            options = this._defaultOptions;\n        }\n\n        // hook reader\n        if (options.readNodeURL) {\n            // be carefull if you plan to call hook the call and after\n            // call the original readNodeURL, you will need to remove\n            // from options the readNodeURL if you dont want an infinte\n            // recursion call\n            return options.readNodeURL.call(this, url, options);\n        }\n\n        url = this.computeURL(url);\n        var that = this;\n        // copy because we are going to modify it to have relative prefix to load assets\n        options = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectMix({}, options);\n\n        // automatic prefix if non specfied\n        if (!options.prefixURL) {\n            var prefix = that.getPrefixURL();\n            var index = url.lastIndexOf('/');\n            if (index !== -1) {\n                prefix = url.substring(0, index + 1);\n            }\n            options.prefixURL = prefix;\n        }\n\n        var ReaderParser = __webpack_require__(33).default;\n\n        var readSceneGraph = function(data) {\n            return ReaderParser.parseSceneGraph(data, options).then(function(child) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].log('loaded ' + url);\n                return child;\n            });\n        };\n\n        var ungzipFile = function(arrayBuffer) {\n            function pad(n) {\n                return n.length < 2 ? '0' + n : n;\n            }\n\n            function uintToString(uintArray) {\n                var str = '';\n                for (var i = 0, len = uintArray.length; i < len; ++i) {\n                    str += '%' + pad(uintArray[i].toString(16));\n                }\n                str = decodeURIComponent(str);\n                return str;\n            }\n\n            var unpacked = arrayBuffer;\n            if (__WEBPACK_IMPORTED_MODULE_5_osgDB_zlib__[\"a\" /* default */].isGunzipBuffer(arrayBuffer)) {\n                unpacked = __WEBPACK_IMPORTED_MODULE_5_osgDB_zlib__[\"a\" /* default */].gunzip(arrayBuffer);\n            }\n\n            var typedArray = new Uint8Array(unpacked);\n            var str = uintToString(typedArray);\n            return str;\n        };\n\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].time('osgjs.metric:Input.readNodeURL', __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].INFO);\n        // try to get the file as responseText to parse JSON\n        var fileTextPromise = that.requestFile(url);\n        return fileTextPromise\n            .then(function(str) {\n                var data;\n                try {\n                    data = JSON.parse(str);\n                } catch (error) {\n                    // can't parse try with ungzip code path\n\n                    __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error('cant parse url ' + url + ' try to gunzip');\n                }\n                // we have the json, read it\n                if (data) return readSceneGraph(data);\n\n                // no data try with gunzip\n                var fileGzipPromise = that.requestFile(url, {\n                    responseType: 'arraybuffer'\n                });\n                return fileGzipPromise\n                    .then(function(file) {\n                        var strUnzip = ungzipFile(file);\n                        data = JSON.parse(strUnzip);\n                        return readSceneGraph(data);\n                    })\n                    .catch(function(status) {\n                        var err = 'cant read file ' + url + ' status ' + status;\n                        __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error(err);\n                        return err;\n                    });\n            })\n            .catch(function(status) {\n                var err = 'cant get file ' + url + ' status ' + status;\n                __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error(err);\n                return err;\n            })\n            .finally(function() {\n                // Stop the timer\n                __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].timeEnd('osgjs.metric:Input.readNodeURL');\n            });\n    },\n\n    _unzipTypedArray: function(binary) {\n        var typedArray = new Uint8Array(binary);\n\n        // check magic number 1f8b\n        if (typedArray[0] === 0x1f && typedArray[1] === 0x8b) {\n            var _zlib = __webpack_require__(132);\n\n            if (!_zlib) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error(\n                    'osg failed to use a gunzip.min.js to uncompress a gz file.\\n You can add this vendors to enable this feature or adds the good header in your gzip file served by your server'\n                );\n            }\n\n            var zdec = new _zlib.Gunzip(typedArray);\n            var result = zdec.decompress();\n            return result.buffer;\n        }\n\n        return binary;\n    },\n\n    readBinaryArrayURL: function(url, options) {\n        if (options === undefined) {\n            options = this._defaultOptions;\n        }\n\n        if (options.readBinaryArrayURL) {\n            return options.readBinaryArrayURL.call(this, url, options);\n        }\n\n        url = this.computeURL(url);\n\n        if (this._identifierMap[url] !== undefined) {\n            return this._identifierMap[url];\n        }\n\n        var filePromise = this.requestFile(url, {\n            responseType: 'arraybuffer',\n            progress: this._defaultOptions.progressXHRCallback\n        });\n\n        var that = this;\n        this._identifierMap[url] = filePromise.then(function(file) {\n            return that._unzipTypedArray(file);\n        });\n\n        return this._identifierMap[url];\n    },\n\n    initializeBufferArray: function(vb, type, buf, options) {\n        if (options === undefined) options = this.getOptions();\n\n        if (options.initializeBufferArray) {\n            return options.initializeBufferArray.call(this, vb, type, buf);\n        }\n\n        var url = vb.File;\n\n        return this.readBinaryArrayURL(url).then(function(array) {\n            var typedArray;\n            // manage endianness\n            var bigEndian;\n            (function() {\n                var a = new Uint8Array([0x12, 0x34]);\n                var b = new Uint16Array(a.buffer);\n                bigEndian = b[0].toString(16) === '1234';\n            })();\n\n            var offset = 0;\n            if (vb.Offset !== undefined) {\n                offset = vb.Offset;\n            }\n\n            var bytesPerElement = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */][type].BYTES_PER_ELEMENT;\n            var nbItems = vb.Size;\n            var nbCoords = buf.getItemSize();\n            var totalSizeInBytes = nbItems * bytesPerElement * nbCoords;\n\n            if (bigEndian) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].log('big endian detected');\n                var TypedArray = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */][type];\n                var tmpArray = new TypedArray(nbItems * nbCoords);\n                var data = new DataView(array, offset, totalSizeInBytes);\n                var i = 0,\n                    l = tmpArray.length;\n                if (type === 'Uint16Array') {\n                    for (; i < l; i++) {\n                        tmpArray[i] = data.getUint16(i * bytesPerElement, true);\n                    }\n                } else if (type === 'Float32Array') {\n                    for (; i < l; i++) {\n                        tmpArray[i] = data.getFloat32(i * bytesPerElement, true);\n                    }\n                }\n                typedArray = tmpArray;\n                data = null;\n            } else {\n                typedArray = new __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */][type](array, offset, nbCoords * nbItems);\n            }\n\n            buf.setElements(typedArray);\n            return buf;\n        });\n    },\n\n    readBufferArray: function(options) {\n        var jsonObj = this.getJSON();\n\n        var uniqueID = jsonObj.UniqueID;\n        var osgjsObject;\n        if (uniqueID !== undefined) {\n            osgjsObject = this._identifierMap[uniqueID];\n            if (osgjsObject !== undefined) {\n                return osgjsObject;\n            }\n        }\n\n        if (options === undefined) options = this.getOptions();\n        if (options.readBufferArray) return options.readBufferArray.call(this);\n\n        if ((!jsonObj.Elements && !jsonObj.Array) || !jsonObj.ItemSize || !jsonObj.Type) {\n            return rejectObject('BufferArray', jsonObj);\n        }\n\n        var promise;\n\n        // inline array\n        if (jsonObj.Elements) {\n            promise = __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(\n                new __WEBPACK_IMPORTED_MODULE_8_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_8_osg_BufferArray__[\"a\" /* default */][jsonObj.Type], jsonObj.Elements, jsonObj.ItemSize)\n            );\n        } else if (jsonObj.Array) {\n            var buf = new __WEBPACK_IMPORTED_MODULE_8_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_8_osg_BufferArray__[\"a\" /* default */][jsonObj.Type]);\n            buf.setItemSize(jsonObj.ItemSize);\n\n            var vb, type;\n            if (jsonObj.Array.Float32Array) {\n                vb = jsonObj.Array.Float32Array;\n                type = 'Float32Array';\n            } else if (jsonObj.Array.Uint16Array) {\n                vb = jsonObj.Array.Uint16Array;\n                type = 'Uint16Array';\n            } else if (jsonObj.Array.Uint8Array) {\n                vb = jsonObj.Array.Uint8Array;\n                type = 'Uint8Array';\n            }\n            // $$ SOURCE_CODE_MODIFIED\n            // readPrimitiveSet() {\n            //  obj = new DrawElements(mode);\n            //\n            //  obj.setIndices(array);\n            // }\n            // DrawElements support 32bits index\n            else if (jsonObj.Array.Uint32Array) {\n                vb = jsonObj.Array.Uint32Array;\n                type = 'Uint32Array';\n            }\n            // $$ SOURCE_CODE_MODIFIED\n\n            if (vb === undefined) {\n                return rejectObject('Typed Array ' + window.Object.keys(jsonObj.Array)[0]);\n            }\n\n            if (vb.File) {\n                promise = this.initializeBufferArray(vb, type, buf);\n            } else if (vb.Elements) {\n                buf.setElements(new __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */][type](vb.Elements));\n                promise = __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(buf);\n            }\n        }\n\n        if (uniqueID !== undefined) {\n            this._identifierMap[uniqueID] = promise;\n        }\n        return promise;\n    },\n\n    readUserDataContainer: function() {\n        var jsonObj = this.getJSON();\n        var osgjsObject;\n        var uniqueID = jsonObj.UniqueID;\n        if (uniqueID !== undefined) {\n            osgjsObject = this._identifierMap[uniqueID];\n            if (osgjsObject !== undefined) {\n                return osgjsObject.Values;\n            }\n        }\n\n        this._identifierMap[uniqueID] = jsonObj;\n        return jsonObj.Values;\n    },\n\n    readPrimitiveSet: function() {\n        var jsonObj = this.getJSON();\n        var uniqueID;\n        var osgjsObject;\n\n        var promise;\n        var obj, mode, first, count;\n        var drawElements =\n            jsonObj.DrawElementUShort ||\n            jsonObj.DrawElementUByte ||\n            jsonObj.DrawElementUInt ||\n            jsonObj.DrawElementsUShort ||\n            jsonObj.DrawElementsUByte ||\n            jsonObj.DrawElementsUInt;\n        var drawArray = jsonObj.DrawArray || jsonObj.DrawArrays;\n        var drawArrayLengths = jsonObj.DrawArrayLengths;\n\n        if (drawElements) {\n            uniqueID = drawElements.UniqueID;\n            if (uniqueID !== undefined) {\n                osgjsObject = this._identifierMap[uniqueID];\n                if (osgjsObject !== undefined) {\n                    return osgjsObject;\n                }\n            }\n\n            mode = drawElements.Mode ? __WEBPACK_IMPORTED_MODULE_12_osg_primitiveSet__[\"a\" /* default */][drawElements.Mode] : __WEBPACK_IMPORTED_MODULE_12_osg_primitiveSet__[\"a\" /* default */].TRIANGLES;\n            obj = new __WEBPACK_IMPORTED_MODULE_11_osg_DrawElements__[\"a\" /* default */](mode);\n\n            this.setJSON(drawElements.Indices);\n            promise = this.readBufferArray().then(function(array) {\n                obj.setIndices(array);\n                return obj;\n            });\n            this.setJSON(jsonObj);\n        } else if (drawArray) {\n            uniqueID = drawArray.UniqueID;\n            if (uniqueID !== undefined) {\n                osgjsObject = this._identifierMap[uniqueID];\n                if (osgjsObject !== undefined) {\n                    return osgjsObject;\n                }\n            }\n\n            mode = drawArray.Mode || drawArray.mode;\n            first = drawArray.First !== undefined ? drawArray.First : drawArray.first;\n            count = drawArray.Count !== undefined ? drawArray.Count : drawArray.count;\n            obj = new __WEBPACK_IMPORTED_MODULE_9_osg_DrawArrays__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_12_osg_primitiveSet__[\"a\" /* default */][mode], first, count);\n            promise = __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(obj);\n        } else if (drawArrayLengths) {\n            uniqueID = drawArrayLengths.UniqueID;\n            if (uniqueID !== undefined) {\n                osgjsObject = this._identifierMap[uniqueID];\n                if (osgjsObject !== undefined) {\n                    return osgjsObject;\n                }\n            }\n\n            mode = drawArrayLengths.Mode;\n            first = drawArrayLengths.First;\n            var array = drawArrayLengths.ArrayLengths;\n            obj = new __WEBPACK_IMPORTED_MODULE_10_osg_DrawArrayLengths__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_12_osg_primitiveSet__[\"a\" /* default */][mode], first, array);\n            promise = __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(obj);\n        } else {\n            promise = rejectObject('PrimitiveSet', jsonObj);\n        }\n\n        if (uniqueID !== undefined) {\n            this._identifierMap[uniqueID] = promise;\n        }\n\n        return promise;\n    },\n\n    readObject: function() {\n        var jsonObj = this.getJSON();\n        var objKeys = window.Object.keys(jsonObj);\n        var prop = objKeys[0];\n        if (!prop) {\n            return rejectObject(\"can't find property for object \" + objKeys);\n        }\n\n        var uniqueID = jsonObj[prop].UniqueID;\n        var osgjsObject;\n        if (uniqueID !== undefined) {\n            osgjsObject = this._identifierMap[uniqueID];\n            if (osgjsObject !== undefined) {\n                return osgjsObject;\n            }\n        }\n\n        var obj = this.getObjectWrapper(prop);\n\n        if (!obj) {\n            return rejectObject(\"can't instanciate object \" + prop);\n        }\n\n        var ReaderParser = __webpack_require__(33).default;\n        var scope = ReaderParser.ObjectWrapper.serializers;\n\n        if (this._cacheReadObject[prop]) {\n            scope = this._cacheReadObject[prop];\n        } else {\n            var splittedPath = prop.split('.');\n            for (var i = 0, l = splittedPath.length; i < l; i++) {\n                var sub = splittedPath[i];\n                var reader = scope[sub];\n                if (!reader) {\n                    return rejectObject('Unknown scope ' + prop + '(' + sub + ')');\n                }\n                scope = reader;\n            }\n            this._cacheReadObject[prop] = scope;\n        }\n\n        var promise = scope(this.setJSON(jsonObj[prop]), obj);\n\n        if (uniqueID !== undefined) {\n            this._identifierMap[uniqueID] = promise;\n            obj._uniqueID = uniqueID;\n        }\n\n        return promise;\n    }\n};\n\n// $$ SOURCE_CODE_MODIFIED\nInput.prototype.readNodeURL = function(url, opt) {\n    var options = opt;\n    if (options === undefined) {\n        options = this._defaultOptions;\n    }\n\n    // hook reader\n    if (options.readNodeURL) {\n        // be carefull if you plan to call hook the call and after\n        // call the original readNodeURL, you will need to remove\n        // from options the readNodeURL if you dont want an infinte\n        // recursion call\n        return options.readNodeURL.call(this, url, options);\n    }\n\n    url = this.computeURL(url);\n    var that = this;\n    // copy because we are going to modify it to have relative prefix to load assets\n    options = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectMix({}, options);\n\n    // automatic prefix if non specfied\n    if (!options.prefixURL) {\n        var prefix = that.getPrefixURL();\n        var index = url.lastIndexOf('/');\n        if (index !== -1) {\n            prefix = url.substring(0, index + 1);\n        }\n        options.prefixURL = prefix;\n\n        // TODO: SOURCE_CODE_MODIFIED\n        options.databasePath = prefix;\n    }\n\n    var ReaderParser = __webpack_require__(33).default;\n\n    var readSceneGraph = function(data) {\n        return ReaderParser.parseSceneGraph(data, options).then(function(child) {\n            __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].log('loaded ' + url);\n            return child;\n        });\n    };\n\n    var ungzipFile = function(arrayBuffer) {\n        function pad(n) {\n            return n.length < 2 ? '0' + n : n;\n        }\n\n        function uintToString(uintArray) {\n            var str = '';\n            for (var i = 0, len = uintArray.length; i < len; ++i) {\n                str += '%' + pad(uintArray[i].toString(16));\n            }\n            str = decodeURIComponent(str);\n            return str;\n        }\n\n        var unpacked = arrayBuffer;\n        if (__WEBPACK_IMPORTED_MODULE_5_osgDB_zlib__[\"a\" /* default */].isGunzipBuffer(arrayBuffer)) {\n            unpacked = __WEBPACK_IMPORTED_MODULE_5_osgDB_zlib__[\"a\" /* default */].gunzip(arrayBuffer);\n        }\n\n        var typedArray = new Uint8Array(unpacked);\n        var str = uintToString(typedArray);\n        return str;\n    };\n\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].time('osgjs.metric:Input.readNodeURL', __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].INFO);\n    // try to get the file as responseText to parse JSON\n    var fileTextPromise = that.requestFile(url);\n    return fileTextPromise\n        .then(function(str) {\n            var data;\n            try {\n                data = JSON.parse(str);\n            } catch (error) {\n                // can't parse try with ungzip code path\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error('cant parse url ' + url + ' try to gunzip');\n            }\n            // we have the json, read it\n            if (data) return readSceneGraph(data);\n\n            // no data try with gunzip\n            var fileGzipPromise = that.requestFile(url, {\n                responseType: 'arraybuffer'\n            });\n            return fileGzipPromise\n                .then(function(file) {\n                    var strUnzip = ungzipFile(file);\n                    data = JSON.parse(strUnzip);\n                    return readSceneGraph(data);\n                })\n                .catch(function(status) {\n                    var err = 'cant read file ' + url + ' status ' + status;\n                    __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error(err);\n                    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject(that);\n                });\n        })\n        .catch(function(status) {\n            var err = 'cant get file ' + url + ' status ' + status;\n            __WEBPACK_IMPORTED_MODULE_6_osg_notify__[\"a\" /* default */].error(err);\n            return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject(that);\n        })\n        .finally(function() {\n            // Stop the timer\n            __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].timeEnd('osgjs.metric:Input.readNodeURL');\n        });\n};\n// $$ SOURCE_CODE_MODIFIED\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Input);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/Input.js\n// module id = 40\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/Input.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var clamp = function(x, min, max) {\n    // http://jsperf.com/math-clamp\n    // http://jsperf.com/clamping-methods/2\n    return Math.min(max, Math.max(min, x));\n};\n\nvar smoothStep = function(edge0, edge1, x) {\n    if (x <= edge0) return 0.0;\n    if (x >= edge1) return 1.0;\n    var y = (x - edge0) / (edge1 - edge0);\n    return y * y * (3.0 - 2.0 * y);\n};\n\n// native isNaN is slow (e.g: https://jsperf.com/isnan-performance/2)\n// note : native isNaN will return true for undefined but\n// this function assume that x is a number\nvar fastIsNaN = function(x) {\n    return x !== x;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    clamp: clamp,\n    smoothStep: smoothStep,\n    isNaN: fastIsNaN\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/math.js\n// module id = 41\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/math.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\nvar BoundingSphere = function() {\n    this._center = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n    this._radius = -1.0;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    BoundingSphere,\n    {\n        init: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].init(this._center);\n            this._radius = -1.0;\n        },\n\n        valid: function() {\n            return this._radius >= 0.0;\n        },\n\n        set: function(center, radius) {\n            this._center = center;\n            this._radius = radius;\n        },\n\n        center: function() {\n            return this._center;\n        },\n\n        radius: function() {\n            return this._radius;\n        },\n\n        radius2: function() {\n            return this._radius * this._radius;\n        },\n\n        volume: function() {\n            var r = this._radius;\n            return r * r * r * Math.PI * 4 / 3;\n        },\n\n        copy: function(other) {\n            this._radius = other._radius;\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(this._center, other._center);\n        },\n\n        copyBoundingBox: function(box) {\n            box.center(this._center);\n            this._radius = box.radius();\n        },\n\n        expandByBoundingBox: (function() {\n            var v = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var newbb = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n\n            return function(bb) {\n                if (!bb.valid()) return;\n\n                if (!this.valid()) {\n                    this.copyBoundingBox(bb);\n                    return;\n                }\n\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(newbb._min, bb._min);\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(newbb._max, bb._max);\n\n                for (var i = 0; i < 8; i++) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sub(v, bb.corner(i, v), this._center); // get the direction vector from corner\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].normalize(v, v); // normalise it.\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(v, this._center, v, -this._radius); // move the vector in the opposite direction distance radius.\n                    newbb.expandByVec3(v); // add it into the new bounding box.\n                }\n\n                newbb.center(this._center);\n                this._radius = newbb.radius();\n            };\n        })(),\n\n        expandByvec3: function(v) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'deprecated, use expandByVec3\');\n            this.expandByVec3(v);\n        },\n\n        expandByVec3: (function() {\n            var dv = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            return function(v) {\n                if (this.valid()) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sub(dv, v, this.center(dv));\n                    var r = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].length(dv);\n                    if (r > this.radius()) {\n                        var dr = (r - this.radius()) * 0.5;\n                        this._center[0] += dv[0] * (dr / r);\n                        this._center[1] += dv[1] * (dr / r);\n                        this._center[2] += dv[2] * (dr / r);\n                        this._radius += dr;\n                    }\n                } else {\n                    this._center[0] = v[0];\n                    this._center[1] = v[1];\n                    this._center[2] = v[2];\n                    this._radius = 0.0;\n                }\n            };\n        })(),\n\n        expandRadiusBySphere: function(sh) {\n            if (sh.valid()) {\n                if (this.valid()) {\n                    var r = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].distance(this._center, sh._center) + sh._radius;\n                    if (r > this._radius) {\n                        this._radius = r;\n                    }\n                    // else do nothing as vertex is within sphere.\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(this._center, sh._center);\n                    this._radius = sh._radius;\n                }\n            }\n        },\n\n        expandByBoundingSphere: function(sh) {\n            // ignore operation if incomming BoundingSphere is invalid.\n            if (!sh.valid()) {\n                return;\n            }\n\n            // This sphere is not set so use the inbound sphere\n            if (!this.valid()) {\n                this._center[0] = sh._center[0];\n                this._center[1] = sh._center[1];\n                this._center[2] = sh._center[2];\n                this._radius = sh.radius();\n\n                return;\n            }\n\n            // Calculate d == The distance between the sphere centers\n            var d = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].distance(sh.center(), this.center());\n\n            // New sphere is already inside this one\n            if (d + sh.radius() <= this.radius()) {\n                return;\n            }\n\n            //  New sphere completely contains this one\n            if (d + this.radius() <= sh.radius()) {\n                this._center[0] = sh._center[0];\n                this._center[1] = sh._center[1];\n                this._center[2] = sh._center[2];\n                this._radius = sh._radius;\n                return;\n            }\n\n            // Build a new sphere that completely contains the other two:\n            //\n            // The center point lies halfway along the line between the furthest\n            // points on the edges of the two spheres.\n            //\n            // Computing those two points is ugly - so we\'ll use similar triangles\n            var newRadius = (this.radius() + d + sh.radius()) * 0.5;\n            var ratio = (newRadius - this.radius()) / d;\n\n            this._center[0] += (sh._center[0] - this._center[0]) * ratio;\n            this._center[1] += (sh._center[1] - this._center[1]) * ratio;\n            this._center[2] += (sh._center[2] - this._center[2]) * ratio;\n\n            this._radius = newRadius;\n        },\n        contains: function(v) {\n            if (!this.valid()) return false;\n            return __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sqrDist(this.center(), v) <= this.radius2();\n        },\n        intersects: function(bs) {\n            if (!this.valid() || !bs.valid()) return false;\n            var r = this.radius() + bs.radius();\n            return __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sqrDist(bs.center(), this.center()) <= r * r;\n        },\n\n        transformMat4: (function() {\n            var scaleVec = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            return function(out, matrix) {\n                if (!this.valid()) return out;\n\n                if (out._center !== this._center) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(out._center, this._center);\n                    out._radius = this._radius;\n                }\n                var sphCenter = out._center;\n                var sphRadius = out._radius;\n\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].getSqrScale(scaleVec, matrix);\n                var scale = Math.sqrt(Math.max(Math.max(scaleVec[0], scaleVec[1]), scaleVec[2]));\n                sphRadius = sphRadius * scale;\n                out._radius = sphRadius;\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].transformMat4(sphCenter, sphCenter, matrix);\n\n                return out;\n            };\n        })()\n    },\n    \'osg\',\n    \'BoundingSphere\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (BoundingSphere);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BoundingSphere.js\n// module id = 42\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BoundingSphere.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n/** @class Plane Operations */\nvar Plane = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */], {\n    // Many case (frustum, convexity)\n    // needs to know where from a plane it stands,\n    // not just boolean intersection\n    INSIDE: 1,\n    INTERSECT: 2,\n    OUTSIDE: 3,\n    /* Transform the plane */\n    transformProvidingInverse: function() {\n        var iplane = Plane.create();\n        return function(p, m) {\n            //Matrix.transformVec4PostMult( matrix, plane, iplane );\n            var x = p[0];\n            var y = p[1];\n            var z = p[2];\n            var w = p[3];\n\n            iplane[0] = m[0] * x + m[1] * y + m[2] * z + m[3] * w;\n            iplane[1] = m[4] * x + m[5] * y + m[6] * z + m[7] * w;\n            iplane[2] = m[8] * x + m[9] * y + m[10] * z + m[11] * w;\n            iplane[3] = m[12] * x + m[13] * y + m[14] * z + m[15] * w;\n\n            Plane.normalizeEquation(iplane);\n            Plane.copy(iplane, p);\n            return p;\n        };\n    },\n\n    normalizeEquation: function(plane) {\n        // multiply the coefficients of the plane equation with a constant factor so that the equation a^2+b^2+c^2 = 1 holds.\n        var inv = 1.0 / Math.sqrt(plane[0] * plane[0] + plane[1] * plane[1] + plane[2] * plane[2]);\n        plane[0] *= inv;\n        plane[1] *= inv;\n        plane[2] *= inv;\n        plane[3] *= inv;\n    },\n    /*only the normal Component*/\n    getNormal: function(plane, result) {\n        result[0] = plane[0];\n        result[1] = plane[1];\n        result[2] = plane[2];\n        return result;\n    },\n    setNormal: function(plane, normal) {\n        plane[0] = normal[0];\n        plane[1] = normal[1];\n        plane[2] = normal[2];\n    },\n    /* only the distance getter*/\n    getDistance: function(plane) {\n        return plane[3];\n    },\n    setDistance: function(plane, distance) {\n        plane[3] = distance;\n    },\n\n    /* using the plane equation, compute distance to plane of a point*/\n    distanceToPlane: function(plane, position) {\n        return plane[0] * position[0] + plane[1] * position[1] + plane[2] * position[2] + plane[3];\n    },\n\n    intersectsOrContainsBoundingSphere: function(plane, bSphere) {\n        if (!bSphere.valid()) return Plane.OUTSIDE;\n        var position = bSphere.center();\n        var radius = bSphere.radius();\n        var d = this.distanceToPlane(plane, position);\n        if (d < -radius) {\n            return Plane.OUTSIDE;\n        } else if (d <= radius) {\n            return Plane.INTERSECT;\n        }\n        return Plane.INSIDE;\n    },\n\n    instersectsBoundingSphere: function(plane, bSphere) {\n        return this.intersectsOrContainsBoundingSphere(plane, bSphere) === Plane.INTERSECT;\n    },\n\n    intersectsOrContainsBoundingBox: (function() {\n        var retCorner = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n        return function(plane, bbox) {\n            var upperBBCorner =\n                (plane[0] >= 0.0 ? 1 : 0) | (plane[1] >= 0.0 ? 2 : 0) | (plane[2] >= 0.0 ? 4 : 0);\n            var lowerBBCorner = ~upperBBCorner & 7;\n\n            if (this.distanceToPlane(plane, bbox.corner(lowerBBCorner, retCorner)) > 0.0)\n                return Plane.INSIDE;\n            if (this.distanceToPlane(plane, bbox.corner(upperBBCorner, retCorner)) < 0.0)\n                return Plane.OUTSIDE;\n            return Plane.INTERSECT; // partially inside\n        };\n    })(),\n\n    intersectsBoundingBox: function(plane, bbox, absPlane) {\n        return this.intersectsOrContainsBoundingBox(plane, bbox, absPlane) === Plane.INTERSECT;\n    },\n\n    intersectOrContainsVertices: function(plane, vertices) {\n        var side = -1;\n        // all points must be on one side only\n        for (var i = 0; i < vertices.length; i++) {\n            var d = this.distanceToPlane(plane, vertices[i]);\n            if (d < 0.0) {\n                if (side === 1) return Plane.INTERSECT;\n                side = 2;\n            } else if (d > 0.0) {\n                if (side === 2) return Plane.INTERSECT;\n                side = 1;\n            } else {\n                //if ( d === 0.0 )\n                return Plane.INTERSECT;\n            }\n        }\n        return side > 0 ? Plane.INSIDE : Plane.OUTSIDE;\n    },\n    intersectVertices: function(plane, vertices) {\n        return this.intersectOrContainsVertices(plane, vertices) === Plane.INTERSECT;\n    }\n});\n\n/* harmony default export */ __webpack_exports__["a"] = (Plane);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Plane.js\n// module id = 43\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Plane.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_UpdateBone__ = __webpack_require__(84);\n\n\n\n\n\n\n\n/**\n *  Bone\n *  @class Bone\n */\nvar Bone = function(name) {\n    if (name !== undefined) this.setName(name);\n\n    __WEBPACK_IMPORTED_MODULE_3_osg_MatrixTransform__["a" /* default */].call(this);\n    this._invBindInSkeletonSpace = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n    this._boneInSkeletonSpace = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n    this._boneBoundingBox = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Bone,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_MatrixTransform__["a" /* default */].prototype, {\n        // consistent color depending of id\n        // _rand: function ( id ) {\n        //     var x = Math.sin( id * 45.233 ) * 43758.5453;\n        //     return x - Math.floor( x );\n        // },\n        // _generateBoneColor: function ( id ) {\n        //     return vec3.fromValues( this._rand( id + 2.16 ), this._rand( id * 57.27 ), this._rand( id * 0.874 ) );\n        // },\n\n        getOrCreateDebugColor: function() {\n            // for bone display (debugging, etc)\n            if (this._boneColor) return this._boneColor;\n            // this._boneColor = this._generateBoneColor( this.getInstanceID() );\n            this._boneColor = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].fromValues(Math.random(), Math.random(), Math.random());\n            return this._boneColor;\n        },\n\n        getBoneBoundingBox: function() {\n            return this._boneBoundingBox;\n        },\n\n        setBoneBoundingBox: function(bb) {\n            this._boneBoundingBox = bb;\n        },\n\n        getMatrixInSkeletonSpace: function() {\n            return this._boneInSkeletonSpace;\n        },\n\n        getInvBindMatrixInSkeletonSpace: function() {\n            return this._invBindInSkeletonSpace;\n        },\n\n        setMatrixInSkeletonSpace: function(m) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].copy(this._boneInSkeletonSpace, m);\n        },\n\n        setInvBindMatrixInSkeletonSpace: function(m) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].copy(this._invBindInSkeletonSpace, m);\n        },\n\n        getBoneParent: function() {\n            var parents = this.getParents();\n            for (var i = 0, l = parents.length; i < l; i++) {\n                var typeID = parents[i].getTypeID();\n                if (typeID === Bone.getTypeID()) {\n                    return parents[i];\n                }\n            }\n            return undefined;\n        },\n\n        setDefaultUpdateCallback: function(name) {\n            this.addUpdateCallback(new __WEBPACK_IMPORTED_MODULE_4_osgAnimation_UpdateBone__["a" /* default */](name !== undefined ? name : this.getName()));\n        }\n    }),\n    \'osgAnimation\',\n    \'Bone\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Bone);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/Bone.js\n// module id = 44\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/Bone.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgAnimation_UpdateRigGeometry__ = __webpack_require__(189);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgAnimation_RigTransformHardware__ = __webpack_require__(191);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgAnimation_AnimationUpdateCallback__ = __webpack_require__(52);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_computeMatrixFromNodePath__ = __webpack_require__(48);\n\n\n\n\n\n\n\n\n\n\n\n\n// RigGeometry is a Geometry deformed by bones\n// To connect bones to RigGeometry it requires:\n//     - a map of bones with index / weight eg also called VertexInfluenceMap\n// {\n//     bone0: { index: [],  // vertex index\n//              weight: []  // weight for this index\n//            },\n//     bone2: { index: [],\n//              weight: []\n//            }\n// }\n\nvar RigGeometry = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */].call(this);\n\n    this._shape = null; // by default no kdtree/shape for rig\n\n    this.addUpdateCallback(new __WEBPACK_IMPORTED_MODULE_6_osgAnimation_UpdateRigGeometry__["a" /* default */]());\n\n    // handle matrixFromSkeletonToGeometry and invMatrixFromSkeletonToGeometry computation\n    this._root = undefined;\n    this._pathToRoot = undefined;\n    this._isAnimatedPath = false;\n\n    this._boneNameID = {};\n\n    this._matrixFromSkeletonToGeometry = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n    this._invMatrixFromSkeletonToGeometry = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n\n    this._rigTransformImplementation = new __WEBPACK_IMPORTED_MODULE_7_osgAnimation_RigTransformHardware__["a" /* default */]();\n\n    // RigGeometry have a special stateset that will be pushed at the very end of the culling\n    // this stateSet only represents animation (and shouldn\'t contain any rendering attributes)\n    // It\'s a way to make every RigGeometry unique (in term of stateSet stack)\n    this._stateSetAnimation = new __WEBPACK_IMPORTED_MODULE_4_osg_StateSet__["a" /* default */]();\n\n    this._needToComputeMatrix = true;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    RigGeometry,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */].prototype, {\n        getStateSetAnimation: function() {\n            return this._stateSetAnimation;\n        },\n\n        getSkeleton: function() {\n            return this._root;\n        },\n\n        setSkeleton: function(root) {\n            this._root = root;\n        },\n\n        setPathToSkeleton: function(path) {\n            this._pathToRoot = path;\n            this._isAnimatedPath = __WEBPACK_IMPORTED_MODULE_8_osgAnimation_AnimationUpdateCallback__["a" /* default */].checkPathIsAnimated(path);\n        },\n\n        setNeedToComputeMatrix: function(needToComputeMatrix) {\n            this._needToComputeMatrix = needToComputeMatrix;\n        },\n\n        getNeedToComputeMatrix: function() {\n            return this._needToComputeMatrix;\n        },\n\n        computeBoundingBox: function(boundingBox) {\n            boundingBox.init();\n\n            var vertexArray = this.getVertexAttributeList().Vertex;\n            var weightsArray = this.getVertexAttributeList().Weights;\n            // mainly copy paste of geometry computeBoundingBox code, except we only\n            // take into account the non-influenced vertices\n\n            // we do that only for the non-influenced vertices because the rigged ones\n            // can\'t be statically computed (full moving bbox of rigs should be computed externally\n            // through bones or cpu rigged colision mesh, etc)\n            // bbox is important for culling (near/far)\n\n            if (\n                vertexArray &&\n                weightsArray &&\n                vertexArray.getElements() &&\n                vertexArray.getItemSize() > 2\n            ) {\n                var weights = weightsArray.getElements();\n                var vertexes = vertexArray.getElements();\n                var itemSize = vertexArray.getItemSize();\n\n                var min = boundingBox.getMin();\n                var max = boundingBox.getMax();\n\n                var minx = min[0];\n                var miny = min[1];\n                var minz = min[2];\n                var maxx = max[0];\n                var maxy = max[1];\n                var maxz = max[2];\n\n                for (\n                    var idx = 0, idb = 0, l = vertexes.length;\n                    idx < l;\n                    idx += itemSize, idb += 4\n                ) {\n                    if (\n                        weights[idx] !== 0.0 ||\n                        weights[idx + 1] !== 0.0 ||\n                        weights[idx + 2] !== 0.0 ||\n                        weights[idx + 3] !== 0.0\n                    )\n                        continue;\n\n                    var v1 = vertexes[idx];\n                    var v2 = vertexes[idx + 1];\n                    var v3 = vertexes[idx + 2];\n                    if (v1 < minx) minx = v1;\n                    if (v1 > maxx) maxx = v1;\n                    if (v2 < miny) miny = v2;\n                    if (v2 > maxy) maxy = v2;\n                    if (v3 < minz) minz = v3;\n                    if (v3 > maxz) maxz = v3;\n                }\n\n                min[0] = minx;\n                min[1] = miny;\n                min[2] = minz;\n                max[0] = maxx;\n                max[1] = maxy;\n                max[2] = maxz;\n            }\n\n            return boundingBox;\n        },\n\n        computeMatrixFromRootSkeleton: function() {\n            if (!this._root) {\n                __WEBPACK_IMPORTED_MODULE_3_osg_notify__["a" /* default */].warn(\n                    \'Warning \' +\n                        this.className() +\n                        \'.computeMatrixFromRootSkeleton if you have this message it means you miss to call buildTransformer( root ), or your RigGeometry (\' +\n                        this.getName() +\n                        \') is not attached to a Skeleton subgraph\'\n                );\n                return;\n            }\n\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].identity(this._matrixFromSkeletonToGeometry);\n            __WEBPACK_IMPORTED_MODULE_9_osg_computeMatrixFromNodePath__["a" /* default */].computeLocalToWorld(\n                this._pathToRoot,\n                true,\n                this._matrixFromSkeletonToGeometry\n            );\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(this._invMatrixFromSkeletonToGeometry, this._matrixFromSkeletonToGeometry);\n\n            if (!this._isAnimatedPath) this._needToComputeMatrix = false;\n        },\n\n        getMatrixFromSkeletonToGeometry: function() {\n            return this._matrixFromSkeletonToGeometry;\n        },\n\n        getInvMatrixFromSkeletonToGeometry: function() {\n            return this._invMatrixFromSkeletonToGeometry;\n        },\n\n        getSourceGeometry: function() {\n            return this._geometry;\n        },\n\n        setSourceGeometry: function(geometry) {\n            this._geometry = geometry;\n        },\n\n        getBoneNameID: function() {\n            return this._boneNameID;\n        },\n\n        setBoneNameID: function(boneMap) {\n            this._boneNameID = boneMap;\n        },\n\n        mergeChildrenVertexAttributeList: function() {\n            if (this._geometry instanceof __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */])\n                this._geometry.mergeChildrenVertexAttributeList();\n\n            var sourceGeometryVertexAttributeList = this._geometry.getVertexAttributeList();\n\n            __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */].appendVertexAttributeToList(\n                sourceGeometryVertexAttributeList,\n                this.getVertexAttributeList()\n            );\n        },\n\n        mergeChildrenData: function() {\n            // move to the rig the vertex attributes, the primitives and the stateset\n\n            this.mergeChildrenVertexAttributeList();\n            var primitiveSetList = this._geometry.getPrimitiveSetList();\n\n            this.getPrimitiveSetList().length = 0;\n            for (var i = 0, il = primitiveSetList.length; i < il; i++)\n                this.getPrimitiveSetList()[i] = primitiveSetList[i];\n\n            if (this.getStateSet())\n                console.error(\'A stateset in the rig is already present : \' + this.getStateSet());\n            this.setStateSet(this._geometry.getStateSet());\n        },\n\n        update: function() {\n            this._rigTransformImplementation.update(this);\n        },\n\n        computeTransformedVertex: function(id, out) {\n            out = out || __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n            var vList = this.getVertexAttributeList();\n            var vWeights = vList.Weights.getElements();\n            var vBones = vList.Bones.getElements();\n\n            var x = 0.0;\n            var y = 0.0;\n            var z = 0.0;\n            if (this._geometry.computeTransformedVertex) {\n                this._geometry.computeTransformedVertex(id, out);\n                x = out[0];\n                y = out[1];\n                z = out[2];\n            } else {\n                var verts = vList.Vertex.getElements();\n                x = verts[id * 3];\n                y = verts[id * 3 + 1];\n                z = verts[id * 3 + 2];\n            }\n\n            var id4 = id * 4;\n\n            var palette = this._rigTransformImplementation._skinningAttribute.getMatrixPalette();\n            var m0 = 0.0;\n            var m1 = 0.0;\n            var m2 = 0.0;\n            var m4 = 0.0;\n            var m5 = 0.0;\n            var m6 = 0.0;\n            var m8 = 0.0;\n            var m9 = 0.0;\n            var m10 = 0.0;\n            var m12 = 0.0;\n            var m13 = 0.0;\n            var m14 = 0.0;\n            var m15 = 0.0;\n\n            var doSkin = false;\n            for (var i = 0; i < 4; ++i) {\n                var w = vWeights[id4 + i];\n                if (w === 0.0) continue;\n\n                var idBone = vBones[id4 + i] * 12;\n\n                m0 += palette[idBone + 0] * w;\n                m4 += palette[idBone + 1] * w;\n                m8 += palette[idBone + 2] * w;\n                m12 += palette[idBone + 3] * w;\n\n                m1 += palette[idBone + 4] * w;\n                m5 += palette[idBone + 5] * w;\n                m9 += palette[idBone + 6] * w;\n                m13 += palette[idBone + 7] * w;\n\n                m2 += palette[idBone + 8] * w;\n                m6 += palette[idBone + 9] * w;\n                m10 += palette[idBone + 10] * w;\n                m14 += palette[idBone + 11] * w;\n\n                m15 += w;\n                doSkin = true;\n            }\n\n            if (!doSkin) {\n                out[0] = x;\n                out[1] = y;\n                out[2] = z;\n            }\n\n            var d = 1.0 / m15;\n            out[0] = (m0 * x + m4 * y + m8 * z + m12) * d;\n            out[1] = (m1 * x + m5 * y + m9 * z + m13) * d;\n            out[2] = (m2 * x + m6 * y + m10 * z + m14) * d;\n\n            return out;\n        },\n\n        computeTransformedVertices: function() {\n            // obviously slow as it can\'t rely on kdTree AND we transform everything cpu side\n\n            var vList = this.getVertexAttributeList();\n            var verts = this._geometry.computeTransformedVertices\n                ? this._geometry.computeTransformedVertices()\n                : vList.Vertex.getElements();\n            var vWeights = vList.Weights.getElements();\n            var vBones = vList.Bones.getElements();\n\n            var riggedVerts = this._riggedVerts || new Float32Array(verts.length);\n\n            // /!\\ if the geometry has several parents inside a skeleton\n            // it might not work as it will just take the last compute matrix palette\n            var palette = this._rigTransformImplementation._skinningAttribute.getMatrixPalette();\n\n            // verbose... but fast\n            for (var idv = 0, idr = 0, len = verts.length; idv < len; idv += 3, idr += 4) {\n                var m0 = 0.0;\n                var m1 = 0.0;\n                var m2 = 0.0;\n\n                var m4 = 0.0;\n                var m5 = 0.0;\n                var m6 = 0.0;\n\n                var m8 = 0.0;\n                var m9 = 0.0;\n                var m10 = 0.0;\n\n                var m12 = 0.0;\n                var m13 = 0.0;\n                var m14 = 0.0;\n                var m15 = 0.0;\n\n                var doSkin = false;\n\n                var w = vWeights[idr];\n                var idBone;\n                if (w !== 0.0) {\n                    idBone = vBones[idr] * 12;\n                    m0 += palette[idBone + 0] * w;\n                    m4 += palette[idBone + 1] * w;\n                    m8 += palette[idBone + 2] * w;\n                    m12 += palette[idBone + 3] * w;\n\n                    m1 += palette[idBone + 4] * w;\n                    m5 += palette[idBone + 5] * w;\n                    m9 += palette[idBone + 6] * w;\n                    m13 += palette[idBone + 7] * w;\n\n                    m2 += palette[idBone + 8] * w;\n                    m6 += palette[idBone + 9] * w;\n                    m10 += palette[idBone + 10] * w;\n                    m14 += palette[idBone + 11] * w;\n\n                    m15 += w;\n                    doSkin = true;\n                }\n\n                w = vWeights[idr + 1];\n                if (w !== 0.0) {\n                    idBone = vBones[idr + 1] * 12;\n                    m0 += palette[idBone + 0] * w;\n                    m4 += palette[idBone + 1] * w;\n                    m8 += palette[idBone + 2] * w;\n                    m12 += palette[idBone + 3] * w;\n\n                    m1 += palette[idBone + 4] * w;\n                    m5 += palette[idBone + 5] * w;\n                    m9 += palette[idBone + 6] * w;\n                    m13 += palette[idBone + 7] * w;\n\n                    m2 += palette[idBone + 8] * w;\n                    m6 += palette[idBone + 9] * w;\n                    m10 += palette[idBone + 10] * w;\n                    m14 += palette[idBone + 11] * w;\n\n                    m15 += w;\n                    doSkin = true;\n                }\n\n                w = vWeights[idr + 2];\n                if (w !== 0.0) {\n                    idBone = vBones[idr + 2] * 12;\n\n                    m0 += palette[idBone + 0] * w;\n                    m4 += palette[idBone + 1] * w;\n                    m8 += palette[idBone + 2] * w;\n                    m12 += palette[idBone + 3] * w;\n\n                    m1 += palette[idBone + 4] * w;\n                    m5 += palette[idBone + 5] * w;\n                    m9 += palette[idBone + 6] * w;\n                    m13 += palette[idBone + 7] * w;\n\n                    m2 += palette[idBone + 8] * w;\n                    m6 += palette[idBone + 9] * w;\n                    m10 += palette[idBone + 10] * w;\n                    m14 += palette[idBone + 11] * w;\n\n                    m15 += w;\n                    doSkin = true;\n                }\n\n                w = vWeights[idr + 3];\n                if (w !== 0.0) {\n                    idBone = vBones[idr + 3] * 12;\n\n                    m0 += palette[idBone + 0] * w;\n                    m4 += palette[idBone + 1] * w;\n                    m8 += palette[idBone + 2] * w;\n                    m12 += palette[idBone + 3] * w;\n\n                    m1 += palette[idBone + 4] * w;\n                    m5 += palette[idBone + 5] * w;\n                    m9 += palette[idBone + 6] * w;\n                    m13 += palette[idBone + 7] * w;\n\n                    m2 += palette[idBone + 8] * w;\n                    m6 += palette[idBone + 9] * w;\n                    m10 += palette[idBone + 10] * w;\n                    m14 += palette[idBone + 11] * w;\n\n                    m15 += w;\n                    doSkin = true;\n                }\n\n                var x = verts[idv];\n                var y = verts[idv + 1];\n                var z = verts[idv + 2];\n\n                if (!doSkin) {\n                    riggedVerts[idv] = x;\n                    riggedVerts[idv + 1] = y;\n                    riggedVerts[idv + 2] = z;\n                    continue;\n                }\n\n                var d = 1.0 / m15;\n                riggedVerts[idv] = (m0 * x + m4 * y + m8 * z + m12) * d;\n                riggedVerts[idv + 1] = (m1 * x + m5 * y + m9 * z + m13) * d;\n                riggedVerts[idv + 2] = (m2 * x + m6 * y + m10 * z + m14) * d;\n            }\n\n            return riggedVerts;\n        }\n    }),\n    \'osgAnimation\',\n    \'RigGeometry\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (RigGeometry);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/RigGeometry.js\n// module id = 45\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/RigGeometry.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgAnimation_target__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__ = __webpack_require__(124);\n\n\n\n\n\n\nvar Channel = {};\n\n// channel {\n//     keys: [],\n//     times: [],\n//     type: enum,\n//     target: targetName\n// }\n// init a channel with extra field\n// start, end, duration\nvar initChannel = function(type, keys, times, targetName, channelName, channel) {\n    var start = times[0];\n    var end = times[times.length - 1];\n    channel.start = start;\n    channel.keys = keys;\n    channel.end = end;\n    channel.times = times;\n    channel.type = type;\n    channel.duration = end - start;\n    channel.target = targetName;\n    channel.name = channelName;\n    return channel;\n};\n\nvar createVec3Channel = function(keys, times, targetName, channelName, chan) {\n    return initChannel(__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Vec3, keys, times, targetName, channelName, chan || {});\n};\n\nvar createFloatChannel = function(keys, times, targetName, channelName, chan) {\n    return initChannel(__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Float, keys, times, targetName, channelName, chan || {});\n};\n\nvar createQuatChannel = function(keys, times, targetName, channelName, chan) {\n    return initChannel(__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Quat, keys, times, targetName, channelName, chan || {});\n};\n\nvar createQuatSlerpChannel = function(keys, times, targetName, channelName, chan) {\n    return initChannel(__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].QuatSlerp, keys, times, targetName, channelName, chan || {});\n};\n\nvar createFloatCubicBezierChannel = function(keys, times, targetName, channelName, chan) {\n    return initChannel(\n        __WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].FloatCubicBezier,\n        keys,\n        times,\n        targetName,\n        channelName,\n        chan || {}\n    );\n};\n\nvar createVec3CubicBezierChannel = function(keys, times, targetName, channelName, chan) {\n    return initChannel(\n        __WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Vec3CubicBezier,\n        keys,\n        times,\n        targetName,\n        channelName,\n        chan || {}\n    );\n};\n\n// channel contains {\n//     keys: [],\n//     times: [],\n//     start: 0.0,\n//     end: 1.0,\n// }\n// return {\n//     channel: channel,\n//     value: vec3.create(),\n//     targetID: int,\n//     key: 0,\n//     t: 0, //global start time\n// }\n\nvar Float = {\n    create: function() {\n        return 0;\n    }\n};\nvar Vec3 = {\n    create: function() {\n        return __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create32();\n    }\n};\nvar Quat = {\n    create: function() {\n        return __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create32();\n    }\n};\n\nvar createInstanceChannelType = function(operator, channel) {\n    return {\n        channel: channel,\n        value: operator.create(),\n        targetID: __WEBPACK_IMPORTED_MODULE_1_osgAnimation_target__["a" /* default */].InvalidTargetID,\n        weight: 1.0,\n        key: 0,\n        start: 0.0,\n        end: 0.0\n    };\n};\n\nvar createInstanceVec3Channel = function(channel) {\n    return createInstanceChannelType(Vec3, channel);\n};\n\nvar createInstanceQuatChannel = function(channel) {\n    return createInstanceChannelType(Quat, channel);\n};\n\nvar createInstanceFloatChannel = function(channel) {\n    return createInstanceChannelType(Float, channel);\n};\n\nvar createInstanceFloatCubicBezierChannel = function(channel) {\n    return createInstanceChannelType(Float, channel);\n};\n\nvar createInstanceVec3CubicBezierChannel = function(channel) {\n    return createInstanceChannelType(Vec3, channel);\n};\n\n// create an instance channel from type\nvar createInstanceChannel = function(channel) {\n    return Channel[channel.type](channel);\n};\n\n// animations instances\n/*\n\n |-----------------| anim0 (channel0_0, channel0_1 )\n           |--------------| anim1 (channel1_0, channel1_1, channel1_2 )\n\n // si triage a cause de la priorité\n // iterate on priority\n // and for animations of the same priority\n\n\n // init d\'une animation\n\n // init du manager\n //   createInstanceAnimation pour chaque animations\n //      createInstanceChannels pour chaque animation\n\n //   initChannelTargetID pour toute les animations du manager\n //      id -> targetName\n\n\n // get target for an animation to push on target list ( to blend )\n var targets = {};\n for ( var i = 0 ; i < channels.length; i++ ) {\n    var target = channels[i].target;\n    targets[target].push( channels[i] );\n }\n\n\n // pour l\'instant on ignore les pb d\'organisation de priorité\n //\n // target X : [\n //      ChannelAnima0_0\n //      ChannelAnima1_0\n // ]\n\n // target Y : [\n //      ChannelAnima0_1\n //      ChannelAnima1_1\n // ]\n\n\n */\n\n// for a target compute each channel contribution\n// channel0, value0, w, priority0\n// channel1, value1, w, priority0\n// channel2, value2, w, priority0\n\n// channel0, value0, w, priority1\n// channel1, value1, w, priority1\n// channel2, value2, w, priority1\n\n/*\n\n var value;\n Copy( channels[0].value, value );\n var weight = 0.0;\n var priority = channels[0].priority;\n var priorityWeight = channels[0].weight;\n\n for ( var i = 1; i < channels.length; i++ ) {\n\n     if ( priority !== channels[i].priority ) {\n          weight += priorityWeight * ( 1.0 - weight );\n          priorityWeight = 0.0;\n          priority = channels[i].priority;\n     }\n\n     priorityWeight += weight;\n     t = ( 1.0 - weight ) * channels[i].weight / priorityWeight;\n     lerp( t, value, channels[i].value );\n }\n\n\n // second version\n\n var value;\n Copy( channels[0].value, value );\n var weight = 0; //channels[0].weight;\n //var priority = channels[0].priority;\n var priorityWeight = 0;\n\n for ( var i = 0; i < channels.length; i++ ) {\n\n     if ( priority !== channels[i].priority ) {\n          weight += priorityWeight * ( 1.0 - weight );\n          priorityWeight = 0.0;\n          priority = channels[i].priority;\n     }\n\n     priorityWeight += weight;\n     t = ( 1.0 - weight ) * channels[i].weight / priorityWeight;\n     lerp( t, value, channels[i].value );\n }\n\n\n */\n\nChannel.createInstanceChannel = createInstanceChannel;\nChannel.createInstanceVec3Channel = createInstanceVec3Channel;\nChannel.createInstanceQuatChannel = createInstanceQuatChannel;\nChannel.createInstanceQuatSlerpChannel = createInstanceQuatChannel;\nChannel.createInstanceFloatChannel = createInstanceFloatChannel;\nChannel.createInstanceFloatCubicBezierChannel = createInstanceFloatCubicBezierChannel;\nChannel.createInstanceVec3CubicBezierChannel = createInstanceVec3CubicBezierChannel;\n\nChannel.createVec3Channel = createVec3Channel;\nChannel.createQuatChannel = createQuatChannel;\nChannel.createQuatSlerpChannel = createQuatSlerpChannel;\nChannel.createFloatChannel = createFloatChannel;\nChannel.createFloatCubicBezierChannel = createFloatCubicBezierChannel;\nChannel.createVec3CubicBezierChannel = createVec3CubicBezierChannel;\n\nChannel[__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Vec3] = createInstanceVec3Channel;\nChannel[__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Quat] = createInstanceQuatChannel;\nChannel[__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].QuatSlerp] = createInstanceQuatChannel;\nChannel[__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Float] = createInstanceFloatChannel;\nChannel[__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].FloatCubicBezier] = createInstanceFloatCubicBezierChannel;\nChannel[__WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */].Vec3CubicBezier] = createInstanceVec3CubicBezierChannel;\n\nChannel.ChannelType = __WEBPACK_IMPORTED_MODULE_2_osgAnimation_channelType__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (Channel);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/channel.js\n// module id = 46\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/channel.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n\n\nvar requestFileFromURL = function(url, options) {\n    return new __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a(function(resolve, reject) {\n        var req = new XMLHttpRequest();\n        req.open('GET', url, true);\n\n        // handle responseType\n        if (options && options.responseType) req.responseType = options.responseType;\n\n        if (options && options.progress) {\n            req.addEventListener('progress', options.progress, false);\n        }\n\n        req.addEventListener('error', reject, false);\n\n        req.addEventListener('load', function() {\n            if (req.responseType === 'arraybuffer' || req.responseType === 'blob')\n                resolve(req.response);\n            else resolve(req.responseText);\n        });\n\n        req.send(null);\n    });\n};\n\nvar requestFileFromReader = function(file, options) {\n    return new __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a(function(resolve) {\n        var reader = new window.FileReader();\n        reader.onload = function(data) {\n            if (options.responseType === 'blob') {\n                var img = new window.Image();\n                img.src = data.target.result;\n                resolve(img);\n            } else {\n                resolve(data.target.result);\n            }\n        };\n        // handle responseType\n        if (options && options.responseType) {\n            if (options.responseType === 'arraybuffer') reader.readAsArrayBuffer(file);\n            else if (options.responseType === 'string') reader.readAsText(file);\n            else reader.readAsDataURL(file);\n        } else {\n            reader.readAsText(file);\n        }\n    });\n};\n\nvar requestFile = function(urlOrFile, options) {\n    // $$ SOURCE_CODE_MODIFIED\n    // PC端OSG\n    // PagedLOD::setDatabasePath();\n    // PagedLOD::setDatabaseOptions(); // 要对加载的节点，用访问器，主动调用设置\n    // nv.getDatabaseRequestHandler()->requestNodeFile(\n    //  _databasePath + _perRangeDataList[numChildren]._filename, ...,\n    //  _databaseOptions.get());\n    // PC端OSG 的 PagedLOD 有对options继承的考虑\n    // 所以可以在options上设置读写回调\n    //\n    // osgjs 的 PagedLOD 没有对options继承的考虑\n    // 只有 PagedLOD::setDatabasePath()\n    // 所以此处没有考虑在options上设置读写回调\n    if (requestFile.requestFileCallback) {\n        return requestFile.requestFileCallback(urlOrFile, options).then(\n            function(data) {\n                return data;\n            },\n            function(data) {\n                if (typeof urlOrFile === 'string') {\n                    return requestFileFromURL(urlOrFile, options);\n                }\n                else {\n                    return requestFileFromReader(urlOrFile, options);\n                }\n            },\n        );\n    }\n    // $$ SOURCE_CODE_MODIFIED\n    if (typeof urlOrFile === 'string') {\n        return requestFileFromURL(urlOrFile, options);\n    } else {\n        return requestFileFromReader(urlOrFile, options);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (requestFile);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/requestFile.js\n// module id = 47\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/requestFile.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_transformEnums__ = __webpack_require__(12);\n\n\n\nvar computeLocalToWorld = function(nodePath, ignoreCameras, userMatrix, nodePathIndex) {\n    var ignoreCamera = ignoreCameras;\n    var nodePathLength = nodePathIndex !== undefined ? nodePathIndex : nodePath.length;\n    if (ignoreCamera === undefined) ignoreCamera = true;\n\n    var matrix = userMatrix || __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create();\n\n    var j = 0;\n\n    if (ignoreCamera) {\n        for (j = nodePathLength - 1; j >= 0; j--) {\n            var camera = nodePath[j];\n\n            if (\n                camera.className() === \'Camera\' &&\n                (camera.getReferenceFrame() !== __WEBPACK_IMPORTED_MODULE_1_osg_transformEnums__["a" /* default */].RELATIVE_RF ||\n                    camera.getParents().length === 0)\n            ) {\n                break;\n            }\n        }\n\n        // because when we break it\'s to an index - 1\n        // it works because if nothing camera found j == -1 at the end of the loop\n        // and if we found a camera we want to start at the camera index + 1\n        j += 1;\n    }\n\n    for (var i = j, l = nodePathLength; i < l; i++) {\n        var node = nodePath[i];\n\n        if (node.computeLocalToWorldMatrix) {\n            node.computeLocalToWorldMatrix(matrix);\n        }\n    }\n\n    return matrix;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    computeLocalToWorld: computeLocalToWorld\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/computeMatrixFromNodePath.js\n// module id = 48\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/computeMatrixFromNodePath.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("var CullSettings = function() {\n    // Not doing a this.reset()\n    // because of multiple inheritance\n    // it will call the wrong reset\n    // cullstack reset for isntance()\n    CullSettings.prototype.reset.call(this);\n};\n\nCullSettings.prototype = {\n    reset: function() {\n        this._computeNearFar = true;\n        this._nearFarRatio = 0.005;\n\n        // Magic numbers 3 & 4\n        this.bbCornerFar = 3;\n        this.bbCornerNear = 4;\n        // // see code below for for the\n        // // Code simplification origin\n        // var vec3 = require('osg/glMatrix').default.vec3;\n        // var lookVector = vec3.fromValues(0.0, 0.0, -1.0);\n        // this.bbCornerFar =\n        //     (lookVector[0] >= 0 ? 1 : 0) |\n        //     (lookVector[1] >= 0 ? 2 : 0) |\n        //     (lookVector[2] >= 0 ? 4 : 0);\n        // this.bbCornerNear = ~this.bbCornerFar & 7;\n        // // is equivalent to\n\n        this._enableFrustumCulling = false;\n\n        // who sets the parameter\n        // if it's cullvisitor\n        // it's an OVERRIDER for enableFrustumCulling\n        // allowing for global EnableFrustimCulling\n        this._settingsSourceOverrider = this;\n        //LOD bias for the CullVisitor to use\n        this._LODScale = 1.0;\n        // Custom clampProjectionMatrix\n        this._clampProjectionMatrixCallback = undefined;\n    },\n\n    setCullSettings: function(settings) {\n        this._computeNearFar = settings._computeNearFar;\n        this._nearFarRatio = settings._nearFarRatio;\n        this._enableFrustumCulling = settings._enableFrustumCulling;\n        this._settingsSourceOverrider = settings._settingsSourceOverrider;\n        this._clampProjectionMatrixCallback = settings._clampProjectionMatrixCallback;\n    },\n\n    setNearFarRatio: function(ratio) {\n        this._nearFarRatio = ratio;\n    },\n    getNearFarRatio: function() {\n        return this._nearFarRatio;\n    },\n    setComputeNearFar: function(value) {\n        this._computeNearFar = value;\n    },\n    getComputeNearFar: function() {\n        return this._computeNearFar;\n    },\n\n    setEnableFrustumCulling: function(value) {\n        this._enableFrustumCulling = value;\n    },\n    getEnableFrustumCulling: function() {\n        return this._enableFrustumCulling;\n    },\n\n    getSettingSourceOverrider: function() {\n        return this._settingsSourceOverrider;\n    },\n\n    setClampProjectionMatrixCallback: function(callback) {\n        this._clampProjectionMatrixCallback = callback;\n    },\n\n    getClampProjectionMatrixCallback: function() {\n        return this._clampProjectionMatrixCallback;\n    },\n\n    setLODScale: function(scale) {\n        this._LODScale = scale;\n    },\n    getLODScale: function() {\n        return this._LODScale;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CullSettings);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/CullSettings.js\n// module id = 49\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/CullSettings.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\n/**\n *  Manage CullFace attribute\n *  @class CullFace\n */\nvar CullFace = function(mode) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this.setMode(mode !== undefined ? mode : CullFace.BACK);\n};\n\nCullFace.DISABLE = 0x0;\nCullFace.FRONT = 0x0404;\nCullFace.BACK = 0x0405;\nCullFace.FRONT_AND_BACK = 0x0408;\n\n/** @lends CullFace.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    CullFace,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'CullFace\',\n\n        cloneType: function() {\n            return new CullFace();\n        },\n\n        setMode: function(mode) {\n            var value = mode;\n            if (typeof value === \'string\') value = CullFace[value];\n            this._mode = value;\n        },\n\n        getMode: function() {\n            return this._mode;\n        },\n\n        apply: function(state) {\n            state.applyCullFace(this);\n        }\n    }),\n    \'osg\',\n    \'CullFace\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (CullFace);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/CullFace.js\n// module id = 50\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/CullFace.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_math__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_CullSettings__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_CullStack__ = __webpack_require__(109);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_AutoTransform__ = __webpack_require__(74);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Projection__ = __webpack_require__(78);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_LightSource__ = __webpack_require__(79);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__ = __webpack_require__(103);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_RenderLeaf__ = __webpack_require__(110);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osg_RenderBin__ = __webpack_require__(61);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osg_RenderStage__ = __webpack_require__(81);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osg_Lod__ = __webpack_require__(82);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osg_Switch__ = __webpack_require__(111);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osg_PagedLOD__ = __webpack_require__(83);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22_osgAnimation_Skeleton__ = __webpack_require__(62);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23_osgAnimation_RigGeometry__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24_osgAnimation_Bone__ = __webpack_require__(44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27_osg_PooledResource__ = __webpack_require__(25);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar createRenderLeaf = function() {\n    return new __WEBPACK_IMPORTED_MODULE_13_osg_RenderLeaf__["a" /* default */]();\n};\n\nvar createCullSettings = function() {\n    return new __WEBPACK_IMPORTED_MODULE_4_osg_CullSettings__["a" /* default */]();\n};\n\n/**\n * CullVisitor traverse the tree and collect Matrix/State for the rendering traverse\n * @class CullVisitor\n */\nvar CullVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].TRAVERSE_ACTIVE_CHILDREN);\n    __WEBPACK_IMPORTED_MODULE_4_osg_CullSettings__["a" /* default */].call(this);\n    __WEBPACK_IMPORTED_MODULE_5_osg_CullStack__["a" /* default */].call(this);\n\n    this._rootStateGraph = undefined;\n    this._currentStateGraph = undefined;\n    this._currentRenderBin = undefined;\n    this._currentRenderStage = undefined;\n    this._rootRenderStage = undefined;\n    this._computedNear = Number.POSITIVE_INFINITY;\n    this._computedFar = Number.NEGATIVE_INFINITY;\n\n    var lookVector = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, -1.0);\n    this._camera = undefined;\n    /*jshint bitwise: false */\n    this._bbCornerFar =\n        (lookVector[0] >= 0 ? 1 : 0) | (lookVector[1] >= 0 ? 2 : 0) | (lookVector[2] >= 0 ? 4 : 0);\n    this._bbCornerNear = ~this._bbCornerFar & 7;\n    /*jshint bitwise: true */\n\n    this._pooledLeaf = new __WEBPACK_IMPORTED_MODULE_27_osg_PooledResource__["a" /* default */](createRenderLeaf);\n\n    this._pooledRenderStages = {};\n\n    this._pooledCullSettings = new __WEBPACK_IMPORTED_MODULE_27_osg_PooledResource__["a" /* default */](createCullSettings);\n\n    this._renderBinStack = new __WEBPACK_IMPORTED_MODULE_26_osg_PooledArray__["a" /* default */]();\n    this.visitorType = __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].CULL_VISITOR;\n\n    this._identityMatrix = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n\n    this._renderer = undefined;\n    this._renderStageType = __WEBPACK_IMPORTED_MODULE_15_osg_RenderStage__["a" /* default */];\n\n    this._numCamera = 0;\n    this._numMatrixTransform = 0;\n    this._numProjection = 0;\n    this._numNode = 0;\n    this._numLightSource = 0;\n    this._numGeometry = 0;\n};\n\nCullVisitor.registerApplyFunction = __WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction;\nCullVisitor.getApplyFunction = __WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].getApplyFunction;\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    CullVisitor,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(\n        __WEBPACK_IMPORTED_MODULE_5_osg_CullStack__["a" /* default */].prototype,\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].prototype, {\n            applyFunctionArray: __WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].applyFunctionArray,\n\n            distance: function(coord, matrix) {\n                return -(\n                    coord[0] * matrix[2] +\n                    coord[1] * matrix[6] +\n                    coord[2] * matrix[10] +\n                    matrix[14]\n                );\n            },\n\n            getComputedNear: function() {\n                return this._computedNear;\n            },\n\n            getComputedFar: function() {\n                return this._computedFar;\n            },\n\n            resetStats: function() {\n                this._numCamera = 0;\n                this._numMatrixTransform = 0;\n                this._numProjection = 0;\n                this._numNode = 0;\n                this._numLightSource = 0;\n                this._numGeometry = 0;\n            },\n\n            handleCullCallbacksAndTraverse: function(node) {\n                var ccb = node.getCullCallback();\n                if (ccb && !ccb.cull(node, this)) return;\n                this.traverse(node);\n            },\n\n            getCurrentCamera: function() {\n                return this._currentRenderBin.getStage().getCamera();\n            },\n\n            updateCalculatedNearFar: (function() {\n                var nearVec = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n                var farVec = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n\n                return function(matrix, drawable) {\n                    var bb = drawable.getBoundingBox();\n                    var dNear, dFar;\n\n                    // efficient computation of near and far, only taking into account the nearest and furthest\n                    // corners of the bounding box.\n                    dNear = this.distance(bb.corner(this._bbCornerNear, nearVec), matrix);\n                    dFar = this.distance(bb.corner(this._bbCornerFar, farVec), matrix);\n\n                    if (dNear > dFar) {\n                        var tmp = dNear;\n                        dNear = dFar;\n                        dFar = tmp;\n                    }\n\n                    if (dFar < 0.0) {\n                        // whole object behind the eye point so discard\n                        return false;\n                    }\n\n                    if (dNear < this._computedNear) {\n                        this._computedNear = dNear;\n                    }\n\n                    if (dFar > this._computedFar) {\n                        this._computedFar = dFar;\n                    }\n\n                    return true;\n                };\n            })(),\n\n            setStateGraph: function(sg) {\n                this._rootStateGraph = sg;\n                this._currentStateGraph = sg;\n            },\n            setRenderStage: function(rg) {\n                this._rootRenderStage = rg;\n                this._currentRenderBin = rg;\n            },\n            setRenderer: function(renderer) {\n                this._renderer = renderer;\n            },\n            getRenderer: function() {\n                return this._renderer;\n            },\n\n            reset: function() {\n                __WEBPACK_IMPORTED_MODULE_5_osg_CullStack__["a" /* default */].prototype.reset.call(this);\n\n                this._pooledLeaf.reset();\n                this._pooledCullSettings.reset();\n\n                // renderstage / renderbin pools\n                for (var key in this._pooledRenderStages) {\n                    this._pooledRenderStages[key].reset();\n                }\n                __WEBPACK_IMPORTED_MODULE_14_osg_RenderBin__["a" /* default */].reset();\n\n                this._computedNear = Number.POSITIVE_INFINITY;\n                this._computedFar = Number.NEGATIVE_INFINITY;\n            },\n\n            getCurrentRenderBin: function() {\n                return this._currentRenderBin;\n            },\n\n            setCurrentRenderBin: function(rb) {\n                this._currentRenderBin = rb;\n            },\n\n            // mimic the osg implementation\n            // in osg you can push 0, in this case an identity matrix will be loaded\n            addPositionedAttribute: function(matrix, attribute) {\n                var m = matrix ? matrix : this._identityMatrix;\n                this._currentRenderBin.getStage().addPositionAttribute(m, attribute);\n            },\n\n            pushStateSet: function(stateset) {\n                this._currentStateGraph = this._currentStateGraph.findOrInsert(stateset);\n                if (stateset.getBinName() !== undefined) {\n                    var renderBinStack = this._renderBinStack;\n                    var currentRenderBin = this._currentRenderBin;\n                    renderBinStack.push(currentRenderBin);\n                    this._currentRenderBin = currentRenderBin\n                        .getStage()\n                        .findOrInsert(stateset.getBinNumber(), stateset.getBinName());\n                }\n            },\n\n            /** Pop the top state set and hence associated state group.\n             * Move the current state group to the parent of the popped\n             * state group.\n             */\n            popStateSet: function() {\n                var currentStateGraph = this._currentStateGraph;\n                var stateset = currentStateGraph.getStateSet();\n                this._currentStateGraph = currentStateGraph.getParent();\n                if (stateset.getBinName() !== undefined) {\n                    var renderBinStack = this._renderBinStack;\n                    if (renderBinStack.getLength() === 0) {\n                        this._currentRenderBin = this._currentRenderBin.getStage();\n                    } else {\n                        this._currentRenderBin = renderBinStack.pop();\n                    }\n                }\n            },\n\n            popProjectionMatrix: function() {\n                if (this._computeNearFar === true && this._computedFar >= this._computedNear) {\n                    var m = this.getCurrentProjectionMatrix();\n                    if (this._clampProjectionMatrixCallback !== undefined) {\n                        this._clampProjectionMatrixCallback(\n                            m,\n                            this._computedNear,\n                            this._computedFar,\n                            this._nearFarRatio\n                        );\n                    } else {\n                        this.clampProjectionMatrix(\n                            m,\n                            this._computedNear,\n                            this._computedFar,\n                            this._nearFarRatio\n                        );\n                    }\n                }\n                __WEBPACK_IMPORTED_MODULE_5_osg_CullStack__["a" /* default */].prototype.popProjectionMatrix.call(this);\n            },\n\n            clampProjectionMatrix: function(projection, znear, zfar, nearFarRatio, resultNearFar) {\n                var epsilon = 1e-6;\n                if (zfar < znear - epsilon) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\n                        \'clampProjectionMatrix not applied, invalid depth range, znear = \' +\n                            znear +\n                            \'  zfar = \' +\n                            zfar,\n                        false,\n                        true\n                    );\n                    return false;\n                }\n\n                var desiredZnear, desiredZfar;\n                if (zfar < znear + epsilon) {\n                    // znear and zfar are too close together and could cause divide by zero problems\n                    // late on in the clamping code, so move the znear and zfar apart.\n                    var average = (znear + zfar) * 0.5;\n                    znear = average - epsilon;\n                    zfar = average + epsilon;\n                    // OSG_INFO << \'_clampProjectionMatrix widening znear and zfar to \'<<znear<<\' \'<<zfar<<std::endl;\n                }\n\n                if (\n                    Math.abs(projection[3]) < epsilon &&\n                    Math.abs(projection[7]) < epsilon &&\n                    Math.abs(projection[11]) < epsilon\n                ) {\n                    // OSG_INFO << \'Orthographic matrix before clamping\'<<projection<<std::endl;\n\n                    var deltaSpan = (zfar - znear) * 0.02;\n                    if (deltaSpan < 1.0) {\n                        deltaSpan = 1.0;\n                    }\n                    desiredZnear = znear - deltaSpan;\n                    desiredZfar = zfar + deltaSpan;\n\n                    // assign the clamped values back to the computed values.\n                    znear = desiredZnear;\n                    zfar = desiredZfar;\n\n                    projection[10] = -2.0 / (desiredZfar - desiredZnear);\n                    projection[14] = -(desiredZfar + desiredZnear) / (desiredZfar - desiredZnear);\n                    // OSG_INFO << \'Orthographic matrix after clamping \'<<projection<<std::endl;\n                } else {\n                    // OSG_INFO << \'Persepective matrix before clamping\'<<projection<<std::endl;\n                    //std::cout << \'_computed_znear\'<<_computed_znear<<std::endl;\n                    //std::cout << \'_computed_zfar\'<<_computed_zfar<<std::endl;\n\n                    var zfarPushRatio = 1.02;\n                    var znearPullRatio = 0.98;\n\n                    //znearPullRatio = 0.99;\n\n                    desiredZnear = znear * znearPullRatio;\n                    desiredZfar = zfar * zfarPushRatio;\n\n                    // near plane clamping.\n                    var minNearPlane = zfar * nearFarRatio;\n                    if (desiredZnear < minNearPlane) {\n                        desiredZnear = minNearPlane;\n                    }\n\n                    // assign the clamped values back to the computed values.\n                    znear = desiredZnear;\n                    zfar = desiredZfar;\n\n                    var m22 = projection[10];\n                    var m32 = projection[14];\n                    var m23 = projection[11];\n                    var m33 = projection[15];\n                    var transNearPlane = (-desiredZnear * m22 + m32) / (-desiredZnear * m23 + m33);\n                    var transFarPlane = (-desiredZfar * m22 + m32) / (-desiredZfar * m23 + m33);\n\n                    var ratio = Math.abs(2.0 / (transNearPlane - transFarPlane));\n                    var center = -(transNearPlane + transFarPlane) / 2.0;\n\n                    var centerRatio = center * ratio;\n                    projection[2] = projection[2] * ratio + projection[3] * centerRatio;\n                    projection[6] = projection[6] * ratio + projection[7] * centerRatio;\n                    projection[10] = m22 * ratio + m23 * centerRatio;\n                    projection[14] = m32 * ratio + m33 * centerRatio;\n                    // same as\n                    // var matrix = [ 1.0, 0.0, 0.0, 0.0,\n                    //     0.0, 1.0, 0.0, 0.0,\n                    //     0.0, 0.0, ratio, 0.0,\n                    //     0.0, 0.0, center * ratio, 1.0\n                    // ];\n                    // mat4.mul( projection , matrix, projection );\n\n                    // OSG_INFO << \'Persepective matrix after clamping\'<<projection<<std::endl;\n                }\n                if (resultNearFar !== undefined) {\n                    resultNearFar[0] = znear;\n                    resultNearFar[1] = zfar;\n                }\n                return true;\n            },\n\n            popCameraModelViewProjectionMatrix: function() {\n                this.popModelViewMatrix();\n                this.popProjectionMatrix();\n            },\n\n            pushCameraModelViewProjectionMatrix: function(camera, modelview, projection) {\n                this.pushModelViewMatrix(modelview);\n                this.pushProjectionMatrix(projection);\n            },\n\n            apply: function(node) {\n                this.applyFunctionArray[node.nodeTypeID].call(this, node);\n            },\n\n            createOrReuseRenderLeaf: function() {\n                return this._pooledLeaf.getOrCreateObject();\n            },\n\n            createOrReuseRenderStage: function(classInstance) {\n                var type = !classInstance ? \'RenderStage\' : classInstance.className();\n\n                if (!this._pooledRenderStages[type]) {\n                    var classCtor = !classInstance ? __WEBPACK_IMPORTED_MODULE_15_osg_RenderStage__["a" /* default */] : classInstance.constructor;\n                    var createRenderStage = function() {\n                        return new classCtor();\n                    };\n                    this._pooledRenderStages[type] = new __WEBPACK_IMPORTED_MODULE_27_osg_PooledResource__["a" /* default */](createRenderStage);\n                }\n                return this._pooledRenderStages[type].getOrCreateObject().init();\n            },\n\n            // function call after the push state in the geometry apply function\n            // the idea is to avoid heavy copy-paste for the rigGeometry apply\n            // since the only difference is that we want to push an additional state\n            // Maybe it will be useful when we\'ll add morph target geometry or something...\n            postPushGeometry: function(cull, node) {\n                var sourceGeometry;\n                var geometryStateSetAnimation;\n\n                if (node instanceof __WEBPACK_IMPORTED_MODULE_23_osgAnimation_RigGeometry__["a" /* default */]) {\n                    geometryStateSetAnimation = node.getStateSetAnimation();\n                    if (geometryStateSetAnimation) cull.pushStateSet(geometryStateSetAnimation);\n\n                    sourceGeometry = node.getSourceGeometry();\n\n                    if (sourceGeometry instanceof __WEBPACK_IMPORTED_MODULE_25_osgAnimation_MorphGeometry__["a" /* default */]) {\n                        geometryStateSetAnimation = sourceGeometry.getStateSetAnimation();\n                        if (geometryStateSetAnimation) cull.pushStateSet(geometryStateSetAnimation);\n                    }\n                } else if (node instanceof __WEBPACK_IMPORTED_MODULE_25_osgAnimation_MorphGeometry__["a" /* default */]) {\n                    geometryStateSetAnimation = node.getStateSetAnimation();\n                    if (geometryStateSetAnimation) cull.pushStateSet(geometryStateSetAnimation);\n                }\n            },\n\n            // same comment as above (postPushGeometry)\n            prePopGeometry: function(cull, node) {\n                if (node instanceof __WEBPACK_IMPORTED_MODULE_23_osgAnimation_RigGeometry__["a" /* default */]) {\n                    var sourceGeometry = node.getSourceGeometry();\n\n                    if (sourceGeometry instanceof __WEBPACK_IMPORTED_MODULE_25_osgAnimation_MorphGeometry__["a" /* default */]) {\n                        if (sourceGeometry.getStateSetAnimation()) cull.popStateSet();\n                    }\n\n                    if (node.getStateSetAnimation()) cull.popStateSet();\n                } else if (node instanceof __WEBPACK_IMPORTED_MODULE_25_osgAnimation_MorphGeometry__["a" /* default */] && node.getStateSetAnimation()) {\n                    cull.popStateSet();\n                }\n            },\n\n            pushLeaf: function(node, depth) {\n                var leafs = this._currentStateGraph.getLeafs();\n                if (!leafs.getLength()) {\n                    this._currentRenderBin.addStateGraph(this._currentStateGraph);\n                }\n\n                var leaf = this.createOrReuseRenderLeaf();\n\n                leaf.init(\n                    this._currentStateGraph,\n                    node,\n                    this.getCurrentProjectionMatrix(),\n                    this.getCurrentViewMatrix(),\n                    this.getCurrentModelViewMatrix(),\n                    this.getCurrentModelMatrix(),\n                    depth\n                );\n\n                leafs.push(leaf);\n            }\n        })\n    ),\n    \'osg\',\n    \'CullVisitor\'\n);\n\n// Camera cull visitor call\n// ANY CHANGE, any change : double check in rendere Camera code\n// for the first camera\nvar cameraApply = function(camera) {\n    this._numCamera++;\n\n    var stateset = camera.getStateSet();\n    if (stateset) this.pushStateSet(stateset);\n\n    var modelview = this._pooledMatrix.getOrCreateObject();\n    var projection = this._pooledMatrix.getOrCreateObject();\n\n    if (camera.getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_21_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n        var lastProjectionMatrix = this.getCurrentProjectionMatrix();\n        __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(projection, lastProjectionMatrix, camera.getProjectionMatrix());\n\n        var lastViewMatrix = this.getCurrentModelViewMatrix();\n        __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(modelview, lastViewMatrix, camera.getViewMatrix());\n    } else {\n        // absolute\n        __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].copy(modelview, camera.getViewMatrix());\n        __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].copy(projection, camera.getProjectionMatrix());\n    }\n\n    // save current state of the camera\n    var previousZnear = this._computedNear;\n    var previousZfar = this._computedFar;\n\n    var previousCullsettings = this._pooledCullSettings.getOrCreateObject();\n    previousCullsettings.reset();\n    previousCullsettings.setCullSettings(this);\n\n    this._computedNear = Number.POSITIVE_INFINITY;\n    this._computedFar = Number.NEGATIVE_INFINITY;\n    //\n\n    this.setCullSettings(camera);\n    // global override\n    // upon who setted the parameter\n    // if it\'s cullvisitor\n    // it\'s an OVERRIDER for enableFrustumCulling\n    // allowing for global EnableFrustimCulling\n    if (\n        previousCullsettings.getSettingSourceOverrider() === this &&\n        previousCullsettings.getEnableFrustumCulling()\n    ) {\n        this.setEnableFrustumCulling(true);\n    }\n\n    this.pushCameraModelViewProjectionMatrix(camera, modelview, projection);\n\n    if (camera.getViewport()) {\n        this.pushViewport(camera.getViewport());\n    }\n\n    // nested camera\n    if (camera.getRenderOrder() === __WEBPACK_IMPORTED_MODULE_20_osg_Camera__["a" /* default */].NESTED_RENDER) {\n        this.handleCullCallbacksAndTraverse(camera);\n    } else {\n        var renderBin = this.getCurrentRenderBin();\n        var previousStage = renderBin.getStage();\n\n        // use render to texture stage\n        var rtts = this.createOrReuseRenderStage(this._rootRenderStage);\n\n        rtts.setCamera(camera);\n        rtts.setClearDepth(camera.getClearDepth());\n        rtts.setClearColor(camera.getClearColor());\n        rtts.setClearMask(camera.getClearMask());\n\n        var viewport = camera.getViewport() ? camera.getViewport() : previousStage.getViewport();\n        var scissor = camera.getScissor() ? camera.getScissor() : previousStage.getScissor();\n        rtts.setViewport(viewport);\n        rtts.setScissor(scissor);\n\n        // skip positional state for now\n        // ...\n\n        this.setCurrentRenderBin(rtts);\n\n        this.handleCullCallbacksAndTraverse(camera);\n\n        this.setCurrentRenderBin(renderBin);\n\n        if (camera.getRenderOrder() === __WEBPACK_IMPORTED_MODULE_20_osg_Camera__["a" /* default */].PRE_RENDER) {\n            this.getCurrentRenderBin()\n                .getStage()\n                .addPreRenderStage(rtts, camera.renderOrderNum);\n        } else {\n            this.getCurrentRenderBin()\n                .getStage()\n                .addPostRenderStage(rtts, camera.renderOrderNum);\n        }\n    }\n\n    this.popCameraModelViewProjectionMatrix(camera);\n\n    if (camera.getViewport()) {\n        this.popViewport();\n    }\n\n    // restore previous state of the camera\n    this.setCullSettings(previousCullsettings);\n    this._computedNear = previousZnear;\n    this._computedFar = previousZfar;\n\n    if (stateset) this.popStateSet();\n};\n\nvar matrixTransformApply = function(node) {\n    this._numMatrixTransform++;\n\n    // Camera and lights must enlarge node parent bounding boxes for this not to cull\n    if (this.isCulled(node, this.nodePath)) {\n        return;\n    }\n    // push the culling mode.\n    this.pushCurrentMask();\n\n    var matrix = this._pooledMatrix.getOrCreateObject();\n    var lastMatrixStack = this.getCurrentModelViewMatrix();\n    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].copy(matrix, lastMatrixStack);\n    node.computeLocalToWorldMatrix(matrix);\n    this.pushModelViewMatrix(matrix);\n\n    var stateset = node.getStateSet();\n\n    if (stateset) this.pushStateSet(stateset);\n\n    this.handleCullCallbacksAndTraverse(node);\n\n    if (stateset) this.popStateSet();\n\n    this.popModelViewMatrix();\n\n    // pop the culling mode.\n    this.popCurrentMask();\n};\n\nvar projectionApply = function(node) {\n    this._numProjection++;\n\n    var lastMatrixStack = this.getCurrentProjectionMatrix();\n    var matrix = this._pooledMatrix.getOrCreateObject();\n    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(matrix, lastMatrixStack, node.getProjectionMatrix());\n    this.pushProjectionMatrix(matrix);\n\n    var stateset = node.getStateSet();\n    if (stateset) this.pushStateSet(stateset);\n\n    this.handleCullCallbacksAndTraverse(node);\n\n    if (stateset) this.popStateSet();\n\n    this.popProjectionMatrix();\n};\n\n// here it\'s treated as a group node for culling\n// as there\'s isn\'t any in osgjs\n// so frustumCulling is done here\nvar nodeApply = function(node) {\n    this._numNode++;\n\n    // Camera and lights must enlarge node parent bounding boxes for this not to cull\n    if (this.isCulled(node, this.nodePath)) {\n        return;\n    }\n\n    // push the culling mode.\n    this.pushCurrentMask();\n\n    var stateset = node.getStateSet();\n    if (stateset) this.pushStateSet(stateset);\n\n    this.handleCullCallbacksAndTraverse(node);\n\n    if (stateset) this.popStateSet();\n\n    // pop the culling mode.\n    this.popCurrentMask();\n};\n\nvar lightSourceApply = function(node) {\n    this._numLightSource++;\n\n    var stateset = node.getStateSet();\n    if (stateset) this.pushStateSet(stateset);\n\n    var light = node.getLight();\n    if (light) {\n        if (node.getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_21_osg_transformEnums__["a" /* default */].RELATIVE_RF)\n            this.addPositionedAttribute(this.getCurrentModelViewMatrix(), light);\n        else this.addPositionedAttribute(null, light);\n    }\n\n    this.handleCullCallbacksAndTraverse(node);\n\n    if (stateset) this.popStateSet();\n};\n\nvar tempVec = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\nvar loggedOnce = false;\nvar geometryApply = function(node) {\n    this._numGeometry++;\n\n    var modelview = this.getCurrentModelViewMatrix();\n    var bb = node.getBoundingBox();\n    if (this._computeNearFar && bb.valid()) {\n        if (!this.updateCalculatedNearFar(modelview, node)) {\n            return;\n        }\n    }\n\n    // using modelview is not a pb because geometry\n    // is a leaf node, else traversing the graph would be an\n    // issue because we use modelview after\n    var ccb = node.getCullCallback();\n    if (ccb && !ccb.cull(node, this)) return;\n\n    var stateset = node.getStateSet();\n    if (stateset) this.pushStateSet(stateset);\n\n    this.postPushGeometry(this, node);\n\n    var depth = 0;\n    if (bb.valid()) {\n        depth = this.distance(bb.center(tempVec), modelview);\n    }\n    if (__WEBPACK_IMPORTED_MODULE_2_osg_math__["a" /* default */].isNaN(depth)) {\n        if (!loggedOnce) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'warning geometry has a NaN depth, \' + modelview + \' center \' + tempVec);\n            loggedOnce = true;\n        }\n    } else {\n        this.pushLeaf(node, depth);\n    }\n\n    this.prePopGeometry(this, node);\n    if (stateset) this.popStateSet();\n};\n\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_16_osg_Node__["a" /* default */].nodeTypeID, nodeApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_18_osg_Switch__["a" /* default */].nodeTypeID, nodeApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_19_osg_PagedLOD__["a" /* default */].nodeTypeID, nodeApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_20_osg_Camera__["a" /* default */].nodeTypeID, cameraApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_7_osg_MatrixTransform__["a" /* default */].nodeTypeID, matrixTransformApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_9_osg_Projection__["a" /* default */].nodeTypeID, projectionApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_12_osg_Geometry__["a" /* default */].nodeTypeID, geometryApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_22_osgAnimation_Skeleton__["a" /* default */].nodeTypeID, matrixTransformApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_24_osgAnimation_Bone__["a" /* default */].nodeTypeID, matrixTransformApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_8_osg_AutoTransform__["a" /* default */].nodeTypeID, matrixTransformApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_17_osg_Lod__["a" /* default */].nodeTypeID, nodeApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_10_osg_LightSource__["a" /* default */].nodeTypeID, lightSourceApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_23_osgAnimation_RigGeometry__["a" /* default */].nodeTypeID, geometryApply);\n__WEBPACK_IMPORTED_MODULE_11_osg_cullVisitorHelper__["default"].registerApplyFunction(__WEBPACK_IMPORTED_MODULE_25_osgAnimation_MorphGeometry__["a" /* default */].nodeTypeID, geometryApply);\n\n/* harmony default export */ __webpack_exports__["a"] = (CullVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/CullVisitor.js\n// module id = 51\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/CullVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_MatrixTransform__ = __webpack_require__(15);\n\n\n\n\n\n/**\n *  AnimationUpdateCallback\n *  @class AnimationUpdateCallback\n */\nvar AnimationUpdateCallback = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].call(this);\n};\n\n// check if the path is animated, it could be elsewhere though\nAnimationUpdateCallback.checkPathIsAnimated = function(path) {\n    for (var i = 0, nbNodes = path.length; i < nbNodes; ++i) {\n        var node = path[i];\n\n        if (node instanceof __WEBPACK_IMPORTED_MODULE_3_osg_MatrixTransform__["a" /* default */]) {\n            var ups = node.getUpdateCallbackList();\n            for (var j = 0, nbUp = ups.length; j < nbUp; ++j) {\n                if (ups[j] instanceof AnimationUpdateCallback) return true;\n            }\n        }\n    }\n\n    return false;\n};\n\n/** @lends AnimationUpdateCallback.prototype */\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    AnimationUpdateCallback,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].prototype, {\n        linkChannel: function() {},\n        linkAnimation: function(anim) {\n            var name = this.getName();\n            if (name.length === 0) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'no name on an update callback, discard\');\n                return 0;\n            }\n            var nbLinks = 0;\n            var channels = anim.getChannels();\n            for (var i = 0, l = channels.length; i < l; i++) {\n                var channel = channels[i];\n                if (channel.getTargetName() === name) {\n                    this.linkChannel(channel);\n                    nbLinks++;\n                }\n            }\n            return nbLinks;\n        }\n    }),\n    \'osgAnimation\',\n    \'AnimationUpdateCallback\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (AnimationUpdateCallback);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/AnimationUpdateCallback.js\n// module id = 52\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/AnimationUpdateCallback.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n\n\n\n// use the same kind of opengl lights\n// see http://www.glprogramming.com/red/chapter05.html\n\nvar Light = function(lightNum, disable) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n\n    var lightNumber = lightNum !== undefined ? lightNum : 0;\n\n    this._ambient = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(0.2, 0.2, 0.2, 1.0);\n    this._diffuse = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(0.8, 0.8, 0.8, 1.0);\n    this._specular = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(0.2, 0.2, 0.2, 1.0);\n\n    // Default is directional as postion[3] is 0\n    this._position = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 1.0, 0.0);\n    this._direction = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, -1.0);\n\n    // TODO : refactor lights management w=1.0 (isHemi), w=-1.0\n    // (isNotHemi) _ground contains the color but w says if it\'s\n    // an hemi or not\n    this._ground = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(0.2, 0.2, 0.2, -1.0);\n\n    this._spotCutoff = 180.0;\n    this._spotBlend = 0.01;\n\n    // the array contains constant, linear, quadratic factor\n    this._attenuation = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.0, 0.0, 0.0);\n\n    this._lightNumber = lightNumber;\n\n    this._enable = !disable;\n    this._dirtyHash = true;\n    this._hash = \'\';\n};\n\nLight.DIRECTION = \'DIRECTION\';\nLight.SPOT = \'SPOT\';\nLight.POINT = \'POINT\';\nLight.HEMI = \'HEMI\';\n\nLight.uniforms = {};\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    Light,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Light\',\n\n        cloneType: function() {\n            return new Light(this._lightNumber, true);\n        },\n\n        getTypeMember: function() {\n            return this.attributeType + this._lightNumber;\n        },\n\n        getUniformName: function(name) {\n            return \'u\' + this.getTypeMember() + \'_\' + name;\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        },\n\n        _computeInternalHash: function() {\n            return this.getTypeMember() + this.getLightType() + this.isEnabled().toString();\n        },\n        getOrCreateUniforms: function() {\n            var obj = Light;\n            var typeMember = this.getTypeMember();\n\n            if (obj.uniforms[typeMember]) return obj.uniforms[typeMember];\n\n            obj.uniforms[typeMember] = {\n                viewPosition: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'viewPosition\')),\n                viewDirection: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat3(this.getUniformName(\'viewDirection\')),\n                modelViewMatrix: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createMatrix4(this.getUniformName(\'modelViewMatrix\')),\n                modelViewNormalMatrix: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createMatrix3(\n                    this.getUniformName(\'modelViewNormalMatrix\')\n                ),\n\n                ambient: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'ambient\')),\n                diffuse: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'diffuse\')),\n                specular: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'specular\')),\n                attenuation: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'attenuation\')),\n\n                spotCutOff: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat1(this.getUniformName(\'spotCutOff\')),\n                spotBlend: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat1(this.getUniformName(\'spotBlend\')),\n                ground: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'ground\'))\n            };\n\n            return obj.uniforms[typeMember];\n        },\n\n        // enable / disable is not implemented in uniform\n        // we should add it\n        isEnabled: function() {\n            return this._enable;\n        },\n\n        setEnabled: function(bool) {\n            this._enable = bool;\n            this._dirtyHash = true;\n        },\n\n        // colors\n        setAmbient: function(a) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].copy(this._ambient, a);\n        },\n\n        getAmbient: function() {\n            return this._ambient;\n        },\n\n        setDiffuse: function(a) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].copy(this._diffuse, a);\n        },\n\n        getDiffuse: function() {\n            return this._diffuse;\n        },\n\n        setSpecular: function(a) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].copy(this._specular, a);\n        },\n\n        getSpecular: function() {\n            return this._specular;\n        },\n\n        // position, also used for directional light\n        // position[3] === 0 means directional\n        // see creating lightsources http://www.glprogramming.com/red/chapter05.html\n        setPosition: function(a) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].copy(this._position, a);\n        },\n\n        getPosition: function() {\n            return this._position;\n        },\n\n        // unused for directional\n        setDirection: function(a) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(this._direction, a);\n        },\n\n        getDirection: function() {\n            return this._direction;\n        },\n\n        setSpotCutoff: function(a) {\n            this._spotCutoff = a;\n        },\n\n        getSpotCutoff: function() {\n            return this._spotCutoff;\n        },\n\n        setSpotBlend: function(a) {\n            this._spotBlend = a;\n        },\n\n        getSpotBlend: function() {\n            return this._spotBlend;\n        },\n\n        // set/get the color of the ground\n        setGround: function(a) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(this._ground, a);\n        },\n\n        getGround: function() {\n            return this._ground;\n        },\n\n        // attenuation coeff\n        setConstantAttenuation: function(value) {\n            this._attenuation[0] = value;\n        },\n\n        getConstantAttenuation: function() {\n            return this._attenuation[0];\n        },\n\n        setLinearAttenuation: function(value) {\n            this._attenuation[1] = value;\n        },\n\n        getLinearAttenuation: function() {\n            return this._attenuation[1];\n        },\n\n        setQuadraticAttenuation: function(value) {\n            this._attenuation[2] = value;\n        },\n\n        getQuadraticAttenuation: function() {\n            return this._attenuation[2];\n        },\n\n        setLightType: function(type) {\n            if (type === Light.DIRECTION) return this.setLightAsDirection();\n            else if (type === Light.SPOT) return this.setLightAsSpot();\n            else if (type === Light.HEMI) return this.setLightAsHemi();\n            return this.setLightAsPoint();\n        },\n\n        getLightType: function() {\n            if (this.isDirectionLight()) return Light.DIRECTION;\n            else if (this.isSpotLight()) return Light.SPOT;\n            else if (this.isHemiLight()) return Light.HEMI;\n            return Light.POINT;\n        },\n\n        setLightAsSpot: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(this._position, 0.0, 0.0, 0.0, 1.0);\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].set(this._direction, 0.0, 0.0, -1.0);\n            this._ground[3] = -1.0;\n            this._spotCutoff = 90;\n            this._dirtyHash = true;\n        },\n\n        setLightAsPoint: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(this._position, 0.0, 0.0, 0.0, 1.0);\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].set(this._direction, 0.0, 0.0, -1.0);\n            this._ground[3] = -1.0;\n            this._dirtyHash = true;\n        },\n\n        setLightAsDirection: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(this._position, 0.0, 0.0, 1.0, 0.0);\n            this._spotCutoff = 180;\n            this._ground[3] = -1.0;\n            this._dirtyHash = true;\n        },\n\n        setLightAsHemi: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(this._position, 0.0, 0.0, 1.0, 0.0);\n            this._spotCutoff = 180;\n            this._ground[3] = 1.0;\n            this._dirtyHash = true;\n        },\n\n        setLightNumber: function(unit) {\n            this._lightNumber = unit;\n            this._dirtyHash = true;\n        },\n\n        getLightNumber: function() {\n            return this._lightNumber;\n        },\n\n        // internal helper\n        isSpotLight: function() {\n            return this._spotCutoff < 180.0;\n        },\n\n        isDirectionLight: function() {\n            return this._position[3] === 0.0 && this._ground[3] === -1.0;\n        },\n\n        isHemiLight: function() {\n            return this._ground[3] === 1.0;\n        },\n\n        // matrix is current model view, which can mean:\n        // world (node refAbsolute)\n        // world+camera (camera is refAbsolute)\n        // world+camera+camera+... (camera relative...)\n        applyPositionedUniform: function(matrix) {\n            var uniformMap = this.getOrCreateUniforms();\n\n            var modelView = uniformMap.modelViewMatrix.getInternalArray();\n            var modelViewNormal = uniformMap.modelViewNormalMatrix.getInternalArray();\n            var viewPosition = uniformMap.viewPosition.getInternalArray();\n            var viewDirection = uniformMap.viewDirection.getInternalArray();\n\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].copy(modelView, matrix);\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["b" /* mat3 */].normalFromMat4(modelViewNormal, matrix);\n\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].transformMat4(viewPosition, this._position, modelView);\n            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].transformMat3(viewDirection, this._direction, modelViewNormal);\n        },\n\n        apply: function() {\n            if (!this._enable) return;\n\n            var uniformMap = this.getOrCreateUniforms();\n\n            if (this.isSpotLight()) {\n                var spotsize = Math.cos(this._spotCutoff * Math.PI / 180.0);\n                uniformMap.spotCutOff.setFloat(spotsize);\n                uniformMap.spotBlend.setFloat((1.0 - spotsize) * this._spotBlend);\n            }\n\n            if (this.isHemiLight()) {\n                uniformMap.ground.setFloat4(this._ground);\n            }\n\n            uniformMap.attenuation.setFloat4(this._attenuation);\n            uniformMap.diffuse.setFloat4(this._diffuse);\n            uniformMap.specular.setFloat4(this._specular);\n            uniformMap.ambient.setFloat4(this._ambient);\n        }\n    }),\n    \'osg\',\n    \'Light\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Light);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Light.js\n// module id = 53\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Light.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_PooledResource__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__ = __webpack_require__(12);\n\n\n\n\n\n\n\nvar IntersectionVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this);\n    // We could need to use a stack of intersectors in case we want\n    // to use several intersectors. Right now we use only one.\n    this._intersector = undefined;\n\n    this._projectionStack = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__["a" /* default */]();\n    this._modelStack = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__["a" /* default */]();\n    this._viewStack = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__["a" /* default */]();\n    this._windowStack = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__["a" /* default */]();\n    this._pooledMatrix = new __WEBPACK_IMPORTED_MODULE_3_osg_PooledResource__["a" /* default */](__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create);\n\n    this.reset();\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    IntersectionVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        reset: function() {\n            this._pooledMatrix.reset();\n            this._viewStack.reset();\n            this._modelStack.reset();\n            this._projectionStack.reset();\n            this._windowStack.reset();\n\n            this._viewStack.push(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n            this._modelStack.push(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n            this._projectionStack.push(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n            this._windowStack.push(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n        },\n        setIntersector: function(intersector) {\n            this._intersector = intersector;\n        },\n        getIntersector: function() {\n            return this._intersector;\n        },\n        // Model matrix\n        pushModelMatrix: function(matrix) {\n            this._modelStack.push(matrix);\n        },\n        getModelMatrix: function() {\n            return this._modelStack.back();\n        },\n        popModelMatrix: function() {\n            return this._modelStack.pop();\n        },\n        // View Matrix\n        pushViewMatrix: function(matrix) {\n            this._viewStack.push(matrix);\n        },\n        getViewMatrix: function() {\n            return this._viewStack.back();\n        },\n        popViewMatrix: function() {\n            return this._viewStack.pop();\n        },\n        // Projection Matrix\n        pushProjectionMatrix: function(matrix) {\n            this._projectionStack.push(matrix);\n        },\n        getProjectionMatrix: function() {\n            return this._projectionStack.back();\n        },\n        popProjectionMatrix: function() {\n            return this._projectionStack.pop();\n        },\n        // Window Matrix\n        pushWindowMatrix: function(matrix) {\n            this._windowStack.push(matrix);\n        },\n        pushWindowMatrixUsingViewport: function(viewport) {\n            this._windowStack.push(\n                viewport.computeWindowMatrix(this._pooledMatrix.getOrCreateObject())\n            );\n        },\n        getWindowMatrix: function() {\n            return this._windowStack.back();\n        },\n        popWindowMatrix: function() {\n            return this._windowStack.pop();\n        },\n        getTransformation: (function() {\n            // We should move this to the intersector when we need to use different coordinate frames\n            // Now we only support WINDOW coordinate frame\n\n            // /!\\ 64 bit precision because the picking is jittery otherwise\n            // It\'s probably caused by one of the camera matrix that has too big/small values\n            // but currently it\'s the ony fix we have\n            var mat = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create64();\n\n            return function() {\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].copy(mat, this.getWindowMatrix());\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(mat, mat, this.getProjectionMatrix());\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(mat, mat, this.getViewMatrix());\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(mat, mat, this.getModelMatrix());\n\n                return mat;\n            };\n        })(),\n\n        enter: function(node) {\n            // Call to each intersector\n            return this._intersector.enter(node);\n        },\n\n        apply: function(node) {\n            // Here we need to decide which apply method to use\n            if (node.getViewMatrix) {\n                // It\'s a Camera\n                this.applyCamera(node);\n            } else {\n                if (node.getMatrix) {\n                    // It\'s a Transform Node\n                    this.applyTransform(node);\n                } else {\n                    // It\'s a leaf or an intermediate node\n                    this.applyNode(node);\n                }\n            }\n        },\n\n        applyCamera: function(camera) {\n            // We use an absolute reference frame for simplicity\n            var vp = camera.getViewport();\n            if (vp !== undefined) {\n                this.pushWindowMatrixUsingViewport(vp);\n            }\n\n            var projection, view, model;\n            if (\n                camera.getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].RELATIVE_RF &&\n                this.getViewMatrix() &&\n                this.getProjectionMatrix()\n            ) {\n                // relative\n                projection = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(\n                    this._pooledMatrix.getOrCreateObject(),\n                    this.getProjectionMatrix(),\n                    camera.getProjectionMatrix()\n                );\n                view = this.getViewMatrix();\n                model = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(\n                    this._pooledMatrix.getOrCreateObject(),\n                    this.getModelMatrix(),\n                    camera.getViewMatrix()\n                );\n            } else {\n                // absolute\n                projection = camera.getProjectionMatrix();\n                view = camera.getViewMatrix();\n                model = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].identity(this._pooledMatrix.getOrCreateObject());\n            }\n\n            this.pushProjectionMatrix(projection);\n            this.pushViewMatrix(view);\n            this.pushModelMatrix(model);\n\n            // TODO maybe we should do something like OSG for the transformation given\n            // to the intersector (having a stack)\n            this._intersector.setCurrentTransformation(this.getTransformation());\n            this.traverse(camera);\n\n            this.popModelMatrix();\n            this.popViewMatrix();\n            this.popProjectionMatrix();\n            if (vp !== undefined) {\n                this.popWindowMatrix();\n            }\n            this._intersector.setCurrentTransformation(this.getTransformation());\n        },\n\n        applyNode: function(node) {\n            if (!this.enter(node)) return;\n            // As this part of the code is potentially executed a lot of times we don\'t use instanceof\n            // https://jsperf.com/instanceof-performance/25\n            if (node.getPrimitiveSetList) {\n                this._intersector.intersect(this, node);\n                // If it is a leaf (it has primitives) we can safely return\n                return;\n            }\n            if (node.traverse) {\n                this.traverse(node);\n            }\n        },\n\n        applyTransform: function(node) {\n            // Now only use PROJECTION coordinate frame\n            if (!this.enter(node)) return;\n            // Accumulate Transform\n            if (node.getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].ABSOLUTE_RF) {\n                var matrix = this._pooledMatrix.getOrCreateObject();\n                this.pushViewMatrix(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].identity(matrix));\n                this.pushModelMatrix(node.getMatrix());\n            } else if (this._modelStack.getLength() > 0) {\n                var m = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].copy(this._pooledMatrix.getOrCreateObject(), this.getModelMatrix());\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(m, m, node.getMatrix());\n                this.pushModelMatrix(m);\n            } else {\n                this.pushModelMatrix(node.getMatrix());\n            }\n\n            // TODO see above\n            this._intersector.setCurrentTransformation(this.getTransformation());\n            this.traverse(node);\n\n            this.popModelMatrix();\n            if (node.getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].ABSOLUTE_RF) this.popViewMatrix();\n            this._intersector.setCurrentTransformation(this.getTransformation());\n        }\n    }),\n    \'osgUtil\',\n    \'IntersectionVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (IntersectionVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/IntersectionVisitor.js\n// module id = 54\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/IntersectionVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_Intersector__ = __webpack_require__(69);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgUtil_LineSegmentIntersectFunctor__ = __webpack_require__(138);\n\n\n\n\n\n\nvar LineSegmentIntersector = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgUtil_Intersector__["a" /* default */].call(this);\n\n    this._start = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._iStart = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n    this._end = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._iEnd = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n    // only used for lines and points\n    this._threshold = 0.0;\n    this._iThreshold = 0.0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    LineSegmentIntersector,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgUtil_Intersector__["a" /* default */].prototype, {\n        set: function(start, end, threshold) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._start, start);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._iStart, start);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._end, end);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._iEnd, end);\n\n            if (threshold !== undefined) {\n                this._threshold = this._iThreshold = threshold;\n            }\n        },\n\n        setStart: function(start) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._start, start);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._iStart, start);\n        },\n\n        setEnd: function(end) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._end, end);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._iEnd, end);\n        },\n\n        intersectNode: function(node) {\n            // TODO implement intersectBoundingBox?\n            return this.intersectBoundingSphere(node.getBoundingSphere());\n        },\n\n        // Intersection Segment/Sphere\n        intersectBoundingSphere: (function() {\n            var sm = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var se = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            return function(bsphere) {\n                // test for _start inside the bounding sphere\n                if (!bsphere.valid()) return false;\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(sm, this._iStart, bsphere.center());\n                var c = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(sm) - bsphere.radius2();\n                if (c <= 0.0) {\n                    return true;\n                }\n                // solve quadratic equation\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(se, this._iEnd, this._iStart);\n                var a = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(se);\n                var b = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(sm, se) * 2.0;\n                var d = b * b - 4.0 * a * c;\n                // no intersections if d<0\n                if (d < 0.0) {\n                    return false;\n                }\n                // compute two solutions of quadratic equation\n                d = Math.sqrt(d);\n                var div = 0.5 / a;\n                var r1 = (-b - d) * div;\n                var r2 = (-b + d) * div;\n\n                // return false if both intersections are before the ray start\n                if (r1 <= 0.0 && r2 <= 0.0) {\n                    return false;\n                }\n\n                if (r1 > 1.0 && r2 > 1.0) {\n                    return false;\n                }\n                return true;\n            };\n        })(),\n\n        intersect: (function() {\n            var functor = new __WEBPACK_IMPORTED_MODULE_3_osgUtil_LineSegmentIntersectFunctor__["a" /* default */]();\n\n            return function(iv, node) {\n                functor.setGeometry(node);\n                functor.setIntersectionVisitor(iv);\n                functor.setIntersector(this);\n\n                functor.set(this._iStart, this._iEnd, this._iThreshold);\n\n                var kdtree = node.getShape();\n                if (kdtree) {\n                    kdtree.intersectLineSegment(\n                        functor,\n                        kdtree.getNodes()[0],\n                        this._iStart,\n                        this._iEnd,\n                        this._iThreshold\n                    );\n                    return;\n                } else {\n                    // handle rig transformed vertices\n                    if (node.computeTransformedVertices) {\n                        functor.setVertices(node.computeTransformedVertices());\n                    }\n\n                    functor.apply(node);\n                }\n\n                functor.reset();\n            };\n        })(),\n\n        setCurrentTransformation: function(matrix) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(matrix, matrix);\n\n            if (this._threshold > 0.0) {\n                var tmp = this._iStart;\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].getScale(tmp, matrix);\n                var x = tmp[0];\n                var y = tmp[1];\n                var z = tmp[2];\n                this._iThreshold = this._threshold * (x > y ? (x > z ? x : z) : y > z ? y : z);\n            }\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].transformMat4(this._iStart, this._start, matrix);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].transformMat4(this._iEnd, this._end, matrix);\n        }\n    }),\n    \'osgUtil\',\n    \'LineSegmentIntersector\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (LineSegmentIntersector);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/LineSegmentIntersector.js\n// module id = 55\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/LineSegmentIntersector.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_Compiler__ = __webpack_require__(57);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShader_ShaderProcessor__ = __webpack_require__(64);\n\n\n\n\n\n\nvar ShaderGenerator = function() {\n    this._cache = {};\n\n    // ShaderProcessor singleton used by ShaderGenerator\n    // but user can replace it if needed\n    this._shaderProcessor = new __WEBPACK_IMPORTED_MODULE_5_osgShader_ShaderProcessor__["a" /* default */]();\n\n    // ShaderCompiler Object to instanciate\n    this._ShaderCompiler = undefined;\n\n    this.setShaderCompiler(__WEBPACK_IMPORTED_MODULE_4_osgShader_Compiler__["a" /* default */]);\n};\n\nShaderGenerator.prototype = {\n    // setShaderCompiler that will be used to createShader\n    setShaderCompiler: function(ShaderCompiler) {\n        this._ShaderCompiler = ShaderCompiler;\n        if (!ShaderCompiler._validAttributeTypeMemberCache)\n            this._computeStateAttributeCache(ShaderCompiler);\n    },\n\n    getShaderCompiler: function() {\n        return this._ShaderCompiler;\n    },\n\n    getShaderProcessor: function() {\n        return this._shaderProcessor;\n    },\n\n    setShaderProcessor: function(shaderProcessor) {\n        this._shaderProcessor = shaderProcessor;\n    },\n\n    // filter input types and write the result in the outputs array\n    filterAttributeTypes: function(attribute) {\n        // works for attribute that contains isEnabled\n        // Light, Shadow. It let us to filter them to build a shader if not enabled\n        if (attribute.isEnabled && !attribute.isEnabled()) return true;\n\n        return false;\n    },\n\n    // get actives attribute that comes from state listed by compiler cache type\n    getActiveAttributeList: function(state, list) {\n        var hash = \'\';\n        var _attributeArray = state._attributeArray;\n        var cacheType = this._ShaderCompiler._validAttributeTypeMemberCache;\n\n        for (var j = 0, k = cacheType.length; j < k; j++) {\n            var type = cacheType[j];\n            var attributeStack = type < _attributeArray.length ? _attributeArray[type] : undefined;\n            if (!attributeStack) continue;\n\n            var attribute = attributeStack._lastApplied;\n\n            if (!attribute || this.filterAttributeTypes(attribute)) continue;\n\n            hash += attribute.getHash();\n            list.push(attribute);\n        }\n\n        return hash;\n    },\n\n    // create a hash from actives attribute listed by compiler cache type\n    getActiveAttributeListCache: function(state) {\n        var hash = \'\';\n\n        var cacheType = this._ShaderCompiler._validAttributeTypeMemberCache;\n        for (var i = 0, l = cacheType.length; i < l; i++) {\n            var type = cacheType[i];\n            var attributeStack =\n                type < state._attributeArray.length ? state._attributeArray[type] : undefined;\n            if (attributeStack) {\n                var attribute = attributeStack._lastApplied;\n                if (!attribute || this.filterAttributeTypes(attribute)) continue;\n\n                hash += attributeStack._lastApplied.getHash();\n            }\n        }\n\n        return hash;\n    },\n\n    // create a hash from actives texture attribute listed by compiler cache type\n    getActiveTextureAttributeListCache: function(state) {\n        var hash = \'\';\n\n        var cacheType = this._ShaderCompiler._validTextureAttributeTypeMemberCache;\n        var textureUnitList = state._textureAttributeArrayList;\n        for (var j = 0; j < textureUnitList.length; j++) {\n            var textureUnit = textureUnitList[j];\n            if (!textureUnit) continue;\n\n            var textureUnitLength = textureUnit.length;\n            for (var i = 0; i < cacheType.length; i++) {\n                var type = cacheType[i];\n                var attributeStack = type < textureUnitLength ? textureUnit[type] : undefined;\n                if (attributeStack) {\n                    var attribute = attributeStack._lastApplied;\n\n                    if (\n                        !attribute ||\n                        this.filterAttributeTypes(attribute) ||\n                        attribute.isTextureNull()\n                    )\n                        continue;\n\n                    // we check to filter texture null in hash\n                    // but it\'s probably better to just set the hash correctly of a tetxure null, to remove this custom code\n                    hash += attribute.getHash();\n                }\n            }\n        }\n\n        return hash;\n    },\n\n    // get actives texture attribute that comes from state\n    getActiveTextureAttributeList: function(state, list) {\n        var hash = \'\';\n        var _attributeArrayList = state._textureAttributeArrayList;\n        var i, l;\n        var cacheType = this._ShaderCompiler._validTextureAttributeTypeMemberCache;\n\n        for (i = 0, l = _attributeArrayList.length; i < l; i++) {\n            var _attributeArrayForUnit = _attributeArrayList[i];\n\n            if (!_attributeArrayForUnit) continue;\n\n            list[i] = [];\n\n            for (var j = 0, m = cacheType.length; j < m; j++) {\n                var type = cacheType[j];\n\n                var attributeStack =\n                    type < _attributeArrayForUnit.length ? _attributeArrayForUnit[type] : undefined;\n                if (!attributeStack) continue;\n\n                var attribute = attributeStack._lastApplied;\n                if (!attribute || this.filterAttributeTypes(attribute) || attribute.isTextureNull())\n                    continue;\n\n                hash += attribute.getHash();\n                list[i].push(attribute);\n            }\n        }\n        return hash;\n    },\n\n    getActiveUniforms: function(state, attributeList, textureAttributeList) {\n        var uniforms = {};\n\n        for (var i = 0, l = attributeList.length; i < l; i++) {\n            var at = attributeList[i];\n            if (at.getOrCreateUniforms) {\n                var attributeUniformMap = at.getOrCreateUniforms();\n                // It could happen that uniforms are declared conditionally\n                if (attributeUniformMap !== undefined) {\n                    for (var keyAttribute in attributeUniformMap) {\n                        var uniform = attributeUniformMap[keyAttribute];\n                        uniforms[uniform.getName()] = uniform;\n                    }\n                }\n            }\n        }\n\n        for (var a = 0, n = textureAttributeList.length; a < n; a++) {\n            var tat = textureAttributeList[a];\n            if (tat) {\n                for (var b = 0, o = tat.length; b < o; b++) {\n                    var attr = tat[b];\n\n                    var texUniformMap = attr.getOrCreateUniforms(a);\n\n                    for (var tname in texUniformMap) {\n                        var tuniform = texUniformMap[tname];\n                        uniforms[tuniform.getName()] = tuniform;\n                    }\n                }\n            }\n        }\n\n        return uniforms;\n    },\n\n    _computeStateAttributeCache: function(CompilerShader) {\n        var typeMemberNames = CompilerShader.stateAttributeConfig.attribute || [];\n        var validTypeMemberList = [];\n        var typeMemberName;\n        var i, il, cache;\n        var id;\n        for (i = 0, il = typeMemberNames.length; i < il; i++) {\n            typeMemberName = typeMemberNames[i];\n            id = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].getIdFromTypeMember(typeMemberName);\n            if (id !== undefined) {\n                if (validTypeMemberList.indexOf(id) !== -1) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\n                        \'Compiler \' +\n                            CompilerShader.name +\n                            \' contains duplicate attribute entry \' +\n                            typeMemberName +\n                            \', check the Compiler configuration\'\n                    );\n                } else {\n                    validTypeMemberList.push(id);\n                }\n            }\n        }\n        cache = new Uint8Array(validTypeMemberList);\n        CompilerShader._validAttributeTypeMemberCache = cache;\n\n        typeMemberNames = CompilerShader.stateAttributeConfig.textureAttribute || [];\n        validTypeMemberList = [];\n        for (i = 0, il = typeMemberNames.length; i < il; i++) {\n            typeMemberName = typeMemberNames[i];\n            id = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].getTextureIdFromTypeMember(typeMemberName);\n            if (validTypeMemberList.indexOf(id) !== -1) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\n                    \'Compiler \' +\n                        CompilerShader.name +\n                        \' contains duplicate texture attribute entry \' +\n                        typeMemberName +\n                        \', check the Compiler configuration\'\n                );\n            } else {\n                validTypeMemberList.push(id);\n            }\n        }\n        cache = new Uint8Array(validTypeMemberList);\n        CompilerShader._validTextureAttributeTypeMemberCache = cache;\n    },\n\n    getOrCreateProgram: (function() {\n        var textureAttributes = [];\n        var attributes = [];\n\n        return function(state) {\n            // extract valid attributes\n\n            // use ShaderCompiler, it can be overrided by a custom one\n            var ShaderCompiler = this._ShaderCompiler;\n\n            var hash =\n                this.getActiveAttributeListCache(state) +\n                this.getActiveTextureAttributeListCache(state);\n\n            var cache = this._cache[hash];\n            if (cache !== undefined) return cache;\n\n            // slow path to generate shader\n            attributes.length = 0;\n            textureAttributes.length = 0;\n\n            this.getActiveAttributeList(state, attributes);\n            this.getActiveTextureAttributeList(state, textureAttributes);\n\n            var shaderGen = new ShaderCompiler(\n                attributes,\n                textureAttributes,\n                this._shaderProcessor\n            );\n\n            /* develblock:start */\n            // Logs hash, attributes and compiler\n            __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].debug(\'New Compilation \', false, true);\n            __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].debug(\n                {\n                    Attributes: attributes,\n                    Texture: textureAttributes,\n                    Hash: hash,\n                    Compiler: shaderGen.getFragmentShaderName()\n                },\n                false,\n                true\n            );\n            /* develblock:end */\n\n            var fragmentshader = shaderGen.createFragmentShader();\n            var vertexshader = shaderGen.createVertexShader();\n\n            var program = new __WEBPACK_IMPORTED_MODULE_2_osg_Program__["a" /* default */](\n                new __WEBPACK_IMPORTED_MODULE_3_osg_Shader__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_Shader__["a" /* default */].VERTEX_SHADER, vertexshader),\n                new __WEBPACK_IMPORTED_MODULE_3_osg_Shader__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_Shader__["a" /* default */].FRAGMENT_SHADER, fragmentshader)\n            );\n\n            program.hash = hash;\n            program.setActiveUniforms(this.getActiveUniforms(state, attributes, textureAttributes));\n            program.generated = true;\n\n            this._cache[hash] = program;\n            return program;\n        };\n    })(),\n\n    resetCache: function(){\n        this._cache = {};\n    }\n\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (ShaderGenerator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/ShaderGenerator.js\n// module id = 56\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/ShaderGenerator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_nodeFactory__ = __webpack_require__(153);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_CompilerVertex__ = __webpack_require__(232);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShader_CompilerFragment__ = __webpack_require__(233);\n\n\n\n\n\n\n\nvar Compiler = function(attributes, textureAttributes, shaderProcessor) {\n    this._attributes = attributes;\n    this._textureAttributes = textureAttributes;\n\n    this._fragmentShaderMode = false; // current context\n\n    this._activeNodeMap = {};\n    this._compiledNodeMap = {};\n    this._traversedNodeMap = {};\n\n    this._variables = {};\n    this._varyings = {};\n    this._vertexShader = [];\n    this._fragmentShader = [];\n\n    this._shaderProcessor = shaderProcessor;\n    this._texturesByName = {};\n\n    // TODO: Have to handle better textures\n    // 4 separate loop over texture list: one here, one for declareTexture, 2 for vertexShader (varying decl + varying store)\n    // (not counting loops done above in shader generator)\n\n    this._shadowsTextures = [];\n    this._lights = [];\n    this._shadows = [];\n    this._textures = [];\n    this._material = null;\n\n    this._invariantPosition = false;\n    this._isBillboard = false;\n\n    // Important: if not using Compiler for Both VS and FS Check either of those\n    // it allow override by custom Processor of some check between the VS & FS pass (varying mostly)\n    this._customVertexShader = false;\n    this._customFragmentShader = false;\n\n    // from Attributes to variables to build shader nodes graph from\n    this.initAttributes();\n    this.initTextureAttributes();\n};\n\nCompiler.cloneStateAttributeConfig = function(compilerClass) {\n    return JSON.parse(JSON.stringify(compilerClass.stateAttributeConfig));\n};\n\nCompiler.setStateAttributeConfig = function(compilerClass, config) {\n    compilerClass.stateAttributeConfig = config;\n\n    config.attribute.forEach(__WEBPACK_IMPORTED_MODULE_3_osg_utils__[\"a\" /* default */].getOrCreateStateAttributeTypeMemberIndexFromName);\n    config.textureAttribute.forEach(__WEBPACK_IMPORTED_MODULE_3_osg_utils__[\"a\" /* default */].getOrCreateTextureStateAttributeTypeMemberIndexFromName);\n\n    compilerClass.validAttributeTypeMember = config.attribute;\n    compilerClass.validTextureAttributeTypeMember = config.textureAttribute;\n};\n\nCompiler.setStateAttributeConfig(Compiler, {\n    attribute: [\n        'Light0',\n        'ShadowReceive0',\n        'Light1',\n        'ShadowReceive1',\n        'Light2',\n        'ShadowReceive2',\n        'Light3',\n        'ShadowReceive3',\n        'Light4',\n        'Light5',\n        'Light6',\n        'Light7',\n        'Material',\n        'PointSize',\n        'Billboard',\n        'Morph',\n        'Skinning'\n    ],\n    textureAttribute: ['Texture']\n});\n\nCompiler.prototype = __WEBPACK_IMPORTED_MODULE_3_osg_utils__[\"a\" /* default */].extend({}, __WEBPACK_IMPORTED_MODULE_4_osgShader_CompilerVertex__[\"a\" /* default */], __WEBPACK_IMPORTED_MODULE_5_osgShader_CompilerFragment__[\"a\" /* default */], {\n    constructor: Compiler,\n\n    createFragmentShader: function() {\n        this._fragmentShaderMode = true;\n        return this._createFragmentShader();\n    },\n\n    createVertexShader: function() {\n        this._fragmentShaderMode = false;\n        return this._createVertexShader();\n    },\n\n    getOrCreateProjectionMatrix: function() {\n        return this.getOrCreateUniform('mat4', 'uProjectionMatrix');\n    },\n\n    getCompilerName: function() {\n        return this._material ? 'CompilerOSGJS' : 'NoMaterialCompilerOSGJS';\n    },\n\n    getFragmentShaderName: function() {\n        var compilerName = this.getCompilerName();\n\n        var materialName = this._material && this._material.getName();\n        if (materialName) {\n            // escape everything but letter and number\n            materialName = materialName.replace(/[^a-zA-Z0-9]+/g, '_').slice(0, 20);\n            compilerName += '(' + materialName + ')';\n        }\n\n        return compilerName;\n    },\n\n    getVertexShaderName: function() {\n        return this.getFragmentShaderName();\n    },\n\n    getDebugIdentifier: function() {\n        var vname = this.getVertexShaderName();\n        var fname = this.getFragmentShaderName();\n        return vname === fname ? fname : vname + '|' + fname;\n    },\n\n    logError: function(msg) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(this.getDebugIdentifier() + ' : ' + msg);\n    },\n\n    logWarn: function(msg) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn(this.getDebugIdentifier() + ' : ' + msg);\n    },\n\n    getOrCreateConstantOne: function(type) {\n        return this.getOrCreateConstant(type, type + 'White').setValue(type + '(1.0)');\n    },\n\n    getOrCreateConstantZero: function(type) {\n        return this.getOrCreateConstant(type, type + 'Black').setValue(type + '(0.0)');\n    },\n\n    initAttributes: function() {\n        var attributes = this._attributes;\n        var lights = this._lights;\n        var shadows = this._shadows;\n        for (var i = 0, l = attributes.length; i < l; i++) {\n            var type = attributes[i].className();\n\n            // Test one light at a time\n            if (type === 'Light') {\n                // && lights.length === 0) {\n                lights.push(attributes[i]);\n            } else if (type === 'Material') {\n                this._material = attributes[i];\n            } else if (type === 'ShadowReceiveAttribute') {\n                shadows.push(attributes[i]);\n            } else if (type === 'Billboard') {\n                this._isBillboard = !!attributes[i];\n            } else if (type === 'SkinningAttribute') {\n                this._skinningAttribute = attributes[i];\n            } else if (type === 'MorphAttribute') {\n                this._morphAttribute = attributes[i];\n            } else if (type === 'PointSizeAttribute') {\n                this._pointSizeAttribute = attributes[i];\n            }\n        }\n    },\n\n    initTextureAttributes: function() {\n        var textureAttributes = this._textureAttributes;\n        var texturesNum = textureAttributes.length;\n        this._textures.length = this._shadowsTextures.length = texturesNum;\n\n        for (var j = 0; j < texturesNum; j++) {\n            var tu = textureAttributes[j];\n            if (tu === undefined) {\n                continue;\n            }\n\n            for (var t = 0, tl = tu.length; t < tl; t++) {\n                this.registerTextureAttributes(tu[t], j);\n            }\n        }\n    },\n\n    registerTextureAttributes: function(tuTarget, tunit) {\n        var tType = tuTarget.className();\n        if (tType === 'Texture') return this.registerTexture(tuTarget, tunit);\n        if (tType.indexOf('ShadowTexture') !== -1)\n            return this.registerTextureShadow(tuTarget, tunit);\n    },\n\n    registerTexture: function(tuTarget, texUnit) {\n        var tName = tuTarget.getName();\n        if (!tName) {\n            tName = 'Texture' + texUnit;\n            tuTarget.setName(tName);\n        }\n        this._textures[texUnit] = tuTarget;\n\n        this._texturesByName[tName] = {\n            texture: tuTarget,\n            variable: undefined,\n            textureUnit: texUnit\n        };\n    },\n\n    registerTextureShadow: function(tuTarget, texUnit) {\n        var tName = tuTarget.getName();\n        if (!tName) {\n            tName = 'Texture' + texUnit;\n            tuTarget.setName(tName);\n        }\n        this._shadowsTextures[texUnit] = tuTarget;\n\n        this._texturesByName[tName] = {\n            texture: tuTarget,\n            variable: undefined,\n            textureUnit: texUnit,\n            shadow: true\n        };\n    },\n\n    getTextureByName: function(name) {\n        var texObj = this._texturesByName[name];\n        if (!texObj || texObj.variable) return texObj;\n\n        var texture = texObj.texture;\n        var texCoordUnit = texObj.textureUnit;\n\n        var textureSampler;\n\n        var className = texture.className();\n        var samplerName = 'Texture' + texCoordUnit;\n        if (className === 'Texture') {\n            textureSampler = this.getOrCreateSampler('sampler2D', samplerName);\n        } else if (className === 'TextureCubeMap') {\n            textureSampler = this.getOrCreateSampler('samplerCube', samplerName);\n        } else {\n            return;\n        }\n\n        var texCoord = this._fragmentShaderMode\n            ? this.getOrCreateVarying('vec2', 'vTexCoord' + texCoordUnit)\n            : this.getOrCreateAttribute('vec2', 'TexCoord' + texCoordUnit);\n\n        texObj.variable = this.createTextureRGBA(texture, textureSampler, texCoord);\n\n        return texObj;\n    },\n\n    // The Compiler Main Code called on Vertex or Fragment Shader Graph\n    createShaderFromGraphs: function(roots) {\n        this._compiledNodeMap = {};\n\n        // list all vars\n        var variables = [];\n        for (var keyVariable in this._variables) {\n            var varNode = this._variables[keyVariable];\n            var d = varNode.declare();\n            if (d) {\n                variables.push(d);\n            }\n        }\n\n        // defines and extensions are added by process shader\n        var extensions = this.evaluateExtensions(roots);\n        var defines = this.evaluateDefines(roots);\n\n        var shaderStack = [];\n        shaderStack.push('\\n');\n        shaderStack.push(this.evaluateGlobalVariableDeclaration(roots));\n        if (this._invariantPosition && !this._fragmentShaderMode)\n            shaderStack.push('\\ninvariant gl_Position;');\n        shaderStack.push('\\n');\n        shaderStack.push(this.evaluateGlobalFunctionDeclaration(roots));\n\n        shaderStack.push('void main() {');\n\n        // declare variables in main\n        if (variables.length !== 0) {\n            shaderStack.push('// vars\\n');\n            shaderStack.push(variables.join(' '));\n            shaderStack.push('\\n// end vars\\n');\n        }\n\n        // make sure we have at least one output\n        if (roots.length === 0) {\n            this.logError('shader without any final Node output (need at least one)');\n        }\n\n        shaderStack.push(this.evaluate(roots));\n\n        shaderStack.push('}');\n\n        // Shader Graph has been outputed an array of string\n        // we concatenate it to a shader string program\n        var shaderStr = shaderStack.join('\\n');\n\n        // Process defines, add precision, resolve include pragma\n        var shader = this._shaderProcessor.processShader(\n            shaderStr,\n            defines,\n            extensions,\n            this._fragmentShaderMode ? 'fragment' : 'vertex'\n        );\n\n        /*develblock:start*/\n        // Check\n        var compiledNodes = this._compiledNodeMap;\n        var activeNodes = this._activeNodeMap;\n        var messages = [];\n        for (var key in activeNodes) {\n            if (compiledNodes[key]) continue;\n\n            var node = activeNodes[key];\n            if (node.silenceWarning) continue;\n\n            var msg = '[' + node.toString() + ']:';\n            var nodeInputs = node.getInputs();\n            for (var i = 0; i < nodeInputs.length; ++i) {\n                var nodeInput = nodeInputs[i];\n                msg += '\\n - Computed by ' + nodeInput.getType();\n\n                var argOutputs = nodeInput.getOutputs();\n                for (var keyOutput in argOutputs) {\n                    if (argOutputs[keyOutput] === node) {\n                        msg += ' - as ' + keyOutput;\n                    }\n                }\n            }\n\n            messages.push(msg);\n        }\n\n        if (messages.length) {\n            this.logWarn('Nodes requested, but not compiled:\\n' + messages.join('\\n\\n'));\n        }\n        /*develblock:end*/\n\n        return shader;\n    },\n\n    _logLookForVariable: function(args, variable) {\n        var res = [];\n        for (var key in args) {\n            if (args[key] === variable) {\n                res.push(key);\n            }\n        }\n        return res;\n    },\n\n    getNode: function(/*name, arg1, etc*/) {\n        var n = __WEBPACK_IMPORTED_MODULE_2_osgShader_nodeFactory__[\"a\" /* default */].getNode.apply(__WEBPACK_IMPORTED_MODULE_2_osgShader_nodeFactory__[\"a\" /* default */], arguments);\n        if (!n) __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('Unknown Node type : ' + arguments[0]);\n        var cacheID = n.getID();\n        this._activeNodeMap[cacheID] = n;\n        return n;\n    },\n\n    getVariable: function(nameID) {\n        return this._variables[nameID];\n    },\n\n    getAttributeType: function(type) {\n        for (var i = 0; i < this._attributes.length; i++) {\n            if (this._attributes[i].getType() === type) return this._attributes[i];\n        }\n        return undefined;\n    },\n\n    // TODO: add Precision qualifier\n    // if doesn't exist create a new on\n    // if nameID given and var already exist, create a varname +\n    createVariable: function(type, varname, deepness) {\n        var nameID = varname;\n\n        if (nameID === undefined) {\n            var len = window.Object.keys(this._variables).length;\n            nameID = 'tmp_' + len;\n        } else if (this._variables[nameID]) {\n            // create a new variable\n            // if we want to reuse a variable we should NOT\n            // call this function in the first place and do the\n            // test before...\n            // however for uniform, varying and sampler, we return\n            // the variable if it already exists, because they are\n            // meant to be read only\n            nameID = nameID + deepness;\n            if (deepness === undefined) {\n                return this.createVariable(type, varname, 1);\n            } else if (this._variables[nameID]) {\n                deepness++;\n                return this.createVariable(type, varname, deepness);\n            }\n        }\n\n        var v = this.getNode('Variable', type, nameID);\n        this._variables[nameID] = v;\n        return v;\n    },\n\n    getOrCreateUniform: function(type, varname, size) {\n        var nameID = varname;\n\n        // accept uniform as parameter to simplify code\n        if (type instanceof __WEBPACK_IMPORTED_MODULE_1_osg_Uniform__[\"a\" /* default */]) {\n            var uniform = type;\n            type = uniform.getType();\n            nameID = uniform.getName();\n        } else if (nameID === undefined) {\n            this.logError('Cannot create unamed Uniform');\n        }\n\n        var exist = this._variables[nameID];\n        if (exist) {\n            if (exist.getType() === type) {\n                return exist;\n            }\n\n            /*develblock:start*/\n            // texture has a particular \"dual\" type of uniform a sampler2D\n            // a int pointing to the texture unit the sampler2D represents\n            if (exist.getType() === 'sampler2D' && type !== 'sampler2D') {\n                this.logError(\n                    'Same uniform, but different type (' +\n                        type +\n                        ', ' +\n                        exist.getType() +\n                        ', ' +\n                        exist.getVariable() +\n                        ')'\n                );\n            }\n            /*develblock:end*/\n        }\n\n        var v = this.getNode('Uniform', type, nameID, size);\n        this._variables[nameID] = v;\n\n        return v;\n    },\n\n    // make sure we get correct Node\n    getOrCreateSampler: function(type, varname) {\n        if (varname === undefined) {\n            this.logError('No name given for sampler type : ' + type);\n        }\n\n        var exist = this._variables[varname];\n        if (exist) {\n            return exist; // see comment in Variable function\n        }\n\n        var v = this.getNode('Sampler', type, varname);\n        this._variables[varname] = v;\n\n        return v;\n    },\n\n    // make sure we get correct Node\n    getOrCreateAttribute: function(type, nameID) {\n        if (this._fragmentShaderMode) {\n            this.logError('No Vertex Attribute in Fragment Shader');\n        }\n\n        var exist = this._variables[nameID];\n        if (exist) {\n            /*develblock:start*/\n            if (exist.getType() !== type) {\n                this.logError('Same attribute, but different type');\n            }\n            /*develblock:end*/\n\n            return exist;\n        }\n\n        var v = this.getNode('Attribute', type, nameID);\n        this._variables[nameID] = v;\n        return v;\n    },\n\n    getOrCreateConstant: function(type, varname) {\n        var nameID = varname;\n        if (nameID === undefined) {\n            // TODO: temp constant ? or enforcing reuse ?\n            // maybe could parse variable to find other constant\n            // but would need having scope info\n            var len = window.Object.keys(this._variables).length;\n            nameID = 'tmp_' + len;\n        } else {\n            var exist = this._variables[nameID];\n            if (exist) {\n                /*develblock:start*/\n                if (exist.getType() !== type) {\n                    this.logError('Same constant name, but different type');\n                }\n                /*develblock:end*/\n\n                // see comment in Variable function\n                return exist;\n            }\n        }\n\n        var v = this.getNode('Constant', type, nameID);\n        this._variables[nameID] = v;\n        return v;\n    },\n\n    // make sure we get correct Node\n    getOrCreateVarying: function(type, nameID) {\n        if (nameID === undefined) {\n            this.logError('Error: Mandatory to name varying (as you need to retrieve them)');\n        }\n\n        var variable = this._variables[nameID];\n        if (variable) {\n            if (!this._varyings[nameID]) {\n                this.logError(\n                    'Error: requesting a varying not declared with getOrCreateVarying previously'\n                );\n            }\n\n            if (variable.getType() !== type) {\n                this.logError('Error: Same varying, but different type');\n            }\n\n            return variable;\n        }\n\n        // if it's not in Varying Cache, but requested from vertex shader it means => error\n        if (!this._fragmentShaderMode && !this._customFragmentShader) {\n            this.logError(\n                'Error: requesting a varying not declared in Fragment Shader Graph (for Custom Vertex Shader, add this._customFragmentShader to the processor): ' +\n                    nameID +\n                    ' ' +\n                    type\n            );\n        }\n\n        variable = this._variables[nameID] = this._varyings[nameID] = this.getNode(\n            'Varying',\n            type,\n            nameID\n        );\n\n        return variable;\n    },\n\n    //////////////////\n    // TRAVERSE STUFFS\n    //////////////////\n\n    markNodeAsVisited: function(n) {\n        var cacheID = n.getID();\n        if (this._activeNodeMap[cacheID] === n) {\n            this._compiledNodeMap[cacheID] = n;\n        } else {\n            this.logWarn(\n                'Node not requested by using Compiler getNode and/or not registered in nodeFactory ' +\n                    n.toString()\n            );\n        }\n    },\n\n    // make sure we traverse once per evaluation of graph\n    checkOrMarkNodeAsTraversed: function(n) {\n        var cacheID = n.getID();\n        if (this._traversedNodeMap[cacheID]) {\n            return true;\n        }\n        this._traversedNodeMap[cacheID] = n;\n        return false;\n    },\n\n    // TODO: add a visitor to debug the graph\n    traverse: function(functor, node) {\n        if (this.checkOrMarkNodeAsTraversed(node)) return;\n\n        var inputs = node.getInputs();\n        if (!Array.isArray(inputs)) {\n            var objectToArray = [];\n            for (var keyInput in inputs) {\n                objectToArray.push(inputs[keyInput]);\n            }\n            inputs = objectToArray;\n        }\n\n        for (var i = 0, l = inputs.length; i < l; i++) {\n            node.checkInputsOutputs();\n\n            var child = inputs[i];\n            if (child && child !== node) {\n                this.traverse(functor, child);\n            }\n        }\n        functor.call(functor, node);\n\n        // keep trace we visited\n        this.markNodeAsVisited(node);\n    },\n\n    _getAndInitFunctor: function(func) {\n        this._traversedNodeMap = {};\n\n        var map = {};\n        var text = [];\n        func = func.bind(this, map, text);\n        func._map = map;\n        func._text = text;\n\n        return func;\n    },\n\n    _functorEvaluateAndGatherField: function(field, map, text, node) {\n        var idx = node.getType();\n        if (idx === undefined || idx === '') {\n            this.logError('Your node ' + node + ' has no type');\n        }\n\n        if (!node[field] || map[idx]) return;\n        map[idx] = true;\n\n        Array.prototype.push.apply(text, node[field]());\n    },\n\n    // Gather a particular output field\n    // for now one of\n    // ['define', 'extensions']\n    //\n    // from a nodeGraph\n    //\n    // In case a node of same Type have different outputs (shadow with different defines)\n    // it use ID rather than Type as map index UNIQUE PER TYPE\n    // TODO: adds includes so that we can remove it from the eval Global Functions ?\n    evaluateAndGatherField: function(nodes, field) {\n        var func = this._getAndInitFunctor(this._functorEvaluateAndGatherField.bind(this, field));\n\n        for (var j = 0, jl = nodes.length; j < jl; j++) {\n            this.traverse(func, nodes[j]);\n        }\n\n        return func._text;\n    },\n\n    _functorEvaluateGlobalFunctionDeclaration: function(map, text, node) {\n        // UNIQUE PER TYPE\n        var idx = node.getType();\n        if (idx === undefined || idx === '') {\n            this.logError('Your node ' + node + ' has no type');\n        }\n\n        if (!node.globalFunctionDeclaration || map[idx]) return;\n        map[idx] = true;\n\n        var decl = node.globalFunctionDeclaration();\n        if (decl) text.push(decl);\n    },\n\n    // Gather a functions declartions of nodesfrom a nodeGraph\n    // (for now pragma include done here too. could be done with define/etc...)\n    // Node of same Type has to share exact same \"node.globalFunctionDeclaration\" output\n    // as it use Type rather than ID as map index\n    evaluateGlobalFunctionDeclaration: function(nodes) {\n        var func = this._getAndInitFunctor(this._functorEvaluateGlobalFunctionDeclaration);\n\n        for (var j = 0, jl = nodes.length; j < jl; j++) {\n            this.traverse(func, nodes[j]);\n        }\n\n        return func._text.join('\\n');\n    },\n\n    _functorEvaluateGlobalVariableDeclaration: function(map, text, node) {\n        // UNIQUE PER NODE\n        var idx = node.getID();\n        if (!node.globalDeclaration || map[idx]) return;\n        map[idx] = true;\n\n        var decl = node.globalDeclaration();\n        if (decl) text.push(decl);\n    },\n\n    // Gather a Variables declarations of nodes from a nodeGraph to be outputted\n    // outside the VOID MAIN code ( Uniforms, Varying )\n    // Node of same Type has different output as it use Type rather than ID as map index\n    evaluateGlobalVariableDeclaration: function(nodes) {\n        var func = this._getAndInitFunctor(this._functorEvaluateGlobalVariableDeclaration);\n\n        var i = 0;\n        var nbNodes = nodes.length;\n        for (i = 0; i < nbNodes; i++) {\n            this.traverse(func, nodes[i]);\n        }\n\n        // beautify/formatting with empty line between type of var\n        var declarations = func._text;\n        var len = declarations.length;\n        if (len > 0) {\n            this.sortDeclarations(declarations);\n\n            var type = declarations[0][0];\n            for (i = 0; i < len; ++i) {\n                var iType = declarations[i][0];\n                if (iType !== type) {\n                    type = iType;\n                    declarations[i - 1] += '\\n';\n                }\n            }\n        }\n\n        return declarations.join('\\n');\n    },\n\n    sortDeclarations: function(declarations) {\n        // sort in alphabetical order attr, unif, sample, varying\n        declarations.sort();\n\n        if (this._fragmentShaderMode) return;\n\n        // making sure Vertex is always coming first (because of webgl warning)\n        for (var i = 0, len = declarations.length; i < len; ++i) {\n            var vatt = declarations[i];\n\n            if (vatt[0] !== 'a') break;\n\n            if (vatt.indexOf('Vertex') !== -1) {\n                declarations.splice(i, 1);\n                declarations.unshift(vatt);\n                break;\n            }\n        }\n    },\n\n    _functorEvaluate: function(map, text, node) {\n        var id = node.getID();\n        if (map[id]) return;\n        map[id] = true;\n\n        var shader = node.computeShader();\n        if (!shader) return;\n\n        var comment = node.getComment && node.getComment();\n        if (comment) text.push(comment);\n        text.push(shader);\n    },\n\n    evaluate: function(nodes) {\n        var func = this._getAndInitFunctor(this._functorEvaluate);\n\n        for (var j = 0, jl = nodes.length; j < jl; j++) {\n            this.traverse(func, nodes[j]);\n        }\n\n        return func._text.join('\\n');\n    },\n\n    evaluateDefines: function(roots) {\n        return this.evaluateAndGatherField(roots, 'getDefines');\n    },\n\n    evaluateExtensions: function(roots) {\n        return this.evaluateAndGatherField(roots, 'getExtensions');\n    },\n\n    /////////////////////\n    // Model space varying\n    /////////////////////\n    getOrCreateModelVertex: function() {\n        if (this._fragmentShaderMode) {\n            return this.getOrCreateVarying('vec3', 'vModelVertex');\n        }\n\n        var out = this._variables.modelVertex;\n        if (out) return out;\n        out = this.createVariable('vec3', 'modelVertex');\n\n        this.getNode('MatrixMultPosition')\n            .inputs({\n                matrix: this.getOrCreateUniform('mat4', 'uModelMatrix'),\n                vec: this.getOrCreateLocalVertex()\n            })\n            .outputs({ vec: out });\n\n        return out;\n    },\n\n    getOrCreateModelNormal: function() {\n        if (this._fragmentShaderMode) {\n            return this.getOrCreateVarying('vec3', 'vModelNormal');\n        }\n\n        var out = this._variables.modelNormal;\n        if (out) return out;\n        out = this.createVariable('vec3', 'modelNormal');\n\n        this.getNode('MatrixMultDirection')\n            .inputs({\n                matrix: this.getOrCreateUniform('mat3', 'uModelNormalMatrix'),\n                vec: this.getOrCreateLocalNormal()\n            })\n            .outputs({ vec: out });\n\n        return out;\n    },\n\n    getOrCreateModelTangent: function() {\n        if (this._fragmentShaderMode) {\n            return this.getOrCreateVarying('vec4', 'vModelTangent');\n        }\n\n        var out = this._variables.modelTangent;\n        if (out) return out;\n        out = this.createVariable('vec4', 'modelTangent');\n\n        this.getNode('MatrixMultDirection')\n            .setOverwriteW(false)\n            .inputs({\n                matrix: this.getOrCreateUniform('mat3', 'uModelNormalMatrix'),\n                vec: this.getOrCreateLocalTangent()\n            })\n            .outputs({ vec: out });\n\n        return out;\n    },\n\n    /////////////////////\n    // View space varying\n    /////////////////////\n    getOrCreateViewVertex: function() {\n        if (this._fragmentShaderMode) {\n            return this.getOrCreateVarying('vec4', 'vViewVertex');\n        }\n\n        var out = this._variables.viewVertex;\n        if (out) return out;\n        out = this.createVariable('vec4', 'viewVertex');\n\n        this.getNode('MatrixMultPosition')\n            .inputs({\n                matrix: this.getOrCreateUniform('mat4', 'uModelViewMatrix'),\n                vec: this.getOrCreateLocalVertex()\n            })\n            .outputs({ vec: out });\n\n        return out;\n    },\n\n    getOrCreateViewNormal: function() {\n        if (this._fragmentShaderMode) {\n            return this.getOrCreateVarying('vec3', 'vViewNormal');\n        }\n\n        var out = this._variables.viewNormal;\n        if (out) return out;\n        out = this.createVariable('vec3', 'viewNormal');\n\n        this.getNode('MatrixMultDirection')\n            .inputs({\n                matrix: this.getOrCreateUniform('mat3', 'uModelViewNormalMatrix'),\n                vec: this.getOrCreateLocalNormal()\n            })\n            .outputs({ vec: out });\n\n        return out;\n    },\n\n    getOrCreateViewTangent: function() {\n        if (this._fragmentShaderMode) {\n            return this.getOrCreateVarying('vec4', 'vViewTangent');\n        }\n\n        var out = this._variables.viewTangent;\n        if (out) return out;\n        out = this.createVariable('vec4', 'viewTangent');\n\n        this.getNode('MatrixMultDirection')\n            .setOverwriteW(false)\n            .inputs({\n                matrix: this.getOrCreateUniform('mat3', 'uModelViewNormalMatrix'),\n                vec: this.getOrCreateLocalTangent()\n            })\n            .outputs({ vec: out });\n\n        return out;\n    }\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Compiler);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/Compiler.js\n// module id = 57\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/Compiler.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_PooledResource__ = __webpack_require__(25);\n\n\n\n\n\n\n\n\n\nvar ComputeBoundsVisitor = function(traversalMode) {\n    __WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__["a" /* default */].call(this, traversalMode);\n\n    // keep a matrix in memory to avoid to create matrix\n    this._pooledMatrix = new __WEBPACK_IMPORTED_MODULE_7_osg_PooledResource__["a" /* default */](__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create);\n\n    // Matrix stack along path traversal\n    this._matrixStack = new __WEBPACK_IMPORTED_MODULE_6_osg_PooledArray__["a" /* default */]();\n    this._matrixStack.push(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n\n    this._bb = new __WEBPACK_IMPORTED_MODULE_0_osg_BoundingBox__["a" /* default */]();\n};\n\n__WEBPACK_IMPORTED_MODULE_5_osg_utils__["a" /* default */].createPrototypeObject(\n    ComputeBoundsVisitor,\n    __WEBPACK_IMPORTED_MODULE_5_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__["a" /* default */].prototype, {\n        reset: function() {\n            this._pooledMatrix.reset();\n            this._matrixStack.reset();\n            this._matrixStack.push(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n            this._bb.init();\n        },\n\n        getBoundingBox: function() {\n            return this._bb;\n        },\n\n        // not implemented\n        //void getPolytope(osg::Polytope& polytope, float margin=0.1) const;\n        //void getBase(osg::Polytope& polytope, float margin=0.1) const;\n\n        //applyDrawable: function ( drawable ) {},\n\n        applyTransform: function(transform) {\n            var matrix = this._pooledMatrix.getOrCreateObject();\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].copy(matrix, this._matrixStack.back());\n            transform.computeLocalToWorldMatrix(matrix, this);\n            this.pushMatrix(matrix);\n            this.traverse(transform);\n            this.popMatrix();\n        },\n\n        apply: function(node) {\n            if (node instanceof __WEBPACK_IMPORTED_MODULE_3_osg_Transform__["a" /* default */]) {\n                this.applyTransform(node);\n                return;\n            } else if (node instanceof __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__["a" /* default */]) {\n                this.applyBoundingBox(node.getBoundingBox());\n                return;\n            }\n\n            this.traverse(node);\n        },\n\n        pushMatrix: function(matrix) {\n            this._matrixStack.push(matrix);\n        },\n\n        popMatrix: function() {\n            this._matrixStack.pop();\n        },\n\n        applyBoundingBox: (function() {\n            var bbOut = new __WEBPACK_IMPORTED_MODULE_0_osg_BoundingBox__["a" /* default */]();\n\n            return function(bbox) {\n                if (bbox.valid()) {\n                    bbox.transformMat4(bbOut, this._matrixStack.back());\n                    this._bb.expandByBoundingBox(bbOut);\n                }\n            };\n        })(),\n\n        getMatrixStack: function() {\n            return this._matrixStack;\n        }\n    }),\n    \'osg\',\n    \'ComputeBoundsVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["default"] = (ComputeBoundsVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/ComputeBoundsVisitor.js\n// module id = 58\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/ComputeBoundsVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Timer__ = __webpack_require__(22);\n\n\n\n\n\n/**\n * VertexArrayObject "Bundles" multipel vertex / normal / ... buffer bind\n * in one webgl call\n * @class VertexArrayObject\n */\nvar VertexArrayObject = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].call(this);\n    // maybe could inherit from Object\n    this._instanceID = __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].getInstanceID();\n    this._vaoObject = undefined;\n    this.dirty();\n};\n\n// static cache of glBuffers flagged for deletion, which will actually\n// be deleted in the correct GL context.\nVertexArrayObject._sDeletedGLVertexArrayObjectCache = new window.Map();\n\n// static method to delete Program\nVertexArrayObject.deleteGLVertexArrayObject = function(gl, buffer) {\n    if (!VertexArrayObject._sDeletedGLVertexArrayObjectCache.has(gl))\n        VertexArrayObject._sDeletedGLVertexArrayObjectCache.set(gl, []);\n    VertexArrayObject._sDeletedGLVertexArrayObjectCache.get(gl).push(buffer);\n};\n\n// static method to flush all the cached glPrograms which need to be deleted in the GL context specified\nVertexArrayObject.flushDeletedGLVertexArrayObjects = function(gl, availableTime) {\n    // if no time available don\'t try to flush objects.\n    if (availableTime <= 0.0) return availableTime;\n    if (!VertexArrayObject._sDeletedGLVertexArrayObjectCache.has(gl)) return availableTime;\n    var elapsedTime = 0.0;\n    var beginTime = __WEBPACK_IMPORTED_MODULE_3_osg_Timer__["a" /* default */].instance().tick();\n    var deleteList = VertexArrayObject._sDeletedGLVertexArrayObjectCache.get(gl);\n    var numBuffers = deleteList.length;\n    for (var i = numBuffers - 1; i >= 0 && elapsedTime < availableTime; i--) {\n        gl.deleteVertexArray(deleteList[i]);\n        deleteList.splice(i, 1);\n        elapsedTime = __WEBPACK_IMPORTED_MODULE_3_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_3_osg_Timer__["a" /* default */].instance().tick());\n    }\n    return availableTime - elapsedTime;\n};\n\nVertexArrayObject.flushAllDeletedGLVertexArrayObjects = function(gl) {\n    if (!VertexArrayObject._sDeletedGLVertexArrayObjectCache.has(gl)) return;\n    var deleteList = VertexArrayObject._sDeletedGLVertexArrayObjectCache.get(gl);\n    var numBuffers = deleteList.length;\n    for (var i = numBuffers - 1; i >= 0; i--) {\n        gl.deleteVertexArray(deleteList[i]);\n        deleteList.splice(i, 1);\n    }\n};\n\nVertexArrayObject.onLostContext = function(gl) {\n    if (!VertexArrayObject._sDeletedGLVertexArrayObjectCache.has(gl)) return;\n    var deleteList = VertexArrayObject._sDeletedGLVertexArrayObjectCache.get(gl);\n    deleteList.length = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    VertexArrayObject,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].prototype, {\n        getInstanceID: function() {\n            return this._instanceID;\n        },\n\n        invalidate: function() {\n            this._vaoObject = undefined;\n            this.dirty();\n        },\n\n        releaseGLObjects: function() {\n            if (this._vaoObject !== undefined && this._gl !== undefined) {\n                VertexArrayObject.deleteGLVertexArrayObject(this._gl, this._vaoObject);\n                __WEBPACK_IMPORTED_MODULE_2_osg_GLObject__["a" /* default */].removeObject(this._gl, this);\n            }\n            this.invalidate();\n        },\n\n        create: function(gl) {\n            this._vaoObject = gl.createVertexArray();\n            this._dirty = false;\n        },\n\n        bind: function(gl) {\n            if (!this._gl) {\n                this.setGraphicContext(gl);\n            }\n\n            var vao = this._vaoObject;\n            if (!vao) return;\n\n            gl.bindVertexArray(this._vaoObject);\n        },\n\n        dirty: function() {\n            this._dirty = true;\n        },\n\n        isDirty: function() {\n            return this._dirty;\n        }\n    }),\n    \'osg\',\n    \'VertexArrayObject\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (VertexArrayObject);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/VertexArrayObject.js\n// module id = 59\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/VertexArrayObject.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_PooledArray__ = __webpack_require__(19);\n\n\nvar PooledMap = function() {\n    this._keys = new __WEBPACK_IMPORTED_MODULE_0_osg_PooledArray__["a" /* default */]();\n    this._map = {};\n};\n\nPooledMap.prototype = {\n    reset: function() {\n        var array = this._keys.getArray();\n        var arrayLength = this._keys.getLength();\n        for (var i = 0; i < arrayLength; i++) {\n            var key = array[i];\n            this._map[key] = undefined;\n        }\n        this._keys.reset();\n    },\n    /**\n     * Set a key value\n     * you have to check that the key does not exist before otherwise you could hit performance hit when calling reset/forEach\n     */\n    set: function(key, value) {\n        this._keys.push(key);\n        this._map[key] = value;\n    },\n    hasKey: function(key) {\n        return this._map[key] !== undefined;\n    },\n    getMap: function() {\n        return this._map;\n    },\n    getKeys: function() {\n        return this._keys;\n    },\n    forEach: function(func) {\n        var array = this._keys.getArray();\n        var arrayLength = this._keys.getLength();\n        for (var i = 0; i < arrayLength; i++) {\n            var key = array[i];\n            func(key, this._map[key]);\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (PooledMap);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/PooledMap.js\n// module id = 60\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/PooledMap.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_math__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_PooledResource__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_PooledMap__ = __webpack_require__(60);\n\n\n\n\n\n\n\n\nvar createPositionAttribute = function() {\n    return [null, null];\n};\n\n/**\n * RenderBin base class. Renderbin contains geometries to be rendered as a group,\n * renderbins are rendered once each.  They can improve efficiency or\n * use different rendering algorithms.\n * A renderBin can contain further renderBins producing a tree hierarchy of renderBins.\n *\n * https://github.com/openscenegraph/osg/blob/master/include/osgUtil/RenderBin#L27-L32\n */\nvar RenderBin = function(sortMode) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].call(this);\n\n    this._renderStage = undefined;\n    this._parent = undefined;\n    this._binNum = 0;\n    this._sorted = false;\n    this._sortMode = sortMode !== undefined ? sortMode : RenderBin.defaultSortMode;\n    this._drawCallback = undefined;\n    this._leafs = [];\n    this._pooledPositionedAttribute = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledResource__["a" /* default */](createPositionAttribute);\n    this._positionedAttribute = new __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__["a" /* default */]();\n    this._stateGraphList = new __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__["a" /* default */]();\n    this._bins = new __WEBPACK_IMPORTED_MODULE_6_osg_PooledMap__["a" /* default */]();\n    RenderBin.prototype.init.call(this, sortMode);\n};\n\nRenderBin.SORT_BY_STATE = 0;\nRenderBin.SORT_BACK_TO_FRONT = 1;\nRenderBin.SORT_FRONT_TO_BACK = 2;\n\n// change it at runtime for default RenderBin if needed\nRenderBin.defaultSortMode = RenderBin.SORT_BY_STATE;\n\nvar createRenderBin = function() {\n    return new RenderBin();\n};\nvar pooledRenderBin = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledResource__["a" /* default */](createRenderBin);\n\nRenderBin.BinPrototypes = {\n    RenderBin: function() {\n        return pooledRenderBin.getOrCreateObject().init();\n    },\n    DepthSortedBin: function() {\n        return pooledRenderBin.getOrCreateObject().init(RenderBin.SORT_BACK_TO_FRONT);\n    }\n};\n\nvar sortBackToFrontFunction = function(a, b) {\n    return b._depth - a._depth;\n};\n\nvar sortFrontToBackFunction = function(a, b) {\n    return a._depth - b._depth;\n};\n\nvar sortBinNumberFunction = function(a, b) {\n    return a._binNum - b._binNum;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    RenderBin,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].prototype, {\n        init: function(sortMode) {\n            this._renderStage = undefined;\n            this._parent = undefined;\n            this._binNum = 0;\n            this._sortMode = sortMode !== undefined ? sortMode : RenderBin.defaultSortMode;\n            this._drawCallback = undefined;\n            RenderBin.prototype._initInternal.call(this);\n            return this;\n        },\n        _initInternal: function() {\n            this._bins.reset();\n            this._stateGraphList.reset();\n            this._positionedAttribute.reset();\n            this._pooledPositionedAttribute.reset();\n            this._leafs.length = 0;\n            this._sorted = false;\n        },\n        _createRenderBin: function(binName) {\n            // default render bin constructor\n            var renderBinConstructor = RenderBin.BinPrototypes.RenderBin;\n\n            if (binName && RenderBin.BinPrototypes[binName])\n                renderBinConstructor = RenderBin.BinPrototypes[binName];\n\n            return renderBinConstructor();\n        },\n\n        addPositionAttribute: function(m, attribute) {\n            var pa = this._pooledPositionedAttribute.getOrCreateObject();\n            pa[0] = m;\n            pa[1] = attribute;\n            this._positionedAttribute.push(pa);\n        },\n\n        getStateGraphList: function() {\n            return this._stateGraphList;\n        },\n\n        getPositionedAttribute: function() {\n            return this._positionedAttribute;\n        },\n\n        copyLeavesFromStateGraphListToRenderLeafList: function() {\n            this._leafs.length = 0;\n            var detectedNaN = false;\n\n            var stateGraphList = this._stateGraphList.getArray();\n            var stateGraphListLength = this._stateGraphList.getLength();\n            for (var i = 0; i < stateGraphListLength; i++) {\n                var leafs = stateGraphList[i]._leafs;\n                var leafsArray = leafs.getArray();\n                var leafsArrayLength = leafs.getLength();\n                for (var j = 0; j < leafsArrayLength; j++) {\n                    var leaf = leafsArray[j];\n                    if (__WEBPACK_IMPORTED_MODULE_3_osg_math__["a" /* default */].isNaN(leaf._depth)) {\n                        detectedNaN = true;\n                    } else {\n                        this._leafs.push(leaf);\n                    }\n                }\n            }\n\n            if (detectedNaN) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].debug(\n                    \'warning: RenderBin::copyLeavesFromStateGraphListToRenderLeafList() detected NaN depth values, database may be corrupted.\'\n                );\n            }\n            // empty the render graph list to prevent it being drawn along side the render leaf list (see drawImplementation.)\n            this._stateGraphList.reset();\n        },\n\n        getSortMode: function() {\n            return this._sortMode;\n        },\n\n        sortBackToFront: function() {\n            this.copyLeavesFromStateGraphListToRenderLeafList();\n            this._leafs.sort(sortBackToFrontFunction);\n        },\n\n        sortFrontToBack: function() {\n            this.copyLeavesFromStateGraphListToRenderLeafList();\n            this._leafs.sort(sortFrontToBackFunction);\n        },\n\n        sortImplementation: function() {\n            var SortMode = RenderBin;\n            switch (this._sortMode) {\n                case SortMode.SORT_BACK_TO_FRONT:\n                    this.sortBackToFront();\n                    break;\n                case SortMode.SORT_FRONT_TO_BACK:\n                    this.sortFrontToBack();\n                    break;\n                case SortMode.SORT_BY_STATE:\n                    // do nothing\n                    break;\n            }\n        },\n\n        sort: function() {\n            if (this._sorted) return;\n\n            var binsKeys = this._bins.getKeys();\n            var binsMap = this._bins.getMap();\n            var binsKeysArray = binsKeys.getArray();\n            var binsKeysArrayLength = binsKeys.getLength();\n            for (var i = 0; i < binsKeysArrayLength; i++) {\n                var keyBin = binsKeysArray[i];\n                binsMap[keyBin].sort();\n            }\n            this.sortImplementation();\n\n            this._sorted = true;\n        },\n\n        setParent: function(parent) {\n            this._parent = parent;\n        },\n\n        getParent: function() {\n            return this._parent;\n        },\n\n        getBinNumber: function() {\n            return this._binNum;\n        },\n\n        findOrInsert: function(binNum, binName) {\n            var bins = this._bins.getMap();\n            var bin = bins[binNum];\n\n            if (!bin) {\n                bin = this._createRenderBin(binName);\n                bin._parent = this;\n                bin._binNum = binNum;\n                bin._renderStage = this._renderStage;\n                this._bins.set(binNum, bin);\n            }\n            return bin;\n        },\n\n        getStage: function() {\n            return this._renderStage;\n        },\n\n        addStateGraph: function(sg) {\n            this._stateGraphList.push(sg);\n        },\n\n        reset: function() {\n            RenderBin.prototype._initInternal.call(this);\n        },\n\n        draw: function(state, previousRenderLeaf) {\n            var previousLeaf = previousRenderLeaf;\n            // use callback drawImplementation if exist\n            if (this._drawCallback && this._drawCallback.drawImplementation) {\n                previousLeaf = this._drawCallback.drawImplementation(this, state, previousLeaf);\n            } else {\n                previousLeaf = this.drawImplementation(state, previousLeaf);\n            }\n\n            return previousLeaf;\n        },\n\n        applyPositionedAttribute: function(state, positionedAttributes) {\n            // the idea is to set uniform \'globally\' in uniform map.\n            var elements = positionedAttributes.getArray();\n            var length = positionedAttributes.getLength();\n            for (var index = 0, l = length; index < l; index++) {\n                var element = elements[index];\n                // add or set uniforms in state\n                var stateAttribute = element[1];\n                var matrix = element[0];\n                state.setGlobalDefaultAttribute(stateAttribute);\n                stateAttribute.apply(state);\n                stateAttribute.applyPositionedUniform(matrix, state);\n                state.haveAppliedAttribute(stateAttribute);\n            }\n        },\n\n        drawImplementation: function(state, previousRenderLeaf) {\n            var previousLeaf = previousRenderLeaf;\n\n            var binsArray = [];\n\n            var bins = this._bins.getMap();\n            var binsKeys = this._bins.getKeys();\n            var binsKeysLength = binsKeys.getLength();\n            var binsKeysArray = binsKeys.getArray();\n            for (var i = 0; i < binsKeysLength; i++) {\n                var keyBin = binsKeysArray[i];\n                binsArray.push(bins[keyBin]);\n            }\n            binsArray.sort(sortBinNumberFunction);\n\n            var current = 0;\n            var end = binsArray.length;\n\n            var bin;\n            // draw pre bins\n            for (; current < end; current++) {\n                bin = binsArray[current];\n                if (bin.getBinNumber() > 0) {\n                    break;\n                }\n                previousLeaf = bin.draw(state, previousLeaf);\n            }\n\n            // draw leafs\n            previousLeaf = this.drawLeafs(state, previousLeaf);\n\n            // draw post bins\n            for (; current < end; current++) {\n                bin = binsArray[current];\n                previousLeaf = bin.draw(state, previousLeaf);\n            }\n            return previousLeaf;\n        },\n\n        drawLeafs: function(state, previousRenderLeaf) {\n            var stateList = this._stateGraphList.getArray();\n            var stateListLength = this._stateGraphList.getLength();\n            var leafs = this._leafs;\n            var previousLeaf = previousRenderLeaf;\n            var leaf;\n\n            // draw fine grained ordering.\n            for (var d = 0, dl = leafs.length; d < dl; d++) {\n                leaf = leafs[d];\n                leaf.render(state, previousLeaf);\n                previousLeaf = leaf;\n            }\n\n            // draw coarse grained ordering.\n            for (var i = 0, l = stateListLength; i < l; i++) {\n                var sg = stateList[i];\n                var leafArray = sg._leafs.getArray();\n                var leafArrayLength = sg._leafs.getLength();\n                for (var j = 0; j < leafArrayLength; j++) {\n                    leaf = leafArray[j];\n                    leaf.render(state, previousLeaf);\n                    previousLeaf = leaf;\n                }\n            }\n            return previousLeaf;\n        }\n    }),\n    \'osg\',\n    \'RenderBin\'\n);\n\nRenderBin.reset = function() {\n    pooledRenderBin.reset();\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (RenderBin);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/RenderBin.js\n// module id = 61\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/RenderBin.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_UpdateSkeleton__ = __webpack_require__(112);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_UpdateMatrixTransform__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_Bone__ = __webpack_require__(44);\n\n\n\n\n\n\n\nvar ResetRestPoseVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    ResetRestPoseVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.getTypeID() === __WEBPACK_IMPORTED_MODULE_5_osgAnimation_Bone__["a" /* default */].getTypeID()) {\n                var cb = node.getUpdateCallback();\n                if (cb instanceof __WEBPACK_IMPORTED_MODULE_4_osgAnimation_UpdateMatrixTransform__["a" /* default */]) {\n                    var stackedTransforms = cb._stackedTransforms;\n                    for (var st = 0, l = stackedTransforms.length; st < l; st++) {\n                        var stackedTransform = stackedTransforms[st];\n                        stackedTransform.resetToDefaultValue();\n                    }\n                    cb.computeChannels();\n                }\n            }\n            this.traverse(node);\n        }\n    }),\n    \'osgAnimation\',\n    \'ResetRestPoseVisitor\'\n);\n\nvar resetter = new ResetRestPoseVisitor();\n\nvar Skeleton = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_MatrixTransform__["a" /* default */].call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Skeleton,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_MatrixTransform__["a" /* default */].prototype, {\n        setDefaultUpdateCallback: function() {\n            this.addUpdateCallback(new __WEBPACK_IMPORTED_MODULE_2_osgAnimation_UpdateSkeleton__["a" /* default */]());\n        },\n\n        setRestPose: function() {\n            this.accept(resetter);\n        }\n    }),\n    \'osgAnimation\',\n    \'Skeleton\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Skeleton);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/Skeleton.js\n// module id = 62\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/Skeleton.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_AnimationUpdateCallback__ = __webpack_require__(52);\n\n\n\n\n/**\n *  UpdateMatrixTransform\n */\nvar UpdateMatrixTransform = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgAnimation_AnimationUpdateCallback__["a" /* default */].call(this);\n\n    // maybe could have a more generic name and used by all AnimationUpdateCallback\n    this._stackedTransforms = [];\n\n    this._matrix = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n\n    this._dirty = false;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    UpdateMatrixTransform,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgAnimation_AnimationUpdateCallback__["a" /* default */].prototype, {\n        getStackedTransforms: function() {\n            return this._stackedTransforms;\n        },\n\n        computeChannels: function() {\n            this._dirty = true;\n            var matrix = this._matrix;\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].identity(matrix);\n            var transforms = this._stackedTransforms;\n\n            for (var i = 0, l = transforms.length; i < l; i++) {\n                var transform = transforms[i];\n                transform.applyToMatrix(matrix);\n            }\n        },\n\n        update: function(node /*, nv */) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].copy(node.getMatrix(), this._matrix);\n            if (this._dirty) {\n                node.dirtyBound();\n                this._dirty = false;\n            }\n            return true;\n        }\n    }),\n    \'osgAnimation\',\n    \'UpdateMatrixTransform\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (UpdateMatrixTransform);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/UpdateMatrixTransform.js\n// module id = 63\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/UpdateMatrixTransform.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_shaderLib__ = __webpack_require__(118);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShadow_shaderLib__ = __webpack_require__(119);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_WebGLCaps__ = __webpack_require__(18);\n\n\n\n\n\n// webgl2 protected variable names : sample, texture\n\n//     Shader as vert/frag/glsl files Using requirejs text plugin\n//     Preprocess features like:    //\n//     - Handle (recursive) include, avoiding code repeat and help code factorization\n//     - Handle per shader and global define/precision\n\nvar ShaderProcessor = function(createInstance) {\n    if (!createInstance) {\n        if (ShaderProcessor.instance) {\n            return ShaderProcessor.instance;\n        }\n        ShaderProcessor.instance = this;\n    }\n\n    this.addShaders(__WEBPACK_IMPORTED_MODULE_1_osgShader_shaderLib__[\"a\" /* default */]);\n    this.addShaders(__WEBPACK_IMPORTED_MODULE_2_osgShadow_shaderLib__[\"a\" /* default */]);\n    return this;\n};\n\nShaderProcessor.prototype = {\n    _shadersText: {},\n    _shadersList: {},\n    _globalDefaultprecision:\n        '#ifdef GL_FRAGMENT_PRECISION_HIGH\\n precision highp float;\\n #else\\n precision mediump float;\\n#endif',\n    _debugLines: false,\n    _includeR: /#pragma include \"([^\"]+)\"/g,\n    _includeCondR: /#pragma include ([\"^+\"]?[\"\\ \"[a-zA-Z_0-9](.*)\"]*?)/g,\n    _defineR: /\\#define\\s+([a-zA-Z_0-9]+)/,\n    _precisionR: /precision\\s+(high|low|medium)p\\s+float/,\n\n    // {\n    //     'functions.glsl': textShaderFunctions,\n    //     'lights.glsl': textShaderFunctions,\n    //     'textures.glsl': textShaderFunctions\n    // };\n    addShaders: function(shaders) {\n        for (var key in shaders) {\n            this._shadersList[key] = key;\n            this._shadersText[key] = shaders[key];\n        }\n    },\n\n    instrumentShaderlines: function(content, sourceID) {\n        // TODO instrumentShaderlines\n        // http://immersedcode.org/2012/1/12/random-notes-on-webgl/\n        // one ID per \"file\"\n        // Each file has its line number starting at 0\n        //   handle include, the do that numbering also in preprocess...\n        // Then on shader error using sourceID and line you can point the correct line...\n        // has to attach that info to osg.shader object.\n        /*\n          var allLines = content.split('\\n');\n          var i = 0;\n          for (var k = 0; k _< allLines.length; k++) {\n          if (!this._includeR.test(allLines[k])) {\n          allLines[k] = \"#line \" + (i++) + \" \" + sourceID + '\\n' + allLines[k] ;\n          }\n          }\n          content = allLines.join('\\n');\n        */\n\n        // seems just  prefixing first line seems ok to help renumbering error mesg\n        return '\\n#line ' + 0 + ' ' + sourceID + '\\n' + content;\n    },\n\n    hasShader: function(shaderName) {\n        // unlike getShaderTextPure, doesn't log an erreur if the shader doesn't exist\n        return this._shadersText[shaderName] !== undefined;\n    },\n\n    getShaderTextPure: function(shaderName) {\n        var preShader = this._shadersText[shaderName];\n\n        if (!preShader) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('shader file/text: ' + shaderName + ' not registered');\n            preShader = '';\n        }\n\n        return preShader;\n    },\n\n    getShader: function(shaderName, defines, extensions, type) {\n        var shader = this.getShaderTextPure(shaderName);\n        return this.processShader(shader, defines, extensions, type);\n    },\n\n    // recursively  handle #include external glsl\n    // files (for now in the same folder.)\n    preprocess: function(content, sourceID, includeList, inputsDefines /*, type */) {\n        var self = this;\n        return content.replace(\n            this._includeCondR,\n            function(_, strMatch) {\n                var includeOpt = strMatch.split(' ');\n                var includeName = includeOpt[0].replace(/\"/g, '');\n\n                // pure include is\n                // \\#pragma include \"name\";\n\n                // conditionnal include is name included if _PCF defined\n                // \\#pragma include \"name\" \"_PCF\";\n                if (includeOpt.length > 1 && inputsDefines) {\n                    // some conditions here.\n                    // if not defined we do not include\n                    var found = false;\n                    var defines = inputsDefines.map(function(defineString) {\n                        // find '#define', remove duplicate whitespace, split on space and return the define Text\n                        return (\n                            self._defineR.test(defineString) &&\n                            defineString.replace(/\\s+/g, ' ').split(' ')[1]\n                        );\n                    });\n\n                    for (var i = 1; i < includeOpt.length && !found; i++) {\n                        var key = includeOpt[i].replace(/\"/g, '');\n                        for (var k = 0; k < defines.length && !found; k++) {\n                            if (defines[k] !== false && defines[k] === key) {\n                                found = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (!found) return '';\n                }\n\n                // already included\n                if (includeList.indexOf(includeName) !== -1) return '';\n                // avoid endless loop, not calling the impure\n                var txt = this.getShaderTextPure(includeName);\n                // make sure it's not included twice\n                includeList.push(includeName);\n                if (this._debugLines) {\n                    txt = this.instrumentShaderlines(txt, sourceID);\n                }\n                sourceID++;\n                // to the infinite and beyond !\n                txt = this.preprocess(txt, sourceID, includeList, inputsDefines);\n                return txt;\n            }.bind(this)\n        );\n    },\n\n    _getSortedUnique: (function() {\n        var filterDuplicate = function(item, pos, self) {\n            return !pos || item !== self[pos - 1];\n        };\n\n        return function(array) {\n            return array && array.sort().filter(filterDuplicate);\n        };\n    })(),\n\n    _convertExtensionsToWebGL2: (function() {\n        var cbRenamer = function(match, extension) {\n            return 'core_' + extension;\n        };\n\n        var cbDefiner = function(match, extension) {\n            return '#define ' + extension;\n        };\n\n        var extensions =\n            '(GL_EXT_shader_texture_lod|GL_OES_standard_derivatives|GL_EXT_draw_buffers|GL_EXT_frag_depth)';\n        var definer = new RegExp('#\\\\s*extension\\\\s+' + extensions + '.*', 'g');\n        var renamer = new RegExp(extensions, 'g');\n\n        return function(strShader) {\n            strShader = strShader.replace(definer, cbDefiner); // replace #extension by #define\n            strShader = strShader.replace(renamer, cbRenamer); // rename extension\n            return strShader;\n        };\n    })(),\n\n    _convertToWebGL2: (function() {\n        var frags = [];\n        var replaceMRT = function(match, number) {\n            var varName = 'glFragData_' + number;\n            frags[number] = 'layout(location = ' + number + ') out vec4 ' + varName + ';';\n            return varName;\n        };\n\n        return function(strShader, isFragment) {\n            if (!strShader) return strShader;\n\n            strShader = strShader.replace(/attribute\\s+/g, 'in ');\n            strShader = strShader.replace(/varying\\s+/g, isFragment ? 'in ' : 'out ');\n            strShader = strShader.replace(/(texture2D|textureCube)\\s*\\(/g, 'texture(');\n            strShader = strShader.replace(/(textureCubeLodEXT)\\s*\\(/g, 'textureLod(');\n\n            strShader = this._convertExtensionsToWebGL2(strShader);\n\n            if (isFragment) {\n                frags.length = 0;\n                strShader = strShader.replace(/gl_FragData\\s*\\[\\s*(\\d+)\\s*\\]/g, replaceMRT);\n\n                if (!frags.length) frags.push('out vec4 glFragColor_0;');\n                strShader = strShader.replace(/gl_FragColor/g, 'glFragColor_0');\n                strShader = strShader.replace(\n                    /void\\s+main\\s*\\(/g,\n                    frags.join('\\n') + '\\nvoid main('\n                );\n            }\n\n            return strShader;\n        };\n    })(),\n\n    _hasVersion: function(shader) {\n        // match first line starting with #\n        var version = shader.match(/^#(.*)$/m);\n        return version && version[0].indexOf('version') !== -1;\n    },\n\n    // process shader\n    // - declare version, extensions, precision and defines\n    // - resolve pragma include\n    // - Convert webgl1 to webgl2 (glsl 100 to glsl 330 es)\n    processShader: function(shader, defines, extensions, type) {\n        // if the shader has #version statement we skip the shader processing\n        if (this._hasVersion(shader)) {\n            return shader;\n        }\n\n        var includeList = [];\n        var preShader = shader;\n        var sourceID = 0;\n        if (this._debugLines) {\n            preShader = this.instrumentShaderlines(preShader, sourceID);\n            sourceID++;\n        }\n\n        // removes duplicates\n        defines = this._getSortedUnique(defines);\n        extensions = this._getSortedUnique(extensions);\n\n        var strCore = this.preprocess(preShader, sourceID, includeList, defines, type);\n\n        // avoid warning on unrecognized pragma\n        strCore = strCore.replace(/#pragma DECLARE_FUNCTION/g, '//#pragma DECLARE_FUNCTION');\n\n        var isFragment = strCore.indexOf('gl_Position') === -1;\n        var convertToWebGL2 = __WEBPACK_IMPORTED_MODULE_3_osg_WebGLCaps__[\"a\" /* default */].instance().isWebGL2();\n\n        var strVersion = convertToWebGL2 ? '#version 300 es' : '#version 100';\n        strVersion += '\\n';\n\n        var strExtensions = extensions ? extensions.join('\\n') + '\\n' : '';\n\n        var strDefines = defines ? defines.join('\\n') + '\\n' : '';\n\n        if (convertToWebGL2) {\n            strExtensions = this._convertExtensionsToWebGL2(strExtensions);\n            strDefines = this._convertToWebGL2(strDefines, isFragment);\n            strCore = this._convertToWebGL2(strCore, isFragment);\n        } else {\n            // support multiline define\n            strDefines = strDefines.replace(/\\\\\\n/g, '');\n            strCore = strCore.replace(/\\\\\\n/g, '');\n        }\n\n        // vertex shader uses highp per default BUT if FS is using mediump then VS should too (conflict with varying/uniform otherwise)\n        // also make sure precision is not already providen\n        var strPrecision = '';\n        if (this._globalDefaultprecision && !this._precisionR.test(strCore)) {\n            strPrecision = this._globalDefaultprecision + '\\n';\n        }\n\n        // order is important\n        // See https://khronos.org/registry/gles/specs/2.0/GLSL_ES_Specification_1.0.17.pdf (p14-15: extension before any non-processor token)\n        return strVersion + strExtensions + strPrecision + strDefines + strCore;\n    }\n};\n/* harmony default export */ __webpack_exports__[\"a\"] = (ShaderProcessor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/ShaderProcessor.js\n// module id = 64\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/ShaderProcessor.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgAnimation_channel__ = __webpack_require__(46);\n\n\n// create Animation data\n// Animation {\n//     channels: [],\n//     duration: 0.0;\n//     name: string\n// },\n\nvar animationCount = 0;\n\n// assume that iniChannel has been called\n// on each channel\nvar createAnimation = function(channels, name) {\n    var min = Infinity;\n    var max = -Infinity;\n    for (var i = 0; i < channels.length; i++) {\n        min = Math.min(min, channels[i].start);\n        max = Math.max(max, channels[i].end);\n    }\n\n    var duration = max - min;\n    var animationName = name || \'animation\' + animationCount.toString();\n    animationCount++;\n    return {\n        channels: channels,\n        duration: duration,\n        name: animationName,\n        start: min\n    };\n};\n\n// create instance Animation data. An instance animation\n// contains instance channels instead of original channels\n// Animation {\n//     channels: [],\n//     duration: 0.0;\n//     start: 0.0, // used to know when an animation has been started\n//     name: string\n// },\nvar createInstanceAnimation = function(animation) {\n    var channels = [];\n    for (var i = 0; i < animation.channels.length; i++) {\n        var channel = __WEBPACK_IMPORTED_MODULE_0_osgAnimation_channel__["a" /* default */].createInstanceChannel(animation.channels[i]);\n        channels.push(channel);\n    }\n\n    return {\n        channels: channels,\n        duration: animation.duration,\n        start: 0.0,\n        name: animation.name,\n        firstKeyTime: animation.start\n    };\n};\n\nvar Animation = function() {};\n\nAnimation.createAnimation = createAnimation;\nAnimation.createInstanceAnimation = createInstanceAnimation;\n\n/* harmony default export */ __webpack_exports__["a"] = (Animation);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/animation.js\n// module id = 65\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/animation.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_transformEnums__ = __webpack_require__(12);\n\n\n\n\nvar rejectObject = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].rejectObject;\n\nvar osgWrapper = {};\n\nosgWrapper.Object = function(input, obj) {\n    var jsonObj = input.getJSON();\n\n    if (jsonObj.Name) obj.setName(jsonObj.Name);\n\n    if (jsonObj.UserDataContainer) {\n        var userdata = input.setJSON(jsonObj.UserDataContainer).readUserDataContainer();\n        if (userdata !== undefined) {\n            obj.setUserData(userdata);\n        }\n    }\n\n    return obj;\n};\n/* jshint newcap: false */\nosgWrapper.Node = function(input, node) {\n    var jsonObj = input.getJSON();\n\n    osgWrapper.Object(input, node);\n\n    var promiseArray = [];\n\n    if (jsonObj.UpdateCallbacks) {\n        var cbAddCallback = node.addUpdateCallback.bind(node);\n        for (var j = 0, l = jsonObj.UpdateCallbacks.length; j < l; j++) {\n            var promise = input.setJSON(jsonObj.UpdateCallbacks[j]).readObject();\n            promiseArray.push(promise);\n            promise.then(cbAddCallback);\n        }\n    }\n\n    if (jsonObj.StateSet) {\n        var pp = input.setJSON(jsonObj.StateSet).readObject();\n        promiseArray.push(pp);\n        pp.then(node.setStateSet.bind(node));\n    }\n\n    var queue = [];\n    // For each url, create a function call and add it to the queue\n    if (jsonObj.Children) {\n        for (var i = 0, k = jsonObj.Children.length; i < k; i++) {\n            queue.push(input.setJSON(jsonObj.Children[i]).readObject());\n        }\n    }\n    // Resolve first updateCallbacks and stateset.\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promiseArray).then(function() {\n        // Need to wait until the stateset and the all the callbacks are resolved\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(queue).then(function(queueNodes) {\n            // All the results from P.all are on the argument as an array\n            // Now insert children in the right order\n            var len = queueNodes.length;\n            for (var n = 0; n < len; n++) node.addChild(queueNodes[n]);\n            return node;\n        });\n    });\n};\n\nosgWrapper.StateSet = function(input, stateSet) {\n    var jsonObj = input.getJSON();\n\n    osgWrapper.Object(input, stateSet);\n\n    if (jsonObj.RenderingHint !== undefined) {\n        stateSet.setRenderingHint(jsonObj.RenderingHint);\n    }\n\n    var promiseArray = [];\n\n    var createAttribute = function(jsonAttribute) {\n        var promise = input.setJSON(jsonAttribute).readObject();\n        if (\n            promise.isRejected() // sometimes we have some empty objects\n        )\n            return;\n        promiseArray.push(promise);\n        promise.then(stateSet.setAttributeAndModes.bind(stateSet));\n    };\n\n    if (jsonObj.AttributeList !== undefined) {\n        for (var i = 0, l = jsonObj.AttributeList.length; i < l; i++) {\n            createAttribute(jsonObj.AttributeList[i]);\n        }\n    }\n\n    var createTextureAttribute = function(unit, textureAttribute) {\n        var promise = input.setJSON(textureAttribute).readObject();\n        if (\n            promise.isRejected() // sometimes we have some empty objects\n        )\n            return;\n        promiseArray.push(promise);\n        promise.then(stateSet.setTextureAttributeAndModes.bind(stateSet, unit));\n    };\n\n    if (jsonObj.TextureAttributeList) {\n        var textures = jsonObj.TextureAttributeList;\n        for (var t = 0, lt = textures.length; t < lt; t++) {\n            var textureAttributes = textures[t];\n            for (var a = 0, al = textureAttributes.length; a < al; a++) {\n                createTextureAttribute(t, textureAttributes[a]);\n            }\n        }\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promiseArray).then(function() {\n        return stateSet;\n    });\n};\n\nosgWrapper.Material = function(input, material) {\n    var jsonObj = input.getJSON();\n    if (\n        !jsonObj.Diffuse ||\n        !jsonObj.Emission ||\n        !jsonObj.Specular ||\n        jsonObj.Shininess === undefined\n    ) {\n        return rejectObject('Material', jsonObj);\n    }\n\n    osgWrapper.Object(input, material);\n\n    material.setAmbient(jsonObj.Ambient);\n    material.setDiffuse(jsonObj.Diffuse);\n    material.setEmission(jsonObj.Emission);\n    material.setSpecular(jsonObj.Specular);\n    material.setShininess(jsonObj.Shininess);\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(material);\n};\n\nosgWrapper.BlendFunc = function(input, blend) {\n    var jsonObj = input.getJSON();\n    if (\n        !jsonObj.SourceRGB ||\n        !jsonObj.SourceAlpha ||\n        !jsonObj.DestinationRGB ||\n        !jsonObj.DestinationAlpha\n    ) {\n        return rejectObject('BlendFunc', jsonObj);\n    }\n\n    osgWrapper.Object(input, blend);\n\n    blend.setSourceRGB(jsonObj.SourceRGB);\n    blend.setSourceAlpha(jsonObj.SourceAlpha);\n    blend.setDestinationRGB(jsonObj.DestinationRGB);\n    blend.setDestinationAlpha(jsonObj.DestinationAlpha);\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(blend);\n};\n\nosgWrapper.CullFace = function(input, attr) {\n    var jsonObj = input.getJSON();\n    if (jsonObj.Mode === undefined) return rejectObject('CullFace', jsonObj);\n\n    osgWrapper.Object(input, attr);\n    attr.setMode(jsonObj.Mode);\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(attr);\n};\n\nosgWrapper.BlendColor = function(input, attr) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.ConstantColor) return rejectObject('BlendColor', jsonObj);\n\n    osgWrapper.Object(input, attr);\n    attr.setConstantColor(jsonObj.ConstantColor);\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(attr);\n};\n\nosgWrapper.Light = function(input, light) {\n    var jsonObj = input.getJSON();\n\n    if (\n        !jsonObj.Ambient ||\n        !jsonObj.Diffuse ||\n        !jsonObj.Direction ||\n        !jsonObj.Position ||\n        !jsonObj.Specular ||\n        jsonObj.LightNum === undefined ||\n        jsonObj.SpotCutoff === undefined ||\n        jsonObj.LinearAttenuation === undefined ||\n        jsonObj.ConstantAttenuation === undefined ||\n        jsonObj.QuadraticAttenuation === undefined\n    ) {\n        return rejectObject('Light', jsonObj);\n    }\n\n    osgWrapper.Object(input, light);\n    light.setAmbient(jsonObj.Ambient);\n    light.setConstantAttenuation(jsonObj.ConstantAttenuation);\n    light.setDiffuse(jsonObj.Diffuse);\n    light.setDirection(jsonObj.Direction);\n    light.setLightNumber(jsonObj.LightNum);\n    light.setLinearAttenuation(jsonObj.LinearAttenuation);\n    light.setPosition(jsonObj.Position);\n    light.setQuadraticAttenuation(jsonObj.QuadraticAttenuation);\n    light.setSpecular(jsonObj.Specular);\n    light.setSpotCutoff(jsonObj.SpotCutoff);\n    light.setSpotBlend(0.01);\n    if (jsonObj.SpotExponent !== undefined) {\n        light.setSpotBlend(jsonObj.SpotExponent / 128.0);\n    }\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(light);\n};\n\nosgWrapper.Texture = function(input, texture) {\n    var jsonObj = input.getJSON();\n\n    osgWrapper.Object(input, texture);\n\n    if (jsonObj.MinFilter) texture.setMinFilter(jsonObj.MinFilter);\n    if (jsonObj.MagFilter) texture.setMagFilter(jsonObj.MagFilter);\n    if (jsonObj.WrapT) texture.setWrapT(jsonObj.WrapT);\n    if (jsonObj.WrapS) texture.setWrapS(jsonObj.WrapS);\n\n    // no file return dummy texture\n    var file = jsonObj.File;\n    if (file === undefined) {\n        file = 'no-image-provided';\n    }\n\n    return input.readImageURL(file).then(function(img) {\n        texture.setImage(img);\n        return texture;\n    });\n};\n\nosgWrapper.Projection = function(input, node) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Matrix) return rejectObject('Projection', jsonObj);\n\n    var promise = osgWrapper.Node(input, node);\n    node.setMatrix(jsonObj.Matrix);\n    return promise;\n};\n\nosgWrapper.MatrixTransform = function(input, node) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Matrix) return rejectObject('MatrixTransform', jsonObj);\n\n    var promise = osgWrapper.Node(input, node);\n    node.setMatrix(jsonObj.Matrix);\n    return promise;\n};\n\nosgWrapper.LightSource = function(input, node) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Light) return rejectObject('LightSource', jsonObj);\n\n    var promise = osgWrapper.Node(input, node);\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all([input.setJSON(jsonObj.Light).readObject(), promise]).then(function(args) {\n        var light = args[0];\n        //var lightsource = args[ 1 ];\n        node.setLight(light);\n        if (jsonObj.ReferenceFrame === 'ABSOLUTE_RF') {\n            node.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_2_osg_transformEnums__[\"a\" /* default */].ABSOLUTE_RF);\n        }\n        return node;\n    });\n};\n\n// not robust, but we probably don't want to complexify the function for now\nosgWrapper.functionSortAttributes = function(a, b) {\n    if (a.indexOf('TexCoord') !== -1 && b.indexOf('TexCoord') !== -1) {\n        return parseInt(a.substr(8), 10) - parseInt(b.substr(8), 10);\n    }\n\n    if (a < b) return -1;\n    if (a > b) return 1;\n    return 0;\n};\n\nosgWrapper.Geometry = function(input, node) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.VertexAttributeList) return rejectObject('Geometry', jsonObj);\n\n    jsonObj.PrimitiveSetList = jsonObj.PrimitiveSetList || [];\n\n    var arraysPromise = [];\n    arraysPromise.push(osgWrapper.Node(input, node));\n\n    var prims = node.getPrimitives();\n    var cbAddPrimitives = prims.push.bind(prims);\n    var i = 0;\n    var l = jsonObj.PrimitiveSetList.length;\n    for (i = 0; i < l; i++) {\n        var promisePrimitive = input.setJSON(jsonObj.PrimitiveSetList[i]).readPrimitiveSet();\n        arraysPromise.push(promisePrimitive);\n        promisePrimitive.then(cbAddPrimitives);\n    }\n\n    var cbSetBuffer = function(name, buffer) {\n        this.getVertexAttributeList()[name] = buffer;\n    };\n\n    var vList = jsonObj.VertexAttributeList;\n    var keys = window.Object.keys(vList);\n\n    // TexCoord10 should be sorted after TexCoord5 (in case of referenced attributes)\n    // alternative is to resolve the referenced keys (2 passes method for example)\n    keys.sort(osgWrapper.functionSortAttributes);\n\n    l = keys.length;\n    for (i = 0; i < l; i++) {\n        var name = keys[i];\n        var promiseBuffer = input.setJSON(vList[name]).readBufferArray();\n        arraysPromise.push(promiseBuffer);\n        promiseBuffer.then(cbSetBuffer.bind(node, name));\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(arraysPromise).then(function() {\n        return node;\n    });\n};\n\nosgWrapper.PagedLOD = function(input, plod) {\n    var jsonObj = input.getJSON();\n\n    osgWrapper.Object(input, plod);\n    // Parse center Mode\n    if (jsonObj.CenterMode === 'USE_BOUNDING_SPHERE_CENTER') plod.setCenterMode(0);\n    else if (jsonObj.CenterMode === 'UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED')\n        plod.setCenterMode(2);\n\n    // Parse center and radius\n    plod.setCenter([jsonObj.UserCenter[0], jsonObj.UserCenter[1], jsonObj.UserCenter[2]]);\n    plod.setRadius(jsonObj.UserCenter[3]);\n\n    // Parse RangeMode\n    if (jsonObj.RangeMode === 'PIXEL_SIZE_ON_SCREEN') plod.setRangeMode(1);\n\n    var str;\n\n    // Parse Ranges\n    var o = jsonObj.RangeList;\n\n    for (var i = 0; i < window.Object.keys(o).length; i++) {\n        str = 'Range ' + i;\n        var v = o[str];\n        plod.setRange(i, v[0], v[1]);\n    }\n    // Parse Files\n    o = jsonObj.RangeDataList;\n    for (i = 0; i < window.Object.keys(o).length; i++) {\n        str = 'File ' + i;\n        plod.setFileName(i, o[str]);\n    }\n    // Set database path from options\n    // TODO: Check also if we have a path from json\n    plod.setDatabasePath(input.getDatabasePath());\n\n    var queue = [];\n    // For each url, create a function call and add it to the queue\n    if (jsonObj.Children) {\n        for (var j = 0, k = jsonObj.Children.length; j < k; j++) {\n            queue.push(input.setJSON(jsonObj.Children[j]).readObject());\n        }\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(queue).then(function(queueNodes) {\n        // All the results from P.all are on the argument as an array\n        var len = queueNodes.length;\n        for (i = 0; i < len; i++) plod.addChildNode(queueNodes[i]);\n        return plod;\n    });\n};\n/* harmony default export */ __webpack_exports__[\"a\"] = (osgWrapper);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgWrappers/serializers/osg.js\n// module id = 66\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgWrappers/serializers/osg.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgDB_readerParser__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_requestFile_js__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_notify__ = __webpack_require__(2);\n\n\n\n\n\n\n\n// Drag'n Drop file helper\n// it also holds a list of basic types per extension to do requests.\nvar FileHelper = {\n    readFileList: function(fileList) {\n        var fileName;\n        var filesMap = new window.Map();\n        var promiseArray = [];\n        var i;\n\n        for (i = 0; i < fileList.length; ++i) {\n            var ext = fileList[i].name.substr(fileList[i].name.lastIndexOf('.') + 1);\n            var readerWriter = __WEBPACK_IMPORTED_MODULE_2_osgDB_Registry__[\"a\" /* default */].instance().getReaderWriterForExtension(ext);\n            // We need a hack for osgjs til it is converted to a readerwriter\n            if (readerWriter !== undefined || ext === 'osgjs') {\n                // So this is the main file to read\n                fileName = fileList[i].name;\n            }\n\n            var type = FileHelper.getTypeForExtension(ext);\n            promiseArray.push(\n                Object(__WEBPACK_IMPORTED_MODULE_3_osgDB_requestFile_js__[\"a\" /* default */])(fileList[i], {\n                    responseType: type\n                })\n            );\n        }\n\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promiseArray).then(function(files) {\n            for (i = 0; i < files.length; ++i) {\n                filesMap.set(fileList[i].name, files[i]);\n            }\n\n            return __WEBPACK_IMPORTED_MODULE_1_osgDB_readerParser__[\"default\"].readNodeURL(fileName, {\n                filesMap: filesMap\n            });\n        });\n    },\n\n    // Adds basic types\n    init: function() {\n        FileHelper._typesMap = new window.Map();\n        // Binary\n        FileHelper._typesMap.set('bin', 'arraybuffer');\n        FileHelper._typesMap.set('b3dm', 'arraybuffer');\n        FileHelper._typesMap.set('glb', 'arraybuffer');\n        FileHelper._typesMap.set('zip', 'arraybuffer');\n        // Image\n        FileHelper._typesMap.set('png', 'blob');\n        FileHelper._typesMap.set('jpg', 'blob');\n        FileHelper._typesMap.set('jpeg', 'blob');\n        FileHelper._typesMap.set('gif', 'blob');\n        // Text\n        FileHelper._typesMap.set('json', 'string');\n        FileHelper._typesMap.set('gltf', 'string');\n        FileHelper._typesMap.set('osgjs', 'string');\n    },\n\n    // To add user defined types\n    addTypeForExtension: function(type, extension) {\n        if (!FileHelper._typesMap) FileHelper.init();\n        if (FileHelper._typesMap.get(extension) !== undefined) {\n            __WEBPACK_IMPORTED_MODULE_4_osg_notify__[\"a\" /* default */].warn(\"the '\" + extension + \"' already has a type\");\n        }\n        FileHelper._typesMap.set(extension, type);\n    },\n\n    getTypeForExtension: function(extension) {\n        if (!FileHelper._typesMap) {\n            FileHelper.init();\n        }\n        return this._typesMap.get(extension);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (FileHelper);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/FileHelper.js\n// module id = 67\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/FileHelper.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BoundingSphere__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n// Base class for Camera / User manipulator\nvar Manipulator = function(boundStrategy) {\n    this._boundStrategy = boundStrategy;\n    if (this._boundStrategy === undefined) {\n        this._boundStrategy = Manipulator.COMPUTE_HOME_USING_SPHERE;\n    }\n\n    this._controllerList = {};\n    this._inverseMatrix = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n    this._camera = undefined;\n    this._node = undefined;\n    this._frustum = {};\n    this._computeBoundNodeMaskOverride = ~0x0;\n\n    // for getHomeBoundingSphere\n    this._tmpSphere = new __WEBPACK_IMPORTED_MODULE_1_osg_BoundingSphere__["a" /* default */]();\n};\n\nManipulator.prototype = {\n    setCamera: function(c) {\n        this._camera = c;\n    },\n    getCamera: function() {\n        return this._camera;\n    },\n    setNode: function(node) {\n        this._node = node;\n    },\n    setComputeBoundNodeMaskOverride: function(mask) {\n        this._computeBoundNodeMaskOverride = mask;\n    },\n    getComputeBoundNodeMaskOverride: function() {\n        return this._computeBoundNodeMaskOverride;\n    },\n\n    // overrideStrat should be a bounding volume calculation strategy\n    getHomeBoundingSphere: function(overrideStrat) {\n        var node = this._node;\n        if (!node) return;\n\n        var type = overrideStrat !== undefined ? overrideStrat : this._boundStrategy;\n\n        if (type & Manipulator.COMPUTE_HOME_USING_BBOX) {\n            var box;\n            if (this._computeBoundNodeMaskOverride === ~0x0) {\n                box = node.getBoundingBox();\n            } else {\n                var ComputeBoundsVisitor = __webpack_require__(58).default;\n                var cbv = new ComputeBoundsVisitor();\n                cbv.setNodeMaskOverride(this._computeBoundNodeMaskOverride);\n                cbv.reset();\n\n                cbv.apply(node);\n                box = cbv.getBoundingBox();\n            }\n\n            if (!box.valid()) return node.getBoundingSphere();\n\n            // minimum between sphere and box\n            if (type & Manipulator.COMPUTE_HOME_USING_SPHERE) {\n                var bsphere = node.getBoundingSphere();\n                if (bsphere.valid() && bsphere.volume() < box.volume()) {\n                    return bsphere;\n                }\n            }\n\n            this._tmpSphere.copyBoundingBox(box);\n            return this._tmpSphere;\n        }\n\n        return node.getBoundingSphere();\n    },\n\n    getHomeBound: function(overrideStrat) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'Please use getHomeBoundingSphere instead\');\n        return this.getHomeBoundingSphere(overrideStrat);\n    },\n\n    getHomeDistance: function(bound) {\n        var frustum = this._frustum;\n        var dist = bound.radius();\n        if (this._camera && __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].getFrustum(frustum, this._camera.getProjectionMatrix())) {\n            var vertical2 = Math.abs(frustum.right - frustum.left) / frustum.zNear / 2;\n            var horizontal2 = Math.abs(frustum.top - frustum.bottom) / frustum.zNear / 2;\n            dist /= Math.sin(Math.atan2(horizontal2 < vertical2 ? horizontal2 : vertical2, 1));\n        } else {\n            dist *= 1.5;\n        }\n        return dist;\n    },\n    // eg: var currentTime = nv.getFrameStamp().getSimulationTime();\n    update: function(/*nv*/) {},\n\n    getInverseMatrix: function() {\n        return this._inverseMatrix;\n    },\n\n    getControllerList: function() {\n        return this._controllerList;\n    }\n};\n\n// flags\nManipulator.COMPUTE_HOME_USING_SPHERE = 1 << 0;\nManipulator.COMPUTE_HOME_USING_BBOX = 1 << 1;\n\n/* harmony default export */ __webpack_exports__["a"] = (Manipulator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/Manipulator.js\n// module id = 68\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/Manipulator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgUtil_intersectionEnums__ = __webpack_require__(70);\n\n\nvar Intersector = function() {\n    this._intersections = [];\n    this._primitiveMask = __WEBPACK_IMPORTED_MODULE_0_osgUtil_intersectionEnums__["a" /* default */].ALL_PRIMITIVES;\n    this._intersectionLimit = __WEBPACK_IMPORTED_MODULE_0_osgUtil_intersectionEnums__["a" /* default */].NO_LIMIT;\n};\n\nIntersector.prototype = {\n    reset: function() {\n        this._intersections.length = 0;\n    },\n\n    enter: function(node) {\n        if (this.reachedLimit()) return false;\n        return !node.isCullingActive() || this.intersectNode(node);\n    },\n\n    intersectNode: function(node) {\n        return (\n            this.intersectBoundingSphere(node.getBoundingSphere()) ||\n            this.intersectBoundingBox(node.getBoundingBox())\n        );\n    },\n\n    intersectBoundingSphere: function(/*bsphere*/) {\n        return false;\n    },\n\n    intersectBoundingBox: function(/*bsphere*/) {\n        return false;\n    },\n\n    getIntersections: function() {\n        return this._intersections;\n    },\n\n    setIntersectionLimit: function(limit) {\n        this._intersectionLimit = limit;\n    },\n\n    getIntersectionLimit: function() {\n        return this._intersectionLimit;\n    },\n\n    setPrimitiveMask: function(primitiveMask) {\n        this._primitiveMask = primitiveMask;\n    },\n\n    getPrimitiveMask: function() {\n        return this._primitiveMask;\n    },\n\n    reachedLimit: function() {\n        return (\n            this._intersectionLimit === __WEBPACK_IMPORTED_MODULE_0_osgUtil_intersectionEnums__["a" /* default */].LIMIT_ONE &&\n            this._intersections.length > 0\n        );\n    },\n\n    setCurrentTransformation: function(/*matrix*/) {},\n\n    intersect: function(/*iv, node*/) {}\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (Intersector);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/Intersector.js\n// module id = 69\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/Intersector.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony default export */ __webpack_exports__["a"] = ({\n    NO_LIMIT: 0,\n    LIMIT_ONE_PER_DRAWABLE: 1,\n    LIMIT_ONE: 2,\n\n    // PrimitiveMask\n    POINT_PRIMITIVES: 1 << 0, /// check for points\n    LINE_PRIMITIVES: 1 << 1, /// check for lines\n    TRIANGLE_PRIMITIVES: 1 << 2, /// check for triangles and other primitives like quad, polygons that can be decomposed into triangles\n    ALL_PRIMITIVES: (1 << 0) | (1 << 1) | (1 << 2)\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/intersectionEnums.js\n// module id = 70\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/intersectionEnums.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_primitiveIndexFunctor__ = __webpack_require__(85);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__ = __webpack_require__(70);\n\n\n\n\n\nvar IntersectFunctor = function() {\n    this._hit = false;\n\n    // geom info\n    this._primitiveIndex = 0;\n    this._vertices = undefined;\n    this._geometry = undefined;\n\n    // intersection visitor (nodepath, etc...)\n    this._intersectionVisitor = undefined;\n\n    // intersector stuffs\n    this._intersector = undefined;\n    this._limitOneIntersection = false;\n    this._primitiveMask = __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__["a" /* default */].ALL_PRIMITIVES;\n};\n\n// minimal "interface" for intersection type\nIntersectFunctor.Intersection = function() {\n    this._nodePath = undefined;\n    this._drawable = undefined;\n    this._matrix = undefined;\n    this._primitiveIndex = undefined;\n\n    this._ratio = 0.0;\n    this._backface = false;\n    this._localIntersectionPoint = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n};\n\nIntersectFunctor.prototype = {\n    reset: function() {\n        this._hit = false;\n        this._vertices = undefined;\n        this._primitiveIndex = 0;\n    },\n\n    setPrimitiveIndex: function(primitiveIndex) {\n        this._primitiveIndex = primitiveIndex;\n    },\n    setGeometry: function(geometry) {\n        this._geometry = geometry;\n        this._primitiveIndex = 0;\n        this._vertices = geometry.getAttributes().Vertex.getElements();\n    },\n    setVertices: function(vertices) {\n        this._vertices = vertices;\n    },\n\n    setIntersectionVisitor: function(intersectionVisitor) {\n        this._intersectionVisitor = intersectionVisitor;\n    },\n    setIntersector: function(intersector) {\n        this._intersector = intersector;\n        this._primitiveMask = intersector.getPrimitiveMask();\n\n        var limit = intersector.getIntersectionLimit();\n        this._limitOneIntersection =\n            limit === __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__["a" /* default */].LIMIT_ONE_PER_DRAWABLE ||\n            limit === __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__["a" /* default */].LIMIT_ONE;\n    },\n\n    setLimitOneIntersection: function(limitOneIntersection) {\n        this._limitOneIntersection = limitOneIntersection;\n    },\n\n    leave: function() {},\n\n    enter: function(/*bbox*/) {},\n\n    initIntersection: function(intersection) {\n        intersection._matrix = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].clone(this._intersectionVisitor.getModelMatrix());\n        intersection._nodePath = this._intersectionVisitor.getNodePath().slice();\n        intersection._primitiveIndex = this._primitiveIndex;\n        intersection._drawable = this._geometry;\n        this._intersector.getIntersections().push(intersection);\n        this._hit = true;\n        return intersection;\n    },\n\n    intersectPoint: function(/*v0, p0*/) {},\n    intersectLine: function(/*v0, v1, p0, p1*/) {},\n    intersectTriangle: function(/*v0, v1, v2, p0, p1, p2*/) {},\n\n    operatorPoint: (function() {\n        var v0 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n\n        return function(p0) {\n            if (this._limitOneIntersection && this._hit) return;\n            if ((this._primitiveMask & __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__["a" /* default */].POINT_PRIMITIVES) === 0) return;\n\n            var vertices = this._vertices;\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v0, vertices[3 * p0], vertices[3 * p0 + 1], vertices[3 * p0 + 2]);\n\n            this.intersectPoint(v0, p0);\n            this._primitiveIndex++;\n        };\n    })(),\n\n    operatorLine: (function() {\n        var v0 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n        var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n\n        return function(p0, p1) {\n            if (this._limitOneIntersection && this._hit) return;\n            if ((this._primitiveMask & __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__["a" /* default */].LINE_PRIMITIVES) === 0) return;\n\n            var vertices = this._vertices;\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v0, vertices[3 * p0], vertices[3 * p0 + 1], vertices[3 * p0 + 2]);\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v1, vertices[3 * p1], vertices[3 * p1 + 1], vertices[3 * p1 + 2]);\n\n            this.intersectLine(v0, v1, p0, p1);\n            this._primitiveIndex++;\n        };\n    })(),\n\n    operatorTriangle: (function() {\n        var v0 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n        var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n        var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n\n        return function(p0, p1, p2) {\n            if (this._limitOneIntersection && this._hit) return;\n            if ((this._primitiveMask & __WEBPACK_IMPORTED_MODULE_2_osgUtil_intersectionEnums__["a" /* default */].TRIANGLE_PRIMITIVES) === 0) return;\n\n            var vertices = this._vertices;\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v0, vertices[3 * p0], vertices[3 * p0 + 1], vertices[3 * p0 + 2]);\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v1, vertices[3 * p1], vertices[3 * p1 + 1], vertices[3 * p1 + 2]);\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v2, vertices[3 * p2], vertices[3 * p2 + 1], vertices[3 * p2 + 2]);\n\n            this.intersectTriangle(v0, v1, v2, p0, p1, p2);\n            this._primitiveIndex++;\n        };\n    })(),\n\n    apply: function(node) {\n        if (!node.getAttributes().Vertex) return;\n        Object(__WEBPACK_IMPORTED_MODULE_1_osg_primitiveIndexFunctor__["a" /* default */])(node, this);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (IntersectFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/IntersectFunctor.js\n// module id = 71\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/IntersectFunctor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var DelayInterpolator = function(size, delay) {\n    this._current = new Float32Array(size);\n    this._target = new Float32Array(size);\n    this._delta = new Float32Array(size);\n    this._delay = delay !== undefined ? delay : 0.15;\n    this._reset = false;\n    this._start = 0.0;\n    this.reset();\n};\n\nDelayInterpolator.prototype = {\n    setDelay: function(delay) {\n        this._delay = delay;\n    },\n    reset: function() {\n        for (var i = 0, l = this._current.length; i < l; i++) {\n            this._current[i] = this._target[i] = 0.0;\n        }\n        this._reset = true;\n    },\n    update: function(dt) {\n        // assume 60 fps to be consistent with the old _delay values for backward compatibility\n        // (otherwise we\'d have to adjust the _delay values by multiplying to 60 )\n        var dtDelay = Math.min(1.0, this._delay * dt * 60.0);\n        for (var i = 0, l = this._current.length; i < l; i++) {\n            var d = (this._target[i] - this._current[i]) * dtDelay;\n            this._delta[i] = d;\n            this._current[i] += d;\n        }\n        return this._delta;\n    },\n    set: function() {\n        for (var i = 0, l = this._current.length; i < l; i++) {\n            this._current[i] = this._target[i] = arguments[i];\n        }\n        this._reset = false;\n    },\n    isReset: function() {\n        return this._reset;\n    },\n    getCurrent: function() {\n        return this._current;\n    },\n    setTarget: function() {\n        for (var i = 0, l = this._target.length; i < l; i++) {\n            if (this._reset) {\n                this._target[i] = this._current[i] = arguments[i];\n            } else {\n                this._target[i] = arguments[i];\n            }\n        }\n        this._reset = false;\n    },\n    addTarget: function() {\n        for (var i = 0; i < arguments.length; i++) {\n            this._target[i] += arguments[i];\n        }\n    },\n    getTarget: function() {\n        return this._target;\n    },\n    getDelta: function() {\n        return this._delta;\n    },\n    getStart: function() {\n        return this._start;\n    },\n    setStart: function(start) {\n        this._start = start;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (DelayInterpolator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/DelayInterpolator.js\n// module id = 72\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/DelayInterpolator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\nvar instance = 0;\nvar Node = function() {\n    this._name = 'AbstractNode';\n    this._inputs = [];\n    this._outputs = null;\n\n    // category of node\n    // same name implies same\n    // define/function\n    //this.type = '';\n\n    // uuid: unicity\n    // allows multipe node of same type\n    // declaring multipe code paths\n    // inside the main\n    this._id = instance++;\n\n    this._text = undefined;\n};\n\nNode.prototype = {\n    getID: function() {\n        return this._id;\n    },\n    getName: function() {\n        return this._name;\n    },\n\n    getType: function() {\n        return this.type;\n    },\n\n    toString: function() {\n        var str = 'name : ' + this._name;\n        if (this.type) str += ' (' + this.type + ')';\n        return str;\n    },\n\n    getInputs: function() {\n        return this._inputs;\n    },\n\n    getOutputs: function() {\n        return this._outputs;\n    },\n\n    checkInputsOutputs: function() {\n        var i, key;\n        if (this.validInputs) {\n            for (i = 0; i < this.validInputs.length; i++) {\n                key = this.validInputs[i];\n                if (!this._inputs[key]) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(\n                        'Shader node ' +\n                            this.type +\n                            ' validation error input ' +\n                            key +\n                            ' is missing'\n                    );\n                    return false;\n                }\n            }\n        }\n\n        if (this.validOutputs) {\n            for (i = 0; i < this.validOutputs.length; i++) {\n                key = this.validOutputs[i];\n                if (!this._outputs[key]) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error(\n                        'Shader node ' +\n                            this.type +\n                            ' validation error output ' +\n                            key +\n                            ' is missing'\n                    );\n                    return false;\n                }\n            }\n        }\n\n        return true;\n    },\n\n    // accepts inputs like that:\n    // inputs( [ a, b, c , d] )\n    // inputs( { a: x, b: y } )\n    // inputs( a, b, c, d )\n    inputs: function() {\n        // handle inputs ( a, b, c, d)\n        for (var i = 0, l = arguments.length; i < l; i++) {\n            var input = arguments[i];\n            if (!input) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('Shader node ' + this.type + ' input number ' + l + ' is undefined ');\n                break;\n            }\n\n            // handle inputs( [a, b, c ,d] )\n            if (Array.isArray(input)) {\n                this.inputs.apply(this, input);\n                return this;\n\n                // check for an object {} and not something from base class Node\n            } else if (\n                typeof input === 'object' &&\n                input !== null &&\n                input instanceof Node === false\n            ) {\n                this._inputs = input;\n                return this;\n            } else {\n                // add argument to the array\n                this._inputs.push(input);\n            }\n        }\n\n        return this;\n    },\n\n    // accepts inputs like that:\n    // outputs( { a: x, b: y } )\n    // outputs( a )\n    outputs: function(outputs) {\n        this._outputs = outputs;\n\n        // single output\n        if (this._outputs instanceof Node === true) {\n            this.autoLink(this._outputs);\n        } else {\n            // iterate on objects keys\n            for (var key in this._outputs) {\n                this.autoLink(this._outputs[key]);\n            }\n        }\n\n        return this;\n    },\n\n    autoLink: function(output) {\n        if (output === undefined) return this;\n\n        output.inputs(this);\n\n        return this;\n    },\n\n    computeShader: function() {\n        return this._text;\n    },\n\n    comment: function(txt) {\n        this._comment = '//' + txt;\n    },\n\n    getComment: function() {\n        return this._comment;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Node);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/Node.js\n// module id = 73\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/Node.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Node__ = __webpack_require__(9);\n\n\n\n\n\n\n\n\n/** AutoTransform is a derived form of Transform that automatically\n * scales or rotates to keep its children aligned with screen coordinates.\n * W.r.t. AutorotateModes only rotate to screen is supported right now.\n * More AutorotateModes modes should be addressed in the future.\n * @class AutoTransform\n */\n\nvar AutoTransform = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Transform__["a" /* default */].call(this);\n    this._matrix = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n    this._position = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n    this._matrixDirty = true;\n    this._scale = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 1.0, 1.0);\n    this._minimumScale = 0;\n    this._maximumScale = Number.MAX_VALUE;\n    this._rotation = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].create();\n    this._pivotPoint = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n    this._autoScaleToScreen = false;\n    this._autoRotateToScreen = false;\n    this._cachedMatrix = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n    this._firstTimeToInitEyePoint = true;\n    this._autoScaleTransitionWidthRatio = 0.25;\n    this._billboardAttribute = undefined;\n    this._previousWidth = 0.0;\n    this._previousHeight = 0.0;\n    this._previousProjection = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n    this._previousModelView = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n    this._previousPosition = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n};\n\n/** @lends Autotransform.prototype */\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeNode(\n    AutoTransform,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Transform__["a" /* default */].prototype, {\n        getMatrix: function() {\n            return this._matrix;\n        },\n\n        setMatrix: function(m) {\n            this._matrix = m;\n            this.dirtyBound();\n        },\n\n        setPosition: function(pos) {\n            this._position = pos;\n            this._matrixDirty = true;\n            this.dirtyBound();\n        },\n        getPosition: function() {\n            return this._position;\n        },\n\n        setRotation: function(q) {\n            this._rotation = q;\n            this._matrixDirty = true;\n            this.dirtyBound();\n        },\n\n        getRotation: function() {\n            return this._rotation;\n        },\n\n        setScale: function(scale) {\n            this.setScaleFromVec3(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].fromValues(scale, scale, scale));\n        },\n\n        setScaleFromvec3: function(scaleVec) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'deprecated, use setScaleFromVec3\');\n            this.setScaleFromVec3(scaleVec);\n        },\n\n        setScaleFromVec3: function(scaleVec) {\n            this._scale = scaleVec;\n            this._matrixDirty = true;\n            this.dirtyBound();\n        },\n\n        getScale: function() {\n            return this._scale;\n        },\n\n        setMinimumScale: function(minimumScale) {\n            this._minimumScale = minimumScale;\n        },\n\n        getMinimumScale: function() {\n            return this._minimumScale;\n        },\n\n        setMaximumScale: function(maximumScale) {\n            this._maximumScale = maximumScale;\n        },\n\n        getMaximumScale: function() {\n            return this._maximumScale;\n        },\n\n        setAutoScaleToScreen: function(autoScaleToScreen) {\n            this._autoScaleToScreen = autoScaleToScreen;\n            this._matrixDirty = true;\n        },\n\n        getAutoScaleToScreen: function() {\n            return this._autoScaleToScreen;\n        },\n\n        setAutoRotateToScreen: function(value) {\n            this._autoRotateToScreen = value;\n        },\n\n        getAutoRotateToScreen: function() {\n            return this._autoRotateToScreen;\n        },\n\n        setAutoScaleTransitionWidthRatio: function(autoScaleTransitionWidthRatio) {\n            this._autoScaleTransitionWidthRatio = autoScaleTransitionWidthRatio;\n        },\n\n        getAutoScaleTransitionWidthRatio: function() {\n            return this._autoScaleTransitionWidthRatio;\n        },\n\n        // local to "local world" (not Global World)\n        computeLocalToWorldMatrix: function(matrix /*, nodeVisitor */) {\n            if (this._matrixDirty) this.computeMatrix();\n            if (this.referenceFrame === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, matrix, this._matrix);\n            } else {\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].copy(matrix, this._matrix);\n            }\n        },\n\n        computeMatrix: (function() {\n            var neg = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var tmpMat = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n            return function() {\n                if (!this._matrixDirty) return;\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromQuat(this._matrix, this._rotation);\n\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromTranslation(tmpMat, this._position);\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(this._matrix, tmpMat, this._matrix);\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].scale(this._matrix, this._matrix, this._scale);\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].translate(this._matrix, this._matrix, __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].neg(neg, this._pivotPoint));\n                this._matrixDirty = false;\n            };\n        })(),\n\n        computeWorldToLocalMatrix: (function() {\n            var neg = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var rotInverse = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].create();\n            var scaleInverse = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var tmpMat = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function(matrix /*, nodeVisitor */) {\n                if (this.scale[0] === 0.0 && this.scale[1] === 0.0 && this.scale[2] === 0.0) {\n                    return false;\n                }\n                scaleInverse[0] = 1.0 / this._scale[0];\n                scaleInverse[1] = 1.0 / this._scale[1];\n                scaleInverse[2] = 1.0 / this._scale[2];\n                if (this.referenceFrame === __WEBPACK_IMPORTED_MODULE_5_osg_transformEnums__["a" /* default */].RELATIVE_RF) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromTranslation(tmpMat, __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].neg(neg, this._position));\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, tmpMat, matrix);\n\n                    if (!__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].zeroRotation(this._rotation)) {\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromQuat(tmpMat, __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].invert(rotInverse, this._rotation));\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, tmpMat, matrix);\n                    }\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromScaling(tmpMat, scaleInverse);\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, tmpMat, matrix);\n\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromTranslation(tmpMat, this._pivotPoint);\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, tmpMat, matrix);\n                } else {\n                    // absolute\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromQuat(this._matrix, __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].invert(rotInverse, this._rotation));\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].translate(matrix, matrix, __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].neg(neg, this._position));\n\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromScaling(tmpMat, scaleInverse);\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, tmpMat, matrix);\n\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].fromTranslation(tmpMat, this._pivotPoint);\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(matrix, tmpMat, matrix);\n                }\n                return true;\n            };\n        })(),\n\n        computeBound: (function() {\n            var matrix = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n            return function(bSphere) {\n                if (this._autoScaleToScreen && this._firstTimeToInitEyePoint) return bSphere;\n                __WEBPACK_IMPORTED_MODULE_6_osg_Node__["a" /* default */].prototype.computeBound.call(this, bSphere);\n                if (!bSphere.valid()) {\n                    return bSphere;\n                }\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].identity(matrix);\n                // local to local world (not Global World)\n                this.computeLocalToWorldMatrix(matrix);\n                //Matrix.transformBoundingSphere( matrix, bSphere, bSphere );\n                bSphere.transformMat4(bSphere, matrix);\n                return bSphere;\n            };\n        })(),\n\n        accept: (function() {\n            return function(visitor) {\n                if (visitor.getVisitorType() === __WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__["a" /* default */].CULL_VISITOR) {\n                    var width = visitor.getViewport().width();\n                    var height = visitor.getViewport().height();\n                    var projMat = visitor.getCurrentProjectionMatrix();\n                    var modelViewMat = visitor.getCurrentModelViewMatrix();\n                    var position = this._position;\n                    var doUpdate = this._firstTimeToInitEyePoint;\n                    if (!this._firstTimeToInitEyePoint) {\n                        if (width !== this._previousWidth || height !== this._previousHeight) {\n                            doUpdate = true;\n                        } else if (!__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].exactEquals(projMat, this._previousProjection)) {\n                            doUpdate = true;\n                        } else if (!__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].exactEquals(modelViewMat, this._previousModelView)) {\n                            doUpdate = true;\n                        } else if (!__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].exactEquals(position, this._previousPosition)) {\n                            doUpdate = true;\n                        }\n                    }\n                    this._firstTimeToInitEyePoint = false;\n                    if (doUpdate) {\n                        if (this._autoScaleToScreen) {\n                            var viewport = visitor.getViewport();\n                            var psvector = this.computePixelSizeVector(\n                                viewport,\n                                projMat,\n                                modelViewMat\n                            );\n                            var v = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(\n                                this._position[0],\n                                this._position[1],\n                                this._position[2],\n                                1.0\n                            );\n                            var pixelSize = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].dot(v, psvector);\n                            pixelSize = 0.48 / pixelSize;\n                            var size = 1.0 / pixelSize;\n                            if (this._autoScaleTransitionWidthRatio > 0.0) {\n                                var c, b, a;\n                                if (this._minimumScale > 0.0) {\n                                    var j = this._minimumScale;\n                                    var i =\n                                        this._maximumScale < Number.MAX_VALUE\n                                            ? this._minimumScale +\n                                              (this._maximumScale - this._minimumScale) *\n                                                  this._autoScaleTransitionWidthRatio\n                                            : this._minimumScale *\n                                              (1.0 + this._autoScaleTransitionWidthRatio);\n                                    c = 1.0 / (4.0 * (i - j));\n                                    b = 1.0 - 2.0 * c * i;\n                                    a = j + b * b / (4.0 * c);\n                                    var k = -b / (2.0 * c);\n                                    if (size < k) size = this._minimumScale;\n                                    else if (size < i) size = a + b * size + c * (size * size);\n                                }\n                                if (this._maximumScale < Number.MAX_VALUE) {\n                                    var n = this._maximumScale;\n                                    var m =\n                                        this._minimumScale > 0.0\n                                            ? this._maximumScale +\n                                              (this._minimumScale - this._maximumScale) *\n                                                  this._autoScaleTransitionWidthRatio\n                                            : this._maximumScale *\n                                              (1.0 - this._autoScaleTransitionWidthRatio);\n                                    c = 1.0 / (4.0 * (m - n));\n                                    b = 1.0 - 2.0 * c * m;\n                                    a = n + b * b / (4.0 * c);\n                                    var p = -b / (2.0 * c);\n\n                                    if (size > p) size = this._maximumScale;\n                                    else if (size > m) size = a + b * size + c * (size * size);\n                                }\n                            }\n                            this.setScale(size);\n                        }\n                        if (this._autoRotateToScreen) {\n                            var rotation = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].create();\n                            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].getRotation(rotation, modelViewMat);\n                            this.setRotation(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */].invert(rotation, rotation));\n                        }\n                        this._previousWidth = width;\n                        this._previousHeight = height;\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].copy(this._previousPosition, position);\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].copy(this._previousProjection, projMat);\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].copy(this._previousModelView, modelViewMat);\n                    }\n                }\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_Node__["a" /* default */].prototype.accept.call(this, visitor);\n            };\n        })(),\n\n        computePixelSizeVector: (function() {\n            var scale00 = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var scale10 = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            return function(W, P, M) {\n                // Where W = viewport, P = ProjectionMatrix, M = ModelViewMatrix\n                // Comment from OSG:\n                // pre adjust P00,P20,P23,P33 by multiplying them by the viewport window matrix.\n                // here we do it in short hand with the knowledge of how the window matrix is formed\n                // note P23,P33 are multiplied by an implicit 1 which would come from the window matrix.\n\n                // scaling for horizontal pixels\n                var P00 = P[0] * W.width() * 0.5;\n                var P20_00 = P[8] * W.width() * 0.5 + P[11] * W.width() * 0.5;\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].set(\n                    scale00,\n                    M[0] * P00 + M[2] * P20_00,\n                    M[4] * P00 + M[6] * P20_00,\n                    M[8] * P00 + M[10] * P20_00\n                );\n\n                // scaling for vertical pixels\n                var P10 = P[5] * W.height() * 0.5;\n                var P20_10 = P[9] * W.height() * 0.5 + P[11] * W.height() * 0.5;\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].set(\n                    scale10,\n                    M[1] * P10 + M[2] * P20_10,\n                    M[5] * P10 + M[6] * P20_10,\n                    M[9] * P10 + M[10] * P20_10\n                );\n\n                var P23 = P[11];\n                var P33 = P[15];\n                var pixelSizeVector = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].fromValues(\n                    M[2] * P23,\n                    M[6] * P23,\n                    M[10] * P23,\n                    M[14] * P23 + M[15] * P33\n                );\n\n                var scaleRatio =\n                    0.7071067811 / Math.sqrt(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sqrLen(scale00) + __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sqrLen(scale10));\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].scale(pixelSizeVector, pixelSizeVector, scaleRatio);\n                return pixelSizeVector;\n            };\n        })()\n    }),\n    \'osg\',\n    \'AutoTransform\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (AutoTransform);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/AutoTransform.js\n// module id = 74\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/AutoTransform.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n\n\n\nvar OptionsDefault = {\n    antialias: true, // activate MSAA\n    //'overrideDevicePixelRatio': 1, // if specified override the device pixel ratio\n    fullscreen: true,\n    enableFrustumCulling: false,\n    scrollwheel: true,\n    webgl2: false,\n    powerPreference: 'high-performance',\n    stats: false // display stats, check in osgStats/Stats for all url options\n    // statsFilter=cull;myGroup;webgl filters groups to display\n    // statsFontSize=12 change the size of the fonts default 12\n    // statsShowGraph=1 display graph\n};\n\nvar Options = function() {\n    for (var keyOption in OptionsDefault) {\n        this[keyOption] = OptionsDefault[keyOption];\n    }\n};\n\nvar urlOptions;\nOptions.getOptionsURL = function() {\n    if (urlOptions) return urlOptions;\n\n    urlOptions = {};\n\n    if (!window.location.search) return urlOptions;\n\n    var vars = [];\n    var hash;\n    // slice(1) to remove leading '?'\n    var hashes = window.location.search.slice(1).split('&');\n    for (var i = 0; i < hashes.length; i++) {\n        hash = hashes[i].split('=');\n        var element = hash[0];\n        vars.push(element);\n        var result = hash[1];\n\n        // ideally we should have typed option\n        if (result === '0' || result === 'false') continue;\n        if (result === undefined) result = '1';\n\n        urlOptions[element] = result;\n    }\n\n    if (urlOptions.log !== undefined) {\n        var level = urlOptions.log.toLowerCase();\n\n        switch (level) {\n            case 'debug':\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].setNotifyLevel(__WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].DEBUG);\n                break;\n            case 'info':\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].setNotifyLevel(__WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].INFO);\n                break;\n            case 'notice':\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].setNotifyLevel(__WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].NOTICE);\n                break;\n            case 'warn':\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].setNotifyLevel(__WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].WARN);\n                break;\n            case 'error':\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].setNotifyLevel(__WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].ERROR);\n                break;\n            case 'html':\n                var logContent = [];\n                var divLogger = document.createElement('div');\n                var codeElement = document.createElement('pre');\n                document.addEventListener('DOMContentLoaded', function() {\n                    document.body.appendChild(divLogger);\n                    divLogger.appendChild(codeElement);\n                });\n                var logFunc = function(str) {\n                    logContent.unshift(str);\n                    codeElement.innerHTML = logContent.join('\\n');\n                };\n                divLogger.style.overflow = 'hidden';\n                divLogger.style.position = 'absolute';\n                divLogger.style.zIndex = '10000';\n                divLogger.style.height = '100%';\n                divLogger.style.maxWidth = '600px';\n                codeElement.style.overflow = 'scroll';\n                codeElement.style.width = '105%';\n                codeElement.style.height = '100%';\n                codeElement.style.fontSize = '10px';\n\n                ['log', 'error', 'warn', 'info', 'debug'].forEach(function(value) {\n                    window.console[value] = logFunc;\n                });\n                break;\n        }\n    }\n\n    return urlOptions;\n};\n\nOptions.prototype = {\n    extend: function(options) {\n        __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectMix(this, options);\n        return this;\n    },\n\n    get: function(key) {\n        return this[key];\n    },\n\n    getBoolean: function(key) {\n        var val = this.getString(key);\n        if (val) return val !== 'false' && val !== '0';\n        return undefined;\n    },\n\n    getNumber: function(key) {\n        var val = this[key];\n        if (val) return Number(val);\n        return undefined;\n    },\n\n    getString: function(key) {\n        var val = this[key];\n        if (val !== undefined) return this[key].toString();\n        return undefined;\n    },\n\n    extendWithOptionsURL: function() {\n        this.extend(Options.getOptionsURL());\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Options);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Options.js\n// module id = 75\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Options.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__ = __webpack_require__(13);\n\n\nvar BufferArrayProxy = function(bufferArray) {\n    this._initialBufferArray = undefined;\n    this._bufferArray = undefined;\n    if (bufferArray) {\n        this.setBufferArray(bufferArray);\n        this.setInitialBufferArray(bufferArray);\n    }\n};\n\nvar prototype = {\n    setInitialBufferArray: function(bufferArray) {\n        this._initialBufferArray = bufferArray;\n    },\n    getInitialBufferArray: function() {\n        return this._initialBufferArray;\n    },\n    setBufferArray: function(bufferArray) {\n        this._bufferArray = bufferArray.getBufferArray ? bufferArray.getBufferArray() : bufferArray;\n    },\n    getBufferArray: function() {\n        return this._bufferArray;\n    }\n};\n\n// adds original method of BufferArray prototype for the proxy for convenient usage\nvar makeFunc = function(func) {\n    return function() {\n        return func.apply(this._bufferArray, arguments);\n    };\n};\n\nfor (var methodName in __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__["a" /* default */].prototype) {\n    prototype[methodName] = makeFunc(__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__["a" /* default */].prototype[methodName]);\n}\n\nBufferArrayProxy.prototype = prototype;\n/* harmony default export */ __webpack_exports__["a"] = (BufferArrayProxy);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BufferArrayProxy.js\n// module id = 76\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BufferArrayProxy.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Plane__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__ = __webpack_require__(19);\n\n\n\n\n\n\n/*jshint bitwise: false */\n/**\n * Polytope class for representing convex clipping volumes made up of a set of planes.\n * When adding planes, their normals should point inwards (into the volume)\n * @class Polytope\n */\nvar Polytope = function() {\n    this._clippingMask = 0x0;\n\n    this._planeList = [\n        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create()\n    ];\n    this._vertexList = [];\n\n    // stack of clipping masks\n    this._maskStack = new __WEBPACK_IMPORTED_MODULE_4_osg_PooledArray__["a" /* default */]();\n\n    // init with a clear mask\n    this._resultMask = 0;\n    this._maskStack.push(this._resultMask);\n};\n\n__WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].createPrototypeObject(\n    Polytope,\n    __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osg_Object__["a" /* default */].prototype, {\n        getPlanes: function() {\n            return this._planeList;\n        },\n\n        setPlanes: function(pl) {\n            this._planeList = pl;\n            this.setupMask();\n        },\n\n        clear: function() {\n            this._clippingMask = 0x0;\n            if (this._planeList) {\n                for (var i = 0, l = this._planeList.length; i < l; ++i) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].init(this._planeList[i]);\n                }\n            }\n            this._vertexList = [];\n            this.setupMask();\n        },\n\n        /** Create a Polytope which is a cube, centered at 0,0,0, with sides of 2 units.*/\n        setToUnitFrustum: function(withNear, withFar) {\n            if (withNear === undefined) withNear = true;\n\n            if (withFar === undefined) withFar = true;\n\n            this._planeList.length = 0;\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 1.0, 0.0, 0.0, 1.0)); // left plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), -1.0, 0.0, 0.0, 1.0)); // right plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, 1.0, 0.0, 1.0)); // bottom plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, -1.0, 0.0, 1.0)); // top plane.\n            if (withNear) this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, 0.0, 1.0, 1.0)); // near plane\n            if (withFar) this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, 0.0, -1.0, 1.0)); // far plane\n            this.setupMask();\n        },\n\n        /** Create a Polytope which is a equivalent to BoundingBox.*/\n        setToBoundingBox: function(bb) {\n            this._planeList.length = 0;\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 1.0, 0.0, 0.0, -bb.getMin()[0])); // left plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), -1.0, 0.0, 0.0, bb.getMax()[0])); // right plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, 1.0, 0.0, -bb.getMin()[1])); // bottom plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, -1.0, 0.0, bb.getMax()[1])); // top plane.\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, 0.0, 1.0, -bb.getMin()[2])); // near plane\n            this._planeList.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["g" /* vec4 */].set(__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].create(), 0.0, 0.0, -1.0, bb.getMax()[2])); // far plane\n            this.setupMask();\n        },\n\n        setAndTransformProvidingInverse: function(pt, matrix) {\n            this._referenceVertexList = pt._referenceVertexList;\n            var polytopBackIndex = this._maskStack.getLength() - 1;\n            var resultMask = pt._maskStack[polytopBackIndex];\n            if (resultMask === 0) {\n                this._maskStack.getArray()[polytopBackIndex] = 0;\n                this._resultMask = 0;\n                this._planeList.length = 0;\n                return;\n            }\n            var selectorMask = 0x1;\n\n            var numActivePlanes = 0;\n            // count number of active planes.\n            var i;\n            for (i = 0; i !== pt._planeList.length; ++i) {\n                if (resultMask & selectorMask) ++numActivePlanes;\n                selectorMask <<= 1;\n            }\n\n            this._planeList.length = numActivePlanes;\n            this._resultMask = 0;\n            selectorMask = 0x1;\n            var index = 0;\n            for (i = 0; i !== pt._planeList.length; ++i) {\n                if (resultMask & selectorMask) {\n                    this._planeList[index] = pt._planeList[i];\n                    __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].transformProvidingInverse(this._planeList[index++], matrix);\n                    this._resultMask = (this._resultMask << 1) | 1;\n                }\n                selectorMask <<= 1;\n            }\n\n            this._maskStack.getArray()[polytopBackIndex] = this._resultMask;\n        },\n\n        voidset: function(pl) {\n            this._planeList = pl;\n            this.setupMask();\n        },\n\n        add: function(pl) {\n            this._planeList.push(pl);\n            this.setupMask();\n        },\n\n        empty: function() {\n            return this._planeList.length === 0;\n        },\n\n        setReferenceVertexList: function(vertices) {\n            this._referenceVertexList = vertices;\n        },\n\n        getReferenceVertexList: function() {\n            return this._referenceVertexList;\n        },\n\n        setupMask: function(plength) {\n            this._resultMask = 0;\n            var pMasklength = plength !== undefined ? plength : this._planeList.length;\n            for (var i = 0; i < pMasklength; ++i) {\n                this._resultMask = (this._resultMask << 1) | 1;\n            }\n            this._maskStack.reset();\n            this._maskStack.push(this._resultMask);\n        },\n\n        getCurrentMask: function() {\n            return this._maskStack.back();\n        },\n\n        setResultMask: function(mask) {\n            this._resultMask = mask;\n        },\n\n        getResultMask: function() {\n            return this._resultMask;\n        },\n\n        getMaskStack: function() {\n            return this._maskStack;\n        },\n\n        // push but keep current mask\n        pushCurrentMask: function() {\n            this._maskStack.push(this._resultMask);\n        },\n        // pop and restore previous mask\n        popCurrentMask: function() {\n            return this._maskStack.pop();\n        },\n\n        /** Check whether a vertex is contained within clipping set.*/\n        containsVertex: function(v) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return true;\n\n            var selectorMask = 0x1;\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (\n                    polytopeBack & selectorMask &&\n                    __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].distanceToPlane(this._planeList[i], v) < 0.0\n                ) {\n                    return false;\n                }\n                selectorMask <<= 1;\n            }\n            return true;\n        },\n\n        /** Check whether any part of vertex list is contained within clipping set.*/\n        containsVertices: function(vertices) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return true;\n\n            this._resultMask = polytopeBack;\n\n            for (var k = 0; k < vertices.length; ++k) {\n                var v = vertices[k];\n                var outside = false;\n                var selectorMask = 0x1;\n                for (var i = 0; !outside && i < this._planeList.length; ++i) {\n                    if (\n                        polytopeBack & selectorMask &&\n                        __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].distanceToPlane(this._planeList[i], v) < 0.0\n                    ) {\n                        outside = true;\n                    }\n                    selectorMask <<= 1;\n                }\n\n                if (!outside) return true;\n            }\n            return false;\n        },\n\n        /** Check whether any part of a bounding sphere is contained within clipping set.\n        Using a mask to determine which planes should be used for the check, and\n        modifying the mask to turn off planes which wouldn\'t contribute to clipping\n        of any internal objects.  This feature is used in osgUtil::CullVisitor\n        to prevent redundant plane checking.*/\n        containsBoundingSphere: function(bs) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack || !bs.valid()) return true;\n\n            this._resultMask = polytopeBack;\n            var selectorMask = 0x1;\n\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (this._resultMask & selectorMask) {\n                    var res = __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].intersectsOrContainsBoundingSphere(this._planeList[i], bs);\n                    if (__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].OUTSIDE === res) {\n                        // totally outside a clipping set.\n                        return false;\n                    } else if (__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].INSIDE === res) {\n                        // subsequent checks against this plane not required.\n                        this._resultMask ^= selectorMask;\n                    }\n                    // else if ( Plane.INTERSECT === res ) { // last possible case\n                    //   can say nothing.\n                    // subsequent checks against this plane needed.\n                    //}\n                }\n                selectorMask <<= 1;\n            }\n            return true;\n        },\n\n        /** Check whether any part of a bounding box is contained within clipping set.\n        Using a mask to determine which planes should be used for the check, and\n        modifying the mask to turn off planes which wouldn\'t contribute to clipping\n        of any internal objects.  This feature is used in osgUtil::CullVisitor\n        to prevent redundant plane checking.*/\n        containsBoundingBox: function(bb) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return true;\n\n            this._resultMask = polytopeBack;\n            var selectorMask = 0x1;\n\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (this._resultMask & selectorMask) {\n                    var res = __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].intersectsOrContainsBoundingBox(this._planeList[i], bb);\n                    if (__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].OUTSIDE === res) return false;\n                    else if (__WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].INSIDE === res)\n                        // outside clipping set.\n                        this._resultMask ^= selectorMask; // subsequent checks against this plane not required.\n                    // else if ( Plane.INTERSECT === res ) the last case need\n                    // no test here but further tests\n                }\n                selectorMask <<= 1;\n            }\n            // correct frustum culling should double check now for\n            // http://www.iquilezles.org/www/articles/frustumcorrect/frustumcorrect.htm\n            // which is inside one "plane", but outside the convex plane intersection\n            return true;\n        },\n\n        /** Check whether all of vertex list is contained with clipping set.*/\n        containsAllOfVertices: function(vertices) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return false;\n\n            this._resultMask = polytopeBack;\n            var selectorMask = 0x1;\n\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (this._resultMask & selectorMask) {\n                    var res = __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].intersectsOrContainsVertices(this._planeList[i], vertices);\n                    if (res < 1) return false; // intersects, or is below plane.\n                    this._resultMask ^= selectorMask; // subsequent checks against this plane not required.\n                }\n                selectorMask <<= 1;\n            }\n            return true;\n        },\n\n        /** Check whether the entire bounding sphere is contained within clipping set.*/\n        containsAllOfBoundingSphere: function(bs) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return false;\n\n            this._resultMask = polytopeBack;\n            var selectorMask = 0x1;\n\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (this._resultMask & selectorMask) {\n                    var res = __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].intersectsOrContainsBoundingSphere(this._planeList[i], bs);\n                    if (res < 1) return false; // intersects, or is below plane.\n                    this._resultMask ^= selectorMask; // subsequent checks against this plane not required.\n                }\n                selectorMask <<= 1;\n            }\n            return true;\n        },\n\n        /** Check whether the entire bounding box is contained within clipping set.*/\n        containsAllOfBoundingBox: function(bbox) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return false;\n\n            this._resultMask = polytopeBack;\n            var selectorMask = 0x1;\n\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (this._resultMask & selectorMask) {\n                    var res = __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].intersectsOrContainsBoundingBox(this._planeList[i], bbox);\n                    if (res < 1) return false; // intersects, or is below plane.\n                    this._resultMask ^= selectorMask; // subsequent checks against this plane not required.\n                }\n                selectorMask <<= 1;\n            }\n            return true;\n        },\n\n        /** Transform the clipping set by provide a pre inverted matrix.\n     * see transform for details. */\n        transformProvidingInverse: function(matrix) {\n            var polytopeBack = this._maskStack.back();\n            if (!polytopeBack) return;\n\n            this._resultMask = polytopeBack;\n            var selectorMask = 0x1;\n            for (var i = 0; i < this._planeList.length; ++i) {\n                if (polytopeBack & selectorMask) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_Plane__["a" /* default */].transformProvidingInverse(this._planeList[i], matrix);\n                }\n                selectorMask <<= 1;\n            }\n        }\n    }),\n    \'osg\',\n    \'Polytope\'\n);\n\n/*jshint bitwise: true */\n\n/* harmony default export */ __webpack_exports__["a"] = (Polytope);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Polytope.js\n// module id = 77\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Polytope.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\nvar Projection = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].call(this);\n    this.projection = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Projection,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype, {\n        getProjectionMatrix: function() {\n            return this.projection;\n        },\n        setProjectionMatrix: function(m) {\n            this.projection = m;\n        }\n    }),\n    \'osg\',\n    \'Projection\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Projection);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Projection.js\n// module id = 78\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Projection.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n/**\n *  LightSource is a positioned node to use with StateAttribute Light\n *  @class LightSource\n */\nvar LightSource = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].call(this);\n    this.setCullingActive(false);\n    this._light = undefined;\n    this._referenceFrame = __WEBPACK_IMPORTED_MODULE_2_osg_transformEnums__["a" /* default */].RELATIVE_RF;\n};\n\n/** @lends LightSource.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    LightSource,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype, {\n        getLight: function() {\n            return this._light;\n        },\n        setLight: function(light) {\n            this._light = light;\n        },\n        setReferenceFrame: function(value) {\n            this._referenceFrame = value;\n        },\n        getReferenceFrame: function() {\n            return this._referenceFrame;\n        },\n        computeBoundingSphere: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(bsphere) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.computeBoundingSphere.call(this, bsphere);\n\n                if (\n                    this._light !== undefined &&\n                    this._referenceFrame === __WEBPACK_IMPORTED_MODULE_2_osg_transformEnums__["a" /* default */].RELATIVE_RF\n                ) {\n                    var position = this._light.getPosition();\n\n                    if (position[3] !== 0.0) {\n                        bsphere.expandByVec3(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].scale(tmp, position, 1.0 / position[3]));\n                    }\n                }\n\n                return bsphere;\n            };\n        })()\n    }),\n    \'osg\',\n    \'LightSource\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (LightSource);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/LightSource.js\n// module id = 79\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/LightSource.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_PooledMap__ = __webpack_require__(60);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_PooledResource__ = __webpack_require__(25);\n\n\n\n\n\nvar StateGraph = function() {\n    this._depth = 0;\n    this._children = new __WEBPACK_IMPORTED_MODULE_2_osg_PooledMap__["a" /* default */]();\n    this._leafs = new __WEBPACK_IMPORTED_MODULE_1_osg_PooledArray__["a" /* default */]();\n    this._stateset = undefined;\n    this._parent = undefined;\n};\n\nvar createStateGraph = function() {\n    return new StateGraph();\n};\n\nStateGraph.pooledStateGraph = new __WEBPACK_IMPORTED_MODULE_3_osg_PooledResource__["a" /* default */](createStateGraph);\nStateGraph.statsNbMoveStateGraph = 0;\n\nStateGraph.reset = function() {\n    StateGraph.pooledStateGraph.reset();\n    StateGraph.statsNbMoveStateGraph = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    StateGraph,\n    {\n        clean: function() {\n            this._leafs.reset();\n            this._children.reset();\n            this._depth = 0;\n            this._stateset = undefined;\n            this._parent = undefined;\n        },\n        getStateSet: function() {\n            return this._stateset;\n        },\n        getLeafs: function() {\n            return this._leafs;\n        },\n        getParent: function() {\n            return this._parent;\n        },\n        findOrInsert: function(stateset) {\n            // nb call per frame as example: 22 (shadowmap) 55 (pbr) to 512 (performance)\n            // it\'s called by node that have a stateSet\n            var stateSetID = stateset.getInstanceID();\n            var childrenMap = this._children.getMap();\n            var sg = childrenMap[stateSetID];\n            if (!sg) {\n                sg = StateGraph.pooledStateGraph.getOrCreateObject();\n                sg.clean();\n\n                sg._parent = this;\n                sg._depth = this._depth + 1;\n                sg._stateset = stateset;\n                this._children.set(stateSetID, sg);\n            }\n\n            return sg;\n        }\n    },\n    \'osg\',\n    \'StateGraph\'\n);\n\nStateGraph.moveStateGraph = (function() {\n    var stack = new __WEBPACK_IMPORTED_MODULE_1_osg_PooledArray__["a" /* default */]();\n    var stackArray = stack.getArray();\n    return function(state, sgCurrentArg, sgNewArg) {\n        StateGraph.statsNbMoveStateGraph++;\n        // nb call per frame: 3 (pbr) 10 (shadowmap) 1(performance)\n\n        stack.reset();\n        var sgNew = sgNewArg;\n        var sgCurrent = sgCurrentArg;\n        var i, l;\n        if (sgNew === sgCurrent || sgNew === undefined) return;\n\n        if (sgCurrent === undefined) {\n            // push stateset from sgNew to root, and apply\n            // stateset from root to sgNew\n            do {\n                if (sgNew._stateset !== undefined) {\n                    stack.push(sgNew._stateset);\n                }\n                sgNew = sgNew._parent;\n            } while (sgNew);\n\n            for (i = stack._length - 1, l = 0; i >= l; --i) {\n                state.pushStateSet(stackArray[i]);\n            }\n            return;\n        } else if (sgCurrent._parent === sgNew._parent) {\n            // first handle the typical case which is two state groups\n            // are neighbours.\n\n            // state has changed so need to pop old state.\n            if (sgCurrent._stateset !== undefined) {\n                state.popStateSet();\n            }\n            // and push new state.\n            if (sgNew._stateset !== undefined) {\n                state.pushStateSet(sgNew._stateset);\n            }\n            return;\n        }\n\n        // need to pop back up to the same depth as the new state group.\n        while (sgCurrent._depth > sgNew._depth) {\n            if (sgCurrent._stateset !== undefined) {\n                state.popStateSet();\n            }\n            sgCurrent = sgCurrent._parent;\n        }\n\n        // use return path to trace back steps to sgNew.\n        stack.reset();\n\n        // need to pop back up to the same depth as the curr state group.\n        while (sgNew._depth > sgCurrent._depth) {\n            if (sgNew._stateset !== undefined) {\n                stack.push(sgNew._stateset);\n            }\n            sgNew = sgNew._parent;\n        }\n\n        // now pop back up both parent paths until they agree.\n\n        // DRT - 10/22/02\n        // should be this to conform with above case where two StateGraph\n        // nodes have the same parent\n        while (sgCurrent !== sgNew) {\n            if (sgCurrent._stateset !== undefined) {\n                state.popStateSet();\n            }\n            sgCurrent = sgCurrent._parent;\n\n            if (sgNew._stateset !== undefined) {\n                stack.push(sgNew._stateset);\n            }\n            sgNew = sgNew._parent;\n        }\n\n        for (i = stack._length - 1, l = 0; i >= l; --i) {\n            state.pushStateSet(stackArray[i]);\n        }\n    };\n})();\n\n/* harmony default export */ __webpack_exports__["a"] = (StateGraph);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/StateGraph.js\n// module id = 80\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/StateGraph.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__ = __webpack_require__(61);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_PooledResource__ = __webpack_require__(25);\n\n\n\n\n\n\n\n\n/**\n * From OpenSceneGraph http://www.openscenegraph.org\n * RenderStage base class. Used for encapsulate a complete stage in\n * rendering - setting up of viewport, the projection and model\n * matrices and rendering the RenderBin\'s enclosed with this RenderStage.\n * RenderStage also has a dependency list of other RenderStages, each\n * of which must be called before the rendering of this stage.  These\n * \'pre\' rendering stages are used for advanced rendering techniques\n * like multistage pixel shading or impostors.\n */\nvar RenderStage = function() {\n    __WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__["a" /* default */].call(this);\n    this._clearColor = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].create();\n    this._clearDepth = undefined;\n    this._clearMask = undefined;\n    this._camera = undefined;\n    this._viewport = undefined;\n    this._scissor = undefined;\n    this._preRenderList = [];\n    this._postRenderList = [];\n    // calling prototype to make sure\n    // we call renderstage and not renderbin init\n    RenderStage.prototype.init.call(this);\n};\n\nvar createRenderStageOrder = function() {\n    return {\n        renderStage: null,\n        order: null\n    };\n};\n\nvar pooledRenderStageOrder = new __WEBPACK_IMPORTED_MODULE_6_osg_PooledResource__["a" /* default */](createRenderStageOrder);\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    RenderStage,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__["a" /* default */].prototype, {\n        init: function() {\n            __WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__["a" /* default */].prototype.init.call(this);\n            this._clearDepth = 1.0;\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].set(this._clearColor, 0.0, 0.0, 0.0, 1.0);\n            /*jshint bitwise: false */\n            this._clearMask = __WEBPACK_IMPORTED_MODULE_1_osg_Camera__["a" /* default */].COLOR_BUFFER_BIT | __WEBPACK_IMPORTED_MODULE_1_osg_Camera__["a" /* default */].DEPTH_BUFFER_BIT;\n            /*jshint bitwise: true */\n            this._camera = undefined;\n            this._viewport = undefined;\n            this._scissor = undefined;\n            this._renderStage = this;\n            RenderStage.prototype._initInternal.call(this);\n            return this;\n        },\n\n        _initInternal: function() {\n            this._preRenderList.length = 0;\n            this._postRenderList.length = 0;\n        },\n\n        reset: function() {\n            pooledRenderStageOrder.reset();\n            __WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__["a" /* default */].prototype.reset.call(this);\n            RenderStage.prototype._initInternal.call(this);\n        },\n\n        setClearDepth: function(depth) {\n            this._clearDepth = depth;\n        },\n\n        getClearDepth: function() {\n            return this._clearDepth;\n        },\n\n        setClearColor: function(color) {\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].copy(this._clearColor, color);\n        },\n\n        getClearColor: function() {\n            return this._clearColor;\n        },\n\n        setClearMask: function(mask) {\n            this._clearMask = mask;\n        },\n\n        getClearMask: function() {\n            return this._clearMask;\n        },\n\n        setViewport: function(vp) {\n            this._viewport = vp;\n        },\n\n        getViewport: function() {\n            return this._viewport;\n        },\n\n        setScissor: function(scissor) {\n            this._scissor = scissor;\n        },\n\n        getScissor: function() {\n            return this._scissor;\n        },\n\n        setCamera: function(camera) {\n            this._camera = camera;\n        },\n\n        getCamera: function() {\n            return this._camera;\n        },\n\n        getPreRenderStageList: function() {\n            return this._preRenderList;\n        },\n\n        getPostRenderStageList: function() {\n            return this._postRenderList;\n        },\n\n        addPreRenderStage: function(rs, order) {\n            for (var i = 0, l = this._preRenderList.length; i < l; i++) {\n                var render = this._preRenderList[i];\n                if (order < render.order) {\n                    break;\n                }\n            }\n\n            var renderStageOrder = pooledRenderStageOrder.getOrCreateObject();\n            renderStageOrder.order = order;\n            renderStageOrder.renderStage = rs;\n            if (i < this._preRenderList.length) {\n                this._preRenderList = this._preRenderList.splice(i, 0, renderStageOrder);\n            } else {\n                this._preRenderList.push(renderStageOrder);\n            }\n        },\n\n        addPostRenderStage: function(rs, order) {\n            for (var i = 0, l = this._postRenderList.length; i < l; i++) {\n                var render = this._postRenderList[i];\n                if (order < render.order) {\n                    break;\n                }\n            }\n\n            var renderStageOrder = pooledRenderStageOrder.getOrCreateObject();\n            renderStageOrder.order = order;\n            renderStageOrder.renderStage = rs;\n            if (i < this._postRenderList.length) {\n                this._postRenderList = this._postRenderList.splice(i, 0, renderStageOrder);\n            } else {\n                this._postRenderList.push(renderStageOrder);\n            }\n        },\n\n        drawPreRenderStages: function(state, previousRenderLeaf) {\n            var previousLeaf = previousRenderLeaf;\n            for (var i = 0, l = this._preRenderList.length; i < l; ++i) {\n                var sg = this._preRenderList[i].renderStage;\n                previousLeaf = sg.draw(state, previousLeaf);\n            }\n            return previousLeaf;\n        },\n\n        draw: function(state, previousRenderLeaf) {\n            if (this._camera && this._camera.getInitialDrawCallback()) {\n                // if we have a camera with a final callback invoke it.\n                this._camera.getInitialDrawCallback()(state);\n            }\n\n            var previousLeaf = this.drawPreRenderStages(state, previousRenderLeaf);\n\n            previousLeaf = this.drawImplementation(state, previousLeaf);\n\n            previousLeaf = this.drawPostRenderStages(state, previousLeaf);\n\n            if (this._camera && this._camera.getFinalDrawCallback()) {\n                // if we have a camera with a final callback invoke it.\n                this._camera.getFinalDrawCallback()(state);\n            }\n\n            return previousLeaf;\n        },\n\n        sort: function() {\n            for (var i = 0, l = this._preRenderList.length; i < l; ++i) {\n                this._preRenderList[i].renderStage.sort();\n            }\n\n            __WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__["a" /* default */].prototype.sort.call(this);\n\n            for (var j = 0, k = this._postRenderList.length; j < k; ++j) {\n                this._postRenderList[j].renderStage.sort();\n            }\n        },\n\n        drawPostRenderStages: function(state, previousRenderLeaf) {\n            var previousLeaf = previousRenderLeaf;\n            for (var i = 0, l = this._postRenderList.length; i < l; ++i) {\n                var sg = this._postRenderList[i].renderStage;\n                previousLeaf = sg.draw(state, previousLeaf);\n            }\n            return previousLeaf;\n        },\n\n        applyCamera: function(state) {\n            var gl = state.getGraphicContext();\n            if (this._camera === undefined) {\n                gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n                return;\n            }\n            var viewport = this._camera.getViewport();\n            var fbo = this._camera.frameBufferObject;\n\n            if (!fbo) {\n                fbo = new __WEBPACK_IMPORTED_MODULE_2_osg_FrameBufferObject__["a" /* default */]();\n                this._camera.frameBufferObject = fbo;\n            }\n\n            if (fbo.isDirty()) {\n                var attachments = this._camera.getAttachments();\n\n                // framebuffer texture and renderbuffer must be same dimension\n                // otherwise framebuffer is incomplete\n                var framebufferWidth, framebufferHeight;\n                var colorAttachment = attachments[__WEBPACK_IMPORTED_MODULE_2_osg_FrameBufferObject__["a" /* default */].COLOR_ATTACHMENT0];\n                if (colorAttachment && colorAttachment.texture) {\n                    framebufferWidth = colorAttachment.texture.getWidth();\n                    framebufferHeight = colorAttachment.texture.getHeight();\n                }\n\n                // we should use a map in camera to avoid to regenerate the keys\n                // each time. But because we dont have a lot of camera I guess\n                // it does not change a lot\n                // texture and renderbuffer must be same size.\n                for (var keyAttachment in attachments) {\n                    colorAttachment = attachments[keyAttachment];\n\n                    var attach = {};\n                    attach.attachment = colorAttachment.attachment;\n\n                    if (colorAttachment.texture === undefined) {\n                        //renderbuffer\n\n                        attach.format = colorAttachment.format;\n                        attach.width =\n                            framebufferWidth !== undefined ? framebufferWidth : viewport.width();\n                        attach.height =\n                            framebufferHeight !== undefined ? framebufferHeight : viewport.height();\n                    } else {\n                        attach.texture = colorAttachment.texture;\n                        attach.textureTarget = colorAttachment.textureTarget;\n\n                        if (colorAttachment.format) {\n                            attach.format = colorAttachment.format;\n                        }\n                    }\n\n                    fbo.setAttachment(attach);\n                }\n            }\n            fbo.apply(state);\n        },\n\n        drawImplementation: function(state, previousRenderLeaf) {\n            var gl = state.getGraphicContext();\n\n            this.applyCamera(state);\n\n            // projection clipping\n            if (this._viewport === undefined) {\n                __WEBPACK_IMPORTED_MODULE_3_osg_notify__["a" /* default */].log(\'RenderStage does not have a valid viewport\');\n            }\n            state.applyAttribute(this._viewport);\n\n            if (this._scissor) {\n                state.applyAttribute(this._scissor);\n            }\n\n            if (this._clearMask !== 0x0) {\n                if (this._clearMask & gl.COLOR_BUFFER_BIT) {\n                    state.clearColor(this._clearColor);\n                }\n                if (this._clearMask & gl.DEPTH_BUFFER_BIT) {\n                    state.depthMask(true);\n                    state.clearDepth(this._clearDepth);\n                }\n                state.clear(this._clearMask);\n            }\n\n            if (this._positionedAttribute.getLength() !== 0) {\n                this.applyPositionedAttribute(state, this._positionedAttribute);\n            }\n\n            var previousLeaf = __WEBPACK_IMPORTED_MODULE_4_osg_RenderBin__["a" /* default */].prototype.drawImplementation.call(\n                this,\n                state,\n                previousRenderLeaf\n            );\n\n            return previousLeaf;\n        }\n    }),\n    \'osg\',\n    \'RenderStage\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (RenderStage);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/RenderStage.js\n// module id = 81\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/RenderStage.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_BoundingSphere__ = __webpack_require__(42);\n\n\n\n\n\n\n\n\n/**\n *  Lod that can contains child node\n *  @class Lod\n */\nvar Lod = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].call(this);\n    this._radius = -1;\n    this._range = [];\n    this._rangeMode = Lod.DISTANCE_FROM_EYE_POINT;\n    this._userDefinedCenter = [];\n    this._centerMode = Lod.USE_BOUNDING_SPHERE_CENTER;\n};\n\nLod.DISTANCE_FROM_EYE_POINT = 0;\nLod.PIXEL_SIZE_ON_SCREEN = 1;\n\nLod.USE_BOUNDING_SPHERE_CENTER = 0;\nLod.USER_DEFINED_CENTER = 1;\nLod.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED = 2;\n\n/** @lends Lod.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Lod,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype, {\n        // Functions here\n        getRadius: function() {\n            return this._radius;\n        },\n\n        /** Set the object-space reference radius of the volume enclosed by the LOD.\n     * Used to determine the bounding sphere of the LOD in the absence of any children.*/\n        setRadius: function(radius) {\n            this._radius = radius;\n        },\n\n        setCenter: function(center) {\n            if (this._centerMode !== Lod.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED)\n                this._centerMode = Lod.USER_DEFINED_CENTER;\n            this._userDefinedCenter = center;\n        },\n\n        getCenter: function() {\n            if (\n                this._centerMode === Lod.USER_DEFINED_CENTER ||\n                this._centerMode === Lod.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED\n            )\n                return this._userDefinedCenter;\n            else return this.getBound().center();\n        },\n\n        setCenterMode: function(centerMode) {\n            this._centerMode = centerMode;\n        },\n\n        computeBoundingSphere: function(bsphere) {\n            if (this._centerMode === Lod.USER_DEFINED_CENTER && this._radius >= 0.0) {\n                bsphere.set(this._userDefinedCenter, this._radius);\n                return bsphere;\n            } else if (\n                this._centerMode === Lod.UNION_OF_BOUNDING_SPHERE_AND_USER_DEFINED &&\n                this._radius >= 0.0\n            ) {\n                bsphere.set(this._userDefinedCenter, this._radius);\n                var bs = new __WEBPACK_IMPORTED_MODULE_4_osg_BoundingSphere__["a" /* default */]();\n                bsphere.expandByBoundingSphere(__WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.computeBoundingSphere.call(this, bs));\n                return bsphere;\n            } else {\n                __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.computeBoundingSphere.call(this, bsphere);\n                return bsphere;\n            }\n        },\n\n        projectBoundingSphere: (function() {\n            // from http://www.iquilezles.org/www/articles/sphereproj/sphereproj.htm\n            // Sample code at http://www.shadertoy.com/view/XdBGzd?\n            var o = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            return function(sph, camMatrix, fle) {\n                __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].transformMat4(o, sph.center(), camMatrix);\n                var r2 = sph.radius2();\n                var z2 = o[2] * o[2];\n                var l2 = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].sqrLen(o);\n                var area =\n                    -Math.PI *\n                    fle *\n                    fle *\n                    r2 *\n                    Math.sqrt(Math.abs((l2 - r2) / (r2 - z2))) /\n                    (r2 - z2);\n                return area;\n            };\n        })(),\n\n        setRangeMode: function(mode) {\n            //TODO: check if mode is correct\n            this._rangeMode = mode;\n        },\n\n        addChildNode: function(node) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.addChild.call(this, node);\n            if (this.children.length > this._range.length) {\n                var r = [];\n                var max = 0.0;\n                if (this._range.lenght > 0) max = this._range[this._range.length - 1][1];\n                r.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["e" /* vec2 */].fromValues(max, max));\n                this._range.push(r);\n            }\n            return true;\n        },\n\n        addChild: function(node, min, max) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.addChild.call(this, node);\n\n            if (this.children.length > this._range.length) {\n                var r = [];\n                r.push(__WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["e" /* vec2 */].fromValues(min, min));\n                this._range.push(r);\n            }\n            this._range[this.children.length - 1][0] = min;\n            this._range[this.children.length - 1][1] = max;\n            return true;\n        },\n\n        traverse: (function() {\n            // avoid to generate variable on the heap to limit garbage collection\n            // instead create variable and use the same each time\n            var zeroVector = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var eye = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var viewModel = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function(visitor) {\n                var traversalMode = visitor.traversalMode;\n\n                switch (traversalMode) {\n                    case __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN:\n                        for (var index = 0; index < this.children.length; index++) {\n                            this.children[index].accept(visitor);\n                        }\n                        break;\n\n                    case __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ACTIVE_CHILDREN:\n                        var requiredRange = 0;\n                        var matrix = visitor.getCurrentModelViewMatrix();\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].invert(viewModel, matrix);\n                        // Calculate distance from viewpoint\n                        if (this._rangeMode === Lod.DISTANCE_FROM_EYE_POINT) {\n                            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].transformMat4(eye, zeroVector, viewModel);\n                            var d = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].distance(this.getBound().center(), eye);\n                            requiredRange = d * visitor.getLODScale();\n                        } else {\n                            // Let\'s calculate pixels on screen\n                            var projmatrix = visitor.getCurrentProjectionMatrix();\n                            // focal lenght is the value stored in projmatrix[0]\n                            requiredRange = this.projectBoundingSphere(\n                                this.getBound(),\n                                matrix,\n                                projmatrix[0]\n                            );\n                            // Multiply by a factor to get the real area value\n                            requiredRange =\n                                requiredRange *\n                                visitor.getViewport().width() *\n                                visitor.getViewport().width() *\n                                0.25 /\n                                visitor.getLODScale();\n                        }\n\n                        var numChildren = this.children.length;\n                        if (this._range.length < numChildren) numChildren = this._range.length;\n\n                        for (var j = 0; j < numChildren; ++j) {\n                            if (\n                                this._range[j][0] <= requiredRange &&\n                                requiredRange < this._range[j][1]\n                            ) {\n                                this.children[j].accept(visitor);\n                            }\n                        }\n                        break;\n\n                    default:\n                        break;\n                }\n            };\n        })()\n    }),\n    \'osg\',\n    \'Lod\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Lod);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Lod.js\n// module id = 82\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Lod.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Lod__ = __webpack_require__(82);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n\n/**\n *  PagedLOD that can contains paged child nodes\n *  @class PagedLod\n */\nvar PagedLOD = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].call(this);\n    this._perRangeDataList = [];\n    this._loading = false;\n    this._expiryTime = 0.0;\n    this._expiryFrame = 0;\n    this._centerMode = __WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].USER_DEFINED_CENTER;\n    this._frameNumberOfLastTraversal = 0;\n    this._databasePath = \'\';\n    this._numChildrenThatCannotBeExpired = 0;\n};\n\n/**\n *  PerRangeData utility structure to store per range values\n *  @class PerRangeData\n */\nvar PerRangeData = function() {\n    this.filename = \'\';\n    this.function = undefined;\n    this.loaded = false;\n    this.timeStamp = 0.0;\n    this.frameNumber = 0;\n    this.frameNumberOfLastTraversal = 0;\n    this.dbrequest = undefined;\n};\n\n/** @lends PagedLOD.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    PagedLOD,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].prototype, {\n        // Functions here\n        setRange: function(childNo, min, max) {\n            if (childNo >= this._range.length) {\n                var r = [];\n                r.push([min, min]);\n                this._range.push(r);\n            }\n            this._range[childNo][0] = min;\n            this._range[childNo][1] = max;\n        },\n\n        setExpiryTime: function(expiryTime) {\n            this._expiryTime = expiryTime;\n        },\n\n        setDatabasePath: function(path) {\n            this._databasePath = path;\n        },\n\n        getDatabasePath: function() {\n            return this._databasePath;\n        },\n\n        setFileName: function(childNo, filename) {\n            // May we should expand the vector first?\n            if (childNo >= this._perRangeDataList.length) {\n                var rd = new PerRangeData();\n                rd.filename = filename;\n                this._perRangeDataList.push(rd);\n            } else {\n                this._perRangeDataList[childNo].filename = filename;\n            }\n        },\n        setFunction: function(childNo, func) {\n            if (childNo >= this._perRangeDataList.length) {\n                var rd = new PerRangeData();\n                rd.function = func;\n                this._perRangeDataList.push(rd);\n            } else {\n                this._perRangeDataList[childNo].function = func;\n            }\n        },\n\n        addChild: function(node, min, max) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].prototype.addChild.call(this, node, min, max);\n            this._perRangeDataList.push(new PerRangeData());\n        },\n\n        addChildNode: function(node) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].prototype.addChildNode.call(this, node);\n        },\n\n        setFrameNumberOfLastTraversal: function(frameNumber) {\n            this._frameNumberOfLastTraversal = frameNumber;\n        },\n\n        getFrameNumberOfLastTraversal: function() {\n            return this._frameNumberOfLastTraversal;\n        },\n        setTimeStamp: function(childNo, timeStamp) {\n            this._perRangeDataList[childNo].timeStamp = timeStamp;\n        },\n        setFrameNumber: function(childNo, frameNumber) {\n            this._perRangeDataList[childNo].frameNumber = frameNumber;\n        },\n        setNumChildrenThatCannotBeExpired: function(num) {\n            this._numChildrenThatCannotBeExpired = num;\n        },\n        getNumChildrenThatCannotBeExpired: function() {\n            return this._numChildrenThatCannotBeExpired;\n        },\n        getDatabaseRequest: function(childNo) {\n            return this._perRangeDataList[childNo].dbrequest;\n        },\n        removeExpiredChildren: function(expiryTime, expiryFrame, removedChildren) {\n            if (this.children.length <= this._numChildrenThatCannotBeExpired) return;\n            var i = this.children.length - 1;\n            var timed, framed;\n            timed = this._perRangeDataList[i].timeStamp + this._expiryTime;\n            framed = this._perRangeDataList[i].frameNumber + this._expiryFrame;\n            if (\n                timed < expiryTime &&\n                framed < expiryFrame &&\n                (this._perRangeDataList[i].filename.length > 0 ||\n                    this._perRangeDataList[i].function !== undefined)\n            ) {\n                removedChildren.push(this.children[i]);\n                this.removeChild(this.children[i]);\n                this._perRangeDataList[i].loaded = false;\n                if (this._perRangeDataList[i].dbrequest !== undefined) {\n                    this._perRangeDataList[i].dbrequest._groupExpired = true;\n                }\n            }\n        },\n\n        traverse: (function() {\n            // avoid to generate variable on the heap to limit garbage collection\n            // instead create variable and use the same each time\n            var zeroVector = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var eye = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].create();\n            var viewModel = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function(visitor) {\n                var traversalMode = visitor.traversalMode;\n                var updateTimeStamp = false;\n\n                if (visitor.getVisitorType() === __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].CULL_VISITOR) {\n                    this._frameNumberOfLastTraversal = visitor.getFrameStamp().getFrameNumber();\n                    updateTimeStamp = true;\n                }\n\n                switch (traversalMode) {\n                    case __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN:\n                        for (var index = 0; index < this.children.length; index++) {\n                            this.children[index].accept(visitor);\n                        }\n                        break;\n\n                    case __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ACTIVE_CHILDREN:\n                        var requiredRange = 0;\n\n                        // Calculate distance from viewpoint\n                        var matrix = visitor.getCurrentModelViewMatrix();\n                        __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].invert(viewModel, matrix);\n                        if (this._rangeMode === __WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].DISTANCE_FROM_EYE_POINT) {\n                            __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].transformMat4(eye, zeroVector, viewModel);\n                            var d = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */].distance(this.getBound().center(), eye);\n                            requiredRange = d * visitor.getLODScale();\n                        } else {\n                            // Calculate pixels on screen\n                            var projmatrix = visitor.getCurrentProjectionMatrix();\n                            // focal lenght is the value stored in projmatrix[0]\n                            requiredRange = this.projectBoundingSphere(\n                                this.getBound(),\n                                matrix,\n                                projmatrix[0]\n                            );\n                            // Get the real area value and apply LODScale\n                            requiredRange =\n                                requiredRange *\n                                visitor.getViewport().width() *\n                                visitor.getViewport().width() *\n                                0.25 /\n                                visitor.getLODScale();\n                            if (requiredRange < 0)\n                                requiredRange = this._range[this._range.length - 1][0];\n                        }\n\n                        var needToLoadChild = false;\n                        var lastChildTraversed = -1;\n                        for (var j = 0; j < this._range.length; ++j) {\n                            if (\n                                this._range[j][0] <= requiredRange &&\n                                requiredRange < this._range[j][1]\n                            ) {\n                                if (j < this.children.length) {\n                                    if (updateTimeStamp) {\n                                        this._perRangeDataList[\n                                            j\n                                        ].timeStamp = visitor.getFrameStamp().getSimulationTime();\n                                        this._perRangeDataList[\n                                            j\n                                        ].frameNumber = visitor.getFrameStamp().getFrameNumber();\n                                    }\n\n                                    this.children[j].accept(visitor);\n                                    lastChildTraversed = j;\n                                } else {\n                                    needToLoadChild = true;\n                                }\n                            }\n                        }\n                        if (needToLoadChild) {\n                            var numChildren = this.children.length;\n                            if (numChildren > 0 && numChildren - 1 !== lastChildTraversed) {\n                                if (updateTimeStamp) {\n                                    this._perRangeDataList[\n                                        numChildren - 1\n                                    ].timeStamp = visitor.getFrameStamp().getSimulationTime();\n                                    this._perRangeDataList[\n                                        numChildren - 1\n                                    ].frameNumber = visitor.getFrameStamp().getFrameNumber();\n                                }\n\n                                this.children[numChildren - 1].accept(visitor);\n                            }\n                            // now request the loading of the next unloaded child.\n                            if (numChildren < this._perRangeDataList.length) {\n                                // compute priority from where abouts in the required range the distance falls.\n\n                                // $$ SOURCE_CODE_MODIFIED\n                                var priority =\n                                    (this._range[numChildren][0] - requiredRange) /\n                                    (this._range[numChildren][1] - this._range[numChildren][0]);\n                                // var priority = requiredRange;\n                                // $$ SOURCE_CODE_MODIFIED\n\n                                if (this._rangeMode === __WEBPACK_IMPORTED_MODULE_1_osg_Lod__["a" /* default */].PIXEL_SIZE_ON_SCREEN) {\n                                    priority = -priority;\n                                }\n                                // Here we do the request\n                                var group = visitor.nodePath[visitor.nodePath.length - 1];\n                                if (this._perRangeDataList[numChildren].loaded === false) {\n                                    this._perRangeDataList[numChildren].loaded = true;\n                                    var dbhandler = visitor.getDatabaseRequestHandler();\n                                    this._perRangeDataList[\n                                        numChildren\n                                    ].dbrequest = dbhandler.requestNodeFile(\n                                        this._perRangeDataList[numChildren].function,\n                                        this._databasePath +\n                                            this._perRangeDataList[numChildren].filename,\n                                        group,\n                                        visitor.getFrameStamp().getSimulationTime(),\n                                        priority\n                                    );\n                                } else {\n                                    // Update timestamp of the request.\n                                    if (\n                                        this._perRangeDataList[numChildren].dbrequest !== undefined\n                                    ) {\n                                        this._perRangeDataList[\n                                            numChildren\n                                        ].dbrequest._timeStamp = visitor\n                                            .getFrameStamp()\n                                            .getSimulationTime();\n                                        this._perRangeDataList[\n                                            numChildren\n                                        ].dbrequest._priority = priority;\n                                    } else {\n                                        // The DB request is undefined, so the DBPager was not accepting requests, we need to ask for the child again.\n                                        this._perRangeDataList[numChildren].loaded = false;\n                                    }\n                                }\n                            }\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            };\n        })()\n    }),\n    \'osg\',\n    \'PagedLOD\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (PagedLOD);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/PagedLOD.js\n// module id = 83\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/PagedLOD.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_UpdateMatrixTransform__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__ = __webpack_require__(3);\n\n\n\n\n\n\n/**\n *  UpdateBone\n *  @class UpdateBone\n */\nvar UpdateBone = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgAnimation_UpdateMatrixTransform__["a" /* default */].call(this);\n};\n\n/** @lends UpdateBone.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    UpdateBone,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgAnimation_UpdateMatrixTransform__["a" /* default */].prototype, {\n        update: function(node, nv) {\n            if (nv.getVisitorType() === __WEBPACK_IMPORTED_MODULE_4_osg_NodeVisitor__["a" /* default */].UPDATE_VISITOR) {\n                if (node.className && node.className() !== \'Bone\') {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\'Warning: UpdateBone set on non-Bone object.\');\n                    return false;\n                }\n\n                var bone = node;\n\n                __WEBPACK_IMPORTED_MODULE_2_osgAnimation_UpdateMatrixTransform__["a" /* default */].prototype.update.call(this, node);\n                bone.setMatrix(bone.getMatrix());\n                var matrix = bone.getMatrix();\n                var parent = bone.getBoneParent();\n\n                if (parent) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */].mul(\n                        bone.getMatrixInSkeletonSpace(),\n                        parent.getMatrixInSkeletonSpace(),\n                        matrix\n                    );\n                } else {\n                    bone.setMatrixInSkeletonSpace(matrix);\n                }\n            }\n            return true;\n        }\n    }),\n    \'osgAnimation\',\n    \'UpdateBone\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (UpdateBone);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/UpdateBone.js\n// module id = 84\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/UpdateBone.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_DrawArrays__ = __webpack_require__(17);\n\n\n\n\n/**\n * PrimitiveIndexFunctor emulates the TemplatePrimitiveIndexFunctor class in OSG and can\n * be used to get access to the vertices that compose the things drawn by osgjs.\n *\n * You have to feed it with an object that references 3 callbacks :\n *\n * var myObject = {\n *     operatorPoint : function ( v ) { }, // Do your point operations here\n *     operatorLine : function ( v1, v2 ){ }, // Do you line operations here\n *     operatorTriangle : function ( v1, v2, v3 ) { } // Do your triangle operations here\n * };\n *\n */\n\nvar functorDrawElements = [];\nvar functorDrawArrays = [];\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLES] = function(offset, count, indexes, cb) {\n    var end = offset + count;\n    for (var i = offset; i < end; i += 3) {\n        cb.operatorTriangle(indexes[i], indexes[i + 1], indexes[i + 2]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP] = function(offset, count, indexes, cb) {\n    for (var i = 2, j = offset; i < count; ++i, ++j) {\n        if (i % 2) cb.operatorTriangle(indexes[j], indexes[j + 2], indexes[j + 1]);\n        else cb.operatorTriangle(indexes[j], indexes[j + 1], indexes[j + 2]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN] = function(offset, count, indexes, cb) {\n    var first = indexes[offset];\n    for (var i = 2, j = offset + 1; i < count; ++i, ++j) {\n        cb.operatorTriangle(first, indexes[j], indexes[j + 1]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].POINTS] = function(offset, count, indexes, cb) {\n    var end = offset + count;\n    for (var i = offset; i < end; ++i) {\n        cb.operatorPoint(indexes[i]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].LINES] = function(offset, count, indexes, cb) {\n    var end = offset + count;\n    for (var i = offset; i < end; i += 2) {\n        cb.operatorLine(indexes[i], indexes[i + 1]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].LINE_STRIP] = function(offset, count, indexes, cb) {\n    var end = offset + count;\n    for (var i = offset; i < end; ++i) {\n        cb.operatorLine(indexes[i], indexes[i + 1]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].LINE_LOOP] = function(offset, count, indexes, cb) {\n    var end = offset + count;\n    for (var i = offset; i < end; ++i) {\n        cb.operatorLine(indexes[i], indexes[i + 1]);\n    }\n    cb.operatorLine(indexes[indexes.length - 1], indexes[0]);\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLES] = function(first, count, cb) {\n    for (var i = 2, pos = first; i < count; i += 3, pos += 3) {\n        cb.operatorTriangle(pos, pos + 1, pos + 2);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP] = function(first, count, cb) {\n    for (var i = 2, pos = first; i < count; ++i, ++pos) {\n        if (i % 2) cb.operatorTriangle(pos, pos + 2, pos + 1);\n        else cb.operatorTriangle(pos, pos + 1, pos + 2);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN] = function(first, count, cb) {\n    for (var i = 2, pos = first + 1; i < count; ++i, ++pos) {\n        cb.operatorTriangle(first, pos, pos + 1);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].POINTS] = function(first, count, cb) {\n    for (var i = 0, pos = first; i < count; ++i, ++pos) {\n        cb.operatorPoint(pos);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].LINES] = function(first, count, cb) {\n    for (var i = 1, pos = first; i < count; i += 2, pos += 2) {\n        cb.operatorLine(pos, pos + 1);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].LINE_STRIP] = function(first, count, cb) {\n    for (var i = 1, pos = first; i < count; ++i, ++pos) {\n        cb.operatorLine(pos, pos + 1);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].LINE_LOOP] = function(first, count, cb) {\n    for (var i = 1, pos = first; i < count; ++i, ++pos) {\n        cb.operatorLine(pos, pos + 1);\n    }\n    cb.operatorLine(first + count - 1, first);\n};\n\nvar primitiveIndexFunctor = function(geom, cb) {\n    var primitives = geom.getPrimitiveSetList();\n    if (!primitives) return;\n\n    var cbFunctor;\n\n    var nbPrimitives = primitives.length;\n    for (var i = 0; i < nbPrimitives; i++) {\n        var primitive = primitives[i];\n        if (primitive instanceof __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__["a" /* default */]) {\n            cbFunctor = functorDrawElements[primitive.getMode()];\n            if (cbFunctor) {\n                var indexes = primitive.indices.getElements();\n                cbFunctor(\n                    primitive.getFirst() / indexes.BYTES_PER_ELEMENT,\n                    primitive.getCount(),\n                    indexes,\n                    cb\n                );\n            }\n        } else if (primitive instanceof __WEBPACK_IMPORTED_MODULE_2_osg_DrawArrays__["a" /* default */]) {\n            cbFunctor = functorDrawArrays[primitive.getMode()];\n            if (cbFunctor) {\n                cbFunctor(primitive.getFirst(), primitive.getCount(), cb);\n            }\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (primitiveIndexFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/primitiveIndexFunctor.js\n// module id = 85\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/primitiveIndexFunctor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__ = __webpack_require__(6);\n\n\n\n\n\n// Define a material attribute\nvar Material = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this._ambient = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(0.2, 0.2, 0.2, 1.0);\n    this._diffuse = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(0.8, 0.8, 0.8, 1.0);\n    this._specular = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 0.0, 1.0);\n    this._emission = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 0.0, 1.0);\n    this._shininess = 12.5;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    Material,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Material\',\n\n        cloneType: function() {\n            return new Material();\n        },\n\n        getParameterName: function(name) {\n            return \'u\' + this.getType() + \'_\' + name;\n        },\n\n        getOrCreateUniforms: function() {\n            var obj = Material;\n            if (obj.uniforms) return obj.uniforms;\n\n            obj.uniforms = {\n                ambient: __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__["a" /* default */].createFloat4(\'uMaterialAmbient\'),\n                diffuse: __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__["a" /* default */].createFloat4(\'uMaterialDiffuse\'),\n                specular: __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__["a" /* default */].createFloat4(\'uMaterialSpecular\'),\n                emission: __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__["a" /* default */].createFloat4(\'uMaterialEmission\'),\n                shininess: __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__["a" /* default */].createFloat1(\'uMaterialShininess\')\n            };\n\n            return obj.uniforms;\n        },\n\n        setEmission: function(a) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].copy(this._emission, a);\n        },\n\n        getEmission: function() {\n            return this._emission;\n        },\n\n        setAmbient: function(a) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].copy(this._ambient, a);\n        },\n\n        getAmbient: function() {\n            return this._ambient;\n        },\n\n        setSpecular: function(a) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].copy(this._specular, a);\n        },\n\n        getSpecular: function() {\n            return this._specular;\n        },\n\n        setDiffuse: function(a) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].copy(this._diffuse, a);\n        },\n\n        getDiffuse: function() {\n            return this._diffuse;\n        },\n\n        setShininess: function(a) {\n            this._shininess = a;\n        },\n\n        getShininess: function() {\n            return this._shininess;\n        },\n\n        setTransparency: function(a) {\n            this._diffuse[3] = 1.0 - a;\n        },\n\n        getTransparency: function() {\n            return this._diffuse[3];\n        },\n\n        apply: function() {\n            var uniforms = this.getOrCreateUniforms();\n\n            uniforms.ambient.setFloat4(this._ambient);\n            uniforms.diffuse.setFloat4(this._diffuse);\n            uniforms.specular.setFloat4(this._specular);\n            uniforms.emission.setFloat4(this._emission);\n            uniforms.shininess.setFloat(this._shininess);\n        }\n    }),\n    \'osg\',\n    \'Material\'\n);\n\n/* harmony default export */ __webpack_exports__["default"] = (Material);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Material.js\n// module id = 86\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Material.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\nvar Scissor = function(x, y, w, h) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n\n    this._x = x !== undefined ? x : -1;\n    this._y = y !== undefined ? y : -1;\n    this._width = w !== undefined ? w : -1;\n\n    this._height = h !== undefined ? h : -1;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    Scissor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Scissor\',\n\n        cloneType: function() {\n            return new Scissor();\n        },\n\n        setScissor: function(x, y, width, height) {\n            this._x = x;\n            this._y = y;\n            this._width = width;\n            this._height = height;\n        },\n\n        x: function() {\n            return this._x;\n        },\n\n        y: function() {\n            return this._y;\n        },\n\n        width: function() {\n            return this._width;\n        },\n\n        height: function() {\n            return this._height;\n        },\n\n        apply: function(state) {\n            state.applyScissor(this);\n        }\n    }),\n    \'osg\',\n    \'Scissor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Scissor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Scissor.js\n// module id = 87\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Scissor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_RigGeometry__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_AnimationUpdateCallback__ = __webpack_require__(52);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_target__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n\n\n\n\n\n\n\nvar UpdateMorph = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osgAnimation_AnimationUpdateCallback__["a" /* default */].call(this);\n\n    this._targets = []; // float target\n    this._targetNames = []; // names of targets\n    this._morphs = []; // the update morph can update several morphs\n\n    this._weights = new Float32Array(__WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */].MAX_MORPH_GPU);\n    // stuffs to handles > max morph gpu targets\n    this._indexMap = new Uint32Array(__WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */].MAX_MORPH_GPU); // we map VA to the last gpu morphed VA targets\n    this._gpuMorphed = []; // size of this._targets, for each target a bool states if it\'s gpu morphed or not\n\n    this._maxMorphGPU = -1;\n};\n\n// for sorting\nvar funcWeights = function(a, b) {\n    return Math.abs(b.value) - Math.abs(a.value);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    UpdateMorph,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osgAnimation_AnimationUpdateCallback__["a" /* default */].prototype, {\n        init: function(node) {\n            this._maxMorphGPU = __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */].MAX_MORPH_GPU;\n            this._morphs.length = 0;\n\n            //Find the morph geometry & init it\n            var children = node.getChildren();\n            for (var i = 0, l = children.length; i < l; i++) {\n                var geom = children[i];\n                var morph;\n                if (geom instanceof __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */]) {\n                    morph = geom;\n                } else if (\n                    geom instanceof __WEBPACK_IMPORTED_MODULE_2_osgAnimation_RigGeometry__["a" /* default */] &&\n                    geom.getSourceGeometry() instanceof __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */]\n                ) {\n                    morph = geom.getSourceGeometry();\n                }\n\n                if (!morph) continue;\n\n                if (morph.getName() === this.getName()) {\n                    if (!morph.isInitialized()) morph.init();\n\n                    this._morphs.push(morph);\n                    this._maxMorphGPU = Math.min(\n                        this._maxMorphGPU,\n                        morph.getMaximumPossibleMorphGPU()\n                    );\n                }\n            }\n        },\n\n        isInitialized: function() {\n            var morphs = this._morphs;\n            var nbMorphs = morphs.length;\n            if (!nbMorphs) return false;\n\n            for (var i = 0; i < nbMorphs; ++i) {\n                if (!morphs[i].isInitialized()) return false;\n            }\n\n            return true;\n        },\n\n        getNumTarget: function() {\n            return this._targets.length;\n        },\n\n        getTarget: function(index) {\n            return this._targets[index];\n        },\n\n        getTargetName: function(index) {\n            return this._targetNames[index];\n        },\n\n        addTarget: function(name, index) {\n            this._targets[index] = __WEBPACK_IMPORTED_MODULE_4_osgAnimation_target__["a" /* default */].createFloatTarget(0);\n            this._targetNames[index] = name;\n        },\n\n        _remapBufferArrays: function() {\n            // basically, this function remaps all the active morphed VA to the 4th first morphTargets VA\n            var indexMap = this._indexMap;\n            var morphs = this._morphs;\n            for (var i = 0; i < this._maxMorphGPU; ++i) {\n                var index = indexMap[i];\n                var strI = \'_\' + i;\n                var strIndex = \'_\' + index;\n\n                for (var j = 0, nbMorphs = morphs.length; j < nbMorphs; ++j) {\n                    var morph = morphs[j];\n                    var vAttrs = morph.getVertexAttributeList();\n                    var morphNames = morph.getMorphTargetNames();\n                    for (var k = 0, nbNames = morphNames.length; k < nbNames; ++k) {\n                        var attName = morphNames[k];\n                        vAttrs[attName + strI].setBufferArray(\n                            vAttrs[attName + strIndex].getInitialBufferArray()\n                        );\n                    }\n                }\n            }\n        },\n\n        _mergeExtraMorphTarget: function(attrs, attName, extraWeightSum) {\n            var i = 0;\n            // ignore the gpu morphed\n            var gpuMorphed = this._gpuMorphed;\n            var vAttr = attrs[attName];\n            var vertexLen = vAttr.getElements().length;\n            var nbVertex = vertexLen / vAttr.getItemSize();\n            var itemSize = vAttr.getItemSize();\n\n            vAttr._cpuMorph =\n                vAttr._cpuMorph ||\n                new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, new Float32Array(vertexLen), itemSize);\n            var morphExtraTargets = vAttr._cpuMorph.getElements();\n            for (i = 0; i < vertexLen; ++i) {\n                morphExtraTargets[i] = 0.0;\n            }\n\n            var targets = this._targets;\n            for (var j = 0, nb = targets.length; j < nb; ++j) {\n                // ignore gpu morphed targets\n                if (gpuMorphed[j] === true) continue;\n\n                var weight = targets[j].value;\n                if (Math.abs(weight) <= __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */].EFFECTIVE_EPS) continue;\n\n                weight /= extraWeightSum;\n\n                var morphElts = attrs[attName + \'_\' + j].getInitialBufferArray().getElements();\n                for (i = 0; i < nbVertex; ++i) {\n                    var k = i * itemSize;\n                    morphExtraTargets[k] += weight * morphElts[k];\n                    morphExtraTargets[k + 1] += weight * morphElts[k + 1];\n                    morphExtraTargets[k + 2] += weight * morphElts[k + 2];\n                    // don\'t morph tangent w component\n                }\n            }\n\n            // map on last index target\n            attrs[attName + \'_\' + (this._maxMorphGPU - 1)].setBufferArray(vAttr._cpuMorph);\n            vAttr._cpuMorph.dirty();\n        },\n\n        _computeExtraWeightsSum: function() {\n            var gpuMorphed = this._gpuMorphed;\n            var sum = 0.0;\n            var targets = this._targets;\n            for (var i = 0, nb = targets.length; i < nb; ++i) {\n                // ignore gpu morphed targets\n                if (gpuMorphed[i] === true) continue;\n\n                var weight = targets[i].value;\n                if (Math.abs(weight) <= __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */].EFFECTIVE_EPS) continue;\n\n                sum += weight;\n            }\n            // check comment in _morphBufferArrayCPU (avoid near zero value)\n            var eps = 1e-5;\n            if (Math.abs(sum) > eps) return sum;\n            return sum < 0.0 ? -eps : eps;\n        },\n\n        _morphBufferArrayCPU: function() {\n            // the idea is... we have :\n            // v\' = v * (1-w1-w2-w3) + t1*w1 + t2*w2 + t3*w3\n            // we want\n            // v\' = v * (1-w1-w4) + t1*w1 + t4*w4\n            // so basically we have to compute\n            // w4 = w2+w3 // (check if ~0 !)\n            // t4 = (t2*w2+t3*w3)/w4\n            // (w4 is extraWeightSum and t4 will be computed in _mergeExtraMorphTarget)\n\n            // compute new weights for the 4th target (all the extra target will be merged inside this one)\n            var extraWeightSum = (this._weights[\n                this._maxMorphGPU - 1\n            ] = this._computeExtraWeightsSum());\n\n            var processed = {}; // handles referenced buffer array (avoid useless double morph computation the same buffer)\n            var morphs = this._morphs;\n            for (var i = 0, nbMorphs = morphs.length; i < nbMorphs; ++i) {\n                var morph = morphs[i];\n                var vAttrs = morph.getVertexAttributeList();\n                var morphNames = morph.getMorphTargetNames();\n\n                for (var j = 0, nbNames = morphNames.length; j < nbNames; ++j) {\n                    var name = morphNames[j];\n                    var attr = vAttrs[name];\n                    // skip if the bufferArray is shared in another morphGeometry and has already been cpu morphed\n                    if (!attr || processed[attr.getInstanceID()]) continue;\n                    processed[attr.getInstanceID()] = true;\n\n                    this._mergeExtraMorphTarget(vAttrs, name, extraWeightSum);\n                }\n            }\n        },\n\n        updateWeights: function() {\n            if (this._maxMorphGPU === 0) return;\n\n            var i = 0;\n            var targets = this._targets;\n            var nbTargets = targets.length;\n            // reset weights\n            var weights = this._weights;\n            weights[0] = weights[1] = weights[2] = weights[3] = 0.0;\n\n            // no need to swap VA or to use CPU morph\n            if (nbTargets <= this._maxMorphGPU) {\n                for (i = 0; i < nbTargets; ++i) {\n                    weights[i] = targets[i].value;\n                }\n                return;\n            }\n\n            // reset indexMap\n            var indexMap = this._indexMap;\n            indexMap[0] = indexMap[1] = indexMap[2] = indexMap[3] = 0;\n\n            // reset gpu morphed array\n            var gpuMorphed = this._gpuMorphed;\n            gpuMorphed.length = nbTargets;\n            for (i = 0; i < nbTargets; ++i) gpuMorphed[i] = false;\n\n            var sortedTargets = targets.slice(0).sort(funcWeights);\n\n            for (i = 0; i < this._maxMorphGPU; ++i) {\n                var ti = targets.indexOf(sortedTargets[i]);\n                gpuMorphed[ti] = true;\n                indexMap[i] = ti;\n                weights[i] = sortedTargets[i].value;\n            }\n\n            // check more than 4 targets, we compute all the extra targets influence and merge in the last 4th morphs targets\n            var extraEpsilon = Math.abs(sortedTargets[this._maxMorphGPU].value);\n            var extraMorphCPU = extraEpsilon > __WEBPACK_IMPORTED_MODULE_5_osgAnimation_MorphGeometry__["a" /* default */].EFFECTIVE_EPS;\n            gpuMorphed[indexMap[this._maxMorphGPU - 1]] = !extraMorphCPU;\n\n            this._remapBufferArrays();\n            if (extraMorphCPU) {\n                this._morphBufferArrayCPU();\n            }\n        },\n\n        update: function(node /*, nv*/) {\n            if (!this.isInitialized()) this.init(node);\n\n            this.updateWeights();\n\n            var weights = this._weights;\n            var nbTargets = Math.min(this._maxMorphGPU, this._targets.length);\n            var morphs = this._morphs;\n            for (var i = 0, nbMorphs = morphs.length; i < nbMorphs; ++i) {\n                var array = morphs[i].getTargetsWeight();\n                for (var j = 0; j < nbTargets; j++) {\n                    array[j] = weights[j];\n                }\n            }\n\n            return true;\n        }\n    }),\n    \'osgAnimation\',\n    \'UpdateMorph\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (UpdateMorph);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/UpdateMorph.js\n// module id = 88\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/UpdateMorph.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__ = __webpack_require__(37);\n\n\n\n\n\n\nvar StackedScale = function(name, scale) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n    this._target = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__["a" /* default */].createVec3Target(scale || __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].ONE);\n    if (name) this.setName(name);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    StackedScale,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        init: function(scale) {\n            this.setScale(scale);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._target.defaultValue, scale);\n        },\n\n        setScale: function(scale) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._target.value, scale);\n        },\n\n        getTarget: function() {\n            return this._target;\n        },\n\n        resetToDefaultValue: function() {\n            this.setScale(this._target.defaultValue);\n        },\n\n        // must be optimized\n        applyToMatrix: function(m) {\n            var scale = this._target.value;\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].scale(m, m, scale);\n        }\n    }),\n    \'osgAnimation\',\n    \'StackedScale\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (StackedScale);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/StackedScale.js\n// module id = 89\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/StackedScale.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgGA_Manipulator__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgGA_OrbitManipulatorDeviceOrientationController__ = __webpack_require__(142);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgGA_OrbitManipulatorGamePadController__ = __webpack_require__(143);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgGA_OrbitManipulatorHammerController__ = __webpack_require__(92);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgGA_OrbitManipulatorStandardMouseKeyboardController__ = __webpack_require__(144);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgGA_OrbitManipulatorWebVRController__ = __webpack_require__(146);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgUtil_DelayInterpolator__ = __webpack_require__(72);\n\n\n\n\n\n\n\n\n\n\n\n/**\n *  OrbitManipulator\n *  @class\n */\nvar OrbitManipulator = function(boundStrategy) {\n    __WEBPACK_IMPORTED_MODULE_2_osgGA_Manipulator__["a" /* default */].call(this, boundStrategy);\n    this._homePosition = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._frustum = {};\n    this.init();\n};\n\nOrbitManipulator.AvailableControllerList = [\n    \'StandardMouseKeyboard\',\n    \'GamePad\',\n    \'Hammer\',\n    \'DeviceOrientation\',\n    \'WebVR\'\n];\n\nOrbitManipulator.ControllerList = [\n    \'StandardMouseKeyboard\',\n    \'GamePad\',\n    \'Hammer\',\n    \'DeviceOrientation\',\n    \'WebVR\'\n];\n\nvar TWO_PI = 2 * Math.PI;\nvar lowerOrEqual = function(val, limit) {\n    return val < limit + 0.00001;\n};\n\n/** @lends OrbitManipulator.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    OrbitManipulator,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgGA_Manipulator__["a" /* default */].prototype, {\n        init: function() {\n            this._distance = 25.0;\n            this._target = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            this._upz = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].init(this._target);\n\n            var rot1 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].fromRotation(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create(), -Math.PI, this._upz);\n            var rot2 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].fromRotation(\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create(),\n                Math.PI / 10.0,\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0)\n            );\n            this._rotation = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].mul(this._rotation, rot1, rot2);\n            this._time = 0.0;\n\n            this._vrMatrix = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n\n            this._rotate = new __WEBPACK_IMPORTED_MODULE_8_osgUtil_DelayInterpolator__["a" /* default */](2);\n            this._pan = new __WEBPACK_IMPORTED_MODULE_8_osgUtil_DelayInterpolator__["a" /* default */](2);\n            this._zoom = new __WEBPACK_IMPORTED_MODULE_8_osgUtil_DelayInterpolator__["a" /* default */](1);\n\n            this._minSpeed = 1e-4; // set a limit to pan/zoom speed\n            this._scaleMouseMotion = 1.0;\n\n            this._inverseMatrix = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n\n            // distance at which we start pushing the target (so that we can still zoom)\n            // with a very low _limitZoomIn, it\'s like a fps manipulator as long as you don\'t unzoom\n            this._autoPushTarget = true;\n\n            // pitch range [-PI/2, PI/2]\n            this._limitPitchUp = Math.PI * 0.5 * 0.9;\n            this._limitPitchDown = -this._limitPitchUp;\n\n            // yaw range [-PI, PI]\n            this._limitYawLeft = -Math.PI;\n            this._limitYawRight = -this._limitYawLeft;\n\n            this._limitZoomIn = 1e-4;\n            this._limitZoomOut = Infinity;\n\n            // instance of controller\n            var self = this;\n\n            OrbitManipulator.ControllerList.forEach(function(value) {\n                if (OrbitManipulator[value] !== undefined) {\n                    if (self._controllerList[value]) {\n                        self._controllerList[value].init();\n                    } else {\n                        self._controllerList[value] = new OrbitManipulator[value](self);\n                    }\n                }\n            });\n        },\n        setLimitPitchUp: function(up) {\n            this._limitPitchUp = up;\n        },\n        setLimitPitchDown: function(down) {\n            this._limitPitchDown = down;\n        },\n        setLimitYawLeft: function(left) {\n            this._limitYawLeft = left;\n        },\n        setLimitYawRight: function(right) {\n            this._limitYawRight = right;\n        },\n        setLimitZoomOut: function(zoomOut) {\n            this._limitZoomOut = zoomOut;\n        },\n        setLimitZoomIn: function(zoomIn) {\n            this._limitZoomIn = zoomIn;\n        },\n        setDelay: function(dt) {\n            this._rotate.setDelay(dt);\n            this._pan.setDelay(dt);\n            this._zoom.setDelay(dt);\n        },\n        reset: function() {\n            this.init();\n        },\n        setTarget: function(target) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._target, target);\n            var eyePos = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            this.getEyePosition(eyePos);\n            this._distance = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].distance(target, eyePos);\n        },\n        setEyePosition: (function() {\n            var f = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var s = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var u = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            return function(eye) {\n                var result = this._rotation;\n                var center = this._target;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(f, eye, center);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(f, f);\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].cross(s, f, this._upz);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(s, s);\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].cross(u, s, f);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(u, u);\n\n                // s[0], f[0], u[0], 0.0,\n                // s[1], f[1], u[1], 0.0,\n                // s[2], f[2], u[2], 0.0,\n                // 0,    0,    0,     1.0\n                result[0] = s[0];\n                result[1] = f[0];\n                result[2] = u[0];\n                result[3] = 0.0;\n                result[4] = s[1];\n                result[5] = f[1];\n                result[6] = u[1];\n                result[7] = 0.0;\n                result[8] = s[2];\n                result[9] = f[2];\n                result[10] = u[2];\n                result[11] = 0.0;\n                result[12] = 0;\n                result[13] = 0;\n                result[14] = 0;\n                result[15] = 1.0;\n\n                this._distance = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].distance(center, eye);\n            };\n        })(),\n\n        computeHomePosition: function(boundStrategy) {\n            var bs = this.getHomeBoundingSphere(boundStrategy);\n            if (!bs || !bs.valid()) return;\n\n            this.setDistance(this.getHomeDistance(bs));\n            this.setTarget(bs.center());\n        },\n\n        getHomePosition: function() {\n            if (this._node !== undefined) {\n                var target = this._target;\n                var distance = this.getDistance();\n\n                this.computeEyePosition(target, distance, this._homePosition);\n            }\n            return this._homePosition;\n        },\n\n        setMinSpeed: function(s) {\n            this._minSpeed = s;\n        },\n        getMinSpeed: function() {\n            return this._minSpeed;\n        },\n\n        setDistance: function(d) {\n            this._distance = d;\n        },\n        getDistance: function() {\n            return this._distance;\n        },\n\n        getSpeedFactor: function() {\n            return Math.max(this._distance, this._minSpeed);\n        },\n        computePan: (function() {\n            var inv = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n            var x = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var y = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            return function(dx, dy) {\n                var proj = this._camera.getProjectionMatrix();\n                // modulate panning speed with verticalFov value\n                // if it\'s an orthographic we don\'t change the panning speed\n                // TODO : manipulators in osgjs don\'t support well true orthographic camera anyway because they\n                // manage the view matrix (and you need to edit the projection matrix to \'zoom\' for true ortho camera)\n                var vFov = proj[15] === 1 ? 1.0 : 2.0 / proj[5];\n                var speed = this.getSpeedFactor() * vFov;\n                dy *= speed;\n                dx *= speed;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(inv, this._rotation);\n                x[0] = inv[0];\n                x[1] = inv[1];\n                x[2] = inv[2];\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(x, x);\n\n                y[0] = inv[8];\n                y[1] = inv[9];\n                y[2] = inv[10];\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(y, y);\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(x, x, -dx);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(y, y, dy);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(this._target, this._target, x);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(this._target, this._target, y);\n            };\n        })(),\n        computeRotation: (function() {\n            var rightDir = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0);\n\n            return function(dx, dy) {\n                var prevPitch = Math.atan(-this._rotation[6] / this._rotation[5]);\n                var pitch = this._computePitch(prevPitch, dy);\n\n                var deltaYaw = dx / 10.0;\n                var previousYaw = Math.atan2(this._rotation[4], this._rotation[0]);\n                var yaw = this._computeYaw(previousYaw, deltaYaw);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].fromRotation(this._rotation, -pitch, rightDir);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].rotate(this._rotation, this._rotation, -yaw, this._upz);\n            };\n        })(),\n\n        _computePitch: function(prevPitch, dy) {\n            var pitch = prevPitch + dy / 10.0;\n            return Math.min(Math.max(pitch, this._limitPitchDown), this._limitPitchUp);\n        },\n\n        _computeYaw: function(previousYaw, deltaYaw) {\n            var yaw = previousYaw + deltaYaw;\n            var left = this._limitYawLeft;\n            var right = this._limitYawRight;\n\n            if (right !== Math.PI || left !== -Math.PI) {\n                if (right < left) {\n                    if (yaw > Math.PI) {\n                        previousYaw -= TWO_PI;\n                        yaw -= TWO_PI;\n                    }\n                    if (yaw < -Math.PI) {\n                        previousYaw += TWO_PI;\n                        yaw += TWO_PI;\n                    }\n                }\n\n                if (deltaYaw === 0) {\n                    var isOutsideLimit = false;\n                    if (left > right) isOutsideLimit = yaw < left && yaw > right;\n                    else isOutsideLimit = yaw < left || yaw > right;\n                    if (isOutsideLimit)\n                        yaw = Math.abs(yaw - left) > Math.abs(yaw - right) ? right : left;\n                }\n\n                if (deltaYaw > 0.0 && lowerOrEqual(previousYaw, right) && yaw > right) {\n                    yaw = right;\n                } else if (deltaYaw < 0.0 && lowerOrEqual(left, previousYaw) && yaw < left) {\n                    yaw = left;\n                }\n            }\n            return yaw;\n        },\n\n        computeZoom: function(dz) {\n            this.zoom(dz);\n        },\n\n        setAutoPushTarget: function(bool) {\n            this._autoPushTarget = bool;\n        },\n\n        zoom: (function() {\n            var dir = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            return function(ratio) {\n                var newValue = this._distance + this.getSpeedFactor() * (ratio - 1.0);\n\n                if (this._autoPushTarget && newValue < this._limitZoomIn) {\n                    // push the target instead of zooming on it\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(dir, this._target, this.getEyePosition(dir));\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(dir, dir);\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(dir, dir, this._limitZoomIn - newValue);\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(this._target, this._target, dir);\n                }\n\n                this._distance = Math.max(\n                    this._limitZoomIn,\n                    Math.min(this._limitZoomOut, newValue)\n                );\n            };\n        })(),\n\n        getRotateInterpolator: function() {\n            return this._rotate;\n        },\n        getPanInterpolator: function() {\n            return this._pan;\n        },\n        getZoomInterpolator: function() {\n            return this._zoom;\n        },\n        getTarget: function(target) {\n            return __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(target, this._target);\n        },\n        getEyePosition: function(eye) {\n            this.computeEyePosition(this._target, this._distance, eye);\n            return eye;\n        },\n\n        computeEyePosition: (function() {\n            var tmpDist = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var tmpInverse = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n            return function(target, distance, eye) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(tmpInverse, this._rotation);\n                tmpDist[1] = distance;\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].transformMat4(eye, tmpDist, tmpInverse);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(eye, target, eye);\n            };\n        })(),\n\n        update: (function() {\n            var eye = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            return function(nv) {\n                var dt = nv.getFrameStamp().getDeltaTime();\n\n                var delta;\n                var mouseFactor = 0.1;\n                delta = this._rotate.update(dt);\n                this.computeRotation(\n                    -delta[0] * mouseFactor * this._scaleMouseMotion,\n                    -delta[1] * mouseFactor * this._scaleMouseMotion\n                );\n\n                var panFactor = 0.002;\n                delta = this._pan.update(dt);\n                this.computePan(-delta[0] * panFactor, -delta[1] * panFactor);\n\n                delta = this._zoom.update(dt);\n                this.computeZoom(1.0 + delta[0] / 10.0);\n\n                var target = this._target;\n                var distance = this._distance;\n\n                /* 1. Works but bypass other manipulators */\n                // mat4.copy( this._inverseMatrix , this._vrMatrix );\n\n                /* 2. Works but gets broken by other manipulators */\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(this._inverseMatrix, this._rotation);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].mul(this._inverseMatrix, this._vrMatrix, this._inverseMatrix);\n\n                /* 3. Doesnt\' work */\n                // mat4.mul( this._vrMatrix,  this._vrMatrix, this._rotation );\n                // mat4.invert( this._inverseMatrix, this._vrMatrix );\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].set(eye, 0.0, distance, 0.0);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].transformMat4(eye, eye, this._inverseMatrix);\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].lookAt(this._inverseMatrix, __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(eye, target, eye), target, this._upz);\n            };\n        })(),\n\n        setPoseVR: function(q /*, pos*/) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].fromQuat(this._vrMatrix, q);\n            // this._vrMatrix[ 12 ] = pos[ 0 ];\n            // this._vrMatrix[ 13 ] = pos[ 1 ];\n            // this._vrMatrix[ 14 ] = pos[ 2 ];\n        }\n    }),\n    \'osgGA\',\n    \'OrbitManipulator\'\n);\n\nOrbitManipulator.DeviceOrientation = __WEBPACK_IMPORTED_MODULE_3_osgGA_OrbitManipulatorDeviceOrientationController__["a" /* default */];\nOrbitManipulator.GamePad = __WEBPACK_IMPORTED_MODULE_4_osgGA_OrbitManipulatorGamePadController__["a" /* default */];\nOrbitManipulator.Hammer = __WEBPACK_IMPORTED_MODULE_5_osgGA_OrbitManipulatorHammerController__["a" /* default */];\nOrbitManipulator.WebVR = __WEBPACK_IMPORTED_MODULE_7_osgGA_OrbitManipulatorWebVRController__["a" /* default */];\nOrbitManipulator.StandardMouseKeyboard = __WEBPACK_IMPORTED_MODULE_6_osgGA_OrbitManipulatorStandardMouseKeyboardController__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (OrbitManipulator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/OrbitManipulator.js\n// module id = 90\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/OrbitManipulator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\nvar degtorad = Math.PI / 180.0; // Degree-to-Radian conversion\n\nvar makeRotateFromEuler = function(q, x, y, z, order) {\n    // http://www.mathworks.com/matlabcentral/fileexchange/\n    // 20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n    // content/SpinCalc.m\n\n    var c1 = Math.cos(x / 2);\n    var c2 = Math.cos(y / 2);\n    var c3 = Math.cos(z / 2);\n    var s1 = Math.sin(x / 2);\n    var s2 = Math.sin(y / 2);\n    var s3 = Math.sin(z / 2);\n\n    if (order === \'XYZ\') {\n        q[0] = s1 * c2 * c3 + c1 * s2 * s3;\n        q[1] = c1 * s2 * c3 - s1 * c2 * s3;\n        q[2] = c1 * c2 * s3 + s1 * s2 * c3;\n        q[3] = c1 * c2 * c3 - s1 * s2 * s3;\n    } else if (order === \'YXZ\') {\n        q[0] = s1 * c2 * c3 + c1 * s2 * s3;\n        q[1] = c1 * s2 * c3 - s1 * c2 * s3;\n        q[2] = c1 * c2 * s3 - s1 * s2 * c3;\n        q[3] = c1 * c2 * c3 + s1 * s2 * s3;\n    } else if (order === \'ZXY\') {\n        q[0] = s1 * c2 * c3 - c1 * s2 * s3;\n        q[1] = c1 * s2 * c3 + s1 * c2 * s3;\n        q[2] = c1 * c2 * s3 + s1 * s2 * c3;\n        q[3] = c1 * c2 * c3 - s1 * s2 * s3;\n    } else if (order === \'ZYX\') {\n        q[0] = s1 * c2 * c3 - c1 * s2 * s3;\n        q[1] = c1 * s2 * c3 + s1 * c2 * s3;\n        q[2] = c1 * c2 * s3 - s1 * s2 * c3;\n        q[3] = c1 * c2 * c3 + s1 * s2 * s3;\n    } else if (order === \'YZX\') {\n        q[0] = s1 * c2 * c3 + c1 * s2 * s3;\n        q[1] = c1 * s2 * c3 + s1 * c2 * s3;\n        q[2] = c1 * c2 * s3 - s1 * s2 * c3;\n        q[3] = c1 * c2 * c3 - s1 * s2 * s3;\n    } else if (order === \'XZY\') {\n        q[0] = s1 * c2 * c3 - c1 * s2 * s3;\n        q[1] = c1 * s2 * c3 - s1 * c2 * s3;\n        q[2] = c1 * c2 * s3 + s1 * s2 * c3;\n        q[3] = c1 * c2 * c3 + s1 * s2 * s3;\n    }\n    return q;\n};\n\nvar FirstPersonManipulatorDeviceOrientationController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\nFirstPersonManipulatorDeviceOrientationController.computeQuaternion = (function() {\n    var screenTransform = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].create();\n    var worldTransform = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].fromValues(-Math.sqrt(0.5), 0.0, 0.0, Math.sqrt(0.5)); // - PI/2 around the x-axis\n\n    // but on ios alpha is relative to the first question:\n    //\n    // http://www.html5rocks.com/en/tutorials/device/orientation/\n    // For most browsers, alpha returns the compass heading, so when the device is pointed\n    // north, alpha is zero. With Mobile Safari, alpha is based on the direction the\n    // device was pointing when device orientation was first requested. The compass\n    // heading is available in the webkitCompassHeading parameter.\n\n    return function(q, deviceOrientation, screenOrientation) {\n        var alpha = deviceOrientation.alpha * degtorad;\n        var beta = deviceOrientation.beta * degtorad;\n        var gamma = deviceOrientation.gamma * degtorad;\n\n        // If the user goes in landscape mode, he rotates his device with a certain angle\n        // around the Z axis counterclockwise and the DeviceOrientation contains this\n        // rotation To compensate this, we apply a rotation of the same angle in the\n        // opposite way\n\n        var screenAngle = screenOrientation * degtorad;\n\n        // alpha is heading -> X\n        // beta             -> Z Up\n        // Gamma            -> Y view direction\n        makeRotateFromEuler(q, beta, alpha, -gamma, \'YXZ\');\n        // equivalent to\n        // var rotateX = mat4.fromRotation( mat4.create(), beta,[ 1,0,0 ] );\n        // var rotateY = mat4.fromRotation( mat4.create(), alpha,[ 0,1,0 ] );\n        // var rotateZ = mat4.fromRotation( mat4.create(), -gamma,[ 0,0,1 ] );\n        // var result = mat4.create();\n        // mat4.mul( result, rotateY, rotateX );\n        // mat4.mul( result, result, rotateZ );\n        // mat4.getRotation( q, result );\n\n        var minusHalfAngle = -screenAngle / 2.0;\n        screenTransform[1] = Math.sin(minusHalfAngle);\n        screenTransform[3] = Math.cos(minusHalfAngle);\n\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].mul(q, q, screenTransform);\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].mul(q, q, worldTransform);\n\n        var yTemp = q[1];\n        q[1] = -q[2];\n        q[2] = yTemp;\n\n        return q;\n    };\n})();\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    FirstPersonManipulatorDeviceOrientationController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {\n            this._stepFactor = 1.0; // meaning radius*stepFactor to move\n            this._quat = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].create();\n            this._pos = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n        },\n\n        update: function(deviceOrientation, screenOrientation) {\n            FirstPersonManipulatorDeviceOrientationController.computeQuaternion(\n                this._quat,\n                deviceOrientation,\n                screenOrientation\n            );\n            this._manipulator.setPoseVR(this._quat, this._pos);\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (FirstPersonManipulatorDeviceOrientationController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/FirstPersonManipulatorDeviceOrientationController.js\n// module id = 91\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/FirstPersonManipulatorDeviceOrientationController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_math__ = __webpack_require__(41);\n\n\n\n\nvar OrbitManipulatorHammerController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__[\"a\" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    OrbitManipulatorHammerController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__[\"a\" /* default */].prototype, {\n        init: function() {\n            this._panFactorX = 1.0;\n            this._panFactorY = -this._panFactorX;\n\n            this._rotateFactorX = 0.6;\n            this._rotateFactorY = -this._rotateFactorX;\n            this._zoomFactor = 5.0;\n\n            this._lastScale = 0;\n            this._nbPointerLast = 0; // to check if we the number of pointers has changed\n            this._delay = 0.15;\n\n            this._transformStarted = false;\n            this._dragStarted = false;\n\n            this._cbPanStart = this.panStart.bind(this);\n            this._cbPanMove = this.panMove.bind(this);\n            this._cbPanEnd = this.panEnd.bind(this);\n\n            this._cbPinchStart = this.pinchStart.bind(this);\n            this._cbPinchEnd = this.pinchEnd.bind(this);\n            this._cbPinchInOut = this.pinchInOut.bind(this);\n\n            this._isValid = true;\n        },\n\n        setValid: function(valid) {\n            if (valid === this._isValid) return;\n            this._isValid = valid;\n            // if validity change during a drag/transform\n            this._transformStarted = false;\n            this._dragStarted = false;\n        },\n\n        getPanStartBind: function() {\n            return this._cbPanStart;\n        },\n\n        getPanMoveBind: function() {\n            return this._cbPanMove;\n        },\n\n        getPanEndBind: function() {\n            return this._cbPanEnd;\n        },\n\n        getPinchEndBind: function() {\n            return this._cbPinchEnd;\n        },\n\n        _setListeners: function() {\n            var hammer = this._eventProxy;\n\n            // Let the pan be detected with two fingers.\n            // 2 => pan, 1 -> rotate\n            hammer.get('pan').set({\n                threshold: 0,\n                pointers: 0\n            });\n\n            var pinch = hammer.get('pinch');\n            if (pinch) {\n                // Set a minimal thresold on pinch event, to be detected after pan\n                pinch.set({\n                    threshold: 0.1\n                });\n                pinch.recognizeWith(hammer.get('pan'));\n            }\n\n            hammer.on('panstart ', this._cbPanStart);\n            hammer.on('panmove', this._cbPanMove);\n            hammer.on('panend', this._cbPanEnd);\n\n            hammer.on('pinchend', this._cbPinchEnd);\n            hammer.on('pinchstart', this._cbPinchStart);\n            hammer.on('pinchin pinchout', this._cbPinchInOut);\n\n            // if validity change during a drag/tranform\n            this._transformStarted = false;\n            this._dragStarted = false;\n        },\n\n        setEventProxy: function(hammer) {\n            if (!hammer || hammer === this._eventProxy) {\n                return;\n            }\n\n            this._eventProxy = hammer;\n            if (this._manipulator) this._setListeners();\n        },\n\n        _computeTouches: function(event) {\n            if (event.pointers !== undefined) return event.pointers.length;\n            return 1; // mouse\n        },\n\n        panStart: function(event) {\n            if (!this._isValid || this._transformStarted || event.pointerType === 'mouse') {\n                return;\n            }\n\n            this._dragStarted = true;\n            var manipulator = this._manipulator;\n            this._nbPointerLast = this._computeTouches(event);\n            if (this._nbPointerLast === 2) {\n                var panInterpolator = manipulator.getPanInterpolator();\n                panInterpolator.reset();\n                var xPan = event.center.x * this._panFactorX;\n                var yPan = event.center.y * this._panFactorY;\n                panInterpolator.set(xPan, yPan);\n            } else {\n                var rotateInterpolator = manipulator.getRotateInterpolator();\n                rotateInterpolator.reset();\n                var xRot = event.center.x * this._rotateFactorX;\n                var yRot = event.center.y * this._rotateFactorY;\n                rotateInterpolator.set(xRot, yRot);\n            }\n        },\n\n        panMove: function(event) {\n            if (!this._isValid || !this._dragStarted || event.pointerType === 'mouse') {\n                return;\n            }\n\n            var manipulator = this._manipulator;\n            var nbPointers = this._computeTouches(event);\n            // prevent sudden big changes in the event.center variables\n            if (this._nbPointerLast !== nbPointers) {\n                if (nbPointers === 2) manipulator.getPanInterpolator().reset();\n                else manipulator.getRotateInterpolator().reset();\n                this._nbPointerLast = nbPointers;\n            }\n\n            if (nbPointers === 2) {\n                var panInterpolator = manipulator.getPanInterpolator();\n                var xPan = event.center.x * this._panFactorX;\n                var yPan = event.center.y * this._panFactorY;\n                panInterpolator.setTarget(xPan, yPan);\n            } else {\n                var rotateInterpolator = manipulator.getRotateInterpolator();\n                rotateInterpolator.setDelay(this._delay);\n                var xRot = event.center.x * this._rotateFactorX;\n                var yRot = event.center.y * this._rotateFactorY;\n                rotateInterpolator.setTarget(xRot, yRot);\n            }\n        },\n\n        panEnd: function(event) {\n            if (!this._isValid || !this._dragStarted || event.pointerType === 'mouse') return;\n            this._dragStarted = false;\n        },\n\n        pinchStart: function(event) {\n            if (!this._isValid || event.pointerType === 'mouse') return;\n\n            this._transformStarted = true;\n            this._lastScale = event.scale;\n            var zoomInterpolator = this._manipulator.getZoomInterpolator();\n            zoomInterpolator.reset();\n            zoomInterpolator.set(this._lastScale);\n            event.preventDefault();\n        },\n\n        pinchEnd: function(event) {\n            if (!this._isValid || event.pointerType === 'mouse') return;\n            this._transformStarted = false;\n        },\n\n        pinchInOut: function(event) {\n            if (!this._isValid || !this._transformStarted || event.pointerType === 'mouse') return;\n\n            // make the dezoom faster (because the manipulator dezoom/dezoom distance speed is adaptive)\n            var zoomFactor =\n                event.scale > this._lastScale ? this._zoomFactor : this._zoomFactor * 3.0;\n            // also detect pan (velocity) to reduce zoom force\n            var minDezoom = 0.0;\n            var maxDezoom = 0.5;\n            var aSmooth = -Math.abs(event.velocity) + (minDezoom + maxDezoom);\n            zoomFactor *= __WEBPACK_IMPORTED_MODULE_2_osg_math__[\"a\" /* default */].smoothStep(minDezoom, maxDezoom, aSmooth);\n\n            var scale = (event.scale - this._lastScale) * zoomFactor;\n            this._lastScale = event.scale;\n\n            var zoomInterpolator = this._manipulator.getZoomInterpolator();\n            zoomInterpolator.setTarget(zoomInterpolator.getTarget()[0] - scale);\n        },\n\n        removeEventProxy: function(eventProxy) {\n            var proxy = eventProxy || this._eventProxy;\n            if (!proxy) return;\n\n            proxy.off('panstart ', this._cbPanStart);\n            proxy.off('panmove', this._cbPanMove);\n            proxy.off('panend', this._cbPanEnd);\n            proxy.off('pinchstart', this._cbPinchStart);\n            proxy.off('pinchend', this._cbPinchEnd);\n            proxy.off('pinchin pinchout', this._cbPinchInOut);\n        },\n\n        setManipulator: function(manipulator) {\n            this._manipulator = manipulator;\n            if (this._eventProxy) this._setListeners();\n        }\n    })\n);\n/* harmony default export */ __webpack_exports__[\"a\"] = (OrbitManipulatorHammerController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/OrbitManipulatorHammerController.js\n// module id = 92\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/OrbitManipulatorHammerController.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__ = __webpack_require__(73);\n\n\n\n\n/*\n\nNodes are automatically created when parsing a glsl file\n\n=== function name ===\n* First letter of your glsl function will be converted to upperCase\n* You can override the function name with NODE_NAME:myNewName\n\n=== variable name ===\n* The output variable is always named result, other variable names are unchanged\n* You can override a variable name by writing glslName:jsName\n\n=== overloading matching ===\n* Overloading is supported, it will select the best matching depending of the js inputs/outputs\n* For now you need to put the overload functions in the same glsl file\n* Overloading will prioritize variable name matching first, then output types, and finally input types\n* When there is a mismatch in types, it'll downcast your input (e.g: by transforming your vec4 into a vec3)\n\n=== misc ===\n* Shader nodes have a function addExtensions if you want to enable extensions\n* Shader nodes have a function addDefines if you want to provides defines\n\n* /!\\ hack: Extensions in pragma is partially supported: for now only by writing DERIVATIVES:enable after the pragma will work\n\n* /!\\ hack: you can declare functions as defines too but it will only perform name checking\n            No type checking/downcasting and no in/out validation\n\n* /!\\ hack: Optional argument are handled with define that have the structure : OPT_ARG_myOptVar\n            The variable will be named myOptVar in that example\n            No type checking/downcasting and no in/out validation for the optional variable\n\n\nTry to stick with the simple example if possible\n\n============================\n====== SIMPLE EXAMPLE ======\n============================\n\n---- glsl ----\n#pragma DECLARE_FUNCTION\nvec3 myFunc(const in float myVarIn, out float myVarOut) {\n    // do stuffs\n}\n\n---- js ----\nthis.getNode('MyFunc')\n    .inputs({\n        myVarIn: var1\n    })\n    .outputs({\n        result: var2,\n        myVarOut: var3\n    });\n\n============================\n====== COMPLEX EXAMPLE =====\n============================\n\n---- glsl ----\n#pragma DECLARE_FUNCTION NODE_NAME:myFuncTiti result:resOut myVarIn:totoIn optVariable:optVar DERIVATIVES:enable\nvec3 myFunc(const in float myVarIn, out float myVarOut, OPT_ARG_optVariable) {\n    // do stuffs\n}\n\n---- js ----\nthis.getNode('myFuncTiti')\n    .inputs({\n        totoIn: var1,\n        optVar: var2\n    })\n    .outputs({\n        resOut: var4,\n        myVarOut: var5\n    })\n    .addDefines(['#define TOTO']);\n\n*/\n\nvar sprintf = function(string, args) {\n    if (!string || !args) {\n        return '';\n    }\n\n    var arg;\n\n    for (var index in args) {\n        arg = args[index];\n\n        if (arg === undefined) {\n            continue;\n        }\n\n        if (arg.getVariable) {\n            arg = arg.getVariable();\n        }\n        string = string.replace('%s', arg);\n    }\n    return string;\n};\n\nvar checkVariableType = function(vars, optionalPrefix) {\n    var inputs = vars;\n    var varsList = [];\n    var prefix = optionalPrefix;\n    if (optionalPrefix === undefined) {\n        prefix = '';\n    }\n\n    for (var i = 0, l = inputs.length; i < l; i++) {\n        var variable = inputs[i];\n        var output;\n\n        if (variable === undefined) {\n            output = 'undefined';\n        } else if (typeof variable === 'string') {\n            output = variable;\n        } else if (variable.getType) {\n            output = variable.getType() + ' ' + variable.getVariable();\n        } else {\n            output = variable.getVariable();\n        }\n\n        varsList.push(prefix + output);\n    }\n\n    return varsList;\n};\n\nvar callFunction = function(funcName, output, inputs) {\n    var osgShader = __webpack_require__(94).default;\n\n    var debug = [];\n    var callString = '';\n\n    // debug\n    if (osgShader.debugShaderNode) {\n        debug.push('\\n// output');\n        Array.prototype.push.apply(debug, checkVariableType([output], '// '));\n    }\n\n    if (output) {\n        callString = (output.getVariable ? output.getVariable() : output) + ' = ';\n    }\n\n    callString = callString + funcName + '( ';\n\n    if (inputs && inputs.length > 0) {\n        // debug\n        if (osgShader.debugShaderNode) {\n            debug.push('// inputs');\n            Array.prototype.push.apply(debug, checkVariableType(inputs, '// '));\n        }\n\n        for (var i = 0, l = inputs.length; i < l; i++) {\n            callString += inputs[i].getVariable ? inputs[i].getVariable() : inputs[i];\n            if (i !== l - 1) callString += ', ';\n        }\n    }\n\n    callString += ' );\\n';\n\n    if (osgShader.debugShaderNode) {\n        return debug.join('\\n') + '\\n' + callString;\n    }\n\n    return callString;\n};\n\nvar extractPragmaArgs = function(option) {\n    // extract glslVar:jsVar pattern\n    // res: [\"DERIVATIVES:enable\", \"glslVarIn:jsVarIn\", \"glslVarOut:jsVarOut\"]\n    var res = option.match(/([^\\s]+):([^\\s]+)/g);\n\n    var map = {};\n    if (!res) return map;\n\n    for (var i = 0; i < res.length; ++i) {\n        var split = res[i].split(':');\n        map[split[0]] = split[1];\n    }\n\n    return map;\n};\n\nvar extractSignature = function(option, signature) {\n    var openParen = signature.indexOf('(');\n    var closeParen = signature.indexOf(')');\n\n    // preSignature: \"vec3 myFunction\"\n    var preSignature = signature.substring(0, openParen);\n    preSignature = preSignature\n        .replace(/[\\r\\n|\\r|\\n]/g, '')\n        .trim()\n        .replace(/\\s+/g, ' ');\n\n    var splitPre = preSignature.split(/\\s/);\n    var firstWord = splitPre[0];\n    var nameFunc = splitPre[1];\n\n    // override variable names\n    var pragmaArgs = extractPragmaArgs(option);\n    var returnName = pragmaArgs.result || 'result';\n\n    // override node name\n    var nodeName = pragmaArgs.NODE_NAME;\n    if (!nodeName) {\n        nodeName = nameFunc[0].toUpperCase() + nameFunc.substring(1);\n    }\n\n    // extensions\n    var extensions = [];\n    if (pragmaArgs.DERIVATIVES) {\n        extensions.push('#extension GL_OES_standard_derivatives : ' + pragmaArgs.DERIVATIVES);\n    }\n\n    var outputs = [];\n    var returnVariable;\n    var isDefine = firstWord === '#define';\n    // return variable\n    if (firstWord !== 'void') {\n        returnVariable = {\n            name: returnName,\n            type: !isDefine && firstWord\n        };\n        outputs.push(returnVariable);\n    }\n\n    // postSignature: \"const in vec3 varIn,    const out float varOut\"\n    var postSignature = signature.substring(openParen + 1, closeParen);\n    postSignature = postSignature.replace(/[\\r\\n|\\r|\\n]/g, '');\n\n    // array of arguments\n    var argumentList = postSignature.split(/OPT_ARG_|,/);\n    var hasOptionalArgs = postSignature.indexOf('OPT_ARG_') !== -1;\n\n    var inputs = [];\n    var orderedArgs = [];\n    for (var i = 0; i < argumentList.length; ++i) {\n        var argi = argumentList[i];\n        if (!argi) continue;\n\n        // cleanArg: \"const in vec3 varIn\"\n        var cleanArg = argi\n            .trim()\n            .replace(/\\s+/g, ' ')\n            .split('[')[0];\n        var splits = cleanArg.split(/\\s/);\n        var nbSplits = splits.length;\n\n        var isOutput = nbSplits >= 3 && splits[nbSplits - 3].indexOf('out') !== -1;\n        var glslName = splits[nbSplits - 1];\n        var res = {\n            isOutput: isOutput,\n            type: splits[nbSplits - 2],\n            name: pragmaArgs[glslName] || glslName,\n            optional: hasOptionalArgs && postSignature.indexOf('OPT_ARG_' + glslName) !== -1\n        };\n\n        orderedArgs.push(res);\n        if (res.optional) continue;\n\n        if (isOutput) outputs.push(res);\n        else inputs.push(res);\n    }\n\n    return {\n        nodeName: nodeName,\n        functionName: nameFunc,\n        signature: {\n            returnVariable: returnVariable,\n            orderedArgs: orderedArgs,\n            outputs: outputs,\n            inputs: inputs,\n            extensions: extensions\n        }\n    };\n};\n\nvar createNode = function(res, fileName) {\n    var NodeCustom = function() {\n        __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].call(this);\n        this._defines = [];\n        this._extensions = [];\n        this._missingArgs = false;\n    };\n\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n        NodeCustom,\n        __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].prototype, {\n            type: res.nodeName,\n            signatures: [res.signature],\n            globalDeclare: '#pragma include \"' + fileName + '\"',\n\n            checkInputsOutputs: function() {},\n\n            globalFunctionDeclaration: function() {\n                return this.globalDeclare;\n            },\n\n            addExtensions: function(exts) {\n                this._extensions.push.apply(this._extensions, exts);\n                return this;\n            },\n\n            getExtensions: function() {\n                this.getOrCreateSignature();\n                return this._extensions;\n            },\n\n            addDefines: function(defines) {\n                this._defines.push.apply(this._defines, defines);\n                return this;\n            },\n\n            getDefines: function() {\n                return this._defines;\n            },\n\n            _validateSameVariables: function(glslArray, jsObj) {\n                var nbGlsl = glslArray.length;\n                for (var i = 0; i < nbGlsl; ++i) {\n                    if (!jsObj[glslArray[i].name]) return false;\n                }\n                return glslArray.length === Object.keys(jsObj).length;\n            },\n\n            _validateSameType: function(glslArray, jsObj) {\n                var nbGlsl = glslArray.length;\n                for (var i = 0; i < nbGlsl; ++i) {\n                    var jsVar = jsObj[glslArray[i].name];\n                    if (jsVar.getType() !== glslArray[i].type) return false;\n                }\n                return true;\n            },\n\n            _getSignatureBestMatch: function() {\n                if (this.signatures.length === 1) return this.signatures[0];\n\n                var matchNames = [];\n                var matchOutput = [];\n                var matchInput = [];\n                var nbSignatures = this.signatures.length;\n                for (var i = 0; i < nbSignatures; ++i) {\n                    var sig = this.signatures[i];\n                    if (!this._validateSameVariables(sig.outputs, this._outputs)) continue;\n                    if (!this._validateSameVariables(sig.inputs, this._inputs)) continue;\n                    matchNames.push(sig);\n\n                    if (!this._validateSameType(sig.outputs, this._outputs)) continue;\n                    matchOutput.push(sig);\n\n                    if (!this._validateSameType(sig.inputs, this._inputs)) continue;\n                    matchInput.push(sig);\n                }\n\n                if (!matchNames.length) return this.signatures[0];\n                if (matchNames.length === 1 || !matchOutput.length) return matchNames[0];\n                if (matchOutput.length === 1 || !matchInput.length) return matchOutput[0];\n                return matchInput[0];\n            },\n\n            getOrCreateSignature: function() {\n                if (!this._signature) {\n                    this._signature = this._getSignatureBestMatch();\n                    this.addExtensions(this._signature.extensions);\n                }\n                return this._signature;\n            },\n\n            _typeDownCast: function(glslArg) {\n                var jsArg;\n                if (glslArg.optional) {\n                    jsArg = this._inputs[glslArg.name] || this._outputs[glslArg.name];\n                    if (!jsArg) return;\n                } else {\n                    jsArg = glslArg.isOutput\n                        ? this._outputs[glslArg.name]\n                        : this._inputs[glslArg.name];\n                }\n\n                if (!jsArg) {\n                    var typeIn = glslArg.isOutput ? 'output' : 'input';\n                    __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].error(\n                        'missing ' + typeIn + ' ' + glslArg.name + ' on NodeCustom ' + res.nodeName\n                    );\n                    this._missingArgs = true;\n                    return;\n                }\n\n                var realType = jsArg.getType();\n                var validType = glslArg.type;\n\n                if (!validType || validType === realType) return jsArg;\n                if (validType === 'vec3') return jsArg.getVariable() + '.rgb';\n                if (validType === 'vec2') return jsArg.getVariable() + '.rg';\n                if (validType === 'float') return jsArg.getVariable() + '.r';\n                return jsArg;\n            },\n\n            computeShader: function() {\n                var signature = this.getOrCreateSignature();\n\n                var ret = signature.returnVariable && signature.returnVariable.name;\n                var returnOut = ret ? this._outputs[ret] : undefined;\n                if (ret && !returnOut) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].error('missing output ' + ret + ' on NodeCustom ' + res.nodeName);\n                    this._missingArgs = true;\n                }\n\n                var orderedArgs = [];\n                for (var i = 0; i < signature.orderedArgs.length; ++i) {\n                    var input = this._typeDownCast(signature.orderedArgs[i]);\n                    if (input) orderedArgs.push(input);\n                }\n\n                if (this._missingArgs) return '';\n                return callFunction(res.functionName, returnOut, orderedArgs);\n            }\n        }),\n        'osgShader',\n        res.nodeName\n    );\n\n    return NodeCustom;\n};\n\nvar shaderNodeClassGlobal = {};\n\nvar extractFunctions = function(shaderLib, fileName) {\n    var signatures = shaderLib[fileName].split(/#pragma DECLARE_FUNCTION(.*)[\\r\\n|\\r|\\n]/);\n    var nbSignatures = (signatures.length - 1) / 2;\n\n    var shaderNodeClassLocal = {};\n    for (var i = 0; i < nbSignatures; ++i) {\n        var result = extractSignature(signatures[i * 2 + 1], signatures[i * 2 + 2]);\n        var nodeName = result.nodeName;\n        var shaderNode = shaderNodeClassLocal[nodeName];\n        if (shaderNode) {\n            shaderNode.prototype.signatures.push(result.signature);\n            continue;\n        }\n        // new shadernode in this local shaderLib\n        shaderNode = shaderNodeClassGlobal[nodeName];\n        if (shaderNode) {\n            // replace shader node globally\n            shaderNode.prototype.signatures = [result.signature];\n            shaderNode.prototype.globalDeclare = '#pragma include \"' + fileName + '\"';\n        } else {\n            shaderNode = createNode(result, fileName);\n        }\n        shaderNodeClassLocal[nodeName] = shaderNode;\n        shaderNodeClassGlobal[nodeName] = shaderNode;\n    }\n\n    return shaderNodeClassLocal;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n    callFunction: callFunction,\n    checkVariableType: checkVariableType,\n    sprintf: sprintf,\n    extractFunctions: extractFunctions\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/utils.js\n// module id = 93\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/utils.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShader_Compiler__ = __webpack_require__(57);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_ShaderGenerator__ = __webpack_require__(56);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_ShaderGeneratorProxy__ = __webpack_require__(230);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShader_ShaderProcessor__ = __webpack_require__(64);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_nodeFactory__ = __webpack_require__(153);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShader_node_Node__ = __webpack_require__(73);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgShader_utils__ = __webpack_require__(93);\n\n\n\n\n\n\n\n\nvar lib = {};\n\nlib.Compiler = __WEBPACK_IMPORTED_MODULE_0_osgShader_Compiler__["a" /* default */];\nlib.ShaderGenerator = __WEBPACK_IMPORTED_MODULE_1_osgShader_ShaderGenerator__["a" /* default */];\nlib.ShaderGeneratorProxy = __WEBPACK_IMPORTED_MODULE_2_osgShader_ShaderGeneratorProxy__["a" /* default */];\nlib.ShaderProcessor = __WEBPACK_IMPORTED_MODULE_3_osgShader_ShaderProcessor__["a" /* default */];\nlib.nodeFactory = __WEBPACK_IMPORTED_MODULE_4_osgShader_nodeFactory__["a" /* default */];\nlib.utils = __WEBPACK_IMPORTED_MODULE_6_osgShader_utils__["a" /* default */];\n\nlib.node = {};\nlib.node.Node = __WEBPACK_IMPORTED_MODULE_5_osgShader_node_Node__["a" /* default */]; // used for inheritance\n__WEBPACK_IMPORTED_MODULE_4_osgShader_nodeFactory__["a" /* default */]._nodes.forEach(function(value, key) {\n    lib.node[key] = value;\n});\n\n// debug utility: set it to one to have verbose in shaders\nlib.debugShaderNode = false;\n/*develblock:start*/\nlib.debugShaderNode = true;\n/*develblock:end*/\n\n/* harmony default export */ __webpack_exports__["default"] = (lib);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/osgShader.js\n// module id = 94\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/osgShader.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgUtil_DisplayGraphRenderer__ = __webpack_require__(234);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgUtil_DisplayGraphNode__ = __webpack_require__(157);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n\n\n\n\nvar $;\n\nvar init$ = function() {\n    try {\n        $ = __webpack_require__(235);\n    } catch (e) {\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].warn(\n            'You will not be able to use osgUtil.DisplayGraph until you add jQuery in your page'\n        );\n    }\n};\n\n// Simple tooltips implementation\nvar SimpleTooltips = function(options) {\n    this.options = options;\n    var css = document.createElement('style');\n    css.type = 'text/css';\n    css.innerHTML = [\n        '.osgDebugSimpleTooltip {',\n        'display: none;',\n        'position: absolute;',\n        'margin-left: 10px;',\n        'border-radius: 4px;',\n        'padding: 10px;',\n        'background: rgba(0,0,0,.9);',\n        'color: #ffffff;',\n        '}',\n        '.osgDebugSimpleTooltip:before {',\n        'content: ',\n        ';',\n        'position: absolute;',\n        'left: -10px;',\n        'top: 8px;',\n        'border: 10px solid transparent;',\n        'border-width: 10px 10px 10px 0;',\n        'border-right-color: rgba(0,0,0,.9);',\n        '}'\n    ].join('\\n');\n    document.getElementsByTagName('head')[0].appendChild(css);\n\n    this.el = document.createElement('div');\n    this.el.className = 'osgDebugSimpleTooltip';\n    document.body.appendChild(this.el);\n    var nodes = document.querySelectorAll(this.options.selector);\n    for (var i = 0; i < nodes.length; i++) {\n        nodes[i].addEventListener('mouseover', this.showTooltip.bind(this), false);\n        nodes[i].addEventListener('mouseout', this.hideTooltip.bind(this), false);\n    }\n};\nSimpleTooltips.prototype = {\n    showTooltip: function(e) {\n        if (!$) return;\n\n        var target = e.currentTarget;\n        this.el.innerHTML = target.getAttribute('title');\n        this.el.style.display = 'block';\n        this.el.style.left =\n            $(target).position().left +\n            $(target)\n                .get(0)\n                .getBoundingClientRect().width +\n            'px';\n        this.el.style.top = $(target).position().top + 'px';\n    },\n    hideTooltip: function() {\n        this.el.style.display = 'none';\n    }\n};\n\nvar DisplayGraph = function() {\n    init$();\n    if (!$) return;\n\n    // indexed with instanceID, references nodes, stateSet, sourceGeometry...\n    // referenced with strings !\n    this._selectables = new window.Map();\n\n    this._graphNode = new __WEBPACK_IMPORTED_MODULE_1_osgUtil_DisplayGraphNode__[\"a\" /* default */](this._selectables);\n    this._graphRender = new __WEBPACK_IMPORTED_MODULE_0_osgUtil_DisplayGraphRenderer__[\"a\" /* default */](this._selectables);\n\n    this._displayNode = true;\n    this._displayRenderer = false;\n\n    // callback when selecting a node\n    this._cbSelect = undefined;\n\n    this._focusedElement = 'graph';\n    this._idToDomElement = new window.Map();\n\n    this._$svg = $('<svg width=100% height=100%></svg>');\n    $('body').append(this._$svg);\n\n    this._css =\n        '.node {text-align: center;cursor: pointer;}.node rect {stroke: #FFF;}.edgePath path {stroke: #FFF;fill: none;}table {text-align: right;}svg {position: absolute;left: 0px;top: 0px;}.osgDebugButton {position: absolute;left: 15px;top: 15px;z-index: 5;border: 0;background: #65a9d7;background: -webkit-gradient(linear, left top, left bottom, from(#3e779d), to(#65a9d7));background: -webkit-linear-gradient(top, #3e779d, #65a9d7);background: -moz-linear-gradient(top, #3e779d, #65a9d7);background: -ms-linear-gradient(top, #3e779d, #65a9d7);background: -o-linear-gradient(top, #3e779d, #65a9d7);padding: 5px 10px;-webkit-border-radius: 7px;-moz-border-radius: 7px;border-radius: 7px;-webkit-box-shadow: rgba(0,0,0,1) 0 1px 0;-moz-box-shadow: rgba(0,0,0,1) 0 1px 0;box-shadow: rgba(0,0,0,1) 0 1px 0;text-shadow: rgba(0,0,0,.4) 0 1px 0;color: white;font-size: 15px;font-family: Helvetica, Arial, Sans-Serif;text-decoration: none;vertical-align: middle;}.osgDebugButton:hover {border-top-color: #28597a;background: #28597a;color: #ccc;}.osgDebugButton:active {border-top-color: #1b435e;background: #1b435e;}.osgDebugSimpleTooltip .osgDebugName {font-weight: bold;color: #60b1fc;margin: 0;}.osgDebugSimpleTooltip .osgDebugDescription {margin: 0;}';\n};\n\nDisplayGraph.instance = function() {\n    if (!DisplayGraph._instance) DisplayGraph._instance = new DisplayGraph();\n    return DisplayGraph._instance;\n};\n\nDisplayGraph.prototype = {\n    getColorFromClassName: __WEBPACK_IMPORTED_MODULE_1_osgUtil_DisplayGraphNode__[\"a\" /* default */].prototype.getColorFromClassName,\n\n    setCallbackSelect: function(cb) {\n        this._cbSelect = cb;\n    },\n\n    reset: function() {\n        if (!$) return;\n\n        this._selectables.clear();\n        this._$svg.empty();\n        this._focusedElement = 'scene';\n        $('.osgDebugButton').hide();\n    },\n\n    setDisplayGraphRenderer: function(bool) {\n        this._displayRenderer = bool;\n    },\n\n    createRenderGraph: function(renderStage) {\n        // called by renderer\n        this._graphRender.createGraph(renderStage);\n        this.displayGraph();\n    },\n\n    createGraph: function(root) {\n        if (!$) return;\n        this.reset();\n\n        this._displayNode = !!root;\n        if (root) {\n            this._graphNode.createGraph(root);\n        }\n\n        // check if asynchronous is necessary\n        if (!this._displayRenderer) {\n            this.displayGraph();\n        } else {\n            // circular dependency\n            __webpack_require__(96).default.debugGraph = true;\n        }\n    },\n\n    // Create and display a dagre d3 graph\n    displayGraph: function() {\n        if (!$) return;\n        if (window.d3 && window.dagreD3) {\n            this._createGraphApply();\n            return;\n        }\n\n        var d3url = '//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js';\n        var dagreurl = '//cdn.jsdelivr.net/dagre-d3/0.2.9/dagre-d3.min.js';\n\n        var cb = this._createGraphApply.bind(this);\n        $.getScript(d3url).done(function() {\n            $.getScript(dagreurl).done(cb);\n        });\n    },\n\n    _createGraphApply: function() {\n        var diGraph = new window.dagreD3.Digraph();\n        if (this._displayNode) this._graphNode.generateNodeAndLink(diGraph);\n        if (this._displayRenderer) this._graphRender.generateNodeAndLink(diGraph);\n\n        // Add the style of the graph\n        this.injectStyleElement();\n        $('.osgDebugButton').show();\n\n        // Create the renderer\n        var renderer = (this.renderer = new window.dagreD3.Renderer());\n\n        // Set up an SVG group so that we can translate the final graph.\n        var svg = window.d3.select(this._$svg.get(0));\n        var svgGroup = svg.append('g');\n\n        // Set initial zoom to 75%\n        var initialScale = 0.75;\n        var oldZoom = renderer.zoom();\n        renderer.zoom(function(g, argSVG) {\n            var zoom = oldZoom(g, argSVG);\n\n            zoom.scale(initialScale).event(argSVG);\n            return zoom;\n        });\n\n        // Simple function to style the tooltip for the given node.\n        var styleTooltip = function(instanceID, description) {\n            // instanceID is used by onNodeSelect to retrieve the node\n            return (\n                '<p class=\"osgDebugName\">' +\n                instanceID +\n                '</p><pre class=\"osgDebugDescription\">' +\n                description +\n                '</pre>'\n            );\n        };\n\n        var idToDom = this._idToDomElement;\n        // Override drawNodes to set up the hover.\n        var oldDrawNodes = renderer.drawNodes();\n        renderer.drawNodes(function(g, argSVG) {\n            var svgNodes = oldDrawNodes(g, argSVG);\n\n            // Set the title on each of the nodes and use tipsy to display the tooltip on hover\n            svgNodes.attr('title', function(d) {\n                idToDom.set(d, this);\n                return styleTooltip(d, g.node(d).description || '');\n            });\n\n            return svgNodes;\n        });\n\n        // Run the renderer. This is what draws the final graph.\n        renderer.run(diGraph, svgGroup);\n\n        this.tooltip = new SimpleTooltips({\n            selector: '.node'\n        });\n\n        // Do a console log of the node (or stateset) and save it in window.*\n        $('.node').click(this.onNodeSelect.bind(this));\n        this.focusOnGraph();\n    },\n\n    selectNode: function(node) {\n        var id = node.getInstanceID();\n        var dom = this._idToDomElement.get(id);\n        if (dom) $(dom).click();\n    },\n\n    onNodeSelect: function(e) {\n        var target = e.currentTarget;\n        var identifier = $(target.getAttribute('title'))[0].innerHTML;\n        var selectables = this._selectables;\n\n        // color the node back\n        if (this.lastNode) {\n            this.lastNode.style.fill = this.lastColor;\n        }\n\n        // non selectables nodes\n        var elt = selectables.get(identifier);\n        if (!elt) return;\n\n        this.lastNode = target.childNodes[0];\n        this.lastColor = this.lastNode.style.fill;\n        target.childNodes[0].style.fill = '#f00';\n\n        window.activeNode = elt;\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].info('window.activeNode is set with the node below !');\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].log(window.activeNode);\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].log('\\n');\n\n        if (this._cbSelect) this._cbSelect(elt);\n    },\n\n    focusOnScene: function() {\n        $('.osgDebugButton').text('Access to the graph');\n        this._$svg.css('zIndex', '-2');\n        this._focusedElement = 'scene';\n    },\n\n    focusOnGraph: function() {\n        $('.osgDebugButton').text('Access to the scene');\n        this._$svg.css('zIndex', '2');\n        $('.osgDebugSimpleTooltip').css('zIndex', '3');\n        this._focusedElement = 'graph';\n    },\n\n    // Apply all the style\n    injectStyleElement: function() {\n        if (this._cssInjected) return;\n        this._cssInjected = true;\n\n        $('body').append('<button class=\"osgDebugButton\">Access to the scene</button>');\n        $('.osgDebugButton').click(\n            function() {\n                if (this._focusedElement === 'scene') this.focusOnGraph();\n                else this.focusOnScene();\n            }.bind(this)\n        );\n\n        var css = document.createElement('style');\n        css.type = 'text/css';\n        css.innerHTML = this._css;\n        document.getElementsByTagName('head')[0].appendChild(css);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DisplayGraph);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/DisplayGraph.js\n// module id = 95\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/DisplayGraph.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_CullSettings__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_CullVisitor__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_RenderStage__ = __webpack_require__(81);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_State__ = __webpack_require__(121);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_StateGraph__ = __webpack_require__(80);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgShader_osgShader__ = __webpack_require__(94);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgUtil_DisplayGraph__ = __webpack_require__(95);\n\n\n\n\n\n\n\n\n\n\n\nvar Renderer = function(camera) {\n    __WEBPACK_IMPORTED_MODULE_3_osg_Object__["a" /* default */].call(this);\n\n    this._state = undefined;\n    this._camera = camera;\n    this._renderStage = undefined;\n    this._stateGraph = undefined;\n\n    this._frameStamp = undefined;\n\n    this._previousCullsettings = new __WEBPACK_IMPORTED_MODULE_1_osg_CullSettings__["a" /* default */]();\n\n    this.setDefaults();\n};\n\nRenderer.debugGraph = false;\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    Renderer,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_Object__["a" /* default */].prototype, {\n        setDefaults: function() {\n            this._state = new __WEBPACK_IMPORTED_MODULE_5_osg_State__["a" /* default */](new __WEBPACK_IMPORTED_MODULE_8_osgShader_osgShader__["default"].ShaderGeneratorProxy());\n\n            this._cullVisitor = new __WEBPACK_IMPORTED_MODULE_2_osg_CullVisitor__["a" /* default */]();\n            this._cullVisitor.setRenderer(this);\n            this._stateGraph = new __WEBPACK_IMPORTED_MODULE_6_osg_StateGraph__["a" /* default */]();\n\n            this.getCamera().setClearColor(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].create());\n            this.setRenderStage(new __WEBPACK_IMPORTED_MODULE_4_osg_RenderStage__["a" /* default */]());\n\n            var osg = __webpack_require__(102).default;\n            var stateSet = this.getCamera().getOrCreateStateSet();\n            stateSet.setAttributeAndModes(new osg.Material());\n            stateSet.setAttributeAndModes(new osg.Depth());\n            stateSet.setAttributeAndModes(new osg.BlendFunc());\n            stateSet.setAttributeAndModes(new osg.CullFace());\n        },\n\n        getCullVisitor: function() {\n            return this._cullVisitor;\n        },\n\n        setCullVisitor: function(cv) {\n            if (cv && !cv.getRenderer()) cv.setRenderer(this);\n            this._cullVisitor = cv;\n        },\n\n        setRenderStage: function(rs) {\n            this._renderStage = rs;\n        },\n\n        getCamera: function() {\n            return this._camera;\n        },\n\n        setFrameStamp: function(fs) {\n            this._frameStamp = fs;\n        },\n\n        getFrameStamp: function() {\n            return this._frameStamp;\n        },\n\n        getState: function() {\n            return this._state;\n        },\n\n        setState: function(state) {\n            this._state = state;\n        },\n\n        setGraphicContext: function(gc) {\n            this._state.setGraphicContext(gc);\n        },\n\n        getGraphicContext: function() {\n            return this._state.getGraphicContext();\n        },\n\n        cullAndDraw: function() {\n            this.cull();\n            this.draw();\n        },\n\n        cull: function() {\n            var camera = this.getCamera();\n            var view = camera.getView();\n\n            this._cullVisitor.setFrameStamp(this._frameStamp);\n\n            // reset stats\n            this._cullVisitor.resetStats();\n\n            // this part of code should be called for each view\n            // right now, we dont support multi view\n\n            // reset all stateGraph per frame\n            __WEBPACK_IMPORTED_MODULE_6_osg_StateGraph__["a" /* default */].reset();\n            this._stateGraph.clean();\n\n            this._renderStage.reset();\n\n            this._cullVisitor.reset();\n            this._cullVisitor.setStateGraph(this._stateGraph);\n            this._cullVisitor.setRenderStage(this._renderStage);\n\n            this._cullVisitor.pushStateSet(camera.getStateSet());\n\n            // save cullSettings\n            this._previousCullsettings.reset();\n            this._previousCullsettings.setCullSettings(this._cullVisitor);\n            this._cullVisitor.setCullSettings(camera);\n            if (\n                this._previousCullsettings.getSettingSourceOverrider() === this._cullVisitor &&\n                this._previousCullsettings.getEnableFrustumCulling()\n            ) {\n                this._cullVisitor.setEnableFrustumCulling(true);\n            }\n\n            // Push reference on the projection stack, it means that if compute near/far\n            // is activated, it will update the projection matrix of the camera\n            this._cullVisitor.pushCameraModelViewProjectionMatrix(\n                camera,\n                camera.getViewMatrix(),\n                camera.getProjectionMatrix()\n            );\n\n            // update bound\n            camera.getBound();\n\n            var light = view.getLight();\n            var View = __webpack_require__(97).default;\n\n            if (light) {\n                switch (view.getLightingMode()) {\n                    case View.LightingMode.HEADLIGHT:\n                        this._cullVisitor.addPositionedAttribute(null, light);\n                        break;\n\n                    case View.LightingMode.SKY_LIGHT:\n                        this._cullVisitor.addPositionedAttribute(camera.getViewMatrix(), light);\n                        break;\n\n                    default:\n                        break;\n                }\n            }\n\n            var viewport = camera.getViewport();\n            var scissor = camera.getScissor();\n\n            this._cullVisitor.pushViewport(viewport);\n\n            this._renderStage.setClearDepth(camera.getClearDepth());\n            this._renderStage.setClearColor(camera.getClearColor());\n            this._renderStage.setClearMask(camera.getClearMask());\n            this._renderStage.setViewport(viewport);\n            this._renderStage.setScissor(scissor);\n\n            // pass de dbpager to the cullvisitor, so plod\'s can do the requests\n            this._cullVisitor.setDatabaseRequestHandler(this._camera.getView().getDatabasePager());\n            // dont add camera on the stack just traverse it\n            this._cullVisitor.handleCullCallbacksAndTraverse(camera);\n\n            // fix projection matrix if camera has near/far auto compute\n            this._cullVisitor.popCameraModelViewProjectionMatrix(camera);\n\n            // Important notes about near/far\n            // If you are using the picking on the main camera and\n            // you use only children sub camera for RTT, your\n            // main camera will keep +/-infinity for near/far because\n            // the computation of near/far is done by camera and use Geometry\n\n            // restore previous state of the camera\n            this._cullVisitor.setCullSettings(this._previousCullsettings);\n\n            this._cullVisitor.popViewport();\n            this._cullVisitor.popStateSet();\n\n            this._renderStage.sort();\n        },\n\n        draw: function() {\n            var state = this.getState();\n\n            // important because cache are used in cullvisitor\n            state.resetCacheFrame();\n\n            // reset stats counter\n            state.resetStats();\n\n            this._renderStage.setCamera(this._camera);\n            this._renderStage.draw(state);\n\n            if (Renderer.debugGraph) {\n                __WEBPACK_IMPORTED_MODULE_9_osgUtil_DisplayGraph__["a" /* default */].instance().createRenderGraph(this._renderStage);\n                Renderer.debugGraph = false;\n            }\n\n            this._renderStage.setCamera(undefined);\n\n            state.applyDefault();\n        }\n    }),\n    \'osgViewer\',\n    \'Renderer\'\n);\n\n/* harmony default export */ __webpack_exports__["default"] = (Renderer);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/Renderer.js\n// module id = 96\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/Renderer.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_FrameStamp__ = __webpack_require__(116);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Light__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Scissor__ = __webpack_require__(87);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_VertexArrayObject__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_WebGLCaps__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgUtil_IntersectionVisitor__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgUtil_LineSegmentIntersector__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osgViewer_Renderer__ = __webpack_require__(96);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osgViewer_Scene__ = __webpack_require__(158);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osgUtil_DisplayGraph__ = __webpack_require__(95);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osg_notify__ = __webpack_require__(2);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// View is normally inherited from osg/View. In osgjs we dont need it yet\n// this split, so everything is in osgViewer/View\n\nvar View = function() {\n    this._camera = new __WEBPACK_IMPORTED_MODULE_1_osg_Camera__["a" /* default */]();\n    this._camera.setName(\'OSGJS camera\');\n\n    this._scene = new __WEBPACK_IMPORTED_MODULE_16_osgViewer_Scene__["a" /* default */]();\n    this._camera.setName(\'OSGJS Scene\');\n\n    this._frameStamp = new __WEBPACK_IMPORTED_MODULE_2_osg_FrameStamp__["a" /* default */]();\n    this._lightingMode = undefined;\n    this._manipulator = undefined;\n    this._canvasWidth = 0;\n    this._canvasHeight = 0;\n\n    this._requestContinousUpdate = true;\n    this._requestRedraw = true;\n\n    this.setLightingMode(View.LightingMode.HEADLIGHT);\n    // assign a renderer to the camera\n    var renderer = this.createRenderer(this.getCamera());\n    renderer.setFrameStamp(this._frameStamp);\n    this.getCamera().setRenderer(renderer);\n    this.getCamera().setView(this);\n};\n\nView.LightingMode = {\n    NO_LIGHT: 0,\n    HEADLIGHT: 1,\n    SKY_LIGHT: 2\n};\n\nView.prototype = {\n    requestRedraw: function() {\n        this._requestRedraw = true;\n    },\n    requestContinuousUpdate: function(bool) {\n        this._requestContinousUpdate = bool;\n    },\n    createRenderer: function(camera) {\n        var render = new __WEBPACK_IMPORTED_MODULE_15_osgViewer_Renderer__["default"](camera);\n        //camera->setStats(new osg::Stats("Camera"));\n        return render;\n    },\n\n    setGraphicContext: function(gc) {\n        this.getCamera()\n            .getRenderer()\n            .getState()\n            .setGraphicContext(gc);\n    },\n\n    getGraphicContext: function() {\n        return this.getCamera()\n            .getRenderer()\n            .getState()\n            .getGraphicContext();\n    },\n\n    initWebGLCaps: function(gl, force) {\n        __WEBPACK_IMPORTED_MODULE_12_osg_WebGLCaps__["a" /* default */].instance(gl, force);\n    },\n\n    // check Each frame because HTML standard inconsistencies\n    // - mobile full-screen, device orientation, etc\n    // peculiarity of webgl canvas resizing here some details\n    // http://webglfundamentals.org/webgl/lessons/webgl-resizing-the-canvas.html\n    // screen size\n    // http://tripleodeon.com/2011/12/first-understand-your-screen/\n    // touchy is touchy: many things to know\n    // http://webglfundamentals.org/webgl/lessons/webgl-anti-patterns.html\n    computeCanvasSize: (function() {\n        return function(canvas) {\n            var clientWidth, clientHeight;\n            clientWidth = canvas.clientWidth;\n            clientHeight = canvas.clientHeight;\n\n            if (clientWidth < 1) clientWidth = 1;\n            if (clientHeight < 1) clientHeight = 1;\n\n            var devicePixelRatio = this._devicePixelRatio;\n\n            var widthPixel = Math.floor(clientWidth * devicePixelRatio);\n            var heightPixel = Math.floor(clientHeight * devicePixelRatio);\n\n            var hasChanged = false;\n            if (this._canvasWidth !== widthPixel) {\n                canvas.width = widthPixel;\n                this._canvasWidth = widthPixel;\n                hasChanged = true;\n            }\n\n            if (this._canvasHeight !== heightPixel) {\n                canvas.height = heightPixel;\n                this._canvasHeight = heightPixel;\n                hasChanged = true;\n            }\n            return hasChanged;\n        };\n    })(),\n\n    getCanvasWidth: function() {\n        return this._canvasWidth;\n    },\n\n    getCanvasHeight: function() {\n        return this._canvasHeight;\n    },\n\n    getCanvasClientWidth: function() {\n        return Math.ceil(this._canvasWidth / this._devicePixelRatio);\n    },\n\n    getCanvasClientHeight: function() {\n        return Math.ceil(this._canvasHeight / this._devicePixelRatio);\n    },\n\n    getCanvasPixelRatio: function() {\n        // in case of VR headset, it\'s probably not relevant anymore\n        return this._devicePixelRatio;\n    },\n\n    setUpView: function(canvas, options) {\n        var devicePixelRatio = window.devicePixelRatio || 1;\n        var overrideDevicePixelRatio = options.getNumber(\'overrideDevicePixelRatio\');\n        var maxDevicePixelRatio = options.getNumber(\'maxDevicePixelRatio\') || -1;\n\n        // override the pixel ratio, used to save pixel on mobile\n        if (typeof overrideDevicePixelRatio === \'number\') {\n            devicePixelRatio = overrideDevicePixelRatio;\n        } else if (maxDevicePixelRatio !== -1) {\n            devicePixelRatio = Math.min(devicePixelRatio, maxDevicePixelRatio);\n        }\n        this._devicePixelRatio = devicePixelRatio;\n\n        this.computeCanvasSize(canvas);\n\n        var width = canvas.width;\n        var height = canvas.height;\n        var ratio = width / height;\n\n        this._camera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */](0, 0, width, height));\n        this._camera.setScissor(new __WEBPACK_IMPORTED_MODULE_9_osg_Scissor__["a" /* default */]());\n\n        this._camera.setGraphicContext(this.getGraphicContext());\n        __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].lookAt(\n            this._camera.getViewMatrix(),\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, -10.0),\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create(),\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0)\n        );\n        __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].perspective(\n            this._camera.getProjectionMatrix(),\n            Math.PI / 180 * 55,\n            ratio,\n            1.0,\n            1000.0\n        );\n\n        if (options && options.enableFrustumCulling)\n            this.getCamera()\n                .getRenderer()\n                .getCullVisitor()\n                .setEnableFrustumCulling(true);\n\n        // add a function to refresh the graph from the console\n        if (options && options.debugGraph) {\n            var camera = this.getCamera();\n            __WEBPACK_IMPORTED_MODULE_17_osgUtil_DisplayGraph__["a" /* default */].instance().refreshGraph = function() {\n                var displayGraph = __WEBPACK_IMPORTED_MODULE_17_osgUtil_DisplayGraph__["a" /* default */].instance();\n                displayGraph.setDisplayGraphRenderer(true);\n                displayGraph.createGraph(camera);\n            };\n\n            __WEBPACK_IMPORTED_MODULE_18_osg_notify__["a" /* default */].log(\n                \'to refresh the graphs type in the console:\\nOSG.osgUtil.DisplayGraph.instance().refreshGraph()\'\n            );\n        }\n    },\n\n    /**\n     * X = 0 at the left\n     * Y = 0 at the BOTTOM\n     */\n    computeIntersections: function(x, y, traversalMask) {\n        /*jshint bitwise: false */\n        if (traversalMask === undefined) {\n            traversalMask = ~0;\n        }\n        /*jshint bitwise: true */\n\n        if (!this._lsi) {\n            this._lsi = new __WEBPACK_IMPORTED_MODULE_14_osgUtil_LineSegmentIntersector__["a" /* default */]();\n        } else {\n            this._lsi.reset();\n        }\n\n        if (!this._origIntersect) {\n            this._origIntersect = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            this._dstIntersect = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n        }\n\n        this._lsi.set(\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(this._origIntersect, x, y, 0.0),\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(this._dstIntersect, x, y, 1.0)\n        );\n\n        if (!this._iv) {\n            this._iv = new __WEBPACK_IMPORTED_MODULE_13_osgUtil_IntersectionVisitor__["a" /* default */]();\n            this._iv.setIntersector(this._lsi);\n        } else {\n            this._iv.reset();\n        }\n        this._iv.setTraversalMask(traversalMask);\n        this._camera.accept(this._iv);\n\n        return this._lsi.getIntersections();\n    },\n\n    setFrameStamp: function(frameStamp) {\n        this._frameStamp = frameStamp;\n    },\n\n    getFrameStamp: function() {\n        return this._frameStamp;\n    },\n\n    setCamera: function(camera) {\n        this._camera = camera;\n    },\n\n    getCamera: function() {\n        return this._camera;\n    },\n\n    setSceneData: function(node) {\n        var previousNode = this._scene.getSceneData();\n        if (node === previousNode) return;\n\n        this._scene.setSceneData(node);\n\n        var children = this._camera.getChildren();\n        var statsNode = undefined;\n        for (var i = 0, l = children.length; i < l; i++) {\n            if (children[i].getName() === \'osgStats\') {\n                statsNode = children[i];\n                break;\n            }\n        }\n        this._camera.removeChildren();\n        this._camera.addChild(node);\n        if (statsNode) this._camera.addChild(statsNode);\n    },\n\n    getSceneData: function() {\n        return this._scene.getSceneData();\n    },\n\n    setDatabasePager: function(dbpager) {\n        this._scene.setDatabasePager(dbpager);\n    },\n\n    getDatabasePager: function() {\n        return this._scene.getDatabasePager();\n    },\n\n    getScene: function() {\n        return this._scene;\n    },\n\n    getManipulator: function() {\n        return this._manipulator;\n    },\n\n    setManipulator: function(manipulator) {\n        this._manipulator = manipulator;\n    },\n\n    getLight: function() {\n        return this._light;\n    },\n\n    setLight: function(light) {\n        this._light = light;\n        if (this._lightingMode !== View.LightingMode.NO_LIGHT) {\n            this._scene.getOrCreateStateSet().setAttributeAndModes(this._light);\n        }\n    },\n\n    getLightingMode: function() {\n        return this._lightingMode;\n    },\n\n    setLightingMode: function(lightingMode) {\n        if (this._lightingMode !== lightingMode) {\n            this._lightingMode = lightingMode;\n\n            if (this._lightingMode !== View.LightingMode.NO_LIGHT) {\n                if (!this._light) this._light = new __WEBPACK_IMPORTED_MODULE_4_osg_Light__["a" /* default */]();\n            } else {\n                this._light = undefined;\n            }\n        }\n    },\n\n    // In OSG this call is done in SceneView\n    flushDeletedGLObjects: function(availableTimeBudget) {\n        // Flush all deleted OpenGL objects within the specified availableTime\n        var gl = this.getGraphicContext();\n        var availableTime = availableTimeBudget;\n        availableTime = __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__["a" /* default */].flushDeletedGLBufferArrays(gl, availableTime);\n        availableTime = __WEBPACK_IMPORTED_MODULE_11_osg_VertexArrayObject__["a" /* default */].flushDeletedGLVertexArrayObjects(gl, availableTime);\n        availableTime = __WEBPACK_IMPORTED_MODULE_6_osg_Texture__["default"].getTextureManager(gl).flushDeletedTextureObjects(gl, availableTime);\n        availableTime = __WEBPACK_IMPORTED_MODULE_7_osg_Program__["a" /* default */].flushDeletedGLPrograms(gl, availableTime);\n        availableTime = __WEBPACK_IMPORTED_MODULE_8_osg_Shader__["a" /* default */].flushDeletedGLShaders(gl, availableTime);\n        availableTime = __WEBPACK_IMPORTED_MODULE_3_osg_FrameBufferObject__["a" /* default */].flushDeletedGLFrameBuffers(gl, availableTime);\n        __WEBPACK_IMPORTED_MODULE_3_osg_FrameBufferObject__["a" /* default */].flushDeletedGLRenderBuffers(gl, availableTime);\n    },\n\n    flushAllDeletedGLObjects: function() {\n        // Flush all deleted OpenGL objects\n        var gl = this.getGraphicContext();\n        __WEBPACK_IMPORTED_MODULE_11_osg_VertexArrayObject__["a" /* default */].flushAllDeletedGLVertexArrayObjects(gl);\n        __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__["a" /* default */].flushAllDeletedGLBufferArrays(gl);\n        __WEBPACK_IMPORTED_MODULE_6_osg_Texture__["default"].getTextureManager(gl).flushAllDeletedTextureObjects(gl);\n        __WEBPACK_IMPORTED_MODULE_7_osg_Program__["a" /* default */].flushAllDeletedGLPrograms(gl);\n        __WEBPACK_IMPORTED_MODULE_8_osg_Shader__["a" /* default */].flushAllDeletedGLShaders(gl);\n        __WEBPACK_IMPORTED_MODULE_3_osg_FrameBufferObject__["a" /* default */].flushAllDeletedGLFrameBuffers(gl);\n        __WEBPACK_IMPORTED_MODULE_3_osg_FrameBufferObject__["a" /* default */].flushAllDeletedGLRenderBuffers(gl);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["default"] = (View);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/View.js\n// module id = 97\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/View.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var Graph = function() {\n    this._values = new Float32Array(Graph.maxGraphValue);\n    this._index = 0;\n    this._maxValue = 0.0;\n    this._x = 0;\n    this._y = 0;\n};\nGraph.maxGraphValue = 120;\nGraph.prototype = {\n    getIndex: function() {\n        return this._index;\n    },\n    getValues: function() {\n        return this._values;\n    },\n    setDisplayPosition: function(x, y) {\n        this._x = x;\n        this._y = y;\n    },\n    getX: function() {\n        return this._x;\n    },\n    getY: function() {\n        return this._y;\n    },\n    addValue: function(value, uvColor) {\n        var index = this._index;\n        this._maxValue = value > this._maxValue ? value : this._maxValue;\n        this._maxValue *= 0.99;\n        this._values[index] = value / (this._maxValue * 1.1);\n        if (uvColor) this._values[index] += uvColor;\n        this._index = (this._index + 1) % Graph.maxGraphValue;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (Graph);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/Graph.js\n// module id = 98\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/Graph.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_utils__ = __webpack_require__(0);\n\n\n\n\n/**\n *  ShadowTechnique provides an implementation interface of shadow techniques.\n *  @class ShadowTechnique\n */\nvar ShadowTechnique = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n\n    this._shadowedScene = undefined;\n    this._dirty = false;\n    this._continuousUpdate = true;\n    // since dirtied, handy for static shadow map\n    this._needRedraw = true;\n};\n\n/** @lends ShadowTechnique.prototype */\n__WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].createPrototypeObject(\n    ShadowTechnique,\n    __WEBPACK_IMPORTED_MODULE_2_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        dirty: function() {\n            this._dirty = true;\n        },\n\n        getShadowedScene: function() {\n            return this._shadowedScene;\n        },\n\n        setContinuousUpdate: function(enabled) {\n            this._continuousUpdate = enabled;\n        },\n\n        isContinuousUpdate: function() {\n            return this._continuousUpdate;\n        },\n\n        needRedraw: function() {\n            return this._needRedraw;\n        },\n\n        requestRedraw: function() {\n            this._needRedraw = true;\n        },\n\n        setShadowedScene: function(shadowedScene) {\n            this._shadowedScene = shadowedScene;\n        },\n\n        init: function() {\n            // well shouldn\'t be called\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'No ShadowTechnique activated: normal rendering activated\');\n        },\n\n        valid: function() {\n            // make sure abstract class not used.\n            return false;\n        },\n\n        // update the technic\n        updateShadowTechnique: function(/*nodeVisitor*/) {},\n\n        cullShadowCasting: function(/*cullVisitor*/) {},\n\n        cleanSceneGraph: function() {\n            // well shouldn\'t be called\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'No ShadowTechnique activated: normal rendering activated\');\n        }\n    }),\n    \'osgShadow\',\n    \'ShadowTechnique\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ShadowTechnique);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowTechnique.js\n// module id = 99\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowTechnique.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n\n\n/**\n * ShadowTexture Attribute encapsulate Texture webgl object\n * with Shadow specificities (no need of texcoord,fragtexcoord)\n * trigger hash change when changing texture precision from float to byt\n * shadowSettings.js header for param explanations\n * @class ShadowTexture\n * @inherits StateAttribute\n */\nvar ShadowTexture = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Texture__["default"].call(this);\n\n    this._uniforms = {};\n    this._mapSize = __WEBPACK_IMPORTED_MODULE_4_osg_glMatrix__["g" /* vec4 */].create();\n    this._renderSize = __WEBPACK_IMPORTED_MODULE_4_osg_glMatrix__["e" /* vec2 */].create();\n    this._lightNumber = -1; // default for a valid cloneType\n    this._dirtyHash = true;\n    this._hash = \'\';\n};\n\nShadowTexture.uniforms = {};\n/** @lends Texture.prototype */\n__WEBPACK_IMPORTED_MODULE_3_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    ShadowTexture,\n    __WEBPACK_IMPORTED_MODULE_3_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Texture__["default"].prototype, {\n        cloneType: function() {\n            return new ShadowTexture();\n        },\n        invalidate: function() {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__["default"].prototype.invalidate.call(this);\n            this.dirty();\n        },\n        hasLightNumber: function(lightNum) {\n            return this._lightNumber === lightNum;\n        },\n\n        setLightNumber: function(lun) {\n            this._lightNumber = lun;\n            this._dirtyHash = true;\n        },\n\n        getLightNumber: function() {\n            return this._lightNumber;\n        },\n\n        getUniformName: function(name) {\n            var prefix = \'Shadow_\' + this.getType() + this._lightNumber.toString();\n            return \'u\' + prefix + \'_\' + name;\n        },\n\n        setInternalFormatType: function(value) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__["default"].prototype.setInternalFormatType.call(this, value);\n            this._dirtyHash = true;\n        },\n\n        getOrCreateUniforms: function(unit) {\n            // uniform are once per CLASS attribute, not per instance\n            var obj = ShadowTexture;\n\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].assert(unit !== undefined);\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].assert(this._lightNumber !== -1);\n\n            if (obj.uniforms[unit] !== undefined) return obj.uniforms[unit];\n\n            var uniforms = (obj.uniforms[unit] = {\n                ViewRight: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'viewRight\')),\n                ViewUp: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'viewUp\')),\n                ViewLook: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'viewLook\')),\n                Projection: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat3(this.getUniformName(\'projection\')),\n                DepthRange: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat2(this.getUniformName(\'depthRange\')),\n                MapSize: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4(this.getUniformName(\'mapSize\')),\n                RenderSize: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat2(this.getUniformName(\'renderSize\'))\n            });\n\n            // Dual Uniform of texture, needs:\n            // - Sampler (type of texture)\n            // - Int (texture unit)\n            // tells Shader Program where to find it\n            var name = \'Texture\' + unit;\n            var uniform = __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createInt1(unit, name);\n            uniforms[name] = uniform;\n\n            return obj.uniforms[unit];\n        },\n\n        setViewMatrix: function(viewMatrix) {\n            this._viewMatrix = viewMatrix;\n        },\n\n        setProjection: function(projection) {\n            this._projection = projection;\n        },\n\n        setDepthRange: function(depthRange) {\n            this._depthRange = depthRange;\n        },\n\n        setTextureSize: function(w, h) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__["default"].prototype.setTextureSize.call(this, w, h);\n            this.dirty();\n            this._mapSize[0] = w;\n            this._mapSize[1] = h;\n            this._mapSize[2] = 1.0 / w;\n            this._mapSize[3] = 1.0 / h;\n\n            this._renderSize[0] = 1.0 / w;\n            this._renderSize[1] = 1.0 / h;\n        },\n\n        // optimize a mat4 into 3 vec4 unforms\n        _updateViewMatrixUniforms: function(viewMatrix, viewRight, viewUp, viewLook) {\n            var v;\n            var m = viewMatrix;\n            v = viewRight.getInternalArray();\n            v[0] = m[0];\n            v[1] = m[4];\n            v[2] = m[8];\n            v[3] = m[12];\n\n            v = viewUp.getInternalArray();\n            v[0] = m[1];\n            v[1] = m[5];\n            v[2] = m[9];\n            v[3] = m[13];\n\n            v = viewLook.getInternalArray();\n            v[0] = m[2];\n            v[1] = m[6];\n            v[2] = m[10];\n            v[3] = m[14];\n        },\n\n        apply: function(state, texNumber) {\n            // Texture stuff: call parent class method\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__["default"].prototype.apply.call(this, state, texNumber);\n\n            if (this._lightNumber === -1) return;\n\n            // update Uniforms\n            var uniformMap = this.getOrCreateUniforms(texNumber);\n\n            this._updateViewMatrixUniforms(\n                this._viewMatrix,\n                uniformMap.ViewRight,\n                uniformMap.ViewUp,\n                uniformMap.ViewLook\n            );\n            uniformMap.Projection.setFloat3(this._projection);\n            uniformMap.DepthRange.setFloat2(this._depthRange);\n            uniformMap.MapSize.setFloat4(this._mapSize);\n            uniformMap.RenderSize.setFloat2(this._renderSize);\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        },\n\n        _computeInternalHash: function() {\n            return this.getTypeMember() + \'_\' + this._lightNumber + \'_\' + this._type;\n        }\n    }),\n    \'osgShadow\',\n    \'ShadowTexture\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ShadowTexture);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowTexture.js\n// module id = 100\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowTexture.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_json_loader_package_json__ = __webpack_require__(176);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_json_loader_package_json___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_json_loader_package_json__);\n\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    name: __WEBPACK_IMPORTED_MODULE_0_json_loader_package_json___default.a.name,\n    version: __WEBPACK_IMPORTED_MODULE_0_json_loader_package_json___default.a.version,\n    author: __WEBPACK_IMPORTED_MODULE_0_json_loader_package_json___default.a.author\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgNameSpace.js\n// module id = 101\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgNameSpace.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_AutoTransform__ = __webpack_require__(74);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BillboardAttribute__ = __webpack_require__(186);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_BlendColor__ = __webpack_require__(187);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_BoundingSphere__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_BufferArrayProxy__ = __webpack_require__(76);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_ColorMask__ = __webpack_require__(188);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_ComputeBoundsVisitor__ = __webpack_require__(58);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_computeMatrixFromNodePath__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_CullFace__ = __webpack_require__(50);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_CullingSet__ = __webpack_require__(108);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osg_CullSettings__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osg_CullStack__ = __webpack_require__(109);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osg_CullVisitor__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osg_DrawArrayLengths__ = __webpack_require__(115);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21_osg_DrawArraysInstanced__ = __webpack_require__(193);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22_osg_DrawElementsInstanced__ = __webpack_require__(194);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23_osg_EllipsoidModel__ = __webpack_require__(195);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25_osg_FrameStamp__ = __webpack_require__(116);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_30_osg_ImageStream__ = __webpack_require__(196);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_31_osg_KdTree__ = __webpack_require__(117);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_32_osg_KdTreeBuilder__ = __webpack_require__(197);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_33_osg_Light__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_34_osg_LightSource__ = __webpack_require__(79);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_35_osg_LineWidth__ = __webpack_require__(198);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_36_osg_Lod__ = __webpack_require__(82);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_37_osg_Material__ = __webpack_require__(86);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_38_osg_math__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_39_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_40_osg_PooledResource__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_41_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_42_osg_PooledMap__ = __webpack_require__(60);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_43_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_44_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_45_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_46_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_47_osg_Options__ = __webpack_require__(75);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_48_osg_PagedLOD__ = __webpack_require__(83);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_49_osg_Polytope__ = __webpack_require__(77);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_50_osg_PointSizeAttribute__ = __webpack_require__(199);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_51_osg_Plane__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_52_osg_primitiveFunctor__ = __webpack_require__(200);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_53_osg_primitiveIndexFunctor__ = __webpack_require__(85);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_54_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_55_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_56_osg_Projection__ = __webpack_require__(78);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_57_osg_RenderBin__ = __webpack_require__(61);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_58_osg_RenderLeaf__ = __webpack_require__(110);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_59_osg_RenderStage__ = __webpack_require__(81);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_60_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_61_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_62_osg_StackObjectPairPool__ = __webpack_require__(120);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_63_osg_State__ = __webpack_require__(121);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_64_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_65_osg_StateGraph__ = __webpack_require__(80);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_66_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_67_osg_Switch__ = __webpack_require__(111);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_68_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_69_osg_TextureCubeMap__ = __webpack_require__(216);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_70_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_71_osg_TriangleIndexFunctor__ = __webpack_require__(217);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_72_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_73_osg_UpdateVisitor__ = __webpack_require__(122);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_74_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_75_osg_Viewport__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_76_osg_Scissor__ = __webpack_require__(87);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_77_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_78_osg_Timer__ = __webpack_require__(22);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_79_osg_TimerGPU__ = __webpack_require__(123);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_80_osg_VertexArrayObject__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_81_osg_WebGLCaps__ = __webpack_require__(18);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// $$ SOURCE_CODE_MODIFIED\n\n\n// $$ SOURCE_CODE_MODIFIED\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar osg = {};\nosg.AutoTransform = __WEBPACK_IMPORTED_MODULE_0_osg_AutoTransform__["a" /* default */];\nosg.BillboardAttribute = __WEBPACK_IMPORTED_MODULE_1_osg_BillboardAttribute__["a" /* default */];\nosg.BlendColor = __WEBPACK_IMPORTED_MODULE_2_osg_BlendColor__["a" /* default */];\nosg.BlendFunc = __WEBPACK_IMPORTED_MODULE_3_osg_BlendFunc__["a" /* default */];\nosg.BoundingBox = __WEBPACK_IMPORTED_MODULE_4_osg_BoundingBox__["a" /* default */];\nosg.BoundingSphere = __WEBPACK_IMPORTED_MODULE_5_osg_BoundingSphere__["a" /* default */];\nosg.BufferArray = __WEBPACK_IMPORTED_MODULE_6_osg_BufferArray__["a" /* default */];\nosg.BufferArrayProxy = __WEBPACK_IMPORTED_MODULE_7_osg_BufferArrayProxy__["a" /* default */];\nosg.ColorMask = __WEBPACK_IMPORTED_MODULE_9_osg_ColorMask__["a" /* default */];\nosg.Camera = __WEBPACK_IMPORTED_MODULE_8_osg_Camera__["a" /* default */];\nosg.ColorMask = __WEBPACK_IMPORTED_MODULE_9_osg_ColorMask__["a" /* default */];\nosg.ComputeBoundsVisitor = __WEBPACK_IMPORTED_MODULE_10_osg_ComputeBoundsVisitor__["default"];\n__WEBPACK_IMPORTED_MODULE_74_osg_utils__["a" /* default */].objectMix(osg, __WEBPACK_IMPORTED_MODULE_11_osg_computeMatrixFromNodePath__["a" /* default */]);\nosg.CullFace = __WEBPACK_IMPORTED_MODULE_12_osg_CullFace__["a" /* default */];\nosg.CullingSet = __WEBPACK_IMPORTED_MODULE_13_osg_CullingSet__["a" /* default */];\nosg.CullSettings = __WEBPACK_IMPORTED_MODULE_14_osg_CullSettings__["a" /* default */];\nosg.CullStack = __WEBPACK_IMPORTED_MODULE_15_osg_CullStack__["a" /* default */];\nosg.CullVisitor = __WEBPACK_IMPORTED_MODULE_16_osg_CullVisitor__["a" /* default */];\nosg.Depth = __WEBPACK_IMPORTED_MODULE_17_osg_Depth__["a" /* default */];\nosg.DrawArrayLengths = __WEBPACK_IMPORTED_MODULE_18_osg_DrawArrayLengths__["a" /* default */];\nosg.DrawArrays = __WEBPACK_IMPORTED_MODULE_19_osg_DrawArrays__["a" /* default */];\nosg.DrawElements = __WEBPACK_IMPORTED_MODULE_20_osg_DrawElements__["a" /* default */];\n// $$ SOURCE_CODE_MODIFIED\nosg.DrawArraysInstanced = __WEBPACK_IMPORTED_MODULE_21_osg_DrawArraysInstanced__["a" /* default */];\nosg.DrawElementsInstanced = __WEBPACK_IMPORTED_MODULE_22_osg_DrawElementsInstanced__["a" /* default */];\n// $$ SOURCE_CODE_MODIFIED\nosg.EllipsoidModel = __WEBPACK_IMPORTED_MODULE_23_osg_EllipsoidModel__["a" /* default */];\nosg.WGS_84_RADIUS_EQUATOR = __WEBPACK_IMPORTED_MODULE_23_osg_EllipsoidModel__["a" /* default */].WGS_84_RADIUS_EQUATOR;\nosg.WGS_84_RADIUS_POLAR = __WEBPACK_IMPORTED_MODULE_23_osg_EllipsoidModel__["a" /* default */].WGS_84_RADIUS_POLAR;\nosg.FrameBufferObject = __WEBPACK_IMPORTED_MODULE_24_osg_FrameBufferObject__["a" /* default */];\nosg.FrameStamp = __WEBPACK_IMPORTED_MODULE_25_osg_FrameStamp__["a" /* default */];\nosg.Geometry = __WEBPACK_IMPORTED_MODULE_26_osg_Geometry__["a" /* default */];\nosg.GLObject = __WEBPACK_IMPORTED_MODULE_28_osg_GLObject__["a" /* default */];\nosg.Image = __WEBPACK_IMPORTED_MODULE_29_osg_Image__["a" /* default */];\nosg.ImageStream = __WEBPACK_IMPORTED_MODULE_30_osg_ImageStream__["a" /* default */];\nosg.KdTree = __WEBPACK_IMPORTED_MODULE_31_osg_KdTree__["a" /* default */];\nosg.KdTreeBuilder = __WEBPACK_IMPORTED_MODULE_32_osg_KdTreeBuilder__["a" /* default */];\nosg.Light = __WEBPACK_IMPORTED_MODULE_33_osg_Light__["a" /* default */];\nosg.LightSource = __WEBPACK_IMPORTED_MODULE_34_osg_LightSource__["a" /* default */];\nosg.LineWidth = __WEBPACK_IMPORTED_MODULE_35_osg_LineWidth__["a" /* default */];\nosg.Lod = __WEBPACK_IMPORTED_MODULE_36_osg_Lod__["a" /* default */];\nosg.Material = __WEBPACK_IMPORTED_MODULE_37_osg_Material__["default"];\n__WEBPACK_IMPORTED_MODULE_74_osg_utils__["a" /* default */].objectMix(osg, __WEBPACK_IMPORTED_MODULE_38_osg_math__["a" /* default */]);\nosg.MatrixTransform = __WEBPACK_IMPORTED_MODULE_39_osg_MatrixTransform__["a" /* default */];\nosg.PooledResource = __WEBPACK_IMPORTED_MODULE_40_osg_PooledResource__["a" /* default */];\nosg.PooledArray = __WEBPACK_IMPORTED_MODULE_41_osg_PooledArray__["a" /* default */];\nosg.PooledMap = __WEBPACK_IMPORTED_MODULE_42_osg_PooledMap__["a" /* default */];\nosg.Node = __WEBPACK_IMPORTED_MODULE_43_osg_Node__["a" /* default */];\nosg.NodeVisitor = __WEBPACK_IMPORTED_MODULE_44_osg_NodeVisitor__["a" /* default */];\n__WEBPACK_IMPORTED_MODULE_74_osg_utils__["a" /* default */].objectMix(osg, __WEBPACK_IMPORTED_MODULE_45_osg_notify__["a" /* default */]);\nosg.Object = __WEBPACK_IMPORTED_MODULE_46_osg_Object__["a" /* default */];\nosg.Options = __WEBPACK_IMPORTED_MODULE_47_osg_Options__["a" /* default */];\nosg.PagedLOD = __WEBPACK_IMPORTED_MODULE_48_osg_PagedLOD__["a" /* default */];\nosg.Plane = __WEBPACK_IMPORTED_MODULE_51_osg_Plane__["a" /* default */];\nosg.PointSizeAttribute = __WEBPACK_IMPORTED_MODULE_50_osg_PointSizeAttribute__["a" /* default */];\nosg.Polytope = __WEBPACK_IMPORTED_MODULE_49_osg_Polytope__["a" /* default */];\nosg.primitiveSet = __WEBPACK_IMPORTED_MODULE_54_osg_primitiveSet__["a" /* default */];\nosg.primitiveFunctor = __WEBPACK_IMPORTED_MODULE_52_osg_primitiveFunctor__["a" /* default */];\nosg.primitiveIndexFunctor = __WEBPACK_IMPORTED_MODULE_53_osg_primitiveIndexFunctor__["a" /* default */];\nosg.Program = __WEBPACK_IMPORTED_MODULE_55_osg_Program__["a" /* default */];\nosg.Projection = __WEBPACK_IMPORTED_MODULE_56_osg_Projection__["a" /* default */];\nosg.RenderBin = __WEBPACK_IMPORTED_MODULE_57_osg_RenderBin__["a" /* default */];\nosg.RenderLeaf = __WEBPACK_IMPORTED_MODULE_58_osg_RenderLeaf__["a" /* default */];\nosg.RenderStage = __WEBPACK_IMPORTED_MODULE_59_osg_RenderStage__["a" /* default */];\nosg.Shader = __WEBPACK_IMPORTED_MODULE_60_osg_Shader__["a" /* default */];\n__WEBPACK_IMPORTED_MODULE_74_osg_utils__["a" /* default */].objectMix(osg, __WEBPACK_IMPORTED_MODULE_61_osg_shape__["a" /* default */]);\nosg.StackObjectPairPool = __WEBPACK_IMPORTED_MODULE_62_osg_StackObjectPairPool__["a" /* default */];\nosg.State = __WEBPACK_IMPORTED_MODULE_63_osg_State__["a" /* default */];\nosg.StateAttribute = __WEBPACK_IMPORTED_MODULE_64_osg_StateAttribute__["a" /* default */];\nosg.StateGraph = __WEBPACK_IMPORTED_MODULE_65_osg_StateGraph__["a" /* default */];\nosg.StateSet = __WEBPACK_IMPORTED_MODULE_66_osg_StateSet__["a" /* default */];\nosg.Scissor = __WEBPACK_IMPORTED_MODULE_76_osg_Scissor__["a" /* default */];\nosg.Switch = __WEBPACK_IMPORTED_MODULE_67_osg_Switch__["a" /* default */];\nosg.Texture = __WEBPACK_IMPORTED_MODULE_68_osg_Texture__["default"];\nosg.TextureCubeMap = __WEBPACK_IMPORTED_MODULE_69_osg_TextureCubeMap__["a" /* default */];\nosg.Transform = __WEBPACK_IMPORTED_MODULE_70_osg_Transform__["a" /* default */];\nosg.TriangleIndexFunctor = __WEBPACK_IMPORTED_MODULE_71_osg_TriangleIndexFunctor__["a" /* default */];\nosg.Uniform = __WEBPACK_IMPORTED_MODULE_72_osg_Uniform__["a" /* default */];\nosg.UpdateVisitor = __WEBPACK_IMPORTED_MODULE_73_osg_UpdateVisitor__["a" /* default */];\n__WEBPACK_IMPORTED_MODULE_74_osg_utils__["a" /* default */].objectMix(osg, __WEBPACK_IMPORTED_MODULE_74_osg_utils__["a" /* default */]);\nosg.Viewport = __WEBPACK_IMPORTED_MODULE_75_osg_Viewport__["a" /* default */];\nosg.VertexArrayObject = __WEBPACK_IMPORTED_MODULE_80_osg_VertexArrayObject__["a" /* default */];\nosg.vec2 = __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__["a" /* glm */].vec2;\nosg.vec3 = __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__["a" /* glm */].vec3;\nosg.vec4 = __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__["a" /* glm */].vec4;\nosg.quat = __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__["a" /* glm */].quat;\nosg.mat3 = __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__["a" /* glm */].mat3;\nosg.mat4 = __WEBPACK_IMPORTED_MODULE_27_osg_glMatrix__["a" /* glm */].mat4;\n\nosg.Transform.RELATIVE_RF = __WEBPACK_IMPORTED_MODULE_77_osg_transformEnums__["a" /* default */].RELATIVE_RF;\nosg.Transform.ABSOLUTE_RF = __WEBPACK_IMPORTED_MODULE_77_osg_transformEnums__["a" /* default */].ABSOLUTE_RF;\nosg.Timer = __WEBPACK_IMPORTED_MODULE_78_osg_Timer__["a" /* default */];\nosg.TimerGPU = __WEBPACK_IMPORTED_MODULE_79_osg_TimerGPU__["a" /* default */];\nosg.WebGLCaps = __WEBPACK_IMPORTED_MODULE_81_osg_WebGLCaps__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["default"] = (osg);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/osg.js\n// module id = 102\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/osg.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\nvar applyFunctionArray = [];\n\nvar registerApplyFunction = function(type, apply) {\n    applyFunctionArray[type] = apply;\n};\n\nvar getApplyFunction = function(type) {\n    return applyFunctionArray[type];\n};\n\n/* harmony default export */ __webpack_exports__["default"] = ({\n    applyFunctionArray: applyFunctionArray,\n    registerApplyFunction: registerApplyFunction,\n    getApplyFunction: getApplyFunction\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/cullVisitorHelper.js\n// module id = 103\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/cullVisitorHelper.js?')},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 3x3 Matrix\n * @name mat3\n */\nvar mat3 = {};\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\nmat3.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(9);\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 1;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 1;\n    return out;\n};\n\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {mat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\nmat3.fromMat4 = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[4];\n    out[4] = a[5];\n    out[5] = a[6];\n    out[6] = a[8];\n    out[7] = a[9];\n    out[8] = a[10];\n    return out;\n};\n\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {mat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\nmat3.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(9);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    return out;\n};\n\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the source matrix\n * @returns {mat3} out\n */\nmat3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    return out;\n};\n\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\nmat3.fromValues = function(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n    var out = new glMatrix.ARRAY_TYPE(9);\n    out[0] = m00;\n    out[1] = m01;\n    out[2] = m02;\n    out[3] = m10;\n    out[4] = m11;\n    out[5] = m12;\n    out[6] = m20;\n    out[7] = m21;\n    out[8] = m22;\n    return out;\n};\n\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\nmat3.set = function(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n    out[0] = m00;\n    out[1] = m01;\n    out[2] = m02;\n    out[3] = m10;\n    out[4] = m11;\n    out[5] = m12;\n    out[6] = m20;\n    out[7] = m21;\n    out[8] = m22;\n    return out;\n};\n\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\nmat3.identity = function(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 1;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 1;\n    return out;\n};\n\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the source matrix\n * @returns {mat3} out\n */\nmat3.transpose = function(out, a) {\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\n    if (out === a) {\n        var a01 = a[1], a02 = a[2], a12 = a[5];\n        out[1] = a[3];\n        out[2] = a[6];\n        out[3] = a01;\n        out[5] = a[7];\n        out[6] = a02;\n        out[7] = a12;\n    } else {\n        out[0] = a[0];\n        out[1] = a[3];\n        out[2] = a[6];\n        out[3] = a[1];\n        out[4] = a[4];\n        out[5] = a[7];\n        out[6] = a[2];\n        out[7] = a[5];\n        out[8] = a[8];\n    }\n    \n    return out;\n};\n\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the source matrix\n * @returns {mat3} out\n */\nmat3.invert = function(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2],\n        a10 = a[3], a11 = a[4], a12 = a[5],\n        a20 = a[6], a21 = a[7], a22 = a[8],\n\n        b01 = a22 * a11 - a12 * a21,\n        b11 = -a22 * a10 + a12 * a20,\n        b21 = a21 * a10 - a11 * a20,\n\n        // Calculate the determinant\n        det = a00 * b01 + a01 * b11 + a02 * b21;\n\n    if (!det) { \n        return null; \n    }\n    det = 1.0 / det;\n\n    out[0] = b01 * det;\n    out[1] = (-a22 * a01 + a02 * a21) * det;\n    out[2] = (a12 * a01 - a02 * a11) * det;\n    out[3] = b11 * det;\n    out[4] = (a22 * a00 - a02 * a20) * det;\n    out[5] = (-a12 * a00 + a02 * a10) * det;\n    out[6] = b21 * det;\n    out[7] = (-a21 * a00 + a01 * a20) * det;\n    out[8] = (a11 * a00 - a01 * a10) * det;\n    return out;\n};\n\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the source matrix\n * @returns {mat3} out\n */\nmat3.adjoint = function(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2],\n        a10 = a[3], a11 = a[4], a12 = a[5],\n        a20 = a[6], a21 = a[7], a22 = a[8];\n\n    out[0] = (a11 * a22 - a12 * a21);\n    out[1] = (a02 * a21 - a01 * a22);\n    out[2] = (a01 * a12 - a02 * a11);\n    out[3] = (a12 * a20 - a10 * a22);\n    out[4] = (a00 * a22 - a02 * a20);\n    out[5] = (a02 * a10 - a00 * a12);\n    out[6] = (a10 * a21 - a11 * a20);\n    out[7] = (a01 * a20 - a00 * a21);\n    out[8] = (a00 * a11 - a01 * a10);\n    return out;\n};\n\n/**\n * Calculates the determinant of a mat3\n *\n * @param {mat3} a the source matrix\n * @returns {Number} determinant of a\n */\nmat3.determinant = function (a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2],\n        a10 = a[3], a11 = a[4], a12 = a[5],\n        a20 = a[6], a21 = a[7], a22 = a[8];\n\n    return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n};\n\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the first operand\n * @param {mat3} b the second operand\n * @returns {mat3} out\n */\nmat3.multiply = function (out, a, b) {\n    var a00 = a[0], a01 = a[1], a02 = a[2],\n        a10 = a[3], a11 = a[4], a12 = a[5],\n        a20 = a[6], a21 = a[7], a22 = a[8],\n\n        b00 = b[0], b01 = b[1], b02 = b[2],\n        b10 = b[3], b11 = b[4], b12 = b[5],\n        b20 = b[6], b21 = b[7], b22 = b[8];\n\n    out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n    out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n    out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n\n    out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n    out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n    out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n\n    out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n    out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n    out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n    return out;\n};\n\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\nmat3.mul = mat3.multiply;\n\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the matrix to translate\n * @param {vec2} v vector to translate by\n * @returns {mat3} out\n */\nmat3.translate = function(out, a, v) {\n    var a00 = a[0], a01 = a[1], a02 = a[2],\n        a10 = a[3], a11 = a[4], a12 = a[5],\n        a20 = a[6], a21 = a[7], a22 = a[8],\n        x = v[0], y = v[1];\n\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n\n    out[3] = a10;\n    out[4] = a11;\n    out[5] = a12;\n\n    out[6] = x * a00 + y * a10 + a20;\n    out[7] = x * a01 + y * a11 + a21;\n    out[8] = x * a02 + y * a12 + a22;\n    return out;\n};\n\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nmat3.rotate = function (out, a, rad) {\n    var a00 = a[0], a01 = a[1], a02 = a[2],\n        a10 = a[3], a11 = a[4], a12 = a[5],\n        a20 = a[6], a21 = a[7], a22 = a[8],\n\n        s = Math.sin(rad),\n        c = Math.cos(rad);\n\n    out[0] = c * a00 + s * a10;\n    out[1] = c * a01 + s * a11;\n    out[2] = c * a02 + s * a12;\n\n    out[3] = c * a10 - s * a00;\n    out[4] = c * a11 - s * a01;\n    out[5] = c * a12 - s * a02;\n\n    out[6] = a20;\n    out[7] = a21;\n    out[8] = a22;\n    return out;\n};\n\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the matrix to rotate\n * @param {vec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\nmat3.scale = function(out, a, v) {\n    var x = v[0], y = v[1];\n\n    out[0] = x * a[0];\n    out[1] = x * a[1];\n    out[2] = x * a[2];\n\n    out[3] = y * a[3];\n    out[4] = y * a[4];\n    out[5] = y * a[5];\n\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    return out;\n};\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {vec2} v Translation vector\n * @returns {mat3} out\n */\nmat3.fromTranslation = function(out, v) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 1;\n    out[5] = 0;\n    out[6] = v[0];\n    out[7] = v[1];\n    out[8] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\nmat3.fromRotation = function(out, rad) {\n    var s = Math.sin(rad), c = Math.cos(rad);\n\n    out[0] = c;\n    out[1] = s;\n    out[2] = 0;\n\n    out[3] = -s;\n    out[4] = c;\n    out[5] = 0;\n\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {vec2} v Scaling vector\n * @returns {mat3} out\n */\nmat3.fromScaling = function(out, v) {\n    out[0] = v[0];\n    out[1] = 0;\n    out[2] = 0;\n\n    out[3] = 0;\n    out[4] = v[1];\n    out[5] = 0;\n\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 1;\n    return out;\n}\n\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {mat2d} a the matrix to copy\n * @returns {mat3} out\n **/\nmat3.fromMat2d = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = 0;\n\n    out[3] = a[2];\n    out[4] = a[3];\n    out[5] = 0;\n\n    out[6] = a[4];\n    out[7] = a[5];\n    out[8] = 1;\n    return out;\n};\n\n/**\n* Calculates a 3x3 matrix from the given quaternion\n*\n* @param {mat3} out mat3 receiving operation result\n* @param {quat} q Quaternion to create matrix from\n*\n* @returns {mat3} out\n*/\nmat3.fromQuat = function (out, q) {\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        yx = y * x2,\n        yy = y * y2,\n        zx = z * x2,\n        zy = z * y2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    out[0] = 1 - yy - zz;\n    out[3] = yx - wz;\n    out[6] = zx + wy;\n\n    out[1] = yx + wz;\n    out[4] = 1 - xx - zz;\n    out[7] = zy - wx;\n\n    out[2] = zx - wy;\n    out[5] = zy + wx;\n    out[8] = 1 - xx - yy;\n\n    return out;\n};\n\n/**\n* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n*\n* @param {mat3} out mat3 receiving operation result\n* @param {mat4} a Mat4 to derive the normal matrix from\n*\n* @returns {mat3} out\n*/\nmat3.normalFromMat4 = function (out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) { \n        return null; \n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n\n    out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n\n    out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n\n    return out;\n};\n\n/**\n * Returns a string representation of a mat3\n *\n * @param {mat3} mat matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nmat3.str = function (a) {\n    return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + \n                    a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + \n                    a[6] + ', ' + a[7] + ', ' + a[8] + ')';\n};\n\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {mat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nmat3.frob = function (a) {\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2)))\n};\n\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the first operand\n * @param {mat3} b the second operand\n * @returns {mat3} out\n */\nmat3.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    out[3] = a[3] + b[3];\n    out[4] = a[4] + b[4];\n    out[5] = a[5] + b[5];\n    out[6] = a[6] + b[6];\n    out[7] = a[7] + b[7];\n    out[8] = a[8] + b[8];\n    return out;\n};\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the first operand\n * @param {mat3} b the second operand\n * @returns {mat3} out\n */\nmat3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    out[3] = a[3] - b[3];\n    out[4] = a[4] - b[4];\n    out[5] = a[5] - b[5];\n    out[6] = a[6] - b[6];\n    out[7] = a[7] - b[7];\n    out[8] = a[8] - b[8];\n    return out;\n};\n\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\nmat3.sub = mat3.subtract;\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {mat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\nmat3.multiplyScalar = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    out[3] = a[3] * b;\n    out[4] = a[4] * b;\n    out[5] = a[5] * b;\n    out[6] = a[6] * b;\n    out[7] = a[7] * b;\n    out[8] = a[8] * b;\n    return out;\n};\n\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {mat3} a the first operand\n * @param {mat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\nmat3.multiplyScalarAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    out[3] = a[3] + (b[3] * scale);\n    out[4] = a[4] + (b[4] * scale);\n    out[5] = a[5] + (b[5] * scale);\n    out[6] = a[6] + (b[6] * scale);\n    out[7] = a[7] + (b[7] * scale);\n    out[8] = a[8] + (b[8] * scale);\n    return out;\n};\n\n/*\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {mat3} a The first matrix.\n * @param {mat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat3.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && \n           a[3] === b[3] && a[4] === b[4] && a[5] === b[5] &&\n           a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n};\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {mat3} a The first matrix.\n * @param {mat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat3.equals = function (a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5], a6 = a[6], a7 = a[7], a8 = a[8];\n    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5], b6 = a[6], b7 = b[7], b8 = b[8];\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a8), Math.abs(b8)));\n};\n\n\nmodule.exports = mat3;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/mat3.js\n// module id = 104\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/mat3.js?")},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 3 Dimensional Vector\n * @name vec3\n */\nvar vec3 = {};\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nvec3.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {vec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nvec3.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nvec3.fromValues = function(x, y, z) {\n    var out = new glMatrix.ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\nvec3.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n};\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nvec3.set = function(out, x, y, z) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nvec3.sub = vec3.subtract;\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    out[2] = a[2] * b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nvec3.mul = vec3.multiply;\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    out[2] = a[2] / b[2];\n    return out;\n};\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nvec3.div = vec3.divide;\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to ceil\n * @returns {vec3} out\n */\nvec3.ceil = function (out, a) {\n    out[0] = Math.ceil(a[0]);\n    out[1] = Math.ceil(a[1]);\n    out[2] = Math.ceil(a[2]);\n    return out;\n};\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to floor\n * @returns {vec3} out\n */\nvec3.floor = function (out, a) {\n    out[0] = Math.floor(a[0]);\n    out[1] = Math.floor(a[1]);\n    out[2] = Math.floor(a[2]);\n    return out;\n};\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    out[2] = Math.min(a[2], b[2]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    out[2] = Math.max(a[2], b[2]);\n    return out;\n};\n\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to round\n * @returns {vec3} out\n */\nvec3.round = function (out, a) {\n    out[0] = Math.round(a[0]);\n    out[1] = Math.round(a[1]);\n    out[2] = Math.round(a[2]);\n    return out;\n};\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nvec3.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n};\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nvec3.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} distance between a and b\n */\nvec3.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nvec3.dist = vec3.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec3.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nvec3.sqrDist = vec3.squaredDistance;\n\n/**\n * Calculates the length of a vec3\n *\n * @param {vec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec3.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return Math.sqrt(x*x + y*y + z*z);\n};\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nvec3.len = vec3.length;\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {vec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec3.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    return x*x + y*y + z*z;\n};\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nvec3.sqrLen = vec3.squaredLength;\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to negate\n * @returns {vec3} out\n */\nvec3.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    return out;\n};\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to invert\n * @returns {vec3} out\n */\nvec3.inverse = function(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n};\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a vector to normalize\n * @returns {vec3} out\n */\nvec3.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2];\n    var len = x*x + y*y + z*z;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\nvec3.cross = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2],\n        bx = b[0], by = b[1], bz = b[2];\n\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n};\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    out[2] = az + t * (b[2] - az);\n    return out;\n};\n\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {vec3} c the third operand\n * @param {vec3} d the fourth operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.hermite = function (out, a, b, c, d, t) {\n  var factorTimes2 = t * t,\n      factor1 = factorTimes2 * (2 * t - 3) + 1,\n      factor2 = factorTimes2 * (t - 2) + t,\n      factor3 = factorTimes2 * (t - 1),\n      factor4 = factorTimes2 * (3 - 2 * t);\n  \n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  \n  return out;\n};\n\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {vec3} c the third operand\n * @param {vec3} d the fourth operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec3} out\n */\nvec3.bezier = function (out, a, b, c, d, t) {\n  var inverseFactor = 1 - t,\n      inverseFactorTimesTwo = inverseFactor * inverseFactor,\n      factorTimes2 = t * t,\n      factor1 = inverseFactorTimesTwo * inverseFactor,\n      factor2 = 3 * t * inverseFactorTimesTwo,\n      factor3 = 3 * factorTimes2 * inverseFactor,\n      factor4 = factorTimes2 * t;\n  \n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  \n  return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\nvec3.random = function (out, scale) {\n    scale = scale || 1.0;\n\n    var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n    var z = (glMatrix.RANDOM() * 2.0) - 1.0;\n    var zScale = Math.sqrt(1.0-z*z) * scale;\n\n    out[0] = Math.cos(r) * zScale;\n    out[1] = Math.sin(r) * zScale;\n    out[2] = z * scale;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat4 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2],\n        w = m[3] * x + m[7] * y + m[11] * z + m[15];\n    w = w || 1.0;\n    out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n    out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n    out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n    return out;\n};\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {mat4} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nvec3.transformMat3 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2];\n    out[0] = x * m[0] + y * m[3] + z * m[6];\n    out[1] = x * m[1] + y * m[4] + z * m[7];\n    out[2] = x * m[2] + y * m[5] + z * m[8];\n    return out;\n};\n\n/**\n * Transforms the vec3 with a quat\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec3} out\n */\nvec3.transformQuat = function(out, a, q) {\n    // benchmarks: http://jsperf.com/quaternion-transform-vec3-implementations\n\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return out;\n};\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nvec3.rotateX = function(out, a, b, c){\n   var p = [], r=[];\n\t  //Translate point to the origin\n\t  p[0] = a[0] - b[0];\n\t  p[1] = a[1] - b[1];\n  \tp[2] = a[2] - b[2];\n\n\t  //perform rotation\n\t  r[0] = p[0];\n\t  r[1] = p[1]*Math.cos(c) - p[2]*Math.sin(c);\n\t  r[2] = p[1]*Math.sin(c) + p[2]*Math.cos(c);\n\n\t  //translate to correct position\n\t  out[0] = r[0] + b[0];\n\t  out[1] = r[1] + b[1];\n\t  out[2] = r[2] + b[2];\n\n  \treturn out;\n};\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nvec3.rotateY = function(out, a, b, c){\n  \tvar p = [], r=[];\n  \t//Translate point to the origin\n  \tp[0] = a[0] - b[0];\n  \tp[1] = a[1] - b[1];\n  \tp[2] = a[2] - b[2];\n  \n  \t//perform rotation\n  \tr[0] = p[2]*Math.sin(c) + p[0]*Math.cos(c);\n  \tr[1] = p[1];\n  \tr[2] = p[2]*Math.cos(c) - p[0]*Math.sin(c);\n  \n  \t//translate to correct position\n  \tout[0] = r[0] + b[0];\n  \tout[1] = r[1] + b[1];\n  \tout[2] = r[2] + b[2];\n  \n  \treturn out;\n};\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {vec3} a The vec3 point to rotate\n * @param {vec3} b The origin of the rotation\n * @param {Number} c The angle of rotation\n * @returns {vec3} out\n */\nvec3.rotateZ = function(out, a, b, c){\n  \tvar p = [], r=[];\n  \t//Translate point to the origin\n  \tp[0] = a[0] - b[0];\n  \tp[1] = a[1] - b[1];\n  \tp[2] = a[2] - b[2];\n  \n  \t//perform rotation\n  \tr[0] = p[0]*Math.cos(c) - p[1]*Math.sin(c);\n  \tr[1] = p[0]*Math.sin(c) + p[1]*Math.cos(c);\n  \tr[2] = p[2];\n  \n  \t//translate to correct position\n  \tout[0] = r[0] + b[0];\n  \tout[1] = r[1] + b[1];\n  \tout[2] = r[2] + b[2];\n  \n  \treturn out;\n};\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec3.forEach = (function() {\n    var vec = vec3.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 3;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Get the angle between two 3D vectors\n * @param {vec3} a The first operand\n * @param {vec3} b The second operand\n * @returns {Number} The angle in radians\n */\nvec3.angle = function(a, b) {\n   \n    var tempA = vec3.fromValues(a[0], a[1], a[2]);\n    var tempB = vec3.fromValues(b[0], b[1], b[2]);\n \n    vec3.normalize(tempA, tempA);\n    vec3.normalize(tempB, tempB);\n \n    var cosine = vec3.dot(tempA, tempB);\n\n    if(cosine > 1.0){\n        return 0;\n    } else {\n        return Math.acos(cosine);\n    }     \n};\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec3} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec3.str = function (a) {\n    return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n};\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nvec3.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n};\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {vec3} a The first vector.\n * @param {vec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nvec3.equals = function (a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2];\n    var b0 = b[0], b1 = b[1], b2 = b[2];\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)));\n};\n\nmodule.exports = vec3;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/vec3.js\n// module id = 105\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/vec3.js?")},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 4 Dimensional Vector\n * @name vec4\n */\nvar vec4 = {};\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\nvec4.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {vec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\nvec4.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\nvec4.fromValues = function(x, y, z, w) {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    out[3] = w;\n    return out;\n};\n\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the source vector\n * @returns {vec4} out\n */\nvec4.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\nvec4.set = function(out, x, y, z, w) {\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    out[3] = w;\n    return out;\n};\n\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {vec4} out\n */\nvec4.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    out[3] = a[3] + b[3];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {vec4} out\n */\nvec4.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    out[3] = a[3] - b[3];\n    return out;\n};\n\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\nvec4.sub = vec4.subtract;\n\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {vec4} out\n */\nvec4.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    out[2] = a[2] * b[2];\n    out[3] = a[3] * b[3];\n    return out;\n};\n\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\nvec4.mul = vec4.multiply;\n\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {vec4} out\n */\nvec4.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    out[2] = a[2] / b[2];\n    out[3] = a[3] / b[3];\n    return out;\n};\n\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\nvec4.div = vec4.divide;\n\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a vector to ceil\n * @returns {vec4} out\n */\nvec4.ceil = function (out, a) {\n    out[0] = Math.ceil(a[0]);\n    out[1] = Math.ceil(a[1]);\n    out[2] = Math.ceil(a[2]);\n    out[3] = Math.ceil(a[3]);\n    return out;\n};\n\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a vector to floor\n * @returns {vec4} out\n */\nvec4.floor = function (out, a) {\n    out[0] = Math.floor(a[0]);\n    out[1] = Math.floor(a[1]);\n    out[2] = Math.floor(a[2]);\n    out[3] = Math.floor(a[3]);\n    return out;\n};\n\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {vec4} out\n */\nvec4.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    out[2] = Math.min(a[2], b[2]);\n    out[3] = Math.min(a[3], b[3]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {vec4} out\n */\nvec4.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    out[2] = Math.max(a[2], b[2]);\n    out[3] = Math.max(a[3], b[3]);\n    return out;\n};\n\n/**\n * Math.round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a vector to round\n * @returns {vec4} out\n */\nvec4.round = function (out, a) {\n    out[0] = Math.round(a[0]);\n    out[1] = Math.round(a[1]);\n    out[2] = Math.round(a[2]);\n    out[3] = Math.round(a[3]);\n    return out;\n};\n\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\nvec4.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    out[3] = a[3] * b;\n    return out;\n};\n\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\nvec4.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    out[3] = a[3] + (b[3] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {Number} distance between a and b\n */\nvec4.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2],\n        w = b[3] - a[3];\n    return Math.sqrt(x*x + y*y + z*z + w*w);\n};\n\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\nvec4.dist = vec4.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec4.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1],\n        z = b[2] - a[2],\n        w = b[3] - a[3];\n    return x*x + y*y + z*z + w*w;\n};\n\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\nvec4.sqrDist = vec4.squaredDistance;\n\n/**\n * Calculates the length of a vec4\n *\n * @param {vec4} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec4.length = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2],\n        w = a[3];\n    return Math.sqrt(x*x + y*y + z*z + w*w);\n};\n\n/**\n * Alias for {@link vec4.length}\n * @function\n */\nvec4.len = vec4.length;\n\n/**\n * Calculates the squared length of a vec4\n *\n * @param {vec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec4.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2],\n        w = a[3];\n    return x*x + y*y + z*z + w*w;\n};\n\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\nvec4.sqrLen = vec4.squaredLength;\n\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a vector to negate\n * @returns {vec4} out\n */\nvec4.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    out[3] = -a[3];\n    return out;\n};\n\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a vector to invert\n * @returns {vec4} out\n */\nvec4.inverse = function(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n};\n\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a vector to normalize\n * @returns {vec4} out\n */\nvec4.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1],\n        z = a[2],\n        w = a[3];\n    var len = x*x + y*y + z*z + w*w;\n    if (len > 0) {\n        len = 1 / Math.sqrt(len);\n        out[0] = x * len;\n        out[1] = y * len;\n        out[2] = z * len;\n        out[3] = w * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec4.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n};\n\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the first operand\n * @param {vec4} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec4} out\n */\nvec4.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2],\n        aw = a[3];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    out[2] = az + t * (b[2] - az);\n    out[3] = aw + t * (b[3] - aw);\n    return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec4} out\n */\nvec4.random = function (out, scale) {\n    scale = scale || 1.0;\n\n    //TODO: This is a pretty awful way of doing this. Find something better.\n    out[0] = glMatrix.RANDOM();\n    out[1] = glMatrix.RANDOM();\n    out[2] = glMatrix.RANDOM();\n    out[3] = glMatrix.RANDOM();\n    vec4.normalize(out, out);\n    vec4.scale(out, out, scale);\n    return out;\n};\n\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec4} out\n */\nvec4.transformMat4 = function(out, a, m) {\n    var x = a[0], y = a[1], z = a[2], w = a[3];\n    out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n    out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n    out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n    out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n    return out;\n};\n\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {vec4} a the vector to transform\n * @param {quat} q quaternion to transform with\n * @returns {vec4} out\n */\nvec4.transformQuat = function(out, a, q) {\n    var x = a[0], y = a[1], z = a[2],\n        qx = q[0], qy = q[1], qz = q[2], qw = q[3],\n\n        // calculate quat * vec\n        ix = qw * x + qy * z - qz * y,\n        iy = qw * y + qz * x - qx * z,\n        iz = qw * z + qx * y - qy * x,\n        iw = -qx * x - qy * y - qz * z;\n\n    // calculate result * inverse quat\n    out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec4.forEach = (function() {\n    var vec = vec4.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 4;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2]; vec[3] = a[i+3];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2]; a[i+3] = vec[3];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec4} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec4.str = function (a) {\n    return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n};\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {vec4} a The first vector.\n * @param {vec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nvec4.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n};\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {vec4} a The first vector.\n * @param {vec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nvec4.equals = function (a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\n    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)));\n};\n\nmodule.exports = vec4;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/vec4.js\n// module id = 106\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/vec4.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("// jshint ignore: start\n\n/*\n * Copyright 2010, Google Inc.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are\n * met:\n *\n *     * Redistributions of source code must retain the above copyright\n * notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above\n * copyright notice, this list of conditions and the following disclaimer\n * in the documentation and/or other materials provided with the\n * distribution.\n *     * Neither the name of Google Inc. nor the names of its\n * contributors may be used to endorse or promote products derived from\n * this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n * \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/**\n * @fileoverview This file contains functions every webgl program will need\n * a version of one way or another.\n *\n * Instead of setting up a context manually it is recommended to\n * use. This will check for success or failure. On failure it\n * will attempt to present an approriate message to the user.\n *\n *       gl = WebGLUtils.setupWebGL(canvas);\n *\n * For animated WebGL apps use of setTimeout or setInterval are\n * discouraged. It is recommended you structure your rendering\n * loop like this.\n *\n *       function render() {\n *         window.requestAnimationFrame(render, canvas);\n *\n *         // do rendering\n *         ...\n *       }\n *       render();\n *\n * This will call your rendering function up to the refresh rate\n * of your display but will stop rendering if your app is not\n * visible.\n */\n\nvar WebGLUtils = (function() {\n    /**\n     * Creates the HTLM for a failure message\n     * @param {string} canvasContainerId id of container of th\n     *        canvas.\n     * @return {string} The html.\n     */\n    var makeFailHTML = function(msg) {\n        return (\n            '' +\n            '<div style=\"margin: auto; width:500px;z-index:10000;margin-top:20em;text-align:center;\">' +\n            msg +\n            '</div>'\n        );\n        // return '' +\n        //   '<table style=\"background-color: #8CE; width: 100%; height: 100%;\"><tr>' +\n        //   '<td align=\"center\">' +\n        //   '<div style=\"display: table-cell; vertical-align: middle;\">' +\n        //   '<div style=\"\">' + msg + '</div>' +\n        //   '</div>' +\n        //   '</td></tr></table>';\n    };\n\n    /**\n     * Mesasge for getting a webgl browser\n     * @type {string}\n     */\n    var GET_A_WEBGL_BROWSER =\n        '' +\n        'This page requires a browser that supports WebGL.<br/>' +\n        '<a href=\"http://get.webgl.org\">Click here to upgrade your browser.</a>';\n\n    /**\n     * Mesasge for need better hardware\n     * @type {string}\n     */\n    var OTHER_PROBLEM =\n        '' +\n        \"It doesn't appear your computer can support WebGL.<br/>\" +\n        '<a href=\"http://get.webgl.org\">Click here for more information.</a>';\n\n    /*\n     * Allows to prevent the global canvas error code on webgl2\n     * as we still have to check if we can fallback on webgl1\n     */\n    var doReportCreationError = true;\n    /**\n     * Creates a webgl context. If creation fails it will\n     * change the contents of the container of the <canvas>\n     * tag to an error message with the correct links for WebGL.\n     * @return {WebGLRenderingContext} The created context.\n     */\n    var setupWebGL = function(\n        /** Element */\n        canvas,\n        /** WebGLContextCreationAttributes */\n        opt_attribs,\n        /** function:(msg) */\n        opt_onError\n    ) {\n        function handleCreationError(msg) {\n            if (!doReportCreationError) return;\n            var container = document.getElementsByTagName('body')[0];\n            //var container = canvas.parentNode;\n            if (container) {\n                var str = window.WebGLRenderingContext ? OTHER_PROBLEM : GET_A_WEBGL_BROWSER;\n                if (msg) {\n                    str += '<br/><br/>Status: ' + msg;\n                }\n                container.innerHTML = makeFailHTML(str);\n            }\n        }\n\n        opt_onError = opt_onError || handleCreationError;\n\n        if (canvas.addEventListener) {\n            canvas.addEventListener(\n                'webglcontextcreationerror',\n                function(event) {\n                    opt_onError(event.statusMessage);\n                },\n                false\n            );\n        }\n        var context = create3DContext(canvas, opt_attribs);\n        if (!context) {\n            //if ( !window.WebGLRenderingContext )\n            opt_onError('');\n        }\n\n        return context;\n    };\n\n    /**\n     * try to creaate webgl contexts\n     * @param {Canvas} canvas The canvas tag to get context\n     * @param {opt_attribs} webgl context options\n     * @param {names} list of webgl context type to try\n     * @return {!WebGLContext} The created context.\n     */\n    var checkAndCreate3DContext = function(canvas, opt_attribs, names) {\n        var context = null;\n        for (var ii = 0; ii < names.length; ++ii) {\n            try {\n                context = canvas.getContext(names[ii], opt_attribs);\n            } catch (e) {}\n            if (context) {\n                break;\n            }\n        }\n        return context;\n    };\n\n    /**\n     * Creates a webgl context.\n     * @param !Canvas} canvas The canvas tag to get context\n     * @param {!opt_attribs} webgl context options\n     * @return {!WebGLContext} The created context.\n     */\n    var create3DContext = function(canvas, opt_attribs) {\n        var context;\n        // only try to enable if URl options ?webgl2=1\n        if (opt_attribs && opt_attribs.webgl2) {\n            doReportCreationError = false;\n            context = checkAndCreate3DContext(canvas, opt_attribs, [\n                'webgl2',\n                'experimental-webgl2'\n            ]);\n            if (context) return context;\n            doReportCreationError = true;\n        }\n        return checkAndCreate3DContext(canvas, opt_attribs, [\n            'webgl',\n            'experimental-webgl',\n            'webkit-3d',\n            'moz-webgl'\n        ]);\n    };\n\n    return {\n        create3DContext: create3DContext,\n        setupWebGL: setupWebGL\n    };\n})();\n\n/**\n * Provides requestAnimationFrame in a cross browser\n * way.\n */\nif (!window.requestAnimationFrame) {\n    window.requestAnimationFrame = (function() {\n        return (\n            window.requestAnimationFrame ||\n            window.webkitRequestAnimationFrame ||\n            window.mozRequestAnimationFrame ||\n            window.oRequestAnimationFrame ||\n            window.msRequestAnimationFrame ||\n            function(\n                /* function FrameRequestCallback */ callback,\n                /* DOMElement Element */ element\n            ) {\n                window.setTimeout(callback, 1000 / 60);\n            }\n        );\n    })();\n}\n\nif (!window.cancelRequestAnimFrame) {\n    window.cancelAnimationFrame = (function() {\n        return (\n            window.cancelAnimationFrame ||\n            window.webkitCancelRequestAnimationFrame ||\n            window.mozCancelRequestAnimationFrame ||\n            window.oCancelRequestAnimationFrame ||\n            window.msCancelRequestAnimationFrame ||\n            clearTimeout\n        );\n    })();\n}\n\nif (!Date.now) {\n    Date.now = function now() {\n        return new Date().getTime();\n    };\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WebGLUtils);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/webgl-utils.js\n// module id = 107\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/webgl-utils.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Polytope__ = __webpack_require__(77);\n\n\nvar CullingSet = function() {\n    this._mask = CullingSet.DEFAULT_CULLING;\n    this._frustum = new __WEBPACK_IMPORTED_MODULE_0_osg_Polytope__["a" /* default */]();\n};\n\nCullingSet.prototype = {\n    reset: function() {\n        this._mask = CullingSet.DEFAULT_CULLING;\n        this._frustum.clear();\n    },\n    setCullingMask: function(mask) {\n        this._mask = mask;\n    },\n    getCullingMask: function() {\n        return this._mask;\n    },\n    setFrustum: function(frustum) {\n        this._frustum = frustum;\n    },\n    getFrustum: function() {\n        return this._frustum;\n    },\n    getCurrentResultMask: function() {\n        return this._frustum.getCurrentMask();\n    },\n    pushCurrentMask: function() {\n        this._frustum.pushCurrentMask();\n    },\n    popCurrentMask: function() {\n        this._frustum.popCurrentMask();\n    },\n    resetCullingMask: function() {\n        this._frustum.setResultMask(this._frustum.getCurrentMask());\n    },\n    isBoundingBoxCulled: function(bbox) {\n        if (this._mask & CullingSet.VIEW_FRUSTUM_CULLING) {\n            // is it outside the view frustum...\n            if (!this._frustum.containsBoundingBox(bbox)) return true;\n        }\n        return false;\n    },\n    isBoundingSphereCulled: function(bs) {\n        if (this._mask & CullingSet.VIEW_FRUSTUM_CULLING) {\n            // is it outside the view frustum...\n            if (!this._frustum.containsBoundingSphere(bs)) return true;\n        }\n        return false;\n    },\n    isVerticesCulled: function(vertices) {\n        if (this._mask & CullingSet.VIEW_FRUSTUM_CULLING) {\n            // is it outside the view frustum...\n            if (!this._frustum.containsVertices(vertices)) return true;\n        }\n        return false;\n    }\n};\n\nCullingSet.NO_CULLING = 0x0;\n\nCullingSet.VIEW_FRUSTUM_LEFT_CULLING = 0x1;\nCullingSet.VIEW_FRUSTUM_RIGHT_CULLING = 0x2;\nCullingSet.VIEW_FRUSTUM_TOP_CULLING = 0x3;\nCullingSet.VIEW_FRUSTUM_BOTTOM_CULLING = 0x4;\nCullingSet.NEAR_PLANE_CULLING = 0x5;\nCullingSet.FAR_PLANE_CULLING = 0x6;\n\nCullingSet.VIEW_FRUSTUM_SIDES_CULLING =\n    CullingSet.VIEW_FRUSTUM_LEFT_CULLING |\n    CullingSet.VIEW_FRUSTUM_RIGHT_CULLING |\n    CullingSet.VIEW_FRUSTUM_BOTTOM_CULLING |\n    CullingSet.VIEW_FRUSTUM_TOP_CULLING;\n\nCullingSet.VIEW_FRUSTUM_CULLING =\n    CullingSet.VIEW_FRUSTUM_SIDES_CULLING |\n    CullingSet.NEAR_PLANE_CULLING |\n    CullingSet.FAR_PLANE_CULLING;\n\nCullingSet.DEFAULT_CULLING = CullingSet.VIEW_FRUSTUM_SIDES_CULLING;\n\nCullingSet.ENABLE_ALL_CULLING = CullingSet.VIEW_FRUSTUM_CULLING;\n\n/* harmony default export */ __webpack_exports__["a"] = (CullingSet);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/CullingSet.js\n// module id = 108\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/CullingSet.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BoundingSphere__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_computeMatrixFromNodePath__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_CullSettings__ = __webpack_require__(49);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_CullingSet__ = __webpack_require__(108);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Plane__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_PooledResource__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_PooledMap__ = __webpack_require__(60);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar createCullingSet = function() {\n    return new __WEBPACK_IMPORTED_MODULE_5_osg_CullingSet__["a" /* default */]();\n};\n\nvar CullStack = function() {\n    this._modelViewMatrixStack = new __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__["a" /* default */]();\n    this._projectionMatrixStack = new __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__["a" /* default */]();\n    this._viewportStack = new __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__["a" /* default */]();\n    this._cullingSetStack = new __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__["a" /* default */]();\n    this._frustumVolume = -1.0;\n    this._bbCornerFar = 0;\n    this._bbCornerNear = 0;\n\n    // keep a matrix in memory to avoid to create matrix\n    this._pooledMatrix = new __WEBPACK_IMPORTED_MODULE_11_osg_PooledResource__["a" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create);\n\n    this._pooledCullingSet = new __WEBPACK_IMPORTED_MODULE_11_osg_PooledResource__["a" /* default */](createCullingSet);\n\n    // data for caching camera matrix inverse for computation of world/view\n    // contains index of the camera node in the nodepath\n    this._cameraIndexStack = new __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__["a" /* default */]();\n\n    // contains index of the camera modelview matrix in the modelViewMatrixStack\n    this._cameraModelViewIndexStack = new __WEBPACK_IMPORTED_MODULE_10_osg_PooledArray__["a" /* default */]();\n\n    // contains the id has a key to computed Inverse Matrix\n    this._cameraMatrixInverse = new __WEBPACK_IMPORTED_MODULE_12_osg_PooledMap__["a" /* default */]();\n    this._cameraMatrixInverseRoot = undefined;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CullStack,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osg_CullSettings__["a" /* default */].prototype, {\n        reset: function() {\n            this._modelViewMatrixStack.reset();\n            this._projectionMatrixStack.reset();\n            this._cullingSetStack.reset();\n\n            this._pooledMatrix.reset();\n            this._pooledCullingSet.reset();\n\n            this._cameraModelViewIndexStack.reset();\n            this._cameraIndexStack.reset();\n\n            this._cameraMatrixInverse.reset();\n\n            this._cameraMatrixInverseRoot = undefined;\n        },\n\n        getProjectionMatrixStack: function() {\n            return this._projectionMatrixStack;\n        },\n        getCurrentProjectionMatrix: function() {\n            return this._projectionMatrixStack.back();\n        },\n\n        getCurrentModelViewMatrix: function() {\n            return this._modelViewMatrixStack.back();\n        },\n\n        getCameraInverseMatrix: function() {\n            // Return or compute and cache the MatrixInverse of the last\n            // active camera in absolute reference\n\n            // if no index the camera inverse is the root with an fake id\n            if (!this._cameraIndexStack.getLength()) return this._cameraMatrixInverseRoot;\n\n            var idx = this._cameraIndexStack.back();\n\n            // get the camera node\n            var camera = this.getNodePath()[idx];\n            var id = camera.getInstanceID();\n\n            var mapCameraInverse = this._cameraMatrixInverse.getMap();\n            var cameraInverse = mapCameraInverse[id];\n\n            if (cameraInverse === undefined) {\n                var indexInModelViewMatrixStack = this._cameraModelViewIndexStack.back();\n                var mat = this._modelViewMatrixStack.getArray()[indexInModelViewMatrixStack];\n                cameraInverse = this._pooledMatrix.getOrCreateObject();\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].invert(cameraInverse, mat);\n                this._cameraMatrixInverse.set(id, cameraInverse);\n            }\n            return cameraInverse;\n        },\n\n        getCurrentModelMatrix: function() {\n            // Improvment could be to cache more things\n            // and / or use this method only if the shader use it\n            var invMatrix = this.getCameraInverseMatrix();\n            var m = this._pooledMatrix.getOrCreateObject();\n            var world = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(m, invMatrix, this.getCurrentModelViewMatrix());\n            return world;\n        },\n\n        getCurrentViewMatrix: function() {\n            // Improvment could be to cache more things\n            // and / or use this method only if the shader use it\n            var modelViewMatrixStackArray = this._modelViewMatrixStack.getArray();\n            if (!this._cameraIndexStack.getLength()) return modelViewMatrixStackArray[0];\n\n            // also we could keep the index of the current to avoid lenght-1 at each access\n            // it\'s implemented in osg like that:\n            // https://github.com/openscenegraph/osg/blob/master/include/osg/fast_back_stack\n            return modelViewMatrixStackArray[this._cameraModelViewIndexStack.back()];\n        },\n\n        getViewport: function() {\n            if (this._viewportStack.getLength() === 0) {\n                return undefined;\n            }\n            return this._viewportStack.back();\n        },\n        getLookVectorLocal: function(outLookVector) {\n            var lookVectorLocal = this.getCurrentModelViewMatrix();\n            return __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].set(\n                outLookVector,\n                -lookVectorLocal[2],\n                -lookVectorLocal[6],\n                -lookVectorLocal[10]\n            );\n        },\n        pushViewport: function(vp) {\n            this._viewportStack.push(vp);\n        },\n        popViewport: function() {\n            this._viewportStack.pop();\n        },\n\n        getFrustumPlanes: (function() {\n            var mvp = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function(out, projection, view, withNearFar) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(mvp, projection, view);\n\n                var computeNearFar = !!withNearFar;\n\n                // Right clipping plane.\n                var right = out[0];\n                right[0] = mvp[3] - mvp[0];\n                right[1] = mvp[7] - mvp[4];\n                right[2] = mvp[11] - mvp[8];\n                right[3] = mvp[15] - mvp[12];\n\n                // Left clipping plane.\n                var left = out[1];\n                left[0] = mvp[3] + mvp[0];\n                left[1] = mvp[7] + mvp[4];\n                left[2] = mvp[11] + mvp[8];\n                left[3] = mvp[15] + mvp[12];\n\n                // Bottom clipping plane.\n                var bottom = out[2];\n                bottom[0] = mvp[3] + mvp[1];\n                bottom[1] = mvp[7] + mvp[5];\n                bottom[2] = mvp[11] + mvp[9];\n                bottom[3] = mvp[15] + mvp[13];\n\n                // Top clipping plane.\n                var top = out[3];\n                top[0] = mvp[3] - mvp[1];\n                top[1] = mvp[7] - mvp[5];\n                top[2] = mvp[11] - mvp[9];\n                top[3] = mvp[15] - mvp[13];\n\n                if (computeNearFar) {\n                    // Far clipping plane.\n                    var far = out[4];\n                    far[0] = mvp[3] - mvp[2];\n                    far[1] = mvp[7] - mvp[6];\n                    far[2] = mvp[11] - mvp[10];\n                    far[3] = mvp[15] - mvp[14];\n\n                    // Near clipping plane.\n                    var near = out[5];\n                    near[0] = mvp[3] + mvp[2];\n                    near[1] = mvp[7] + mvp[6];\n                    near[2] = mvp[11] + mvp[10];\n                    near[3] = mvp[15] + mvp[14];\n                }\n\n                //Normalize the planes\n                var j = withNearFar ? 6 : 4;\n                for (var i = 0; i < j; i++) {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_Plane__["a" /* default */].normalizeEquation(out[i]);\n                }\n            };\n        })(),\n\n        pushCullingSet: function() {\n            var cs = this._pooledCullingSet.getOrCreateObject();\n            if (this._enableFrustumCulling) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].getFrustumPlanes(\n                    cs.getFrustum().getPlanes(),\n                    this.getCurrentProjectionMatrix(),\n                    this.getCurrentModelViewMatrix(),\n                    false\n                );\n                // TODO: no far no near.\n                // should check if we have them\n                // should add at least a near 0 clip if not\n                cs.getFrustum().setupMask(4);\n            }\n\n            this._cullingSetStack.push(cs);\n        },\n        popCullingSet: function() {\n            return this._cullingSetStack.pop();\n        },\n        getCurrentCullingSet: function() {\n            return this._cullingSetStack.back();\n        },\n\n        pushCurrentMask: function() {\n            var cs = this.getCurrentCullingSet();\n            if (cs) cs.pushCurrentMask();\n        },\n        popCurrentMask: function() {\n            var cs = this.getCurrentCullingSet();\n            if (cs) cs.popCurrentMask();\n        },\n\n        isVerticesCulled: function(vertices) {\n            if (!this._enableFrustumCulling) return false;\n            return this.getCurrentCullingSet().isVerticesCulled(vertices);\n        },\n\n        isBoundingBoxCulled: function(bb) {\n            if (!this._enableFrustumCulling) return false;\n            return bb.valid() && this.getCurrentCullingSet().isBoundingBoxCulled(bb);\n        },\n\n        isBoundingSphereCulled: function(bs) {\n            if (!this._enableFrustumCulling) return false;\n            return bs.valid() && this.getCurrentCullingSet().isBoundingSphereCulled(bs);\n        },\n\n        isCulled: (function() {\n            var bsWorld = new __WEBPACK_IMPORTED_MODULE_1_osg_BoundingSphere__["a" /* default */]();\n            return function(node, nodePath) {\n                if (!this._enableFrustumCulling) return false;\n                if (node.isCullingActive()) {\n                    if (this.getCurrentCullingSet().getCurrentResultMask() === 0) return false; // father bounding sphere totally inside\n\n                    var matrix = this._pooledMatrix.getOrCreateObject();\n                    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].identity(matrix);\n\n                    var maxNodePathLength = nodePath.length;\n                    if (node instanceof __WEBPACK_IMPORTED_MODULE_8_osg_Transform__["a" /* default */]) {\n                        // MatrixTransform getBound is already transformed to\n                        // its local space whereas nodepath also have its matrix ...\n                        // so to get world space, you HAVE to remove that matrix from nodePATH\n                        maxNodePathLength--;\n                    }\n\n                    __WEBPACK_IMPORTED_MODULE_3_osg_computeMatrixFromNodePath__["a" /* default */].computeLocalToWorld(\n                        nodePath,\n                        true,\n                        matrix,\n                        maxNodePathLength\n                    );\n\n                    node.getBound().transformMat4(bsWorld, matrix);\n\n                    return this.getCurrentCullingSet().isBoundingSphereCulled(bsWorld);\n                } else {\n                    this.getCurrentCullingSet().resetCullingMask();\n                    return false;\n                }\n            };\n        })(),\n\n        pushModelViewMatrix: (function() {\n            var lookVector = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            return function(matrix) {\n                // When pushing a matrix, it can be a transform or camera. To compute\n                // differents matrix type in shader ( ViewMatrix/ModelMatrix/ModelViewMatrix )\n                // we track camera node when using pushModelViewMatrix\n                // To detect a camera, we check on the nodepath the type of the node and if the\n                // camera is relatif or absolute.\n                // When we detect an absolute camera we keep it\'s index to get it when needed to\n                // compute the World/View matrix\n                // Th    ere is an exception for the root camera, the root camera is not pushed on the\n                // CullVisitor but only its matrixes, so to handle this we compute the inverse camera\n                // when the nodepath has a lenght of 0\n                // To avoid to compute too much inverse matrix, we keep a cache of them during the\n                // traverse and store the result under the instanceID key, except for the root\n                var np = this.getNodePath();\n                var length = np.length;\n                if (!length) {\n                    // root\n                    var matInverse = this._pooledMatrix.getOrCreateObject();\n                    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].invert(matInverse, matrix);\n                    this._cameraMatrixInverseRoot = matInverse;\n                } else {\n                    var index = length - 1;\n                    if (\n                        np[index].getTypeID() === __WEBPACK_IMPORTED_MODULE_2_osg_Camera__["a" /* default */].getTypeID() &&\n                        np[index].getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_9_osg_transformEnums__["a" /* default */].ABSOLUTE_RF\n                    ) {\n                        this._cameraIndexStack.push(index);\n                        this._cameraModelViewIndexStack.push(\n                            this._modelViewMatrixStack.getLength()\n                        );\n                    }\n                }\n\n                this._modelViewMatrixStack.push(matrix);\n                this.getLookVectorLocal(lookVector);\n\n                /*jshint bitwise: false */\n                this._bbCornerFar =\n                    (lookVector[0] >= 0 ? 1 : 0) |\n                    (lookVector[1] >= 0 ? 2 : 0) |\n                    (lookVector[2] >= 0 ? 4 : 0);\n                this._bbCornerNear = ~this._bbCornerFar & 7;\n                /*jshint bitwise: true */\n            };\n        })(),\n        popModelViewMatrix: (function() {\n            var lookVector = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function() {\n                // if same index it\'s a camera and we have to pop it\n                var np = this.getNodePath();\n                var index = np.length - 1;\n                if (this._cameraIndexStack.getLength() && index === this._cameraIndexStack.back()) {\n                    this._cameraIndexStack.pop();\n                    this._cameraModelViewIndexStack.pop();\n                }\n\n                this._modelViewMatrixStack.pop();\n\n                if (this._modelViewMatrixStack.getLength()) {\n                    this.getLookVectorLocal(lookVector);\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].set(lookVector, 0.0, 0.0, -1.0);\n                }\n\n                /*jshint bitwise: false */\n                this._bbCornerFar =\n                    (lookVector[0] >= 0.0 ? 1.0 : 0.0) |\n                    (lookVector[1] >= 0 ? 2.0 : 0.0) |\n                    (lookVector[2] >= 0 ? 4.0 : 0.0);\n                this._bbCornerNear = ~this._bbCornerFar & 7;\n                /*jshint bitwise: true */\n            };\n        })(),\n\n        pushProjectionMatrix: function(matrix) {\n            this._projectionMatrixStack.push(matrix);\n\n            // need to recompute frustum volume.\n            this._frustumVolume = -1.0;\n\n            this.pushCullingSet();\n        },\n        popProjectionMatrix: function() {\n            this._projectionMatrixStack.pop();\n\n            // need to recompute frustum volume.\n            this._frustumVolume = -1.0;\n\n            this.popCullingSet();\n        }\n    }),\n    \'osg\',\n    \'CullStack\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (CullStack);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/CullStack.js\n// module id = 109\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/CullStack.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_StateGraph__ = __webpack_require__(80);\n\n\n// just use inline function, it\'s faster than having the test in the code\nvar applyUniformCache = [\n    // apply just modelview and projection\n    function(state, modelview, model, view, projection) {\n        state.applyModelViewMatrix(modelview, model);\n        state.applyProjectionMatrix(projection);\n    },\n\n    // apply model\n    function(state, modelview, model, view, projection) {\n        var gl = state.getGraphicContext();\n        var matrixModelViewChanged = state.applyModelViewMatrix(modelview, model);\n        state.applyProjectionMatrix(projection);\n\n        if (matrixModelViewChanged) {\n            var modelMatrix = state._modelMatrix;\n            modelMatrix.setMatrix4(model);\n            modelMatrix.apply(gl, this.modelUniform);\n        }\n    },\n\n    // apply view\n    function(state, modelview, model, view, projection) {\n        var gl = state.getGraphicContext();\n        var matrixModelViewChanged = state.applyModelViewMatrix(modelview, model);\n        state.applyProjectionMatrix(projection);\n\n        if (matrixModelViewChanged) {\n            var viewMatrix = state._viewMatrix;\n            viewMatrix.setMatrix4(view);\n            viewMatrix.apply(gl, this.viewUniform);\n        }\n    },\n\n    // applyModelAndViewUniform\n    function(state, modelview, model, view, projection) {\n        var gl = state.getGraphicContext();\n        var matrixModelViewChanged = state.applyModelViewMatrix(modelview, model);\n        state.applyProjectionMatrix(projection);\n\n        if (matrixModelViewChanged) {\n            var modelMatrix = state._modelMatrix;\n            modelMatrix.setMatrix4(model);\n            modelMatrix.apply(gl, this.modelUniform);\n\n            var viewMatrix = state._viewMatrix;\n            viewMatrix.setMatrix4(view);\n            viewMatrix.apply(gl, this.viewUniform);\n        }\n    }\n];\n\nvar CacheUniformApply = function(state, program) {\n    this.modelUniform = program._uniformsCache[state._modelMatrix.getName()];\n    this.viewUniform = program._uniformsCache[state._viewMatrix.getName()];\n\n    var cacheIndex = 0;\n    if (this.modelUniform) cacheIndex = 1;\n    if (this.viewUniform) cacheIndex |= 2;\n\n    this.apply = applyUniformCache[cacheIndex];\n};\n\nvar RenderLeaf = function() {\n    this._parent = undefined;\n    this._geometry = undefined;\n    this._depth = 0.0;\n\n    this._projection = undefined;\n    this._view = undefined;\n    this._model = undefined;\n    this._modelView = undefined;\n};\n\nRenderLeaf.prototype = {\n    reset: function() {\n        this._parent = undefined;\n        this._geometry = undefined;\n        this._depth = 0.0;\n\n        this._projection = undefined;\n        this._view = undefined;\n        this._model = undefined;\n        this._modelView = undefined;\n    },\n\n    init: function(parent, geom, projection, view, modelView, model, depth) {\n        this._parent = parent;\n        this._geometry = geom;\n        this._depth = depth;\n\n        this._projection = projection;\n        this._view = view;\n        this._model = model;\n        this._modelView = modelView;\n    },\n\n    drawGeometry: (function() {\n        return function(state) {\n            var program = state.getLastProgramApplied();\n            var programInstanceID = program.getInstanceID();\n            var cache = state.getCacheUniformsApplyRenderLeaf();\n            var obj = cache[programInstanceID];\n\n            if (!obj) {\n                obj = new CacheUniformApply(state, program);\n                cache[programInstanceID] = obj;\n            }\n\n            obj.apply(state, this._modelView, this._model, this._view, this._projection);\n\n            this._geometry.drawImplementation(state);\n        };\n    })(),\n\n    render: (function() {\n        var idLastDraw = 0;\n        var lastStateSetStackSize = -1;\n\n        return function(state, previousLeaf) {\n            var prevRenderGraph;\n            var prevRenderGraphParent;\n            var curRenderGraph = this._parent;\n            var curRenderGraphParent = curRenderGraph._parent;\n            var curRenderGraphStateSet = curRenderGraph._stateset;\n\n            // When rendering a RenderLeaf we try to limit the state change\n            // to do that Graph of State is created during the culling pass.\n            // this graph contains nodes of StateGraph type see the class StateGraph\n            //\n            // So to limit switching of StateSet we check where are the common parent\n            // between previous RenderLeaf and this current.\n            //\n            // There are 3 cases when there is a prev / current render leaf\n            //\n            //\n            // pRG: previousRenderGraph\n            // cRG: currentRenderGraph\n            // pRL: previousRenderLeaf\n            // cRL: currentRenderLeaf\n            // each RG contains a StateSet\n            //\n            //          A                        B                       C\n            // +-----+     +-----+            +-----+                 +-----+\n            // | pRG |     | cRG |         +--+ RG  +--+              | RG  |\n            // +--+--+     +--+--+         |  +-----+  |              +--+--+\n            //    |           |            |           |                 |\n            // +--v--+     +--v--+      +--v--+     +--v--+           +--v--+\n            // | pRG |     | cRG |      | pRG |     | cRG |        +--+ RG  +--+\n            // +--+--+     +--+--+      +--+--+     +--+--+        |  +-----+  |\n            //    |           |            |           |           |           |\n            // +--v--+     +--v--+      +--v--+     +--v--+     +--v--+     +--v--+\n            // | pRL |     | cRL |      | pRL |     | cRL |     | pRL |     | cRL |\n            // +-----+     +-----+      +-----+     +-----+     +-----+     +-----+\n            //\n            //\n            // Case A\n            // no common parent StateGraphNode we need to\n            // popStateSet until we find the common parent and then\n            // pushStateSet from the common parent to the current\n            // RenderLeaf\n            //\n            // Case B\n            // common parent StateGraphNode so we apply the current stateSet\n            //\n            // Case C\n            // the StateGraphNode is common to the previous RenderLeaf so we dont need\n            // to do anything except if we used an insertStateSet\n            //\n\n            if (previousLeaf !== undefined) {\n                // apply state if required.\n                prevRenderGraph = previousLeaf._parent;\n                prevRenderGraphParent = prevRenderGraph._parent;\n\n                if (prevRenderGraphParent !== curRenderGraphParent) {\n                    // Case A\n                    __WEBPACK_IMPORTED_MODULE_0_osg_StateGraph__["a" /* default */].moveStateGraph(state, prevRenderGraphParent, curRenderGraphParent);\n\n                    state.applyStateSet(curRenderGraphStateSet);\n                } else if (curRenderGraph !== prevRenderGraph) {\n                    // Case B\n                    state.applyStateSet(curRenderGraphStateSet);\n                } else {\n                    // Case C\n\n                    // in osg we call apply but actually we dont need\n                    // except if the stateSetStack changed.\n                    // for example if insert/remove StateSet has been used\n                    if (state._stateSetStackChanged(idLastDraw, lastStateSetStackSize)) {\n                        state.applyStateSet(curRenderGraphStateSet);\n                    }\n                }\n            } else {\n                __WEBPACK_IMPORTED_MODULE_0_osg_StateGraph__["a" /* default */].moveStateGraph(state, undefined, curRenderGraphParent);\n                state.applyStateSet(curRenderGraphStateSet);\n            }\n\n            state._setStateSetsDrawID(++idLastDraw);\n            lastStateSetStackSize = state.getStateSetStackSize();\n\n            this.drawGeometry(state);\n        };\n    })()\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (RenderLeaf);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/RenderLeaf.js\n// module id = 110\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/RenderLeaf.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__ = __webpack_require__(3);\n\n\n\n\n/**\n *  Switch that can switch on and off separate children\n *  @class Switch\n */\nvar Switch = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].call(this);\n    // This list of bools is effectively a bit mask.\n    this._values = [];\n};\n\n/** @lends Switch.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeNode(\n    Switch,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype, {\n        addChild: function(node, value) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Node__["a" /* default */].prototype.addChild.call(this, node);\n\n            if (value === undefined) value = true;\n\n            if (this.children.length > this._values.length) {\n                this._values.push(value);\n            } else {\n                this._values[this.children.length - 1] = value;\n            }\n            return true;\n        },\n\n        setValue: function(index, value) {\n            if (index < this._values.length) {\n                this._values[index] = value;\n            }\n        },\n\n        getValue: function(index) {\n            if (index < this._values.length) {\n                return this._values[index];\n            }\n        },\n\n        setAllChildrenOff: function() {\n            for (var i = 0; i < this._values.length; ++i) {\n                this._values[i] = false;\n            }\n        },\n\n        setAllChildrenOn: function() {\n            for (var i = 0; i < this._values.length; ++i) {\n                this._values[i] = true;\n            }\n        },\n\n        traverse: (function() {\n            return function(visitor) {\n                var traversalMode = visitor.traversalMode;\n\n                switch (traversalMode) {\n                    case __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN:\n                        for (var i = 0; i < this.children.length; ++i) {\n                            this.children[i].accept(visitor);\n                        }\n                        break;\n\n                    case __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ACTIVE_CHILDREN:\n                        var numChildren = this.children.length;\n                        if (this._values.length < numChildren) numChildren = this._values.length;\n\n                        for (i = 0; i < numChildren; ++i) {\n                            if (this._values[i] === true) {\n                                this.children[i].accept(visitor);\n                            }\n                        }\n                        break;\n\n                    default:\n                        break;\n                }\n            };\n        })()\n    }),\n    \'osg\',\n    \'Switch\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Switch);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/Switch.js\n// module id = 111\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/Switch.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgAnimation_Bone__ = __webpack_require__(44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Object__ = __webpack_require__(5);\n\n\n\n\n\n\n/**\n *  ValidateSkeletonVisitor\n *  @class ValidateSkeletonVisitor\n */\nvar ValidateSkeletonVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    ValidateSkeletonVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.getTypeID() !== __WEBPACK_IMPORTED_MODULE_1_osgAnimation_Bone__["a" /* default */].getTypeID()) {\n                return;\n            }\n            var foundNonBone = false;\n\n            var children = node.getChildren();\n            for (var i = 0, l = node.getChildren().length; i < l; i++) {\n                var child = children[i];\n                if (child.getTypeID() === __WEBPACK_IMPORTED_MODULE_1_osgAnimation_Bone__["a" /* default */].getTypeID()) {\n                    if (foundNonBone) {\n                        __WEBPACK_IMPORTED_MODULE_3_osg_notify__["a" /* default */].warn(\n                            \'Warning: a Bone was found after a non-Bone child \' +\n                                \'within a Skeleton. Children of a Bone must be ordered \' +\n                                \'with all child Bones first for correct update order.\'\n                        );\n                        //this.traversalMode = NodeVisitor.TRAVERSE_NONE;\n                        return;\n                    }\n                } else {\n                    foundNonBone = true;\n                }\n            }\n            this.traverse(node);\n        }\n    }),\n    \'osgAnimation\',\n    \'ValidateSkeletonVisitor\'\n);\n\nvar compareBone = function(x, y) {\n    var a = x instanceof __WEBPACK_IMPORTED_MODULE_1_osgAnimation_Bone__["a" /* default */] ? 0 : 1;\n    var b = y instanceof __WEBPACK_IMPORTED_MODULE_1_osgAnimation_Bone__["a" /* default */] ? 0 : 1;\n\n    return a - b;\n};\n\n/**\n *  UpdateSkeleton\n *  @class UpdateSkeleton\n */\nvar UpdateSkeleton = function() {\n    this._needValidate = true;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    UpdateSkeleton,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osg_Object__["a" /* default */].prototype, {\n        needToValidate: function() {\n            return this._needValidate;\n        },\n\n        update: function(node, nv) {\n            if (this._needValidate && nv.getVisitorType() === __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].UPDATE_VISITOR) {\n                if (node.className && node.className() === \'Skeleton\') {\n                    var validateSkeletonVisitor = new ValidateSkeletonVisitor();\n                    var children = node.getChildren();\n                    for (var i = 0, l = children.length; i < l; i++) {\n                        var child = children[i];\n                        child.accept(validateSkeletonVisitor);\n                    }\n\n                    //Re-order skeleton children to force correct bones update, we should put bones first\n                    children.sort(compareBone);\n\n                    this._needValidate = false;\n                }\n            }\n            return true;\n        }\n    }),\n    \'osgAnimation\',\n    \'UpdateSkeleton\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (UpdateSkeleton);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/UpdateSkeleton.js\n// module id = 112\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/UpdateSkeleton.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n\n\n\n\n/**\n * MorphAttribute encapsulate Animation State\n * @class MorphAttribute\n * @inherits StateAttribute\n */\nvar MorphAttribute = function(nbTarget, disable) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].call(this);\n    this._nbTarget = nbTarget;\n    this._enable = !disable;\n\n    this._targetNames = {};\n    this._hashNames = ''; // compute only once target hash names\n\n    this._hash = ''; // cache of hash\n    this._dirtyHash = true;\n};\n\nMorphAttribute.uniforms = {};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    MorphAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].prototype, {\n        attributeType: 'Morph',\n\n        cloneType: function() {\n            return new MorphAttribute(undefined, true);\n        },\n\n        hasTarget: function(name) {\n            return !!this._targetNames[name];\n        },\n\n        copyTargetNames: function(names) {\n            var tNames = this._targetNames;\n            var hash = '';\n            var nbNames = (tNames.length = names.length);\n\n            for (var i = 0; i < nbNames; ++i) {\n                var att = names[i];\n                tNames[att] = true;\n                hash += att;\n            }\n\n            this._hashNames = hash;\n            this._dirtyHash = true;\n        },\n\n        getOrCreateUniforms: function() {\n            var obj = MorphAttribute;\n            var unifHash = this.getNumTargets();\n\n            if (obj.uniforms[unifHash]) return obj.uniforms[unifHash];\n\n            obj.uniforms[unifHash] = {\n                uTargetWeights: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__[\"a\" /* default */].createFloat4('uTargetWeights')\n            };\n\n            return obj.uniforms[unifHash];\n        },\n\n        setNumTargets: function(nb) {\n            this._nbTarget = nb;\n            this._dirtyHash = true;\n        },\n\n        getNumTargets: function() {\n            return this._nbTarget;\n        },\n\n        setTargetWeights: function(targetWeight) {\n            this._targetWeights = targetWeight;\n        },\n\n        getTargetWeights: function() {\n            return this._targetWeights;\n        },\n\n        isEnabled: function() {\n            return this._enable;\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        },\n\n        _computeInternalHash: function() {\n            return this.getTypeMember() + this._hashNames + this.getNumTargets() + this.isEnabled();\n        },\n\n        apply: function() {\n            if (!this._enable) return;\n\n            var uniformMap = this.getOrCreateUniforms();\n            uniformMap.uTargetWeights.setFloat4(this._targetWeights);\n        }\n    }),\n    'osgAnimation',\n    'MorphAttribute'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (MorphAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/MorphAttribute.js\n// module id = 113\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/MorphAttribute.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n\n\n\n\n/**\n * SkinningAttribute encapsulate Animation State\n * @class SkinningAttribute\n * @inherits StateAttribute\n */\nvar SkinningAttribute = function(disable, boneUniformSize) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this._enable = !disable;\n    // optional, if it\'s not provided, it will fall back to the maximum bone uniform size\n    // boneUniformSize represents the number of vec4 (uniform) used in the shader for all the bones\n    this._boneUniformSize = boneUniformSize;\n\n    this._dirtyHash = true;\n    this._hash = \'\';\n};\n\nSkinningAttribute.uniforms = {};\nSkinningAttribute.maxBoneUniformSize = 1;\nSkinningAttribute.maxBoneUniformAllowed = Infinity; // can be overriden by application specific limit on startup (typically gl limit)\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    SkinningAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Skinning\',\n\n        cloneType: function() {\n            return new SkinningAttribute(true);\n        },\n\n        getBoneUniformSize: function() {\n            return this._boneUniformSize !== undefined\n                ? this._boneUniformSize\n                : SkinningAttribute.maxBoneUniformSize;\n        },\n\n        getOrCreateUniforms: function() {\n            var obj = SkinningAttribute;\n            var boneSize = this.getBoneUniformSize();\n\n            if (obj.uniforms[boneSize]) return obj.uniforms[boneSize];\n\n            obj.uniforms[boneSize] = {\n                uBones: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__["a" /* default */].createFloat4Array(\'uBones\', boneSize)\n            };\n\n            return obj.uniforms[boneSize];\n        },\n\n        setMatrixPalette: function(matrixPalette) {\n            this._matrixPalette = matrixPalette;\n            // update max bone size\n            if (this._boneUniformSize === undefined) {\n                SkinningAttribute.maxBoneUniformSize = Math.max(\n                    SkinningAttribute.maxBoneUniformSize,\n                    matrixPalette.length / 4\n                );\n                SkinningAttribute.maxBoneUniformSize = Math.min(\n                    SkinningAttribute.maxBoneUniformAllowed,\n                    SkinningAttribute.maxBoneUniformSize\n                );\n            }\n        },\n\n        getMatrixPalette: function() {\n            return this._matrixPalette;\n        },\n\n        // need a isEnabled to let the ShaderGenerator to filter\n        // StateAttribute from the shader compilation\n        isEnabled: function() {\n            return this._enable;\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = true;\n            return this._hash;\n        },\n\n        _computeInternalHash: function() {\n            // bone uniform size is hashed because the size of uniform is statically declared in the shader\n            return this.getTypeMember() + this.getBoneUniformSize() + this.isEnabled();\n        },\n\n        apply: function() {\n            if (!this._enable) return;\n\n            this.getOrCreateUniforms()\n                .uBones.getInternalArray()\n                .set(this._matrixPalette);\n        }\n    }),\n    \'osgAnimation\',\n    \'SkinningAttribute\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (SkinningAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/SkinningAttribute.js\n// module id = 114\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/SkinningAttribute.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/**\n * DrawArrayLengths manage rendering primitives\n * @class DrawArrayLengths\n */\nvar DrawArrayLengths = function(mode, first, array) {\n    this._mode = mode;\n    this._first = first;\n    this._arrayLengths = array.slice(0);\n};\n\n/** @lends DrawArrayLengths.prototype */\nDrawArrayLengths.prototype = {\n    draw: function(state) {\n        var gl = state.getGraphicContext();\n        var mode = this._mode;\n        var first = this._first;\n        var array = this._arrayLengths;\n        for (var i = 0, l = array.length; i < l; i++) {\n            var count = array[i];\n            gl.drawArrays(mode, first, count);\n            first += count;\n        }\n    },\n    getMode: function() {\n        return this._mode;\n    },\n    getNumIndices: function() {\n        var count = 0;\n        var array = this._arrayLengths;\n        for (var i = 0, l = array.length; i < l; i++) {\n            count += array[i];\n        }\n        return count;\n    },\n    getCount: function() {\n        return this.getNumIndices();\n    },\n    getArrayLengths: function() {\n        return this._arrayLengths;\n    },\n    getFirst: function() {\n        return this._first;\n    },\n    setFirst: function(first) {\n        this._first = first;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (DrawArrayLengths);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/DrawArrayLengths.js\n// module id = 115\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/DrawArrayLengths.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var FrameStamp = function() {\n    this._frame = 0;\n    this._startSimulation = 0.0;\n    this._currentSimulation = 0.0;\n    this._deltaTime = 0.0; // last time elapsed since the next traversal\n};\n\nFrameStamp.prototype = {\n    setReferenceTime: function(s) {\n        this._startSimulation = s;\n    },\n    getReferenceTime: function() {\n        return this._startSimulation;\n    },\n    setSimulationTime: function(s) {\n        this._currentSimulation = s;\n    },\n    getSimulationTime: function() {\n        return this._currentSimulation;\n    },\n    setDeltaTime: function(d) {\n        this._deltaTime = d;\n    },\n    getDeltaTime: function() {\n        return this._deltaTime;\n    },\n    setFrameNumber: function(n) {\n        this._frame = n;\n    },\n    getFrameNumber: function() {\n        return this._frame;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (FrameStamp);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/FrameStamp.js\n// module id = 116\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/FrameStamp.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_primitiveIndexFunctor__ = __webpack_require__(85);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_notify__ = __webpack_require__(2);\n\n\n\n\n\n\n\n// **** GENERAL INFO ON KDTREE ****\n// A KdTree is a Spatial Partitionning Tree (http://en.wikipedia.org/wiki/Space_partitioning)\n// The type of tree is sort of defined by the splitting axis method:\n// - Per Axis split (octree/ kdtree)\n// - Arbritrary direction split (bsp)\n\n// The algorithm used for splitting, the name for finding best split is \'Surface Area Heuristic (SAH)\'\n// Octree divide the space in 8 subspace (one box -> 8 sub boxes)\n// whereas kdtree does it by splitting population number in two equal group\n\n// Kd Tree http://en.wikipedia.org/wiki/K-d_tree\n// a given set of points is sorted along one Axis (e.g. X).\n// The sorted list is split at the median.\n// The result are two sets, one for each half-space (left and right).\n\n// Then, for the current node, the splitting-plane position (or the median-point) and depth is saved.\n// Finally, if the point-set has more than n point and the tree depth is below m\n// (with n,m chosen by the user, as build options), two child-nodes (L/R one for each point-set)\n// are created which themselfs repeat the pocedure.\n\n// The split-axis gets alternated at each depth, the split order is computed by checking the main\n// bounding box the length of its axis\n// **** GENERAL INFO ON KDTREE ****\n\n// The KdTree implemented here is flattened, ie, a node and its children all lie in the same array\n// The most important thing is the understanding of the variables first and second for each node\n// Their semantic depend if the node is a leaf or not\n// if it\'s a leaf :\n//   first and second defines a range in the triangles array (triangles in the cell)\n// if it\'s not a leaf :\n// - first and second respectively represents the left and right sub children\n// We know that a node is a leaf if first is negative, in that case the range will be defined by\n// [ -first - 1, -first-1 + second ]\nvar KdNode = function(first, second) {\n    this._bb = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n    this._first = first;\n    this._second = second;\n    // These variables represent the local clipped ray (for intersection test)\n    // They are mostly temporary because they are recomputed for each intersection test\n    this._nodeRayStart = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._nodeRayEnd = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n};\n\nvar InfoCollector = function() {\n    this._numVertexIndices = 0;\n};\n\nInfoCollector.prototype = {\n    apply: function(node) {\n        if (!node.getAttributes().Vertex) return;\n        Object(__WEBPACK_IMPORTED_MODULE_3_osg_primitiveIndexFunctor__["a" /* default */])(node, this);\n    },\n\n    operatorPoint: function() {\n        this._numVertexIndices += 2;\n    },\n\n    operatorLine: function() {\n        this._numVertexIndices += 3;\n    },\n\n    operatorTriangle: function() {\n        this._numVertexIndices += 4;\n    }\n};\n\nvar PrimitiveIndicesCollector = function(buildKdTree) {\n    this._buildKdTree = buildKdTree;\n    this._numIndices = 0;\n};\n\nPrimitiveIndicesCollector.prototype = {\n    apply: function(node) {\n        if (!node.getAttributes().Vertex) return;\n        Object(__WEBPACK_IMPORTED_MODULE_3_osg_primitiveIndexFunctor__["a" /* default */])(node, this);\n    },\n\n    operatorPoint: function(i0) {\n        var vertices = this._buildKdTree._kdTree.getVertices();\n        var iv = i0 * 3;\n        this._buildKdTree._kdTree.addPoint(i0);\n        this._buildKdTree._primitiveIndices[this._numIndices] = this._numIndices;\n        var centers = this._buildKdTree._centers;\n        var idCenter = this._numIndices * 3;\n        centers[idCenter] = vertices[iv];\n        centers[idCenter + 1] = vertices[iv + 1];\n        centers[idCenter + 2] = vertices[iv + 2];\n        this._numIndices++;\n    },\n\n    operatorLine: function(i0, i1) {\n        if (i0 === i1) return;\n        var vertices = this._buildKdTree._kdTree.getVertices();\n        var iv0 = i0 * 3;\n        var iv1 = i1 * 3;\n\n        this._buildKdTree._kdTree.addLine(i0, i1);\n\n        var numIndices = this._numIndices;\n        this._buildKdTree._primitiveIndices[numIndices] = numIndices;\n\n        var idCenter = numIndices * 3;\n\n        var v0x = vertices[iv0];\n        var v0y = vertices[iv0 + 1];\n        var v0z = vertices[iv0 + 2];\n\n        var v1x = vertices[iv1];\n        var v1y = vertices[iv1 + 1];\n        var v1z = vertices[iv1 + 2];\n\n        var minx = v0x < v1x ? v0x : v1x;\n        var miny = v0y < v1y ? v0y : v1y;\n        var minz = v0z < v1z ? v0z : v1z;\n\n        var maxx = v0x > v1x ? v0x : v1x;\n        var maxy = v0y > v1y ? v0y : v1y;\n        var maxz = v0z > v1z ? v0z : v1z;\n\n        var centers = this._buildKdTree._centers;\n        centers[idCenter] = (minx + maxx) * 0.5;\n        centers[idCenter + 1] = (miny + maxy) * 0.5;\n        centers[idCenter + 2] = (minz + maxz) * 0.5;\n\n        this._numIndices++;\n    },\n\n    operatorTriangle: function(i0, i1, i2) {\n        if (i0 === i1 || i0 === i2 || i1 === i2) return;\n\n        var vertices = this._buildKdTree._kdTree.getVertices();\n        var iv0 = i0 * 3;\n        var iv1 = i1 * 3;\n        var iv2 = i2 * 3;\n\n        this._buildKdTree._kdTree.addTriangle(i0, i1, i2);\n\n        var numIndices = this._numIndices;\n        this._buildKdTree._primitiveIndices[numIndices] = numIndices;\n\n        var idCenter = numIndices * 3;\n\n        var v0x = vertices[iv0];\n        var v0y = vertices[iv0 + 1];\n        var v0z = vertices[iv0 + 2];\n\n        var v1x = vertices[iv1];\n        var v1y = vertices[iv1 + 1];\n        var v1z = vertices[iv1 + 2];\n\n        var v2x = vertices[iv2];\n        var v2y = vertices[iv2 + 1];\n        var v2z = vertices[iv2 + 2];\n\n        var minx = v0x < v1x ? (v0x < v2x ? v0x : v2x) : v1x < v2x ? v1x : v2x;\n        var miny = v0y < v1y ? (v0y < v2y ? v0y : v2y) : v1y < v2y ? v1y : v2y;\n        var minz = v0z < v1z ? (v0z < v2z ? v0z : v2z) : v1z < v2z ? v1z : v2z;\n\n        var maxx = v0x > v1x ? (v0x > v2x ? v0x : v2x) : v1x > v2x ? v1x : v2x;\n        var maxy = v0y > v1y ? (v0y > v2y ? v0y : v2y) : v1y > v2y ? v1y : v2y;\n        var maxz = v0z > v1z ? (v0z > v2z ? v0z : v2z) : v1z > v2z ? v1z : v2z;\n\n        var centers = this._buildKdTree._centers;\n        centers[idCenter] = (minx + maxx) * 0.5;\n        centers[idCenter + 1] = (miny + maxy) * 0.5;\n        centers[idCenter + 2] = (minz + maxz) * 0.5;\n\n        this._numIndices++;\n    }\n};\n\nvar BuildKdTree = function(kdTree) {\n    this._kdTree = kdTree;\n    this._bb = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n    this._primitiveIndices = undefined; // Uint32Array\n    this._centers = undefined; // Float32Array\n    this._axisOrder = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._stackLength = 0;\n};\n\nBuildKdTree.prototype = {\n    build: function(options, geom) {\n        var targetTris = options._targetNumTrianglesPerLeaf;\n        var vertexAttrib = geom.getVertexAttributeList().Vertex;\n        if (!vertexAttrib) return false;\n        var vertices = vertexAttrib.getElements();\n        if (!vertices) return false;\n        var nbVertices = vertices.length / 3;\n        if (nbVertices < targetTris) return false;\n\n        this._bb.copy(geom.getBoundingBox());\n        this._kdTree.setVertices(vertices);\n\n        this.computeDivisions(options);\n        options._numVerticesProcessed += nbVertices;\n\n        var totalLenArray = 0;\n        var geomPrimitives = geom.getPrimitiveSetList();\n        var nbPrimitives = geomPrimitives.length;\n\n        for (var i = 0; i < nbPrimitives; i++) {\n            var prim = geomPrimitives[i];\n            var mode = prim.getMode();\n            if (mode === __WEBPACK_IMPORTED_MODULE_4_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP || mode === __WEBPACK_IMPORTED_MODULE_4_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN)\n                totalLenArray += Math.abs(prim.getCount() - 2) * 3;\n            else totalLenArray += prim.getCount() * 3;\n        }\n\n        var infoCollector = new InfoCollector(this);\n        infoCollector.apply(geom);\n        var vertexIndicesSize = infoCollector._numVertexIndices;\n\n        this._primitiveIndices = new Uint32Array(totalLenArray / 3);\n        this._centers = new Float32Array(totalLenArray);\n\n        // init kdtree arrays\n        // Check if we can use Uint16 later\n        this._kdTree.setPrimitiveIndices(new Uint32Array(totalLenArray));\n        var vertexIndicesArray =\n            nbVertices > 65535\n                ? new Uint32Array(vertexIndicesSize)\n                : new Uint16Array(vertexIndicesSize);\n        this._kdTree.setVertexIndices(vertexIndicesArray);\n\n        var pic = new PrimitiveIndicesCollector(this);\n        pic.apply(geom);\n\n        // Adjust sizes\n        var kdPrimIndices = this._kdTree\n            .getPrimitiveIndices()\n            .slice(0, this._kdTree.getNumPrimitiveIndices());\n        this._kdTree.setPrimitiveIndices(kdPrimIndices);\n        var kdVertexIndices = this._kdTree\n            .getVertexIndices()\n            .slice(0, this._kdTree.getNumVertexIndices());\n        this._kdTree.setVertexIndices(kdVertexIndices);\n\n        this._primitiveIndices = this._primitiveIndices.slice(0, pic._numIndices);\n        this._centers = this._centers.slice(0, pic._numIndices * 3);\n\n        var node = new KdNode(-1, this._primitiveIndices.length);\n        node._bb.copy(this._bb);\n        var nodeNum = this._kdTree.addNode(node);\n\n        var bb = new __WEBPACK_IMPORTED_MODULE_2_osg_BoundingBox__["a" /* default */]();\n        bb.copy(this._bb);\n        this.divide(options, bb, nodeNum, 0);\n\n        var primitiveIndices = this._kdTree.getPrimitiveIndices();\n\n        nbPrimitives = this._primitiveIndices.length;\n        for (i = 0; i < nbPrimitives; ++i) {\n            this._primitiveIndices[i] = primitiveIndices[this._primitiveIndices[i]];\n        }\n        this._kdTree.setPrimitiveIndices(this._primitiveIndices);\n\n        return this._kdTree.getNodes().length > 0;\n    },\n\n    computeDivisions: function(options) {\n        this._stackLength = options._maxNumLevels;\n        var max = this._bb._max;\n        var min = this._bb._min;\n        var dx = max[0] - min[0];\n        var dy = max[1] - min[1];\n        var dz = max[2] - min[2];\n        var axisOrder = this._axisOrder;\n\n        // We set the cutting order (longest edge aabb first)\n        axisOrder[0] = dx >= dy && dx >= dz ? 0 : dy >= dz ? 1 : 2;\n        axisOrder[2] = dx < dy && dx < dz ? 0 : dy < dz ? 1 : 2;\n        var sum = axisOrder[0] + axisOrder[2];\n        axisOrder[1] = sum === 3 ? 0 : sum === 2 ? 1 : 2;\n    },\n    // The core function of the kdtree building\n    // It checks if the node needs to be subdivided or not\n    // If it\'s a leaf, it computes the final bounding box of the node\n    // and it ends here\n    // If it\'s a node, then it puts the splitting axis position on the median population\n    // On the same time it reorders the triangle index array\n    divide: function(options, bb, nodeIndex, level) {\n        var kdTree = this._kdTree;\n        var primitives = this._primitiveIndices;\n        var nodes = kdTree.getNodes();\n        var node = nodes[nodeIndex];\n\n        var first = node._first;\n        var second = node._second;\n\n        var needToDivide =\n            level < this._stackLength && first < 0 && second > options._targetNumTrianglesPerLeaf;\n        var istart = -first - 1;\n        var iend = istart + second - 1;\n\n        if (!needToDivide) {\n            if (first < 0) {\n                // leaf is done, now compute bound on it.\n                this.computeNodeBox(node, istart, iend);\n            }\n            return nodeIndex;\n        }\n\n        if (first >= 0) return nodeIndex;\n        // leaf node as first < 0, so look at dividing it.\n\n        var axis = this._axisOrder[level % 3];\n        var originalMin = bb._min[axis];\n        var originalMax = bb._max[axis];\n\n        var mid = (originalMin + originalMax) * 0.5;\n\n        var originalLeftChildIndex = 0;\n        var originalRightChildIndex = 0;\n        var insitueDivision = false;\n\n        var left = istart;\n        var right = iend;\n\n        var centers = this._centers;\n        while (left < right) {\n            while (left < right && centers[primitives[left] * 3 + axis] <= mid) {\n                ++left;\n            }\n\n            while (left < right && centers[primitives[right] * 3 + axis] > mid) {\n                --right;\n            }\n\n            if (left < right) {\n                var tmp = primitives[left];\n                primitives[left] = primitives[right];\n                primitives[right] = tmp;\n                ++left;\n                --right;\n            }\n        }\n\n        if (left === right) {\n            if (centers[primitives[left] * 3 + axis] <= mid) ++left;\n            else --right;\n        }\n\n        if (right - istart <= -1) {\n            originalLeftChildIndex = 0;\n            originalRightChildIndex = nodeIndex;\n            insitueDivision = true;\n        } else if (iend - left <= -1) {\n            originalLeftChildIndex = nodeIndex;\n            originalRightChildIndex = 0;\n            insitueDivision = true;\n        } else {\n            originalLeftChildIndex = kdTree.addNode(new KdNode(-istart - 1, right - istart + 1));\n            originalRightChildIndex = kdTree.addNode(new KdNode(-left - 1, iend - left + 1));\n        }\n\n        var restore = bb._max[axis];\n        bb._max[axis] = mid;\n\n        var leftChildIndex =\n            originalLeftChildIndex !== 0\n                ? this.divide(options, bb, originalLeftChildIndex, level + 1)\n                : 0;\n\n        bb._max[axis] = restore;\n\n        restore = bb._min[axis];\n        bb._min[axis] = mid;\n\n        var rightChildIndex =\n            originalRightChildIndex !== 0\n                ? this.divide(options, bb, originalRightChildIndex, level + 1)\n                : 0;\n\n        bb._min[axis] = restore;\n\n        if (!insitueDivision) {\n            node._first = leftChildIndex;\n            node._second = rightChildIndex;\n\n            insitueDivision = true;\n\n            var bnode = node._bb;\n            bnode.init();\n            if (leftChildIndex !== 0) bnode.expandByBoundingBox(nodes[leftChildIndex]._bb);\n            if (rightChildIndex !== 0) bnode.expandByBoundingBox(nodes[rightChildIndex]._bb);\n        }\n        return nodeIndex;\n    },\n    // It computes the bounding box of the node so that the box contains all the triangles\n    // of the cell\n    computeNodeBox: function(node, istart, iend) {\n        var minx = Infinity,\n            miny = Infinity,\n            minz = Infinity,\n            maxx = -Infinity,\n            maxy = -Infinity,\n            maxz = -Infinity;\n        var vertexIndices = this._kdTree.getVertexIndices();\n        var primitives = this._kdTree.getPrimitiveIndices();\n        var vertices = this._kdTree.getVertices();\n        for (var i = istart; i <= iend; ++i) {\n            var primitiveIndex = primitives[this._primitiveIndices[i]];\n            var numPoints = vertexIndices[primitiveIndex++];\n            for (var j = 0; j < numPoints; ++j) {\n                var vi = vertexIndices[primitiveIndex++] * 3;\n                var vx = vertices[vi];\n                var vy = vertices[vi + 1];\n                var vz = vertices[vi + 2];\n\n                if (vx < minx) minx = vx;\n                if (vy < miny) miny = vy;\n                if (vz < minz) minz = vz;\n\n                if (vx > maxx) maxx = vx;\n                if (vy > maxy) maxy = vy;\n                if (vz > maxz) maxz = vz;\n            }\n        }\n        var epsilon = 1e-6;\n        var bnode = node._bb;\n        var bmin = bnode._min;\n        var bmax = bnode._max;\n        bmin[0] = minx - epsilon;\n        bmin[1] = miny - epsilon;\n        bmin[2] = minz - epsilon;\n        bmax[0] = maxx + epsilon;\n        bmax[1] = maxy + epsilon;\n        bmax[2] = maxz + epsilon;\n    }\n};\n\nvar KdTree = function() {\n    this._vertices = null;\n    this._kdNodes = [];\n    this._primitiveIndices = undefined;\n    this._vertexIndices = undefined;\n    this._numVertexIndices = 0;\n    this._numPrimitiveIndices = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    KdTree,\n    {\n        getVertices: function() {\n            return this._vertices;\n        },\n        setVertices: function(vertices) {\n            this._vertices = vertices;\n        },\n\n        getNumPrimitiveIndices: function() {\n            return this._numPrimitiveIndices;\n        },\n\n        getNumVertexIndices: function() {\n            return this._numVertexIndices;\n        },\n\n        setPrimitiveIndices: function(indices) {\n            this._primitiveIndices = indices;\n        },\n        getPrimitiveIndices: function() {\n            return this._primitiveIndices;\n        },\n\n        // vector containing the primitive vertex index data packed as no_vertice_indices then vertex indices\n        // ie. for points it\'s (1, p0), for lines (2, p0, p1) etc.\n        setVertexIndices: function(indices) {\n            this._vertexIndices = indices;\n        },\n\n        getVertexIndices: function() {\n            return this._vertexIndices;\n        },\n\n        getNodes: function() {\n            return this._kdNodes;\n        },\n\n        addPoint: function(p0) {\n            var i = this._numVertexIndices;\n            this._primitiveIndices[this._numPrimitiveIndices++] = i;\n            this._vertexIndices[this._numVertexIndices++] = 1;\n            this._vertexIndices[this._numVertexIndices++] = p0;\n        },\n\n        addLine: function(p0, p1) {\n            var i = this._numVertexIndices;\n            this._primitiveIndices[this._numPrimitiveIndices++] = i;\n            this._vertexIndices[this._numVertexIndices++] = 2;\n            this._vertexIndices[this._numVertexIndices++] = p0;\n            this._vertexIndices[this._numVertexIndices++] = p1;\n        },\n\n        addTriangle: function(p0, p1, p2) {\n            var i = this._numVertexIndices;\n            this._primitiveIndices[this._numPrimitiveIndices++] = i;\n            this._vertexIndices[this._numVertexIndices++] = 3;\n            this._vertexIndices[this._numVertexIndices++] = p0;\n            this._vertexIndices[this._numVertexIndices++] = p1;\n            this._vertexIndices[this._numVertexIndices++] = p2;\n        },\n\n        addNode: function(node) {\n            this._kdNodes.push(node);\n            return this._kdNodes.length - 1;\n        },\n        build: function(options, geom) {\n            var buildTree = new BuildKdTree(this);\n            return buildTree.build(options, geom);\n        },\n\n        _intersectFunctor: function(functor, node) {\n            // treat as a leaf\n            var istart = -node._first - 1;\n            var iend = istart + node._second;\n            var vIds = this._vertexIndices;\n\n            functor.setVertices(this._vertices);\n            functor.setPrimitiveIndex(istart);\n\n            for (var i = istart; i < iend; ++i) {\n                var pIndex = this._primitiveIndices[i];\n                var numVertices = vIds[pIndex++];\n\n                if (numVertices === 3) {\n                    functor.operatorTriangle(vIds[pIndex], vIds[pIndex + 1], vIds[pIndex + 2]);\n                } else if (numVertices === 2) {\n                    functor.operatorLine(vIds[pIndex], vIds[pIndex + 1]);\n                } else if (numVertices === 1) {\n                    functor.operatorPoint(vIds[pIndex]);\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_5_osg_notify__["a" /* default */].error(\'KdTree::intersect() unsupported vertices count :\' + numVertices);\n                }\n            }\n        },\n\n        intersect: function(functor, node) {\n            if (node._first < 0) {\n                this._intersectFunctor(functor, node);\n                return;\n            }\n\n            if (functor.enter(node._bb)) {\n                if (node._first > 0) {\n                    this.intersect(functor, this._kdNodes[node._first]);\n                }\n\n                if (node._second > 0) {\n                    this.intersect(functor, this._kdNodes[node._second]);\n                }\n                functor.leave();\n            }\n        },\n        intersectLineSegment: function(functor, node, ls, le) {\n            if (node._first < 0) {\n                this._intersectFunctor(functor, node);\n                return;\n            }\n\n            var s = node._nodeRayStart;\n            var e = node._nodeRayEnd;\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(s, ls);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(e, le);\n            var kNodes = this._kdNodes;\n            var kNode;\n            if (node._first > 0) {\n                kNode = kNodes[node._first];\n                if (functor.enter(kNode._bb, s, e)) this.intersectLineSegment(functor, kNode, s, e);\n            }\n\n            if (node._second > 0) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(s, ls);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(e, le);\n                kNode = kNodes[node._second];\n                if (functor.enter(kNode._bb, s, e)) this.intersectLineSegment(functor, kNode, s, e);\n            }\n        }\n    },\n    \'osg\',\n    \'KdTree\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (KdTree);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/KdTree.js\n// module id = 117\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/KdTree.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShader_node_common_glsl__ = __webpack_require__(201);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShader_node_common_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_osgShader_node_common_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_node_functions_glsl__ = __webpack_require__(202);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_node_functions_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_osgShader_node_functions_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_node_lightCommon_glsl__ = __webpack_require__(203);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_node_lightCommon_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_osgShader_node_lightCommon_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShader_node_lights_glsl__ = __webpack_require__(204);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShader_node_lights_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_osgShader_node_lights_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_node_skinning_glsl__ = __webpack_require__(205);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_node_skinning_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_osgShader_node_skinning_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShader_node_morphing_glsl__ = __webpack_require__(206);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShader_node_morphing_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_osgShader_node_morphing_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgShader_node_textures_glsl__ = __webpack_require__(207);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgShader_node_textures_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_osgShader_node_textures_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgShader_node_colorEncode_glsl__ = __webpack_require__(208);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgShader_node_colorEncode_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_osgShader_node_colorEncode_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgShader_node_billboard_glsl__ = __webpack_require__(209);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgShader_node_billboard_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_osgShader_node_billboard_glsl__);\n\n\n\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n    'common.glsl': __WEBPACK_IMPORTED_MODULE_0_osgShader_node_common_glsl___default.a,\n    'functions.glsl': __WEBPACK_IMPORTED_MODULE_1_osgShader_node_functions_glsl___default.a,\n    'lightCommon.glsl': __WEBPACK_IMPORTED_MODULE_2_osgShader_node_lightCommon_glsl___default.a,\n    'lights.glsl': __WEBPACK_IMPORTED_MODULE_3_osgShader_node_lights_glsl___default.a,\n    'skinning.glsl': __WEBPACK_IMPORTED_MODULE_4_osgShader_node_skinning_glsl___default.a,\n    'morphing.glsl': __WEBPACK_IMPORTED_MODULE_5_osgShader_node_morphing_glsl___default.a,\n    'textures.glsl': __WEBPACK_IMPORTED_MODULE_6_osgShader_node_textures_glsl___default.a,\n    'colorEncode.glsl': __WEBPACK_IMPORTED_MODULE_7_osgShader_node_colorEncode_glsl___default.a,\n    'billboard.glsl': __WEBPACK_IMPORTED_MODULE_8_osgShader_node_billboard_glsl___default.a\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/shaderLib.js\n// module id = 118\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/shaderLib.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShadow_shaders_shadowCast_glsl__ = __webpack_require__(210);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShadow_shaders_shadowCast_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_osgShadow_shaders_shadowCast_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShadow_shaders_shadowReceive_glsl__ = __webpack_require__(211);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShadow_shaders_shadowReceive_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_osgShadow_shaders_shadowReceive_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShadow_shaders_shadowLinearSoft_glsl__ = __webpack_require__(212);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShadow_shaders_shadowLinearSoft_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_osgShadow_shaders_shadowLinearSoft_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShadow_shaders_floatFromTex_glsl__ = __webpack_require__(213);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShadow_shaders_floatFromTex_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_osgShadow_shaders_floatFromTex_glsl__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShadow_shaders_tapPCF_glsl__ = __webpack_require__(214);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShadow_shaders_tapPCF_glsl___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_osgShadow_shaders_tapPCF_glsl__);\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n    'shadowCast.glsl': __WEBPACK_IMPORTED_MODULE_0_osgShadow_shaders_shadowCast_glsl___default.a,\n    'shadowReceive.glsl': __WEBPACK_IMPORTED_MODULE_1_osgShadow_shaders_shadowReceive_glsl___default.a,\n    'shadowLinearSoft.glsl': __WEBPACK_IMPORTED_MODULE_2_osgShadow_shaders_shadowLinearSoft_glsl___default.a,\n    'floatFromTex.glsl': __WEBPACK_IMPORTED_MODULE_3_osgShadow_shaders_floatFromTex_glsl___default.a,\n    'tapPCF.glsl': __WEBPACK_IMPORTED_MODULE_4_osgShadow_shaders_tapPCF_glsl___default.a\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/shaderLib.js\n// module id = 119\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/shaderLib.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var StackObjectPairPool = function() {\n    this._globalDefault = undefined;\n    this._lastApplied = undefined;\n    this._changed = false;\n\n    this._values = [];\n    this._back = undefined;\n    this._length = 0;\n};\n\nStackObjectPairPool.prototype = {\n    getLength: function() {\n        return this._length;\n    },\n    push: function(object, value) {\n        var objectPair;\n        if (this._length === this._values.length) {\n            objectPair = { object: object, value: value };\n            this._values.push(objectPair);\n        } else {\n            objectPair = this._values[this._length];\n            objectPair.object = object;\n            objectPair.value = value;\n        }\n        this._back = objectPair;\n        this._length++;\n    },\n    pop: function() {\n        if (!this._length) return undefined;\n        var values = this._values;\n        this._length--;\n        var objectPair = values[this._length];\n        this._back = this._length ? values[this._length - 1] : undefined;\n        return objectPair;\n    }\n};\n/* harmony default export */ __webpack_exports__["a"] = (StackObjectPairPool);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/StackObjectPairPool.js\n// module id = 120\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/StackObjectPairPool.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_StackObjectPairPool__ = __webpack_require__(120);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_WebGLCaps__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_StateCache__ = __webpack_require__(215);\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar checkUniformCache = [\n    undefined,\n    function uniformCheck1(uniformArray, cacheArray) {\n        if (uniformArray[0] === cacheArray[0]) return true;\n        cacheArray[0] = uniformArray[0];\n        return false;\n    },\n\n    function uniformCheck2(uniformArray, cacheArray) {\n        if (uniformArray[0] === cacheArray[0] && uniformArray[1] === cacheArray[1]) return true;\n        cacheArray[0] = uniformArray[0];\n        cacheArray[1] = uniformArray[1];\n        return false;\n    },\n\n    function uniformCheck3(uniformArray, cacheArray) {\n        if (\n            uniformArray[0] === cacheArray[0] &&\n            uniformArray[1] === cacheArray[1] &&\n            uniformArray[2] === cacheArray[2]\n        )\n            return true;\n        cacheArray[0] = uniformArray[0];\n        cacheArray[1] = uniformArray[1];\n        cacheArray[2] = uniformArray[2];\n        return false;\n    },\n\n    function uniformCheck4(uniformArray, cacheArray) {\n        if (\n            uniformArray[0] === cacheArray[0] &&\n            uniformArray[1] === cacheArray[1] &&\n            uniformArray[2] === cacheArray[2] &&\n            uniformArray[3] === cacheArray[3]\n        )\n            return true;\n        cacheArray[0] = uniformArray[0];\n        cacheArray[1] = uniformArray[1];\n        cacheArray[2] = uniformArray[2];\n        cacheArray[3] = uniformArray[3];\n        return false;\n    }\n];\n\nvar State = function(shaderGeneratorProxy) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].call(this);\n\n    this._excludeUniforms = {\n        uProjectionMatrix: true,\n        uModelMatrix: true,\n        uViewMatrix: true,\n        uModelViewMatrix: true,\n        uModelNormalMatrix: true,\n        uModelViewNormalMatrix: true,\n        uArrayColorEnabled: true\n    };\n\n    this._graphicContext = undefined;\n    this._shaderGeneratorProxy = shaderGeneratorProxy;\n\n    if (shaderGeneratorProxy === undefined) console.break();\n\n    this._currentVAO = null;\n    this._currentIndexVBO = null;\n\n    this._stateSets = new __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__["a" /* default */]();\n    this._shaderGeneratorNames = new __WEBPACK_IMPORTED_MODULE_6_osg_StackObjectPairPool__["a" /* default */]();\n    this._uniforms = {};\n\n    this._textureAttributeArrayList = [];\n    this._attributeArray = [];\n\n    this._projectionMatrix = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createMatrix4(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), \'uProjectionMatrix\');\n    this._modelMatrix = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createMatrix4(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), \'uModelMatrix\');\n    this._viewMatrix = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createMatrix4(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), \'uViewMatrix\');\n    this._modelViewMatrix = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createMatrix4(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), \'uModelViewMatrix\');\n    this._modelNormalMatrix = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createMatrix3(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["b" /* mat3 */].create(), \'uModelNormalMatrix\');\n    this._modelViewNormalMatrix = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createMatrix3(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["b" /* mat3 */].create(), \'uModelViewNormalMatrix\');\n\n    // track uniform for color array enabled\n    var arrayColorEnable = new __WEBPACK_IMPORTED_MODULE_6_osg_StackObjectPairPool__["a" /* default */]();\n    arrayColorEnable._globalDefault = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createFloat1(0.0, \'uArrayColorEnabled\');\n\n    this._uniforms.ArrayColorEnabled = arrayColorEnable;\n\n    this._previousColorAttribPair = {};\n    this._vertexAttribMap = {};\n    this._vertexAttribMap._disable = [];\n    this._vertexAttribMap._keys = [];\n\n    this._frameStamp = undefined;\n\n    // we dont use Map because in this use case with a few entries\n    // {} is faster\n    this._programCommonUniformsCache = {};\n\n    // keep pointer on the last applied modelview and projection matrix\n    this._lastAppliedModelViewMatrix = undefined;\n    this._lastAppliedProjectionMatrix = undefined;\n\n    // keep track of last applied program\n    this._program = undefined;\n    // inject a default program to initialize the stack Program\n    var program = new __WEBPACK_IMPORTED_MODULE_3_osg_Program__["a" /* default */]();\n    this.applyAttribute(program);\n\n    // cache programAttribute access\n    this._programType = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateStateAttributeTypeMemberIndex(program);\n    this._programAttribute = this._attributeArray[this._programType];\n\n    this._numPushStateSet = 0;\n    this._numApply = 0;\n\n    this._programUniformCache = [];\n    this._cacheUniformId = 0;\n\n    // gl states cache\n    this._stateCache = new __WEBPACK_IMPORTED_MODULE_10_osg_StateCache__["a" /* default */]();\n\n    this.resetStats();\n};\n\n__WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].createPrototypeObject(\n    State,\n    __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].prototype, {\n        // excludeUniforms is a list of uniforms that will not be applied or checked automatically when applying a program\n        // you should not add you uniforms in this list until you really know what you are doing.\n        // The use case of the exclusions is because the RenderLeaf.drawGeometry will apply them without UniformStack and\n        // it should be applied automatically because you will apply them RenderLeaf.drawGeometry.\n        // If you are writing a custom renderStage or overriding RenderLeaf.drawGeometry and add new uniform and custom\n        // behavior then it can make sense to add uniforms here.\n        // To make it work you should add your uniforms before the rendering (usually before viewer.run())\n        getExcludeUniforms: function() {\n            return this._excludeUniforms;\n        },\n\n        resetCaches: function() {\n            this._currentVAO = null;\n            this._currentIndexVBO = null;\n\n            this._previousColorAttribPair = {};\n            this._vertexAttribMap = {};\n            this._vertexAttribMap._disable = [];\n            this._vertexAttribMap._keys = [];\n\n            this._programCommonUniformsCache = {};\n        },\n\n        applyColorMask: function(attribute) {\n            this._stateCache.applyColorMaskAttribute(attribute);\n        },\n\n        applyBlendFunc: function(attribute) {\n            this._stateCache.applyBlendFuncAttribute(attribute);\n        },\n\n        applyCullFace: function(attribute) {\n            this._stateCache.applyCullFaceAttribute(attribute);\n        },\n\n        applyDepth: function(attribute) {\n            this._stateCache.applyDepthAttribute(attribute);\n        },\n\n        applyViewport: function(attribute) {\n            this._stateCache.applyViewportAttribute(attribute);\n        },\n\n        applyScissor: function(attribute) {\n            this._stateCache.applyScissorAttribute(attribute);\n        },\n\n        viewport: function(x, y, width, height) {\n            this._stateCache.viewport(x, y, width, height);\n        },\n\n        depthMask: function(value) {\n            this._stateCache.depthMask(value);\n        },\n\n        clearDepth: function(value) {\n            this._stateCache.clearDepth(value);\n        },\n\n        clearColor: function(value) {\n            this._stateCache.clearColor(value);\n        },\n\n        clear: function(mask) {\n            this._stateCache.clear(this._graphicContext, mask);\n        },\n\n        drawGeometry: function(geom) {\n            this._stateCache.drawGeometry(this._graphicContext, geom);\n        },\n\n        getCacheUniformsApplyRenderLeaf: function() {\n            return this._programCommonUniformsCache;\n        },\n\n        setGraphicContext: function(graphicContext) {\n            this._graphicContext = graphicContext;\n            this._extVAO = __WEBPACK_IMPORTED_MODULE_9_osg_WebGLCaps__["a" /* default */].instance(graphicContext).getWebGLExtension(\n                \'OES_vertex_array_object\'\n            );\n        },\n\n        getGraphicContext: function() {\n            return this._graphicContext;\n        },\n\n        getShaderGeneratorProxy: function() {\n            return this._shaderGeneratorProxy;\n        },\n\n        pushCheckOverride: function(stack, object, maskValue) {\n            var result = this._evaluateOverrideObjectOnStack(stack, object, maskValue);\n            // override and protected case\n            if (result !== object) stack.push(result, stack._back.value);\n            else stack.push(object, maskValue);\n        },\n\n        _evaluateOverrideObjectOnStack: function(stack, object, maskValue) {\n            var back = stack._back;\n            // object can be a Uniform, an Attribute, or a shader generator name\n            if (stack._length === 0) {\n                return object;\n            } else if (\n                back.value & __WEBPACK_IMPORTED_MODULE_4_osg_StateAttribute__["a" /* default */].OVERRIDE &&\n                !(maskValue & __WEBPACK_IMPORTED_MODULE_4_osg_StateAttribute__["a" /* default */].PROTECTED)\n            ) {\n                return back.object;\n            } else {\n                return object;\n            }\n        },\n\n        pushStateSet: function(stateset) {\n            this._numPushStateSet++;\n            this._stateSets.push(stateset);\n\n            this.pushAttributeMap(\n                this._attributeArray,\n                stateset._attributeArray,\n                stateset._activeAttribute\n            );\n\n            var textureAttributeArrayList = stateset._textureAttributeArrayList;\n            var activeTextureUnits = stateset._activeTextureAttributeUnit;\n            var activeTextureAttribute = stateset._activeTextureAttribute;\n\n            for (var i = 0, l = activeTextureUnits.length; i < l; i++) {\n                var unit = activeTextureUnits[i];\n                var _attributeArray = textureAttributeArrayList[unit];\n\n                var textureUnitAttributeArray = this.getOrCreateTextureAttributeArray(unit);\n                this.pushAttributeMap(\n                    textureUnitAttributeArray,\n                    _attributeArray,\n                    activeTextureAttribute\n                );\n            }\n\n            if (stateset.hasUniform())\n                this.pushUniformsList(this._uniforms, stateset.getUniformList());\n\n            var generatorPair = stateset.getShaderGeneratorPair();\n            if (generatorPair)\n                this.pushCheckOverride(\n                    this._shaderGeneratorNames,\n                    generatorPair.getShaderGeneratorName(),\n                    generatorPair.getValue()\n                );\n        },\n\n        getStateSetStackSize: function() {\n            return this._stateSets.getLength();\n        },\n\n        insertStateSet: (function() {\n            var tmpStack = new __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__["a" /* default */]();\n            var tmpStackArray = tmpStack.getArray();\n            return function(pos, stateSet) {\n                tmpStack.reset();\n                var length = this.getStateSetStackSize();\n                while (length > pos) {\n                    tmpStack.push(this._stateSets.back());\n                    this.popStateSet();\n                    length--;\n                }\n\n                this.pushStateSet(stateSet);\n\n                for (var i = tmpStack._length - 1; i >= 0; i--) {\n                    this.pushStateSet(tmpStackArray[i]);\n                }\n            };\n        })(),\n\n        removeStateSet: (function() {\n            var tmpStack = new __WEBPACK_IMPORTED_MODULE_5_osg_PooledArray__["a" /* default */]();\n            var tmpStackArray = tmpStack.getArray();\n            return function(pos) {\n                var length = this.getStateSetStackSize();\n                if (pos >= length) {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\'Warning State:removeStateSet \' + pos + \' out of range\');\n                    return;\n                }\n\n                tmpStack.reset();\n\n                // record the StateSet above the one we intend to remove\n                while (length - 1 > pos) {\n                    tmpStack.push(this._stateSets.back());\n                    this.popStateSet();\n                    length--;\n                }\n\n                // remove the intended StateSet as well\n                this.popStateSet();\n\n                // push back the original ones that were above the remove StateSet\n                for (var i = tmpStack._length - 1; i >= 0; i--) {\n                    this.pushStateSet(tmpStackArray[i]);\n                }\n            };\n        })(),\n\n        // needed because we use a cache during the frame to avoid\n        // applying uniform or operation. At each frame we need to\n        // invalidate those informations\n        resetCacheFrame: function() {\n            this._lastAppliedModelViewMatrix = this._lastAppliedProjectionMatrix = undefined;\n        },\n\n        resetStats: function() {\n            this._numApply = 0;\n            this._numPushStateSet = 0;\n        },\n\n        // apply program if needed\n        applyProgram: function(program) {\n            if (this._program === program) return;\n            this._program = program;\n            this.getGraphicContext().useProgram(program);\n        },\n\n        applyModelViewMatrix: (function() {\n            var normal = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["b" /* mat3 */].create();\n\n            return function StateApplyModelViewMatrix(matrix, matrixModel) {\n                if (this._lastAppliedModelViewMatrix === matrix) return false;\n\n                var program = this.getLastProgramApplied();\n                var uniformCache = program.getUniformsCache();\n                var mu = this._modelViewMatrix;\n                var mul = uniformCache.uModelViewMatrix;\n                var gc = this.getGraphicContext();\n                if (mul) {\n                    mu.setMatrix4(matrix);\n                    mu.apply(gc, mul);\n                }\n\n                var sendNormal;\n                if (this._lastAppliedModelViewMatrix) {\n                    // check if we need to push normal\n                    // test rotation component, if not diff\n                    // we dont need to send normal\n                    var m2 = this._lastAppliedModelViewMatrix;\n                    for (var i = 0; i < 11; i++) {\n                        if (matrix[i] !== m2[i]) {\n                            sendNormal = true;\n                            break;\n                        }\n                    }\n                } else {\n                    sendNormal = true;\n                }\n\n                if (sendNormal) {\n                    mu = this._modelViewNormalMatrix;\n                    mul = uniformCache.uModelViewNormalMatrix;\n                    if (mul) {\n                        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["b" /* mat3 */].normalFromMat4(normal, matrix);\n                        mu.setMatrix3(normal);\n                        mu.apply(gc, mul);\n                    }\n\n                    mul = uniformCache.uModelNormalMatrix;\n                    if (mul) {\n                        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["b" /* mat3 */].normalFromMat4(normal, matrixModel);\n                        mu.setMatrix3(normal);\n                        mu.apply(gc, mul);\n                    }\n                }\n\n                this._lastAppliedModelViewMatrix = matrix;\n                return true;\n            };\n        })(),\n\n        applyProjectionMatrix: function(matrix) {\n            if (this._lastAppliedProjectionMatrix === matrix) return;\n\n            this._lastAppliedProjectionMatrix = matrix;\n            var program = this.getLastProgramApplied();\n            var mu = this._projectionMatrix;\n\n            var mul = program.getUniformsCache()[mu.getName()];\n            if (mul) {\n                mu.setMatrix4(matrix);\n                mu.apply(this.getGraphicContext(), mul);\n            }\n        },\n\n        getCurrentShaderGeneratorStateSet: function(stateset) {\n            var programStack = this._programAttribute;\n            var stateSetProgramPair = stateset._attributeArray[this._programType];\n\n            if (\n                (programStack._length !== 0 && programStack._back.value !== __WEBPACK_IMPORTED_MODULE_4_osg_StateAttribute__["a" /* default */].OFF) ||\n                (stateSetProgramPair && stateSetProgramPair.getValue() !== __WEBPACK_IMPORTED_MODULE_4_osg_StateAttribute__["a" /* default */].OFF)\n            )\n                return undefined;\n\n            var stateSetGeneratorPair = stateset.getShaderGeneratorPair();\n            var generatorStack = this._shaderGeneratorNames;\n            var generator;\n\n            if (stateSetGeneratorPair) {\n                var maskValue = stateSetGeneratorPair.getValue();\n                var stateSetGenerator = stateSetGeneratorPair.getShaderGeneratorName();\n                generator = this._evaluateOverrideObjectOnStack(\n                    this._shaderGeneratorNames,\n                    stateSetGenerator,\n                    maskValue\n                );\n            } else if (generatorStack._length) {\n                generator = generatorStack._back.object;\n            }\n\n            // no custom program look into the stack of ShaderGenerator name\n            // what we should use to generate a program\n            var last = generator;\n            var shaderGenerator = this._shaderGeneratorProxy.getShaderGenerator(last);\n            return shaderGenerator;\n        },\n\n        _applyAttributeMapStateSet: function(_attributeArray, stateSetAttributeArray) {\n            var max =\n                _attributeArray.length > stateSetAttributeArray.length\n                    ? _attributeArray.length\n                    : stateSetAttributeArray.length;\n\n            for (var i = 0, l = max; i < l; i++) {\n                var attribute;\n                var attributeId = i;\n\n                var attributeStack =\n                    attributeId < _attributeArray.length ? _attributeArray[attributeId] : undefined;\n\n                var stateSetAttributePair =\n                    attributeId < stateSetAttributeArray.length\n                        ? stateSetAttributeArray[attributeId]\n                        : undefined;\n\n                var hasStateAttributeStack = !!attributeStack;\n                var hasStateAttributeStackChanged =\n                    hasStateAttributeStack && attributeStack._changed;\n\n                if (!stateSetAttributePair && !hasStateAttributeStackChanged) continue;\n\n                var stateSetAttribute = stateSetAttributePair\n                    ? stateSetAttributePair.getAttribute()\n                    : undefined;\n\n                if (!hasStateAttributeStack) {\n                    attributeStack = this._createAttributeStack(\n                        _attributeArray,\n                        attributeId,\n                        stateSetAttribute.cloneType()\n                    );\n                    attributeStack._changed = true;\n                    this._applyAttributeStack(stateSetAttribute, attributeStack);\n                } else if (stateSetAttribute) {\n                    var maskValue = stateSetAttributePair.getValue();\n                    attribute = this._evaluateOverrideObjectOnStack(\n                        attributeStack,\n                        stateSetAttribute,\n                        maskValue\n                    );\n                    if (attribute !== stateSetAttribute) {\n                        // override\n\n                        if (attributeStack._changed) {\n                            this._applyAttributeStack(attribute, attributeStack);\n                            attributeStack._changed = false;\n                        }\n                    } else if (this._applyAttributeStack(attribute, attributeStack)) {\n                        attributeStack._changed = true;\n                    }\n                } else if (attributeStack._length) {\n                    attributeStack._changed = false;\n                    this._applyAttributeStack(attributeStack._back.object, attributeStack);\n                } else {\n                    attributeStack._changed = false;\n                    this._applyAttributeStack(attributeStack._globalDefault, attributeStack);\n                }\n            }\n        },\n\n        _applyTextureAttributeMapListStateSet: function(\n            _textureAttributeArrayList,\n            stateSetTextureAttributeArrayList\n        ) {\n            var _textureAttributeArray;\n            var stateSetTextureAttributeLength, stateTextureAttributeLength;\n            // very interesting JIT optimizer behavior\n            // max texture is supposed to be the max of activeTexture or stateSet texture list\n            // if the loop is fix, for example max value that could be 16. It\'s faster than using the max of textureUnit of State and StateSet even if the value is 8 for example\n            var maxTexture = 16;\n            for (var i = 0, l = maxTexture; i < l; i++) {\n                var textureUnit = i;\n\n                _textureAttributeArray =\n                    textureUnit < _textureAttributeArrayList.length\n                        ? _textureAttributeArrayList[textureUnit]\n                        : undefined;\n                var stateSetTextureAttributeArray =\n                    textureUnit < stateSetTextureAttributeArrayList.length\n                        ? stateSetTextureAttributeArrayList[textureUnit]\n                        : undefined;\n\n                if (!_textureAttributeArray && !stateSetTextureAttributeArray) continue;\n\n                stateSetTextureAttributeLength = stateTextureAttributeLength = 0;\n                if (!_textureAttributeArray) {\n                    _textureAttributeArray = this.getOrCreateTextureAttributeArray(textureUnit);\n                    stateSetTextureAttributeLength = stateSetTextureAttributeArray.length;\n                } else {\n                    stateTextureAttributeLength = _textureAttributeArray.length;\n                    if (stateSetTextureAttributeArray)\n                        stateSetTextureAttributeLength = stateSetTextureAttributeArray.length;\n                }\n\n                var lt =\n                    stateTextureAttributeLength > stateSetTextureAttributeLength\n                        ? stateTextureAttributeLength\n                        : stateSetTextureAttributeLength;\n                for (var j = 0; j < lt; j++) {\n                    var attributeId = j;\n\n                    var attributeStack =\n                        attributeId < stateTextureAttributeLength\n                            ? _textureAttributeArray[attributeId]\n                            : undefined;\n\n                    var stateSetAttributePair =\n                        stateSetTextureAttributeArray &&\n                        attributeId < stateSetTextureAttributeArray.length\n                            ? stateSetTextureAttributeArray[attributeId]\n                            : undefined;\n                    var hasStateAttributeStack = !!attributeStack;\n                    var hasStateAttributeStackChanged =\n                        hasStateAttributeStack && attributeStack._changed;\n                    var attribute;\n\n                    if (!stateSetAttributePair && !hasStateAttributeStackChanged) continue;\n\n                    var stateSetAttribute = stateSetAttributePair\n                        ? stateSetAttributePair.getAttribute()\n                        : undefined;\n\n                    if (!hasStateAttributeStack) {\n                        attribute = stateSetAttributePair.getAttribute();\n                        attributeStack = this._createAttributeStack(\n                            _textureAttributeArray,\n                            attributeId,\n                            attribute.cloneType()\n                        );\n                        attributeStack._changed = true;\n                        this._applyTextureAttribute(textureUnit, attribute, attributeStack);\n                    } else if (stateSetAttribute) {\n                        var maskValue = stateSetAttributePair.getValue();\n                        attribute = this._evaluateOverrideObjectOnStack(\n                            attributeStack,\n                            stateSetAttribute,\n                            maskValue\n                        );\n                        if (attribute !== stateSetAttribute) {\n                            // override\n\n                            if (attributeStack._changed) {\n                                this._applyTextureAttribute(textureUnit, attribute, attributeStack);\n                                attributeStack._changed = false;\n                            }\n                        } else if (\n                            this._applyTextureAttribute(textureUnit, attribute, attributeStack)\n                        ) {\n                            attributeStack._changed = true;\n                        }\n                    } else if (attributeStack._length) {\n                        attributeStack._changed = false;\n                        this._applyTextureAttribute(\n                            textureUnit,\n                            attributeStack._back.object,\n                            attributeStack\n                        );\n                    } else {\n                        attributeStack._changed = false;\n                        this._applyTextureAttribute(\n                            textureUnit,\n                            attributeStack._globalDefault,\n                            attributeStack\n                        );\n                    }\n                }\n            }\n        },\n\n        applyStateSet: function(stateset) {\n            this._numApply++;\n\n            var previousProgram = this.getLastProgramApplied();\n\n            // needed before calling applyAttributeMap because\n            // we cache needed StateAttribute from the compiler\n            this._currentShaderGenerator = this.getCurrentShaderGeneratorStateSet(stateset);\n\n            this._applyAttributeMapStateSet(this._attributeArray, stateset._attributeArray);\n            this._applyTextureAttributeMapListStateSet(\n                this._textureAttributeArrayList,\n                stateset._textureAttributeArrayList\n            );\n\n            var lastApplied;\n            if (this._currentShaderGenerator) {\n                // no custom program look into the stack of ShaderGenerator name\n                // what we should use to generate a program\n                var generatedProgram = this._currentShaderGenerator.getOrCreateProgram(this);\n                this.applyAttribute(generatedProgram);\n                lastApplied = generatedProgram;\n\n                // will cache uniform and apply them with the program\n                this._applyGeneratedProgramUniforms(generatedProgram, stateset);\n            } else {\n                lastApplied = this.getLastProgramApplied();\n                // custom program so we will iterate on uniform from the program and apply them\n                // but in order to be able to use Attribute in the state graph we will check if\n                // our program want them. It must be defined by the user\n                this._applyCustomProgramUniforms(lastApplied, stateset);\n            }\n\n            // reset reference of last applied matrix\n            if (previousProgram !== lastApplied) {\n                this._lastAppliedModelViewMatrix = undefined;\n                this._lastAppliedProjectionMatrix = undefined;\n            }\n        },\n\n        popAllStateSets: function() {\n            while (this._stateSets._length) {\n                this.popStateSet();\n            }\n        },\n\n        popStateSet: function() {\n            if (!this._stateSets._length) return;\n\n            var stateset = this._stateSets.pop();\n\n            this.popAttributeMap(\n                this._attributeArray,\n                stateset._attributeArray,\n                stateset._activeAttribute\n            );\n\n            var textureAttributeArrayList = stateset._textureAttributeArrayList;\n            var activeTextureUnits = stateset._activeTextureAttributeUnit;\n            var activeTextureAttribute = stateset._activeTextureAttribute;\n\n            for (var i = 0, l = activeTextureUnits.length; i < l; i++) {\n                var unit = activeTextureUnits[i];\n                var _attributeArray = textureAttributeArrayList[unit];\n                var textureUnitAttributeArray = this._textureAttributeArrayList[unit];\n                this.popAttributeMap(\n                    textureUnitAttributeArray,\n                    _attributeArray,\n                    activeTextureAttribute\n                );\n            }\n\n            if (stateset.hasUniform())\n                this.popUniformsList(this._uniforms, stateset.getUniformList());\n\n            if (stateset.getShaderGeneratorPair()) {\n                this._shaderGeneratorNames.pop();\n            }\n        },\n\n        _createAttributeStack: function(_attributeArray, typeIndex, globalDefault) {\n            __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].arrayDense(typeIndex, _attributeArray);\n            var attributeStack = new __WEBPACK_IMPORTED_MODULE_6_osg_StackObjectPairPool__["a" /* default */]();\n            attributeStack._globalDefault = globalDefault;\n\n            _attributeArray[typeIndex] = attributeStack;\n\n            return attributeStack;\n        },\n\n        haveAppliedAttribute: function(attribute) {\n            if (!attribute) return;\n\n            var attributeArray = this._attributeArray;\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateStateAttributeTypeMemberIndex(attribute);\n            var attributeStack = index < attributeArray.length ? attributeArray[index] : undefined;\n            if (!attributeStack) {\n                attributeStack = this._createAttributeStack(\n                    attributeArray,\n                    index,\n                    attribute.cloneType()\n                );\n            }\n            attributeStack._lastApplied = attribute;\n            attributeStack._changed = true;\n        },\n\n        applyAttribute: function(attribute) {\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateStateAttributeTypeMemberIndex(attribute);\n\n            var attributeArray = this._attributeArray;\n            var attributeStack = index < attributeArray.length ? attributeArray[index] : undefined;\n            if (!attributeStack) {\n                attributeStack = this._createAttributeStack(\n                    attributeArray,\n                    index,\n                    attribute.cloneType()\n                );\n            }\n\n            attributeStack._changed = true;\n            this._applyAttributeStack(attribute, attributeStack);\n        },\n\n        _applyAttributeStack: function(attribute, attributeStack) {\n            if (attributeStack._lastApplied === attribute) return false;\n\n            if (attribute.apply) attribute.apply(this);\n\n            attributeStack._lastApplied = attribute;\n            return true;\n        },\n\n        _applyTextureAttribute: function(unit, attribute, attributeStack) {\n            if (attributeStack._lastApplied === attribute) return false;\n\n            attributeStack._lastApplied = attribute;\n\n            if (!attribute.apply) return true;\n\n            var gl = this.getGraphicContext();\n            gl.activeTexture(gl.TEXTURE0 + unit);\n\n            // there is a texture we bind it.\n            attribute.apply(this, unit);\n\n            return true;\n        },\n\n        applyTextureAttribute: function(unit, attribute) {\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateTextureStateAttributeTypeMemberIndex(attribute);\n            var textureUnitAttributeArray = this.getOrCreateTextureAttributeArray(unit);\n            var attributeStack = textureUnitAttributeArray[index];\n\n            if (!attributeStack)\n                attributeStack = this._createAttributeStack(\n                    textureUnitAttributeArray,\n                    index,\n                    attribute.cloneType()\n                );\n\n            attributeStack._changed = true;\n            this._applyTextureAttribute(unit, attribute, attributeStack);\n        },\n\n        getLastProgramApplied: function() {\n            return this._programAttribute._lastApplied;\n        },\n\n        applyDefault: function() {\n            this.popAllStateSets();\n\n            this._currentShaderGenerator = undefined;\n\n            this.applyAttributeMap(this._attributeArray);\n            this.applyTextureAttributeMapList(this._textureAttributeArrayList);\n        },\n\n        applyAttributeMap: function(_attributeArray) {\n            var attributeStack;\n            for (var i = 0, l = _attributeArray.length; i < l; i++) {\n                attributeStack = _attributeArray[i];\n                if (!attributeStack) continue;\n\n                var attribute;\n                if (attributeStack._length) attribute = attributeStack._back.object;\n                else attribute = attributeStack._globalDefault;\n\n                if (!attributeStack._changed) continue;\n\n                if (attributeStack._lastApplied !== attribute) {\n                    if (attribute.apply) attribute.apply(this);\n\n                    attributeStack._lastApplied = attribute;\n                }\n\n                attributeStack._changed = false;\n            }\n        },\n\n        pushUniformsList: function(uniformMap, stateSetUniformMap) {\n            /*jshint bitwise: false */\n            var name;\n            var uniform;\n\n            for (var key in stateSetUniformMap) {\n                var uniformPair = stateSetUniformMap[key];\n                uniform = uniformPair.getUniform();\n                name = uniform.getName();\n                if (!uniformMap[name]) {\n                    this._createAttributeStack(uniformMap, name, uniform);\n                }\n\n                this.pushCheckOverride(uniformMap[name], uniform, uniformPair.getValue());\n            }\n            /*jshint bitwise: true */\n        },\n\n        popUniformsList: function(uniformMap, stateSetUniformMap) {\n            for (var key in stateSetUniformMap) {\n                uniformMap[key].pop();\n            }\n        },\n\n        applyTextureAttributeMapList: function(textureAttributeArrayList) {\n            var gl = this._graphicContext;\n            var textureAttributeArray;\n\n            for (\n                var textureUnit = 0, l = textureAttributeArrayList.length;\n                textureUnit < l;\n                textureUnit++\n            ) {\n                textureAttributeArray = textureAttributeArrayList[textureUnit];\n                if (!textureAttributeArray) continue;\n\n                for (var i = 0, lt = textureAttributeArray.length; i < lt; i++) {\n                    var attributeStack = textureAttributeArray[i];\n\n                    // skip if not stack or not changed in stack\n                    if (!attributeStack) continue;\n\n                    var attribute;\n                    if (attributeStack._length) attribute = attributeStack._back.object;\n                    else attribute = attributeStack._globalDefault;\n\n                    if (!attributeStack._changed) continue;\n\n                    // if the the stack has changed but the last applied attribute is the same\n                    // then we dont need to apply it again\n                    if (attributeStack._lastApplied !== attribute) {\n                        gl.activeTexture(gl.TEXTURE0 + textureUnit);\n                        attribute.apply(this, textureUnit);\n\n                        attributeStack._lastApplied = attribute;\n                    }\n\n                    attributeStack._changed = false;\n                }\n            }\n        },\n\n        setGlobalDefaultAttribute: function(attribute) {\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateStateAttributeTypeMemberIndex(attribute);\n            if (index >= this._attributeArray.length || !this._attributeArray[index]) {\n                this._createAttributeStack(this._attributeArray, index, attribute);\n            } else {\n                this._attributeArray[index]._globalDefault = attribute;\n            }\n        },\n\n        getGlobalDefaultAttribute: function(typeMember) {\n            var _attributeArray = this._attributeArray;\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getIdFromTypeMember(typeMember);\n            if (index === undefined || index >= _attributeArray.length) return undefined;\n            return _attributeArray[index] ? _attributeArray[index]._globalDefault : undefined;\n        },\n\n        setGlobalDefaultTextureAttribute: function(unit, attribute) {\n            var attributeArray = this.getOrCreateTextureAttributeArray(unit);\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateTextureStateAttributeTypeMemberIndex(attribute);\n\n            if (index >= attributeArray.length || !attributeArray[index]) {\n                this._createAttributeStack(attributeArray, index, attribute);\n            } else {\n                attributeArray[index]._globalDefault = attribute;\n            }\n        },\n\n        getGlobalDefaultTextureAttribute: function(unit, typeMember) {\n            var attributeArray = this.getOrCreateTextureAttributeArray(unit);\n            var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getTextureIdFromTypeMember(typeMember);\n            if (index === undefined || index >= attributeArray.length) return undefined;\n            return attributeArray[index] ? attributeArray[index]._globalDefault : undefined;\n        },\n\n        getOrCreateTextureAttributeArray: function(unit) {\n            __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].arrayDense(unit, this._textureAttributeArrayList);\n\n            if (!this._textureAttributeArrayList[unit]) this._textureAttributeArrayList[unit] = [];\n            return this._textureAttributeArrayList[unit];\n        },\n\n        pushAttributeMap: function(_attributeArray, stateSetAttributeArray, validAttributeArray) {\n            /*jshint bitwise: false */\n            var attributeStack;\n            var stateSetAttributeArrayLength = stateSetAttributeArray.length;\n            var _attributeArrayLength = _attributeArray.length;\n            for (var i = 0, l = validAttributeArray.length; i < l; i++) {\n                var index = validAttributeArray[i];\n                var attributePair =\n                    index < stateSetAttributeArrayLength\n                        ? stateSetAttributeArray[index]\n                        : undefined;\n                var attribute = attributePair.getAttribute();\n\n                attributeStack = index < _attributeArrayLength ? _attributeArray[index] : undefined;\n                if (!attributeStack) {\n                    attributeStack = this._createAttributeStack(\n                        _attributeArray,\n                        index,\n                        attribute.cloneType()\n                    );\n                }\n\n                this.pushCheckOverride(attributeStack, attribute, attributePair.getValue());\n                attributeStack._changed = true;\n            }\n        },\n\n        popAttributeMap: function(_attributeArray, stateSetAttributeArray, activeAttribute) {\n            for (var i = 0, l = activeAttribute.length; i < l; i++) {\n                var index = activeAttribute[i];\n                var attributeStack = _attributeArray[index];\n\n                attributeStack.pop();\n                attributeStack._changed = true;\n            }\n        },\n\n        setIndexArray: function(array) {\n            var gl = this._graphicContext;\n\n            if (this._currentIndexVBO !== array) {\n                array.bind(gl);\n                this._currentIndexVBO = array;\n            }\n\n            if (array.isDirty()) {\n                array.compile(gl);\n            }\n        },\n\n        lazyDisablingOfVertexAttributes: function() {\n            var keys = this._vertexAttribMap._keys;\n            for (var i = 0, l = keys.length; i < l; i++) {\n                var attr = keys[i];\n                if (this._vertexAttribMap[attr]) {\n                    this._vertexAttribMap._disable[attr] = true;\n                }\n            }\n        },\n\n        enableVertexColor: function() {\n            var program = this._programAttribute._lastApplied;\n\n            if (\n                !program.getUniformsCache().uArrayColorEnabled ||\n                !program.getAttributesCache().Color\n            )\n                return; // no color uniform or attribute used, exit\n\n            // update uniform\n            var uniform = this._uniforms.ArrayColorEnabled._globalDefault;\n\n            var previousColorEnabled = this._previousColorAttribPair[program.getInstanceID()];\n\n            if (!previousColorEnabled) {\n                uniform.setFloat(1.0);\n                uniform.apply(\n                    this.getGraphicContext(),\n                    program.getUniformsCache().uArrayColorEnabled\n                );\n                this._previousColorAttribPair[program.getInstanceID()] = true;\n            }\n        },\n\n        disableVertexColor: function() {\n            var program = this._programAttribute._lastApplied;\n\n            if (\n                !program.getUniformsCache().uArrayColorEnabled ||\n                !program.getAttributesCache().Color\n            )\n                return; // no color uniform or attribute used, exit\n\n            // update uniform\n            var uniform = this._uniforms.ArrayColorEnabled._globalDefault;\n\n            var previousColorEnabled = this._previousColorAttribPair[program.getInstanceID()];\n\n            if (previousColorEnabled) {\n                uniform.setFloat(0.0);\n                uniform.apply(\n                    this.getGraphicContext(),\n                    program.getUniformsCache().uArrayColorEnabled\n                );\n                this._previousColorAttribPair[program.getInstanceID()] = false;\n            }\n        },\n\n        applyDisablingOfVertexAttributes: function() {\n            var keys = this._vertexAttribMap._keys;\n            for (var i = 0, l = keys.length; i < l; i++) {\n                if (this._vertexAttribMap._disable[keys[i]] === true) {\n                    var attr = keys[i];\n                    this._graphicContext.disableVertexAttribArray(attr);\n                    this._vertexAttribMap._disable[attr] = false;\n                    this._vertexAttribMap[attr] = false;\n                }\n            }\n        },\n\n        clearVertexAttribCache: function() {\n            var vertexAttribMap = this._vertexAttribMap;\n            var keys = vertexAttribMap._keys;\n            for (var i = 0, l = keys.length; i < l; i++) {\n                var attr = keys[i];\n                vertexAttribMap[attr] = undefined;\n                vertexAttribMap._disable[attr] = false;\n            }\n\n            this._vertexAttribMap._disable.length = 0;\n            this._vertexAttribMap._keys.length = 0;\n        },\n\n        /**\n         *  set a vertex array object.\n         *  return true if binded the vao and false\n         *  if was already binded\n         */\n        setVertexArrayObject: function(vao) {\n            if (this._currentVAO === vao) return false;\n\n            this._currentVAO = vao;\n\n            if (vao) {\n                vao.bind(this._graphicContext);\n            } else {\n                // disable cache to force a re enable of array\n                this._graphicContext.bindVertexArray(null);\n                this.clearVertexAttribCache();\n            }\n\n            // disable currentIndexVBO to force to bind indexArray from Geometry\n            // if there is a change of vao\n            this._currentIndexVBO = undefined;\n\n            return true;\n        },\n\n        // $$ SOURCE_CODE_MODIFIED\n        setVertexAttribArray: function(attrib, array, normalize, divisor) {\n            var vertexAttribMap = this._vertexAttribMap;\n            vertexAttribMap._disable[attrib] = false;\n            var gl = this._graphicContext;\n            var binded = false;\n\n            if (array.isDirty()) {\n                array.bind(gl);\n                array.compile(gl);\n                binded = true;\n            }\n\n            var currentArray = vertexAttribMap[attrib];\n            if (currentArray !== array) {\n                if (!binded) {\n                    array.bind(gl);\n                }\n\n                if (!currentArray) {\n                    gl.enableVertexAttribArray(attrib);\n\n                    // can be === false (so undefined check is important)\n                    if (currentArray === undefined) vertexAttribMap._keys.push(attrib);\n                }\n\n                vertexAttribMap[attrib] = array;\n                gl.vertexAttribPointer(\n                    attrib,\n                    array.getItemSize(),\n                    array.getType(),\n                    normalize,\n                    0,\n                    0\n                );\n                // $$ SOURCE_CODE_MODIFIED\n                if ( undefined !== divisor && 0 !== divisor) {\n                    if( gl.vertexAttribDivisor ) {\n                        gl.vertexAttribDivisor( attrib, divisor );\n                        return;\n                    }\n                    var ext = __WEBPACK_IMPORTED_MODULE_9_osg_WebGLCaps__["a" /* default */].instance( gl ).getWebGLExtension( \'ANGLE_instanced_arrays\' );\n                    if ( !ext ) {\n                        __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].error( \'browser does not support instanced arrays\' );\n                        return;\n                    }\n                    ext.vertexAttribDivisorANGLE( attrib, divisor );\n                }\n                // $$ SOURCE_CODE_MODIFIED\n            }\n        },\n        // $$ SOURCE_CODE_MODIFIED\n\n        _getActiveUniformsFromProgramAttributes: function(program, activeUniformsList) {\n            var _attributeArrayStack = this._attributeArray;\n\n            var attributeKeys = program.getTrackAttributes().attributeKeys;\n\n            if (attributeKeys.length > 0) {\n                for (var i = 0, l = attributeKeys.length; i < l; i++) {\n                    var key = attributeKeys[i];\n\n                    // $$ SOURCE_CODE_MODIFIED\n                    var index = __WEBPACK_IMPORTED_MODULE_8_osg_utils__["a" /* default */].getOrCreateStateAttributeTypeMemberIndex(key);\n                    // var index = this.typeMember[key];\n                    // $$ SOURCE_CODE_MODIFIED\n\n                    var attributeStack = _attributeArrayStack[index];\n                    if (!attributeStack) {\n                        continue;\n                    }\n\n                    // we just need the uniform list and not the attribute itself\n                    var attribute = attributeStack._globalDefault;\n                    if (!attribute.getOrCreateUniforms) {\n                        continue;\n                    }\n\n                    var uniformMap = attribute.getOrCreateUniforms();\n                    for (var keyUniform in uniformMap) {\n                        activeUniformsList.push(uniformMap[keyUniform]);\n                    }\n                }\n            }\n        },\n\n        _getActiveUniformsFromProgramTextureAttributes: function(program, activeUniformsList) {\n            var textureAttributeKeysList = program.getTrackAttributes().textureAttributeKeys;\n            if (!textureAttributeKeysList) return;\n\n            for (var unit = 0, nbUnit = textureAttributeKeysList.length; unit < nbUnit; unit++) {\n                var textureAttributeKeys = textureAttributeKeysList[unit];\n                if (!textureAttributeKeys) continue;\n\n                var unitTextureAttributeList = this._textureAttributeArrayList[unit];\n                if (!unitTextureAttributeList) continue;\n\n                for (var i = 0, l = textureAttributeKeys.length; i < l; i++) {\n                    var key = textureAttributeKeys[i];\n\n                    var attributeStack = unitTextureAttributeList[key];\n                    if (!attributeStack) {\n                        continue;\n                    }\n                    // we just need the uniform list and not the attribute itself\n                    var attribute = attributeStack._globalDefault;\n                    if (!attribute.getOrCreateUniforms) {\n                        continue;\n                    }\n                    var uniformMap = attribute.getOrCreateUniforms();\n                    for (var keyUniform in uniformMap) {\n                        activeUniformsList.push(uniformMap[keyUniform]);\n                    }\n                }\n            }\n        },\n\n        _cacheUniformsForCustomProgram: function(program, activeUniformsList) {\n            this._getActiveUniformsFromProgramAttributes(program, activeUniformsList);\n\n            this._getActiveUniformsFromProgramTextureAttributes(program, activeUniformsList);\n\n            var gl = this._graphicContext;\n\n            // now we have a list on uniforms we want to track but we will filter them to use only what is needed by our program\n            // not that if you create a uniforms whith the same name of a tracked attribute, and it will override it\n            var uniformsFinal = {};\n\n            for (var i = 0, l = activeUniformsList.length; i < l; i++) {\n                var u = activeUniformsList[i];\n                var uniformName = u.getName();\n                var loc = gl.getUniformLocation(program._program, uniformName);\n                if (loc !== undefined && loc !== null) {\n                    uniformsFinal[uniformName] = u;\n                }\n            }\n            program.trackUniforms = uniformsFinal;\n        },\n\n        _applyCustomProgramUniforms: (function() {\n            var activeUniformsList = [];\n\n            return function(program, stateset) {\n                // custom program so we will iterate on uniform from the program and apply them\n                // but in order to be able to use Attribute in the state graph we will check if\n                // our program want them. It must be defined by the user\n\n                // first time we see attributes key, so we will keep a list of uniforms from attributes\n                activeUniformsList.length = 0;\n\n                // fill the program with cached active uniforms map from attributes and texture attributes\n                if (\n                    program.getTrackAttributes() !== undefined &&\n                    program.trackUniforms === undefined\n                ) {\n                    this._cacheUniformsForCustomProgram(program, activeUniformsList);\n                }\n\n                var programUniformMap = program.getUniformsCache();\n                var uniformMapStack = this._uniforms;\n\n                var programTrackUniformMap;\n                if (program.trackUniforms) programTrackUniformMap = program.trackUniforms;\n\n                var uniform;\n                for (var uniformName in programUniformMap) {\n                    var location = programUniformMap[uniformName];\n                    var uniformStack = uniformMapStack[uniformName];\n\n                    var hasStateSetUniformPair = stateset && stateset.uniforms[uniformName];\n\n                    if (!uniformStack && !hasStateSetUniformPair) {\n                        if (programTrackUniformMap === undefined) {\n                            this._checkErrorUniform(uniformName);\n                            continue;\n                        }\n\n                        uniform = programTrackUniformMap[uniformName];\n                        // $$ SOURCE_CODE_MODIFIED\n                        // 源码只要 programTrackUniformMap 可以得到值，\n                        // 就认为是 用户指定需要继承 的属性\n                        // 但 uModelViewMatrix uProjectionMatrix 等 也会走该分支\n                        if(undefined===uniform) {\n                            continue;\n                        }\n                        // $$ SOURCE_CODE_MODIFIED\n                    } else if (hasStateSetUniformPair) {\n                        var stateSetUniformPair = stateset.uniforms[uniformName];\n                        var maskValue = stateSetUniformPair.getValue();\n                        var stateSetUniform = stateSetUniformPair.getUniform();\n                        if (uniformStack)\n                            uniform = this._evaluateOverrideObjectOnStack(\n                                uniformStack,\n                                stateSetUniform,\n                                maskValue\n                            );\n                        else uniform = stateSetUniform;\n                    } else if (uniformStack._length) {\n                        uniform = uniformStack._back.object;\n                    } else {\n                        uniform = uniformStack._globalDefault;\n                    }\n\n                    uniform.apply(this._graphicContext, location);\n                }\n            };\n        })(),\n\n        _checkErrorUniform: function(uniformName) {\n            var unit = uniformName.substr(7);\n            if (this._textureAttributeArrayList[unit] && uniformName === \'Texture\' + unit) {\n                return;\n            }\n\n            if (this._excludeUniforms[uniformName]) {\n                return;\n            }\n\n            this._excludeUniforms[uniformName] = 1; // avoid multiple spammy errors\n\n            __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].error(\'Uniform not in the scene hierarchy : \' + uniformName);\n        },\n\n        _computeForeignUniforms: function(programUniformMap, activeUniformMap) {\n            var foreignUniforms = [];\n\n            for (var keyUniform in programUniformMap) {\n                var location = programUniformMap[keyUniform];\n\n                // filter \'standard\' uniform matrix that will be applied for all shader\n                if (location !== undefined && activeUniformMap[keyUniform] === undefined) {\n                    if (!this._excludeUniforms[keyUniform]) {\n                        foreignUniforms.push(keyUniform);\n                    }\n                }\n            }\n\n            return foreignUniforms;\n        },\n\n        _removeUniformsNotRequiredByProgram: function(activeUniformMap, programUniformMap) {\n            for (var keyUniform in activeUniformMap) {\n                var location = programUniformMap[keyUniform];\n                if (location === undefined || location === null) {\n                    delete activeUniformMap[keyUniform];\n                }\n            }\n        },\n\n        _cacheUniformsForGeneratedProgram: function(program) {\n            var shaderUniforms = program.getUniformsCache(); // declared in the shader\n            var stateSetUniforms = program.getActiveUniforms(); // present in last stateset\n\n            var foreignUniforms = this._computeForeignUniforms(shaderUniforms, stateSetUniforms);\n            program.setForeignUniforms(foreignUniforms);\n\n            // remove uniforms listed by attributes (getActiveUniforms) but not required by the program\n            this._removeUniformsNotRequiredByProgram(stateSetUniforms, shaderUniforms);\n        },\n\n        _copyUniformEntry: function(uniform) {\n            var internalArray = uniform.getInternalArray();\n            var cacheData;\n            if (internalArray.length < 16) {\n                cacheData = new internalArray.constructor(internalArray.length);\n            }\n\n            return cacheData;\n        },\n\n        _initUniformCache: function(program) {\n            var activeUniformMap = program.getActiveUniforms();\n\n            var foreignUniformKeys = program.getForeignUniforms();\n            var uniformMapStack = this._uniforms;\n\n            var cacheForeignUniforms = [];\n            var cacheActiveUniforms = [];\n\n            var i, l, cache, name, cacheData, uniform;\n\n            program._cacheUniformId = this._cacheUniformId++;\n            this._programUniformCache[program._cacheUniformId] = {};\n\n            if (foreignUniformKeys.length) {\n                cache = cacheForeignUniforms;\n                for (i = 0, l = foreignUniformKeys.length; i < l; i++) {\n                    name = foreignUniformKeys[i];\n                    var uniStack = uniformMapStack[name];\n                    if (uniStack) {\n                        uniform = uniStack._globalDefault;\n                        cacheData = this._copyUniformEntry(uniform);\n                        cache.push(cacheData);\n                    }\n                }\n            }\n\n            for (var keyUniform in activeUniformMap) {\n                uniform = activeUniformMap[keyUniform];\n                cacheData = this._copyUniformEntry(uniform);\n                cacheActiveUniforms.push(cacheData);\n            }\n\n            this._programUniformCache[program._cacheUniformId].foreign = cacheForeignUniforms;\n            this._programUniformCache[program._cacheUniformId].active = cacheActiveUniforms;\n        },\n\n        _checkCacheAndApplyUniform: function(\n            uniform,\n            cacheArray,\n            indexCache,\n            programUniformMap,\n            nameUniform\n        ) {\n            var isCached;\n            var internalArray = uniform.getInternalArray();\n            var uniformArrayLength = internalArray.length;\n            if (uniformArrayLength <= 4) {\n                var uniformCache = cacheArray[indexCache];\n                isCached = checkUniformCache[uniformArrayLength](internalArray, uniformCache);\n            } else {\n                isCached = false;\n            }\n\n            if (!isCached) {\n                var location = programUniformMap[nameUniform];\n                uniform.apply(this._graphicContext, location);\n            }\n        },\n\n        // note that about TextureAttribute that need uniform on unit we would need to improve\n        // the current uniformList ...\n\n        // when we apply the shader for the first time, we want to compute the active uniforms for this shader and the list of uniforms not extracted from attributes called foreignUniforms\n        _applyGeneratedProgramUniforms: function(program, stateset) {\n            var uniformMapStack = this._uniforms;\n            var uniform, uniformName, uniformStack, i;\n\n            var foreignUniformKeys = program.getForeignUniforms();\n            if (!foreignUniformKeys) {\n                this._cacheUniformsForGeneratedProgram(program);\n                foreignUniformKeys = program.getForeignUniforms();\n\n                // be sure to create a stack for foreign uniform for this program\n                // it\'s needed to do it here because of the cache of uniform\n                if (stateset) {\n                    var stateSetUniforms = stateset.uniforms;\n                    for (i = 0; i < foreignUniformKeys.length; i++) {\n                        uniformName = foreignUniformKeys[i];\n\n                        // already exist\n                        if (uniformMapStack[uniformName]) continue;\n\n                        // does not exist check to initialize with stateSet uniforms\n                        if (!stateSetUniforms[uniformName]) continue;\n\n                        uniform = stateSetUniforms[uniformName].getUniform();\n                        this._createAttributeStack(uniformMapStack, uniformName, uniform);\n                    }\n                }\n\n                this._initUniformCache(program);\n            }\n\n            var programUniformMap = program.getUniformsCache();\n            var activeUniformMap = program.getActiveUniforms();\n\n            var cacheUniformsActive = this._programUniformCache[program._cacheUniformId].active;\n            var cacheUniformsForeign = this._programUniformCache[program._cacheUniformId].foreign;\n\n            // apply active uniforms\n            // caching uniforms from attribtues make it impossible to overwrite uniform with a custom uniform instance not used in the attributes\n            var indexCache = 0;\n            for (var keyUniform in activeUniformMap) {\n                uniform = activeUniformMap[keyUniform];\n                this._checkCacheAndApplyUniform(\n                    uniform,\n                    cacheUniformsActive,\n                    indexCache,\n                    programUniformMap,\n                    keyUniform\n                );\n                indexCache++; // TODO not good, for in ordered consistency, etc...\n            }\n\n            // apply now foreign uniforms, it\'s uniforms needed by the program but not contains in attributes used to generate this program\n            indexCache = 0;\n            var nbForeigns = foreignUniformKeys.length;\n            for (i = 0; i < nbForeigns; i++) {\n                uniformName = foreignUniformKeys[i];\n\n                uniformStack = uniformMapStack[uniformName];\n                var hasStateSetUniformPair = stateset && stateset.uniforms[uniformName];\n\n                if (!hasStateSetUniformPair && !uniformStack) {\n                    this._checkErrorUniform(uniformName);\n                    continue;\n                }\n\n                if (hasStateSetUniformPair) {\n                    var stateSetUniformPair = stateset.uniforms[uniformName];\n                    var maskValue = stateSetUniformPair.getValue();\n                    var stateSetUniform = stateSetUniformPair.getUniform();\n                    uniform = this._evaluateOverrideObjectOnStack(\n                        uniformStack,\n                        stateSetUniform,\n                        maskValue\n                    );\n                } else if (uniformStack._length) {\n                    uniform = uniformStack._back.object;\n                } else {\n                    uniform = uniformStack._globalDefault;\n                    this._checkErrorUniform(uniformName);\n                }\n\n                this._checkCacheAndApplyUniform(\n                    uniform,\n                    cacheUniformsForeign,\n                    indexCache,\n                    programUniformMap,\n                    uniformName\n                );\n                indexCache++;\n            }\n        },\n\n        // Use to detect changes in RenderLeaf between call to avoid to applyStateSet\n        _setStateSetsDrawID: function(id) {\n            var values = this._stateSets.getArray();\n            for (var i = 0, nbStateSets = this._stateSets.length; i < nbStateSets; i++) {\n                values[i].setDrawID(id);\n            }\n        },\n\n        _stateSetStackChanged: function(id, nbLast) {\n            var values = this._stateSets.getArray();\n            var nbStateSets = this._stateSets.length;\n            if (nbLast !== nbStateSets) return true;\n\n            for (var i = 0; i < nbStateSets; i++) {\n                if (id !== values[i].getDrawID()) return true;\n            }\n\n            return false;\n        }\n    }),\n    \'osg\',\n    \'State\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (State);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/State.js\n// module id = 121\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/State.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n\n\n\nvar UpdateVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this);\n    this.visitorType = __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].UPDATE_VISITOR;\n    this._numUpdateCallback = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    UpdateVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        resetStats: function() {\n            this._numUpdateCallback = 0;\n        },\n\n        apply: function(node) {\n            // a way to avoid extra call is to implement getNumChildrenRequiringUpdateTraversal\n            // and stateset.requiresUpdateTraversal()\n\n            // handle callback in stateset\n            var stateSet = node.getStateSet();\n            if (stateSet && stateSet.requiresUpdateTraversal()) {\n                var updateCallbackList = stateSet.getUpdateCallbackList();\n\n                var numStateSetUpdateCallback = updateCallbackList.length;\n                if (numStateSetUpdateCallback) {\n                    this._numUpdateCallback += numStateSetUpdateCallback;\n                    for (var i = 0, l = numStateSetUpdateCallback; i < l; i++)\n                        updateCallbackList[i].update(stateSet, this);\n                }\n            }\n\n            // handle callback in nodes\n            var ncs = node.getUpdateCallbackList();\n            var numUpdateCallback = ncs.length;\n            for (var j = 0; j < numUpdateCallback; j++) {\n                this._numUpdateCallback++;\n                if (!ncs[j].update(node, this)) {\n                    return;\n                }\n            }\n\n            if (node.getNumChildrenRequiringUpdateTraversal() > 0) this.traverse(node);\n        }\n    }),\n    \'osg\',\n    \'NodeVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (UpdateVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/UpdateVisitor.js\n// module id = 122\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/UpdateVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__ = __webpack_require__(18);\n\n\n\n/*\nuse EXT_disjoint_timer_queryto time webgl calls GPU side average over multiple frames\n\nIf timestamp feature is not supported, we virtualize the query by splitting and adding\ndummy queries, that way it should handle both nested and interleaved queries.\n\nAlso, if you time the same queryID multiple time in the same frame, it will sum the different\nqueries, that way you can track a particular of gl command for examples\n\n*/\n\nvar TimerGPU = function(gl) {\n    this._enabled = false;\n    this.reset(gl);\n};\n\nTimerGPU.FRAME_COUNT = 0;\n\nTimerGPU.instance = function(gl, force) {\n    if (!TimerGPU._instance) {\n        TimerGPU._instance = new TimerGPU(gl);\n    } else if (gl && (TimerGPU._instance.getContext() !== gl || force)) {\n        TimerGPU._instance.setContext(gl);\n        TimerGPU._instance.reset(gl);\n    }\n    return TimerGPU._instance;\n};\n\nTimerGPU.prototype = {\n    reset: function(gl) {\n        if (gl) {\n            var ext = __WEBPACK_IMPORTED_MODULE_1_osg_WebGLCaps__["a" /* default */].instance(gl).getDisjointTimerQuery();\n            if (!ext) return this;\n\n            // webgl1 to webgl2\n            if (!gl.getQueryParameter) gl.getQueryParameter = ext.getQueryObjectEXT.bind(ext);\n\n            // https://github.com/KhronosGroup/WebGL/blob/master/sdk/tests/conformance/extensions/ext-disjoint-timer-query.html#L102\n            // run the page if strange results\n            // to validate you gpu/browser has correct gpu queries support\n            this._hasTimeElapsed =\n                gl.getQuery(ext.TIME_ELAPSED_EXT, ext.QUERY_COUNTER_BITS_EXT) >= 30;\n            this._hasTimeStamp = gl.getQuery(ext.TIMESTAMP_EXT, ext.QUERY_COUNTER_BITS_EXT) >= 30;\n\n            if (!this._hasTimeElapsed && !this._hasTimeStamp) {\n                return this;\n            }\n\n            // no timestamp means not start/end absolute time\n            // which means each start must be followed by a end\n            // BEFORE any other start (of other queryID)\n            if (!this._hasTimeStamp) __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].debug(\'Warning: do not use interleaved GPU query\');\n\n            this._ext = ext;\n            this._gl = gl;\n            this._enabled = true;\n        }\n\n        this._frameAverageCount = 10;\n\n        this._glQueries = [];\n        this._queriesByID = {};\n        this._userQueries = []; // for timestamp, it\'s the same as _glQueries\n\n        // stuffs used to virtualize query (no timestamp)\n        this._queryCount = 0;\n        this._nbOpened = 0;\n    },\n    getContext: function() {\n        return this._gl;\n    },\n    setContext: function(gl) {\n        this._gl = gl;\n    },\n    setFrameAverageCount: function(val) {\n        this._frameAverageCount = val;\n    },\n\n    clearQueries: function() {\n        var glQueries = this._glQueries;\n        for (var i = 0, nbQueries = glQueries.length; i < nbQueries; ++i) {\n            var query = glQueries[i];\n            this._gl.deleteQuery(query._pollingStartQuery);\n            if (query._pollingEndQuery) this._gl.deleteQuery(query);\n        }\n\n        this._userQueries.length = 0;\n        this._glQueries.length = 0;\n        this._queriesByID = {};\n    },\n\n    supportTimeStamp: function() {\n        return this._hasTimeStamp;\n    },\n\n    // many browser doesn\'t yet have\n    // the marvellous gpu timers\n    enable: function() {\n        // enable only if we have the extension\n        this._enabled = !!this._ext;\n    },\n\n    disable: function() {\n        this._enabled = false;\n    },\n    isEnabled: function() {\n        return this._enabled;\n    },\n\n    setCallback: function(cb) {\n        this._callback = cb;\n    },\n\n    createUserQuery: function(queryID) {\n        var query;\n        if (this._hasTimeStamp) {\n            query = this.createGLQuery();\n        } else {\n            query = {\n                _startIndex: 0,\n                _endIndex: 0\n            };\n        }\n\n        query._id = queryID;\n        query._frame = TimerGPU.FRAME_COUNT;\n        query._isOpened = true;\n        query._siblings = []; // if the query is called multiple time in the same frame\n\n        return query;\n    },\n\n    createGLQuery: function() {\n        var query = {};\n        query._isWaiting = false; // wait typically 1 or 2 frames\n        query._pollingStartQuery = undefined; // gl query object\n        query._pollingEndQuery = undefined; // gl query object (timestamp only)\n        query._averageTimer = 0.0; // cumulative average time\n        query._resultCount = 0; // cumulative average count\n\n        if (this._hasTimeStamp) query._pollingEndQuery = this._gl.createQuery();\n        query._pollingStartQuery = this._gl.createQuery();\n\n        this._glQueries.push(query);\n\n        return query;\n    },\n\n    getOrCreateLastGLQuery: function() {\n        var query = this._glQueries[this._queryCount - 1];\n        if (query) return query;\n\n        query = this._glQueries[this._queryCount - 1] = this.createGLQuery();\n\n        return query;\n    },\n\n    beginCurrentQuery: function() {\n        if (this._nbOpened === 0) return;\n\n        this._queryCount++;\n\n        var query = this.getOrCreateLastGLQuery();\n        if (!query._isWaiting) {\n            this._gl.beginQuery(this._ext.TIME_ELAPSED_EXT, query._pollingStartQuery);\n        }\n    },\n\n    endCurrentQuery: function() {\n        if (this._nbOpened === 0) return;\n\n        if (!this.getOrCreateLastGLQuery()._isWaiting) {\n            this._gl.endQuery(this._ext.TIME_ELAPSED_EXT);\n        }\n    },\n\n    getAvailableQueryByID: function(queryID) {\n        var query = this._queriesByID[queryID];\n        if (!query) {\n            query = this._queriesByID[queryID] = this.createUserQuery(queryID);\n            this._userQueries.push(query);\n            return query;\n        }\n\n        if (query._frame === TimerGPU.FRAME_COUNT) {\n            if (query._isOpened) return query;\n\n            var siblings = query._siblings;\n            for (var i = 0, nbSiblings = siblings.length; i < nbSiblings; ++i) {\n                var qsib = siblings[i];\n                if (qsib._frame !== TimerGPU.FRAME_COUNT || qsib._isOpened) {\n                    qsib._frame = TimerGPU.FRAME_COUNT;\n                    return qsib;\n                }\n            }\n\n            var newQuery = this.createUserQuery();\n            siblings.push(newQuery);\n            return newQuery;\n        }\n\n        query._frame = TimerGPU.FRAME_COUNT;\n\n        return query;\n    },\n\n    // start recording time if query already exist, don\'t recreate\n    start: function(queryID) {\n        // If timing currently disabled or glTimer does not exist, exit early.\n        if (!this._enabled) {\n            return undefined;\n        }\n\n        var query = this.getAvailableQueryByID(queryID);\n        query._isOpened = true;\n\n        if (this._hasTimeStamp) {\n            if (!query._isWaiting)\n                this._ext.queryCounterEXT(query._pollingStartQuery, this._ext.TIMESTAMP_EXT);\n        } else {\n            this.endCurrentQuery();\n\n            this._nbOpened++;\n            query._startIndex = this._queryCount;\n\n            this.beginCurrentQuery();\n        }\n    },\n\n    // stop query recording (if running) polls for results\n    end: function(queryID) {\n        if (!this._enabled) {\n            return;\n        }\n\n        var query = this.getAvailableQueryByID(queryID);\n        query._isOpened = false;\n\n        if (this._hasTimeStamp) {\n            if (!query._isWaiting)\n                this._ext.queryCounterEXT(query._pollingEndQuery, this._ext.TIMESTAMP_EXT);\n        } else {\n            this.endCurrentQuery();\n\n            query._endIndex = this._queryCount;\n            this._nbOpened--;\n\n            this.beginCurrentQuery();\n        }\n    },\n\n    computeQueryAverageTime: function(query) {\n        var average = 0;\n        var glQueries = this._glQueries;\n\n        for (var i = query._startIndex; i < query._endIndex; ++i) {\n            var glAvg = glQueries[i]._averageTimer;\n            if (glAvg < 0) return -1;\n            average += glAvg;\n        }\n\n        return average;\n    },\n\n    computeFullAverageTime: function(query) {\n        var average = this.computeQueryAverageTime(query);\n\n        if (average < 0) return -1;\n\n        var siblings = query._siblings;\n        for (var i = 0, nbSiblings = siblings.length; i < nbSiblings; ++i) {\n            var qsib = siblings[i];\n            if (qsib._frame !== TimerGPU.FRAME_COUNT - 1) continue;\n\n            var sibAvg = this.computeQueryAverageTime(qsib);\n            if (sibAvg < 0) return -1;\n            average += sibAvg;\n        }\n\n        return average;\n    },\n\n    pollQueries: function() {\n        TimerGPU.FRAME_COUNT++;\n        this._queryCount = 0;\n        this._nbOpened = 0;\n\n        if (!this._enabled || !this._callback) {\n            return;\n        }\n\n        var glQueries = this._glQueries;\n        var nbGlQueries = glQueries.length;\n        var i;\n\n        // all timer are corrupted, clear the queries\n        var disjoint = this._gl.getParameter(this._ext.GPU_DISJOINT_EXT);\n        if (disjoint) {\n            for (i = 0; i < nbGlQueries; ++i) {\n                glQueries[i]._isWaiting = false;\n            }\n            return;\n        }\n\n        // update average time for each queries\n        for (i = 0; i < nbGlQueries; ++i) {\n            this.pollQuery(glQueries[i]);\n        }\n\n        var userQueries = this._userQueries;\n        var nbUserQueries = userQueries.length;\n\n        for (i = 0; i < nbUserQueries; ++i) {\n            var query = userQueries[i];\n            var average = this.computeFullAverageTime(query);\n            if (average > 0) {\n                this._callback(average, query._id);\n            }\n        }\n    },\n\n    pollQuery: function(query) {\n        query._isWaiting = false;\n\n        // last to be queried\n        var lastQuery = this._hasTimeStamp ? query._pollingEndQuery : query._pollingStartQuery;\n\n        // wait till results are ready\n        var available = this._gl.getQueryParameter(lastQuery, this._gl.QUERY_RESULT_AVAILABLE);\n        if (!available) {\n            query._isWaiting = true;\n            return 0;\n        }\n\n        var timeElapsed;\n\n        if (this._hasTimeStamp) {\n            var startTime = this._gl.getQueryParameter(\n                query._pollingStartQuery,\n                this._gl.QUERY_RESULT\n            );\n            var endTime = this._gl.getQueryParameter(lastQuery, this._gl.QUERY_RESULT);\n            timeElapsed = endTime - startTime;\n        } else {\n            timeElapsed = this._gl.getQueryParameter(lastQuery, this._gl.QUERY_RESULT);\n        }\n\n        query._resultCount++;\n\n        // restart cumulative average every frameAveragecount frames\n        if (query._resultCount > this._frameAverageCount) {\n            query._averageTimer = 0.0;\n            query._resultCount = 1;\n        }\n\n        // https://en.wikipedia.org/wiki/Moving_average#Cumulative_moving_average\n        query._averageTimer =\n            query._averageTimer + (timeElapsed - query._averageTimer) / query._resultCount;\n\n        return query._averageTimer;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (TimerGPU);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/TimerGPU.js\n// module id = 123\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/TimerGPU.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// must be sync wiht Interpolator Type\n/* harmony default export */ __webpack_exports__["a"] = ({\n    Vec3: 0,\n    Quat: 1,\n    Float: 2,\n    FloatCubicBezier: 3,\n    Vec3CubicBezier: 4,\n    QuatSlerp: 5,\n    Matrix: 6,\n    Count: 7\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/channelType.js\n// module id = 124\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/channelType.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_animation__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgAnimation_interpolator__ = __webpack_require__(126);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgAnimation_CollectAnimationUpdateCallbackVisitor__ = __webpack_require__(127);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgAnimation_target__ = __webpack_require__(37);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgAnimation_UpdateMorph__ = __webpack_require__(88);\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Float = {\n    lerp: function(a, b, t) {\n        return a + (b - a) * t;\n    },\n    init: function() {\n        return 0.0;\n    },\n    copy: function(out, src) {\n        return src;\n    },\n    create: function() {\n        return 0.0;\n    }\n};\n\nvar TypeToSize = [];\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Float] = 1;\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.FloatCubicBezier] = 1;\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Vec3] = 3;\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Vec3CubicBezier] = 3;\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Quat] = 4;\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.QuatSlerp] = 4;\nTypeToSize[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Matrix] = 16;\n\nvar ResultType = [];\nResultType.length = __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Count;\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Vec3] = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */];\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Quat] = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */];\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.QuatSlerp] = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["d" /* quat */];\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Float] = Float;\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.FloatCubicBezier] = Float;\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Vec3CubicBezier] = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["f" /* vec3 */];\nResultType[__WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Matrix] = __WEBPACK_IMPORTED_MODULE_3_osg_glMatrix__["c" /* mat4 */];\n\n/**\n *  BasicAnimationManager\n *  @class BasicAnimationManager\n */\nvar BasicAnimationManager = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].call(this);\n\n    this._simulationTime = 0.0;\n    this._pauseTime = 0.0;\n    this._timeFactor = 1.0;\n    this._startTime = 0.0;\n\n    // contains a map with instance animations\n    this._instanceAnimations = {};\n\n    // animations to start\n    this._startAnimations = {};\n\n    // target contains an array of all target for this manager\n    // index in the array is used as ID\n    // see Animation.createTarget\n    // [\n    //     { id: 0,\n    //       channels: [],\n    //       value: 0.0,\n    //       defaultValue: 0.0,\n    //       type\n    //     },\n    //     ...\n    // ];\n    this._targets = [];\n    this._targetsMap = {};\n\n    // target id with active lists\n    // [\n    //   vec3: [ targetID0, targetID1 ]\n    //   Quat: [ targetID2, targetID3,  ... ]\n    //   Float: [ ... ]\n    // ]\n    this._targetsByTypes = [];\n    this._targetsByTypes.length = __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Count;\n    for (var i = 0, ni = this._targetsByTypes.length; i < ni; i++) {\n        this._targetsByTypes[i] = [];\n    }\n\n    // current playing animations\n    this._activeAnimations = {};\n    this._activeAnimationList = [];\n\n    // current actives channels by types\n    //   [ chanel0, channel1, ... ] // vec3 type\n    //   [ chanel2, channel3, ... ] // Quat type\n    //   [ chanel5, channel6, ... ] // Float type\n    this._activeChannelsByTypes = [];\n    this._activeChannelsByTypes.length = __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Count;\n    for (var j = 0, nj = this._activeChannelsByTypes.length; j < nj; j++) {\n        this._activeChannelsByTypes[j] = [];\n    }\n\n    // assign all target/channel in animationCallback\n    // then they can read it directly\n    // animation callback to update\n    this._animationsUpdateCallback = {};\n    this._animationsUpdateCallbackArray = [];\n\n    // queue of animations to register\n    this._animationsToRegister = [];\n\n    //Pause status (true / false)\n    this._pause = false;\n\n    this._dirty = false;\n\n    this._seekTime = -1;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    BasicAnimationManager,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].prototype, {\n        init: function(animations) {\n            // reset all\n            this._simulationTime = 0.0;\n            this._pauseTime = 0.0;\n            this._timeFactor = 1.0;\n            this._startTime = 0.0;\n\n            // contains a map with instance animations\n            this._instanceAnimations = {};\n\n            // animations to start\n            this._startAnimations = {};\n\n            this._resetTargets();\n\n            this._activeAnimations = {};\n            this._activeAnimationList.length = 0;\n\n            for (var i = 0, ni = this._activeChannelsByTypes.length; i < ni; i++)\n                this._activeChannelsByTypes[i].length = 0;\n\n            this._animationsUpdateCallback = {};\n            this._animationsUpdateCallbackArray.length = 0;\n\n            this._pause = false;\n            this._seekTime = -1;\n\n            // add animations\n            this.addAnimations(animations);\n        },\n\n        // push all animations into the queue\n        addAnimations: function(animations) {\n            var instanceAnimationList = this._addAnimation(animations);\n\n            // qeue them to assign target\n            Array.prototype.push.apply(this._animationsToRegister, instanceAnimationList);\n            this._dirty = true;\n            this._registerAnimations();\n        },\n\n        update: function(node, nv) {\n            if (this._dirty) {\n                this._findAnimationUpdateCallback(node);\n                this._registerTargetFoundInAnimationCallback();\n                this._registerAnimations();\n            }\n\n            var t = nv.getFrameStamp().getSimulationTime();\n\n            if (this._seekTime !== -1) this._pauseTime = -this._seekTime + this._startTime + t;\n            this._seekTime = -1;\n\n            if (!this._pause) {\n                // Not in pause\n                this._simulationTime = this._startTime + (t - this._pauseTime);\n            } else {\n                this._pauseTime = t - this._simulationTime + this._startTime;\n            }\n\n            this.updateManager(this._simulationTime * this._timeFactor);\n            return true;\n        },\n\n        updateManager: function(t) {\n            // adds active animations / channels requested\n            //\n            this._processStartAnimation(t);\n\n            var l = __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__["a" /* default */].ChannelType.Count;\n            // update all actives channels by type\n            //\n            for (var i = 0; i < l; i++) {\n                var activeChannelType = this._activeChannelsByTypes[i];\n                this._updateChannelsType(t, activeChannelType, __WEBPACK_IMPORTED_MODULE_6_osgAnimation_interpolator__["a" /* default */][i]);\n            }\n\n            // update targets\n            //\n            for (var j = 0; j < l; j++) {\n                var targetType = this._targetsByTypes[j];\n                this._updateTargetType(targetType, ResultType[j]);\n            }\n\n            // update all animation callback\n            // expect to have UpdateMatrixTransform\n            for (var k = 0, nk = this._animationsUpdateCallbackArray.length; k < nk; k++) {\n                var animCallback = this._animationsUpdateCallbackArray[k];\n                animCallback.computeChannels();\n            }\n\n            // check animation finished\n            this._removeFinishedAnimation(t);\n        },\n\n        togglePause: function() {\n            //Pause the manager\'s time\n            this._pause = !this._pause;\n            // if we resume an animation we don\'t want to move forward the animation\n            if (!this._pause) this._seekTime = this._simulationTime;\n        },\n\n        getSimulationTime: function() {\n            return this._simulationTime;\n        },\n\n        setSimulationTime: function(t) {\n            this._simulationTime = t;\n        },\n\n        setSeekTime: function(t) {\n            this._simulationTime = t;\n            this._seekTime = t;\n        },\n\n        stopAnimation: function(name) {\n            var activeAnimationList = this._activeAnimationList;\n            for (var i = 0, nbAnim = activeAnimationList.length; i < nbAnim; ++i) {\n                if (activeAnimationList[i].name === name) {\n                    this._removeActiveChannels(this._instanceAnimations[name]);\n                    this._activeAnimations[name] = undefined;\n                    activeAnimationList.splice(i, 1);\n                    return;\n                }\n            }\n        },\n\n        stopAllAnimation: function() {\n            var activeAnimationList = this._activeAnimationList;\n            for (var i = 0, nbAnim = activeAnimationList.length; i < nbAnim; ++i) {\n                var name = activeAnimationList[i].name;\n                this._removeActiveChannels(this._instanceAnimations[name]);\n                this._activeAnimations[name] = undefined;\n            }\n            activeAnimationList.length = 0;\n        },\n\n        setTimeFactor: function(timeFactor) {\n            var tf = timeFactor / this._timeFactor;\n            this._startTime += (this._simulationTime - this._simulationTime * tf) / tf;\n\n            this._timeFactor = timeFactor;\n\n            if (this._pause)\n                this._simulationTime += (this._simulationTime - this._simulationTime * tf) / tf;\n        },\n\n        getTimeFactor: function() {\n            return this._timeFactor;\n        },\n\n        isPlaying: function(name) {\n            if (this._activeAnimations[name]) return true;\n            return false;\n        },\n\n        // play animation using object as config\n        // {\n        //     name: string,\n        //     priority: 0,\n        //     weight: 1.0,\n        //     loop: true / false\n        // }\n        playAnimationObject: function(obj) {\n            var anim = this._instanceAnimations[obj.name];\n            if (!anim) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].info(\'no animation \' + obj.name + \' found\');\n                return;\n            }\n\n            if (this.isPlaying(obj.name)) return;\n\n            anim.priority = obj.priority === undefined ? 0 : obj.priority;\n            anim.weight = obj.weight === undefined ? 1.0 : obj.weight;\n            anim.loop = obj.loop === undefined ? true : obj.loop;\n\n            this._startAnimations[anim.name] = anim;\n        },\n\n        // if first argument is an object\n        // playAnimationObject is called instead\n        playAnimation: function(name, loop, priority, weight) {\n            var animationObject;\n            if (typeof name === \'object\') animationObject = name;\n            else {\n                animationObject = {\n                    name: name,\n                    priority: priority,\n                    weight: weight,\n                    loop: loop\n                };\n            }\n\n            return this.playAnimationObject(animationObject);\n        },\n\n        getAnimations: function() {\n            return this._instanceAnimations;\n        },\n\n        _registerAnimations: function() {\n            if (!this._targets.length) return;\n\n            for (var i = 0, ni = this._animationsToRegister.length; i < ni; i++) {\n                var instanceAnimation = this._animationsToRegister[i];\n                this._registerInstanceAnimation(instanceAnimation);\n            }\n\n            this._animationsToRegister.length = 0;\n            this._dirty = false;\n        },\n\n        // Register animation\n        //\n        // Register animation list all target from channel in the animations and associate\n        // target found in the scenegraph. If no target are registered animation cant be\n        // registered. In this case animation will be pending and resolved after a visitor\n        // extract target.\n        _registerInstanceAnimation: function(instanceAnimation) {\n            var instanceChannels = instanceAnimation.channels;\n            for (var i = 0, ni = instanceChannels.length; i < ni; i++) {\n                var instanceChannel = instanceChannels[i];\n                var targetName = instanceChannel.channel.target;\n                var name = instanceChannel.channel.name;\n                var uniqueTargetName = targetName + \'.\' + name;\n\n                // disply a warning if animation has a channel but not target found in the\n                // scene graph. We could probably optimize and removes those channels, but\n                // it must be a user decision in case the user plugin different scene\n                // graph together and target would appear later in the scenegraph\n                if (!this._targetMap[uniqueTargetName]) {\n                    __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\n                        \'registerInstanceAnimation did not find targetName (\' +\n                            uniqueTargetName +\n                            \') in the scene graph\'\n                    );\n                    continue;\n                }\n\n                instanceChannel.targetID = this._targetMap[uniqueTargetName].id;\n            }\n            return true;\n        },\n\n        _findAnimationUpdateCallback: function(node) {\n            var collector = new __WEBPACK_IMPORTED_MODULE_7_osgAnimation_CollectAnimationUpdateCallbackVisitor__["a" /* default */]();\n            node.accept(collector);\n            this._animationsUpdateCallback = collector.getAnimationUpdateCallbackMap();\n        },\n\n        // assignTargetToAnimationCallback\n        //\n        // check all animationUpdateCallback collected and try to\n        // assign the channel instance registered in the manager. If a\n        // animationUpdateCallback contains channels not known by the\n        // manager we skip it.  It means that it should be called\n        // after the animations has been registered into the animation\n        // manager\n        _registerTargetFoundInAnimationCallback: function() {\n            this._resetTargets();\n\n            var targetID = 0;\n            var targetMap = this._targetMap;\n            var targets = this._targets;\n\n            var registerTarget = function(uniqueTargetName, target, name) {\n                if (!targetMap[uniqueTargetName]) {\n                    targetMap[uniqueTargetName] = target;\n                    // assign an id that will be an index into a array\n                    target.id = targetID++;\n                    targets.push(target);\n\n                    var type = target.type; // split by type\n                    this._targetsByTypes[type].push(target);\n                } else {\n                    // detect differents target instance with same\n                    // unique target name. It\'s a problem\n                    if (target !== targetMap[uniqueTargetName])\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\n                            \'detected differents target instance with the same name (\' + name + \')\'\n                        );\n                }\n            }.bind(this);\n\n            var target;\n            var name;\n            var uniqueTargetName;\n\n            for (var keyAnimation in this._animationsUpdateCallback) {\n                var animationCallback = this._animationsUpdateCallback[keyAnimation];\n\n                // handle UpdateBone and UpdateMatrixTransform but not stateSet\n                if (\n                    animationCallback.getStackedTransforms &&\n                    animationCallback.getStackedTransforms().length\n                ) {\n                    this._animationsUpdateCallbackArray.push(animationCallback);\n\n                    var stackedTransforms = animationCallback.getStackedTransforms();\n                    for (var j = 0, nj = stackedTransforms.length; j < nj; j++) {\n                        var stackedTransform = stackedTransforms[j];\n                        target = stackedTransform.getTarget();\n                        name = stackedTransform.getName();\n                        uniqueTargetName = animationCallback.getName() + \'.\' + name;\n\n                        registerTarget(uniqueTargetName, target, name);\n                    }\n                } else if (animationCallback instanceof __WEBPACK_IMPORTED_MODULE_9_osgAnimation_UpdateMorph__["a" /* default */]) {\n                    for (\n                        var t = 0, numTarget = animationCallback.getNumTarget();\n                        t < numTarget;\n                        t++\n                    ) {\n                        name = animationCallback.getTargetName(t);\n                        uniqueTargetName = name + \'.\' + t;\n                        target = animationCallback.getTarget(t);\n\n                        registerTarget(uniqueTargetName, target, name);\n                    }\n                }\n            }\n        },\n\n        _addAnimation: function(animations) {\n            var instanceAnimationList = [];\n            for (var i = 0, ni = animations.length; i < ni; i++) {\n                var animation = animations[i];\n                var animationName = animation.name;\n\n                if (this._instanceAnimations[animationName]) continue;\n\n                var instanceAnimation = __WEBPACK_IMPORTED_MODULE_5_osgAnimation_animation__["a" /* default */].createInstanceAnimation(animation);\n                this._instanceAnimations[animationName] = instanceAnimation;\n                instanceAnimationList.push(instanceAnimation);\n            }\n\n            return instanceAnimationList;\n        },\n\n        // add channels from instance animation to the active channels list\n        _addActiveChannels: function(t, instanceAnimation) {\n            var instanceChannels = instanceAnimation.channels;\n            for (var i = 0, ni = instanceChannels.length; i < ni; i++) {\n                var instanceChannel = instanceChannels[i];\n                var type = instanceChannel.channel.type;\n                instanceChannel.t = t; // reset time\n                instanceChannel.instanceAnimation = instanceAnimation; // link with parent animation\n                var targetID = instanceChannel.targetID;\n\n                if (targetID === __WEBPACK_IMPORTED_MODULE_8_osgAnimation_target__["a" /* default */].InvalidTargetID) continue;\n\n                this._activeChannelsByTypes[type].push(instanceChannel);\n                this._targets[targetID].channels.push(instanceChannel);\n            }\n        },\n\n        _removeActiveChannels: function(instanceAnimation) {\n            var instanceChannels = instanceAnimation.channels;\n            for (var i = 0, ni = instanceChannels.length; i < ni; i++) {\n                var instanceChannel = instanceChannels[i];\n                var type = instanceChannel.channel.type;\n                var targetID = instanceChannel.targetID;\n\n                if (targetID === __WEBPACK_IMPORTED_MODULE_8_osgAnimation_target__["a" /* default */].InvalidTargetID) continue;\n\n                // remove channel instance from targetID channel list\n                var targetChannelsList = this._targets[targetID].channels;\n                var index = targetChannelsList.indexOf(instanceChannel);\n                targetChannelsList.splice(index, 1);\n\n                // remove channel from active channels\n                var channelTypeList = this._activeChannelsByTypes[type];\n                var channelIndex = channelTypeList.indexOf(instanceChannel);\n                channelTypeList.splice(channelIndex, 1);\n            }\n        },\n\n        // blend value from each channels for each target\n        // or copy default value if not updated by an active animation\n        _updateTargetType: function(targetList, operatorType) {\n            for (var i = 0, ni = targetList.length; i < ni; i++) {\n                var target = targetList[i];\n                var affectedChannels = target.channels;\n                var nbChannels = affectedChannels.length;\n                // note operatorType operations doesn\'t always operate on arrays (float)\n                // so we can\'t simply assume that target.value is an array so we need\n                // to write "target.value = ..."\n\n                if (nbChannels === 0) {\n                    // no blending ?\n                    target.value = operatorType.copy(target.value, target.defaultValue);\n                } else if (nbChannels === 1) {\n                    target.value = operatorType.copy(target.value, affectedChannels[0].value);\n                } else {\n                    // blend between multiple channels\n                    target.value = operatorType.init(target.value);\n                    var accumulatedWeight = 0.0;\n\n                    // it\'s the same as targetOut = (v0 * w0 + v1 * w1 + ...) / (w0 + w1 + ...)\n                    for (var j = 0, nj = affectedChannels.length; j < nj; j++) {\n                        var achannel = affectedChannels[j];\n                        var weight = achannel.weight;\n                        accumulatedWeight += weight;\n                        // avoid divide by zero and useless lerp\n                        if (accumulatedWeight === 0.0 || weight === 0.0) continue;\n\n                        var ratio = weight / accumulatedWeight;\n                        target.value = operatorType.lerp(\n                            target.value,\n                            target.value,\n                            achannel.value,\n                            ratio\n                        );\n                    }\n                }\n            }\n        },\n\n        _updateChannelsType: function(t, channels, interpolator) {\n            for (var i = 0, ni = channels.length; i < ni; i++) {\n                var channel = channels[i];\n                var instanceAnimation = channel.instanceAnimation;\n                var loop = instanceAnimation.loop;\n\n                var tLocal = t - channel.t;\n\n                // handle loop, careful in case animation is one frame\n                if (loop && instanceAnimation.duration > 0.0) {\n                    tLocal = tLocal % instanceAnimation.duration;\n                }\n\n                interpolator(tLocal + instanceAnimation.firstKeyTime, channel);\n            }\n        },\n\n        _removeFinishedAnimation: function(t) {\n            var activeAnimationList = this._activeAnimationList;\n\n            var i = 0;\n            while (i < activeAnimationList.length) {\n                var instanceAnimation = activeAnimationList[i];\n                var name = instanceAnimation.name;\n\n                if (t > instanceAnimation.end && instanceAnimation.loop === false) {\n                    this._removeActiveChannels(instanceAnimation);\n                    this._activeAnimations[name] = undefined;\n                    activeAnimationList.splice(i, 1);\n                } else {\n                    i++;\n                }\n            }\n        },\n\n        _addActiveAnimation: function(t, cmd) {\n            this._activeAnimations[cmd.name] = cmd; // set animation in the list of active one\n\n            var instanceAnimation = this._instanceAnimations[cmd.name];\n            instanceAnimation.start = t;\n            instanceAnimation.end = t + instanceAnimation.duration;\n            this._addActiveChannels(t, instanceAnimation);\n\n            // keep track of instance animation active in a list\n            this._activeAnimationList.push(instanceAnimation);\n        },\n\n        // execute start animations events\n        // during the updateManager\n        _processStartAnimation: function(t) {\n            // dont really start animation if we dont have yet targets\n            if (!this._targets.length) return;\n\n            var keyAnimation;\n            for (keyAnimation in this._startAnimations) {\n                var cmd = this._startAnimations[keyAnimation];\n                var name = cmd.name;\n\n                if (this.isPlaying(name)) continue;\n\n                this._addActiveAnimation(t, cmd);\n            }\n\n            if (keyAnimation !== undefined) this._startAnimations = {};\n        },\n\n        _resetTargets: function() {\n            this._targetMap = {};\n            this._targets.length = 0;\n\n            for (var i = 0, ni = this._targetsByTypes.length; i < ni; i++) {\n                this._targetsByTypes[i].length = 0;\n            }\n        },\n\n        resetAllStackedTransforms: function() {\n            var anims = this._animationsUpdateCallbackArray;\n            for (var i = 0, nbAnims = anims.length; i < nbAnims; i++) {\n                var stacked = anims[i].getStackedTransforms();\n                for (var j = 0, nbStacked = stacked.length; j < nbStacked; j++) {\n                    stacked[j].resetToDefaultValue();\n                }\n\n                // computeChannels is not mandatory here as the following frame will call\n                // this function anyway\n                anims[i].computeChannels();\n            }\n        },\n\n        setAnimationLerpEndStart: function(anim, lerpDuration) {\n            var channels = anim.channels;\n            if (anim.originalDuration === undefined) anim.originalDuration = anim.duration;\n\n            anim.duration = anim.originalDuration + lerpDuration;\n\n            var firstKey = anim.firstKeyTime;\n            var animDuration = anim.originalDuration;\n\n            for (var i = 0, nbChannels = channels.length; i < nbChannels; ++i) {\n                var ch = channels[i].channel;\n\n                // compare first and last key and detect if we can loop the channel or not\n                // it uses an arbitrary epsilon\n                if (\n                    Math.abs(ch.start - firstKey) > 0.01 ||\n                    Math.abs(ch.duration - animDuration) > 0.01\n                )\n                    continue;\n\n                // update channel end time\n                if (ch.originalEnd === undefined) ch.originalEnd = ch.end;\n\n                ch.end = ch.originalEnd + lerpDuration;\n\n                // add or remove additonal key and time\n\n                var sizeElt = TypeToSize[ch.type];\n                var size = ch.times.buffer.byteLength / 4;\n\n                // no lerp between end and start\n                if (lerpDuration === 0.0) {\n                    ch.keys = new Float32Array(ch.keys.buffer, 0, (size - 1) * sizeElt);\n                    ch.times = new Float32Array(ch.times.buffer, 0, size - 1);\n                } else {\n                    // take full size of buffer (with additional keys)\n                    ch.keys = new Float32Array(ch.keys.buffer, 0, size * sizeElt);\n                    // copy first key\n                    var idLast = (size - 1) * sizeElt;\n                    for (var j = 0; j < sizeElt; ++j) ch.keys[idLast + j] = ch.keys[j];\n\n                    ch.times = new Float32Array(ch.times.buffer, 0, size);\n                    ch.times[size - 1] = ch.times[size - 2] + lerpDuration;\n                }\n            }\n        }\n    }),\n    \'osgAnimation\',\n    \'BasicAnimationManager\'\n);\n\nBasicAnimationManager.TypeToSize = TypeToSize;\n\n/* harmony default export */ __webpack_exports__["a"] = (BasicAnimationManager);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/BasicAnimationManager.js\n// module id = 125\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/BasicAnimationManager.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgAnimation_channel__ = __webpack_require__(46);\n\n\n\n\nvar vec3CopyKeyFrame = function(i, keys, result) {\n    result[0] = keys[i++];\n    result[1] = keys[i++];\n    result[2] = keys[i++];\n};\n\nvar Vec4CopyKeyFrame = function(i, keys, result) {\n    result[0] = keys[i++];\n    result[1] = keys[i++];\n    result[2] = keys[i++];\n    result[3] = keys[i++];\n};\n\nvar Vec3LerpInterpolator = function(t, channelInstance) {\n    var channel = channelInstance.channel;\n    var value = channelInstance.value;\n    var keys = channel.keys;\n    var times = channel.times;\n\n    if (t >= times[times.length - 1]) {\n        channelInstance.key = 0;\n        vec3CopyKeyFrame(keys.length - 3, keys, value);\n        return;\n    } else if (t <= times[0]) {\n        channelInstance.key = 0;\n        vec3CopyKeyFrame(0, keys, value);\n        return;\n    }\n\n    var i1 = channelInstance.key;\n    if (t > times[i1]) while (times[i1 + 1] < t) i1++;\n    else if (t < times[i1]) while (times[i1] > t) i1--;\n\n    var t1 = times[i1];\n    var t2 = times[i1 + 1];\n\n    var index = i1 * 3;\n    var x1 = keys[index++];\n    var y1 = keys[index++];\n    var z1 = keys[index++];\n\n    var x2 = keys[index++];\n    var y2 = keys[index++];\n    var z2 = keys[index++];\n\n    var r = (t - t1) / (t2 - t1);\n\n    value[0] = x1 + (x2 - x1) * r;\n    value[1] = y1 + (y2 - y1) * r;\n    value[2] = z1 + (z2 - z1) * r;\n    channelInstance.key = i1;\n};\n\nvar QuatLerpInterpolator = (function() {\n    var q0 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create32();\n    var q1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create32();\n\n    return function(t, channelInstance) {\n        var channel = channelInstance.channel;\n        var value = channelInstance.value;\n        var keys = channel.keys;\n        var times = channel.times;\n\n        if (t >= times[times.length - 1]) {\n            channelInstance.key = 0;\n            Vec4CopyKeyFrame(keys.length - 4, keys, value);\n            return;\n        } else if (t <= times[0]) {\n            channelInstance.key = 0;\n            Vec4CopyKeyFrame(0, keys, value);\n            return;\n        }\n\n        var i1 = channelInstance.key;\n        if (t > times[i1]) while (times[i1 + 1] < t) i1++;\n        else if (t < times[i1]) while (times[i1] > t) i1--;\n\n        var t1 = times[i1];\n        var t2 = times[i1 + 1];\n\n        var index = i1 * 4;\n        q0[0] = keys[index++];\n        q0[1] = keys[index++];\n        q0[2] = keys[index++];\n        q0[3] = keys[index++];\n\n        q1[0] = keys[index++];\n        q1[1] = keys[index++];\n        q1[2] = keys[index++];\n        q1[3] = keys[index++];\n\n        var r = (t - t1) / (t2 - t1);\n\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].nlerp(value, q0, q1, r);\n        channelInstance.key = i1;\n    };\n})();\n\nvar QuatSlerpInterpolator = (function() {\n    var q0 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create32();\n    var q1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].create32();\n\n    return function(t, channelInstance) {\n        var channel = channelInstance.channel;\n        var value = channelInstance.value;\n        var keys = channel.keys;\n        var times = channel.times;\n\n        if (t >= times[times.length - 1]) {\n            channelInstance.key = 0;\n            Vec4CopyKeyFrame(keys.length - 4, keys, value);\n            return;\n        } else if (t <= times[0]) {\n            channelInstance.key = 0;\n            Vec4CopyKeyFrame(0, keys, value);\n            return;\n        }\n\n        var i1 = channelInstance.key;\n        if (t > times[i1]) while (times[i1 + 1] < t) i1++;\n        else if (t < times[i1]) while (times[i1] > t) i1--;\n\n        var t1 = times[i1];\n        var t2 = times[i1 + 1];\n\n        var index = i1 * 4;\n        q0[0] = keys[index++];\n        q0[1] = keys[index++];\n        q0[2] = keys[index++];\n        q0[3] = keys[index++];\n\n        q1[0] = keys[index++];\n        q1[1] = keys[index++];\n        q1[2] = keys[index++];\n        q1[3] = keys[index++];\n\n        var r = (t - t1) / (t2 - t1);\n\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["d" /* quat */].slerp(value, q0, q1, r);\n\n        channelInstance.key = i1;\n    };\n})();\n\nvar FloatLerpInterpolator = function(t, channelInstance) {\n    var channel = channelInstance.channel;\n    var value = channelInstance.value;\n    var keys = channel.keys;\n    var times = channel.times;\n\n    if (t >= times[times.length - 1]) {\n        channelInstance.key = 0;\n        channelInstance.value = keys[keys.length - 1];\n        return;\n    } else if (t <= times[0]) {\n        channelInstance.key = 0;\n        channelInstance.value = keys[0];\n        return;\n    }\n\n    var i1 = channelInstance.key;\n    if (t > times[i1]) while (times[i1 + 1] < t) i1++;\n    else if (t < times[i1]) while (times[i1] > t) i1--;\n\n    var t1 = times[i1];\n    var t2 = times[i1 + 1];\n\n    var index = i1;\n    var x1 = keys[index++];\n    var x2 = keys[index++];\n\n    var r = (t - t1) / (t2 - t1);\n\n    value = x1 + (x2 - x1) * r;\n    channelInstance.key = i1;\n    channelInstance.value = value;\n};\n\nvar FloatCubicBezierInterpolator = function(t, channelInstance) {\n    var channel = channelInstance.channel;\n    var value = channelInstance.value;\n    var keys = channel.keys;\n    var times = channel.times;\n\n    if (t >= times[times.length - 1]) {\n        channelInstance.key = 0;\n        channelInstance.value = keys[keys.length - 3];\n        return;\n    } else if (t <= times[0]) {\n        channelInstance.key = 0;\n        channelInstance.value = keys[0];\n        return;\n    }\n\n    var i = channelInstance.key;\n    if (t > times[i]) while (times[i + 1] < t) i++;\n    else if (t < times[i]) while (times[i] > t) i--;\n\n    var tt = (t - times[i]) / (times[i + 1] - times[i]);\n    var oneMinusT = 1.0 - tt;\n    var oneMinusT2 = oneMinusT * oneMinusT;\n    var oneMinusT3 = oneMinusT2 * oneMinusT;\n    var t2 = tt * tt;\n\n    var id = i * 3;\n    var v0 = keys[id] * oneMinusT3;\n    var v1 = keys[id + 1] * (3.0 * tt * oneMinusT2);\n    var v2 = keys[id + 2] * (3.0 * t2 * oneMinusT);\n    var v3 = keys[id + 3] * (t2 * tt);\n\n    value = v0 + v1 + v2 + v3;\n    channelInstance.key = i;\n    channelInstance.value = value;\n};\n\nvar Vec3CubicBezierInterpolator = (function() {\n    var v0 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n\n    return function(t, channelInstance) {\n        var channel = channelInstance.channel;\n        var value = channelInstance.value;\n        var keys = channel.keys;\n        var times = channel.times;\n\n        if (t >= times[times.length - 1]) {\n            channelInstance.key = 0;\n            vec3CopyKeyFrame(keys.length - 9, keys, value);\n            return;\n        } else if (t <= times[0]) {\n            channelInstance.key = 0;\n            vec3CopyKeyFrame(0, keys, value);\n            return;\n        }\n\n        var i = channelInstance.key;\n        if (t > times[i]) while (times[i + 1] < t) i++;\n        else if (t < times[i]) while (times[i] > t) i--;\n\n        var tt = (t - times[i]) / (times[i + 1] - times[i]);\n        var oneMinusT = 1.0 - tt;\n        var oneMinusT2 = oneMinusT * oneMinusT;\n        var oneMinusT3 = oneMinusT2 * oneMinusT;\n        var t2 = tt * tt;\n\n        var id = i * 9;\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].scale(v0, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v0, keys[id++], keys[id++], keys[id++]), oneMinusT3);\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].scale(v1, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v1, keys[id++], keys[id++], keys[id++]), 3.0 * tt * oneMinusT2);\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].scale(v2, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v2, keys[id++], keys[id++], keys[id++]), 3.0 * t2 * oneMinusT);\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].scale(v3, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].set(v3, keys[id++], keys[id++], keys[id++]), t2 * tt);\n\n        value[0] = v0[0] + v1[0] + v2[0] + v3[0];\n        value[1] = v0[1] + v1[1] + v2[1] + v3[1];\n        value[2] = v0[2] + v1[2] + v2[2] + v3[2];\n        channelInstance.key = i;\n    };\n})();\n\n// must be sync wiht Interpolator Type\nvar ChannelType = __WEBPACK_IMPORTED_MODULE_1_osgAnimation_channel__["a" /* default */].ChannelType;\n\nvar moduleInterpolator = {};\n\n// refrence interpolator by channe enum id\nmoduleInterpolator[ChannelType.Vec3] = Vec3LerpInterpolator;\nmoduleInterpolator[ChannelType.Quat] = QuatLerpInterpolator;\nmoduleInterpolator[ChannelType.QuatSlerp] = QuatSlerpInterpolator;\nmoduleInterpolator[ChannelType.Float] = FloatLerpInterpolator;\nmoduleInterpolator[ChannelType.FloatCubicBezier] = FloatCubicBezierInterpolator;\nmoduleInterpolator[ChannelType.Vec3CubicBezier] = Vec3CubicBezierInterpolator;\n\nmoduleInterpolator.Vec3LerpInterpolator = Vec3LerpInterpolator;\nmoduleInterpolator.QuatLerpInterpolator = QuatLerpInterpolator;\nmoduleInterpolator.QuatSlerpInterpolator = QuatSlerpInterpolator;\nmoduleInterpolator.FloatLerpInterpolator = FloatLerpInterpolator;\nmoduleInterpolator.FloatCubicBezierInterpolator = FloatCubicBezierInterpolator;\nmoduleInterpolator.Vec3CubicBezierInterpolator = Vec3CubicBezierInterpolator;\n\n/* harmony default export */ __webpack_exports__["a"] = (moduleInterpolator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/interpolator.js\n// module id = 126\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/interpolator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_AnimationUpdateCallback__ = __webpack_require__(52);\n\n\n\n\n// search into a subgraph all target\nvar CollectAnimationUpdateCallbackVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this);\n    this._animationUpdateCallback = {};\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CollectAnimationUpdateCallbackVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        getAnimationUpdateCallbackMap: function() {\n            return this._animationUpdateCallback;\n        },\n\n        apply: function(node) {\n            var cbs = node.getUpdateCallbackList();\n\n            // collect and remove animation update callback\n            for (var i = 0, cbsLength = cbs.length; i < cbsLength; i++) {\n                var cb = cbs[i];\n                if (cb instanceof __WEBPACK_IMPORTED_MODULE_2_osgAnimation_AnimationUpdateCallback__["a" /* default */]) {\n                    this._animationUpdateCallback[cb.getInstanceID()] = cb;\n                    //node.removeUpdateCallback( cb );\n                }\n            }\n            this.traverse(node);\n        }\n    }),\n    \'osgAnimation\',\n    \'CollectAnimationUpdateCallbackVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (CollectAnimationUpdateCallbackVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/CollectAnimationUpdateCallbackVisitor.js\n// module id = 127\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/CollectAnimationUpdateCallbackVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__ = __webpack_require__(37);\n\n\n\n\n\nvar StackedMatrix = function(name, matrix) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n    this._target = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__["a" /* default */].createMatrixTarget(matrix || __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n    if (name) this.setName(name);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    StackedMatrix,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        init: function(matrix) {\n            this.setMatrix(matrix);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].copy(this._target.defaultValue, matrix);\n        },\n\n        getTarget: function() {\n            return this._target;\n        },\n\n        getMatrix: function() {\n            return this._target.value;\n        },\n\n        setMatrix: function(m) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].copy(this._target.value, m);\n        },\n\n        resetToDefaultValue: function() {\n            this.setMatrix(this._target.defaultValue);\n        },\n\n        applyToMatrix: function(m) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(m, m, this._target.value);\n        }\n    }),\n    \'osgAnimation\',\n    \'StackedMatrix\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (StackedMatrix);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/StackedMatrix.js\n// module id = 128\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/StackedMatrix.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__ = __webpack_require__(37);\n\n\n\n\n\n\nvar qIdentity = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].create();\n\nvar StackedQuaternion = function(name, q) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n    this._target = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__["a" /* default */].createQuatTarget(q || qIdentity);\n    if (name) this.setName(name);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    StackedQuaternion,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        init: function(q) {\n            this.setQuaternion(q);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].copy(this._target.defaultValue, q);\n        },\n\n        setQuaternion: function(q) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].copy(this._target.value, q);\n        },\n\n        getTarget: function() {\n            return this._target;\n        },\n\n        resetToDefaultValue: function() {\n            this.setQuaternion(this._target.defaultValue);\n        },\n\n        applyToMatrix: (function() {\n            var matrixTmp = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function applyToMatrix(m) {\n                var mtmp = matrixTmp;\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromQuat(mtmp, this._target.value);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(m, m, mtmp);\n            };\n        })()\n    }),\n    \'osgAnimation\',\n    \'StackedQuaternion\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (StackedQuaternion);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/StackedQuaternion.js\n// module id = 129\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/StackedQuaternion.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__ = __webpack_require__(37);\n\n\n\n\n\n\n/**\n *  StackedTranslate\n */\nvar StackedTranslate = function(name, translate) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n    this._target = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__["a" /* default */].createVec3Target(translate || __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].ZERO);\n    if (name) this.setName(name);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    StackedTranslate,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        init: function(translate) {\n            this.setTranslate(translate);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._target.defaultValue, translate);\n        },\n\n        setTranslate: function(translate) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._target.value, translate);\n        },\n\n        getTarget: function() {\n            return this._target;\n        },\n\n        resetToDefaultValue: function() {\n            this.setTranslate(this._target.defaultValue);\n        },\n\n        applyToMatrix: function(m) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].translate(m, m, this._target.value);\n        }\n    }),\n    \'osgAnimation\',\n    \'StackedTranslate\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (StackedTranslate);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/StackedTranslate.js\n// module id = 130\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/StackedTranslate.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\nvar isBufferGZIP = function(arrayBuffer) {\n    var typedArray = new Uint8Array(arrayBuffer);\n    return typedArray[0] === 0x1f && typedArray[1] === 0x8b;\n};\n\nvar gunzip = function(arrayBuffer) {\n    var typedArray = new Uint8Array(arrayBuffer);\n    var zlib = __webpack_require__(132);\n\n    if (!zlib) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].error(\n            \'osg failed to use a gunzip.min.js to uncompress a gz file.\\n You can add this vendors to enable this feature or get it at https://github.com/imaya/zlib.js/blob/master/bin/gunzip.min.js\'\n        );\n    }\n\n    var zdec = new zlib.Gunzip(typedArray);\n    var result = zdec.decompress();\n    return result.buffer;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    isGunzipBuffer: isBufferGZIP,\n    gunzip: gunzip\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/zlib.js\n// module id = 131\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/zlib.js?')},function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_132__;\n\n//////////////////\n// WEBPACK FOOTER\n// external {"root":"Zlib","commonjs2":"zlib","commonjs":"zlib","amd":"zlib"}\n// module id = 132\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%7B%22root%22:%22Zlib%22,%22commonjs2%22:%22zlib%22,%22commonjs%22:%22zlib%22,%22amd%22:%22zlib%22%7D?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_PagedLOD__ = __webpack_require__(83);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Timer__ = __webpack_require__(22);\n\n\n\n\n\n\nvar FindPagedLODsVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN);\n    this._activePagedLODList = undefined;\n    this._frameNumber = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    FindPagedLODsVisitor,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.getTypeID() === __WEBPACK_IMPORTED_MODULE_3_osg_PagedLOD__["a" /* default */].getTypeID()) {\n                node.setFrameNumberOfLastTraversal(this._frameNumber);\n                this._activePagedLODList.add(node);\n            }\n            this.traverse(node);\n        },\n        set: function(pagedLODList, frameNumber) {\n            this._activePagedLODList = pagedLODList;\n            this._frameNumber = frameNumber;\n        }\n    }),\n    \'osgDB\',\n    \'FindPagedLODsVisitor\'\n);\n\nvar ReleaseVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN);\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    ReleaseVisitor,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            // mark GLResources in nodes to be released\n            node.releaseGLObjects();\n            this.traverse(node);\n        }\n    }),\n    \'osgDB\',\n    \'ReleaseVisitor\'\n);\n\nvar ExpiredPagedLODVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN);\n    this._childrenList = [];\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    ExpiredPagedLODVisitor,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.getTypeID() === __WEBPACK_IMPORTED_MODULE_3_osg_PagedLOD__["a" /* default */].getTypeID()) {\n                this._childrenList.push(node);\n                this._markRequestsExpired(node);\n            }\n            this.traverse(node);\n        },\n\n        removeExpiredChildrenAndFindPagedLODs: function(\n            plod,\n            expiryTime,\n            expiryFrame,\n            removedChildren\n        ) {\n            if (!plod.children.length) return false;\n\n            var sizeBefore = removedChildren.length;\n            plod.removeExpiredChildren(expiryTime, expiryFrame, removedChildren);\n            for (var i = sizeBefore; i < removedChildren.length; i++) {\n                removedChildren[i].accept(this);\n            }\n            return sizeBefore !== removedChildren.length;\n        },\n\n        _markRequestsExpired: function(plod) {\n            var numRanges = plod._perRangeDataList.length;\n            var request;\n            for (var i = 0; i < numRanges; i++) {\n                request = plod.getDatabaseRequest(i);\n                if (request !== undefined) {\n                    request._groupExpired = true;\n                    request._loadedModel = null;\n                }\n            }\n        },\n        reset: function() {\n            this._childrenList.length = 0;\n        }\n    }),\n    \'osgDB\',\n    \'ExpiredPagedLODVisitor\'\n);\n\n// Helper functions to avoid undesired memory allocation\nvar sortByTimeStamp = function(r1, r2) {\n    return r2._timeStamp - r1._timeStamp;\n};\nvar sortByPriority = function(r1, r2) {\n    // Ask for newer requests first.\n    var value = r1._timeStamp - r2._timeStamp;\n    // Ask for the greater priority if the timestamp is the same.\n    if (value === 0) {\n        value = r1._priority - r2._priority;\n    }\n    return value;\n};\n\n/**\n * Database paging class which manages the loading of files\n * and synchronizing of loaded models with the main scene graph.\n *  @class DatabasePager\n */\nvar DatabasePager = function() {\n    this._pendingRequests = [];\n    this._pendingNodes = [];\n    this._loading = false;\n    this._progressCallback = undefined;\n    this._lastCB = true;\n    this._activePagedLODList = new Set();\n    this._childrenToRemoveList = new Set();\n    this._downloadingRequestsNumber = 0;\n    this._maxRequestsPerFrame = 10;\n    this._acceptNewRequests = true;\n    this._releaseVisitor = new ReleaseVisitor();\n    this._expiredPagedLODVisitor = new ExpiredPagedLODVisitor();\n    this._findPagedLODsVisitor = new FindPagedLODsVisitor();\n    // In OSG the targetMaximumNumberOfPagedLOD is 300 by default\n    // here we set 75 as we need to be more strict with memory in a browser\n    // This value can be setted using setTargetMaximumNumberOfPageLOD method.\n    this._targetMaximumNumberOfPagedLOD = 75;\n    // Helper variables to avoid memory allocation, not for user access\n    this._elapsedTime = 0;\n    this._beginTime = 0;\n    this._availableTime = 0;\n};\n\nvar DatabaseRequest = function() {\n    this._loadedModel = undefined;\n    this._group = undefined;\n    this._url = undefined;\n    this._function = undefined;\n    this._timeStamp = 0.0;\n    this._groupExpired = false;\n    this._priority = 0.0;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    DatabasePager,\n    {\n        setTargetMaximumNumberOfPageLOD: function(target) {\n            this._targetMaximumNumberOfPagedLOD = target;\n        },\n\n        getTargetMaximumNumberOfPageLOD: function() {\n            return this._targetMaximumNumberOfPagedLOD;\n        },\n\n        setAcceptNewDatabaseRequests: function(acceptNewRequests) {\n            this._acceptNewRequests = acceptNewRequests;\n        },\n        getAcceptNewDatabaseRequests: function() {\n            return this._acceptNewRequests;\n        },\n        reset: function() {\n            this._pendingRequests = [];\n            this._pendingNodes = [];\n            this._loading = false;\n            this._lastCB = true;\n            this._activePagedLODList.clear();\n            this._childrenToRemoveList.clear();\n            this._downloadingRequestsNumber = 0;\n            this._maxRequestsPerFrame = 10;\n            this._acceptNewRequests = true;\n            this._targetMaximumNumberOfPagedLOD = 75;\n        },\n\n        updateSceneGraph: function(frameStamp) {\n            // Progress callback\n            if (this._progressCallback !== undefined) {\n                // Maybe we should encapsulate this in a promise.\n                this.executeProgressCallback();\n            }\n            // We need to control the time spent in DatabasePager tasks to\n            // avoid making the rendering slow.\n            // Probably we can have a time parameter to manage all the tasks.\n            // Now it is fixed to 0.0025 ms to remove expired childs\n            // and 0.005 ms  to add to the scene the loaded requests.\n\n            // Remove expired nodes\n            this.removeExpiredSubgraphs(frameStamp, 0.0025);\n            // Time to do the requests.\n            this.takeRequests();\n            // Add the loaded data to the graph\n            this.addLoadedDataToSceneGraph(frameStamp, 0.005);\n        },\n\n        executeProgressCallback: function() {\n            if (this._pendingRequests.length > 0 || this._pendingNodes.length > 0) {\n                this._progressCallback(\n                    this._pendingRequests.length + this._downloadingRequestsNumber,\n                    this._pendingNodes.length\n                );\n                this._lastCB = false;\n            } else {\n                if (!this._lastCB) {\n                    this._progressCallback(\n                        this._pendingRequests.length + this._downloadingRequestsNumber,\n                        this._pendingNodes.length\n                    );\n                    this._lastCB = true;\n                }\n            }\n        },\n\n        setMaxRequestsPerFrame: function(numRequests) {\n            this._maxRequestsPerFrame = numRequests;\n        },\n\n        getMaxRequestsPerFrame: function() {\n            return this._maxRequestsPerFrame;\n        },\n\n        getRequestListSize: function() {\n            return this._pendingRequests.length + this._downloadingRequestsNumber;\n        },\n\n        setProgressCallback: function(cb) {\n            this._progressCallback = cb;\n        },\n\n        addLoadedDataToSceneGraph: function(frameStamp, availableTime) {\n            if (!this._pendingNodes.length || availableTime <= 0.0) return 0.0;\n\n            // Prune the list of database requests.\n            var elapsedTime = 0.0;\n            var beginTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n            this._pendingNodes.sort(sortByTimeStamp);\n\n            for (var i = 0; i < this._pendingNodes.length; i++) {\n                if (elapsedTime > availableTime) return 0.0;\n\n                var request = this._pendingNodes.shift();\n                var frameNumber = frameStamp.getFrameNumber();\n                var timeStamp = frameStamp.getSimulationTime();\n\n                // If the request is not expired, then add/register new childs\n                if (request._groupExpired === false) {\n                    var plod = request._group;\n                    plod.setTimeStamp(plod.children.length, timeStamp);\n                    plod.setFrameNumber(plod.children.length, frameNumber);\n                    plod.addChildNode(request._loadedModel);\n\n                    // Register PagedLODs.\n                    if (!this._activePagedLODList.has(plod)) {\n                        this.registerPagedLODs(plod, frameNumber);\n                    } else {\n                        this.registerPagedLODs(request._loadedModel, frameNumber);\n                    }\n                } else {\n                    // Clean the request\n                    request._loadedModel = undefined;\n                    request = undefined;\n                }\n                elapsedTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n            }\n            availableTime -= elapsedTime;\n            return availableTime;\n        },\n\n        isLoading: function() {\n            return this._loading;\n        },\n\n        registerPagedLODs: function(subgraph, frameNumber) {\n            if (!subgraph) return;\n            this._findPagedLODsVisitor.set(this._activePagedLODList, frameNumber);\n            subgraph.accept(this._findPagedLODsVisitor);\n        },\n\n        requestNodeFile: function(func, url, node, timestamp, priority) {\n            // Check if we are currently accepting requests.\n            if (!this._acceptNewRequests) return undefined;\n            // We don\'t need to determine if the dbrequest is in the queue\n            // That is already done in the PagedLOD, so we just create the request\n            var dbrequest = new DatabaseRequest();\n            dbrequest._group = node;\n            dbrequest._function = func;\n            dbrequest._url = url;\n            dbrequest._timeStamp = timestamp;\n            dbrequest._priority = priority;\n            this._pendingRequests.push(dbrequest);\n            return dbrequest;\n        },\n\n        takeRequests: function() {\n            if (this._pendingRequests.length) {\n                var numRequests = Math.min(this._maxRequestsPerFrame, this._pendingRequests.length);\n                this._pendingRequests.sort(sortByPriority);\n                for (var i = 0; i < numRequests; i++) {\n                    this._downloadingRequestsNumber++;\n                    this.processRequest(this._pendingRequests.shift());\n                }\n            }\n        },\n\n        processRequest: function(dbrequest) {\n            this._loading = true;\n            var that = this;\n            // Check if the request is valid;\n            if (dbrequest._groupExpired) {\n                //Notify.log( \'DatabasePager::processRequest() Request expired.\' );\n                that._downloadingRequestsNumber--;\n                this._loading = false;\n                return;\n            }\n\n            // Load from function\n            if (dbrequest._function !== undefined) {\n                this.loadNodeFromFunction(dbrequest._function, dbrequest._group).then(function(\n                    child\n                ) {\n                    that._downloadingRequestsNumber--;\n                    dbrequest._loadedModel = child;\n                    that._pendingNodes.push(dbrequest);\n                    that._loading = false;\n                });\n            } else if (dbrequest._url !== \'\') {\n                // Load from URL\n                this.loadNodeFromURL(dbrequest._url).then(function(child) {\n                    that._downloadingRequestsNumber--;\n                    dbrequest._loadedModel = child;\n                    that._pendingNodes.push(dbrequest);\n                    that._loading = false;\n                });\n            }\n        },\n\n        loadNodeFromFunction: function(func, plod) {\n            // Need to call with pagedLOD as parent, to be able to have multiresolution structures.\n            var promise = func(plod);\n            // should func always return a promise ?\n            if (!promise) return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject();\n            if (promise && promise.then) return promise;\n            return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(promise);\n        },\n\n        loadNodeFromURL: function(url) {\n            var ReaderParser = __webpack_require__(33).default;\n            // Call to ReaderParser just in case there is a custom readNodeURL Callback\n            // See osgDB/options.js and/or osgDB/Input.js\n            // TODO: We should study if performance can be improved if separating the XHTTP request from\n            // the parsing. This way several/many request could be done at the same time.\n            // Also we should be able to cancel requests, so there is a need to have access\n            // to the HTTPRequest Object\n            return ReaderParser.readNodeURL(url);\n        },\n\n        releaseGLExpiredSubgraphs: function(availableTime) {\n            this._availableTime = availableTime;\n            if (!this._childrenToRemoveList.size || availableTime <= 0.0) return 0.0;\n            // We need to test if we have time to flush\n            this._elapsedTime = 0.0;\n            this._beginTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n            this._childrenToRemoveList.forEach(this._releaseExpiredSubgraphs, this);\n            this._availableTime -= this._elapsedTime;\n            return this._availableTime;\n        },\n\n        // function to avoid memory allocation in forEach\n        _releaseExpiredSubgraphs: function(node) {\n            // If we don\'t have more time, break the loop.\n            if (this._elapsedTime > this._availableTime) return;\n            this._childrenToRemoveList.delete(node);\n            node.accept(this._releaseVisitor);\n            node.removeChildren();\n            node = null;\n            this._elapsedTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(this._beginTime, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n        },\n\n        removeExpiredSubgraphs: function(frameStamp, availableTime) {\n            if (frameStamp.getFrameNumber() === 0) return 0.0;\n            var numToPrune = this._activePagedLODList.size - this._targetMaximumNumberOfPagedLOD;\n            var expiryTime = frameStamp.getSimulationTime() - 0.1;\n            var expiryFrame = frameStamp.getFrameNumber() - 1;\n            // First traverse and remove inactive PagedLODs, as their children will\n            // certainly have expired.\n            // TODO: Then traverse active nodes if we still need to prune.\n            if (numToPrune > 0) {\n                availableTime = this.removeExpiredChildren(\n                    numToPrune,\n                    expiryTime,\n                    expiryFrame,\n                    availableTime\n                );\n            }\n            return availableTime;\n        },\n\n        removeExpiredChildren: function(numToPrune, expiryTime, expiryFrame, availableTime) {\n            // Iterate over the activePagedLODList to remove expired children\n            // We need to control the time spent in remove childs.\n            var elapsedTime = 0.0;\n            var beginTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n            var that = this;\n            var removedChildren = [];\n            var expiredPagedLODVisitor = this._expiredPagedLODVisitor;\n            expiredPagedLODVisitor.reset();\n\n            this._activePagedLODList.forEach(function(plod) {\n                // Check if we have time, else return 0\n                if (elapsedTime > availableTime) return 0.0;\n                if (numToPrune < 0) return availableTime;\n                // See if plod is still active, so we don\'t have to prune\n                if (expiryFrame < plod.getFrameNumberOfLastTraversal()) return availableTime;\n                expiredPagedLODVisitor.removeExpiredChildrenAndFindPagedLODs(\n                    plod,\n                    expiryTime,\n                    expiryFrame,\n                    removedChildren\n                );\n                for (var i = 0; i < expiredPagedLODVisitor._childrenList.length; i++) {\n                    that._activePagedLODList.delete(expiredPagedLODVisitor._childrenList[i]);\n                    numToPrune--;\n                }\n                // Add to the remove list all the childs deleted\n                for (i = 0; i < removedChildren.length; i++) {\n                    that._childrenToRemoveList.add(removedChildren[i]);\n                }\n                expiredPagedLODVisitor._childrenList.length = 0;\n                removedChildren.length = 0;\n                elapsedTime = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n            });\n            availableTime -= elapsedTime;\n            return availableTime;\n        }\n    },\n    \'osgDB\',\n    \'DatabasePager\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (DatabasePager);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/DatabasePager.js\n// module id = 133\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/DatabasePager.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_animation__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgDB_readerParser__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgAnimation_StackedMatrix__ = __webpack_require__(128);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgAnimation_StackedScale__ = __webpack_require__(89);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Geometry__ = __webpack_require__(10);\n\n\n\n\n\n\n\n\n\n\n\n\nvar rejectObject = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].rejectObject;\n\nvar osgAnimationWrapper = {};\n\nvar channelCtor = function() {};\n\nvar registry = __WEBPACK_IMPORTED_MODULE_6_osgDB_readerParser__[\"default\"].registry();\nregistry.registerObject('osgAnimation.Vec3LerpChannel', channelCtor);\nregistry.registerObject('osgAnimation.FloatLerpChannel', channelCtor);\nregistry.registerObject('osgAnimation.QuatSlerpChannel', channelCtor);\nregistry.registerObject('osgAnimation.QuatLerpChannel', channelCtor);\nregistry.registerObject('osgAnimation.FloatCubicBezierChannel', channelCtor);\nregistry.registerObject('osgAnimation.Vec3CubicBezierChannel', channelCtor);\n// needs to be cleaned in c++\nregistry.registerObject('osgAnimation.StackedMatrixElement', __WEBPACK_IMPORTED_MODULE_7_osgAnimation_StackedMatrix__[\"a\" /* default */]);\nregistry.registerObject('osgAnimation.StackedScaleElement', __WEBPACK_IMPORTED_MODULE_8_osgAnimation_StackedScale__[\"a\" /* default */]);\n\nosgAnimationWrapper.Animation = function(input) {\n    var jsonObj = input.getJSON();\n    if (jsonObj.Name === undefined || !jsonObj.Channels || jsonObj.Channels.length === 0) {\n        return rejectObject('Animation', jsonObj);\n    }\n\n    var arrayChannelsPromise = [];\n\n    // channels\n    for (var i = 0, l = jsonObj.Channels.length; i < l; i++) {\n        var promise = input.setJSON(jsonObj.Channels[i]).readObject();\n        arrayChannelsPromise.push(promise);\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(arrayChannelsPromise).then(function(channels) {\n        return __WEBPACK_IMPORTED_MODULE_5_osgAnimation_animation__[\"a\" /* default */].createAnimation(channels, jsonObj.Name);\n    });\n};\n\nosgAnimationWrapper.StandardVec3Channel = function(input, channel, creator) {\n    var jsonObj = input.getJSON();\n    if (\n        jsonObj.TargetName === undefined ||\n        !jsonObj.KeyFrames ||\n        !jsonObj.Name ||\n        !jsonObj.KeyFrames.Time ||\n        !jsonObj.KeyFrames.Key ||\n        jsonObj.KeyFrames.Key.length !== 3\n    ) {\n        return rejectObject('StandardVec3Channel', jsonObj);\n    }\n\n    var jsTime = input.setJSON(jsonObj.KeyFrames.Time).readBufferArray();\n    var jsKeyX = input.setJSON(jsonObj.KeyFrames.Key[0]).readBufferArray();\n    var jsKeyY = input.setJSON(jsonObj.KeyFrames.Key[1]).readBufferArray();\n    var jsKeyZ = input.setJSON(jsonObj.KeyFrames.Key[2]).readBufferArray();\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all([jsTime, jsKeyX, jsKeyY, jsKeyZ]).then(function(pArray) {\n        var eTime = pArray[0].getElements();\n        var eKeyX = pArray[1].getElements();\n        var eKeyY = pArray[2].getElements();\n        var eKeyZ = pArray[3].getElements();\n\n        // the keys and time array are always create with a slightly biffer array buffer\n        // (one additional element) in case we want to lerp between end and start\n        var size = eTime.length;\n        var keys = new Float32Array(new ArrayBuffer(4 * (size + 1) * 3), 0, size * 3);\n        var times = new Float32Array(new ArrayBuffer(4 * (size + 1)), 0, size);\n\n        for (var i = 0; i < size; i++) {\n            var id = i * 3;\n            times[i] = eTime[i];\n            keys[id++] = eKeyX[i];\n            keys[id++] = eKeyY[i];\n            keys[id] = eKeyZ[i];\n        }\n\n        creator(keys, times, jsonObj.TargetName, jsonObj.Name, channel);\n        return channel;\n    });\n};\n\nosgAnimationWrapper.StandardQuatChannel = function(input, channel, creator) {\n    var jsonObj = input.getJSON();\n    if (\n        jsonObj.TargetName === undefined ||\n        !jsonObj.KeyFrames ||\n        !jsonObj.Name ||\n        !jsonObj.KeyFrames.Time ||\n        !jsonObj.KeyFrames.Key ||\n        jsonObj.KeyFrames.Key.length !== 4\n    ) {\n        return rejectObject('StandardQuatChannel', jsonObj);\n    }\n\n    var jsTime = input.setJSON(jsonObj.KeyFrames.Time).readBufferArray();\n    var jsKeyX = input.setJSON(jsonObj.KeyFrames.Key[0]).readBufferArray();\n    var jsKeyY = input.setJSON(jsonObj.KeyFrames.Key[1]).readBufferArray();\n    var jsKeyZ = input.setJSON(jsonObj.KeyFrames.Key[2]).readBufferArray();\n    var jsKeyW = input.setJSON(jsonObj.KeyFrames.Key[3]).readBufferArray();\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all([jsTime, jsKeyX, jsKeyY, jsKeyZ, jsKeyW]).then(function(pArray) {\n        var eTime = pArray[0].getElements();\n        var eKeyX = pArray[1].getElements();\n        var eKeyY = pArray[2].getElements();\n        var eKeyZ = pArray[3].getElements();\n        var eKeyW = pArray[4].getElements();\n\n        var size = eTime.length;\n        var keys = new Float32Array(new ArrayBuffer(4 * (size + 1) * 4), 0, size * 4);\n        var times = new Float32Array(new ArrayBuffer(4 * (size + 1)), 0, size);\n\n        for (var i = 0; i < size; i++) {\n            var id = i * 4;\n            times[i] = eTime[i];\n            keys[id++] = eKeyX[i];\n            keys[id++] = eKeyY[i];\n            keys[id++] = eKeyZ[i];\n            keys[id] = eKeyW[i];\n        }\n        creator(keys, times, jsonObj.TargetName, jsonObj.Name, channel);\n        return channel;\n    });\n};\n\nosgAnimationWrapper.StandardFloatChannel = function(input, channel, creator) {\n    var jsonObj = input.getJSON();\n    if (\n        jsonObj.TargetName === undefined ||\n        !jsonObj.KeyFrames ||\n        !jsonObj.Name ||\n        !jsonObj.KeyFrames.Time ||\n        !jsonObj.KeyFrames.Key\n    ) {\n        return rejectObject('StandardFloatChannel', jsonObj);\n    }\n\n    var jsTime = input.setJSON(jsonObj.KeyFrames.Time).readBufferArray();\n    var jsKey = input.setJSON(jsonObj.KeyFrames.Key).readBufferArray();\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all([jsTime, jsKey]).then(function(pArray) {\n        var eTime = pArray[0].getElements();\n        var eKey = pArray[1].getElements();\n\n        var size = eTime.length;\n        var keys = new Float32Array(new ArrayBuffer(4 * (size + 1)), 0, size);\n        var times = new Float32Array(new ArrayBuffer(4 * (size + 1)), 0, size);\n\n        for (var i = 0; i < size; i++) {\n            times[i] = eTime[i];\n            keys[i] = eKey[i];\n        }\n\n        creator(keys, times, jsonObj.TargetName, jsonObj.Name, channel);\n        return channel;\n    });\n};\n\nosgAnimationWrapper.Vec3LerpChannel = function(input, channel) {\n    return osgAnimationWrapper.StandardVec3Channel(input, channel, __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__[\"a\" /* default */].createVec3Channel);\n};\n\nosgAnimationWrapper.QuatLerpChannel = function(input, channel) {\n    return osgAnimationWrapper.StandardQuatChannel(input, channel, __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__[\"a\" /* default */].createQuatChannel);\n};\n\nosgAnimationWrapper.QuatSlerpChannel = function(input, channel) {\n    // nlerp is less expensive than slerp\n    return osgAnimationWrapper.StandardQuatChannel(input, channel, __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__[\"a\" /* default */].createQuatChannel);\n    // return osgAnimationWrapper.StandardQuatChannel( input, channel, Channel.createQuatSlerpChannel );\n};\n\nosgAnimationWrapper.FloatLerpChannel = function(input, channel) {\n    return osgAnimationWrapper.StandardFloatChannel(input, channel, __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__[\"a\" /* default */].createFloatChannel);\n};\n\nosgAnimationWrapper.FloatCubicBezierChannel = function(input, channel) {\n    var jsonObj = input.getJSON();\n\n    if (\n        jsonObj.TargetName === undefined ||\n        !jsonObj.KeyFrames ||\n        !jsonObj.Name ||\n        !jsonObj.KeyFrames.Time ||\n        !jsonObj.KeyFrames.Position ||\n        !jsonObj.KeyFrames.ControlPointOut ||\n        !jsonObj.KeyFrames.ControlPointIn\n    ) {\n        return rejectObject('FloatCubicBezierChannel', jsonObj);\n    }\n\n    var arrayPromise = [];\n    var keyFrames = window.Object.keys(jsonObj.KeyFrames);\n    var i;\n    for (i = 0; i < keyFrames.length; i++)\n        arrayPromise.push(input.setJSON(jsonObj.KeyFrames[keyFrames[i]]).readBufferArray());\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(arrayPromise).then(function(pArray) {\n        var controlPointIn = pArray[0].getElements();\n        var controlPointOut = pArray[1].getElements();\n        var position = pArray[2].getElements();\n        var time = pArray[3].getElements();\n\n        var size = time.length;\n        var keys = new Float32Array(new ArrayBuffer(4 * (size + 1) * 3), 0, size * 3);\n        var times = new Float32Array(new ArrayBuffer(4 * (size + 1)), 0, size);\n\n        for (i = 0; i < size; i++) {\n            var id = i * 3;\n\n            times[i] = time[i];\n            keys[id++] = position[i];\n            keys[id++] = controlPointIn[i];\n            keys[id] = controlPointOut[i];\n        }\n        __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__[\"a\" /* default */].createFloatCubicBezierChannel(\n            keys,\n            times,\n            jsonObj.TargetName,\n            jsonObj.Name,\n            channel\n        );\n        return channel;\n    });\n};\n\nosgAnimationWrapper.Vec3CubicBezierChannel = function(input, channel) {\n    var jsonObj = input.getJSON();\n\n    if (\n        jsonObj.TargetName === undefined ||\n        !jsonObj.KeyFrames ||\n        !jsonObj.Name ||\n        !jsonObj.KeyFrames.Time ||\n        !jsonObj.KeyFrames.Position ||\n        !jsonObj.KeyFrames.ControlPointOut ||\n        !jsonObj.KeyFrames.ControlPointIn ||\n        jsonObj.KeyFrames.Position.length !== 3 ||\n        jsonObj.KeyFrames.ControlPointIn.length !== 3 ||\n        jsonObj.KeyFrames.ControlPointOut.length !== 3\n    ) {\n        return rejectObject('Vec3CubicBezierChannel', jsonObj);\n    }\n\n    var arrayPromise = [];\n\n    //Reads all keyframes\n    var keyFrames = window.Object.keys(jsonObj.KeyFrames);\n    var i;\n    for (i = 0; i < keyFrames.length; i++) {\n        var key = keyFrames[i];\n        var jsonAttribute = jsonObj.KeyFrames[key];\n        if (key !== 'Time') {\n            arrayPromise.push(input.setJSON(jsonAttribute[0]).readBufferArray());\n            arrayPromise.push(input.setJSON(jsonAttribute[1]).readBufferArray());\n            arrayPromise.push(input.setJSON(jsonAttribute[2]).readBufferArray());\n        } else arrayPromise.push(input.setJSON(jsonAttribute).readBufferArray());\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(arrayPromise).then(function(pArray) {\n        var cpi0 = pArray[0].getElements();\n        var cpi1 = pArray[1].getElements();\n        var cpi2 = pArray[2].getElements();\n        var cpo0 = pArray[3].getElements();\n        var cpo1 = pArray[4].getElements();\n        var cpo2 = pArray[5].getElements();\n        var p0 = pArray[6].getElements();\n        var p1 = pArray[7].getElements();\n        var p2 = pArray[8].getElements();\n        var time = pArray[9].getElements();\n\n        var size = time.length;\n        var keys = new Float32Array(new ArrayBuffer(4 * (size + 1) * 9), 0, size * 9);\n        var times = new Float32Array(new ArrayBuffer(4 * (size + 1)), 0, size);\n\n        for (i = 0; i < size; i++) {\n            var id = i * 9;\n\n            times[i] = time[i];\n            keys[id++] = p0[i];\n            keys[id++] = p1[i];\n            keys[id++] = p2[i];\n\n            keys[id++] = cpi0[i];\n            keys[id++] = cpi1[i];\n            keys[id++] = cpi2[i];\n\n            keys[id++] = cpo0[i];\n            keys[id++] = cpo1[i];\n            keys[id] = cpo2[i];\n        }\n        __WEBPACK_IMPORTED_MODULE_4_osgAnimation_channel__[\"a\" /* default */].createVec3CubicBezierChannel(\n            keys,\n            times,\n            jsonObj.TargetName,\n            jsonObj.Name,\n            channel\n        );\n        return channel;\n    });\n};\n\nosgAnimationWrapper.BasicAnimationManager = function(input, manager) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Animations) return rejectObject('BasicAnimationManager', jsonObj);\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, manager);\n\n    var animPromises = [];\n\n    for (var i = 0, l = jsonObj.Animations.length; i < l; i++) {\n        var promiseAnimation = input.setJSON(jsonObj.Animations[i]).readObject();\n        if (promiseAnimation.isRejected()) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].warn('An Animation failed on the parsing!');\n            continue;\n        }\n        animPromises.push(promiseAnimation);\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(animPromises).then(function(animations) {\n        manager.init(animations);\n        return manager;\n    });\n};\n\nosgAnimationWrapper.UpdateMatrixTransform = function(input, umt) {\n    var jsonObj = input.getJSON();\n    //  some stackedTransform on bones has no name but the transform is usefull\n    if (/*!jsonObj.Name ||*/ !jsonObj.StackedTransforms) {\n        return rejectObject('UpdateMatrixTransform', jsonObj);\n    }\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, umt);\n\n    var promiseArray = [];\n    var i, l;\n    for (i = 0, l = jsonObj.StackedTransforms.length; i < l; i++) {\n        var promiseStacked = input.setJSON(jsonObj.StackedTransforms[i]).readObject();\n        if (promiseStacked.isRejected()) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].warn('A stacked transforms failed on the parsing!');\n            continue;\n        }\n        promiseArray.push(promiseStacked);\n    }\n\n    // when UpdateMatrixTransform is ready\n    // compute the default value data\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promiseArray).then(function(array) {\n        var stack = umt.getStackedTransforms();\n        for (i = 0, l = array.length; i < l; i++) stack.push(array[i]);\n        umt.computeChannels();\n        return umt;\n    });\n};\n\nosgAnimationWrapper.StackedTranslate = function(input, st) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Name || !jsonObj.Translate) return rejectObject('StackedTranslate', jsonObj);\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, st);\n\n    st.init(jsonObj.Translate);\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(st);\n};\n\nosgAnimationWrapper.StackedQuaternion = function(input, st) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Name || !jsonObj.Quaternion) return rejectObject('StackedQuaternion', jsonObj);\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, st);\n\n    st.init(jsonObj.Quaternion);\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(st);\n};\n\nosgAnimationWrapper.StackedRotateAxis = function(input, st) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Axis || jsonObj.Angle === undefined) {\n        return rejectObject('StackedRotateAxis', jsonObj);\n    }\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, st);\n\n    st.init(jsonObj.Axis, jsonObj.Angle);\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(st);\n};\n\nosgAnimationWrapper.StackedMatrix = function(input, sme) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Name || !jsonObj.Matrix) return rejectObject('StackedMatrix', jsonObj);\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, sme);\n\n    sme.init(jsonObj.Matrix);\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(sme);\n};\n\nosgAnimationWrapper.StackedScale = function(input, stc) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Name || !jsonObj.Scale) return rejectObject('StackedScale', jsonObj);\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, stc);\n\n    stc.init(jsonObj.Scale);\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(stc);\n};\n\nosgAnimationWrapper.Bone = function(input, bone) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.InvBindMatrixInSkeletonSpace) return rejectObject('Bone', jsonObj);\n\n    var promise = __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].MatrixTransform(input, bone);\n\n    bone.setInvBindMatrixInSkeletonSpace(jsonObj.InvBindMatrixInSkeletonSpace);\n\n    if (jsonObj.BoundingBox) {\n        // It is mandatory because we need it for shadows and culling\n        var bbox = bone.getBoneBoundingBox();\n        bbox.setMax(jsonObj.BoundingBox.max);\n        bbox.setMin(jsonObj.BoundingBox.min);\n    }\n\n    return promise;\n};\n\nosgAnimationWrapper.UpdateBone = osgAnimationWrapper.UpdateMatrixTransform;\n\nosgAnimationWrapper.UpdateSkeleton = function(input, upSkl) {\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, upSkl);\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(upSkl);\n};\n\nosgAnimationWrapper.Skeleton = __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].MatrixTransform;\n\nosgAnimationWrapper.RigGeometry = function(input, rigGeom) {\n    var jsonObj = input.getJSON();\n\n    // check boneMap\n    if (!jsonObj.SourceGeometry) return rejectObject('RigGeometry', jsonObj);\n\n    if (!jsonObj.BoneMap) __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].warn('No boneMap found in a RigGeometry !');\n\n    //Import rigGeometry as Geometry + BoneMap\n    var rigPromise = __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Geometry(input, rigGeom);\n    rigGeom._boneNameID = jsonObj.BoneMap;\n\n    //Import source geometry and merge it with the rigGeometry\n    var sourceGeometry = jsonObj.SourceGeometry['osg.Geometry'];\n    var geomPromise;\n    if (sourceGeometry) {\n        input.setJSON(sourceGeometry);\n        rigGeom.setSourceGeometry(new __WEBPACK_IMPORTED_MODULE_10_osg_Geometry__[\"a\" /* default */]());\n        geomPromise = __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Geometry(input, rigGeom.getSourceGeometry());\n    } else {\n        sourceGeometry = jsonObj.SourceGeometry['osgAnimation.MorphGeometry'];\n        if (sourceGeometry) {\n            input.setJSON(sourceGeometry);\n            rigGeom.setSourceGeometry(new __WEBPACK_IMPORTED_MODULE_9_osgAnimation_MorphGeometry__[\"a\" /* default */]());\n            geomPromise = osgAnimationWrapper.MorphGeometry(input, rigGeom.getSourceGeometry());\n        } else {\n            __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].warn('SourceGeometry type no recognized');\n        }\n    }\n\n    // not sure if it's normal but rig geometry don't have UniqueID\n    if (rigGeom._uniqueID === undefined) rigGeom._uniqueID = sourceGeometry.UniqueID;\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all([rigPromise, geomPromise]).then(function() {\n        rigGeom.mergeChildrenData();\n        return rigGeom;\n    });\n};\n\nosgAnimationWrapper.MorphGeometry = function(input, morphGeometry) {\n    var jsonObj = input.getJSON();\n\n    if (!jsonObj.MorphTargets) return rejectObject('MorphGeometry', jsonObj);\n\n    var morphTargets = jsonObj.MorphTargets;\n    var arrayPromise = [];\n\n    // arrayPromise[0] is the morphGeometry\n    arrayPromise.push(__WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Geometry(input, morphGeometry));\n\n    for (var i = 0, l = morphTargets.length; i < l; i++)\n        arrayPromise.push(input.setJSON(morphTargets[i]).readObject());\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(arrayPromise).then(function(promiseResultArray) {\n        var morphGeometryResolved = promiseResultArray[0];\n\n        var targets = morphGeometryResolved.getMorphTargets();\n        for (var j = 1, jn = promiseResultArray.length; j < jn; j++)\n            targets.push(promiseResultArray[j]);\n\n        morphGeometryResolved.mergeChildrenVertexAttributeList();\n        return morphGeometryResolved;\n    });\n};\n\nosgAnimationWrapper.UpdateMorph = function(input, updateMorph) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.TargetMap) return rejectObject('UpdateMorph', jsonObj);\n\n    __WEBPACK_IMPORTED_MODULE_3_osgWrappers_serializers_osg__[\"a\" /* default */].Object(input, updateMorph);\n\n    var keys = window.Object.keys(jsonObj.TargetMap);\n    for (var i = 0, l = keys.length; i < l; i++) {\n        var key = keys[i];\n        updateMorph.addTarget(jsonObj.TargetMap[key], parseInt(key, 10));\n    }\n\n    return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.resolve(updateMorph);\n};\n\nosgAnimationWrapper.StackedMatrixElement = osgAnimationWrapper.StackedMatrix;\nosgAnimationWrapper.StackedScaleElement = osgAnimationWrapper.StackedScale;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (osgAnimationWrapper);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgWrappers/serializers/osgAnimation.js\n// module id = 134\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgWrappers/serializers/osgAnimation.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgWrappers_serializers_osg__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgText_Text__ = __webpack_require__(136);\n\n\n\n\n\nvar osgTextWrapper = {};\n\nosgTextWrapper.Text = function(input, node) {\n    var jsonObj = input.getJSON();\n    if (!jsonObj.Text) return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject();\n\n    var promise = __WEBPACK_IMPORTED_MODULE_1_osgWrappers_serializers_osg__[\"a\" /* default */].Node(input, node);\n    node.setColor(jsonObj.Color);\n    node.setText(jsonObj.Text);\n    node.setAutoRotateToScreen(jsonObj.AutoRotateToScreen);\n    node.setPosition(jsonObj.Position);\n    node.setCharacterSize(jsonObj.CharacterSize);\n\n    if (jsonObj.Layout === 'VERTICAL') {\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].error('Vertical Alignment not supported');\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject();\n    }\n    var alignment = jsonObj.Alignment;\n    if (jsonObj.Alignment.indexOf('BASE_LINE') > -1) {\n        if (jsonObj.Alignment === 'LEFT_BASE_LINE') {\n            alignment = __WEBPACK_IMPORTED_MODULE_3_osgText_Text__[\"a\" /* default */].LEFT_CENTER;\n        } else if (jsonObj.Alignment === 'CENTER_BASE_LINE') {\n            alignment = __WEBPACK_IMPORTED_MODULE_3_osgText_Text__[\"a\" /* default */].CENTER_CENTER;\n        } else if (jsonObj.Alignment === 'RIGHT_BASE_LINE') {\n            alignment = __WEBPACK_IMPORTED_MODULE_3_osgText_Text__[\"a\" /* default */].RIGHT_CENTER;\n        } else if (jsonObj.Alignment === 'LEFT_BOTTOM_BASE_LINE') {\n            alignment = __WEBPACK_IMPORTED_MODULE_3_osgText_Text__[\"a\" /* default */].LEFT_BOTTOM;\n        } else if (jsonObj.Alignment === 'CENTER_BOTTOM_BASE_LINE') {\n            alignment = __WEBPACK_IMPORTED_MODULE_3_osgText_Text__[\"a\" /* default */].CENTER_BOTTOM;\n        } else if (jsonObj.Alignment === 'RIGHT_BOTTOM_BASE_LINE') {\n            alignment = __WEBPACK_IMPORTED_MODULE_3_osgText_Text__[\"a\" /* default */].RIGHT_BOTTOM;\n        }\n        /*develblock:start*/\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].log('Base line alignments not supported, alignment converted');\n        /*develblock:end*/\n    }\n    node.setAlignment(alignment);\n    node.setLayout(jsonObj.Layout);\n\n    return promise;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (osgTextWrapper);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgWrappers/serializers/osgText.js\n// module id = 135\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgWrappers/serializers/osgText.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_CullVisitor__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_AutoTransform__ = __webpack_require__(74);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Node__ = __webpack_require__(9);\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n *  @class Text: Text 2D using a Canvas2D as a texture for a textured quad.\n *  Notes: The OSGjs Text has been implemented like OSG osgText::Text as much as possible. However there are some\n *  things that should be noted:\n *  - This Text is far more simple than OSG ones, it only supports basic functionality.\n *  - In contrast to OSG, Text inherits from AutoTransform in osgjs.\n *  - Supported fonts are not the same in HTML than in OSG/C++.\n *  - Vertical layout is not supported right now.\n *  - BaseLine alignments are not supported, instead they are converted to supported ones if parsing a osgjs file.\n *  - Set the color in the range [ 0 - 1 ], as if you were working with OSG.\n *  - Texts are generated as a canvas 2D texture sticked in a quad. The size of the texture is the next power of two of the current size of the\n *    text so the bigger is your characterSize, the more memory it will consume.\n */\nvar Text = function(text) {\n    __WEBPACK_IMPORTED_MODULE_3_osg_AutoTransform__[\"a\" /* default */].call(this);\n    // create a canvas element\n    this._canvas = document.createElement('canvas');\n    this._context = this._canvas.getContext('2d');\n    this._matrixTransform = new __WEBPACK_IMPORTED_MODULE_4_osg_MatrixTransform__[\"a\" /* default */]();\n    this.addChild(this._matrixTransform);\n    this._text = '';\n    if (text !== undefined) this._text = text;\n    this._font = 'monospace';\n    // Vec4 value to load/return\n    this._color = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"g\" /* vec4 */].fromValues(0.0, 0.0, 0.0, 1.0);\n    // This determines the text color, it can take a hex value or rgba value (e.g. rgba(255,0,0,0.5))\n    this._fillStyle = 'rgba( 0, 0, 0, 1 )';\n    // This determines the alignment of text, e.g. left, center, right\n    this._context.textAlign = 'center';\n    this._textX = undefined;\n    // This determines the baseline of the text, e.g. top, middle, bottom\n    this._context.baseLine = 'middle';\n    this._textY = undefined;\n    // Size of the textured quad in meters.\n    this._characterSize = 1;\n    this._characterSizeMode = Text.OBJECT_COORDS;\n    // Font resolution\n    this._fontSize = 32;\n    this._geometry = undefined;\n    this._autoRotateToScreen = false;\n    this._position = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"f\" /* vec3 */].create();\n    this._layout = Text.LEFT_TO_RIGHT;\n    this._alignment = Text.CENTER_CENTER;\n    // NPOT textures\n    this._forcePowerOfTwo = false;\n    // Lazy initialization\n    this._texture = new __WEBPACK_IMPORTED_MODULE_6_osg_Texture__[\"default\"]();\n    this.drawText();\n    this._dirty = false;\n\n    // We need to keep track of modelView Matrix\n    this._previousModelView = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].create();\n};\n\n// CharacterSizeMode\nText.OBJECT_COORDS = 0;\nText.SCREEN_COORDS = 1;\nText.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT = 2;\n\n// Layout enum\nText.LEFT_TO_RIGHT = 'ltr';\nText.RIGHT_TO_LEFT = 'rtl';\n\n// Alignment enum\nText.LEFT_TOP = 0;\nText.LEFT_CENTER = 1;\nText.LEFT_BOTTOM = 2;\n\nText.CENTER_TOP = 3;\nText.CENTER_CENTER = 4;\nText.CENTER_BOTTOM = 5;\n\nText.RIGHT_TOP = 6;\nText.RIGHT_CENTER = 7;\nText.RIGHT_BOTTOM = 8;\n\n/** @lends Text.prototype */\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeNode(\n    Text,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_AutoTransform__[\"a\" /* default */].prototype, {\n        drawText: function() {\n            if (this._geometry !== undefined) {\n                this._matrixTransform.removeChild(this._geometry);\n                // The text could be dynamic, so we need to remove GL objects\n                this._geometry.releaseGLObjects();\n            }\n            if (!this._text) return;\n            this.setTextProperties();\n            this._canvas.width = this._context.measureText(this._text).width;\n            this._canvas.height = this._fontSize * 2;\n            // For devices not supporting NPOT textures\n            if (this._forcePowerOfTwo) {\n                this._canvas.width = this._nextPowerOfTwo(this._canvas.width);\n                this._canvas.height = this._nextPowerOfTwo(this._canvas.height);\n            }\n            // We need to set the text properties again, as the canvas size cold change.\n            this.setTextProperties();\n            this._context.clearRect(0, 0, this._canvas.width, this._canvas.height);\n            this._context.fillText(this._text, this._textX, this._textY);\n            // Right now we set the pivot point to center, to assure the bounding box is correct when rendering billboards.\n            // TODO: Possibility to set different pivot point so we can have missing alignments.\n            var aspectRatio = this._canvas.width / this._canvas.height;\n            var quadWidth = this._characterSize * aspectRatio;\n            this._geometry = __WEBPACK_IMPORTED_MODULE_5_osg_shape__[\"a\" /* default */].createTexturedQuadGeometry(\n                -quadWidth / 2,\n                -this._characterSize / 2,\n                0,\n                quadWidth,\n                0,\n                0,\n                0,\n                this._characterSize,\n                0\n            );\n            // create a texture to attach the canvas2D\n            this._texture.setTextureSize(this._canvas.width, this._canvas.height);\n            this._texture.setMinFilter('LINEAR');\n            this._texture.setMagFilter('LINEAR');\n            this._texture.setImage(this._canvas);\n            // Transparency stuff\n            var stateset = this._geometry.getOrCreateStateSet();\n            stateset.setTextureAttributeAndModes(0, this._texture);\n            stateset.setRenderingHint('TRANSPARENT_BIN');\n            stateset.setAttributeAndModes(\n                new __WEBPACK_IMPORTED_MODULE_7_osg_BlendFunc__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_7_osg_BlendFunc__[\"a\" /* default */].ONE, __WEBPACK_IMPORTED_MODULE_7_osg_BlendFunc__[\"a\" /* default */].ONE_MINUS_SRC_ALPHA)\n            );\n            this._matrixTransform.addChild(this._geometry);\n            this.dirtyBound();\n        },\n\n        setText: function(text) {\n            this._text = text;\n            // Canvas size could change so we need to make it dirty.\n            this._dirty = true;\n        },\n\n        getText: function() {\n            return this._text;\n        },\n\n        setFont: function(font) {\n            this._font = font;\n            this._dirty = true;\n        },\n\n        setColor: function(color) {\n            this._color = color;\n            // Convert color to html range\n            this._fillStyle =\n                'rgba(' +\n                Math.round(color[0] * 255) +\n                ',' +\n                Math.round(color[1] * 255) +\n                ',' +\n                Math.round(color[2] * 255) +\n                ',' +\n                color[3] +\n                ')';\n            this._context.fillStyle = this._fillStyle;\n            // Canvas size does not change so we don't need to redo the quad.\n            this._context.fillText(this._text, this._textX, this._textY);\n        },\n\n        getColor: function() {\n            return this._color;\n        },\n\n        setCharacterSize: function(size) {\n            this._characterSize = size;\n            if (this._characterSizeMode !== Text.OBJECT_COORDS) {\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].fromScaling(this._matrixTransform.getMatrix(), [\n                    this._characterSize,\n                    this._characterSize,\n                    this._characterSize\n                ]);\n                if (\n                    this._characterSizeMode ===\n                    Text.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT\n                )\n                    this.setMaximumScale(this._characterSize);\n            }\n            this._dirty = true;\n        },\n\n        getCharacterSize: function() {\n            return this._characterSize;\n        },\n\n        setCharacterSizeMode: function(mode) {\n            this._characterSizeMode = mode;\n            if (this._characterSizeMode !== Text.OBJECT_COORDS) {\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].fromScaling(this._matrixTransform.getMatrix(), [\n                    this._characterSize,\n                    this._characterSize,\n                    this._characterSize\n                ]);\n                this.setAutoScaleToScreen(true);\n                this.setMaximumScale(Number.MAX_VALUE);\n                if (\n                    this._characterSizeMode ===\n                    Text.OBJECT_COORDS_WITH_MAXIMUM_SCREEN_SIZE_CAPPED_BY_FONT_HEIGHT\n                )\n                    this.setMaximumScale(this._characterSize);\n            } else {\n                this._matrixTransform.setMatrix(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].create());\n                this.setAutoScaleToScreen(false);\n            }\n            this._dirty = true;\n        },\n\n        getCharacterSizeMode: function() {\n            return this._characterSizeMode;\n        },\n\n        setFontResolution: function(resolution) {\n            this._fontSize = resolution;\n            this._dirty = true;\n        },\n\n        getFontResolution: function() {\n            return this._fontSize;\n        },\n\n        setPosition: function(position) {\n            this._position = position;\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].fromTranslation(this.getMatrix(), position);\n        },\n\n        getPosition: function() {\n            return this._position;\n        },\n\n        setTextProperties: function() {\n            this._context.fillStyle = this._fillStyle;\n            this._setAlignmentValues(this._alignment);\n            this._context.font = this._fontSize + 'px ' + this._font;\n            this._context.direction = this._layout;\n        },\n\n        setAutoRotateToScreen: function(value) {\n            __WEBPACK_IMPORTED_MODULE_3_osg_AutoTransform__[\"a\" /* default */].prototype.setAutoRotateToScreen.call(this, value);\n            this._dirty = true;\n        },\n\n        getAutoRotateToScreen: function() {\n            return this._autoRotateToScreen;\n        },\n\n        setLayout: function(layout) {\n            if (typeof layout === 'string') {\n                this._layout = Text[layout];\n            } else {\n                this._layout = layout;\n            }\n            this._dirty = true;\n        },\n        getLayout: function() {\n            return this._layout;\n        },\n        setAlignment: function(alignment) {\n            if (typeof alignment === 'string') {\n                this._alignment = Text[alignment];\n            } else {\n                this._alignment = alignment;\n            }\n            this._dirty = true;\n        },\n        getAlignment: function() {\n            return this._alignment;\n        },\n\n        accept: (function() {\n            return function(visitor) {\n                if (this._dirty) {\n                    this.drawText();\n                    this._dirty = false;\n                }\n                if (visitor.getVisitorType() === __WEBPACK_IMPORTED_MODULE_8_osg_NodeVisitor__[\"a\" /* default */].CULL_VISITOR) {\n                    var width = visitor.getViewport().width();\n                    var height = visitor.getViewport().height();\n                    var projMat = visitor.getCurrentProjectionMatrix();\n                    var modelViewMat = visitor.getCurrentModelViewMatrix();\n                    var position = this._position;\n                    var doUpdate = this._firstTimeToInitEyePoint;\n\n                    if (!this._firstTimeToInitEyePoint) {\n                        if (!__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].exactEquals(modelViewMat, this._previousModelView)) {\n                            doUpdate = true;\n                        } else if (\n                            width !== this._previousWidth ||\n                            height !== this._previousHeight\n                        ) {\n                            doUpdate = true;\n                        } else if (!__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].exactEquals(projMat, this._previousProjection)) {\n                            doUpdate = true;\n                        } else if (!__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"f\" /* vec3 */].exactEquals(position, this._previousPosition)) {\n                            doUpdate = true;\n                        }\n                    }\n                    this._firstTimeToInitEyePoint = false;\n                    if (doUpdate) {\n                        if (this._autoScaleToScreen) {\n                            var viewport = visitor.getViewport();\n                            var psvector = this.computePixelSizeVector(\n                                viewport,\n                                projMat,\n                                modelViewMat\n                            );\n                            var v = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"g\" /* vec4 */].fromValues(\n                                this._position[0],\n                                this._position[1],\n                                this._position[2],\n                                1.0\n                            );\n                            var pixelSize = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"g\" /* vec4 */].dot(v, psvector);\n                            pixelSize = 0.48 / pixelSize;\n                            var size = 1.0 / pixelSize;\n                            if (this._autoScaleTransitionWidthRatio > 0.0) {\n                                var c, b, a;\n                                if (this._minimumScale > 0.0) {\n                                    var j = this._minimumScale;\n                                    var i =\n                                        this._maximumScale < Number.MAX_VALUE\n                                            ? this._minimumScale +\n                                              (this._maximumScale - this._minimumScale) *\n                                                  this._autoScaleTransitionWidthRatio\n                                            : this._minimumScale *\n                                              (1.0 + this._autoScaleTransitionWidthRatio);\n                                    c = 1.0 / (4.0 * (i - j));\n                                    b = 1.0 - 2.0 * c * i;\n                                    a = j + b * b / (4.0 * c);\n                                    var k = -b / (2.0 * c);\n                                    if (size < k) size = this._minimumScale;\n                                    else if (size < i) size = a + b * size + c * (size * size);\n                                }\n                                if (this._maximumScale < Number.MAX_VALUE) {\n                                    var n = this._maximumScale;\n                                    var m =\n                                        this._minimumScale > 0.0\n                                            ? this._maximumScale +\n                                              (this._minimumScale - this._maximumScale) *\n                                                  this._autoScaleTransitionWidthRatio\n                                            : this._maximumScale *\n                                              (1.0 - this._autoScaleTransitionWidthRatio);\n                                    c = 1.0 / (4.0 * (m - n));\n                                    b = 1.0 - 2.0 * c * m;\n                                    a = n + b * b / (4.0 * c);\n                                    var p = -b / (2.0 * c);\n\n                                    if (size > p) size = this._maximumScale;\n                                    else if (size > m) size = a + b * size + c * (size * size);\n                                }\n                            }\n                            this.setScale(size);\n                        }\n                        if (this._autoRotateToScreen) {\n                            var rotation = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"d\" /* quat */].create();\n                            var modelView = visitor.getCurrentModelViewMatrix();\n                            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].getRotation(rotation, modelView);\n                            this.setRotation(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"d\" /* quat */].invert(rotation, rotation));\n                        }\n                        this._previousWidth = width;\n                        this._previousHeight = height;\n                        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"f\" /* vec3 */].copy(this._previousPosition, position);\n                        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].copy(this._previousProjection, projMat);\n                        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].copy(this._previousModelView, modelViewMat);\n                    }\n                }\n\n                __WEBPACK_IMPORTED_MODULE_9_osg_Node__[\"a\" /* default */].prototype.accept.call(this, visitor);\n            };\n        })(),\n        _setAlignmentValues: function(alignment) {\n            // Convert the OSG Api to js API\n            switch (alignment) {\n                case Text.LEFT_TOP:\n                    this._context.textAlign = 'left';\n                    this._textX = 0;\n                    this._context.textBaseline = 'top';\n                    this._textY = 0;\n                    break;\n                case Text.LEFT_CENTER:\n                    this._context.textAlign = 'left';\n                    this._textX = 0;\n                    this._context.textBaseline = 'middle';\n                    this._textY = this._canvas.height / 2;\n                    break;\n                case Text.LEFT_BOTTOM:\n                    this._context.textAlign = 'left';\n                    this._textX = 0;\n                    this._context.textBaseline = 'bottom';\n                    this._textY = this._canvas.height;\n                    break;\n                case Text.CENTER_TOP:\n                    this._context.textAlign = 'center';\n                    this._textX = this._canvas.width / 2;\n                    this._context.textBaseline = 'top';\n                    this._textY = 0;\n                    break;\n                case Text.CENTER_CENTER:\n                    this._context.textAlign = 'center';\n                    this._textX = this._canvas.width / 2;\n                    this._context.textBaseline = 'middle';\n                    this._textY = this._canvas.height / 2;\n                    break;\n                case Text.CENTER_BOTTOM:\n                    this._context.textAlign = 'center';\n                    this._textX = this._canvas.width / 2;\n                    this._context.textBaseline = 'bottom';\n                    this._textY = this._canvas.height;\n                    break;\n                case Text.RIGHT_TOP:\n                    this._context.textAlign = 'right';\n                    this._textX = this._canvas.width;\n                    this._context.textBaseline = 'top';\n                    this._textY = 0;\n                    break;\n                case Text.RIGHT_CENTER:\n                    this._context.textAlign = 'right';\n                    this._textX = this._canvas.width;\n                    this._context.textBaseline = 'middle';\n                    this._textY = this._canvas.height / 2;\n                    break;\n                case Text.RIGHT_BOTTOM:\n                    this._context.textAlign = 'right';\n                    this._textX = this._canvas.width;\n                    this._context.textBaseline = 'bottom';\n                    this._textY = this._canvas.height;\n                    break;\n            }\n        },\n        setForcePowerOfTwo: function(value) {\n            this._forcePowerOfTwo = value;\n        },\n        getForcePowerOfTwo: function() {\n            return this._forcePowerOfTwo;\n        },\n        _nextPowerOfTwo: function(value) {\n            var v = value;\n            v--;\n            v |= v >> 1;\n            v |= v >> 2;\n            v |= v >> 4;\n            v |= v >> 8;\n            v |= v >> 16;\n            v++;\n            return v;\n        }\n    }),\n    'osgText',\n    'Text'\n);\n\n// same code like Node\n__WEBPACK_IMPORTED_MODULE_0_osg_CullVisitor__[\"a\" /* default */].registerApplyFunction(\n    Text.nodeTypeID,\n    __WEBPACK_IMPORTED_MODULE_0_osg_CullVisitor__[\"a\" /* default */].getApplyFunction(__WEBPACK_IMPORTED_MODULE_3_osg_AutoTransform__[\"a\" /* default */].nodeTypeID)\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Text);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgText/Text.js\n// module id = 136\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgText/Text.js?")},function(module,exports){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_137__;\n\n//////////////////\n// WEBPACK FOOTER\n// external {"root":"Hammer","commonjs2":"hammerjs","commonjs":"hammerjs","amd":"hammer"}\n// module id = 137\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%7B%22root%22:%22Hammer%22,%22commonjs2%22:%22hammerjs%22,%22commonjs%22:%22hammerjs%22,%22amd%22:%22hammer%22%7D?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__ = __webpack_require__(71);\n\n\n\n\n\nvar LineSegmentIntersection = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].Intersection.call(this);\n\n    this._localIntersectionNormal = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].clone(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].ONE);\n\n    // index of vertex\n    this._i1 = -1;\n    this._i2 = -1;\n    this._i3 = -1;\n\n    // barycentric coordinates\n    this._r1 = 0.0;\n    this._r2 = 0.0;\n    this._r3 = 0.0;\n};\n\n// Settings are needed.\nvar LineSegmentIntersectFunctor = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].call(this);\n\n    this._threshold = 0.0; // only used for lines and points\n    this._d = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._length = 0;\n    this._invLength = 0;\n\n    this._start = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._end = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._dInvX = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._dInvY = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._dInvZ = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._hit = false;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    LineSegmentIntersectFunctor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].prototype, {\n        set: function(start, end, threshold) {\n            this._start = start;\n            this._end = end;\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(this._d, end, start);\n\n            this._length = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].length(this._d);\n            this._invLength = this._length !== 0.0 ? 1.0 / this._length : 0.0;\n\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(this._d, this._d, this._invLength);\n            if (this._d[0] !== 0.0) __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(this._dInvX, this._d, 1.0 / this._d[0]);\n            if (this._d[1] !== 0.0) __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(this._dInvY, this._d, 1.0 / this._d[1]);\n            if (this._d[2] !== 0.0) __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(this._dInvZ, this._d, 1.0 / this._d[2]);\n\n            if (threshold !== undefined) this._threshold = threshold;\n        },\n\n        enter: function(bbox, s, e) {\n            var min = bbox._min;\n            var xmin = min[0];\n            var ymin = min[1];\n            var zmin = min[2];\n\n            var max = bbox._max;\n            var xmax = max[0];\n            var ymax = max[1];\n            var zmax = max[2];\n\n            var invX = this._dInvX;\n            var invY = this._dInvY;\n            var invZ = this._dInvZ;\n\n            if (s[0] <= e[0]) {\n                // trivial reject of segment wholely outside.\n                if (e[0] < xmin) return false;\n                if (s[0] > xmax) return false;\n\n                if (s[0] < xmin) {\n                    // clip s to xMin.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(s, s, invX, xmin - s[0]);\n                }\n\n                if (e[0] > xmax) {\n                    // clip e to xMax.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(e, s, invX, xmax - s[0]);\n                }\n            } else {\n                if (s[0] < xmin) return false;\n                if (e[0] > xmax) return false;\n\n                if (e[0] < xmin) {\n                    // clip s to xMin.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(e, s, invX, xmin - s[0]);\n                }\n\n                if (s[0] > xmax) {\n                    // clip e to xMax.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(s, s, invX, xmax - s[0]);\n                }\n            }\n\n            // compare s and e against the yMin to yMax range of bb.\n            if (s[1] <= e[1]) {\n                // trivial reject of segment wholely outside.\n                if (e[1] < ymin) return false;\n                if (s[1] > ymax) return false;\n\n                if (s[1] < ymin) {\n                    // clip s to yMin.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(s, s, invY, ymin - s[1]);\n                }\n\n                if (e[1] > ymax) {\n                    // clip e to yMax.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(e, s, invY, ymax - s[1]);\n                }\n            } else {\n                if (s[1] < ymin) return false;\n                if (e[1] > ymax) return false;\n\n                if (e[1] < ymin) {\n                    // clip s to yMin.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(e, s, invY, ymin - s[1]);\n                }\n\n                if (s[1] > ymax) {\n                    // clip e to yMax.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(s, s, invY, ymax - s[1]);\n                }\n            }\n\n            // compare s and e against the zMin to zMax range of bb.\n            if (s[2] <= e[2]) {\n                // trivial reject of segment wholely outside.\n                if (e[2] < zmin) return false;\n                if (s[2] > zmax) return false;\n\n                if (s[2] < zmin) {\n                    // clip s to zMin.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(s, s, invZ, zmin - s[2]);\n                }\n\n                if (e[2] > zmax) {\n                    // clip e to zMax.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(e, s, invZ, zmax - s[2]);\n                }\n            } else {\n                if (s[2] < zmin) return false;\n                if (e[2] > zmax) return false;\n\n                if (e[2] < zmin) {\n                    // clip s to zMin.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(e, s, invZ, zmin - s[2]);\n                }\n\n                if (s[2] > zmax) {\n                    // clip e to zMax.\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(s, s, invZ, zmax - s[2]);\n                }\n            }\n\n            return true;\n        },\n\n        intersectPoint: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var dir = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(v0, p0) {\n                // https://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistPointSegment.h\n                var st = this._start;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(tmp, v0, st);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(dir, this._end, st);\n                // compute ratio (projection on line)\n                var r = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(tmp, dir) * this._invLength * this._invLength;\n\n                // compute distance to segment\n                var distToSegmentSqr = 1.0;\n                if (r < 0.0) distToSegmentSqr = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(tmp);\n                else if (r > 1.0) distToSegmentSqr = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrDist(v0, this._end);\n                else distToSegmentSqr = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(tmp, tmp, dir, -r));\n\n                if (distToSegmentSqr > this._threshold * this._threshold) {\n                    return;\n                }\n\n                var intersection = this.initIntersection(new LineSegmentIntersection());\n                intersection._i1 = p0;\n                intersection._r1 = 1.0;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(intersection._localIntersectionPoint, st, dir, r);\n                intersection._ratio = r;\n            };\n        })(),\n\n        intersectLine: (function() {\n            var u = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var v = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var w = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n            var closest0 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var closest1 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(v0, v1, p0, p1) {\n                // https://www.geometrictools.com/GTEngine/Samples/Geometrics/DistanceSegments3/DistanceSegments3.cpp\n                var epsilon = 0.00000001;\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(u, v1, v0);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(v, this._end, this._start);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(w, v0, this._start);\n                var a = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(u, u);\n                var b = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(u, v);\n                var c = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(v, v);\n                var d = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(u, w);\n                var e = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(v, w);\n                var D = a * c - b * b;\n                var sN;\n                var tN;\n                var sD = D;\n                var tD = D;\n\n                // compute the line parameters of the two closest points\n                if (D < epsilon) {\n                    // the lines are almost parallel\n                    sN = 0.0; // force using point P0 on segment S1\n                    sD = 1.0; // to prevent possible division by 0.0 later\n                    tN = e;\n                    tD = c;\n                } else {\n                    // get the closest points on the infinite lines\n                    sN = b * e - c * d;\n                    tN = a * e - b * d;\n                    if (sN < 0.0) {\n                        // sc < 0 => the s=0 edge is visible\n                        sN = 0.0;\n                        tN = e;\n                        tD = c;\n                    } else if (sN > sD) {\n                        // sc > 1  => the s=1 edge is visible\n                        sN = sD;\n                        tN = e + b;\n                        tD = c;\n                    }\n                }\n\n                if (tN < 0.0) {\n                    // tc < 0 => the t=0 edge is visible\n                    tN = 0.0;\n                    // recompute sc for this edge\n                    if (-d < 0.0) sN = 0.0;\n                    else if (-d > a) sN = sD;\n                    else {\n                        sN = -d;\n                        sD = a;\n                    }\n                } else if (tN > tD) {\n                    // tc > 1  => the t=1 edge is visible\n                    tN = tD;\n                    // recompute sc for this edge\n                    if (-d + b < 0.0) sN = 0;\n                    else if (-d + b > a) sN = sD;\n                    else {\n                        sN = -d + b;\n                        sD = a;\n                    }\n                }\n                // finally do the division to get sc and tc\n                var sc = Math.abs(sN) < epsilon ? 0.0 : sN / sD;\n                var tc = Math.abs(tN) < epsilon ? 0.0 : tN / tD;\n\n                // get the difference of the two closest points\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(closest0, v0, u, sc);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(closest1, this._start, v, tc);\n\n                var sqrDistance = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrDist(closest0, closest1);\n                if (sqrDistance > this._threshold * this._threshold) {\n                    return;\n                }\n\n                var intersection = this.initIntersection(new LineSegmentIntersection());\n                intersection._i1 = p0;\n                intersection._i2 = p1;\n                intersection._r1 = 1.0 - tc;\n                intersection._r2 = tc;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(intersection._localIntersectionPoint, closest1);\n                intersection._ratio = tc;\n            };\n        })(),\n\n        intersectTriangle: (function() {\n            var normal = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var e2 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var e1 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var tvec = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var pvec = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var qvec = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var epsilon = 1e-20;\n\n            return function(v0, v1, v2, p0, p1, p2) {\n                var d = this._d;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(e2, v2, v0);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(e1, v1, v0);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].cross(pvec, d, e2);\n\n                var det = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(pvec, e1);\n                if (det > -epsilon && det < epsilon) return;\n                var invDet = 1.0 / det;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(tvec, this._start, v0);\n\n                var u = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(pvec, tvec) * invDet;\n                if (u < 0.0 || u > 1.0) return;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].cross(qvec, tvec, e1);\n\n                var v = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(qvec, d) * invDet;\n                if (v < 0.0 || u + v > 1.0) return;\n\n                var t = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(qvec, e2) * invDet;\n\n                if (t < epsilon || t > this._length) return;\n\n                var r0 = 1.0 - u - v;\n                var r1 = u;\n                var r2 = v;\n                var r = t * this._invLength;\n\n                var interX = v0[0] * r0 + v1[0] * r1 + v2[0] * r2;\n                var interY = v0[1] * r0 + v1[1] * r1 + v2[1] * r2;\n                var interZ = v0[2] * r0 + v1[2] * r1 + v2[2] * r2;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].cross(normal, e1, e2);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(normal, normal);\n\n                var intersection = this.initIntersection(new LineSegmentIntersection());\n                intersection._i1 = p0;\n                intersection._i2 = p1;\n                intersection._i3 = p2;\n                intersection._r1 = r0;\n                intersection._r2 = r1;\n                intersection._r3 = r2;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].set(intersection._localIntersectionPoint, interX, interY, interZ);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(intersection._localIntersectionNormal, normal);\n                intersection._ratio = r;\n\n                // http://gamedev.stackexchange.com/questions/54505/negative-scale-in-matrix-4x4\n                // https://en.wikipedia.org/wiki/Determinant#Orientation_of_a_basis\n                // you can\'t exactly extract scale of a matrix but the determinant will tell you\n                // if the orientation is preserved\n                intersection._backface = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].determinant(intersection._matrix) * det < 0;\n            };\n        })(),\n\n        operatorPoint: function(p0) {\n            if (this._threshold <= 0.0) return;\n            __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].prototype.operatorPoint.call(this, p0);\n        },\n\n        operatorLine: function(p0, p1) {\n            if (this._threshold <= 0.0) return;\n            __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].prototype.operatorLine.call(this, p0, p1);\n        }\n    }),\n    \'osgUtil\',\n    \'LineSegmentIntersectFunctor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (LineSegmentIntersectFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/LineSegmentIntersectFunctor.js\n// module id = 138\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/LineSegmentIntersectFunctor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Polytope__ = __webpack_require__(77);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Plane__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgUtil_Intersector__ = __webpack_require__(69);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgUtil_PolytopeIntersectFunctor__ = __webpack_require__(140);\n\n\n\n\n\n\n\n\n/** Concrete class for implementing polytope intersections with the scene graph.\n * To be used in conjunction with IntersectionVisitor. */\nvar PolytopeIntersector = function() {\n    __WEBPACK_IMPORTED_MODULE_4_osgUtil_Intersector__["a" /* default */].call(this);\n\n    this._index = 0;\n    // We use one for reference and other for the intersections\n    this._polytope = new __WEBPACK_IMPORTED_MODULE_2_osg_Polytope__["a" /* default */]();\n    this._iPolytope = new __WEBPACK_IMPORTED_MODULE_2_osg_Polytope__["a" /* default */]();\n    this._referencePlane = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create();\n    this._iReferencePlane = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create();\n};\n\nvar transformVec4PostMult = function(out, p, m) {\n    var x = p[0];\n    var y = p[1];\n    var z = p[2];\n    var w = p[3];\n\n    out[0] = m[0] * x + m[1] * y + m[2] * z + m[3] * w;\n    out[1] = m[4] * x + m[5] * y + m[6] * z + m[7] * w;\n    out[2] = m[8] * x + m[9] * y + m[10] * z + m[11] * w;\n    out[3] = m[12] * x + m[13] * y + m[14] * z + m[15] * w;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    PolytopeIntersector,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osgUtil_Intersector__["a" /* default */].prototype, {\n        setPolytope: function(polytope) {\n            this._polytope.setPlanes(polytope);\n            var iPlanes = [];\n            for (var i = 0; i < polytope.length; ++i) {\n                var plane = polytope[i];\n                iPlanes[i] = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].copy(this._iPolytope.getPlanes()[i] || __WEBPACK_IMPORTED_MODULE_3_osg_Plane__["a" /* default */].create(), plane);\n            }\n            this._iPolytope.setPlanes(iPlanes);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].copy(this._referencePlane, polytope[polytope.length - 1]);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].copy(this._iReferencePlane, this._referencePlane);\n        },\n\n        getPolytope: function() {\n            return this._iPolytope;\n        },\n\n        setPolytopeFromWindowCoordinates: function(xMin, yMin, xMax, yMax) {\n            // Note: last polytope value depends on the Coordinate frame\n            // Now we are only supporting WINDOW coordinate frame, so must change this if we decide to support\n            // other types of Coordinate Frame\n            this.setPolytope([\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.0, 0.0, -xMin),\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(-1.0, 0.0, 0.0, xMax),\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 1.0, 0.0, -yMin),\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, -1.0, 0.0, yMax),\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 1.0, 0.0)\n            ]);\n        },\n\n        intersectBoundingBox: function(bbox) {\n            return this._iPolytope.containsBoundingBox(bbox);\n        },\n\n        intersectBoundingSphere: function(bsphere) {\n            return this._iPolytope.containsBoundingSphere(bsphere);\n        },\n\n        intersect: (function() {\n            var functor = new __WEBPACK_IMPORTED_MODULE_5_osgUtil_PolytopeIntersectFunctor__["a" /* default */]();\n\n            return function(iv, node) {\n                functor.setGeometry(node);\n                functor.setIntersectionVisitor(iv);\n                functor.setIntersector(this);\n\n                var kdtree = node.getShape();\n                if (kdtree) {\n                    kdtree.intersect(functor, kdtree.getNodes()[0]);\n                } else {\n                    // handle rig transformed vertices\n                    if (node.computeTransformedVertices) {\n                        functor.setVertices(node.computeTransformedVertices());\n                    }\n\n                    functor.apply(node);\n                }\n                functor.reset();\n            };\n        })(),\n\n        setCurrentTransformation: function(matrix) {\n            // Transform the polytope and the referencePlane to the current Model local coordinate frame\n            var planeList = this._polytope.getPlanes();\n            var iPlaneList = this._iPolytope.getPlanes();\n            for (var i = 0, j = planeList.length; i < j; i++) {\n                var iplane = (iPlaneList[i] = iPlaneList[i] || __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create());\n                // PostMult\n                transformVec4PostMult(iplane, planeList[i], matrix);\n                // multiply the coefficients of the plane equation with a constant factor so that the equation a^2+b^2+c^2 = 1 holds.\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].scale(iplane, iplane, 1.0 / __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].len(iplane));\n            }\n\n            //Post Mult\n            transformVec4PostMult(this._iReferencePlane, this._referencePlane, matrix);\n\n            // multiply the coefficients of the plane equation with a constant factor so that the equation a^2+b^2+c^2 = 1 holds.\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].scale(\n                this._iReferencePlane,\n                this._iReferencePlane,\n                1.0 / __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].len(this._iReferencePlane)\n            );\n        }\n    }),\n    \'osgUtil\',\n    \'PolytopeIntersector\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (PolytopeIntersector);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/PolytopeIntersector.js\n// module id = 139\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/PolytopeIntersector.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Plane__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgUtil_IntersectFunctor__ = __webpack_require__(71);\n\n\n\n\n\nvar PolytopeIntersection = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osgUtil_IntersectFunctor__["a" /* default */].Intersection.call(this);\n\n    this._intersectionPoints = [];\n    this._distance = 0;\n    this._maxDistance = 0;\n    this._numIntersectionPoints = 0;\n};\n\n// Settings are needed.\nvar PolytopeIntersectFunctor = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osgUtil_IntersectFunctor__["a" /* default */].call(this);\n\n    this._src = [];\n    this._dest = [];\n    this._maxNumIntersectionsPoints = 6;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    PolytopeIntersectFunctor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osgUtil_IntersectFunctor__["a" /* default */].prototype, {\n        reset: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osgUtil_IntersectFunctor__["a" /* default */].prototype.reset.call(this);\n            this._src = [];\n            this._dest = [];\n        },\n\n        enter: function(bbox) {\n            if (this._intersector.getPolytope().containsBoundingBox(bbox)) {\n                this._intersector.getPolytope().pushCurrentMask();\n                return true;\n            }\n            return false;\n        },\n\n        leave: function() {\n            this._intersector.getPolytope().popCurrentMask();\n        },\n\n        addIntersection: function() {\n            this._src = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].arrayUniq(this._src);\n            var src = this._src;\n\n            var center = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var maxDistance = -Number.MAX_VALUE;\n            var referencePlane = this._intersector._iReferencePlane;\n            for (var i = 0; i < src.length; ++i) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(center, center, src[i]);\n                var d = __WEBPACK_IMPORTED_MODULE_2_osg_Plane__["a" /* default */].distanceToPlane(referencePlane, src[i]);\n                if (d > maxDistance) maxDistance = d;\n            }\n\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(center, center, 1.0 / src.length);\n\n            var intersection = this.initIntersection(new PolytopeIntersection());\n            intersection._distance = __WEBPACK_IMPORTED_MODULE_2_osg_Plane__["a" /* default */].distanceToPlane(referencePlane, center);\n            intersection._maxDistance = maxDistance;\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(intersection._localIntersectionPoint, center);\n\n            var maxNum = this._maxNumIntersectionsPoints;\n            intersection._numIntersectionPoints = src.length < maxNum ? src.length : maxNum;\n\n            for (i = 0; i < intersection._numIntersectionPoints; ++i) {\n                intersection._intersectionPoints.push(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].clone(this._src[i]));\n            }\n        },\n\n        contains: function() {\n            var polytope = this._intersector.getPolytope();\n            var planeList = polytope.getPlanes();\n\n            var resultMask = polytope.getCurrentMask();\n            if (!resultMask) return true;\n\n            var selectorMask = 0x1;\n\n            for (var i = 0; i < planeList.length; ++i) {\n                if (resultMask & (selectorMask === 0)) {\n                    selectorMask <<= 1;\n                    continue;\n                }\n\n                this._dest = [];\n                var plane = planeList[i];\n                var vPrevious = this._src[0];\n                var dPrevious = __WEBPACK_IMPORTED_MODULE_2_osg_Plane__["a" /* default */].distanceToPlane(plane, vPrevious);\n                for (var j = 1; j < this._src.length; ++j) {\n                    var vCurrent = this._src[j];\n                    var dCurrent = __WEBPACK_IMPORTED_MODULE_2_osg_Plane__["a" /* default */].distanceToPlane(plane, vCurrent);\n                    if (dPrevious >= 0.0) {\n                        this._dest.push(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].clone(vPrevious));\n                    }\n                    if (dPrevious * dCurrent < 0.0) {\n                        var distance = dPrevious - dCurrent;\n                        var rCurrent = dPrevious / distance;\n                        //(*v_previous)*(1.0-r_current) + (*v_current)*r_current;\n                        var vnew = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].add(\n                            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create(),\n                            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create(), vPrevious, 1.0 - rCurrent),\n                            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scale(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create(), vCurrent, rCurrent)\n                        );\n                        this._dest.push(vnew);\n                    }\n                    dPrevious = dCurrent;\n                    vPrevious = vCurrent;\n                }\n                if (dPrevious >= 0.0) {\n                    this._dest.push(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].clone(vPrevious));\n                }\n                if (this._dest.length <= 1) {\n                    return false;\n                }\n                // swap values\n                var swap = this._src.slice();\n                this._src = this._dest.slice();\n                this._dest = swap;\n            }\n\n            return true;\n        },\n\n        containsPoint: function(v0) {\n            if (this._intersector.getPolytope().containsVertex(v0)) {\n                // initialize the set of vertices to test.\n                this._src = [];\n                this._src[0] = v0;\n                return true;\n            }\n            return false;\n        },\n\n        containsLine: function(v0, v1) {\n            // initialize the set of vertices to test.\n            this._src = [];\n            this._src[0] = v0;\n            this._src[1] = v1;\n            this._src[2] = v0;\n            return this.contains();\n        },\n\n        containsTriangle: function(v0, v1, v2) {\n            // initialize the set of vertices to test.\n            this._src = [];\n            this._src[0] = v0;\n            this._src[1] = v1;\n            this._src[2] = v2;\n            this._src[3] = v0;\n            return this.contains();\n        },\n\n        intersectPoint: function(v0) {\n            if (this.containsPoint(v0)) this.addIntersection();\n        },\n\n        intersectLine: function(v0, v1) {\n            if (this.containsLine(v0, v1)) this.addIntersection();\n        },\n\n        intersectTriangle: function(v0, v1, v2) {\n            if (this.containsTriangle(v0, v1, v2)) this.addIntersection();\n        }\n    }),\n    \'osgUtil\',\n    \'PolytopeIntersectFunctor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (PolytopeIntersectFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/PolytopeIntersectFunctor.js\n// module id = 140\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/PolytopeIntersectFunctor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__ = __webpack_require__(90);\n\n\n\n\nvar CADManipulatorStandardMouseKeyboardController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this._timer = false;\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    CADManipulatorStandardMouseKeyboardController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {\n            this._rotateKey = 65; // a\n            this._zoomKey = 83; // s\n            this._panKey = 68; // d\n\n            this._mode = undefined;\n            this._buttonup = true;\n        },\n        // called to enable/disable controller\n        setEnable: function(bool) {\n            if (!bool) {\n                // reset mode if we disable it\n                this._mode = undefined;\n            }\n            __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype.setEnable.call(this, bool);\n        },\n        getMode: function() {\n            return this._mode;\n        },\n        setMode: function(mode) {\n            this._mode = mode;\n        },\n        setEventProxy: function(proxy) {\n            this._eventProxy = proxy;\n        },\n        setManipulator: function(manipulator) {\n            this._manipulator = manipulator;\n        },\n\n        mousemove: function(ev) {\n            if (this._buttonup === true) {\n                return;\n            }\n\n            var manipulator = this._manipulator;\n            var pos = manipulator.getPositionRelativeToCanvas(ev.clientX, ev.clientY);\n\n            if (isNaN(pos[0]) === false && isNaN(pos[1]) === false) {\n                var mode = this.getMode();\n                if (mode === __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Rotate) {\n                    manipulator.getRotateInterpolator().setTarget(pos[0], pos[1]);\n                } else if (mode === __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Pan) {\n                    manipulator.getPanInterpolator().setTarget(pos[0], pos[1]);\n                } else if (mode === __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Zoom) {\n                    var zoom = manipulator.getZoomInterpolator();\n                    manipulator.computeIntersections(pos);\n\n                    if (zoom.isReset()) {\n                        zoom.setStart(pos[1]);\n                        zoom.set(0.0);\n                    }\n                    var dy = pos[1] - zoom.getStart();\n                    zoom.setStart(pos[1]);\n                    var v = zoom.getTarget()[0];\n                    zoom.setTarget(v - dy / 20.0);\n                }\n            }\n\n            ev.preventDefault();\n        },\n        mousedown: function(ev) {\n            var manipulator = this._manipulator;\n            var mode = this.getMode();\n            if (mode === undefined) {\n                if (ev.button === 0) {\n                    if (ev.shiftKey) {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Pan);\n                    } else if (ev.ctrlKey) {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Zoom);\n                    } else {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Rotate);\n                    }\n                } else {\n                    this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Pan);\n                }\n            }\n\n            this.pushButton();\n\n            //var pos = this.getPositionRelativeToCanvas( ev );\n            var pos = manipulator.getPositionRelativeToCanvas(ev.clientX, ev.clientY);\n            manipulator.computeIntersections(pos);\n\n            mode = this.getMode();\n            if (mode === __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Rotate) {\n                manipulator.getRotateInterpolator().reset();\n                manipulator.getRotateInterpolator().set(pos[0], pos[1]);\n            } else if (mode === __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Pan) {\n                manipulator.getPanInterpolator().reset();\n                manipulator.getPanInterpolator().set(pos[0], pos[1]);\n            } else if (mode === __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Zoom) {\n                manipulator.getZoomInterpolator().setStart(pos[1]);\n                manipulator.getZoomInterpolator().set(0.0);\n            }\n        },\n        mouseup: function(/*ev */) {\n            this.releaseButton();\n            this.setMode(undefined);\n        },\n        mousewheel: function(ev, intDelta /*, deltaX, deltaY */) {\n            var manipulator = this._manipulator;\n            var zoomTarget = manipulator.getZoomInterpolator().getTarget()[0] - intDelta;\n            manipulator.getZoomInterpolator().setTarget(zoomTarget);\n            var timer;\n            if (this._timer === false) {\n                this._timer = true;\n                var that = this;\n                clearTimeout(timer);\n                timer = setTimeout(function() {\n                    that._timer = false;\n                }, 200);\n                //var pos = this.getPositionRelativeToCanvas( ev );\n                var pos = manipulator.getPositionRelativeToCanvas(ev.clientX, ev.clientY);\n                manipulator.computeIntersections(pos);\n            }\n        },\n\n        dblclick: function(ev) {\n            var manipulator = this._manipulator;\n            ev.preventDefault();\n\n            manipulator.getZoomInterpolator().set(0.0);\n            var zoomTarget = manipulator.getZoomInterpolator().getTarget()[0] - 10; // Default interval 10\n            manipulator.getZoomInterpolator().setTarget(zoomTarget);\n            //var pos = this.getPositionRelativeToCanvas( ev );\n            var pos = manipulator.getPositionRelativeToCanvas(ev.clientX, ev.clientY);\n            manipulator.computeIntersections(pos);\n        },\n\n        pushButton: function() {\n            this._buttonup = false;\n        },\n        releaseButton: function() {\n            this._buttonup = true;\n        },\n\n        keydown: function(ev) {\n            if (ev.keyCode === 32) {\n                this._manipulator.computeHomePosition();\n                ev.preventDefault();\n            } else if (ev.keyCode === this._panKey && this.getMode() !== __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Pan) {\n                this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Pan);\n                this._manipulator.getPanInterpolator().reset();\n                this.pushButton();\n                ev.preventDefault();\n            } else if (ev.keyCode === this._zoomKey && this.getMode() !== __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Zoom) {\n                this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Zoom);\n                this._manipulator.getZoomInterpolator().reset();\n                this.pushButton();\n                ev.preventDefault();\n            } else if (\n                ev.keyCode === this._rotateKey &&\n                this.getMode() !== __WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Rotate\n            ) {\n                this.setMode(__WEBPACK_IMPORTED_MODULE_2_osgGA_OrbitManipulator__["a" /* default */].Rotate);\n                this._manipulator.getRotateInterpolator().reset();\n                this.pushButton();\n                ev.preventDefault();\n            }\n        },\n\n        keyup: function(ev) {\n            if (ev.keyCode === this._panKey) {\n                this.mouseup(ev);\n            } else if (ev.keyCode === this._rotateKey) {\n                this.mouseup(ev);\n            } else if (ev.keyCode === this._rotateKey) {\n                this.mouseup(ev);\n            }\n            this.setMode(undefined);\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (CADManipulatorStandardMouseKeyboardController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/CADManipulatorStandardMouseKeyboardController.js\n// module id = 141\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/CADManipulatorStandardMouseKeyboardController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgGA_FirstPersonManipulatorDeviceOrientationController__ = __webpack_require__(91);\n\n\n\n\n\n\n\nvar OrbitManipulatorDeviceOrientationController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    OrbitManipulatorDeviceOrientationController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {\n            this._stepFactor = 1.0; // meaning radius*stepFactor to move\n            this._quat = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].create();\n            this._pos = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n        },\n\n        update: function(deviceOrientation, screenOrientation) {\n            // for now we use the same code in first person and orbit to compute rotation\n            __WEBPACK_IMPORTED_MODULE_3_osgGA_FirstPersonManipulatorDeviceOrientationController__["a" /* default */].computeQuaternion(\n                this._quat,\n                deviceOrientation,\n                screenOrientation\n            );\n            this._manipulator.setPoseVR(this._quat, this._pos);\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (OrbitManipulatorDeviceOrientationController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/OrbitManipulatorDeviceOrientationController.js\n// module id = 142\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/OrbitManipulatorDeviceOrientationController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\nvar OrbitManipulatorGamePadController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    OrbitManipulatorGamePadController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {\n            this._delay = 0.15;\n            this._threshold = 0.08;\n            this._padFactor = 10.0;\n            this._zoomFactor = 0.5;\n            this._rotateFactor = 5.0;\n        },\n\n        addPan: function(pan, x, y) {\n            pan.setDelay(this._delay);\n            pan.addTarget(x * this._padFactor, y * this._padFactor);\n        },\n\n        addZoom: function(zoom, z) {\n            zoom.setDelay(this._delay);\n            zoom.addTarget(z * this._zoomFactor);\n        },\n\n        addRotate: function(rotate, x, y) {\n            rotate.setDelay(this._delay);\n            //var rotateTarget = rotate.getTarget();\n            rotate.addTarget(x * this._rotateFactor, y * this._rotateFactor);\n        },\n\n        gamepadaxes: function(axes) {\n            // Block badly balanced controllers\n            var AXIS_THRESHOLD = 0.005;\n\n            //var rotateTarget, panTarget;\n            var rotate = this._manipulator.getRotateInterpolator();\n            var zoom = this._manipulator.getZoomInterpolator();\n            var pan = this._manipulator.getPanInterpolator();\n            // Regular gamepads\n            if (axes.length === 4) {\n                if (Math.abs(axes[0]) > AXIS_THRESHOLD || Math.abs(axes[1]) > AXIS_THRESHOLD) {\n                    this.addRotate(rotate, -axes[0], axes[1]);\n                }\n                if (Math.abs(axes[3]) > AXIS_THRESHOLD) {\n                    this.addZoom(zoom, -axes[3]);\n                }\n\n                //SpaceNavigator & 6-axis controllers\n            } else if (axes.length >= 5) {\n                //Notify.log(axes);\n                if (Math.abs(axes[0]) > AXIS_THRESHOLD || Math.abs(axes[1]) > AXIS_THRESHOLD) {\n                    this.addPan(pan, -axes[0], axes[1]);\n                }\n\n                if (Math.abs(axes[2]) > AXIS_THRESHOLD) {\n                    this.addZoom(zoom, -axes[2]);\n                }\n\n                if (Math.abs(axes[3]) > AXIS_THRESHOLD || Math.abs(axes[4]) > AXIS_THRESHOLD) {\n                    this.addRotate(rotate, axes[4], axes[3]);\n                }\n            }\n        },\n\n        gamepadbuttondown: function(event /*, pressed */) {\n            // Buttons 12 to 15 are the d-pad.\n            if (event.button >= 12 && event.button <= 15) {\n                var pan = this._manipulator.getPanInterpolator();\n                var panTarget = pan.getTarget();\n                var delta = {\n                    12: __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(0, -1),\n                    13: __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(0, 1),\n                    14: __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(-1, 0),\n                    15: __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(1, 0)\n                }[event.button];\n                pan.setDelay(this._delay);\n                pan.setTarget(panTarget[0] - delta[0] * 10, panTarget[1] + delta[1] * 10);\n            }\n        },\n\n        update: function(gm) {\n            if (!gm) {\n                return;\n            }\n\n            var axis = gm.axes;\n            var buttons = gm.buttons;\n\n            this.gamepadaxes(axis);\n\n            // Dummy event wrapper\n            var emptyFunc = function() {};\n            for (var i = 0; i < buttons.length; i++) {\n                if (buttons[i]) {\n                    this.gamepadbuttondown(\n                        {\n                            preventDefault: emptyFunc,\n                            gamepad: gm,\n                            button: i\n                        },\n                        !!buttons[i]\n                    );\n                }\n            }\n        }\n    })\n);\n/* harmony default export */ __webpack_exports__["a"] = (OrbitManipulatorGamePadController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/OrbitManipulatorGamePadController.js\n// module id = 143\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/OrbitManipulatorGamePadController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_math__ = __webpack_require__(41);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__ = __webpack_require__(145);\n\n\n\n\n\nvar OrbitManipulatorStandardMouseKeyboardController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    OrbitManipulatorStandardMouseKeyboardController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {\n            this._rotateKey = 65; // a\n            this._zoomKey = 83; // s\n            this._panKey = 68; // d\n\n            this._delay = 0.15;\n            this._mode = undefined;\n            this._buttonup = true;\n        },\n        // called to enable/disable controller\n        setEnable: function(bool) {\n            if (!bool) {\n                // reset mode if we disable it\n                this._mode = undefined;\n            }\n            __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype.setEnable.call(this, bool);\n        },\n        getMode: function() {\n            return this._mode;\n        },\n        setMode: function(mode) {\n            this._mode = mode;\n        },\n        setEventProxy: function(proxy) {\n            this._eventProxy = proxy;\n        },\n        setManipulator: function(manipulator) {\n            this._manipulator = manipulator;\n        },\n        mousemove: function(ev) {\n            if (this._buttonup === true) {\n                return;\n            }\n            var pos = this._eventProxy.getPositionRelativeToCanvas(ev);\n            var manipulator = this._manipulator;\n            if (__WEBPACK_IMPORTED_MODULE_2_osg_math__["a" /* default */].isNaN(pos[0]) === false && __WEBPACK_IMPORTED_MODULE_2_osg_math__["a" /* default */].isNaN(pos[1]) === false) {\n                var mode = this.getMode();\n                if (mode === __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ROTATE) {\n                    manipulator.getRotateInterpolator().setDelay(this._delay);\n                    manipulator.getRotateInterpolator().setTarget(pos[0], pos[1]);\n                } else if (mode === __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].PAN) {\n                    manipulator.getPanInterpolator().setTarget(pos[0], pos[1]);\n                } else if (mode === __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM) {\n                    var zoom = manipulator.getZoomInterpolator();\n                    if (zoom.isReset()) {\n                        zoom.setStart(pos[1]);\n                        zoom.set(0.0);\n                    }\n                    var dy = pos[1] - zoom.getStart();\n                    zoom.setStart(pos[1]);\n                    var v = zoom.getTarget()[0];\n                    zoom.setTarget(v - dy / 20.0);\n                }\n            }\n\n            ev.preventDefault();\n        },\n        mousedown: function(ev) {\n            var manipulator = this._manipulator;\n            var mode = this.getMode();\n            if (mode === undefined) {\n                if (ev.button === 0) {\n                    if (ev.shiftKey) {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].PAN);\n                    } else if (ev.ctrlKey) {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM);\n                    } else {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ROTATE);\n                    }\n                } else {\n                    // For users on Mac machines for who CTRL+LeftClick is naturally converted\n                    // into a RightClick in Firefox.\n                    if (ev.button === 2 && ev.ctrlKey) {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM);\n                    } else {\n                        this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].PAN);\n                    }\n                }\n            }\n\n            this.pushButton();\n\n            var pos = this._eventProxy.getPositionRelativeToCanvas(ev);\n            mode = this.getMode();\n            if (mode === __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ROTATE) {\n                manipulator.getRotateInterpolator().reset();\n                manipulator.getRotateInterpolator().set(pos[0], pos[1]);\n            } else if (mode === __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].PAN) {\n                manipulator.getPanInterpolator().reset();\n                manipulator.getPanInterpolator().set(pos[0], pos[1]);\n            } else if (mode === __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM) {\n                manipulator.getZoomInterpolator().setStart(pos[1]);\n                manipulator.getZoomInterpolator().set(0.0);\n            }\n        },\n        mouseup: function(/*ev */) {\n            this.releaseButton();\n            this.setMode(undefined);\n        },\n        mouseout: function(/*ev */) {\n            this.releaseButton();\n            this.setMode(undefined);\n        },\n        mousewheel: function(ev, intDelta /*, deltaX, deltaY */) {\n            var manipulator = this._manipulator;\n            var zoomTarget = manipulator.getZoomInterpolator().getTarget()[0] - intDelta;\n            manipulator.getZoomInterpolator().setTarget(zoomTarget);\n        },\n\n        pushButton: function() {\n            this._buttonup = false;\n        },\n        releaseButton: function() {\n            this._buttonup = true;\n        },\n\n        keydown: function(ev) {\n            if (ev.keyCode === 32) {\n                this._manipulator.computeHomePosition();\n                ev.preventDefault();\n            } else if (\n                ev.keyCode === this._panKey &&\n                this.getMode() !== __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].PAN\n            ) {\n                this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].PAN);\n                this._manipulator.getPanInterpolator().reset();\n                this.pushButton();\n                ev.preventDefault();\n            } else if (\n                ev.keyCode === this._zoomKey &&\n                this.getMode() !== __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM\n            ) {\n                this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM);\n                this._manipulator.getZoomInterpolator().reset();\n                this.pushButton();\n                ev.preventDefault();\n            } else if (\n                ev.keyCode === this._rotateKey &&\n                this.getMode() !== __WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ROTATE\n            ) {\n                this.setMode(__WEBPACK_IMPORTED_MODULE_3_osgGA_orbitManipulatorEnums__["a" /* default */].ROTATE);\n                this._manipulator.getRotateInterpolator().reset();\n                this.pushButton();\n                ev.preventDefault();\n            }\n        },\n\n        keyup: function(ev) {\n            if (ev.keyCode === this._panKey) {\n                this.mouseup(ev);\n            } else if (ev.keyCode === this._rotateKey) {\n                this.mouseup(ev);\n            } else if (ev.keyCode === this._rotateKey) {\n                this.mouseup(ev);\n            }\n            this.setMode(undefined);\n        }\n    })\n);\n/* harmony default export */ __webpack_exports__["a"] = (OrbitManipulatorStandardMouseKeyboardController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/OrbitManipulatorStandardMouseKeyboardController.js\n// module id = 144\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/OrbitManipulatorStandardMouseKeyboardController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony default export */ __webpack_exports__["a"] = ({\n    ROTATE: 0,\n    PAN: 1,\n    ZOOM: 2\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/orbitManipulatorEnums.js\n// module id = 145\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/orbitManipulatorEnums.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n\n\n\nvar OrbitManipulatorWebVRController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    OrbitManipulatorWebVRController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {},\n        update: function(q, position) {\n            this._manipulator.setPoseVR(q, position);\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (OrbitManipulatorWebVRController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/OrbitManipulatorWebVRController.js\n// module id = 146\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/OrbitManipulatorWebVRController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n\n\n\nvar CADManipulatorHammerController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__[\"a\" /* default */].call(this, manipulator);\n    this._timer = false;\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    CADManipulatorHammerController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__[\"a\" /* default */].prototype, {\n        init: function() {\n            this._panFactorX = 1.0;\n            this._panFactorY = -this._panFactorX;\n\n            this._rotateFactorX = 0.6;\n            this._rotateFactorY = -this._rotateFactorX;\n            this._zoomFactor = 5.0;\n\n            this._lastScale = 0;\n            this._nbPointerLast = 0; // to check if we the number of pointers has changed\n\n            this._lastPos = undefined; // to set the pivot for rotation\n            this._dragStarted = false;\n            this._transformStarted = false;\n            this._isValid = false;\n        },\n\n        // called to enable/disable controller\n        setEnable: function(bool) {\n            if (!bool) {\n                // reset mode if we disable it\n                this._dragStarted = false;\n                this._lastPos = undefined;\n                this._transformStarted = false;\n                this._nbPointerLast = 0;\n            }\n            __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__[\"a\" /* default */].prototype.setEnable.call(this, bool);\n        },\n\n        setValid: function(valid) {\n            this._isValid = valid;\n        },\n\n        setEventProxy: function(hammer) {\n            if (!hammer || hammer === this._eventProxy) {\n                return;\n            }\n\n            this._eventProxy = hammer;\n\n            // Set a minimal thresold on pinch event, to be detected after pan\n            hammer.get('pinch').set({\n                threshold: 0.1\n            });\n            // Let the pan be detected with two fingers.\n            hammer.get('pan').set({\n                threshold: 0,\n                pointers: 0\n            });\n            hammer.get('pinch').recognizeWith(hammer.get('pan'));\n\n            hammer.get('tap').set({\n                taps: 2,\n                posThreshold: 300\n            });\n\n            this._cbPanStart = this.panStart.bind(this);\n            this._cbPanMove = this.panMove.bind(this);\n            this._cbPanEnd = this.panEnd.bind(this);\n            this._cbPinchStart = this.pinchStart.bind(this);\n            this._cbPinchEnd = this.pinchEnd.bind(this);\n            this._cbPinchInOut = this.pinchInOut.bind(this);\n            this._cbDoubleTap = this.doubleTap.bind(this);\n\n            hammer.on('panstart ', this._cbPanStart);\n            hammer.on('panmove', this._cbPanMove);\n            hammer.on('panend', this._cbPanEnd);\n            hammer.on('pinchstart', this._cbPinchStart);\n            hammer.on('pinchend', this._cbPinchEnd);\n            hammer.on('pinchin pinchout', this._cbPinchInOut);\n            hammer.on('tap', this._cbDoubleTap);\n        },\n\n        _computeTouches: function(event) {\n            if (event.pointers !== undefined) return event.pointers.length;\n            return 1; // mouse\n        },\n\n        panStart: function(event) {\n            if (!this._isValid) return;\n\n            var manipulator = this._manipulator;\n            if (!manipulator || this._transformStarted || event.pointerType === 'mouse') {\n                return;\n            }\n\n            this._dragStarted = true;\n            this._nbPointerLast = this._computeTouches(event);\n\n            var pos;\n            if (this._nbPointerLast === 2) {\n                pos = manipulator.getPositionRelativeToCanvas(event.center.x, event.center.y);\n                this._lastPos = pos;\n            } else {\n                if (this._lastPos === undefined) {\n                    pos = manipulator.getCanvasCenter();\n                } else {\n                    pos = this._lastPos;\n                }\n            }\n\n            manipulator.computeIntersections(pos);\n\n            if (this._nbPointerLast === 2) {\n                var panInterpolator = manipulator.getPanInterpolator();\n                manipulator.getPanInterpolator().reset();\n                var xPan = event.center.x * this._panFactorX;\n                var yPan = event.center.y * this._panFactorY;\n                panInterpolator.set(xPan, yPan);\n            } else {\n                manipulator.getRotateInterpolator().reset();\n            }\n        },\n\n        panMove: function(event) {\n            if (!this._isValid) return;\n\n            var manipulator = this._manipulator;\n            if (!manipulator || !this._dragStarted || event.pointerType === 'mouse') {\n                return;\n            }\n\n            var nbPointers = this._computeTouches(event);\n\n            // prevent sudden big changes in the event.center variables\n            if (this._nbPointerLast !== nbPointers) {\n                if (nbPointers === 2) manipulator.getPanInterpolator().reset();\n                else manipulator.getRotateInterpolator().reset();\n                this._nbPointerLast = nbPointers;\n            }\n\n            if (nbPointers === 2) {\n                var panInterpolator = manipulator.getPanInterpolator();\n                var xPan = event.center.x * this._panFactorX;\n                var yPan = event.center.y * this._panFactorY;\n                panInterpolator.setTarget(xPan, yPan);\n            } else {\n                var rotateInterpolator = manipulator.getRotateInterpolator();\n                var xRot = event.center.x * this._rotateFactorX;\n                var yRot = event.center.y * this._rotateFactorY;\n                rotateInterpolator.setTarget(xRot, yRot);\n            }\n        },\n\n        panEnd: function(event) {\n            if (!this._isValid) return;\n\n            var manipulator = this._manipulator;\n            if (!manipulator || !this._dragStarted || event.pointerType === 'mouse') {\n                return;\n            }\n\n            this._dragStarted = false;\n        },\n\n        pinchStart: function(event) {\n            if (!this._isValid) return;\n\n            var manipulator = this._manipulator;\n            if (!manipulator || event.pointerType === 'mouse') {\n                return;\n            }\n\n            this._transformStarted = true;\n\n            this._lastScale = event.scale;\n            manipulator.getZoomInterpolator().reset();\n            manipulator.getZoomInterpolator().set(this._lastScale);\n            event.preventDefault();\n        },\n\n        pinchEnd: function(event) {\n            if (!this._isValid) return;\n\n            if (event.pointerType === 'mouse') {\n                return;\n            }\n\n            this._transformStarted = false;\n        },\n\n        pinchInOut: function(event) {\n            if (!this._isValid) return;\n\n            var manipulator = this._manipulator;\n            if (!manipulator || !this._transformStarted || event.pointerType === 'mouse') {\n                return;\n            }\n\n            // make the dezoom faster\n            var isZoomIn = event.scale > this._lastScale;\n            var zoomFactor = isZoomIn ? this._zoomFactor : this._zoomFactor * 4.0;\n            var scale = (event.scale - this._lastScale) * zoomFactor;\n            this._lastScale = event.scale;\n\n            var zoomInterpolator = manipulator.getZoomInterpolator();\n            zoomInterpolator.setTarget(zoomInterpolator.getTarget()[0] - scale);\n        },\n\n        doubleTap: function(event) {\n            if (!this._isValid) return;\n\n            var manipulator = this._manipulator;\n            if (!manipulator || event.pointerType === 'mouse') {\n                return;\n            }\n\n            var pos = manipulator.getPositionRelativeToCanvas(event.center.x, event.center.y);\n            this._lastPos = pos;\n\n            manipulator.getZoomInterpolator().set(0.0);\n            var zoomInterpolator = manipulator.getZoomInterpolator();\n            // Default interval 10\n            zoomInterpolator.setTarget(zoomInterpolator.getTarget()[0] - 10);\n        },\n\n        removeEventProxy: function(proxy) {\n            if (!proxy || !this._eventProxy) return;\n\n            proxy.off('panstart ', this._cbPanStart);\n            proxy.off('panmove', this._cbPanMove);\n            proxy.off('panend', this._cbPanEnd);\n            proxy.off('pinchstart', this._cbPinchStart);\n            proxy.off('pinchend', this._cbPinchEnd);\n            proxy.off('pinchin pinchout', this._cbPinchInOut);\n            proxy.off('tap', this._cbDoubleTap);\n        },\n\n        setManipulator: function(manipulator) {\n            this._manipulator = manipulator;\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CADManipulatorHammerController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/CADManipulatorHammerController.js\n// module id = 147\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/CADManipulatorHammerController.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_OrbitManipulatorHammerController__ = __webpack_require__(92);\n\n\n/* harmony default export */ __webpack_exports__["a"] = (__WEBPACK_IMPORTED_MODULE_0_osgGA_OrbitManipulatorHammerController__["a" /* default */]);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/FirstPersonManipulatorHammerController.js\n// module id = 148\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/FirstPersonManipulatorHammerController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n\n\n\nvar FirstPersonManipulatorWebVRController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    FirstPersonManipulatorWebVRController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {},\n        update: function(q, position) {\n            this._manipulator.setPoseVR(q, position);\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (FirstPersonManipulatorWebVRController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/FirstPersonManipulatorWebVRController.js\n// module id = 149\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/FirstPersonManipulatorWebVRController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__ = __webpack_require__(21);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n\n\n\nvar FirstPersonManipulatorStandardMouseKeyboardController = function(manipulator) {\n    __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].call(this, manipulator);\n    this.init();\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    FirstPersonManipulatorStandardMouseKeyboardController,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype, {\n        init: function() {\n            this._delay = 0.15;\n            this._stepFactor = 1.0; // meaning radius*stepFactor to move\n            this._buttonup = true;\n        },\n        // called to enable/disable controller\n        setEnable: function(bool) {\n            if (!bool) {\n                // reset mode if we disable it\n                this._buttonup = true;\n            }\n            __WEBPACK_IMPORTED_MODULE_0_osgGA_Controller__["a" /* default */].prototype.setEnable.call(this, bool);\n        },\n        setEventProxy: function(proxy) {\n            this._eventProxy = proxy;\n        },\n        setManipulator: function(manipulator) {\n            this._manipulator = manipulator;\n\n            // we always want to sync speed of controller with manipulator\n            this._manipulator.setStepFactor(this._stepFactor);\n        },\n\n        pushButton: function() {\n            this._buttonup = false;\n        },\n        releaseButton: function() {\n            this._buttonup = true;\n        },\n\n        mousedown: function(ev) {\n            var pos = this._eventProxy.getPositionRelativeToCanvas(ev);\n            var manipulator = this._manipulator;\n            manipulator.getLookPositionInterpolator().set(pos[0], pos[1]);\n            this.pushButton();\n        },\n        mouseup: function(/*ev */) {\n            this.releaseButton();\n        },\n        mouseout: function(/*ev */) {\n            this.releaseButton();\n        },\n        mousemove: function(ev) {\n            if (this._buttonup === true) {\n                return;\n            }\n\n            var pos = this._eventProxy.getPositionRelativeToCanvas(ev);\n            this._manipulator.getLookPositionInterpolator().setDelay(this._delay);\n            this._manipulator.getLookPositionInterpolator().setTarget(pos[0], pos[1]);\n\n            ev.preventDefault();\n        },\n        mousewheel: function(ev, intDelta /*, deltaX, deltaY */) {\n            this._stepFactor = Math.min(Math.max(0.001, this._stepFactor + intDelta * 0.01), 4.0);\n            this._manipulator.setStepFactor(this._stepFactor);\n        },\n\n        keydown: function(event) {\n            var manipulator = this._manipulator;\n            if (event.keyCode === 32) {\n                manipulator.computeHomePosition();\n                event.preventDefault();\n            } else if (event.keyCode === 87 || event.keyCode === 90 || event.keyCode === 38) {\n                // w/z/up\n                manipulator.getForwardInterpolator().setDelay(this._delay);\n                manipulator.getForwardInterpolator().setTarget(1);\n                event.preventDefault();\n                return false;\n            } else if (event.keyCode === 83 || event.keyCode === 40) {\n                // S/down\n                manipulator.getForwardInterpolator().setDelay(this._delay);\n                manipulator.getForwardInterpolator().setTarget(-1);\n                event.preventDefault();\n                return false;\n            } else if (event.keyCode === 68 || event.keyCode === 39) {\n                // D/right\n                manipulator.getSideInterpolator().setDelay(this._delay);\n                manipulator.getSideInterpolator().setTarget(1);\n                event.preventDefault();\n                return false;\n            } else if (event.keyCode === 65 || event.keyCode === 81 || event.keyCode === 37) {\n                // a/q/left\n                manipulator.getSideInterpolator().setDelay(this._delay);\n                manipulator.getSideInterpolator().setTarget(-1);\n                event.preventDefault();\n                return false;\n            }\n            return undefined;\n        },\n\n        keyup: function(event) {\n            var manipulator = this._manipulator;\n            if (\n                event.keyCode === 87 ||\n                event.keyCode === 90 ||\n                event.keyCode === 38 || // w/z/up\n                event.keyCode === 83 ||\n                event.keyCode === 40\n            ) {\n                // S/down\n                manipulator.getForwardInterpolator().setDelay(this._delay);\n                manipulator.getForwardInterpolator().setTarget(0);\n                return false;\n            } else if (\n                event.keyCode === 68 ||\n                event.keyCode === 39 || // D/right\n                event.keyCode === 65 ||\n                event.keyCode === 81 ||\n                event.keyCode === 37\n            ) {\n                // a/q/left\n                manipulator.getSideInterpolator().setDelay(this._delay);\n                manipulator.getSideInterpolator().setTarget(0);\n                return false;\n            }\n            return undefined;\n        }\n    })\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (FirstPersonManipulatorStandardMouseKeyboardController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/FirstPersonManipulatorStandardMouseKeyboardController.js\n// module id = 150\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/FirstPersonManipulatorStandardMouseKeyboardController.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_shape__ = __webpack_require__(36);\n\n\n/*\n * Given a Camera, update a wireframe representation of its\n * view frustum from a projection and depthrange\n * @param Geomtry g frustum geometry\n * @param Matrix proj Projection\n * @param Vec2 dR depthRange (optional, only if proj is infinite)\n */\nvar updateFrustum = function(proj, dR) {\n    var near, far;\n    if (!dR) {\n        // Get near and far from the Projection matrix.\n        near = proj[14] / (proj[10] - 1.0);\n        far = proj[14] / (1.0 + proj[10]);\n    } else {\n        near = dR[0];\n        far = dR[1];\n    }\n\n    // Get the sides of the near plane.\n    var nLeft = near * (proj[8] - 1.0) / proj[0];\n    var nRight = near * (1.0 + proj[8]) / proj[0];\n    var nTop = near * (1.0 + proj[9]) / proj[5];\n    var nBottom = near * (proj[9] - 1.0) / proj[5];\n\n    // Get the sides of the far plane.\n    var fLeft = far * (proj[8] - 1.0) / proj[0];\n    var fRight = far * (1.0 + proj[8]) / proj[0];\n    var fTop = far * (1.0 + proj[9]) / proj[5];\n    var fBottom = far * (proj[9] - 1.0) / proj[5];\n\n    var vBuff = this.getAttributes().Vertex;\n    var v = vBuff.getElements();\n\n    // eight corners of the near and far planes.\n    v[0] = nLeft;\n    v[1] = nBottom;\n    v[2] = -near;\n\n    v[3] = nRight;\n    v[4] = nBottom;\n    v[5] = -near;\n\n    v[6] = nRight;\n    v[7] = nTop;\n    v[8] = -near;\n\n    v[9] = nLeft;\n    v[10] = nTop;\n    v[11] = -near;\n\n    v[12] = fLeft;\n    v[13] = fBottom;\n    v[14] = -far;\n\n    v[15] = fRight;\n    v[16] = fBottom;\n    v[17] = -far;\n\n    v[18] = fRight;\n    v[19] = fTop;\n    v[20] = -far;\n\n    v[21] = fLeft;\n    v[22] = fTop;\n    v[23] = -far;\n\n    vBuff.dirty();\n};\n/*\n * Given a Camera, create a wireframe representation\n *  of its view frustum\n */\nvar createDebugFrustrumGeometry = function() {\n    var g = __WEBPACK_IMPORTED_MODULE_0_osg_shape__["a" /* default */].createBoundingBoxGeometry();\n    g.updateGeometry = updateFrustum;\n    return g;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    createDebugFrustumGeometry: createDebugFrustrumGeometry\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/debug.js\n// module id = 151\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/debug.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgShader_ShaderGenerator__ = __webpack_require__(56);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__ = __webpack_require__(57);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgAnimation_RigGeometry__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgAnimation_UpdateMorph__ = __webpack_require__(88);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n////////////////////////\n// COMPILER OFFSET NORMAL\n////////////////////////\nvar CompilerOffsetNormal = function() {\n    __WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */].apply(this, arguments);\n};\n\nvar configNormal = __WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */].cloneStateAttributeConfig(__WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */]);\nconfigNormal.textureAttribute = [];\n\n__WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */].setStateAttributeConfig(CompilerOffsetNormal, configNormal);\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CompilerOffsetNormal,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */].prototype, {\n        getCompilerName: function() {\n            return \'CompilerOffsetNormal\';\n        },\n        initTextureAttributes: function() {},\n        createFragmentShaderGraph: function() {\n            var frag = this.getNode(\'glFragColor\');\n\n            this.getNode(\'SetAlpha\')\n                .inputs({\n                    color: this.getOrCreateUniform(\'vec3\', \'uColorDebug\'),\n                    alpha: this.createVariable(\'float\').setValue(\'1.0\')\n                })\n                .outputs({\n                    result: frag\n                });\n\n            return [frag];\n        },\n        getOffsetDirection: function() {\n            return this.getOrCreateModelNormal();\n        },\n        getOrCreateModelVertex: function() {\n            var vertexOffset = this.getVariable(\'vertexOffset\');\n            if (vertexOffset) return vertexOffset;\n\n            vertexOffset = this.createVariable(\'vec3\', \'vertexOffset\');\n\n            var str =\n                \'%out = %offset == 1.0 ? %vertex + normalize(%direction.xyz) * %scale: %vertex;\';\n            this.getNode(\'InlineCode\')\n                .code(str)\n                .inputs({\n                    offset: this.getOrCreateAttribute(\'float\', \'Offset\'),\n                    direction: this.getOffsetDirection(),\n                    vertex: __WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */].prototype.getOrCreateModelVertex.call(this),\n                    scale: this.getOrCreateUniform(\'float\', \'uScale\')\n                })\n                .outputs({\n                    out: vertexOffset\n                });\n\n            return vertexOffset;\n        },\n        getOrCreateViewVertex: function() {\n            var out = this._variables.FragEyeVector;\n            if (out && !out.isEmpty()) return out;\n            out = this._varyings.FragEyeVector || this.createVariable(\'vec4\', \'FragEyeVector\');\n\n            this.getNode(\'MatrixMultPosition\')\n                .inputs({\n                    matrix: this.getOrCreateUniform(\'mat4\', \'uViewMatrix\'),\n                    vec: this.getOrCreateModelVertex()\n                })\n                .outputs({\n                    vec: out\n                });\n\n            return out;\n        }\n    }),\n    \'osgUtil\',\n    \'CompilerOffsetNormal\'\n);\n\nvar ShaderGeneratorCompilerOffsetNormal = function() {\n    __WEBPACK_IMPORTED_MODULE_10_osgShader_ShaderGenerator__["a" /* default */].apply(this, arguments);\n    this.setShaderCompiler(CompilerOffsetNormal);\n};\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    ShaderGeneratorCompilerOffsetNormal,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_10_osgShader_ShaderGenerator__["a" /* default */].prototype, {}),\n    \'osgUtil\',\n    \'ShaderGeneratorCompilerOffsetNormal\'\n);\n\n////////////////////////\n// COMPILER OFFSET TANGENT\n////////////////////////\nvar CompilerOffsetTangent = function() {\n    CompilerOffsetNormal.apply(this, arguments);\n};\n\nvar configTangent = configNormal;\n__WEBPACK_IMPORTED_MODULE_11_osgShader_Compiler__["a" /* default */].setStateAttributeConfig(CompilerOffsetTangent, configTangent);\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CompilerOffsetTangent,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(CompilerOffsetNormal.prototype, {\n        getCompilerName: function() {\n            return \'CompilerOffsetTangent\';\n        },\n        getOffsetDirection: function() {\n            return this.getOrCreateModelTangent();\n        }\n    }),\n    \'osgUtil\',\n    \'CompilerOffsetTangent\'\n);\n\nvar ShaderGeneratorCompilerOffsetTangent = function() {\n    __WEBPACK_IMPORTED_MODULE_10_osgShader_ShaderGenerator__["a" /* default */].apply(this, arguments);\n    this.setShaderCompiler(CompilerOffsetTangent);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    ShaderGeneratorCompilerOffsetTangent,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_10_osgShader_ShaderGenerator__["a" /* default */].prototype, {}),\n    \'osgUtil\',\n    \'ShaderGeneratorCompilerOffsetTangent\'\n);\n\n////////////////////////\n// DISPLAY NORMAL VISITOR\n////////////////////////\n\nvar DisplayNormalVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this);\n\n    this._unifScale = __WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createFloat(1.0, \'uScale\');\n\n    var ns = (this._normalStateSet = new __WEBPACK_IMPORTED_MODULE_6_osg_StateSet__["a" /* default */]());\n    ns.addUniform(__WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createFloat3(__WEBPACK_IMPORTED_MODULE_9_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0), \'uColorDebug\'));\n    ns.addUniform(this._unifScale);\n    ns.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */].NEVER));\n    ns.setShaderGeneratorName(\'debugNormal\');\n\n    var ts = (this._tangentStateSet = new __WEBPACK_IMPORTED_MODULE_6_osg_StateSet__["a" /* default */]());\n    ts.addUniform(__WEBPACK_IMPORTED_MODULE_7_osg_Uniform__["a" /* default */].createFloat3(__WEBPACK_IMPORTED_MODULE_9_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0), \'uColorDebug\'));\n    ts.addUniform(this._unifScale);\n    ts.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */].NEVER));\n    ts.setShaderGeneratorName(\'debugTangent\');\n};\n\nDisplayNormalVisitor.CompilerOffsetNormal = CompilerOffsetNormal;\nDisplayNormalVisitor.CompilerOffsetTangent = CompilerOffsetTangent;\nDisplayNormalVisitor.ShaderGeneratorCompilerOffsetNormal = ShaderGeneratorCompilerOffsetNormal;\nDisplayNormalVisitor.ShaderGeneratorCompilerOffsetTangent = ShaderGeneratorCompilerOffsetTangent;\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    DisplayNormalVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        setScale: function(scale) {\n            this._unifScale.setFloat(scale);\n        },\n        setTangentVisibility: function(bool) {\n            this._tangentStateSet.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */](bool ? __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */].LESS : __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */].NEVER));\n        },\n        setNormalVisibility: function(bool) {\n            this._normalStateSet.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */](bool ? __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */].LESS : __WEBPACK_IMPORTED_MODULE_8_osg_Depth__["a" /* default */].NEVER));\n        },\n        apply: function(node) {\n            if (node._isVisitedNormalDebug) return;\n            node._isVisitedNormalDebug = true;\n\n            if (node instanceof __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]) {\n                this._createDebugGeom(node, \'Normal\', this._normalStateSet);\n                this._createDebugGeom(node, \'Tangent\', this._tangentStateSet);\n                return;\n            }\n\n            this.traverse(node);\n\n            var list = node.getUpdateCallbackList();\n            // reference the new morph geometry on the UpdateMorph callbacks\n            for (var i = 0, nbCB = list.length; i < nbCB; ++i) {\n                if (list[i] instanceof __WEBPACK_IMPORTED_MODULE_14_osgAnimation_UpdateMorph__["a" /* default */]) {\n                    list[i].init(node);\n                }\n            }\n        },\n        _createDoubleOffsetArray: function(nbVertices) {\n            // 0 means original vertex pos\n            // 1 means offseted vertex\n            var elts = new Float32Array(nbVertices * 2);\n            for (var i = 0; i < nbVertices; ++i) {\n                elts[i * 2] = 1.0;\n            }\n            return new __WEBPACK_IMPORTED_MODULE_3_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, elts, 1);\n        },\n        _createDoubledBufferArray: function(bufferArray) {\n            // in case of morphs\n            if (bufferArray.getInitialBufferArray)\n                bufferArray = bufferArray.getInitialBufferArray();\n\n            var itemSize = bufferArray.getItemSize();\n            var elements = bufferArray.getElements();\n            var nbElements = elements.length / itemSize;\n\n            var ctor = elements.constructor;\n            var elementsDouble = new ctor(elements.length * 2);\n            for (var i = 0; i < nbElements; ++i) {\n                var iSize = i * itemSize;\n                var iSize2 = iSize * 2;\n\n                for (var j = 0; j < itemSize; ++j) {\n                    elementsDouble[iSize2 + j] = elementsDouble[iSize2 + j + itemSize] =\n                        elements[iSize + j];\n                }\n            }\n\n            return new __WEBPACK_IMPORTED_MODULE_3_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, elementsDouble, itemSize);\n        },\n        _addMorphTargets: function(originMorph, morph, vecName) {\n            var targets = morph.getMorphTargets();\n            morph.setName(originMorph.getName()); // for the UpdateMorph\n\n            var originTargets = originMorph.getMorphTargets();\n            for (var i = 0, nbTarget = originTargets.length; i < nbTarget; ++i) {\n                var origTarget = originTargets[i];\n                var origAttrs = origTarget.getVertexAttributeList();\n\n                var newTarget = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n                newTarget.setName(origTarget.getName()); // for the UpdateMorph\n                var newAttrs = newTarget.getVertexAttributeList();\n\n                newAttrs.Vertex = this._createDoubledBufferArray(origAttrs.Vertex);\n                if (origAttrs[vecName])\n                    newAttrs[vecName] = this._createDoubledBufferArray(origAttrs[vecName]);\n\n                targets.push(newTarget);\n            }\n\n            morph.mergeChildrenVertexAttributeList();\n            return morph;\n        },\n        _createDebugGeom: function(node, vecName, stateSet) {\n            var attrs = node.getAttributes();\n            var dispVec = attrs[vecName];\n            if (!dispVec) return;\n\n            var vertices = attrs.Vertex;\n            if (!vertices) return;\n\n            var originMorph;\n            if (node instanceof __WEBPACK_IMPORTED_MODULE_13_osgAnimation_MorphGeometry__["a" /* default */]) originMorph = node;\n            else if (node.getSourceGeometry && node.getSourceGeometry() instanceof __WEBPACK_IMPORTED_MODULE_13_osgAnimation_MorphGeometry__["a" /* default */])\n                originMorph = node.getSourceGeometry();\n\n            var nbVertices = vertices.getElements().length / vertices.getItemSize();\n\n            // vertex and normals\n            var source = originMorph ? new __WEBPACK_IMPORTED_MODULE_13_osgAnimation_MorphGeometry__["a" /* default */]() : new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n            source.getAttributes().Vertex = this._createDoubledBufferArray(vertices);\n            source.getAttributes().Offset = this._createDoubleOffsetArray(nbVertices);\n            source.getAttributes()[vecName] = this._createDoubledBufferArray(dispVec);\n\n            // primitive\n            source.getPrimitives().push(new __WEBPACK_IMPORTED_MODULE_4_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_5_osg_primitiveSet__["a" /* default */].LINES, 0, nbVertices * 2));\n\n            if (originMorph) this._addMorphTargets(originMorph, source, vecName);\n\n            var geom;\n            if (node instanceof __WEBPACK_IMPORTED_MODULE_12_osgAnimation_RigGeometry__["a" /* default */]) {\n                var rig = new __WEBPACK_IMPORTED_MODULE_12_osgAnimation_RigGeometry__["a" /* default */]();\n                rig.setSourceGeometry(source);\n\n                rig.getVertexAttributeList().Bones = this._createDoubledBufferArray(attrs.Bones);\n                rig.getVertexAttributeList().Weights = this._createDoubledBufferArray(\n                    attrs.Weights\n                );\n\n                // we can simply share the rig-animated stateSet attributes\n                // (unlike morph, the stateSet and update animation doesn\'t operate at per vertex level)\n                rig._rigTransformImplementation = node._rigTransformImplementation;\n                rig._stateSetAnimation = node._stateSetAnimation;\n\n                rig.mergeChildrenData();\n                geom = rig;\n            } else {\n                geom = source;\n            }\n\n            // add geom to the graph\n            var parents = node.getParents();\n            var nbParents = parents.length;\n            geom._isVisitedNormalDebug = true;\n            geom._isNormalDebug = true;\n            geom.setStateSet(stateSet);\n            for (var i = 0; i < nbParents; ++i) parents[i].addChild(geom);\n\n            return geom;\n        }\n    }),\n    \'osgUtil\',\n    \'DisplayNormalVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (DisplayNormalVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/DisplayNormalVisitor.js\n// module id = 152\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/DisplayNormalVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_node_data__ = __webpack_require__(229);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_node_operations__ = __webpack_require__(231);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShader_utils__ = __webpack_require__(93);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__ = __webpack_require__(118);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShadow_shaderLib__ = __webpack_require__(119);\n\n\n\n\n\n\n\nvar Factory = function() {\n    this._nodes = new window.Map();\n\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'lights.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'lightCommon.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'skinning.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'morphing.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'billboard.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'functions.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_4_osgShader_shaderLib__["a" /* default */], \'textures.glsl\');\n\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_5_osgShadow_shaderLib__["a" /* default */], \'shadowCast.glsl\');\n    this.extractFunctions(__WEBPACK_IMPORTED_MODULE_5_osgShadow_shaderLib__["a" /* default */], \'shadowReceive.glsl\');\n\n    this.registerNodes(__WEBPACK_IMPORTED_MODULE_1_osgShader_node_data__["a" /* default */]);\n    this.registerNodes(__WEBPACK_IMPORTED_MODULE_2_osgShader_node_operations__["a" /* default */]);\n};\n\nFactory.prototype = {\n    registerNodes: function(obj) {\n        for (var key in obj) {\n            this.registerNode(key, obj[key]);\n        }\n    },\n\n    registerNode: function(name, constructor) {\n        if (this._nodes.has(name)) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'Node \' + name + \' already registered\');\n        }\n        this._nodes.set(name, constructor);\n    },\n\n    extractFunctions: function(lib, filename) {\n        this.registerNodes(__WEBPACK_IMPORTED_MODULE_3_osgShader_utils__["a" /* default */].extractFunctions(lib, filename));\n    },\n\n    // extra argument are passed to the constructor of the node\n    getNode: function(name) {\n        var Constructor = this._nodes.get(name);\n        if (!Constructor) {\n            // Means either:\n            // - the node isn\'t registered by methods above\n            // - you mistyped the name\n            // - Core Node has changed its Name\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'Node \' + name + \' does not exist\');\n            return undefined;\n        }\n\n        // call a constructor with array arguments\n        // http://www.ecma-international.org/ecma-262/5.1/#sec-13.2.2\n        var instance = window.Object.create(Constructor.prototype);\n        Constructor.apply(instance, Array.prototype.slice.call(arguments, 1));\n\n        return instance;\n    }\n};\n\nvar instance = new Factory();\n\n/* harmony default export */ __webpack_exports__["a"] = (instance);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/nodeFactory.js\n// module id = 153\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/nodeFactory.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShader_ShaderGenerator__ = __webpack_require__(56);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShadow_ShadowCastCompiler__ = __webpack_require__(155);\n\n\n\nvar ShaderGeneratorShadowCast = function() {\n    __WEBPACK_IMPORTED_MODULE_0_osgShader_ShaderGenerator__["a" /* default */].apply(this, arguments);\n    this.setShaderCompiler(__WEBPACK_IMPORTED_MODULE_1_osgShadow_ShadowCastCompiler__["a" /* default */]);\n};\n\nShaderGeneratorShadowCast.prototype = __WEBPACK_IMPORTED_MODULE_0_osgShader_ShaderGenerator__["a" /* default */].prototype;\n\n/* harmony default export */ __webpack_exports__["a"] = (ShaderGeneratorShadowCast);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowCastShaderGenerator.js\n// module id = 154\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowCastShaderGenerator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_Compiler__ = __webpack_require__(57);\n\n\n\nvar CompilerShadowCast = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osgShader_Compiler__[\"a\" /* default */].apply(this, arguments);\n};\n\nvar config = __WEBPACK_IMPORTED_MODULE_1_osgShader_Compiler__[\"a\" /* default */].cloneStateAttributeConfig(__WEBPACK_IMPORTED_MODULE_1_osgShader_Compiler__[\"a\" /* default */]);\nconfig.attribute = ['ShadowCast', 'Morph', 'Skinning', 'PointSize'];\n\n__WEBPACK_IMPORTED_MODULE_1_osgShader_Compiler__[\"a\" /* default */].setStateAttributeConfig(CompilerShadowCast, config);\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    CompilerShadowCast,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osgShader_Compiler__[\"a\" /* default */].prototype, {\n        getCompilerName: function() {\n            return 'ShadowCast';\n        },\n\n        initAttributes: function() {\n            var attributes = this._attributes;\n\n            for (var i = 0, l = attributes.length; i < l; i++) {\n                var type = attributes[i].className();\n\n                if (type === 'ShadowCastAttribute') {\n                    this._shadowCastAttribute = attributes[i];\n                } else if (type === 'Billboard') {\n                    this._isBillboard = !!attributes[i];\n                } else if (type === 'SkinningAttribute') {\n                    this._skinningAttribute = attributes[i];\n                } else if (type === 'MorphAttribute') {\n                    this._morphAttribute = attributes[i];\n                } else if (type === 'PointSizeAttribute') {\n                    this._pointSizeAttribute = attributes[i];\n                }\n            }\n        },\n\n        registerTextureAttributes: function() {},\n\n        // Depth Shadow Map Casted from Light POV Depth encoded in color buffer\n        createShadowCastDepth: function(out) {\n            var defines = this._shadowCastAttribute.getDefines();\n\n            var node = this.getNode('ShadowCast')\n                .inputs({\n                    shadowDepthRange: this.getOrCreateUniform('vec4', 'uShadowDepthRange'),\n                    fragEye: this.getOrCreateViewVertex()\n                })\n                .outputs({ result: out });\n\n            node.getDefines = function() {\n                return defines;\n            };\n\n            return out;\n        },\n\n        // encapsulate for easier overwrite by user defined compiler\n        // that would inherint from this compiler Do not merge with above method\n        createFragmentShaderGraph: function() {\n            var frag = this.getNode('glFragColor');\n            return [this.createShadowCastDepth(frag)];\n        }\n    }),\n    'osgShader',\n    'CompilerShadowCast'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CompilerShadowCast);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowCastCompiler.js\n// module id = 155\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowCastCompiler.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_RigGeometry__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgShader_ShaderGenerator__ = __webpack_require__(56);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__ = __webpack_require__(57);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_Depth__ = __webpack_require__(32);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n////////////////////////\n// COMPILER DEBUG GEOMETRY\n////////////////////////\nvar CompilerColorGeometry = function() {\n    __WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].apply(this, arguments);\n};\n\nvar configColor = __WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].cloneStateAttributeConfig(__WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */]);\nconfigColor.textureAttribute = [];\nconfigColor.attribute = [\'PointSize\', \'Morph\', \'Skinning\'];\n\n__WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].setStateAttributeConfig(CompilerColorGeometry, configColor);\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CompilerColorGeometry,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].prototype, {\n        getCompilerName: function() {\n            return \'CompilerDebugGeometry\';\n        },\n        initTextureAttributes: function() {},\n        createFragmentShaderGraph: function() {\n            var frag = this.getNode(\'glFragColor\');\n\n            this.getNode(\'SetAlpha\')\n                .inputs({\n                    color: this.getOrCreateUniform(\'vec3\', \'uColorDebug\'),\n                    alpha: this.createVariable(\'float\').setValue(\'1.0\')\n                })\n                .outputs({\n                    result: frag\n                });\n\n            return [frag];\n        }\n    }),\n    \'osgUtil\',\n    \'CompilerColorGeometry\'\n);\n\nvar ShaderGeneratorCompilerColorGeometry = function() {\n    __WEBPACK_IMPORTED_MODULE_7_osgShader_ShaderGenerator__["a" /* default */].apply(this, arguments);\n    this.setShaderCompiler(CompilerColorGeometry);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    ShaderGeneratorCompilerColorGeometry,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_7_osgShader_ShaderGenerator__["a" /* default */].prototype, {}),\n    \'osgUtil\',\n    \'ShaderGeneratorCompilerColorGeometry\'\n);\n\n////////////////////////\n// COMPILER SKINNING DEBUG\n////////////////////////\nvar CompilerColorSkinning = function() {\n    __WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].apply(this, arguments);\n};\n\nvar configSkinning = __WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].cloneStateAttributeConfig(__WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */]);\nconfigSkinning.textureAttribute = [];\n\n__WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].setStateAttributeConfig(CompilerColorSkinning, configSkinning);\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CompilerColorSkinning,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].prototype, {\n        getCompilerName: function() {\n            return \'CompilerDebugSkinning\';\n        },\n        initTextureAttributes: function() {},\n        createFragmentShaderGraph: function() {\n            var frag = this.getNode(\'glFragColor\');\n\n            this.getNode(\'SetAlpha\')\n                .inputs({\n                    color: this.getOrCreateVarying(\'vec3\', \'vBonesColor\'),\n                    alpha: this.createVariable(\'float\').setValue(\'1.0\')\n                })\n                .outputs({\n                    result: frag\n                });\n\n            return [frag];\n        },\n        declareVertexVaryings: function(roots) {\n            var color = this.getOrCreateVarying(\'vec3\', \'vBonesColor\');\n            this.getNode(\'SetFromNode\')\n                .inputs(this.getOrCreateAttribute(\'vec3\', \'BonesColor\'))\n                .outputs(color);\n            return __WEBPACK_IMPORTED_MODULE_8_osgShader_Compiler__["a" /* default */].prototype.declareVertexVaryings.call(this, roots);\n        }\n    }),\n    \'osgUtil\',\n    \'CompilerColorSkinning\'\n);\n\nvar ShaderGeneratorCompilerColorSkinning = function() {\n    __WEBPACK_IMPORTED_MODULE_7_osgShader_ShaderGenerator__["a" /* default */].apply(this, arguments);\n    this.setShaderCompiler(CompilerColorSkinning);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    ShaderGeneratorCompilerColorSkinning,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_7_osgShader_ShaderGenerator__["a" /* default */].prototype, {}),\n    \'osgUtil\',\n    \'ShaderGeneratorCompilerColorSkinning\'\n);\n\n///////////////////////////\n// DISPLAY GEOMETRY VISITOR\n///////////////////////////\n\nvar GeometryColorDebugVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this);\n    this._debugColor = true;\n    this._debugSkinning = false;\n\n    this._stCenter = new __WEBPACK_IMPORTED_MODULE_5_osg_StateSet__["a" /* default */](); // state set of center crosses\n    this._stCenter.setShaderGeneratorName(\'debugGeometry\');\n};\n\nGeometryColorDebugVisitor.CompilerColorGeometry = CompilerColorGeometry;\nGeometryColorDebugVisitor.ShaderGeneratorCompilerColorGeometry = ShaderGeneratorCompilerColorGeometry;\n\nGeometryColorDebugVisitor.CompilerSkinningGeometry = CompilerColorSkinning;\nGeometryColorDebugVisitor.ShaderGeneratorCompilerColorSkinning = ShaderGeneratorCompilerColorSkinning;\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    GeometryColorDebugVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        setGeometryDebug: function(node) {\n            this._stCenter.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_13_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_13_osg_Depth__["a" /* default */].ALWAYS));\n            this._debugColor = true;\n            this._debugSkinning = false;\n            this.apply(node);\n        },\n\n        setSkinningDebug: function(node) {\n            this._stCenter.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_13_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_13_osg_Depth__["a" /* default */].NEVER));\n            this._debugColor = false;\n            this._debugSkinning = true;\n            this.apply(node);\n        },\n\n        disableDebug: function(node) {\n            this._stCenter.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_13_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_13_osg_Depth__["a" /* default */].NEVER));\n            this._debugColor = false;\n            this._debugSkinning = false;\n            this.apply(node);\n        },\n\n        _debugCenterGeometry: function(node, color) {\n            // draw cross with slightly different color than the geometry\n            var bb = node.getBound();\n\n            var verts = new Float32Array(18);\n            var off = bb.radius() * 0.1;\n            verts[0] = off;\n            verts[3] = -off;\n\n            verts[7] = off;\n            verts[10] = -off;\n\n            verts[14] = off;\n            verts[17] = -off;\n\n            var geo = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n            geo.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_9_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_9_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, verts, 3);\n            var primitive = new __WEBPACK_IMPORTED_MODULE_10_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_11_osg_primitiveSet__["a" /* default */].LINES, 0, 6);\n            geo.getPrimitives().push(primitive);\n\n            var mt = new __WEBPACK_IMPORTED_MODULE_12_osg_MatrixTransform__["a" /* default */]();\n            var center = bb.center();\n            mt.getMatrix()[12] = center[0];\n            mt.getMatrix()[13] = center[1];\n            mt.getMatrix()[14] = center[2];\n\n            mt.addChild(geo);\n            this.nodePath[this.nodePath.length - 2].addChild(mt);\n            color = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(color[0] * 0.8, color[1] * 0.8, color[2] * 0.8);\n            geo.getOrCreateStateSet().addUniform(__WEBPACK_IMPORTED_MODULE_4_osg_Uniform__["a" /* default */].createFloat3(color, \'uColorDebug\'));\n            mt.setStateSet(this._stCenter);\n\n            mt._isCenterDebug = true;\n        },\n\n        _debugRigGeometry: function(node) {\n            // a bone can be shared between several rigs so we use the instanceID to get unique color\n            var vList = node.getVertexAttributeList();\n            if (vList.BonesColor) return;\n\n            var eltBones = vList.Bones.getElements();\n            var eltWeights = vList.Weights.getElements();\n\n            var bones = node._rigTransformImplementation._bones;\n            var nbBones = eltBones.length / 4;\n\n            var bonesColor = new Float32Array(nbBones * 3);\n\n            for (var i = 0; i < nbBones; ++i) {\n                var idb = i * 4;\n                var c0 = bones[eltBones[idb]].getOrCreateDebugColor();\n                var c1 = bones[eltBones[idb + 1]].getOrCreateDebugColor();\n                var c2 = bones[eltBones[idb + 2]].getOrCreateDebugColor();\n                var c3 = bones[eltBones[idb + 3]].getOrCreateDebugColor();\n\n                var w0 = eltWeights[idb];\n                var w1 = eltWeights[idb + 1];\n                var w2 = eltWeights[idb + 2];\n                var w3 = eltWeights[idb + 3];\n\n                var idc = i * 3;\n                bonesColor[idc] = w0 * c0[0] + w1 * c1[0] + w2 * c2[0] + w3 * c3[0];\n                bonesColor[idc + 1] = w0 * c0[1] + w1 * c1[1] + w2 * c2[1] + w3 * c3[1];\n                bonesColor[idc + 2] = w0 * c0[2] + w1 * c1[2] + w2 * c2[2] + w3 * c3[2];\n            }\n\n            vList.BonesColor = new __WEBPACK_IMPORTED_MODULE_9_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_9_osg_BufferArray__["a" /* default */].ARRAY_BUFFER, bonesColor, 3);\n        },\n\n        _debugGeometry: function(node) {\n            var debugColor = this._debugColor;\n            var debugSkinning = this._debugSkinning && node instanceof __WEBPACK_IMPORTED_MODULE_3_osgAnimation_RigGeometry__["a" /* default */];\n\n            if (!debugColor && !debugSkinning) {\n                if (node._originalStateSet !== undefined) {\n                    node.setStateSet(node._originalStateSet || undefined);\n                }\n                return;\n            }\n\n            if (node._originalStateSet === undefined) {\n                node._originalStateSet = node.getStateSet() || null;\n            }\n\n            var stateSet = new __WEBPACK_IMPORTED_MODULE_5_osg_StateSet__["a" /* default */]();\n            node.setStateSet(stateSet);\n\n            if (debugSkinning) {\n                stateSet.setShaderGeneratorName(\'debugSkinning\');\n                this._debugRigGeometry(node);\n                return;\n            }\n\n            // debug color\n            var color = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(Math.random(), Math.random(), Math.random());\n            stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_4_osg_Uniform__["a" /* default */].createFloat3(color, \'uColorDebug\'));\n            stateSet.setShaderGeneratorName(\'debugGeometry\');\n\n            this._debugCenterGeometry(node, color);\n        },\n\n        apply: function(node) {\n            if (node._isNormalDebug || node._isCenterDebug) return;\n\n            if (node instanceof __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]) {\n                this._debugGeometry(node);\n            }\n\n            this.traverse(node);\n        }\n    }),\n    \'osgUtil\',\n    \'GeometryColorDebugVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (GeometryColorDebugVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/DisplayGeometryVisitor.js\n// module id = 156\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/DisplayGeometryVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n\n\n\n\nvar DisplayGraphNode = function(selectables) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__[\"a\" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__[\"a\" /* default */].TRAVERSE_ALL_CHILDREN);\n\n    this._selectables = selectables;\n    this._nodeList = [];\n    this._linkList = [];\n\n    // don't reference twice same node\n    this._uniqueNodes = new window.Set();\n    this._uniqueEdges = new window.Set();\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    DisplayGraphNode,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__[\"a\" /* default */].prototype, {\n        getColorFromClassName: function(name) {\n            switch (name) {\n                case 'ShadowedScene':\n                    return '#3D3D3D';\n                case 'Camera':\n                    return '#AB7BCF';\n                case 'RenderBin':\n                    return '#59778B';\n                case 'LightSource':\n                    return '#53967D';\n                case 'RenderStage':\n                    return '#DDCC55';\n                case 'RenderLeaf':\n                case 'Geometry':\n                    return '#FFCC55';\n                case 'RigGeometry':\n                    return '#DD8800';\n                case 'MorphGeometry':\n                    return '#AA5500';\n                case 'MatrixTransform':\n                    return '#CE697E';\n                case 'StateSet':\n                    return '#0099FF';\n                case 'StateGraph':\n                case 'Skeleton':\n                    return '#96999E';\n                case 'Bone':\n                    return '#A9DEAA';\n                case 'Node':\n                    return '#FFFFFF';\n                default:\n                    return '#FF00AA';\n            }\n        },\n\n        createGraph: function(root) {\n            this.reset();\n            root.accept(this);\n        },\n\n        reset: function() {\n            this._nodeList.length = 0;\n            this._linkList.length = 0;\n            this._uniqueNodes.clear();\n            this._uniqueEdges.clear();\n        },\n\n        apply: function(node) {\n            if (node._isNormalDebug) return;\n\n            if (!this._uniqueNodes.has(node.getInstanceID())) {\n                this._uniqueNodes.add(node.getInstanceID());\n                this._nodeList.push(node);\n            }\n\n            if (this.nodePath.length >= 2) {\n                var parentID = this.nodePath[this.nodePath.length - 2].getInstanceID();\n                var childID = node.getInstanceID();\n                var key = parentID + '+' + childID;\n                if (!this._uniqueEdges.has(key)) {\n                    this._linkList.push({\n                        parentNode: parentID,\n                        childrenNode: childID\n                    });\n                    this._uniqueEdges.add(key);\n                }\n            }\n\n            this.traverse(node);\n        },\n\n        // Create an array to display the matrix\n        createMatrixGrid: function(node, matrixArray) {\n            var nodeMatrix = '';\n\n            nodeMatrix += '<table><tr><td>' + matrixArray[0] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[4] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[8] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[12] + '</td></tr>';\n\n            nodeMatrix += '<tr><td>' + matrixArray[1] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[5] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[9] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[13] + '</td></tr>';\n\n            nodeMatrix += '<tr><td>' + matrixArray[2] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[6] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[10] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[14] + '</td></tr>';\n\n            nodeMatrix += '<tr><td>' + matrixArray[3] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[7] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[11] + '</td>';\n            nodeMatrix += '<td>' + matrixArray[15] + '</td></tr></table>';\n\n            return nodeMatrix;\n        },\n\n        getLabel: function(obj) {\n            var label = obj.className() + ' (' + obj.getInstanceID() + ')';\n            if (obj.getName && obj.getName()) label += '\\n' + obj.getName();\n            return label;\n        },\n\n        generateNode: function(g, node) {\n            var description = '';\n            if (node.getMatrix && node.getMatrix()) {\n                description += '<br /><br />' + this.createMatrixGrid(node, node.getMatrix());\n            }\n\n            this._selectables.set(node.getInstanceID().toString(), node);\n            g.addNode(node.getInstanceID(), {\n                label: this.getLabel(node),\n                description: description,\n                style:\n                    'fill: ' + this.getColorFromClassName(node.className()) + ';stroke-width: 0px;'\n            });\n        },\n\n        generateStateSet: function(g, node) {\n            var stateSet = node.getStateSet();\n            var stateSetID = stateSet.getInstanceID();\n\n            var label = this.getLabel(stateSet);\n            label += '\\nNbTexture : ' + stateSet.getNumTextureAttributeLists();\n\n            if (!g.hasNode(stateSetID)) {\n                this._selectables.set(stateSetID.toString(), stateSet);\n                g.addNode(stateSetID, {\n                    label: label,\n                    style:\n                        'fill: ' +\n                        this.getColorFromClassName(stateSet.className()) +\n                        ';stroke-width: 0px;'\n                });\n            }\n\n            g.addEdge(null, node.getInstanceID(), stateSetID, {\n                style: 'stroke: ' + this.getColorFromClassName(stateSet.className()) + ';'\n            });\n        },\n\n        generateSourceGeometry: function(g, node) {\n            var sourceGeom = node.getSourceGeometry();\n            var sourceGeomID = sourceGeom.getInstanceID();\n\n            this._selectables.set(sourceGeomID.toString(), sourceGeom);\n            g.addNode(sourceGeomID, {\n                label: this.getLabel(sourceGeom),\n                style:\n                    'fill: ' +\n                    this.getColorFromClassName(sourceGeom.className()) +\n                    ';stroke-width: 0px;'\n            });\n\n            g.addEdge(null, node.getInstanceID(), sourceGeomID, {\n                style: 'stroke: ' + this.getColorFromClassName(sourceGeom.className()) + ';'\n            });\n        },\n\n        // Subfunction of createGraph, will iterate to create all the node and link in dagre\n        generateNodeAndLink: function(g) {\n            for (var i = 0, ni = this._nodeList.length; i < ni; i++) {\n                var node = this._nodeList[i];\n\n                // node\n                this.generateNode(g, node);\n\n                // adds statesets node\n                if (node.getStateSet()) {\n                    this.generateStateSet(g, node);\n                }\n\n                // adds source geometry node\n                if (node.getSourceGeometry && node.getSourceGeometry() instanceof __WEBPACK_IMPORTED_MODULE_2_osgAnimation_MorphGeometry__[\"a\" /* default */]) {\n                    this.generateSourceGeometry(g, node);\n                }\n            }\n\n            for (var j = 0, nj = this._linkList.length; j < nj; j++) {\n                g.addEdge(null, this._linkList[j].parentNode, this._linkList[j].childrenNode);\n            }\n        }\n    }),\n    'osgUtil',\n    'DisplayGraphNode'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DisplayGraphNode);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/DisplayGraphNode.js\n// module id = 157\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/DisplayGraphNode.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_DatabasePager__ = __webpack_require__(133);\n\n\n\n\nvar Scene = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n    this._databasePager = new __WEBPACK_IMPORTED_MODULE_2_osgDB_DatabasePager__["a" /* default */]();\n    this._sceneData = undefined;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    Scene,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        getSceneData: function() {\n            return this._sceneData;\n        },\n\n        setSceneData: function(node) {\n            this._sceneData = node;\n        },\n\n        setDatabasePager: function(dbpager) {\n            this._databasePager = dbpager;\n        },\n\n        getDatabasePager: function() {\n            return this._databasePager;\n        },\n\n        // database pager are not implemented yet here\n        updateSceneGraph: function(updateVisitor) {\n            if (this._databasePager)\n                this._databasePager.updateSceneGraph(updateVisitor.getFrameStamp());\n            if (this._sceneData) this._sceneData.accept(updateVisitor);\n        }\n    }),\n    \'osgViewer\',\n    \'Scene\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Scene);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/Scene.js\n// module id = 158\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/Scene.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Shader__ = __webpack_require__(26);\n\n\n\n\n\n\n\n\nvar glPrecision = ['#ifdef GL_ES', 'precision highp float;', '#endif'].join('\\n');\n\nvar program;\nvar getOrCreateShader = function() {\n    if (program) return program;\n    var shaderName = '#define SHADER_NAME GizmoLine3D';\n    var vertexshader = [\n        glPrecision,\n        'attribute vec3 Vertex;',\n        'uniform mat4 uModelViewMatrix;',\n        'uniform mat4 uProjectionMatrix;',\n        shaderName,\n        '',\n        'void main(void) {',\n        '  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);',\n        '}'\n    ].join('\\n');\n\n    var fragmentshader = [\n        glPrecision,\n        'uniform vec4 uColor;',\n        shaderName,\n        '',\n        'void main(void) {',\n        '  gl_FragColor = uColor;',\n        '}'\n    ].join('\\n');\n\n    program = new __WEBPACK_IMPORTED_MODULE_5_osg_Program__[\"a\" /* default */](\n        new __WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */].VERTEX_SHADER, vertexshader),\n        new __WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */].FRAGMENT_SHADER, fragmentshader)\n    );\n    return program;\n};\n\nvar program2D;\nvar getOrCreateShader2D = function() {\n    if (program2D) return program2D;\n    var shaderName = '#define SHADER_NAME GizmoLine2D';\n    var vertexshader = [\n        glPrecision,\n        'attribute vec2 Vertex;',\n        shaderName,\n        '',\n        'void main(void) {',\n        '  gl_Position = vec4(Vertex, 0.0, 1.0);',\n        '}'\n    ].join('\\n');\n\n    var fragmentshader = [\n        glPrecision,\n        shaderName,\n        '',\n        'void main(void) {',\n        '  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);',\n        '}'\n    ].join('\\n');\n\n    program2D = new __WEBPACK_IMPORTED_MODULE_5_osg_Program__[\"a\" /* default */](\n        new __WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */].VERTEX_SHADER, vertexshader),\n        new __WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */].FRAGMENT_SHADER, fragmentshader)\n    );\n    return program2D;\n};\n\nvar programQC;\nvar getOrCreateShaderQuadCircle = function() {\n    if (programQC) return programQC;\n    var shaderName = '#define SHADER_NAME GizmoQuadCircle';\n    var vertexshader = [\n        glPrecision,\n        'attribute vec3 Vertex;',\n        'uniform mat4 uModelViewMatrix;',\n        'uniform mat4 uProjectionMatrix;',\n        'varying vec3 vViewVertex;',\n        shaderName,\n        '',\n        'void main(void) {',\n        '  vViewVertex = Vertex;',\n        '  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex, 1.0);',\n        '}'\n    ].join('\\n');\n\n    var fragmentshader = [\n        glPrecision,\n        'uniform float uAngle;',\n        'uniform vec3 uBase;',\n        'varying vec3 vViewVertex;',\n        'const float PI = 3.14159265358979323846264;',\n        'const float PI2 = PI * 2.0;',\n        shaderName,\n        '',\n        'void main(void) {',\n        '  if(length(vViewVertex) > 0.5)',\n        '    discard;',\n        '  vec3 vn = normalize(vViewVertex);',\n        '  float angle = atan(uBase.y * vn.x - uBase.x * vn.y, dot(uBase, vn));',\n        '  if(angle > 0.0) {',\n        '    if(uAngle >= 0.0 && angle > uAngle) discard;',\n        '    if(uAngle < -PI && angle < uAngle + PI2) discard;',\n        '    if(uAngle < 0.0 && uAngle > -PI) discard;',\n        '  }',\n        '  if(angle < 0.0) {',\n        '    if(uAngle <= 0.0 && angle < uAngle) discard;',\n        '    if(uAngle > PI && angle > uAngle - PI2) discard;',\n        '    if(uAngle > 0.0 && uAngle < PI) discard;',\n        '  }',\n        '  gl_FragColor = vec4(1.0, 1.0, 0.0, 0.5);',\n        '}'\n    ].join('\\n');\n\n    programQC = new __WEBPACK_IMPORTED_MODULE_5_osg_Program__[\"a\" /* default */](\n        new __WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */].VERTEX_SHADER, vertexshader),\n        new __WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_6_osg_Shader__[\"a\" /* default */].FRAGMENT_SHADER, fragmentshader)\n    );\n    return programQC;\n};\n\nvar resetPrograms = function () {\n    program = undefined;\n    program2D = undefined;\n    programQC = undefined;\n};\n\nvar createDebugLineGeometry = function() {\n    var g = new __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__[\"a\" /* default */]();\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ARRAY_BUFFER, new Float32Array(4), 2);\n    var primitive = new __WEBPACK_IMPORTED_MODULE_3_osg_DrawArrays__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_2_osg_primitiveSet__[\"a\" /* default */].LINES, 0, 2);\n    g.getPrimitives().push(primitive);\n    g.getOrCreateStateSet().setAttributeAndModes(getOrCreateShader2D());\n    return g;\n};\n\nvar createTorusGeometry = function(\n    argRadiusOut,\n    argRadiusWidth,\n    argNbRadial,\n    argNbTubular,\n    argArc\n) {\n    var radiusOut = argRadiusOut !== undefined ? argRadiusOut : 1.0;\n    var radiusWidth = argRadiusWidth !== undefined ? argRadiusWidth : 0.2;\n    var nbRadial = argNbRadial !== undefined ? argNbRadial : 6;\n    var nbTubular = argNbTubular !== undefined ? argNbTubular : 64;\n    var arc = argArc !== undefined ? argArc : Math.PI * 2;\n\n    var nbVertices = (nbRadial + 1) * (nbTubular + 1);\n    var nbTriangles = nbRadial * nbTubular * 2;\n    var g = new __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__[\"a\" /* default */]();\n    var vertices = new Float32Array(nbVertices * 3);\n    var indices = new Uint16Array(nbTriangles * 3);\n    arc = arc || Math.PI * 2;\n    var id = 0;\n    var k = 0;\n    var i = 0;\n    var j = 0;\n    for (j = 0; j <= nbRadial; ++j) {\n        for (i = 0; i <= nbTubular; ++i) {\n            var u = i / nbTubular * arc;\n            var v = j / nbRadial * Math.PI * 2;\n            k = id * 3;\n            vertices[k] = (radiusOut + radiusWidth * Math.cos(v)) * Math.cos(u);\n            vertices[k + 1] = (radiusOut + radiusWidth * Math.cos(v)) * Math.sin(u);\n            vertices[k + 2] = radiusWidth * Math.sin(v);\n            id++;\n        }\n    }\n    id = 0;\n    for (j = 1; j <= nbRadial; ++j) {\n        for (i = 1; i <= nbTubular; ++i) {\n            k = id * 6;\n            indices[k] = (nbTubular + 1) * j + i - 1;\n            indices[k + 1] = indices[k + 3] = (nbTubular + 1) * (j - 1) + i - 1;\n            indices[k + 2] = indices[k + 5] = (nbTubular + 1) * j + i;\n            indices[k + 4] = (nbTubular + 1) * (j - 1) + i;\n            id++;\n        }\n    }\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ARRAY_BUFFER, vertices, 3);\n    g.getOrCreateStateSet().setAttributeAndModes(getOrCreateShader());\n    g\n        .getPrimitives()\n        .push(\n            new __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__[\"a\" /* default */](\n                __WEBPACK_IMPORTED_MODULE_2_osg_primitiveSet__[\"a\" /* default */].TRIANGLES,\n                new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ELEMENT_ARRAY_BUFFER, indices, 1)\n            )\n        );\n    return g;\n};\n\nvar createCylinderGeometry = function(\n    argRadiusTop,\n    argRadiusBottom,\n    argHeight,\n    argRadialSegments,\n    argHeightSegments,\n    argTopCap,\n    argLowCap\n) {\n    var radiusTop = argRadiusTop !== undefined ? argRadiusTop : 1.0;\n    var radiusBottom = argRadiusBottom !== undefined ? argRadiusBottom : 1.0;\n    var height = argHeight !== undefined ? argHeight : 5.0;\n    var radialSegments = argRadialSegments !== undefined ? argRadialSegments : 32;\n    var heightSegments = argHeightSegments !== undefined ? argHeightSegments : 1;\n    var topCap = argTopCap !== undefined ? argTopCap : true;\n    var lowCap = argLowCap !== undefined ? argLowCap : true;\n\n    topCap = topCap && radiusTop > 0.0;\n    lowCap = lowCap && radiusBottom > 0.0;\n    var heightHalf = height * 0.5;\n\n    var nbVertices = (heightSegments + 1) * (radialSegments + 1);\n    var nbTriangles = heightSegments * radialSegments * 2;\n    if (topCap) {\n        nbVertices += 1;\n        nbTriangles += radialSegments;\n    }\n    if (lowCap) {\n        nbVertices += 1;\n        nbTriangles += radialSegments;\n    }\n    var g = new __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__[\"a\" /* default */]();\n    var vertices = new Float32Array(nbVertices * 3);\n    var indices = new Uint16Array(nbTriangles * 3);\n\n    var id = 0;\n    var k = 0;\n    var i = 0;\n    var j = 0;\n    for (i = 0; i <= heightSegments; i++) {\n        var v = i / heightSegments;\n        var radius = v * (radiusBottom - radiusTop) + radiusTop;\n        for (j = 0; j <= radialSegments; j++) {\n            var u = j / radialSegments;\n            k = id * 3;\n            vertices[k] = radius * Math.sin(u * Math.PI * 2);\n            vertices[k + 1] = radius * Math.cos(u * Math.PI * 2);\n            vertices[k + 2] = -v * height + heightHalf;\n            id++;\n        }\n    }\n\n    id = 0;\n    for (j = 0; j < radialSegments; j++) {\n        for (i = 0; i < heightSegments; i++) {\n            k = id * 6;\n            indices[k] = (radialSegments + 1) * i + j;\n            indices[k + 1] = indices[k + 3] = (radialSegments + 1) * (i + 1) + j;\n            indices[k + 2] = indices[k + 5] = (radialSegments + 1) * i + j + 1;\n            indices[k + 4] = (radialSegments + 1) * (i + 1) + j + 1;\n            id++;\n        }\n    }\n    id *= 2;\n    var last;\n    if (topCap) {\n        last = (lowCap ? vertices.length - 6 : vertices.length - 3) / 3;\n        vertices[last * 3 + 2] = heightHalf;\n        for (j = 0; j < radialSegments; j++) {\n            k = id * 3;\n            indices[k] = j;\n            indices[k + 1] = j + 1;\n            indices[k + 2] = last;\n            id++;\n        }\n    }\n\n    if (lowCap) {\n        last = (vertices.length - 3) / 3;\n        vertices[last * 3 + 2] = -heightHalf;\n        var end = (radialSegments + 1) * i;\n        for (j = 0; j < radialSegments; j++) {\n            k = id * 3;\n            indices[k] = end + j + 1;\n            indices[k + 1] = end + j;\n            indices[k + 2] = last;\n            id++;\n        }\n    }\n\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ARRAY_BUFFER, vertices, 3);\n    g.getOrCreateStateSet().setAttributeAndModes(getOrCreateShader());\n    g\n        .getPrimitives()\n        .push(\n            new __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__[\"a\" /* default */](\n                __WEBPACK_IMPORTED_MODULE_2_osg_primitiveSet__[\"a\" /* default */].TRIANGLES,\n                new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ELEMENT_ARRAY_BUFFER, indices, 1)\n            )\n        );\n    return g;\n};\n\nvar createCircleGeometry = function(nbVertices, radius, argArc) {\n    var g = new __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__[\"a\" /* default */]();\n    var vertices = new Float32Array(nbVertices * 3);\n    var arc = argArc || Math.PI * 2;\n    for (var i = 0; i < nbVertices; ++i) {\n        var j = i * 3;\n        var segment = arc * i / nbVertices;\n        vertices[j] = Math.cos(segment) * radius;\n        vertices[j + 1] = Math.sin(segment) * radius;\n    }\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ARRAY_BUFFER, vertices, 3);\n    var primitive = new __WEBPACK_IMPORTED_MODULE_3_osg_DrawArrays__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_2_osg_primitiveSet__[\"a\" /* default */].LINE_STRIP, 0, nbVertices);\n    g.getOrCreateStateSet().setAttributeAndModes(getOrCreateShader());\n    g.getPrimitives().push(primitive);\n    return g;\n};\n\nvar createPlaneGeometry = function(width, height) {\n    var offx = width ? width * 0.5 : 0.5;\n    var offy = height ? height * 0.5 : 0.5;\n\n    var g = new __WEBPACK_IMPORTED_MODULE_1_osg_Geometry__[\"a\" /* default */]();\n    var vertices = new Float32Array(12);\n    vertices[0] = -offx;\n    vertices[1] = -offy;\n\n    vertices[3] = offx;\n    vertices[4] = -offy;\n\n    vertices[6] = -offx;\n    vertices[7] = offy;\n\n    vertices[9] = offx;\n    vertices[10] = offy;\n\n    g.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_0_osg_BufferArray__[\"a\" /* default */].ARRAY_BUFFER, vertices, 3);\n    var primitive = new __WEBPACK_IMPORTED_MODULE_3_osg_DrawArrays__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_2_osg_primitiveSet__[\"a\" /* default */].TRIANGLE_STRIP, 0, 4);\n    g.getOrCreateStateSet().setAttributeAndModes(getOrCreateShader());\n    g.getPrimitives().push(primitive);\n    return g;\n};\n\nvar createQuadCircleGeometry = function() {\n    var g = createPlaneGeometry();\n    g.getOrCreateStateSet().setAttributeAndModes(getOrCreateShaderQuadCircle());\n    return g;\n};\n\nvar GizmoGeometry = {};\nGizmoGeometry.createCircleGeometry = createCircleGeometry;\nGizmoGeometry.createCylinderGeometry = createCylinderGeometry;\nGizmoGeometry.createTorusGeometry = createTorusGeometry;\nGizmoGeometry.createDebugLineGeometry = createDebugLineGeometry;\nGizmoGeometry.createPlaneGeometry = createPlaneGeometry;\nGizmoGeometry.createQuadCircleGeometry = createQuadCircleGeometry;\nGizmoGeometry.resetPrograms = resetPrograms;\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (GizmoGeometry);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/gizmoGeometry.js\n// module id = 159\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/gizmoGeometry.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgViewer_eventProxy_GamePad__ = __webpack_require__(244);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgViewer_eventProxy_Hammer__ = __webpack_require__(245);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgViewer_eventProxy_StandardMouseKeyboard__ = __webpack_require__(246);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgViewer_eventProxy_WebVR__ = __webpack_require__(247);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgViewer_eventProxy_DeviceOrientation__ = __webpack_require__(249);\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    GamePad: __WEBPACK_IMPORTED_MODULE_0_osgViewer_eventProxy_GamePad__["a" /* default */],\n    Hammer: __WEBPACK_IMPORTED_MODULE_1_osgViewer_eventProxy_Hammer__["a" /* default */],\n    StandardMouseKeyboard: __WEBPACK_IMPORTED_MODULE_2_osgViewer_eventProxy_StandardMouseKeyboard__["a" /* default */],\n    WebVR: __WEBPACK_IMPORTED_MODULE_3_osgViewer_eventProxy_WebVR__["a" /* default */],\n    DeviceOrientation: __WEBPACK_IMPORTED_MODULE_4_osgViewer_eventProxy_DeviceOrientation__["a" /* default */]\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/eventProxy/eventProxy.js\n// module id = 160\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/eventProxy/eventProxy.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_CullFace__ = __webpack_require__(50);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__ = __webpack_require__(162);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgStats_Counter__ = __webpack_require__(163);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgStats_Graph__ = __webpack_require__(98);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgStats_TextGenerator__ = __webpack_require__(164);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osgUtil_IntersectionVisitor__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osgUtil_LineSegmentIntersector__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osg_BoundingBox__ = __webpack_require__(28);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Stats usages:\n// url usable in Options\n//\n// to active the stats: ?stats=1\n//\n// to filter content in the stats: statsFilter=cull;myGroup;webgl\n//\n// to change the fontSize: statsFontSize=40\n//\n// You can also change the configuration before running the viewer to adds counters\n// var config = {\n//     values: {\n//         myCounter: {\n//             caption: 'my uber counter',\n//             average: true,\n//             graph: true,\n//             over: 16\n//         },\n//         myCounter2: {\n//             caption: 'a second counter',\n//             graph: true,\n//             below: 16\n//         }\n//         groups: [\n//             {\n//                 name: myGroup,\n//                 caption: 'blah my group',\n//                 values: [ 'myCounter', 'myCounter2' ]\n//             }\n//         ]\n//     };\n//     getViewerStats().addConfig(config)\n//     getViewerStats().setShowFilter(['cull', 'myGroup']) // will display only cull\n//     and myGroup groups\n//     getViewerStats().setFontSize(50)\n\nvar getCanvasCoord = function(vec, e) {\n    if (e.touches && e.touches.length) {\n        var touch = e.touches[0];\n        vec[0] = touch.pageX;\n        vec[1] = touch.pageY;\n    } else {\n        vec[0] = e.offsetX === undefined ? e.layerX : e.offsetX;\n        vec[1] = e.offsetY === undefined ? e.layerY : e.offsetY;\n    }\n};\n\nvar PICKING_NODEMASK = 0x8000;\n\nvar createShader = function() {\n    var vertexshader = [\n        'attribute vec4 Vertex;',\n        'uniform mat4 uModelViewMatrix;',\n        'uniform mat4 uProjectionMatrix;',\n        '',\n        'varying vec2 vTexCoord0;',\n        '',\n        'void main(void) {',\n        '  vTexCoord0 = Vertex.zw;',\n        '  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex.xy,0.0, 1.0));',\n        '}'\n    ].join('\\n');\n\n    var fragmentshader = [\n        '#define SHADER_NAME STATS',\n        'varying vec2 vTexCoord0;',\n        'uniform sampler2D Texture0;',\n\n        'void main(void) {',\n        '  vec4 color = vec4(1.0);',\n        '  vec2 uv =  vTexCoord0;',\n        '  int isText = 0;',\n        '  if ( uv.y < 0.0 ) {',\n        '     isText = 1;',\n        '     uv.y = -uv.y;',\n        '  }',\n        '  if ( uv.y >= ' + (__WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].backgroundColor - 1).toFixed(1) + ' ) {', // background\n        '     color = vec4(0.0,0.0,0.0,0.5);',\n        '     uv.y -= ' + __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].backgroundColor.toFixed(1) + ';',\n        '  } else if ( uv.y >= ' + (__WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].redColor - 1).toFixed(1) + ' ) {',\n        '     color = vec4(1.0,0.0,0.0,1.0);',\n        '     uv.y -= ' + __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].redColor.toFixed(1) + ';',\n        '  } else if ( uv.y == ' + (__WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].greyColor - 1).toFixed(1) + ' ) {',\n        '     color = vec4(0.5,0.5,0.5,1.0);',\n        '     uv.y -= ' + __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].greyColor.toFixed(1) + ';',\n        '  } else {',\n        '     uv.y -= ' + __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].whiteColor.toFixed(1) + ';',\n        '  }',\n        '  if ( isText == 1 ) {',\n        '     color *= texture2D( Texture0, uv.xy);',\n        '  }',\n        '  gl_FragColor = color;',\n        '}'\n    ].join('\\n');\n\n    return new __WEBPACK_IMPORTED_MODULE_6_osg_Program__[\"a\" /* default */](\n        new __WEBPACK_IMPORTED_MODULE_7_osg_Shader__[\"a\" /* default */]('VERTEX_SHADER', vertexshader),\n        new __WEBPACK_IMPORTED_MODULE_7_osg_Shader__[\"a\" /* default */]('FRAGMENT_SHADER', fragmentshader)\n    );\n};\n\nvar Stats = function(viewer, options) {\n    this._captionsBuffer = undefined;\n    this._valuesBuffer = undefined;\n\n    this._dirtyCaptions = true;\n    this._dirtyValues = true;\n\n    this._viewer = viewer;\n    this._labelMaxWidth = 0;\n    this._viewport = viewer.getCamera().getViewport();\n\n    this._node = undefined;\n    this._text = undefined;\n    this._offsetGroup = undefined;\n\n    this._counters = {};\n    this._groups = {};\n    this._updates = [];\n    this._displayableCounters = {};\n    this._x = 0;\n    this._y = 0;\n    this._width = 0;\n    this._height = 0;\n\n    this._maxCaptionTextLength = 32;\n\n    this._lineFactor = 1.1;\n    this._displayFilter = [];\n\n    this._backgroundWidth = 0;\n    this._backgroundHeight = 0;\n\n    this._bufferStats = new __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */]();\n    this._historyGraph = {};\n\n    this._graphToDisplay = [];\n\n    this._valuesMaxWidth = 6 * 12;\n\n    this._showGraph = false;\n\n    // inputs data\n    this._backgroundPicking = __WEBPACK_IMPORTED_MODULE_17_osg_shape__[\"a\" /* default */].createTexturedQuadGeometry(0, 0, 0, 10, 0, 0, 0, 10, 0);\n    this._dragStop = __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"e\" /* vec2 */].create();\n    this._dragStart = __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"e\" /* vec2 */].create();\n    this._startTransformation = __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"c\" /* mat4 */].create();\n\n    this._init(options);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(Stats, {\n    getCounter: function(name) {\n        if (!this._counters[name]) {\n            this._counters[name] = new __WEBPACK_IMPORTED_MODULE_12_osgStats_Counter__[\"a\" /* default */]({\n                caption: name,\n                average: true\n            });\n        }\n\n        return this._counters[name];\n    },\n    getBufferStats: function() {\n        return this._bufferStats;\n    },\n    addConfig: function(config) {\n        if (config.init && !config.init()) return;\n\n        for (var valueName in config.values) {\n            var valueConfig = config.values[valueName];\n            var counter = new __WEBPACK_IMPORTED_MODULE_12_osgStats_Counter__[\"a\" /* default */](valueConfig);\n            this._counters[valueName] = counter;\n        }\n\n        if (config.groups) {\n            for (var i = 0; i < config.groups.length; i++) {\n                var groupConfig = config.groups[i];\n                var group = {\n                    caption: groupConfig.caption,\n                    values: groupConfig.values,\n                    textCursorY: new Float32Array(groupConfig.values.length)\n                };\n\n                var name = groupConfig.name ? groupConfig.name : groupConfig.caption;\n                this._groups[name] = group;\n            }\n        }\n\n        if (config.update) {\n            this._updates.push(config.update);\n        }\n    },\n    reset: function() {\n        this._bufferStats.resetCaptions();\n        this._bufferStats.resetValues();\n\n        this._dirtyCaptions = true;\n        this._dirtyValue = true;\n\n        this._bufferStats.resize(this._bufferStats._maxNbVertexes);\n    },\n    update: function() {\n        for (var i = 0; i < this._updates.length; i++) {\n            this._updates[i](this);\n        }\n        this._dirtyValues = true;\n\n        if (this._checkViewportChanged() || this._checkCounterDisplayableChanged())\n            this._dirtyCaptions = true;\n\n        if (this._dirtyCaptions) {\n            this._bufferStats.resetCaptions();\n            this._generateCaptions();\n            this._dirtyCaptions = false;\n        }\n\n        if (this._dirtyValues) {\n            this._bufferStats.resetValues();\n            this._generateValues();\n            this._dirtyValues = false;\n        }\n    },\n    getNode: function() {\n        return this._node;\n    },\n    setShowFilter: function(groupNamesArray) {\n        this._dirtyCaptions = true;\n        if (!groupNamesArray) {\n            this._displayFilter.length = 0;\n            return;\n        }\n        this._displayFilter = groupNamesArray.slice();\n    },\n    _init: function(options) {\n        // 3D init\n        var camera = new __WEBPACK_IMPORTED_MODULE_2_osg_Camera__[\"a\" /* default */]();\n\n        camera.setRenderOrder(__WEBPACK_IMPORTED_MODULE_2_osg_Camera__[\"a\" /* default */].POST_RENDER, 0);\n        camera.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_8_osg_Transform__[\"a\" /* default */].ABSOLUTE_RF);\n        camera.setClearMask(0x0); // dont clear anything\n        var node = new __WEBPACK_IMPORTED_MODULE_5_osg_MatrixTransform__[\"a\" /* default */]();\n        node.setName('StatsNode');\n        node.addChild(this._backgroundPicking);\n        this._nodeTransform = node;\n        this._backgroundPicking.setNodeMask(0);\n\n        camera.addChild(node);\n        camera.setName('osgStats');\n        camera.setViewport(this._viewport);\n        this._node = camera;\n        this._text = new __WEBPACK_IMPORTED_MODULE_14_osgStats_TextGenerator__[\"a\" /* default */]();\n\n        var fontSize = 12;\n        if (options) {\n            var statsGroupList = options.getString('statsFilter');\n            if (statsGroupList) {\n                var filterList = statsGroupList.split(';');\n                this.setShowFilter(filterList);\n            }\n            var statsFontSize = options.getNumber('statsFontSize');\n            if (statsFontSize !== undefined) fontSize = statsFontSize;\n\n            this._showGraph = options.getBoolean('statsShowGraph');\n        }\n\n        var texture = new __WEBPACK_IMPORTED_MODULE_9_osg_Texture__[\"default\"]();\n        texture.setMinFilter(__WEBPACK_IMPORTED_MODULE_9_osg_Texture__[\"default\"].NEAREST);\n        texture.setMagFilter(__WEBPACK_IMPORTED_MODULE_9_osg_Texture__[\"default\"].NEAREST);\n        this._text.setFontSize(fontSize * this._viewer.getCanvasPixelRatio());\n        this._text.getCanvas().then(\n            function(canvas) {\n                this._dirtyCaptions = true;\n                var geometry = this._bufferStats.getGeometry();\n                geometry.setName('StatsGeometry');\n                geometry.setNodeMask(~PICKING_NODEMASK);\n                node.addChild(geometry);\n                texture.setImage(canvas);\n                // invalidate the bounding box, we dont want it\n                // to be used\n                geometry.setBound(new __WEBPACK_IMPORTED_MODULE_18_osg_BoundingBox__[\"a\" /* default */]());\n            }.bind(this)\n        );\n\n        node.getOrCreateStateSet().setAttributeAndModes(createShader());\n        node.getOrCreateStateSet().setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_3_osg_CullFace__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_CullFace__[\"a\" /* default */].DISABLE));\n        var blendFunc = new __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__[\"a\" /* default */]('SRC_ALPHA', 'ONE_MINUS_SRC_ALPHA');\n        node.getOrCreateStateSet().setAttributeAndModes(blendFunc);\n        node.getOrCreateStateSet().setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_4_osg_Depth__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_4_osg_Depth__[\"a\" /* default */].DISABLE));\n        node.getOrCreateStateSet().setTextureAttributeAndModes(0, texture);\n\n        var canvas = this._viewer.getGraphicContext().canvas;\n\n        this._canvas = canvas;\n\n        canvas.addEventListener('mousemove', this.onMouseMove.bind(this));\n        canvas.addEventListener('mousedown', this.onMouseDown.bind(this));\n        canvas.addEventListener('mouseup', this.onMouseUp.bind(this));\n        canvas.addEventListener('mouseout', this.onMouseUp.bind(this));\n\n        canvas.addEventListener('touchmove', this.onMouseMove.bind(this));\n        canvas.addEventListener('touchstart', this.onMouseDown.bind(this));\n        canvas.addEventListener('touchend', this.onMouseUp.bind(this));\n        canvas.addEventListener('touchcancel', this.onMouseUp.bind(this));\n    },\n    onMouseDown: function(e) {\n        var hits = this.computeNearestIntersection(e);\n        this._onStats = !!hits.length;\n        if (!this._onStats) return;\n\n        this._viewer.setEnableManipulator(false);\n\n        e.preventDefault();\n        __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"c\" /* mat4 */].copy(this._startTransformation, this._nodeTransform.getMatrix());\n        getCanvasCoord(this._dragStart, e);\n        this._dragStop[1] = this._dragStart[1];\n    },\n    onMouseMove: (function() {\n        return function(e) {\n            if (!this._onStats) return;\n\n            getCanvasCoord(this._dragStop, e);\n            var dy = this._dragStop[1] - this._dragStart[1];\n            __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"c\" /* mat4 */].translate(\n                this._nodeTransform.getMatrix(),\n                this._startTransformation,\n                __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"f\" /* vec3 */].fromValues(0, -dy, 0)\n            );\n        };\n    })(),\n    onMouseUp: function() {\n        this._viewer.setEnableManipulator(true);\n        this._onStats = false;\n    },\n    computeNearestIntersection: (function() {\n        var coord = __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"e\" /* vec2 */].create();\n        var lsi = new __WEBPACK_IMPORTED_MODULE_16_osgUtil_LineSegmentIntersector__[\"a\" /* default */]();\n        var origIntersect = __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"f\" /* vec3 */].create();\n        var dstIntersect = __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"f\" /* vec3 */].create();\n        var iv = new __WEBPACK_IMPORTED_MODULE_15_osgUtil_IntersectionVisitor__[\"a\" /* default */]();\n        iv.setIntersector(lsi);\n        return function(e) {\n            getCanvasCoord(coord, e);\n\n            // canvas to webgl coord\n            var viewer = this._viewer;\n            var canvas = this._canvas;\n            var x = coord[0] * (viewer._canvasWidth / canvas.clientWidth);\n            var y = (canvas.clientHeight - coord[1]) * (viewer._canvasHeight / canvas.clientHeight);\n\n            lsi.reset();\n            lsi.set(__WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"f\" /* vec3 */].set(origIntersect, x, y, 0.0), __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"f\" /* vec3 */].set(dstIntersect, x, y, 1.0));\n            iv.reset();\n\n            this._backgroundPicking.setNodeMask(PICKING_NODEMASK);\n            iv.setTraversalMask(PICKING_NODEMASK);\n            this._node.accept(iv);\n            var hits = lsi.getIntersections();\n            this._backgroundPicking.setNodeMask(0x0);\n\n            return hits;\n        };\n    })(),\n    _updateBackgroundPicking: function(x, y, w, h) {\n        var vertexes = this._backgroundPicking.getVertexAttributeList().Vertex.getElements();\n        vertexes[0] = x;\n        vertexes[1] = y + h;\n\n        vertexes[3] = x;\n        vertexes[4] = y;\n\n        vertexes[6] = x + w;\n        vertexes[7] = y;\n\n        vertexes[9] = x + w;\n        vertexes[10] = y + h;\n        this._backgroundPicking.dirtyBound();\n    },\n\n    _generateCaptions: function() {\n        var initialX = 0;\n        var characterHeight = this._text.getCharacterHeight();\n        var textCursorX = initialX;\n        var textCursorY = this._viewport.height() - characterHeight;\n\n        this._labelMaxWidth = 0;\n\n        // generate background\n        this._bufferStats.generateBackground(\n            0,\n            this._viewport.height() - this._backgroundHeight,\n            this._backgroundWidth,\n            this._backgroundHeight\n        );\n\n        this._updateBackgroundPicking(\n            0,\n            this._viewport.height() - this._backgroundHeight,\n            this._backgroundWidth,\n            this._backgroundHeight\n        );\n\n        var filters = this._displayFilter;\n        for (var groupName in this._groups) {\n            if (groupName && filters.length && filters.indexOf(groupName) === -1) continue;\n\n            var group = this._groups[groupName];\n            var groupText = '--- ' + group.caption + ' ---';\n            var textWidth = this._bufferStats.generateText(\n                textCursorX,\n                textCursorY,\n                groupText,\n                this._text,\n                __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].whiteColor\n            );\n            this._labelMaxWidth = Math.max(textWidth, this._labelMaxWidth);\n            textCursorX = initialX;\n            textCursorY -= this._lineFactor * characterHeight;\n\n            for (var j = 0; j < group.values.length; j++) {\n                var counterName = group.values[j];\n                var counter = this._counters[counterName];\n                if (!counter || !counter.isDisplayable()) continue;\n\n                group.textCursorY[j] = textCursorY;\n\n                var text = counter._caption;\n                // could need to split the label on multi line\n                var nbSplits = text.length / this._maxCaptionTextLength;\n                for (var c = 0; c < nbSplits; c++) {\n                    var start = c * this._maxCaptionTextLength;\n                    var splitText = text.substr(start, this._maxCaptionTextLength);\n                    textWidth = this._bufferStats.generateText(\n                        textCursorX,\n                        textCursorY,\n                        splitText,\n                        this._text,\n                        __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].whiteColor\n                    );\n                    this._labelMaxWidth = Math.max(textWidth, this._labelMaxWidth);\n                    textCursorY -= characterHeight;\n                    textCursorX = initialX;\n                }\n            }\n            textCursorY -= characterHeight;\n        }\n        this._bufferStats.captionsEnd();\n    },\n    _generateValues: function() {\n        var characterWidth = this._text.getCharacterWidth();\n        var valuesOffsetX = this._labelMaxWidth + 2 * characterWidth;\n        var graphOffsetX = this._valuesMaxWidth + 2 * characterWidth;\n        var characterHeight = this._text.getCharacterHeight();\n        var textCursorX = valuesOffsetX;\n        var textCursorY;\n\n        var filters = this._displayFilter;\n        var valuesMaxWidth = 0;\n        for (var groupName in this._groups) {\n            if (groupName && filters.length && filters.indexOf(groupName) === -1) continue;\n\n            var group = this._groups[groupName];\n            textCursorX = valuesOffsetX;\n\n            for (var j = 0; j < group.values.length; j++) {\n                var counterName = group.values[j];\n                var counter = this._counters[counterName];\n                if (!counter || !counter.isDisplayable()) continue;\n\n                var value = counter.getAverageMs() ? counter.getAverageValue() : counter.getValue();\n                var text;\n                if (!Number.isInteger(value)) {\n                    text = value.toFixed(2);\n                } else {\n                    text = value.toString();\n                }\n\n                textCursorY = group.textCursorY[j];\n                var color = __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].whiteColor;\n                var over = counter.getOver();\n                var below = counter.getBelow();\n                if (over !== 0) color = value > over ? __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].redColor : color;\n                else if (below !== 0) color = value < below ? __WEBPACK_IMPORTED_MODULE_11_osgStats_BufferStats__[\"a\" /* default */].redColor : color;\n\n                var valueWidth = this._bufferStats.generateText(\n                    textCursorX,\n                    textCursorY,\n                    text,\n                    this._text,\n                    color\n                );\n                valuesMaxWidth = Math.max(valueWidth, valuesMaxWidth);\n\n                if (this._showGraph && counter._graph) {\n                    if (!this._historyGraph[counterName]) {\n                        this._historyGraph[counterName] = new __WEBPACK_IMPORTED_MODULE_13_osgStats_Graph__[\"a\" /* default */]();\n                    }\n                    this._graphToDisplay.push(this._historyGraph[counterName]);\n                    this._historyGraph[counterName].setDisplayPosition(\n                        valuesOffsetX + graphOffsetX,\n                        textCursorY\n                    );\n                    this._historyGraph[counterName].addValue(value, color);\n                }\n\n                textCursorX = valuesOffsetX;\n            }\n        }\n        this._bufferStats.valuesEnd();\n\n        this._valuesMaxWidth = valuesMaxWidth;\n\n        for (var g = 0; g < this._graphToDisplay.length; g++) {\n            var graph = this._graphToDisplay[g];\n            this._bufferStats.generateGraph(graph, characterHeight - 2.0);\n        }\n\n        var totalWidth = valuesOffsetX + graphOffsetX;\n\n        if (this._graphToDisplay.length) totalWidth += __WEBPACK_IMPORTED_MODULE_13_osgStats_Graph__[\"a\" /* default */].maxGraphValue * 2 + 1;\n        var totalHeight = this._viewport.height() - textCursorY;\n\n        if (this._backgroundWidth !== totalWidth || this._backgroundHeight !== totalHeight) {\n            this._backgroundWidth = totalWidth;\n            this._backgroundHeight = totalHeight;\n            this._dirtyCaptions = true;\n        }\n        this._graphToDisplay.length = 0;\n\n        this._bufferStats.graphsEnd();\n        this._bufferStats.update();\n    },\n    _checkCounterDisplayableChanged: function() {\n        var changed = false;\n        for (var key in this._counters) {\n            var counter = this._counters[key];\n            if (this._displayableCounters[key] !== counter.isDisplayable()) {\n                this._displayableCounters[key] = counter.isDisplayable();\n                changed = true;\n            }\n        }\n        return changed;\n    },\n    _checkViewportChanged: function() {\n        var x = this._viewport.x();\n        var y = this._viewport.y();\n        var w = this._viewport.width();\n        var h = this._viewport.height();\n        if (x !== this._x || y !== this._y || w !== this._width || h !== this._height) {\n            this._x = x;\n            this._y = y;\n            this._width = w;\n            this._height = h;\n\n            var camera = this._node;\n            __WEBPACK_IMPORTED_MODULE_10_osg_glMatrix__[\"c\" /* mat4 */].ortho(\n                camera.getProjectionMatrix(),\n                this._x,\n                this._width,\n                this._y,\n                this._height,\n                -5,\n                5\n            );\n            return true;\n        }\n        return false;\n    }\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Stats);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/Stats.js\n// module id = 161\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/Stats.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgStats_Graph__ = __webpack_require__(98);\n\n\n\n\n\n\n\n\n\n// captions data (4 vertexes, indexes)\n// values data   (4 vertexes, indexes)\n// graph data    (2 vertexes, drawArrays)\n\nvar BufferStats = function() {\n    this._usageHint = __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].DYNAMIC_DRAW;\n    // equivalent of 512 characters for caption, 128 of values characters\n    // and 6 graph of 120 lines\n    var nbVertexes = (1024 + 256) * 4 + 6 * 2 * 120;\n    this._nbVertexes = 0;\n    this._maxNbVertexes = 0;\n\n    this._captionNbVertexes = 0;\n    this._valuesNbVertexes = 0;\n    this._graphsNbVertexes = 0;\n\n    this.resize(nbVertexes);\n};\n\nBufferStats.backgroundColor = 10.0;\nBufferStats.redColor = 7.0;\nBufferStats.greyColor = 4.0;\nBufferStats.whiteColor = 1.0;\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(BufferStats, {\n    getGeometry: function() {\n        return this._geometry;\n    },\n    generateBackground: function(x, y, w, h) {\n        var vertexes = this._vertexes;\n        this._nbVertexes += 4;\n\n        vertexes[0] = x;\n        vertexes[1] = y;\n        vertexes[2] = 0.0;\n        vertexes[3] = BufferStats.backgroundColor;\n\n        var x1 = x + w;\n        var y1 = y + h;\n\n        vertexes[4] = x;\n        vertexes[5] = y1;\n        vertexes[6] = 0.0;\n        vertexes[7] = BufferStats.backgroundColor;\n\n        vertexes[8] = x1;\n        vertexes[9] = y1;\n        vertexes[10] = 0.0;\n        vertexes[11] = BufferStats.backgroundColor;\n\n        vertexes[12] = x1;\n        vertexes[13] = y;\n        vertexes[14] = 0.0;\n        vertexes[15] = BufferStats.backgroundColor;\n    },\n    generateCharacter: function(x, y, w, h, ux, ux1, color) {\n        var vertexes = this._vertexes;\n        var nbVertexes = this._nbVertexes;\n\n        this._nbVertexes += 4;\n        var i = nbVertexes * 4;\n\n        vertexes[i++] = x;\n        vertexes[i++] = y;\n        vertexes[i++] = ux;\n        vertexes[i++] = -(0.0 + color);\n\n        var x1 = x + w;\n        var y1 = y + h;\n\n        vertexes[i++] = x;\n        vertexes[i++] = y1;\n        vertexes[i++] = ux;\n        vertexes[i++] = -(1.0 + color);\n\n        vertexes[i++] = x1;\n        vertexes[i++] = y1;\n        vertexes[i++] = ux1;\n        vertexes[i++] = -(1.0 + color);\n\n        vertexes[i++] = x1;\n        vertexes[i++] = y;\n        vertexes[i++] = ux1;\n        vertexes[i++] = -(0.0 + color);\n    },\n    generateText: function(x, y, text, textGenerator, zColor) {\n        var size = text.length;\n        if (this._nbVertexes + size * 4 >= this._maxNbVertexes) {\n            this.resize(this._maxNbVertexes * 2);\n        }\n        var characterSizeUV = textGenerator._characterSizeUV;\n        var characterWidth = textGenerator._characterWidth;\n        var characterHeight = textGenerator._characterHeight;\n        for (var i = 0; i < size; i++) {\n            var characterCode = text.charCodeAt(i);\n            var uvx = textGenerator.getCharacterUV(characterCode);\n            this.generateCharacter(\n                x,\n                y,\n                characterWidth,\n                characterHeight,\n                uvx,\n                uvx + characterSizeUV,\n                zColor\n            );\n\n            x += characterWidth;\n        }\n        return size * characterWidth;\n    },\n    generateGraph: function(graph, height) {\n        if (this._nbVertexes + __WEBPACK_IMPORTED_MODULE_7_osgStats_Graph__["a" /* default */].maxGraphValue * 2 >= this._maxNbVertexes) {\n            this.resize(this._maxNbVertexes * 2);\n        }\n        var vertexes = this._vertexes;\n        var nbVertexes = this._nbVertexes;\n\n        var graphValues = graph.getValues();\n        var nbGraphValues = graphValues.length;\n        var graphStartIndex = graph.getIndex();\n\n        var x = graph.getX();\n        var y = graph.getY();\n        this._nbVertexes += nbGraphValues * 2;\n\n        for (var i = 0; i < nbGraphValues; i++) {\n            var graphIndex = (graphStartIndex + i) % nbGraphValues;\n            var graphValue = graphValues[graphIndex];\n\n            var bufferIndex = nbVertexes + i * 2;\n            var vertexIndex = bufferIndex * 4;\n\n            var value = graphValue;\n            var color = BufferStats.greyColor;\n            // check if the value is a warning or not\n            if (value >= BufferStats.redColor) {\n                color = BufferStats.redColor;\n                value -= BufferStats.redColor;\n            }\n\n            if (value > 1.0) value = 1.0;\n            value *= height;\n            if (value < 1.0) value = 1.0;\n\n            vertexes[vertexIndex] = x + i * 2;\n            vertexes[vertexIndex + 1] = y;\n            vertexes[vertexIndex + 2] = 0.0;\n            vertexes[vertexIndex + 3] = color;\n\n            vertexes[vertexIndex + 4] = x + i * 2;\n            vertexes[vertexIndex + 5] = y + value;\n            vertexes[vertexIndex + 6] = 0.0;\n            vertexes[vertexIndex + 7] = color;\n        }\n    },\n    resize: function(nbVertexes) {\n        __WEBPACK_IMPORTED_MODULE_6_osg_notify__["a" /* default */].log(\'resize buffer to \' + nbVertexes);\n        this._maxNbVertexes = nbVertexes;\n        var vertexes = new Float32Array(nbVertexes * 4);\n        if (this._vertexes) vertexes.set(this._vertexes);\n        this._vertexes = vertexes;\n\n        // it\'s the max number of characters displayable\n        var nbCharacters = Math.ceil(nbVertexes / 4);\n        this._indexes = new Uint16Array(nbCharacters * 6);\n        for (var i = 0, j = 0; i < nbCharacters; i++) {\n            this._indexes[j++] = i * 4 + 0;\n            this._indexes[j++] = i * 4 + 1;\n            this._indexes[j++] = i * 4 + 3;\n            this._indexes[j++] = i * 4 + 3;\n            this._indexes[j++] = i * 4 + 1;\n            this._indexes[j++] = i * 4 + 2;\n        }\n\n        if (this._geometry) {\n            this._geometry.getAttributes().Vertex.setElements(this._vertexes);\n            this._characterPrimitive.getIndices().setElements(this._indexes);\n            return;\n        }\n\n        this._geometry = new __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */]();\n\n        this._geometry.getAttributes().Vertex = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\n            __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ARRAY_BUFFER,\n            this._vertexes,\n            4,\n            true\n        );\n        var indexArray = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */].ELEMENT_ARRAY_BUFFER, this._indexes, 1);\n\n        // for labels and values\n        this._geometry.getAttributes().Vertex.setUsage(this._usageHint);\n\n        var drawElement = new __WEBPACK_IMPORTED_MODULE_4_osg_DrawElements__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].TRIANGLES, indexArray);\n        this._characterPrimitive = drawElement;\n        this._geometry.getPrimitives().push(this._characterPrimitive);\n\n        var drawArrays = new __WEBPACK_IMPORTED_MODULE_5_osg_DrawArrays__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_primitiveSet__["a" /* default */].LINES, 0, 0);\n        this._graphPrimitive = drawArrays;\n        this._geometry.getPrimitives().push(this._graphPrimitive);\n    },\n    update: function() {\n        var nbTotalCharacters = this._captionNbVertexes + this._valuesNbVertexes;\n        this._characterPrimitive.setCount(nbTotalCharacters / 4 * 6);\n        this._graphPrimitive.setCount(this._graphsNbVertexes);\n        this._graphPrimitive.setFirst(nbTotalCharacters);\n\n        this._geometry.getAttributes().Vertex.dirty();\n    },\n    resetCaptions: function() {\n        this._nbVertexes = 0;\n        this._captionNbVertexes = 0;\n    },\n    resetValues: function() {\n        this._nbVertexes = this._captionNbVertexes;\n        this._valuesNbVertexes = 0;\n        this._graphsNbVertexes = 0;\n    },\n    captionsEnd: function() {\n        this._captionNbVertexes = this._nbVertexes;\n    },\n    valuesEnd: function() {\n        this._valuesNbVertexes = this._nbVertexes - this._captionNbVertexes;\n    },\n    graphsEnd: function() {\n        this._graphsNbVertexes =\n            this._nbVertexes - (this._valuesNbVertexes + this._captionNbVertexes);\n    },\n    getCharacterPrimitive: function() {\n        return this._characterPrimitive;\n    },\n    getGraphPrimitive: function() {\n        return this._graphPrimitive;\n    },\n    getNbVertexes: function() {\n        return this._nbVertexes;\n    }\n});\n\n/* harmony default export */ __webpack_exports__["a"] = (BufferStats);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/BufferStats.js\n// module id = 162\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/BufferStats.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n\nvar performance = window.performance;\n\nvar Counter = function(config) {\n    this._caption = config.caption;\n    this._accumValue = 0;\n    this._accumSamples = 0;\n    this._accumStart = 0;\n    this._value = 0;\n    this._averageValue = 0;\n    this._time = 0;\n    this._avgMs = 0;\n    this._over = config.over > 0.0 ? config.over : 0;\n    this._below = config.below > 0.0 ? config.below : 0;\n    this._graph = !!config.graph;\n    if (config.average) {\n        this._avgMs = config.avgMs ? config.avgMs : 1000;\n    }\n    this._display = false;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(Counter, {\n    isDisplayable: function() {\n        return this._display;\n    },\n    setDisplayable: function(boolean) {\n        this._display = boolean;\n    },\n    getOver: function() {\n        return this._over;\n    },\n    getBelow: function() {\n        return this._below;\n    },\n    getGraph: function() {\n        return this._graph;\n    },\n    getAverageMs: function() {\n        return this._avgMs;\n    },\n    getAverageValue: function() {\n        return this._averageValue;\n    },\n    getValue: function() {\n        return this._value;\n    },\n    average: function(value) {\n        if (!this._avgMs) return;\n\n        this._accumValue += value;\n        this._accumSamples++;\n        var t = performance.now();\n        if (t - this._accumStart > this._avgMs) {\n            this._averageValue = this._accumValue / this._accumSamples;\n            this._accumValue = 0;\n            this._accumStart = t;\n            this._accumSamples = 0;\n        }\n    },\n    start: function() {\n        this._display = true;\n        this._time = performance.now();\n    },\n    end: function() {\n        this._value = performance.now() - this._time;\n        this.average(this._value);\n    },\n    set: function(value) {\n        this._display = true;\n        this._value = value;\n        this.average(value);\n    },\n    tick: function() {\n        this.end();\n        this.start();\n    },\n    frame: function() {\n        var delta = performance.now() - this._time;\n        this.set(1000.0 / delta);\n        this.start();\n    }\n});\n\n/* harmony default export */ __webpack_exports__["a"] = (Counter);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/Counter.js\n// module id = 163\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/Counter.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n\n\n\n\nvar DefaultFont = 'Courier New';\n\nvar determineFontHeight = function(fontStyle) {\n    var body = document.getElementsByTagName('body')[0];\n    var dummy = document.createElement('div');\n    var dummyText = document.createTextNode('M');\n    dummy.appendChild(dummyText);\n    dummy.setAttribute('style', fontStyle);\n    body.appendChild(dummy);\n    var result = dummy.offsetHeight;\n    body.removeChild(dummy);\n    return result;\n};\n\nvar loadFont = function(fontFamily) {\n    return new __WEBPACK_IMPORTED_MODULE_1_bluebird___default.a(function(resolve, reject) {\n        window.WebFontConfig = {\n            google: {\n                families: [fontFamily + ':200']\n            },\n            active: function() {\n                resolve(fontFamily);\n            },\n            inactive: function(error) {\n                reject('loadFont error:' + error);\n            }\n        };\n        var wf = document.createElement('script'),\n            s = document.scripts[0];\n        wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';\n        wf.async = true;\n        wf.onerror = function() {\n            reject();\n        };\n        s.parentNode.insertBefore(wf, s);\n    });\n};\n\nvar TextGenerator = function() {\n    this._canvas = undefined;\n    this._characterHeight = 0;\n    this._characterWidth = 0;\n    this._fontSize = 16;\n    this._fontFamily = 'Source Code Pro';\n    this._characterFirstCode = ' '.charCodeAt();\n    this._characterLastCode = 'z'.charCodeAt();\n    this._characterSizeUV = 0;\n    this._backgroundColor = 'rgba(0,0,0,0.0)';\n    this._createCanvas();\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(TextGenerator, {\n    setFontSize: function(size) {\n        this._fontSize = size;\n    },\n    getCharacterWidth: function() {\n        return this._characterWidth;\n    },\n    getCharacterHeight: function() {\n        return this._characterHeight;\n    },\n    getCanvas: function() {\n        return this._promise;\n    },\n    getCharacterUV: function(characterCode) {\n        var index = characterCode - this._characterFirstCode;\n        return index * this._characterSizeUV;\n    },\n    _fillCanvas: function(fontFamily, fontSize) {\n        // get font height\n        var size = fontSize + 'px';\n        var style = 'font-family: ' + fontFamily + '; font-size: ' + size + ';';\n        var pixelHeight = determineFontHeight(style);\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].debug(fontFamily + ' ' + size + ' ==> ' + pixelHeight + ' pixels high.');\n\n        this._characterHeight = Math.ceil(pixelHeight);\n        var font = fontSize + \"px '\" + fontFamily + \"'\";\n        var canvas = document.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        this._canvas = canvas;\n        ctx.font = font;\n        ctx.textBaseline = 'middle';\n\n        this._characterWidth = ctx.measureText(' ').width;\n        this._characterWidth = Math.ceil(this._characterWidth);\n\n        var nbCharacters = this._characterLastCode - this._characterFirstCode + 1;\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].info(\n            'Stats character size ' +\n                this._characterWidth +\n                ' x ' +\n                this._characterHeight +\n                ' texture width ' +\n                this._characterWidth * nbCharacters\n        );\n\n        canvas.width = Math.ceil(this._characterWidth * nbCharacters);\n        canvas.height = this._characterHeight;\n\n        this._characterSizeUV = this._characterWidth / canvas.width;\n\n        ctx.font = font;\n        ctx.textBaseline = 'middle';\n        ctx.fillStyle = 'rgb(255,255,255)';\n        for (var i = this._characterFirstCode, j = 0; i <= this._characterLastCode; i++, j++) {\n            var code = String.fromCharCode(i);\n            var x = j * this._characterWidth;\n            var y = this._characterHeight / 2;\n            ctx.fillText(code, x, y);\n        }\n        return canvas;\n    },\n    _createCanvas: function() {\n        this._promise = loadFont(this._fontFamily)\n            .then(\n                function(fontFamily) {\n                    return this._fillCanvas(fontFamily, this._fontSize);\n                }.bind(this)\n            )\n            .catch(\n                function() {\n                    return this._fillCanvas(DefaultFont, this._fontSize);\n                }.bind(this)\n            );\n    }\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (TextGenerator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/TextGenerator.js\n// module id = 164\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/TextGenerator.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("var values = {\n    frame: {\n        caption: 'Total frame time',\n        over: 16,\n        average: true,\n        graph: true,\n        max: 4\n    },\n    stats: {\n        caption: 'stats',\n        over: 1,\n        graph: true\n    },\n    fps: {\n        caption: 'Framerate (FPS)',\n        below: 30,\n        average: true\n    },\n    raf: {\n        caption: 'Time since last rAF',\n        average: true,\n        avgMs: 500\n    },\n    update: {\n        caption: 'update',\n        average: true,\n        graph: true\n    },\n    cull: {\n        caption: 'cull',\n        average: true,\n        graph: true,\n        max: 16\n    },\n    render: {\n        caption: 'render',\n        average: true,\n        graph: true\n    },\n    glframe: {\n        caption: 'glframe',\n        average: true,\n        graph: true\n    },\n\n    textureused: {\n        caption: 'texture used'\n    },\n    texturereserved: {\n        caption: 'texture reserved'\n    },\n    texturetotal: {\n        caption: 'texture total'\n    },\n\n    pushstateset: {\n        caption: 'num pushStateSet'\n    },\n    applyStateSet: {\n        caption: 'num applyStateSet'\n    },\n    updatecallback: {\n        caption: 'num updateCallback'\n    },\n\n    cullcamera: {\n        caption: 'camera'\n    },\n    cullmatrixtransform: {\n        caption: 'matrixTransform'\n    },\n    cullprojection: {\n        caption: 'projection'\n    },\n    cullnode: {\n        caption: 'node'\n    },\n    culllightsource: {\n        caption: 'lightSource'\n    },\n    cullgeometry: {\n        caption: 'geometry'\n    }\n};\n\nvar groups = [\n    {\n        name: 'framerate',\n        caption: 'Framerate',\n        values: ['fps', 'raf']\n    },\n    {\n        name: 'frameBudget',\n        caption: 'Frame Budget',\n        base: 'frame',\n        values: ['frame', 'update', 'cull', 'render', 'glframe', 'stats']\n    },\n    {\n        name: 'sceneGraph',\n        caption: 'Scene Graph ',\n        values: ['pushstateset', 'updatecallback', 'applyStateSet']\n    },\n    {\n        name: 'cullVisitor',\n        caption: 'Cull',\n        values: [\n            'cullnode',\n            'cullmatrixtransform',\n            'cullcamera',\n            'culllighsource',\n            'cullprojection',\n            'cullgeometry'\n        ]\n    },\n    {\n        name: 'texture',\n        caption: 'Texture Memory',\n        values: ['texturereserved', 'textureused', 'texturetotal']\n    }\n];\n\nvar config = {\n    values: values,\n    groups: groups\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (config);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/defaultStats.js\n// module id = 165\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/defaultStats.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("var WebGLRenderingContext = window.WebGLRenderingContext;\nvar WebGL2RenderingContext = window.WebGL2RenderingContext;\n\nvar contextList = [WebGLRenderingContext, WebGL2RenderingContext];\n\nvar glProxy = function(f, c) {\n    return function() {\n        c.apply(this, arguments);\n        f.apply(this, arguments);\n    };\n};\n\nvar totalDrawArraysCalls = 0,\n    totalDrawElementsCalls = 0,\n    totalUseProgramCalls = 0,\n    totalFaces = 0,\n    totalVertices = 0,\n    totalPoints = 0,\n    totalBindTexures = 0;\nvar statsVertices = 0,\n    statsFaces = 0,\n    statsLines = 0;\n\nvar init = function() {\n    var hasContext = false;\n    for (var i = 0; i < contextList.length; i++) {\n        var WebGLContext = contextList[i];\n        if (!WebGLContext) continue;\n\n        hasContext = true;\n        WebGLContext.prototype.drawArrays = glProxy(WebGLContext.prototype.drawArrays, function() {\n            totalDrawArraysCalls++;\n            if (arguments[0] === this.POINTS) totalPoints += arguments[2];\n            else totalVertices += arguments[2];\n        });\n        WebGLContext.prototype.drawElements = glProxy(\n            WebGLContext.prototype.drawElements,\n            function() {\n                totalDrawElementsCalls++;\n                totalFaces += arguments[1] / 3;\n                totalVertices += arguments[1];\n            }\n        );\n\n        WebGLContext.prototype.useProgram = glProxy(WebGLContext.prototype.useProgram, function() {\n            totalUseProgramCalls++;\n        });\n\n        WebGLContext.prototype.bindTexture = glProxy(\n            WebGLContext.prototype.bindTexture,\n            function() {\n                totalBindTexures++;\n            }\n        );\n    }\n    return hasContext;\n};\n\nvar update = function(stats) {\n    var bufferStats = stats.getBufferStats();\n    var nbVertexes = bufferStats.getNbVertexes();\n    var drawElements = bufferStats.getCharacterPrimitive();\n    var drawArrays = bufferStats.getGraphPrimitive();\n\n    // substracts stats from regular gl stats\n    totalDrawElementsCalls -= 1; // one drawcall for characters\n    if (drawArrays.getCount()) totalDrawArraysCalls -= 1; // one draw array for graph\n    totalBindTexures -= 2;\n    totalUseProgramCalls -= 1;\n    totalVertices -= drawElements.getCount() + drawArrays.getCount();\n    totalFaces -= drawElements.getCount() / 3;\n\n    statsVertices = nbVertexes;\n    statsFaces = drawElements.getCount() / 3;\n    statsLines = drawArrays.getCount() / 2;\n\n    stats.getCounter('glDrawCalls').set(totalDrawElementsCalls + totalDrawArraysCalls);\n    stats.getCounter('glDrawElements').set(totalDrawElementsCalls);\n    stats.getCounter('glDrawArrays').set(totalDrawArraysCalls);\n    stats.getCounter('glBindTexture').set(totalBindTexures);\n    stats.getCounter('glUseProgram').set(totalUseProgramCalls);\n    stats.getCounter('glFaces').set(totalFaces);\n    stats.getCounter('glVertices').set(totalVertices);\n    stats.getCounter('glPoints').set(totalPoints);\n\n    stats.getCounter('statsVertices').set(statsVertices);\n    stats.getCounter('statsFaces').set(statsFaces);\n    stats.getCounter('statsLines').set(statsLines);\n\n    statsVertices = 0;\n    statsFaces = 0;\n    statsLines = 0;\n    totalDrawArraysCalls = 0;\n    totalDrawElementsCalls = 0;\n    totalUseProgramCalls = 0;\n    totalFaces = 0;\n    totalVertices = 0;\n    totalPoints = 0;\n    totalBindTexures = 0;\n}.bind(this);\n\nvar config = {\n    values: {\n        glDrawCalls: {\n            caption: 'drawCalls'\n        },\n        glDrawElements: {\n            caption: 'drawElements'\n        },\n        glDrawArrays: {\n            caption: 'drawArrays'\n        },\n        glBindTexture: {\n            caption: 'bindTexture'\n        },\n        glUseProgram: {\n            caption: 'useProgram'\n        },\n        glFaces: {\n            caption: 'totalFaces'\n        },\n        glVertices: {\n            caption: 'totalVertices'\n        },\n        glPoints: {\n            caption: 'totalPoints'\n        },\n        statsFaces: {\n            caption: 'statsFaces'\n        },\n        statsVertices: {\n            caption: 'statsVertices'\n        },\n        statsLines: {\n            caption: 'statsLines'\n        }\n    },\n    groups: [\n        {\n            name: 'webgl',\n            caption: 'WebGL',\n            values: [\n                'glDrawCalls',\n                'glDrawElements',\n                'glDrawArrays',\n                'glUseProgram',\n                'glBindTexture',\n                'glFaces',\n                'glVertices',\n                'glPoints',\n                'statsVertices',\n                'statsFaces',\n                'statsLines'\n            ]\n        }\n    ],\n    update: update,\n    init: init\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (config);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/glStats.js\n// module id = 166\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/glStats.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\nvar memory = undefined;\n\nvar log1024 = Math.log(1024);\nvar size = function(v) {\n    var precision = 100; //Math.pow(10, 2);\n    var i = Math.floor(Math.log(v) / log1024);\n    if (v === 0) i = 1;\n    return Math.round(v * precision / Math.pow(1024, i)) / precision; // + ' ' + sizes[i];\n};\n\nvar init = function() {\n    if (window.performance && window.performance.memory) memory = window.performance.memory;\n    if (!memory || memory.totalJSHeapSize === 0) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].warn('Stats will not report memory, not supported by your browse');\n    }\n    return !!memory;\n};\n\nvar update = function(stats) {\n    var usedJSHeapSize = 0;\n    var totalJSHeapSize = 0;\n    if (memory) {\n        usedJSHeapSize = size(memory.usedJSHeapSize);\n        totalJSHeapSize = size(memory.totalJSHeapSize);\n    }\n    stats.getCounter('browserMemory').set(usedJSHeapSize);\n    stats.getCounter('browserMemoryTotal').set(totalJSHeapSize);\n};\n\nvar config = {\n    values: {\n        browserMemory: {\n            caption: 'Used Memory',\n            average: true,\n            avgMs: 1000\n        },\n        browserMemoryTotal: {\n            caption: 'Total Memory'\n        }\n    },\n    groups: [\n        {\n            name: 'browser',\n            caption: 'Browser',\n            values: ['browserMemory', 'browserMemoryTotal']\n        }\n    ],\n    update: update,\n    init: init\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (config);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/browserStats.js\n// module id = 167\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/browserStats.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\n// Used to notify the Compiler to create a Depth Casting optimized shader\nvar ShadowCastAttribute = function(disable, shadowReceiveAttribute) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].call(this);\n    this._enable = !disable;\n    this._shadowReceiveAttribute = shadowReceiveAttribute;\n    this._dirtyHash = true;\n    this._hash = '';\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    ShadowCastAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].prototype, {\n        attributeType: 'ShadowCast',\n        cloneType: function() {\n            return new ShadowCastAttribute(true);\n        },\n        setReceiveAttribute: function(shadowReceiveAttribute) {\n            this._shadowReceiveAttribute = shadowReceiveAttribute;\n        },\n        getReceiveAttribute: function() {\n            return this._shadowReceiveAttribute;\n        },\n        getDefines: function() {\n            return this._shadowReceiveAttribute.getDefines();\n        },\n        _computeInternalHash: function() {\n            return 'ShadowCast' + this._enable + this._shadowReceiveAttribute.getPrecision();\n        },\n        getHash: function() {\n            var receiveAttributeDirty = false;\n            if (this._shadowReceiveAttribute && this._shadowReceiveAttribute._dirtyHash)\n                this._receiveAttributeDirty = true;\n\n            if (!this._dirtyHash && !receiveAttributeDirty) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        },\n        // need a isEnabled to let the ShaderGenerator to filter\n        // StateAttribute from the shader compilation\n        isEnabled: function() {\n            return this._enable;\n        }\n    }),\n    'osgShadow',\n    'ShadowCastAttribute'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ShadowCastAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowCastAttribute.js\n// module id = 168\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowCastAttribute.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Light__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_LightSource__ = __webpack_require__(79);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_utils__ = __webpack_require__(0);\n\n\n\n\n\n\n\n\n/*\n * Remove nodes that shouldn\'t not be culled when casting\n * like lights, camera with render texture targets,\n * transparent (alphablended) geometries\n * (otherwise it might break things)\n * visits whole underlying scene recursively\n */\nvar ShadowCasterVisitor = function(mask) {\n    __WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__["a" /* default */].call(this);\n    // mask setting to avoid casting shadows\n    this._noCastMask = mask;\n    this._nodeList = [];\n};\n\n__WEBPACK_IMPORTED_MODULE_6_osg_utils__["a" /* default */].createPrototypeObject(\n    ShadowCasterVisitor,\n    __WEBPACK_IMPORTED_MODULE_6_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_5_osg_NodeVisitor__["a" /* default */].prototype, {\n        reset: function() {\n            this._nodeList = [];\n        },\n        removeNodeFromCasting: function(node) {\n            /*jshint bitwise: false */\n\n            var nm = node.getNodeMask();\n            // ~0x0 as not to be processed\n\n            if (nm === ~0x0) {\n                // set to avoid casting shadow\n                nm = this._noCastMask;\n                node.setNodeMask(nm);\n                this._nodeList.push(node);\n            } else if ((nm & ~this._noCastMask) !== 0) {\n                // set to avoid casting shadow\n                node.setNodeMask(nm | this._noCastMask);\n                this._nodeList.push(node);\n            }\n            /*jshint bitwise: true */\n        },\n        // Visiting whole casting scene recursively\n        apply: function(node) {\n            // check that and other things ?\n            // TODO: should check whole hierarchy to check for override/protected/etc\n            // Depth, BlendFunc Attributes...\n            var st = node.getStateSet();\n            if (st) {\n                // check for transparency not casting shadows\n                // as no alpha blending transparency shadow (no transmittance support)\n                var blend = st.getAttribute(\'BlendFunc\');\n                if (blend !== undefined && blend.getSource() !== __WEBPACK_IMPORTED_MODULE_0_osg_BlendFunc__["a" /* default */].DISABLE) {\n                    var depth = st.getAttribute(\'Depth\');\n                    if (\n                        depth &&\n                        (depth.getFunc() === __WEBPACK_IMPORTED_MODULE_2_osg_Depth__["a" /* default */].DISABLE || depth.getWriteMask() === false)\n                    ) {\n                        this.removeNodeFromCasting(node);\n                        return;\n                    }\n                }\n            }\n\n            // check for lights, as lights are positionned attributes\n            if (node.getTypeID() === __WEBPACK_IMPORTED_MODULE_3_osg_Light__["a" /* default */].typeID || node.getTypeID() === __WEBPACK_IMPORTED_MODULE_4_osg_LightSource__["a" /* default */].typeID) {\n                this.removeNodeFromCasting(node);\n                return;\n            } else if (node.getTypeID() === __WEBPACK_IMPORTED_MODULE_1_osg_Camera__["a" /* default */].typeID && node.isRenderToTextureCamera()) {\n                // no "Subrender" when rendering the shadow map as from light point of view\n                this.removeNodeFromCasting(node);\n                return;\n            }\n            this.traverse(node);\n        },\n\n        setNoCastMask: function(mask) {\n            this._noCastMask = mask;\n        },\n\n        // restore to any previous mask avoiding any breaks\n        // in other application mask usage.\n        restore: function() {\n            for (var i = 0, l = this._nodeList.length; i < l; i++) {\n                var node = this._nodeList[i];\n                var nm = node.getNodeMask();\n\n                if (nm === this._noCastMask) {\n                    node.setNodeMask(~0x0);\n                } else {\n                    node.setNodeMask(nm & ~this._noCastMask);\n                }\n            }\n        }\n    }),\n    \'osgShadow\',\n    \'ShadowCasterVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ShadowCasterVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowCasterVisitor.js\n// module id = 169\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowCasterVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_CullVisitor__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgUtil_debug__ = __webpack_require__(151);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osg_Viewport__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osg_WebGLCaps__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osgShadow_ShadowReceiveAttribute__ = __webpack_require__(171);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osgShadow_ShadowCastAttribute__ = __webpack_require__(168);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21_osgShadow_ShadowTechnique__ = __webpack_require__(99);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22_osgShadow_ShadowTexture__ = __webpack_require__(100);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23_osg_Scissor__ = __webpack_require__(87);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Custom camera cull callback\n// we customize it just to avoid to add extra \'virtual\' function\n// on the shadowTecnique class\nvar CameraCullCallback = function(shadowTechnique) {\n    this._shadowTechnique = shadowTechnique;\n};\n\n__WEBPACK_IMPORTED_MODULE_15_osg_utils__["a" /* default */].createPrototypeObject(\n    CameraCullCallback,\n    {\n        cull: function(node, nv) {\n            this._shadowTechnique.getShadowedScene().nodeTraverse(nv);\n\n            var cs = nv.getCurrentCullingSet();\n            var m = nv.getCurrentProjectionMatrix();\n            var near = nv.getComputedNear(),\n                far = nv.getComputedFar();\n\n            if (near === Infinity && far === -Infinity) {\n                this._shadowTechnique.markSceneAsNoShadow();\n                return false;\n            }\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].getFrustumPlanes(\n                cs.getFrustum().getPlanes(),\n                m,\n                nv.getCurrentModelViewMatrix(),\n                false\n            );\n            cs.getFrustum().setupMask(6);\n            this._shadowTechnique.setLightFrustum(cs.getFrustum(), near, far);\n\n            return false;\n        }\n    },\n    \'osgShadow\',\n    \'CameraCullCallback\'\n);\n\n/**\n *  ShadowMap provides an implementation of shadow textures.\n *  @class ShadowMap\n */\nvar ShadowMap = function(settings, shadowTexture) {\n    __WEBPACK_IMPORTED_MODULE_21_osgShadow_ShadowTechnique__["a" /* default */].call(this);\n\n    this._projectionMatrix = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].create();\n    this._projection = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n    this._viewMatrix = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].create();\n    this._lightNumberArrayIndex = -1;\n    this._lightUp = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n\n    this._light = settings.light;\n\n    // data\n    this._cameraShadow = new __WEBPACK_IMPORTED_MODULE_0_osg_Camera__["a" /* default */]();\n    this._cameraShadow.setCullCallback(new CameraCullCallback(this));\n    this._cameraShadow.setRenderOrder(__WEBPACK_IMPORTED_MODULE_0_osg_Camera__["a" /* default */].PRE_RENDER, 0);\n    this._cameraShadow.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_13_osg_Transform__["a" /* default */].ABSOLUTE_RF);\n    this._cameraShadow.setClearColor(__WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 1.0, 1.0, 1.0));\n\n    if (shadowTexture) {\n        this._texture = shadowTexture;\n    } else {\n        this._texture = new __WEBPACK_IMPORTED_MODULE_22_osgShadow_ShadowTexture__["a" /* default */]();\n        this._textureUnitBase = 4;\n        this._textureUnit = this._textureUnitBase;\n\n        // see shadowSettings.js header for param explanations\n        this._textureMagFilter = undefined;\n        this._textureMinFilter = undefined;\n    }\n\n    this._textureSize = 256;\n    var unifRenderSize = __WEBPACK_IMPORTED_MODULE_14_osg_Uniform__["a" /* default */].createFloat2(\'RenderSize\');\n    this._texelSizeUniform = __WEBPACK_IMPORTED_MODULE_14_osg_Uniform__["a" /* default */].createFloat1(1.0 / this._textureSize, \'texelSize\');\n    this._renderSize = unifRenderSize.getInternalArray();\n    this._renderSize[0] = this._renderSize[1] = this._textureSize;\n\n    this._receivingStateset = undefined;\n\n    this._casterStateSet = new __WEBPACK_IMPORTED_MODULE_10_osg_StateSet__["a" /* default */]();\n    this._casterStateSet.addUniform(__WEBPACK_IMPORTED_MODULE_14_osg_Uniform__["a" /* default */].createFloat1(0, \'exponent0\'));\n    this._casterStateSet.addUniform(__WEBPACK_IMPORTED_MODULE_14_osg_Uniform__["a" /* default */].createFloat1(0, \'exponent1\'));\n    this._casterStateSet.addUniform(__WEBPACK_IMPORTED_MODULE_14_osg_Uniform__["a" /* default */].createFloat1(0.005, \'bias\'));\n    this._casterStateSet.addUniform(this._texelSizeUniform);\n    this._casterStateSet.addUniform(unifRenderSize);\n\n    // make sure no unintended blend happens\n    // if casting semi-transparent (alphablend material with full opaque pixels) shadow\n    this._casterStateSet.setAttributeAndModes(\n        new __WEBPACK_IMPORTED_MODULE_3_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_Depth__["a" /* default */].LESS),\n        __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE\n    );\n    this._casterStateSet.setAttributeAndModes(\n        new __WEBPACK_IMPORTED_MODULE_2_osg_BlendFunc__["a" /* default */](),\n        __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE\n    );\n\n    this._shadowReceiveAttribute = new __WEBPACK_IMPORTED_MODULE_19_osgShadow_ShadowReceiveAttribute__["a" /* default */](this._light.getLightNumber());\n    this._casterStateSet.setAttributeAndModes(\n        this._shadowReceiveAttribute,\n        __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE\n    );\n\n    // default name, overridable with shadow settings\n    this._shadowCastShaderGeneratorName = \'ShadowCast\';\n\n    var near = 0.001;\n    var far = 1000;\n    var unifRange = __WEBPACK_IMPORTED_MODULE_14_osg_Uniform__["a" /* default */].createFloat4(\'uShadowDepthRange\');\n    this._casterStateSet.addUniform(unifRange);\n    this._depthRange = unifRange.getInternalArray();\n    this._depthRange[0] = near;\n    this._depthRange[1] = far;\n\n    this._worldLightPos = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].create();\n    this._worldLightPos[3] = 0;\n    this._worldLightDir = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].create();\n    this._worldLightDir[3] = 1;\n\n    this._castsShadowDrawTraversalMask = 0xffffffff;\n    this._castsShadowBoundsTraversalMask = 0xffffffff;\n\n    this._shaderProcessor = undefined;\n\n    // tmp variables\n    this._tmpVec = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n    this._tmpVecBis = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n    this._tmpVecTercio = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n    this._tmpMatrix = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].create();\n\n    if (settings) this.setShadowSettings(settings);\n\n    this._infiniteFrustum = true;\n    var shadowStateAttribute = new __WEBPACK_IMPORTED_MODULE_20_osgShadow_ShadowCastAttribute__["a" /* default */](false, this._shadowReceiveAttribute);\n\n    this._casterStateSet.setAttributeAndModes(\n        shadowStateAttribute,\n        __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE\n    );\n    this._casterStateSet.setShaderGeneratorName(\n        this._shadowCastShaderGeneratorName,\n        __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON\n    );\n\n    this._debug = false;\n};\n\n/** @lends ShadowMap.prototype */\n__WEBPACK_IMPORTED_MODULE_15_osg_utils__["a" /* default */].createPrototypeObject(\n    ShadowMap,\n    __WEBPACK_IMPORTED_MODULE_15_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_21_osgShadow_ShadowTechnique__["a" /* default */].prototype, {\n        getDepthRange: function() {\n            return this._depthRange;\n        },\n        setLightFrustum: function(lf, near, far) {\n            this._lightFrustum = lf;\n\n            this._depthRange[0] = near;\n            this._depthRange[1] = far;\n            this.nearFarBounding();\n\n            if (this._debug) {\n                this._debugGeomFrustum.updateGeometry(this._projectionMatrix, this._depthRange);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].invert(this._debugNodeFrustum.getMatrix(), this._viewMatrix);\n            }\n        },\n        getCamera: function() {\n            return this._cameraShadow;\n        },\n\n        getTexture: function() {\n            return this._texture;\n        },\n\n        isDirty: function() {\n            return this._dirty;\n        },\n        /**\n         * at which Texture unit number we start adding texture shadow\n         */\n        setTextureUnitBase: function(unitBase) {\n            this._textureUnitBase = unitBase;\n            this._textureUnit = unitBase;\n        },\n\n        /* Sets  shadowSettings\n     */\n        setShadowSettings: function(shadowSettings) {\n            if (!shadowSettings) return;\n\n            this._light = shadowSettings.light;\n            this._shadowCastShaderGeneratorName = shadowSettings.getShadowCastShaderGeneratorName();\n\n            this.setCastsShadowDrawTraversalMask(shadowSettings.castsShadowDrawTraversalMask);\n            this.setCastsShadowBoundsTraversalMask(shadowSettings.castsShadowBoundsTraversalMask);\n\n            this.setLight(this._light);\n            this.setTextureSize(shadowSettings.textureSize);\n            this.setTexturePrecision(shadowSettings.textureType);\n\n            this.setKernelSizePCF(shadowSettings.kernelSizePCF);\n            this.setBias(shadowSettings.bias);\n            this.setNormalBias(shadowSettings.normalBias);\n        },\n\n        setCastsShadowDrawTraversalMask: function(mask) {\n            this._castsShadowDrawTraversalMask = mask;\n        },\n\n        getCastsShadowDrawTraversalMask: function() {\n            return this._castsDrawShadowTraversalMask;\n        },\n\n        setCastsShadowBoundsTraversalMask: function(mask) {\n            this._castsShadowBoundsTraversalMask = mask;\n        },\n\n        getCastsShadowBoundsTraversalMask: function() {\n            return this._castsShadowBoundsTraversalMask;\n        },\n\n        getNormalBias: function() {\n            return this._shadowReceiveAttribute.getNormalBias();\n        },\n\n        setNormalBias: function(value) {\n            this._shadowReceiveAttribute.setNormalBias(value);\n        },\n\n        getJitterOffset: function() {\n            return this._shadowReceiveAttribute.getJitterOffset();\n        },\n\n        setJitterOffset: function(value) {\n            this._shadowReceiveAttribute.setJitterOffset(value);\n        },\n\n        getBias: function() {\n            return this._shadowReceiveAttribute.getBias();\n        },\n\n        setBias: function(value) {\n            this._shadowReceiveAttribute.setBias(value);\n            var uniform = this._casterStateSet.getUniformList().bias.getUniform();\n            uniform.setFloat(value);\n        },\n\n        getKernelSizePCF: function() {\n            return this._shadowReceiveAttribute.getKernelSizePCF();\n        },\n\n        setKernelSizePCF: function(value) {\n            this._shadowReceiveAttribute.setKernelSizePCF(value);\n        },\n\n        setShadowedScene: function(shadowedScene) {\n            __WEBPACK_IMPORTED_MODULE_21_osgShadow_ShadowTechnique__["a" /* default */].prototype.setShadowedScene.call(this, shadowedScene);\n            this._receivingStateset = this._shadowedScene.getReceivingStateSet();\n            this.dirty();\n        },\n\n        checkLightNumber: function() {\n            var lightNumber = this._light.getLightNumber();\n\n            // if light number changed we need to remove cleanly\n            // attributes from receiveStateSet\n            // it\'s because it use a typemember like light attribute\n            // so the number if very important to keep State clean\n            if (this._shadowReceiveAttribute.getLightNumber() !== lightNumber) {\n                if (\n                    this._receivingStateset.getAttribute(\n                        this._shadowReceiveAttribute.getTypeMember()\n                    ) === this._shadowReceiveAttribute\n                )\n                    this._receivingStateset.removeAttribute(\n                        this._shadowReceiveAttribute.getTypeMember()\n                    );\n            }\n\n            /*develblock:start*/\n            __WEBPACK_IMPORTED_MODULE_7_osg_notify__["a" /* default */].assert(\n                this._shadowReceiveAttribute.getTypeMember() ===\n                    this._shadowReceiveAttribute.attributeType + lightNumber,\n                \'TypeMember isnt reflecting light number\' +\n                    this._shadowReceiveAttribute.getTypeMember() +\n                    \' !== \' +\n                    this._shadowReceiveAttribute.attributeType +\n                    lightNumber\n            );\n            /*develblock:end*/\n\n            if (this._texture && !this._texture.hasLightNumber(lightNumber)) {\n                // remove this._texture, but not if it\'s not this._texture\n                if (\n                    this._receivingStateset.getTextureAttribute(\n                        this._textureUnit,\n                        this._texture.getTypeMember()\n                    ) === this._texture\n                )\n                    this._receivingStateset.removeTextureAttribute(\n                        this._textureUnit,\n                        this._texture.getTypeMember()\n                    );\n            }\n        },\n\n        _rebindFbo: function() {\n            this._cameraShadow.detachAll();\n            this._cameraShadow.attachTexture(__WEBPACK_IMPORTED_MODULE_4_osg_FrameBufferObject__["a" /* default */].COLOR_ATTACHMENT0, this._texture);\n            this._cameraShadow.attachRenderBuffer(\n                __WEBPACK_IMPORTED_MODULE_4_osg_FrameBufferObject__["a" /* default */].DEPTH_ATTACHMENT,\n                __WEBPACK_IMPORTED_MODULE_4_osg_FrameBufferObject__["a" /* default */].DEPTH_COMPONENT16\n            );\n        },\n\n        /** initialize the ShadowedScene and local cached data structures.*/\n        init: function(atlasTexture, lightIndex, textureUnit) {\n            if (!this._shadowedScene) return;\n\n            this._needRedraw = true;\n\n            this.checkLightNumber();\n\n            var lightNumber = this._light.getLightNumber();\n\n            if (!atlasTexture) {\n                this.initTexture();\n                this._rebindFbo();\n                this._textureUnit = this._textureUnitBase + lightNumber;\n                this._texture.setLightNumber(lightNumber);\n                this._texture.setName(\'ShadowTexture\' + this._textureUnit);\n                this._shadowReceiveAttribute.setAtlas(false);\n            } else {\n                this._texture = atlasTexture;\n\n                // allow indexing properties in the texture uniforms\n                this._lightNumberArrayIndex = lightIndex;\n                this._textureUnit = textureUnit;\n                this._shadowReceiveAttribute.setAtlas(true);\n            }\n\n            this._cameraShadow.setName(\'light_shadow_camera\' + this._light.getName());\n            this._shadowReceiveAttribute.setLightNumber(lightNumber);\n\n            // Idea is to make sure the null texture is "binded" to all shadow casting scene\n            // so we override all existing texture bind in the scene, preventing any texture bind.\n            // When user implements alpha mask casting, they use PROTECTED to prevent OVERRIDE to remove their alpha mask texture needed.\n            var fullOverride = __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON;\n\n            this._receivingStateset.setAttributeAndModes(\n                this._shadowReceiveAttribute,\n                fullOverride\n            );\n\n            // prevent unnecessary texture bindings\n            this._preventTextureBindingDuringShadowCasting();\n\n            // Mandatory: prevent binding shadow textures themselves\n            // ( ShadowedScene StateSet is applied  just above in StateSet hierarchy)\n            // that would mean undefined values as it would be read/write access...\n            // So we force it against Texture.null binding done just above (PROTECTED)\n            // and Prevent any under hierarchy bind with OVERRIDE\n            // must be done AFTER the prevent binding.\n            this._casterStateSet.setTextureAttributeAndModes(\n                this._textureUnit,\n                __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].textureNull,\n                __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].PROTECTED\n            );\n\n            // add shadow texture to the receivers\n            // should make sure somehow that\n            // alpha blender transparent receiver doesn\'t use it\n            // compiler wise at least\n            this._receivingStateset.setTextureAttributeAndModes(\n                this._textureUnit,\n                this._texture,\n                fullOverride\n            );\n\n            this._dirty = false;\n        },\n        // Make sure we don\'t bind texture and thus make GPU work for nothing\n        // as shadow casting just output Depth ( no color )\n        // os we set a null texture and OVERRIDE StateAttribute flag\n        // only case you want to use a texture is\n        // alpha masked material, then you have StateAttribute to \'PROTECTED\'\n        _preventTextureBindingDuringShadowCasting: function() {\n            // prevent unnecessary texture bindings on all texture unit\n            var shouldGetMaxTextureUnits = __WEBPACK_IMPORTED_MODULE_18_osg_WebGLCaps__["a" /* default */].instance().getWebGLParameter(\n                \'MAX_TEXTURE_IMAGE_UNITS\'\n            );\n            for (var k = 0; k < shouldGetMaxTextureUnits; k++) {\n                // bind  null texture which OSGJS will not bind,\n                // effectively preventing any other texture bind\n                // just not touching texture unit state.\n                this._casterStateSet.setTextureAttributeAndModes(\n                    k,\n                    __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].textureNull,\n                    __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].OVERRIDE | __WEBPACK_IMPORTED_MODULE_9_osg_StateAttribute__["a" /* default */].ON\n                );\n            }\n        },\n        valid: function() {\n            // checks\n            return true;\n        },\n\n        updateShadowTechnique: function(nv, viewportDimension, frameBufferObject) {\n            var camera = this._cameraShadow;\n            var texture = this._texture;\n\n            if (camera && texture) {\n                var vp = camera.getViewport();\n\n                if (!vp) {\n                    vp = new __WEBPACK_IMPORTED_MODULE_17_osg_Viewport__["a" /* default */]();\n                    camera.setViewport(vp);\n                }\n\n                if (viewportDimension) {\n                    var scissor = camera.getScissor();\n                    if (!scissor) {\n                        scissor = new __WEBPACK_IMPORTED_MODULE_23_osg_Scissor__["a" /* default */](\n                            viewportDimension[0],\n                            viewportDimension[1],\n                            viewportDimension[2],\n                            viewportDimension[3]\n                        );\n                        camera.setScissor(scissor);\n                    }\n\n                    // if texture size changed update the camera rtt params\n                    if (\n                        vp.x() !== viewportDimension[0] ||\n                        vp.y() !== viewportDimension[1] ||\n                        vp.width() !== viewportDimension[2] ||\n                        vp.height() !== viewportDimension[3]\n                    ) {\n                        camera.setFrameBufferObject(frameBufferObject);\n                        vp.setViewport(\n                            viewportDimension[0],\n                            viewportDimension[1],\n                            viewportDimension[2],\n                            viewportDimension[3]\n                        );\n\n                        scissor.setScissor(\n                            viewportDimension[0],\n                            viewportDimension[1],\n                            viewportDimension[2],\n                            viewportDimension[3]\n                        );\n                    }\n                } else if (\n                    vp.width() !== texture.getWidth() ||\n                    vp.height() !== texture.getHeight()\n                ) {\n                    // if texture size changed update the camera rtt params\n                    this._rebindFbo();\n                    vp.setViewport(0, 0, texture.getWidth(), texture.getHeight());\n                }\n            }\n        },\n\n        updateShadowTechnic: function(/*nv*/) {\n            __WEBPACK_IMPORTED_MODULE_7_osg_notify__["a" /* default */].log(\n                \'ShadowMap.updateShadowTechnic() is deprecated, use updateShadowTechnique instead\'\n            );\n            this.updateShadowTechnique();\n        },\n\n        setTextureFiltering: function() {\n            var textureType;\n            var texType = this.getTexturePrecision();\n            switch (texType) {\n                case \'HALF_FLOAT\':\n                    textureType = __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].HALF_FLOAT;\n                    break;\n                case \'FLOAT\':\n                    textureType = __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].FLOAT;\n                    break;\n                default:\n                case \'UNSIGNED_BYTE\':\n                    textureType = __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].UNSIGNED_BYTE;\n                    break;\n            }\n\n            this._texture.setInternalFormatType(textureType);\n            this._texture.setMinFilter(__WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].NEAREST);\n            this._texture.setMagFilter(__WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].NEAREST);\n            this._textureMagFilter = __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].NEAREST;\n            this._textureMinFilter = __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].NEAREST;\n        },\n\n        // internal texture allocation\n        // handle any change like resize, filter param, etc.\n        initTexture: function() {\n            if (!this._dirty) return;\n\n            if (!this._texture) {\n                this._texture = new __WEBPACK_IMPORTED_MODULE_22_osgShadow_ShadowTexture__["a" /* default */]();\n                this._textureUnit = this._textureUnitBase;\n            }\n\n            this._texture.setTextureSize(this._textureSize, this._textureSize);\n            this._texelSizeUniform.setFloat(1.0 / this._textureSize);\n            this._renderSize[0] = this._textureSize;\n            this._renderSize[1] = this._textureSize;\n\n            var textureFormat;\n            // luminance Float format ?\n            textureFormat = __WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].RGBA;\n\n            this.setTextureFiltering();\n            this._texture.setInternalFormat(textureFormat);\n\n            this._texture.setWrapS(__WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].CLAMP_TO_EDGE);\n            this._texture.setWrapT(__WEBPACK_IMPORTED_MODULE_12_osg_Texture__["default"].CLAMP_TO_EDGE);\n\n            this._texture.dirty();\n        },\n        setTexturePrecision: function(format) {\n            if (format === this._shadowReceiveAttribute.getPrecision()) return;\n\n            this._shadowReceiveAttribute.setPrecision(format);\n            this.dirty();\n        },\n\n        getTexturePrecision: function() {\n            return this._shadowReceiveAttribute.getPrecision();\n        },\n\n        setTextureSize: function(mapSize) {\n            if (mapSize === this._textureSize) return;\n\n            this._textureSize = mapSize;\n\n            this.dirty();\n        },\n\n        getCasterStateSet: function() {\n            return this._casterStateSet;\n        },\n\n        setLight: function(light) {\n            if (!light || light === this._light) return;\n\n            this._light = light;\n            this.dirty();\n        },\n\n        getUp: function(dir) {\n            //avoid dir/up wrong angle breaking computation\n\n            // compute a up vector ensuring avoiding parallel vectors\n            // also might reverting to it once got the change here done once\n            // vec3.fromValues( 0.0, 0.0, 1.0 );\n\n            if (Math.abs(__WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].dot(this._lightUp, dir)) >= 1.0) {\n                // another camera up\n                // vec3.fromValues( 1.0, 0.0, 0.0 );\n                if (this._lightUp[0] === 1.0) {\n                    this._lightUp[0] = 0.0;\n                    this._lightUp[1] = 1.0;\n                    this._lightUp[2] = 0.0;\n                } else {\n                    this._lightUp[0] = 1.0;\n                    this._lightUp[1] = 0.0;\n                    this._lightUp[2] = 0.0;\n                }\n            }\n            return this._lightUp;\n        },\n\n        // makes sure we don\'t have incorrect near/far\n        // or we actually have to render something.\n        // Empty or Bad Frustums\n        // No objects, handle it gracefully\n        nearFarBounding: function() {\n            var zNear = this._depthRange[0];\n            var zFar = this._depthRange[1];\n\n            var epsilon = ShadowMap.EPSILON;\n            if (zFar < zNear - epsilon) {\n                // early out\n                this._emptyCasterScene = true;\n                zFar = 1;\n                zNear = epsilon;\n            } else if (zNear < epsilon) {\n                zNear = epsilon;\n            }\n\n            this._depthRange[0] = zNear;\n            this._depthRange[1] = zFar;\n        },\n\n        makePerspectiveFromBoundingBox: function(bbox, fov, eyePos, eyeDir, view, projection) {\n            var center = bbox.center(this._tmpVec);\n            var radius = bbox.radius();\n            var epsilon = ShadowMap.EPSILON;\n            var zNear = epsilon;\n            var zFar = 1.0;\n\n            this._radius = radius;\n\n            var distance = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].distance(center, eyePos);\n            // inside or not have influence\n            // on using radius for fov\n            if (distance <= radius) {\n                // shhh.. we\'re inside !\n                // sphere center is in front\n                zNear = epsilon;\n                zFar = distance + radius;\n            } else {\n                //  Sphere totally in front\n                // long distance runner\n                // we must make a nicer zNear here!\n                zNear = distance - radius;\n                zFar = distance + radius;\n            }\n\n            this._depthRange[0] = zNear;\n            this._depthRange[1] = zFar;\n            this.nearFarBounding();\n\n            // positional light: spot, point, area\n            //  fov < 180.0\n            // statically defined by spot, only needs zNear zFar estimates\n            var fovRadius = this._depthRange[0] * Math.tan(fov * Math.PI / 180.0);\n            // if scene radius is smaller than fov on scene\n            // Tighten and enhance precision\n            fovRadius = fovRadius > radius ? radius : fovRadius;\n\n            var ymax = fovRadius;\n            var ymin = -ymax;\n\n            var xmax = fovRadius;\n            var xmin = -xmax;\n\n            var up = this.getUp(eyeDir);\n\n            if (this._infiniteFrustum) {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].infiniteFrustum(projection, xmin, xmax, ymin, ymax, this._depthRange[0]);\n            } else {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].frustum(\n                    projection,\n                    xmin,\n                    xmax,\n                    ymin,\n                    ymax,\n                    this._depthRange[0],\n                    this._depthRange[1]\n                );\n            }\n\n            this._projection[0] = this._projectionMatrix[0];\n            this._projection[1] = this._projectionMatrix[5];\n            this._projection[2] = 0.0;\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].lookAtDirection(view, eyePos, eyeDir, up);\n        },\n\n        makeOrthoFromBoundingBox: function(bbox, eyeDir, view, projection) {\n            var center = bbox.center(this._tmpVecTercio);\n\n            var radius = bbox.radius();\n            var diameter = radius + radius;\n\n            var zNear = 0.0001;\n            var zFar = diameter + 0.0001;\n\n            // compute eye Pos from a inverted lightDir Ray shot from center of bbox\n            // firs make a RAY then move the eye to the that far pos following the ray\n            var eyePos = this._tmpVec;\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(eyePos, center, eyeDir, -diameter);\n\n            zNear = radius;\n            zFar += radius;\n\n            var zNearRatio = 0.001;\n            if (zNear < zFar * zNearRatio) {\n                zNear = zFar * zNearRatio;\n            }\n\n            var up = this.getUp(eyeDir);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].lookAtDirection(view, eyePos, eyeDir, up);\n\n            var right, top;\n            top = radius;\n            right = top;\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].ortho(projection, -right, right, -top, top, zNear, zFar);\n\n            this._projection[0] = right;\n            this._projection[1] = top;\n            this._projection[2] = 1.0;\n\n            this._depthRange[0] = zNear;\n            this._depthRange[1] = zFar;\n        },\n        /*\n     * Sync camera and light vision so that\n     * shadow map render using a camera whom\n     * settings come from the light\n     * and the scene being shadowed\n     */\n        aimShadowCastingCamera: function(cullVisitor, bbox) {\n            var light = this._light;\n\n            if (!light) {\n                this._emptyCasterScene = true;\n                return;\n            }\n\n            var camera = this._cameraShadow;\n\n            var worldLightPos = this._worldLightPos;\n            var worldLightDir = this._worldLightDir;\n\n            // make sure it\'s not modified outside our computations\n            // camera matrix can be modified by cullvisitor afterwards...\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(this._projectionMatrix, camera.getProjectionMatrix());\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(this._viewMatrix, camera.getViewMatrix());\n            var projection = this._projectionMatrix;\n            var view = this._viewMatrix;\n\n            // inject camera world matrix.\n            // from light current world/pos and camera eye pos.\n            // inject camera world matrix.\n            // from light current world/pos\n            // NEED same camera eye pos\n            var positionedAttribute = cullVisitor.getCurrentRenderBin().getPositionedAttribute();\n\n            var lightMatrix;\n            var positionedAttributeElements = positionedAttribute.getArray();\n            for (var i = 0; i < positionedAttribute.getLength(); i++) {\n                var pa = positionedAttributeElements[i];\n                var attribute = pa[1];\n                var matrix = pa[0];\n                if (attribute === light) {\n                    lightMatrix = matrix;\n                    break;\n                }\n            }\n\n            if (lightMatrix === undefined) {\n                __WEBPACK_IMPORTED_MODULE_7_osg_notify__["a" /* default */].warn(\'light isnt inside children of shadowedScene Node\');\n                this._emptyCasterScene = true;\n                return;\n            }\n\n            var eyeToWorld = this._tmpMatrix;\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].invert(eyeToWorld, cullVisitor.getCurrentModelViewMatrix());\n\n            //  light pos & lightTarget in World Space\n            if (!this._light.isDirectionLight()) {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].mul(this._tmpMatrix, eyeToWorld, lightMatrix);\n                var worldMatrix = this._tmpMatrix;\n\n                // same code as light spot shader\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].transformMat4(worldLightPos, light.getPosition(), worldMatrix);\n                worldMatrix[12] = 0;\n                worldMatrix[13] = 0;\n                worldMatrix[14] = 0;\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].invert(worldMatrix, worldMatrix);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].transpose(worldMatrix, worldMatrix);\n\n                // not a directional light, compute the world light dir\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].copy(worldLightDir, light.getDirection());\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].transformMat4(worldLightDir, worldLightDir, worldMatrix);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(worldLightDir, worldLightDir);\n\n                // and compute a perspective frustum\n                this.makePerspectiveFromBoundingBox(\n                    bbox,\n                    light.getSpotCutoff(),\n                    worldLightPos,\n                    worldLightDir,\n                    view,\n                    projection\n                );\n            } else {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].transformMat4(worldLightPos, light.getPosition(), lightMatrix);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["g" /* vec4 */].transformMat4(worldLightPos, worldLightPos, eyeToWorld);\n                // same code as light sun shader\n                // lightpos is a light dir\n                // so we now have to normalize\n                // since the transform to world above\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].scale(worldLightPos, worldLightPos, -1.0);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(worldLightPos, worldLightPos);\n                this.makeOrthoFromBoundingBox(bbox, worldLightPos, view, projection);\n\n                if (this._debug) {\n                    // project box by view to get projection debug bbox\n                    __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].invert(this._debugNodeFrustum.getMatrix(), view);\n                }\n            }\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(camera.getProjectionMatrix(), this._projectionMatrix);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(camera.getViewMatrix(), this._viewMatrix);\n        },\n\n        // culling is done,\n        // now try for a the tightest frustum\n        // possible for shadowcasting\n        frameShadowCastingFrustum: function(cullVisitor) {\n            if (!this._infiniteFrustum) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_CullVisitor__["a" /* default */].prototype.clampProjectionMatrix(\n                    this._projectionMatrix,\n                    this._depthRange[0],\n                    this._depthRange[1],\n                    cullVisitor.getNearFarRatio(),\n                    this._depthRange\n                );\n            }\n\n            // overwrite any cullvisitor wrongness done by any clampProjectionMatrix\n            var camera = this._cameraShadow;\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(camera.getProjectionMatrix(), this._projectionMatrix);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(camera.getViewMatrix(), this._viewMatrix);\n\n            this.setShadowUniformsReceive(false);\n        },\n\n        setShadowUniformsReceive: function(noDepth) {\n            if (noDepth) {\n                // receiver shader can read and early out\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["e" /* vec2 */].set(this._depthRange, 0.0, 0.0);\n            }\n            // even if noDepth, need to call those to make sure they are created\n            // in shadowTexture / shadowTextureAtlas\n            if (this._lightNumberArrayIndex !== -1) {\n                var lightNumber = this._light.getLightNumber();\n                this._texture.setViewMatrix(lightNumber, this._viewMatrix);\n                this._texture.setProjection(lightNumber, this._projection);\n                this._texture.setDepthRange(lightNumber, this._depthRange);\n            } else {\n                this._texture.setViewMatrix(this._viewMatrix);\n                this._texture.setProjection(this._projection);\n                this._texture.setDepthRange(this._depthRange);\n            }\n        },\n\n        // we know the scene is empty so we don\'t draw it\n        // but we still camera clear it.\n        // but we want to mark the uniform so that receiver shader can do\n        // an early out.\n        // ie: in shader, no texfetch\n        markSceneAsNoShadow: function() {\n            this.setShadowUniformsReceive(true);\n            // we still clear the shadow so we filled it\n            this._needRedraw = false;\n        },\n\n        // Defines the frustum from light param.\n        //\n        cullShadowCasting: function(cullVisitor, bbox) {\n            if (this._debug) {\n                var min = bbox.getMin();\n                var max = bbox.getMax();\n                bbox.center(this._tmpVec);\n                var matrix = this._debugNodeSceneCast.getMatrix();\n\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].fromScaling(matrix, [max[0] - min[0], max[1] - min[1], max[2] - min[2], 1]);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].setTranslation(matrix, this._tmpVec);\n            }\n\n            this._emptyCasterScene = false;\n            this.aimShadowCastingCamera(cullVisitor, bbox);\n\n            if (this._emptyCasterScene) {\n                // nothing to draw, tell receiver to do early out\n                // ie: in shader, no texfetch\n                this.markSceneAsNoShadow();\n                // Early out, no need to traverse scene either\n                return;\n            }\n\n            // get renderer to make the cull program\n            // record the traversal mask on entry so we can reapply it later.\n            var traversalMask = cullVisitor.getTraversalMask();\n\n            cullVisitor.setTraversalMask(this._castsShadowDrawTraversalMask);\n\n            // cast geometries into depth shadow map\n            cullVisitor.pushStateSet(this._casterStateSet);\n\n            this._cameraShadow.setEnableFrustumCulling(true);\n            this._cameraShadow.setComputeNearFar(true);\n\n            if (this._debug) {\n                this._debugNode.accept(cullVisitor);\n            }\n\n            // do RTT from the camera traversal mimicking light pos/orient\n            this._cameraShadow.accept(cullVisitor);\n\n            // make sure no negative near\n            this.nearFarBounding();\n\n            // Here culling is done, we do have near/far.\n            // and cull/non-culled info\n            // if we wanted a tighter frustum.\n            this.frameShadowCastingFrustum(cullVisitor);\n\n            // disabling to prevent cullvisitor breaking\n            // the projection matrix by "clamping" it\n            this._cameraShadow.setComputeNearFar(false);\n\n            cullVisitor.popStateSet();\n\n            // re-apply the original traversal mask\n            cullVisitor.setTraversalMask(traversalMask);\n            this._needRedraw = false;\n        },\n\n        cleanReceivingStateSet: function(ignoreTexture) {\n            if (this._receivingStateset) {\n                if (\n                    this._receivingStateset.getAttribute(\n                        this._shadowReceiveAttribute.getTypeMember()\n                    ) === this._shadowReceiveAttribute\n                )\n                    this._receivingStateset.removeAttribute(\n                        this._shadowReceiveAttribute.getTypeMember()\n                    );\n\n                if (ignoreTexture) return;\n\n                if (this._texture) {\n                    // remove this._texture, but not if it\'s not this._texture\n                    if (\n                        this._receivingStateset.getTextureAttribute(\n                            this._textureUnit,\n                            this._texture.getTypeMember()\n                        ) === this._texture\n                    )\n                        this._receivingStateset.removeTextureAttribute(\n                            this._textureUnit,\n                            this._texture.getTypeMember()\n                        );\n                }\n            }\n        },\n        cleanSceneGraph: function(ignoreTexture) {\n            // well release a lot more things when it works\n            this._needRedraw = true;\n            this.cleanReceivingStateSet(ignoreTexture);\n            // TODO: need state\n            //this._texture.releaseGLObjects();\n            //this._shadowReceiveAttribute = undefined;\n            this._texture = undefined;\n            this._shadowedScene = undefined;\n        },\n\n        setDebug: function(enable) {\n            if (enable && !this._debug) {\n                if (!this._debugNode) {\n                    this._debugGeomFrustum = __WEBPACK_IMPORTED_MODULE_11_osgUtil_debug__["a" /* default */].createDebugFrustumGeometry();\n\n                    this._debugGeomSceneCast = __WEBPACK_IMPORTED_MODULE_8_osg_shape__["a" /* default */].createBoundingBoxGeometry();\n\n                    this._debugGeomSceneCast.getPrimitives()[0].mode = __WEBPACK_IMPORTED_MODULE_16_osg_primitiveSet__["a" /* default */].LINES;\n\n                    this._debugNode = new __WEBPACK_IMPORTED_MODULE_6_osg_MatrixTransform__["a" /* default */]();\n                    this._debugNodeFrustum = new __WEBPACK_IMPORTED_MODULE_6_osg_MatrixTransform__["a" /* default */]();\n                    this._debugNodeSceneCast = new __WEBPACK_IMPORTED_MODULE_6_osg_MatrixTransform__["a" /* default */]();\n\n                    this._debugNodeFrustum.addChild(this._debugGeomFrustum);\n                    this._debugNodeSceneCast.addChild(this._debugGeomSceneCast);\n\n                    this._debugNode.addChild(this._debugNodeFrustum);\n                    this._debugNode.addChild(this._debugNodeSceneCast);\n                }\n            }\n            this._debug = enable;\n        },\n        getDebug: function() {\n            return this._debug;\n        },\n        getLightNumber: function() {\n            return this._light.getLightNumber();\n        },\n\n        getLight: function() {\n            return this._light;\n        }\n    }),\n    \'osgShadow\',\n    \'ShadowMap\'\n);\n\nShadowMap.EPSILON = 5e-3;\n\n/* harmony default export */ __webpack_exports__["a"] = (ShadowMap);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowMap.js\n// module id = 170\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowMap.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n\n\n\n\n/**\n * ShadowReceiveAttribute encapsulate Shadow Main State object\n * @class ShadowReceiveAttribute\n * @inherits StateAttribute\n */\nvar ShadowReceiveAttribute = function(lightNum, disable) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].call(this);\n\n    this._lightNumber = lightNum;\n\n    // see shadowSettings.js header for shadow algo param explanations\n    // hash change var\n\n    // shadow depth bias as projected in shadow camera space texture\n    // and viewer camera space projection introduce its bias\n    this._bias = 0.001;\n\n    // shadow normal bias from normal exploding offset technique\n    this._normalBias = undefined;\n    // shader compilation different upon texture precision\n    this._precision = 'UNSIGNED_BYTE';\n    // kernel size & type for pcf\n    this._kernelSizePCF = undefined;\n\n    this._fakePCF = true;\n\n    this._jitterOffset = 'none';\n\n    this._enable = !disable;\n    this._isAtlasTexture = false;\n\n    this._dirtyHash = true;\n    this._hash = '';\n};\n\nShadowReceiveAttribute.uniforms = {};\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    ShadowReceiveAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].prototype, {\n        attributeType: 'ShadowReceive',\n\n        cloneType: function() {\n            return new ShadowReceiveAttribute(this._lightNumber, true);\n        },\n\n        getTypeMember: function() {\n            return this.attributeType + this.getLightNumber();\n        },\n\n        getLightNumber: function() {\n            return this._lightNumber;\n        },\n\n        getUniformName: function(name) {\n            var prefix = this.getType() + this.getLightNumber().toString();\n            return 'u' + prefix + '_' + name;\n        },\n\n        getAtlas: function() {\n            return this._isAtlasTexture;\n        },\n        setAtlas: function(v) {\n            this._isAtlasTexture = v;\n        },\n\n        setBias: function(bias) {\n            this._bias = bias;\n        },\n\n        getBias: function() {\n            return this._bias;\n        },\n\n        setNormalBias: function(bias) {\n            this._normalBias = bias;\n        },\n\n        getNormalBias: function() {\n            return this._normalBias;\n        },\n\n        setJitterOffset: function(jitter) {\n            this._jitterOffset = jitter;\n        },\n\n        getJitterOffset: function() {\n            return this._jitterOffset;\n        },\n\n        getKernelSizePCF: function() {\n            return this._kernelSizePCF;\n        },\n\n        setKernelSizePCF: function(v) {\n            this._kernelSizePCF = v;\n            this._dirtyHash = true;\n        },\n\n        setPrecision: function(precision) {\n            this._precision = precision;\n            this._dirtyHash = true;\n        },\n\n        getPrecision: function() {\n            return this._precision;\n        },\n\n        setLightNumber: function(lightNum) {\n            this._lightNumber = lightNum;\n            this._dirtyHash = true;\n        },\n\n        getOrCreateUniforms: function() {\n            // uniform are once per CLASS attribute, not per instance\n            var obj = ShadowReceiveAttribute;\n\n            var typeMember = this.getTypeMember();\n\n            if (obj.uniforms[typeMember]) return obj.uniforms[typeMember];\n\n            obj.uniforms[typeMember] = {\n                bias: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__[\"a\" /* default */].createFloat(this.getUniformName('bias')),\n                normalBias: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__[\"a\" /* default */].createFloat(this.getUniformName('normalBias'))\n            };\n\n            return obj.uniforms[typeMember];\n        },\n\n        // Here to be common between  caster and receiver\n        // (used by shadowMap and shadow node shader)\n        getDefines: function() {\n            var defines = [];\n\n            var pcf = this.getKernelSizePCF();\n            switch (pcf) {\n                case '4Tap(16texFetch)':\n                    defines.push('#define _PCFx4');\n                    break;\n                case '9Tap(36texFetch)':\n                    defines.push('#define _PCFx9');\n                    break;\n                case '16Tap(64texFetch)':\n                    defines.push('#define _PCFx25');\n                    break;\n                default:\n                case '1Tap(4texFetch)':\n                    defines.push('#define _PCFx1');\n                    break;\n            }\n\n            if (this.getPrecision() !== 'UNSIGNED_BYTE') defines.push('#define _FLOATTEX');\n            if (this.getAtlas()) defines.push('#define _ATLAS_SHADOW');\n            if (this.getNormalBias()) defines.push('#define _NORMAL_OFFSET');\n            if (this.getJitterOffset() !== 'none') defines.push('#define _JITTER_OFFSET');\n\n            return defines;\n        },\n\n        apply: function() {\n            if (!this._enable) return;\n\n            var uniformMap = this.getOrCreateUniforms();\n\n            uniformMap.normalBias.setFloat(this._normalBias);\n            uniformMap.bias.setFloat(this._bias);\n        },\n\n        // need a isEnabled to let the ShaderGenerator to filter\n        // StateAttribute from the shader compilation\n        isEnabled: function() {\n            return this._enable;\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        },\n\n        _computeInternalHash: function() {\n            return this.getTypeMember() + '_' + this.getKernelSizePCF();\n        }\n    }),\n    'osgShadow',\n    'ShadowReceiveAttribute'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ShadowReceiveAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowReceiveAttribute.js\n// module id = 171\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowReceiveAttribute.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShadow_ShadowTexture__ = __webpack_require__(100);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n\n\n/**\n * ShadowTexture Attribute encapsulate Texture webgl object\n * with Shadow specificities (no need of texcoord,fragtexcoord)\n * trigger hash change when changing texture precision from float to byt\n * shadowSettings.js header for param explanations\n * @class ShadowTextureAtlas\n * @inherits TextureAttribute\n */\nvar ShadowTextureAtlas = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Texture__[\"default\"].call(this);\n\n    this._uniforms = {};\n    this._lightNumberArray = []; // default for a valid cloneType\n\n    this._viewMatrices = [];\n    this._projection = [];\n    this._depthRanges = [];\n    this._mapSizes = [];\n    this._renderSize = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__[\"e\" /* vec2 */].create();\n    this._dirtyHash = true;\n    this._hash = '';\n};\n\nShadowTextureAtlas.uniforms = {};\n/** @lends Texture.prototype */\n\n__WEBPACK_IMPORTED_MODULE_4_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    ShadowTextureAtlas,\n    __WEBPACK_IMPORTED_MODULE_4_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Texture__[\"default\"].prototype, {\n        cloneType: function() {\n            return new ShadowTextureAtlas();\n        },\n\n        getLightNumberArray: function() {\n            return this._lightNumberArray;\n        },\n\n        hasLightNumber: function(lightNum) {\n            return this._lightNumberArray.indexOf(lightNum) !== -1;\n        },\n\n        setLightNumberArray: function(lightNumberArray) {\n            this._lightNumberArray = lightNumberArray;\n            this._dirtyHash = true;\n        },\n\n        getUniformName: function(lightNumber, name) {\n            var prefix = 'Shadow_' + this.getType() + lightNumber.toString();\n            return 'u' + prefix + '_' + name;\n        },\n\n        setInternalFormatType: function(value) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__[\"default\"].prototype.setInternalFormatType.call(this, value);\n            this._dirtyHash = true;\n        },\n\n        createUniforms: function(lightNumber, uniforms) {\n\n            uniforms['ViewRight_' + lightNumber] = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat4(\n                this.getUniformName(lightNumber, 'ViewRight')\n            );\n            uniforms['ViewUp_' + lightNumber] = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat4(\n                this.getUniformName(lightNumber, 'ViewUp')\n            );\n            uniforms['ViewLook_' + lightNumber] = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat4(\n                this.getUniformName(lightNumber, 'ViewLook')\n            );\n\n            uniforms['Projection_' + lightNumber] = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat3(\n                this.getUniformName(lightNumber, 'projection')\n            );\n            uniforms['DepthRange_' + lightNumber] = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat2(\n                this.getUniformName(lightNumber, 'depthRange')\n            );\n            uniforms['MapSize_' + lightNumber] = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat4(\n                this.getUniformName(lightNumber, 'mapSize')\n            );\n            uniforms['RenderSize_' + lightNumber] = uniforms['RenderSize'];\n        },\n\n        getOrCreateUniforms: function(unit) {\n\n            // uniform are once per CLASS attribute, not per instance\n            var obj = ShadowTextureAtlas;\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].assert(unit !== undefined || this._lightNumberArray.length !== 0);\n\n            if (obj.uniforms[unit] !== undefined) {\n                return obj.uniforms[unit];\n            }\n\n            var uniforms = (obj.uniforms[unit] = {});\n\n            // shadowmap texture size used for texel space which is viewport independant\n            var renderSizeUniform = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createFloat2(this.getUniformName(0, 'renderSize'));\n            uniforms['RenderSize'] = renderSizeUniform;\n\n            for (var i = 0, l = this._lightNumberArray.length; i < l; i++) {\n                this.createUniforms(this._lightNumberArray[i], uniforms);\n            }\n\n            // Dual Uniform of texture, needs:\n            // - Sampler (type of texture)\n            // - Int (texture unit)\n            // tells Shader Program where to find it\n            var name = 'Texture' + unit;\n            var uniform = __WEBPACK_IMPORTED_MODULE_3_osg_Uniform__[\"a\" /* default */].createInt1(unit, name);\n            uniforms[name] = uniform;\n\n            return obj.uniforms[unit];\n        },\n\n        setViewMatrix: function(lightNumber, viewMatrix) {\n            this._viewMatrices[lightNumber] = viewMatrix;\n        },\n\n\n        setProjection: function(lightNumber, projection) {\n            this._projection[lightNumber] = projection;\n        },\n\n        setDepthRange: function(lighNumber, depthRange) {\n            this._depthRanges[lighNumber] = depthRange;\n        },\n\n        setLightShadowMapSize: function(lightNumber, dimension) {\n            this._mapSizes[lightNumber] = dimension;\n        },\n\n        apply: function(state, texUnit) {\n            // Texture stuff: call parent class method\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__[\"default\"].prototype.apply.call(this, state, texUnit);\n\n            if (this._lightNumberArray.length === 0) {\n                return;\n            }\n\n            // update Uniforms\n            var uniformMap = this.getOrCreateUniforms(texUnit);\n\n            for (var i = 0, l = this._lightNumberArray.length; i < l; i++) {\n                var lightNumber = this._lightNumberArray[i];\n\n                if (!uniformMap['ViewRight_' + lightNumber]) {\n                    // enable disable uniforms and yet using getOrCreate\n                    this.createUniforms(lightNumber, uniformMap);\n                }\n\n                __WEBPACK_IMPORTED_MODULE_2_osgShadow_ShadowTexture__[\"a\" /* default */].prototype._updateViewMatrixUniforms.call(this,\n                    this._viewMatrices[lightNumber],\n                    uniformMap['ViewRight_' + lightNumber],\n                    uniformMap['ViewUp_' + lightNumber],\n                    uniformMap['ViewLook_' + lightNumber]\n                );\n\n                uniformMap['Projection_' + lightNumber].setFloat3(\n                    this._projection[lightNumber]\n                );\n                uniformMap['DepthRange_' + lightNumber].setFloat2(this._depthRanges[lightNumber]);\n                uniformMap['MapSize_' + lightNumber].setFloat4(this._mapSizes[lightNumber]);\n            }\n\n            uniformMap['RenderSize'].setFloat2(this._renderSize);\n        },\n\n        setTextureSize: function(w, h) {\n            this._renderSize[0] = 1.0 / w;\n            this._renderSize[1] = 1.0 / h;\n            __WEBPACK_IMPORTED_MODULE_1_osg_Texture__[\"default\"].prototype.setTextureSize.call(this, w, h);\n            this.dirty();\n        },\n\n        _computeInternalHash: function() {\n            var hash = this.getTypeMember();\n            for (var i = 0, l = this._lightNumberArray.length; i < l; i++) {\n                hash += '_' + this._lightNumberArray[i];\n            }\n            hash += '_' + this._type;\n            return hash;\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        }\n    }),\n    'osgShadow',\n    'ShadowTextureAtlas'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ShadowTextureAtlas);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowTextureAtlas.js\n// module id = 172\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowTextureAtlas.js?")},function(module,exports,__webpack_require__){eval("module.exports = __webpack_require__(174);\n\n\n//////////////////\n// WEBPACK FOOTER\n// multi ./sources/OSG.js\n// module id = 173\n// module chunks = 0\n\n//# sourceURL=webpack:///multi_./sources/OSG.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('Object.defineProperty(__webpack_exports__, "__esModule", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_polyfill__ = __webpack_require__(175);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_polyfill___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_osg_polyfill__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgNameSpace__ = __webpack_require__(101);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_osg__ = __webpack_require__(102);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_osgAnimation__ = __webpack_require__(218);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgDB_osgDB__ = __webpack_require__(221);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgGA_osgGA__ = __webpack_require__(223);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgUtil_osgUtil__ = __webpack_require__(227);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgViewer_osgViewer__ = __webpack_require__(242);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgShader_osgShader__ = __webpack_require__(94);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgShadow_osgShadow__ = __webpack_require__(251);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgStats_osgStats__ = __webpack_require__(256);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgText_osgText__ = __webpack_require__(257);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgWrappers_osgWrappers__ = __webpack_require__(258);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgPlugins_osgPlugins__ = __webpack_require__(259);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osg", function() { return __WEBPACK_IMPORTED_MODULE_2_osg_osg__["default"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgAnimation", function() { return __WEBPACK_IMPORTED_MODULE_3_osgAnimation_osgAnimation__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgDB", function() { return __WEBPACK_IMPORTED_MODULE_4_osgDB_osgDB__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgGA", function() { return __WEBPACK_IMPORTED_MODULE_5_osgGA_osgGA__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgUtil", function() { return __WEBPACK_IMPORTED_MODULE_6_osgUtil_osgUtil__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgViewer", function() { return __WEBPACK_IMPORTED_MODULE_7_osgViewer_osgViewer__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgShader", function() { return __WEBPACK_IMPORTED_MODULE_8_osgShader_osgShader__["default"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgShadow", function() { return __WEBPACK_IMPORTED_MODULE_9_osgShadow_osgShadow__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgStats", function() { return __WEBPACK_IMPORTED_MODULE_10_osgStats_osgStats__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgText", function() { return __WEBPACK_IMPORTED_MODULE_11_osgText_osgText__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgWrappers", function() { return __WEBPACK_IMPORTED_MODULE_12_osgWrappers_osgWrappers__["a"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "osgPlugins", function() { return __WEBPACK_IMPORTED_MODULE_13_osgPlugins_osgPlugins__["a"]; });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar OSG = __WEBPACK_IMPORTED_MODULE_1_osgNameSpace__["a" /* default */];\n\nOSG.osg = __WEBPACK_IMPORTED_MODULE_2_osg_osg__["default"];\nOSG.osgAnimation = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_osgAnimation__["a" /* default */];\nOSG.osgDB = __WEBPACK_IMPORTED_MODULE_4_osgDB_osgDB__["a" /* default */];\nOSG.osgGA = __WEBPACK_IMPORTED_MODULE_5_osgGA_osgGA__["a" /* default */];\nOSG.osgUtil = __WEBPACK_IMPORTED_MODULE_6_osgUtil_osgUtil__["a" /* default */];\nOSG.osgViewer = __WEBPACK_IMPORTED_MODULE_7_osgViewer_osgViewer__["a" /* default */];\nOSG.osgShader = __WEBPACK_IMPORTED_MODULE_8_osgShader_osgShader__["default"];\nOSG.osgShadow = __WEBPACK_IMPORTED_MODULE_9_osgShadow_osgShadow__["a" /* default */];\nOSG.osgStats = __WEBPACK_IMPORTED_MODULE_10_osgStats_osgStats__["a" /* default */];\nOSG.osgText = __WEBPACK_IMPORTED_MODULE_11_osgText_osgText__["a" /* default */];\nOSG.osgWrappers = __WEBPACK_IMPORTED_MODULE_12_osgWrappers_osgWrappers__["a" /* default */];\nOSG.osgPlugins = __WEBPACK_IMPORTED_MODULE_13_osgPlugins_osgPlugins__["a" /* default */];\n\n// for backward compatibility\nOSG.globalify = function() {\n    window.osg = OSG.osg;\n    window.osgAnimation = OSG.osgAnimation;\n    window.osgDB = OSG.osgDB;\n    window.osgGA = OSG.osgGA;\n    window.osgUtil = OSG.osgUtil;\n    window.osgViewer = OSG.osgViewer;\n    window.osgShader = OSG.osgShader;\n    window.osgShadow = OSG.osgShadow;\n    window.osgStats = OSG.osgStats;\n    window.osgText = OSG.osgText;\n    window.osgWrappers = OSG.osgWrappers;\n    window.osgPlugins = OSG.osgPlugins;\n};\n\n\n\n/* harmony default export */ __webpack_exports__["default"] = (OSG);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/OSG.js\n// module id = 174\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/OSG.js?')},function(module,exports){eval("(function() {\n    // prevent crash on old browser\n    if (!window.Set || !window.Map || !window.Uint8ClampedArray) return;\n\n    // This file contains needed polyfills mainly for IE11\n    if (!Math.sign) {\n        Math.sign = function(a) {\n            return a > 0.0 ? 1.0 : a < 0.0 ? -1.0 : 0.0;\n        };\n    }\n\n    if (!Math.log2) {\n        Math.log2 = function(x) {\n            return Math.log(x) * Math.LOG2E;\n        };\n    }\n\n    if (!Math.log10) {\n        Math.log10 = function(x) {\n            return Math.log(x) * Math.LOG10E;\n        };\n    }\n\n    if (!String.prototype.endsWith) {\n        String.prototype.endsWith = function(str) {\n            return this.slice(-str.length) === str;\n        };\n    }\n\n    if (!String.prototype.startsWith) {\n        String.prototype.startsWith = function(str) {\n            return this.slice(0, str.length) === str;\n        };\n    }\n\n    if (!Float32Array.prototype.slice) {\n        var _slicePolyfill = function(start, end) {\n            return new this.constructor(this.subarray(start, end));\n        };\n\n        Int8Array.prototype.slice = _slicePolyfill;\n        Uint8Array.prototype.slice = _slicePolyfill;\n        Uint8ClampedArray.prototype.slice = _slicePolyfill;\n        Int16Array.prototype.slice = _slicePolyfill;\n        Uint16Array.prototype.slice = _slicePolyfill;\n        Int32Array.prototype.slice = _slicePolyfill;\n        Uint32Array.prototype.slice = _slicePolyfill;\n        Float32Array.prototype.slice = _slicePolyfill;\n        Float64Array.prototype.slice = _slicePolyfill;\n    }\n\n    // IE11 does not support Set with constructing arguments. May 2017.\n    var setTest = new window.Set(['test']);\n    var hasConstructorParameterSupport = setTest.has('test');\n    if (hasConstructorParameterSupport) return;\n    var nativeSetConstructor = window.Set;\n    window.Set = function(init) {\n        var set = new nativeSetConstructor();\n        if (init) {\n            for (var i = 0; i < init.length; ++i) {\n                set.add(init[i]);\n            }\n        }\n        return set;\n    };\n})();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/polyfill.js\n// module id = 175\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/polyfill.js?")},function(module,exports){eval('module.exports = {"devDependencies":{"chai":"^3.5.0","eslint":"4.1.1","eslint-config-google":"^0.8.0","eslint-config-standard":"^10.2.1","eslint-plugin-import":"^2.6.0","eslint-plugin-node":"^5.1.0","eslint-plugin-prettier":"^2.3.1","eslint-plugin-promise":"^3.5.0","eslint-plugin-standard":"^3.0.1","eslint-plugin-private-variables":"*","grunt-contrib-connect":"~0.9","grunt-documentation":"*","grunt-execute":"^0.2.2","grunt-plato":"~0.2.1","grunt-release":"^0.10.0","grunt-update-submodules":"^0.4.1","jsdom":"11.0.0","jsdom-global":"3.0.2","mocha":"^2.5.3"},"peerDependencies":{"grunt":">=0.4.0"},"dependencies":{"bluebird":"^3.0.5","d3":"^4.9.1","dagre":"^0.7.4","dat.gui":"github:dataarts/dat.gui#v0.6.4","extend":"*","gl-matrix":"2.3.2","glob":"*","grunt":"> 1.0.0","grunt-contrib-clean":"*","grunt-contrib-copy":"*","grunt-contrib-uglify":"^3.1.0","grunt-eslint":"^20.1.0","grunt-git":"*","grunt-shell":"*","grunt-webpack":"^3.0.2","hammerjs":"^2.0.8","jquery":"^2.2.4","json-loader":"^0.5.4","path":"^0.11.14","prettier":"^1.7.0","raw-loader":"^0.5.1","webpack":"^3.7.1","webpack-dev-server":"^2.9.2","webpack-strip-block":"^0.2.0","zlibjs":"^0.3.1"},"contributors":["Paul Cheyrou-Lagrèze <tuan.kuranes@gmail.com>","Jordi Torres <jtorresfabra@gmail.com>","Matt Fontaine <tehqin@gmail.com>","Stephane Ginier <stephane.ginier@gmail.com>"],"version":"0.2.9","author":"Cedric Pinson <trigrou@trigrou.com> (http://cedricpinson.com)","license":"MIT","description":"OpenSceneGraph implementation in javascript","repository":{"url":"git@github.com:cedricpinson/osgjs.git","type":"git"},"name":"OpenSceneGraph"}\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/json-loader!./package.json\n// module id = 176\n// module chunks = 0\n\n//# sourceURL=webpack:///./package.json?./node_modules/json-loader')},function(module,exports){eval('var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function("return this")() || (1,eval)("this");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === "object")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it\'s\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 177\n// module chunks = 0\n\n//# sourceURL=webpack:///(webpack)/buildin/global.js?')},function(module,exports,__webpack_require__){eval('/**\n * @fileoverview gl-matrix - High performance matrix and vector operations\n * @author Brandon Jones\n * @author Colin MacKenzie IV\n * @version 2.3.2\n */\n\n/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n// END HEADER\n\nexports.glMatrix = __webpack_require__(29);\nexports.mat2 = __webpack_require__(179);\nexports.mat2d = __webpack_require__(180);\nexports.mat3 = __webpack_require__(104);\nexports.mat4 = __webpack_require__(181);\nexports.quat = __webpack_require__(182);\nexports.vec2 = __webpack_require__(183);\nexports.vec3 = __webpack_require__(105);\nexports.vec4 = __webpack_require__(106);\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix.js\n// module id = 178\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix.js?')},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 2x2 Matrix\n * @name mat2\n */\nvar mat2 = {};\n\n/**\n * Creates a new identity mat2\n *\n * @returns {mat2} a new 2x2 matrix\n */\nmat2.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    return out;\n};\n\n/**\n * Creates a new mat2 initialized with values from an existing matrix\n *\n * @param {mat2} a matrix to clone\n * @returns {mat2} a new 2x2 matrix\n */\nmat2.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Copy the values from one mat2 to another\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the source matrix\n * @returns {mat2} out\n */\nmat2.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Set a mat2 to the identity matrix\n *\n * @param {mat2} out the receiving matrix\n * @returns {mat2} out\n */\nmat2.identity = function(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    return out;\n};\n\n/**\n * Create a new mat2 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out A new 2x2 matrix\n */\nmat2.fromValues = function(m00, m01, m10, m11) {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = m00;\n    out[1] = m01;\n    out[2] = m10;\n    out[3] = m11;\n    return out;\n};\n\n/**\n * Set the components of a mat2 to the given values\n *\n * @param {mat2} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\n * @returns {mat2} out\n */\nmat2.set = function(out, m00, m01, m10, m11) {\n    out[0] = m00;\n    out[1] = m01;\n    out[2] = m10;\n    out[3] = m11;\n    return out;\n};\n\n\n/**\n * Transpose the values of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the source matrix\n * @returns {mat2} out\n */\nmat2.transpose = function(out, a) {\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\n    if (out === a) {\n        var a1 = a[1];\n        out[1] = a[2];\n        out[2] = a1;\n    } else {\n        out[0] = a[0];\n        out[1] = a[2];\n        out[2] = a[1];\n        out[3] = a[3];\n    }\n    \n    return out;\n};\n\n/**\n * Inverts a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the source matrix\n * @returns {mat2} out\n */\nmat2.invert = function(out, a) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\n\n        // Calculate the determinant\n        det = a0 * a3 - a2 * a1;\n\n    if (!det) {\n        return null;\n    }\n    det = 1.0 / det;\n    \n    out[0] =  a3 * det;\n    out[1] = -a1 * det;\n    out[2] = -a2 * det;\n    out[3] =  a0 * det;\n\n    return out;\n};\n\n/**\n * Calculates the adjugate of a mat2\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the source matrix\n * @returns {mat2} out\n */\nmat2.adjoint = function(out, a) {\n    // Caching this value is nessecary if out == a\n    var a0 = a[0];\n    out[0] =  a[3];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    out[3] =  a0;\n\n    return out;\n};\n\n/**\n * Calculates the determinant of a mat2\n *\n * @param {mat2} a the source matrix\n * @returns {Number} determinant of a\n */\nmat2.determinant = function (a) {\n    return a[0] * a[3] - a[2] * a[1];\n};\n\n/**\n * Multiplies two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the first operand\n * @param {mat2} b the second operand\n * @returns {mat2} out\n */\nmat2.multiply = function (out, a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\n    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n    out[0] = a0 * b0 + a2 * b1;\n    out[1] = a1 * b0 + a3 * b1;\n    out[2] = a0 * b2 + a2 * b3;\n    out[3] = a1 * b2 + a3 * b3;\n    return out;\n};\n\n/**\n * Alias for {@link mat2.multiply}\n * @function\n */\nmat2.mul = mat2.multiply;\n\n/**\n * Rotates a mat2 by the given angle\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\nmat2.rotate = function (out, a, rad) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\n        s = Math.sin(rad),\n        c = Math.cos(rad);\n    out[0] = a0 *  c + a2 * s;\n    out[1] = a1 *  c + a3 * s;\n    out[2] = a0 * -s + a2 * c;\n    out[3] = a1 * -s + a3 * c;\n    return out;\n};\n\n/**\n * Scales the mat2 by the dimensions in the given vec2\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the matrix to rotate\n * @param {vec2} v the vec2 to scale the matrix by\n * @returns {mat2} out\n **/\nmat2.scale = function(out, a, v) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\n        v0 = v[0], v1 = v[1];\n    out[0] = a0 * v0;\n    out[1] = a1 * v0;\n    out[2] = a2 * v1;\n    out[3] = a3 * v1;\n    return out;\n};\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.rotate(dest, dest, rad);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2} out\n */\nmat2.fromRotation = function(out, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad);\n    out[0] = c;\n    out[1] = s;\n    out[2] = -s;\n    out[3] = c;\n    return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2.identity(dest);\n *     mat2.scale(dest, dest, vec);\n *\n * @param {mat2} out mat2 receiving operation result\n * @param {vec2} v Scaling vector\n * @returns {mat2} out\n */\nmat2.fromScaling = function(out, v) {\n    out[0] = v[0];\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = v[1];\n    return out;\n}\n\n/**\n * Returns a string representation of a mat2\n *\n * @param {mat2} mat matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nmat2.str = function (a) {\n    return 'mat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n};\n\n/**\n * Returns Frobenius norm of a mat2\n *\n * @param {mat2} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nmat2.frob = function (a) {\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2)))\n};\n\n/**\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\n * @param {mat2} L the lower triangular matrix \n * @param {mat2} D the diagonal matrix \n * @param {mat2} U the upper triangular matrix \n * @param {mat2} a the input matrix to factorize\n */\n\nmat2.LDU = function (L, D, U, a) { \n    L[2] = a[2]/a[0]; \n    U[0] = a[0]; \n    U[1] = a[1]; \n    U[3] = a[3] - L[2] * U[1]; \n    return [L, D, U];       \n}; \n\n/**\n * Adds two mat2's\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the first operand\n * @param {mat2} b the second operand\n * @returns {mat2} out\n */\nmat2.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    out[3] = a[3] + b[3];\n    return out;\n};\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the first operand\n * @param {mat2} b the second operand\n * @returns {mat2} out\n */\nmat2.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    out[3] = a[3] - b[3];\n    return out;\n};\n\n/**\n * Alias for {@link mat2.subtract}\n * @function\n */\nmat2.sub = mat2.subtract;\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {mat2} a The first matrix.\n * @param {mat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat2.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n};\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {mat2} a The first matrix.\n * @param {mat2} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat2.equals = function (a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\n    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)));\n};\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2} out the receiving matrix\n * @param {mat2} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2} out\n */\nmat2.multiplyScalar = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    out[3] = a[3] * b;\n    return out;\n};\n\n/**\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2} out the receiving vector\n * @param {mat2} a the first operand\n * @param {mat2} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2} out\n */\nmat2.multiplyScalarAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    out[3] = a[3] + (b[3] * scale);\n    return out;\n};\n\nmodule.exports = mat2;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/mat2.js\n// module id = 179\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/mat2.js?")},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 2x3 Matrix\n * @name mat2d\n * \n * @description \n * A mat2d contains six elements defined as:\n * <pre>\n * [a, c, tx,\n *  b, d, ty]\n * </pre>\n * This is a short form for the 3x3 matrix:\n * <pre>\n * [a, c, tx,\n *  b, d, ty,\n *  0, 0, 1]\n * </pre>\n * The last row is ignored so the array is shorter and operations are faster.\n */\nvar mat2d = {};\n\n/**\n * Creates a new identity mat2d\n *\n * @returns {mat2d} a new 2x3 matrix\n */\nmat2d.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(6);\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    out[4] = 0;\n    out[5] = 0;\n    return out;\n};\n\n/**\n * Creates a new mat2d initialized with values from an existing matrix\n *\n * @param {mat2d} a matrix to clone\n * @returns {mat2d} a new 2x3 matrix\n */\nmat2d.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(6);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    return out;\n};\n\n/**\n * Copy the values from one mat2d to another\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the source matrix\n * @returns {mat2d} out\n */\nmat2d.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    return out;\n};\n\n/**\n * Set a mat2d to the identity matrix\n *\n * @param {mat2d} out the receiving matrix\n * @returns {mat2d} out\n */\nmat2d.identity = function(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    out[4] = 0;\n    out[5] = 0;\n    return out;\n};\n\n/**\n * Create a new mat2d with the given values\n *\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} A new mat2d\n */\nmat2d.fromValues = function(a, b, c, d, tx, ty) {\n    var out = new glMatrix.ARRAY_TYPE(6);\n    out[0] = a;\n    out[1] = b;\n    out[2] = c;\n    out[3] = d;\n    out[4] = tx;\n    out[5] = ty;\n    return out;\n};\n\n/**\n * Set the components of a mat2d to the given values\n *\n * @param {mat2d} out the receiving matrix\n * @param {Number} a Component A (index 0)\n * @param {Number} b Component B (index 1)\n * @param {Number} c Component C (index 2)\n * @param {Number} d Component D (index 3)\n * @param {Number} tx Component TX (index 4)\n * @param {Number} ty Component TY (index 5)\n * @returns {mat2d} out\n */\nmat2d.set = function(out, a, b, c, d, tx, ty) {\n    out[0] = a;\n    out[1] = b;\n    out[2] = c;\n    out[3] = d;\n    out[4] = tx;\n    out[5] = ty;\n    return out;\n};\n\n/**\n * Inverts a mat2d\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the source matrix\n * @returns {mat2d} out\n */\nmat2d.invert = function(out, a) {\n    var aa = a[0], ab = a[1], ac = a[2], ad = a[3],\n        atx = a[4], aty = a[5];\n\n    var det = aa * ad - ab * ac;\n    if(!det){\n        return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = ad * det;\n    out[1] = -ab * det;\n    out[2] = -ac * det;\n    out[3] = aa * det;\n    out[4] = (ac * aty - ad * atx) * det;\n    out[5] = (ab * atx - aa * aty) * det;\n    return out;\n};\n\n/**\n * Calculates the determinant of a mat2d\n *\n * @param {mat2d} a the source matrix\n * @returns {Number} determinant of a\n */\nmat2d.determinant = function (a) {\n    return a[0] * a[3] - a[1] * a[2];\n};\n\n/**\n * Multiplies two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the first operand\n * @param {mat2d} b the second operand\n * @returns {mat2d} out\n */\nmat2d.multiply = function (out, a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\n        b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5];\n    out[0] = a0 * b0 + a2 * b1;\n    out[1] = a1 * b0 + a3 * b1;\n    out[2] = a0 * b2 + a2 * b3;\n    out[3] = a1 * b2 + a3 * b3;\n    out[4] = a0 * b4 + a2 * b5 + a4;\n    out[5] = a1 * b4 + a3 * b5 + a5;\n    return out;\n};\n\n/**\n * Alias for {@link mat2d.multiply}\n * @function\n */\nmat2d.mul = mat2d.multiply;\n\n/**\n * Rotates a mat2d by the given angle\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\nmat2d.rotate = function (out, a, rad) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\n        s = Math.sin(rad),\n        c = Math.cos(rad);\n    out[0] = a0 *  c + a2 * s;\n    out[1] = a1 *  c + a3 * s;\n    out[2] = a0 * -s + a2 * c;\n    out[3] = a1 * -s + a3 * c;\n    out[4] = a4;\n    out[5] = a5;\n    return out;\n};\n\n/**\n * Scales the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the matrix to translate\n * @param {vec2} v the vec2 to scale the matrix by\n * @returns {mat2d} out\n **/\nmat2d.scale = function(out, a, v) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\n        v0 = v[0], v1 = v[1];\n    out[0] = a0 * v0;\n    out[1] = a1 * v0;\n    out[2] = a2 * v1;\n    out[3] = a3 * v1;\n    out[4] = a4;\n    out[5] = a5;\n    return out;\n};\n\n/**\n * Translates the mat2d by the dimensions in the given vec2\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the matrix to translate\n * @param {vec2} v the vec2 to translate the matrix by\n * @returns {mat2d} out\n **/\nmat2d.translate = function(out, a, v) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5],\n        v0 = v[0], v1 = v[1];\n    out[0] = a0;\n    out[1] = a1;\n    out[2] = a2;\n    out[3] = a3;\n    out[4] = a0 * v0 + a2 * v1 + a4;\n    out[5] = a1 * v0 + a3 * v1 + a5;\n    return out;\n};\n\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.rotate(dest, dest, rad);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat2d} out\n */\nmat2d.fromRotation = function(out, rad) {\n    var s = Math.sin(rad), c = Math.cos(rad);\n    out[0] = c;\n    out[1] = s;\n    out[2] = -s;\n    out[3] = c;\n    out[4] = 0;\n    out[5] = 0;\n    return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.scale(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {vec2} v Scaling vector\n * @returns {mat2d} out\n */\nmat2d.fromScaling = function(out, v) {\n    out[0] = v[0];\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = v[1];\n    out[4] = 0;\n    out[5] = 0;\n    return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat2d.identity(dest);\n *     mat2d.translate(dest, dest, vec);\n *\n * @param {mat2d} out mat2d receiving operation result\n * @param {vec2} v Translation vector\n * @returns {mat2d} out\n */\nmat2d.fromTranslation = function(out, v) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    out[4] = v[0];\n    out[5] = v[1];\n    return out;\n}\n\n/**\n * Returns a string representation of a mat2d\n *\n * @param {mat2d} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nmat2d.str = function (a) {\n    return 'mat2d(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + \n                    a[3] + ', ' + a[4] + ', ' + a[5] + ')';\n};\n\n/**\n * Returns Frobenius norm of a mat2d\n *\n * @param {mat2d} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nmat2d.frob = function (a) { \n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + 1))\n}; \n\n/**\n * Adds two mat2d's\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the first operand\n * @param {mat2d} b the second operand\n * @returns {mat2d} out\n */\nmat2d.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    out[3] = a[3] + b[3];\n    out[4] = a[4] + b[4];\n    out[5] = a[5] + b[5];\n    return out;\n};\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the first operand\n * @param {mat2d} b the second operand\n * @returns {mat2d} out\n */\nmat2d.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    out[3] = a[3] - b[3];\n    out[4] = a[4] - b[4];\n    out[5] = a[5] - b[5];\n    return out;\n};\n\n/**\n * Alias for {@link mat2d.subtract}\n * @function\n */\nmat2d.sub = mat2d.subtract;\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat2d} out the receiving matrix\n * @param {mat2d} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat2d} out\n */\nmat2d.multiplyScalar = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    out[3] = a[3] * b;\n    out[4] = a[4] * b;\n    out[5] = a[5] * b;\n    return out;\n};\n\n/**\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat2d} out the receiving vector\n * @param {mat2d} a the first operand\n * @param {mat2d} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat2d} out\n */\nmat2d.multiplyScalarAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    out[3] = a[3] + (b[3] * scale);\n    out[4] = a[4] + (b[4] * scale);\n    out[5] = a[5] + (b[5] * scale);\n    return out;\n};\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {mat2d} a The first matrix.\n * @param {mat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat2d.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\n};\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {mat2d} a The first matrix.\n * @param {mat2d} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat2d.equals = function (a, b) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5];\n    var b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5];\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a5), Math.abs(b5)));\n};\n\nmodule.exports = mat2d;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/mat2d.js\n// module id = 180\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/mat2d.js?")},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 4x4 Matrix\n * @name mat4\n */\nvar mat4 = {\n  scalar: {},\n  SIMD: {},\n};\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nmat4.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(16);\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n};\n\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {mat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\nmat4.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(16);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n};\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n};\n\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\nmat4.fromValues = function(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    var out = new glMatrix.ARRAY_TYPE(16);\n    out[0] = m00;\n    out[1] = m01;\n    out[2] = m02;\n    out[3] = m03;\n    out[4] = m10;\n    out[5] = m11;\n    out[6] = m12;\n    out[7] = m13;\n    out[8] = m20;\n    out[9] = m21;\n    out[10] = m22;\n    out[11] = m23;\n    out[12] = m30;\n    out[13] = m31;\n    out[14] = m32;\n    out[15] = m33;\n    return out;\n};\n\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\nmat4.set = function(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    out[0] = m00;\n    out[1] = m01;\n    out[2] = m02;\n    out[3] = m03;\n    out[4] = m10;\n    out[5] = m11;\n    out[6] = m12;\n    out[7] = m13;\n    out[8] = m20;\n    out[9] = m21;\n    out[10] = m22;\n    out[11] = m23;\n    out[12] = m30;\n    out[13] = m31;\n    out[14] = m32;\n    out[15] = m33;\n    return out;\n};\n\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nmat4.identity = function(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n};\n\n/**\n * Transpose the values of a mat4 not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.scalar.transpose = function(out, a) {\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\n    if (out === a) {\n        var a01 = a[1], a02 = a[2], a03 = a[3],\n            a12 = a[6], a13 = a[7],\n            a23 = a[11];\n\n        out[1] = a[4];\n        out[2] = a[8];\n        out[3] = a[12];\n        out[4] = a01;\n        out[6] = a[9];\n        out[7] = a[13];\n        out[8] = a02;\n        out[9] = a12;\n        out[11] = a[14];\n        out[12] = a03;\n        out[13] = a13;\n        out[14] = a23;\n    } else {\n        out[0] = a[0];\n        out[1] = a[4];\n        out[2] = a[8];\n        out[3] = a[12];\n        out[4] = a[1];\n        out[5] = a[5];\n        out[6] = a[9];\n        out[7] = a[13];\n        out[8] = a[2];\n        out[9] = a[6];\n        out[10] = a[10];\n        out[11] = a[14];\n        out[12] = a[3];\n        out[13] = a[7];\n        out[14] = a[11];\n        out[15] = a[15];\n    }\n\n    return out;\n};\n\n/**\n * Transpose the values of a mat4 using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.SIMD.transpose = function(out, a) {\n    var a0, a1, a2, a3,\n        tmp01, tmp23,\n        out0, out1, out2, out3;\n\n    a0 = SIMD.Float32x4.load(a, 0);\n    a1 = SIMD.Float32x4.load(a, 4);\n    a2 = SIMD.Float32x4.load(a, 8);\n    a3 = SIMD.Float32x4.load(a, 12);\n\n    tmp01 = SIMD.Float32x4.shuffle(a0, a1, 0, 1, 4, 5);\n    tmp23 = SIMD.Float32x4.shuffle(a2, a3, 0, 1, 4, 5);\n    out0  = SIMD.Float32x4.shuffle(tmp01, tmp23, 0, 2, 4, 6);\n    out1  = SIMD.Float32x4.shuffle(tmp01, tmp23, 1, 3, 5, 7);\n    SIMD.Float32x4.store(out, 0,  out0);\n    SIMD.Float32x4.store(out, 4,  out1);\n\n    tmp01 = SIMD.Float32x4.shuffle(a0, a1, 2, 3, 6, 7);\n    tmp23 = SIMD.Float32x4.shuffle(a2, a3, 2, 3, 6, 7);\n    out2  = SIMD.Float32x4.shuffle(tmp01, tmp23, 0, 2, 4, 6);\n    out3  = SIMD.Float32x4.shuffle(tmp01, tmp23, 1, 3, 5, 7);\n    SIMD.Float32x4.store(out, 8,  out2);\n    SIMD.Float32x4.store(out, 12, out3);\n\n    return out;\n};\n\n/**\n * Transpse a mat4 using SIMD if available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.transpose = glMatrix.USE_SIMD ? mat4.SIMD.transpose : mat4.scalar.transpose;\n\n/**\n * Inverts a mat4 not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.scalar.invert = function(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n        return null;\n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n};\n\n/**\n * Inverts a mat4 using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.SIMD.invert = function(out, a) {\n  var row0, row1, row2, row3,\n      tmp1,\n      minor0, minor1, minor2, minor3,\n      det,\n      a0 = SIMD.Float32x4.load(a, 0),\n      a1 = SIMD.Float32x4.load(a, 4),\n      a2 = SIMD.Float32x4.load(a, 8),\n      a3 = SIMD.Float32x4.load(a, 12);\n\n  // Compute matrix adjugate\n  tmp1 = SIMD.Float32x4.shuffle(a0, a1, 0, 1, 4, 5);\n  row1 = SIMD.Float32x4.shuffle(a2, a3, 0, 1, 4, 5);\n  row0 = SIMD.Float32x4.shuffle(tmp1, row1, 0, 2, 4, 6);\n  row1 = SIMD.Float32x4.shuffle(row1, tmp1, 1, 3, 5, 7);\n  tmp1 = SIMD.Float32x4.shuffle(a0, a1, 2, 3, 6, 7);\n  row3 = SIMD.Float32x4.shuffle(a2, a3, 2, 3, 6, 7);\n  row2 = SIMD.Float32x4.shuffle(tmp1, row3, 0, 2, 4, 6);\n  row3 = SIMD.Float32x4.shuffle(row3, tmp1, 1, 3, 5, 7);\n\n  tmp1   = SIMD.Float32x4.mul(row2, row3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor0 = SIMD.Float32x4.mul(row1, tmp1);\n  minor1 = SIMD.Float32x4.mul(row0, tmp1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row1, tmp1), minor0);\n  minor1 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0, tmp1), minor1);\n  minor1 = SIMD.Float32x4.swizzle(minor1, 2, 3, 0, 1);\n\n  tmp1   = SIMD.Float32x4.mul(row1, row2);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor0 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row3, tmp1), minor0);\n  minor3 = SIMD.Float32x4.mul(row0, tmp1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.sub(minor0, SIMD.Float32x4.mul(row3, tmp1));\n  minor3 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0, tmp1), minor3);\n  minor3 = SIMD.Float32x4.swizzle(minor3, 2, 3, 0, 1);\n\n  tmp1   = SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(row1, 2, 3, 0, 1), row3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  row2   = SIMD.Float32x4.swizzle(row2, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row2, tmp1), minor0);\n  minor2 = SIMD.Float32x4.mul(row0, tmp1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.sub(minor0, SIMD.Float32x4.mul(row2, tmp1));\n  minor2 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0, tmp1), minor2);\n  minor2 = SIMD.Float32x4.swizzle(minor2, 2, 3, 0, 1);\n\n  tmp1   = SIMD.Float32x4.mul(row0, row1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor2 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row3, tmp1), minor2);\n  minor3 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row2, tmp1), minor3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor2 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row3, tmp1), minor2);\n  minor3 = SIMD.Float32x4.sub(minor3, SIMD.Float32x4.mul(row2, tmp1));\n\n  tmp1   = SIMD.Float32x4.mul(row0, row3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor1 = SIMD.Float32x4.sub(minor1, SIMD.Float32x4.mul(row2, tmp1));\n  minor2 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row1, tmp1), minor2);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor1 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row2, tmp1), minor1);\n  minor2 = SIMD.Float32x4.sub(minor2, SIMD.Float32x4.mul(row1, tmp1));\n\n  tmp1   = SIMD.Float32x4.mul(row0, row2);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor1 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row3, tmp1), minor1);\n  minor3 = SIMD.Float32x4.sub(minor3, SIMD.Float32x4.mul(row1, tmp1));\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor1 = SIMD.Float32x4.sub(minor1, SIMD.Float32x4.mul(row3, tmp1));\n  minor3 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row1, tmp1), minor3);\n\n  // Compute matrix determinant\n  det   = SIMD.Float32x4.mul(row0, minor0);\n  det   = SIMD.Float32x4.add(SIMD.Float32x4.swizzle(det, 2, 3, 0, 1), det);\n  det   = SIMD.Float32x4.add(SIMD.Float32x4.swizzle(det, 1, 0, 3, 2), det);\n  tmp1  = SIMD.Float32x4.reciprocalApproximation(det);\n  det   = SIMD.Float32x4.sub(\n               SIMD.Float32x4.add(tmp1, tmp1),\n               SIMD.Float32x4.mul(det, SIMD.Float32x4.mul(tmp1, tmp1)));\n  det   = SIMD.Float32x4.swizzle(det, 0, 0, 0, 0);\n  if (!det) {\n      return null;\n  }\n\n  // Compute matrix inverse\n  SIMD.Float32x4.store(out, 0,  SIMD.Float32x4.mul(det, minor0));\n  SIMD.Float32x4.store(out, 4,  SIMD.Float32x4.mul(det, minor1));\n  SIMD.Float32x4.store(out, 8,  SIMD.Float32x4.mul(det, minor2));\n  SIMD.Float32x4.store(out, 12, SIMD.Float32x4.mul(det, minor3));\n  return out;\n}\n\n/**\n * Inverts a mat4 using SIMD if available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.invert = glMatrix.USE_SIMD ? mat4.SIMD.invert : mat4.scalar.invert;\n\n/**\n * Calculates the adjugate of a mat4 not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.scalar.adjoint = function(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n\n    out[0]  =  (a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22));\n    out[1]  = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n    out[2]  =  (a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12));\n    out[3]  = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n    out[4]  = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n    out[5]  =  (a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22));\n    out[6]  = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n    out[7]  =  (a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12));\n    out[8]  =  (a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21));\n    out[9]  = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n    out[10] =  (a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11));\n    out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n    out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n    out[13] =  (a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21));\n    out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n    out[15] =  (a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11));\n    return out;\n};\n\n/**\n * Calculates the adjugate of a mat4 using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nmat4.SIMD.adjoint = function(out, a) {\n  var a0, a1, a2, a3;\n  var row0, row1, row2, row3;\n  var tmp1;\n  var minor0, minor1, minor2, minor3;\n\n  var a0 = SIMD.Float32x4.load(a, 0);\n  var a1 = SIMD.Float32x4.load(a, 4);\n  var a2 = SIMD.Float32x4.load(a, 8);\n  var a3 = SIMD.Float32x4.load(a, 12);\n\n  // Transpose the source matrix.  Sort of.  Not a true transpose operation\n  tmp1 = SIMD.Float32x4.shuffle(a0, a1, 0, 1, 4, 5);\n  row1 = SIMD.Float32x4.shuffle(a2, a3, 0, 1, 4, 5);\n  row0 = SIMD.Float32x4.shuffle(tmp1, row1, 0, 2, 4, 6);\n  row1 = SIMD.Float32x4.shuffle(row1, tmp1, 1, 3, 5, 7);\n\n  tmp1 = SIMD.Float32x4.shuffle(a0, a1, 2, 3, 6, 7);\n  row3 = SIMD.Float32x4.shuffle(a2, a3, 2, 3, 6, 7);\n  row2 = SIMD.Float32x4.shuffle(tmp1, row3, 0, 2, 4, 6);\n  row3 = SIMD.Float32x4.shuffle(row3, tmp1, 1, 3, 5, 7);\n\n  tmp1   = SIMD.Float32x4.mul(row2, row3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor0 = SIMD.Float32x4.mul(row1, tmp1);\n  minor1 = SIMD.Float32x4.mul(row0, tmp1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row1, tmp1), minor0);\n  minor1 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0, tmp1), minor1);\n  minor1 = SIMD.Float32x4.swizzle(minor1, 2, 3, 0, 1);\n\n  tmp1   = SIMD.Float32x4.mul(row1, row2);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor0 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row3, tmp1), minor0);\n  minor3 = SIMD.Float32x4.mul(row0, tmp1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.sub(minor0, SIMD.Float32x4.mul(row3, tmp1));\n  minor3 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0, tmp1), minor3);\n  minor3 = SIMD.Float32x4.swizzle(minor3, 2, 3, 0, 1);\n\n  tmp1   = SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(row1, 2, 3, 0, 1), row3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  row2   = SIMD.Float32x4.swizzle(row2, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row2, tmp1), minor0);\n  minor2 = SIMD.Float32x4.mul(row0, tmp1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor0 = SIMD.Float32x4.sub(minor0, SIMD.Float32x4.mul(row2, tmp1));\n  minor2 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row0, tmp1), minor2);\n  minor2 = SIMD.Float32x4.swizzle(minor2, 2, 3, 0, 1);\n\n  tmp1   = SIMD.Float32x4.mul(row0, row1);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor2 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row3, tmp1), minor2);\n  minor3 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row2, tmp1), minor3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor2 = SIMD.Float32x4.sub(SIMD.Float32x4.mul(row3, tmp1), minor2);\n  minor3 = SIMD.Float32x4.sub(minor3, SIMD.Float32x4.mul(row2, tmp1));\n\n  tmp1   = SIMD.Float32x4.mul(row0, row3);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor1 = SIMD.Float32x4.sub(minor1, SIMD.Float32x4.mul(row2, tmp1));\n  minor2 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row1, tmp1), minor2);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor1 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row2, tmp1), minor1);\n  minor2 = SIMD.Float32x4.sub(minor2, SIMD.Float32x4.mul(row1, tmp1));\n\n  tmp1   = SIMD.Float32x4.mul(row0, row2);\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 1, 0, 3, 2);\n  minor1 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row3, tmp1), minor1);\n  minor3 = SIMD.Float32x4.sub(minor3, SIMD.Float32x4.mul(row1, tmp1));\n  tmp1   = SIMD.Float32x4.swizzle(tmp1, 2, 3, 0, 1);\n  minor1 = SIMD.Float32x4.sub(minor1, SIMD.Float32x4.mul(row3, tmp1));\n  minor3 = SIMD.Float32x4.add(SIMD.Float32x4.mul(row1, tmp1), minor3);\n\n  SIMD.Float32x4.store(out, 0,  minor0);\n  SIMD.Float32x4.store(out, 4,  minor1);\n  SIMD.Float32x4.store(out, 8,  minor2);\n  SIMD.Float32x4.store(out, 12, minor3);\n  return out;\n};\n\n/**\n * Calculates the adjugate of a mat4 using SIMD if available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\n mat4.adjoint = glMatrix.USE_SIMD ? mat4.SIMD.adjoint : mat4.scalar.adjoint;\n\n/**\n * Calculates the determinant of a mat4\n *\n * @param {mat4} a the source matrix\n * @returns {Number} determinant of a\n */\nmat4.determinant = function (a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32;\n\n    // Calculate the determinant\n    return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n};\n\n/**\n * Multiplies two mat4's explicitly using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the first operand, must be a Float32Array\n * @param {mat4} b the second operand, must be a Float32Array\n * @returns {mat4} out\n */\nmat4.SIMD.multiply = function (out, a, b) {\n    var a0 = SIMD.Float32x4.load(a, 0);\n    var a1 = SIMD.Float32x4.load(a, 4);\n    var a2 = SIMD.Float32x4.load(a, 8);\n    var a3 = SIMD.Float32x4.load(a, 12);\n\n    var b0 = SIMD.Float32x4.load(b, 0);\n    var out0 = SIMD.Float32x4.add(\n                   SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0, 0, 0, 0, 0), a0),\n                   SIMD.Float32x4.add(\n                       SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0, 1, 1, 1, 1), a1),\n                       SIMD.Float32x4.add(\n                           SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0, 2, 2, 2, 2), a2),\n                           SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b0, 3, 3, 3, 3), a3))));\n    SIMD.Float32x4.store(out, 0, out0);\n\n    var b1 = SIMD.Float32x4.load(b, 4);\n    var out1 = SIMD.Float32x4.add(\n                   SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1, 0, 0, 0, 0), a0),\n                   SIMD.Float32x4.add(\n                       SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1, 1, 1, 1, 1), a1),\n                       SIMD.Float32x4.add(\n                           SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1, 2, 2, 2, 2), a2),\n                           SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b1, 3, 3, 3, 3), a3))));\n    SIMD.Float32x4.store(out, 4, out1);\n\n    var b2 = SIMD.Float32x4.load(b, 8);\n    var out2 = SIMD.Float32x4.add(\n                   SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2, 0, 0, 0, 0), a0),\n                   SIMD.Float32x4.add(\n                       SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2, 1, 1, 1, 1), a1),\n                       SIMD.Float32x4.add(\n                               SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2, 2, 2, 2, 2), a2),\n                               SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b2, 3, 3, 3, 3), a3))));\n    SIMD.Float32x4.store(out, 8, out2);\n\n    var b3 = SIMD.Float32x4.load(b, 12);\n    var out3 = SIMD.Float32x4.add(\n                   SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3, 0, 0, 0, 0), a0),\n                   SIMD.Float32x4.add(\n                        SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3, 1, 1, 1, 1), a1),\n                        SIMD.Float32x4.add(\n                            SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3, 2, 2, 2, 2), a2),\n                            SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(b3, 3, 3, 3, 3), a3))));\n    SIMD.Float32x4.store(out, 12, out3);\n\n    return out;\n};\n\n/**\n * Multiplies two mat4's explicitly not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the first operand\n * @param {mat4} b the second operand\n * @returns {mat4} out\n */\nmat4.scalar.multiply = function (out, a, b) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n\n    // Cache only the current line of the second matrix\n    var b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n    out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n    out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n    out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n    out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n    return out;\n};\n\n/**\n * Multiplies two mat4's using SIMD if available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the first operand\n * @param {mat4} b the second operand\n * @returns {mat4} out\n */\nmat4.multiply = glMatrix.USE_SIMD ? mat4.SIMD.multiply : mat4.scalar.multiply;\n\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\nmat4.mul = mat4.multiply;\n\n/**\n * Translate a mat4 by the given vector not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to translate\n * @param {vec3} v vector to translate by\n * @returns {mat4} out\n */\nmat4.scalar.translate = function (out, a, v) {\n    var x = v[0], y = v[1], z = v[2],\n        a00, a01, a02, a03,\n        a10, a11, a12, a13,\n        a20, a21, a22, a23;\n\n    if (a === out) {\n        out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n        out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n        out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n        out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n    } else {\n        a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\n        a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\n        a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\n\n        out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\n        out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\n        out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\n\n        out[12] = a00 * x + a10 * y + a20 * z + a[12];\n        out[13] = a01 * x + a11 * y + a21 * z + a[13];\n        out[14] = a02 * x + a12 * y + a22 * z + a[14];\n        out[15] = a03 * x + a13 * y + a23 * z + a[15];\n    }\n\n    return out;\n};\n\n/**\n * Translates a mat4 by the given vector using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to translate\n * @param {vec3} v vector to translate by\n * @returns {mat4} out\n */\nmat4.SIMD.translate = function (out, a, v) {\n    var a0 = SIMD.Float32x4.load(a, 0),\n        a1 = SIMD.Float32x4.load(a, 4),\n        a2 = SIMD.Float32x4.load(a, 8),\n        a3 = SIMD.Float32x4.load(a, 12),\n        vec = SIMD.Float32x4(v[0], v[1], v[2] , 0);\n\n    if (a !== out) {\n        out[0] = a[0]; out[1] = a[1]; out[2] = a[2]; out[3] = a[3];\n        out[4] = a[4]; out[5] = a[5]; out[6] = a[6]; out[7] = a[7];\n        out[8] = a[8]; out[9] = a[9]; out[10] = a[10]; out[11] = a[11];\n    }\n\n    a0 = SIMD.Float32x4.mul(a0, SIMD.Float32x4.swizzle(vec, 0, 0, 0, 0));\n    a1 = SIMD.Float32x4.mul(a1, SIMD.Float32x4.swizzle(vec, 1, 1, 1, 1));\n    a2 = SIMD.Float32x4.mul(a2, SIMD.Float32x4.swizzle(vec, 2, 2, 2, 2));\n\n    var t0 = SIMD.Float32x4.add(a0, SIMD.Float32x4.add(a1, SIMD.Float32x4.add(a2, a3)));\n    SIMD.Float32x4.store(out, 12, t0);\n\n    return out;\n};\n\n/**\n * Translates a mat4 by the given vector using SIMD if available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to translate\n * @param {vec3} v vector to translate by\n * @returns {mat4} out\n */\nmat4.translate = glMatrix.USE_SIMD ? mat4.SIMD.translate : mat4.scalar.translate;\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to scale\n * @param {vec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nmat4.scalar.scale = function(out, a, v) {\n    var x = v[0], y = v[1], z = v[2];\n\n    out[0] = a[0] * x;\n    out[1] = a[1] * x;\n    out[2] = a[2] * x;\n    out[3] = a[3] * x;\n    out[4] = a[4] * y;\n    out[5] = a[5] * y;\n    out[6] = a[6] * y;\n    out[7] = a[7] * y;\n    out[8] = a[8] * z;\n    out[9] = a[9] * z;\n    out[10] = a[10] * z;\n    out[11] = a[11] * z;\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n};\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to scale\n * @param {vec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nmat4.SIMD.scale = function(out, a, v) {\n    var a0, a1, a2;\n    var vec = SIMD.Float32x4(v[0], v[1], v[2], 0);\n\n    a0 = SIMD.Float32x4.load(a, 0);\n    SIMD.Float32x4.store(\n        out, 0, SIMD.Float32x4.mul(a0, SIMD.Float32x4.swizzle(vec, 0, 0, 0, 0)));\n\n    a1 = SIMD.Float32x4.load(a, 4);\n    SIMD.Float32x4.store(\n        out, 4, SIMD.Float32x4.mul(a1, SIMD.Float32x4.swizzle(vec, 1, 1, 1, 1)));\n\n    a2 = SIMD.Float32x4.load(a, 8);\n    SIMD.Float32x4.store(\n        out, 8, SIMD.Float32x4.mul(a2, SIMD.Float32x4.swizzle(vec, 2, 2, 2, 2)));\n\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n};\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 using SIMD if available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to scale\n * @param {vec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n */\nmat4.scale = glMatrix.USE_SIMD ? mat4.SIMD.scale : mat4.scalar.scale;\n\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {vec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nmat4.rotate = function (out, a, rad, axis) {\n    var x = axis[0], y = axis[1], z = axis[2],\n        len = Math.sqrt(x * x + y * y + z * z),\n        s, c, t,\n        a00, a01, a02, a03,\n        a10, a11, a12, a13,\n        a20, a21, a22, a23,\n        b00, b01, b02,\n        b10, b11, b12,\n        b20, b21, b22;\n\n    if (Math.abs(len) < glMatrix.EPSILON) { return null; }\n\n    len = 1 / len;\n    x *= len;\n    y *= len;\n    z *= len;\n\n    s = Math.sin(rad);\n    c = Math.cos(rad);\n    t = 1 - c;\n\n    a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\n    a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\n    a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\n\n    // Construct the elements of the rotation matrix\n    b00 = x * x * t + c; b01 = y * x * t + z * s; b02 = z * x * t - y * s;\n    b10 = x * y * t - z * s; b11 = y * y * t + c; b12 = z * y * t + x * s;\n    b20 = x * z * t + y * s; b21 = y * z * t - x * s; b22 = z * z * t + c;\n\n    // Perform rotation-specific matrix multiplication\n    out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n    out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n    out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n    out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n    out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n    out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n    out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n    out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n    out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n    out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n    out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n    out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged last row\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the X axis not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.scalar.rotateX = function (out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\n        out[0]  = a[0];\n        out[1]  = a[1];\n        out[2]  = a[2];\n        out[3]  = a[3];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    out[4] = a10 * c + a20 * s;\n    out[5] = a11 * c + a21 * s;\n    out[6] = a12 * c + a22 * s;\n    out[7] = a13 * c + a23 * s;\n    out[8] = a20 * c - a10 * s;\n    out[9] = a21 * c - a11 * s;\n    out[10] = a22 * c - a12 * s;\n    out[11] = a23 * c - a13 * s;\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the X axis using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.SIMD.rotateX = function (out, a, rad) {\n    var s = SIMD.Float32x4.splat(Math.sin(rad)),\n        c = SIMD.Float32x4.splat(Math.cos(rad));\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\n      out[0]  = a[0];\n      out[1]  = a[1];\n      out[2]  = a[2];\n      out[3]  = a[3];\n      out[12] = a[12];\n      out[13] = a[13];\n      out[14] = a[14];\n      out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    var a_1 = SIMD.Float32x4.load(a, 4);\n    var a_2 = SIMD.Float32x4.load(a, 8);\n    SIMD.Float32x4.store(out, 4,\n                         SIMD.Float32x4.add(SIMD.Float32x4.mul(a_1, c), SIMD.Float32x4.mul(a_2, s)));\n    SIMD.Float32x4.store(out, 8,\n                         SIMD.Float32x4.sub(SIMD.Float32x4.mul(a_2, c), SIMD.Float32x4.mul(a_1, s)));\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the X axis using SIMD if availabe and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.rotateX = glMatrix.USE_SIMD ? mat4.SIMD.rotateX : mat4.scalar.rotateX;\n\n/**\n * Rotates a matrix by the given angle around the Y axis not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.scalar.rotateY = function (out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\n        out[4]  = a[4];\n        out[5]  = a[5];\n        out[6]  = a[6];\n        out[7]  = a[7];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    out[0] = a00 * c - a20 * s;\n    out[1] = a01 * c - a21 * s;\n    out[2] = a02 * c - a22 * s;\n    out[3] = a03 * c - a23 * s;\n    out[8] = a00 * s + a20 * c;\n    out[9] = a01 * s + a21 * c;\n    out[10] = a02 * s + a22 * c;\n    out[11] = a03 * s + a23 * c;\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the Y axis using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.SIMD.rotateY = function (out, a, rad) {\n    var s = SIMD.Float32x4.splat(Math.sin(rad)),\n        c = SIMD.Float32x4.splat(Math.cos(rad));\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged rows\n        out[4]  = a[4];\n        out[5]  = a[5];\n        out[6]  = a[6];\n        out[7]  = a[7];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    var a_0 = SIMD.Float32x4.load(a, 0);\n    var a_2 = SIMD.Float32x4.load(a, 8);\n    SIMD.Float32x4.store(out, 0,\n                         SIMD.Float32x4.sub(SIMD.Float32x4.mul(a_0, c), SIMD.Float32x4.mul(a_2, s)));\n    SIMD.Float32x4.store(out, 8,\n                         SIMD.Float32x4.add(SIMD.Float32x4.mul(a_0, s), SIMD.Float32x4.mul(a_2, c)));\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the Y axis if SIMD available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n mat4.rotateY = glMatrix.USE_SIMD ? mat4.SIMD.rotateY : mat4.scalar.rotateY;\n\n/**\n * Rotates a matrix by the given angle around the Z axis not using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.scalar.rotateZ = function (out, a, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad),\n        a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7];\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged last row\n        out[8]  = a[8];\n        out[9]  = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    out[0] = a00 * c + a10 * s;\n    out[1] = a01 * c + a11 * s;\n    out[2] = a02 * c + a12 * s;\n    out[3] = a03 * c + a13 * s;\n    out[4] = a10 * c - a00 * s;\n    out[5] = a11 * c - a01 * s;\n    out[6] = a12 * c - a02 * s;\n    out[7] = a13 * c - a03 * s;\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the Z axis using SIMD\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.SIMD.rotateZ = function (out, a, rad) {\n    var s = SIMD.Float32x4.splat(Math.sin(rad)),\n        c = SIMD.Float32x4.splat(Math.cos(rad));\n\n    if (a !== out) { // If the source and destination differ, copy the unchanged last row\n        out[8]  = a[8];\n        out[9]  = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n    }\n\n    // Perform axis-specific matrix multiplication\n    var a_0 = SIMD.Float32x4.load(a, 0);\n    var a_1 = SIMD.Float32x4.load(a, 4);\n    SIMD.Float32x4.store(out, 0,\n                         SIMD.Float32x4.add(SIMD.Float32x4.mul(a_0, c), SIMD.Float32x4.mul(a_1, s)));\n    SIMD.Float32x4.store(out, 4,\n                         SIMD.Float32x4.sub(SIMD.Float32x4.mul(a_1, c), SIMD.Float32x4.mul(a_0, s)));\n    return out;\n};\n\n/**\n * Rotates a matrix by the given angle around the Z axis if SIMD available and enabled\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n mat4.rotateZ = glMatrix.USE_SIMD ? mat4.SIMD.rotateZ : mat4.scalar.rotateZ;\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {vec3} v Translation vector\n * @returns {mat4} out\n */\nmat4.fromTranslation = function(out, v) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {vec3} v Scaling vector\n * @returns {mat4} out\n */\nmat4.fromScaling = function(out, v) {\n    out[0] = v[0];\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = v[1];\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = v[2];\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {vec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nmat4.fromRotation = function(out, rad, axis) {\n    var x = axis[0], y = axis[1], z = axis[2],\n        len = Math.sqrt(x * x + y * y + z * z),\n        s, c, t;\n\n    if (Math.abs(len) < glMatrix.EPSILON) { return null; }\n\n    len = 1 / len;\n    x *= len;\n    y *= len;\n    z *= len;\n\n    s = Math.sin(rad);\n    c = Math.cos(rad);\n    t = 1 - c;\n\n    // Perform rotation-specific matrix multiplication\n    out[0] = x * x * t + c;\n    out[1] = y * x * t + z * s;\n    out[2] = z * x * t - y * s;\n    out[3] = 0;\n    out[4] = x * y * t - z * s;\n    out[5] = y * y * t + c;\n    out[6] = z * y * t + x * s;\n    out[7] = 0;\n    out[8] = x * z * t + y * s;\n    out[9] = y * z * t - x * s;\n    out[10] = z * z * t + c;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.fromXRotation = function(out, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad);\n\n    // Perform axis-specific matrix multiplication\n    out[0]  = 1;\n    out[1]  = 0;\n    out[2]  = 0;\n    out[3]  = 0;\n    out[4] = 0;\n    out[5] = c;\n    out[6] = s;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = -s;\n    out[10] = c;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.fromYRotation = function(out, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad);\n\n    // Perform axis-specific matrix multiplication\n    out[0]  = c;\n    out[1]  = 0;\n    out[2]  = -s;\n    out[3]  = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = s;\n    out[9] = 0;\n    out[10] = c;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nmat4.fromZRotation = function(out, rad) {\n    var s = Math.sin(rad),\n        c = Math.cos(rad);\n\n    // Perform axis-specific matrix multiplication\n    out[0]  = c;\n    out[1]  = s;\n    out[2]  = 0;\n    out[3]  = 0;\n    out[4] = -s;\n    out[5] = c;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     var quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {vec3} v Translation vector\n * @returns {mat4} out\n */\nmat4.fromRotationTranslation = function (out, q, v) {\n    // Quaternion math\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        xy = x * y2,\n        xz = x * z2,\n        yy = y * y2,\n        yz = y * z2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    out[0] = 1 - (yy + zz);\n    out[1] = xy + wz;\n    out[2] = xz - wy;\n    out[3] = 0;\n    out[4] = xy - wz;\n    out[5] = 1 - (xx + zz);\n    out[6] = yz + wx;\n    out[7] = 0;\n    out[8] = xz + wy;\n    out[9] = yz - wx;\n    out[10] = 1 - (xx + yy);\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n\n    return out;\n};\n\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {mat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nmat4.getTranslation = function (out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n\n  return out;\n};\n\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {mat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\nmat4.getRotation = function (out, mat) {\n  // Algorithm taken from http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n  var trace = mat[0] + mat[5] + mat[10];\n  var S = 0;\n\n  if (trace > 0) { \n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (mat[6] - mat[9]) / S;\n    out[1] = (mat[8] - mat[2]) / S; \n    out[2] = (mat[1] - mat[4]) / S; \n  } else if ((mat[0] > mat[5])&(mat[0] > mat[10])) { \n    S = Math.sqrt(1.0 + mat[0] - mat[5] - mat[10]) * 2;\n    out[3] = (mat[6] - mat[9]) / S;\n    out[0] = 0.25 * S;\n    out[1] = (mat[1] + mat[4]) / S; \n    out[2] = (mat[8] + mat[2]) / S; \n  } else if (mat[5] > mat[10]) { \n    S = Math.sqrt(1.0 + mat[5] - mat[0] - mat[10]) * 2;\n    out[3] = (mat[8] - mat[2]) / S;\n    out[0] = (mat[1] + mat[4]) / S; \n    out[1] = 0.25 * S;\n    out[2] = (mat[6] + mat[9]) / S; \n  } else { \n    S = Math.sqrt(1.0 + mat[10] - mat[0] - mat[5]) * 2;\n    out[3] = (mat[1] - mat[4]) / S;\n    out[0] = (mat[8] + mat[2]) / S;\n    out[1] = (mat[6] + mat[9]) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n};\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     var quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {vec3} v Translation vector\n * @param {vec3} s Scaling vector\n * @returns {mat4} out\n */\nmat4.fromRotationTranslationScale = function (out, q, v, s) {\n    // Quaternion math\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        xy = x * y2,\n        xz = x * z2,\n        yy = y * y2,\n        yz = y * z2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2,\n        sx = s[0],\n        sy = s[1],\n        sz = s[2];\n\n    out[0] = (1 - (yy + zz)) * sx;\n    out[1] = (xy + wz) * sx;\n    out[2] = (xz - wy) * sx;\n    out[3] = 0;\n    out[4] = (xy - wz) * sy;\n    out[5] = (1 - (xx + zz)) * sy;\n    out[6] = (yz + wx) * sy;\n    out[7] = 0;\n    out[8] = (xz + wy) * sz;\n    out[9] = (yz - wx) * sz;\n    out[10] = (1 - (xx + yy)) * sz;\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n\n    return out;\n};\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     var quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {vec3} v Translation vector\n * @param {vec3} s Scaling vector\n * @param {vec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\nmat4.fromRotationTranslationScaleOrigin = function (out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0], y = q[1], z = q[2], w = q[3],\n      x2 = x + x,\n      y2 = y + y,\n      z2 = z + z,\n\n      xx = x * x2,\n      xy = x * y2,\n      xz = x * z2,\n      yy = y * y2,\n      yz = y * z2,\n      zz = z * z2,\n      wx = w * x2,\n      wy = w * y2,\n      wz = w * z2,\n\n      sx = s[0],\n      sy = s[1],\n      sz = s[2],\n\n      ox = o[0],\n      oy = o[1],\n      oz = o[2];\n\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out[0] * ox + out[4] * oy + out[8] * oz);\n  out[13] = v[1] + oy - (out[1] * ox + out[5] * oy + out[9] * oz);\n  out[14] = v[2] + oz - (out[2] * ox + out[6] * oy + out[10] * oz);\n  out[15] = 1;\n\n  return out;\n};\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nmat4.fromQuat = function (out, q) {\n    var x = q[0], y = q[1], z = q[2], w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n\n        xx = x * x2,\n        yx = y * x2,\n        yy = y * y2,\n        zx = z * x2,\n        zy = z * y2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n\n    out[0] = 1 - yy - zz;\n    out[1] = yx + wz;\n    out[2] = zx - wy;\n    out[3] = 0;\n\n    out[4] = yx - wz;\n    out[5] = 1 - xx - zz;\n    out[6] = zy + wx;\n    out[7] = 0;\n\n    out[8] = zx + wy;\n    out[9] = zy - wx;\n    out[10] = 1 - xx - yy;\n    out[11] = 0;\n\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n\n    return out;\n};\n\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\nmat4.frustum = function (out, left, right, bottom, top, near, far) {\n    var rl = 1 / (right - left),\n        tb = 1 / (top - bottom),\n        nf = 1 / (near - far);\n    out[0] = (near * 2) * rl;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = (near * 2) * tb;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = (right + left) * rl;\n    out[9] = (top + bottom) * tb;\n    out[10] = (far + near) * nf;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = (far * near * 2) * nf;\n    out[15] = 0;\n    return out;\n};\n\n/**\n * Generates a perspective projection matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nmat4.perspective = function (out, fovy, aspect, near, far) {\n    var f = 1.0 / Math.tan(fovy / 2),\n        nf = 1 / (near - far);\n    out[0] = f / aspect;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = f;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = (far + near) * nf;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = (2 * far * near) * nf;\n    out[15] = 0;\n    return out;\n};\n\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nmat4.perspectiveFromFieldOfView = function (out, fov, near, far) {\n    var upTan = Math.tan(fov.upDegrees * Math.PI/180.0),\n        downTan = Math.tan(fov.downDegrees * Math.PI/180.0),\n        leftTan = Math.tan(fov.leftDegrees * Math.PI/180.0),\n        rightTan = Math.tan(fov.rightDegrees * Math.PI/180.0),\n        xScale = 2.0 / (leftTan + rightTan),\n        yScale = 2.0 / (upTan + downTan);\n\n    out[0] = xScale;\n    out[1] = 0.0;\n    out[2] = 0.0;\n    out[3] = 0.0;\n    out[4] = 0.0;\n    out[5] = yScale;\n    out[6] = 0.0;\n    out[7] = 0.0;\n    out[8] = -((leftTan - rightTan) * xScale * 0.5);\n    out[9] = ((upTan - downTan) * yScale * 0.5);\n    out[10] = far / (near - far);\n    out[11] = -1.0;\n    out[12] = 0.0;\n    out[13] = 0.0;\n    out[14] = (far * near) / (near - far);\n    out[15] = 0.0;\n    return out;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nmat4.ortho = function (out, left, right, bottom, top, near, far) {\n    var lr = 1 / (left - right),\n        bt = 1 / (bottom - top),\n        nf = 1 / (near - far);\n    out[0] = -2 * lr;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = -2 * bt;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 2 * nf;\n    out[11] = 0;\n    out[12] = (left + right) * lr;\n    out[13] = (top + bottom) * bt;\n    out[14] = (far + near) * nf;\n    out[15] = 1;\n    return out;\n};\n\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {vec3} eye Position of the viewer\n * @param {vec3} center Point the viewer is looking at\n * @param {vec3} up vec3 pointing up\n * @returns {mat4} out\n */\nmat4.lookAt = function (out, eye, center, up) {\n    var x0, x1, x2, y0, y1, y2, z0, z1, z2, len,\n        eyex = eye[0],\n        eyey = eye[1],\n        eyez = eye[2],\n        upx = up[0],\n        upy = up[1],\n        upz = up[2],\n        centerx = center[0],\n        centery = center[1],\n        centerz = center[2];\n\n    if (Math.abs(eyex - centerx) < glMatrix.EPSILON &&\n        Math.abs(eyey - centery) < glMatrix.EPSILON &&\n        Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n        return mat4.identity(out);\n    }\n\n    z0 = eyex - centerx;\n    z1 = eyey - centery;\n    z2 = eyez - centerz;\n\n    len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n\n    x0 = upy * z2 - upz * z1;\n    x1 = upz * z0 - upx * z2;\n    x2 = upx * z1 - upy * z0;\n    len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n    if (!len) {\n        x0 = 0;\n        x1 = 0;\n        x2 = 0;\n    } else {\n        len = 1 / len;\n        x0 *= len;\n        x1 *= len;\n        x2 *= len;\n    }\n\n    y0 = z1 * x2 - z2 * x1;\n    y1 = z2 * x0 - z0 * x2;\n    y2 = z0 * x1 - z1 * x0;\n\n    len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n    if (!len) {\n        y0 = 0;\n        y1 = 0;\n        y2 = 0;\n    } else {\n        len = 1 / len;\n        y0 *= len;\n        y1 *= len;\n        y2 *= len;\n    }\n\n    out[0] = x0;\n    out[1] = y0;\n    out[2] = z0;\n    out[3] = 0;\n    out[4] = x1;\n    out[5] = y1;\n    out[6] = z1;\n    out[7] = 0;\n    out[8] = x2;\n    out[9] = y2;\n    out[10] = z2;\n    out[11] = 0;\n    out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n    out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n    out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n    out[15] = 1;\n\n    return out;\n};\n\n/**\n * Returns a string representation of a mat4\n *\n * @param {mat4} mat matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nmat4.str = function (a) {\n    return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' +\n                    a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' +\n                    a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' +\n                    a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\n};\n\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {mat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nmat4.frob = function (a) {\n    return(Math.sqrt(Math.pow(a[0], 2) + Math.pow(a[1], 2) + Math.pow(a[2], 2) + Math.pow(a[3], 2) + Math.pow(a[4], 2) + Math.pow(a[5], 2) + Math.pow(a[6], 2) + Math.pow(a[7], 2) + Math.pow(a[8], 2) + Math.pow(a[9], 2) + Math.pow(a[10], 2) + Math.pow(a[11], 2) + Math.pow(a[12], 2) + Math.pow(a[13], 2) + Math.pow(a[14], 2) + Math.pow(a[15], 2) ))\n};\n\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the first operand\n * @param {mat4} b the second operand\n * @returns {mat4} out\n */\nmat4.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    out[3] = a[3] + b[3];\n    out[4] = a[4] + b[4];\n    out[5] = a[5] + b[5];\n    out[6] = a[6] + b[6];\n    out[7] = a[7] + b[7];\n    out[8] = a[8] + b[8];\n    out[9] = a[9] + b[9];\n    out[10] = a[10] + b[10];\n    out[11] = a[11] + b[11];\n    out[12] = a[12] + b[12];\n    out[13] = a[13] + b[13];\n    out[14] = a[14] + b[14];\n    out[15] = a[15] + b[15];\n    return out;\n};\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the first operand\n * @param {mat4} b the second operand\n * @returns {mat4} out\n */\nmat4.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    out[2] = a[2] - b[2];\n    out[3] = a[3] - b[3];\n    out[4] = a[4] - b[4];\n    out[5] = a[5] - b[5];\n    out[6] = a[6] - b[6];\n    out[7] = a[7] - b[7];\n    out[8] = a[8] - b[8];\n    out[9] = a[9] - b[9];\n    out[10] = a[10] - b[10];\n    out[11] = a[11] - b[11];\n    out[12] = a[12] - b[12];\n    out[13] = a[13] - b[13];\n    out[14] = a[14] - b[14];\n    out[15] = a[15] - b[15];\n    return out;\n};\n\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\nmat4.sub = mat4.subtract;\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\nmat4.multiplyScalar = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    out[3] = a[3] * b;\n    out[4] = a[4] * b;\n    out[5] = a[5] * b;\n    out[6] = a[6] * b;\n    out[7] = a[7] * b;\n    out[8] = a[8] * b;\n    out[9] = a[9] * b;\n    out[10] = a[10] * b;\n    out[11] = a[11] * b;\n    out[12] = a[12] * b;\n    out[13] = a[13] * b;\n    out[14] = a[14] * b;\n    out[15] = a[15] * b;\n    return out;\n};\n\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {mat4} a the first operand\n * @param {mat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\nmat4.multiplyScalarAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    out[2] = a[2] + (b[2] * scale);\n    out[3] = a[3] + (b[3] * scale);\n    out[4] = a[4] + (b[4] * scale);\n    out[5] = a[5] + (b[5] * scale);\n    out[6] = a[6] + (b[6] * scale);\n    out[7] = a[7] + (b[7] * scale);\n    out[8] = a[8] + (b[8] * scale);\n    out[9] = a[9] + (b[9] * scale);\n    out[10] = a[10] + (b[10] * scale);\n    out[11] = a[11] + (b[11] * scale);\n    out[12] = a[12] + (b[12] * scale);\n    out[13] = a[13] + (b[13] * scale);\n    out[14] = a[14] + (b[14] * scale);\n    out[15] = a[15] + (b[15] * scale);\n    return out;\n};\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {mat4} a The first matrix.\n * @param {mat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat4.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && \n           a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && \n           a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] &&\n           a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n};\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {mat4} a The first matrix.\n * @param {mat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nmat4.equals = function (a, b) {\n    var a0  = a[0],  a1  = a[1],  a2  = a[2],  a3  = a[3],\n        a4  = a[4],  a5  = a[5],  a6  = a[6],  a7  = a[7], \n        a8  = a[8],  a9  = a[9],  a10 = a[10], a11 = a[11], \n        a12 = a[12], a13 = a[13], a14 = a[14], a15 = a[15];\n\n    var b0  = b[0],  b1  = b[1],  b2  = b[2],  b3  = b[3],\n        b4  = b[4],  b5  = b[5],  b6  = b[6],  b7  = b[7], \n        b8  = b[8],  b9  = b[9],  b10 = b[10], b11 = b[11], \n        b12 = b[12], b13 = b[13], b14 = b[14], b15 = b[15];\n\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a8), Math.abs(b8)) &&\n            Math.abs(a9 - b9) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a9), Math.abs(b9)) &&\n            Math.abs(a10 - b10) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a10), Math.abs(b10)) &&\n            Math.abs(a11 - b11) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a11), Math.abs(b11)) &&\n            Math.abs(a12 - b12) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a12), Math.abs(b12)) &&\n            Math.abs(a13 - b13) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a13), Math.abs(b13)) &&\n            Math.abs(a14 - b14) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a14), Math.abs(b14)) &&\n            Math.abs(a15 - b15) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a15), Math.abs(b15)));\n};\n\n\n\nmodule.exports = mat4;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/mat4.js\n// module id = 181\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/mat4.js?")},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\nvar mat3 = __webpack_require__(104);\nvar vec3 = __webpack_require__(105);\nvar vec4 = __webpack_require__(106);\n\n/**\n * @class Quaternion\n * @name quat\n */\nvar quat = {};\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\nquat.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(4);\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    return out;\n};\n\n/**\n * Sets a quaternion to represent the shortest rotation from one\n * vector to another.\n *\n * Both vectors are assumed to be unit length.\n *\n * @param {quat} out the receiving quaternion.\n * @param {vec3} a the initial vector\n * @param {vec3} b the destination vector\n * @returns {quat} out\n */\nquat.rotationTo = (function() {\n    var tmpvec3 = vec3.create();\n    var xUnitVec3 = vec3.fromValues(1,0,0);\n    var yUnitVec3 = vec3.fromValues(0,1,0);\n\n    return function(out, a, b) {\n        var dot = vec3.dot(a, b);\n        if (dot < -0.999999) {\n            vec3.cross(tmpvec3, xUnitVec3, a);\n            if (vec3.length(tmpvec3) < 0.000001)\n                vec3.cross(tmpvec3, yUnitVec3, a);\n            vec3.normalize(tmpvec3, tmpvec3);\n            quat.setAxisAngle(out, tmpvec3, Math.PI);\n            return out;\n        } else if (dot > 0.999999) {\n            out[0] = 0;\n            out[1] = 0;\n            out[2] = 0;\n            out[3] = 1;\n            return out;\n        } else {\n            vec3.cross(tmpvec3, a, b);\n            out[0] = tmpvec3[0];\n            out[1] = tmpvec3[1];\n            out[2] = tmpvec3[2];\n            out[3] = 1 + dot;\n            return quat.normalize(out, out);\n        }\n    };\n})();\n\n/**\n * Sets the specified quaternion with values corresponding to the given\n * axes. Each axis is a vec3 and is expected to be unit length and\n * perpendicular to all other specified axes.\n *\n * @param {vec3} view  the vector representing the viewing direction\n * @param {vec3} right the vector representing the local \"right\" direction\n * @param {vec3} up    the vector representing the local \"up\" direction\n * @returns {quat} out\n */\nquat.setAxes = (function() {\n    var matr = mat3.create();\n\n    return function(out, view, right, up) {\n        matr[0] = right[0];\n        matr[3] = right[1];\n        matr[6] = right[2];\n\n        matr[1] = up[0];\n        matr[4] = up[1];\n        matr[7] = up[2];\n\n        matr[2] = -view[0];\n        matr[5] = -view[1];\n        matr[8] = -view[2];\n\n        return quat.normalize(out, quat.fromMat3(out, matr));\n    };\n})();\n\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {quat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\nquat.clone = vec4.clone;\n\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\nquat.fromValues = vec4.fromValues;\n\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the source quaternion\n * @returns {quat} out\n * @function\n */\nquat.copy = vec4.copy;\n\n/**\n * Set the components of a quat to the given values\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} out\n * @function\n */\nquat.set = vec4.set;\n\n/**\n * Set a quat to the identity quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\nquat.identity = function(out) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 1;\n    return out;\n};\n\n/**\n * Sets a quat from the given angle and rotation axis,\n * then returns it.\n *\n * @param {quat} out the receiving quaternion\n * @param {vec3} axis the axis around which to rotate\n * @param {Number} rad the angle in radians\n * @returns {quat} out\n **/\nquat.setAxisAngle = function(out, axis, rad) {\n    rad = rad * 0.5;\n    var s = Math.sin(rad);\n    out[0] = s * axis[0];\n    out[1] = s * axis[1];\n    out[2] = s * axis[2];\n    out[3] = Math.cos(rad);\n    return out;\n};\n\n/**\n * Gets the rotation axis and angle for a given\n *  quaternion. If a quaternion is created with\n *  setAxisAngle, this method will return the same\n *  values as providied in the original parameter list\n *  OR functionally equivalent values.\n * Example: The quaternion formed by axis [0, 0, 1] and\n *  angle -90 is the same as the quaternion formed by\n *  [0, 0, 1] and 270. This method favors the latter.\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\n * @param  {quat} q     Quaternion to be decomposed\n * @return {Number}     Angle, in radians, of the rotation\n */\nquat.getAxisAngle = function(out_axis, q) {\n    var rad = Math.acos(q[3]) * 2.0;\n    var s = Math.sin(rad / 2.0);\n    if (s != 0.0) {\n        out_axis[0] = q[0] / s;\n        out_axis[1] = q[1] / s;\n        out_axis[2] = q[2] / s;\n    } else {\n        // If s is zero, return any axis (no rotation - axis does not matter)\n        out_axis[0] = 1;\n        out_axis[1] = 0;\n        out_axis[2] = 0;\n    }\n    return rad;\n};\n\n/**\n * Adds two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @returns {quat} out\n * @function\n */\nquat.add = vec4.add;\n\n/**\n * Multiplies two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @returns {quat} out\n */\nquat.multiply = function(out, a, b) {\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        bx = b[0], by = b[1], bz = b[2], bw = b[3];\n\n    out[0] = ax * bw + aw * bx + ay * bz - az * by;\n    out[1] = ay * bw + aw * by + az * bx - ax * bz;\n    out[2] = az * bw + aw * bz + ax * by - ay * bx;\n    out[3] = aw * bw - ax * bx - ay * by - az * bz;\n    return out;\n};\n\n/**\n * Alias for {@link quat.multiply}\n * @function\n */\nquat.mul = quat.multiply;\n\n/**\n * Scales a quat by a scalar number\n *\n * @param {quat} out the receiving vector\n * @param {quat} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {quat} out\n * @function\n */\nquat.scale = vec4.scale;\n\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {quat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nquat.rotateX = function (out, a, rad) {\n    rad *= 0.5; \n\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        bx = Math.sin(rad), bw = Math.cos(rad);\n\n    out[0] = ax * bw + aw * bx;\n    out[1] = ay * bw + az * bx;\n    out[2] = az * bw - ay * bx;\n    out[3] = aw * bw - ax * bx;\n    return out;\n};\n\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {quat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nquat.rotateY = function (out, a, rad) {\n    rad *= 0.5; \n\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        by = Math.sin(rad), bw = Math.cos(rad);\n\n    out[0] = ax * bw - az * by;\n    out[1] = ay * bw + aw * by;\n    out[2] = az * bw + ax * by;\n    out[3] = aw * bw - ay * by;\n    return out;\n};\n\n/**\n * Rotates a quaternion by the given angle about the Z axis\n *\n * @param {quat} out quat receiving operation result\n * @param {quat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\nquat.rotateZ = function (out, a, rad) {\n    rad *= 0.5; \n\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        bz = Math.sin(rad), bw = Math.cos(rad);\n\n    out[0] = ax * bw + ay * bz;\n    out[1] = ay * bw - ax * bz;\n    out[2] = az * bw + aw * bz;\n    out[3] = aw * bw - az * bz;\n    return out;\n};\n\n/**\n * Calculates the W component of a quat from the X, Y, and Z components.\n * Assumes that quaternion is 1 unit in length.\n * Any existing W component will be ignored.\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a quat to calculate W component of\n * @returns {quat} out\n */\nquat.calculateW = function (out, a) {\n    var x = a[0], y = a[1], z = a[2];\n\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n    return out;\n};\n\n/**\n * Calculates the dot product of two quat's\n *\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\nquat.dot = vec4.dot;\n\n/**\n * Performs a linear interpolation between two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {quat} out\n * @function\n */\nquat.lerp = vec4.lerp;\n\n/**\n * Performs a spherical linear interpolation between two quat\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {quat} out\n */\nquat.slerp = function (out, a, b, t) {\n    // benchmarks:\n    //    http://jsperf.com/quaternion-slerp-implementations\n\n    var ax = a[0], ay = a[1], az = a[2], aw = a[3],\n        bx = b[0], by = b[1], bz = b[2], bw = b[3];\n\n    var        omega, cosom, sinom, scale0, scale1;\n\n    // calc cosine\n    cosom = ax * bx + ay * by + az * bz + aw * bw;\n    // adjust signs (if necessary)\n    if ( cosom < 0.0 ) {\n        cosom = -cosom;\n        bx = - bx;\n        by = - by;\n        bz = - bz;\n        bw = - bw;\n    }\n    // calculate coefficients\n    if ( (1.0 - cosom) > 0.000001 ) {\n        // standard case (slerp)\n        omega  = Math.acos(cosom);\n        sinom  = Math.sin(omega);\n        scale0 = Math.sin((1.0 - t) * omega) / sinom;\n        scale1 = Math.sin(t * omega) / sinom;\n    } else {        \n        // \"from\" and \"to\" quaternions are very close \n        //  ... so we can do a linear interpolation\n        scale0 = 1.0 - t;\n        scale1 = t;\n    }\n    // calculate final values\n    out[0] = scale0 * ax + scale1 * bx;\n    out[1] = scale0 * ay + scale1 * by;\n    out[2] = scale0 * az + scale1 * bz;\n    out[3] = scale0 * aw + scale1 * bw;\n    \n    return out;\n};\n\n/**\n * Performs a spherical linear interpolation with two control points\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a the first operand\n * @param {quat} b the second operand\n * @param {quat} c the third operand\n * @param {quat} d the fourth operand\n * @param {Number} t interpolation amount\n * @returns {quat} out\n */\nquat.sqlerp = (function () {\n  var temp1 = quat.create();\n  var temp2 = quat.create();\n  \n  return function (out, a, b, c, d, t) {\n    quat.slerp(temp1, a, d, t);\n    quat.slerp(temp2, b, c, t);\n    quat.slerp(out, temp1, temp2, 2 * t * (1 - t));\n    \n    return out;\n  };\n}());\n\n/**\n * Calculates the inverse of a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a quat to calculate inverse of\n * @returns {quat} out\n */\nquat.invert = function(out, a) {\n    var a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3],\n        dot = a0*a0 + a1*a1 + a2*a2 + a3*a3,\n        invDot = dot ? 1.0/dot : 0;\n    \n    // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n    out[0] = -a0*invDot;\n    out[1] = -a1*invDot;\n    out[2] = -a2*invDot;\n    out[3] = a3*invDot;\n    return out;\n};\n\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a quat to calculate conjugate of\n * @returns {quat} out\n */\nquat.conjugate = function (out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    out[2] = -a[2];\n    out[3] = a[3];\n    return out;\n};\n\n/**\n * Calculates the length of a quat\n *\n * @param {quat} a vector to calculate length of\n * @returns {Number} length of a\n * @function\n */\nquat.length = vec4.length;\n\n/**\n * Alias for {@link quat.length}\n * @function\n */\nquat.len = quat.length;\n\n/**\n * Calculates the squared length of a quat\n *\n * @param {quat} a vector to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\nquat.squaredLength = vec4.squaredLength;\n\n/**\n * Alias for {@link quat.squaredLength}\n * @function\n */\nquat.sqrLen = quat.squaredLength;\n\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {quat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\nquat.normalize = vec4.normalize;\n\n/**\n * Creates a quaternion from the given 3x3 rotation matrix.\n *\n * NOTE: The resultant quaternion is not normalized, so you should be sure\n * to renormalize the quaternion yourself where necessary.\n *\n * @param {quat} out the receiving quaternion\n * @param {mat3} m rotation matrix\n * @returns {quat} out\n * @function\n */\nquat.fromMat3 = function(out, m) {\n    // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n    // article \"Quaternion Calculus and Fast Animation\".\n    var fTrace = m[0] + m[4] + m[8];\n    var fRoot;\n\n    if ( fTrace > 0.0 ) {\n        // |w| > 1/2, may as well choose w > 1/2\n        fRoot = Math.sqrt(fTrace + 1.0);  // 2w\n        out[3] = 0.5 * fRoot;\n        fRoot = 0.5/fRoot;  // 1/(4w)\n        out[0] = (m[5]-m[7])*fRoot;\n        out[1] = (m[6]-m[2])*fRoot;\n        out[2] = (m[1]-m[3])*fRoot;\n    } else {\n        // |w| <= 1/2\n        var i = 0;\n        if ( m[4] > m[0] )\n          i = 1;\n        if ( m[8] > m[i*3+i] )\n          i = 2;\n        var j = (i+1)%3;\n        var k = (i+2)%3;\n        \n        fRoot = Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k] + 1.0);\n        out[i] = 0.5 * fRoot;\n        fRoot = 0.5 / fRoot;\n        out[3] = (m[j*3+k] - m[k*3+j]) * fRoot;\n        out[j] = (m[j*3+i] + m[i*3+j]) * fRoot;\n        out[k] = (m[k*3+i] + m[i*3+k]) * fRoot;\n    }\n    \n    return out;\n};\n\n/**\n * Returns a string representation of a quatenion\n *\n * @param {quat} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nquat.str = function (a) {\n    return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n};\n\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {quat} a The first quaternion.\n * @param {quat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nquat.exactEquals = vec4.exactEquals;\n\n/**\n * Returns whether or not the quaternions have approximately the same elements in the same position.\n *\n * @param {quat} a The first vector.\n * @param {quat} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nquat.equals = vec4.equals;\n\nmodule.exports = quat;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/quat.js\n// module id = 182\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/quat.js?")},function(module,exports,__webpack_require__){eval("/* Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE. */\n\nvar glMatrix = __webpack_require__(29);\n\n/**\n * @class 2 Dimensional Vector\n * @name vec2\n */\nvar vec2 = {};\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\nvec2.create = function() {\n    var out = new glMatrix.ARRAY_TYPE(2);\n    out[0] = 0;\n    out[1] = 0;\n    return out;\n};\n\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {vec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\nvec2.clone = function(a) {\n    var out = new glMatrix.ARRAY_TYPE(2);\n    out[0] = a[0];\n    out[1] = a[1];\n    return out;\n};\n\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\nvec2.fromValues = function(x, y) {\n    var out = new glMatrix.ARRAY_TYPE(2);\n    out[0] = x;\n    out[1] = y;\n    return out;\n};\n\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the source vector\n * @returns {vec2} out\n */\nvec2.copy = function(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    return out;\n};\n\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\nvec2.set = function(out, x, y) {\n    out[0] = x;\n    out[1] = y;\n    return out;\n};\n\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nvec2.add = function(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    return out;\n};\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nvec2.subtract = function(out, a, b) {\n    out[0] = a[0] - b[0];\n    out[1] = a[1] - b[1];\n    return out;\n};\n\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\nvec2.sub = vec2.subtract;\n\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nvec2.multiply = function(out, a, b) {\n    out[0] = a[0] * b[0];\n    out[1] = a[1] * b[1];\n    return out;\n};\n\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\nvec2.mul = vec2.multiply;\n\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nvec2.divide = function(out, a, b) {\n    out[0] = a[0] / b[0];\n    out[1] = a[1] / b[1];\n    return out;\n};\n\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\nvec2.div = vec2.divide;\n\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to ceil\n * @returns {vec2} out\n */\nvec2.ceil = function (out, a) {\n    out[0] = Math.ceil(a[0]);\n    out[1] = Math.ceil(a[1]);\n    return out;\n};\n\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to floor\n * @returns {vec2} out\n */\nvec2.floor = function (out, a) {\n    out[0] = Math.floor(a[0]);\n    out[1] = Math.floor(a[1]);\n    return out;\n};\n\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nvec2.min = function(out, a, b) {\n    out[0] = Math.min(a[0], b[0]);\n    out[1] = Math.min(a[1], b[1]);\n    return out;\n};\n\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec2} out\n */\nvec2.max = function(out, a, b) {\n    out[0] = Math.max(a[0], b[0]);\n    out[1] = Math.max(a[1], b[1]);\n    return out;\n};\n\n/**\n * Math.round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to round\n * @returns {vec2} out\n */\nvec2.round = function (out, a) {\n    out[0] = Math.round(a[0]);\n    out[1] = Math.round(a[1]);\n    return out;\n};\n\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\nvec2.scale = function(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    return out;\n};\n\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\nvec2.scaleAndAdd = function(out, a, b, scale) {\n    out[0] = a[0] + (b[0] * scale);\n    out[1] = a[1] + (b[1] * scale);\n    return out;\n};\n\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {Number} distance between a and b\n */\nvec2.distance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1];\n    return Math.sqrt(x*x + y*y);\n};\n\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\nvec2.dist = vec2.distance;\n\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\nvec2.squaredDistance = function(a, b) {\n    var x = b[0] - a[0],\n        y = b[1] - a[1];\n    return x*x + y*y;\n};\n\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\nvec2.sqrDist = vec2.squaredDistance;\n\n/**\n * Calculates the length of a vec2\n *\n * @param {vec2} a vector to calculate length of\n * @returns {Number} length of a\n */\nvec2.length = function (a) {\n    var x = a[0],\n        y = a[1];\n    return Math.sqrt(x*x + y*y);\n};\n\n/**\n * Alias for {@link vec2.length}\n * @function\n */\nvec2.len = vec2.length;\n\n/**\n * Calculates the squared length of a vec2\n *\n * @param {vec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nvec2.squaredLength = function (a) {\n    var x = a[0],\n        y = a[1];\n    return x*x + y*y;\n};\n\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\nvec2.sqrLen = vec2.squaredLength;\n\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to negate\n * @returns {vec2} out\n */\nvec2.negate = function(out, a) {\n    out[0] = -a[0];\n    out[1] = -a[1];\n    return out;\n};\n\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to invert\n * @returns {vec2} out\n */\nvec2.inverse = function(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n};\n\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a vector to normalize\n * @returns {vec2} out\n */\nvec2.normalize = function(out, a) {\n    var x = a[0],\n        y = a[1];\n    var len = x*x + y*y;\n    if (len > 0) {\n        //TODO: evaluate use of glm_invsqrt here?\n        len = 1 / Math.sqrt(len);\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n    }\n    return out;\n};\n\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {Number} dot product of a and b\n */\nvec2.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1];\n};\n\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @returns {vec3} out\n */\nvec2.cross = function(out, a, b) {\n    var z = a[0] * b[1] - a[1] * b[0];\n    out[0] = out[1] = 0;\n    out[2] = z;\n    return out;\n};\n\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the first operand\n * @param {vec2} b the second operand\n * @param {Number} t interpolation amount between the two inputs\n * @returns {vec2} out\n */\nvec2.lerp = function (out, a, b, t) {\n    var ax = a[0],\n        ay = a[1];\n    out[0] = ax + t * (b[0] - ax);\n    out[1] = ay + t * (b[1] - ay);\n    return out;\n};\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec2} out\n */\nvec2.random = function (out, scale) {\n    scale = scale || 1.0;\n    var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n    out[0] = Math.cos(r) * scale;\n    out[1] = Math.sin(r) * scale;\n    return out;\n};\n\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the vector to transform\n * @param {mat2} m matrix to transform with\n * @returns {vec2} out\n */\nvec2.transformMat2 = function(out, a, m) {\n    var x = a[0],\n        y = a[1];\n    out[0] = m[0] * x + m[2] * y;\n    out[1] = m[1] * x + m[3] * y;\n    return out;\n};\n\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the vector to transform\n * @param {mat2d} m matrix to transform with\n * @returns {vec2} out\n */\nvec2.transformMat2d = function(out, a, m) {\n    var x = a[0],\n        y = a[1];\n    out[0] = m[0] * x + m[2] * y + m[4];\n    out[1] = m[1] * x + m[3] * y + m[5];\n    return out;\n};\n\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the vector to transform\n * @param {mat3} m matrix to transform with\n * @returns {vec2} out\n */\nvec2.transformMat3 = function(out, a, m) {\n    var x = a[0],\n        y = a[1];\n    out[0] = m[0] * x + m[3] * y + m[6];\n    out[1] = m[1] * x + m[4] * y + m[7];\n    return out;\n};\n\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {vec2} a the vector to transform\n * @param {mat4} m matrix to transform with\n * @returns {vec2} out\n */\nvec2.transformMat4 = function(out, a, m) {\n    var x = a[0], \n        y = a[1];\n    out[0] = m[0] * x + m[4] * y + m[12];\n    out[1] = m[1] * x + m[5] * y + m[13];\n    return out;\n};\n\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nvec2.forEach = (function() {\n    var vec = vec2.create();\n\n    return function(a, stride, offset, count, fn, arg) {\n        var i, l;\n        if(!stride) {\n            stride = 2;\n        }\n\n        if(!offset) {\n            offset = 0;\n        }\n        \n        if(count) {\n            l = Math.min((count * stride) + offset, a.length);\n        } else {\n            l = a.length;\n        }\n\n        for(i = offset; i < l; i += stride) {\n            vec[0] = a[i]; vec[1] = a[i+1];\n            fn(vec, vec, arg);\n            a[i] = vec[0]; a[i+1] = vec[1];\n        }\n        \n        return a;\n    };\n})();\n\n/**\n * Returns a string representation of a vector\n *\n * @param {vec2} vec vector to represent as a string\n * @returns {String} string representation of the vector\n */\nvec2.str = function (a) {\n    return 'vec2(' + a[0] + ', ' + a[1] + ')';\n};\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {vec2} a The first vector.\n * @param {vec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nvec2.exactEquals = function (a, b) {\n    return a[0] === b[0] && a[1] === b[1];\n};\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {vec2} a The first vector.\n * @param {vec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nvec2.equals = function (a, b) {\n    var a0 = a[0], a1 = a[1];\n    var b0 = b[0], b1 = b[1];\n    return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)));\n};\n\nmodule.exports = vec2;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/gl-matrix/src/gl-matrix/vec2.js\n// module id = 183\n// module chunks = 0\n\n//# sourceURL=webpack:///./node_modules/gl-matrix/src/gl-matrix/vec2.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony default export */ __webpack_exports__["a"] = ({\n    ArrayType: Float64Array\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/config.js\n// module id = 184\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/config.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Timer__ = __webpack_require__(22);\n\n\n\nvar TextureProfile = function(target, internalFormat, width, height) {\n    this._target = target;\n    this._internalFormat = internalFormat;\n    this._width = width;\n    this._height = height;\n    this._size = 0;\n    this.computeSize();\n};\n\nTextureProfile.prototype = {\n    match: function(textureProfile) {\n        return (\n            textureProfile._target === this._target &&\n            textureProfile._internalFormat === this._internalFormat &&\n            textureProfile._width === this._width &&\n            textureProfile._height === this._height\n        );\n    },\n    computeSize: function() {\n        var Texture = __webpack_require__(7).default;\n\n        var numBitsPerTexel = 0;\n        switch (this._internalFormat) {\n            case 1:\n                numBitsPerTexel = 8;\n                break;\n            case Texture.ALPHA:\n                numBitsPerTexel = 8;\n                break;\n            case Texture.LUMINANCE:\n                numBitsPerTexel = 8;\n                break;\n\n            case Texture.LUMINANCE_ALPHA:\n                numBitsPerTexel = 16;\n                break;\n            case 2:\n                numBitsPerTexel = 16;\n                break;\n\n            case Texture.RGB:\n                numBitsPerTexel = 24;\n                break;\n            case 3:\n                numBitsPerTexel = 24;\n                break;\n\n            case Texture.RGBA:\n                numBitsPerTexel = 32;\n                break;\n            case 4:\n                numBitsPerTexel = 32;\n                break;\n        }\n        var size = Math.ceil(this._width * this._height * numBitsPerTexel) / 8.0;\n\n        if (this._target === Texture.TEXTURE_CUBE_MAP) size *= 6.0;\n\n        // add the mipmap overhead size even if not used\n        size += size / 3.0;\n\n        this._size = size;\n    },\n\n    getSize: function() {\n        return this._size;\n    }\n};\nTextureProfile.getHash = function() {\n    var array = Array.prototype.slice.call(arguments);\n    var hash = '';\n    array.forEach(function(element) {\n        hash += element;\n    });\n    return hash;\n};\n\nvar TextureObject = function(texture, id, textureSet) {\n    this._texture = texture;\n    this._id = id;\n    this._textureSet = textureSet;\n};\n\nTextureObject.prototype = {\n    target: function() {\n        return this._textureSet._profile._target;\n    },\n    id: function() {\n        return this._id;\n    },\n    getTextureSet: function() {\n        return this._textureSet;\n    },\n    reset: function() {\n        this._textureObject = null;\n        this._texture = undefined;\n    },\n    bind: function(gl) {\n        gl.bindTexture(this.target(), this._id);\n    }\n};\n\nvar TextureObjectSet = function(profile) {\n    this._profile = profile;\n    this._usedTextureObjects = [];\n    this._orphanedTextureObjects = [];\n};\n\nTextureObjectSet.prototype = {\n    getProfile: function() {\n        return this._profile;\n    },\n    getUsedTextureObjects: function() {\n        return this._usedTextureObjects;\n    },\n    getOrphanedTextureObjects: function() {\n        return this._orphanedTextureObjects;\n    },\n\n    takeOrGenerate: function(gl, texture) {\n        var textureObject;\n        if (this._orphanedTextureObjects.length > 0) {\n            textureObject = this.takeFromOrphans();\n            textureObject._texture = texture;\n            this._usedTextureObjects.push(textureObject);\n            return textureObject;\n        }\n\n        var textureID = gl.createTexture();\n        textureObject = new TextureObject(texture, textureID, this);\n        this._usedTextureObjects.push(textureObject);\n\n        return textureObject;\n    },\n\n    // get texture object from pool\n    takeFromOrphans: function() {\n        if (this._orphanedTextureObjects.length) return this._orphanedTextureObjects.pop();\n\n        return undefined;\n    },\n\n    // release texture object\n    orphan: function(textureObject) {\n        var index = this._usedTextureObjects.indexOf(textureObject);\n        if (index !== -1) {\n            this._orphanedTextureObjects.push(this._usedTextureObjects[index]);\n            this._usedTextureObjects.splice(index, 1);\n        }\n    },\n\n    flushDeletedTextureObjects: function(gl, availableTime) {\n        // if no time available don't try to flush objects.\n        if (availableTime <= 0.0) return availableTime;\n        var nbTextures = this._orphanedTextureObjects.length;\n        // Should we use a maxSizeTexturePool value?\n        //var size = this.getProfile().getSize();\n        // We need to test if we have time to flush\n        var elapsedTime = 0.0;\n        var beginTime = __WEBPACK_IMPORTED_MODULE_1_osg_Timer__[\"a\" /* default */].instance().tick();\n        var i;\n        for (i = 0; i < nbTextures && elapsedTime < availableTime; i++) {\n            gl.deleteTexture(this._orphanedTextureObjects[i].id());\n            this._orphanedTextureObjects[i].reset();\n            elapsedTime = __WEBPACK_IMPORTED_MODULE_1_osg_Timer__[\"a\" /* default */].instance().deltaS(beginTime, __WEBPACK_IMPORTED_MODULE_1_osg_Timer__[\"a\" /* default */].instance().tick());\n        }\n        this._orphanedTextureObjects.splice(0, i);\n        return availableTime - elapsedTime;\n    },\n\n    flushAllDeletedTextureObjects: function(gl) {\n        var nbTextures = this._orphanedTextureObjects.length;\n        var size = this.getProfile().getSize();\n        for (var i = 0, j = nbTextures; i < j; ++i) {\n            gl.deleteTexture(this._orphanedTextureObjects[i].id());\n            this._orphanedTextureObjects[i].reset();\n        }\n        this._orphanedTextureObjects.length = 0;\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].info(\n            'TextureManager: released ' +\n                nbTextures +\n                ' with ' +\n                nbTextures * size / (1024 * 1024) +\n                ' MB'\n        );\n    },\n\n    onLostContext: function() {\n        var i, nbTextures;\n\n        nbTextures = this._orphanedTextureObjects.length;\n        for (i = 0; i < nbTextures; ++i) {\n            this._orphanedTextureObjects[i].reset();\n        }\n        this._orphanedTextureObjects.length = 0;\n\n        nbTextures = this._usedTextureObjects.length;\n        for (i = 0; i < nbTextures; ++i) {\n            this._usedTextureObjects[i].reset();\n        }\n        this._usedTextureObjects.length = 0;\n    }\n};\n\nvar TextureManager = function() {\n    this._textureSetMap = {};\n};\n\nTextureManager.prototype = {\n    generateTextureObject: function(gl, texture, target, internalFormat, width, height) {\n        var hash = TextureProfile.getHash(target, internalFormat, width, height);\n\n        if (this._textureSetMap[hash] === undefined) {\n            this._textureSetMap[hash] = new TextureObjectSet(\n                new TextureProfile(target, internalFormat, width, height)\n            );\n        }\n\n        var textureSet = this._textureSetMap[hash];\n        var textureObject = textureSet.takeOrGenerate(gl, texture);\n        return textureObject;\n    },\n\n    updateStats: function(frameNumber, stats) {\n        var totalUsed = 0;\n        var totalUnused = 0;\n        for (var keyTexture in this._textureSetMap) {\n            var profile = this._textureSetMap[keyTexture].getProfile();\n            var size = profile.getSize();\n            var nbUsed = this._textureSetMap[keyTexture].getUsedTextureObjects().length;\n            var nbUnused = this._textureSetMap[keyTexture].getOrphanedTextureObjects().length;\n            totalUsed += nbUsed * size;\n            totalUnused += nbUnused * size;\n        }\n\n        var MB = 1024 * 1024;\n        stats.getCounter('textureused').set(totalUsed / MB);\n        stats.getCounter('texturereserved').set(totalUnused / MB);\n        stats.getCounter('texturetotal').set((totalUsed + totalUnused) / MB);\n    },\n\n    reportStats: function() {\n        var total = 0;\n        for (var keyTexture in this._textureSetMap) {\n            var profile = this._textureSetMap[keyTexture].getProfile();\n            var size = profile.getSize() / (1024 * 1024);\n            var nb = this._textureSetMap[keyTexture].getUsedTextureObjects().length;\n            size *= nb;\n            total += size;\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].notice(\n                String(size) +\n                    ' MB with ' +\n                    nb +\n                    ' texture of ' +\n                    profile._width +\n                    'x' +\n                    profile._height +\n                    ' ' +\n                    profile._internalFormat\n            );\n        }\n\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].notice(String(total) + ' MB in total');\n    },\n\n    flushAllDeletedTextureObjects: function(gl) {\n        for (var keyTexture in this._textureSetMap) {\n            this._textureSetMap[keyTexture].flushAllDeletedTextureObjects(gl);\n        }\n    },\n\n    onLostContext: function(gl) {\n        for (var keyTexture in this._textureSetMap) {\n            this._textureSetMap[keyTexture].onLostContext(gl);\n        }\n    },\n\n    flushDeletedTextureObjects: function(gl, availableTimeArg) {\n        var availableTime = availableTimeArg;\n        for (var keyTexture in this._textureSetMap) {\n            availableTime = this._textureSetMap[keyTexture].flushDeletedTextureObjects(\n                gl,\n                availableTime\n            );\n            if (availableTime <= 0.0) break;\n        }\n        return availableTime;\n    },\n\n    releaseTextureObject: function(textureObject) {\n        if (textureObject) {\n            var ts = textureObject.getTextureSet();\n            ts.orphan(textureObject);\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (TextureManager);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/TextureManager.js\n// module id = 185\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/TextureManager.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\nvar BillboardAttribute = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this._attributeEnable = false;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    BillboardAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'Billboard\',\n\n        cloneType: function() {\n            return new BillboardAttribute();\n        },\n\n        setEnabled: function(state) {\n            this._attributeEnable = state;\n        },\n\n        isEnabled: function() {\n            return this._attributeEnable;\n        },\n\n        apply: function() {}\n    }),\n    \'osg\',\n    \'Billboard\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (BillboardAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BillboardAttribute.js\n// module id = 186\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BillboardAttribute.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n/**\n *  Manage BlendColor attribute\n *  @class\n *  @memberOf osg\n *  @extends StateAttribute\n */\nvar BlendColor = function(color) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this._constantColor = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].create();\n    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].set(this._constantColor, 1.0, 1.0, 1.0, 1.0);\n    if (color !== undefined) {\n        this.setConstantColor(color);\n    }\n};\n\n/**\n * @lends BlendColor.prototype\n */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    BlendColor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'BlendColor\',\n        cloneType: function() {\n            return new BlendColor();\n        },\n\n        /**\n     *\n     * @param {} color\n     */\n        setConstantColor: function(color) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].copy(this._constantColor, color);\n        },\n        getConstantColor: function() {\n            return this._constantColor;\n        },\n        apply: function(state) {\n            var gl = state.getGraphicContext();\n            gl.blendColor(\n                this._constantColor[0],\n                this._constantColor[1],\n                this._constantColor[2],\n                this._constantColor[3]\n            );\n        }\n    }),\n    \'osg\',\n    \'BlendColor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (BlendColor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/BlendColor.js\n// module id = 187\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/BlendColor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\nvar ColorMask = function(red, green, blue, alpha) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this._red = true;\n    this._green = true;\n    this._blue = true;\n    this._alpha = true;\n\n    if (red !== undefined && green !== undefined && blue !== undefined)\n        this.setMask(red, green, blue, alpha);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    ColorMask,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'ColorMask\',\n        cloneType: function() {\n            return new ColorMask();\n        },\n        setMask: function(red, green, blue, alpha) {\n            this._red = !!red;\n            this._green = !!green;\n            this._blue = !!blue;\n            this._alpha = !!alpha;\n        },\n        apply: function(state) {\n            state.applyColorMask(this);\n        }\n    }),\n    \'osg\',\n    \'ColorMask\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ColorMask);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/ColorMask.js\n// module id = 188\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/ColorMask.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_FindNearestParentSkeleton__ = __webpack_require__(190);\n\n\n\n\n\n// converted from C++ probably it could be merged into RigGeometry\n// it could probably inlined into RigGeometry code\nvar UpdateRigGeometry = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    UpdateRigGeometry,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Object__["a" /* default */].prototype, {\n        init: function(geom) {\n            var finder = new __WEBPACK_IMPORTED_MODULE_3_osgAnimation_FindNearestParentSkeleton__["a" /* default */]();\n            if (geom.getParents().length > 1)\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\n                    \'A RigGeometry should not have multi parent ( \' + geom.getName() + \' )\'\n                );\n\n            geom.getParents()[0].accept(finder);\n\n            if (!finder._root) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_notify__["a" /* default */].warn(\n                    \'A RigGeometry did not find a parent skeleton for RigGeometry ( \' +\n                        geom.getName() +\n                        \' )\'\n                );\n                return;\n            }\n\n            geom.setSkeleton(finder._root);\n            geom.setPathToSkeleton(finder._pathToRoot);\n        },\n\n        update: function(node /*, nv*/) {\n            // Circular ref\n            if (node && node.className() !== \'RigGeometry\') return true;\n\n            var geom = node;\n\n            // maybe this code could simpler\n            if (!geom.getSkeleton() && geom.getParents().length !== 0) this.init(geom);\n            if (!geom.getSkeleton()) return true;\n\n            if (geom.getNeedToComputeMatrix()) geom.computeMatrixFromRootSkeleton();\n\n            geom.update();\n\n            return true;\n        }\n    }),\n    \'osgAnimation\',\n    \'UpdateRigGeometry\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (UpdateRigGeometry);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/UpdateRigGeometry.js\n// module id = 189\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/UpdateRigGeometry.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_Skeleton__ = __webpack_require__(62);\n\n\n\n\n/**\n * FindNearestParentSkeleton\n */\n\nvar FindNearestParentSkeleton = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].TRAVERSE_PARENTS);\n    this._root = undefined;\n\n    // node path to skeleton (without skeleton node though)\n    this._pathToRoot = undefined;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    FindNearestParentSkeleton,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (this._root) return;\n\n            if (node.typeID === __WEBPACK_IMPORTED_MODULE_2_osgAnimation_Skeleton__["a" /* default */].typeID) {\n                this._root = node;\n                this._pathToRoot = this.nodePath.slice(1);\n                return;\n            }\n\n            this.traverse(node);\n        }\n    }),\n    \'osgAnimation\',\n    \'FindNearestParentSkeleton\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (FindNearestParentSkeleton);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/FindNearestParentSkeleton.js\n// module id = 190\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/FindNearestParentSkeleton.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_SkinningAttribute__ = __webpack_require__(114);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_CollectBoneVisitor__ = __webpack_require__(192);\n\n\n\n\n\n/**\n * Hardware implementation for rigGeometry\n *\n */\nvar RigTransformHardware = function() {\n    this._isInitialized = false;\n\n    // bones are sorted to be used directly by\n    // computeMatrixPalette\n    // means the\n    this._bones = [];\n};\n\nRigTransformHardware.prototype = {\n    // boneNameID contains a map: boneName: id\n    // {\n    //    \'bone0\' : 1,\n    //    \'bone4\' : 0,\n    // }\n    //\n    // boneMap contains a map: boneName: Bone\n    // {\n    //    \'bone0: : Bone object,\n    //    \'bone1: : Bone object,\n    // }\n    //\n    // return index / bone object\n    // [\n    //    Bone4 object,\n    //    Bone0 object\n    // ]\n    computeBonePalette: function(boneMap, boneNameID) {\n        var bones = this._bones;\n        for (var boneName in boneMap) {\n            var index = boneNameID[boneName];\n            var bone = boneMap[boneName];\n\n            if (index !== undefined) bones[index] = bone;\n        }\n\n        return bones;\n    },\n\n    init: function(geom) {\n        // init the bones map\n\n        // stop here\n        // compute bonemap / index\n        var mapVisitor = new __WEBPACK_IMPORTED_MODULE_3_osgAnimation_CollectBoneVisitor__["a" /* default */]();\n        geom.getSkeleton().accept(mapVisitor);\n        var bm = mapVisitor.getBoneMap();\n\n        this.computeBonePalette(bm, geom._boneNameID);\n\n        // matrix are 4x3\n        var nbVec4Uniforms = this._bones.length * 3;\n        var animAttrib = (this._skinningAttribute = new __WEBPACK_IMPORTED_MODULE_2_osgAnimation_SkinningAttribute__["a" /* default */]());\n        animAttrib.setMatrixPalette(new Float32Array(nbVec4Uniforms * 4));\n        geom.getStateSetAnimation().setAttributeAndModes(animAttrib, __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].ON);\n\n        this._isInitialized = true;\n        return true;\n    },\n\n    computeMatrixPalette: (function() {\n        var mTmp = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create();\n\n        return function(transformFromSkeletonToGeometry, invTransformFromSkeletonToGeometry) {\n            var bones = this._bones;\n            var matPalette = this._skinningAttribute.getMatrixPalette();\n            var uniformIndex = 0;\n\n            for (var i = 0, l = bones.length; i < l; i++) {\n                var bone = bones[i];\n\n                var invBindMatrix = bone.getInvBindMatrixInSkeletonSpace();\n                var boneMatrix = bone.getMatrixInSkeletonSpace();\n\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].mul(mTmp, boneMatrix, invBindMatrix);\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].mul(mTmp, invTransformFromSkeletonToGeometry, mTmp);\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].mul(mTmp, mTmp, transformFromSkeletonToGeometry);\n\n                // TODO: maybe change upload order so that we can use\n                // glsl constructor :\n                // mat4(uBones[index], uBones[index+1], uBones[index+2], vec4(0.0, 0.0, 0.0, 1.0))\n                // for faster glsl\n                matPalette[uniformIndex++] = mTmp[0];\n                matPalette[uniformIndex++] = mTmp[4];\n                matPalette[uniformIndex++] = mTmp[8];\n                matPalette[uniformIndex++] = mTmp[12];\n\n                matPalette[uniformIndex++] = mTmp[1];\n                matPalette[uniformIndex++] = mTmp[5];\n                matPalette[uniformIndex++] = mTmp[9];\n                matPalette[uniformIndex++] = mTmp[13];\n\n                matPalette[uniformIndex++] = mTmp[2];\n                matPalette[uniformIndex++] = mTmp[6];\n                matPalette[uniformIndex++] = mTmp[10];\n                matPalette[uniformIndex++] = mTmp[14];\n            }\n        };\n    })(),\n\n    update: function(geom) {\n        if (!this._isInitialized) this.init(geom);\n\n        this.computeMatrixPalette(\n            geom.getMatrixFromSkeletonToGeometry(),\n            geom.getInvMatrixFromSkeletonToGeometry()\n        );\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (RigTransformHardware);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/RigTransformHardware.js\n// module id = 191\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/RigTransformHardware.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_Bone__ = __webpack_require__(44);\n\n\n\n\n\nvar CollectBoneVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN);\n    this._boneMap = {};\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CollectBoneVisitor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.typeID === __WEBPACK_IMPORTED_MODULE_3_osgAnimation_Bone__["a" /* default */].typeID) {\n                var name = node.getName();\n\n                if (!name) {\n                    __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].warn(\'found Bone without name\');\n                } else {\n                    this._boneMap[name] = node;\n                }\n            }\n\n            this.traverse(node);\n        },\n\n        getBoneMap: function() {\n            return this._boneMap;\n        }\n    }),\n    \'osgAnimation\',\n    \'CollectBoneVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (CollectBoneVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/CollectBoneVisitor.js\n// module id = 192\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/CollectBoneVisitor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_WebGLCaps__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_DrawArrays__ = __webpack_require__(17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_notify__ = __webpack_require__(2);\n// $$ SOURCE_CODE_MODIFIED\n\n\n// var WebGLCaps = require( 'osg/WebGLCaps' );\n// var DrawArrays = require( 'osg/DrawArrays' );\n// var MACROUTILS = require( 'osg/Utils' );\n// var notify = require( 'osg/notify' );\n\n\n\n\n\n/**\n * DrawArraysInstanced manage rendering of instanced primitives\n * @class DrawArraysInstanced\n */\nvar DrawArraysInstanced = function ( mode, first, count, numInstances ) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_DrawArrays__[\"a\" /* default */].call( this, mode, first, count );\n    this.numInstances = numInstances;\n    this.extension = undefined;\n};\n\n/** @lends DrawArraysInstanced.prototype */\n__WEBPACK_IMPORTED_MODULE_2_osg_utils__[\"a\" /* default */].createPrototypeNode(\n    DrawArraysInstanced,\n    __WEBPACK_IMPORTED_MODULE_2_osg_utils__[\"a\" /* default */].objectInherit( __WEBPACK_IMPORTED_MODULE_1_osg_DrawArrays__[\"a\" /* default */].prototype, {\n        draw: function ( state ) {\n            if( this.count === 0 ) {\n                return;\n            }\n            var gl = state.getGraphicContext();\n            if( gl.drawArrayInstanced ) {\n                gl.drawArrayInstanced( this.mode, this.first,\n                    this.count, this.numInstances );\n                return;\n            }\n\n            if ( !this.extension ) {\n                this.extension = __WEBPACK_IMPORTED_MODULE_0_osg_WebGLCaps__[\"a\" /* default */].instance( gl ).getWebGLExtension(\n                    'ANGLE_instanced_arrays' );\n                if ( !this.extension ) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_notify__[\"a\" /* default */].error( 'browser does not support instanced arrays extension' );\n                    return;\n                }\n            }\n            this.extension.drawArraysInstancedANGLE( this.mode, this.first,\n                this.count, this.numInstances );\n        },\n\n        setNumInstances: function ( numInstances ) {\n            this.numInstances = numInstances;\n        },\n        getNumInstances: function () {\n            return this.numInstances;\n        },\n    }),\n    'osg',\n    'DrawArraysInstanced'\n);\n\n// module.exports = DrawArraysInstanced;\n/* harmony default export */ __webpack_exports__[\"a\"] = (DrawArraysInstanced);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/DrawArraysInstanced.js\n// module id = 193\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/DrawArraysInstanced.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_WebGLCaps__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_notify__ = __webpack_require__(2);\n// $$ SOURCE_CODE_MODIFIED\n\n\n// var WebGLCaps = require( 'osg/WebGLCaps' );\n// var DrawElements = require( 'osg/DrawElements' );\n// var MACROUTILS = require( 'osg/Utils' );\n// var notify = require( 'osg/notify' );\n\n\n\n\n\n/**\n * DrawElementsInstanced manage rendering of indexed instanced primitives\n * @class DrawElementsInstanced\n */\nvar DrawElementsInstanced = function ( mode, indices, numInstances ) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__[\"a\" /* default */].call( this, mode, indices );\n    this.numInstances = numInstances;\n    this.extension = undefined;\n};\n\n/** @lends DrawElementsInstanced.prototype */\n__WEBPACK_IMPORTED_MODULE_2_osg_utils__[\"a\" /* default */].createPrototypeNode(\n    DrawElementsInstanced,\n    __WEBPACK_IMPORTED_MODULE_2_osg_utils__[\"a\" /* default */].objectInherit( __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__[\"a\" /* default */].prototype, {\n        drawElements: function ( state ) {\n            var gl = state.getGraphicContext();\n            if( gl.drawElementsInstanced ) {\n                gl.drawElementsInstanced( this.mode, this.count, this.uType,\n                    this.offset, this.numInstances );\n                return;\n            }\n\n            if ( !this.extension ) {\n                this.extension = __WEBPACK_IMPORTED_MODULE_0_osg_WebGLCaps__[\"a\" /* default */].instance( gl ).getWebGLExtension( 'ANGLE_instanced_arrays' );\n                if ( !this.extension ) {\n                    __WEBPACK_IMPORTED_MODULE_3_osg_notify__[\"a\" /* default */].error( 'browser does not support instanced arrays extension' );\n                    return;\n                }\n            }\n            this.extension.drawElementsInstancedANGLE( this.mode, this.count,\n                this.uType, this.offset, this.numInstances );\n        },\n\n        setNumInstances: function ( numInstances ) {\n            this.numInstances = numInstances;\n        },\n        getNumInstances: function () {\n            return this.numInstances;\n        },\n    }),\n    'osg',\n    'DrawElementsInstanced',\n);\n\n// module.exports = DrawElementsInstanced;\n/* harmony default export */ __webpack_exports__[\"a\"] = (DrawElementsInstanced);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/DrawElementsInstanced.js\n// module id = 194\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/DrawElementsInstanced.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n\n\n\nvar EllipsoidModel = function() {\n    this._radiusEquator = EllipsoidModel.WGS_84_RADIUS_EQUATOR;\n    this._radiusPolar = EllipsoidModel.WGS_84_RADIUS_POLAR;\n    this.computeCoefficients();\n};\n\nEllipsoidModel.WGS_84_RADIUS_EQUATOR = 6378137.0;\nEllipsoidModel.WGS_84_RADIUS_POLAR = 6356752.3142;\n\nEllipsoidModel.prototype = {\n    setRadiusEquator: function(radius) {\n        this._radiusEquator = radius;\n        this.computeCoefficients();\n    },\n    getRadiusEquator: function() {\n        return this._radiusEquator;\n    },\n    setRadiusPolar: function(radius) {\n        this._radiusPolar = radius;\n        this.computeCoefficients();\n    },\n    getRadiusPolar: function() {\n        return this._radiusPolar;\n    },\n    convertLatLongHeightToXYZ: function(latitude, longitude, height, result) {\n        var sinLatitude = Math.sin(latitude);\n        var cosLatitude = Math.cos(latitude);\n        var N =\n            this._radiusEquator /\n            Math.sqrt(1.0 - this._eccentricitySquared * sinLatitude * sinLatitude);\n        var X = (N + height) * cosLatitude * Math.cos(longitude);\n        var Y = (N + height) * cosLatitude * Math.sin(longitude);\n        var Z = (N * (1.0 - this._eccentricitySquared) + height) * sinLatitude;\n        result[0] = X;\n        result[1] = Y;\n        result[2] = Z;\n        return result;\n    },\n    convertXYZToLatLongHeight: function(X, Y, Z, result) {\n        // http://www.colorado.edu/geography/gcraft/notes/datum/gif/xyzllh.gif\n        var p = Math.sqrt(X * X + Y * Y);\n        var theta = Math.atan2(Z * this._radiusEquator, p * this._radiusPolar);\n        var eDashSquared =\n            (this._radiusEquator * this._radiusEquator - this._radiusPolar * this._radiusPolar) /\n            (this._radiusPolar * this._radiusPolar);\n\n        var sinTheta = Math.sin(theta);\n        var cosTheta = Math.cos(theta);\n\n        var latitude = Math.atan(\n            (Z + eDashSquared * this._radiusPolar * sinTheta * sinTheta * sinTheta) /\n                (p -\n                    this._eccentricitySquared *\n                        this._radiusEquator *\n                        cosTheta *\n                        cosTheta *\n                        cosTheta)\n        );\n        var longitude = Math.atan2(Y, X);\n\n        var sinLatitude = Math.sin(latitude);\n        var N =\n            this._radiusEquator /\n            Math.sqrt(1.0 - this._eccentricitySquared * sinLatitude * sinLatitude);\n\n        var cosLat = Math.cos(latitude);\n        if (cosLat === 0) cosLat = 1;\n        var height = p / cosLat - N;\n        result[0] = latitude;\n        result[1] = longitude;\n        result[2] = height;\n        return result;\n    },\n    computeLocalUpVector: function(X, Y, Z) {\n        // Note latitude is angle between normal to ellipsoid surface and XY-plane\n        var latitude, longitude;\n        var coord = this.convertXYZToLatLongHeight(X, Y, Z, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create());\n        latitude = coord[0];\n        longitude = coord[1];\n\n        // Compute up vector\n        return [\n            Math.cos(longitude) * Math.cos(latitude),\n            Math.sin(longitude) * Math.cos(latitude),\n            Math.sin(latitude)\n        ];\n    },\n    isWGS84: function() {\n        return (\n            this._radiusEquator === EllipsoidModel.WGS_84_RADIUS_EQUATOR &&\n            this._radiusPolar === EllipsoidModel.WGS_84_RADIUS_POLAR\n        );\n    },\n\n    computeCoefficients: function() {\n        var flattening = (this._radiusEquator - this._radiusPolar) / this._radiusEquator;\n        this._eccentricitySquared = 2.0 * flattening - flattening * flattening;\n    },\n    computeLocalToWorldTransformFromLatLongHeight: function(latitude, longitude, height, result) {\n        var pos = this.convertLatLongHeightToXYZ(latitude, longitude, height, result);\n        __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].fromTranslation(result, pos);\n        this.computeCoordinateFrame(latitude, longitude, result);\n        return result;\n    },\n    computeLocalToWorldTransformFromXYZ: function(X, Y, Z) {\n        var lla = this.convertXYZToLatLongHeight(X, Y, Z, __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create());\n        var m = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].fromTranslation(__WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].create(), __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].fromValues(X, Y, Z));\n        this.computeCoordinateFrame(lla[0], lla[1], m);\n        return m;\n    },\n    computeCoordinateFrame: (function() {\n        var up = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n        var east = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n        var north = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n        return function(latitude, longitude, localToWorld) {\n            // Compute up vector\n            up[0] = Math.cos(longitude) * Math.cos(latitude);\n            up[1] = Math.sin(longitude) * Math.cos(latitude);\n            up[2] = Math.sin(latitude);\n\n            // Compute east vector\n            east[0] = -Math.sin(longitude);\n            east[1] = -Math.cos(longitude);\n\n            // Compute north vector = outer product up x east\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].cross(north, up, east);\n\n            // set matrix\n            __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["c" /* mat4 */].set(\n                localToWorld,\n                east[0],\n                east[1],\n                east[2],\n                0,\n                north[0],\n                north[1],\n                north[2],\n                0,\n                up[0],\n                up[1],\n                up[2],\n                0,\n                0,\n                0,\n                0,\n                1\n            );\n        };\n    })()\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (EllipsoidModel);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/EllipsoidModel.js\n// module id = 195\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/EllipsoidModel.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Image__ = __webpack_require__(34);\n\n\n\n\nvar ImageStream = function(video) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Image__["a" /* default */].call(this, video);\n    this._canPlayDefered = undefined;\n};\n\nImageStream.PAUSE = 0;\nImageStream.PLAYING = 1;\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].createPrototypeObject(\n    ImageStream,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Image__["a" /* default */].prototype, {\n        isDirty: function() {\n            return this._status === ImageStream.PLAYING; // video is dirty if playing\n        },\n\n        setImage: function(video) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_Image__["a" /* default */].prototype.setImage.call(this, video);\n\n            this._status = ImageStream.STOP;\n\n            // event at the end of the stream\n            video.addEventListener(\n                \'ended\',\n                function() {\n                    if (!this._imageObject.loop) this.stop();\n                }.bind(this),\n                true\n            );\n\n            this.dirty();\n        },\n\n        setLooping: function(bool) {\n            this._imageObject.loop = bool;\n        },\n\n        play: function() {\n            this._imageObject.play();\n            this._status = ImageStream.PLAYING;\n        },\n\n        stop: function() {\n            this._imageObject.pause();\n            this._status = ImageStream.PAUSE;\n        },\n\n        whenReady: function() {\n            if (!this._imageObject) {\n                return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject();\n            }\n            var that = this;\n            return new __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a(function(resolve) {\n                if (!that._canPlayDefered) {\n                    that._canPlayDefered = resolve;\n                    // resolve directly if the event is already fired\n                    if (that._imageObject.readyState > 3) that._canPlayDefered(that);\n                    else\n                        that._imageObject.addEventListener(\n                            \'canplaythrough\',\n                            that._canPlayDefered.bind(that._canPlayDefered, that),\n                            true\n                        );\n                }\n            });\n        }\n    }),\n    \'osg\',\n    \'ImageStream\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ImageStream);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/ImageStream.js\n// module id = 196\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/ImageStream.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_KdTree__ = __webpack_require__(117);\n\n\n\n\nvar KdTreeBuilder = function(options) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this);\n    this._buildOptions = {\n        _numVerticesProcessed: 0,\n        _targetNumTrianglesPerLeaf: 50,\n        _maxNumLevels: 20\n    };\n\n    if (!options) return;\n\n    // merge options\n    var perLeaf = options._targetNumTrianglesPerLeaf;\n    var maxLevel = options._maxNumLevels;\n\n    if (perLeaf !== undefined) this._buildOptions._targetNumTrianglesPerLeaf = perLeaf;\n    if (maxLevel !== undefined) this._buildOptions._maxNumLevels = maxLevel;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    KdTreeBuilder,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.getShape) {\n                var shape = node.getShape();\n                // we test if the kdTree is already built and if we can build it (null means we skip it)\n                if (shape === undefined) {\n                    var kdTree = new __WEBPACK_IMPORTED_MODULE_2_osg_KdTree__["a" /* default */]();\n                    if (kdTree.build(this._buildOptions, node)) {\n                        node.setShape(kdTree);\n                    }\n                }\n            }\n            this.traverse(node);\n        }\n    }),\n    \'osg\',\n    \'KdTreeBuilder\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (KdTreeBuilder);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/KdTreeBuilder.js\n// module id = 197\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/KdTreeBuilder.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n\n\n\nvar LineWidth = function(lineWidth) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].call(this);\n    this.lineWidth = 1.0;\n    if (lineWidth !== undefined) {\n        this.lineWidth = lineWidth;\n    }\n};\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    LineWidth,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__["a" /* default */].prototype, {\n        attributeType: \'LineWidth\',\n        cloneType: function() {\n            return new LineWidth();\n        },\n        apply: function(state) {\n            state.getGraphicContext().lineWidth(this.lineWidth);\n        }\n    }),\n    \'osg\',\n    \'LineWidth\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (LineWidth);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/LineWidth.js\n// module id = 198\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/LineWidth.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__ = __webpack_require__(6);\n\n\n\n\nvar PointSizeAttribute = function(disable) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].call(this);\n\n    this._enable = !disable;\n    this._pointSize = 1.0;\n    // careful with this option if there is lines/triangles under the stateset\n    this._circleShape = false;\n    this._dirtyHash = true;\n    this._hash = '';\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeStateAttribute(\n    PointSizeAttribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_StateAttribute__[\"a\" /* default */].prototype, {\n        attributeType: 'PointSize',\n\n        cloneType: function() {\n            return new PointSizeAttribute(true);\n        },\n\n        setCircleShape: function(bool) {\n            this._circleShape = bool;\n            this._dirtyHash = true;\n        },\n\n        isCircleShape: function() {\n            return this._circleShape;\n        },\n\n        setEnabled: function(state) {\n            this._enable = state;\n            this._dirtyHash = true;\n        },\n\n        isEnabled: function() {\n            return this._enable;\n        },\n\n        setPointSize: function(size) {\n            this._pointSize = size;\n        },\n\n        getOrCreateUniforms: function() {\n            var obj = PointSizeAttribute;\n            if (obj.uniforms) return obj.uniforms;\n\n            obj.uniforms = {\n                pointSize: __WEBPACK_IMPORTED_MODULE_2_osg_Uniform__[\"a\" /* default */].createFloat(1.0, 'uPointSize')\n            };\n\n            return obj.uniforms;\n        },\n\n        getHash: function() {\n            if (!this._dirtyHash) return this._hash;\n\n            this._hash = this._computeInternalHash();\n            this._dirtyHash = false;\n            return this._hash;\n        },\n\n        _computeInternalHash: function() {\n            return (\n                this.getTypeMember() +\n                (this.isEnabled() ? '1' : '0') +\n                (this._circleShape ? '1' : '0')\n            );\n        },\n\n        apply: function() {\n            if (!this._enable) return;\n\n            var uniforms = this.getOrCreateUniforms();\n            uniforms.pointSize.setFloat(this._pointSize);\n        }\n    }),\n    'osg',\n    'PointSizeAttribute'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (PointSizeAttribute);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/PointSizeAttribute.js\n// module id = 199\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/PointSizeAttribute.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_DrawArrays__ = __webpack_require__(17);\n\n\n\n\n\n/**\n * PrimitiveFunctor emulates the TemplatePrimitiveFunctor class in OSG and can\n * be used to get access to the vertices that compose the things drawn by osgjs.\n *\n * You have to feed it with an object that references 3 callbacks :\n *\n * var myObject = {\n *     operatorPoint : function ( v ) { }, // Do your point operations here\n *     operatorLine : function ( v1, v2 ){ }, // Do you line operations here\n *     operatorTriangle : function ( v1, v2, v3 ) { } // Do your triangle operations here\n * };\n *\n */\n\nvar functorDrawElements = [];\nvar functorDrawArrays = [];\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].POINTS] = (function() {\n    var v = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        var end = offset + count;\n        for (var i = offset; i < end; ++i) {\n            var j = indexes[i] * 3;\n            v[0] = vertices[j];\n            v[1] = vertices[j + 1];\n            v[2] = vertices[j + 2];\n            cb.operatorPoint(v);\n        }\n    };\n})();\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].LINES] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        var end = offset + count;\n        for (var i = offset; i < end - 1; i += 2) {\n            var j = indexes[i] * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = indexes[i + 1] * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            cb.operatorLine(v1, v2);\n        }\n    };\n})();\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].LINE_STRIP] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        var end = offset + count;\n        for (var i = offset; i < end - 1; ++i) {\n            var j = indexes[i] * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = indexes[i + 1] * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            cb.operatorLine(v1, v2);\n        }\n    };\n})();\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].LINE_LOOP] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        var last = offset + count - 1;\n        for (var i = offset; i < last; ++i) {\n            var j = indexes[i] * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = indexes[i + 1] * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            cb.operatorLine(v1, v2);\n        }\n        last = indexes[last] * 3;\n        v1[0] = vertices[last];\n        v1[1] = vertices[last + 1];\n        v1[2] = vertices[last + 2];\n        var first = indexes[0] * 3;\n        v2[0] = vertices[first];\n        v2[1] = vertices[first + 1];\n        v2[2] = vertices[first + 2];\n        cb.operatorLine(v1, v2);\n    };\n})();\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].TRIANGLES] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        var end = offset + count;\n        for (var i = offset; i < end; i += 3) {\n            var j = indexes[i] * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = indexes[i + 1] * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            j = indexes[i + 2] * 3;\n            v3[0] = vertices[j];\n            v3[1] = vertices[j + 1];\n            v3[2] = vertices[j + 2];\n            cb.operatorTriangle(v1, v2, v3);\n        }\n    };\n})();\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        for (var i = 2, pos = offset; i < count; ++i, ++pos) {\n            var j = indexes[pos] * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = indexes[pos + 1] * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            j = indexes[pos + 2] * 3;\n            v3[0] = vertices[j];\n            v3[1] = vertices[j + 1];\n            v3[2] = vertices[j + 2];\n            if (i % 2) {\n                cb.operatorTriangle(v1, v3, v2);\n            } else {\n                cb.operatorTriangle(v1, v2, v3);\n            }\n        }\n    };\n})();\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(offset, count, indexes, cb, vertices) {\n        var first = indexes[offset];\n        for (var i = 2, pos = offset + 1; i < count; ++i, ++pos) {\n            v1[0] = vertices[first];\n            v1[1] = vertices[first + 1];\n            v1[2] = vertices[first + 2];\n            var j = indexes[pos] * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            j = indexes[pos + 1] * 3;\n            v3[0] = vertices[j];\n            v3[1] = vertices[j + 1];\n            v3[2] = vertices[j + 2];\n            cb.operatorTriangle(v1, v2, v3);\n        }\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].POINTS] = (function() {\n    var v = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        for (var i = first; i < first + count; ++i) {\n            var j = i * 3;\n            v[0] = vertices[j];\n            v[1] = vertices[j + 1];\n            v[2] = vertices[j + 2];\n            cb.operatorPoint(v);\n        }\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].LINES] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        for (var i = first; i < first + count - 1; i += 2) {\n            var j = i * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = (i + 1) * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            cb.operatorLine(v1, v2);\n        }\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].LINE_STRIP] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        for (var i = first; i < first + count - 1; ++i) {\n            var j = i * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = (i + 1) * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            cb.operatorLine(v1, v2);\n        }\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].LINE_LOOP] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        var last = first + count - 1;\n        for (var i = first; i < last; ++i) {\n            var j = i * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = (i + 1) * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            cb.operatorLine(v1, v2);\n        }\n        last = last * 3;\n        v1[0] = vertices[last];\n        v1[1] = vertices[last + 1];\n        v1[2] = vertices[last + 2];\n        first = first * 3;\n        v2[0] = vertices[first];\n        v2[1] = vertices[first + 1];\n        v2[2] = vertices[first + 2];\n        cb.operatorLine(v1, v2);\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].TRIANGLES] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        for (var i = first; i < first + count; i += 3) {\n            var j = i * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = (i + 1) * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            j = (i + 2) * 3;\n            v3[0] = vertices[j];\n            v3[1] = vertices[j + 1];\n            v3[2] = vertices[j + 2];\n            cb.operatorTriangle(v1, v2, v3);\n        }\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        for (var i = 2, pos = first; i < count; ++i, ++pos) {\n            var j = pos * 3;\n            v1[0] = vertices[j];\n            v1[1] = vertices[j + 1];\n            v1[2] = vertices[j + 2];\n            j = (pos + 1) * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            j = (pos + 2) * 3;\n            v3[0] = vertices[j];\n            v3[1] = vertices[j + 1];\n            v3[2] = vertices[j + 2];\n            if (i % 2) {\n                cb.operatorTriangle(v1, v3, v2);\n            } else {\n                cb.operatorTriangle(v1, v2, v3);\n            }\n        }\n    };\n})();\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_1_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN] = (function() {\n    var v1 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v2 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    var v3 = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__["f" /* vec3 */].create();\n    return function(first, count, cb, vertices) {\n        for (var i = 2, pos = first + 1; i < count; ++i, ++pos) {\n            v1[0] = vertices[first];\n            v1[1] = vertices[first + 1];\n            v1[2] = vertices[first + 2];\n            var j = pos * 3;\n            v2[0] = vertices[j];\n            v2[1] = vertices[j + 1];\n            v2[2] = vertices[j + 2];\n            j = (pos + 1) * 3;\n            v3[0] = vertices[j];\n            v3[1] = vertices[j + 1];\n            v3[2] = vertices[j + 2];\n            cb.operatorTriangle(v1, v2, v3);\n        }\n    };\n})();\n\nvar primitiveFunctor = function(geom, cb, vertices) {\n    var primitives = geom.getPrimitiveSetList();\n    if (!primitives) return;\n\n    var cbFunctor;\n\n    var nbPrimitives = primitives.length;\n    for (var i = 0; i < nbPrimitives; i++) {\n        var primitive = primitives[i];\n        if (primitive instanceof __WEBPACK_IMPORTED_MODULE_2_osg_DrawElements__["a" /* default */]) {\n            cbFunctor = functorDrawElements[primitive.getMode()];\n            if (cbFunctor) {\n                var indexes = primitive.indices.getElements();\n                cbFunctor(\n                    primitive.getFirst() / indexes.BYTES_PER_ELEMENT,\n                    primitive.getCount(),\n                    indexes,\n                    cb,\n                    vertices\n                );\n            }\n        } else if (primitive instanceof __WEBPACK_IMPORTED_MODULE_3_osg_DrawArrays__["a" /* default */]) {\n            cbFunctor = functorDrawArrays[primitive.getMode()];\n            if (cbFunctor) {\n                cbFunctor(primitive.getFirst(), primitive.getCount(), cb, vertices);\n            }\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (primitiveFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/primitiveFunctor.js\n// module id = 200\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/primitiveFunctor.js?')},function(module,exports){eval('module.exports = "#define PI 3.141593\\n#define saturate(_x) clamp(_x, 0., 1.)\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/common.glsl\n// module id = 201\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/common.glsl?')},function(module,exports){eval('module.exports = "// approximation such as http://chilliant.blogspot.fr/2012/08/srgb-approximations-for-hlsl.html\\n// introduced slightly darker colors and more slight banding in the darks.\\n\\n// so we stick with the reference implementation (except we don\'t check if color >= 0.0):\\n// https://www.khronos.org/registry/gles/extensions/EXT/EXT_sRGB.txt\\n#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055\\n#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)\\n\\n#pragma DECLARE_FUNCTION\\nfloat linearTosRGB(const in float color) { return LIN_SRGB(color); }\\n\\n#pragma DECLARE_FUNCTION\\nvec3 linearTosRGB(const in vec3 color) { return vec3(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b)); }\\n\\n#pragma DECLARE_FUNCTION\\nvec4 linearTosRGB(const in vec4 color) { return vec4(LIN_SRGB(color.r), LIN_SRGB(color.g), LIN_SRGB(color.b), color.a); }\\n\\n#pragma DECLARE_FUNCTION NODE_NAME:sRGBToLinear\\nfloat sRGBToLinear(const in float color) { return SRGB_LIN(color); }\\n\\n#pragma DECLARE_FUNCTION NODE_NAME:sRGBToLinear\\nvec3 sRGBToLinear(const in vec3 color) { return vec3(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b)); }\\n\\n#pragma DECLARE_FUNCTION NODE_NAME:sRGBToLinear\\nvec4 sRGBToLinear(const in vec4 color) { return vec4(SRGB_LIN(color.r), SRGB_LIN(color.g), SRGB_LIN(color.b), color.a); }\\n\\n//http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\\nvec3 RGBMToRGB( const in vec4 rgba ) {\\n    const float maxRange = 8.0;\\n    return rgba.rgb * maxRange * rgba.a;\\n}\\n\\nconst mat3 LUVInverse = mat3( 6.0013, -2.700, -1.7995, -1.332, 3.1029, -5.7720, 0.3007, -1.088, 5.6268 );\\n\\nvec3 LUVToRGB( const in vec4 vLogLuv ) {\\n    float Le = vLogLuv.z * 255.0 + vLogLuv.w;\\n    vec3 Xp_Y_XYZp;\\n    Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\\n    Xp_Y_XYZp.z = Xp_Y_XYZp.y / vLogLuv.y;\\n    Xp_Y_XYZp.x = vLogLuv.x * Xp_Y_XYZp.z;\\n    vec3 vRGB = LUVInverse * Xp_Y_XYZp;\\n    return max(vRGB, 0.0);\\n}\\n\\n// http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\\n#pragma DECLARE_FUNCTION\\nvec4 encodeRGBM(const in vec3 color, const in float range) {\\n    if(range <= 0.0) return vec4(color, 1.0);\\n    vec4 rgbm;\\n    vec3 col = color / range;\\n    rgbm.a = clamp( max( max( col.r, col.g ), max( col.b, 1e-6 ) ), 0.0, 1.0 );\\n    rgbm.a = ceil( rgbm.a * 255.0 ) / 255.0;\\n    rgbm.rgb = col / rgbm.a;\\n    return rgbm;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvec3 decodeRGBM(const in vec4 color, const in float range) {\\n    if(range <= 0.0) return color.rgb;\\n    return range * color.rgb * color.a;\\n}\\n\\n// https://twitter.com/pyalot/status/711956736639418369\\n// https://github.com/mrdoob/three.js/issues/10331\\n#pragma DECLARE_FUNCTION NODE_NAME:FrontNormal\\n#define _frontNormal(normal) gl_FrontFacing ? normal : -normal\\n\\n#pragma DECLARE_FUNCTION NODE_NAME:Normalize\\n#define _normalize(vec) normalize(vec)\\n\\n#pragma DECLARE_FUNCTION\\nvec4 preMultAlpha(const in vec3 color, const in float alpha) { return vec4(color.rgb * alpha, alpha); }\\n\\n#pragma DECLARE_FUNCTION\\nvec4 preMultAlpha(const in vec4 color) { return vec4(color.rgb * color.a, color.a); }\\n\\n#pragma DECLARE_FUNCTION\\nvec4 setAlpha(const in vec3 color, const in float alpha) { return vec4(color, alpha); }\\n\\n#pragma DECLARE_FUNCTION\\nvec4 setAlpha(const in vec3 color, const in vec4 alpha) { return vec4(color, alpha.a); }\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/functions.glsl\n// module id = 202\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/functions.glsl?')},function(module,exports){eval('module.exports = "float getLightAttenuation(const in float dist, const in vec4 lightAttenuation) {\\n    // lightAttenuation(constantEnabled, linearEnabled, quadraticEnabled)\\n    // TODO find a vector alu instead of 4 scalar\\n    float constant = lightAttenuation.x;\\n    float linear = lightAttenuation.y * dist;\\n    float quadratic = lightAttenuation.z * dist * dist;\\n    return 1.0 / (constant + linear + quadratic);\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvoid precomputeSpot(\\n        const in vec3 normal,\\n        const in vec3 viewVertex,\\n                          \\n        const in vec3 lightViewDirection,\\n        const in vec4 lightAttenuation,\\n        const in vec3 lightViewPosition,\\n        const in float lightSpotCutOff,\\n        const in float lightSpotBlend,\\n                          \\n        out float attenuation,\\n        out vec3 eyeLightDir,\\n        out float dotNL) {\\n\\n    eyeLightDir = lightViewPosition - viewVertex;\\n    float dist = length(eyeLightDir);\\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist : vec3( 0.0, 1.0, 0.0 );\\n\\n    float cosCurAngle = dot(-eyeLightDir, lightViewDirection);\\n    float spot = cosCurAngle * smoothstep(0.0, 1.0, (cosCurAngle - lightSpotCutOff) / lightSpotBlend);\\n\\n    dotNL = dot(eyeLightDir, normal);\\n    attenuation = spot * getLightAttenuation(dist, lightAttenuation);\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvoid precomputePoint(\\n        const in vec3 normal,\\n        const in vec3 viewVertex,\\n\\n        const in vec4 lightAttenuation,\\n        const in vec3 lightViewPosition,\\n\\n        out float attenuation,\\n        out vec3 eyeLightDir,\\n        out float dotNL) {\\n\\n    eyeLightDir = lightViewPosition - viewVertex;\\n    float dist = length(eyeLightDir);\\n\\n    attenuation = getLightAttenuation(dist, lightAttenuation);\\n    eyeLightDir = dist > 0.0 ? eyeLightDir / dist :  vec3( 0.0, 1.0, 0.0 );\\n    dotNL = dot(eyeLightDir, normal);\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvoid precomputeSun(\\n        const in vec3 normal,\\n        const in vec3 lightViewDirection,\\n  \\n        out float attenuation,\\n        out vec3 eyeLightDir,\\n        out float dotNL) {\\n\\n    attenuation = 1.0;\\n    eyeLightDir = -lightViewDirection;\\n    dotNL = dot(eyeLightDir, normal);\\n}"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/lightCommon.glsl\n// module id = 203\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/lightCommon.glsl?')},function(module,exports){eval('module.exports = "#pragma include \\"lightCommon.glsl\\"\\n\\n////////////////\\n// COOK TORRANCE\\n////////////////\\nvec3 specularCookTorrance(\\n        const in vec3 normal,\\n        const in vec3 lightDir,\\n        const in vec3 eyeVector,\\n        const in float materialShininess,\\n        const in vec3 materialSpecular,\\n        const in vec3 lightSpecular) {\\n  \\n    vec3 h = normalize(eyeVector + lightDir);\\n    float nh = dot(normal, h);\\n    float specfac = 0.0;\\n\\n    if(nh > 0.0) {\\n        float nv = max( dot(normal, eyeVector), 0.0 );\\n        float i = pow(nh, materialShininess);\\n        i = i / (0.1 + nv);\\n        specfac = i;\\n    }\\n    // ugly way to fake an energy conservation (mainly to avoid super bright stuffs with low glossiness)\\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\\n    return specfac * materialSpecular * lightSpecular * att;\\n}\\n\\nvec3 lambert(const in float dotNL,  const in vec3 materialDiffuse, const in vec3 lightDiffuse) {\\n    return dotNL * materialDiffuse * lightDiffuse;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvoid computeLightLambertCookTorrance(\\n        const in vec3 normal,\\n        const in vec3 eyeVector,\\n        const in float dotNL,\\n        const in float attenuation,\\n\\n        const in vec3 materialDiffuse,\\n        const in vec3 materialSpecular,\\n        const in float materialShininess,\\n\\n        const in vec3 lightDiffuse,\\n        const in vec3 lightSpecular,\\n        const in vec3 eyeLightDir,\\n\\n        out vec3 diffuseOut,\\n        out vec3 specularOut,\\n        out bool lighted) {\\n\\n    lighted = dotNL > 0.0;\\n    if (lighted == false) {\\n        specularOut = diffuseOut = vec3(0.0);\\n        return;\\n    }\\n\\n    specularOut = attenuation * specularCookTorrance(normal, eyeLightDir, eyeVector, materialShininess, materialSpecular, lightSpecular);\\n    diffuseOut = attenuation * lambert(dotNL, materialDiffuse, lightDiffuse);\\n}\\n\\n///////\\n// HEMI\\n///////\\n#pragma DECLARE_FUNCTION\\nvoid hemiLight(\\n        const in vec3 normal,\\n        const in vec3 eyeVector,\\n        const in float dotNL,\\n        const in float eyeLightDir,\\n\\n        const in vec3 materialDiffuse,\\n        const in vec3 materialSpecular,\\n        const in float materialShininess,\\n\\n        const in vec3 lightDiffuse,\\n        const in vec3 lightGround,\\n\\n        out vec3 diffuseOut,\\n        out vec3 specularOut,\\n        out bool lighted) {\\n\\n    lighted = false;\\n    float weight = 0.5 * dotNL + 0.5;\\n    diffuseOut = materialDiffuse * mix(lightGround, lightDiffuse, weight);\\n\\n    // same cook-torrance as above for sky/ground\\n    float skyWeight = 0.5 * dot(normal, normalize(eyeVector + eyeLightDir)) + 0.5;\\n    float gndWeight = 0.5 * dot(normal, normalize(eyeVector - eyeLightDir)) + 0.5;\\n    float skySpec = pow(skyWeight, materialShininess);\\n    float skyGround = pow(gndWeight, materialShininess);\\n    float divisor = (0.1 + max( dot(normal, eyeVector), 0.0 ));\\n    float att = materialShininess > 100.0 ? 1.0 : smoothstep(0.0, 1.0, materialShininess * 0.01);\\n    \\n    specularOut = lightDiffuse * materialSpecular * weight * att * (skySpec + skyGround) / divisor;\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/lights.glsl\n// module id = 204\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/lights.glsl?')},function(module,exports){eval('module.exports = "//////////////////////////////\\n// OPTIMIZED VERSION (NO IF)\\n//////////////////////////////\\n#pragma DECLARE_FUNCTION\\nmat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\\n    mat4 outMat_1;\\n    mat4 tmpMat_2;\\n    highp ivec4 tmpvar_3;\\n    tmpvar_3 = (3 * ivec4(bonesIndex));\\n    tmpMat_2 = mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0);\\n    vec4 tmpvar_4;\\n    tmpvar_4 = -(abs(weights));\\n    tmpMat_2[0] = uBones[tmpvar_3.x];\\n    tmpMat_2[1] = uBones[(tmpvar_3.x + 1)];\\n    tmpMat_2[2] = uBones[(tmpvar_3.x + 2)];\\n    outMat_1 = ((float(\\n    ((tmpvar_4.x + tmpvar_4.y) >= -((tmpvar_4.z + tmpvar_4.w)))\\n    ) * mat4(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0)) + (weights.x * tmpMat_2));\\n    tmpMat_2[0] = uBones[tmpvar_3.y];\\n    tmpMat_2[1] = uBones[(tmpvar_3.y + 1)];\\n    tmpMat_2[2] = uBones[(tmpvar_3.y + 2)];\\n    outMat_1 = (outMat_1 + (weights.y * tmpMat_2));\\n    tmpMat_2[0] = uBones[tmpvar_3.z];\\n    tmpMat_2[1] = uBones[(tmpvar_3.z + 1)];\\n    tmpMat_2[2] = uBones[(tmpvar_3.z + 2)];\\n    outMat_1 = (outMat_1 + (weights.z * tmpMat_2));\\n    tmpMat_2[0] = uBones[tmpvar_3.w];\\n    tmpMat_2[1] = uBones[(tmpvar_3.w + 1)];\\n    tmpMat_2[2] = uBones[(tmpvar_3.w + 2)];\\n    outMat_1 = (outMat_1 + (weights.w * tmpMat_2));\\n\\n    return outMat_1;\\n}\\n\\n//////////////////////////////\\n// UN-OPTIMIZED VERSION (WITH IF)\\n//////////////////////////////\\n\\n// //http://http.developer.nvidia.com/GPUGems/gpugems_ch04.html\\n// mat4 getMat4FromVec4( const int index, inout mat4 myMat ) {\\n//     // We have to use a global variable because we can\'t access dynamically\\n//     // matrix is transpose so we should do vec * matrix\\n//     myMat[0] = uBones[ index ];\\n//     myMat[1] = uBones[ index + 1];\\n//     myMat[2] = uBones[ index + 2];\\n//     return myMat;\\n// }\\n\\n// mat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\\n//     ivec4 idx =  3 * ivec4(bonesIndex);\\n//     mat4 tmpMat = mat4(1.0);\\n//     mat4 outMat = mat4(0.0);\\n\\n//     // we handle negative weights\\n//     if(all(equal(weights, vec4(0.0)))) return tmpMat;\\n\\n//     if(weights.x != 0.0) outMat += weights.x * getMat4FromVec4( idx.x, tmpMat );\\n//     if(weights.y != 0.0) outMat += weights.y * getMat4FromVec4( idx.y, tmpMat );\\n//     if(weights.z != 0.0) outMat += weights.z * getMat4FromVec4( idx.z, tmpMat );\\n//     if(weights.w != 0.0) outMat += weights.w * getMat4FromVec4( idx.w, tmpMat );\\n//     return outMat;\\n// }\\n\\n//////////////////////////////\\n// UN-OPTIMIZED VERSION (NO IF)\\n//////////////////////////////\\n\\n// mat4 skinning( const in vec4 weights, const in vec4 bonesIndex ) {\\n//     ivec4 idx =  3 * ivec4(bonesIndex);\\n//     mat4 tmpMat = mat4(1.0);\\n\\n//     // if sum is 0, return identity\\n//     vec4 absWeights = -abs(weights);\\n//     mat4 outMat = step(0.0, absWeights.x + absWeights.y + absWeights.z + absWeights.w) * tmpMat;\\n\\n//     // we handle negative weights\\n//     // outMat[3][3] += weights.x + weights.y + weights.z + weights.w;\\n\\n//     tmpMat[0] = uBones[ idx.x ];\\n//     tmpMat[1] = uBones[ idx.x + 1];\\n//     tmpMat[2] = uBones[ idx.x + 2];\\n//     outMat += weights.x * tmpMat;\\n\\n//     tmpMat[0] = uBones[ idx.y ];\\n//     tmpMat[1] = uBones[ idx.y + 1];\\n//     tmpMat[2] = uBones[ idx.y + 2];\\n//     outMat += weights.y * tmpMat;\\n\\n//     tmpMat[0] = uBones[ idx.z ];\\n//     tmpMat[1] = uBones[ idx.z + 1];\\n//     tmpMat[2] = uBones[ idx.z + 2];\\n//     outMat += weights.z * tmpMat;\\n\\n//     tmpMat[0] = uBones[ idx.w ];\\n//     tmpMat[1] = uBones[ idx.w + 1];\\n//     tmpMat[2] = uBones[ idx.w + 2];\\n//     outMat += weights.w * tmpMat;\\n\\n//     return outMat;\\n// }\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/skinning.glsl\n// module id = 205\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/skinning.glsl?')},function(module,exports){eval('module.exports = "#pragma DECLARE_FUNCTION\\nvec3 morphing(\\n        const in vec4 weights,\\n        const in vec3 vertex,\\n        const in vec3 target0) {\\n\\n    return mix(vertex, target0, weights[0]);\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvec3 morphing(\\n        const in vec4 weights,\\n        const in vec3 vertex,\\n        const in vec3 target0,\\n        const in vec3 target1) {\\n\\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1]));\\n    vecOut += target0 * weights[0];\\n    vecOut += target1 * weights[1];\\n    return vecOut;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvec3 morphing(\\n        const in vec4 weights,\\n        const in vec3 vertex,\\n        const in vec3 target0,\\n        const in vec3 target1,\\n        const in vec3 target2) {\\n  \\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2]));\\n    vecOut += target0 * weights[0];\\n    vecOut += target1 * weights[1];\\n    vecOut += target2 * weights[2];\\n    return vecOut;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvec3 morphing(\\n        const in vec4 weights,\\n        const in vec3 vertex,\\n        const in vec3 target0,\\n        const in vec3 target1,\\n        const in vec3 target2,\\n        const in vec3 target3) {\\n\\n    vec3 vecOut = vertex * (1.0 - ( weights[0] + weights[1] + weights[2] + weights[3]));\\n    vecOut += target0 * weights[0];\\n    vecOut += target1 * weights[1];\\n    vecOut += target2 * weights[2];\\n    vecOut += target3 * weights[3];\\n    return vecOut;\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/morphing.glsl\n// module id = 206\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/morphing.glsl?')},function(module,exports){eval('module.exports = "#pragma DECLARE_FUNCTION\\nvec3 textureRGB(const in sampler2D tex, const in vec2 uv) {\\n    return texture2D(tex, uv.xy).rgb;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvec4 textureRGBA(const in sampler2D tex, const in vec2 uv) {\\n    return texture2D(tex, uv.xy).rgba;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nfloat textureIntensity(const in sampler2D tex, const in vec2 uv) {\\n    return texture2D(tex, uv).r;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nfloat textureAlpha(const in sampler2D tex, const in vec2 uv) {\\n    return texture2D(tex, uv.xy).a;\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/textures.glsl\n// module id = 207\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/textures.glsl?')},function(module,exports){eval('module.exports = "\\nfloat decodeFloatRGBA( vec4 rgba ) {\\n    return dot( rgba, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) );\\n}\\n\\nvec4 encodeFloatRGBA( float v ) {\\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * v;\\n    enc = fract(enc);\\n    enc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\\n    return enc;\\n}\\n\\nvec2 decodeHalfFloatRGBA( vec4 rgba ) {\\n    return vec2(rgba.x + (rgba.y / 255.0), rgba.z + (rgba.w / 255.0));\\n}\\n\\nvec4 encodeHalfFloatRGBA( vec2 v ) {\\n    const vec2 bias = vec2(1.0 / 255.0, 0.0);\\n    vec4 enc;\\n    enc.xy = vec2(v.x, fract(v.x * 255.0));\\n    enc.xy = enc.xy - (enc.yy * bias);\\n\\n    enc.zw = vec2(v.y, fract(v.y * 255.0));\\n    enc.zw = enc.zw - (enc.ww * bias);\\n    return enc;\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/colorEncode.glsl\n// module id = 208\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/colorEncode.glsl?')},function(module,exports){eval('module.exports = "vec3 getScale( const in mat4 matrix ) {\\n      // Only working with positive scales.\\n      float xs = matrix[0][0] * matrix[0][1] * matrix[0][2] * matrix[0][3] < 0. ? -1. : 1.;\\n      float ys = matrix[1][0] * matrix[1][1] * matrix[1][2] * matrix[1][3] < 0. ? -1. : 1.;\\n      float zs = matrix[2][0] * matrix[2][1] * matrix[2][2] * matrix[2][3] < 0. ? -1. : 1.;\\n      vec3 scale;\\n      scale.x = xs * sqrt( matrix[0][0] * matrix[0][0] + matrix[0][1] * matrix[0][1] + matrix[0][2] * matrix[0][2]);\\n      scale.y = ys * sqrt( matrix[1][0] * matrix[1][0] + matrix[1][1] * matrix[1][1] + matrix[1][2] * matrix[1][2]);\\n      scale.z = zs * sqrt( matrix[2][0] * matrix[2][0] + matrix[2][1] * matrix[2][1] + matrix[2][2] * matrix[2][2]);\\n      return scale;\\n}\\n\\n#pragma DECLARE_FUNCTION\\nvec4 billboard( const in vec3 vertex, const in mat4 modelViewMatrix, const in mat4 projectionMatrix ) {\\n      vec3 scale = getScale( modelViewMatrix );\\n      return projectionMatrix * ( vec4( scale.x* vertex.x , scale.y * vertex.y, scale.z * vertex.z, 1.0 ) + vec4( modelViewMatrix[ 3 ].xyz, 0.0 ) );\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/billboard.glsl\n// module id = 209\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/billboard.glsl?')},function(module,exports){eval('module.exports = "#pragma include \\"colorEncode.glsl\\"\\n\\n#pragma DECLARE_FUNCTION\\nvec4 shadowCast(const in vec4 fragEye, const in vec2 shadowDepthRange){\\n    // distance to camera (we make sure we are near 0 and in [0,1])\\n    float depth = (-fragEye.z * fragEye.w - shadowDepthRange.x) / (shadowDepthRange.y - shadowDepthRange.x);\\n\\n#ifdef _FLOATTEX\\n    return vec4(depth, 0.0, 0.0, 1.0);\\n#else\\n    return encodeFloatRGBA(depth);\\n#endif\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/shaders/shadowCast.glsl\n// module id = 210\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/shaders/shadowCast.glsl?')},function(module,exports){eval('module.exports = "#ifdef _OUT_DISTANCE\\n#define OPT_ARG_outDistance ,out float outDistance\\n#define OPT_INSTANCE_ARG_outDistance ,outDistance\\n#else\\n#define OPT_ARG_outDistance\\n#define OPT_INSTANCE_ARG_outDistance\\n#endif\\n\\n#ifdef _ATLAS_SHADOW\\n#define OPT_ARG_atlasSize ,const in vec4 atlasSize\\n#else\\n#define OPT_ARG_atlasSize\\n#endif\\n\\n#ifdef _NORMAL_OFFSET\\n#define OPT_ARG_normalBias ,const in float normalBias\\n#else\\n#define OPT_ARG_normalBias\\n#endif\\n\\n#ifdef _JITTER_OFFSET\\n#define OPT_ARG_jitter ,const in float jitter\\n#define OPT_INSTANCE_ARG_jitter ,jitter\\n#else\\n#define OPT_ARG_jitter\\n#define OPT_INSTANCE_ARG_jitter\\n#endif\\n\\n#pragma include \\"tapPCF.glsl\\"\\n\\n#pragma DECLARE_FUNCTION DERIVATIVES:enable\\nfloat shadowReceive(const in bool lighted,\\n                    const in vec3 normalWorld,\\n                    const in vec3 vertexWorld,\\n\\n                    const in sampler2D shadowTexture,\\n\\n                    const in vec2 shadowSize,\\n                    const in vec3 shadowProjection,\\n\\n                    const in vec4 shadowViewRight,\\n                    const in vec4 shadowViewUp,\\n                    const in vec4 shadowViewLook,\\n\\n\\n                    const in vec2 shadowDepthRange,\\n                    const in float shadowBias\\n                    OPT_ARG_atlasSize\\n                    OPT_ARG_normalBias\\n                    OPT_ARG_outDistance\\n                    OPT_ARG_jitter) {\\n\\n    // 0 for early out\\n    bool earlyOut = false;\\n\\n    // Calculate shadow amount\\n    float shadow = 1.0;\\n\\n    if (!lighted) {\\n        shadow = 0.0;\\n#ifndef _OUT_DISTANCE\\n        earlyOut = true;\\n#endif // _OUT_DISTANCE\\n    }\\n\\n    if (shadowDepthRange.x == shadowDepthRange.y) {\\n        earlyOut = true;\\n    }\\n\\n    vec4 shadowVertexEye;\\n    vec4 shadowNormalEye;\\n    float shadowReceiverZ = 0.0;\\n    vec4 shadowVertexProjected;\\n    vec2 shadowUV;\\n    float N_Dot_L;\\n    float invDepthRange;\\n\\n    if (!earlyOut) {\\n\\n        shadowVertexEye.x = dot(shadowViewRight.xyz, vertexWorld.xyz) + shadowViewRight.w;\\n        shadowVertexEye.y = dot(shadowViewUp.xyz, vertexWorld.xyz) + shadowViewUp.w;\\n        shadowVertexEye.z = dot(shadowViewLook.xyz, vertexWorld.xyz) + shadowViewLook.w;\\n        shadowVertexEye.w = 1.0;\\n\\n\\n        // derivated, only need z.\\n        //vec3 shadowLightDir = vec3(0.0, 0.0, 1.0); // in shadow view light is camera\\n        //shadowNormalEye =  shadowViewMatrix * normalFront;\\n        //shadowNormalEye.x = dot(shadowViewRight.xyz, normalWorld.xyz);\\n        //shadowNormalEye.y = dot(shadowViewUp.xyz, normalWorld.xyz);\\n        shadowNormalEye.z = dot(shadowViewLook.xyz, normalWorld.xyz);\\n        //shadowNormalEye.w = 0.0;\\n\\n        //N_Dot_L = dot(shadowNormalEye.xyz, shadowLightDir);\\n        N_Dot_L = shadowNormalEye.z;\\n\\n        if (!earlyOut) {\\n\\n            invDepthRange = 1.0 / (shadowDepthRange.y - shadowDepthRange.x);\\n\\n#ifdef _NORMAL_OFFSET\\n\\n            // http://www.dissidentlogic.com/old/images/NormalOffsetShadows/GDC_Poster_NormalOffset.png\\n            float normalOffsetScale = clamp(1.0  - N_Dot_L, 0.0 , 1.0);\\n            normalOffsetScale *= abs((shadowVertexEye.z - shadowDepthRange.x) * invDepthRange);\\n            normalOffsetScale *= max(shadowProjection.x, shadowProjection.y);\\n            normalOffsetScale *= normalBias * invDepthRange;\\n\\n\\n            vec4 shadowNormalShift =  vec4(normalWorld, 0.0) * normalOffsetScale;\\n            shadowNormalEye.x = dot(shadowViewRight.xyz, shadowNormalShift.xyz);\\n            shadowNormalEye.y = dot(shadowViewUp.xyz, shadowNormalShift.xyz);\\n            shadowNormalEye.z = dot(shadowViewLook.xyz, shadowNormalShift.xyz);\\n            shadowNormalEye.w = 0.0;\\n\\n            vec4 viewShadow = shadowVertexEye + shadowNormalEye;\\n#else\\n            vec4 viewShadow = shadowVertexEye;\\n#endif\\n\\n\\n            if (shadowProjection.z == 0.0){\\n\\n               // X, 0, 0, 0,\\n               // 0, Y, 0, 0,\\n               // 0, 0, -1, -1,\\n               // 0, 0, -2.0*znear, 0\\n               // mat4 shadowProjectionMatrix;\\n               // shadowProjectionMatrix[0] = vec4(shadowProjection.x, 0.0, 0.0, 0.0 );\\n               // shadowProjectionMatrix[1] = vec4(0.0, shadowProjection.y, 0.0, 0.0 );\\n               // shadowProjectionMatrix[2] = vec4(0.0, 0.0, -1.0, -1.0 );\\n               // shadowProjectionMatrix[3] = vec4(0.0, 0.0, -2.0*shadowDepthRange.x, 0.0 );\\n               // shadowVertexProjected = shadowProjectionMatrix * shadowVertexEye;\\n\\n               // derivated optimisation\\n               shadowVertexProjected.x = shadowProjection.x * viewShadow.x;\\n               shadowVertexProjected.y = shadowProjection.y * viewShadow.y;\\n\\n               shadowVertexProjected.z = - viewShadow.z - (2.0 * shadowDepthRange.x * viewShadow.w);\\n               shadowVertexProjected.w = - viewShadow.z;\\n\\n            }\\n            else{\\n                // lr = 1/(left-right);\\n                // bt = 1/(bottom-top);\\n                // nf = 1/(near-far);\\n                // -2*lr,           0,               0,              0,\\n                // 0,               -2*bt,           0,              0,\\n                // 0,               0,               2*nf,           0.0,\\n                // (left+right)*lr, (top+bottom)*bt, (far+near)*nf), 1\\n                // here left = -right && top = -bottom\\n                // float lr = 1.0 / (-2.0 * shadowProjection.x);\\n                // float bt = 1.0 / (-2.0 * shadowProjection.y);\\n                // float nf = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\\n                float nfNeg = 1.0 / (shadowDepthRange.x - shadowDepthRange.y);\\n                float nfPos = (shadowDepthRange.x + shadowDepthRange.y)*nfNeg;\\n\\n                //mat4 shadowProjectionMatrix;\\n                //shadowProjectionMatrix[0] = vec4(1.0 / shadowProjection.x, 0.0,     0.0,  0.0 );\\n                //shadowProjectionMatrix[1] = vec4(0.0,     1.0 / shadowProjection.y, 0.0,  0.0 );\\n                //shadowProjectionMatrix[2] = vec4(0.0,     0.0, 2.0*nfNeg, 0.0 );\\n                //shadowProjectionMatrix[3] = vec4(0.0,     0.0, nfPos, 1.0 );\\n                //shadowdertexProjected = shadowProjectionMatrix * shadowVertexEye;\\n\\n                // derivated optimisation\\n                shadowVertexProjected.x = viewShadow.x / shadowProjection.x;\\n                shadowVertexProjected.y = viewShadow.y / shadowProjection.y;\\n\\n                shadowVertexProjected.z = 2.0 * nfNeg* viewShadow.z + nfPos * viewShadow.w;\\n                shadowVertexProjected.w = viewShadow.w;\\n\\n            }\\n\\n\\n            if (shadowVertexProjected.w < 0.0) {\\n                earlyOut = true; // notably behind camera\\n            }\\n\\n        }\\n\\n        if (!earlyOut) {\\n\\n            shadowUV.xy = shadowVertexProjected.xy / shadowVertexProjected.w;\\n            shadowUV.xy = shadowUV.xy * 0.5 + 0.5;// mad like\\n\\n            if (any(bvec4 ( shadowUV.x > 1., shadowUV.x < 0., shadowUV.y > 1., shadowUV.y < 0.))) {\\n                earlyOut = true;// limits of light frustum\\n            }\\n\\n            // most precision near 0, make sure we are near 0 and in [0,1]\\n            shadowReceiverZ = - shadowVertexEye.z;\\n            shadowReceiverZ =  (shadowReceiverZ - shadowDepthRange.x) * invDepthRange;\\n\\n            if(shadowReceiverZ < 0.0) {\\n                earlyOut = true; // notably behind camera\\n            }\\n\\n        }\\n    }\\n\\n    // pcf pbias to add on offset\\n    vec2 shadowBiasPCF = vec2 (0.);\\n\\n#ifdef GL_OES_standard_derivatives\\n#ifdef _RECEIVERPLANEDEPTHBIAS\\n    vec2 biasUV;\\n\\n    vec3 texCoordDY = dFdx(shadowVertexEye.xyz);\\n    vec3 texCoordDX = dFdy(shadowVertexEye.xyz);\\n\\n    biasUV.x = texCoordDY.y * texCoordDX.z - texCoordDX.y * texCoordDY.z;\\n    biasUV.y = texCoordDX.x * texCoordDY.z - texCoordDY.x * texCoordDX.z;\\n    biasUV *= 1.0 / ((texCoordDX.x * texCoordDY.y) - (texCoordDX.y * texCoordDY.x));\\n\\n    // Static depth biasing to make up for incorrect fractional sampling on the shadow map grid\\n    float fractionalSamplingError = dot(vec2(1.0, 1.0) * shadowSize.xy, abs(biasUV));\\n    float receiverDepthBias = min(fractionalSamplingError, 0.01);\\n\\n    shadowBiasPCF.x = biasUV.x;\\n    shadowBiasPCF.y = biasUV.y;\\n\\n    shadowReceiverZ += receiverDepthBias;\\n\\n#else // _RECEIVERPLANEDEPTHBIAS\\n    shadowBiasPCF.x = clamp(dFdx(shadowReceiverZ) * shadowSize.x, -1.0, 1.0 );\\n    shadowBiasPCF.y = clamp(dFdy(shadowReceiverZ) * shadowSize.y, -1.0, 1.0 );\\n#endif\\n\\n#endif // GL_OES_standard_derivatives\\n\\n\\n    vec4 clampDimension;\\n\\n#ifdef _ATLAS_SHADOW\\n    shadowUV.xy  = ((shadowUV.xy * atlasSize.zw ) + atlasSize.xy) * shadowSize.xy;\\n\\n    // clamp uv bias/filters by half pixel to avoid point filter on border\\n    clampDimension.xy = atlasSize.xy + vec2(0.5);\\n    clampDimension.zw = (atlasSize.xy + atlasSize.zw) - vec2(0.5);\\n\\n    clampDimension = clampDimension * shadowSize.xyxy;\\n#else\\n    clampDimension = vec4(0.0, 0.0, 1.0, 1.0);\\n#endif // _RECEIVERPLANEDEPTHBIAS\\n\\n\\n    // now that derivatives is done and we don\'t access any mipmapped/texgrad texture we can early out\\n    // see http://teknicool.tumblr.com/post/77263472964/glsl-dynamic-branching-and-texture-samplers\\n    if (earlyOut) {\\n        // empty statement because of weird gpu intel bug\\n    } else {\\n\\n        // depth bias: fighting shadow acne (depth imprecsion z-fighting)\\n        // cosTheta is dot( n, l ), clamped between 0 and 1\\n        // float shadowBias = 0.005*tan(acos(N_Dot_L));\\n        // same but 4 cycles instead of 15\\n        float depthBias = 0.05 * sqrt( 1.0 - N_Dot_L * N_Dot_L) / clamp(N_Dot_L, 0.0005, 1.0);\\n\\n        // That makes sure that plane perpendicular to light doesn\'t flicker due to\\n        // selfshadowing and 1 = dot(Normal, Light) using a min bias\\n        depthBias = clamp(depthBias, 0.00005, 2.0 * shadowBias);\\n\\n        // shadowZ must be clamped to [0,1]\\n        // otherwise it\'s not comparable to shadow caster depth map\\n        // which is clamped to [0,1]\\n        // Not doing that makes ALL shadowReceiver > 1.0 black\\n        // because they ALL becomes behind any point in Caster depth map\\n        shadowReceiverZ = clamp(shadowReceiverZ, 0.0, 1.0 -depthBias) - depthBias;\\n\\n        // Now computes Shadow\\n        float res = getShadowPCF(shadowTexture,\\n                                 shadowSize,\\n                                 shadowUV,\\n                                 shadowReceiverZ,\\n                                 shadowBiasPCF,\\n                                 clampDimension\\n                                 OPT_INSTANCE_ARG_outDistance\\n                                 OPT_INSTANCE_ARG_jitter);\\n#ifdef _OUT_DISTANCE\\n        if (lighted) shadow = res;\\n        outDistance *= shadowDepthRange.y - shadowDepthRange.x; // world space distance\\n#else\\n        shadow = res;\\n#endif  // _OUT_DISTANCE\\n    }\\n\\n    return shadow;\\n\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/shaders/shadowReceive.glsl\n// module id = 211\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/shaders/shadowReceive.glsl?')},function(module,exports){eval('module.exports = "#pragma include \\"floatFromTex.glsl\\"\\n\\n// simulation of texture2Dshadow glsl call on HW\\n// http://codeflow.org/entries/2013/feb/15/soft-shadow-mapping/\\nfloat texture2DCompare(const in sampler2D depths,\\n                       const in vec2 uv,\\n                       const in float compare,\\n                       const in vec4 clampDimension){\\n    float depth = getSingleFloatFromTex(depths, clamp(uv, clampDimension.xy, clampDimension.zw));\\n    return compare - depth;\\n}\\n\\n#ifdef _JITTER_OFFSET\\n#define INT_SCALE3_JITTER vec3(.1031, .1030, .0973)\\n// uniform rand\\nvec3 randJitter(const in vec3 p2) {\\n    vec3 p3  = fract(p2.xyz * INT_SCALE3_JITTER);\\n    p3 += dot(p3, p3.yzx + 19.19);\\n    p3 = fract((p3.xxy + p3.yzz) * p3.zyx);\\n    return p3;\\n}\\n#endif\\n\\n// simulates linear fetch like texture2d shadow\\nfloat texture2DShadowLerp(\\n    const in sampler2D depths,\\n    const in vec2 size,\\n    const in vec2 uv,\\n    const in float compare,\\n    const in vec4 clampDimension\\n    OPT_ARG_outDistance\\n    OPT_ARG_jitter){\\n\\n    vec2 centroidCoord = uv / size.xy;\\n\\n#ifdef _JITTER_OFFSET\\n    if (jitter > 0.0){\\n        centroidCoord += randJitter(vec3(gl_FragCoord.xy, jitter)).xy;\\n    }\\n#endif\\n\\n    centroidCoord = centroidCoord + 0.5;\\n    vec2 f = fract(centroidCoord);\\n    vec2 centroidUV = floor(centroidCoord) * size.xy;\\n\\n    vec4 fetches;\\n    const vec2 shift  = vec2(1.0, 0.0);\\n    fetches.x = texture2DCompare(depths, centroidUV + size.xy * shift.yy, compare, clampDimension);\\n    fetches.y = texture2DCompare(depths, centroidUV + size.xy * shift.yx, compare, clampDimension);\\n    fetches.z = texture2DCompare(depths, centroidUV + size.xy * shift.xy, compare, clampDimension);\\n    fetches.w = texture2DCompare(depths, centroidUV + size.xy * shift.xx, compare, clampDimension);\\n\\n\\n\\n#ifdef _OUT_DISTANCE\\n    float _a = mix(fetches.x, fetches.y, f.y);\\n    float _b = mix(fetches.z, fetches.w, f.y);\\n    outDistance = mix(_a, _b, f.x);\\n#endif\\n\\n    vec4 st = step(fetches, vec4(0.0));\\n\\n    float a = mix(st.x, st.y, f.y);\\n    float b = mix(st.z, st.w, f.y);\\n    return mix(a, b, f.x);\\n}\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/shaders/shadowLinearSoft.glsl\n// module id = 212\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/shaders/shadowLinearSoft.glsl?')},function(module,exports){eval('module.exports = "#pragma include \\"colorEncode.glsl\\"\\n\\n// end Float codec\\nfloat getSingleFloatFromTex(const in sampler2D depths, const in vec2 uv){\\n#ifndef _FLOATTEX\\n    return  decodeFloatRGBA(texture2D(depths, uv));\\n#else\\n    return texture2D(depths, uv).x;\\n#endif\\n}\\n\\nvec2 getDoubleFloatFromTex(const in sampler2D depths, const in vec2 uv){\\n#ifndef _FLOATTEX\\n    return decodeHalfFloatRGBA(texture2D(depths, uv));\\n#else\\n    return texture2D(depths, uv).xy;\\n#endif\\n}\\n\\nvec4 getQuadFloatFromTex(const in sampler2D depths, const in vec2 uv){\\n    return texture2D(depths, uv).xyzw;\\n}\\n// end Float codec\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/shaders/floatFromTex.glsl\n// module id = 213\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/shaders/floatFromTex.glsl?')},function(module,exports){eval('module.exports = "#pragma include \\"shadowLinearSoft.glsl\\"\\n\\nfloat getShadowPCF(\\n    const in sampler2D depths,\\n    const in vec2 size,\\n    const in vec2 uv,\\n    const in float compare,\\n    const in vec2 biasPCF,\\n    const in vec4 clampDimension\\n    OPT_ARG_outDistance\\n    OPT_ARG_jitter) {\\n\\n     float res = 0.0;\\n\\n     res += texture2DShadowLerp(depths, size, uv + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter);\\n\\n\\n#if defined(_PCFx1)\\n\\n#else\\n\\n    float dx0 = -size.x;\\n    float dy0 = -size.y;\\n    float dx1 = size.x;\\n    float dy1 = size.y;\\n\\n#define TSF(o1,o2) texture2DShadowLerp(depths, size, uv + vec2(o1, o2) + biasPCF, compare, clampDimension OPT_INSTANCE_ARG_outDistance OPT_INSTANCE_ARG_jitter)\\n\\n    res += TSF(dx0, dx0);\\n    res += TSF(dx0, .0);\\n    res += TSF(dx0, dx1);\\n\\n#if defined(_PCFx4)\\n\\n    res /=4.0;\\n\\n#elif defined(_PCFx9)\\n    res += TSF(.0, dx0);\\n    res += TSF(.0, dx1);\\n\\n    res += TSF(dx1, dx0);\\n    res += TSF(dx1, .0);\\n    res += TSF(dx1, dx1);\\n\\n\\n    res /=9.0;\\n\\n#elif defined(_PCFx25)\\n\\n    float dx02 = 2.0*dx0;\\n    float dy02 = 2.0*dy0;\\n    float dx2 = 2.0*dx1;\\n    float dy2 = 2.0*dy1;\\n\\n    // complete row above\\n    res += TSF(dx0, dx02);\\n    res += TSF(dx0, dx2);\\n\\n    res += TSF(.0, dx02);\\n    res += TSF(.0, dx2);\\n\\n    res += TSF(dx1, dx02);\\n    res += TSF(dx1, dx2);\\n\\n    // two new col\\n    res += TSF(dx02, dx02);\\n    res += TSF(dx02, dx0);\\n    res += TSF(dx02, .0);\\n    res += TSF(dx02, dx1);\\n    res += TSF(dx02, dx2);\\n\\n    res += TSF(dx2, dx02);\\n    res += TSF(dx2, dx0);\\n    res += TSF(dx2, .0);\\n    res += TSF(dx2, dx1);\\n    res += TSF(dx2, dx2);\\n\\n\\n    res/=25.0;\\n\\n#endif\\n\\n#undef TSF\\n\\n#endif\\n    return res;\\n}\\n/////// end Tap\\n"\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/shaders/tapPCF.glsl\n// module id = 214\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/shaders/tapPCF.glsl?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_CullFace__ = __webpack_require__(50);\n\n\n\n\n// To avoid to apply duplicate states we cache them and apply them only\n// when there is a draw commands it means when calling state.drawGeometry\n// called from Geometry.drawImplementation or state.clear\n\n// Here what it does:\n// state.applyCullFaceAttribute(cullFaceDisableAttribute);\n// state.applyCullFaceAttribute(cullFaceEnableAttribute);\n// state.applyCullFaceAttribute(cullFaceDisableAttribute);\n// state.applyCullFaceAttribute(cullFaceEnableAttribute);\n// state.drawGeometry()\n\n//     in this case only the cullFaceEnableAttribute will be applied not the previous one\n\n// Internal implementation use 2 buffers:\n//     - buffer, it contains the required field that will be applied when executing a draw command\n//     - state, that contains the last state appied to webgl, it\'s used to compare if a\n//              change happend from the incoming attribute\n\nvar createStateBlendFunc = function() {\n    return {\n        buffer: {\n            separate: false,\n            enable: false,\n            sourceFactor: __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__["a" /* default */].ONE,\n            destinationFactor: __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__["a" /* default */].ZERO,\n            sourceFactorAlpha: __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__["a" /* default */].ONE,\n            destinationFactorAlpha: __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__["a" /* default */].ZERO\n        },\n        state: {\n            separate: undefined,\n            enable: false,\n            sourceFactor: undefined,\n            destinationFactor: undefined,\n            sourceFactorAlpha: undefined,\n            destinationFactorAlpha: undefined\n        },\n        changed: true\n    };\n};\n\nvar createStateDepth = function() {\n    return {\n        buffer: {\n            func: __WEBPACK_IMPORTED_MODULE_0_osg_Depth__["a" /* default */].LESS,\n            enable: false,\n            near: 0.0,\n            far: 1.0\n        },\n        state: {\n            func: undefined,\n            enable: false,\n            near: undefined,\n            far: undefined\n        },\n        changed: true\n    };\n};\n\nvar createStateCullFace = function() {\n    return {\n        buffer: {\n            enable: false,\n            mode: __WEBPACK_IMPORTED_MODULE_2_osg_CullFace__["a" /* default */].BACK\n        },\n        state: {\n            enable: false,\n            mode: undefined\n        },\n        changed: true\n    };\n};\n\nvar createStateScissor = function() {\n    return {\n        buffer: {\n            enable: false,\n            x: 0,\n            y: 0,\n            width: 640,\n            height: 480\n        },\n        state: {\n            enable: false,\n            x: undefined,\n            y: undefined,\n            width: undefined,\n            height: undefined\n        },\n        changed: true\n    };\n};\n\nvar createStateColorMask = function() {\n    return {\n        buffer: {\n            red: true,\n            green: true,\n            blue: true,\n            alpha: true\n        },\n        state: {\n            red: undefined,\n            green: undefined,\n            blue: undefined,\n            alpha: undefined\n        },\n        changed: true\n    };\n};\n\nvar createStateViewport = function() {\n    return {\n        buffer: {\n            x: 0,\n            y: 0,\n            width: 640,\n            height: 480\n        },\n        state: {\n            x: undefined,\n            y: undefined,\n            width: undefined,\n            height: undefined\n        },\n        changed: true\n    };\n};\n\nvar createStateDepthMask = function() {\n    return {\n        state: { value: true },\n        buffer: { value: undefined },\n        changed: true\n    };\n};\n\nvar createStateClearDepth = function() {\n    return {\n        buffer: { value: 1.0 },\n        state: { value: undefined },\n        changed: true\n    };\n};\n\nvar createStateClearColor = function() {\n    return {\n        buffer: {\n            red: 0.0,\n            green: 0.0,\n            blue: 0.0,\n            alpha: 0.0\n        },\n        state: {\n            red: undefined,\n            green: undefined,\n            blue: undefined,\n            alpha: undefined\n        },\n        changed: true\n    };\n};\n\nvar StateCache = function() {\n    this._stateClearColor = createStateClearColor();\n    this._stateClearDepth = createStateClearDepth();\n    this._stateDepthMask = createStateDepthMask();\n    this._stateViewport = createStateViewport();\n    this._stateColorMask = createStateColorMask();\n    this._stateScissor = createStateScissor();\n    this._stateDepth = createStateDepth();\n    this._stateCullFace = createStateCullFace();\n    this._stateBlendFunc = createStateBlendFunc();\n};\n\nStateCache.prototype = {\n    clearColor: function(array) {\n        var data = this._stateClearColor;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.red = array[0];\n        buffer.green = array[1];\n        buffer.blue = array[2];\n        buffer.alpha = array[3];\n\n        if (\n            state.red !== array[0] ||\n            state.green !== array[1] ||\n            state.blue !== array[2] ||\n            state.alpha !== array[3]\n        ) {\n            data.changed = true;\n        }\n    },\n\n    applyClearColor: function(gl) {\n        var data = this._stateClearColor;\n        var state = data.state;\n        var buffer = data.buffer;\n        data.changed = false;\n        state.red = buffer.red;\n        state.green = buffer.green;\n        state.blue = buffer.blue;\n        state.alpha = buffer.alpha;\n        gl.clearColor(state.red, state.green, state.blue, state.alpha);\n    },\n\n    clearDepth: function(value) {\n        var data = this._stateClearDepth;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.value = value;\n\n        if (state.value !== value) {\n            data.changed = true;\n        }\n    },\n\n    applyClearDepth: function(gl) {\n        var data = this._stateClearDepth;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n        state.value = buffer.value;\n        gl.clearDepth(state.value);\n    },\n\n    depthMask: function(value) {\n        var data = this._stateDepthMask;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.value = value;\n\n        if (state.value !== value) {\n            data.changed = true;\n        }\n    },\n\n    applyDepthMask: function(gl) {\n        var data = this._stateDepthMask;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n        state.value = buffer.value;\n        gl.depthMask(state.value);\n    },\n\n    applyViewportAttribute: function(attribute) {\n        this.viewport(attribute._x, attribute._y, attribute._width, attribute._height);\n    },\n\n    viewport: function(x, y, width, height) {\n        var data = this._stateViewport;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.x = x;\n        buffer.y = y;\n        buffer.width = width;\n        buffer.height = height;\n\n        if (state.x !== x || state.y !== y || state.width !== width || state.height !== height) {\n            data.changed = true;\n        }\n    },\n\n    applyViewport: function(gl) {\n        var data = this._stateViewport;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n        state.x = buffer.x;\n        state.y = buffer.y;\n        state.width = buffer.width;\n        state.height = buffer.height;\n        gl.viewport(state.x, state.y, state.width, state.height);\n    },\n\n    applyColorMaskAttribute: function(attribute) {\n        var data = this._stateColorMask;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.red = attribute._red;\n        buffer.green = attribute._green;\n        buffer.blue = attribute._blue;\n        buffer.alpha = attribute._alpha;\n\n        if (\n            state.red !== attribute._red ||\n            state.green !== attribute._green ||\n            state.blue !== attribute._blue ||\n            state.alpha !== attribute._alpha\n        ) {\n            data.changed = true;\n        }\n    },\n\n    applyColorMask: function(gl) {\n        var data = this._stateColorMask;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n        state.red = buffer.red;\n        state.green = buffer.green;\n        state.blue = buffer.blue;\n        state.alpha = buffer.alpha;\n        gl.colorMask(state.red, state.green, state.blue, state.alpha);\n    },\n\n    applyScissorAttribute: function(attribute) {\n        var enable = attribute._x !== -1;\n        var data = this._stateScissor;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.enable = enable;\n        buffer.x = attribute._x;\n        buffer.y = attribute._y;\n        buffer.width = attribute._width;\n        buffer.height = attribute._height;\n\n        if (state.enable !== enable ||\n            state.x !== attribute._x ||\n            state.y !== attribute._y ||\n            state.width !== attribute._width ||\n            state.height !== attribute._height ) {\n            data.changed = true;\n        }\n    },\n\n    applyScissor: function(gl) {\n        var data = this._stateScissor;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        if (state.enable !== buffer.enable) {\n            state.enable = buffer.enable;\n            if (state.enable) {\n                gl.enable(gl.SCISSOR_TEST);\n            } else {\n                gl.disable(gl.SCISSOR_TEST);\n            }\n        }\n\n        if (!state.enable) return;\n\n        if (\n            state.x !== buffer.x ||\n            state.y !== buffer.y ||\n            state.width !== buffer.width ||\n            state.height !== buffer.height\n        ) {\n            state.x = buffer.x;\n            state.y = buffer.y;\n            state.width = buffer.width;\n            state.height = buffer.height;\n            gl.scissor(state.x, state.y, state.width, state.height);\n        }\n    },\n\n    applyCullFaceAttribute: function(attribute) {\n        var data = this._stateCullFace;\n        var buffer = data.buffer;\n        var state = data.state;\n        var enable = attribute._mode !== __WEBPACK_IMPORTED_MODULE_2_osg_CullFace__["a" /* default */].DISABLE;\n        data.changed = false;\n\n        buffer.enable = enable;\n        buffer.mode = attribute._mode;\n\n        if (state.enable !== enable || state.mode !== attribute._mode) {\n            data.changed = true;\n        }\n    },\n\n    applyCullFace: function(gl) {\n        var data = this._stateCullFace;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        if (state.enable !== buffer.enable) {\n            state.enable = buffer.enable;\n            if (state.enable) {\n                gl.enable(gl.CULL_FACE);\n            } else {\n                gl.disable(gl.CULL_FACE);\n            }\n        }\n\n        if (!state.enable) return;\n\n        if (state.mode !== buffer.mode) {\n            state.mode = buffer.mode;\n            gl.cullFace(state.mode);\n        }\n    },\n\n    applyDepthAttribute: function(attribute) {\n        var enable = attribute._func !== __WEBPACK_IMPORTED_MODULE_0_osg_Depth__["a" /* default */].DISABLE;\n        var data = this._stateDepth;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        buffer.enable = enable;\n        buffer.func = attribute._func;\n        buffer.far = attribute._far;\n        buffer.near = attribute._near;\n\n        if (state.enable !== enable ||\n            state.func !== attribute._func ||\n            state.near !== attribute._near ||\n            state.far !== attribute._far ) {\n            data.changed = true;\n        }\n\n        this.depthMask(attribute._writeMask);\n    },\n\n    applyDepth: function(gl) {\n        var data = this._stateDepth;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        if (state.enable !== buffer.enable) {\n            state.enable = buffer.enable;\n            if (state.enable) {\n                gl.enable(gl.DEPTH_TEST);\n            } else {\n                gl.disable(gl.DEPTH_TEST);\n            }\n        }\n\n        if (!state.enable) return;\n\n        if (state.func !== buffer.func) {\n            state.func = buffer.func;\n            gl.depthFunc(state.func);\n        }\n\n        if (state.near !== buffer.near || state.far !== buffer.far) {\n            state.far = buffer.far;\n            state.near = buffer.near;\n            gl.depthRange(state.near, state.far);\n        }\n    },\n\n    applyBlendFuncAttribute: function(attribute) {\n        var data = this._stateBlendFunc;\n        var buffer = data.buffer;\n        var state = data.state;\n        var enable =\n            attribute._sourceFactor !== __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__["a" /* default */].DISABLE &&\n            attribute._destinationFactor !== __WEBPACK_IMPORTED_MODULE_1_osg_BlendFunc__["a" /* default */].DISABLE;\n        data.changed = false;\n\n        buffer.enable = enable;\n        buffer.separate = attribute._separate;\n        buffer.sourceFactor = attribute._sourceFactor;\n        buffer.destinationFactor = attribute._destinationFactor;\n        buffer.sourceFactorAlpha = attribute._sourceFactorAlpha;\n        buffer.destinationFactorAlpha = attribute._destinationFactorAlpha;\n\n        if (state.enable !== enable ||\n            state.sourceFactor !== attribute._sourceFactor ||\n            state.destinationFactor !== attribute._destinationFactor ||\n            state.sourceFactorAlpha !== attribute._sourceFactorAlpha ||\n            state.destinationFactorAlpha !== attribute._destinationFactorAlpha\n        ) {\n            data.changed = true;\n        }\n    },\n\n    applyBlendFunc: function(gl) {\n        var data = this._stateBlendFunc;\n        var buffer = data.buffer;\n        var state = data.state;\n        data.changed = false;\n\n        if (state.enable !== buffer.enable) {\n            state.enable = buffer.enable;\n            if (state.enable) {\n                gl.enable(gl.BLEND);\n            } else {\n                gl.disable(gl.BLEND);\n            }\n        }\n\n        if (!state.enable) return;\n\n        state.separate = buffer.separate;\n        if (state.separate) {\n            if (\n                state.sourceFactor !== buffer.sourceFactor ||\n                state.destinationFactor !== buffer.destinationFactor ||\n                state.sourceFactorAlpha !== buffer.sourceFactorAlpha ||\n                state.destinationFactorAlpha !== buffer.destinationFactorAlpha\n            ) {\n                state.sourceFactor = buffer.sourceFactor;\n                state.destinationFactor = buffer.destinationFactor;\n                state.sourceFactorAlpha = buffer.sourceFactorAlpha;\n                state.destinationFactorAlpha = buffer.destinationFactorAlpha;\n                gl.blendFuncSeparate(\n                    state.sourceFactor,\n                    state.destinationFactor,\n                    state.sourceFactorAlpha,\n                    state.destinationFactorAlpha\n                );\n            }\n        } else if (\n            state.sourceFactor !== buffer.sourceFactor ||\n            state.destinationFactor !== buffer.destinationFactor\n        ) {\n            state.sourceFactor = buffer.sourceFactor;\n            state.destinationFactor = buffer.destinationFactor;\n            gl.blendFunc(state.sourceFactor, state.destinationFactor);\n        }\n    },\n\n    applyClearStates: function(gl) {\n        if (this._stateDepthMask.changed) {\n            this.applyDepthMask(gl);\n        }\n        if (this._stateScissor.changed) {\n            this.applyScissor(gl);\n        }\n        if (this._stateClearColor.changed) {\n            this.applyClearColor(gl);\n        }\n        if (this._stateClearDepth.changed) {\n            this.applyClearDepth(gl);\n        }\n        if (this._stateColorMask.changed) {\n            this.applyColorMask(gl);\n        }\n    },\n\n    applyDrawStates: function(gl) {\n        if (this._stateViewport.changed) {\n            this.applyViewport(gl);\n        }\n        if (this._stateScissor.changed) {\n            this.applyScissor(gl);\n        }\n        if (this._stateDepth.changed) {\n            this.applyDepth(gl);\n        }\n        if (this._stateDepthMask.changed) {\n            this.applyDepthMask(gl);\n        }\n        if (this._stateCullFace.changed) {\n            this.applyCullFace(gl);\n        }\n        if (this._stateBlendFunc.changed) {\n            this.applyBlendFunc(gl);\n        }\n        if (this._stateColorMask.changed) {\n            this.applyColorMask(gl);\n        }\n    },\n\n    clear: function(gl, mask) {\n        this.applyClearStates(gl);\n        gl.clear(mask);\n    },\n\n    drawGeometry: function(gl) {\n        this.applyDrawStates(gl);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (StateCache);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/StateCache.js\n// module id = 215\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/StateCache.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Texture__ = __webpack_require__(7);\n\n\n\n\n\n/**\n * TextureCubeMap\n * @class TextureCubeMap\n * @inherits Texture\n */\nvar TextureCubeMap = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].call(this);\n    this._images = {};\n\n    // pre allocated all textures faces slots\n    for (var i = 0; i < 6; i++) {\n        this._images[__WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X + i] = new __WEBPACK_IMPORTED_MODULE_1_osg_Image__["a" /* default */]();\n    }\n};\n\n/** @lends TextureCubeMap.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeStateAttribute(\n    TextureCubeMap,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].prototype, {\n        setDefaultParameters: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].prototype.setDefaultParameters.call(this);\n            this._textureTarget = __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP;\n\n            this._flipY = false;\n        },\n\n        invalidate: function() {\n            __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].prototype.invalidate.call(this);\n            for (\n                var i = __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X;\n                i < __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X + 6;\n                i++\n            ) {\n                var faceImage = this._images[i];\n                if (this._images[__WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X].getImage()) {\n                    faceImage.dirty();\n                }\n            }\n            this.dirty();\n        },\n\n        cloneType: function() {\n            return new TextureCubeMap();\n        },\n\n        setImage: function(imageFace, img, imageFormat) {\n            var face = imageFace;\n\n            if (typeof face === \'string\') face = __WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"][face];\n\n            this._images[face].setImage(img, imageFormat);\n\n            this.setImageFormat(imageFormat);\n            this.setTextureSize(this._images[face].getWidth(), this._images[face].getHeight());\n\n            this._textureNull = false;\n            this.dirty();\n        },\n\n        getImage: function(face) {\n            return this._images[face].getImage();\n        },\n\n        initCubemapContent: function(gl) {\n            var internalFormat = this._internalFormat;\n\n            this.applyTexImage2D(\n                gl,\n                gl.TEXTURE_CUBE_MAP_POSITIVE_X,\n                0,\n                internalFormat,\n                this._textureWidth,\n                this._textureHeight,\n                0,\n                internalFormat,\n                this._type,\n                null\n            );\n\n            this.applyTexImage2D(\n                gl,\n                gl.TEXTURE_CUBE_MAP_NEGATIVE_X,\n                0,\n                internalFormat,\n                this._textureWidth,\n                this._textureHeight,\n                0,\n                internalFormat,\n                this._type,\n                null\n            );\n\n            this.applyTexImage2D(\n                gl,\n                gl.TEXTURE_CUBE_MAP_POSITIVE_Y,\n                0,\n                internalFormat,\n                this._textureWidth,\n                this._textureHeight,\n                0,\n                internalFormat,\n                this._type,\n                null\n            );\n\n            this.applyTexImage2D(\n                gl,\n                gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,\n                0,\n                internalFormat,\n                this._textureWidth,\n                this._textureHeight,\n                0,\n                internalFormat,\n                this._type,\n                null\n            );\n\n            this.applyTexImage2D(\n                gl,\n                gl.TEXTURE_CUBE_MAP_POSITIVE_Z,\n                0,\n                internalFormat,\n                this._textureWidth,\n                this._textureHeight,\n                0,\n                internalFormat,\n                this._type,\n                null\n            );\n\n            this.applyTexImage2D(\n                gl,\n                gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,\n                0,\n                internalFormat,\n                this._textureWidth,\n                this._textureHeight,\n                0,\n                internalFormat,\n                this._type,\n                null\n            );\n\n            return true;\n        },\n\n        // handle mipmap logic, if images for mipmap are provided or not\n        generateMipmap: function(gl, target) {\n            if (!this.hasMipmapFilter()) return;\n\n            // manual mipmap provided\n            if (this._images[__WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X].hasMipmap()) {\n                for (var face = 0; face < 6; face++) {\n                    var faceImage = this._images[__WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X + face];\n                    if (!faceImage.hasMipmap()) {\n                        __WEBPACK_IMPORTED_MODULE_2_osg_notify__["a" /* default */].error(\'mipmap not set correctly for TextureCubemap\');\n                    }\n\n                    var internalFormat = this._internalFormat;\n                    for (var level = 1; level < faceImage.getMipmap().length; level++) {\n                        var size = faceImage.getMipmap()[level].getWidth();\n\n                        this.applyTexImage2D(\n                            gl,\n                            gl.TEXTURE_CUBE_MAP_POSITIVE_X + face,\n                            level,\n                            internalFormat,\n                            size,\n                            size,\n                            0,\n                            internalFormat,\n                            this._type,\n                            faceImage.getMipmap()[level].getImage()\n                        );\n                    }\n                }\n            } else {\n                // automatic mipmap\n                gl.generateMipmap(target);\n            }\n\n            this._dirtyMipmap = false;\n        },\n\n        applyImageTarget: function(gl, internalFormat, target) {\n            var faceImage = this._images[target];\n\n            if (!faceImage.getImage()) return 0;\n\n            if (!faceImage.isReady()) return 0;\n\n            if (!faceImage.isDirty()) return 1;\n\n            this.setTextureSize(faceImage.getWidth(), faceImage.getHeight());\n\n            faceImage.setDirty(false);\n\n            if (faceImage.isTypedArray()) {\n                this.applyTexImage2D(\n                    gl,\n                    target,\n                    0,\n                    internalFormat,\n                    this._textureWidth,\n                    this._textureHeight,\n                    0,\n                    internalFormat,\n                    this._type,\n                    faceImage.getImage()\n                );\n            } else {\n                this.applyTexImage2D(\n                    gl,\n                    target,\n                    0,\n                    internalFormat,\n                    internalFormat,\n                    this._type,\n                    faceImage.getImage()\n                );\n            }\n\n            // release here only if no mipmap\n            if (this._unrefImageDataAfterApply && !(this.hasMipmap() && faceImage.hasMipmap())) {\n                faceImage.release();\n            }\n\n            return 1;\n        },\n\n        initCubemapContentImage: function(gl) {\n            var internalFormat = this._internalFormat;\n            var valid = 0;\n            valid += this.applyImageTarget(gl, internalFormat, gl.TEXTURE_CUBE_MAP_POSITIVE_X);\n            valid += this.applyImageTarget(gl, internalFormat, gl.TEXTURE_CUBE_MAP_NEGATIVE_X);\n\n            valid += this.applyImageTarget(gl, internalFormat, gl.TEXTURE_CUBE_MAP_POSITIVE_Y);\n            valid += this.applyImageTarget(gl, internalFormat, gl.TEXTURE_CUBE_MAP_NEGATIVE_Y);\n\n            valid += this.applyImageTarget(gl, internalFormat, gl.TEXTURE_CUBE_MAP_POSITIVE_Z);\n            valid += this.applyImageTarget(gl, internalFormat, gl.TEXTURE_CUBE_MAP_NEGATIVE_Z);\n\n            if (valid === 6) return true;\n\n            return false;\n        },\n\n        apply: function(state) {\n            var gl = state.getGraphicContext();\n            // if need to release the texture\n            if (this._dirtyTextureObject) {\n                this.releaseGLObjects();\n                this.setGraphicContext(gl);\n            }\n\n            if (this._textureObject !== undefined && !this.isDirty()) {\n                this._textureObject.bind(gl);\n\n                // If we have modified the texture via Rtt or texSubImage2D and _need_ updated mipmaps,\n                // then we must regenerate the mipmaps explicitely.\n                // In all other cases, don\'t set this flag because it can be costly\n                if (this.isDirtyMipmap()) {\n                    this.generateMipmap(gl, this._textureTarget);\n                }\n            } else if (this._textureNull) {\n                gl.bindTexture(this._textureTarget, null);\n            } else {\n                if (!this._textureObject) {\n                    // must be called before init\n                    this.computeTextureFormat();\n\n                    this.init(state);\n                }\n                this._textureObject.bind(gl);\n\n                var valid;\n\n                // no images it\'s must be a cubemap filled from rtt\n                if (!this._images[__WEBPACK_IMPORTED_MODULE_3_osg_Texture__["default"].TEXTURE_CUBE_MAP_POSITIVE_X].getImage()) {\n                    valid = this.initCubemapContent(gl);\n                } else {\n                    valid = this.initCubemapContentImage(gl);\n                }\n\n                if (valid) {\n                    this._dirty = false;\n                    this.applyFilterParameter(gl, this._textureTarget);\n                    this.generateMipmap(gl, this._textureTarget);\n                }\n            } // render to cubemap not yet implemented\n        }\n    }),\n    \'osg\',\n    \'TextureCubeMap\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (TextureCubeMap);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/TextureCubeMap.js\n// module id = 216\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/TextureCubeMap.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_DrawArrays__ = __webpack_require__(17);\n\n\n\n\n// This class can be used to visit all the triangles of a geometry\nvar TriangleIndexFunctor = function() {};\n\nvar functorDrawElements = (TriangleIndexFunctor.functorDrawElements = []);\nvar functorDrawArrays = (TriangleIndexFunctor.functorDrawArrays = []);\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLES] = function(offset, count, indexes, cb) {\n    var end = offset + count;\n    for (var i = offset; i < end; i += 3) {\n        cb(indexes[i], indexes[i + 1], indexes[i + 2]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP] = function(offset, count, indexes, cb) {\n    for (var i = 2, j = offset; i < count; ++i, ++j) {\n        if (i % 2) cb(indexes[j], indexes[j + 2], indexes[j + 1]);\n        else cb(indexes[j], indexes[j + 1], indexes[j + 2]);\n    }\n};\n\nfunctorDrawElements[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN] = function(offset, count, indexes, cb) {\n    var first = indexes[offset];\n    for (var i = 2, j = offset + 1; i < count; ++i, ++j) {\n        cb(first, indexes[j], indexes[j + 1]);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLES] = function(first, count, cb) {\n    for (var i = 2, pos = first; i < count; i += 3, pos += 3) {\n        cb(pos, pos + 1, pos + 2);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP] = function(first, count, cb) {\n    for (var i = 2, pos = first; i < count; ++i, ++pos) {\n        if (i % 2) cb(pos, pos + 2, pos + 1);\n        else cb(pos, pos + 1, pos + 2);\n    }\n};\n\nfunctorDrawArrays[__WEBPACK_IMPORTED_MODULE_0_osg_primitiveSet__["a" /* default */].TRIANGLE_FAN] = function(first, count, cb) {\n    for (var i = 2, pos = first + 1; i < count; ++i, ++pos) {\n        cb(first, pos, pos + 1);\n    }\n};\n\nTriangleIndexFunctor.prototype = {\n    // You feed it with a callback that will be called for each triangle\n    // (with the 3 indexes of vertices as arguments)\n    init: function(geom, cb) {\n        this._geom = geom;\n        this._cb = cb;\n    },\n\n    apply: function() {\n        var geom = this._geom;\n        var primitives = geom.getPrimitiveSetList();\n        if (!primitives) return;\n\n        var cb = this._cb;\n        var cbFunctor;\n\n        var nbPrimitives = primitives.length;\n        for (var i = 0; i < nbPrimitives; i++) {\n            var primitive = primitives[i];\n            if (primitive instanceof __WEBPACK_IMPORTED_MODULE_1_osg_DrawElements__["a" /* default */]) {\n                cbFunctor = functorDrawElements[primitive.getMode()];\n                if (cbFunctor) {\n                    var indexes = primitive.indices.getElements();\n                    cbFunctor(\n                        primitive.getFirst() / indexes.BYTES_PER_ELEMENT,\n                        primitive.getCount(),\n                        indexes,\n                        cb\n                    );\n                }\n            } else if (primitive instanceof __WEBPACK_IMPORTED_MODULE_2_osg_DrawArrays__["a" /* default */]) {\n                cbFunctor = functorDrawArrays[primitive.getMode()];\n                if (cbFunctor) {\n                    cbFunctor(primitive.getFirst(), primitive.getCount(), cb);\n                }\n            }\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (TriangleIndexFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osg/TriangleIndexFunctor.js\n// module id = 217\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osg/TriangleIndexFunctor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgAnimation_animation__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgAnimation_SkinningAttribute__ = __webpack_require__(114);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_AnimationUpdateCallback__ = __webpack_require__(52);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_BasicAnimationManager__ = __webpack_require__(125);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_Bone__ = __webpack_require__(44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgAnimation_channel__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgAnimation_CollectAnimationUpdateCallbackVisitor__ = __webpack_require__(127);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgAnimation_easing__ = __webpack_require__(219);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgAnimation_interpolator__ = __webpack_require__(126);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgAnimation_MorphAttribute__ = __webpack_require__(113);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgAnimation_MorphGeometry__ = __webpack_require__(38);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgAnimation_RigGeometry__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgAnimation_Skeleton__ = __webpack_require__(62);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgAnimation_StackedMatrix__ = __webpack_require__(128);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osgAnimation_StackedQuaternion__ = __webpack_require__(129);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osgAnimation_StackedRotateAxis__ = __webpack_require__(220);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osgAnimation_StackedScale__ = __webpack_require__(89);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osgAnimation_StackedTranslate__ = __webpack_require__(130);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osgAnimation_UpdateBone__ = __webpack_require__(84);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osgAnimation_UpdateMatrixTransform__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21_osgAnimation_UpdateMorph__ = __webpack_require__(88);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22_osgAnimation_UpdateSkeleton__ = __webpack_require__(112);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar osgAnimation = {};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectMix(osgAnimation, __WEBPACK_IMPORTED_MODULE_8_osgAnimation_easing__["a" /* default */]);\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectMix(osgAnimation, __WEBPACK_IMPORTED_MODULE_9_osgAnimation_interpolator__["a" /* default */]);\nosgAnimation.Animation = __WEBPACK_IMPORTED_MODULE_1_osgAnimation_animation__["a" /* default */];\nosgAnimation.SkinningAttribute = __WEBPACK_IMPORTED_MODULE_2_osgAnimation_SkinningAttribute__["a" /* default */];\nosgAnimation.AnimationUpdateCallback = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_AnimationUpdateCallback__["a" /* default */];\nosgAnimation.BasicAnimationManager = __WEBPACK_IMPORTED_MODULE_4_osgAnimation_BasicAnimationManager__["a" /* default */];\nosgAnimation.Bone = __WEBPACK_IMPORTED_MODULE_5_osgAnimation_Bone__["a" /* default */];\nosgAnimation.Channel = __WEBPACK_IMPORTED_MODULE_6_osgAnimation_channel__["a" /* default */];\nosgAnimation.CollectAnimationUpdateCallbackVisitor = __WEBPACK_IMPORTED_MODULE_7_osgAnimation_CollectAnimationUpdateCallbackVisitor__["a" /* default */];\nosgAnimation.MorphAttribute = __WEBPACK_IMPORTED_MODULE_10_osgAnimation_MorphAttribute__["a" /* default */];\nosgAnimation.MorphGeometry = __WEBPACK_IMPORTED_MODULE_11_osgAnimation_MorphGeometry__["a" /* default */];\nosgAnimation.RigGeometry = __WEBPACK_IMPORTED_MODULE_12_osgAnimation_RigGeometry__["a" /* default */];\nosgAnimation.Skeleton = __WEBPACK_IMPORTED_MODULE_13_osgAnimation_Skeleton__["a" /* default */];\nosgAnimation.StackedMatrix = __WEBPACK_IMPORTED_MODULE_14_osgAnimation_StackedMatrix__["a" /* default */];\nosgAnimation.StackedQuaternion = __WEBPACK_IMPORTED_MODULE_15_osgAnimation_StackedQuaternion__["a" /* default */];\nosgAnimation.StackedRotateAxis = __WEBPACK_IMPORTED_MODULE_16_osgAnimation_StackedRotateAxis__["a" /* default */];\nosgAnimation.StackedScale = __WEBPACK_IMPORTED_MODULE_17_osgAnimation_StackedScale__["a" /* default */];\nosgAnimation.StackedTranslate = __WEBPACK_IMPORTED_MODULE_18_osgAnimation_StackedTranslate__["a" /* default */];\nosgAnimation.UpdateBone = __WEBPACK_IMPORTED_MODULE_19_osgAnimation_UpdateBone__["a" /* default */];\nosgAnimation.UpdateMatrixTransform = __WEBPACK_IMPORTED_MODULE_20_osgAnimation_UpdateMatrixTransform__["a" /* default */];\nosgAnimation.UpdateMorph = __WEBPACK_IMPORTED_MODULE_21_osgAnimation_UpdateMorph__["a" /* default */];\nosgAnimation.UpdateSkeleton = __WEBPACK_IMPORTED_MODULE_22_osgAnimation_UpdateSkeleton__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (osgAnimation);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/osgAnimation.js\n// module id = 218\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/osgAnimation.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('var easeOutQuad = function(t) {\n    return -(t * (t - 2.0));\n};\nvar easeInQuad = function(t) {\n    return t * t;\n};\nvar easeOutCubic = function(t) {\n    t = t - 1.0;\n    return t * t * t + 1;\n};\nvar easeInCubic = function(t) {\n    return t * t * t;\n};\nvar easeOutQuart = function(t) {\n    t = t - 1;\n    return -(t * t * t * t - 1);\n};\nvar easeInQuart = function(t) {\n    return t * t * t * t;\n};\nvar easeOutElastic = function(t) {\n    return Math.pow(2.0, -10.0 * t) * Math.sin((t - 0.3 / 4.0) * (2.0 * Math.PI) / 0.3) + 1.0;\n};\n//osgAnimation.EaseInElastic = function(t) { return ; };\nvar easeOutBounce = function(t) {\n    if (t < 1 / 2.75) {\n        return 7.5625 * t * t;\n    } else if (t < 2 / 2.75) {\n        return 7.5625 * (t -= 1.5 / 2.75) * t + 0.75;\n    } else if (t < 2.5 / 2.75) {\n        return 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375;\n    } else {\n        return 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375;\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = ({\n    easeOutQuad: easeOutQuad,\n    easeInQuad: easeInQuad,\n    easeOutCubic: easeOutCubic,\n    easeInCubic: easeInCubic,\n    easeOutQuart: easeOutQuart,\n    easeInQuart: easeInQuart,\n    easeOutElastic: easeOutElastic,\n    easeOutBounce: easeOutBounce,\n    EaseOutQuad: easeOutQuad,\n    EaseInQuad: easeInQuad,\n    EaseOutCubic: easeOutCubic,\n    EaseInCubic: easeInCubic,\n    EaseOutQuart: easeOutQuart,\n    EaseInQuart: easeInQuart,\n    EaseOutElastic: easeOutElastic,\n    EaseOutBounce: easeOutBounce\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/easing.js\n// module id = 219\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/easing.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Object__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__ = __webpack_require__(37);\n\n\n\n\n\n\n\nvar StackedRotateAxis = function(name, axis, angle) {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].call(this);\n    this._axis = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(0, 0, 1);\n    if (axis) __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._axis, axis);\n    this._target = __WEBPACK_IMPORTED_MODULE_3_osgAnimation_target__["a" /* default */].createFloatTarget(typeof angle === \'number\' ? angle : 0.0);\n    if (name) this.setName(name);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    StackedRotateAxis,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Object__["a" /* default */].prototype, {\n        init: function(axis, angle) {\n            this.setAxis(axis);\n            this.setAngle(angle);\n            this._target.defaultValue = angle;\n        },\n\n        setAxis: function(axis) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._axis, axis);\n        },\n\n        setAngle: function(angle) {\n            this._target.value = angle;\n        },\n\n        getTarget: function() {\n            return this._target;\n        },\n\n        resetToDefaultValue: function() {\n            this.setAngle(this._target.defaultValue);\n        },\n\n        applyToMatrix: (function() {\n            var matrixTmp = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n            var quatTmp = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].create();\n\n            return function(m) {\n                var axis = this._axis;\n                var qtmp = quatTmp;\n                var mtmp = matrixTmp;\n                var angle = this._target.value;\n\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].setAxisAngle(qtmp, axis, angle);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromQuat(mtmp, qtmp);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(m, m, mtmp);\n            };\n        })()\n    }),\n    \'osgAnimation\',\n    \'StackedRotateAxis\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (StackedRotateAxis);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgAnimation/StackedRotateAxis.js\n// module id = 220\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgAnimation/StackedRotateAxis.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgDB_Input__ = __webpack_require__(40);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_readerParser__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_DatabasePager__ = __webpack_require__(133);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgWrappers_serializers_osg__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgWrappers_serializers_osgAnimation__ = __webpack_require__(134);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgWrappers_serializers_osgText__ = __webpack_require__(135);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgDB_FileHelper__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgDB_requestFile__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgDB_zlib__ = __webpack_require__(131);\n\n\n\n\n\n\n\n\n\n\n\n\nvar osgDB = {};\nosgDB.Input = __WEBPACK_IMPORTED_MODULE_1_osgDB_Input__["default"];\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectMix(osgDB, __WEBPACK_IMPORTED_MODULE_2_osgDB_readerParser__["default"]);\nosgDB.DatabasePager = __WEBPACK_IMPORTED_MODULE_3_osgDB_DatabasePager__["a" /* default */];\nosgDB.ObjectWrapper.serializers.osg = __WEBPACK_IMPORTED_MODULE_4_osgWrappers_serializers_osg__["a" /* default */];\nosgDB.ObjectWrapper.serializers.osgAnimation = __WEBPACK_IMPORTED_MODULE_5_osgWrappers_serializers_osgAnimation__["a" /* default */];\nosgDB.ObjectWrapper.serializers.osgText = __WEBPACK_IMPORTED_MODULE_6_osgWrappers_serializers_osgText__["a" /* default */];\nosgDB.Registry = __WEBPACK_IMPORTED_MODULE_7_osgDB_Registry__["a" /* default */];\nosgDB.FileHelper = __WEBPACK_IMPORTED_MODULE_8_osgDB_FileHelper__["a" /* default */];\nosgDB.requestFile = __WEBPACK_IMPORTED_MODULE_9_osgDB_requestFile__["a" /* default */];\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectMix(osgDB, __WEBPACK_IMPORTED_MODULE_10_osgDB_zlib__["a" /* default */]);\n\n/* harmony default export */ __webpack_exports__["a"] = (osgDB);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/osgDB.js\n// module id = 221\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/osgDB.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("var defaultOptions = {\n    // prefix to built url to load resource\n    prefixURL: '',\n\n    // database URL for PagedLOD structures\n    databasePath: '',\n\n    // callback used when loading data\n    progressXHRCallback: undefined,\n\n    // replacement of readImageURL to use your own code to load Nodes\n    // the function will be execute in the context of Input, see Input:readNodeURL\n    readNodeURL: undefined,\n\n    // replacement of readImageURL to use your own code to load osg.Image\n    // the function will be execute in the context of Input, see Input:readImageURL\n    readImageURL: undefined,\n\n    // replacement of readBinaryArrayURL to use your own code to load binary array\n    // the function will be execute in the context of Input, see Input:readBinaryArrayURL\n    readBinaryArrayURL: undefined,\n\n    imageLoadingUsePromise: true, // use promise to load image instead of returning Image\n    imageOnload: undefined, // use callback when loading an image\n    imageCrossOrigin: undefined // use callback when loading an image\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (defaultOptions);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgDB/options.js\n// module id = 222\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgDB/options.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_hammer__ = __webpack_require__(137);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_hammer___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_hammer__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgGA_CADManipulator__ = __webpack_require__(224);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgGA_CADManipulatorStandardMouseKeyboardController__ = __webpack_require__(141);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgGA_CADManipulatorHammerController__ = __webpack_require__(147);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgGA_FirstPersonManipulator__ = __webpack_require__(225);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgGA_FirstPersonManipulatorDeviceOrientationController__ = __webpack_require__(91);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgGA_FirstPersonManipulatorHammerController__ = __webpack_require__(148);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgGA_FirstPersonManipulatorStandardMouseKeyboardController__ = __webpack_require__(150);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgGA_FirstPersonManipulatorWebVRController__ = __webpack_require__(149);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgGA_Manipulator__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgGA_OrbitManipulator__ = __webpack_require__(90);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgGA_OrbitManipulatorDeviceOrientationController__ = __webpack_require__(142);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgGA_OrbitManipulatorGamePadController__ = __webpack_require__(143);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgGA_OrbitManipulatorHammerController__ = __webpack_require__(92);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgGA_OrbitManipulatorStandardMouseKeyboardController__ = __webpack_require__(144);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osgGA_OrbitManipulatorWebVRController__ = __webpack_require__(146);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osgGA_SwitchManipulator__ = __webpack_require__(226);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osgGA_orbitManipulatorEnums__ = __webpack_require__(145);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osgGA_Controller__ = __webpack_require__(21);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar osgGA = {};\n\n__WEBPACK_IMPORTED_MODULE_0_hammer___default.a.NO_MOUSEEVENTS = true; // disable hammer js mouse events\n\nosgGA.CADManipulator = __WEBPACK_IMPORTED_MODULE_1_osgGA_CADManipulator__["a" /* default */];\nosgGA.getCADManipulatorStandardMouseKeyboardController = function() {\n    return __WEBPACK_IMPORTED_MODULE_2_osgGA_CADManipulatorStandardMouseKeyboardController__["a" /* default */];\n};\nosgGA.getCADManipulatorHammerController = function() {\n    return __WEBPACK_IMPORTED_MODULE_3_osgGA_CADManipulatorHammerController__["a" /* default */];\n};\nosgGA.FirstPersonManipulator = __WEBPACK_IMPORTED_MODULE_4_osgGA_FirstPersonManipulator__["a" /* default */];\nosgGA.getFirstPersonDeviceOrientationController = function() {\n    return __WEBPACK_IMPORTED_MODULE_5_osgGA_FirstPersonManipulatorDeviceOrientationController__["a" /* default */];\n};\nosgGA.getFirstPersonManipulatorHammerController = function() {\n    return __WEBPACK_IMPORTED_MODULE_6_osgGA_FirstPersonManipulatorHammerController__["a" /* default */];\n};\nosgGA.getFirstPersonStandardMouseKeyboardControllerClass = function() {\n    return __WEBPACK_IMPORTED_MODULE_7_osgGA_FirstPersonManipulatorStandardMouseKeyboardController__["a" /* default */];\n};\nosgGA.getFirstPersonWebVRControllerClass = function() {\n    return __WEBPACK_IMPORTED_MODULE_8_osgGA_FirstPersonManipulatorWebVRController__["a" /* default */];\n};\nosgGA.Manipulator = __WEBPACK_IMPORTED_MODULE_9_osgGA_Manipulator__["a" /* default */];\nosgGA.OrbitManipulator = __WEBPACK_IMPORTED_MODULE_10_osgGA_OrbitManipulator__["a" /* default */];\nosgGA.getOrbitManipulatorDeviceOrientationController = function() {\n    return __WEBPACK_IMPORTED_MODULE_11_osgGA_OrbitManipulatorDeviceOrientationController__["a" /* default */];\n};\nosgGA.getOrbitManipulatorGamePadController = function() {\n    return __WEBPACK_IMPORTED_MODULE_12_osgGA_OrbitManipulatorGamePadController__["a" /* default */];\n};\nosgGA.getOrbitManipulatorHammerController = function() {\n    return __WEBPACK_IMPORTED_MODULE_13_osgGA_OrbitManipulatorHammerController__["a" /* default */];\n};\nosgGA.getOrbitManipulatorStandardMouseKeyboardController = function() {\n    return __WEBPACK_IMPORTED_MODULE_14_osgGA_OrbitManipulatorStandardMouseKeyboardController__["a" /* default */];\n};\nosgGA.getOrbitManipulatorWebVRController = function() {\n    return __WEBPACK_IMPORTED_MODULE_15_osgGA_OrbitManipulatorWebVRController__["a" /* default */];\n};\n\nosgGA.SwitchManipulator = __WEBPACK_IMPORTED_MODULE_16_osgGA_SwitchManipulator__["a" /* default */];\n\nosgGA.OrbitManipulator.Rotate = __WEBPACK_IMPORTED_MODULE_17_osgGA_orbitManipulatorEnums__["a" /* default */].ROTATE;\nosgGA.OrbitManipulator.Pan = __WEBPACK_IMPORTED_MODULE_17_osgGA_orbitManipulatorEnums__["a" /* default */].PAN;\nosgGA.OrbitManipulator.Zoom = __WEBPACK_IMPORTED_MODULE_17_osgGA_orbitManipulatorEnums__["a" /* default */].ZOOM;\n\nosgGA.Controller = __WEBPACK_IMPORTED_MODULE_18_osgGA_Controller__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (osgGA);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/osgGA.js\n// module id = 223\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/osgGA.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgGA_Manipulator__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectionVisitor__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgUtil_LineSegmentIntersector__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgUtil_PolytopeIntersector__ = __webpack_require__(139);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_computeMatrixFromNodePath__ = __webpack_require__(48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgGA_CADManipulatorStandardMouseKeyboardController__ = __webpack_require__(141);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgGA_CADManipulatorHammerController__ = __webpack_require__(147);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgUtil_DelayInterpolator__ = __webpack_require__(72);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgUtil_intersectionEnums__ = __webpack_require__(70);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n *  CADManipulator\n *  @class Provides a manipulator with rotation and zoom capacities around a pivot point.\n *  The pivot point is computed through intersections. If no intersection is computed\n *  the manipulator uses the last computed pivot point.\n *  - Mousewheel/Pinch zooms in and out on the pivot point.\n *  - Double click/tap zooms in on the pivot point.\n *  - Left click/pan rotates around the pivot point.\n *  - Center/Right click or two-finger drag moves the view.\n *  - Spacebar resets the view.\n */\n\nvar CADManipulator = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osgGA_Manipulator__["a" /* default */].call(this);\n    this._tmpHomePosition = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n    this._intersectionVisitor = new __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectionVisitor__["a" /* default */]();\n    this._lineSegmentIntersector = new __WEBPACK_IMPORTED_MODULE_3_osgUtil_LineSegmentIntersector__["a" /* default */]();\n    this._polytopeIntersector = undefined;\n    this._usePolytopeIntersector = false;\n    this._primitiveMask = __WEBPACK_IMPORTED_MODULE_10_osgUtil_intersectionEnums__["a" /* default */].ALL_PRIMITIVES;\n    this.init();\n};\n\nCADManipulator.Interpolator = function() {\n    this._current = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n    this._target = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n    this._delta = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n    this._reset = false;\n    this.reset();\n    this._width = undefined;\n    this._height = undefined;\n};\n\nCADManipulator.Interpolator.prototype = {\n    setWidth: function(width) {\n        this._width = width;\n    },\n    setHeight: function(height) {\n        this._height = height;\n    },\n    reset: function() {\n        for (var i = 0, l = this._current.length; i < l; i++) {\n            this._current[i] = this._target[i] = 0;\n        }\n        this._reset = true;\n    },\n    update: function() {\n        var d0;\n        var d1;\n        if (this._width === undefined) d0 = 0;\n        else d0 = (this._target[0] - this._current[0]) / this._width;\n        this._delta[0] = d0;\n        this._current[0] = this._target[0];\n        if (this._height === undefined) d1 = 0;\n        else d1 = (this._target[1] - this._current[1]) / this._height;\n        this._delta[1] = d1;\n        this._current[1] = this._target[1];\n        return this._delta;\n    },\n    set: function() {\n        for (var i = 0, l = this._current.length; i < l; i++) {\n            this._current[i] = this._target[i] = arguments[i];\n        }\n        this._reset = false;\n    },\n    isReset: function() {\n        return this._reset;\n    },\n    getCurrent: function() {\n        return this._current;\n    },\n    setTarget: function() {\n        for (var i = 0, l = this._target.length; i < l; i++) {\n            if (this._reset) {\n                this._target[i] = this._current[i] = arguments[i];\n            } else {\n                this._target[i] = arguments[i];\n            }\n        }\n        this._reset = false;\n    },\n    addTarget: function() {\n        for (var i = 0; i < arguments.length; i++) {\n            this._target[i] += arguments[i];\n        }\n    },\n    getTarget: function() {\n        return this._target;\n    },\n    getDelta: function() {\n        return this._delta;\n    }\n};\n\nCADManipulator.AvailableControllerList = [\'StandardMouseKeyboard\', \'Hammer\'];\nCADManipulator.ControllerList = [\'StandardMouseKeyboard\', \'Hammer\'];\n\n/** @lends CADManipulator.prototype */\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    CADManipulator,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osgGA_Manipulator__["a" /* default */].prototype, {\n        init: function() {\n            this._distance = 25.0;\n            this._target = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            this._upz = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n            this._right = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0);\n\n            __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].init(this._target);\n\n            var rot1 = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].fromRotation(__WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create(), -Math.PI, this._upz);\n            var rot2 = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].fromRotation(__WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create(), Math.PI / 10.0, this._right);\n            this._rotation = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n            __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(this._rotation, rot1, rot2);\n            this._time = 0.0;\n\n            this._rotate = new CADManipulator.Interpolator();\n            this._pan = new CADManipulator.Interpolator();\n            this._zoom = new __WEBPACK_IMPORTED_MODULE_9_osgUtil_DelayInterpolator__["a" /* default */](1);\n\n            this._panFactor = 1.5;\n            this._rotateFactor = 1;\n            this._zoomFactor = 1;\n\n            this._inverseMatrix = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n\n            this._homeEye = undefined;\n            this._homeCenter = undefined;\n            this._homeUp = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n\n            this._orientation = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].create();\n            this._pivotPoint = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n\n            this._eye = undefined;\n\n            this._zoomDir = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n\n            // instance of controller\n            var self = this;\n\n            CADManipulator.ControllerList.forEach(function(value) {\n                if (CADManipulator[value] !== undefined) {\n                    if (self._controllerList[value]) {\n                        self._controllerList[value].init();\n                    } else {\n                        self._controllerList[value] = new CADManipulator[value](self);\n                    }\n                }\n            });\n        },\n\n        setViewer: function(viewer) {\n            this._viewer = viewer;\n        },\n\n        reset: function() {\n            this.init();\n        },\n\n        setNode: function(node) {\n            this._node = node;\n        },\n\n        setPivotPoint: function(pivotPoint) {\n            // First calculate offset\n            __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._pivotPoint, pivotPoint);\n        },\n\n        setTarget: (function() {\n            var eyePos = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            return function(target) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._target, target);\n                this.getEyePosition(eyePos);\n                this._distance = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].distance(target, eyePos);\n            };\n        })(),\n\n        setEyePosition: function(eye) {\n            __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._eye, eye);\n            this._distance = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].distance(this._target, eye);\n        },\n\n        setHomePosition: function(eye, center, up) {\n            this._homeEye = eye;\n            this._homeCenter = center;\n            this._homeUp = up;\n        },\n\n        computeHomePosition: (function() {\n            var f = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var s = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var u = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var result = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n            return function(boundStrategy) {\n                var bs = this.getHomeBoundingSphere(boundStrategy);\n                if (!bs) return;\n                this.setDistance(this.getHomeDistance(bs));\n                this.setTarget(bs.center());\n                this.setPivotPoint(bs.center());\n\n                if (this._homeEye === undefined) {\n                    this._homeEye = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n                    this.getEyePosition(this._homeEye);\n                }\n\n                if (this._homeCenter === undefined) {\n                    this._homeCenter = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n                    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._homeCenter, bs.center());\n                }\n\n                if (this._eye === undefined) {\n                    this._eye = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n                }\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._eye, this._homeEye);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._target, this._homeCenter);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(this._upz, this._homeUp);\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].copy(result, this._rotation);\n                var center = this._target;\n                var eye = this._eye;\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].sub(f, center, eye);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].normalize(f, f);\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].cross(s, f, this._upz);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].normalize(s, s);\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].cross(u, s, f);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].normalize(u, u);\n\n                // s[0], f[0], u[0], 0.0,\n                // s[1], f[1], u[1], 0.0,\n                // s[2], f[2], u[2], 0.0,\n                // 0,    0,    0,     1.0\n                result[0] = s[0];\n                result[1] = u[0];\n                result[2] = -f[0];\n                result[3] = 0.0;\n                result[4] = s[1];\n                result[5] = u[1];\n                result[6] = -f[1];\n                result[7] = 0.0;\n                result[8] = s[2];\n                result[9] = u[2];\n                result[10] = -f[2];\n                result[11] = 0.0;\n                result[12] = 0;\n                result[13] = 0;\n                result[14] = 0;\n                result[15] = 1.0;\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].getRotation(this._orientation, result);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].invert(this._orientation, this._orientation);\n            };\n        })(),\n\n        setZoomFactor: function(f) {\n            this._zoomFactor = f;\n        },\n\n        setRotateFactor: function(f) {\n            this._rotateFactor = f;\n        },\n\n        setPanFactor: function(f) {\n            this._panFactor = f;\n        },\n\n        setDistance: function(d) {\n            this._distance = d;\n        },\n\n        // If set to true, intersections are computed against points and lines\n        setUsePolytopeIntersector: function(upi) {\n            this._usePolytopeIntersector = upi;\n        },\n\n        getUsePolytopeIntersector: function() {\n            return this._usePolytopeIntersector;\n        },\n\n        getDistance: function() {\n            return this._distance;\n        },\n\n        zoom: function(ratio) {\n            this._distance = ratio;\n        },\n\n        getRotateInterpolator: function() {\n            return this._rotate;\n        },\n\n        getPanInterpolator: function() {\n            return this._pan;\n        },\n\n        getZoomInterpolator: function() {\n            return this._zoom;\n        },\n\n        getIntersectionVisitor: function() {\n            return this._intersectionVisitor;\n        },\n\n        getLineSegmentIntersector: function() {\n            return this._lineSegmentIntersector;\n        },\n\n        getOrCreatePolytopeIntersector: function() {\n            if (this._polytopeIntersector === undefined) {\n                this._polytopeIntersector = new __WEBPACK_IMPORTED_MODULE_4_osgUtil_PolytopeIntersector__["a" /* default */]();\n                this._polytopeIntersector.setIntersectionLimit(\n                    __WEBPACK_IMPORTED_MODULE_10_osgUtil_intersectionEnums__["a" /* default */].LIMIT_ONE_PER_DRAWABLE\n                );\n                this._polytopeIntersector.setPrimitiveMask(\n                    __WEBPACK_IMPORTED_MODULE_10_osgUtil_intersectionEnums__["a" /* default */].POINT_PRIMITIVES | __WEBPACK_IMPORTED_MODULE_10_osgUtil_intersectionEnums__["a" /* default */].LINE_PRIMITIVES\n                );\n            }\n            return this._polytopeIntersector;\n        },\n\n        getTarget: function(target) {\n            __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(target, this._target);\n            return target;\n        },\n\n        getEyePosition: function(eye) {\n            if (this._eye === undefined) this.computeEyePosition(this._target, this._distance, eye);\n            else __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].copy(eye, this._eye);\n        },\n\n        computeEyePosition: (function() {\n            var tmpDist = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var tmpInverse = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n            return function(target, distance, eye) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].invert(tmpInverse, this._rotation);\n                tmpDist[1] = distance;\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformMat4(eye, tmpDist, tmpInverse);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].add(eye, target, eye);\n            };\n        })(),\n\n        computePan: (function() {\n            var trans = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var rotPos = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var speedTmp = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            return function(dx, dy, rotMat) {\n                var speed =\n                    __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].length(__WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].sub(speedTmp, this._eye, this._pivotPoint)) / this._panFactor;\n                if (speed < 10) speed = 10;\n                trans[0] = dx * speed / 2;\n                trans[1] = dy * speed / 2;\n                trans[2] = 0;\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformMat4(rotPos, trans, rotMat);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].add(this._eye, this._eye, rotPos);\n            };\n        })(),\n\n        computeZoom: (function() {\n            var vectorDistance = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var speedDist = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            return function(dz) {\n                var zoomSpeed = dz * this._zoomFactor;\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].sub(vectorDistance, this._pivotPoint, this._eye);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].add(this._eye, this._eye, __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].scale(speedDist, vectorDistance, zoomSpeed));\n            };\n        })(),\n\n        computeRotation: (function() {\n            var rightNormalized = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var right = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var dir = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var offset = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var pitchQuat = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].create();\n            var yawQuat = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].create();\n            var pitchyawQuat = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].create();\n            var tmp = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            var rightScalar = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(yawDelta, pitchDelta) {\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformQuat(right, this._right, this._orientation);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].normalize(rightNormalized, right);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].sub(dir, this._eye, this._pivotPoint);\n                var scalar = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].dot(rightNormalized, dir);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].sub(offset, dir, __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].scale(rightScalar, rightNormalized, scalar));\n                var xy = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].fromValues(-offset[0], -offset[1], 0);\n\n                var positionPitch = Math.atan2(-offset[2], __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].length(xy));\n                pitchDelta =\n                    Math.max(\n                        -Math.PI / 2 + 0.01,\n                        Math.min(Math.PI / 2 - 0.01, positionPitch + pitchDelta)\n                    ) - positionPitch;\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].setAxisAngle(pitchQuat, right, pitchDelta * this._rotateFactor);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].setAxisAngle(yawQuat, this._upz, yawDelta * this._rotateFactor);\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].mul(pitchyawQuat, yawQuat, pitchQuat);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformQuat(tmp, dir, pitchyawQuat);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].add(this._eye, tmp, this._pivotPoint);\n\n                // Find rotation offset and target\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].mul(this._orientation, yawQuat, this._orientation);\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformQuat(right, this._right, this._orientation);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].setAxisAngle(pitchQuat, right, pitchDelta * this._rotateFactor);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["d" /* quat */].mul(this._orientation, pitchQuat, this._orientation);\n            };\n        })(),\n\n        update: (function() {\n            var rotMat = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n            var transMat = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].create();\n            return function(nv) {\n                var dt = nv.getFrameStamp().getDeltaTime();\n\n                var mouseFactor = 10;\n                //Note inverted y\n                var delta = this._rotate.update();\n                this.computeRotation(-delta[0] * mouseFactor, delta[1] * mouseFactor);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].fromQuat(rotMat, this._orientation);\n\n                var deltapan = this._pan.update();\n                this.computePan(-deltapan[0] * mouseFactor, -deltapan[1] * mouseFactor, rotMat);\n\n                delta = this._zoom.update(dt);\n                this.computeZoom(-delta[0] / 10.0);\n\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].fromTranslation(transMat, this._eye);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].mul(this._inverseMatrix, transMat, rotMat);\n                __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["c" /* mat4 */].invert(this._inverseMatrix, this._inverseMatrix);\n            };\n        })(),\n        getInverseMatrix: function() {\n            return this._inverseMatrix;\n        },\n\n        computeIntersections: (function() {\n            var hits = [];\n            var pTrans = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].create();\n            return function(pos) {\n                var viewer = this._camera.getView();\n\n                var cam = this._camera;\n                var width = cam.getViewport().width();\n                var height = cam.getViewport().height();\n                this._rotate.setWidth(width);\n                this._rotate.setHeight(height);\n                this._pan.setWidth(width);\n                this._pan.setHeight(height);\n\n                var point, matrix;\n                if ((this._primitiveMask & __WEBPACK_IMPORTED_MODULE_10_osgUtil_intersectionEnums__["a" /* default */].TRIANGLE_PRIMITIVES) !== 0) {\n                    hits = viewer.computeIntersections(pos[0], pos[1]);\n\n                    if (hits.length > 0) {\n                        point = hits[0]._localIntersectionPoint;\n                        hits[0]._nodePath.shift();\n                        matrix = __WEBPACK_IMPORTED_MODULE_5_osg_computeMatrixFromNodePath__["a" /* default */].computeLocalToWorld(hits[0]._nodePath);\n                        __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformMat4(pTrans, point, matrix);\n                        this.setPivotPoint(pTrans);\n                    }\n                }\n\n                if (hits.length === 0 && this._usePolytopeIntersector) {\n                    var pi = this.getOrCreatePolytopeIntersector();\n                    pi.reset();\n                    pi.setPolytopeFromWindowCoordinates(\n                        pos[0] - 5,\n                        pos[1] - 5,\n                        pos[0] + 5,\n                        pos[1] + 5\n                    );\n                    var iv = this._intersectionVisitor;\n                    iv.setIntersector(pi);\n                    viewer.getCamera().accept(iv);\n                    hits = pi.getIntersections();\n                    hits.sort(function(a, b) {\n                        return a._distance - b._distance;\n                    });\n                    if (hits.length > 0) {\n                        point = hits[0]._localIntersectionPoint;\n                        hits[0]._nodePath.shift();\n                        matrix = __WEBPACK_IMPORTED_MODULE_5_osg_computeMatrixFromNodePath__["a" /* default */].computeLocalToWorld(hits[0]._nodePath);\n                        __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["f" /* vec3 */].transformMat4(pTrans, point, matrix);\n                        this.setPivotPoint(pTrans);\n                    }\n                }\n            };\n        })(),\n\n        getPositionRelativeToCanvas: (function() {\n            var offset = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n            var pos = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n            return function(x, y) {\n                var canvas = this._camera._graphicContext.canvas;\n                this.getOffsetRect(canvas, offset);\n                var ratioX = canvas.width / canvas.clientWidth;\n                var ratioY = canvas.height / canvas.clientHeight;\n                pos[0] = (x - offset[1]) * ratioX;\n                pos[1] = (canvas.clientHeight - (y - offset[0])) * ratioY;\n                return pos;\n            };\n        })(),\n\n        getCanvasCenter: (function() {\n            var offset = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n            var pos = __WEBPACK_IMPORTED_MODULE_6_osg_glMatrix__["e" /* vec2 */].create();\n            return function() {\n                var canvas = this._camera.getGraphicContext().canvas;\n                this.getOffsetRect(canvas, offset);\n                var ratioX = canvas.width / canvas.clientWidth;\n                var ratioY = canvas.height / canvas.clientHeight;\n                pos[0] = canvas.clientWidth / 2 * ratioX;\n                pos[1] = canvas.clientHeight / 2 * ratioY;\n                return pos;\n            };\n        })(),\n\n        getOffsetRect: function(elem, offset) {\n            var box = elem.getBoundingClientRect();\n            var body = document.body;\n            var docElem = document.documentElement;\n            var scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n            var scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n            var clientTop = docElem.clientTop || body.clientTop || 0;\n            var clientLeft = docElem.clientLeft || body.clientLeft || 0;\n            var top = box.top + scrollTop - clientTop;\n            var left = box.left + scrollLeft - clientLeft;\n            offset[0] = Math.round(top);\n            offset[1] = Math.round(left);\n            return offset;\n        }\n    }),\n    \'osgGA\',\n    \'CADManipulator\'\n);\n\nCADManipulator.StandardMouseKeyboard = __WEBPACK_IMPORTED_MODULE_7_osgGA_CADManipulatorStandardMouseKeyboardController__["a" /* default */];\nCADManipulator.Hammer = __WEBPACK_IMPORTED_MODULE_8_osgGA_CADManipulatorHammerController__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (CADManipulator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/CADManipulator.js\n// module id = 224\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/CADManipulator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgGA_Manipulator__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgGA_FirstPersonManipulatorDeviceOrientationController__ = __webpack_require__(91);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgGA_FirstPersonManipulatorHammerController__ = __webpack_require__(148);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgGA_FirstPersonManipulatorWebVRController__ = __webpack_require__(149);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgGA_FirstPersonManipulatorStandardMouseKeyboardController__ = __webpack_require__(150);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgUtil_DelayInterpolator__ = __webpack_require__(72);\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * Authors:\n *  Matt Fontaine <tehqin@gmail.com>\n *  Cedric Pinson <trigrou@gmail.com>\n */\n\n/**\n *  FirstPersonManipulator\n *  @class\n */\nvar FirstPersonManipulator = function(boundStrategy) {\n    __WEBPACK_IMPORTED_MODULE_1_osgGA_Manipulator__["a" /* default */].call(this, boundStrategy);\n    this.init();\n};\n\nFirstPersonManipulator.AvailableControllerList = [\n    \'StandardMouseKeyboard\',\n    \'WebVR\',\n    \'DeviceOrientation\',\n    \'Hammer\'\n];\nFirstPersonManipulator.ControllerList = [\n    \'StandardMouseKeyboard\',\n    \'WebVR\',\n    \'DeviceOrientation\',\n    \'Hammer\'\n];\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    FirstPersonManipulator,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osgGA_Manipulator__["a" /* default */].prototype, {\n        computeHomePosition: function(boundStrategy) {\n            var bs = this.getHomeBoundingSphere(boundStrategy);\n            if (!bs || !bs.valid()) return;\n\n            this._distance = this.getHomeDistance(bs);\n            var cen = bs.center();\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].scale(this._eye, this._direction, -this._distance);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(this._eye, cen, this._eye);\n            this.setTarget(cen);\n        },\n\n        init: function() {\n            this._direction = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0);\n            this._eye = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 25.0, 10.0);\n            this._up = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n            this._distance = 1.0;\n            this._forward = new __WEBPACK_IMPORTED_MODULE_7_osgUtil_DelayInterpolator__["a" /* default */](1);\n            this._side = new __WEBPACK_IMPORTED_MODULE_7_osgUtil_DelayInterpolator__["a" /* default */](1);\n            this._lookPosition = new __WEBPACK_IMPORTED_MODULE_7_osgUtil_DelayInterpolator__["a" /* default */](2);\n\n            // direct pan interpolator (not based on auto-move)\n            this._pan = new __WEBPACK_IMPORTED_MODULE_7_osgUtil_DelayInterpolator__["a" /* default */](2);\n            this._zoom = new __WEBPACK_IMPORTED_MODULE_7_osgUtil_DelayInterpolator__["a" /* default */](1);\n\n            this._stepFactor = 1.0; // meaning radius*stepFactor to move\n            this._angleVertical = 0.0;\n            this._angleHorizontal = 0.0;\n\n            // tmp value use for computation\n            this._tmpGetTargetDir = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n\n            // vr controls\n            this._vrEnable = false;\n            this._vrRot = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].create(); // absolute orientation\n            this._vrPos = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create(); // absolute position\n            this._vrTrans = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create(); // delta translation since last update\n\n            var self = this;\n\n            this._controllerList = {};\n            FirstPersonManipulator.ControllerList.forEach(function(value) {\n                if (FirstPersonManipulator[value] !== undefined) {\n                    if (self._controllerList[value]) {\n                        self._controllerList[value].init();\n                    } else {\n                        self._controllerList[value] = new FirstPersonManipulator[value](self);\n                    }\n                }\n            });\n        },\n\n        setDelay: function(dt) {\n            this._forward.setDelay(dt);\n            this._side.setDelay(dt);\n            this._lookPosition.setDelay(dt);\n            this._pan.setDelay(dt);\n            this._zoom.setDelay(dt);\n        },\n\n        getEyePosition: function(eye) {\n            eye[0] = this._eye[0];\n            eye[1] = this._eye[1];\n            eye[2] = this._eye[2];\n            return eye;\n        },\n\n        setEyePosition: function(eye) {\n            this._eye[0] = eye[0];\n            this._eye[1] = eye[1];\n            this._eye[2] = eye[2];\n            return this;\n        },\n\n        getTarget: function(pos) {\n            var dir = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].scale(this._tmpGetTargetDir, this._direction, this._distance);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(pos, this._eye, dir);\n            return pos;\n        },\n\n        setTarget: function(pos) {\n            var dir = this._tmpGetTargetDir;\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].sub(dir, pos, this._eye);\n            dir[2] = 0.0;\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(dir, dir);\n            this._angleHorizontal = Math.acos(dir[1]);\n            if (dir[0] < 0.0) {\n                this._angleHorizontal = -this._angleHorizontal;\n            }\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].sub(dir, pos, this._eye);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(dir, dir);\n\n            this._angleVertical = -Math.asin(dir[2]);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._direction, dir);\n        },\n\n        getLookPositionInterpolator: function() {\n            return this._lookPosition;\n        },\n        getSideInterpolator: function() {\n            return this._side;\n        },\n        getForwardInterpolator: function() {\n            return this._forward;\n        },\n        getPanInterpolator: function() {\n            return this._pan;\n        },\n        getZoomInterpolator: function() {\n            return this._zoom;\n        },\n        getRotateInterpolator: function() {\n            // for compatibility with orbit hammer controllers\n            return this._lookPosition;\n        },\n\n        computeRotation: (function() {\n            var first = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n            var rotMat = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n\n            var right = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0);\n            var upy = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0);\n            var upz = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n            var LIMIT = Math.PI * 0.5;\n            return function(dx, dy) {\n                this._angleVertical += dy * 0.01;\n                this._angleHorizontal -= dx * 0.01;\n                if (this._angleVertical > LIMIT) this._angleVertical = LIMIT;\n                else if (this._angleVertical < -LIMIT) this._angleVertical = -LIMIT;\n\n                if (this._vrEnable) {\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].transformQuat(this._direction, upy, this._vrRot);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(this._direction, this._direction);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].transformQuat(this._up, upz, this._vrRot);\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromRotation(first, -this._angleVertical, right);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromRotation(rotMat, -this._angleHorizontal, upz);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(rotMat, rotMat, first);\n\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].transformMat4(this._direction, upy, rotMat);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(this._direction, this._direction);\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].transformMat4(this._up, upz, rotMat);\n                }\n            };\n        })(),\n        reset: function() {\n            this.init();\n        },\n        setDistance: function(d) {\n            this._distance = d;\n        },\n        getDistance: function() {\n            return this._distance;\n        },\n        setStepFactor: function(t) {\n            this._stepFactor = t;\n        },\n\n        computePosition: (function() {\n            var vec = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].create();\n\n            return function(dt) {\n                this._forward.update(dt);\n                this._side.update(dt);\n\n                // TDOO why check with epsilon ?\n                var factor = this._distance < 1e-3 ? 1e-3 : this._distance;\n\n                // see comment in orbitManipulator for fov modulation speed\n                var proj = this._camera.getProjectionMatrix();\n                var vFov = proj[15] === 1 ? 1.0 : 2.0 / proj[5];\n\n                // time based displacement vector\n                vec[0] = this._forward.getCurrent()[0];\n                vec[1] = this._side.getCurrent()[0];\n                var len2 = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].sqrLen(vec);\n                if (len2 > 1.0) __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].scale(vec, vec, 1.0 / Math.sqrt(len2));\n\n                // direct displacement vectors\n                var pan = this._pan.update(dt);\n                var zoom = this._zoom.update(dt);\n\n                var timeFactor = this._stepFactor * factor * vFov * dt;\n                var directFactor = this._stepFactor * factor * vFov * 0.005;\n\n                this.moveForward(vec[0] * timeFactor - zoom[0] * directFactor * 20.0);\n                this.strafe(vec[1] * timeFactor - pan[0] * directFactor);\n                this.strafeVertical(-pan[1] * directFactor);\n\n                if (this._vrEnable) {\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(this._eye, this._eye, this._vrTrans);\n                    // in case setPoseVR skips some frame (possible if tracking is lost temporarily)\n                    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].init(this._vrTrans);\n                }\n            };\n        })(),\n\n        update: (function() {\n            var tmpTarget = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(nv) {\n                var dt = nv.getFrameStamp().getDeltaTime();\n\n                var delta = this._lookPosition.update(dt);\n                this.computeRotation(-delta[0] * 0.5, -delta[1] * 0.5);\n                this.computePosition(dt);\n\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(tmpTarget, this._eye, this._direction);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].lookAt(this._inverseMatrix, this._eye, tmpTarget, this._up);\n\n                this._vrEnable = false; // setPoseVR is called on each frame\n            };\n        })(),\n\n        setPoseVR: function(q, pos) {\n            this._vrEnable = true;\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["d" /* quat */].copy(this._vrRot, q);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].sub(this._vrTrans, pos, this._vrPos);\n            __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].copy(this._vrPos, pos);\n        },\n\n        moveForward: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n            return function(distance) {\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(tmp, this._direction);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].scale(tmp, tmp, distance);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(this._eye, this._eye, tmp);\n            };\n        })(),\n\n        strafe: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n            return function(distance) {\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].cross(tmp, this._direction, this._up);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(tmp, tmp);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].scale(tmp, tmp, distance);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(this._eye, this._eye, tmp);\n            };\n        })(),\n\n        strafeVertical: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].create();\n            return function(distance) {\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].normalize(tmp, this._up);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].scale(tmp, tmp, distance);\n                __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].add(this._eye, this._eye, tmp);\n            };\n        })()\n    }),\n    \'osgGA\',\n    \'FirstPersonManipulator\'\n);\n\nFirstPersonManipulator.DeviceOrientation = __WEBPACK_IMPORTED_MODULE_3_osgGA_FirstPersonManipulatorDeviceOrientationController__["a" /* default */];\nFirstPersonManipulator.Hammer = __WEBPACK_IMPORTED_MODULE_4_osgGA_FirstPersonManipulatorHammerController__["a" /* default */];\nFirstPersonManipulator.WebVR = __WEBPACK_IMPORTED_MODULE_5_osgGA_FirstPersonManipulatorWebVRController__["a" /* default */];\nFirstPersonManipulator.StandardMouseKeyboard = __WEBPACK_IMPORTED_MODULE_6_osgGA_FirstPersonManipulatorStandardMouseKeyboardController__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (FirstPersonManipulator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/FirstPersonManipulator.js\n// module id = 225\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/FirstPersonManipulator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\n/**\n *  OrbitManipulator\n *  @class\n */\nvar SwitchManipulator = function() {\n    this._manipulatorList = [];\n    this._currentManipulator = undefined;\n};\n\n/** @lends SwitchManipulator.prototype */\nSwitchManipulator.prototype = {\n    getCamera: function() {\n        return this.getCurrentManipulator().getCamera();\n    },\n    setCamera: function(cam) {\n        var cbList = this.getManipulatorList();\n        for (var i = 0, nb = cbList.length; i < nb; ++i) cbList[i].setCamera(cam);\n    },\n    update: function(nv) {\n        var manipulator = this.getCurrentManipulator();\n        if (manipulator !== undefined) {\n            return manipulator.update(nv);\n        }\n        return undefined;\n    },\n    getNode: function() {\n        // we should add an accessor in the osgjs manipulator\n        return this.getCurrentManipulator()._node;\n    },\n    setNode: function(node) {\n        var cbList = this.getManipulatorList();\n        for (var i = 0, nb = cbList.length; i < nb; ++i) cbList[i].setNode(node);\n    },\n    getControllerList: function() {\n        return this.getCurrentManipulator().getControllerList();\n    },\n    getNumManipulator: function() {\n        return this._manipulatorList.length;\n    },\n    addManipulator: function(manipulator) {\n        this._manipulatorList.push(manipulator);\n        if (this._currentManipulator === undefined) {\n            this.setManipulatorIndex(0);\n        }\n    },\n    getManipulatorList: function() {\n        return this._manipulatorList;\n    },\n    setManipulatorIndex: function(index) {\n        this._currentManipulator = index;\n    },\n    getCurrentManipulatorIndex: function() {\n        return this._currentManipulator;\n    },\n    getCurrentManipulator: function() {\n        return this._manipulatorList[this._currentManipulator];\n    },\n    reset: function() {\n        this.getCurrentManipulator().reset();\n    },\n    computeHomePosition: function(useBoundingBox) {\n        var manipulator = this.getCurrentManipulator();\n        if (manipulator !== undefined) {\n            manipulator.computeHomePosition(useBoundingBox);\n        }\n    },\n    getInverseMatrix: function() {\n        var manipulator = this.getCurrentManipulator();\n        if (manipulator !== undefined) {\n            return manipulator.getInverseMatrix();\n        }\n    },\n    getHomeBound: function(boundStrategy) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'Please use getHomeBoundingSphere instead\');\n        return this.getHomeBoundingSphere(boundStrategy);\n    },\n    getHomeBoundingSphere: function(boundStrategy) {\n        return this.getCurrentManipulator().getHomeBoundingSphere(boundStrategy);\n    },\n    getHomeDistance: function(bs) {\n        return this.getCurrentManipulator().getHomeDistance(bs);\n    }\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (SwitchManipulator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgGA/SwitchManipulator.js\n// module id = 226\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgGA/SwitchManipulator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgUtil_ComposerPostProcess__ = __webpack_require__(228);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgUtil_debug__ = __webpack_require__(151);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_DelayInterpolator__ = __webpack_require__(72);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgUtil_DisplayNormalVisitor__ = __webpack_require__(152);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgUtil_DisplayGeometryVisitor__ = __webpack_require__(156);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgUtil_DisplayGraph__ = __webpack_require__(95);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgUtil_IntersectFunctor__ = __webpack_require__(71);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgUtil_Intersector__ = __webpack_require__(69);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgUtil_IntersectionVisitor__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgUtil_LineSegmentIntersector__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgUtil_LineSegmentIntersectFunctor__ = __webpack_require__(138);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgUtil_NodeGizmo__ = __webpack_require__(236);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osgUtil_gizmoGeometry__ = __webpack_require__(159);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgUtil_PolytopeIntersector__ = __webpack_require__(139);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osgUtil_PolytopeIntersectFunctor__ = __webpack_require__(140);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osgUtil_SphereIntersector__ = __webpack_require__(237);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osgUtil_TangentSpaceGenerator__ = __webpack_require__(239);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osgUtil_WebVRCustom__ = __webpack_require__(240);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osgUtil_WebVR__ = __webpack_require__(241);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__ = __webpack_require__(70);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar osgUtil = {};\n\nosgUtil.ComposerPostProcess = __WEBPACK_IMPORTED_MODULE_0_osgUtil_ComposerPostProcess__["a" /* default */];\n__WEBPACK_IMPORTED_MODULE_11_osg_utils__["a" /* default */].objectMix(osgUtil, __WEBPACK_IMPORTED_MODULE_1_osgUtil_debug__["a" /* default */]);\nosgUtil.DelayInterpolator = __WEBPACK_IMPORTED_MODULE_2_osgUtil_DelayInterpolator__["a" /* default */];\nosgUtil.DisplayNormalVisitor = __WEBPACK_IMPORTED_MODULE_3_osgUtil_DisplayNormalVisitor__["a" /* default */];\nosgUtil.DisplayGeometryVisitor = __WEBPACK_IMPORTED_MODULE_4_osgUtil_DisplayGeometryVisitor__["a" /* default */];\nosgUtil.DisplayGraph = __WEBPACK_IMPORTED_MODULE_5_osgUtil_DisplayGraph__["a" /* default */];\nosgUtil.IntersectFunctor = __WEBPACK_IMPORTED_MODULE_6_osgUtil_IntersectFunctor__["a" /* default */];\nosgUtil.Intersector = __WEBPACK_IMPORTED_MODULE_7_osgUtil_Intersector__["a" /* default */];\nosgUtil.IntersectionVisitor = __WEBPACK_IMPORTED_MODULE_8_osgUtil_IntersectionVisitor__["a" /* default */];\nosgUtil.LineSegmentIntersector = __WEBPACK_IMPORTED_MODULE_9_osgUtil_LineSegmentIntersector__["a" /* default */];\nosgUtil.LineSegmentIntersectFunctor = __WEBPACK_IMPORTED_MODULE_10_osgUtil_LineSegmentIntersectFunctor__["a" /* default */];\nosgUtil.NodeGizmo = __WEBPACK_IMPORTED_MODULE_12_osgUtil_NodeGizmo__["a" /* default */];\nosgUtil.GizmoGeometry = __WEBPACK_IMPORTED_MODULE_13_osgUtil_gizmoGeometry__["a" /* default */];\nosgUtil.WebVRCustom = __WEBPACK_IMPORTED_MODULE_18_osgUtil_WebVRCustom__["a" /* default */];\nosgUtil.PolytopeIntersector = __WEBPACK_IMPORTED_MODULE_14_osgUtil_PolytopeIntersector__["a" /* default */];\nosgUtil.PolytopeIntersectFunctor = __WEBPACK_IMPORTED_MODULE_15_osgUtil_PolytopeIntersectFunctor__["a" /* default */];\nosgUtil.SphereIntersector = __WEBPACK_IMPORTED_MODULE_16_osgUtil_SphereIntersector__["a" /* default */];\nosgUtil.TangentSpaceGenerator = __WEBPACK_IMPORTED_MODULE_17_osgUtil_TangentSpaceGenerator__["a" /* default */];\nosgUtil.WebVR = __WEBPACK_IMPORTED_MODULE_19_osgUtil_WebVR__["a" /* default */];\n\nosgUtil.NO_LIMIT = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].NO_LIMIT;\nosgUtil.LIMIT_ONE_PER_DRAWABLE = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].LIMIT_ONE_PER_DRAWABLE;\nosgUtil.LIMIT_ONE = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].LIMIT_ONE;\n\nosgUtil.POINT_PRIMITIVES = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].POINT_PRIMITIVES;\nosgUtil.LINE_PRIMITIVES = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].LINE_PRIMITIVES;\nosgUtil.TRIANGLE_PRIMITIVES = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].TRIANGLE_PRIMITIVES;\nosgUtil.ALL_PRIMITIVES = __WEBPACK_IMPORTED_MODULE_20_osgUtil_intersectionEnums__["a" /* default */].ALL_PRIMITIVES;\n\n/* harmony default export */ __webpack_exports__["a"] = (osgUtil);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/osgUtil.js\n// module id = 227\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/osgUtil.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_CullFace__ = __webpack_require__(50);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Viewport__ = __webpack_require__(39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osgShader_ShaderProcessor__ = __webpack_require__(64);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*\nThis class creates a post-processing pipeline based on an user-defined list of passes and .glsl files.\nThe user can thus easily change the order or the passes without having to do the usual stuff: creating cameras, stateSets, bind textures, etc.\n\n======================\n=== simple example ===\n======================\n\nvar composer = new ComposerPostProcess();\ncomposer.setScreenSize( width, height );\n\ncomposer.addInternalTexture({\n    name: 'color',\n    immuable: true // the texture object won't change and can be safely used with getInternalTexture\n});\n\n// the first %last will be an alias to this texture\ncomposer.setInputTexture( 'color' );\n\nvar passes = [];\npasses.push({\n    func: { name: 'func', file: 'file.glsl' },\n\n    // %last and %next can be seen as stack operators, each %next pushes a texture on the stack while %last takes the top of the stack\n    // it allows more flexibility when the user want to change the order of the passes withoug having to change the inputs/outputs/filtering/colorspaces of the other passes\n    // it is also better for performances in some cases because it allows the composer to collapse passes in one pass\n    textures: [ '%last' ],\n    uniforms: [ Uniform.createFloat( 3.8, 'factor' ) ],\n    out: { name: '%next' }\n});\n\ncomposer.build( passes );\n\nvar color = composer.getInternalTexture( 'color' );\n\n========================\n=== advanced example ===\n========================\n\nvar composer = new ComposerPostProcess();\ncomposer.setScreenSize( width, height );\n\ncomposer.addInternalTexture({\n    name: 'color',\n    immuable: true // immuable is used\n});\n\ncomposer.addInternalTexture({\n    name: 'depth',\n    reusable: false // besides beeing immuable, the texture won't be reused by other passes, can be useful when the texture is needed after post-processing\n});\n\npasses.push({\n    func: 'func', // will deduce the file func.glsl'\n    textures: [ { name: '%last', filter: 'linear' }, 'color' ], // for some reasons, we want to sample that texture in linear\n    out: { name: 'pass1', divisor: 2.0 } // we want to render this pass into an half-res texture\n    collapsible: false // we don't want this pass to be collapsed into the last pass\n});\n\npasses.push({\n    func: 'func2',\n    header: [ '#define NUM_SAMPLES 10', '#extension GL_EXTENSION_NAME : require' ],\n\n    // %previous is a special predefined value, it will transform the pass into a feedback loop, all is needed now is to swap the textures every frames using:\n    // composer.swapFeedbackLoopTextures( boolean )\n    texture: [ 'color', '%previous' ],\n    out: { name: '%next' }\n})\n\npasses.push({\n    func: 'func3',\n    texture: [ 'pass1', '%last', { name: 'pass2', uniformName: '', srgb: true, rgbm: false } ], // force srgb and rgbm, composer won't override this\n    out: { name: %next', filter: 'linear' } // force the linear filter, composer won't override this\n    // this pass should be collapsed into the last one, collapsible defaults to false\n    collapsible: true\n})\n\n// these uniforms will be passed to every shaders created by the composer\ncomposer.setGlobalUniforms( [ uniformTime ] );\n\nvar color = composer.getInternalTexture( 'color' );\nvar depth = composer.getInternalTexture( 'depth' );\n\n*/\n\nvar ComposerPostProcess = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_Node__[\"a\" /* default */].call(this);\n\n    // stuffs for syncing feedback texture uniforms\n    this._feedbackSwapped = false; // called on feedack swap\n    this._syncFeedbackUniforms = false; // called on resize\n    this._syncOnNextFrame = false;\n    this._lastXratio = 1;\n    this._lastYratio = 1;\n\n    // partial viewport and drs (dynamic resolution scaling)\n    this._xViewportRatio = 1.0;\n    this._yViewportRatio = 1.0;\n    this._xTextureRatio = 1.0;\n    this._yTextureRatio = 1.0;\n    // in case of dynamic resolution scaling : true will do a final upsampling\n    // to full viewport size\n    this._finalPassUpScaleToScreen = true;\n    // wrap uv stuffs\n    this._methodWrapUV = 0;\n    this._thresholdWrapUV = 1.0;\n    this._texInfos = undefined;\n\n    this._screenWidth = this._screenHeight = 0;\n\n    this._shaderProcessor = Object(__WEBPACK_IMPORTED_MODULE_14_osgShader_ShaderProcessor__[\"a\" /* default */])();\n\n    this._feedbackData = {};\n\n    this._cameras = [];\n    this._stateSets = [];\n    this._textureUniforms = [];\n\n    this._programs = {};\n\n    this._externalTextures = {};\n    this._internalPasses = [];\n    this._textures = {};\n\n    this._userTextures = {};\n\n    this._currentPoolIndex = 0;\n    this._texturePool = {};\n\n    this._firstTexture = '';\n\n    var stateSet = this.getOrCreateStateSet();\n    stateSet.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_3_osg_Depth__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_Depth__[\"a\" /* default */].DISABLE));\n    stateSet.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_2_osg_CullFace__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_2_osg_CullFace__[\"a\" /* default */].BACK));\n\n    this.setCullCallback(this);\n};\n\nComposerPostProcess.VertexShader = [\n    'attribute vec3 Vertex;',\n    'void main(void) {',\n    '  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);',\n    '}',\n    '',\n    '#define SHADER_NAME %name%',\n    ''\n].join('\\n');\n\nComposerPostProcess.FragmentShader = [\n    '#ifdef GL_FRAGMENT_PRECISION_HIGH\\n precision highp float;\\n#else\\n precision mediump float;\\n#endif',\n    'uniform float uRGBMRange;',\n    'vec2 gTexCoord;',\n    '%uniforms%',\n    '',\n    '#pragma include \"functions.glsl\"',\n    '',\n    '%header%',\n    '',\n    '%texturesColorSpace%',\n    '',\n    '%functionBodies%',\n    '',\n    'void main() {',\n    '\\tgTexCoord = gl_FragCoord.xy / uTextureOutputSize.xy;',\n    '\\tvec4 color = %firstFunc%(%firstArg%);',\n    '%optionalFuncs%',\n    '%colorSpaces%',\n    '\\tgl_FragColor = color;',\n    '}',\n    '',\n    '#define SHADER_NAME %name%',\n    ''\n].join('\\n');\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    ComposerPostProcess,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_Node__[\"a\" /* default */].prototype, {\n        clear: function() {\n            this._textures = {};\n            this._internalPasses.length = 0;\n\n            this._firstTexture = '';\n\n            for (var tex in this._texturePool) {\n                this._texturePool[tex].usage = -1;\n            }\n\n            this._feedbackData = {};\n\n            this._cameras.length = 0;\n            this._stateSets.length = 0;\n            this._textureUniforms.length = 0;\n\n            this.removeChildren();\n        },\n\n        clearShaderCache: function() {\n            this._programs = {};\n        },\n\n        getGlobalXRatio: function() {\n            return this._xViewportRatio * this._xTextureRatio;\n        },\n\n        getGlobalYRatio: function() {\n            return this._yViewportRatio * this._yTextureRatio;\n        },\n\n        setFinalPassUpScaleToScreen: function(bool) {\n            this._finalPassUpScaleToScreen = bool;\n        },\n\n        _enforceFromInputParameter: function(paramName, inputTexture) {\n            var texName = inputTexture.name;\n            var prevTexture = this._textures[texName];\n            var prevFeedbackTexture = this._textures[texName + 'FeedbackTexture'];\n\n            var newParam = inputTexture[paramName];\n            if (newParam === undefined) {\n                return;\n            }\n\n            // check possible mismatch\n            if (prevTexture[paramName] !== undefined) {\n                if (prevTexture[paramName] !== newParam) {\n                    console.error('Mismatch on parameter ' + paramName + ' : ' + texName);\n                }\n            }\n\n            prevTexture[paramName] = newParam;\n            if (prevFeedbackTexture) {\n                prevFeedbackTexture[paramName] = newParam;\n            }\n        },\n\n        _updatePassInfoFromInputs: function(pass, passName, lastPassInfo) {\n            var outTexture = this._textures[passName];\n\n            var lastPassSrgb = lastPassInfo.srgb;\n\n            // reset\n            lastPassInfo.srgb = undefined;\n\n            for (var i = 0; i < pass.textures.length; i++) {\n                var inputTexture = pass.textures[i];\n                this._renameTextureAlias(inputTexture, passName, lastPassInfo.name);\n\n                var texInfoName = inputTexture.name;\n                if (this._externalTextures[texInfoName]) {\n                    continue;\n                }\n\n                this._usages[texInfoName] = (this._usages[texInfoName] || 0) + 1;\n\n                var requestSrgb = inputTexture.srgb;\n\n                // copy user inputs\n                this._enforceFromInputParameter('filter', inputTexture);\n                this._enforceFromInputParameter('rgbm', inputTexture);\n                this._enforceFromInputParameter('srgb', inputTexture);\n\n                // notify a texture to be encoded in srgb if previous pass was in linear\n                var texture = this._textures[texInfoName];\n                if (!texture) {\n                    var orig = texInfoName.substring(0, texInfoName.indexOf('FeedbackTexture'));\n                    texture = this._textures[orig];\n                }\n\n                if (lastPassSrgb !== undefined && requestSrgb !== undefined) {\n                    if (lastPassSrgb !== requestSrgb) {\n                        texture.encodeSRGB = true;\n                    }\n                }\n\n                this._setInferredParameter('rgbmInferred', 'rgbm', outTexture, texture);\n                this._setInferredParameter('srgbInferred', 'srgb', outTexture, texture);\n            }\n\n            if (lastPassInfo.srgb === undefined) {\n                lastPassInfo.srgb =\n                    outTexture.srgb === undefined ? outTexture.srgbInferred : outTexture.srgb;\n            }\n        },\n\n        _setInferredParameter: function(paramInfer, param, dest, src) {\n            if (dest[paramInfer] === undefined) {\n                dest[paramInfer] = src[param] === undefined ? src[paramInfer] : src[param];\n            }\n        },\n\n        _createTextureOut: function(pass, passName, isLastPass) {\n            var outTexture = {\n                srgb: pass.out.srgb,\n                rgbm: pass.out.rgbm,\n                filter: pass.out.filter,\n                type: pass.out.type\n            };\n\n            // enforce : not rgbm if we are in float\n            var isFloat = pass.out.type !== __WEBPACK_IMPORTED_MODULE_4_osg_Texture__[\"default\"].UNSIGNED_BYTE;\n            if (outTexture.rgbm === undefined && (isLastPass || isFloat)) {\n                outTexture.rgbm = false;\n            }\n\n            // enforce : linear space if we have rgbm or float texture\n            if (outTexture.srgb === undefined) {\n                if (isLastPass) outTexture.srgb = true;\n                else if (outTexture.rgbm || isFloat) outTexture.srgb = false;\n            }\n\n            return outTexture;\n        },\n\n        _processUserPasses: function(userPasses) {\n            userPasses = this._internalPasses.concat(userPasses);\n            var passes = this._preprocessUserPasses(userPasses);\n\n            var numPasses = passes.length;\n\n            var outPasses = [];\n\n            var lastPassInfo = {\n                name: this._firstTexture,\n                srgb: undefined\n            };\n\n            var duplicateNames = {};\n\n            for (var i = 0; i < numPasses; i++) {\n                var pass = passes[i];\n\n                var isLastPass = i === numPasses - 1;\n                if (!isLastPass && this._collapsePasses(pass, passes[i + 1])) {\n                    passes.splice(i + 1, 1);\n                    numPasses--;\n                    i--;\n\n                    continue;\n                }\n\n                var passName = pass.out.name;\n                var isNext = passName === '%next';\n\n                if (isNext) {\n                    passName = pass.funcs.join('_');\n\n                    if (duplicateNames[passName]) {\n                        passName += duplicateNames[passName]++;\n                    } else {\n                        duplicateNames[passName] = 1;\n                    }\n                }\n\n                // create textures\n                var outTexture = this._createTextureOut(pass, passName, isLastPass);\n                this._textures[passName] = outTexture;\n\n                this._updatePassInfoFromInputs(pass, passName, lastPassInfo);\n\n                // feedback texture share same parameters\n                if (pass.feedbackLoop) {\n                    this._textures[passName + 'FeedbackTexture'] = {\n                        srgb: outTexture.srgb,\n                        rgbm: outTexture.rgbm,\n                        srgbInferred: outTexture.srgbInferred,\n                        rgbmInferred: outTexture.rgbmInferred,\n                        filter: outTexture.filter\n                    };\n                }\n\n                if (isNext) {\n                    lastPassInfo.name = passName;\n                    pass.out.name = passName;\n                }\n\n                outPasses.push(pass);\n            }\n\n            return outPasses;\n        },\n\n        // the number of textures needed by the post-processing stack can be deduced using the user data\n        // each texture has an unique name from which an usage number is computed\n        // each time a texture is sampled, the usage is decremented\n        // when is reaches 0 it means that the texture won't be used anymore so it can be reused\n        // besides the usage number, the divisor, internal type and the filtering of the texture are used to make sure it can safely be reused\n        _hasFreeTexture: function(passName, filter, out) {\n            // passName that directly matches a texture name\n            if (passName === out.name && this._texturePool[passName]) {\n                return passName;\n            }\n\n            if (out.immuable) {\n                return;\n            }\n\n            for (var key in this._texturePool) {\n                var poolTexture = this._texturePool[key];\n\n                // not reusable (could be used after postprocess)\n                if (!poolTexture.reusable) continue;\n\n                // still required for a future postprocess pass\n                if (poolTexture.usage > 0) continue;\n\n                // different resolution\n                if (poolTexture.texture.divisor !== out.divisor) continue;\n\n                // different type (/!\\ important, we could change type runtime, that way we cause lot of memory)\n                if (poolTexture.texture.getInternalFormatType() !== out.type) continue;\n\n                // first usage\n                if (poolTexture.usage === -1) {\n                    if (poolTexture.texture.getMinFilter() !== filter) {\n                        poolTexture.texture.setMinFilter(filter);\n                        poolTexture.texture.setMagFilter(filter);\n                    }\n\n                    return key;\n                }\n\n                // reuse\n                if (poolTexture.texture.getMinFilter() === filter) {\n                    return key;\n                }\n            }\n\n            return;\n        },\n\n        _setOrCreateTextureKey: function(usage, passName, out) {\n            var isLinear = this._textures[passName].filter === 'linear';\n            var filterEnum = isLinear ? __WEBPACK_IMPORTED_MODULE_4_osg_Texture__[\"default\"].LINEAR : __WEBPACK_IMPORTED_MODULE_4_osg_Texture__[\"default\"].NEAREST;\n\n            var poolKey = this._hasFreeTexture(passName, filterEnum, out);\n            if (poolKey) {\n                this._texturePool[poolKey].usage = usage;\n                this._textures[passName].key = poolKey;\n                return;\n            }\n\n            if (out.immuable) {\n                poolKey = passName;\n            } else {\n                poolKey = 'key' + this._currentPoolIndex++;\n            }\n\n            this._texturePool[poolKey] = {\n                usage: usage,\n                texture: this._createTexture(passName, out.divisor, out.type, filterEnum),\n                immuable: out.immuable,\n                reusable: out.reusable\n            };\n\n            if (out.divisor === -1) {\n                this._texturePool[poolKey].width = out.width;\n                this._texturePool[poolKey].height = out.height;\n            }\n\n            this._textures[passName].key = poolKey;\n        },\n\n        _addStateSet: function(pass, stateSet) {\n            for (var i = 0; i < pass.funcs.length; i++) {\n                var passName = pass.funcs[i].name;\n\n                this._stateSets[passName] = stateSet;\n            }\n        },\n\n        _addTextureToStateSet: function(textureInfo, stateSet, unit, uniforms, isFeedback) {\n            stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_5_osg_Uniform__[\"a\" /* default */].createInt1(unit, textureInfo.uniformName));\n\n            var name = textureInfo.name;\n            var texture;\n\n            if (this._textures[name] !== undefined) {\n                var key = this._textures[name].key;\n                texture = this._texturePool[key].texture;\n            } else {\n                texture = this._externalTextures[name];\n            }\n\n            this._addTextureUniforms(\n                textureInfo.uniformName,\n                texture,\n                stateSet,\n                uniforms,\n                isFeedback\n            );\n\n            if (textureInfo.uniformName === 'TexturePrevious') {\n                return unit;\n            }\n\n            stateSet.setTextureAttributeAndModes(unit, texture);\n\n            return undefined;\n        },\n\n        _getUniformName: function(uniformName) {\n            return 'u' + uniformName[0].toUpperCase() + uniformName.slice(1);\n        },\n\n        _addTextureUniforms: function(uniformName, texture, stateSet, uniforms, isFeedback) {\n            var uName = this._getUniformName(uniformName);\n\n            var uSize = __WEBPACK_IMPORTED_MODULE_5_osg_Uniform__[\"a\" /* default */].createFloat2(uName + 'Size');\n            var uRatio = __WEBPACK_IMPORTED_MODULE_5_osg_Uniform__[\"a\" /* default */].createFloat2(uName + 'Ratio');\n\n            stateSet.addUniform(uSize);\n            stateSet.addUniform(uRatio);\n\n            uniforms.push(uSize);\n            uniforms.push(uRatio);\n\n            this._textureUniforms.push({\n                size: uSize,\n                ratio: uRatio,\n                texture: texture,\n                isFeedback: !!isFeedback\n            });\n        },\n\n        _checkInferredParameters: function() {\n            for (var key in this._textures) {\n                var tex = this._textures[key];\n                if (tex.srgb === undefined) tex.srgb = tex.srgbInferred;\n                if (tex.rgbm === undefined) tex.rgbm = tex.rgbmInferred;\n            }\n        },\n\n        _buildPass: function(index, passes) {\n            var pass = passes[index];\n            var passName = pass.out.name;\n\n            this._setOrCreateTextureKey(this._usages[passName], passName, pass.out);\n\n            var feedbackName = pass.out.name + 'FeedbackTexture';\n\n            if (pass.feedbackLoop) {\n                this._setOrCreateTextureKey(this._usages[feedbackName], feedbackName, pass.out);\n            }\n\n            // internal pass (user texture)\n            if (!pass.funcs.length) {\n                var key = this._textures[passName].key;\n                this._userTextures[passName] = this._texturePool[key].texture;\n                return;\n            }\n\n            var stateSet = new __WEBPACK_IMPORTED_MODULE_6_osg_StateSet__[\"a\" /* default */]();\n            this._addStateSet(pass, stateSet);\n\n            var i;\n            for (i = 0; i < pass.uniforms.length; i++) {\n                stateSet.addUniform(pass.uniforms[i]);\n            }\n\n            var uniforms = [];\n\n            var previousTextureUnit = undefined;\n\n            for (i = 0; i < pass.textures.length; i++) {\n                var texInfo = pass.textures[i];\n\n                var isFeedback = texInfo.name === feedbackName;\n                if (!isFeedback && !this._externalTextures[texInfo.name]) {\n                    var poolKey = this._textures[texInfo.name].key;\n                    this._texturePool[poolKey].usage--;\n                }\n\n                var unit = this._addTextureToStateSet(texInfo, stateSet, i, uniforms, isFeedback);\n                if (unit !== undefined) {\n                    previousTextureUnit = unit;\n                }\n\n                if (this._feedbackData[texInfo.name] === undefined) {\n                    continue;\n                }\n\n                var nextPass = {\n                    stateSet: stateSet,\n                    textureUnit: i\n                };\n\n                this._feedbackData[texInfo.name].nextPasses.push(nextPass);\n            }\n\n            var outputTexture = undefined;\n            if (index !== passes.length - 1) {\n                var outputKey = this._textures[passName].key;\n                outputTexture = this._texturePool[outputKey].texture;\n            }\n\n            this._addTextureUniforms('TextureOutput', outputTexture, stateSet, uniforms);\n\n            stateSet.setAttributeAndModes(this._createProgram(pass, uniforms));\n\n            if (pass.feedbackLoop) {\n                this._feedbackData[passName] = this._createFeedbackLoopCameras(\n                    passName,\n                    stateSet,\n                    outputTexture,\n                    previousTextureUnit\n                );\n            } else {\n                this.addChild(this._createCamera(passName, stateSet, outputTexture));\n            }\n        },\n\n        _buildGraphFromPasses: function(passes) {\n            for (var i = 0; i < passes.length; i++) {\n                this._buildPass(i, passes);\n            }\n        },\n\n        build: function(userPasses) {\n            this._usages = {};\n\n            // process array of passes\n            var passes = this._processUserPasses(userPasses);\n\n            // fallback on inferred information for srgb/rgbm/filter\n            this._checkInferredParameters(passes);\n\n            // create textures, cameras and shader\n            this._buildGraphFromPasses(passes);\n\n            this.resize(this._screenWidth, this._screenHeight);\n        },\n\n        _createFeedbackLoopCameras: function(name, stateSet, outputTexture, previousTextureUnit) {\n            var previousKey = this._textures[name + 'FeedbackTexture'].key;\n            var previousTexture = this._texturePool[previousKey].texture;\n\n            var common = new __WEBPACK_IMPORTED_MODULE_1_osg_Node__[\"a\" /* default */]();\n            common.setStateSet(stateSet);\n\n            var camera1 = this._createFeedbackLoopCamera(\n                name,\n                outputTexture,\n                previousTexture,\n                previousTextureUnit\n            );\n            var camera2 = this._createFeedbackLoopCamera(\n                name + 'FeedbackTexture',\n                previousTexture,\n                outputTexture,\n                previousTextureUnit\n            );\n\n            camera2.setNodeMask(0x0);\n\n            common.addChild(camera1);\n            common.addChild(camera2);\n\n            this.addChild(common);\n\n            var feedbackLoopData = {};\n            feedbackLoopData.camera1 = camera1;\n            feedbackLoopData.camera2 = camera2;\n            feedbackLoopData.texture1 = outputTexture;\n            feedbackLoopData.texture2 = previousTexture;\n            feedbackLoopData.nextPasses = [];\n\n            return feedbackLoopData;\n        },\n\n        _createFeedbackLoopCamera: function(cameraName, dstTexture, srcTexture, srcUnit) {\n            var stateSet = new __WEBPACK_IMPORTED_MODULE_6_osg_StateSet__[\"a\" /* default */]();\n            stateSet.setTextureAttributeAndModes(srcUnit, srcTexture);\n\n            var camera = this._createCamera(cameraName, stateSet, dstTexture);\n            camera.setStateSet(stateSet);\n\n            return camera;\n        },\n\n        _createCamera: function(name, stateSet, outputTexture) {\n            var camera = new __WEBPACK_IMPORTED_MODULE_7_osg_Camera__[\"a\" /* default */]();\n            camera.setName(name);\n            camera.setStateSet(stateSet);\n            camera.setClearMask(0x0);\n            camera.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_13_osg_transformEnums__[\"a\" /* default */].ABSOLUTE_RF);\n\n            if (outputTexture) {\n                camera.setRenderOrder(__WEBPACK_IMPORTED_MODULE_7_osg_Camera__[\"a\" /* default */].PRE_RENDER, 0);\n                camera.attachTexture(__WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__[\"a\" /* default */].COLOR_ATTACHMENT0, outputTexture);\n            }\n\n            camera.setViewport(new __WEBPACK_IMPORTED_MODULE_9_osg_Viewport__[\"a\" /* default */]());\n\n            var quad = __WEBPACK_IMPORTED_MODULE_12_osg_shape__[\"a\" /* default */].createTexturedFullScreenFakeQuadGeometry();\n            quad.setName('composer layer');\n            camera.addChild(quad);\n\n            this._cameras.push(camera);\n            return camera;\n        },\n\n        swapFeedbackLoopTextures: function(frame0) {\n            for (var key in this._feedbackData) {\n                var data = this._feedbackData[key];\n\n                data.camera1.setNodeMask(frame0 ? ~0x0 : 0x0);\n                data.camera2.setNodeMask(frame0 ? 0x0 : ~0x0);\n\n                var texture = frame0 ? data.texture1 : data.texture2;\n\n                for (var j = 0; j < data.nextPasses.length; j++) {\n                    var nextPass = data.nextPasses[j];\n                    nextPass.stateSet.setTextureAttributeAndModes(nextPass.textureUnit, texture);\n                }\n            }\n\n            this._feedbackSwapped = true;\n        },\n\n        _createFuncFromUserData: function(userFunc) {\n            var func =\n                typeof userFunc === 'string'\n                    ? { name: userFunc, file: userFunc + '.glsl' }\n                    : userFunc;\n\n            // now funcs.join( '_' ) only join the name of the functions instead of every members of the object\n            func.toString = function() {\n                return this.name;\n            };\n\n            return func;\n        },\n\n        _createTextureInfoFromUserData: function(userData) {\n            var texInfo = {\n                name: '',\n                uniformName: '',\n                rgbm: undefined,\n                srgb: undefined,\n                filter: undefined\n            };\n\n            if (typeof userData === 'string') {\n                texInfo.name = userData;\n            } else {\n                texInfo.name = userData.name;\n\n                if (userData.uniformName) texInfo.uniformName = userData.uniformName;\n                if (userData.rgbm !== undefined) texInfo.rgbm = userData.rgbm;\n                if (userData.srgb !== undefined) texInfo.srgb = userData.srgb;\n                if (userData.filter !== undefined) texInfo.filter = userData.filter;\n            }\n\n            return texInfo;\n        },\n\n        _preprocessUserPasses: function(userPasses) {\n            var passes = [];\n\n            for (var i = 0; i < userPasses.length; i++) {\n                var userPass = userPasses[i];\n\n                var pass = {};\n                pass.funcs = [];\n\n                if (userPass.func) {\n                    pass.funcs.push(this._createFuncFromUserData(userPass.func));\n                }\n\n                pass.textures = [];\n\n                pass.feedbackLoop = false;\n\n                if (userPass.textures !== undefined) {\n                    if (!Array.isArray(userPass.textures)) {\n                        userPass.textures = [userPass.textures];\n                    }\n\n                    for (var j = 0; j < userPass.textures.length; j++) {\n                        var tex = this._createTextureInfoFromUserData(userPass.textures[j]);\n\n                        if (tex.name === '%previous') {\n                            pass.feedbackLoop = true;\n                        }\n\n                        pass.textures.push(tex);\n                    }\n                }\n\n                if (typeof userPass.header === 'string') {\n                    pass.header = [userPass.header];\n                } else {\n                    pass.header = userPass.header || [];\n                }\n\n                if (userPass.uniforms !== undefined) {\n                    if (Array.isArray(userPass.uniforms)) {\n                        pass.uniforms = userPass.uniforms;\n                    } else {\n                        pass.uniforms = [userPass.uniforms];\n                    }\n                } else {\n                    pass.uniforms = [];\n                }\n\n                pass.out = userPass.out;\n                // filter/rgbm/srgb are undefined by default\n                pass.out.divisor = pass.out.divisor || 1.0;\n\n                pass.out.type = pass.out.type || __WEBPACK_IMPORTED_MODULE_4_osg_Texture__[\"default\"].UNSIGNED_BYTE;\n                if (pass.out.immuable === undefined) pass.out.immuable = false;\n                if (pass.out.reusable === undefined) pass.out.reusable = true;\n\n                if (pass.feedbackLoop || pass.out.divisor === -1) {\n                    pass.out.immuable = true;\n                    pass.out.reusable = false;\n                }\n\n                pass.collapsible = userPass.collapsible || false;\n                passes.push(pass);\n            }\n\n            return passes;\n        },\n\n        _canBeCollapsed: function(currentPass, nextPass) {\n            // this won't merge passes with named textures even if they are collapsible\n            // is this what we want?\n            return (\n                currentPass.funcs.length &&\n                nextPass.collapsible &&\n                currentPass.out.name === '%next' &&\n                currentPass.out.divisor === nextPass.out.divisor &&\n                // we dont want to merge fixed size texture if the same isn't equal\n                currentPass.out.width === currentPass.out.width &&\n                currentPass.out.height === currentPass.out.height\n            );\n        },\n\n        _collapsePasses: function(currentPass, nextPass) {\n            if (!this._canBeCollapsed(currentPass, nextPass)) {\n                return false;\n            }\n\n            currentPass.funcs = currentPass.funcs.concat(nextPass.funcs);\n            currentPass.header = currentPass.header.concat(nextPass.header);\n\n            currentPass.textures = this._mergeWithoutDuplicates(\n                currentPass.textures,\n                nextPass.textures,\n                function(a, b) {\n                    return a.name === b.name;\n                }\n            );\n\n            currentPass.uniforms = this._mergeWithoutDuplicates(\n                currentPass.uniforms,\n                nextPass.uniforms,\n                function(a, b) {\n                    return a.getName() === b.getName();\n                }\n            );\n\n            // not sure if we should collapse feedbackLoop into lastpass?\n            return true;\n        },\n\n        _renameTextureAlias: function(texture, passName, lastPassName) {\n            if (texture.name === '%last') {\n                texture.name = lastPassName;\n                texture.uniformName = texture.uniformName || 'TextureInput';\n            } else if (texture.name === '%previous') {\n                texture.name = passName + 'FeedbackTexture';\n                texture.uniformName = texture.uniformName || 'TexturePrevious';\n            } else if (!texture.uniformName) {\n                texture.uniformName = texture.name;\n            }\n        },\n\n        _createTexture: function(name, divisor, type, filter) {\n            var texture = new __WEBPACK_IMPORTED_MODULE_4_osg_Texture__[\"default\"]();\n            texture.setTextureSize(1, 1);\n            texture.setInternalFormatType(type);\n\n            // not always necessary to have 4 channels, might be interesting to set it in pass\n            texture.setInternalFormat(__WEBPACK_IMPORTED_MODULE_4_osg_Texture__[\"default\"].RGBA);\n\n            texture.setMinFilter(filter);\n            texture.setMagFilter(filter);\n\n            texture.divisor = divisor;\n            texture.setName(name);\n\n            return texture;\n        },\n\n        _computeHashFromPass: function(pass) {\n            var hash = '';\n\n            for (var i = 0; i < pass.funcs.length; i++) {\n                hash += pass.funcs[i].name + '_' + pass.funcs[i].file + '_';\n            }\n\n            if (pass.header) {\n                hash += pass.header.join('_');\n            }\n\n            for (i = 0; i < pass.textures.length; i++) {\n                hash += !!pass.textures[i].rgbm + '_' + !!pass.textures[i].srgb + '_';\n            }\n\n            hash += !!pass.out.encodeSRGB + '_';\n            hash += !!this._textures[pass.out.name].rgbm + '_';\n\n            return hash;\n        },\n\n        _writeDeclarations: function(source, uniforms, textures, header) {\n            var str = 'uniform sampler2D TextureInput;\\n';\n\n            var i;\n            for (i = 0; i < textures.length; i++) {\n                var tname = textures[i].uniformName || textures[i].name;\n                str += 'uniform sampler2D ' + tname + ';\\n';\n            }\n            for (i = 0; i < uniforms.length; i++) {\n                var uniform = uniforms[i];\n                str += 'uniform ' + uniform.getType() + ' ' + uniform.getName() + ';\\n';\n            }\n\n            source = source.replace('%uniforms%', str);\n\n            if (header) {\n                source = source.replace('%header%', header.join('\\n'));\n            }\n\n            return source;\n        },\n\n        setMethodWrapUV: function(method, threshold) {\n            // hook every texture call to handle viewport/texture ratio\n            // when reading out of texture assigned zone\n\n            // 0 - do nothing\n            // 1 - clamp uv\n            // 2 - black color\n            if (method !== undefined) this._methodWrapUV = method;\n            if (threshold !== undefined) this._thresholdWrapUV = threshold;\n            this._texInfos = undefined;\n        },\n\n        _getInfos: function() {\n            if (this._texInfos) return this._texInfos;\n\n            var bodySimple = 'texture2D(%tex, (uv) * %ratio)';\n            var bodyNearest =\n                'texture2D(%tex, (floor((uv) * %size) + 0.5) * %ratio / %size, -99999.0)';\n            var bodyBias = 'texture2D(%tex, (uv) * %ratio)';\n\n            // see setMethodWrapUV\n            var val = this._thresholdWrapUV.toExponential();\n            if (this._methodWrapUV === 1) {\n                var replaceValue = 'min(uv, 1.0 - ' + val + ' / %size.xy)';\n                bodySimple = bodySimple.replace(/(uv)/g, replaceValue);\n                bodyNearest = bodyNearest.replace(/(uv)/g, replaceValue);\n                bodyBias = bodyBias.replace(/(uv)/g, replaceValue);\n            } else if (this._methodWrapUV === 2) {\n                var prefix = 'step((uv).x, 1.0 - ' + val + ' / %size.x) *';\n                prefix += 'step((uv).y, 1.0 - ' + val + ' / %size.y) * ';\n                bodySimple = prefix + bodySimple;\n                bodyNearest = prefix + bodyNearest;\n                bodyBias = prefix + bodyBias;\n            }\n\n            this._texInfos = {\n                TEXTURE_2D: {\n                    signature: 'TEXTURE_2D_%tex(uv)',\n                    body: bodySimple\n                },\n                TEXTURE_2D_NEAREST: {\n                    signature: 'TEXTURE_2D_NEAREST_%tex(uv)',\n                    body: bodyNearest\n                },\n                TEXTURE_2D_BIAS: {\n                    signature: 'TEXTURE_2D_BIAS_%tex(uv, bias)',\n                    body: bodyBias\n                }\n            };\n\n            return this._texInfos;\n        },\n\n        _extractTextures: function(file) {\n            var infos = this._getInfos();\n\n            var lines = file.match(/TEXTURE_2D(?:_BIAS|_NEAREST)?_\\w+\\(/g);\n            if (!lines) return {};\n\n            var textures = {};\n\n            for (var j = 0; j < lines.length; j++) {\n                var str = lines[j].match(/((TEXTURE_2D(?:_BIAS|_NEAREST)?)_(\\w+))\\(/);\n                var info = infos[str[2]];\n\n                textures[str[1]] = {\n                    name: str[3],\n                    signature: info.signature,\n                    body: info.body\n                };\n            }\n\n            return textures;\n        },\n\n        _writeFunctionBodies: function(source, funcs, textures, collapsible) {\n            var colorSpacesDefines = [];\n            var functionBodies = '';\n            var defineKeys = {};\n\n            for (var i = 0; i < funcs.length; i++) {\n                var file = this._shaderProcessor.getShaderTextPure(funcs[i].file);\n                functionBodies += file + '\\n';\n            }\n\n            // resolve pragma include\n            var includeList = ['functions.glsl']; // included in composer main shader\n            functionBodies = this._shaderProcessor.preprocess(functionBodies, 0, includeList);\n\n            var textureDefines = this._extractTextures(functionBodies);\n            if (collapsible) {\n                var tex2dInfo = this._getInfos().TEXTURE_2D;\n                textureDefines.TEXTURE_2D_TextureInput = {\n                    name: 'TextureInput',\n                    signature: tex2dInfo.signature,\n                    body: tex2dInfo.body\n                };\n            }\n\n            for (var key in textureDefines) {\n                if (defineKeys[key]) {\n                    continue;\n                }\n\n                defineKeys[key] = true;\n\n                var defineInfo = textureDefines[key];\n                var texName = defineInfo.name;\n\n                var rgbm = false;\n                // check if the textures is rgbm\n                for (var j = 0; j < textures.length; j++) {\n                    var inTex = textures[j];\n                    if (inTex.uniformName !== texName) {\n                        continue;\n                    }\n\n                    var tex = this._textures[inTex.name];\n                    if (tex && tex.rgbm) {\n                        rgbm = tex.rgbm;\n                        break;\n                    }\n                }\n\n                var code = defineInfo.body;\n                if (rgbm) code = 'vec4(decodeRGBM(' + code + ', uRGBMRange), 1.0)';\n                code = '#define ' + defineInfo.signature + ' (' + code + ')';\n\n                // replace %stuff by uniform names\n                var uName = this._getUniformName(texName);\n                code = code.replace(/%size/g, uName + 'Size');\n                code = code.replace(/%ratio/g, uName + 'Ratio');\n                code = code.replace(/%tex/g, texName);\n\n                colorSpacesDefines.push(code);\n            }\n\n            source = source.replace('%texturesColorSpace%', colorSpacesDefines.join('\\n'));\n\n            // allows multi-line defines in sub-shaders\n            return source.replace('%functionBodies%', functionBodies.replace(/\\\\\\n/g, ''));\n        },\n\n        _writeMainFunction: function(source, funcs, collapsible, textureName) {\n            source = source.replace('%firstFunc%', funcs[0].name);\n\n            var arg = collapsible ? 'TEXTURE_2D_TextureInput(gTexCoord)' : '';\n            source = source.replace('%firstArg%', arg);\n\n            var str = '';\n\n            for (var i = 1; i < funcs.length; i++) {\n                str += '\\tcolor = ' + funcs[i].name + '(color);\\n';\n            }\n\n            source = source.replace('%optionalFuncs%', str);\n\n            if (this._textures[textureName].encodeSRGB === true) {\n                var func = this._textures[textureName].srgb ? 'linearTosRGB' : 'sRGBToLinear';\n                str = '\\tcolor.rgb = ' + func + '(color.rgb);\\n';\n            } else {\n                str = '';\n            }\n\n            if (this._textures[textureName].rgbm) {\n                str += '\\tcolor = encodeRGBM(color.rgb, uRGBMRange);';\n            } else {\n                str += '';\n            }\n\n            return source.replace('%colorSpaces%', str);\n        },\n\n        // an hash string is created using the user pass data before creating a program\n        // shaders are stored inside a map using this string, so the composer knows there is no need to rebuild it if it already exists\n\n        _removeDuplicatedUniforms: function(source) {\n            var lines = source.split('\\n');\n\n            var uniforms = {};\n\n            var numLines = lines.length;\n\n            for (var i = 0; i < numLines; i++) {\n                var match = lines[i].match(/uniform(?:\\s+){1,}\\w+(?:\\s+){1,}(\\w+)/);\n                if (match === null) {\n                    continue;\n                }\n\n                var name = match[1];\n\n                if (uniforms[name] !== undefined) {\n                    lines.splice(i, 1);\n                    numLines--;\n                    i--;\n                } else {\n                    uniforms[name] = true;\n                }\n            }\n\n            return lines.join('\\n');\n        },\n\n        _createProgram: function(pass, uniforms) {\n            var hash = this._computeHashFromPass(pass);\n            if (this._programs[hash] !== undefined) {\n                return this._programs[hash];\n            }\n\n            var source = this._writeDeclarations(\n                ComposerPostProcess.FragmentShader,\n                uniforms,\n                pass.textures,\n                pass.header\n            );\n\n            source = this._writeFunctionBodies(source, pass.funcs, pass.textures, pass.collapsible);\n            source = this._writeMainFunction(source, pass.funcs, pass.collapsible, pass.out.name);\n\n            source = source.replace('%name%', pass.out.name);\n            source = this._removeDuplicatedUniforms(source);\n\n            var vertexSource = ComposerPostProcess.VertexShader.replace('%name%', pass.out.name);\n            var program = new __WEBPACK_IMPORTED_MODULE_10_osg_Program__[\"a\" /* default */](\n                new __WEBPACK_IMPORTED_MODULE_11_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_11_osg_Shader__[\"a\" /* default */].VERTEX_SHADER, vertexSource),\n                new __WEBPACK_IMPORTED_MODULE_11_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_11_osg_Shader__[\"a\" /* default */].FRAGMENT_SHADER, source)\n            );\n\n            this._programs[hash] = program;\n            return program;\n        },\n\n        resize: function(width, height) {\n            this.setScreenSize(width, height);\n\n            // resize texture\n            for (var key in this._texturePool) {\n                var texture = this._texturePool[key].texture;\n\n                if (this._texturePool[key].width !== undefined) {\n                    texture.setTextureSize(\n                        this._texturePool[key].width,\n                        this._texturePool[key].height\n                    );\n\n                    continue;\n                }\n\n                texture.setTextureSize(\n                    this._getTextureSize(width, texture.divisor),\n                    this._getTextureSize(height, texture.divisor)\n                );\n            }\n\n            this.resizeRatio();\n        },\n\n        resizeRatio: function(xViewport, yViewport, xTexture, yTexture) {\n            if (xViewport !== undefined) this._xViewportRatio = xViewport;\n            if (yViewport !== undefined) this._yViewportRatio = yViewport;\n            if (xTexture !== undefined) this._xTextureRatio = xTexture;\n            if (yTexture !== undefined) this._yTextureRatio = yTexture;\n\n            this._resizeViewports();\n            this._resizeTextureUniforms();\n        },\n\n        _resizeViewports: function() {\n            var xRatio = this.getGlobalXRatio();\n            var yRatio = this.getGlobalYRatio();\n\n            var cameras = this._cameras;\n            for (var i = 0; i < cameras.length; ++i) {\n                var camera = cameras[i];\n\n                var isRtt = camera.isRenderToTextureCamera();\n                var divisor = 1;\n                if (isRtt) {\n                    var attachment = camera.getAttachments()[__WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__[\"a\" /* default */].COLOR_ATTACHMENT0];\n                    divisor = attachment.texture.divisor;\n                }\n\n                if (i === cameras.length - 1 && this._finalPassUpScaleToScreen) {\n                    xRatio = this._xViewportRatio;\n                    yRatio = this._yViewportRatio;\n                }\n\n                if (divisor === -1) {\n                    continue;\n                }\n\n                var width = this._getTextureSize(this._screenWidth, divisor / xRatio);\n                var height = this._getTextureSize(this._screenHeight, divisor / yRatio);\n\n                camera.getViewport().setViewport(0, 0, width, height);\n            }\n        },\n\n        _resizeTextureUniforms: function() {\n            var xRatio = this.getGlobalXRatio();\n            var yRatio = this.getGlobalYRatio();\n\n            var xFinalRatio = this._finalPassUpScaleToScreen ? this._xViewportRatio : xRatio;\n            var yFinalRatio = this._finalPassUpScaleToScreen ? this._yViewportRatio : yRatio;\n\n            // we delay the uniform size/ratio of the feedback texture on next frame\n            this._syncFeedbackUniforms = true;\n\n            var tunifs = this._textureUniforms;\n            for (var i = 0; i < tunifs.length; ++i) {\n                var obj = tunifs[i];\n                var size = obj.size.getInternalArray();\n                var ratio = obj.ratio.getInternalArray();\n\n                // feedback texture update is delayed (unless first frame)\n                if (obj.isFeedback && size[0]) {\n                    continue;\n                }\n\n                ratio[0] = xRatio;\n                ratio[1] = yRatio;\n\n                var texture = obj.texture;\n                // final pass\n                if (!texture) {\n                    size[0] = this._screenWidth * xFinalRatio;\n                    size[1] = this._screenHeight * yFinalRatio;\n                    continue;\n                }\n\n                // external texture\n                if (!texture.divisor || texture.divisor < 0) {\n                    size[0] = texture.getWidth();\n                    size[1] = texture.getHeight();\n\n                    ratio[0] = ratio[1] = 1.0;\n                    continue;\n                }\n\n                // don't floor/round/ceil\n                // (it may be useful when we force a nearest fetch in a shader)\n                size[0] = xRatio * texture.getWidth();\n                size[1] = yRatio * texture.getHeight();\n            }\n        },\n\n        _resizeFeedbackTextureUniforms: function() {\n            var xRatio = this._lastXratio;\n            var yRatio = this._lastYratio;\n\n            var tunifs = this._textureUniforms;\n            for (var i = 0; i < tunifs.length; ++i) {\n                var obj = tunifs[i];\n                if (!obj.isFeedback) continue;\n\n                var size = obj.size.getInternalArray();\n                var ratio = obj.ratio.getInternalArray();\n\n                var texture = obj.texture;\n                ratio[0] = xRatio;\n                ratio[1] = yRatio;\n\n                size[0] = xRatio * texture.getWidth();\n                size[1] = yRatio * texture.getHeight();\n            }\n        },\n\n        cull: function() {\n            if (this._syncOnNextFrame) {\n                this._resizeFeedbackTextureUniforms();\n                this._syncOnNextFrame = false;\n            }\n\n            if (this._syncFeedbackUniforms) {\n                if (this._feedbackSwapped) {\n                    this._syncFeedbackUniforms = false;\n                    this._syncOnNextFrame = true;\n                    this._lastXratio = this.getGlobalXRatio();\n                    this._lastYratio = this.getGlobalYRatio();\n                }\n            }\n\n            this._feedbackSwapped = false;\n            return true;\n        },\n\n        _mergeWithoutDuplicates: function(a, b, compareFunc) {\n            for (var i = 0; i < b.length; i++) {\n                var element = b[i];\n\n                var add = true;\n\n                for (var j = 0; j < a.length; j++) {\n                    if (compareFunc(a[j], element)) {\n                        add = false;\n                        break;\n                    }\n                }\n\n                if (add) {\n                    a.push(element);\n                }\n            }\n\n            return a;\n        },\n\n        _getTextureSize: function(size, divisor) {\n            return Math.max(1.0, Math.round(size / divisor));\n        },\n\n        setScreenSize: function(width, height) {\n            this._screenWidth = width;\n            this._screenHeight = height;\n        },\n\n        setShaderProcessor: function(shaderProcessor) {\n            this._shaderProcessor = shaderProcessor;\n        },\n\n        // textures owned by the composer, they will be cached/reused/resized unless reusable or immuable\n        addInternalTexture: function(desc) {\n            this._internalPasses.push({\n                out: {\n                    name: desc.name,\n                    divisor: desc.divisor,\n                    type: desc.type,\n                    filter: desc.filter,\n                    srgb: desc.srgb,\n                    rgbm: desc.rgbm,\n                    immuable: desc.immuable,\n                    reusable: desc.reusable\n                }\n            });\n        },\n\n        // textures not owned by the composer, they won't be cached/reused/resized\n        addExternalTexture: function(key, texture) {\n            this._externalTextures[key] = texture;\n        },\n\n        setInputTexture: function(key) {\n            this._firstTexture = key;\n        },\n\n        getCameras: function() {\n            return this._cameras;\n        },\n\n        getStateSetPass: function(passName) {\n            return this._stateSets[passName];\n        },\n\n        getInternalTexture: function(alias) {\n            return this._userTextures[alias];\n        }\n    }),\n    'osgUtil',\n    'ComposerPostProcess'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ComposerPostProcess);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/ComposerPostProcess.js\n// module id = 228\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/ComposerPostProcess.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_utils__ = __webpack_require__(93);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__ = __webpack_require__(73);\n\n\n\n\nvar sprintf = __WEBPACK_IMPORTED_MODULE_1_osgShader_utils__[\"a\" /* default */].sprintf;\n\n// Base Class for all variables Nodes\n// TODO: add precision\n// type {string} vec3/4/2, float, int, etc.\n// prefix {string} vec3/4/2, float, int, etc.\nvar Variable = function(type, prefix) {\n    __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].call(this);\n    this._name = 'Variable';\n    this._prefix = prefix;\n    this._type = type;\n    this._value = undefined;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Variable,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].prototype, {\n        getType: function() {\n            return this._type;\n        },\n\n        getVariable: function() {\n            return this._prefix;\n        },\n\n        setValue: function(value) {\n            this._value = value;\n            return this;\n        },\n\n        toString: function() {\n            var str = this._name + ' ' + this._prefix;\n            if (this._type) str += ' (' + this._type + ')';\n            str += ' - id:' + this._id;\n            return str;\n        },\n\n        declare: function() {\n            if (this._value !== undefined) {\n                return sprintf('%s %s = %s;', [this._type, this.getVariable(), this._value]);\n            } else {\n                return sprintf('%s %s;', [this._type, this.getVariable()]);\n            }\n        },\n\n        isEmpty: function() {\n            return this._value === undefined && this._inputs.length === 0;\n        },\n\n        reset: function() {\n            this._inputs = [];\n            this._outputs = null;\n            this._value = undefined;\n            this._text = undefined;\n        }\n    }),\n    'osgShader',\n    'Variable'\n);\n\n// Constant Variable\n// help glsl compiler and make sure no one writes in it :)\nvar Constant = function(type, prefix) {\n    Variable.call(this, type, prefix);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Constant,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Variable.prototype, {\n        declare: function() {\n            return sprintf('const %s %s = %s;', [this._type, this.getVariable(), this._value]);\n        }\n    }),\n    'osgShader',\n    'Constant'\n);\n\nvar Uniform = function(type, prefix, size) {\n    Variable.call(this, type, prefix);\n    this._size = size;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Uniform,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Variable.prototype, {\n        declare: function() {\n            return undefined;\n        },\n\n        globalDeclaration: function() {\n            if (this._size) {\n                return sprintf('uniform %s %s[%s];', [this._type, this.getVariable(), this._size]);\n            } else {\n                return sprintf('uniform %s %s;', [this._type, this.getVariable()]);\n            }\n        }\n    }),\n    'osgShader',\n    'Uniform'\n);\n\n// Vertex Attribute Variables\nvar Attribute = function(type, prefix) {\n    Variable.call(this, type, prefix);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Attribute,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Variable.prototype, {\n        declare: function() {\n            return undefined;\n        },\n\n        globalDeclaration: function() {\n            return sprintf('attribute %s %s;', [this._type, this.getVariable()]);\n        }\n    }),\n    'osgShader',\n    'Attribute'\n);\n\nvar Varying = function(type, prefix) {\n    Variable.call(this, type, prefix);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Varying,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Variable.prototype, {\n        declare: function() {\n            return undefined;\n        },\n\n        globalDeclaration: function() {\n            return sprintf('varying %s %s;', [this._type, this.getVariable()]);\n        }\n    }),\n    'osgShader',\n    'Varying'\n);\n\nvar Sampler = function(type, prefix) {\n    Variable.call(this, type, prefix);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Sampler,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Variable.prototype, {\n        declare: function() {\n            return undefined;\n        },\n\n        globalDeclaration: function() {\n            return sprintf('uniform %s %s;', [this._type, this.getVariable()]);\n        }\n    }),\n    'osgShader',\n    'Sampler'\n);\n\n// Graph Root Node Abstract Class\n// Derive from that for new outputs\n// gl_FragDepth, etc.\nvar Output = function(type, wholeName) {\n    Variable.call(this, type, wholeName);\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Output,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Variable.prototype, {\n        _unique: true,\n        isUnique: function() {\n            return this._unique;\n        },\n        outputs: function() {\n            /* do nothing for variable */\n            return this;\n        },\n        getVariable: function() {\n            return this._prefix;\n        }\n    }),\n    'osgShader',\n    'Output'\n);\n\n// Graph Root Nodes\nvar glFragColor = function() {\n    Output.call(this, 'vec4', 'gl_FragColor');\n    this._name = 'glFragColor';\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    glFragColor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Output.prototype, {}),\n    'osgShader',\n    'glFragColor'\n);\n\nvar glPosition = function() {\n    Output.call(this, 'vec4', 'gl_Position');\n    this._name = 'glPosition';\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    glPosition,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Output.prototype, {}),\n    'osgShader',\n    'glPosition'\n);\n\nvar glPointSize = function() {\n    Output.call(this, 'float', 'gl_PointSize');\n    this._name = 'glPointSize';\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    glPointSize,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(Output.prototype, {}),\n    'osgShader',\n    'glPointSize'\n);\n\nvar Define = function(name) {\n    __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].call(this);\n    this._defineName = name;\n    this._defineValue = '';\n};\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Define,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].prototype, {\n        type: 'Define',\n        setValue: function(value) {\n            this._defineValue = value;\n            return this;\n        },\n        getDefines: function() {\n            return ['#define ' + this._defineName + ' ' + this._defineValue];\n        }\n    }),\n    'osgShader',\n    'Define'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n    Output: Output,\n    glPointSize: glPointSize,\n    glPosition: glPosition,\n    glFragColor: glFragColor,\n    Sampler: Sampler,\n    Variable: Variable,\n    Constant: Constant,\n    Attribute: Attribute,\n    Varying: Varying,\n    Uniform: Uniform,\n    Define: Define\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/data.js\n// module id = 229\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/data.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShader_ShaderGenerator__ = __webpack_require__(56);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShadow_ShadowCastShaderGenerator__ = __webpack_require__(154);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgUtil_DisplayNormalVisitor__ = __webpack_require__(152);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgUtil_DisplayGeometryVisitor__ = __webpack_require__(156);\n\n\n\n\n\n\nvar ShaderGeneratorProxy = function() {\n    // object of shader generators\n    this._generators = {};\n    this.addShaderGenerator('default', new __WEBPACK_IMPORTED_MODULE_1_osgShader_ShaderGenerator__[\"a\" /* default */]());\n    this.addShaderGenerator('ShadowCast', new __WEBPACK_IMPORTED_MODULE_2_osgShadow_ShadowCastShaderGenerator__[\"a\" /* default */]());\n    this.addShaderGenerator(\n        'debugNormal',\n        new __WEBPACK_IMPORTED_MODULE_3_osgUtil_DisplayNormalVisitor__[\"a\" /* default */].ShaderGeneratorCompilerOffsetNormal()\n    );\n    this.addShaderGenerator(\n        'debugTangent',\n        new __WEBPACK_IMPORTED_MODULE_3_osgUtil_DisplayNormalVisitor__[\"a\" /* default */].ShaderGeneratorCompilerOffsetTangent()\n    );\n    this.addShaderGenerator(\n        'debugGeometry',\n        new __WEBPACK_IMPORTED_MODULE_4_osgUtil_DisplayGeometryVisitor__[\"a\" /* default */].ShaderGeneratorCompilerColorGeometry()\n    );\n    this.addShaderGenerator(\n        'debugSkinning',\n        new __WEBPACK_IMPORTED_MODULE_4_osgUtil_DisplayGeometryVisitor__[\"a\" /* default */].ShaderGeneratorCompilerColorSkinning()\n    );\n\n    return this;\n};\n\nShaderGeneratorProxy.prototype = {\n    getShaderGenerator: function(name) {\n        if (!name) return this._generators.default;\n\n        var shaderGenerator = this._generators[name];\n\n        if (!shaderGenerator) {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('ShaderGenerator ' + name + ' does not exist in ShaderGeneratorProxy');\n            return this._generators.default;\n        }\n\n        return shaderGenerator;\n    },\n\n    // user-space facility to provide its own\n    addShaderGenerator: function(name, sg) {\n        this._generators[name] = sg;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ShaderGeneratorProxy);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/ShaderGeneratorProxy.js\n// module id = 230\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/ShaderGeneratorProxy.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__ = __webpack_require__(73);\n\n\n\n\n// Abstract class\n// base operator contains helper for the constructor\n// it helps to do that:\n// arg0 = output\n// arg1 = input0 or [ inputs ]\n// arg2 = input1\n// ...\nvar BaseOperator = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].call(this);\n};\n\nBaseOperator.prototype = __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].prototype;\n\n// Add support this syntax:\n// new Add( output, input0, input1, ... )\n// new Add( output, [ inputs ] )\n// glsl code output = input0 + input1 +...\nvar Add = function() {\n    BaseOperator.call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Add,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(BaseOperator.prototype, {\n        type: 'Add',\n\n        operator: '+',\n\n        _getFirstVariableCast: function() {\n            var variable = this._inputs[0].getVariable();\n            var inType = this._inputs[0].getType();\n            var outType = this._outputs.getType();\n\n            if (outType === inType) return variable;\n\n            // upcast float\n            if (inType === 'float') return outType + '(' + variable + ')';\n\n            // downcast vector\n            if (outType === 'vec3') return variable + '.rgb';\n            if (outType === 'vec2') return variable + '.rg';\n            if (outType === 'float') return variable + '.r';\n\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('Mismatch type : ' + outType + ' with ' + inType + ', ' + variable);\n            return variable;\n        },\n\n        computeShader: function() {\n            // force inputs type to be all the same from the output\n            var outputType = this._outputs.getType();\n            var addType = '';\n\n            if (outputType === 'vec4') addType = '.rgba';\n            else if (outputType === 'vec3') addType = '.rgb';\n            else if (outputType === 'vec2') addType = '.rg';\n\n            var firstVariable = this._getFirstVariableCast();\n            var str = this._outputs.getVariable() + ' = ' + firstVariable;\n\n            for (var i = 1, l = this._inputs.length; i < l; i++) {\n                var input = this._inputs[i];\n                str += this.operator + input.getVariable();\n\n                var inType = input.getType();\n                if (inType !== 'float' && inType !== outputType) {\n                    str += addType;\n                }\n            }\n            str += ';';\n            return str;\n        }\n    }),\n    'osgShader',\n    'Add'\n);\n\n// Mult works like Add\n// glsl code output = input0 * input1 * ...\nvar Mult = function() {\n    Add.call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Mult,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(Add.prototype, {\n        type: 'Mult',\n        operator: '*'\n    }),\n    'osgShader',\n    'Mult'\n);\n\n// basic assignement alias: output = input\n// glsl code output = input0\nvar SetFromNode = function() {\n    Add.call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    SetFromNode,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(Add.prototype, {\n        type: 'SetFromNode'\n    }),\n    'osgShader',\n    'SetFromNode'\n);\n\n// Mult Matrix * vector4\n// making the cast vector4(input.xyz, 0)\n// if needed\n// glsl code output = matrix * vector4(vec.xyz, 0)\nvar MatrixMultDirection = function() {\n    Add.call(this);\n    this._overwriteW = true; // if set to false, we copy the input alpha in the output alpha\n    this._forceComplement = true;\n    this._inverseOp = false;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    MatrixMultDirection,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(Add.prototype, {\n        type: 'MatrixMultDirection',\n        operator: '*',\n        validInputs: ['vec', 'matrix'],\n        validOutputs: ['vec'],\n        complement: '0.',\n        setInverse: function(bool) {\n            this._inverseOp = bool;\n            return this;\n        },\n        setForceComplement: function(bool) {\n            this._forceComplement = bool;\n            return this;\n        },\n        setOverwriteW: function(bool) {\n            this._overwriteW = bool;\n            return this;\n        },\n        computeShader: function() {\n            // force inputs type to be all the same from the output\n            // and handle vector complement\n            var vecIn = this._inputs.vec.getVariable();\n            var matrix = this._inputs.matrix.getVariable();\n            var vecOut = this._outputs.vec.getVariable();\n\n            var inputType = this._inputs.vec.getType();\n            var outputType = this._outputs.vec.getType();\n            var matrixType = this._inputs.matrix.getType();\n\n            var strOut = vecOut;\n\n            if (matrixType === 'mat4') {\n                strOut += ' = ';\n\n                if (outputType !== 'vec4') strOut += outputType + '(';\n\n                var strCasted = vecIn;\n                if (this._forceComplement || inputType !== 'vec4')\n                    strCasted = 'vec4(' + vecIn + '.xyz, ' + this.complement + ')';\n\n                strOut += this._inverseOp\n                    ? strCasted + this.operator + matrix\n                    : matrix + this.operator + strCasted;\n\n                if (outputType !== 'vec4') strOut += ')';\n\n                strOut += ';';\n\n                if (!this._overwriteW && inputType === 'vec4')\n                    strOut += '\\n' + vecOut + '.a = ' + vecIn + '.a;';\n            } else {\n                if (outputType === 'vec4') strOut += '.xyz';\n                strOut += ' = ';\n\n                var strvec3 = vecIn + '.xyz';\n                strOut +=\n                    (this._inverseOp\n                        ? strvec3 + this.operator + matrix\n                        : matrix + this.operator + strvec3) + ';';\n\n                if (!this._overwriteW && outputType === 'vec4' && inputType === 'vec4')\n                    strOut += '\\n' + vecOut + '.a = ' + vecIn + '.a;';\n            }\n\n            return strOut;\n        }\n    }),\n    'osgShader',\n    'MatrixMultDirection'\n);\n\n// override only for complement.\n// glsl code output = matrix * vector4(vec.xyz, 1)\nvar MatrixMultPosition = function() {\n    MatrixMultDirection.call(this);\n    this._forceComplement = false;\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    MatrixMultPosition,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(MatrixMultDirection.prototype, {\n        type: 'MatrixMultPosition',\n        complement: '1.'\n    }),\n    'osgShader',\n    'MatrixMultPosition'\n);\n\nvar Blend = function() {\n    BaseOperator.apply(this);\n    this._mode = 'MIX';\n};\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    Blend,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(BaseOperator.prototype, {\n        type: 'Blend',\n        mode: function(mode) {\n            this._mode = mode;\n            return this;\n        },\n        computeShader: function() {\n            return this[this._mode === undefined ? 'MIX' : this._mode]();\n        },\n        ADD: function() {\n            return (\n                this._outputs.getVariable() +\n                ' = ' +\n                this._inputs[0].getVariable() +\n                ' + (' +\n                this._inputs[1].getVariable() +\n                ' * ' +\n                this._inputs[2].getVariable() +\n                ');'\n            );\n        },\n        MIX: function() {\n            // result = val0*(1.0-t) + t*val1\n            return (\n                this._outputs.getVariable() +\n                ' = mix(' +\n                this._inputs[0].getVariable() +\n                ', ' +\n                this._inputs[1].getVariable() +\n                ', ' +\n                this._inputs[2].getVariable() +\n                ');'\n            );\n        },\n        MULTIPLY: function() {\n            return (\n                this._outputs.getVariable() +\n                ' = ' +\n                this._inputs[0].getVariable() +\n                ' * mix( ' +\n                this._inputs[0].getType() +\n                '(1.0), ' +\n                this._inputs[1].getVariable() +\n                ', ' +\n                this._inputs[2].getVariable() +\n                ');'\n            );\n        }\n    })\n);\n\n// For all you custom needs.\n//\n// call Code() with variable input/output replace\n// indexed by the '%'\n// getNode( 'InlineCode' ).code( '%out = %input;' ).inputs( {\n//             input: this.getOrCreateConstant( 'float', 'unitFloat' ).setValue( '1.0' )\n//        } ).outputs( {\n//            out: this.getNode( 'glPointSize' )\n// }\n//\nvar InlineCode = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].call(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].createPrototypeObject(\n    InlineCode,\n    __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgShader_node_Node__[\"a\" /* default */].prototype, {\n        type: 'InlineCode',\n        code: function(txt) {\n            this._text = txt;\n            return this;\n        },\n        computeShader: function() {\n            // merge inputs and outputs dict to search in both\n            var replaceVariables = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectMix({}, this._inputs);\n            replaceVariables = __WEBPACK_IMPORTED_MODULE_1_osg_utils__[\"a\" /* default */].objectMix(replaceVariables, this._outputs);\n\n            // find all %string\n            var r = new RegExp('%[A-Za-z0-9_]+', 'gm');\n            var text = this._text;\n            var result = this._text.match(r);\n\n            var done = new Set(); // keep trace of replaced string\n\n            for (var i = 0; i < result.length; i++) {\n                var str = result[i].substr(1);\n                if (!done.has(str)) {\n                    if (!replaceVariables[str]) {\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('error with inline code\\n' + this._text);\n                        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].error('input ' + str + ' not provided for ' + result[i]);\n                    }\n                    var reg = new RegExp(result[i].toString(), 'gm');\n                    text = text.replace(reg, replaceVariables[str].getVariable());\n                    done.add(str);\n                }\n            }\n\n            return text;\n        }\n    }),\n    'osgShader',\n    'InlineCode'\n);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n    BaseOperator: BaseOperator,\n    Mult: Mult,\n    MatrixMultPosition: MatrixMultPosition,\n    MatrixMultDirection: MatrixMultDirection,\n    Add: Add,\n    Blend: Blend,\n    InlineCode: InlineCode,\n    SetFromNode: SetFromNode\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/node/operations.js\n// module id = 231\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/node/operations.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\nvar CompilerVertex = {\n    _createVertexShader: function() {\n        // Call to specialised inhenrited shader Compiler\n        var roots = this.declareVertexMain();\n        var vname = this.getVertexShaderName();\n        if (vname) roots.push(this.getNode('Define', 'SHADER_NAME').setValue(vname));\n\n        // call the graph compiler itself\n        var shader = this.createShaderFromGraphs(roots);\n\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].debug(this.getDebugIdentifier());\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].debug(shader);\n\n        return shader;\n    },\n\n    declareVertexMain: function() {\n        // Because of a weird bug on iOS, glPosition should be computed in the vertex shader before some varyings\n        var roots = [this.declarePointSize(), this.declareVertexPosition()];\n\n        this.declareVertexVaryings(roots);\n\n        return roots;\n    },\n\n    declarePointSize: function() {\n        var glPointSize = this.getNode('glPointSize');\n\n        if (!this._pointSizeAttribute || !this._pointSizeAttribute.isEnabled()) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateConstantOne('float'))\n                .outputs(glPointSize);\n            return glPointSize;\n        }\n\n        this.getNode('InlineCode')\n            .code('%pointSize = min(64.0, max(1.0, -%size / %position.z));')\n            .inputs({\n                position: this.getOrCreateViewVertex(),\n                size: this.getOrCreateUniform('float', 'uPointSize')\n            })\n            .outputs({\n                pointSize: glPointSize\n            });\n\n        return glPointSize;\n    },\n\n    declareVertexVaryings: function(roots) {\n        var varyings = this._varyings;\n\n        if (varyings.vModelVertex) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateModelVertex())\n                .outputs(varyings.vModelVertex);\n        }\n\n        if (varyings.vModelNormal) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateModelNormal())\n                .outputs(varyings.vModelNormal);\n        }\n\n        if (varyings.vModelTangent) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateModelTangent())\n                .outputs(varyings.vModelTangent);\n        }\n\n        if (varyings.vViewVertex) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateViewVertex())\n                .outputs(varyings.vViewVertex);\n        }\n\n        if (varyings.vViewNormal) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateViewNormal())\n                .outputs(varyings.vViewNormal);\n        }\n\n        if (varyings.vViewTangent) {\n            this.getNode('SetFromNode')\n                .inputs(this.getOrCreateViewTangent())\n                .outputs(varyings.vViewTangent);\n        }\n\n        if (varyings.vVertexColor) {\n            this.getNode('InlineCode')\n                .code('%vcolor = %venabled == 1.0 ? %acolor : vec4(1.0, 1.0, 1.0, 1.0);')\n                .inputs({\n                    venabled: this.getOrCreateUniform('float', 'uArrayColorEnabled'),\n                    acolor: this.getOrCreateAttribute('vec4', 'Color')\n                })\n                .outputs({\n                    vcolor: this.getOrCreateVarying('vec4', 'vVertexColor')\n                });\n        }\n\n        for (var keyVarying in varyings) {\n            var varying = varyings[keyVarying];\n            roots.push(varying);\n\n            var name = varying.getVariable();\n            if (name.indexOf('vTexCoord') !== -1) {\n                this.getNode('SetFromNode')\n                    .inputs(this.getOrCreateAttribute('vec2', name.substring(1)))\n                    .outputs(varying);\n            }\n        }\n    },\n\n    declareVertexPosition: function() {\n        var glPosition = this.getNode('glPosition');\n        if (this._isBillboard) this.declareVertexTransformBillboard(glPosition);\n        else this.declareScreenVertex(glPosition);\n        return glPosition;\n    },\n\n    declareScreenVertex: function(glPosition) {\n        this.getNode('MatrixMultPosition')\n            .inputs({\n                matrix: this.getOrCreateProjectionMatrix(),\n                vec: this.getOrCreateViewVertex()\n            })\n            .outputs({\n                vec: glPosition\n            });\n    },\n\n    declareVertexTransformBillboard: function(glPosition) {\n        this.getNode('Billboard')\n            .inputs({\n                Vertex: this.getOrCreateAttribute('vec3', 'Vertex'),\n                ModelViewMatrix: this.getOrCreateUniform('mat4', 'uModelViewMatrix'),\n                ProjectionMatrix: this.getOrCreateUniform('mat4', 'uProjectionMatrix')\n            })\n            .outputs({\n                result: glPosition\n            });\n    },\n\n    getOrCreateBoneMatrix: function() {\n        // reusable BoneMatrix between Vertex, Normal, Tangent\n        // Manadatory: scale animations must be uniform scale\n        var boneMatrix = this._variables.boneMatrix;\n        if (boneMatrix) return boneMatrix;\n        boneMatrix = this.createVariable('mat4', 'boneMatrix');\n\n        var inputWeights = this.getOrCreateAttribute('vec4', 'Weights');\n        var inputBones = this.getOrCreateAttribute('vec4', 'Bones');\n        var matrixPalette = this.getOrCreateUniform(\n            'vec4',\n            'uBones',\n            this._skinningAttribute.getBoneUniformSize()\n        );\n\n        this.getNode('Skinning')\n            .inputs({\n                weights: inputWeights,\n                bonesIndex: inputBones,\n                matrixPalette: matrixPalette\n            })\n            .outputs({\n                result: boneMatrix\n            });\n\n        return boneMatrix;\n    },\n\n    getTarget: function(name, i) {\n        var type = name.indexOf('Tangent') !== -1 ? 'vec4' : 'vec3';\n        return this.getOrCreateAttribute(type, name + '_' + i);\n    },\n\n    morphTangentApproximation: function(inputVertex, outputVertex) {\n        var normalizedMorph = this.getOrCreateLocalNormal();\n        // kind of tricky, here we retrieve the normalized normal after morphing\n        // if there is no rigging we do not recompute it\n        if (this._skinningAttribute) {\n            normalizedMorph = this.createVariable('vec3');\n            this.getNode('Normalize')\n                .inputs({\n                    vec: this.getOrCreateMorphNormal()\n                })\n                .outputs({\n                    result: normalizedMorph\n                });\n        }\n\n        this.getNode('InlineCode')\n            .code('%out = %tangent.rgb - dot(%tangent.rgb, %normal) * %normal;')\n            .inputs({\n                tangent: inputVertex,\n                normal: normalizedMorph\n            })\n            .outputs({\n                out: outputVertex\n            });\n\n        return outputVertex;\n    },\n\n    morphTransformVec3: function(inputVertex, outputVertex) {\n        var inputs = {\n            vertex: inputVertex,\n            weights: this.getOrCreateUniform('vec4', 'uTargetWeights')\n        };\n\n        var numTargets = this._morphAttribute.getNumTargets();\n        for (var i = 0; i < numTargets; i++) {\n            inputs['target' + i] = this.getTarget(inputVertex.getVariable(), i);\n        }\n\n        this.getNode('Morphing')\n            .inputs(inputs)\n            .outputs({\n                result: outputVertex\n            });\n\n        return outputVertex;\n    },\n\n    skinTransformVertex: function(inputVertex, outputVertex) {\n        this.getNode('MatrixMultPosition')\n            .setInverse(true)\n            .inputs({\n                matrix: this.getOrCreateBoneMatrix(),\n                vec: inputVertex\n            })\n            .outputs({\n                vec: outputVertex\n            });\n        return outputVertex;\n    },\n\n    skinTransformNormal: function(inputVertex, outputVertex) {\n        this.getNode('MatrixMultDirection')\n            .setInverse(true)\n            .inputs({\n                matrix: this.getOrCreateBoneMatrix(),\n                vec: inputVertex\n            })\n            .outputs({\n                vec: outputVertex\n            });\n        return outputVertex;\n    },\n\n    getOrCreateMorphVertex: function() {\n        var vecOut = this.getVariable('morphVertex');\n        if (vecOut) return vecOut;\n\n        var inputVertex = this.getOrCreateAttribute('vec3', 'Vertex');\n        if (!this._morphAttribute || !this._morphAttribute.hasTarget('Vertex')) return inputVertex;\n\n        return this.morphTransformVec3(inputVertex, this.createVariable('vec3', 'morphVertex'));\n    },\n\n    getOrCreateMorphNormal: function() {\n        var vecOut = this.getVariable('morphNormal');\n        if (vecOut) return vecOut;\n\n        var inputNormal = this.getOrCreateAttribute('vec3', 'Normal');\n        if (!this._morphAttribute || !this._morphAttribute.hasTarget('Normal')) return inputNormal;\n\n        return this.morphTransformVec3(inputNormal, this.createVariable('vec3', 'morphNormal'));\n    },\n\n    getOrCreateMorphTangent: function() {\n        var vecOut = this.getVariable('morphTangent');\n        if (vecOut) return vecOut;\n\n        var inputTangent = this.getOrCreateAttribute('vec4', 'Tangent');\n        var hasMorphTangent = this._morphAttribute && this._morphAttribute.hasTarget('Tangent');\n\n        if (!hasMorphTangent) return inputTangent;\n\n        return this.morphTransformVec3(inputTangent, this.createVariable('vec3', 'morphTangent'));\n\n        // if ( !hasMorphTangent && !this._morphAttribute && !this._morphAttribute.hasTarget( 'Normal' ) ) return inputTangent;\n\n        // if ( hasMorphTangent ) return this.morphTransformVec3( inputTangent, this.createVariable( 'vec3', 'morphTangent' ) );\n\n        // // Approximate tangent morphing depending of the normal morphing (disabled as we are not sure it's worth it for now)\n        // return this.morphTangentApproximation( inputTangent, this.createVariable( 'vec3', 'morphTangent' ) );\n    },\n\n    getOrCreateSkinVertex: function() {\n        var vecOut = this.getVariable('skinVertex');\n        if (vecOut) return vecOut;\n\n        var inputVertex = this.getOrCreateMorphVertex();\n        if (!this._skinningAttribute) return inputVertex;\n\n        return this.skinTransformVertex(inputVertex, this.createVariable('vec3', 'skinVertex'));\n    },\n\n    getOrCreateSkinNormal: function() {\n        var vecOut = this.getVariable('skinNormal');\n        if (vecOut) return vecOut;\n\n        var inputNormal = this.getOrCreateMorphNormal();\n        if (!this._skinningAttribute) return inputNormal;\n\n        return this.skinTransformNormal(inputNormal, this.createVariable('vec3', 'skinNormal'));\n    },\n\n    getOrCreateSkinTangent: function() {\n        var vecOut = this.getVariable('skinTangent');\n        if (vecOut) return vecOut;\n\n        var inputTangent = this.getOrCreateMorphTangent();\n        if (!this._skinningAttribute) return inputTangent;\n\n        return this.skinTransformNormal(inputTangent, this.createVariable('vec3', 'skinTangent'));\n    },\n\n    getOrCreateLocalVertex: function() {\n        return this.getOrCreateSkinVertex();\n    },\n\n    getOrCreateLocalNormal: function() {\n        var vecOut = this.getVariable('localNormal');\n        if (vecOut) return vecOut;\n\n        var normal = this.getOrCreateSkinNormal();\n        if (normal === this.getOrCreateAttribute('vec3', 'Normal')) return normal;\n\n        vecOut = this.createVariable('vec3', 'localNormal');\n        this.getNode('Normalize')\n            .inputs({\n                vec: normal\n            })\n            .outputs({\n                result: vecOut\n            });\n\n        return vecOut;\n    },\n\n    getOrCreateLocalTangent: function() {\n        var vecOut = this.getVariable('localTangent');\n        if (vecOut) return vecOut;\n\n        var inputTangent = this.getOrCreateAttribute('vec4', 'Tangent');\n        var tangent = this.getOrCreateSkinTangent();\n        if (tangent === inputTangent) return tangent;\n\n        return this.normalizeAndSetAlpha(\n            tangent,\n            inputTangent,\n            this.createVariable('vec4', 'localTangent')\n        );\n    },\n\n    normalizeAndSetAlpha: function(tang3, tang4, vecOut) {\n        var tangNormalized = this.createVariable('vec3');\n        this.getNode('Normalize')\n            .inputs({\n                vec: tang3\n            })\n            .outputs({\n                result: tangNormalized\n            });\n\n        this.getNode('SetAlpha')\n            .inputs({\n                color: tangNormalized,\n                alpha: tang4\n            })\n            .outputs({\n                result: vecOut\n            });\n\n        return vecOut;\n    }\n};\n\nvar wrapperVertexOnly = function(fn, name) {\n    return function() {\n        if (this._fragmentShaderMode) {\n            this.logError('This function should not be called from fragment shader : ' + name);\n        }\n        return fn.apply(this, arguments);\n    };\n};\n\nfor (var fnName in CompilerVertex) {\n    CompilerVertex[fnName] = wrapperVertexOnly(CompilerVertex[fnName], fnName);\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CompilerVertex);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/CompilerVertex.js\n// module id = 232\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/CompilerVertex.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Light__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_notify__ = __webpack_require__(2);\n\n\n\nvar CompilerFragment = {\n    _createFragmentShader: function() {\n        // Call to specialised inhenrited shader Compiler\n        var roots = this.createFragmentShaderGraph();\n        var fname = this.getFragmentShaderName();\n        if (fname) roots.push(this.getNode('Define', 'SHADER_NAME').setValue(fname));\n\n        var shader = this.createShaderFromGraphs(roots);\n\n        __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].debug(this.getDebugIdentifier());\n        __WEBPACK_IMPORTED_MODULE_1_osg_notify__[\"a\" /* default */].debug(shader);\n\n        this.cleanAfterFragment();\n\n        return shader;\n    },\n\n    applyPointSizeCircle: function(color) {\n        if (\n            !this._pointSizeAttribute ||\n            !this._pointSizeAttribute.isEnabled() ||\n            !this._pointSizeAttribute.isCircleShape()\n        ) {\n            return color;\n        }\n\n        this.getNode('InlineCode')\n            .code('if (length(2.0 * gl_PointCoord - 1.0) > %radius) discard;')\n            .inputs({\n                radius: this.getOrCreateConstantOne('float')\n            })\n            .outputs({\n                output: color\n            });\n\n        return color;\n    },\n\n    cleanAfterFragment: function() {\n        // reset for next\n        this._variables = {};\n        this._activeNodeMap = {};\n\n        // clean texture cache variable (for vertex shader re-usage)\n        for (var keyTexture in this._texturesByName) {\n            this._texturesByName[keyTexture].variable = undefined;\n        }\n\n        for (var keyVarying in this._varyings) {\n            var varying = this._varyings[keyVarying];\n            varying.reset();\n            this._activeNodeMap[varying.getID()] = varying;\n            this._variables[keyVarying] = varying;\n        }\n    },\n\n    createDefaultFragmentShaderGraph: function() {\n        var fofd = this.getOrCreateConstant('vec4', 'fofd').setValue('vec4(1.0, 0.0, 1.0, 0.7)');\n        var fragCol = this.getNode('glFragColor');\n        this.getNode('SetFromNode')\n            .inputs(fofd)\n            .outputs(fragCol);\n        return fragCol;\n    },\n\n    createFragmentShaderGraph: function() {\n        // shader graph can have multiple output (glPointsize, varyings)\n        // here named roots all outputs must be pushed inside\n        var roots = [];\n\n        // no material then return a default shader\n        if (!this._material) {\n            roots.push(this.createDefaultFragmentShaderGraph());\n            return roots;\n        }\n\n        var finalColor =\n            this._lights.length > 0 ? this.getLighting() : this.getOrCreateMaterialDiffuseColor();\n\n        var emission = this.getOrCreateMaterialEmission();\n        if (emission) {\n            var emit = this.createVariable('vec3');\n            this.getNode('Add')\n                .inputs(finalColor, emission)\n                .outputs(emit);\n            finalColor = emit;\n        }\n\n        var textureColor = this.getDiffuseColorFromTextures();\n        if (textureColor) {\n            var texColor = this.createVariable('vec3');\n            this.getNode('Mult')\n                .inputs(finalColor, textureColor)\n                .outputs(texColor);\n            finalColor = texColor;\n        }\n\n        var alpha = this.getAlpha();\n\n        // premult alpha\n        finalColor = this.getPremultAlpha(finalColor, alpha);\n\n        var fragColor = this.getNode('glFragColor');\n\n        this.applyPointSizeCircle(fragColor);\n\n        // todo add gamma corrected color, but it would also mean to handle correctly srgb texture\n        // so it should be done at the same time. see osg.Tetxure to implement srgb\n        this.getNode('SetAlpha')\n            .inputs({\n                color: finalColor,\n                alpha: alpha\n            })\n            .outputs({\n                result: fragColor\n            });\n\n        roots.push(fragColor);\n\n        return roots;\n    },\n\n    getAlpha: function() {\n        // compute alpha\n        var alpha = this.createVariable('float');\n        var textureTexel = this.getFirstValidTexture();\n\n        var inputs = {\n            color: this.getOrCreateMaterialDiffuseColor()\n        };\n        if (textureTexel) inputs.texelAlpha = textureTexel;\n\n        var str = textureTexel ? '%alpha = %color.a * %texelAlpha.a;' : '%alpha = %color.a;';\n\n        // Discard fragments totally transparents when rendering billboards\n        if (this._isBillboard) {\n            str += 'if ( %alpha == 0.0) discard;';\n        }\n\n        this.getNode('InlineCode')\n            .code(str)\n            .inputs(inputs)\n            .outputs({\n                alpha: alpha\n            });\n\n        return alpha;\n    },\n\n    getOrCreateFrontViewTangent: function() {\n        var out = this._variables.frontViewTangent;\n        if (out) return out;\n        out = this.createVariable('vec4', 'frontViewTangent');\n\n        this.getNode('FrontNormal')\n            .inputs({ normal: this.getOrCreateViewTangent() })\n            .outputs({ result: out });\n\n        return out;\n    },\n\n    getOrCreateFrontViewNormal: function() {\n        var out = this._variables.frontViewNormal;\n        if (out) return out;\n        out = this.createVariable('vec3', 'frontViewNormal');\n\n        this.getNode('FrontNormal')\n            .inputs({ normal: this.getOrCreateViewNormal() })\n            .outputs({ result: out });\n\n        return out;\n    },\n\n    getOrCreateNormalizedViewEyeDirection: function() {\n        var out = this._variables.eyeVector;\n        if (out) return out;\n        out = this.createVariable('vec3', 'eyeVector');\n\n        this.getNode('SetFromNode')\n            .inputs(this.getOrCreateViewVertex())\n            .outputs(out);\n\n        this.getNode('Normalize')\n            .inputs({ vec: out })\n            .outputs({ result: out });\n\n        this.getNode('Mult')\n            .inputs(out, this.createVariable('float').setValue('-1.0'))\n            .outputs(out);\n\n        return out;\n    },\n\n    getOrCreateNormalizedFrontViewNormal: function() {\n        var out = this._variables.nFrontViewNormal;\n        if (out) return out;\n        out = this.createVariable('vec3', 'nFrontViewNormal');\n\n        this.getNode('Normalize')\n            .inputs({ vec: this.getOrCreateFrontViewNormal() })\n            .outputs({ result: out });\n\n        return out;\n    },\n\n    getOrCreateFrontModelNormal: function() {\n        var out = this._variables.frontModelNormal;\n        if (out) return out;\n        out = this.createVariable('vec3', 'frontModelNormal');\n\n        this.getNode('FrontNormal')\n            .inputs({ normal: this.getOrCreateModelNormal() })\n            .outputs({ result: out });\n\n        return out;\n    },\n\n    getOrCreateNormalizedFrontModelNormal: function() {\n        var out = this._variables.nFrontModelNormal;\n        if (out) return out;\n        out = this.createVariable('vec3', 'nFrontModelNormal');\n\n        this.getNode('Normalize')\n            .inputs({ vec: this.getOrCreateFrontModelNormal() })\n            .outputs({ result: out });\n\n        return out;\n    },\n\n    getPremultAlpha: function(finalColor, alpha) {\n        if (alpha === undefined) return finalColor;\n\n        var premultAlpha = this.createVariable('vec4');\n\n        this.getNode('PreMultAlpha')\n            .inputs({ color: finalColor, alpha: alpha })\n            .outputs({ result: premultAlpha });\n\n        return premultAlpha;\n    },\n\n    getColorsRGB: function(finalColor) {\n        var finalSrgbColor = this.createVariable('vec3');\n        this.getNode('LinearTosRGB')\n            .inputs({ color: finalColor })\n            .outputs({ color: finalSrgbColor });\n\n        return finalSrgbColor;\n    },\n\n    multiplyDiffuseWithVertexColor: function(diffuseColor) {\n        var vertexColor = this.getOrCreateVarying('vec4', 'vVertexColor');\n        var vertexColorUniform = this.getOrCreateUniform('float', 'uArrayColorEnabled');\n        var tmp = this.createVariable('vec4');\n\n        var str = [\n            '',\n            '%color = %diffuse;',\n            'if ( %hasVertexColor == 1.0)',\n            '  %color *= %vertexColor;'\n        ].join('\\n');\n\n        this.getNode('InlineCode')\n            .code(str)\n            .inputs({\n                diffuse: diffuseColor,\n                hasVertexColor: vertexColorUniform,\n                vertexColor: vertexColor\n            })\n            .outputs({ color: tmp })\n            .comment('diffuse color = diffuse color * vertex color');\n\n        return tmp;\n    },\n\n    getDiffuseColorFromTextures: function() {\n        var texturesInput = [];\n        var textures = this._texturesByName;\n\n        for (var keyTexture in textures) {\n            var texture = textures[keyTexture];\n\n            if (texture.shadow) continue;\n\n            texturesInput.push(this.getTextureByName(keyTexture).variable);\n        }\n\n        // if multi texture multiply them all with diffuse\n        // but if only one, return the first\n        if (texturesInput.length > 1) {\n            var texAccum = this.createVariable('vec3', 'texDiffuseAccum');\n\n            this.getNode('Mult')\n                .inputs(texturesInput)\n                .outputs(texAccum);\n            return texAccum;\n        } else if (texturesInput.length === 1) {\n            return texturesInput[0];\n        }\n\n        return undefined;\n    },\n\n    getFirstValidTexture: function() {\n        var textures = this._textures;\n        for (var i = 0, nb = textures.length; i < nb; ++i) {\n            var tex = textures[i];\n            if (tex) return this.getTextureByName(tex.getName()).variable;\n        }\n        return undefined;\n    },\n\n    _getShadowReceiveAttributeFromLightNum: function(array, lightNum) {\n        // array is shadow textures or shadow receive attributes\n        for (var i = 0; i < array.length; i++) {\n            var shadow = array[i];\n            if (shadow && shadow.getLightNumber() === lightNum) {\n                return shadow;\n            }\n        }\n    },\n\n    _getShadowTextureFromLightNum: function(array, lightNum) {\n        // array is shadow textures or shadow receive attributes\n        for (var i = 0; i < array.length; i++) {\n            var shadow = array[i];\n            if (shadow && shadow.hasLightNumber(lightNum)) {\n                return shadow;\n            }\n        }\n    },\n\n    getInputsFromShadow: function(shadowReceive, shadowTexture, lighted, lightNum) {\n        var shadowUniforms = shadowReceive.getOrCreateUniforms();\n        var tUnit = this._shadowsTextures.indexOf(shadowTexture);\n        var textureUniforms = shadowTexture.getOrCreateUniforms(tUnit);\n\n        var suffix = shadowReceive.getAtlas() ? '_' + lightNum : '';\n        var inputs = {\n            lighted: lighted,\n            normalWorld: this.getOrCreateNormalizedFrontModelNormal(),\n            vertexWorld: this.getOrCreateModelVertex(),\n            shadowTexture: this.getOrCreateSampler('sampler2D', 'Texture' + tUnit),\n            shadowSize: this.getOrCreateUniform(textureUniforms['RenderSize']),\n            shadowProjection: this.getOrCreateUniform(textureUniforms['Projection' + suffix]),\n\n            shadowViewRight: this.getOrCreateUniform(textureUniforms['ViewRight' + suffix]),\n            shadowViewUp: this.getOrCreateUniform(textureUniforms['ViewUp' + suffix]),\n            shadowViewLook: this.getOrCreateUniform(textureUniforms['ViewLook' + suffix]),\n\n            shadowDepthRange: this.getOrCreateUniform(textureUniforms['DepthRange' + suffix]),\n            shadowBias: this.getOrCreateUniform(shadowUniforms.bias)\n        };\n\n        if (shadowReceive.getAtlas())\n            inputs.atlasSize = this.getOrCreateUniform(textureUniforms['MapSize' + suffix]);\n        if (shadowReceive.getNormalBias())\n            inputs.normalBias = this.getOrCreateUniform(shadowUniforms.normalBias);\n\n        return inputs;\n    },\n\n    getOrCreateDistanceShadow: function(num) {\n        if (!this._computeShadowOutDistance) return undefined;\n\n        var varName = 'shadowDistance' + num;\n        var distance = this.getVariable(varName);\n        if (!distance) distance = this.createVariable('float', varName).setValue('0.0');\n        return distance;\n    },\n\n    getOrCreateJitterShadow: function() {\n        return false;\n    },\n\n    hasLightShadow: function(lightNum) {\n        var shadowTexture = this._getShadowTextureFromLightNum(this._shadowsTextures, lightNum);\n        var shadowReceive = this._getShadowReceiveAttributeFromLightNum(this._shadows, lightNum);\n        return !!shadowTexture && !!shadowReceive;\n    },\n\n    createShadowingLight: function(light, lighted) {\n        var lightNum = light.getLightNumber();\n        var shadowTexture = this._getShadowTextureFromLightNum(this._shadowsTextures, lightNum);\n        var shadowReceive = this._getShadowReceiveAttributeFromLightNum(this._shadows, lightNum);\n        if (!shadowTexture || !shadowReceive) return undefined;\n\n        var inputs = this.getInputsFromShadow(shadowReceive, shadowTexture, lighted, lightNum);\n\n        var shadowedOutput = this.createVariable('float');\n        var outputs = {\n            result: shadowedOutput\n        };\n\n        var defines = shadowReceive.getDefines();\n\n        var outDistance = this.getOrCreateDistanceShadow(lightNum);\n        if (outDistance) {\n            outputs.outDistance = outDistance;\n            defines.push('#define _OUT_DISTANCE');\n        }\n\n        var doJitter = this.getOrCreateJitterShadow(lightNum);\n        if (doJitter) {\n            inputs.jitter = doJitter;\n        }\n\n        this.getNode('ShadowReceive')\n            .inputs(inputs)\n            .outputs(outputs)\n            .addDefines(defines);\n\n        return shadowedOutput;\n    },\n\n    getOrCreateMaterialNormal: function() {\n        return this.getOrCreateNormalizedFrontViewNormal();\n    },\n\n    getOrCreateMaterialDiffuseColor: function() {\n        var matDiffuse = this.getVariable('materialDiffuseColor');\n        if (matDiffuse) return matDiffuse;\n        matDiffuse = this.createVariable('vec4', 'materialDiffuseColor');\n\n        var diffuse = this.getOrCreateUniform(this._material.getOrCreateUniforms().diffuse);\n        this.getNode('Mult')\n            .inputs(this.multiplyDiffuseWithVertexColor(diffuse))\n            .outputs(matDiffuse);\n\n        return matDiffuse;\n    },\n\n    getOrCreateMaterialEmission: function() {\n        return this.getOrCreateUniform(this._material.getOrCreateUniforms().emission);\n    },\n\n    getOrCreateMaterialSpecularColor: function() {\n        return this.getOrCreateUniform(this._material.getOrCreateUniforms().specular);\n    },\n\n    getOrCreateMaterialSpecularHardness: function() {\n        return this.getOrCreateUniform(this._material.getOrCreateUniforms().shininess);\n    },\n\n    getOrCreateMaterialAmbient: function() {\n        return this.getOrCreateUniform(this._material.getOrCreateUniforms().ambient);\n    },\n\n    getLighting: function() {\n        if (this._lights.length === 0) return undefined;\n\n        var res = this.getLightingSeparate();\n        var output = this.createVariable('vec3');\n        this.getNode('Add')\n            .inputs(res.diffuse, res.specular)\n            .outputs(output);\n\n        return output;\n    },\n\n    getLightingSeparate: function() {\n        if (this._lights.length === 0) return undefined;\n\n        // return contribution of diffuse and specular lights\n        var diffuseSum = [];\n        var specularSum = [];\n\n        for (var i = 0; i < this._lights.length; i++) {\n            var light = this._lights[i];\n            var outputs = this.getLightSeparate(light);\n            diffuseSum.push(outputs.diffuseOut);\n            specularSum.push(outputs.specularOut);\n        }\n\n        var finalDiffuse;\n        var finalSpecular;\n        if (this._lights.length === 1) {\n            finalDiffuse = diffuseSum[0];\n            finalSpecular = specularSum[0];\n        } else {\n            finalDiffuse = this.createVariable('vec3');\n            this.getNode('Add')\n                .inputs(diffuseSum)\n                .outputs(finalDiffuse);\n\n            finalSpecular = this.createVariable('vec3');\n            this.getNode('Add')\n                .inputs(specularSum)\n                .outputs(finalSpecular);\n        }\n\n        return {\n            diffuse: finalDiffuse,\n            specular: finalSpecular\n        };\n    },\n\n    getLightSeparate: function(light) {\n        var precompute = this.getPrecomputeLight(light);\n        var outputs = this.getLightWithPrecompute(light, precompute);\n\n        var shadowFactor = this.createShadowingLight(light, outputs.lighted);\n        if (shadowFactor) {\n            this.getNode('Mult')\n                .inputs(outputs.diffuseOut, shadowFactor)\n                .outputs(outputs.diffuseOut);\n            this.getNode('Mult')\n                .inputs(outputs.specularOut, shadowFactor)\n                .outputs(outputs.specularOut);\n        }\n\n        var ambient = this.getAmbientLight(light);\n        if (ambient)\n            this.getNode('Add')\n                .inputs(outputs.diffuseOut, ambient)\n                .outputs(outputs.diffuseOut);\n\n        return {\n            diffuseOut: outputs.diffuseOut,\n            specularOut: outputs.specularOut,\n            // below can be used re-used if needed (sss, etc...)\n            lighted: outputs.lighted,\n            attenuation: precompute.attenuation,\n            eyeLightDir: precompute.eyeLightDir,\n            dotNL: precompute.dotNL\n        };\n    },\n\n    getPrecomputeLight: function(light) {\n        var lightUniforms = light.getOrCreateUniforms();\n\n        var outputs = {\n            attenuation: this.createVariable('float'),\n            eyeLightDir: this.createVariable('vec3'),\n            dotNL: this.createVariable('float')\n        };\n\n        var inputs = {\n            normal: this.getOrCreateMaterialNormal()\n        };\n\n        var nodeName;\n\n        var lightType = light.getLightType();\n        if (lightType === __WEBPACK_IMPORTED_MODULE_0_osg_Light__[\"a\" /* default */].POINT) {\n            nodeName = 'PrecomputePoint';\n\n            inputs.viewVertex = this.getOrCreateViewVertex();\n            inputs.lightAttenuation = this.getOrCreateUniform(lightUniforms.attenuation);\n            inputs.lightViewPosition = this.getOrCreateUniform(lightUniforms.viewPosition);\n        } else if (lightType === __WEBPACK_IMPORTED_MODULE_0_osg_Light__[\"a\" /* default */].SPOT) {\n            nodeName = 'PrecomputeSpot';\n\n            inputs.viewVertex = this.getOrCreateViewVertex();\n            inputs.lightViewDirection = this.getOrCreateUniform(lightUniforms.viewDirection);\n            inputs.lightAttenuation = this.getOrCreateUniform(lightUniforms.attenuation);\n            inputs.lightSpotCutOff = this.getOrCreateUniform(lightUniforms.spotCutOff);\n            inputs.lightSpotBlend = this.getOrCreateUniform(lightUniforms.spotBlend);\n            inputs.lightViewPosition = this.getOrCreateUniform(lightUniforms.viewPosition);\n        } else {\n            nodeName = 'PrecomputeSun';\n            inputs.lightViewDirection = this.getOrCreateUniform(lightUniforms.viewDirection);\n        }\n\n        this.getNode(nodeName)\n            .inputs(inputs)\n            .outputs(outputs);\n        return outputs;\n    },\n\n    getLightWithPrecompute: function(light, precompute) {\n        var lightUniforms = light.getOrCreateUniforms();\n\n        var inputs = {\n            normal: this.getOrCreateMaterialNormal(),\n            eyeVector: this.getOrCreateNormalizedViewEyeDirection(),\n            dotNL: precompute.dotNL,\n            attenuation: precompute.attenuation,\n\n            materialDiffuse: this.getOrCreateMaterialDiffuseColor(),\n            materialSpecular: this.getOrCreateMaterialSpecularColor(),\n            materialShininess: this.getOrCreateMaterialSpecularHardness(),\n\n            lightDiffuse: this.getOrCreateUniform(lightUniforms.diffuse),\n            lightSpecular: this.getOrCreateUniform(lightUniforms.specular),\n            eyeLightDir: precompute.eyeLightDir\n        };\n\n        var nodeName = 'ComputeLightLambertCookTorrance';\n        if (light.getLightType() === __WEBPACK_IMPORTED_MODULE_0_osg_Light__[\"a\" /* default */].HEMI) {\n            inputs.lightGround = this.getOrCreateUniform(lightUniforms.ground);\n            nodeName = 'HemiLight';\n        }\n\n        var outputs = this.getOutputsFromLight();\n        this.getNode(nodeName)\n            .inputs(inputs)\n            .outputs(outputs);\n\n        return outputs;\n    },\n\n    getAmbientLight: function(light) {\n        var ambient = this.createVariable('vec3');\n        var lightAmbient = this.getOrCreateUniform(light.getOrCreateUniforms().ambient);\n        var materialAmbient = this.getOrCreateMaterialAmbient();\n        this.getNode('Mult')\n            .inputs(materialAmbient, lightAmbient)\n            .outputs(ambient);\n        return ambient;\n    },\n\n    getOutputsFromLight: function() {\n        var outputs = {\n            diffuseOut: this.createVariable('vec3'),\n            specularOut: this.createVariable('vec3'),\n            lighted: this.createVariable('bool')\n        };\n\n        // the light glsl function always output this boolean\n        // even if no shadowmaping (so the variable ends up unused)\n        outputs.lighted.silenceWarning = true;\n\n        return outputs;\n    },\n\n    createTextureRGBA: function(texture, textureSampler, texCoord) {\n        // but we could later implement srgb inside and read differents flag\n        // as read only in the texture\n\n        var texel = this.createVariable('vec4');\n        this.getNode('TextureRGBA')\n            .inputs({ tex: textureSampler, uv: texCoord })\n            .outputs({ result: texel });\n\n        return texel;\n    }\n};\n\nvar wrapperFragmentOnly = function(fn, name) {\n    return function() {\n        if (!this._fragmentShaderMode) {\n            this.logError('This function should not be called from vertex shader : ' + name);\n        }\n        return fn.apply(this, arguments);\n    };\n};\n\nfor (var fnName in CompilerFragment) {\n    CompilerFragment[fnName] = wrapperFragmentOnly(CompilerFragment[fnName], fnName);\n}\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (CompilerFragment);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShader/CompilerFragment.js\n// module id = 233\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShader/CompilerFragment.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgUtil_DisplayGraphNode__ = __webpack_require__(157);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_RenderBin__ = __webpack_require__(61);\n\n\n\nvar DisplayGraphRenderer = function(selectables) {\n    this._selectables = selectables;\n    this._nodeList = [];\n    this._linkList = [];\n\n    this._renderBinMap = new window.Map();\n    this._renderBinStack = [];\n\n    this._generatorID = 0;\n    this._refID = 0; // invalide old _instanceID if we recreate the graph\n\n    this._uniqueEdges = new window.Set();\n};\n\nDisplayGraphRenderer.prototype = {\n    getColorFromClassName: __WEBPACK_IMPORTED_MODULE_0_osgUtil_DisplayGraphNode__[\"a\" /* default */].prototype.getColorFromClassName,\n\n    createGraph: function(renderBin) {\n        this.reset();\n        this.apply(renderBin);\n    },\n\n    reset: function() {\n        this._renderBinMap.clear();\n        this._renderBinStack.length = 0;\n        this._generatorID = 0;\n        this._refID++;\n\n        this._nodeList.length = 0;\n        this._linkList.length = 0;\n\n        this._uniqueEdges.clear();\n    },\n\n    apply: function(rb) {\n        var instanceID = rb.getInstanceID();\n        if (!this._renderBinMap.has(instanceID)) {\n            this._renderBinMap.set(instanceID, rb);\n        }\n\n        this._renderBinStack.push(rb);\n\n        // pre render stage if render stage node\n        if (rb.getPreRenderStageList) {\n            var preRenderList = rb.getPreRenderStageList();\n            for (var i = 0, ni = preRenderList.length; i < ni; ++i) {\n                this.apply(preRenderList[i].renderStage);\n            }\n        }\n\n        // draw implementation\n        // handle rs camera\n        this.registerNode(rb);\n\n        // post render stage if render stage node\n        if (rb.getPostRenderStageList) {\n            var postRenderList = rb.getPostRenderStageList();\n            for (var j = 0, nj = postRenderList.length; j < nj; ++j) {\n                this.apply(postRenderList[j].renderStage);\n            }\n        }\n\n        this._renderBinStack.pop();\n    },\n\n    registerNode: function(rb) {\n        var childID = rb.getInstanceID();\n\n        this._nodeList.push(rb);\n\n        // register bins\n        var bins = rb._bins;\n        bins.forEach(\n            function(key, bin) {\n                this.apply(bin);\n            }.bind(this)\n        );\n\n        // register fine grained leafs\n        if (rb._leafs.length) {\n            for (var j = 0, nj = rb._leafs.length; j < nj; j++) {\n                this.createNodeAndSetID(childID, rb._leafs[j]);\n            }\n        }\n\n        var self = this;\n        var context = {};\n\n        var leafFunction = function(leaf) {\n            self.createNodeAndSetID(this.stateGraphID, leaf);\n        }.bind(context);\n\n        var stateGraphFunction = function(sg) {\n            self.createNodeAndSetID(childID, sg);\n            var stateGraphID = sg._instanceID;\n            var leafsPool = sg.getLeafs();\n            context.stateGraphID = stateGraphID;\n            leafsPool.forEach(leafFunction);\n        };\n        // register coarse grained leafs\n        var stateGraphList = rb.getStateGraphList();\n        stateGraphList.forEach(stateGraphFunction);\n\n        // no parent no link\n        if (this._renderBinStack.length < 2) return;\n\n        var parentID = this._renderBinStack[this._renderBinStack.length - 2].getInstanceID();\n        this.createLink(parentID, childID);\n    },\n\n    createLink: function(parent, child) {\n        var key = parent + '+' + child;\n        if (!this._uniqueEdges.has(key)) {\n            this._linkList.push({\n                parentNode: parent,\n                childrenNode: child\n            });\n            this._uniqueEdges.add(key);\n        }\n    },\n\n    createNodeAndSetID: function(parentID, node) {\n        // register render leaf\n        this._nodeList.push(node);\n\n        // generate fake id < 0 because RenderLeaf does not inherit from Object\n        if (\n            node._instanceID === undefined ||\n            (node._instanceID < 0 && node._refID !== this._refID)\n        ) {\n            node._instanceID = -1 - this._generatorID++;\n            node._refID = this._refID;\n        }\n\n        this.createLink(parentID, node._instanceID);\n    },\n\n    generateRenderLeaf: function(g, node) {\n        var instanceID = node._instanceID;\n        var className = 'RenderLeaf';\n        var geomName =\n            node._geometry && node._geometry.getName()\n                ? '\\n' + node._geometry.getName()\n                : 'Geometry';\n\n        var label = className + ' ( ' + node._instanceID + ' )';\n        label += '\\n' + geomName + ' ( ' + node._geometry.getInstanceID() + ' )';\n\n        this._selectables.set(instanceID.toString(), node);\n        g.addNode(instanceID, {\n            label: label,\n            description: '',\n            style: 'fill: ' + this.getColorFromClassName(className) + ';stroke-width: 0px;'\n        });\n    },\n\n    generateStateGraph: function(g, node) {\n        var instanceID = node._instanceID;\n        var className = 'StateGraph';\n        var label = className + ' ( ' + node._instanceID + ' )';\n        label += '\\n' + node._leafs._length + ' leafs';\n\n        this._selectables.set(instanceID.toString(), node);\n        g.addNode(instanceID, {\n            label: label,\n            description: '',\n            style: 'fill: ' + this.getColorFromClassName(className) + ';stroke-width: 0px;'\n        });\n    },\n\n    generateRenderStage: function(g, node) {\n        var label = node.className() + ' ( ' + node._instanceID + ' )';\n        if (node.getName()) label += '\\n' + node.getName();\n        label +=\n            '\\nViewport ( ' +\n            node.getViewport().width() +\n            ' x ' +\n            node.getViewport().height() +\n            ' )';\n\n        this._selectables.set(node.getInstanceID().toString(), node);\n        g.addNode(node.getInstanceID(), {\n            label: label,\n            description: '',\n            style: 'fill: ' + this.getColorFromClassName(node.className()) + ';stroke-width: 0px;'\n        });\n    },\n\n    generateRenderBin: function(g, rb) {\n        var label = rb.className() + ' ( ' + rb.getInstanceID() + ' )';\n        if (rb.getName()) label += '\\n' + rb.getName();\n\n        var sortMode = '';\n        if (rb.getSortMode() === __WEBPACK_IMPORTED_MODULE_1_osg_RenderBin__[\"a\" /* default */].SORT_BACK_TO_FRONT) sortMode = 'SortMode: BackToFront';\n\n        var description = 'BinNumber: ' + rb.getBinNumber() + '\\n' + sortMode;\n\n        this._selectables.set(rb.getInstanceID().toString(), rb);\n        g.addNode(rb.getInstanceID(), {\n            label: label,\n            description: description,\n            style: 'fill: ' + this.getColorFromClassName(rb.className()) + ';stroke-width: 0px;'\n        });\n    },\n\n    // Subfunction of createGraph, will iterate to create all the node and link in dagre\n    generateNodeAndLink: function(g) {\n        for (var i = 0, ni = this._nodeList.length; i < ni; i++) {\n            var node = this._nodeList[i];\n\n            // detect if RenderLeaf\n            if (node._geometry && node._depth !== undefined) {\n                this.generateRenderLeaf(g, node);\n            } else if (node.className() === 'StateGraph') {\n                this.generateStateGraph(g, node);\n            } else if (node.className() === 'RenderStage') {\n                this.generateRenderStage(g, node);\n            } else {\n                // it's a RenderBin\n                this.generateRenderBin(g, node);\n            }\n        }\n\n        for (var j = 0, nj = this._linkList.length; j < nj; j++) {\n            g.addEdge(null, this._linkList[j].parentNode, this._linkList[j].childrenNode);\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DisplayGraphRenderer);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/DisplayGraphRenderer.js\n// module id = 234\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/DisplayGraphRenderer.js?")},function(module,exports){eval('if(typeof __WEBPACK_EXTERNAL_MODULE_235__ === \'undefined\') {var e = new Error("Cannot find module \\"undefined\\""); e.code = \'MODULE_NOT_FOUND\'; throw e;}\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_235__;\n\n//////////////////\n// WEBPACK FOOTER\n// external {"root":"$","commonjs2":"jquery","commonjs":"jquery","amd":"jquery"}\n// module id = 235\n// module chunks = 0\n\n//# sourceURL=webpack:///external_%7B%22root%22:%22$%22,%22commonjs2%22:%22jquery%22,%22commonjs%22:%22jquery%22,%22amd%22:%22jquery%22%7D?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Depth__ = __webpack_require__(32);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_CullFace__ = __webpack_require__(50);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgUtil_IntersectionVisitor__ = __webpack_require__(54);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgUtil_LineSegmentIntersector__ = __webpack_require__(55);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__ = __webpack_require__(159);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_utils__ = __webpack_require__(0);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar getCanvasCoord = function(vec, e) {\n    vec[0] = e.offsetX === undefined ? e.layerX : e.offsetX;\n    vec[1] = e.offsetY === undefined ? e.layerY : e.offsetY;\n};\n\nvar HideCullCallback = function() {};\nHideCullCallback.prototype = {\n    cull: function() {\n        return false;\n    }\n};\n\nvar blendAttribute = new __WEBPACK_IMPORTED_MODULE_4_osg_BlendFunc__["a" /* default */](__WEBPACK_IMPORTED_MODULE_4_osg_BlendFunc__["a" /* default */].SRC_ALPHA, __WEBPACK_IMPORTED_MODULE_4_osg_BlendFunc__["a" /* default */].ONE_MINUS_SRC_ALPHA);\n\nvar LineCustomIntersector = function(testPlane) {\n    this._testPlane = testPlane; // intersection plane or line\n    this._inter = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create(); // translate distance\n    __WEBPACK_IMPORTED_MODULE_9_osgUtil_LineSegmentIntersector__["a" /* default */].call(this);\n};\n__WEBPACK_IMPORTED_MODULE_12_osg_utils__["a" /* default */].createPrototypeObject(\n    LineCustomIntersector,\n    __WEBPACK_IMPORTED_MODULE_12_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_9_osgUtil_LineSegmentIntersector__["a" /* default */].prototype, {\n        setTestPlane: function(testPlane) {\n            this._testPlane = testPlane; // intersection plane or line\n        },\n        getTranslateDistance: function() {\n            return this._inter;\n        },\n        enter: (function() {\n            var axis = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n            var dir = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(node) {\n                if (node._nbAxis === undefined) return true;\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].init(axis);\n                axis[node._nbAxis] = 1.0;\n                if (!this._testPlane) {\n                    // intersection line line\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].normalize(dir, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].sub(dir, this._iEnd, this._iStart));\n\n                    var a01 = -__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].dot(dir, axis);\n                    var b0 = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].dot(this._iStart, dir);\n                    var det = Math.abs(1.0 - a01 * a01);\n\n                    var b1 = -__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].dot(this._iStart, axis);\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].init(this._inter);\n                    this._inter[node._nbAxis] = (a01 * b0 - b1) / det;\n                } else {\n                    // intersection line plane\n                    var dist1 = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].dot(this._iStart, axis);\n                    var dist2 = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].dot(this._iEnd, axis);\n                    // ray copplanar to triangle\n                    if (dist1 === dist2) return false;\n                    // intersection between ray and triangle\n                    var val = -dist1 / (dist2 - dist1);\n                    this._inter[0] = this._iStart[0] + (this._iEnd[0] - this._iStart[0]) * val;\n                    this._inter[1] = this._iStart[1] + (this._iEnd[1] - this._iStart[1]) * val;\n                    this._inter[2] = this._iStart[2] + (this._iEnd[2] - this._iStart[2]) * val;\n                }\n                return false;\n            };\n        })(),\n        intersectTriangle: function() {},\n        intersectLine: function() {},\n        intersectPoint: function() {}\n    }),\n    \'osgUtil\',\n    \'LineCustomIntersector\'\n);\n\n// for getWorldMatrix\nvar _TMP_MAT = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n\n// The MT node can be detected as such because they\n// have a \'_nbAxis\' property on them (x=0, y=1, z=2)\n//\n// MatrixTransform _________________________________________\n//           |                    |                         |\n//    ____ Rotate             Translate               TranslatePlane\n//   |     / | \\                / | \\                     / | \\\n//   MT   MT MT MT             MT MT MT                  MT MT MT\n//   |     \\ | /                \\ | /                     \\ | /\n// FullArc  \\|/                  \\|/                       \\|/\n//       ____|_____            ___|________              ___|________\n//      |          |          |            |            |            |\n//   DrawArc   HideNode   DrawArrow    HideNode     DrawPlane    HideNode\n//                 |                       |                         |\n//              PickArc                PickArrow                  PickPlane\n//\nvar NodeGizmo = function(viewer) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */].call(this);\n\n    this._tmask = 1; // traversal mask when picking the scene\n\n    // When attaching the gizmo on a node, there\'s 2 ways:\n    // - if _autoInsertMT is true and no direct parent has an editMask\n    //   we insert a matrixTransform that we are going to edit\n    // - otherwise we look for the nearest MatrixTransform with an editMask on the graph\n    this._autoInsertMT = false;\n    this._correctPivotOnAutoInsert = false;\n\n    this._viewer = viewer;\n    this._canvas = viewer.getGraphicContext().canvas;\n    this._manipulator = viewer.getManipulator();\n\n    this._rotateNode = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n    this._translateNode = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n    this._planeNode = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n\n    this._rotateInLocal = true; // local vs world space\n    this._translateInLocal = true; // local vs world space\n    this._showAngle = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n\n    //for realtime picking\n    this._downCanvasCoord = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].create();\n    this._hoverNode = null; // the hovered x/y/z MT node\n    this._keepHoverColor = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].create();\n\n    // for editing\n    this._isEditing = false;\n\n    this._editLineOrigin = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n    this._editLineDirection = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n    this._editOffset = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n    // cached matrices when starting the editing operations\n    this._editLocal = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n    this._editWorldTrans = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n    this._editWorldScaleRot = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n    this._editInvWorldScaleRot = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n\n    // red line, it can be useful as helpers too\n    this._debugNode = new __WEBPACK_IMPORTED_MODULE_0_osg_Node__["a" /* default */]();\n\n    this._lastDistToEye = 0.0; // see updateGizmo comment\n\n    this._attachedNode = null;\n    this._pivotOffset = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create(); // to center the gizmo and rotation pivot when inserting MT\n    this.attachToNode(null);\n\n    // Intersectors\n    this._lsi = new LineCustomIntersector();\n    this._origIntersect = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n    this._dstIntersect = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n    this._iv = new __WEBPACK_IMPORTED_MODULE_8_osgUtil_IntersectionVisitor__["a" /* default */]();\n    this._iv.setIntersector(this._lsi);\n\n    this.init();\n};\n\n// picking masks\nNodeGizmo.NO_PICK = 1 << 0;\n\nNodeGizmo.PICK_ARC_X = 1 << 1;\nNodeGizmo.PICK_ARC_Y = 1 << 2;\nNodeGizmo.PICK_ARC_Z = 1 << 3;\n\nNodeGizmo.PICK_ARROW_X = 1 << 4;\nNodeGizmo.PICK_ARROW_Y = 1 << 5;\nNodeGizmo.PICK_ARROW_Z = 1 << 6;\n\nNodeGizmo.PICK_PLANE_X = 1 << 7;\nNodeGizmo.PICK_PLANE_Y = 1 << 8;\nNodeGizmo.PICK_PLANE_Z = 1 << 9;\n\nNodeGizmo.NO_FULL_CIRCLE = 1 << 10; // don\'t display the full non pickable circle (visual cue)\nNodeGizmo.CORRECT_PIVOT = 1 << 11; // recompute pivot to center of bound node instead of local origin\n\nNodeGizmo.PICK_ARC = NodeGizmo.PICK_ARC_X | NodeGizmo.PICK_ARC_Y | NodeGizmo.PICK_ARC_Z;\nNodeGizmo.PICK_ARROW = NodeGizmo.PICK_ARROW_X | NodeGizmo.PICK_ARROW_Y | NodeGizmo.PICK_ARROW_Z;\nNodeGizmo.PICK_PLANE = NodeGizmo.PICK_PLANE_X | NodeGizmo.PICK_PLANE_Y | NodeGizmo.PICK_PLANE_Z;\n\nNodeGizmo.PICK_GIZMO = NodeGizmo.PICK_ARC | NodeGizmo.PICK_ARROW | NodeGizmo.PICK_PLANE;\n\n// retrieve nearest editable node\nvar GetNearestEditableNode = function() {\n    __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].TRAVERSE_PARENTS);\n    this._editableNode = null;\n};\n\n__WEBPACK_IMPORTED_MODULE_12_osg_utils__["a" /* default */].createPrototypeObject(\n    GetNearestEditableNode,\n    __WEBPACK_IMPORTED_MODULE_12_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype, {\n        reset: function() {\n            __WEBPACK_IMPORTED_MODULE_1_osg_NodeVisitor__["a" /* default */].prototype.reset.call(this);\n            this._editableNode = null;\n        },\n        getEditableNode: function() {\n            return this._editableNode;\n        },\n        apply: function(node) {\n            if (this._editableNode) return;\n\n            var editMask = node.editMask;\n            if (editMask && editMask & NodeGizmo.PICK_GIZMO) {\n                this._editableNode = node;\n                return;\n            }\n\n            this.traverse(node);\n        }\n    })\n);\n\n__WEBPACK_IMPORTED_MODULE_12_osg_utils__["a" /* default */].createPrototypeNode(\n    NodeGizmo,\n    __WEBPACK_IMPORTED_MODULE_12_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */].prototype, {\n        setRotateInLocal: function(bool) {\n            this._rotateInLocal = bool;\n        },\n\n        setTranslateInLocal: function(bool) {\n            this._translateInLocal = bool;\n        },\n\n        setTraversalMask: function(tmask) {\n            this._tmask = tmask;\n        },\n\n        setAutoMatrixTransformInsertion: function(bool) {\n            this._autoInsertMT = bool;\n        },\n\n        setCorrectPivotOnAutoInsert: function(bool) {\n            this._correctPivotOnAutoInsert = bool;\n        },\n\n        isEditing: function() {\n            return this._isEditing;\n        },\n\n        getAttachedNode: function() {\n            return this._attachedNode;\n        },\n\n        init: function() {\n            this.getOrCreateStateSet().setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_3_osg_Depth__["a" /* default */](__WEBPACK_IMPORTED_MODULE_3_osg_Depth__["a" /* default */].DISABLE));\n            this.getOrCreateStateSet().setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_5_osg_CullFace__["a" /* default */](__WEBPACK_IMPORTED_MODULE_5_osg_CullFace__["a" /* default */].DISABLE));\n\n            this.addUpdateCallback(this);\n            this.addChild(this.initNodeTranslate());\n            this.addChild(this.initNodeTranslatePlane());\n            this.addChild(this.initNodeRotate());\n            if (this._debugNode) {\n                this._debugNode.addChild(__WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createDebugLineGeometry());\n                this.addChild(this._debugNode);\n                this._debugNode.setNodeMask(0x0);\n            }\n\n            var canvas = this._canvas;\n            canvas.addEventListener(\'mousemove\', this.onMouseMove.bind(this));\n            canvas.addEventListener(\'mousedown\', this.onMouseDown.bind(this));\n            canvas.addEventListener(\'mouseup\', this.onMouseUp.bind(this));\n            canvas.addEventListener(\'mouseout\', this.onMouseUp.bind(this));\n        },\n\n        _insertEditNode: function(parent, node) {\n            var mtInsert = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n\n            mtInsert.editMask = NodeGizmo.PICK_GIZMO;\n            if (this._correctPivotOnAutoInsert) mtInsert.editMask |= NodeGizmo.CORRECT_PIVOT;\n\n            parent.addChild(mtInsert);\n            parent.removeChild(node);\n            mtInsert.addChild(node);\n\n            mtInsert._isInserted = true;\n\n            return mtInsert;\n        },\n\n        _findEditNodeFromNodePath: function(nodepath) {\n            if (!nodepath) return null;\n\n            var node = nodepath[nodepath.length - 1];\n            if (node.editMask) return node;\n\n            if (!this._autoInsertMT) {\n                for (var i = nodepath.length - 1; i >= 0; --i) {\n                    var editMask = nodepath[i].editMask;\n                    if (editMask && editMask & NodeGizmo.PICK_GIZMO) return nodepath[i];\n                }\n\n                return null;\n            }\n\n            var parent = nodepath[nodepath.length - 2];\n            // direct parent is already an editable node\n            if (parent.editMask) return parent;\n            return this._insertEditNode(parent, node);\n        },\n\n        _findEditNodeFromNode: function(node) {\n            if (!node) return null;\n            if (node.editMask) return node;\n\n            if (this._autoInsertMT) {\n                var parents = node.getParents();\n                // direct parent is already an editable node\n                for (var i = 0; i < parents.length; ++i) {\n                    var editMask = parents[i].editMask;\n                    if (editMask && editMask & NodeGizmo.PICK_GIZMO) return parents[i];\n                }\n\n                // we have to choose an arbitrary parent here\n                return this._insertEditNode(parents[0], node);\n            }\n\n            if (!this._getEditNodeVisitor) {\n                this._getEditNodeVisitor = new GetNearestEditableNode();\n            } else {\n                this._getEditNodeVisitor.reset();\n            }\n\n            node.accept(this._getEditNodeVisitor);\n            return this._getEditNodeVisitor.getEditableNode();\n        },\n\n        attachToNodePath: function(nodepath) {\n            var editNode = this._findEditNodeFromNodePath(nodepath);\n            this._attachEditNode(editNode, nodepath && nodepath[nodepath.length - 1]);\n        },\n\n        attachToNode: function(node) {\n            var editNode = this._findEditNodeFromNode(node);\n            this._attachEditNode(editNode, node);\n        },\n\n        _attachEditNode: function(editNode, userNode) {\n            this._attachedNode = editNode;\n\n            if (userNode && userNode !== editNode) {\n                if (editNode.editMask & NodeGizmo.CORRECT_PIVOT) {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].copy(this._pivotOffset, userNode.getBoundingSphere().center());\n                }\n            }\n\n            this.updateGizmoMask();\n        },\n\n        updateGizmoMask: function() {\n            if (!this._attachedNode) {\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].init(this._pivotOffset);\n                this.setNodeMask(0x0);\n                return;\n            }\n\n            var mask = this._attachedNode.editMask;\n\n            this.setNodeMask(mask & NodeGizmo.PICK_GIZMO ? NodeGizmo.NO_PICK : 0x0);\n\n            this._translateNode.setNodeMask(\n                mask & NodeGizmo.PICK_ARROW ? NodeGizmo.PICK_ARROW : 0x0\n            );\n            this._rotateNode.setNodeMask(mask & NodeGizmo.PICK_ARC ? NodeGizmo.PICK_ARC : 0x0);\n            this._planeNode.setNodeMask(mask & NodeGizmo.PICK_PLANE ? NodeGizmo.PICK_PLANE : 0x0);\n\n            var transChildren = this._translateNode.getChildren();\n            transChildren[0].setNodeMask(\n                mask & NodeGizmo.PICK_ARROW_X ? NodeGizmo.PICK_ARROW_X : 0x0\n            );\n            transChildren[1].setNodeMask(\n                mask & NodeGizmo.PICK_ARROW_Y ? NodeGizmo.PICK_ARROW_Y : 0x0\n            );\n            transChildren[2].setNodeMask(\n                mask & NodeGizmo.PICK_ARROW_Z ? NodeGizmo.PICK_ARROW_Z : 0x0\n            );\n\n            // children 0 is full arc\n            var rotChildren = this._rotateNode.getChildren();\n            rotChildren[0].setNodeMask(mask & NodeGizmo.NO_FULL_CIRCLE ? 0x0 : NodeGizmo.NO_PICK);\n            rotChildren[1].setNodeMask(mask & NodeGizmo.PICK_ARC_X ? NodeGizmo.PICK_ARC_X : 0x0);\n            rotChildren[2].setNodeMask(mask & NodeGizmo.PICK_ARC_Y ? NodeGizmo.PICK_ARC_Y : 0x0);\n            rotChildren[3].setNodeMask(mask & NodeGizmo.PICK_ARC_Z ? NodeGizmo.PICK_ARC_Z : 0x0);\n\n            var planeChildren = this._planeNode.getChildren();\n            planeChildren[0].setNodeMask(\n                mask & NodeGizmo.PICK_PLANE_X ? NodeGizmo.PICK_PLANE_X : 0x0\n            );\n            planeChildren[1].setNodeMask(\n                mask & NodeGizmo.PICK_PLANE_Y ? NodeGizmo.PICK_PLANE_Y : 0x0\n            );\n            planeChildren[2].setNodeMask(\n                mask & NodeGizmo.PICK_PLANE_Z ? NodeGizmo.PICK_PLANE_Z : 0x0\n            );\n        },\n\n        onNodeHovered: (function() {\n            var hoverColor = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 1.0, 0.0, 1.0);\n\n            return function(hit) {\n                if (this._hoverNode)\n                    this._hoverNode\n                        .getStateSet()\n                        .getUniform(\'uColor\')\n                        .setFloat4(this._keepHoverColor);\n                if (!hit) {\n                    this._hoverNode = null;\n                    return;\n                }\n\n                // stop at the first X/Y/Z matrix node\n                var np = hit._nodePath;\n                var i = np.length - 1;\n                var node = np[i];\n                while (node._nbAxis === undefined) {\n                    if (i === 0) return;\n                    node = np[--i];\n                }\n\n                var unif = node.getStateSet().getUniform(\'uColor\');\n                this._hoverNode = node;\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].copy(this._keepHoverColor, unif.getInternalArray());\n                unif.setFloat4(hoverColor);\n            };\n        })(),\n\n        initNodeRotate: function() {\n            var drawArcXYZ = __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createTorusGeometry(1.0, 0.01, 6, 64, Math.PI * 2);\n            var drawArc = __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createTorusGeometry(1.0, 0.01, 6, 64, Math.PI);\n            var pickArc = __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createTorusGeometry(1.0, 0.1, 6, 64, Math.PI);\n\n            var mtXYZ = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtX = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtY = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtZ = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            mtX._nbAxis = 0;\n            mtY._nbAxis = 1;\n            mtZ._nbAxis = 2;\n\n            var hideNode = new __WEBPACK_IMPORTED_MODULE_0_osg_Node__["a" /* default */]();\n            hideNode.setCullCallback(new HideCullCallback());\n            hideNode.addChild(pickArc);\n\n            // set masks\n            drawArcXYZ.setNodeMask(NodeGizmo.NO_PICK);\n            drawArc.setNodeMask(NodeGizmo.NO_PICK);\n            mtX.setNodeMask(NodeGizmo.PICK_ARC_X);\n            mtY.setNodeMask(NodeGizmo.PICK_ARC_Y);\n            mtZ.setNodeMask(NodeGizmo.PICK_ARC_Z);\n\n            mtXYZ.addChild(drawArcXYZ);\n            mtX.addChild(drawArc);\n            mtY.addChild(drawArc);\n            mtZ.addChild(drawArc);\n\n            mtX.addChild(hideNode);\n            mtY.addChild(hideNode);\n            mtZ.addChild(hideNode);\n\n            mtXYZ\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.2, 0.2, 0.2, 1.0), \'uColor\'));\n            mtX\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.0, 0.0, 1.0), \'uColor\'));\n            mtY\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 1.0, 0.0, 1.0), \'uColor\'));\n            mtZ\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 1.0, 1.0), \'uColor\'));\n\n            var showAngle = this._showAngle;\n            showAngle.getOrCreateStateSet().setAttributeAndModes(blendAttribute);\n            showAngle.setNodeMask(0x0);\n            showAngle\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat3(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0), \'uBase\'));\n            showAngle.getOrCreateStateSet().addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat(0.0, \'uAngle\'));\n            showAngle.addChild(__WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createQuadCircleGeometry());\n\n            var rotate = this._rotateNode;\n            rotate.setNodeMask(NodeGizmo.PICK_ARC);\n            rotate.addChild(mtXYZ);\n            rotate.addChild(mtX);\n            rotate.addChild(mtY);\n            rotate.addChild(mtZ);\n            rotate.addChild(showAngle);\n            return rotate;\n        },\n\n        initNodeTranslate: function() {\n            var aHeight = 1.5;\n            var aConeHeight = 0.3;\n            var pickStart = 0.5; // offset (because of the picking plane)\n            var pickHeight = (aHeight - pickStart + aConeHeight) * 1.1;\n\n            // cone arrow\n            var mtCone = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromTranslation(\n                mtCone.getMatrix(),\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, aHeight + aConeHeight * 0.5)\n            );\n            mtCone.addChild(\n                __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createCylinderGeometry(0.0, 0.07, aConeHeight, 32, 1, true, true)\n            );\n            // arrow base\n            var mtArrow = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromTranslation(mtArrow.getMatrix(), __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, aHeight * 0.5));\n            mtArrow.addChild(\n                __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createCylinderGeometry(0.01, 0.01, aHeight, 32, 1, true, true)\n            );\n            // draw arrow\n            var drawArrow = new __WEBPACK_IMPORTED_MODULE_0_osg_Node__["a" /* default */]();\n            drawArrow.addChild(mtArrow);\n            drawArrow.addChild(mtCone);\n\n            var pickArrow = __WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createCylinderGeometry(\n                0.1,\n                0.1,\n                pickHeight,\n                32,\n                1,\n                true,\n                true\n            );\n\n            var mtX = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtY = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtZ = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            mtX._nbAxis = 0;\n            mtY._nbAxis = 1;\n            mtZ._nbAxis = 2;\n\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mtX.getMatrix(), Math.PI * 0.5, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0));\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mtY.getMatrix(), -Math.PI * 0.5, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0));\n\n            var hideNode = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            hideNode.setCullCallback(new HideCullCallback());\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromTranslation(\n                hideNode.getMatrix(),\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, pickStart + pickHeight * 0.5)\n            );\n            hideNode.addChild(pickArrow);\n\n            // set masks\n            drawArrow.setNodeMask(NodeGizmo.NO_PICK);\n            mtX.setNodeMask(NodeGizmo.PICK_ARROW_X);\n            mtY.setNodeMask(NodeGizmo.PICK_ARROW_Y);\n            mtZ.setNodeMask(NodeGizmo.PICK_ARROW_Z);\n\n            mtX.addChild(drawArrow);\n            mtY.addChild(drawArrow);\n            mtZ.addChild(drawArrow);\n\n            mtX.addChild(hideNode);\n            mtY.addChild(hideNode);\n            mtZ.addChild(hideNode);\n\n            mtX\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.0, 0.0, 1.0), \'uColor\'));\n            mtY\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 1.0, 0.0, 1.0), \'uColor\'));\n            mtZ\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 1.0, 1.0), \'uColor\'));\n\n            var translate = this._translateNode;\n            translate.setNodeMask(NodeGizmo.PICK_ARROW);\n            translate.addChild(mtX);\n            translate.addChild(mtY);\n            translate.addChild(mtZ);\n            return translate;\n        },\n\n        initNodeTranslatePlane: function() {\n            var mtPlane = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromTranslation(mtPlane.getMatrix(), __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.5, 0.5, 0.0));\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(\n                mtPlane.getMatrix(),\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromScaling(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create(), __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.5, 0.5, 1.0)),\n                mtPlane.getMatrix()\n            );\n            mtPlane.addChild(__WEBPACK_IMPORTED_MODULE_10_osgUtil_gizmoGeometry__["a" /* default */].createPlaneGeometry());\n\n            var mtX = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtY = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            var mtZ = new __WEBPACK_IMPORTED_MODULE_2_osg_MatrixTransform__["a" /* default */]();\n            mtX._nbAxis = 0;\n            mtY._nbAxis = 1;\n            mtZ._nbAxis = 2;\n\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mtX.getMatrix(), -Math.PI * 0.5, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0));\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mtY.getMatrix(), Math.PI * 0.5, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0));\n\n            // set masks\n            mtX.setNodeMask(NodeGizmo.PICK_PLANE_X);\n            mtY.setNodeMask(NodeGizmo.PICK_PLANE_Y);\n            mtZ.setNodeMask(NodeGizmo.PICK_PLANE_Z);\n\n            mtX.addChild(mtPlane);\n            mtY.addChild(mtPlane);\n            mtZ.addChild(mtPlane);\n\n            mtX\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.0, 0.0, 0.3), \'uColor\'));\n            mtY\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 1.0, 0.0, 0.3), \'uColor\'));\n            mtZ\n                .getOrCreateStateSet()\n                .addUniform(__WEBPACK_IMPORTED_MODULE_6_osg_Uniform__["a" /* default */].createFloat4(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["g" /* vec4 */].fromValues(0.0, 0.0, 1.0, 0.3), \'uColor\'));\n\n            var plane = this._planeNode;\n            plane.setNodeMask(NodeGizmo.PICK_PLANE);\n            plane.getOrCreateStateSet().setAttributeAndModes(blendAttribute);\n            plane.addChild(mtX);\n            plane.addChild(mtY);\n            plane.addChild(mtZ);\n            return plane;\n        },\n\n        updateArcRotation: (function() {\n            var qTmp = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].create();\n            var quatx = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].setAxisAngle(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].create(), [0.0, 1.0, 0.0], -Math.PI * 0.5);\n            var quaty = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].setAxisAngle(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].create(), [1.0, 0.0, 0.0], -Math.PI * 0.5);\n            return function(eye) {\n                var rotateNode = this._rotateNode;\n                var arcs = rotateNode.getChildren();\n                // eye arc\n                qTmp[0] = -eye[1];\n                qTmp[1] = eye[0];\n                qTmp[2] = 0.0;\n                qTmp[3] = 1.0 + eye[2];\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].normalize(qTmp, qTmp);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromQuat(arcs[0].getMatrix(), qTmp);\n                // x arc\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].setAxisAngle(qTmp, [1.0, 0.0, 0.0], Math.atan2(eye[2], eye[1]));\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].mul(qTmp, qTmp, quatx);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromQuat(arcs[1].getMatrix(), qTmp);\n                // y arc\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].setAxisAngle(qTmp, [0.0, 1.0, 0.0], Math.atan2(-eye[0], -eye[2]));\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].mul(qTmp, qTmp, quaty);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromQuat(arcs[2].getMatrix(), qTmp);\n                // z arc\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["d" /* quat */].setAxisAngle(qTmp, [0.0, 0.0, 1.0], Math.atan2(-eye[0], eye[1]));\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromQuat(arcs[3].getMatrix(), qTmp);\n\n                arcs[1].dirtyBound();\n                arcs[2].dirtyBound();\n                arcs[3].dirtyBound();\n            };\n        })(),\n\n        getTransformType: function(nodeIn) {\n            // should probably be a visitor with traverse parents instead\n            var node = nodeIn;\n            while (node.getParents().length > 0) {\n                var refFrame = node.referenceFrame;\n                if (refFrame !== undefined && refFrame === __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__["a" /* default */].ABSOLUTE_RF) {\n                    return __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__["a" /* default */].ABSOLUTE_RF;\n                }\n                node = node.getParents()[0];\n            }\n            return __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__["a" /* default */].RELATIVE_RF;\n        },\n\n        getAttachedNodeWorldMatrix: function() {\n            var worldMat = this._attachedNode.getWorldMatrix(undefined, _TMP_MAT);\n            return __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].translate(worldMat, worldMat, this._pivotOffset);\n        },\n\n        update: (function() {\n            var eye = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n            var worldTrans = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n            var tmpVec = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n            var tmpMat = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function() {\n                if (!this._attachedNode) return;\n\n                var ttype = this.getTransformType(this._attachedNode);\n                this.setReferenceFrame(ttype);\n                this.setCullingActive(ttype === __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__["a" /* default */].RELATIVE_RF);\n                var worldMat = this.getAttachedNodeWorldMatrix();\n\n                // world trans\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].getTranslation(worldTrans, worldMat);\n\n                // normalize gizmo size\n                var scaleFactor = 3.0;\n                if (ttype === __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__["a" /* default */].ABSOLUTE_RF) {\n                    eye[0] = eye[1] = eye[2] = 0.0;\n                } else {\n                    // normalize gizmo size relative to screen size\n                    var proj = this._viewer.getCamera().getProjectionMatrix();\n                    var scaleFov = this._canvas.clientWidth * 0.023 * proj[0];\n                    this._manipulator.getEyePosition(eye);\n                    // while we are editing we don\'t normalize the gizmo\n                    // it gives a better depth feedback, especially if we are editing a geometry that has\n                    // a constant screen size (for example an icon)\n                    this._lastDistToEye = this._isEditing\n                        ? this._lastDistToEye\n                        : __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].distance(worldTrans, eye);\n                    scaleFactor *= this._lastDistToEye / scaleFov;\n                }\n\n                // set the position of gizmo\n                var gizmoMatrix = this.getMatrix();\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromTranslation(gizmoMatrix, worldTrans);\n\n                // set scale of gizmo\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].set(tmpVec, scaleFactor, scaleFactor, scaleFactor);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(gizmoMatrix, gizmoMatrix, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromScaling(tmpMat, tmpVec));\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].sub(eye, eye, worldTrans);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].normalize(eye, eye);\n\n                // rotate node\n                if (this._rotateInLocal || this._translateInLocal) {\n                    // world scale\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].getScale(tmpVec, worldMat);\n                    var invScale = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromScaling(tmpMat, tmpVec);\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].invert(invScale, invScale);\n\n                    var worldRot = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(worldMat, worldMat, invScale);\n                    worldRot[12] = worldRot[13] = worldRot[14] = 0.0;\n\n                    if (this._translateInLocal) {\n                        __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this._translateNode.getMatrix(), worldRot);\n                        __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this._planeNode.getMatrix(), worldRot);\n                    }\n\n                    if (this._rotateInLocal) {\n                        __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this._rotateNode.getMatrix(), worldRot);\n                        __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].invert(worldRot, worldRot);\n                        __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(eye, eye, worldRot);\n                    }\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].identity(this._rotateNode.getMatrix());\n                }\n\n                this.updateArcRotation(eye);\n\n                this._rotateNode.dirtyBound();\n                this._translateNode.dirtyBound();\n                this._planeNode.dirtyBound();\n\n                if (this._isEditing) {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this._showAngle.getMatrix(), this._hoverNode.getMatrix());\n                }\n            };\n        })(),\n\n        computeNearestIntersection: (function() {\n            var sortByRatio = function(a, b) {\n                return a._ratio - b._ratio;\n            };\n            var coord = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].create();\n\n            return function(e, tmask) {\n                getCanvasCoord(coord, e);\n\n                // canvas to webgl coord\n                var viewer = this._viewer;\n                var canvas = this._canvas;\n                var x = coord[0] * (viewer._canvasWidth / canvas.clientWidth);\n                var y =\n                    (canvas.clientHeight - coord[1]) * (viewer._canvasHeight / canvas.clientHeight);\n\n                var hits = this._viewer.computeIntersections(x, y, tmask);\n\n                if (hits.length === 0) return undefined;\n\n                hits.sort(sortByRatio);\n                return hits[0];\n            };\n        })(),\n\n        setOnlyGizmoPicking: function() {\n            // enable picking only for the gizmo\n            this._viewer.getCamera().addChild(this);\n            this._viewer.getSceneData().setNodeMask(0x0);\n            this.setNodeMask(~0x0);\n        },\n\n        setOnlyScenePicking: function() {\n            this._viewer.getCamera().removeChild(this);\n            this._viewer.getSceneData().setNodeMask(~0x0);\n            this.setNodeMask(NodeGizmo.NO_PICK);\n        },\n\n        pickGizmo: function(e, tmask) {\n            this.setOnlyGizmoPicking();\n            var hit = this.computeNearestIntersection(e, tmask);\n            this.setOnlyScenePicking();\n            return hit;\n        },\n\n        getCanvasPositionFromWorldPoint: (function() {\n            var mat = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n\n            return function(worldPoint, out) {\n                var cam = this._viewer.getCamera();\n\n                var screenPoint = out;\n\n                if (cam.getViewport()) {\n                    cam.getViewport().computeWindowMatrix(mat);\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].identity(mat);\n                }\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(mat, mat, cam.getProjectionMatrix());\n                if (this.getReferenceFrame() === __WEBPACK_IMPORTED_MODULE_11_osg_transformEnums__["a" /* default */].RELATIVE_RF)\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(mat, mat, cam.getViewMatrix());\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(screenPoint, worldPoint, mat);\n\n                // canvas to webgl coord\n                var viewer = this._viewer;\n                var canvas = this._canvas;\n                screenPoint[0] = screenPoint[0] / (viewer._canvasWidth / canvas.clientWidth);\n                screenPoint[1] =\n                    canvas.clientHeight -\n                    screenPoint[1] / (viewer._canvasHeight / canvas.clientHeight);\n                return screenPoint;\n            };\n        })(),\n\n        onMouseDown: function(e) {\n            getCanvasCoord(this._downCanvasCoord, e);\n            if (!this._hoverNode || !this._attachedNode) return;\n\n            e.preventDefault();\n\n            this._viewer.setEnableManipulator(false);\n\n            this.saveEditMatrices();\n            var nm = this._hoverNode.getParents()[0].getNodeMask();\n            this._isEditing = true;\n\n            if (nm & NodeGizmo.PICK_ARC) {\n                this._translateNode.setNodeMask(0x0);\n                this._planeNode.setNodeMask(0x0);\n                this.startRotateEdit(e);\n            } else if (nm & NodeGizmo.PICK_ARROW) {\n                this._rotateNode.setNodeMask(0x0);\n                this._planeNode.setNodeMask(0x0);\n                this.startTranslateEdit(e);\n            } else if (nm & NodeGizmo.PICK_PLANE) {\n                this._rotateNode.setNodeMask(0x0);\n                this._translateNode.setNodeMask(0x0);\n                this.startPlaneEdit(e);\n            }\n        },\n\n        saveEditMatrices: function() {\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this._editLocal, this._attachedNode.getMatrix());\n            // save the world translation\n            var wm = this.getAttachedNodeWorldMatrix();\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromTranslation(this._editWorldTrans, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(wm[12], wm[13], wm[14]));\n            // save the inv of world rotation + scale\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this._editWorldScaleRot, wm);\n            // removes translation\n            this._editWorldScaleRot[12] = this._editWorldScaleRot[13] = this._editWorldScaleRot[14] = 0.0;\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].invert(this._editInvWorldScaleRot, this._editWorldScaleRot);\n        },\n\n        startRotateEdit: function(e) {\n            var gizmoMat = this._rotateNode.getWorldMatrix(undefined, _TMP_MAT);\n\n            // center of gizmo on screen\n            var projCenter = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(projCenter, projCenter, gizmoMat);\n            this.getCanvasPositionFromWorldPoint(projCenter, projCenter);\n\n            // pick rotate gizmo\n            var hit = this.pickGizmo(e, this._hoverNode.getNodeMask() | NodeGizmo.PICK_ARC);\n            if (!hit) return;\n\n            // compute tangent direction\n            var sign = this._hoverNode._nbAxis === 0 ? -1.0 : 1.0;\n            var tang = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n            tang[0] = sign * hit._localIntersectionPoint[1];\n            tang[1] = -sign * hit._localIntersectionPoint[0];\n            tang[2] = hit._localIntersectionPoint[2];\n\n            // project tangent on screen\n            var projArc = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(projArc, tang, this._hoverNode.getMatrix());\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(projArc, projArc, gizmoMat);\n            this.getCanvasPositionFromWorldPoint(projArc, projArc);\n\n            var dir = this._editLineDirection;\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(dir, projArc, projCenter);\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].normalize(dir, dir);\n\n            // show angle\n            this._showAngle.setNodeMask(NodeGizmo.NO_PICK);\n            hit._localIntersectionPoint[2] = 0.0;\n            var stateAngle = this._showAngle.getStateSet();\n            stateAngle.getUniform(\'uAngle\').setFloat(0.0);\n            stateAngle\n                .getUniform(\'uBase\')\n                .setVec3(__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].normalize(hit._localIntersectionPoint, hit._localIntersectionPoint));\n\n            getCanvasCoord(this._editLineOrigin, e);\n        },\n\n        startTranslateEdit: function(e) {\n            var origin = this._editLineOrigin;\n            var dir = this._editLineDirection;\n\n            // 3d origin (center of gizmo)\n            var gizmoMat = this._translateNode.getWorldMatrix(undefined, _TMP_MAT);\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].getTranslation(origin, gizmoMat);\n\n            // 3d direction\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].init(dir);\n            dir[this._hoverNode._nbAxis] = 1.0;\n            if (this._translateInLocal) {\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(dir, dir, this._editWorldScaleRot);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].normalize(dir, dir);\n            }\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].add(dir, origin, dir);\n\n            // project on canvas\n            this.getCanvasPositionFromWorldPoint(origin, origin);\n            this.getCanvasPositionFromWorldPoint(dir, dir);\n\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(dir, dir, origin);\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].normalize(dir, dir);\n\n            var offset = this._editOffset;\n            getCanvasCoord(offset, e);\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(offset, offset, origin);\n        },\n\n        startPlaneEdit: function(e) {\n            var origin = this._editLineOrigin; // just used to determine the 2d offset\n\n            // 3d origin (center of gizmo)\n            var gizmoMat = this._planeNode.getWorldMatrix(undefined, _TMP_MAT);\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].getTranslation(origin, gizmoMat);\n\n            // project on canvas\n            this.getCanvasPositionFromWorldPoint(origin, origin);\n\n            var offset = this._editOffset;\n            getCanvasCoord(offset, e);\n            __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(offset, offset, origin);\n        },\n\n        drawLineCanvasDebug: function(x1, y1, x2, y2) {\n            this._debugNode.setNodeMask(NodeGizmo.NO_PICK);\n            var buffer = this._debugNode.getChildren()[0].getAttributes().Vertex;\n            buffer.getElements()[0] = x1 / this._canvas.clientWidth * 2 - 1.0;\n            buffer.getElements()[1] =\n                (this._canvas.clientHeight - y1) / this._canvas.clientHeight * 2 - 1.0;\n            buffer.getElements()[2] = x2 / this._canvas.clientWidth * 2 - 1.0;\n            buffer.getElements()[3] =\n                (this._canvas.clientHeight - y2) / this._canvas.clientHeight * 2 - 1.0;\n            buffer.dirty();\n        },\n\n        pickAndSelect: function(e) {\n            this.setNodeMask(0x0);\n            var hit = this.computeNearestIntersection(e, this._tmask);\n            this.attachToNodePath(hit ? hit._nodePath : hit);\n        },\n\n        onMouseUp: function(e) {\n            this._viewer.setEnableManipulator(true);\n            if (this._debugNode) this._debugNode.setNodeMask(0x0);\n\n            var v = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].create();\n            getCanvasCoord(v, e);\n            if (__WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].distance(v, this._downCanvasCoord) === 0.0) this.pickAndSelect(e);\n\n            this._showAngle.setNodeMask(0x0);\n            this._isEditing = false;\n            if (!this._hoverNode) return;\n            this.updateGizmoMask();\n        },\n\n        onMouseMove: function(e) {\n            if (!this._attachedNode) return;\n            var hit;\n            if (this._isEditing === false) {\n                hit = this.pickGizmo(e, NodeGizmo.PICK_GIZMO);\n                this.onNodeHovered(hit);\n                return;\n            }\n\n            if (!this._hoverNode) return;\n\n            var par = this._hoverNode.getParents()[0];\n            if (par === this._rotateNode) this.updateRotateEdit(e);\n            else if (par === this._translateNode) this.updateTranslateEdit(e);\n            else if (par === this._planeNode) this.updatePlaneEdit(e);\n        },\n\n        updateRotateEdit: (function() {\n            var mrot = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].create();\n            var vec = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].create();\n            var vecX = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(1.0, 0.0, 0.0);\n            var vecY = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 1.0, 0.0);\n            var vecZ = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].fromValues(0.0, 0.0, 1.0);\n            var negatePivot = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(e) {\n                var origin = this._editLineOrigin;\n                var dir = this._editLineDirection;\n\n                getCanvasCoord(vec, e);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(vec, vec, origin);\n                var dist = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].dot(vec, dir);\n\n                if (this._debugNode) {\n                    var ox = origin[0];\n                    var oy = origin[1];\n                    this.drawLineCanvasDebug(ox, oy, ox + dir[0] * dist, oy + dir[1] * dist);\n                }\n\n                var minClient = Math.min(this._canvas.clientWidth, this._canvas.clientHeight);\n                var angle = 7 * dist / minClient;\n                angle %= Math.PI * 2;\n\n                var nbAxis = this._hoverNode._nbAxis;\n                if (nbAxis === 0) __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mrot, -angle, vecX);\n                else if (nbAxis === 1) __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mrot, -angle, vecY);\n                else if (nbAxis === 2) __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].fromRotation(mrot, -angle, vecZ);\n\n                var uAngle = this._showAngle.getOrCreateStateSet().getUniform(\'uAngle\');\n                uAngle.setFloat(nbAxis === 0 ? -angle : angle);\n\n                if (!this._rotateInLocal) {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(mrot, this._editInvWorldScaleRot, mrot);\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(mrot, mrot, this._editWorldScaleRot);\n                }\n\n                // rotate around origin pivot (geometry center)\n                // the classic rotation around pivot : -T * R * T\n                var attMat = this._attachedNode.getMatrix();\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].translate(attMat, this._editLocal, this._pivotOffset);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].mul(attMat, attMat, mrot);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].translate(attMat, attMat, __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].negate(negatePivot, this._pivotOffset));\n\n                this._attachedNode.dirtyBound();\n            };\n        })(),\n\n        updateTranslateEdit: (function() {\n            var vec = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].create();\n            var tra = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(e) {\n                var origin = this._editLineOrigin;\n                var dir = this._editLineDirection;\n\n                getCanvasCoord(vec, e);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(vec, vec, origin);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(vec, vec, this._editOffset);\n\n                var dist = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].dot(vec, dir);\n                vec[0] = origin[0] + dir[0] * dist;\n                vec[1] = origin[1] + dir[1] * dist;\n\n                if (this._debugNode) this.drawLineCanvasDebug(origin[0], origin[1], vec[0], vec[1]);\n\n                // canvas to webgl coord\n                var viewer = this._viewer;\n                var canvas = this._canvas;\n                var coordx = vec[0] * (viewer._canvasWidth / canvas.clientWidth);\n                var coordy =\n                    (canvas.clientHeight - vec[1]) * (viewer._canvasHeight / canvas.clientHeight);\n\n                // project 2D point on the 3d line\n                this._lsi.reset();\n                this._lsi.setTestPlane(false);\n                this._lsi.set(\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].set(this._origIntersect, coordx, coordy, 0.0),\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].set(this._dstIntersect, coordx, coordy, 1.0)\n                );\n                this._iv.reset();\n                this._iv.setTraversalMask(this._hoverNode.getNodeMask());\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this.getMatrix(), this._editWorldTrans);\n\n                this.setOnlyGizmoPicking();\n                this._viewer._camera.accept(this._iv);\n                this.setOnlyScenePicking();\n\n                if (!this._translateInLocal) {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(\n                        tra,\n                        this._lsi.getTranslateDistance(),\n                        this._editInvWorldScaleRot\n                    );\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].getScale(tra, this._editInvWorldScaleRot);\n\n                    var inter = this._lsi.getTranslateDistance();\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].mul(tra, tra, inter);\n                }\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].translate(this._attachedNode.getMatrix(), this._editLocal, tra);\n\n                this._attachedNode.dirtyBound();\n            };\n        })(),\n\n        updatePlaneEdit: (function() {\n            var vec = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].create();\n            var tra = __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(e) {\n                getCanvasCoord(vec, e);\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["e" /* vec2 */].sub(vec, vec, this._editOffset);\n\n                // canvas to webgl coord\n                var viewer = this._viewer;\n                var canvas = this._canvas;\n                var coordx = vec[0] * (viewer._canvasWidth / canvas.clientWidth);\n                var coordy =\n                    (canvas.clientHeight - vec[1]) * (viewer._canvasHeight / canvas.clientHeight);\n\n                // project 2D point on the 3d plane\n                this._lsi.reset();\n                this._lsi.setTestPlane(true);\n                this._lsi.set(\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].set(this._origIntersect, coordx, coordy, 0.0),\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].set(this._dstIntersect, coordx, coordy, 1.0)\n                );\n                this._iv.reset();\n                this._iv.setTraversalMask(this._hoverNode.getNodeMask());\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].copy(this.getMatrix(), this._editWorldTrans);\n\n                this.setOnlyGizmoPicking();\n                this._viewer._camera.accept(this._iv);\n                this.setOnlyScenePicking();\n\n                if (!this._translateInLocal) {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].transformMat4(\n                        tra,\n                        this._lsi.getTranslateDistance(),\n                        this._editInvWorldScaleRot\n                    );\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].getScale(tra, this._editInvWorldScaleRot);\n                    var inter = this._lsi.getTranslateDistance();\n                    __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["f" /* vec3 */].mul(tra, tra, inter);\n                }\n\n                __WEBPACK_IMPORTED_MODULE_7_osg_glMatrix__["c" /* mat4 */].translate(this._attachedNode.getMatrix(), this._editLocal, tra);\n\n                this._attachedNode.dirtyBound();\n            };\n        })()\n    }),\n    \'osgUtil\',\n    \'NodeGizmo\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (NodeGizmo);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/NodeGizmo.js\n// module id = 236\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/NodeGizmo.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_Intersector__ = __webpack_require__(69);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgUtil_SphereIntersectFunctor__ = __webpack_require__(238);\n\n\n\n\n\n\nvar SphereIntersector = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgUtil_Intersector__["a" /* default */].call(this);\n\n    this._center = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._iCenter = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n    this._radius = 1.0;\n    this._iRadius = 1.0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    SphereIntersector,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgUtil_Intersector__["a" /* default */].prototype, {\n        set: function(center, radius) {\n            // we copy iCenter and iRadius in case setCurrentTransformation is never called\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._center, center);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._iCenter, center);\n            this._radius = this._iRadius = radius;\n            this.reset();\n        },\n\n        setCenter: function(center) {\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._center, center);\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(this._iCenter, center);\n        },\n\n        setRadius: function(radius) {\n            this._radius = this._iRadius = radius;\n        },\n\n        intersectNode: function(node) {\n            // TODO implement intersectBoundingBox?\n            return this.intersectBoundingSphere(node.getBoundingSphere());\n        },\n\n        intersectBoundingSphere: function(bsphere) {\n            if (!bsphere.valid()) return false;\n            var r = this._iRadius + bsphere.radius();\n            return __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrDist(bsphere.center(), this._iCenter) <= r * r;\n        },\n\n        intersect: (function() {\n            var functor = new __WEBPACK_IMPORTED_MODULE_3_osgUtil_SphereIntersectFunctor__["a" /* default */]();\n\n            return function(iv, node) {\n                functor.setGeometry(node);\n                functor.setIntersectionVisitor(iv);\n                functor.setIntersector(this);\n\n                functor.set(this._iCenter, this._iRadius);\n\n                var kdtree = node.getShape();\n                if (kdtree) {\n                    kdtree.intersect(functor, kdtree.getNodes()[0]);\n                } else {\n                    // handle rig transformed vertices\n                    if (node.computeTransformedVertices) {\n                        functor.setVertices(node.computeTransformedVertices());\n                    }\n\n                    functor.apply(node);\n                }\n\n                functor.reset();\n            };\n        })(),\n\n        setCurrentTransformation: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(matrix) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].invert(matrix, matrix);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].transformMat4(this._iCenter, this._center, matrix);\n                // Only handling analitically uniform scales.\n                // For non uniform we use an approximation to avoid complexity\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].getScale(tmp, matrix);\n                var x = tmp[0];\n                var y = tmp[1];\n                var z = tmp[2];\n                var maxScale = x > y ? (x > z ? x : z) : y > z ? y : z;\n                this._iRadius = this._radius * maxScale;\n            };\n        })()\n    }),\n    \'osgUtil\',\n    \'SphereIntersector\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (SphereIntersector);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/SphereIntersector.js\n// module id = 237\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/SphereIntersector.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__ = __webpack_require__(71);\n\n\n\n\nvar SphereIntersection = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].Intersection.call(this);\n\n    this._localIntersectionNormal = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].clone(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].ONE);\n\n    // index of vertex\n    this._i1 = -1;\n    this._i2 = -1;\n    this._i3 = -1;\n\n    // barycentric coordinates\n    this._r1 = 0.0;\n    this._r2 = 0.0;\n    this._r3 = 0.0;\n};\n\nvar SphereIntersectFunctor = function() {\n    __WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].apply(this);\n\n    this._center = undefined;\n    this._radius = 0.0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    SphereIntersectFunctor,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osgUtil_IntersectFunctor__["a" /* default */].prototype, {\n        set: function(center, radius) {\n            this._center = center;\n            this._radius = radius;\n        },\n\n        enter: function(bbox) {\n            // Intersection sphere box, from graphic gems 2\n            // https://github.com/erich666/GraphicsGems/blob/master/gems/BoxSphere.c\n            var r2 = this._radius * this._radius;\n            var dmin = 0;\n            var bmin = bbox.getMin();\n            var bmax = bbox.getMax();\n            var d = 0;\n            for (var i = 0; i < 3; i++) {\n                if (this._center[i] < bmin[i]) {\n                    d = this._center[i] - bmin[i];\n                    dmin += d * d;\n                } else if (this._center[i] > bmax[i]) {\n                    d = this._center[i] - bmax[i];\n                    dmin += d * d;\n                }\n            }\n            return dmin <= r2;\n        },\n\n        intersectPoint: function(v0, i0) {\n            var sqrDistance = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrDist(v0, this._center);\n            if (sqrDistance > this._radius * this._radius) return;\n\n            var intersection = this.initIntersection(new SphereIntersection());\n            intersection._i1 = i0;\n            intersection._r1 = 1.0;\n            __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].copy(intersection._localIntersectionPoint, v0);\n            intersection._ratio = Math.sqrt(sqrDistance) / this._radius;\n        },\n\n        intersectLine: (function() {\n            var tmp = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var dir = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n            return function(v0, v1, p0, p1) {\n                // https://www.geometrictools.com/GTEngine/Include/Mathematics/GteDistPointSegment.h\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(tmp, this._center, v0);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(dir, v1, v0);\n                // compute ratio (projection on line)\n                var r = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(tmp, dir) / __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(dir);\n\n                // compute distance to segment\n                var distToSegmentSqr = 1.0;\n                if (r < 0.0) distToSegmentSqr = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(tmp);\n                else if (r > 1.0) distToSegmentSqr = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrDist(this._center, v1);\n                else distToSegmentSqr = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(tmp, tmp, dir, -r));\n\n                if (distToSegmentSqr > this._radius * this._radius) {\n                    return;\n                }\n\n                var intersection = this.initIntersection(new SphereIntersection());\n                intersection._i1 = p0;\n                intersection._i2 = p1;\n\n                intersection._r1 = 1.0 - r;\n                intersection._r2 = r;\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(intersection._localIntersectionPoint, v0, dir, r);\n                intersection._ratio = Math.sqrt(distToSegmentSqr) / this._radius;\n            };\n        })(),\n\n        //\n        // \\2|\n        //  \\|\n        //   \\\n        // 3 |\\  1\n        //   |0\\\n        // __|__\\___\n        // 4 | 5 \\ 6\n        //\n        // from http://www.geometrictools.com/Source/Distance3D.html#PointPlanar\n        // js : https://github.com/stephomi/sculptgl/blob/master/src/math3d/Geometry.js#L89\n        intersectTriangle: (function() {\n            var edge1 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var edge2 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            var diff = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n            return function(v0, v1, v2, i0, i1, i2) {\n                if (this._limitOneIntersection && this._hit) return;\n                // sphere is a \'volume\' here (so if the triangle is inside the ball it will intersects)\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(edge1, v1, v0);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(edge2, v2, v0);\n                var a00 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(edge1);\n                var a01 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(edge1, edge2);\n                var a11 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(edge2);\n\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sub(diff, v0, this._center);\n                var b0 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(diff, edge1);\n                var b1 = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].dot(diff, edge2);\n                var c = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].sqrLen(diff);\n                var det = Math.abs(a00 * a11 - a01 * a01);\n                if (det < 1e-10) return;\n\n                var s = a01 * b1 - a11 * b0;\n                var t = a01 * b0 - a00 * b1;\n                var sqrDistance;\n                var zone = 4;\n\n                if (s + t <= det) {\n                    if (s < 0.0) {\n                        if (t < 0.0) {\n                            // region 4\n                            zone = 4;\n                            if (b0 < 0.0) {\n                                t = 0.0;\n                                if (-b0 >= a00) {\n                                    s = 1.0;\n                                    sqrDistance = a00 + 2.0 * b0 + c;\n                                } else {\n                                    s = -b0 / a00;\n                                    sqrDistance = b0 * s + c;\n                                }\n                            } else {\n                                s = 0.0;\n                                if (b1 >= 0.0) {\n                                    t = 0.0;\n                                    sqrDistance = c;\n                                } else if (-b1 >= a11) {\n                                    t = 1.0;\n                                    sqrDistance = a11 + 2.0 * b1 + c;\n                                } else {\n                                    t = -b1 / a11;\n                                    sqrDistance = b1 * t + c;\n                                }\n                            }\n                        } else {\n                            // region 3\n                            zone = 3;\n                            s = 0.0;\n                            if (b1 >= 0.0) {\n                                t = 0.0;\n                                sqrDistance = c;\n                            } else if (-b1 >= a11) {\n                                t = 1.0;\n                                sqrDistance = a11 + 2.0 * b1 + c;\n                            } else {\n                                t = -b1 / a11;\n                                sqrDistance = b1 * t + c;\n                            }\n                        }\n                    } else if (t < 0.0) {\n                        // region 5\n                        zone = 5;\n                        t = 0.0;\n                        if (b0 >= 0.0) {\n                            s = 0.0;\n                            sqrDistance = c;\n                        } else if (-b0 >= a00) {\n                            s = 1.0;\n                            sqrDistance = a00 + 2.0 * b0 + c;\n                        } else {\n                            s = -b0 / a00;\n                            sqrDistance = b0 * s + c;\n                        }\n                    } else {\n                        // region 0\n                        zone = 0;\n                        // minimum at interior point\n                        var invDet = 1.0 / det;\n                        s *= invDet;\n                        t *= invDet;\n                        sqrDistance =\n                            s * (a00 * s + a01 * t + 2.0 * b0) +\n                            t * (a01 * s + a11 * t + 2.0 * b1) +\n                            c;\n                    }\n                } else {\n                    var tmp0, tmp1, numer, denom;\n\n                    if (s < 0.0) {\n                        // region 2\n                        zone = 2;\n                        tmp0 = a01 + b0;\n                        tmp1 = a11 + b1;\n                        if (tmp1 > tmp0) {\n                            numer = tmp1 - tmp0;\n                            denom = a00 - 2.0 * a01 + a11;\n                            if (numer >= denom) {\n                                s = 1.0;\n                                t = 0.0;\n                                sqrDistance = a00 + 2.0 * b0 + c;\n                            } else {\n                                s = numer / denom;\n                                t = 1.0 - s;\n                                sqrDistance =\n                                    s * (a00 * s + a01 * t + 2.0 * b0) +\n                                    t * (a01 * s + a11 * t + 2.0 * b1) +\n                                    c;\n                            }\n                        } else {\n                            s = 0.0;\n                            if (tmp1 <= 0.0) {\n                                t = 1.0;\n                                sqrDistance = a11 + 2.0 * b1 + c;\n                            } else if (b1 >= 0.0) {\n                                t = 0.0;\n                                sqrDistance = c;\n                            } else {\n                                t = -b1 / a11;\n                                sqrDistance = b1 * t + c;\n                            }\n                        }\n                    } else if (t < 0.0) {\n                        // region 6\n                        zone = 6;\n                        tmp0 = a01 + b1;\n                        tmp1 = a00 + b0;\n                        if (tmp1 > tmp0) {\n                            numer = tmp1 - tmp0;\n                            denom = a00 - 2.0 * a01 + a11;\n                            if (numer >= denom) {\n                                t = 1.0;\n                                s = 0.0;\n                                sqrDistance = a11 + 2.0 * b1 + c;\n                            } else {\n                                t = numer / denom;\n                                s = 1.0 - t;\n                                sqrDistance =\n                                    s * (a00 * s + a01 * t + 2.0 * b0) +\n                                    t * (a01 * s + a11 * t + 2.0 * b1) +\n                                    c;\n                            }\n                        } else {\n                            t = 0.0;\n                            if (tmp1 <= 0.0) {\n                                s = 1.0;\n                                sqrDistance = a00 + 2.0 * b0 + c;\n                            } else if (b0 >= 0.0) {\n                                s = 0.0;\n                                sqrDistance = c;\n                            } else {\n                                s = -b0 / a00;\n                                sqrDistance = b0 * s + c;\n                            }\n                        }\n                    } else {\n                        // region 1\n                        zone = 1;\n                        numer = a11 + b1 - a01 - b0;\n                        if (numer <= 0.0) {\n                            s = 0.0;\n                            t = 1.0;\n                            sqrDistance = a11 + 2.0 * b1 + c;\n                        } else {\n                            denom = a00 - 2.0 * a01 + a11;\n                            if (numer >= denom) {\n                                s = 1.0;\n                                t = 0.0;\n                                sqrDistance = a00 + 2.0 * b0 + c;\n                            } else {\n                                s = numer / denom;\n                                t = 1.0 - s;\n                                sqrDistance =\n                                    s * (a00 * s + a01 * t + 2.0 * b0) +\n                                    t * (a01 * s + a11 * t + 2.0 * b1) +\n                                    c;\n                            }\n                        }\n                    }\n                }\n\n                if (sqrDistance > this._radius * this._radius) return;\n\n                var normal = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n                var intersection = this.initIntersection(new SphereIntersection());\n                intersection._i1 = i0;\n                intersection._i2 = i1;\n                intersection._i3 = i2;\n\n                intersection._r1 = 1 - s - t;\n                intersection._r2 = s;\n                intersection._r3 = t;\n\n                // inter = v0 + edge1 * s + edge2 * t\n                var inter = intersection._localIntersectionPoint;\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(inter, __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].scaleAndAdd(inter, v0, edge1, s), edge2, t);\n\n                // normal\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].cross(intersection._localIntersectionNormal, edge1, edge2);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].normalize(normal, intersection._localIntersectionNormal);\n\n                intersection._ratio = Math.sqrt(sqrDistance) / this._radius;\n                intersection._zone = zone;\n            };\n        })()\n    }),\n    \'osgUtil\',\n    \'SphereIntersectFunctor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (SphereIntersectFunctor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/SphereIntersectFunctor.js\n// module id = 238\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/SphereIntersectFunctor.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n\n\nvar TangentSpaceGenerator = function() {\n    __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].call(this);\n    this._T = undefined;\n    this._B = undefined;\n    this._N = undefined;\n    this._texCoordUnit = 0;\n};\n\n__WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].createPrototypeObject(\n    TangentSpaceGenerator,\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].prototype, {\n        apply: function(node) {\n            if (node.getTypeID() === __WEBPACK_IMPORTED_MODULE_2_osg_Geometry__["a" /* default */].getTypeID()) this.generate(node, this._texCoordUnit);\n            else this.traverse(node);\n        },\n\n        setTexCoordUnit: function(texCoordUnit) {\n            this._texCoordUnit = texCoordUnit;\n        },\n\n        computePrimitiveSet: function(geometry, primitive) {\n            // no indices -> exit\n            if (!primitive.getIndices) return;\n\n            var numIndices = primitive.getNumIndices();\n\n            var vx = geometry.getAttributes().Vertex;\n            var nx = geometry.getAttributes().Normal;\n            var tx = geometry.getAttributes()[\'TexCoord\' + this._texCoordUnit];\n\n            var i;\n\n            if (primitive.getMode() === __WEBPACK_IMPORTED_MODULE_4_osg_primitiveSet__["a" /* default */].TRIANGLES) {\n                for (i = 0; i < numIndices; i += 3) {\n                    this.compute(primitive, vx, nx, tx, i, i + 1, i + 2);\n                }\n            } else if (primitive.getMode() === __WEBPACK_IMPORTED_MODULE_4_osg_primitiveSet__["a" /* default */].TRIANGLE_STRIP) {\n                for (i = 0; i < numIndices - 2; ++i) {\n                    if (i % 2 === 0) {\n                        this.compute(primitive, vx, nx, tx, i, i + 1, i + 2);\n                    } else {\n                        this.compute(primitive, vx, nx, tx, i + 1, i, i + 2);\n                    }\n                }\n            }\n        },\n\n        generate: function(geometry, texCoordUnit) {\n            this._texCoordUnit = texCoordUnit;\n\n            if (this._texCoordUnit === undefined) this._texCoordUnit = 0;\n\n            var size = geometry.getAttributes().Vertex.getElements().length;\n            this._T = new __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].Float32Array(size);\n            this._B = new __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].Float32Array(size);\n            this._N = new __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].Float32Array(size);\n\n            geometry.getPrimitiveSetList().forEach(function(primitive) {\n                this.computePrimitiveSet(geometry, primitive);\n            }, this);\n\n            var nbElements = size / 3;\n            var tangents = new __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].Float32Array(nbElements * 4);\n\n            var tmp0 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var tmp1 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var t3 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n\n            for (var i = 0; i < nbElements; i++) {\n                var t = this._T.subarray(i * 3, i * 3 + 3);\n                var n = this._N.subarray(i * 3, i * 3 + 3);\n                var b = this._B.subarray(i * 3, i * 3 + 3);\n\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(n, n);\n\n                // Gram-Schmidt orthogonalize\n                // vec3 t3 = (t - n * (n * t));\n                // t3.normalize();\n                // finalTangent = Vec4(t3, 0.0);\n                // Calculate handedness\n                // finalTangent[3] = (((n ^ t) * b) < 0.0) ? -1.0 : 1.0;\n                // The bitangent vector B is then given by B = (N × T) · Tw\n\n                var nt = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].dot(n, t);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].scale(tmp1, n, nt);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].sub(tmp0, t, tmp1);\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(t3, tmp0);\n\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tmp0, n, t);\n                var sign = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].dot(tmp0, b);\n                sign = sign < 0.0 ? -1.0 : 0.0;\n\n                // TODO perf : cache index var id = i * 4;\n                tangents[i * 4] = t3[0];\n                tangents[i * 4 + 1] = t3[1];\n                tangents[i * 4 + 2] = t3[2];\n                tangents[i * 4 + 3] = sign;\n            }\n\n            geometry.getAttributes().Normal.setElements(this._N);\n            geometry.getAttributes().Tangent = new __WEBPACK_IMPORTED_MODULE_1_osg_BufferArray__["a" /* default */](\'ARRAY_BUFFER\', tangents, 4);\n        },\n\n        compute: function(primitive, vx, nx, tx, ia, ib, ic) {\n            var i0 = primitive.index(ia);\n            var i1 = primitive.index(ib);\n            var i2 = primitive.index(ic);\n\n            // TODO perf : cache xx.getElements() but more importantly\n            // subarray call have very high overhead, it\'s super useful\n            // when you call it a few times for big array chunk, but for\n            // small array extraction (each vertex) it\'s better to use a temporary\n            // pre allocated array and simply fill it\n            // then, you\'ll have to write in the big arrays at the end\n            var P1 = vx.getElements().subarray(i0 * 3, i0 * 3 + 3);\n            var P2 = vx.getElements().subarray(i1 * 3, i1 * 3 + 3);\n            var P3 = vx.getElements().subarray(i2 * 3, i2 * 3 + 3);\n\n            var N1 = nx.getElements().subarray(i0 * 3, i0 * 3 + 3);\n            var N2 = nx.getElements().subarray(i1 * 3, i1 * 3 + 3);\n            var N3 = nx.getElements().subarray(i2 * 3, i2 * 3 + 3);\n\n            var uv1 = tx.getElements().subarray(i0 * 2, i0 * 2 + 2);\n            var uv2 = tx.getElements().subarray(i1 * 2, i1 * 2 + 2);\n            var uv3 = tx.getElements().subarray(i2 * 2, i2 * 2 + 2);\n\n            var vz, vy;\n            // TODO perf : use temporary vec\n            var V = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n\n            var B1 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var B2 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var B3 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n\n            var T1 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var T2 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var T3 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n\n            var v1 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var v2 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(v1, P2[0] - P1[0], uv2[0] - uv1[0], uv2[1] - uv1[1]);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(v2, P3[0] - P1[0], uv3[0] - uv1[0], uv3[1] - uv1[1]);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(V, v1, v2);\n\n            if (V[0] !== 0.0) {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(V, V);\n                vy = -V[1] / V[0];\n                vz = -V[2] / V[0];\n                T1[0] += vy;\n                B1[0] += vz;\n                T2[0] += vy;\n                B2[0] += vz;\n                T3[0] += vy;\n                B3[0] += vz;\n            }\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(v1, P2[1] - P1[1], uv2[0] - uv1[0], uv2[1] - uv1[1]);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(v2, P3[1] - P1[1], uv3[0] - uv1[0], uv3[1] - uv1[1]);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(V, v1, v2);\n\n            if (V[0] !== 0.0) {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(V, V);\n                vy = -V[1] / V[0];\n                vz = -V[2] / V[0];\n                T1[1] += vy;\n                B1[1] += vz;\n                T2[1] += vy;\n                B2[1] += vz;\n                T3[1] += vy;\n                B3[1] += vz;\n            }\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(v1, P2[2] - P1[2], uv2[0] - uv1[0], uv2[1] - uv1[1]);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].set(v2, P3[2] - P1[2], uv3[0] - uv1[0], uv3[1] - uv1[1]);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(V, v1, v2);\n\n            if (V[0] !== 0.0) {\n                __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].normalize(V, V);\n                vy = -V[1] / V[0];\n                vz = -V[2] / V[0];\n                T1[2] += vy;\n                B1[2] += vz;\n                T2[2] += vy;\n                B2[2] += vz;\n                T3[2] += vy;\n                B3[2] += vz;\n            }\n\n            var tempVec = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n            var tempVec2 = __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].create();\n\n            var Tdst, Bdst, Ndst;\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec, N1, T1);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec2, tempVec, N1);\n            Tdst = this._T.subarray(i0 * 3, i0 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Tdst, tempVec2, Tdst);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec, B1, N1);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec2, N1, tempVec);\n            Bdst = this._B.subarray(i0 * 3, i0 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Bdst, tempVec2, Bdst);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec, N2, T2);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec2, tempVec, N2);\n            Tdst = this._T.subarray(i1 * 3, i1 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Tdst, tempVec2, Tdst);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec, B2, N2);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec2, N2, tempVec);\n            Bdst = this._B.subarray(i1 * 3, i1 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Bdst, tempVec2, Bdst);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec, N3, T3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec2, tempVec, N3);\n            Tdst = this._T.subarray(i2 * 3, i2 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Tdst, tempVec2, Tdst);\n\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec, B3, N3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].cross(tempVec2, N3, tempVec);\n            Bdst = this._B.subarray(i2 * 3, i2 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Bdst, tempVec2, Bdst);\n\n            Ndst = this._N.subarray(i0 * 3, i0 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Ndst, N1, Ndst);\n\n            Ndst = this._N.subarray(i1 * 3, i1 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Ndst, N2, Ndst);\n\n            Ndst = this._N.subarray(i2 * 3, i2 * 3 + 3);\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["f" /* vec3 */].add(Ndst, N3, Ndst);\n        }\n    }),\n    \'osgUtil\',\n    \'TangentSpaceGenerator\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (TangentSpaceGenerator);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/TangentSpaceGenerator.js\n// module id = 239\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/TangentSpaceGenerator.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__ = __webpack_require__(39);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar WebVRCustom = {};\n\n// no smart resize, we just recreate everything\nvar UpdateRecreateOnResize = function(viewer, rttScene, hmdConfig, root, canvas) {\n    this._viewer = viewer;\n    this._rttScene = rttScene;\n    this._hmdConfig = hmdConfig;\n    this._root = root;\n    this._canvas = canvas;\n    this._width = canvas.width;\n    this._height = canvas.height;\n};\n\nUpdateRecreateOnResize.prototype = {\n    update: function() {\n        var canvas = this._canvas;\n        var width = canvas.width;\n        var height = canvas.height;\n\n        if (width !== this._width || height !== this._height) {\n            this._root.removeChildren();\n\n            var hmdConfig = this._hmdConfig;\n            if (hmdConfig && hmdConfig.isCardboard) {\n                hmdConfig.hResolution = width;\n                hmdConfig.vResolution = height;\n            }\n            this._width = width;\n            this._height = height;\n\n            WebVRCustom.createScene(this._viewer, this._rttScene, hmdConfig, this._root);\n        }\n        return true;\n    }\n};\n\nvar UpdateOffsetCamera = function(rootView, offsetView) {\n    this._rootView = rootView;\n    this._offsetView = offsetView;\n};\n\nUpdateOffsetCamera.prototype = {\n    update: function(node) {\n        var nodeView = node.getViewMatrix();\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(nodeView, this._offsetView, this._rootView);\n        return true;\n    }\n};\n\nvar setupWebVR = function(worldFactor, HMD, webVRUniforms, webVRMatrices) {\n    var aspect = HMD.hResolution / (2.0 * HMD.vResolution);\n    var r =\n        -1.0 - 4.0 * (HMD.hScreenSize * 0.25 - HMD.lensSeparationDistance * 0.5) / HMD.hScreenSize;\n    var distScale =\n        HMD.distortionK[0] +\n        HMD.distortionK[1] * Math.pow(r, 2) +\n        HMD.distortionK[2] * Math.pow(r, 4) +\n        HMD.distortionK[3] * Math.pow(r, 6);\n    var fov =\n        180.0 /\n        Math.PI *\n        2.0 *\n        Math.atan2(HMD.vScreenSize * distScale, 2.0 * HMD.eyeToScreenDistance);\n\n    var proj = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].perspective(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create(), Math.PI / 180 * fov, aspect, 0.3, 10000.0);\n\n    var hOffset =\n        4.0 * (HMD.hScreenSize * 0.25 - HMD.interpupillaryDistance * 0.5) / HMD.hScreenSize;\n    var lensShift =\n        4.0 * (HMD.hScreenSize * 0.25 - HMD.lensSeparationDistance * 0.5) / HMD.hScreenSize;\n\n    var leftMat = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n    var rightMat = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create();\n    webVRMatrices.projectionLeft = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(\n        leftMat,\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromTranslation(leftMat, __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(hOffset, 0.0, 0.0)),\n        proj\n    );\n    webVRMatrices.projectionRight = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].mul(\n        rightMat,\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromTranslation(rightMat, __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(-hOffset, 0.0, 0.0)),\n        proj\n    );\n    webVRMatrices.viewLeft = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromTranslation(\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(worldFactor * HMD.interpupillaryDistance * 0.5, 0.0, 0.0)\n    );\n    webVRMatrices.viewRight = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].fromTranslation(\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["f" /* vec3 */].fromValues(-worldFactor * HMD.interpupillaryDistance * 0.5, 0.0, 0.0)\n    );\n\n    webVRUniforms.lensCenterLeft = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(lensShift, 0.0);\n    webVRUniforms.lensCenterRight = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(-lensShift, 0.0);\n    webVRUniforms.hmdWarpParam = HMD.distortionK;\n    webVRUniforms.chromAbParam = HMD.chromaAbParameter;\n    webVRUniforms.scaleIn = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(1.0, 1.0 / aspect);\n    webVRUniforms.scale = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(1.0 / distScale, 1.0 * aspect / distScale);\n};\n\nvar getWebVRShader = function() {\n    var fragmentshader = [\n        \'\',\n        \'#ifdef GL_ES\',\n        \'precision highp float;\',\n        \'#endif\',\n\n        \'uniform vec2 uScale;\',\n        \'uniform vec2 uScaleIn;\',\n        \'uniform vec2 uLensCenter;\',\n        \'uniform vec4 uHmdWarpParam;\',\n        \'uniform vec4 uChromAbParam;\',\n        \'uniform sampler2D Texture0;\',\n\n        \'varying vec2 vTexCoord0;\',\n\n        // from http://paradise.untergrund.net/tmp/demoshit/examples/js/effects/OculusRiftEffect.js\n        \'void main(void) {\',\n        \'  vec2 uv = (vTexCoord0 * 2.0) - 1.0;\', // range from [0,1] to [-1,1]\n        \'  vec2 theta = (uv - uLensCenter) * uScaleIn;\',\n        \'  float rSq = theta.x * theta.x + theta.y * theta.y;\',\n        \'  vec2 rvector = theta * (uHmdWarpParam.x + uHmdWarpParam.y * rSq + uHmdWarpParam.z * rSq * rSq + uHmdWarpParam.w * rSq * rSq * rSq);\',\n        \'  vec2 rBlue = rvector * (uChromAbParam.z + uChromAbParam.w * rSq);\',\n        \'  vec2 tcBlue = (uLensCenter + uScale * rBlue);\',\n        \'  tcBlue = (tcBlue + 1.0) * 0.5;\', // range from [-1,1] to [0,1]\n        \'  if (any(bvec2(clamp(tcBlue, vec2(0.0, 0.0), vec2(1.0, 1.0)) - tcBlue))) {\',\n        \'    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\',\n        \'    return;\',\n        \'  }\',\n        \'  vec2 tcGreen = uLensCenter + uScale * rvector;\',\n        \'  tcGreen = (tcGreen + 1.0) * 0.5;\', // range from [-1,1] to [0,1]\n        \'  vec2 rRed = rvector * (uChromAbParam.x + uChromAbParam.y * rSq);\',\n        \'  vec2 tcRed = uLensCenter + uScale * rRed;\',\n        \'  tcRed = (tcRed + 1.0) * 0.5;\', // range from [-1,1] to [0,1]\n        \'  gl_FragColor = vec4(texture2D(Texture0, tcRed).r, texture2D(Texture0, tcGreen).g, texture2D(Texture0, tcBlue).b, 1);\',\n        \'}\',\n        \'\'\n    ].join(\'\\n\');\n\n    return new __WEBPACK_IMPORTED_MODULE_4_osg_Program__["a" /* default */](\n        new __WEBPACK_IMPORTED_MODULE_5_osg_Shader__["a" /* default */](\n            __WEBPACK_IMPORTED_MODULE_5_osg_Shader__["a" /* default */].VERTEX_SHADER,\n            [\n                \'attribute vec3 Vertex;\',\n                \'varying vec2 vTexCoord0;\',\n                \'void main(void) {\',\n                \'  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);\',\n                \'  vTexCoord0 = Vertex.xy;\',\n                \'}\',\n                \'\',\n                \'#define SHADER_NAME VRpostProcessing\',\n                \'\'\n            ].join(\'\\n\')\n        ),\n        new __WEBPACK_IMPORTED_MODULE_5_osg_Shader__["a" /* default */](__WEBPACK_IMPORTED_MODULE_5_osg_Shader__["a" /* default */].FRAGMENT_SHADER, fragmentshader)\n    );\n};\n\nvar createTextureRtt = function(rttSize) {\n    var rttTexture = new __WEBPACK_IMPORTED_MODULE_7_osg_Texture__["default"]();\n    rttTexture.setTextureSize(rttSize[0], rttSize[1]);\n    rttTexture.setMinFilter(\'LINEAR\');\n    rttTexture.setMagFilter(\'LINEAR\');\n    return rttTexture;\n};\n\nvar createOrthoRtt = function(left, viewportSize, canvasSize, cardboard, texture, webVRUniforms) {\n    var orthoCamera = new __WEBPACK_IMPORTED_MODULE_0_osg_Camera__["a" /* default */]();\n    var vw = viewportSize[0];\n    var vh = viewportSize[1];\n    var cw = canvasSize[0];\n    var ch = canvasSize[1];\n    if (cardboard === true) {\n        if (left) orthoCamera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */](0.0, 0.0, cw / 2.0, ch));\n        else orthoCamera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */](cw / 2.0, 0.0, cw / 2.0, ch));\n    } else {\n        if (left) orthoCamera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */](0.5 * cw - vw, 0.5 * (ch - vh), vw, vh));\n        else orthoCamera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */](0.5 * cw, 0.5 * (ch - vh), vw, vh));\n    }\n    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["c" /* mat4 */].ortho(orthoCamera.getProjectionMatrix(), -0.5, 0.5, -0.5, 0.5, -5, 5);\n    orthoCamera.setRenderOrder(__WEBPACK_IMPORTED_MODULE_0_osg_Camera__["a" /* default */].NESTED_RENDER, 0);\n    orthoCamera.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_8_osg_Transform__["a" /* default */].ABSOLUTE_RF);\n\n    var stateSet = orthoCamera.getOrCreateStateSet();\n    stateSet.setTextureAttributeAndModes(0, texture);\n    stateSet.setAttributeAndModes(getWebVRShader());\n    stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat2(webVRUniforms.scale, \'uScale\'));\n    stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat2(webVRUniforms.scaleIn, \'uScaleIn\'));\n    stateSet.addUniform(\n        __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat2(\n            left ? webVRUniforms.lensCenterLeft : webVRUniforms.lensCenterRight,\n            \'uLensCenter\'\n        )\n    );\n    stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat4(webVRUniforms.hmdWarpParam, \'uHmdWarpParam\'));\n    stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat4(webVRUniforms.chromAbParam, \'uChromAbParam\'));\n\n    return orthoCamera;\n};\n\nvar createCameraRtt = function(texture, projMatrix) {\n    var camera = new __WEBPACK_IMPORTED_MODULE_0_osg_Camera__["a" /* default */]();\n    camera.setName(\'rtt camera\');\n    camera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */](0, 0, texture.getWidth(), texture.getHeight()));\n    camera.setProjectionMatrix(projMatrix);\n    camera.setClearColor(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(0.3, 0.3, 0.3, 0.0));\n    camera.setRenderOrder(__WEBPACK_IMPORTED_MODULE_0_osg_Camera__["a" /* default */].POST_RENDER, 0);\n    camera.attachTexture(__WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__["a" /* default */].COLOR_ATTACHMENT0, texture);\n    camera.attachRenderBuffer(\n        __WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__["a" /* default */].DEPTH_ATTACHMENT,\n        __WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__["a" /* default */].DEPTH_COMPONENT16\n    );\n    camera.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_8_osg_Transform__["a" /* default */].ABSOLUTE_RF);\n    return camera;\n};\n\nWebVRCustom.createScene = function(viewer, rttScene, HMDconfig, rootOverride, worldFactorOverride) {\n    var HMD = WebVRCustom.getDefaultConfig(HMDconfig);\n    var rttSize = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(HMD.hResolution * 0.5, HMD.vResolution);\n    var viewportSize = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(HMD.hResolution * 0.5, HMD.vResolution);\n    var vp = viewer.getCamera().getViewport();\n    var canvasSize = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["e" /* vec2 */].fromValues(vp.width(), vp.height());\n\n    var canvas = viewer.getGraphicContext().canvas;\n    if (HMD.isCardboard) {\n        canvasSize[0] = canvas.width;\n        canvasSize[1] = canvas.height;\n    }\n\n    var worldFactor = worldFactorOverride !== undefined ? worldFactorOverride : 1.0;\n    var webVRUniforms = {};\n    var webVRMatrices = {};\n    setupWebVR(worldFactor, HMD, webVRUniforms, webVRMatrices);\n\n    var rootViewMatrix = viewer.getCamera().getViewMatrix();\n\n    var root = rootOverride || new __WEBPACK_IMPORTED_MODULE_3_osg_Node__["a" /* default */]();\n    root.addUpdateCallback(new UpdateRecreateOnResize(viewer, rttScene, HMDconfig, root, canvas));\n\n    var rttTextureLeft = createTextureRtt(rttSize);\n    var rttCamLeft = createCameraRtt(rttTextureLeft, webVRMatrices.projectionLeft);\n    var orthoCameraLeft = createOrthoRtt(\n        true,\n        viewportSize,\n        canvasSize,\n        HMD.isCardboard,\n        rttTextureLeft,\n        webVRUniforms\n    );\n    rttCamLeft.addUpdateCallback(new UpdateOffsetCamera(rootViewMatrix, webVRMatrices.viewLeft));\n\n    var rttTextureRight = createTextureRtt(rttSize);\n    var rttCamRight = createCameraRtt(rttTextureRight, webVRMatrices.projectionRight);\n    var orthoCameraRight = createOrthoRtt(\n        false,\n        viewportSize,\n        canvasSize,\n        HMD.isCardboard,\n        rttTextureRight,\n        webVRUniforms\n    );\n    rttCamRight.addUpdateCallback(new UpdateOffsetCamera(rootViewMatrix, webVRMatrices.viewRight));\n\n    rttCamLeft.addChild(rttScene);\n    rttCamRight.addChild(rttScene);\n\n    orthoCameraLeft.addChild(__WEBPACK_IMPORTED_MODULE_6_osg_shape__["a" /* default */].createTexturedFullScreenFakeQuadGeometry());\n    orthoCameraRight.addChild(__WEBPACK_IMPORTED_MODULE_6_osg_shape__["a" /* default */].createTexturedFullScreenFakeQuadGeometry());\n\n    root.addChild(rttCamLeft);\n    root.addChild(rttCamRight);\n\n    root.addChild(orthoCameraLeft);\n    root.addChild(orthoCameraRight);\n\n    return root;\n};\n\nWebVRCustom.getDefaultConfig = function(hmdConfig) {\n    // FOV: 103.506416\n    // vScreenCenter: 0.03645\n\n    // Oculus Rift DK2\n    var hmd = {\n        hResolution: 1920,\n        vResolution: 1080,\n        hScreenSize: 0.1296,\n        vScreenSize: 0.0729,\n        interpupillaryDistance: 0.064,\n        lensSeparationDistance: 0.0635,\n        eyeToScreenDistance: 0.04,\n        distortionK: __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.22, 0.13, 0.02),\n        chromaAbParameter: __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(0.996, -0.004, 1.014, 0.0),\n        isCardboard: false\n    };\n\n    if (hmdConfig === 2 || hmdConfig === undefined) return hmd;\n\n    if (hmdConfig === 1) {\n        // Oculus Rift DK1\n        hmd.hResolution = 1280;\n        hmd.vResolution = 800;\n        hmd.hScreenSize = 0.14976;\n        hmd.vScreenSize = 0.0936;\n        hmd.lensSeparationDistance = 0.064;\n        hmd.eyeToScreenDistance = 0.041;\n        hmd.distortionK = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 0.22, 0.24, 0.0);\n        return hmd;\n    }\n\n    // custom param\n    if (hmdConfig.hResolution !== undefined) hmd.hResolution = hmdConfig.hResolution;\n    if (hmdConfig.vResolution !== undefined) hmd.vResolution = hmdConfig.vResolution;\n    if (hmdConfig.hScreenSize !== undefined) hmd.hScreenSize = hmdConfig.hScreenSize;\n    if (hmdConfig.vScreenSize !== undefined) hmd.vScreenSize = hmdConfig.vScreenSize;\n    if (hmdConfig.interpupillaryDistance !== undefined)\n        hmd.interpupillaryDistance = hmdConfig.interpupillaryDistance;\n    if (hmdConfig.lensSeparationDistance !== undefined)\n        hmd.lensSeparationDistance = hmdConfig.lensSeparationDistance;\n    if (hmdConfig.eyeToScreenDistance !== undefined)\n        hmd.eyeToScreenDistance = hmdConfig.eyeToScreenDistance;\n    if (hmdConfig.distortionK !== undefined) hmd.distortionK = hmdConfig.distortionK;\n    if (hmdConfig.chromaAbParameter !== undefined)\n        hmd.chromaAbParameter = hmdConfig.chromaAbParameter;\n    if (hmdConfig.isCardboard !== undefined) hmd.isCardboard = hmdConfig.isCardboard;\n\n    return hmd;\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (WebVRCustom);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/WebVRCustom.js\n// module id = 240\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/WebVRCustom.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_shape__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_Transform__ = __webpack_require__(23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__ = __webpack_require__(39);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar UpdateRttCameraCallback = function(rootView, offsetView) {\n    this._rootView = rootView;\n    this._offsetView = offsetView;\n};\n\nUpdateRttCameraCallback.prototype = {\n    update: function(node /*, nv */) {\n        var nodeView = node.getViewMatrix();\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].mul(nodeView, this._offsetView, this._rootView);\n        return true;\n    }\n};\n\nvar createTexture = function(size) {\n    var texture = new __WEBPACK_IMPORTED_MODULE_7_osg_Texture__[\"default\"]();\n    texture.setTextureSize(size.width, size.height);\n    texture.setMinFilter('LINEAR');\n    texture.setMagFilter('LINEAR');\n    return texture;\n};\n\nvar getAssembleShader = function() {\n    var fragmentShader = [\n        '#ifdef GL_ES',\n        '   precision highp float;',\n        '#endif',\n        'varying vec2 vTexCoord0;',\n        'uniform sampler2D TextureLeft;',\n        'uniform sampler2D TextureRight;',\n\n        'void main() {',\n        '   if (vTexCoord0.x < 0.5)',\n        '       gl_FragColor = texture2D(TextureLeft, vec2(vTexCoord0.x * 2.0, vTexCoord0.y));',\n        '   else',\n        '       gl_FragColor = texture2D(TextureRight, vec2(vTexCoord0.x * 2.0 - 1.0, vTexCoord0.y));',\n        '}'\n    ].join('\\n');\n\n    return new __WEBPACK_IMPORTED_MODULE_4_osg_Program__[\"a\" /* default */](\n        new __WEBPACK_IMPORTED_MODULE_5_osg_Shader__[\"a\" /* default */](\n            __WEBPACK_IMPORTED_MODULE_5_osg_Shader__[\"a\" /* default */].VERTEX_SHADER,\n            [\n                'attribute vec3 Vertex;',\n                'varying vec2 vTexCoord0;',\n                'void main(void) {',\n                '  gl_Position = vec4(Vertex * 2.0 - 1.0, 1.0);',\n                '  vTexCoord0 = Vertex.xy;',\n                '}',\n                '',\n                '#define SHADER_NAME VRpostProcessing',\n                ''\n            ].join('\\n')\n        ),\n        new __WEBPACK_IMPORTED_MODULE_5_osg_Shader__[\"a\" /* default */](__WEBPACK_IMPORTED_MODULE_5_osg_Shader__[\"a\" /* default */].FRAGMENT_SHADER, fragmentShader)\n    );\n};\n\n// This camera will render both textures on the canvas in a single pass\nvar createCameraCanvas = function(leftEyeTexture, rightEyeTexture, viewport) {\n    var orthoCamera = new __WEBPACK_IMPORTED_MODULE_0_osg_Camera__[\"a\" /* default */]();\n    orthoCamera.setViewport(viewport);\n    orthoCamera.setRenderOrder(__WEBPACK_IMPORTED_MODULE_0_osg_Camera__[\"a\" /* default */].NESTED_RENDER, 0);\n    orthoCamera.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_8_osg_Transform__[\"a\" /* default */].ABSOLUTE_RF);\n    __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].ortho(orthoCamera.getProjectionMatrix(), 0.0, 1.0, 0.0, 1.0, -5.0, 5.0);\n\n    var stateSet = orthoCamera.getOrCreateStateSet();\n    stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_9_osg_Uniform__[\"a\" /* default */].createInt(0, 'TextureLeft'));\n    stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_9_osg_Uniform__[\"a\" /* default */].createInt(1, 'TextureRight'));\n    stateSet.setTextureAttributeAndModes(0, leftEyeTexture);\n    stateSet.setTextureAttributeAndModes(1, rightEyeTexture);\n    stateSet.setAttributeAndModes(getAssembleShader());\n\n    orthoCamera.addChild(__WEBPACK_IMPORTED_MODULE_6_osg_shape__[\"a\" /* default */].createTexturedFullScreenFakeQuadGeometry());\n\n    return orthoCamera;\n};\n\n// This camera will render the scene on a texture for an eye\nvar createCameraRtt = function(texture, projection) {\n    var camera = new __WEBPACK_IMPORTED_MODULE_0_osg_Camera__[\"a\" /* default */]();\n    camera.setName('rtt camera');\n    camera.setViewport(new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__[\"a\" /* default */](0.0, 0.0, texture.getWidth(), texture.getHeight()));\n    camera.setProjectionMatrix(projection);\n    camera.setClearColor(__WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"g\" /* vec4 */].fromValues(0.3, 0.3, 0.3, 0.0));\n    camera.setRenderOrder(__WEBPACK_IMPORTED_MODULE_0_osg_Camera__[\"a\" /* default */].POST_RENDER, 0);\n    camera.attachTexture(__WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__[\"a\" /* default */].COLOR_ATTACHMENT0, texture);\n    camera.attachRenderBuffer(\n        __WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__[\"a\" /* default */].DEPTH_ATTACHMENT,\n        __WEBPACK_IMPORTED_MODULE_1_osg_FrameBufferObject__[\"a\" /* default */].DEPTH_COMPONENT16\n    );\n    camera.setReferenceFrame(__WEBPACK_IMPORTED_MODULE_8_osg_Transform__[\"a\" /* default */].ABSOLUTE_RF);\n    return camera;\n};\n\nvar WebVR = {};\n\nWebVR.createScene = function(viewer, rttScene, HMDdevice, rootOverride, worldFactorOverride) {\n    var root = rootOverride || new __WEBPACK_IMPORTED_MODULE_3_osg_Node__[\"a\" /* default */]();\n    var worldFactor = worldFactorOverride !== undefined ? worldFactorOverride : 1.0;\n\n    var left = HMDdevice.getEyeParameters('left');\n    var right = HMDdevice.getEyeParameters('right');\n\n    var frameData = new window.VRFrameData();\n    HMDdevice.getFrameData(frameData);\n\n    // Compute projections and view matrices for both eyes\n    var viewLeft = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].fromTranslation(\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"f\" /* vec3 */].fromValues(-worldFactor * left.offset[0], left.offset[1], left.offset[2])\n    );\n    var viewRight = __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].fromTranslation(\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"c\" /* mat4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_2_osg_glMatrix__[\"f\" /* vec3 */].fromValues(-worldFactor * right.offset[0], right.offset[1], right.offset[2])\n    );\n\n    // Each eye is rendered on a texture whose width is half of the final combined texture\n    var eyeTextureSize = {\n        width: Math.max(left.renderWidth, right.renderWidth),\n        height: Math.max(left.renderHeight, right.renderHeight)\n    };\n\n    var leftEyeTexture = createTexture(eyeTextureSize);\n    var rightEyeTexture = createTexture(eyeTextureSize);\n\n    // Setup the render cameras for both eyes\n    var camRttLeft = createCameraRtt(leftEyeTexture, frameData.leftProjectionMatrix);\n    var camRttRight = createCameraRtt(rightEyeTexture, frameData.rightProjectionMatrix);\n\n    // The viewMatrix of each eye is updated with the current viewer's camera viewMatrix\n    var rootViewMatrix = viewer.getCamera().getViewMatrix();\n    camRttLeft.addUpdateCallback(new UpdateRttCameraCallback(rootViewMatrix, viewLeft));\n    camRttRight.addUpdateCallback(new UpdateRttCameraCallback(rootViewMatrix, viewRight));\n\n    // Render both textures on the canvas, using the viewer's camera viewport to render on the fullscreen canvas\n    var camCanvas = createCameraCanvas(\n        leftEyeTexture,\n        rightEyeTexture,\n        viewer.getCamera().getViewport()\n    );\n\n    camRttLeft.addChild(rttScene);\n    camRttRight.addChild(rttScene);\n\n    root.addChild(camRttLeft);\n    root.addChild(camRttRight);\n    root.addChild(camCanvas);\n\n    return root;\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WebVR);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/WebVR.js\n// module id = 241\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/WebVR.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgViewer_Renderer__ = __webpack_require__(96);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgViewer_View__ = __webpack_require__(97);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgViewer_Viewer__ = __webpack_require__(243);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgViewer_eventProxy_eventProxy__ = __webpack_require__(160);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgViewer_Scene__ = __webpack_require__(158);\n\n\n\n\n\n\nvar osgViewer = {};\n\nosgViewer.Renderer = __WEBPACK_IMPORTED_MODULE_0_osgViewer_Renderer__["default"];\nosgViewer.View = __WEBPACK_IMPORTED_MODULE_1_osgViewer_View__["default"];\nosgViewer.Viewer = __WEBPACK_IMPORTED_MODULE_2_osgViewer_Viewer__["a" /* default */];\nosgViewer.EventProxy = __WEBPACK_IMPORTED_MODULE_3_osgViewer_eventProxy_eventProxy__["a" /* default */];\nosgViewer.Scene = __WEBPACK_IMPORTED_MODULE_4_osgViewer_Scene__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (osgViewer);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/osgViewer.js\n// module id = 242\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/osgViewer.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Options__ = __webpack_require__(75);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Timer__ = __webpack_require__(22);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_TimerGPU__ = __webpack_require__(123);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_UpdateVisitor__ = __webpack_require__(122);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_GLObject__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_VertexArrayObject__ = __webpack_require__(59);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osg_Shader__ = __webpack_require__(26);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_Program__ = __webpack_require__(20);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osgGA_OrbitManipulator__ = __webpack_require__(90);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osgViewer_eventProxy_eventProxy__ = __webpack_require__(160);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osgViewer_View__ = __webpack_require__(97);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osgViewer_webgl_utils__ = __webpack_require__(107);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osgViewer_webgl_debug__ = __webpack_require__(250);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osgStats_Stats__ = __webpack_require__(161);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21_osgStats_defaultStats__ = __webpack_require__(165);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22_osgStats_glStats__ = __webpack_require__(166);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23_osgStats_browserStats__ = __webpack_require__(167);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Viewer = function(canvas, userOptions, error) {\n    __WEBPACK_IMPORTED_MODULE_17_osgViewer_View__["default"].call(this);\n\n    this._startTick = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick();\n    this._stats = undefined;\n    this._done = false;\n\n    // keep reference so that you still have it\n    // when gl context is lost\n    this._canvas = canvas;\n\n    var options = this.initOptions(userOptions);\n    var gl = this.initWebGLContext(canvas, options, error);\n\n    if (!gl) throw \'No WebGL implementation found\';\n\n    this.initDeviceEvents(options, canvas);\n    this._updateVisitor = new __WEBPACK_IMPORTED_MODULE_6_osg_UpdateVisitor__["a" /* default */]();\n\n    this.setUpView(gl.canvas, options);\n    this.initStats(options, canvas);\n\n    this._hmd = null;\n    this._requestAnimationFrame = window.requestAnimationFrame.bind(window);\n    this._options = options;\n    this._contextLost = false;\n    this._forceRestoreContext = true;\n    this.renderBinded = this.render.bind(this);\n};\n\n__WEBPACK_IMPORTED_MODULE_7_osg_utils__["a" /* default */].createPrototypeObject(\n    Viewer,\n    __WEBPACK_IMPORTED_MODULE_7_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_17_osgViewer_View__["default"].prototype, {\n        initDeviceEvents: function(options, canvas) {\n            // default argument for mouse binding\n            var defaultMouseEventNode = options.mouseEventNode || canvas;\n\n            var eventsBackend = options.EventBackend || {};\n            if (!options.EventBackend) options.EventBackend = eventsBackend;\n            eventsBackend.StandardMouseKeyboard = options.EventBackend.StandardMouseKeyboard || {};\n            var mouseEventNode =\n                eventsBackend.StandardMouseKeyboard.mouseEventNode || defaultMouseEventNode;\n            eventsBackend.StandardMouseKeyboard.mouseEventNode = mouseEventNode;\n            eventsBackend.StandardMouseKeyboard.keyboardEventNode =\n                eventsBackend.StandardMouseKeyboard.keyboardEventNode || document;\n\n            // hammer, Only activate it if we have a touch device in order to fix problems with IE11\n            if (\'ontouchstart\' in window) {\n                eventsBackend.Hammer = eventsBackend.Hammer || {};\n                eventsBackend.Hammer.eventNode =\n                    eventsBackend.Hammer.eventNode || defaultMouseEventNode;\n            }\n\n            // gamepad\n            eventsBackend.GamePad = eventsBackend.GamePad || {};\n\n            this._eventProxy = this.initEventProxy(options);\n        },\n\n        initOptions: function(userOptions) {\n            // use default options\n            var options = new __WEBPACK_IMPORTED_MODULE_2_osg_Options__["a" /* default */]();\n\n            if (userOptions) {\n                // user options override by user options\n                options.extend(userOptions);\n            }\n\n            // if url options override url options\n            options.extendWithOptionsURL();\n\n            // Activate global trace on log call\n            if (options.getBoolean(\'traceLogCall\') === true) __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].traceLogCall = true;\n\n            // Check if Frustum culling is enabled to calculate the clip planes\n            if (options.getBoolean(\'enableFrustumCulling\') === true)\n                this.getCamera()\n                    .getRenderer()\n                    .getCullVisitor()\n                    .setEnableFrustumCulling(true);\n\n            return options;\n        },\n\n        initWebGLContext: function(canvas, options, error) {\n            // #FIXME see tojiro\'s blog for webgl lost context stuffs\n            // $$ SOURCE_CODE_MODIFIED\n            if (options.hasOwnProperty(\'SimulateWebGLLostContext\')) {\n            // if (options.get(\'SimulateWebGLLostContext\')) {\n            // $$ SOURCE_CODE_MODIFIED\n                canvas = __WEBPACK_IMPORTED_MODULE_19_osgViewer_webgl_debug__["a" /* default */].makeLostContextSimulatingCanvas(canvas);\n                canvas.loseContextInNCalls(options.get(\'SimulateWebGLLostContext\'));\n                this._canvas = canvas;\n            }\n\n            var gl = __WEBPACK_IMPORTED_MODULE_18_osgViewer_webgl_utils__["a" /* default */].setupWebGL(canvas, options, error);\n\n            //www.khronos.org/registry/webgl/specs/latest/1.0/#WEBGLCONTEXTEVENT\n            canvas.addEventListener(\n                \'webglcontextlost\',\n                function(event) {\n                    this.contextLost();\n                    if (this._forceRestoreContext !== false) {\n                        event.preventDefault();\n                    }\n                }.bind(this),\n                false\n            );\n\n            canvas.addEventListener(\n                \'webglcontextrestored\',\n                function() {\n                    this.contextRestored();\n                }.bind(this),\n                false\n            );\n\n            if (__WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].reportWebGLError || options.get(\'reportWebGLError\')) {\n                gl = __WEBPACK_IMPORTED_MODULE_19_osgViewer_webgl_debug__["a" /* default */].makeDebugContext(gl);\n            }\n\n            this.initWebGLCaps(gl);\n            this.setGraphicContext(gl);\n\n            return gl;\n        },\n\n        // allow user to acknowledge the context lost\n        // (display a message, etc.)\n        // - callback return false: no attempt to restore\n        setContextLostCallback: function(callback) {\n            this._contextLostCallback = callback;\n            // just in case callback registration\n            // happens after the context lost\n            if (this._contextLost) {\n                this._forceRestoreContext = callback();\n            }\n        },\n\n        setContextRestoreCallback: function(callback) {\n            this._contextRestoreCallback = callback;\n        },\n\n        contextLost: function() {\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'webgl context lost\');\n            if (this._contextLostCallback) {\n                this._forceRestoreContext = this._contextLostCallback();\n            }\n            this._contextLost = true;\n            window.cancelAnimationFrame(this._requestID);\n        },\n\n        contextRestored: function() {\n            if (this._forceRestoreContext === false) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'webgl context restore not supported - please reload the page - \');\n                return;\n            }\n            // restore is already async\n            // https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.15.2\n            this.restoreContext();\n            __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'webgl context restored\');\n        },\n\n        restoreContext: function() {\n            var gl = this.getGraphicContext();\n\n            __WEBPACK_IMPORTED_MODULE_12_osg_Shader__["a" /* default */].onLostContext(gl);\n            __WEBPACK_IMPORTED_MODULE_13_osg_Program__["a" /* default */].onLostContext(gl);\n            __WEBPACK_IMPORTED_MODULE_10_osg_BufferArray__["a" /* default */].onLostContext(gl);\n            __WEBPACK_IMPORTED_MODULE_11_osg_VertexArrayObject__["a" /* default */].onLostContext(gl);\n            __WEBPACK_IMPORTED_MODULE_9_osg_FrameBufferObject__["a" /* default */].onLostContext(gl);\n            __WEBPACK_IMPORTED_MODULE_14_osg_Texture__["default"].getTextureManager(gl).onLostContext(gl);\n\n            __WEBPACK_IMPORTED_MODULE_8_osg_GLObject__["a" /* default */].onLostContext(gl);\n\n            this.getCamera()\n                .getRenderer()\n                .getState()\n                .resetCaches();\n\n            // if it\'s a different GPU, different webglcaps\n            this.initWebGLCaps(gl, true);\n            this.setGraphicContext(gl);\n\n            // different GPU caps means different timer caps\n            __WEBPACK_IMPORTED_MODULE_5_osg_TimerGPU__["a" /* default */].instance(this.getGraphicContext(), true);\n            if (this._stats) {\n                // stats geometries needs special care\n                this._stats.reset();\n            }\n\n            // ready to draw again\n            this._contextLost = false;\n            this._requestRedraw = true;\n\n            // Warn users context has been restored\n            if (this._contextRestoreCallback) {\n                this._contextRestoreCallback(gl);\n            }\n            this._runImplementation();\n        },\n\n        init: function() {\n            //this._done = false;\n        },\n\n        getUpdateVisitor: function() {\n            return this._updateVisitor;\n        },\n\n        getState: function() {\n            return this.getCamera()\n                .getRenderer()\n                .getState();\n        },\n\n        initStats: function(options) {\n            var timerGPU = __WEBPACK_IMPORTED_MODULE_5_osg_TimerGPU__["a" /* default */].instance(this.getGraphicContext());\n\n            if (!options.getBoolean(\'stats\')) {\n                timerGPU.disable();\n                return;\n            }\n\n            this._stats = new __WEBPACK_IMPORTED_MODULE_20_osgStats_Stats__["a" /* default */](this, options);\n            this._stats.addConfig(__WEBPACK_IMPORTED_MODULE_21_osgStats_defaultStats__["a" /* default */]);\n            this._stats.addConfig(__WEBPACK_IMPORTED_MODULE_22_osgStats_glStats__["a" /* default */]);\n            this._stats.addConfig(__WEBPACK_IMPORTED_MODULE_23_osgStats_browserStats__["a" /* default */]);\n\n            this.getCamera().addChild(this._stats.getNode());\n\n            timerGPU.setCallback(this.callbackTimerGPU.bind(this));\n        },\n\n        callbackTimerGPU: function(average, queryID) {\n            if (this._stats) this._stats.getCounter(queryID).set(average / 1e6);\n        },\n\n        getViewerStats: function() {\n            return this._stats;\n        },\n\n        renderingTraversal: function() {\n            this.getState()._frameStamp = this._frameStamp;\n\n            if (this.getScene().getSceneData())\n                this.getScene()\n                    .getSceneData()\n                    .getBound();\n\n            if (this.getCamera()) {\n                var stats = this._stats;\n                var timerGPU = __WEBPACK_IMPORTED_MODULE_5_osg_TimerGPU__["a" /* default */].instance(this.getGraphicContext());\n\n                var renderer = this.getCamera().getRenderer();\n\n                if (stats) stats.getCounter(\'cull\').start();\n\n                renderer.cull();\n\n                if (stats) stats.getCounter(\'cull\').end();\n\n                timerGPU.pollQueries();\n                timerGPU.start(\'glframe\');\n\n                if (stats) {\n                    stats.getCounter(\'render\').start();\n                }\n\n                renderer.draw();\n\n                if (stats) {\n                    stats.getCounter(\'render\').end();\n                }\n\n                timerGPU.end(\'glframe\');\n\n                if (stats) {\n                    var cullVisitor = renderer.getCullVisitor();\n                    stats.getCounter(\'cullcamera\').set(cullVisitor._numCamera);\n                    stats.getCounter(\'cullmatrixtransform\').set(cullVisitor._numMatrixTransform);\n                    stats.getCounter(\'cullprojection\').set(cullVisitor._numProjection);\n                    stats.getCounter(\'cullnode\').set(cullVisitor._numNode);\n                    stats.getCounter(\'culllightsource\').set(cullVisitor._numLightSource);\n                    stats.getCounter(\'cullgeometry\').set(cullVisitor._numGeometry);\n\n                    stats.getCounter(\'pushstateset\').set(renderer.getState()._numPushStateSet);\n\n                    stats.getCounter(\'applyStateSet\').set(renderer.getState()._numApply);\n                }\n            }\n        },\n\n        updateTraversal: function() {\n            var stats = this._stats;\n\n            if (stats) stats.getCounter(\'update\').start();\n\n            // update the scene\n            this._updateVisitor.resetStats();\n            this.getScene().updateSceneGraph(this._updateVisitor);\n\n            if (stats)\n                stats.getCounter(\'updatecallback\').set(this._updateVisitor._numUpdateCallback);\n\n            // Remove ExpiredSubgraphs from DatabasePager\n            this.getDatabasePager().releaseGLExpiredSubgraphs(0.005);\n            // In OSG this.is deferred until the draw traversal, to handle multiple contexts\n            this.flushDeletedGLObjects(0.005);\n\n            if (stats) stats.getCounter(\'update\').end();\n        },\n\n        advance: function(simulationTime) {\n            var sTime = simulationTime;\n\n            if (sTime === undefined) sTime = Number.MAX_VALUE;\n\n            var frameStamp = this._frameStamp;\n            var previousFrameNumber = frameStamp.getFrameNumber();\n\n            frameStamp.setFrameNumber(previousFrameNumber + 1);\n\n            var deltaS = __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().deltaS(this._startTick, __WEBPACK_IMPORTED_MODULE_4_osg_Timer__["a" /* default */].instance().tick());\n            frameStamp.setReferenceTime(deltaS);\n\n            var lastSimulationTime = frameStamp.getSimulationTime();\n            frameStamp.setSimulationTime(sTime === Number.MAX_VALUE ? deltaS : sTime); // set simul time\n            frameStamp.setDeltaTime(frameStamp.getSimulationTime() - lastSimulationTime); // compute delta since last tick\n        },\n\n        beginFrame: function() {\n            var stats = this._stats;\n\n            if (stats) {\n                stats.getCounter(\'frame\').start();\n\n                stats.getCounter(\'raf\').tick();\n                stats.getCounter(\'fps\').frame();\n            }\n        },\n\n        endFrame: function() {\n            var frameNumber = this.getFrameStamp().getFrameNumber();\n\n            // update texture stats\n            if (this._stats) {\n                __WEBPACK_IMPORTED_MODULE_14_osg_Texture__["default"].getTextureManager(this.getGraphicContext()).updateStats(\n                    frameNumber,\n                    this._stats\n                );\n\n                this._stats.getCounter(\'stats\').start();\n                this._stats.update();\n                this._stats.getCounter(\'stats\').end();\n\n                this._stats.getCounter(\'frame\').end();\n            }\n        },\n\n        checkNeedToDoFrame: function() {\n            return this._requestContinousUpdate || this._requestRedraw;\n        },\n\n        frame: function() {\n            // _contextLost check for code calling viewer::frame directly\n            // (likely force preload gl resource or direct render control )\n            if (this._contextLost) return;\n\n            this.beginFrame();\n\n            this.advance();\n\n            // update viewport if a resize occured\n            var canvasSizeChanged = this.updateViewport();\n\n            // update inputs devices\n            this.updateEventProxy(this._eventProxy, this.getFrameStamp());\n\n            // setup framestamp\n            this._updateVisitor.setFrameStamp(this.getFrameStamp());\n            // Update Manipulator/Event\n            if (this.getManipulator()) {\n                this.getManipulator().update(this._updateVisitor);\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].copy(\n                    this.getCamera().getViewMatrix(),\n                    this.getManipulator().getInverseMatrix()\n                );\n            }\n\n            if (this.checkNeedToDoFrame() || canvasSizeChanged) {\n                this._requestRedraw = false;\n                this.updateTraversal();\n                this.renderingTraversal();\n            }\n\n            this.endFrame();\n\n            // submit frame to vr headset\n            if (this._hmd && this._hmd.isPresenting) this._hmd.submitFrame();\n        },\n\n        setDone: function(bool) {\n            this._done = bool;\n        },\n\n        done: function() {\n            return this._done;\n        },\n\n        render: function() {\n            if (!this.done()) {\n                this._requestID = this._requestAnimationFrame(this.renderBinded, this._canvas);\n                this.frame();\n            }\n        },\n\n        _runImplementation: function() {\n            this.render();\n        },\n\n        run: function() {\n            this._runImplementation();\n        },\n\n        setVRDisplay: function(hmd) {\n            this._hmd = hmd;\n        },\n\n        getVRDisplay: function() {\n            return this._hmd;\n        },\n\n        setPresentVR: function(doPresentVR) {\n            if (!this._hmd) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'no hmd device provided to the viewer!\');\n                return __WEBPACK_IMPORTED_MODULE_3_bluebird___default.a.reject();\n            }\n\n            if (!this._hmd.capabilities.canPresent) return __WEBPACK_IMPORTED_MODULE_3_bluebird___default.a.reject();\n\n            if (doPresentVR) {\n                // spec is not clear if it should be done after the requestPresent promise or before\n                this._requestAnimationFrame = this._hmd.requestAnimationFrame.bind(this._hmd);\n\n                var layers = [\n                    {\n                        source: this.getGraphicContext().canvas\n                    }\n                ];\n                return this._hmd.requestPresent(layers);\n            } else {\n                this._requestAnimationFrame = window.requestAnimationFrame.bind(window);\n                return this._hmd.exitPresent();\n            }\n        },\n\n        setupManipulator: function(manipulator /*, dontBindDefaultEvent */) {\n            if (manipulator === undefined) {\n                manipulator = new __WEBPACK_IMPORTED_MODULE_15_osgGA_OrbitManipulator__["a" /* default */]();\n            }\n\n            if (manipulator.setNode !== undefined) {\n                manipulator.setNode(this.getSceneData());\n            } else {\n                // for backward compatibility\n                manipulator.view = this;\n            }\n\n            manipulator.setCamera(this.getCamera());\n            this.setManipulator(manipulator);\n        },\n\n        // updateViewport\n        updateViewport: function() {\n            var gl = this.getGraphicContext();\n            var canvas = gl.canvas;\n\n            var hasChanged = this.computeCanvasSize(canvas);\n            if (!hasChanged) return false;\n\n            var camera = this.getCamera();\n            var vp = camera.getViewport();\n\n            var prevWidth = vp.width();\n            var prevHeight = vp.height();\n\n            var widthChangeRatio = canvas.width / prevWidth;\n            var heightChangeRatio = canvas.height / prevHeight;\n            var aspectRatioChange = widthChangeRatio / heightChangeRatio;\n            vp.setViewport(\n                Math.round(vp.x() * widthChangeRatio),\n                Math.round(vp.y() * heightChangeRatio),\n                Math.round(vp.width() * widthChangeRatio),\n                Math.round(vp.height() * heightChangeRatio)\n            );\n\n            if (aspectRatioChange !== 1.0) {\n                __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].mul(\n                    camera.getProjectionMatrix(),\n                    camera.getProjectionMatrix(),\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].fromScaling(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create(), [1.0 / aspectRatioChange, 1.0, 1.0])\n                );\n            }\n\n            return true;\n        },\n\n        // intialize all input devices\n        initEventProxy: function(argsObject) {\n            var args = argsObject || {};\n            var deviceEnabled = {};\n\n            var lists = __WEBPACK_IMPORTED_MODULE_16_osgViewer_eventProxy_eventProxy__["a" /* default */];\n            var argumentEventBackend = args.EventBackend;\n\n            // loop on each devices and try to initialize it\n            for (var device in lists) {\n                // check if the config has a require\n                var initialize = true;\n                var argDevice = {};\n                if (argumentEventBackend && argumentEventBackend[device] !== undefined) {\n                    var bool = argumentEventBackend[device].enable;\n                    initialize = bool !== undefined ? bool : true;\n                    argDevice = argumentEventBackend[device];\n                }\n\n                // extend argDevice with regular options eg:\n                // var options = {\n                //     EventBackend: {\n                //         Hammer: {\n                //             drag_max_touches: 4,\n                //             transform_min_scale: 0.08,\n                //             transform_min_rotation: 180,\n                //             transform_always_block: true\n                //         }\n                //     },\n                //     zoomscroll: false\n                // };\n\n                // to options merged:\n                // var options = {\n                //     drag_max_touches: 4,\n                //     transform_min_scale: 0.08,\n                //     transform_min_rotation: 180,\n                //     transform_always_block: true,\n                //     zoomscroll: false\n                // };\n                //\n                var options = new __WEBPACK_IMPORTED_MODULE_2_osg_Options__["a" /* default */]();\n                options.extend(argDevice).extend(argsObject);\n                delete options.EventBackend;\n\n                if (initialize) {\n                    var inputDevice = new lists[device](this);\n                    inputDevice.init(options);\n                    deviceEnabled[device] = inputDevice;\n                }\n            }\n            return deviceEnabled;\n        },\n        updateEventProxy: function(list, frameStamp) {\n            for (var key in list) {\n                var device = list[key];\n                if (device.update) device.update(frameStamp);\n            }\n        },\n\n        setManipulator: function(manipulator) {\n            if (this._manipulator) this.removeEventProxy();\n\n            if (!manipulator.getCamera()) manipulator.setCamera(this.getCamera());\n\n            __WEBPACK_IMPORTED_MODULE_17_osgViewer_View__["default"].prototype.setManipulator.call(this, manipulator);\n        },\n\n        setEnableManipulator: function(bool) {\n            if (!this._manipulator) return;\n\n            var controllerMap = this._manipulator.getControllerList();\n            for (var name in controllerMap) {\n                controllerMap[name].setEnable(bool);\n            }\n        },\n\n        removeEventProxy: function() {\n            var list = this._eventProxy;\n            for (var key in list) {\n                var device = list[key];\n                if (device.remove) device.remove();\n            }\n        },\n\n        getEventProxy: function() {\n            return this._eventProxy;\n        }\n    }),\n    \'osgViewer\',\n    \'Viewer\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (Viewer);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/Viewer.js\n// module id = 243\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/Viewer.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n\n\nvar GamePad = function(viewer) {\n    this._viewer = viewer;\n    this._type = 'GamePad';\n    this._enable = true;\n    this._gamepadIndex = -1;\n};\n\nGamePad.prototype = {\n    setEnable: function(bool) {\n        this._enable = bool;\n    },\n\n    getEnable: function() {\n        return this._enable;\n    },\n\n    init: function(/*args*/) {},\n\n    isValid: function() {\n        if (!this._enable) return false;\n\n        var manipulator = this._viewer.getManipulator();\n        if (!manipulator) return false;\n\n        var controller = manipulator.getControllerList()[this._type];\n        if (!controller || !controller.isEnabled()) return false;\n\n        return true;\n    },\n\n    getManipulatorController: function() {\n        return this._viewer.getManipulator().getControllerList()[this._type];\n    },\n\n    gamepadPoll: function() {\n        if (!navigator.getGamepads) return null;\n        var gamepads = navigator.getGamepads();\n        var gamepad = gamepads[this._gamepadIndex];\n        if (gamepad) return gamepad;\n\n        for (var i = 0, nb = gamepads.length; i < nb; ++i) {\n            var gm = gamepads[i];\n            // https://code.google.com/p/chromium/issues/detail?id=413805\n            if (gm && gm.id && gm.id.indexOf('Unknown Gamepad') === -1) {\n                this._gamepadIndex = i;\n                this.onGamepadConnect(gm);\n                return gm;\n            }\n        }\n        if (this._gamepadIndex >= 0) {\n            this._gamepadIndex = -1;\n            this.onGamepadConnect();\n        }\n        return null;\n    },\n\n    onGamepadConnect: function(gamepad) {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].log('Detected new gamepad!', gamepad);\n    },\n\n    onGamepadDisconnect: function() {\n        __WEBPACK_IMPORTED_MODULE_0_osg_notify__[\"a\" /* default */].log('Gamepad disconnected');\n    },\n\n    // Called in each frame\n    update: function() {\n        // we poll instead\n\n        if (!this.isValid()) return;\n\n        var gamepad = this.gamepadPoll();\n        if (!gamepad) return;\n\n        var manipulatorAdapter = this.getManipulatorController();\n        //manipulatorAdapter.setEventProxy(this);\n        if (manipulatorAdapter.update) {\n            manipulatorAdapter.update(gamepad);\n        }\n    }\n};\n/* harmony default export */ __webpack_exports__[\"a\"] = (GamePad);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/eventProxy/GamePad.js\n// module id = 244\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/eventProxy/GamePad.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_hammer__ = __webpack_require__(137);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_hammer___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_hammer__);\n\n\nvar HammerController = function(viewer) {\n    this._enable = true;\n    this._viewer = viewer;\n    this._type = 'Hammer';\n\n    this._eventNode = undefined;\n};\n\nHammerController.prototype = {\n    setEnable: function(bool) {\n        this._enable = bool;\n    },\n\n    getEnable: function() {\n        return this._enable;\n    },\n\n    getHammer: function() {\n        return this._hammer;\n    },\n\n    init: function(options) {\n        this._eventNode = options.eventNode;\n        if (this._eventNode) {\n            this._hammer = new __WEBPACK_IMPORTED_MODULE_0_hammer___default.a.Manager(this._eventNode);\n\n            // defaults: { event: 'pan', pointers: 1, direction: Hammer.DIRECTION_HORIZONTAL, threshold: 10 }\n            this._hammer.add(new __WEBPACK_IMPORTED_MODULE_0_hammer___default.a.Pan());\n\n            if (options.getBoolean('scrollwheel')) {\n                //defaults: { event: 'pinch', pointers: 2, threshold: 0 }\n                this._hammer.add(new __WEBPACK_IMPORTED_MODULE_0_hammer___default.a.Pinch());\n            }\n\n            // $$ SOURCE_CODE_MODIFIED ���ӵ�����˫���ź�\n            var singleTap = new __WEBPACK_IMPORTED_MODULE_0_hammer___default.a.Tap({ event: 'singletap' });\n            var doubleTap = new __WEBPACK_IMPORTED_MODULE_0_hammer___default.a.Tap({event: 'doubletap', taps: 2 });\n            doubleTap.recognizeWith(singleTap);\n            singleTap.requireFailure(doubleTap);\n            this._hammer.add(singleTap);\n            this._hammer.add(doubleTap);\n            // $$ SOURCE_CODE_MODIFIED\n        }\n    },\n\n    isValid: function() {\n        if (!this._enable) return false;\n\n        var manipulator = this._viewer.getManipulator();\n        if (!manipulator) return false;\n\n        var controller = manipulator.getControllerList()[this._type];\n        if (!controller || !controller.isEnabled()) return false;\n\n        return true;\n    },\n\n    getManipulatorController: function() {\n        var manip = this._viewer.getManipulator();\n        return manip && manip.getControllerList()[this._type];\n    },\n\n    // use the update to set the input device to mouse controller\n    // it's needed to compute size\n    update: function() {\n        var isValid = this.isValid();\n        var manip = this.getManipulatorController();\n        if (manip) manip.setValid(isValid);\n\n        if (!isValid) return;\n\n        // we pass directly hammer object\n        this.getManipulatorController().setEventProxy(this._hammer);\n    },\n    remove: function() {\n        if (!this.isValid()) return;\n        this.getManipulatorController().removeEventProxy(this._hammer);\n    }\n};\n/* harmony default export */ __webpack_exports__[\"a\"] = (HammerController);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/eventProxy/Hammer.js\n// module id = 245\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/eventProxy/Hammer.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n\n\nvar StandardMouseKeyboard = function(viewer) {\n    this._enable = true;\n    this._viewer = viewer;\n    this._type = 'StandardMouseKeyboard';\n\n    this._mouseEventNode = undefined;\n    this._wheelEventNode = undefined;\n    this._keyboardEventNode = undefined;\n    this._eventList = ['mousedown', 'mouseup', 'mouseout', 'mousemove', 'dblclick'];\n    this._mousePosition = __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__[\"e\" /* vec2 */].create();\n    this._eventBinded = false;\n};\n\nStandardMouseKeyboard.prototype = {\n    setEnable: function(bool) {\n        this._enable = bool;\n    },\n\n    getEnable: function() {\n        return this._enable;\n    },\n\n    init: function(options) {\n        var mouse = options.mouseEventNode;\n\n        var mousewheel = options.wheelEventNode || mouse;\n        var keyboard = options.keyboardEventNode || mouse;\n\n        if (options.getBoolean('scrollwheel') === false) {\n            mousewheel = null;\n        }\n\n        this._mouseEventNode = mouse;\n        this._wheelEventNode = mousewheel;\n        this._keyboardEventNode = keyboard;\n\n        // to remove listeners, you need the exact same callback\n        this._callbacks = {\n            mousedown: this.mousedown.bind(this),\n            mouseup: this.mouseup.bind(this),\n            mouseout: this.mouseout.bind(this),\n            mousemove: this.mousemove.bind(this),\n            dblclick: this.dblclick.bind(this),\n            mousewheel: this.mousewheel.bind(this),\n            preventDefault: this.preventDefault.bind(this),\n            keydown: this.keydown.bind(this),\n            keyup: this.keyup.bind(this)\n        };\n    },\n\n    _addOrRemoveEventListeners: function(remove) {\n        var callbacks = this._callbacks;\n        var cb = remove ? 'removeEventListener' : 'addEventListener';\n        var cbMouse = this._mouseEventNode && this._mouseEventNode[cb].bind(this._mouseEventNode);\n        var cbMousewheel =\n            this._wheelEventNode && this._wheelEventNode[cb].bind(this._wheelEventNode);\n        var cbKeyboard =\n            this._keyboardEventNode && this._keyboardEventNode[cb].bind(this._keyboardEventNode);\n\n        if (cbMouse) {\n            for (var i = 0, l = this._eventList.length; i < l; i++) {\n                var ev = this._eventList[i];\n                cbMouse(ev, callbacks[ev], false);\n            }\n        }\n\n        if (cbMousewheel) {\n            cbMousewheel('DOMMouseScroll', callbacks.mousewheel, false);\n            cbMousewheel('mousewheel', callbacks.mousewheel, false);\n            cbMousewheel('MozMousePixelScroll', callbacks.preventDefault, false);\n        }\n\n        if (cbKeyboard) {\n            cbKeyboard('keydown', callbacks.keydown, false);\n            cbKeyboard('keyup', callbacks.keyup, false);\n        }\n        this._eventBinded = !remove;\n    },\n\n    addEventListeners: function() {\n        return this._addOrRemoveEventListeners(false);\n    },\n\n    removeEventListeners: function() {\n        return this._addOrRemoveEventListeners(true);\n    },\n\n    isValid: function() {\n        if (!this._enable) return false;\n\n        var manipulator = this._viewer.getManipulator();\n        if (!manipulator) return false;\n\n        var controller = manipulator.getControllerList()[this._type];\n        if (!controller || !controller.isEnabled()) return false;\n\n        return true;\n    },\n\n    getManipulatorController: function() {\n        return this._viewer.getManipulator().getControllerList()[this._type];\n    },\n\n    keyup: function(ev) {\n        if (this.isValid() && this.getManipulatorController().keyup) {\n            return this.getManipulatorController().keyup(ev);\n        }\n\n        return undefined;\n    },\n\n    keydown: function(ev) {\n        if (this.isValid() && this.getManipulatorController().keydown) {\n            return this.getManipulatorController().keydown(ev);\n        }\n\n        return undefined;\n    },\n\n    mousedown: function(ev) {\n        if (this.isValid() && this.getManipulatorController().mousedown) {\n            // prevent browser to enter in scroll mode\n            if (ev.button === 1) ev.preventDefault();\n\n            return this.getManipulatorController().mousedown(ev);\n        }\n\n        return undefined;\n    },\n\n    mouseup: function(ev) {\n        if (this.isValid() && this.getManipulatorController().mouseup) {\n            return this.getManipulatorController().mouseup(ev);\n        }\n\n        return undefined;\n    },\n\n    mouseout: function(ev) {\n        if (this.isValid() && this.getManipulatorController().mouseout) {\n            return this.getManipulatorController().mouseout(ev);\n        }\n\n        return undefined;\n    },\n\n    mousemove: function(ev) {\n        if (this.isValid() && this.getManipulatorController().mousemove) {\n            return this.getManipulatorController().mousemove(ev);\n        }\n\n        return undefined;\n    },\n\n    dblclick: function(ev) {\n        if (this.isValid() && this.getManipulatorController().dblclick) {\n            return this.getManipulatorController().dblclick(ev);\n        }\n\n        return undefined;\n    },\n\n    mousewheel: function(event) {\n        if (!this.isValid()) {\n            return undefined;\n        }\n\n        var manipulatorAdapter = this.getManipulatorController();\n\n        if (!manipulatorAdapter.mousewheel) {\n            return undefined;\n        }\n\n        event.preventDefault();\n\n        // from jquery\n        var orgEvent = event || window.event;\n        var delta = 0;\n        var deltaX = 0;\n        var deltaY = 0;\n\n        // Old school scrollwheel delta\n        if (event.detail) delta = -event.detail / 3;\n        else if (event.wheelDelta) delta = event.wheelDelta / 120;\n\n        // New school multidimensional scroll (touchpads) deltas\n        deltaY = delta;\n\n        // Gecko\n        if (orgEvent.axis === orgEvent.HORIZONTAL_AXIS) {\n            deltaY = 0;\n            deltaX = -1 * delta;\n        }\n\n        // Webkit\n        if (orgEvent.wheelDeltaY !== undefined) deltaY = orgEvent.wheelDeltaY / 120;\n        if (orgEvent.wheelDeltaX !== undefined) deltaX = -1 * orgEvent.wheelDeltaX / 120;\n\n        return manipulatorAdapter.mousewheel(event, delta, deltaX, deltaY);\n    },\n\n    preventDefault: function(event) {\n        event.preventDefault();\n    },\n\n    getPositionRelativeToCanvas: function(e, result) {\n        result = result || this._mousePosition;\n        result[0] = e.offsetX === undefined ? e.layerX : e.offsetX;\n        result[1] = e.target.clientHeight - (e.offsetY === undefined ? e.layerY : e.offsetY);\n        return result;\n    },\n\n    // use the update to set the input device to mouse controller\n    // it's needed to compute size\n    update: function() {\n        if (!this.isValid()) {\n            return;\n        }\n\n        this.getManipulatorController().setEventProxy(this);\n        if (!this._eventBinded) this.addEventListeners();\n    }\n};\n/* harmony default export */ __webpack_exports__[\"a\"] = (StandardMouseKeyboard);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/eventProxy/StandardMouseKeyboard.js\n// module id = 246\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/eventProxy/StandardMouseKeyboard.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgUtil_webvr_1_1__ = __webpack_require__(248);\n\n\n\n\n // polyfill\n\nvar WebVR = function(viewer) {\n    this._viewer = viewer;\n\n    this._type = \'WebVR\';\n    this._enable = false;\n    this._hmd = undefined;\n    this._sensor = undefined;\n\n    this._frameData = undefined;\n    this._quat = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["d" /* quat */].create();\n    this._pos = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n    this._worldScale = 1.0;\n};\n\nWebVR.prototype = {\n    setWorldScale: function(val) {\n        this._worldScale = val;\n    },\n\n    setEnable: function(bool) {\n        this._enable = bool;\n    },\n\n    getEnable: function() {\n        return this._enable;\n    },\n\n    init: function() {\n        if (!navigator.getVRDisplays) return;\n\n        var self = this;\n        navigator.getVRDisplays().then(function(displays) {\n            if (displays.length > 0) {\n                self._hmd = displays[0];\n                self._frameData = new window.VRFrameData();\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].log(\'Found a VR display\');\n                // currently it\'s the event proxy webvr that has the responsability of detecting vr devices\n                self._viewer.setVRDisplay(self._hmd);\n            }\n        });\n    },\n\n    getManipulatorController: function() {\n        return this._viewer.getManipulator().getControllerList()[this._type];\n    },\n\n    isValid: function() {\n        if (!this._enable) return false;\n\n        var manipulator = this._viewer.getManipulator();\n        if (!manipulator) return false;\n\n        var controller = manipulator.getControllerList()[this._type];\n        if (!controller || !controller.isEnabled()) return false;\n\n        if (!this._hmd) return false;\n\n        return true;\n    },\n\n    update: (function() {\n        var tempQuat = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["d" /* quat */].create();\n        var tempPos = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].create();\n\n        return function() {\n            if (!this.isValid()) return;\n\n            var manipulatorAdapter = this.getManipulatorController();\n\n            // update the manipulator with the rotation of the device\n            if (!manipulatorAdapter.update) return;\n\n            this._hmd.getFrameData(this._frameData);\n\n            var pose = this._frameData.pose;\n\n            if (!pose) return;\n\n            // WebVR up vector is Y\n            // OSGJS up vector is Z\n\n            var sitToStand =\n                this._hmd.stageParameters && this._hmd.stageParameters.sittingToStandingTransform;\n\n            var q = pose.orientation;\n            if (q) {\n                if (sitToStand) {\n                    q = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].getRotation(tempQuat, sitToStand);\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["d" /* quat */].mul(q, q, pose.orientation);\n                }\n\n                this._quat[0] = q[0];\n                this._quat[1] = -q[2];\n                this._quat[2] = q[1];\n                this._quat[3] = q[3];\n            }\n\n            var pos = pose.position;\n            if (pos) {\n                if (sitToStand) {\n                    pos = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["f" /* vec3 */].transformMat4(tempPos, pos, sitToStand);\n                }\n                this._pos[0] = pos[0] * this._worldScale;\n                this._pos[1] = -pos[2] * this._worldScale;\n                this._pos[2] = pos[1] * this._worldScale;\n            }\n\n            manipulatorAdapter.update(this._quat, this._pos);\n        };\n    })(),\n\n    getHmd: function() {\n        return this._hmd;\n    }\n};\n/* harmony default export */ __webpack_exports__["a"] = (WebVR);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/eventProxy/WebVR.js\n// module id = 247\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/eventProxy/WebVR.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__ = __webpack_require__(1);\n// Copyright 2016 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n// Installs a shim that emulates functionality from the WebVR '1.1' spec if the\n// browser only exposes WebVR '1.0'.\n\n\n\nif ('getVRDisplays' in navigator) {\n    // A lot of Chrome builds to date don't have depthNear and depthFar, even\n    // though they're in the WebVR 1.0 spec. They're more necessary in 1.1.\n    if (!('depthNear' in window.VRDisplay.prototype)) {\n        window.VRDisplay.prototype.depthNear = 0.01;\n    }\n\n    if (!('depthFar' in window.VRDisplay.prototype)) {\n        window.VRDisplay.prototype.depthFar = 10000.0;\n    }\n\n    // If the browser has a WebVR implementation but does not include the 1.1\n    // functionality patch it with JS.\n    if (!('VRFrameData' in window)) {\n        window.VRFrameData = function() {\n            this.leftProjectionMatrix = new Float32Array(16);\n            this.leftViewMatrix = new Float32Array(16);\n            this.rightProjectionMatrix = new Float32Array(16);\n            this.rightViewMatrix = new Float32Array(16);\n            this.pose = null;\n        };\n\n        window.VRDisplay.prototype.getFrameData = (function() {\n            var defaultOrientation = new Float32Array([0, 0, 0, 1]);\n            var defaultPosition = new Float32Array([0, 0, 0]);\n\n            function updateEyeMatrices(projection, view, pose, parameters, vrDisplay) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__[\"c\" /* mat4 */].perspectiveFromFieldOfView(\n                    projection,\n                    parameters.fieldOfView,\n                    vrDisplay.depthNear,\n                    vrDisplay.depthFar\n                );\n\n                var orientation = pose.orientation;\n                var position = pose.position;\n                if (!orientation) {\n                    orientation = defaultOrientation;\n                }\n                if (!position) {\n                    position = defaultPosition;\n                }\n\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__[\"c\" /* mat4 */].fromRotationTranslation(view, orientation, position);\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__[\"c\" /* mat4 */].translate(view, view, parameters.offset);\n                __WEBPACK_IMPORTED_MODULE_0_osg_glMatrix__[\"c\" /* mat4 */].invert(view, view);\n            }\n\n            return function(frameData) {\n                var pose = this.getPose();\n                if (!pose) return false;\n\n                frameData.pose = pose;\n                frameData.timestamp = pose.timestamp;\n\n                updateEyeMatrices(\n                    frameData.leftProjectionMatrix,\n                    frameData.leftViewMatrix,\n                    pose,\n                    this.getEyeParameters('left'),\n                    this\n                );\n                updateEyeMatrices(\n                    frameData.rightProjectionMatrix,\n                    frameData.rightViewMatrix,\n                    pose,\n                    this.getEyeParameters('right'),\n                    this\n                );\n\n                return true;\n            };\n        })();\n    }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgUtil/webvr-1-1.js\n// module id = 248\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgUtil/webvr-1-1.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("var DeviceOrientation = function(viewer) {\n    this._viewer = viewer;\n    this._type = 'DeviceOrientation';\n    this._enable = false;\n\n    // Landscape mobile orientation testing defaults\n    this._deviceOrientation = undefined;\n    this._screenOrientation = window.orientation || 90;\n};\n\nDeviceOrientation.prototype = {\n    setEnable: function(bool) {\n        this._enable = bool;\n    },\n\n    getEnable: function() {\n        return this._enable;\n    },\n\n    init: function() {\n        var self = this;\n\n        // Check because Chrome send _one_ event with all angles to null\n        window.addEventListener(\n            'deviceorientation',\n            function(rawEvtData) {\n                if (rawEvtData.alpha !== null && rawEvtData.alpha !== undefined)\n                    self._deviceOrientation = rawEvtData;\n            },\n            false\n        );\n\n        window.addEventListener(\n            'orientationchange',\n            function() {\n                if (window.orientation !== null && window.orientation !== undefined)\n                    self._screenOrientation = window.orientation;\n            },\n            false\n        );\n    },\n\n    getManipulatorController: function() {\n        return this._viewer.getManipulator().getControllerList()[this._type];\n    },\n\n    isValid: function() {\n        if (!this._enable) return false;\n\n        if (!this._deviceOrientation) return false;\n\n        var manipulator = this._viewer.getManipulator();\n        if (!manipulator) return false;\n\n        var controller = manipulator.getControllerList()[this._type];\n        if (!controller || !controller.isEnabled()) return false;\n\n        return true;\n    },\n\n    update: function() {\n        if (!this.isValid()) return;\n\n        // update the manipulator with the rotation of the device\n        var manipulatorAdapter = this.getManipulatorController();\n        if (manipulatorAdapter.update) {\n            manipulatorAdapter.update(this._deviceOrientation, this._screenOrientation);\n        }\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (DeviceOrientation);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/eventProxy/DeviceOrientation.js\n// module id = 249\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/eventProxy/DeviceOrientation.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("// jshint ignore: start\n\n/*\n ** Copyright (c) 2012 The Khronos Group Inc.\n **\n ** Permission is hereby granted, free of charge, to any person obtaining a\n ** copy of this software and/or associated documentation files (the\n ** \"Materials\"), to deal in the Materials without restriction, including\n ** without limitation the rights to use, copy, modify, merge, publish,\n ** distribute, sublicense, and/or sell copies of the Materials, and to\n ** permit persons to whom the Materials are furnished to do so, subject to\n ** the following conditions:\n **\n ** The above copyright notice and this permission notice shall be included\n ** in all copies or substantial portions of the Materials.\n **\n ** THE MATERIALS ARE PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n ** EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n ** MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n ** IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n ** CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n ** TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n ** MATERIALS OR THE USE OR OTHER DEALINGS IN THE MATERIALS.\n */\n\n// Various functions for helping debug WebGL apps.\n\nvar WebGLDebugUtils = (function() {\n    /**\n     * Wrapped logging function.\n     * @param {string} msg Message to log.\n     */\n    var log = function(msg) {\n        if (window.console && window.console.log) {\n            window.console.log(msg);\n        }\n    };\n\n    /**\n     * Wrapped error logging function.\n     * @param {string} msg Message to log.\n     */\n    var error = function(msg) {\n        if (window.console && window.console.error) {\n            window.console.error(msg);\n        } else {\n            log(msg);\n        }\n    };\n\n    /**\n     * Which arguments are enums based on the number of arguments to the function.\n     * So\n     *    'texImage2D': {\n     *       9: { 0:true, 2:true, 6:true, 7:true },\n     *       6: { 0:true, 2:true, 3:true, 4:true },\n     *    },\n     *\n     * means if there are 9 arguments then 6 and 7 are enums, if there are 6\n     * arguments 3 and 4 are enums\n     *\n     * @type {!Object.<number, !Object.<number, string>}\n     */\n    var glValidEnumContexts = {\n        // Generic setters and getters\n\n        enable: {\n            1: {\n                0: true\n            }\n        },\n        disable: {\n            1: {\n                0: true\n            }\n        },\n        getParameter: {\n            1: {\n                0: true\n            }\n        },\n\n        // Rendering\n\n        drawArrays: {\n            3: {\n                0: true\n            }\n        },\n        drawElements: {\n            4: {\n                0: true,\n                2: true\n            }\n        },\n\n        // Shaders\n\n        createShader: {\n            1: {\n                0: true\n            }\n        },\n        getShaderParameter: {\n            2: {\n                1: true\n            }\n        },\n        getProgramParameter: {\n            2: {\n                1: true\n            }\n        },\n        getShaderPrecisionFormat: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n\n        // Vertex attributes\n\n        getVertexAttrib: {\n            2: {\n                1: true\n            }\n        },\n        vertexAttribPointer: {\n            6: {\n                2: true\n            }\n        },\n\n        // Textures\n\n        bindTexture: {\n            2: {\n                0: true\n            }\n        },\n        activeTexture: {\n            1: {\n                0: true\n            }\n        },\n        getTexParameter: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n        texParameterf: {\n            3: {\n                0: true,\n                1: true\n            }\n        },\n        texParameteri: {\n            3: {\n                0: true,\n                1: true,\n                2: true\n            }\n        },\n        // texImage2D and texSubImage2D are defined below with WebGL 2 entrypoints\n        copyTexImage2D: {\n            8: {\n                0: true,\n                2: true\n            }\n        },\n        copyTexSubImage2D: {\n            8: {\n                0: true\n            }\n        },\n        generateMipmap: {\n            1: {\n                0: true\n            }\n        },\n        // compressedTexImage2D and compressedTexSubImage2D are defined below with WebGL 2 entrypoints\n\n        // Buffer objects\n\n        bindBuffer: {\n            2: {\n                0: true\n            }\n        },\n        // bufferData and bufferSubData are defined below with WebGL 2 entrypoints\n        getBufferParameter: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n\n        // Renderbuffers and framebuffers\n\n        pixelStorei: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n        // readPixels is defined below with WebGL 2 entrypoints\n        bindRenderbuffer: {\n            2: {\n                0: true\n            }\n        },\n        bindFramebuffer: {\n            2: {\n                0: true\n            }\n        },\n        checkFramebufferStatus: {\n            1: {\n                0: true\n            }\n        },\n        framebufferRenderbuffer: {\n            4: {\n                0: true,\n                1: true,\n                2: true\n            }\n        },\n        framebufferTexture2D: {\n            5: {\n                0: true,\n                1: true,\n                2: true\n            }\n        },\n        getFramebufferAttachmentParameter: {\n            3: {\n                0: true,\n                1: true,\n                2: true\n            }\n        },\n        getRenderbufferParameter: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n        renderbufferStorage: {\n            4: {\n                0: true,\n                1: true\n            }\n        },\n\n        // Frame buffer operations (clear, blend, depth test, stencil)\n\n        clear: {\n            1: {\n                0: {\n                    enumBitwiseOr: ['COLOR_BUFFER_BIT', 'DEPTH_BUFFER_BIT', 'STENCIL_BUFFER_BIT']\n                }\n            }\n        },\n        depthFunc: {\n            1: {\n                0: true\n            }\n        },\n        blendFunc: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n        blendFuncSeparate: {\n            4: {\n                0: true,\n                1: true,\n                2: true,\n                3: true\n            }\n        },\n        blendEquation: {\n            1: {\n                0: true\n            }\n        },\n        blendEquationSeparate: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n        stencilFunc: {\n            3: {\n                0: true\n            }\n        },\n        stencilFuncSeparate: {\n            4: {\n                0: true,\n                1: true\n            }\n        },\n        stencilMaskSeparate: {\n            2: {\n                0: true\n            }\n        },\n        stencilOp: {\n            3: {\n                0: true,\n                1: true,\n                2: true\n            }\n        },\n        stencilOpSeparate: {\n            4: {\n                0: true,\n                1: true,\n                2: true,\n                3: true\n            }\n        },\n\n        // Culling\n\n        cullFace: {\n            1: {\n                0: true\n            }\n        },\n        frontFace: {\n            1: {\n                0: true\n            }\n        },\n\n        // ANGLE_instanced_arrays extension\n\n        drawArraysInstancedANGLE: {\n            4: {\n                0: true\n            }\n        },\n        drawElementsInstancedANGLE: {\n            5: {\n                0: true,\n                2: true\n            }\n        },\n\n        // EXT_blend_minmax extension\n\n        blendEquationEXT: {\n            1: {\n                0: true\n            }\n        },\n\n        // WebGL 2 Buffer objects\n\n        bufferData: {\n            3: {\n                0: true,\n                2: true\n            }, // WebGL 1\n            4: {\n                0: true,\n                2: true\n            }, // WebGL 2\n            5: {\n                0: true,\n                2: true\n            } // WebGL 2\n        },\n        bufferSubData: {\n            3: {\n                0: true\n            }, // WebGL 1\n            4: {\n                0: true\n            }, // WebGL 2\n            5: {\n                0: true\n            } // WebGL 2\n        },\n        copyBufferSubData: {\n            5: {\n                0: true,\n                1: true\n            }\n        },\n        getBufferSubData: {\n            3: {\n                0: true\n            },\n            4: {\n                0: true\n            },\n            5: {\n                0: true\n            }\n        },\n\n        // WebGL 2 Framebuffer objects\n\n        blitFramebuffer: {\n            10: {\n                8: {\n                    enumBitwiseOr: ['COLOR_BUFFER_BIT', 'DEPTH_BUFFER_BIT', 'STENCIL_BUFFER_BIT']\n                },\n                9: true\n            }\n        },\n        framebufferTextureLayer: {\n            5: {\n                0: true,\n                1: true\n            }\n        },\n        invalidateFramebuffer: {\n            2: {\n                0: true\n            }\n        },\n        invalidateSubFramebuffer: {\n            6: {\n                0: true\n            }\n        },\n        readBuffer: {\n            1: {\n                0: true\n            }\n        },\n\n        // WebGL 2 Renderbuffer objects\n\n        getInternalformatParameter: {\n            3: {\n                0: true,\n                1: true,\n                2: true\n            }\n        },\n        renderbufferStorageMultisample: {\n            5: {\n                0: true,\n                2: true\n            }\n        },\n\n        // WebGL 2 Texture objects\n\n        texStorage2D: {\n            5: {\n                0: true,\n                2: true\n            }\n        },\n        texStorage3D: {\n            6: {\n                0: true,\n                2: true\n            }\n        },\n        texImage2D: {\n            9: {\n                0: true,\n                2: true,\n                6: true,\n                7: true\n            }, // WebGL 1 & 2\n            6: {\n                0: true,\n                2: true,\n                3: true,\n                4: true\n            }, // WebGL 1\n            10: {\n                0: true,\n                2: true,\n                6: true,\n                7: true\n            } // WebGL 2\n        },\n        texImage3D: {\n            10: {\n                0: true,\n                2: true,\n                7: true,\n                8: true\n            },\n            11: {\n                0: true,\n                2: true,\n                7: true,\n                8: true\n            }\n        },\n        texSubImage2D: {\n            9: {\n                0: true,\n                6: true,\n                7: true\n            }, // WebGL 1 & 2\n            7: {\n                0: true,\n                4: true,\n                5: true\n            }, // WebGL 1\n            10: {\n                0: true,\n                6: true,\n                7: true\n            } // WebGL 2\n        },\n        texSubImage3D: {\n            11: {\n                0: true,\n                8: true,\n                9: true\n            },\n            12: {\n                0: true,\n                8: true,\n                9: true\n            }\n        },\n        copyTexSubImage3D: {\n            9: {\n                0: true\n            }\n        },\n        compressedTexImage2D: {\n            7: {\n                0: true,\n                2: true\n            }, // WebGL 1 & 2\n            8: {\n                0: true,\n                2: true\n            }, // WebGL 2\n            9: {\n                0: true,\n                2: true\n            } // WebGL 2\n        },\n        compressedTexImage3D: {\n            8: {\n                0: true,\n                2: true\n            },\n            9: {\n                0: true,\n                2: true\n            },\n            10: {\n                0: true,\n                2: true\n            }\n        },\n        compressedTexSubImage2D: {\n            8: {\n                0: true,\n                6: true\n            }, // WebGL 1 & 2\n            9: {\n                0: true,\n                6: true\n            }, // WebGL 2\n            10: {\n                0: true,\n                6: true\n            } // WebGL 2\n        },\n        compressedTexSubImage3D: {\n            10: {\n                0: true,\n                8: true\n            },\n            11: {\n                0: true,\n                8: true\n            },\n            12: {\n                0: true,\n                8: true\n            }\n        },\n\n        // WebGL 2 Vertex attribs\n\n        vertexAttribIPointer: {\n            5: {\n                2: true\n            }\n        },\n\n        // WebGL 2 Writing to the drawing buffer\n\n        drawArraysInstanced: {\n            4: {\n                0: true\n            }\n        },\n        drawElementsInstanced: {\n            5: {\n                0: true,\n                2: true\n            }\n        },\n        drawRangeElements: {\n            6: {\n                0: true,\n                4: true\n            }\n        },\n\n        // WebGL 2 Reading back pixels\n\n        readPixels: {\n            7: {\n                4: true,\n                5: true\n            }, // WebGL 1 & 2\n            8: {\n                4: true,\n                5: true\n            } // WebGL 2\n        },\n\n        // WebGL 2 Multiple Render Targets\n\n        clearBufferfv: {\n            3: {\n                0: true\n            },\n            4: {\n                0: true\n            }\n        },\n        clearBufferiv: {\n            3: {\n                0: true\n            },\n            4: {\n                0: true\n            }\n        },\n        clearBufferuiv: {\n            3: {\n                0: true\n            },\n            4: {\n                0: true\n            }\n        },\n        clearBufferfi: {\n            4: {\n                0: true\n            }\n        },\n\n        // WebGL 2 Query objects\n\n        beginQuery: {\n            2: {\n                0: true\n            }\n        },\n        endQuery: {\n            1: {\n                0: true\n            }\n        },\n        getQuery: {\n            2: {\n                0: true,\n                1: true\n            }\n        },\n        getQueryParameter: {\n            2: {\n                1: true\n            }\n        },\n\n        // WebGL 2 Sampler objects\n\n        samplerParameteri: {\n            3: {\n                1: true,\n                2: true\n            }\n        },\n        samplerParameterf: {\n            3: {\n                1: true\n            }\n        },\n        getSamplerParameter: {\n            2: {\n                1: true\n            }\n        },\n\n        // WebGL 2 Sync objects\n\n        fenceSync: {\n            2: {\n                0: true,\n                1: {\n                    enumBitwiseOr: []\n                }\n            }\n        },\n        clientWaitSync: {\n            3: {\n                1: {\n                    enumBitwiseOr: ['SYNC_FLUSH_COMMANDS_BIT']\n                }\n            }\n        },\n        waitSync: {\n            3: {\n                1: {\n                    enumBitwiseOr: []\n                }\n            }\n        },\n        getSyncParameter: {\n            2: {\n                1: true\n            }\n        },\n\n        // WebGL 2 Transform Feedback\n\n        bindTransformFeedback: {\n            2: {\n                0: true\n            }\n        },\n        beginTransformFeedback: {\n            1: {\n                0: true\n            }\n        },\n        transformFeedbackVaryings: {\n            3: {\n                2: true\n            }\n        },\n\n        // WebGL2 Uniform Buffer Objects and Transform Feedback Buffers\n\n        bindBufferBase: {\n            3: {\n                0: true\n            }\n        },\n        bindBufferRange: {\n            5: {\n                0: true\n            }\n        },\n        getIndexedParameter: {\n            2: {\n                0: true\n            }\n        },\n        getActiveUniforms: {\n            3: {\n                2: true\n            }\n        },\n        getActiveUniformBlockParameter: {\n            3: {\n                2: true\n            }\n        }\n    };\n\n    /**\n     * Map of numbers to names.\n     * @type {Object}\n     */\n    var glEnums = null;\n\n    /**\n     * Map of names to numbers.\n     * @type {Object}\n     */\n    var enumStringToValue = null;\n\n    /**\n     * Initializes this module. Safe to call more than once.\n     * @param {!WebGLRenderingContext} ctx A WebGL context. If\n     *    you have more than one context it doesn't matter which one\n     *    you pass in, it is only used to pull out constants.\n     */\n    function init(ctx) {\n        if (glEnums == null) {\n            glEnums = {};\n            enumStringToValue = {};\n            for (var propertyName in ctx) {\n                if (typeof ctx[propertyName] === 'number') {\n                    glEnums[ctx[propertyName]] = propertyName;\n                    enumStringToValue[propertyName] = ctx[propertyName];\n                }\n            }\n        }\n    }\n\n    /**\n     * Checks the utils have been initialized.\n     */\n    function checkInit() {\n        if (glEnums == null) {\n            throw 'WebGLDebugUtils.init(ctx) not called';\n        }\n    }\n\n    /**\n     * Returns true or false if value matches any WebGL enum\n     * @param {*} value Value to check if it might be an enum.\n     * @return {boolean} True if value matches one of the WebGL defined enums\n     */\n    function mightBeEnum(value) {\n        checkInit();\n        return glEnums[value] !== undefined;\n    }\n\n    /**\n     * Gets an string version of an WebGL enum.\n     *\n     * Example:\n     *   var str = WebGLDebugUtil.glEnumToString(ctx.getError());\n     *\n     * @param {number} value Value to return an enum for\n     * @return {string} The string version of the enum.\n     */\n    function glEnumToString(value) {\n        checkInit();\n        var name = glEnums[value];\n        return name !== undefined\n            ? 'gl.' + name\n            : '/*UNKNOWN WebGL ENUM*/ 0x' + value.toString(16) + '';\n    }\n\n    /**\n     * Returns the string version of a WebGL argument.\n     * Attempts to convert enum arguments to strings.\n     * @param {string} functionName the name of the WebGL function.\n     * @param {number} numArgs the number of arguments passed to the function.\n     * @param {number} argumentIndx the index of the argument.\n     * @param {*} value The value of the argument.\n     * @return {string} The value as a string.\n     */\n    function glFunctionArgToString(functionName, numArgs, argumentIndex, value) {\n        var funcInfo = glValidEnumContexts[functionName];\n        if (funcInfo !== undefined) {\n            var funcInfo = funcInfo[numArgs];\n            if (funcInfo !== undefined) {\n                if (funcInfo[argumentIndex]) {\n                    if (\n                        typeof funcInfo[argumentIndex] === 'object' &&\n                        funcInfo[argumentIndex]['enumBitwiseOr'] !== undefined\n                    ) {\n                        var enums = funcInfo[argumentIndex]['enumBitwiseOr'];\n                        var orResult = 0;\n                        var orEnums = [];\n                        for (var i = 0; i < enums.length; ++i) {\n                            var enumValue = enumStringToValue[enums[i]];\n                            if ((value & enumValue) !== 0) {\n                                orResult |= enumValue;\n                                orEnums.push(glEnumToString(enumValue));\n                            }\n                        }\n                        if (orResult === value) {\n                            return orEnums.join(' | ');\n                        } else {\n                            return glEnumToString(value);\n                        }\n                    } else {\n                        return glEnumToString(value);\n                    }\n                }\n            }\n        }\n        if (value === null) {\n            return 'null';\n        } else if (value === undefined) {\n            return 'undefined';\n        } else {\n            return value.toString();\n        }\n    }\n\n    /**\n     * Converts the arguments of a WebGL function to a string.\n     * Attempts to convert enum arguments to strings.\n     *\n     * @param {string} functionName the name of the WebGL function.\n     * @param {number} args The arguments.\n     * @return {string} The arguments as a string.\n     */\n    function glFunctionArgsToString(functionName, args) {\n        // apparently we can't do args.join(\",\");\n        var argStr = '';\n        var numArgs = args.length;\n        for (var ii = 0; ii < numArgs; ++ii) {\n            argStr +=\n                (ii == 0 ? '' : ', ') + glFunctionArgToString(functionName, numArgs, ii, args[ii]);\n        }\n        return argStr;\n    }\n\n    function makePropertyWrapper(wrapper, original, propertyName) {\n        //log(\"wrap prop: \" + propertyName);\n        wrapper.__defineGetter__(propertyName, function() {\n            return original[propertyName];\n        });\n        // TODO(gmane): this needs to handle properties that take more than\n        // one value?\n        wrapper.__defineSetter__(propertyName, function(value) {\n            //log(\"set: \" + propertyName);\n            original[propertyName] = value;\n        });\n    }\n\n    // Makes a function that calls a function on another object.\n    function makeFunctionWrapper(original, functionName) {\n        //log(\"wrap fn: \" + functionName);\n        var f = original[functionName];\n        return function() {\n            //log(\"call: \" + functionName);\n            var result = f.apply(original, arguments);\n            return result;\n        };\n    }\n\n    /**\n     * Given a WebGL context returns a wrapped context that calls\n     * gl.getError after every command and calls a function if the\n     * result is not gl.NO_ERROR.\n     *\n     * @param {!WebGLRenderingContext} ctx The webgl context to\n     *        wrap.\n     * @param {!function(err, funcName, args): void} opt_onErrorFunc\n     *        The function to call when gl.getError returns an\n     *        error. If not specified the default function calls\n     *        console.log with a message.\n     * @param {!function(funcName, args): void} opt_onFunc The\n     *        function to call when each webgl function is called.\n     *        You can use this to log all calls for example.\n     * @param {!WebGLRenderingContext} opt_err_ctx The webgl context\n     *        to call getError on if different than ctx.\n     */\n    function makeDebugContext(ctx, opt_onErrorFunc, opt_onFunc, opt_err_ctx) {\n        opt_err_ctx = opt_err_ctx || ctx;\n        init(ctx);\n        opt_onErrorFunc =\n            opt_onErrorFunc ||\n            function(err, functionName, args) {\n                // apparently we can't do args.join(\",\");\n                var argStr = '';\n                var numArgs = args.length;\n                for (var ii = 0; ii < numArgs; ++ii) {\n                    argStr +=\n                        (ii == 0 ? '' : ', ') +\n                        glFunctionArgToString(functionName, numArgs, ii, args[ii]);\n                }\n                error(\n                    'WebGL error ' +\n                        glEnumToString(err) +\n                        ' in ' +\n                        functionName +\n                        '(' +\n                        argStr +\n                        ')'\n                );\n            };\n\n        // Holds booleans for each GL error so after we get the error ourselves\n        // we can still return it to the client app.\n        var glErrorShadow = {};\n\n        // Makes a function that calls a WebGL function and then calls getError.\n        function makeErrorWrapper(ctx, functionName) {\n            return function() {\n                if (opt_onFunc) {\n                    opt_onFunc(functionName, arguments);\n                }\n                var result = ctx[functionName].apply(ctx, arguments);\n                var err = opt_err_ctx.getError();\n                if (err != 0) {\n                    glErrorShadow[err] = true;\n                    opt_onErrorFunc(err, functionName, arguments);\n                }\n                return result;\n            };\n        }\n\n        // Make a an object that has a copy of every property of the WebGL context\n        // but wraps all functions.\n        var wrapper = {};\n        for (var propertyName in ctx) {\n            if (typeof ctx[propertyName] === 'function') {\n                if (propertyName != 'getExtension') {\n                    wrapper[propertyName] = makeErrorWrapper(ctx, propertyName);\n                } else {\n                    var wrapped = makeErrorWrapper(ctx, propertyName);\n                    wrapper[propertyName] = function() {\n                        var result = wrapped.apply(ctx, arguments);\n                        if (!result) {\n                            return null;\n                        }\n                        return makeDebugContext(result, opt_onErrorFunc, opt_onFunc, opt_err_ctx);\n                    };\n                }\n            } else {\n                makePropertyWrapper(wrapper, ctx, propertyName);\n            }\n        }\n\n        // Override the getError function with one that returns our saved results.\n        wrapper.getError = function() {\n            for (var err in glErrorShadow) {\n                if (glErrorShadow.hasOwnProperty(err)) {\n                    if (glErrorShadow[err]) {\n                        glErrorShadow[err] = false;\n                        return err;\n                    }\n                }\n            }\n            return ctx.NO_ERROR;\n        };\n\n        return wrapper;\n    }\n\n    function resetToInitialState(ctx) {\n        var isWebGL2RenderingContext = !!ctx.createTransformFeedback;\n\n        if (isWebGL2RenderingContext) {\n            ctx.bindVertexArray(null);\n        }\n\n        var numAttribs = ctx.getParameter(ctx.MAX_VERTEX_ATTRIBS);\n        var tmp = ctx.createBuffer();\n        ctx.bindBuffer(ctx.ARRAY_BUFFER, tmp);\n        for (var ii = 0; ii < numAttribs; ++ii) {\n            ctx.disableVertexAttribArray(ii);\n            ctx.vertexAttribPointer(ii, 4, ctx.FLOAT, false, 0, 0);\n            ctx.vertexAttrib1f(ii, 0);\n            if (isWebGL2RenderingContext) {\n                ctx.vertexAttribDivisor(ii, 0);\n            }\n        }\n        ctx.deleteBuffer(tmp);\n\n        var numTextureUnits = ctx.getParameter(ctx.MAX_TEXTURE_IMAGE_UNITS);\n        for (var ii = 0; ii < numTextureUnits; ++ii) {\n            ctx.activeTexture(ctx.TEXTURE0 + ii);\n            ctx.bindTexture(ctx.TEXTURE_CUBE_MAP, null);\n            ctx.bindTexture(ctx.TEXTURE_2D, null);\n            if (isWebGL2RenderingContext) {\n                ctx.bindTexture(ctx.TEXTURE_2D_ARRAY, null);\n                ctx.bindTexture(ctx.TEXTURE_3D, null);\n                ctx.bindSampler(ii, null);\n            }\n        }\n\n        ctx.activeTexture(ctx.TEXTURE0);\n        ctx.useProgram(null);\n        ctx.bindBuffer(ctx.ARRAY_BUFFER, null);\n        ctx.bindBuffer(ctx.ELEMENT_ARRAY_BUFFER, null);\n        ctx.bindFramebuffer(ctx.FRAMEBUFFER, null);\n        ctx.bindRenderbuffer(ctx.RENDERBUFFER, null);\n        ctx.disable(ctx.BLEND);\n        ctx.disable(ctx.CULL_FACE);\n        ctx.disable(ctx.DEPTH_TEST);\n        ctx.disable(ctx.DITHER);\n        ctx.disable(ctx.SCISSOR_TEST);\n        ctx.blendColor(0, 0, 0, 0);\n        ctx.blendEquation(ctx.FUNC_ADD);\n        ctx.blendFunc(ctx.ONE, ctx.ZERO);\n        ctx.clearColor(0, 0, 0, 0);\n        ctx.clearDepth(1);\n        ctx.clearStencil(-1);\n        ctx.colorMask(true, true, true, true);\n        ctx.cullFace(ctx.BACK);\n        ctx.depthFunc(ctx.LESS);\n        ctx.depthMask(true);\n        ctx.depthRange(0, 1);\n        ctx.frontFace(ctx.CCW);\n        ctx.hint(ctx.GENERATE_MIPMAP_HINT, ctx.DONT_CARE);\n        ctx.lineWidth(1);\n        ctx.pixelStorei(ctx.PACK_ALIGNMENT, 4);\n        ctx.pixelStorei(ctx.UNPACK_ALIGNMENT, 4);\n        ctx.pixelStorei(ctx.UNPACK_FLIP_Y_WEBGL, false);\n        ctx.pixelStorei(ctx.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);\n        // TODO: Delete this IF.\n        if (ctx.UNPACK_COLORSPACE_CONVERSION_WEBGL) {\n            ctx.pixelStorei(ctx.UNPACK_COLORSPACE_CONVERSION_WEBGL, ctx.BROWSER_DEFAULT_WEBGL);\n        }\n        ctx.polygonOffset(0, 0);\n        ctx.sampleCoverage(1, false);\n        ctx.scissor(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.stencilFunc(ctx.ALWAYS, 0, 0xffffffff);\n        ctx.stencilMask(0xffffffff);\n        ctx.stencilOp(ctx.KEEP, ctx.KEEP, ctx.KEEP);\n        ctx.viewport(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.clear(ctx.COLOR_BUFFER_BIT | ctx.DEPTH_BUFFER_BIT | ctx.STENCIL_BUFFER_BIT);\n\n        if (isWebGL2RenderingContext) {\n            ctx.drawBuffers([ctx.BACK]);\n            ctx.readBuffer(ctx.BACK);\n            ctx.bindBuffer(ctx.COPY_READ_BUFFER, null);\n            ctx.bindBuffer(ctx.COPY_WRITE_BUFFER, null);\n            ctx.bindBuffer(ctx.PIXEL_PACK_BUFFER, null);\n            ctx.bindBuffer(ctx.PIXEL_UNPACK_BUFFER, null);\n            var numTransformFeedbacks = ctx.getParameter(\n                ctx.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS\n            );\n            for (var ii = 0; ii < numTransformFeedbacks; ++ii) {\n                ctx.bindBufferBase(ctx.TRANSFORM_FEEDBACK_BUFFER, ii, null);\n            }\n            var numUBOs = ctx.getParameter(ctx.MAX_UNIFORM_BUFFER_BINDINGS);\n            for (var ii = 0; ii < numUBOs; ++ii) {\n                ctx.bindBufferBase(ctx.UNIFORM_BUFFER, ii, null);\n            }\n            ctx.disable(ctx.RASTERIZER_DISCARD);\n            ctx.pixelStorei(ctx.UNPACK_IMAGE_HEIGHT, 0);\n            ctx.pixelStorei(ctx.UNPACK_SKIP_IMAGES, 0);\n            ctx.pixelStorei(ctx.UNPACK_ROW_LENGTH, 0);\n            ctx.pixelStorei(ctx.UNPACK_SKIP_ROWS, 0);\n            ctx.pixelStorei(ctx.UNPACK_SKIP_PIXELS, 0);\n            ctx.pixelStorei(ctx.PACK_ROW_LENGTH, 0);\n            ctx.pixelStorei(ctx.PACK_SKIP_ROWS, 0);\n            ctx.pixelStorei(ctx.PACK_SKIP_PIXELS, 0);\n            ctx.hint(ctx.FRAGMENT_SHADER_DERIVATIVE_HINT, ctx.DONT_CARE);\n        }\n\n        // TODO: This should NOT be needed but Firefox fails with 'hint'\n        while (ctx.getError());\n    }\n\n    function makeLostContextSimulatingCanvas(canvas) {\n        var unwrappedContext_;\n        var wrappedContext_;\n        var onLost_ = [];\n        var onRestored_ = [];\n        var wrappedContext_ = {};\n        var contextId_ = 1;\n        var contextLost_ = false;\n        var resourceId_ = 0;\n        var resourceDb_ = [];\n        var numCallsToLoseContext_ = 0;\n        var numCalls_ = 0;\n        var canRestore_ = false;\n        var restoreTimeout_ = 0;\n        var isWebGL2RenderingContext;\n\n        // Holds booleans for each GL error so can simulate errors.\n        var glErrorShadow_ = {};\n\n        canvas.getContext = (function(f) {\n            return function() {\n                var ctx = f.apply(canvas, arguments);\n                // Did we get a context and is it a WebGL context?\n                if (\n                    ctx instanceof WebGLRenderingContext ||\n                    (window.WebGL2RenderingContext && ctx instanceof WebGL2RenderingContext)\n                ) {\n                    if (ctx != unwrappedContext_) {\n                        if (unwrappedContext_) {\n                            throw 'got different context';\n                        }\n                        isWebGL2RenderingContext =\n                            window.WebGL2RenderingContext && ctx instanceof WebGL2RenderingContext;\n                        unwrappedContext_ = ctx;\n                        wrappedContext_ = makeLostContextSimulatingContext(unwrappedContext_);\n                    }\n                    return wrappedContext_;\n                }\n                return ctx;\n            };\n        })(canvas.getContext);\n\n        function wrapEvent(listener) {\n            if (typeof listener === 'function') {\n                return listener;\n            } else {\n                return function(info) {\n                    listener.handleEvent(info);\n                };\n            }\n        }\n\n        var addOnContextLostListener = function(listener) {\n            onLost_.push(wrapEvent(listener));\n        };\n\n        var addOnContextRestoredListener = function(listener) {\n            onRestored_.push(wrapEvent(listener));\n        };\n\n        function wrapAddEventListener(canvas) {\n            var f = canvas.addEventListener;\n            canvas.addEventListener = function(type, listener, bubble) {\n                switch (type) {\n                    case 'webglcontextlost':\n                        addOnContextLostListener(listener);\n                        break;\n                    case 'webglcontextrestored':\n                        addOnContextRestoredListener(listener);\n                        break;\n                    default:\n                        f.apply(canvas, arguments);\n                }\n            };\n        }\n\n        wrapAddEventListener(canvas);\n\n        canvas.loseContext = function() {\n            if (!contextLost_) {\n                contextLost_ = true;\n                numCallsToLoseContext_ = 0;\n                ++contextId_;\n                while (unwrappedContext_.getError());\n                clearErrors();\n                glErrorShadow_[unwrappedContext_.CONTEXT_LOST_WEBGL] = true;\n                var event = makeWebGLContextEvent('context lost');\n                var callbacks = onLost_.slice();\n                setTimeout(function() {\n                    //log(\"numCallbacks:\" + callbacks.length);\n                    for (var ii = 0; ii < callbacks.length; ++ii) {\n                        //log(\"calling callback:\" + ii);\n                        callbacks[ii](event);\n                    }\n                    if (restoreTimeout_ >= 0) {\n                        setTimeout(function() {\n                            canvas.restoreContext();\n                        }, restoreTimeout_);\n                    }\n                }, 0);\n            }\n        };\n\n        canvas.restoreContext = function() {\n            if (contextLost_) {\n                if (onRestored_.length) {\n                    setTimeout(function() {\n                        if (!canRestore_) {\n                            throw 'can not restore. webglcontestlost listener did not call event.preventDefault';\n                        }\n                        freeResources();\n                        resetToInitialState(unwrappedContext_);\n                        contextLost_ = false;\n                        numCalls_ = 0;\n                        canRestore_ = false;\n                        var callbacks = onRestored_.slice();\n                        var event = makeWebGLContextEvent('context restored');\n                        for (var ii = 0; ii < callbacks.length; ++ii) {\n                            callbacks[ii](event);\n                        }\n                    }, 0);\n                }\n            }\n        };\n\n        canvas.loseContextInNCalls = function(numCalls) {\n            if (contextLost_) {\n                throw 'You can not ask a lost contet to be lost';\n            }\n            numCallsToLoseContext_ = numCalls_ + numCalls;\n        };\n\n        canvas.getNumCalls = function() {\n            return numCalls_;\n        };\n\n        canvas.setRestoreTimeout = function(timeout) {\n            restoreTimeout_ = timeout;\n        };\n\n        function isWebGLObject(obj) {\n            //return false;\n            return (\n                obj instanceof WebGLBuffer ||\n                obj instanceof WebGLFramebuffer ||\n                obj instanceof WebGLProgram ||\n                obj instanceof WebGLRenderbuffer ||\n                obj instanceof WebGLShader ||\n                obj instanceof WebGLTexture\n            );\n        }\n\n        function checkResources(args) {\n            for (var ii = 0; ii < args.length; ++ii) {\n                var arg = args[ii];\n                if (isWebGLObject(arg)) {\n                    return arg.__webglDebugContextLostId__ == contextId_;\n                }\n            }\n            return true;\n        }\n\n        function clearErrors() {\n            var k = Object.keys(glErrorShadow_);\n            for (var ii = 0; ii < k.length; ++ii) {\n                delete glErrorShadow_[k[ii]];\n            }\n        }\n\n        function loseContextIfTime() {\n            ++numCalls_;\n            if (!contextLost_) {\n                if (numCallsToLoseContext_ == numCalls_) {\n                    canvas.loseContext();\n                }\n            }\n        }\n\n        // Makes a function that simulates WebGL when out of context.\n        function makeLostContextFunctionWrapper(ctx, functionName) {\n            var f = ctx[functionName];\n            return function() {\n                // log(\"calling:\" + functionName);\n                // Only call the functions if the context is not lost.\n                loseContextIfTime();\n                if (!contextLost_) {\n                    //if (!checkResources(arguments)) {\n                    //  glErrorShadow_[wrappedContext_.INVALID_OPERATION] = true;\n                    //  return;\n                    //}\n                    var result = f.apply(ctx, arguments);\n                    return result;\n                }\n            };\n        }\n\n        function freeResources() {\n            for (var ii = 0; ii < resourceDb_.length; ++ii) {\n                var resource = resourceDb_[ii];\n                if (resource instanceof WebGLBuffer) {\n                    unwrappedContext_.deleteBuffer(resource);\n                } else if (resource instanceof WebGLFramebuffer) {\n                    unwrappedContext_.deleteFramebuffer(resource);\n                } else if (resource instanceof WebGLProgram) {\n                    unwrappedContext_.deleteProgram(resource);\n                } else if (resource instanceof WebGLRenderbuffer) {\n                    unwrappedContext_.deleteRenderbuffer(resource);\n                } else if (resource instanceof WebGLShader) {\n                    unwrappedContext_.deleteShader(resource);\n                } else if (resource instanceof WebGLTexture) {\n                    unwrappedContext_.deleteTexture(resource);\n                } else if (isWebGL2RenderingContext) {\n                    if (resource instanceof WebGLQuery) {\n                        unwrappedContext_.deleteQuery(resource);\n                    } else if (resource instanceof WebGLSampler) {\n                        unwrappedContext_.deleteSampler(resource);\n                    } else if (resource instanceof WebGLSync) {\n                        unwrappedContext_.deleteSync(resource);\n                    } else if (resource instanceof WebGLTransformFeedback) {\n                        unwrappedContext_.deleteTransformFeedback(resource);\n                    } else if (resource instanceof WebGLVertexArrayObject) {\n                        unwrappedContext_.deleteVertexArray(resource);\n                    }\n                }\n            }\n        }\n\n        function makeWebGLContextEvent(statusMessage) {\n            return {\n                statusMessage: statusMessage,\n                preventDefault: function() {\n                    canRestore_ = true;\n                }\n            };\n        }\n\n        return canvas;\n\n        function makeLostContextSimulatingContext(ctx) {\n            // copy all functions and properties to wrapper\n            for (var propertyName in ctx) {\n                if (typeof ctx[propertyName] === 'function') {\n                    wrappedContext_[propertyName] = makeLostContextFunctionWrapper(\n                        ctx,\n                        propertyName\n                    );\n                } else {\n                    makePropertyWrapper(wrappedContext_, ctx, propertyName);\n                }\n            }\n\n            // Wrap a few functions specially.\n            wrappedContext_.getError = function() {\n                loseContextIfTime();\n                if (!contextLost_) {\n                    var err;\n                    while ((err = unwrappedContext_.getError())) {\n                        glErrorShadow_[err] = true;\n                    }\n                }\n                for (var err in glErrorShadow_) {\n                    if (glErrorShadow_[err]) {\n                        delete glErrorShadow_[err];\n                        return err;\n                    }\n                }\n                return wrappedContext_.NO_ERROR;\n            };\n\n            var creationFunctions = [\n                'createBuffer',\n                'createFramebuffer',\n                'createProgram',\n                'createRenderbuffer',\n                'createShader',\n                'createTexture'\n            ];\n            if (isWebGL2RenderingContext) {\n                creationFunctions.push(\n                    'createQuery',\n                    'createSampler',\n                    'fenceSync',\n                    'createTransformFeedback',\n                    'createVertexArray'\n                );\n            }\n            for (var ii = 0; ii < creationFunctions.length; ++ii) {\n                var functionName = creationFunctions[ii];\n                wrappedContext_[functionName] = (function(f) {\n                    return function() {\n                        loseContextIfTime();\n                        if (contextLost_) {\n                            return null;\n                        }\n                        var obj = f.apply(ctx, arguments);\n                        obj.__webglDebugContextLostId__ = contextId_;\n                        resourceDb_.push(obj);\n                        return obj;\n                    };\n                })(ctx[functionName]);\n            }\n\n            var functionsThatShouldReturnNull = [\n                'getActiveAttrib',\n                'getActiveUniform',\n                'getBufferParameter',\n                'getContextAttributes',\n                'getAttachedShaders',\n                'getFramebufferAttachmentParameter',\n                'getParameter',\n                'getProgramParameter',\n                'getProgramInfoLog',\n                'getRenderbufferParameter',\n                'getShaderParameter',\n                'getShaderInfoLog',\n                'getShaderSource',\n                'getTexParameter',\n                'getUniform',\n                'getUniformLocation',\n                'getVertexAttrib'\n            ];\n            if (isWebGL2RenderingContext) {\n                functionsThatShouldReturnNull.push(\n                    'getInternalformatParameter',\n                    'getQuery',\n                    'getQueryParameter',\n                    'getSamplerParameter',\n                    'getSyncParameter',\n                    'getTransformFeedbackVarying',\n                    'getIndexedParameter',\n                    'getUniformIndices',\n                    'getActiveUniforms',\n                    'getActiveUniformBlockParameter',\n                    'getActiveUniformBlockName'\n                );\n            }\n            for (var ii = 0; ii < functionsThatShouldReturnNull.length; ++ii) {\n                var functionName = functionsThatShouldReturnNull[ii];\n                wrappedContext_[functionName] = (function(f) {\n                    return function() {\n                        loseContextIfTime();\n                        if (contextLost_) {\n                            return null;\n                        }\n                        return f.apply(ctx, arguments);\n                    };\n                })(wrappedContext_[functionName]);\n            }\n\n            var isFunctions = [\n                'isBuffer',\n                'isEnabled',\n                'isFramebuffer',\n                'isProgram',\n                'isRenderbuffer',\n                'isShader',\n                'isTexture'\n            ];\n            if (isWebGL2RenderingContext) {\n                isFunctions.push(\n                    'isQuery',\n                    'isSampler',\n                    'isSync',\n                    'isTransformFeedback',\n                    'isVertexArray'\n                );\n            }\n            for (var ii = 0; ii < isFunctions.length; ++ii) {\n                var functionName = isFunctions[ii];\n                wrappedContext_[functionName] = (function(f) {\n                    return function() {\n                        loseContextIfTime();\n                        if (contextLost_) {\n                            return false;\n                        }\n                        return f.apply(ctx, arguments);\n                    };\n                })(wrappedContext_[functionName]);\n            }\n\n            wrappedContext_.checkFramebufferStatus = (function(f) {\n                return function() {\n                    loseContextIfTime();\n                    if (contextLost_) {\n                        return wrappedContext_.FRAMEBUFFER_UNSUPPORTED;\n                    }\n                    return f.apply(ctx, arguments);\n                };\n            })(wrappedContext_.checkFramebufferStatus);\n\n            wrappedContext_.getAttribLocation = (function(f) {\n                return function() {\n                    loseContextIfTime();\n                    if (contextLost_) {\n                        return -1;\n                    }\n                    return f.apply(ctx, arguments);\n                };\n            })(wrappedContext_.getAttribLocation);\n\n            wrappedContext_.getVertexAttribOffset = (function(f) {\n                return function() {\n                    loseContextIfTime();\n                    if (contextLost_) {\n                        return 0;\n                    }\n                    return f.apply(ctx, arguments);\n                };\n            })(wrappedContext_.getVertexAttribOffset);\n\n            wrappedContext_.isContextLost = function() {\n                return contextLost_;\n            };\n\n            if (isWebGL2RenderingContext) {\n                wrappedContext_.getFragDataLocation = (function(f) {\n                    return function() {\n                        loseContextIfTime();\n                        if (contextLost_) {\n                            return -1;\n                        }\n                        return f.apply(ctx, arguments);\n                    };\n                })(wrappedContext_.getFragDataLocation);\n\n                wrappedContext_.clientWaitSync = (function(f) {\n                    return function() {\n                        loseContextIfTime();\n                        if (contextLost_) {\n                            return wrappedContext_.WAIT_FAILED;\n                        }\n                        return f.apply(ctx, arguments);\n                    };\n                })(wrappedContext_.clientWaitSync);\n\n                wrappedContext_.getUniformBlockIndex = (function(f) {\n                    return function() {\n                        loseContextIfTime();\n                        if (contextLost_) {\n                            return wrappedContext_.INVALID_INDEX;\n                        }\n                        return f.apply(ctx, arguments);\n                    };\n                })(wrappedContext_.getUniformBlockIndex);\n            }\n\n            return wrappedContext_;\n        }\n    }\n\n    return {\n        /**\n         * Initializes this module. Safe to call more than once.\n         * @param {!WebGLRenderingContext} ctx A WebGL context. If\n         *    you have more than one context it doesn't matter which one\n         *    you pass in, it is only used to pull out constants.\n         */\n        init: init,\n\n        /**\n         * Returns true or false if value matches any WebGL enum\n         * @param {*} value Value to check if it might be an enum.\n         * @return {boolean} True if value matches one of the WebGL defined enums\n         */\n        mightBeEnum: mightBeEnum,\n\n        /**\n         * Gets an string version of an WebGL enum.\n         *\n         * Example:\n         *   WebGLDebugUtil.init(ctx);\n         *   var str = WebGLDebugUtil.glEnumToString(ctx.getError());\n         *\n         * @param {number} value Value to return an enum for\n         * @return {string} The string version of the enum.\n         */\n        glEnumToString: glEnumToString,\n\n        /**\n         * Converts the argument of a WebGL function to a string.\n         * Attempts to convert enum arguments to strings.\n         *\n         * Example:\n         *   WebGLDebugUtil.init(ctx);\n         *   var str = WebGLDebugUtil.glFunctionArgToString('bindTexture', 2, 0, gl.TEXTURE_2D);\n         *\n         * would return 'TEXTURE_2D'\n         *\n         * @param {string} functionName the name of the WebGL function.\n         * @param {number} numArgs The number of arguments\n         * @param {number} argumentIndx the index of the argument.\n         * @param {*} value The value of the argument.\n         * @return {string} The value as a string.\n         */\n        glFunctionArgToString: glFunctionArgToString,\n\n        /**\n         * Converts the arguments of a WebGL function to a string.\n         * Attempts to convert enum arguments to strings.\n         *\n         * @param {string} functionName the name of the WebGL function.\n         * @param {number} args The arguments.\n         * @return {string} The arguments as a string.\n         */\n        glFunctionArgsToString: glFunctionArgsToString,\n\n        /**\n         * Given a WebGL context returns a wrapped context that calls\n         * gl.getError after every command and calls a function if the\n         * result is not NO_ERROR.\n         *\n         * You can supply your own function if you want. For example, if you'd like\n         * an exception thrown on any GL error you could do this\n         *\n         *    function throwOnGLError(err, funcName, args) {\n         *      throw WebGLDebugUtils.glEnumToString(err) +\n         *            \" was caused by call to \" + funcName;\n         *    };\n         *\n         *    ctx = WebGLDebugUtils.makeDebugContext(\n         *        canvas.getContext(\"webgl\"), throwOnGLError);\n         *\n         * @param {!WebGLRenderingContext} ctx The webgl context to wrap.\n         * @param {!function(err, funcName, args): void} opt_onErrorFunc The function\n         *     to call when gl.getError returns an error. If not specified the default\n         *     function calls console.log with a message.\n         * @param {!function(funcName, args): void} opt_onFunc The\n         *     function to call when each webgl function is called. You\n         *     can use this to log all calls for example.\n         */\n        makeDebugContext: makeDebugContext,\n\n        /**\n         * Given a canvas element returns a wrapped canvas element that will\n         * simulate lost context. The canvas returned adds the following functions.\n         *\n         * loseContext:\n         *   simulates a lost context event.\n         *\n         * restoreContext:\n         *   simulates the context being restored.\n         *\n         * lostContextInNCalls:\n         *   loses the context after N gl calls.\n         *\n         * getNumCalls:\n         *   tells you how many gl calls there have been so far.\n         *\n         * setRestoreTimeout:\n         *   sets the number of milliseconds until the context is restored\n         *   after it has been lost. Defaults to 0. Pass -1 to prevent\n         *   automatic restoring.\n         *\n         * @param {!Canvas} canvas The canvas element to wrap.\n         */\n        makeLostContextSimulatingCanvas: makeLostContextSimulatingCanvas,\n\n        /**\n         * Resets a context to the initial state.\n         * @param {!WebGLRenderingContext} ctx The webgl context to\n         *     reset.\n         */\n        resetToInitialState: resetToInitialState\n    };\n})();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (WebGLDebugUtils);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgViewer/webgl-debug.js\n// module id = 250\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgViewer/webgl-debug.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgShadow_ShadowCastAttribute__ = __webpack_require__(168);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgShadow_ShadowCastCompiler__ = __webpack_require__(155);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgShadow_ShadowCastShaderGenerator__ = __webpack_require__(154);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgShadow_ShadowCasterVisitor__ = __webpack_require__(169);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShadow_ShadowFrustumIntersection__ = __webpack_require__(252);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShadow_ShadowMap__ = __webpack_require__(170);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgShadow_ShadowMapAtlas__ = __webpack_require__(253);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgShadow_ShadowReceiveAttribute__ = __webpack_require__(171);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgShadow_ShadowSettings__ = __webpack_require__(254);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgShadow_ShadowTechnique__ = __webpack_require__(99);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgShadow_ShadowTexture__ = __webpack_require__(100);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgShadow_ShadowTextureAtlas__ = __webpack_require__(172);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgShadow_ShadowedScene__ = __webpack_require__(255);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar osgShadow = {};\n\nosgShadow.ShadowCastAttribute = __WEBPACK_IMPORTED_MODULE_0_osgShadow_ShadowCastAttribute__["a" /* default */];\nosgShadow.ShadowCastCompiler = __WEBPACK_IMPORTED_MODULE_1_osgShadow_ShadowCastCompiler__["a" /* default */];\nosgShadow.ShadowReceiveAttribute = __WEBPACK_IMPORTED_MODULE_7_osgShadow_ShadowReceiveAttribute__["a" /* default */];\nosgShadow.ShadowCasterVisitor = __WEBPACK_IMPORTED_MODULE_3_osgShadow_ShadowCasterVisitor__["a" /* default */];\nosgShadow.ShadowFrustumIntersection = __WEBPACK_IMPORTED_MODULE_4_osgShadow_ShadowFrustumIntersection__["a" /* default */];\nosgShadow.ShadowMap = __WEBPACK_IMPORTED_MODULE_5_osgShadow_ShadowMap__["a" /* default */];\nosgShadow.ShadowMapAtlas = __WEBPACK_IMPORTED_MODULE_6_osgShadow_ShadowMapAtlas__["a" /* default */];\nosgShadow.ShadowedScene = __WEBPACK_IMPORTED_MODULE_12_osgShadow_ShadowedScene__["a" /* default */];\nosgShadow.ShadowSettings = __WEBPACK_IMPORTED_MODULE_8_osgShadow_ShadowSettings__["a" /* default */];\nosgShadow.ShadowCastShaderGenerator = __WEBPACK_IMPORTED_MODULE_2_osgShadow_ShadowCastShaderGenerator__["a" /* default */];\nosgShadow.ShadowTechnique = __WEBPACK_IMPORTED_MODULE_9_osgShadow_ShadowTechnique__["a" /* default */];\nosgShadow.ShadowTexture = __WEBPACK_IMPORTED_MODULE_10_osgShadow_ShadowTexture__["a" /* default */];\nosgShadow.ShadowTextureAtlas = __WEBPACK_IMPORTED_MODULE_11_osgShadow_ShadowTextureAtlas__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (osgShadow);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/osgShadow.js\n// module id = 251\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/osgShadow.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_BoundingBox__ = __webpack_require__(28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_BoundingSphere__ = __webpack_require__(42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_Light__ = __webpack_require__(53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_PooledResource__ = __webpack_require__(25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_PooledArray__ = __webpack_require__(19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Plane__ = __webpack_require__(43);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osg_utils__ = __webpack_require__(0);\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * [ComputeFrustumBoundsVisitor get a scene bounds limited by a light and camera frustum]\n */\nvar ComputeMultiFrustumBoundsVisitor = function() {\n    __WEBPACK_IMPORTED_MODULE_9_osg_NodeVisitor__["a" /* default */].call(this, __WEBPACK_IMPORTED_MODULE_9_osg_NodeVisitor__["a" /* default */].TRAVERSE_ALL_CHILDREN);\n\n    this._pooledMatrix = new __WEBPACK_IMPORTED_MODULE_6_osg_PooledResource__["a" /* default */](__WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].create);\n\n    this._matrixStack = new __WEBPACK_IMPORTED_MODULE_7_osg_PooledArray__["a" /* default */]();\n    this._matrixStack.push(__WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n\n    this._bb = new __WEBPACK_IMPORTED_MODULE_0_osg_BoundingBox__["a" /* default */]();\n    this._bs = new __WEBPACK_IMPORTED_MODULE_1_osg_BoundingSphere__["a" /* default */]();\n};\n\n/*\n * TODO: apply world matrix on the traverse instead of per node\n */\n__WEBPACK_IMPORTED_MODULE_11_osg_utils__["a" /* default */].createPrototypeObject(\n    ComputeMultiFrustumBoundsVisitor,\n    __WEBPACK_IMPORTED_MODULE_11_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_9_osg_NodeVisitor__["a" /* default */].prototype, {\n        reset: function(traversalMask, worldLightPos, cameraFrustum, cameraNearFar, lightFrustum) {\n            this.setTraversalMask(traversalMask);\n\n            this._cameraFrustum = cameraFrustum;\n            this._lightFrustum = lightFrustum;\n\n            // what plane to exclude from shadowedscene\n            this.getCameraPlaneMaskForLightNear(\n                worldLightPos,\n                cameraFrustum,\n                cameraNearFar ? 6 : 4\n            );\n\n            this._pooledMatrix.reset();\n            this._matrixStack.reset();\n            this._matrixStack.push(__WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].IDENTITY);\n            this._bb.init();\n        },\n\n        getBoundingBox: function() {\n            return this._bb;\n        },\n\n        getCameraPlaneMaskForLightNear: function(point, cameraFrustum, len) {\n            var selectorMask = 0x1;\n            var resultMask = 15;\n            var i;\n\n            for (i = 0; i < len; ++i) {\n                resultMask = (resultMask << 1) | 1;\n            }\n\n            var planeList = cameraFrustum.getPlanes();\n            for (i = 0; i < len; ++i) {\n                if (__WEBPACK_IMPORTED_MODULE_10_osg_Plane__["a" /* default */].distanceToPlane(planeList[i], point) < 0.0) {\n                    // Ligth frustum source poitn is outside this plane.\n                    // subsequent checks against this plane not required.\n                    // as light position is behind those,\n                    // and culling that would cull light near\n                    resultMask ^= selectorMask;\n                }\n                selectorMask <<= 1;\n            }\n            this._cameraPlaneMaskedByLightNear = resultMask;\n\n            cameraFrustum.setResultMask(resultMask);\n            cameraFrustum.pushCurrentMask(resultMask);\n            return resultMask;\n        },\n\n        applyTransform: function(transform) {\n            var matrix = this._pooledMatrix.getOrCreateObject();\n            __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].copy(matrix, this._matrixStack.back());\n            transform.computeLocalToWorldMatrix(matrix, this);\n\n            var bs = this._bs;\n            transform.getBound().transformMat4(this._bs, matrix);\n\n            // camera cull\n            if (this._cameraFrustum.getCurrentMask() !== 0) {\n                // father bounding sphere is not totally inside\n                // now test this one\n                if (!this._cameraFrustum.containsBoundingSphere(bs)) return; // culled\n            }\n\n            // light cull\n            if (this._lightFrustum.getCurrentMask() !== 0) {\n                // father bounding sphere is not totally inside\n                // now test this one\n                if (!this._lightFrustum.containsBoundingSphere(bs)) return; // culled\n            }\n\n            this._cameraFrustum.pushCurrentMask();\n            this._lightFrustum.pushCurrentMask();\n\n            this.pushMatrix(matrix);\n\n            this.traverse(transform);\n\n            this._cameraFrustum.popCurrentMask();\n            this._lightFrustum.popCurrentMask();\n\n            this.popMatrix();\n        },\n        applyBoundingBox: (function() {\n            var bbOut = new __WEBPACK_IMPORTED_MODULE_0_osg_BoundingBox__["a" /* default */]();\n            return function(bbox) {\n                var matrix = this._matrixStack.back();\n                if (__WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].exactEquals(matrix, __WEBPACK_IMPORTED_MODULE_5_osg_glMatrix__["c" /* mat4 */].IDENTITY)) {\n                    this._bb.expandByBoundingBox(bbox);\n                } else if (bbox.valid()) {\n                    bbox.transformMat4(bbOut, matrix);\n                    this._bb.expandByBoundingBox(bbOut);\n                }\n            };\n        })(),\n\n        apply: function(node) {\n            var typeID = node.getTypeID();\n\n            if (node instanceof __WEBPACK_IMPORTED_MODULE_8_osg_MatrixTransform__["a" /* default */]) {\n                this.applyTransform(node);\n                return;\n            } else if (typeID === __WEBPACK_IMPORTED_MODULE_3_osg_Geometry__["a" /* default */].getTypeID()) {\n                var bs = this._bs;\n                node.getBound().transformMat4(bs, this._matrixStack.back());\n\n                // camera cull\n                if (this._cameraFrustum.getCurrentMask() !== 0) {\n                    // father bounding sphere is not totally inside\n                    // now test this one\n                    if (!this._cameraFrustum.containsBoundingSphere(bs)) return; // culled\n                }\n\n                // light cull\n                if (this._lightFrustum.getCurrentMask() !== 0) {\n                    // father bounding sphere is not totally inside\n                    // now test this one\n                    if (!this._lightFrustum.containsBoundingSphere(bs)) return; // culled\n                }\n\n                // Visible: we enlarge the bbox\n                this.applyBoundingBox(node.getBoundingBox());\n\n                return;\n            } else if (typeID === __WEBPACK_IMPORTED_MODULE_2_osg_Camera__["a" /* default */].getTypeID()) {\n            } else if (typeID === __WEBPACK_IMPORTED_MODULE_4_osg_Light__["a" /* default */].getTypeID()) {\n            }\n\n            this.traverse(node);\n        },\n\n        pushMatrix: function(matrix) {\n            this._matrixStack.push(matrix);\n        },\n\n        popMatrix: function() {\n            this._matrixStack.pop();\n        }\n    }),\n    \'osgShadow\',\n    \'ComputeMultiFrustumBoundsVisitor\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ComputeMultiFrustumBoundsVisitor);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowFrustumIntersection.js\n// module id = 252\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowFrustumIntersection.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Camera__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgShadow_ShadowTechnique__ = __webpack_require__(99);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgShadow_ShadowTextureAtlas__ = __webpack_require__(172);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgShadow_ShadowMap__ = __webpack_require__(170);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__ = __webpack_require__(31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__ = __webpack_require__(39);\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n *  ShadowMapAtlas provides an implementation of shadow textures.\n * here, one shadow\n *  @class ShadowMapAtlas\n */\nvar ShadowMapAtlas = function(settings) {\n    this._lights = [];\n    this._shadowMaps = [];\n    this._viewportDimension = [];\n\n    __WEBPACK_IMPORTED_MODULE_4_osgShadow_ShadowTechnique__["a" /* default */].apply(this, arguments);\n    this._shadowSettings = settings;\n    this._texture = new __WEBPACK_IMPORTED_MODULE_5_osgShadow_ShadowTextureAtlas__["a" /* default */]();\n    this._textureUnitBase = 4;\n    this._textureUnit = this._textureUnitBase;\n\n    // see shadowSettings.js header for param explanations\n    this._textureMagFilter = undefined;\n    this._textureMinFilter = undefined;\n\n    this._textureSize = 1024;\n    this._shadowMapSize = 256;\n\n    this._receivingStateset = undefined;\n\n    this._shaderProcessor = undefined;\n\n    if (settings) {\n        this.setShadowSettings(settings);\n        if (settings.atlasSize) this._textureSize = settings.atlasSize;\n        if (settings.textureSize) this._shadowMapSize = settings.textureSize;\n    }\n\n    this._texelSizeUniform = __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat1(1.0 / this._textureSize, \'texelSize\');\n\n    var unifRenderSize = __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat2(\'RenderSize\');\n    this._renderSize = unifRenderSize.getInternalArray();\n    this._renderSize[0] = this._renderSize[1] = this._textureSize;\n\n    this._numShadowWidth = this._textureSize / this._shadowMapSize;\n    this._numShadowHeight = this._textureSize / this._shadowMapSize;\n\n    this._cameraClear = new __WEBPACK_IMPORTED_MODULE_2_osg_Camera__["a" /* default */]();\n    this._cameraClear.setName(\'shadowAtlasCameraClear\');\n    this._cameraClear.setRenderOrder(__WEBPACK_IMPORTED_MODULE_2_osg_Camera__["a" /* default */].PRE_RENDER, 0);\n    this._cameraClear.setClearColor(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(1.0, 1.0, 1.0, 1.0));\n    this._cameraClear.setFrameBufferObject(new __WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__["a" /* default */]());\n    this._cameraClear.setClearMask(0x0);\n};\n\n/** @lends ShadowMapAtlas.prototype */\n__WEBPACK_IMPORTED_MODULE_3_osg_utils__["a" /* default */].createPrototypeObject(\n    ShadowMapAtlas,\n    __WEBPACK_IMPORTED_MODULE_3_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_4_osgShadow_ShadowTechnique__["a" /* default */].prototype, {\n        getTexture: function() {\n            return this._texture;\n        },\n\n        isDirty: function(ligthtIndex) {\n            if (ligthtIndex !== undefined) {\n                return this._shadowMaps[ligthtIndex].isDirty();\n            } else {\n                for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                    if (this._shadowMaps[i].isDirty()) return true;\n                }\n            }\n            return false;\n        },\n        /**\n         * at which Texture unit number we start adding texture shadow\n         */\n        setTextureUnitBase: function(unitBase) {\n            this._textureUnitBase = unitBase;\n            this._textureUnit = unitBase;\n\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setTextureUnitBase(unitBase);\n            }\n        },\n\n        /* Sets  shadowSettings\n        */\n        setShadowSettings: function(shadowSettings) {\n            if (!shadowSettings) return;\n            this._shadowSettings = shadowSettings;\n\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++)\n                this._shadowMaps[i].setShadowSettings(shadowSettings);\n\n            this.setTextureSize(shadowSettings.textureSize);\n            this.setTexturePrecision(shadowSettings.textureType);\n        },\n\n        setCastsShadowDrawTraversalMask: function(mask) {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setCastsShadowDrawTraversalMask(mask);\n            }\n        },\n\n        getCastsShadowDrawTraversalMask: function(numShadow) {\n            if (numShadow !== undefined) {\n                return this._shadowMaps[numShadow].getCastsShadowDrawTraversalMask();\n            } else if (this._shadowMaps.length !== 0) {\n                return this._shadowMaps[0].getCastsShadowDrawTraversalMask();\n            }\n        },\n\n        setCastsShadowBoundsTraversalMask: function(mask) {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setCastsShadowBoundsTraversalMask(mask);\n            }\n        },\n\n        getCastsShadowBoundsTraversalMask: function(numShadow) {\n            if (numShadow !== undefined) {\n                return this._shadowMaps[numShadow].getCastsShadowDrawTraversalMask();\n            } else if (this._shadowMaps.length !== 0) {\n                return this._shadowMaps[0].getCastsShadowDrawTraversalMask();\n            }\n        },\n\n        getNormalBias: function(numShadow) {\n            if (numShadow !== undefined) {\n                return this._shadowMaps[numShadow].getNormalBias();\n            } else if (this._shadowMaps.length !== 0) {\n                return this._shadowMaps[0].getNormalBias();\n            }\n        },\n\n        setNormalBias: function(value) {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setNormalBias(value);\n            }\n        },\n\n        getBias: function(numShadow) {\n            if (numShadow !== undefined) {\n                return this._shadowMaps[numShadow].getBias();\n            } else if (this._shadowMaps.length !== 0) {\n                return this._shadowMaps[0].getBias();\n            }\n        },\n\n        setBias: function(value) {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setBias(value);\n            }\n        },\n\n        getKernelSizePCF: function(numShadow) {\n            if (numShadow !== undefined) {\n                return this._shadowMaps[numShadow].getKernelSizePCF();\n            } else if (this._shadowMaps.length !== 1) {\n                return this._shadowMaps[0].getKernelSizePCF();\n            }\n        },\n\n        setKernelSizePCF: function(value) {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setKernelSizePCF(value);\n            }\n        },\n\n        setShadowedScene: function(shadowedScene) {\n            __WEBPACK_IMPORTED_MODULE_4_osgShadow_ShadowTechnique__["a" /* default */].prototype.setShadowedScene.call(this, shadowedScene);\n            this._receivingStateset = this._shadowedScene.getReceivingStateSet();\n\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setShadowedScene(shadowedScene);\n            }\n        },\n\n        setTexturePrecision: function(value) {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].setTexturePrecision(value);\n            }\n        },\n\n        getTexturePrecision: function(numShadow) {\n            if (numShadow !== undefined) {\n                return this._shadowMaps[numShadow].getTexturePrecision();\n            } else if (this._shadowMaps.length !== 1) {\n                return this._shadowMaps[0].getTexturePrecision();\n            }\n        },\n\n        setTextureSize: function(mapSize) {\n            if (mapSize === this._textureSize) return;\n\n            //this._textureSize = mapSize;\n            //this._textureSize = settings.atlasSize;\n            this._shadowMapSize = mapSize;\n\n            this._numShadowWidth = this._textureSize / this._shadowMapSize;\n            this._numShadowHeight = this._textureSize / this._shadowMapSize;\n\n            this.dirty();\n        },\n\n        getShadowMap: function(lightNum) {\n            return this._shadowMaps[lightNum];\n        },\n\n        addLight: function(light) {\n            if (!light || this._lights.indexOf(light) !== -1) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\'no light or light already added\');\n                return -1;\n            }\n\n            var lightCount = this._lights.length;\n            if (lightCount === this._numShadowWidth * this._numShadowHeight) {\n                __WEBPACK_IMPORTED_MODULE_0_osg_notify__["a" /* default */].warn(\n                    "can\'t allocate shadow for light " +\n                        light.getLightNumber() +\n                        \' ShadowAtlas already full \'\n                );\n                return undefined;\n            }\n\n            this._lights.push(light);\n            this._shadowSettings.setLight(light);\n\n            var shadowMap = new __WEBPACK_IMPORTED_MODULE_6_osgShadow_ShadowMap__["a" /* default */](this._shadowSettings, this._texture);\n            this._shadowMaps.push(shadowMap);\n\n            if (this._shadowedScene) shadowMap.setShadowedScene(this._shadowedScene);\n\n            this.recomputeViewports();\n\n            return shadowMap;\n        },\n\n        /** initialize the ShadowedScene and local cached data structures.*/\n        init: function() {\n            if (!this._shadowedScene) return;\n\n            this.initTexture();\n            var lightNumberArray = [];\n            for (var k = 0; k < this._lights.length; k++) {\n                lightNumberArray.push(this._lights[k].getLightNumber());\n            }\n            this._texture.setLightNumberArray(lightNumberArray);\n\n            this._textureUnit = this._textureUnitBase;\n            this._texture.setName(\'ShadowTexture\' + this._textureUnit);\n\n            var unifRenderSize = __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat2(\'RenderSize\');\n            this._texelSizeUniform = __WEBPACK_IMPORTED_MODULE_9_osg_Uniform__["a" /* default */].createFloat1(1.0 / this._textureSize, \'texelSize\');\n            this._renderSize = unifRenderSize.getInternalArray();\n            this._renderSize[0] = this._renderSize[1] = this._textureSize;\n\n            this.recomputeViewports();\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                var shadowMap = this._shadowMaps[i];\n\n                if (!this._shadowedScene)\n                    this._shadowedScene = shadowMap.getShadowedScene(this._shadowedScene);\n                if (this._shadowedScene) shadowMap.setShadowedScene(this._shadowedScene);\n                shadowMap.init(this._texture, i, this._textureUnitBase);\n            }\n        },\n\n        recomputeViewports: function() {\n            var numViews = this._shadowMaps.length;\n\n            var viewDivideY = numViews > 2 ? Math.sqrt(2 * Math.ceil(numViews / 2)) : numViews;\n            var viewDivideX = viewDivideY;\n\n            var mapSizeX = this._textureSize / viewDivideX;\n            var mapSizeY = this._textureSize / viewDivideY;\n\n            var numShadowWidth = this._textureSize / mapSizeX;\n            var numShadowHeight = this._textureSize / mapSizeY;\n\n            for (var i = 0; i < numViews; i++) {\n                var shadowMap = this._shadowMaps[i];\n\n                var x = mapSizeX * (i % numShadowWidth);\n                var y = mapSizeY * Math.floor(i / numShadowHeight);\n\n                if (this._viewportDimension.length <= i) {\n                    this._viewportDimension.push(__WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].fromValues(x, y, mapSizeX, mapSizeY));\n                } else {\n                    __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].set(this._viewportDimension[i], x, y, mapSizeX, mapSizeY);\n                }\n\n                this._texture.setLightShadowMapSize(\n                    this._lights[i].getLightNumber(),\n                    this._viewportDimension[i]\n                );\n\n                shadowMap.dirty();\n            }\n        },\n\n        valid: function() {\n            // checks\n            return true;\n        },\n\n        updateCameraClear: function() {\n            var camera = this._cameraClear;\n            var texture = this._texture;\n\n            if (camera && texture) {\n                var vp = camera.getViewport();\n\n                if (!vp) {\n                    vp = new __WEBPACK_IMPORTED_MODULE_10_osg_Viewport__["a" /* default */]();\n                    camera.setViewport(vp);\n                }\n\n                // if texture size changed update the camera rtt params\n                if (vp.width() !== texture.getWidth() || vp.height() !== texture.getHeight()) {\n                    camera.detachAll();\n\n                    camera.attachTexture(__WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__["a" /* default */].COLOR_ATTACHMENT0, texture);\n                    camera.attachRenderBuffer(\n                        __WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__["a" /* default */].DEPTH_ATTACHMENT,\n                        __WEBPACK_IMPORTED_MODULE_8_osg_FrameBufferObject__["a" /* default */].DEPTH_COMPONENT16\n                    );\n                    camera.getViewport().setViewport(0, 0, texture.getWidth(), texture.getHeight());\n                }\n            }\n        },\n\n        updateShadowTechnique: function(nv) {\n            this.updateCameraClear();\n            var fbo = this._cameraClear.getFrameBufferObject();\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].updateShadowTechnique(nv, this._viewportDimension[i], fbo);\n            }\n        },\n\n        // internal texture allocation\n        // handle any change like resize, filter param, etc.\n        initTexture: function() {\n            if (!this._dirty) return;\n\n            if (!this._texture) {\n                this._texture = new __WEBPACK_IMPORTED_MODULE_5_osgShadow_ShadowTextureAtlas__["a" /* default */]();\n                this._textureUnit = this._textureUnitBase;\n            }\n\n            this._texture.setTextureSize(this._textureSize, this._textureSize);\n            this._texelSizeUniform.setFloat(1.0 / this._textureSize);\n            this._renderSize[0] = this._textureSize;\n            this._renderSize[1] = this._textureSize;\n\n            var textureFormat;\n            // luminance Float format ?\n            textureFormat = __WEBPACK_IMPORTED_MODULE_7_osg_Texture__["default"].RGBA;\n\n            __WEBPACK_IMPORTED_MODULE_6_osgShadow_ShadowMap__["a" /* default */].prototype.setTextureFiltering.call(this);\n            this._texture.setInternalFormat(textureFormat);\n\n            this._texture.setWrapS(__WEBPACK_IMPORTED_MODULE_7_osg_Texture__["default"].CLAMP_TO_EDGE);\n            this._texture.setWrapT(__WEBPACK_IMPORTED_MODULE_7_osg_Texture__["default"].CLAMP_TO_EDGE);\n\n            this._texture.dirty();\n        },\n\n        // Defines the frustum from light param.\n        //\n        cullShadowCasting: function(cullVisitor, bbox) {\n            this._cameraClear.accept(cullVisitor);\n\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                var shadowMap = this._shadowMaps[i];\n                if (shadowMap.isContinuousUpdate() || shadowMap.needRedraw()) {\n                    shadowMap.cullShadowCasting(cullVisitor, bbox);\n                }\n            }\n        },\n\n        isContinuousUpdate: function() {\n            // need at least one shadow to be enabled\n            // so that shadowedScene will continue shadowCasting\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                if (this._shadowMaps[i].isContinuousUpdate()) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        needRedraw: function() {\n            // need at least one shadow not dirty\n            // so that shadowedScene will continue shadowCasting\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                if (this._shadowMaps[i].needRedraw()) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        removeShadowMap: function(shadowMap) {\n            if (this._shadowMaps.length > 0) {\n                var idx = this._shadowMaps.indexOf(shadowMap);\n                if (idx !== -1) {\n                    if (this._shadowMaps[idx].valid()) {\n                        this._shadowMaps[idx].cleanSceneGraph(true);\n                    }\n                    this._shadowMaps.splice(idx, 1);\n\n                    var lightNumberArray = this._texture.getLightNumberArray();\n                    idx = lightNumberArray.indexOf(shadowMap.getLightNumber());\n                    if (idx !== -1) lightNumberArray.splice(idx, 1);\n\n                    var light = shadowMap.getLight();\n                    idx = this._lights.indexOf(light);\n                    if (idx !== -1) this._lights.splice(idx, 1);\n\n                    if (this._viewportDimension.length > idx) {\n                        this._viewportDimension.splice(idx, 1);\n                    }\n\n                    this.recomputeViewports();\n                }\n            }\n        },\n\n        addShadowMap: function(shadowMap) {\n            if (this._shadowMaps.length > 0) {\n                if (this._shadowMaps.indexOf(shadowMap) !== -1) return;\n            }\n\n            this._shadowMaps.push(shadowMap);\n\n            var light = shadowMap.getLight();\n            if (this._lights.indexOf(light) === -1) {\n                this._lights.push(light);\n            }\n\n            if (this._shadowedScene) shadowMap.setShadowedScene(this._shadowedScene);\n\n            var lightNumberArray = this._texture.getLightNumberArray();\n            if (lightNumberArray.indexOf(shadowMap.getLightNumber()) === -1) {\n                lightNumberArray.push(light.getLightNumber());\n            }\n\n            this.recomputeViewports();\n        },\n\n        cleanReceivingStateSet: function() {\n            if (this._receivingStateset) {\n                if (this._texture) {\n                    // remove this._texture, but not if it\'s not this._texture\n                    if (\n                        this._receivingStateset.getTextureAttribute(\n                            this._textureUnit,\n                            this._texture.getTypeMember()\n                        ) === this._texture\n                    )\n                        this._receivingStateset.removeTextureAttribute(\n                            this._textureUnit,\n                            this._texture.getTypeMember()\n                        );\n                }\n\n                for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                    this._shadowMaps[i].cleanReceivingStateSet();\n                }\n            }\n        },\n        cleanSceneGraph: function() {\n            // TODO: need state\n            //this._texture.releaseGLObjects();\n            //this._shadowReceiveAttribute = undefined;\n            this._texture = undefined;\n            this._shadowedScene = undefined;\n        },\n        setDebug: function(enable, lightNum) {\n            if (!lightNum) {\n                for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                    this._shadowMaps[i].setDebug(enable);\n                }\n            } else {\n                this._shadowMaps[lightNum].setDebug(enable);\n            }\n        },\n        markSceneAsNoShadow: function() {\n            for (var i = 0, l = this._shadowMaps.length; i < l; i++) {\n                this._shadowMaps[i].markSceneAsNoShadow();\n            }\n        }\n    }),\n    \'osgShadow\',\n    \'ShadowMapAtlas\'\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ShadowMapAtlas);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowMapAtlas.js\n// module id = 253\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowMapAtlas.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Texture__ = __webpack_require__(7);\n\n\n\nvar kernelSizeList = [\n    '1Tap(4texFetch)',\n    '4Tap(16texFetch)',\n    '9Tap(36texFetch)',\n    '16Tap(64texFetch)'\n];\n\n/**\n *  ShadowSettings provides the parameters that the ShadowTechnique should use as a guide for setting up shadowing\n *  @class ShadowSettings\n */\nvar ShadowSettings = function(options) {\n    this.castsShadowDrawTraversalMask = 0xffffffff;\n    this.castsShadowBoundsTraversalMask = 0xffffffff;\n\n    this.textureSize = 1024;\n\n    // important note:\n    // comparison shadow is: DepthShadow > DephFragment => shadowed\n    // which is d<z\n    // and\n    // Average( (d < z) ) != (Average( z ) < d)\n    // so PCF/NONE technique cannot be prefiltered (bilinear, etc..) with HW filter\n    // on gl/dx desktop there is a sampler2DShadow that allows that taking z in third param\n    // we emulate that with texture2DShadowLerp\n    // which is why some techniques have more texfetch than advertized.\n    // http://http.developer.nvidia.com/GPUGems/gpugems_ch11.html\n\n    // texture precision. (and bandwith implication)\n    this.textureType = 'UNSIGNED_BYTE';\n\n    this.textureFormat = __WEBPACK_IMPORTED_MODULE_1_osg_Texture__[\"default\"].RGBA;\n\n    // either orthogonal (non-fov) or perpsective (fov)\n    this.shadowProjection = 'fov';\n    // fov size: can be infered from spotlight angle\n    this.fov = 50;\n\n    // PCF algo and kernel size\n    // Band kernelsize gives nxn texFetch\n    // others a n*n*4 (emulating the HW shadowSampler)\n    // ['4Tap(16texFetch)', '9Tap(36texFetch)', '16Tap(64texFetch)']\n    this.kernelSizePCF = '4Tap(4texFetch)';\n\n    // depth offset (shadow acne / peter panning)\n    this.bias = 0.005;\n\n    // normal exploding offset (shadow acne / peter panning)\n    this.normalBias = undefined;\n\n    // defaut shader generator name for shadow casting\n    this.shadowCastShaderGeneratorName = 'ShadowCast';\n\n    // if url options override url options\n    __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectMix(this, options);\n};\n\nShadowSettings.kernelSizeList = kernelSizeList;\n\nShadowSettings.prototype = {\n    setCastsShadowDrawTraversalMask: function(mask) {\n        this.castsShadowDrawTraversalMask = mask;\n    },\n    getCastsShadowDrawTraversalMask: function() {\n        return this.castsDrawShadowTraversalMask;\n    },\n\n    setCastsShadowBoundsTraversalMask: function(mask) {\n        this.castsShadowBoundsTraversalMask = mask;\n    },\n    getCastsShadowBoundsTraversalMask: function() {\n        return this.castsShadowBoundsTraversalMask;\n    },\n\n    setLight: function(light) {\n        this.light = light;\n    },\n    getLight: function() {\n        return this.light;\n    },\n\n    setTextureSize: function(textureSize) {\n        this.textureSize = textureSize;\n    },\n    getTextureSize: function() {\n        return this.textureSize;\n    },\n    setTextureType: function(tt) {\n        this.textureType = tt;\n    },\n    getTextureType: function() {\n        return this.textureType;\n    },\n    setTextureFormat: function(tf) {\n        this.textureFormat = tf;\n    },\n    getTextureFormat: function() {\n        return this.textureFormat;\n    },\n    setShadowCastShaderGeneratorName: function(n) {\n        this.shadowCastShaderGeneratorName = n;\n    },\n    getShadowCastShaderGeneratorName: function() {\n        return this.shadowCastShaderGeneratorName;\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ShadowSettings);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowSettings.js\n// module id = 254\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowSettings.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_CullVisitor__ = __webpack_require__(51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Node__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osg_StateSet__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osg_ComputeBoundsVisitor__ = __webpack_require__(58);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgShadow_ShadowCasterVisitor__ = __webpack_require__(169);\n\n\n\n\n\n\n\n\n\n\n/**\n *  ShadowedScene provides a mechanism for decorating a scene that the needs to have shadows cast upon it.\n *  @class ShadowedScene\n *  @{@link [http://trac.openscenegraph.org/projects/osg//wiki/Support/ProgrammingGuide/osgShadow]}\n *  @{@link [http://developer.download.nvidia.com/presentations/2008/GDC/GDC08_SoftShadowMapping.pdf]};\n */\nvar ShadowedScene = function(settings) {\n    __WEBPACK_IMPORTED_MODULE_2_osg_Node__["a" /* default */].call(this);\n\n    // TODO: all  techniques (stencil/projTex/map/vol)\n    this._shadowTechniques = [];\n\n    this._optimizedFrustum = false;\n\n    this._frustumReceivers = [\n        __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create(),\n        __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["g" /* vec4 */].create()\n    ];\n\n    this._tmpMat = __WEBPACK_IMPORTED_MODULE_1_osg_glMatrix__["c" /* mat4 */].create();\n\n    this._receivingStateset = new __WEBPACK_IMPORTED_MODULE_4_osg_StateSet__["a" /* default */]();\n\n    this._computeBoundsVisitor = new __WEBPACK_IMPORTED_MODULE_6_osg_ComputeBoundsVisitor__["default"]();\n\n    this._castsShadowDrawTraversalMask = 0xffffffff;\n    this._castsShadowBoundsTraversalMask = 0xffffffff;\n    if (settings) this.setShadowSettings(settings);\n};\n\n/** @lends ShadowedScene.prototype */\n__WEBPACK_IMPORTED_MODULE_5_osg_utils__["a" /* default */].createPrototypeNode(\n    ShadowedScene,\n    __WEBPACK_IMPORTED_MODULE_5_osg_utils__["a" /* default */].objectInherit(__WEBPACK_IMPORTED_MODULE_2_osg_Node__["a" /* default */].prototype, {\n        getReceivingStateSet: function() {\n            return this._receivingStateset;\n        },\n\n        getShadowTechniques: function() {\n            return this._shadowTechniques;\n        },\n\n        addShadowTechnique: function(technique) {\n            if (this._shadowTechniques.length > 0) {\n                if (this._shadowTechniques.indexOf(technique) !== -1) return;\n            }\n\n            this._shadowTechniques.push(technique);\n\n            if (technique.valid()) {\n                technique.setShadowedScene(this);\n                technique.dirty();\n            }\n        },\n        removeShadowTechnique: function(technique) {\n            if (this._shadowTechniques.length > 0) {\n                var idx = this._shadowTechniques.indexOf(technique);\n                if (idx !== -1) {\n                    if (this._shadowTechniques[idx].valid()) {\n                        this._shadowTechniques[idx].cleanSceneGraph();\n                    }\n                    this._shadowTechniques.splice(idx, 1);\n                }\n            }\n        },\n        /** Clean scene graph from any shadow technique specific nodes, state and drawables.*/\n        cleanSceneGraph: function() {\n            for (var i = 0, lt = this._shadowTechniques.length; i < lt; i++) {\n                if (this._shadowTechniques[i] && this._shadowTechniques[i].valid()) {\n                    this._shadowTechniques[i].cleanSceneGraph();\n                }\n            }\n        },\n\n        /** Dirty any cache data structures held in the attached ShadowTechnique.*/\n        dirty: function() {\n            for (var i = 0; i < this._shadowTechniques.length; i++)\n                this._shadowTechniques[i].dirty();\n        },\n\n        nodeTraverse: function(nv) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_Node__["a" /* default */].prototype.traverse.call(this, nv);\n        },\n\n        setShadowSettings: function(shadowSettings) {\n            this._settings = shadowSettings;\n\n            this.setCastsShadowDrawTraversalMask(shadowSettings.castsShadowDrawTraversalMask);\n            this.setCastsShadowBoundsTraversalMask(shadowSettings.castsShadowBoundsTraversalMask);\n\n            // Overridable Visitor so that user can override the visitor to enable disable\n            // in its own shadowmap implementation\n            // settings.userShadowCasterVisitor:\n            // - undefined means using default\n            // - false means no removal visitor needed\n            // - otherwise must be an instance of a class inherited from shadowCaster\n            if (shadowSettings.userShadowCasterVisitor !== false) {\n                this._removeNodesNeverCastingVisitor =\n                    shadowSettings.userShadowCasterVisitor ||\n                    new __WEBPACK_IMPORTED_MODULE_7_osgShadow_ShadowCasterVisitor__["a" /* default */](this._castsShadowTraversalMask);\n            }\n        },\n\n        setCastsShadowDrawTraversalMask: function(mask) {\n            this._castsShadowDrawTraversalMask = mask;\n        },\n\n        getCastsShadowDrawTraversalMask: function() {\n            return this._castsDrawShadowTraversalMask;\n        },\n\n        setCastsShadowBoundsTraversalMask: function(mask) {\n            this._castsShadowBoundsTraversalMask = mask;\n        },\n\n        getCastsShadowBoundsTraversalMask: function() {\n            return this._castsShadowBoundsTraversalMask;\n        },\n\n        computeShadowedSceneBounds: function() {\n            if (this._removeNodesNeverCastingVisitor) {\n                this._removeNodesNeverCastingVisitor.setNoCastMask(\n                    ~(this._castsShadowBoundsTraversalMask | this._castsShadowDrawTraversalMask)\n                );\n                this._removeNodesNeverCastingVisitor.reset();\n                this.accept(this._removeNodesNeverCastingVisitor);\n            }\n\n            this._computeBoundsVisitor.setTraversalMask(this._castsShadowBoundsTraversalMask);\n            this._computeBoundsVisitor.reset();\n            this.accept(this._computeBoundsVisitor);\n            var bbox = this._computeBoundsVisitor.getBoundingBox();\n\n            if (!bbox.valid()) {\n                // nothing to draw Early out.\n                if (this._removeNodesNeverCastingVisitor) {\n                    // remove our flags changes on any bitmask\n                    // not to break things\n                    this._removeNodesNeverCastingVisitor.restore();\n                }\n\n                return false;\n            }\n\n            return true;\n        },\n\n        traverse: function(nv) {\n            // update the scene\n            if (nv.getVisitorType() === __WEBPACK_IMPORTED_MODULE_3_osg_NodeVisitor__["a" /* default */].CULL_VISITOR) {\n                var i,\n                    st,\n                    lt = this._shadowTechniques.length;\n\n                // cull Shadowed Scene\n                if (lt) nv.pushStateSet(this._receivingStateset);\n                this.nodeTraverse(nv);\n                if (lt) nv.popStateSet();\n\n                var isDirty = false;\n                for (i = 0; i < lt; i++) {\n                    st = this._shadowTechniques[i];\n\n                    // dirty check for user playing with shadows inside update traverse\n                    if (!st || !st.valid()) continue;\n\n                    if (st.isDirty()) {\n                        isDirty = true;\n                        st.init();\n                    }\n\n                    if (st.isContinuousUpdate() || st.needRedraw()) isDirty = true;\n                }\n                if (!isDirty) return;\n\n                var hasCastingScene = this.computeShadowedSceneBounds(nv);\n                if (!hasCastingScene) {\n                    // no shadow but still may need to clear\n                    // and makes sure shadow receiver shader\n                    // uses optimized early out codepath\n                    for (i = 0; i < lt; i++) {\n                        st = this._shadowTechniques[i];\n                        st.markSceneAsNoShadow();\n                    }\n\n                    return;\n                }\n                var bbox = this._computeBoundsVisitor.getBoundingBox();\n\n                // HERE we get the shadowedScene Current World Matrix\n                // to get any world transform ABOVE the shadowedScene\n                var worldMatrix = nv.getCurrentModelMatrix();\n                bbox.transformMat4(bbox, worldMatrix);\n\n                // cull Casters\n                for (i = 0; i < lt; i++) {\n                    st = this._shadowTechniques[i];\n                    if (st.isContinuousUpdate() || st.needRedraw()) {\n                        st.updateShadowTechnique(nv);\n                        st.cullShadowCasting(nv, bbox);\n                    }\n                }\n\n                if (this._removeNodesNeverCastingVisitor) {\n                    // remove our flags changes on any bitmask\n                    // not to break things\n                    this._removeNodesNeverCastingVisitor.restore();\n                }\n            } else {\n                this.nodeTraverse(nv);\n            }\n        }\n    }),\n    \'osgShadow\',\n    \'ShadowedScene\'\n);\n\n// same code like Node\n__WEBPACK_IMPORTED_MODULE_0_osg_CullVisitor__["a" /* default */].registerApplyFunction(\n    ShadowedScene.nodeTypeID,\n    __WEBPACK_IMPORTED_MODULE_0_osg_CullVisitor__["a" /* default */].getApplyFunction(__WEBPACK_IMPORTED_MODULE_2_osg_Node__["a" /* default */].nodeTypeID)\n);\n\n/* harmony default export */ __webpack_exports__["a"] = (ShadowedScene);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgShadow/ShadowedScene.js\n// module id = 255\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgShadow/ShadowedScene.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgStats_Stats__ = __webpack_require__(161);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgStats_BufferStats__ = __webpack_require__(162);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgStats_Graph__ = __webpack_require__(98);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgStats_TextGenerator__ = __webpack_require__(164);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgStats_Counter__ = __webpack_require__(163);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgStats_defaultStats__ = __webpack_require__(165);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgStats_browserStats__ = __webpack_require__(167);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgStats_glStats__ = __webpack_require__(166);\n\n\n\n\n\n\n\n\n\nvar osgStats = {\n    Stats: __WEBPACK_IMPORTED_MODULE_0_osgStats_Stats__["a" /* default */],\n    BufferStats: __WEBPACK_IMPORTED_MODULE_1_osgStats_BufferStats__["a" /* default */],\n    Graph: __WEBPACK_IMPORTED_MODULE_2_osgStats_Graph__["a" /* default */],\n    TextGenerator: __WEBPACK_IMPORTED_MODULE_3_osgStats_TextGenerator__["a" /* default */],\n    Counter: __WEBPACK_IMPORTED_MODULE_4_osgStats_Counter__["a" /* default */],\n    defaultStats: __WEBPACK_IMPORTED_MODULE_5_osgStats_defaultStats__["a" /* default */],\n    browserStats: __WEBPACK_IMPORTED_MODULE_6_osgStats_browserStats__["a" /* default */],\n    glStats: __WEBPACK_IMPORTED_MODULE_7_osgStats_glStats__["a" /* default */]\n};\n\n/* harmony default export */ __webpack_exports__["a"] = (osgStats);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgStats/osgStats.js\n// module id = 256\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgStats/osgStats.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgText_Text__ = __webpack_require__(136);\n\n\nvar osgText = {};\nosgText.Text = __WEBPACK_IMPORTED_MODULE_0_osgText_Text__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (osgText);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgText/osgText.js\n// module id = 257\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgText/osgText.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgWrappers_serializers_osg__ = __webpack_require__(66);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgWrappers_serializers_osgAnimation__ = __webpack_require__(134);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgWrappers_serializers_osgText__ = __webpack_require__(135);\n\n\n\n\nvar osgWrappers = {};\n\nosgWrappers.osg = __WEBPACK_IMPORTED_MODULE_0_osgWrappers_serializers_osg__["a" /* default */];\nosgWrappers.osgAnimation = __WEBPACK_IMPORTED_MODULE_1_osgWrappers_serializers_osgAnimation__["a" /* default */];\nosgWrappers.osgText = __WEBPACK_IMPORTED_MODULE_2_osgWrappers_serializers_osgText__["a" /* default */];\n\n/* harmony default export */ __webpack_exports__["a"] = (osgWrappers);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgWrappers/osgWrappers.js\n// module id = 258\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgWrappers/osgWrappers.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osgPlugins_ReaderWriterGLTF__ = __webpack_require__(260);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgPlugins_ReaderWriterZIP__ = __webpack_require__(261);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgPlugins_ReaderWriterZZP__ = __webpack_require__(262);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgPlugins_ReaderWriterKML__ = __webpack_require__(263);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgPlugins_ReaderWriterDDS__ = __webpack_require__(265);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgPlugins_ReaderWriterKTX__ = __webpack_require__(266);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgPlugins_ReaderWriterPVR__ = __webpack_require__(267);\n\n\n\n// $$ SOURCE_CODE_MODIFIED\n\n\n\n\n\n// $$ SOURCE_CODE_MODIFIED\n\nvar osgPlugins = {};\n\nosgPlugins.ReaderWriterGLTF = __WEBPACK_IMPORTED_MODULE_0_osgPlugins_ReaderWriterGLTF__["a" /* default */];\nosgPlugins.ReaderWriterZIP = __WEBPACK_IMPORTED_MODULE_1_osgPlugins_ReaderWriterZIP__["a" /* default */];\n\n// $$ SOURCE_CODE_MODIFIED\nosgPlugins.ReaderWriterZZP = __WEBPACK_IMPORTED_MODULE_2_osgPlugins_ReaderWriterZZP__["a" /* default */];\nosgPlugins.ReaderWriterKML = __WEBPACK_IMPORTED_MODULE_3_osgPlugins_ReaderWriterKML__["a" /* default */];\nosgPlugins.ReaderWriterDDS = __WEBPACK_IMPORTED_MODULE_4_osgPlugins_ReaderWriterDDS__["a" /* default */];\nosgPlugins.ReaderWriterKTX = __WEBPACK_IMPORTED_MODULE_5_osgPlugins_ReaderWriterKTX__["a" /* default */];\nosgPlugins.ReaderWriterPVR = __WEBPACK_IMPORTED_MODULE_6_osgPlugins_ReaderWriterPVR__["a" /* default */];\n// $$ SOURCE_CODE_MODIFIED\n\n/* harmony default export */ __webpack_exports__["a"] = (osgPlugins);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/osgPlugins.js\n// module id = 259\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/osgPlugins.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgDB_requestFile__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_Input__ = __webpack_require__(40);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgAnimation_animation__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgAnimation_BasicAnimationManager__ = __webpack_require__(125);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_osgAnimation_Skeleton__ = __webpack_require__(62);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_osgAnimation_Bone__ = __webpack_require__(44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_osgAnimation_StackedTranslate__ = __webpack_require__(130);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_osgAnimation_StackedQuaternion__ = __webpack_require__(129);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_osgAnimation_StackedScale__ = __webpack_require__(89);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_osgAnimation_RigGeometry__ = __webpack_require__(45);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_osgAnimation_channel__ = __webpack_require__(46);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_osg_BlendFunc__ = __webpack_require__(30);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_osg_Geometry__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16_osg_MatrixTransform__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17_osg_Material__ = __webpack_require__(86);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18_osg_DrawElements__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19_osg_primitiveSet__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20_osg_BufferArray__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21_osgAnimation_UpdateBone__ = __webpack_require__(84);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22_osgAnimation_UpdateMatrixTransform__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23_osgDB_FileHelper__ = __webpack_require__(67);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__ = __webpack_require__(1);\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar createQuatChannel = __WEBPACK_IMPORTED_MODULE_12_osgAnimation_channel__["a" /* default */].createQuatChannel;\nvar createVec3Channel = __WEBPACK_IMPORTED_MODULE_12_osgAnimation_channel__["a" /* default */].createVec3Channel;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar ReaderWriterGLTF = function() {\n    // Contains all the needed glTF files (.gltf, .bin, etc...)\n    this._filesMap = undefined;\n    this._loadedFiles = undefined;\n    this._bufferViewCache = undefined;\n    this._basicAnimationManager = undefined;\n    this._visitedNodes = undefined;\n    this._animatedNodes = undefined;\n    this._skeletons = undefined;\n    this._bones = undefined;\n    this._skeletonToInfluenceMap = undefined;\n    this._inputImgReader = undefined;\n    this._localPath = \'\';\n\n    this.init();\n};\n\nReaderWriterGLTF.WEBGL_COMPONENT_TYPES = {\n    5120: Int8Array,\n    5121: Uint8Array,\n    5122: Int16Array,\n    5123: Uint16Array,\n    5125: Uint32Array,\n    5126: Float32Array\n};\n\nReaderWriterGLTF.TYPE_TABLE = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16\n};\n\nReaderWriterGLTF.TEXTURE_FORMAT = {\n    6406: __WEBPACK_IMPORTED_MODULE_15_osg_Texture__["default"].ALPHA,\n    6407: __WEBPACK_IMPORTED_MODULE_15_osg_Texture__["default"].RGB,\n    6408: __WEBPACK_IMPORTED_MODULE_15_osg_Texture__["default"].RGBA,\n    6409: __WEBPACK_IMPORTED_MODULE_15_osg_Texture__["default"].LUMINANCE,\n    6410: __WEBPACK_IMPORTED_MODULE_15_osg_Texture__["default"].LUMINANCE_ALPHA\n};\n\nReaderWriterGLTF.PBR_SPEC_EXT = \'KHR_materials_pbrSpecularGlossiness\';\nReaderWriterGLTF.PBR_SPEC_MODE = \'PBR_specular_glossiness\';\nReaderWriterGLTF.PBR_METAL_MODE = \'PBR_metal_roughness\';\n\nReaderWriterGLTF.ALBEDO_TEXTURE_UNIT = 2;\nReaderWriterGLTF.DIFFUSE_TEXTURE_UNIT = 2;\nReaderWriterGLTF.SPECULAR_GLOSSINESS_TEXTURE_UNIT = 3;\nReaderWriterGLTF.METALLIC_ROUGHNESS_TEXTURE_UNIT = 3;\nReaderWriterGLTF.SPECULAR_TEXTURE_UNIT = 4;\nReaderWriterGLTF.NORMAL_TEXTURE_UNIT = 5;\nReaderWriterGLTF.AO_TEXTURE_UNIT = 6;\nReaderWriterGLTF.EMISSIVE_TEXTURE_UNIT = 7;\n\nReaderWriterGLTF.ALBEDO_UNIFORM = \'albedoMap\';\nReaderWriterGLTF.METALLIC_ROUGHNESS_UNIFORM = \'metallicRoughnessMap\';\nReaderWriterGLTF.SPECULAR_UNIFORM = \'specularMap\';\nReaderWriterGLTF.NORMAL_UNIFORM = \'normalMap\';\nReaderWriterGLTF.AO_UNIFORM = \'aoMap\';\nReaderWriterGLTF.EMISSIVE_UNIFORM = \'emissiveMap\';\n\nReaderWriterGLTF.prototype = {\n    init: function() {\n        this._glTFJSON = undefined;\n        this._bufferViewCache = {};\n        this._basicAnimationManager = undefined;\n        this._localPath = \'\';\n        this._visitedNodes = {};\n        this._animatedNodes = {};\n        this._skeletons = {};\n        this._bones = {};\n        this._skeletonToInfluenceMap = {};\n        this._stateSetMap = {};\n        this._filesMap = new window.Map();\n        this._inputReader = new __WEBPACK_IMPORTED_MODULE_2_osgDB_Input__["default"]();\n    },\n\n    loadFile: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(uri) {\n        if (this._filesMap.has(uri)) return this._filesMap.get(uri);\n\n        var ext = uri.substr(uri.lastIndexOf(\'.\') + 1);\n        var fileType = __WEBPACK_IMPORTED_MODULE_23_osgDB_FileHelper__["a" /* default */].getTypeForExtension(ext);\n\n        var promiseFile;\n        var url = this._localPath + uri;\n        if (fileType === \'blob\') {\n            promiseFile = this._inputReader.readImageURL(url, {\n                imageLoadingUsePromise: true\n            });\n        } else if (fileType === \'arraybuffer\') {\n            promiseFile = this._inputReader.readBinaryArrayURL(url, {\n                fileType: fileType\n            });\n        }\n\n        this._filesMap.set(uri, promiseFile);\n\n        promiseFile.then(function(file) {\n            return file;\n        });\n        return promiseFile;\n    }),\n\n    /**\n     * Loads a osg.BufferArray from a TypeArray obtained by using a glTF accessor.\n     * No memory allocation is done, the result is a subarray obtained from a glTF binary file\n     * @param  {Object} accessor\n     * @param  {osg.BufferArray.ARRAY_BUFFER | osg.BufferArray.ELEMENT_ARRAY_BUFFER} type WebGL buffer type\n     * @param  {TypedArray} BufferType specific TypedArray type used for extraction\n     * @return {osg.BufferArray} OSG readable buffer contaning the extracted data\n     */\n    loadAccessorBuffer: function(accessor, type) {\n        var json = this._glTFJSON;\n        var bufferView = json.bufferViews[accessor.bufferView];\n        var buffer = json.buffers[bufferView.buffer];\n        var filePromise = this.loadFile(buffer.uri);\n        var self = this;\n        return filePromise.then(function(data) {\n            return self.assignBuffers(data, accessor, type, bufferView);\n        });\n    },\n\n    assignBuffers: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(data, accessor, type, bufferView) {\n        if (!data) return null;\n\n        var TypedArray = ReaderWriterGLTF.WEBGL_COMPONENT_TYPES[accessor.componentType];\n        var typedArray = null;\n\n        if (!this._bufferViewCache[accessor.bufferView])\n            this._bufferViewCache[accessor.bufferView] = data.slice(\n                bufferView.byteOffset,\n                bufferView.byteOffset + bufferView.byteLength\n            );\n\n        var bufferViewArray = this._bufferViewCache[accessor.bufferView];\n        typedArray = new TypedArray(\n            bufferViewArray,\n            accessor.byteOffset,\n            accessor.count * ReaderWriterGLTF.TYPE_TABLE[accessor.type]\n        );\n\n        if (type)\n            return new __WEBPACK_IMPORTED_MODULE_20_osg_BufferArray__["a" /* default */](\n                type,\n                typedArray,\n                ReaderWriterGLTF.TYPE_TABLE[accessor.type],\n                true\n            );\n        return typedArray;\n    }),\n\n    findByKey: function(obj, key) {\n        return obj && obj[key];\n    },\n\n    registerUpdateCallback: function(callbackName, node) {\n        var json = this._glTFJSON;\n\n        var animationCallback = null;\n        if (json.nodes[callbackName].jointName) animationCallback = new __WEBPACK_IMPORTED_MODULE_21_osgAnimation_UpdateBone__["a" /* default */]();\n        else animationCallback = new __WEBPACK_IMPORTED_MODULE_22_osgAnimation_UpdateMatrixTransform__["a" /* default */]();\n\n        animationCallback.setName(callbackName);\n\n        var translation = __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["f" /* vec3 */].create();\n        __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].getTranslation(translation, node.getMatrix());\n\n        var rotationQuat = __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["d" /* quat */].create();\n        __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].getRotation(rotationQuat, node.getMatrix());\n\n        var scale = __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["f" /* vec3 */].create();\n        __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].getScale(scale, node.getMatrix());\n\n        animationCallback\n            .getStackedTransforms()\n            .push(new __WEBPACK_IMPORTED_MODULE_8_osgAnimation_StackedTranslate__["a" /* default */](\'translation\', translation));\n        animationCallback\n            .getStackedTransforms()\n            .push(new __WEBPACK_IMPORTED_MODULE_9_osgAnimation_StackedQuaternion__["a" /* default */](\'rotation\', rotationQuat));\n        animationCallback.getStackedTransforms().push(new __WEBPACK_IMPORTED_MODULE_10_osgAnimation_StackedScale__["a" /* default */](\'scale\', scale));\n\n        node.addUpdateCallback(animationCallback);\n    },\n\n    createTextureAndSetAttrib: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(glTFTextureObject, stateSet, location, uniform) {\n        if (!glTFTextureObject) return;\n        var json = this._glTFJSON;\n        var glTFTexture = json.textures[glTFTextureObject.index];\n        if (!glTFTexture) return;\n\n        var image = json.images[glTFTexture.source];\n\n        if (!image) return;\n        var texture = new __WEBPACK_IMPORTED_MODULE_15_osg_Texture__["default"]();\n        // GLTF texture origin is correct\n        texture.setFlipY(false);\n        texture.setWrapS(\'REPEAT\');\n        texture.setWrapT(\'REPEAT\');\n\n        this.loadFile(image.uri).then(function(data) {\n            if (!data) return;\n            texture.setImage(data, ReaderWriterGLTF.TEXTURE_FORMAT[glTFTexture.format]);\n            stateSet.setTextureAttributeAndModes(location, texture);\n            if (uniform) {\n                stateSet.addUniform(__WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createInt(location, uniform));\n            }\n            return;\n        });\n    }),\n\n    /**\n     * Creates a MatrixTransform node by using\n     * glTF node\'s properties (matrix, translation, rotation, scale)\n     * @param  {Object} glTFNode glTF node\n     * @return {OSG.MatrixTransform} MatrixTransform node containing the glTF node transform\n     */\n    loadTransform: function(glTFNode) {\n        var mat = __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].create();\n        // The transform is given under a matrix form\n        if (glTFNode.matrix) {\n            __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].copy(mat, glTFNode.matrix);\n            return mat;\n        }\n        // The transform is given under the form\n        // translation, rotation, scale\n        var scale = glTFNode.scale || __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["f" /* vec3 */].ONE;\n        var rot = glTFNode.rotation || __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["d" /* quat */].IDENTITY;\n        var trans = glTFNode.translation || __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["f" /* vec3 */].ZERO;\n\n        __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].fromRotationTranslationScale(mat, rot, trans, scale);\n        return mat;\n    },\n\n    preprocessChannel: function(glTFChannel, glTFAnim) {\n        var json = this._glTFJSON;\n        var promisesArray = [];\n\n        var glTFSampler = glTFAnim.samplers[glTFChannel.sampler];\n\n        var timeAccessor = json.accessors[glTFSampler.input];\n        var valueAccessor = json.accessors[glTFSampler.output];\n\n        var timePromise = this.loadAccessorBuffer(timeAccessor, null);\n        var valuePromise = this.loadAccessorBuffer(valueAccessor, null);\n\n        promisesArray.push(timePromise, valuePromise);\n\n        var self = this;\n\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promisesArray).then(function(timeAndValue) {\n            var timeKeys = timeAndValue[0];\n            var valueKeys = timeAndValue[1];\n\n            var osgChannel = null;\n\n            if (ReaderWriterGLTF.TYPE_TABLE[valueAccessor.type] === 4) {\n                osgChannel = createQuatChannel(\n                    valueKeys,\n                    timeKeys,\n                    glTFChannel.target.node,\n                    glTFChannel.target.path,\n                    null\n                );\n            } else if (ReaderWriterGLTF.TYPE_TABLE[valueAccessor.type] === 3) {\n                osgChannel = createVec3Channel(\n                    valueKeys,\n                    timeKeys,\n                    glTFChannel.target.node,\n                    glTFChannel.target.path,\n                    null\n                );\n            }\n\n            self._animatedNodes[glTFChannel.target.node] = true;\n\n            return osgChannel;\n        });\n    },\n\n    createAnimationFromChannels: function(channelsPromiseArray, animName) {\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(channelsPromiseArray).then(function(channels) {\n            return __WEBPACK_IMPORTED_MODULE_4_osgAnimation_animation__["a" /* default */].createAnimation(channels, animName);\n        });\n    },\n\n    /**\n     * Loads all the solid animations registering\n     * them in a BasicAnimationManager instance\n     * @return {BasicAnimationManager} the animation manager containing the animations\n     */\n    preprocessAnimations: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function() {\n        var json = this._glTFJSON;\n\n        if (!json.animations) return;\n\n        var animPromiseArray = [];\n\n        var animationsObjectKeys = window.Object.keys(json.animations);\n        for (var i = 0; i < animationsObjectKeys.length; ++i) {\n            var glTFAnim = json.animations[animationsObjectKeys[i]];\n\n            var channelsPromiseArray = [];\n            // Creates each OSGJS channel\n            for (var j = 0; j < glTFAnim.channels.length; ++j) {\n                var glTFChannel = glTFAnim.channels[j];\n\n                var osgChannel = this.preprocessChannel(glTFChannel, glTFAnim);\n                channelsPromiseArray.push(osgChannel);\n            }\n\n            var animPromise = this.createAnimationFromChannels(\n                channelsPromiseArray,\n                animationsObjectKeys[i]\n            );\n            animPromiseArray.push(animPromise);\n        }\n\n        var self = this;\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(animPromiseArray).then(function(animations) {\n            var animationManager = new __WEBPACK_IMPORTED_MODULE_5_osgAnimation_BasicAnimationManager__["a" /* default */]();\n            animationManager.init(animations);\n\n            self._basicAnimationManager = animationManager;\n            animationManager.playAnimation(animations[0].name);\n        });\n    }),\n\n    loadBone: function(boneId, skin) {\n        var json = this._glTFJSON;\n        var node = json.nodes[boneId];\n\n        var self = this;\n\n        var inverseBindMatricesAccessor = json.accessors[skin.inverseBindMatrices];\n        var bonePromise = this.loadAccessorBuffer(inverseBindMatricesAccessor, null);\n        return bonePromise.then(function(data) {\n            // Creates the current bone\n            // initializing it with initial pose\n            for (var i = 0; i < skin.joints.length; ++i) {\n                if (skin.joints[i] === node.jointName) break;\n            }\n\n            var boneNode = new __WEBPACK_IMPORTED_MODULE_7_osgAnimation_Bone__["a" /* default */](node.jointName);\n            var invMat = data.subarray(i * 16, i * 16 + 16);\n            boneNode.setInvBindMatrixInSkeletonSpace(invMat);\n\n            self._bones[boneId] = boneNode;\n\n            return boneNode;\n        });\n    },\n\n    buildInfluenceMap: function(rootBoneId, skin) {\n        if (this._skeletonToInfluenceMap[rootBoneId]) return;\n        this._skeletonToInfluenceMap[rootBoneId] = {};\n        for (var j = 0; j < skin.joints.length; j++) {\n            var jointName = skin.joints[j];\n            this._skeletonToInfluenceMap[rootBoneId][jointName] = j;\n        }\n    },\n\n    mapBonesToSkin: function() {\n        var json = this._glTFJSON;\n\n        var boneToSkin = {};\n\n        // Maps each bone ID to its skin\n        var skinsKeys = window.Object.keys(json.skins);\n        for (var i = 0; i < skinsKeys.length; ++i) {\n            var skin = json.skins[skinsKeys[i]];\n\n            for (var j = 0; j < skin.joints.length; ++j) {\n                var jName = skin.joints[j];\n\n                var nodesKeys = window.Object.keys(json.nodes);\n                for (var k = 0; k < nodesKeys.length; ++k) {\n                    var node = json.nodes[nodesKeys[k]];\n\n                    if (node.jointName && node.jointName === jName) boneToSkin[nodesKeys[k]] = skin;\n                }\n            }\n        }\n\n        return boneToSkin;\n    },\n\n    preprocessBones: function(bonesToSkin) {\n        var json = this._glTFJSON;\n        var nodesKeys = window.Object.keys(json.nodes);\n        var promises = [];\n        for (var i = 0; i < nodesKeys.length; ++i) {\n            var boneId = nodesKeys[i];\n            var boneNode = json.nodes[boneId];\n            if (!boneNode.jointName) continue;\n            var bonePromise = this.loadBone(boneId, bonesToSkin[boneId]);\n            promises.push(bonePromise);\n        }\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promises);\n    },\n\n    preprocessSkeletons: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function() {\n        var json = this._glTFJSON;\n        if (!json.skins) return;\n        var bonesToSkin = this.mapBonesToSkin();\n\n        // Saves each skeleton in the skeleton maprep\n        var nodesKeys = window.Object.keys(json.nodes);\n        for (var j = 0; j < nodesKeys.length; ++j) {\n            var nodeId = nodesKeys[j];\n            var node = json.nodes[nodeId];\n            var skin = json.skins[node.skin];\n\n            if (!node.skeletons) continue;\n\n            for (var i = 0; i < node.skeletons.length; ++i) {\n                var rootBoneId = null;\n                var rootJointId = node.skeletons[i];\n                for (var k = 0; k < nodesKeys.length; ++k) {\n                    var subnodeId = nodesKeys[k];\n                    var subnode = json.nodes[subnodeId];\n                    if (!subnode.jointName) continue;\n                    var rootJoint = json.nodes[rootJointId];\n                    if (subnode.jointName === rootJoint.jointName) {\n                        rootBoneId = subnodeId;\n                        break;\n                    }\n                }\n                if (rootBoneId && !this._skeletons[rootBoneId]) {\n                    this._skeletons[rootJointId] = new __WEBPACK_IMPORTED_MODULE_6_osgAnimation_Skeleton__["a" /* default */]();\n                    // Adds missing bone to the boneMap\n                    bonesToSkin[rootBoneId] = skin;\n                }\n                this.buildInfluenceMap(rootJointId, skin);\n            }\n        }\n\n        return this.preprocessBones(bonesToSkin);\n    }),\n\n    loadPBRMaterial: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(materialId, glTFmaterial, geometryNode, extension) {\n        var pbrMetallicRoughness = glTFmaterial.pbrMetallicRoughness;\n        var osgStateSet = geometryNode.getOrCreateStateSet();\n\n        var promises = [];\n        var model = \'\';\n\n        if (pbrMetallicRoughness) {\n            if (pbrMetallicRoughness.baseColorTexture)\n                promises.push(\n                    this.createTextureAndSetAttrib(\n                        pbrMetallicRoughness.baseColorTexture,\n                        osgStateSet,\n                        ReaderWriterGLTF.ALBEDO_TEXTURE_UNIT,\n                        ReaderWriterGLTF.ALBEDO_UNIFORM\n                    )\n                );\n            if (pbrMetallicRoughness.baseColorFactor) {\n                //PBR default uniforms\n                osgStateSet.addUniform(\n                    __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat4(pbrMetallicRoughness.baseColorFactor, \'uBaseColorFactor\')\n                );\n            }\n\n            if (pbrMetallicRoughness.metallicFactor !== undefined) {\n                osgStateSet.addUniform(\n                    __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat1(pbrMetallicRoughness.metallicFactor, \'uMetallicFactor\')\n                );\n            }\n            if (pbrMetallicRoughness.roughnessFactor !== undefined) {\n                osgStateSet.addUniform(\n                    __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat1(pbrMetallicRoughness.roughnessFactor, \'uRoughnessFactor\')\n                );\n            }\n\n            if (pbrMetallicRoughness.metallicRoughnessTexture)\n                promises.push(\n                    this.createTextureAndSetAttrib(\n                        pbrMetallicRoughness.metallicRoughnessTexture,\n                        osgStateSet,\n                        ReaderWriterGLTF.METALLIC_ROUGHNESS_TEXTURE_UNIT,\n                        ReaderWriterGLTF.METALLIC_ROUGHNESS_UNIFORM\n                    )\n                );\n            model = ReaderWriterGLTF.PBR_METAL_MODE;\n        }\n        // SPECULAR/GLOSSINESS\n        if (extension) {\n            if (extension.diffuseFactor) {\n                //PBR default uniforms\n                osgStateSet.addUniform(\n                    __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat4(extension.diffuseFactor, \'uBaseColorFactor\')\n                );\n            }\n            if (extension.glossinessFactor !== undefined) {\n                osgStateSet.addUniform(\n                    __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat1(extension.glossinessFactor, \'uGlossinessFactor\')\n                );\n            }\n            if (extension.specularFactor !== undefined) {\n                osgStateSet.addUniform(\n                    __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat3(extension.specularFactor, \'uSpecularFactor\')\n                );\n            }\n            if (extension.diffuseTexture) {\n                promises.push(\n                    this.createTextureAndSetAttrib(\n                        extension.diffuseTexture,\n                        osgStateSet,\n                        ReaderWriterGLTF.DIFFUSE_TEXTURE_UNIT,\n                        ReaderWriterGLTF.ALBEDO_UNIFORM\n                    )\n                );\n            }\n            if (extension.specularGlossinessTexture) {\n                promises.push(\n                    this.createTextureAndSetAttrib(\n                        extension.specularGlossinessTexture,\n                        osgStateSet,\n                        ReaderWriterGLTF.SPECULAR_GLOSSINESS_TEXTURE_UNIT,\n                        ReaderWriterGLTF.METALLIC_ROUGHNESS_UNIFORM\n                    )\n                );\n            }\n            model = ReaderWriterGLTF.PBR_SPEC_MODE;\n        }\n        if (glTFmaterial.normalTexture) {\n            promises.push(\n                this.createTextureAndSetAttrib(\n                    glTFmaterial.normalTexture,\n                    osgStateSet,\n                    ReaderWriterGLTF.NORMAL_TEXTURE_UNIT,\n                    ReaderWriterGLTF.NORMAL_UNIFORM\n                )\n            );\n        }\n        if (glTFmaterial.occlusionTexture) {\n            promises.push(\n                this.createTextureAndSetAttrib(\n                    glTFmaterial.occlusionTexture,\n                    osgStateSet,\n                    ReaderWriterGLTF.AO_TEXTURE_UNIT,\n                    ReaderWriterGLTF.AO_UNIFORM\n                )\n            );\n        }\n        if (glTFmaterial.emissiveFactor !== undefined) {\n            osgStateSet.addUniform(\n                __WEBPACK_IMPORTED_MODULE_24_osg_Uniform__["a" /* default */].createFloat3(glTFmaterial.emissiveFactor, \'uEmissiveFactor\')\n            );\n        }\n        if (glTFmaterial.emissiveTexture !== undefined) {\n            promises.push(\n                this.createTextureAndSetAttrib(\n                    glTFmaterial.emissiveTexture,\n                    osgStateSet,\n                    ReaderWriterGLTF.EMISSIVE_TEXTURE_UNIT,\n                    ReaderWriterGLTF.EMISSIVE_UNIFORM\n                )\n            );\n        }\n        // TODO:Need to check for specular glossiness extension\n        geometryNode.setUserData({\n            pbrWorklow: model\n        });\n\n        geometryNode.stateset = osgStateSet;\n        osgStateSet.setRenderingHint(\'TRANSPARENT_BIN\');\n        osgStateSet.setRenderBinDetails(1000, \'RenderBin\');\n        osgStateSet.setAttributeAndModes(new __WEBPACK_IMPORTED_MODULE_13_osg_BlendFunc__["a" /* default */](\'SRC_ALPHA\', \'ONE_MINUS_SRC_ALPHA\'));\n        this._stateSetMap[materialId] = osgStateSet;\n\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promises);\n    }),\n\n    loadMaterial: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(materialId, geometryNode) {\n        var json = this._glTFJSON;\n        var glTFmaterial = json.materials[materialId];\n\n        if (this._stateSetMap[materialId]) {\n            geometryNode.stateset = this._stateSetMap[materialId];\n            return;\n        }\n\n        var extension = this.findByKey(glTFmaterial.extensions, ReaderWriterGLTF.PBR_SPEC_EXT);\n        if (glTFmaterial.pbrMetallicRoughness || extension)\n            return this.loadPBRMaterial(materialId, glTFmaterial, geometryNode, extension);\n\n        var values = glTFmaterial.values;\n        if (!values) return;\n\n        // Handles basic material attributes\n        var osgMaterial = new __WEBPACK_IMPORTED_MODULE_17_osg_Material__["default"]();\n        var osgStateSet = geometryNode.getOrCreateStateSet();\n        osgStateSet.setAttribute(osgMaterial);\n\n        if (values.ambient) osgMaterial.setAmbient(values.ambient);\n        if (values.emission) osgMaterial.setEmission(values.emission);\n        if (values.shininess) osgMaterial.setShininess(values.shininess);\n        if (values.specular) osgMaterial.setSpecular(values.specular);\n\n        // Create a texture for the diffuse, if any\n        if (values.diffuse) {\n            if (typeof values.diffuse !== \'string\') osgMaterial.setDiffuse(values.diffuse);\n            else return this.createTextureAndSetAttrib(values.diffuse, osgStateSet, 0);\n        }\n\n        geometryNode.stateset = osgStateSet;\n        this._stateSetMap[materialId] = osgStateSet;\n\n        return;\n    }),\n\n    createGeometry: function(primitive, skeletonJointId) {\n        var json = this._glTFJSON;\n        var promisesArray = [];\n\n        // Builds the geometry from the extracted vertices & normals\n        var geom = new __WEBPACK_IMPORTED_MODULE_14_osg_Geometry__["a" /* default */]();\n        var rigOrGeom = geom;\n\n        var cbSetBuffer = function(name, buffer) {\n            if (!buffer) return;\n\n            this.getVertexAttributeList()[name] = buffer;\n        };\n\n        if (skeletonJointId) {\n            rigOrGeom = new __WEBPACK_IMPORTED_MODULE_11_osgAnimation_RigGeometry__["a" /* default */]();\n            rigOrGeom._boneNameID = this._skeletonToInfluenceMap[skeletonJointId];\n        }\n\n        var attributeWeight = function(data) {\n            if (!data) return;\n\n            rigOrGeom.getAttributes().Weights = data;\n\n            var elts = rigOrGeom.getAttributes().Weights.getElements();\n            for (var i = 0, l = elts.length / 4; i < l; ++i) {\n                var sum = elts[i * 4] + elts[i * 4 + 1] + elts[i * 4 + 2] + elts[i * 4 + 3];\n                var correc = 1.0 / sum;\n                elts[i * 4] *= correc;\n                elts[i * 4 + 1] *= correc;\n                elts[i * 4 + 2] *= correc;\n                elts[i * 4 + 3] *= correc;\n            }\n        };\n\n        // Registers each glTF primitive attributes\n        // into a respective geometry attribute\n        var attributesKeys = window.Object.keys(primitive.attributes);\n        for (var i = 0; i < attributesKeys.length; ++i) {\n            var accessor = json.accessors[primitive.attributes[attributesKeys[i]]];\n            var promise = this.loadAccessorBuffer(accessor, __WEBPACK_IMPORTED_MODULE_20_osg_BufferArray__["a" /* default */].ARRAY_BUFFER);\n\n            if (attributesKeys[i].indexOf(\'POSITION\') !== -1) {\n                promise.then(cbSetBuffer.bind(geom, \'Vertex\'));\n            } else if (attributesKeys[i].indexOf(\'NORMAL\') !== -1) {\n                promise.then(cbSetBuffer.bind(geom, \'Normal\'));\n            } else if (attributesKeys[i].indexOf(\'TANGENT\') !== -1) {\n                promise.then(cbSetBuffer.bind(geom, \'Tangent\'));\n            } else if (attributesKeys[i].indexOf(\'JOINT\') !== -1) {\n                promise.then(cbSetBuffer.bind(rigOrGeom, \'Bones\'));\n            } else if (attributesKeys[i].indexOf(\'WEIGHT\') !== -1) {\n                promise.then(attributeWeight);\n            } else if (attributesKeys[i].indexOf(\'COLOR\') !== -1) {\n                promise.then(cbSetBuffer.bind(geom, \'Color\'));\n            } else if (attributesKeys[i].indexOf(\'TEXCOORD\') !== -1) {\n                var texCoordId = attributesKeys[i].substr(9);\n                promise.then(cbSetBuffer.bind(geom, \'TexCoord\' + texCoordId));\n            }\n\n            promisesArray.push(promise);\n        }\n\n        var indicesAccessor = json.accessors[primitive.indices];\n        var indicesPromise = this.loadAccessorBuffer(\n            indicesAccessor,\n            __WEBPACK_IMPORTED_MODULE_20_osg_BufferArray__["a" /* default */].ELEMENT_ARRAY_BUFFER\n        );\n        indicesPromise.then(function(data) {\n            if (!data) return;\n\n            var osgPrimitive = new __WEBPACK_IMPORTED_MODULE_18_osg_DrawElements__["a" /* default */](__WEBPACK_IMPORTED_MODULE_19_osg_primitiveSet__["a" /* default */].TRIANGLES, data);\n            geom.getPrimitives().push(osgPrimitive);\n        });\n\n        promisesArray.push(indicesPromise);\n\n        if (primitive.material !== undefined)\n            promisesArray.push(this.loadMaterial(primitive.material, geom));\n\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promisesArray).then(function() {\n            if (skeletonJointId) {\n                rigOrGeom.setSourceGeometry(geom);\n                rigOrGeom.mergeChildrenData();\n\n                rigOrGeom.computeBoundingBox = geom.computeBoundingBox;\n            }\n\n            return rigOrGeom;\n        });\n    },\n\n    loadGLTFPrimitives: function(meshId, resultMeshNode, skeletonJointId) {\n        var json = this._glTFJSON;\n        var mesh = json.meshes[meshId];\n\n        var primitives = mesh.primitives;\n\n        var promisesArray = [];\n        var i;\n        for (i = 0; i < primitives.length; ++i) {\n            var primitive = primitives[i];\n            var promiseGeom = this.createGeometry(primitive, skeletonJointId);\n\n            promisesArray.push(promiseGeom);\n        }\n\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promisesArray).then(function(geoms) {\n            for (i = 0; i < geoms.length; ++i) resultMeshNode.addChild(geoms[i]);\n\n            return geoms;\n        });\n    },\n\n    loadGLTFNode: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(nodeId, root) {\n        if (this._visitedNodes[nodeId]) return;\n\n        var json = this._glTFJSON;\n        var glTFNode = json.nodes[nodeId];\n\n        var currentNode = glTFNode.jointName ? this._bones[nodeId] : new __WEBPACK_IMPORTED_MODULE_16_osg_MatrixTransform__["a" /* default */]();\n        currentNode.setName(nodeId);\n        __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].copy(currentNode.getMatrix(), this.loadTransform(glTFNode));\n\n        if (glTFNode.jointName && this._skeletons[glTFNode.joinName]) {\n            var skeleton = this._skeletons[glTFNode.jointName];\n            skeleton.addChild(currentNode);\n            root.addChild(skeleton);\n        }\n\n        // Recurses on children before\n        // processing the current node\n        var children = glTFNode.children;\n        var i;\n        var promises = [];\n        if (children) {\n            for (i = 0; i < children.length; ++i) {\n                var nodePromise = this.loadGLTFNode(children[i], currentNode);\n                promises.push(nodePromise);\n            }\n        }\n        // Loads meshes contained in the node\n        // Adds RigGeometry to corresponding skeleton if any\n        if (glTFNode.mesh !== undefined) {\n            var meshId = glTFNode.mesh;\n            if (!glTFNode.skeletons) {\n                var geomPromise = this.loadGLTFPrimitives(meshId, currentNode, null);\n                promises.push(geomPromise);\n            } else {\n                for (var j = 0; j < glTFNode.skeletons.length; ++j) {\n                    var rootJointId = glTFNode.skeletons[j];\n                    var skeletonNode = this._skeletons[rootJointId];\n                    var meshTransformNode = new __WEBPACK_IMPORTED_MODULE_16_osg_MatrixTransform__["a" /* default */]();\n                    __WEBPACK_IMPORTED_MODULE_25_osg_glMatrix__["c" /* mat4 */].copy(meshTransformNode.getMatrix(), currentNode.getMatrix());\n                    var geomP = this.loadGLTFPrimitives(meshId, meshTransformNode, rootJointId);\n                    skeletonNode.addChild(meshTransformNode);\n                    promises.push(geomP);\n                }\n            }\n        }\n        // Loads solid animations\n        // by adding an update callback\n        if (this._animatedNodes[nodeId]) this.registerUpdateCallback(nodeId, currentNode);\n\n        if (!this._skeletons[nodeId]) root.addChild(currentNode);\n\n        this._visitedNodes[nodeId] = true;\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promises);\n    }),\n\n    readNodeURL: function(url, options) {\n        var self = this;\n\n        this.init();\n        if (options && options.filesMap !== undefined && options.filesMap.size > 0) {\n            // it comes from the ZIP plugin or from drag\'n drop\n            // So we already have all the files.\n            this._filesMap = options.filesMap;\n            var glTFFile = this._filesMap.get(url);\n            return this.readJSON(glTFFile, url);\n        }\n\n        var index = url.lastIndexOf(\'/\');\n        this._localPath = index === -1 ? \'\' : url.substr(0, index + 1);\n        // Else it is a usual XHR request\n        var filePromise = Object(__WEBPACK_IMPORTED_MODULE_1_osgDB_requestFile__["a" /* default */])(url);\n        return filePromise.then(function(file) {\n            return self.readJSON(file);\n        });\n    },\n\n    readJSON: __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.method(function(glTFFile, url) {\n        // Creates the root node\n        // adding a PI / 2 rotation arround the X-axis\n        var root = new __WEBPACK_IMPORTED_MODULE_16_osg_MatrixTransform__["a" /* default */]();\n        root.setName(url);\n\n        var json = JSON.parse(glTFFile);\n        if (!json) return;\n\n        this._glTFJSON = json;\n\n        var promisesArray = [];\n        // Preprocesses animations\n        var animPromise = this.preprocessAnimations();\n        // Preprocesses skin animations if any\n        var skeletonPromise = this.preprocessSkeletons();\n\n        promisesArray.push(skeletonPromise, animPromise);\n        var self = this;\n        return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promisesArray).then(function() {\n            var promises = [];\n            // Loops through each scene\n            // loading geometry nodes, transform nodes, etc...s\n            var sceneKeys = window.Object.keys(json.scenes);\n            for (var i = 0; i < sceneKeys.length; ++i) {\n                var scene = json.scenes[sceneKeys[i]];\n\n                if (!scene) continue;\n                for (var j = 0; j < scene.nodes.length; ++j) {\n                    var p = self.loadGLTFNode(scene.nodes[j], root);\n                    promises.push(p);\n                }\n            }\n\n            // Register the animation manager\n            // if the glTF file contains animations\n            if (self._basicAnimationManager) root.addUpdateCallback(self._basicAnimationManager);\n\n            return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promises).then(function() {\n                return root;\n            });\n        });\n    })\n};\n\n__WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__["a" /* default */].instance().addReaderWriter(\'gltf\', new ReaderWriterGLTF());\n\n/* harmony default export */ __webpack_exports__["a"] = (ReaderWriterGLTF);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterGLTF.js\n// module id = 260\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterGLTF.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgDB_requestFile_js__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgDB_readerParser__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgDB_FileHelper__ = __webpack_require__(67);\n\n\n\n\n\n\nvar JSZip = window.JSZip;\n\nvar ReaderWriterZIP = function() {\n    this._options = undefined;\n    this._filesMap = new window.Map();\n    this._fileName = ''; // The file containing the model of the archive ( gltf, glb, osgjs, b3dm, etc )\n};\n\nReaderWriterZIP.prototype = {\n    readNodeURL: function(url, options) {\n        if (JSZip === undefined) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].error('You need to add JSZip as a dependency');\n            return;\n        }\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].log('starting to read: ' + url);\n        // Check if we already have the file\n        var self = this;\n        if (options && options.filesMap !== undefined) {\n            // it comes  from drag'n drop\n            if (options.filesMap.has(url)) {\n                // Now url is a File\n                var file = options.filesMap.get(url);\n                return this.readZipFile(file).then(function() {\n                    if (!self._fileName.length) return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject(self);\n\n                    // At this point we have the main file name and a Map containing all the resources\n                    return __WEBPACK_IMPORTED_MODULE_4_osgDB_readerParser__[\"default\"].readNodeURL(self._fileName, {\n                        filesMap: self._filesMap\n                    });\n                });\n            }\n        }\n\n        var filePromise = Object(__WEBPACK_IMPORTED_MODULE_1_osgDB_requestFile_js__[\"a\" /* default */])(url, {\n            responseType: 'blob'\n        });\n\n        return filePromise.then(function(zfile) {\n            self.readZipFile(zfile).then(function() {\n                // At this point we have the main file name and a Map containing all the resources\n                return __WEBPACK_IMPORTED_MODULE_4_osgDB_readerParser__[\"default\"].readNodeURL(self._fileName, {\n                    filesMap: self._filesMap\n                });\n            });\n        });\n    },\n\n    _registerZipImage: function(fileName, type, extension, fileData) {\n        var data = fileData;\n        // Is an image\n        if (type === 'base64') {\n            data = new window.Image();\n            data.src = 'data:image/' + extension + ';base64,' + fileData;\n        }\n        this._filesMap.set(fileName, data);\n    },\n\n    readZipFile: function(fileOrBlob) {\n        return JSZip.loadAsync(fileOrBlob).then(\n            function(zip) {\n                var promisesArray = [];\n\n                for (var fileName in zip.files) {\n                    var extension = fileName.substr(fileName.lastIndexOf('.') + 1);\n                    // Check if the file is readable by any osgDB plugin\n                    var readerWriter = __WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__[\"a\" /* default */].instance().getReaderWriterForExtension(extension);\n                    // We need a hack for osgjs til it is converted to a readerwriter\n                    if (readerWriter !== undefined || extension === 'osgjs') {\n                        // So this is the main file to read\n                        this._fileName = fileName;\n                    }\n\n                    var type = __WEBPACK_IMPORTED_MODULE_5_osgDB_FileHelper__[\"a\" /* default */].getTypeForExtension(extension);\n                    // We don't need to parse this file\n                    if (type === undefined) continue;\n                    if (type === 'blob') type = 'base64'; // Images are base64 encoded in ZIP files\n\n                    var p = zip\n                        .file(fileName)\n                        .async(type)\n                        .then(this._registerZipImage.bind(this, fileName, type, extension));\n                    promisesArray.push(p);\n                }\n\n                return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promisesArray);\n            }.bind(this)\n        );\n    }\n};\n\n__WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__[\"a\" /* default */].instance().addReaderWriter('zip', new ReaderWriterZIP());\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReaderWriterZIP);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterZIP.js\n// module id = 261\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterZIP.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird__ = __webpack_require__(11);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_bluebird___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_bluebird__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgDB_requestFile_js__ = __webpack_require__(47);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_notify__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgDB_readerParser__ = __webpack_require__(33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_osgDB_FileHelper__ = __webpack_require__(67);\n// $$ SOURCE_CODE_MODIFIED\n\n// TODO: 复制自 ReaderWriterZIP.js，整体结构已有，实现有待补充\n\n\n\n\n\n\n\nvar JSZip = window.JSZip;\n\nvar ReaderWriterZZP = function() {\n    this._options = undefined;\n    this._filesMap = new window.Map();\n    this._fileName = ''; // The file containing the model of the archive ( gltf, glb, osgjs, b3dm, etc )\n};\n\nReaderWriterZZP.prototype = {\n    readNodeURL: function(url, options) {\n        if (JSZip === undefined) {\n            __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].error('You need to add JSZip as a dependency');\n            return;\n        }\n        __WEBPACK_IMPORTED_MODULE_2_osg_notify__[\"a\" /* default */].log('starting to read: ' + url);\n        // Check if we already have the file\n        var self = this;\n        if (options && options.filesMap !== undefined) {\n            // it comes  from drag'n drop\n            if (options.filesMap.has(url)) {\n                // Now url is a File\n                var file = options.filesMap.get(url);\n                return this.readZzpFile(file).then(function() {\n                    if (!self._fileName.length) return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.reject(self);\n\n                    // At this point we have the main file name and a Map containing all the resources\n                    return __WEBPACK_IMPORTED_MODULE_4_osgDB_readerParser__[\"default\"].readNodeURL(self._fileName, {\n                        filesMap: self._filesMap\n                    });\n                });\n            }\n        }\n\n        var filePromise = Object(__WEBPACK_IMPORTED_MODULE_1_osgDB_requestFile_js__[\"a\" /* default */])(url, {\n            responseType: 'blob'\n        });\n\n        return filePromise.then(function(zfile) {\n            self.readZzpFile(zfile).then(function() {\n                // At this point we have the main file name and a Map containing all the resources\n                return __WEBPACK_IMPORTED_MODULE_4_osgDB_readerParser__[\"default\"].readNodeURL(self._fileName, {\n                    filesMap: self._filesMap\n                });\n            });\n        });\n    },\n\n    _registerZzpImage: function(fileName, type, extension, fileData) {\n        var data = fileData;\n        // Is an image\n        if (type === 'base64') {\n            data = new window.Image();\n            data.src = 'data:image/' + extension + ';base64,' + fileData;\n        }\n        this._filesMap.set(fileName, data);\n    },\n\n    readZzpFile: function(fileOrBlob) {\n        return JSZip.loadAsync(fileOrBlob).then(\n            function(zzp) {\n                var promisesArray = [];\n\n                for (var fileName in zzp.files) {\n                    var extension = fileName.substr(fileName.lastIndexOf('.') + 1);\n                    // Check if the file is readable by any osgDB plugin\n                    var readerWriter = __WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__[\"a\" /* default */].instance().getReaderWriterForExtension(extension);\n                    // We need a hack for osgjs til it is converted to a readerwriter\n                    if (readerWriter !== undefined || extension === 'osgjs') {\n                        // So this is the main file to read\n                        this._fileName = fileName;\n                    }\n\n                    var type = __WEBPACK_IMPORTED_MODULE_5_osgDB_FileHelper__[\"a\" /* default */].getTypeForExtension(extension);\n                    // We don't need to parse this file\n                    if (type === undefined) continue;\n                    if (type === 'blob') type = 'base64'; // Images are base64 encoded in ZIP files\n\n                    var p = zzp\n                        .file(fileName)\n                        .async(type)\n                        .then(this._registerZzpImage.bind(this, fileName, type, extension));\n                    promisesArray.push(p);\n                }\n\n                return __WEBPACK_IMPORTED_MODULE_0_bluebird___default.a.all(promisesArray);\n            }.bind(this)\n        );\n    }\n};\n\n__WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__[\"a\" /* default */].instance().addReaderWriter('zzp', new ReaderWriterZZP());\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReaderWriterZZP);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterZZP.js\n// module id = 262\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterZZP.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_Input__ = __webpack_require__(40);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgPlugins_toGeoJSON__ = __webpack_require__(264);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgPlugins_toGeoJSON___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_osgPlugins_toGeoJSON__);\n// $$ SOURCE_CODE_MODIFIED\n\n\n\n\n// togeojson-0.16.0\n\n\nvar ReaderWriterKML = function() {\n};\nReaderWriterKML.prototype = {\n    readNodeURL: function(url, options) {\n        var scope = this;\n        var input = new __WEBPACK_IMPORTED_MODULE_2_osgDB_Input__[\"default\"]();\n\n        options = __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectMix(input.getOptions(), options);\n        input.setOptions(options);\n\n        if ( url.substr( 0, 10 ) !== 'data:image' ) {\n            url = input.computeURL( url );\n        }\n\n        // console.log('loading ' + url);\n\n        if(options) {\n            options.responseType = 'document';\n        }\n        var fileTextPromise = input.requestFile(url, options);\n        return fileTextPromise.then(function(data) {\n            var geoJSON = __WEBPACK_IMPORTED_MODULE_3_osgPlugins_toGeoJSON___default.a.kml(data);\n            return geoJSON;\n        });\n    },\n};\n\n__WEBPACK_IMPORTED_MODULE_1_osgDB_Registry__[\"a\" /* default */].instance().addReaderWriter('kml', new ReaderWriterKML());\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReaderWriterKML);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterKML.js\n// module id = 263\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterKML.js?")},function(module,exports,__webpack_require__){eval("// togeojson-0.16.0\n\nvar toGeoJSON = (function() {\n    'use strict';\n\n    var removeSpace = /\\s*/g,\n        trimSpace = /^\\s*|\\s*$/g,\n        splitSpace = /\\s+/;\n    // generate a short, numeric hash of a string\n    function okhash(x) {\n        if (!x || !x.length) return 0;\n        for (var i = 0, h = 0; i < x.length; i++) {\n            h = ((h << 5) - h) + x.charCodeAt(i) | 0;\n        } return h;\n    }\n    // all Y children of X\n    function get(x, y) { return x.getElementsByTagName(y); }\n    function attr(x, y) { return x.getAttribute(y); }\n    function attrf(x, y) { return parseFloat(attr(x, y)); }\n    // one Y child of X, if any, otherwise null\n    function get1(x, y) { var n = get(x, y); return n.length ? n[0] : null; }\n    // https://developer.mozilla.org/en-US/docs/Web/API/Node.normalize\n    function norm(el) { if (el.normalize) { el.normalize(); } return el; }\n    // cast array x into numbers\n    function numarray(x) {\n        for (var j = 0, o = []; j < x.length; j++) { o[j] = parseFloat(x[j]); }\n        return o;\n    }\n    // get the content of a text node, if any\n    function nodeVal(x) {\n        if (x) { norm(x); }\n        return (x && x.textContent) || '';\n    }\n    // get the contents of multiple text nodes, if present\n    function getMulti(x, ys) {\n        var o = {}, n, k;\n        for (k = 0; k < ys.length; k++) {\n            n = get1(x, ys[k]);\n            if (n) o[ys[k]] = nodeVal(n);\n        }\n        return o;\n    }\n    // add properties of Y to X, overwriting if present in both\n    function extend(x, y) { for (var k in y) x[k] = y[k]; }\n    // get one coordinate from a coordinate array, if any\n    function coord1(v) { return numarray(v.replace(removeSpace, '').split(',')); }\n    // get all coordinates from a coordinate array as [[],[]]\n    function coord(v) {\n        var coords = v.replace(trimSpace, '').split(splitSpace),\n            o = [];\n        for (var i = 0; i < coords.length; i++) {\n            o.push(coord1(coords[i]));\n        }\n        return o;\n    }\n    function coordPair(x) {\n        var ll = [attrf(x, 'lon'), attrf(x, 'lat')],\n            ele = get1(x, 'ele'),\n            // handle namespaced attribute in browser\n            heartRate = get1(x, 'gpxtpx:hr') || get1(x, 'hr'),\n            time = get1(x, 'time'),\n            e;\n        if (ele) {\n            e = parseFloat(nodeVal(ele));\n            if (!isNaN(e)) {\n                ll.push(e);\n            }\n        }\n        return {\n            coordinates: ll,\n            time: time ? nodeVal(time) : null,\n            heartRate: heartRate ? parseFloat(nodeVal(heartRate)) : null\n        };\n    }\n\n    // create a new feature collection parent object\n    function fc() {\n        return {\n            type: 'FeatureCollection',\n            features: []\n        };\n    }\n\n    // $$ SOURCE_CODE_MODIFIED\n    // ERROR in ./sources/osgPlugins/toGeoJSON.js\n    // Module not found: Error: Can't resolve 'xmldom' in 'sources\\osgPlugins'\n    //\n    // var serializer;\n    // if (typeof XMLSerializer !== 'undefined') {\n    //     /* istanbul ignore next */\n    //     serializer = new XMLSerializer();\n    // // only require xmldom in a node environment\n    // } else if (typeof exports === 'object' && typeof process === 'object' && !process.browser) {\n    //     serializer = new (require('xmldom').XMLSerializer)();\n    // }\n    // function xml2str(str) {\n    //     // IE9 will create a new XMLSerializer but it'll crash immediately.\n    //     // This line is ignored because we don't run coverage tests in IE9\n    //     /* istanbul ignore next */\n    //     if (str.xml !== undefined) return str.xml;\n    //     return serializer.serializeToString(str);\n    // }\n    // $$ SOURCE_CODE_MODIFIED\n\n    var t = {\n        kml: function(doc) {\n\n            var gj = fc(),\n                // styleindex keeps track of hashed styles in order to match features\n                styleIndex = {}, styleByHash = {},\n                // stylemapindex keeps track of style maps to expose in properties\n                styleMapIndex = {},\n                // atomic geospatial types supported by KML - MultiGeometry is\n                // handled separately\n                geotypes = ['Polygon', 'LineString', 'Point', 'Track', 'gx:Track'],\n                // all root placemarks in the file\n                placemarks = get(doc, 'Placemark'),\n                styles = get(doc, 'Style'),\n                styleMaps = get(doc, 'StyleMap');\n\n            for (var k = 0; k < styles.length; k++) {\n                var hash = okhash(xml2str(styles[k])).toString(16);\n                styleIndex['#' + attr(styles[k], 'id')] = hash;\n                styleByHash[hash] = styles[k];\n            }\n            for (var l = 0; l < styleMaps.length; l++) {\n                styleIndex['#' + attr(styleMaps[l], 'id')] = okhash(xml2str(styleMaps[l])).toString(16);\n                var pairs = get(styleMaps[l], 'Pair');\n                var pairsMap = {};\n                for (var m = 0; m < pairs.length; m++) {\n                    pairsMap[nodeVal(get1(pairs[m], 'key'))] = nodeVal(get1(pairs[m], 'styleUrl'));\n                }\n                styleMapIndex['#' + attr(styleMaps[l], 'id')] = pairsMap;\n\n            }\n            for (var j = 0; j < placemarks.length; j++) {\n                gj.features = gj.features.concat(getPlacemark(placemarks[j]));\n            }\n            function kmlColor(v) {\n                var color, opacity;\n                v = v || '';\n                if (v.substr(0, 1) === '#') { v = v.substr(1); }\n                if (v.length === 6 || v.length === 3) { color = v; }\n                if (v.length === 8) {\n                    opacity = parseInt(v.substr(0, 2), 16) / 255;\n                    color = '#' + v.substr(6, 2) +\n                        v.substr(4, 2) +\n                        v.substr(2, 2);\n                }\n                return [color, isNaN(opacity) ? undefined : opacity];\n            }\n            function gxCoord(v) { return numarray(v.split(' ')); }\n            function gxCoords(root) {\n                var elems = get(root, 'coord', 'gx'), coords = [], times = [];\n                if (elems.length === 0) elems = get(root, 'gx:coord');\n                for (var i = 0; i < elems.length; i++) coords.push(gxCoord(nodeVal(elems[i])));\n                var timeElems = get(root, 'when');\n                for (var j = 0; j < timeElems.length; j++) times.push(nodeVal(timeElems[j]));\n                return {\n                    coords: coords,\n                    times: times\n                };\n            }\n            function getGeometry(root) {\n                var geomNode, geomNodes, i, j, k, geoms = [], coordTimes = [];\n                if (get1(root, 'MultiGeometry')) { return getGeometry(get1(root, 'MultiGeometry')); }\n                if (get1(root, 'MultiTrack')) { return getGeometry(get1(root, 'MultiTrack')); }\n                if (get1(root, 'gx:MultiTrack')) { return getGeometry(get1(root, 'gx:MultiTrack')); }\n                for (i = 0; i < geotypes.length; i++) {\n                    geomNodes = get(root, geotypes[i]);\n                    if (geomNodes) {\n                        for (j = 0; j < geomNodes.length; j++) {\n                            geomNode = geomNodes[j];\n                            if (geotypes[i] === 'Point') {\n                                geoms.push({\n                                    type: 'Point',\n                                    coordinates: coord1(nodeVal(get1(geomNode, 'coordinates')))\n                                });\n                            } else if (geotypes[i] === 'LineString') {\n                                geoms.push({\n                                    type: 'LineString',\n                                    coordinates: coord(nodeVal(get1(geomNode, 'coordinates')))\n                                });\n                            } else if (geotypes[i] === 'Polygon') {\n                                var rings = get(geomNode, 'LinearRing'),\n                                    coords = [];\n                                for (k = 0; k < rings.length; k++) {\n                                    coords.push(coord(nodeVal(get1(rings[k], 'coordinates'))));\n                                }\n                                geoms.push({\n                                    type: 'Polygon',\n                                    coordinates: coords\n                                });\n                            } else if (geotypes[i] === 'Track' ||\n                                geotypes[i] === 'gx:Track') {\n                                var track = gxCoords(geomNode);\n                                geoms.push({\n                                    type: 'LineString',\n                                    coordinates: track.coords\n                                });\n                                if (track.times.length) coordTimes.push(track.times);\n                            }\n                        }\n                    }\n                }\n                return {\n                    geoms: geoms,\n                    coordTimes: coordTimes\n                };\n            }\n            function getPlacemark(root) {\n                var geomsAndTimes = getGeometry(root), i, properties = {},\n                    name = nodeVal(get1(root, 'name')),\n                    styleUrl = nodeVal(get1(root, 'styleUrl')),\n                    description = nodeVal(get1(root, 'description')),\n                    timeSpan = get1(root, 'TimeSpan'),\n                    timeStamp = get1(root, 'TimeStamp'),\n                    extendedData = get1(root, 'ExtendedData'),\n                    lineStyle = get1(root, 'LineStyle'),\n                    polyStyle = get1(root, 'PolyStyle'),\n                    visibility = get1(root, 'visibility');\n\n                if (!geomsAndTimes.geoms.length) return [];\n                if (name) properties.name = name;\n                if (styleUrl) {\n                    if (styleUrl[0] !== '#') {\n                        styleUrl = '#' + styleUrl;\n                    }\n\n                    properties.styleUrl = styleUrl;\n                    if (styleIndex[styleUrl]) {\n                        properties.styleHash = styleIndex[styleUrl];\n                    }\n                    if (styleMapIndex[styleUrl]) {\n                        properties.styleMapHash = styleMapIndex[styleUrl];\n                        properties.styleHash = styleIndex[styleMapIndex[styleUrl].normal];\n                    }\n                    // Try to populate the lineStyle or polyStyle since we got the style hash\n                    var style = styleByHash[properties.styleHash];\n                    if (style) {\n                        if (!lineStyle) lineStyle = get1(style, 'LineStyle');\n                        if (!polyStyle) polyStyle = get1(style, 'PolyStyle');\n                    }\n                }\n                if (description) properties.description = description;\n                if (timeSpan) {\n                    var begin = nodeVal(get1(timeSpan, 'begin'));\n                    var end = nodeVal(get1(timeSpan, 'end'));\n                    properties.timespan = { begin: begin, end: end };\n                }\n                if (timeStamp) {\n                    properties.timestamp = nodeVal(get1(timeStamp, 'when'));\n                }\n                if (lineStyle) {\n                    var linestyles = kmlColor(nodeVal(get1(lineStyle, 'color'))),\n                        color = linestyles[0],\n                        opacity = linestyles[1],\n                        width = parseFloat(nodeVal(get1(lineStyle, 'width')));\n                    if (color) properties.stroke = color;\n                    if (!isNaN(opacity)) properties['stroke-opacity'] = opacity;\n                    if (!isNaN(width)) properties['stroke-width'] = width;\n                }\n                if (polyStyle) {\n                    var polystyles = kmlColor(nodeVal(get1(polyStyle, 'color'))),\n                        pcolor = polystyles[0],\n                        popacity = polystyles[1],\n                        fill = nodeVal(get1(polyStyle, 'fill')),\n                        outline = nodeVal(get1(polyStyle, 'outline'));\n                    if (pcolor) properties.fill = pcolor;\n                    if (!isNaN(popacity)) properties['fill-opacity'] = popacity;\n                    if (fill) properties['fill-opacity'] = fill === '1' ? properties['fill-opacity'] || 1 : 0;\n                    if (outline) properties['stroke-opacity'] = outline === '1' ? properties['stroke-opacity'] || 1 : 0;\n                }\n                if (extendedData) {\n                    var datas = get(extendedData, 'Data'),\n                        simpleDatas = get(extendedData, 'SimpleData');\n\n                    for (i = 0; i < datas.length; i++) {\n                        properties[datas[i].getAttribute('name')] = nodeVal(get1(datas[i], 'value'));\n                    }\n                    for (i = 0; i < simpleDatas.length; i++) {\n                        properties[simpleDatas[i].getAttribute('name')] = nodeVal(simpleDatas[i]);\n                    }\n                }\n                if (visibility) {\n                    properties.visibility = nodeVal(visibility);\n                }\n                if (geomsAndTimes.coordTimes.length) {\n                    properties.coordTimes = (geomsAndTimes.coordTimes.length === 1) ?\n                        geomsAndTimes.coordTimes[0] : geomsAndTimes.coordTimes;\n                }\n                var feature = {\n                    type: 'Feature',\n                    geometry: (geomsAndTimes.geoms.length === 1) ? geomsAndTimes.geoms[0] : {\n                        type: 'GeometryCollection',\n                        geometries: geomsAndTimes.geoms\n                    },\n                    properties: properties\n                };\n                if (attr(root, 'id')) feature.id = attr(root, 'id');\n                return [feature];\n            }\n            return gj;\n        },\n        gpx: function(doc) {\n            var i,\n                tracks = get(doc, 'trk'),\n                routes = get(doc, 'rte'),\n                waypoints = get(doc, 'wpt'),\n                // a feature collection\n                gj = fc(),\n                feature;\n            for (i = 0; i < tracks.length; i++) {\n                feature = getTrack(tracks[i]);\n                if (feature) gj.features.push(feature);\n            }\n            for (i = 0; i < routes.length; i++) {\n                feature = getRoute(routes[i]);\n                if (feature) gj.features.push(feature);\n            }\n            for (i = 0; i < waypoints.length; i++) {\n                gj.features.push(getPoint(waypoints[i]));\n            }\n            function getPoints(node, pointname) {\n                var pts = get(node, pointname),\n                    line = [],\n                    times = [],\n                    heartRates = [],\n                    l = pts.length;\n                if (l < 2) return {};  // Invalid line in GeoJSON\n                for (var i = 0; i < l; i++) {\n                    var c = coordPair(pts[i]);\n                    line.push(c.coordinates);\n                    if (c.time) times.push(c.time);\n                    if (c.heartRate) heartRates.push(c.heartRate);\n                }\n                return {\n                    line: line,\n                    times: times,\n                    heartRates: heartRates\n                };\n            }\n            function getTrack(node) {\n                var segments = get(node, 'trkseg'),\n                    track = [],\n                    times = [],\n                    heartRates = [],\n                    line;\n                for (var i = 0; i < segments.length; i++) {\n                    line = getPoints(segments[i], 'trkpt');\n                    if (line) {\n                        if (line.line) track.push(line.line);\n                        if (line.times && line.times.length) times.push(line.times);\n                        if (line.heartRates && line.heartRates.length) heartRates.push(line.heartRates);\n                    }\n                }\n                if (track.length === 0) return;\n                var properties = getProperties(node);\n                if (times.length) properties.coordTimes = track.length === 1 ? times[0] : times;\n                if (heartRates.length) properties.heartRates = track.length === 1 ? heartRates[0] : heartRates;\n                return {\n                    type: 'Feature',\n                    properties: properties,\n                    geometry: {\n                        type: track.length === 1 ? 'LineString' : 'MultiLineString',\n                        coordinates: track.length === 1 ? track[0] : track\n                    }\n                };\n            }\n            function getRoute(node) {\n                var line = getPoints(node, 'rtept');\n                if (!line.line) return;\n                var routeObj = {\n                    type: 'Feature',\n                    properties: getProperties(node),\n                    geometry: {\n                        type: 'LineString',\n                        coordinates: line.line\n                    }\n                };\n                return routeObj;\n            }\n            function getPoint(node) {\n                var prop = getProperties(node);\n                extend(prop, getMulti(node, ['sym', 'type']));\n                return {\n                    type: 'Feature',\n                    properties: prop,\n                    geometry: {\n                        type: 'Point',\n                        coordinates: coordPair(node).coordinates\n                    }\n                };\n            }\n            function getProperties(node) {\n                var prop, links;\n                prop = getMulti(node, ['name', 'cmt', 'desc', 'time', 'keywords']);\n                links = get(node, 'link');\n                if (links.length) prop.links = [];\n                for (var i = 0, link; i < links.length; i++) {\n                    link = { href: attr(links[i], 'href') };\n                    extend(link, getMulti(links[i], ['text', 'type']));\n                    prop.links.push(link);\n                }\n                return prop;\n            }\n            return gj;\n        }\n    };\n    return t;\n})();\n\nif (true) module.exports = toGeoJSON;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/toGeoJSON.js\n// module id = 264\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/toGeoJSON.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_Input__ = __webpack_require__(40);\n// $$ SOURCE_CODE_MODIFIED\n\n\n\n\n\nvar ReaderWriterDDS = function() {\n    this._options = undefined;\n    this._filesMap = new window.Map();\n    this._fileName = \'\'; // The file containing the model of the archive ( gltf, glb, osgjs, b3dm, etc )\n};\n\nReaderWriterDDS.prototype = {\n    readImageURL: function(url, options) {\n        var scope = this;\n        var input = new __WEBPACK_IMPORTED_MODULE_3_osgDB_Input__["default"]();\n\n        options = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectMix(input.getOptions(), options);\n        input.setOptions(options);\n\n        if ( url.substr( 0, 10 ) !== \'data:image\' ) {\n            url = input.computeURL( url );\n        }\n\n        var image = new __WEBPACK_IMPORTED_MODULE_1_osg_Image__["a" /* default */]();\n        image.setURL(url);\n        // console.log(\'loading \' + url);\n\n        if(options) {\n            options.responseType = \'arraybuffer\';\n        }\n        var fileTextPromise = input.requestFile(url, options);\n        return fileTextPromise.then(function(data) {\n            var texDatas = scope.readDDSFile( data, true);\n            if(texDatas.mipmaps.length) {\n                image.setImage = function(img) {\n                    this._mipmap = img.mipmaps;\n                    this.setWidth(img.width);\n                    this.setHeight(img.height);\n                    this._mipmap.length = img.mipmapCount;\n                    this._imageObject = this._mipmap[0].data;\n                    this.format = img.format;\n                    this.dirty();\n                };\n                image.setImage( texDatas );\n            }\n            else {\n                image.setImage(__WEBPACK_IMPORTED_MODULE_3_osgDB_Input__["default"].imageFallback);\n            }\n            return image;\n        });\n    },\n    readDDSFile: function (buffer, loadMipmaps) {\n        var dds = {mipmaps: [], width: 0, height: 0, format: null, mipmapCount: 1};\n\n        // Adapted from @toji\'s DDS utils\n        // https://github.com/toji/webgl-texture-utils/blob/master/texture-util/dds.js\n\n        // All values and structures referenced from:\n        // http://msdn.microsoft.com/en-us/library/bb943991.aspx/\n\n        var DDS_MAGIC = 0x20534444;\n\n        var DDSD_CAPS = 0x1,\n            DDSD_HEIGHT = 0x2,\n            DDSD_WIDTH = 0x4,\n            DDSD_PITCH = 0x8,\n            DDSD_PIXELFORMAT = 0x1000,\n            DDSD_MIPMAPCOUNT = 0x20000,\n            DDSD_LINEARSIZE = 0x80000,\n            DDSD_DEPTH = 0x800000;\n\n        var DDSCAPS_COMPLEX = 0x8,\n            DDSCAPS_MIPMAP = 0x400000,\n            DDSCAPS_TEXTURE = 0x1000;\n\n        var DDSCAPS2_CUBEMAP = 0x200,\n            DDSCAPS2_CUBEMAP_POSITIVEX = 0x400,\n            DDSCAPS2_CUBEMAP_NEGATIVEX = 0x800,\n            DDSCAPS2_CUBEMAP_POSITIVEY = 0x1000,\n            DDSCAPS2_CUBEMAP_NEGATIVEY = 0x2000,\n            DDSCAPS2_CUBEMAP_POSITIVEZ = 0x4000,\n            DDSCAPS2_CUBEMAP_NEGATIVEZ = 0x8000,\n            DDSCAPS2_VOLUME = 0x200000;\n\n        var DDPF_ALPHAPIXELS = 0x1,\n            DDPF_ALPHA = 0x2,\n            DDPF_FOURCC = 0x4,\n            DDPF_RGB = 0x40,\n            DDPF_YUV = 0x200,\n            DDPF_LUMINANCE = 0x20000;\n\n        function fourCCToInt32(value) {\n            return value.charCodeAt(0) +\n                ( value.charCodeAt(1) << 8 ) +\n                ( value.charCodeAt(2) << 16 ) +\n                ( value.charCodeAt(3) << 24 );\n        }\n\n        function int32ToFourCC(value) {\n            return String.fromCharCode(\n                value & 0xff,\n                ( value >> 8 ) & 0xff,\n                ( value >> 16 ) & 0xff,\n                ( value >> 24 ) & 0xff\n            );\n        }\n\n        function loadARGBMip(buffer, dataOffset, width, height) {\n            var dataLength = width * height * 4;\n            var srcBuffer = new Uint8Array(buffer, dataOffset, dataLength);\n            var byteArray = new Uint8Array(dataLength);\n            var dst = 0;\n            var src = 0;\n            for (var y = 0; y < height; y++) {\n\n                for (var x = 0; x < width; x++) {\n\n                    var b = srcBuffer[src];\n                    src++;\n                    var g = srcBuffer[src];\n                    src++;\n                    var r = srcBuffer[src];\n                    src++;\n                    var a = srcBuffer[src];\n                    src++;\n                    byteArray[dst] = r;\n                    dst++;  //r\n                    byteArray[dst] = g;\n                    dst++;  //g\n                    byteArray[dst] = b;\n                    dst++;  //b\n                    byteArray[dst] = a;\n                    dst++;  //a\n\n                }\n\n            }\n            return byteArray;\n        }\n\n        var FOURCC_DXT1 = fourCCToInt32("DXT1");\n        var FOURCC_DXT3 = fourCCToInt32("DXT3");\n        var FOURCC_DXT5 = fourCCToInt32("DXT5");\n        var FOURCC_ETC1 = fourCCToInt32("ETC1");\n\n        var headerLengthInt = 31; // The header length in 32 bit ints\n\n        // Offsets into the header array\n\n        var off_magic = 0;\n\n        var off_size = 1;\n        var off_flags = 2;\n        var off_height = 3;\n        var off_width = 4;\n\n        var off_mipmapCount = 7;\n\n        var off_pfFlags = 20;\n        var off_pfFourCC = 21;\n        var off_RGBBitCount = 22;\n        var off_RBitMask = 23;\n        var off_GBitMask = 24;\n        var off_BBitMask = 25;\n        var off_ABitMask = 26;\n\n        var off_caps = 27;\n        var off_caps2 = 28;\n        var off_caps3 = 29;\n        var off_caps4 = 30;\n\n        // Parse header\n        var header = new Int32Array(buffer, 0, headerLengthInt);\n        if (header[off_magic] !== DDS_MAGIC) {\n            console.warn(\'THREE.DDSLoader.parse: Invalid magic number in DDS header.\');\n            return dds;\n        }\n        if (!header[off_pfFlags] & DDPF_FOURCC) {\n            console.warn(\'THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code.\');\n            return dds;\n        }\n\n        var blockBytes;\n\n        var fourCC = header[off_pfFourCC];\n\n        var isRGBAUncompressed = false;\n\n        switch (fourCC) {\n\n            case FOURCC_DXT1:\n\n                blockBytes = 8;\n                dds.format = 0x83F1;\n                break;\n\n            case FOURCC_DXT3:\n\n                blockBytes = 16;\n                dds.format = 0x83F2;\n                break;\n\n            case FOURCC_DXT5:\n\n                blockBytes = 16;\n                dds.format = 0x83F3;\n                break;\n\n            case FOURCC_ETC1:\n\n                blockBytes = 8;\n                dds.format = 0x8D64;\n                break;\n\n            default:\n\n                if (header[off_RGBBitCount] === 32\n                    && header[off_RBitMask] & 0xff0000\n                    && header[off_GBitMask] & 0xff00\n                    && header[off_BBitMask] & 0xff\n                    && header[off_ABitMask] & 0xff000000) {\n\n                    isRGBAUncompressed = true;\n                    blockBytes = 64;\n                    dds.format = 0x8C93;\n\n                } else {\n\n                    console.error(\'THREE.DDSLoader.parse: Unsupported FourCC code \', int32ToFourCC(fourCC));\n                    return dds;\n\n                }\n        }\n\n        dds.mipmapCount = 1;\n\n        if (header[off_flags] & DDSD_MIPMAPCOUNT && loadMipmaps !== false) {\n\n            dds.mipmapCount = Math.max(1, header[off_mipmapCount]);\n\n        }\n\n        var caps2 = header[off_caps2];\n        dds.isCubemap = caps2 & DDSCAPS2_CUBEMAP ? true : false;\n        if (dds.isCubemap && (\n                !( caps2 & DDSCAPS2_CUBEMAP_POSITIVEX ) ||\n                !( caps2 & DDSCAPS2_CUBEMAP_NEGATIVEX ) ||\n                !( caps2 & DDSCAPS2_CUBEMAP_POSITIVEY ) ||\n                !( caps2 & DDSCAPS2_CUBEMAP_NEGATIVEY ) ||\n                !( caps2 & DDSCAPS2_CUBEMAP_POSITIVEZ ) ||\n                !( caps2 & DDSCAPS2_CUBEMAP_NEGATIVEZ )\n            )) {\n\n            console.error(\'THREE.DDSLoader.parse: Incomplete cubemap faces\');\n            return dds;\n\n        }\n\n        dds.width = header[off_width];\n        dds.height = header[off_height];\n\n        var dataOffset = header[off_size] + 4;\n\n        // Extract mipmaps buffers\n\n        var faces = dds.isCubemap ? 6 : 1;\n\n        for (var face = 0; face < faces; face++) {\n\n            var width = dds.width;\n            var height = dds.height;\n\n            for (var i = 0; i < dds.mipmapCount; i++) {\n\n                if (isRGBAUncompressed) {\n\n                    var byteArray = loadARGBMip(buffer, dataOffset, width, height);\n                    var dataLength = byteArray.length;\n\n                } else {\n\n                    var dataLength = Math.max(4, width) / 4 * Math.max(4, height) / 4 * blockBytes;\n                    var byteArray = new Uint8Array(buffer, dataOffset, dataLength);\n\n                }\n\n\n                var mipmap = {\n                    data: byteArray,\n                    width: width,\n                    height: height,\n                    getWidth: function () {\n                        return this.width;\n                    }, getHeight: function () {\n                        return this.height;\n                    }, getImage: function () {\n                        return this.data;\n                    }\n                };\n\n                dds.mipmaps.push(mipmap);\n\n                dataOffset += dataLength;\n\n                width = Math.max(width >> 1, 1);\n                height = Math.max(height >> 1, 1);\n\n            }\n\n        }\n\n        return dds;\n    },\n};\n\n__WEBPACK_IMPORTED_MODULE_2_osgDB_Registry__["a" /* default */].instance().addReaderWriter(\'dds\', new ReaderWriterDDS());\n\n/* harmony default export */ __webpack_exports__["a"] = (ReaderWriterDDS);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterDDS.js\n// module id = 265\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterDDS.js?')},function(module,__webpack_exports__,__webpack_require__){"use strict";eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_Input__ = __webpack_require__(40);\n// $$ SOURCE_CODE_MODIFIED\n// 解析KTX文件代码,从[Three.js-r91]上抄过来的\n\n\n\n\n\nvar ReaderWriterKTX = function() {\n    this._options = undefined;\n    this._filesMap = new window.Map();\n    this._fileName = ''; // The file containing the model of the archive ( gltf, glb, osgjs, b3dm, etc )\n};\n\nReaderWriterKTX.prototype = {\n    readImageURL: function(url, input) {\n        var scope = this;\n        var input = new __WEBPACK_IMPORTED_MODULE_3_osgDB_Input__[\"default\"]();\n\n        options = __WEBPACK_IMPORTED_MODULE_0_osg_utils__[\"a\" /* default */].objectMix(input.getOptions(), options);\n        input.setOptions(options);\n\n        if ( url.substr( 0, 10 ) !== 'data:image' ) {\n            url = input.computeURL( url );\n        }\n\n        var image = new __WEBPACK_IMPORTED_MODULE_1_osg_Image__[\"a\" /* default */]();\n        image.setImage = function(ktx) {\n            this._mipmap = ktx.mipmaps( true );\n            this.setWidth(ktx.pixelWidth);\n            this.setHeight(ktx.pixelHeight);\n            this._mipmap.length = ktx.numberOfMipmapLevels;\n            this._imageObject = this._mipmap[0].data;\n            this.format = ktx.glInternalFormat;\n            this.dirty();\n        };\n        image.setURL(url);\n\n        if(options) {\n            options.responseType = 'arraybuffer';\n        }\n        var fileTextPromise = input.requestFile(url, options);\n        return fileTextPromise.then(function(data) {\n            var ktx = new KhronosTextureContainer( data, 1 );\n            image.setImage( ktx );\n            return image;\n        });\n    }\n};\n\n\nvar KhronosTextureContainer = ( function () {\n\n    /**\n     * @param {ArrayBuffer} arrayBuffer- contents of the KTX container file\n     * @param {number} facesExpected- should be either 1 or 6, based whether a cube texture or or\n     * @param {boolean} threeDExpected- provision for indicating that data should be a 3D texture, not implemented\n     * @param {boolean} textureArrayExpected- provision for indicating that data should be a texture array, not implemented\n     */\n    function KhronosTextureContainer( arrayBuffer, facesExpected, threeDExpected, textureArrayExpected ) {\n\n        this.arrayBuffer = arrayBuffer;\n\n        // Test that it is a ktx formatted file, based on the first 12 bytes, character representation is:\n        // '´', 'K', 'T', 'X', ' ', '1', '1', 'ª', '\\r', '\\n', '\\x1A', '\\n'\n        // 0xAB, 0x4B, 0x54, 0x58, 0x20, 0x31, 0x31, 0xBB, 0x0D, 0x0A, 0x1A, 0x0A\n        var identifier = new Uint8Array( this.arrayBuffer, 0, 12 );\n        if ( identifier[ 0 ] !== 0xAB ||\n            identifier[ 1 ] !== 0x4B ||\n            identifier[ 2 ] !== 0x54 ||\n            identifier[ 3 ] !== 0x58 ||\n            identifier[ 4 ] !== 0x20 ||\n            identifier[ 5 ] !== 0x31 ||\n            identifier[ 6 ] !== 0x31 ||\n            identifier[ 7 ] !== 0xBB ||\n            identifier[ 8 ] !== 0x0D ||\n            identifier[ 9 ] !== 0x0A ||\n            identifier[ 10 ] !== 0x1A ||\n            identifier[ 11 ] !== 0x0A ) {\n\n            console.error( 'texture missing KTX identifier' );\n            return;\n\n        }\n\n        // load the reset of the header in native 32 bit int\n        var header = new Int32Array( this.arrayBuffer, 12, 13 );\n        // determine of the remaining header values are recorded in the opposite endianness & require conversion\n        var oppositeEndianess = header[ 0 ] === 0x01020304;\n        // read all the header elements in order they exist in the file, without modification (sans endainness)\n        this.glType = oppositeEndianess ? this.switchEndainness( header[ 1 ] ) : header[ 1 ]; // must be 0 for compressed textures\n        this.glTypeSize = oppositeEndianess ? this.switchEndainness( header[ 2 ] ) : header[ 2 ]; // must be 1 for compressed textures\n        this.glFormat = oppositeEndianess ? this.switchEndainness( header[ 3 ] ) : header[ 3 ]; // must be 0 for compressed textures\n        this.glInternalFormat = oppositeEndianess ? this.switchEndainness( header[ 4 ] ) : header[ 4 ]; // the value of arg passed to gl.compressedTexImage2D(,,x,,,,)\n        this.glBaseInternalFormat = oppositeEndianess ? this.switchEndainness( header[ 5 ] ) : header[ 5 ]; // specify GL_RGB, GL_RGBA, GL_ALPHA, etc (un-compressed only)\n        this.pixelWidth = oppositeEndianess ? this.switchEndainness( header[ 6 ] ) : header[ 6 ]; // level 0 value of arg passed to gl.compressedTexImage2D(,,,x,,,)\n        this.pixelHeight = oppositeEndianess ? this.switchEndainness( header[ 7 ] ) : header[ 7 ]; // level 0 value of arg passed to gl.compressedTexImage2D(,,,,x,,)\n        this.pixelDepth = oppositeEndianess ? this.switchEndainness( header[ 8 ] ) : header[ 8 ]; // level 0 value of arg passed to gl.compressedTexImage3D(,,,,,x,,)\n        this.numberOfArrayElements = oppositeEndianess ? this.switchEndainness( header[ 9 ] ) : header[ 9 ]; // used for texture arrays\n        this.numberOfFaces = oppositeEndianess ? this.switchEndainness( header[ 10 ] ) : header[ 10 ]; // used for cubemap textures, should either be 1 or 6\n        this.numberOfMipmapLevels = oppositeEndianess ? this.switchEndainness( header[ 11 ] ) : header[ 11 ]; // number of levels; disregard possibility of 0 for compressed textures\n        this.bytesOfKeyValueData = oppositeEndianess ? this.switchEndainness( header[ 12 ] ) : header[ 12 ]; // the amount of space after the header for meta-data\n\n        // Make sure we have a compressed type.  Not only reduces work, but probably better to let dev know they are not compressing.\n        if ( this.glType !== 0 ) {\n\n            console.warn( 'only compressed formats currently supported' );\n            return;\n\n        } else {\n\n            // value of zero is an indication to generate mipmaps @ runtime.  Not usually allowed for compressed, so disregard.\n            this.numberOfMipmapLevels = Math.max( 1, this.numberOfMipmapLevels );\n\n        }\n        if ( this.pixelHeight === 0 || this.pixelDepth !== 0 ) {\n\n            console.warn( 'only 2D textures currently supported' );\n            return;\n\n        }\n        if ( this.numberOfArrayElements !== 0 ) {\n\n            console.warn( 'texture arrays not currently supported' );\n            return;\n\n        }\n        if ( this.numberOfFaces !== facesExpected ) {\n\n            console.warn( 'number of faces expected' + facesExpected + ', but found ' + this.numberOfFaces );\n            return;\n\n        }\n        // we now have a completely validated file, so could use existence of loadType as success\n        // would need to make this more elaborate & adjust checks above to support more than one load type\n        this.loadType = KhronosTextureContainer.COMPRESSED_2D;\n\n    }\n\n    // not as fast hardware based, but will probably never need to use\n    KhronosTextureContainer.prototype.switchEndainness = function ( val ) {\n\n        return ( ( val & 0xFF ) << 24 ) | ( ( val & 0xFF00 ) << 8 ) | ( ( val >> 8 ) & 0xFF00 ) | ( ( val >> 24 ) & 0xFF );\n\n    };\n\n    // return mipmaps for THREE.js\n    KhronosTextureContainer.prototype.mipmaps = function ( loadMipmaps ) {\n\n        var mipmaps = [];\n\n        // initialize width & height for level 1\n        var dataOffset = KhronosTextureContainer.HEADER_LEN + this.bytesOfKeyValueData;\n        var width = this.pixelWidth;\n        var height = this.pixelHeight;\n        var mipmapCount = loadMipmaps ? this.numberOfMipmapLevels : 1;\n\n        for ( var level = 0; level < mipmapCount; level ++ ) {\n\n            var imageSize = new Int32Array( this.arrayBuffer, dataOffset, 1 )[ 0 ]; // size per face, since not supporting array cubemaps\n            for ( var face = 0; face < this.numberOfFaces; face ++ ) {\n\n                var byteArray = new Uint8Array( this.arrayBuffer, dataOffset + 4, imageSize );\n\n                mipmaps.push( {\n                    \"data\": byteArray,\n                    \"width\": width,\n                    \"height\": height,\n                    getWidth: function () {\n                        return this.width;\n                    },\n                    getHeight: function () {\n                        return this.height;\n                    },\n                    getImage: function () {\n                        return this.data;\n                    }\n                } );\n\n                dataOffset += imageSize + 4; // size of the image + 4 for the imageSize field\n                dataOffset += 3 - ( ( imageSize + 3 ) % 4 ); // add padding for odd sized image\n\n            }\n            width = Math.max( 1.0, width * 0.5 );\n            height = Math.max( 1.0, height * 0.5 );\n\n        }\n\n        return mipmaps;\n\n    };\n\n    KhronosTextureContainer.HEADER_LEN = 12 + ( 13 * 4 ); // identifier + header elements (not including key value meta-data pairs)\n    // load types\n    KhronosTextureContainer.COMPRESSED_2D = 0; // uses a gl.compressedTexImage2D()\n    KhronosTextureContainer.COMPRESSED_3D = 1; // uses a gl.compressedTexImage3D()\n    KhronosTextureContainer.TEX_2D = 2; // uses a gl.texImage2D()\n    KhronosTextureContainer.TEX_3D = 3; // uses a gl.texImage3D()\n\n    return KhronosTextureContainer;\n\n}() );\n\n__WEBPACK_IMPORTED_MODULE_2_osgDB_Registry__[\"a\" /* default */].instance().addReaderWriter('ktx', new ReaderWriterKTX());\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (ReaderWriterKTX);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterKTX.js\n// module id = 266\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterKTX.js?")},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_osg_utils__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_osg_Image__ = __webpack_require__(34);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_osg_Texture__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_osgDB_Input__ = __webpack_require__(40);\n// $$ SOURCE_CODE_MODIFIED\n\n\n\n\n\n\nvar RGB_PVRTC_4BPPV1_Format = __WEBPACK_IMPORTED_MODULE_2_osg_Texture__["default"].COMPRESSED_RGB_PVRTC_4BPPV1_IMG; // 35840;\nvar RGB_PVRTC_2BPPV1_Format = __WEBPACK_IMPORTED_MODULE_2_osg_Texture__["default"].COMPRESSED_RGB_PVRTC_2BPPV1_IMG; // 35841;\nvar RGBA_PVRTC_4BPPV1_Format = __WEBPACK_IMPORTED_MODULE_2_osg_Texture__["default"].COMPRESSED_RGBA_PVRTC_4BPPV1_IMG; // 35842;\nvar RGBA_PVRTC_2BPPV1_Format = __WEBPACK_IMPORTED_MODULE_2_osg_Texture__["default"].COMPRESSED_RGBA_PVRTC_2BPPV1_IMG; // 35843;\n\nvar ReaderWriterPVR = function() {\n    this._options = undefined;\n    this._filesMap = new window.Map();\n    this._fileName = \'\'; // The file containing the model of the archive ( gltf, glb, osgjs, b3dm, etc )\n};\n\nReaderWriterPVR.prototype = {\n    readImageURL: function(url, input) {\n        var scope = this;\n        var input = new __WEBPACK_IMPORTED_MODULE_4_osgDB_Input__["default"]();\n\n        options = __WEBPACK_IMPORTED_MODULE_0_osg_utils__["a" /* default */].objectMix(input.getOptions(), options);\n        input.setOptions(options);\n\n        if ( url.substr( 0, 10 ) !== \'data:image\' ) {\n            url = input.computeURL( url );\n        }\n\n        var image = new __WEBPACK_IMPORTED_MODULE_1_osg_Image__["a" /* default */]();\n        image.setImage = function(img) {\n            this._mipmap = img.mipmaps;\n            this.setWidth(img.width);\n            this.setHeight(img.height);\n            this._mipmap.length = img.mipmapCount;\n            this._imageObject = this._mipmap[0].data;\n            this.format = img.format;\n            this.dirty();\n        };\n        image.setURL(url);\n\n        if(options) {\n            options.responseType = \'arraybuffer\';\n        }\n        var fileTextPromise = input.requestFile(url, options);\n        return fileTextPromise.then(function(data) {\n            var texDatas = scope.parse( data, true);\n            if (texDatas.width !==texDatas.height) {\n                console.error(\'不支持非正方形PVR纹理: \'+ url);\n            }\n            image.setImage( texDatas );\n            return image;\n        });\n    },\n    parse: function ( buffer, loadMipmaps ) {\n        var headerLengthInt = 13;\n        var header = new Uint32Array( buffer, 0, headerLengthInt );\n\n        var pvrDatas = {\n            buffer: buffer,\n            header: header,\n            loadMipmaps: loadMipmaps\n        };\n\n        if ( header[ 0 ] === 0x03525650 ) {\n            // PVR v3\n            return this._parseV3( pvrDatas );\n        } else if ( header[ 11 ] === 0x21525650 ) {\n            // PVR v2\n            return this._parseV2( pvrDatas );\n        } else {\n            console.error( \'Unknown PVR format.\' );\n        }\n    },\n    _parseV3: function ( pvrDatas ) {\n        var header = pvrDatas.header;\n        var bpp, format;\n\n        var metaLen = header[ 12 ],\n            pixelFormat = header[ 2 ],\n            height = header[ 6 ],\n            width = header[ 7 ],\n            // numSurfs = header[ 9 ],\n            numFaces = header[ 10 ],\n            numMipmaps = header[ 11 ];\n\n        switch ( pixelFormat ) {\n\n            case 0 : // PVRTC 2bpp RGB\n                bpp = 2;\n                format = RGB_PVRTC_2BPPV1_Format;\n                break;\n\n            case 1 : // PVRTC 2bpp RGBA\n                bpp = 2;\n                format = RGBA_PVRTC_2BPPV1_Format;\n                break;\n\n            case 2 : // PVRTC 4bpp RGB\n                bpp = 4;\n                format = RGB_PVRTC_4BPPV1_Format;\n                break;\n\n            case 3 : // PVRTC 4bpp RGBA\n                bpp = 4;\n                format = RGBA_PVRTC_4BPPV1_Format;\n                break;\n\n            default :\n                console.error( \'THREE.PVRLoader: Unsupported PVR format:\', pixelFormat );\n\n        }\n\n        pvrDatas.dataPtr = 52 + metaLen;\n        pvrDatas.bpp = bpp;\n        pvrDatas.format = format;\n        pvrDatas.width = width;\n        pvrDatas.height = height;\n        pvrDatas.numSurfaces = numFaces;\n        pvrDatas.numMipmaps = numMipmaps;\n        pvrDatas.isCubemap  = ( numFaces === 6 );\n\n        return this._extract( pvrDatas );\n    },\n    _parseV2: function ( pvrDatas ) {\n        var header = pvrDatas.header;\n\n        var headerLength = header[ 0 ],\n            height = header[ 1 ],\n            width = header[ 2 ],\n            numMipmaps = header[ 3 ],\n            flags = header[ 4 ],\n            // dataLength = header[ 5 ],\n            // bpp =  header[ 6 ],\n            // bitmaskRed = header[ 7 ],\n            // bitmaskGreen = header[ 8 ],\n            // bitmaskBlue = header[ 9 ],\n            bitmaskAlpha = header[ 10 ],\n            // pvrTag = header[ 11 ],\n            numSurfs = header[ 12 ];\n\n\n        var TYPE_MASK = 0xff;\n        var PVRTC_2 = 24,\n            PVRTC_4 = 25;\n\n        var formatFlags = flags & TYPE_MASK;\n\n        var bpp, format;\n        var _hasAlpha = bitmaskAlpha > 0;\n\n        if ( formatFlags === PVRTC_4 ) {\n\n            format = _hasAlpha ? RGBA_PVRTC_4BPPV1_Format : RGB_PVRTC_4BPPV1_Format;\n            bpp = 4;\n\n        } else if ( formatFlags === PVRTC_2 ) {\n\n            format = _hasAlpha ? RGBA_PVRTC_2BPPV1_Format : RGB_PVRTC_2BPPV1_Format;\n            bpp = 2;\n\n        } else {\n\n            console.error( \'THREE.PVRLoader: Unknown PVR format:\', formatFlags );\n\n        }\n\n        pvrDatas.dataPtr = headerLength;\n        pvrDatas.bpp = bpp;\n        pvrDatas.format = format;\n        pvrDatas.width = width;\n        pvrDatas.height = height;\n        pvrDatas.numSurfaces = numSurfs;\n        pvrDatas.numMipmaps = numMipmaps + 1;\n\n        // guess cubemap type seems tricky in v2\n        // it juste a pvr containing 6 surface (no explicit cubemap type)\n        pvrDatas.isCubemap  = ( numSurfs === 6 );\n\n        return this._extract( pvrDatas );\n    },\n    _extract: function ( pvrDatas) {\n        var pvr = {\n            mipmaps: [],\n            width: pvrDatas.width,\n            height: pvrDatas.height,\n            format: pvrDatas.format,\n            mipmapCount: pvrDatas.numMipmaps,\n            isCubemap: pvrDatas.isCubemap\n        };\n\n        var buffer = pvrDatas.buffer;\n\n        var dataOffset = pvrDatas.dataPtr,\n            bpp = pvrDatas.bpp,\n            numSurfs = pvrDatas.numSurfaces,\n            dataSize = 0,\n            blockSize = 0,\n            blockWidth = 0,\n            blockHeight = 0,\n            widthBlocks = 0,\n            heightBlocks = 0;\n\n        if ( bpp === 2 ) {\n            blockWidth = 8;\n            blockHeight = 4;\n        } else {\n            blockWidth = 4;\n            blockHeight = 4;\n        }\n\n        blockSize = ( blockWidth * blockHeight ) * bpp / 8;\n\n        pvr.mipmaps.length = pvrDatas.numMipmaps * numSurfs;\n\n        var mipLevel = 0;\n\n        while ( mipLevel < pvrDatas.numMipmaps ) {\n            var sWidth = pvrDatas.width >> mipLevel,\n                sHeight = pvrDatas.height >> mipLevel;\n\n            widthBlocks = sWidth / blockWidth;\n            heightBlocks = sHeight / blockHeight;\n\n            // Clamp to minimum number of blocks\n            if ( widthBlocks < 2 ) widthBlocks = 2;\n            if ( heightBlocks < 2 ) heightBlocks = 2;\n\n            dataSize = widthBlocks * heightBlocks * blockSize;\n\n            for ( var surfIndex = 0; surfIndex < numSurfs; surfIndex ++ ) {\n                var byteArray = new Uint8Array( buffer, dataOffset, dataSize );\n\n                var mipmap = {\n                    data: byteArray,\n                    width: sWidth,\n                    height: sHeight,\n                    getWidth: function() {\n                        return this.width;\n                    },\n                    getHeight: function() {\n                        return this.height;\n                    },\n                    getImage: function() {\n                        return this.data;\n                    },\n                };\n\n                pvr.mipmaps[ surfIndex * pvrDatas.numMipmaps + mipLevel ] = mipmap;\n\n                dataOffset += dataSize;\n            }\n            mipLevel ++;\n        }\n        return pvr;\n    },\n};\n\n__WEBPACK_IMPORTED_MODULE_3_osgDB_Registry__["a" /* default */].instance().addReaderWriter(\'pvr\', new ReaderWriterPVR());\n\n/* harmony default export */ __webpack_exports__["a"] = (ReaderWriterPVR);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./sources/osgPlugins/ReaderWriterPVR.js\n// module id = 267\n// module chunks = 0\n\n//# sourceURL=webpack:///./sources/osgPlugins/ReaderWriterPVR.js?')}])},module.exports=factory(__webpack_require__(6624),__webpack_require__(2635),__webpack_require__(840),function(){try{return __webpack_require__(9755)}catch(e){}}())},1383:function(e,n,t){var r=t(5108);e.exports=function(){"use strict";var e=function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]},n=1,t=2,a=4,i=5,o=484813681109536e-20,s=Math.PI/2,_=.16666666666666666,u=.04722222222222222,l=.022156084656084655,c=1e-10,h=.017453292519943295,d=57.29577951308232,f=Math.PI/4,p=2*Math.PI,m=3.14159265359,g={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},v={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},E=/[\s_\-\/\(\)]/g;function b(e,n){if(e[n])return e[n];for(var t,r=Object.keys(e),a=n.toLowerCase().replace(E,""),i=-1;++i<r.length;)if((t=r[i]).toLowerCase().replace(E,"")===a)return e[t]}var M=function(e){var n,t,r,a={},i=e.split("+").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,n){var t=n.split("=");return t.push(!0),e[t[0].toLowerCase()]=t[1],e}),{}),o={proj:"projName",datum:"datumCode",rf:function(e){a.rf=parseFloat(e)},lat_0:function(e){a.lat0=e*h},lat_1:function(e){a.lat1=e*h},lat_2:function(e){a.lat2=e*h},lat_ts:function(e){a.lat_ts=e*h},lon_0:function(e){a.long0=e*h},lon_1:function(e){a.long1=e*h},lon_2:function(e){a.long2=e*h},alpha:function(e){a.alpha=parseFloat(e)*h},lonc:function(e){a.longc=e*h},x_0:function(e){a.x0=parseFloat(e)},y_0:function(e){a.y0=parseFloat(e)},k_0:function(e){a.k0=parseFloat(e)},k:function(e){a.k0=parseFloat(e)},a:function(e){a.a=parseFloat(e)},b:function(e){a.b=parseFloat(e)},r_a:function(){a.R_A=!0},zone:function(e){a.zone=parseInt(e,10)},south:function(){a.utmSouth=!0},towgs84:function(e){a.datum_params=e.split(",").map((function(e){return parseFloat(e)}))},to_meter:function(e){a.to_meter=parseFloat(e)},units:function(e){a.units=e;var n=b(v,e);n&&(a.to_meter=n.to_meter)},from_greenwich:function(e){a.from_greenwich=e*h},pm:function(e){var n=b(g,e);a.from_greenwich=(n||parseFloat(e))*h},nadgrids:function(e){"@null"===e?a.datumCode="none":a.nadgrids=e},axis:function(e){var n="ewnsud";3===e.length&&-1!==n.indexOf(e.substr(0,1))&&-1!==n.indexOf(e.substr(1,1))&&-1!==n.indexOf(e.substr(2,1))&&(a.axis=e)}};for(n in i)t=i[n],n in o?"function"==typeof(r=o[n])?r(t):a[r]=t:a[n]=t;return"string"==typeof a.datumCode&&"WGS84"!==a.datumCode&&(a.datumCode=a.datumCode.toLowerCase()),a},y=1,O=2,P=3,x=4,D=5,T=-1,A=/\s/,C=/[A-Za-z]/,w=/[A-Za-z84]/,R=/[,\]]/,I=/[\d\.E\-\+]/;function L(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=y}function S(e){return new L(e).output()}function B(e,n,t){Array.isArray(n)&&(t.unshift(n),n=null);var r=n?{}:e,a=t.reduce((function(e,n){return U(n,e),e}),r);n&&(e[n]=a)}function U(e,n){if(Array.isArray(e)){var t,r=e.shift();if("PARAMETER"===r&&(r=e.shift()),1===e.length)return Array.isArray(e[0])?(n[r]={},void U(e[0],n[r])):void(n[r]=e[0]);if(e.length)if("TOWGS84"!==r)switch(Array.isArray(r)||(n[r]={}),r){case"UNIT":case"PRIMEM":case"VERT_DATUM":return n[r]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&U(e[2],n[r]));case"SPHEROID":case"ELLIPSOID":return n[r]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&U(e[3],n[r]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void B(n,r,e);default:for(t=-1;++t<e.length;)if(!Array.isArray(e[t]))return U(e,n[r]);return B(n,r,e)}else n[r]=e;else n[r]=!0}else n[e]=!0}L.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==x)for(;A.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case y:return this.neutral(e);case O:return this.keyword(e);case x:return this.quoted(e);case D:return this.afterquote(e);case P:return this.number(e);case T:return}},L.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=x);if(R.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},L.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=y)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=y,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=T))):void 0},L.prototype.number=function(e){if(!I.test(e)){if(R.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},L.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=D},L.prototype.keyword=function(e){if(w.test(e))this.word+=e;else{if("["===e){var n=[];return n.push(this.word),this.level++,null===this.root?this.root=n:this.currentObject.push(n),this.stack.push(this.currentObject),this.currentObject=n,void(this.state=y)}if(!R.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},L.prototype.neutral=function(e){if(C.test(e))return this.word=e,void(this.state=O);if('"'===e)return this.word="",void(this.state=x);if(I.test(e))return this.word=e,void(this.state=P);if(!R.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},L.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===T)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var k=.017453292519943295;function W(e,n){var t=n[0],r=n[1];!(t in e)&&r in e&&(e[t]=e[r],3===n.length&&(e[t]=n[2](e[t])))}function N(e){return e*k}function K(e){"GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"==typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var n=e.GEOGCS;function t(n){return n*(e.to_meter||1)}"GEOGCS"===e.type&&(n=e),n&&(n.DATUM?e.datumCode=n.DATUM.name.toLowerCase():e.datumCode=n.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==e.datumCode&&"new_zealand_1949"!==e.datumCode||(e.datumCode="nzgd49"),"wgs_1984"===e.datumCode&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),n.DATUM&&n.DATUM.SPHEROID&&(e.ellps=n.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=n.DATUM.SPHEROID.a,e.rf=parseFloat(n.DATUM.SPHEROID.rf,10)),n.DATUM&&n.DATUM.TOWGS84&&(e.datum_params=n.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",N],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",N],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",N],["lat0","latitude_of_origin",N],["lat0","standard_parallel_1",N],["lat1","standard_parallel_1",N],["lat2","standard_parallel_2",N],["azimuth","Azimuth"],["alpha","azimuth",N],["srsCode","name"]].forEach((function(n){return W(e,n)})),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName||(e.lat0=N(e.lat1>0?90:-90),e.lat_ts=e.lat1)}var F=function(e){var n=S(e),t=n.shift(),r=n.shift();n.unshift(["name",r]),n.unshift(["type",t]);var a={};return U(n,a),K(a),a};function j(e){var n=this;if(2===arguments.length){var t=arguments[1];"string"==typeof t?"+"===t.charAt(0)?j[e]=M(arguments[1]):j[e]=F(arguments[1]):j[e]=t}else if(1===arguments.length){if(Array.isArray(e))return e.map((function(e){Array.isArray(e)?j.apply(n,e):j(e)}));if("string"==typeof e){if(e in j)return j[e]}else"EPSG"in e?j["EPSG:"+e.EPSG]=e:"ESRI"in e?j["ESRI:"+e.ESRI]=e:"IAU2000"in e?j["IAU2000:"+e.IAU2000]=e:r.log(e);return}}function q(e){return"string"==typeof e}function V(e){return e in j}e(j);var G=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function z(e){return G.some((function(n){return e.indexOf(n)>-1}))}var H=["3857","900913","3785","102113"];function X(e){var n=b(e,"authority");if(n){var t=b(n,"epsg");return t&&H.indexOf(t)>-1}}function Y(e){var n=b(e,"extension");if(n)return b(n,"proj4")}function Z(e){return"+"===e[0]}function Q(e){if(!q(e))return e;if(V(e))return j[e];if(z(e)){var n=F(e);if(X(n))return j["EPSG:3857"];var t=Y(n);return t?M(t):n}return Z(e)?M(e):void 0}var $=function(e,n){var t,r;if(e=e||{},!n)return e;for(r in n)void 0!==(t=n[r])&&(e[r]=t);return e},J=function(e,n,t){var r=e*n;return t/Math.sqrt(1-r*r)},ee=function(e){return e<0?-1:1},ne=function(e){return Math.abs(e)<=m?e:e-ee(e)*p},te=function(e,n,t){var r=e*t,a=.5*e;return r=Math.pow((1-r)/(1+r),a),Math.tan(.5*(s-n))/r},re=function(e,n){for(var t,r,a=.5*e,i=s-2*Math.atan(n),o=0;o<=15;o++)if(t=e*Math.sin(i),i+=r=s-2*Math.atan(n*Math.pow((1-t)/(1+t),a))-i,Math.abs(r)<=1e-10)return i;return-9999};function ae(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=J(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function ie(e){var n,t,r=e.x,a=e.y;if(a*d>90&&a*d<-90&&r*d>180&&r*d<-180)return null;if(Math.abs(Math.abs(a)-s)<=c)return null;if(this.sphere)n=this.x0+this.a*this.k0*ne(r-this.long0),t=this.y0+this.a*this.k0*Math.log(Math.tan(f+.5*a));else{var i=Math.sin(a),o=te(this.e,a,i);n=this.x0+this.a*this.k0*ne(r-this.long0),t=this.y0-this.a*this.k0*Math.log(o)}return e.x=n,e.y=t,e}function oe(e){var n,t,r=e.x-this.x0,a=e.y-this.y0;if(this.sphere)t=s-2*Math.atan(Math.exp(-a/(this.a*this.k0)));else{var i=Math.exp(-a/(this.a*this.k0));if(-9999===(t=re(this.e,i)))return null}return n=ne(this.long0+r/(this.a*this.k0)),e.x=n,e.y=t,e}function se(){}function _e(e){return e}var ue=[{init:ae,forward:ie,inverse:oe,names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:se,forward:_e,inverse:_e,names:["longlat","identity"]}],le={},ce=[];function he(e,n){var t=ce.length;return e.names?(ce[t]=e,e.names.forEach((function(e){le[e.toLowerCase()]=t})),this):(r.log(n),!0)}function de(e){if(!e)return!1;var n=e.toLowerCase();return void 0!==le[n]&&ce[le[n]]?ce[le[n]]:void 0}function fe(){ue.forEach(he)}var pe={start:fe,add:he,get:de},me={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},ge=me.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};function ve(e,n,t,r){var a=e*e,i=n*n,o=(a-i)/a,s=0;return r?(a=(e*=1-o*(_+o*(u+o*l)))*e,o=0):s=Math.sqrt(o),{es:o,e:s,ep2:(a-i)/i}}function Ee(e,n,t,r,a){if(!e){var i=b(me,r);i||(i=ge),e=i.a,n=i.b,t=i.rf}return t&&!n&&(n=(1-1/t)*e),(0===t||Math.abs(e-n)<c)&&(a=!0,n=e),{a:e,b:n,rf:t,sphere:a}}me.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var be={};function Me(e,r,s,_,u,l){var c={};return c.datum_type=void 0===e||"none"===e?i:a,r&&(c.datum_params=r.map(parseFloat),0===c.datum_params[0]&&0===c.datum_params[1]&&0===c.datum_params[2]||(c.datum_type=n),c.datum_params.length>3&&(0===c.datum_params[3]&&0===c.datum_params[4]&&0===c.datum_params[5]&&0===c.datum_params[6]||(c.datum_type=t,c.datum_params[3]*=o,c.datum_params[4]*=o,c.datum_params[5]*=o,c.datum_params[6]=c.datum_params[6]/1e6+1))),c.a=s,c.b=_,c.es=u,c.ep2=l,c}function ye(e,n){if(!(this instanceof ye))return new ye(e);n=n||function(e){if(e)throw e};var t=Q(e);if("object"==typeof t){var r=ye.projections.get(t.projName);if(r){if(t.datumCode&&"none"!==t.datumCode){var a=b(be,t.datumCode);a&&(t.datum_params=a.towgs84?a.towgs84.split(","):null,t.ellps=a.ellipse,t.datumName=a.datumName?a.datumName:t.datumCode)}t.k0=t.k0||1,t.axis=t.axis||"enu",t.ellps=t.ellps||"wgs84";var i=Ee(t.a,t.b,t.rf,t.ellps,t.sphere),o=ve(i.a,i.b,i.rf,t.R_A),s=t.datum||Me(t.datumCode,t.datum_params,i.a,i.b,o.es,o.ep2);$(this,t),$(this,r),this.a=i.a,this.b=i.b,this.rf=i.rf,this.sphere=i.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=s,this.init(),n(null,this)}else n(e)}else n(e)}function Oe(e,r){return e.datum_type===r.datum_type&&!(e.a!==r.a||Math.abs(e.es-r.es)>5e-11)&&(e.datum_type===n?e.datum_params[0]===r.datum_params[0]&&e.datum_params[1]===r.datum_params[1]&&e.datum_params[2]===r.datum_params[2]:e.datum_type!==t||e.datum_params[0]===r.datum_params[0]&&e.datum_params[1]===r.datum_params[1]&&e.datum_params[2]===r.datum_params[2]&&e.datum_params[3]===r.datum_params[3]&&e.datum_params[4]===r.datum_params[4]&&e.datum_params[5]===r.datum_params[5]&&e.datum_params[6]===r.datum_params[6])}function Pe(e,n,t){var r,a,i,o,_=e.x,u=e.y,l=e.z?e.z:0;if(u<-s&&u>-1.001*s)u=-s;else if(u>s&&u<1.001*s)u=s;else{if(u<-s)return{x:-1/0,y:-1/0,z:e.z};if(u>s)return{x:1/0,y:1/0,z:e.z}}return _>Math.PI&&(_-=2*Math.PI),a=Math.sin(u),o=Math.cos(u),i=a*a,{x:((r=t/Math.sqrt(1-n*i))+l)*o*Math.cos(_),y:(r+l)*o*Math.sin(_),z:(r*(1-n)+l)*a}}function xe(e,n,t,r){var a,i,o,s,_,u,l,c,h,d,f,p,m,g,v,E=1e-12,b=E*E,M=30,y=e.x,O=e.y,P=e.z?e.z:0;if(a=Math.sqrt(y*y+O*O),i=Math.sqrt(y*y+O*O+P*P),a/t<E){if(g=0,i/t<E)return v=-r,{x:e.x,y:e.y,z:e.z}}else g=Math.atan2(O,y);o=P/i,c=(s=a/i)*(1-n)*(_=1/Math.sqrt(1-n*(2-n)*s*s)),h=o*_,m=0;do{m++,u=n*(l=t/Math.sqrt(1-n*h*h))/(l+(v=a*c+P*h-l*(1-n*h*h))),p=(f=o*(_=1/Math.sqrt(1-u*(2-u)*s*s)))*c-(d=s*(1-u)*_)*h,c=d,h=f}while(p*p>b&&m<M);return{x:g,y:Math.atan(f/Math.abs(d)),z:v}}function De(e,r,a){if(r===n)return{x:e.x+a[0],y:e.y+a[1],z:e.z+a[2]};if(r===t){var i=a[0],o=a[1],s=a[2],_=a[3],u=a[4],l=a[5],c=a[6];return{x:c*(e.x-l*e.y+u*e.z)+i,y:c*(l*e.x+e.y-_*e.z)+o,z:c*(-u*e.x+_*e.y+e.z)+s}}}function Te(e,r,a){if(r===n)return{x:e.x-a[0],y:e.y-a[1],z:e.z-a[2]};if(r===t){var i=a[0],o=a[1],s=a[2],_=a[3],u=a[4],l=a[5],c=a[6],h=(e.x-i)/c,d=(e.y-o)/c,f=(e.z-s)/c;return{x:h+l*d-u*f,y:-l*h+d+_*f,z:u*h-_*d+f}}}function Ae(e){return e===n||e===t}be.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},be.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},be.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},be.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},be.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},be.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},be.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},be.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},be.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},be.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},be.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},be.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},be.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},be.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},be.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},be.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},be.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},ye.projections=pe,ye.projections.start();var Ce=function(e,n,t){return Oe(e,n)||e.datum_type===i||n.datum_type===i?t:e.es!==n.es||e.a!==n.a||Ae(e.datum_type)||Ae(n.datum_type)?(t=Pe(t,e.es,e.a),Ae(e.datum_type)&&(t=De(t,e.datum_type,e.datum_params)),Ae(n.datum_type)&&(t=Te(t,n.datum_type,n.datum_params)),xe(t,n.es,n.a,n.b)):t},we=function(e,n,t){var r,a,i,o=t.x,s=t.y,_=t.z||0,u={};for(i=0;i<3;i++)if(!n||2!==i||void 0!==t.z)switch(0===i?(r=o,a="x"):1===i?(r=s,a="y"):(r=_,a="z"),e.axis[i]){case"e":case"n":u[a]=r;break;case"w":case"s":u[a]=-r;break;case"u":void 0!==t[a]&&(u.z=r);break;case"d":void 0!==t[a]&&(u.z=-r);break;default:return null}return u},Re=function(e){var n={x:e[0],y:e[1]};return e.length>2&&(n.z=e[2]),e.length>3&&(n.m=e[3]),n},Ie=function(e){Le(e.x),Le(e.y)};function Le(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function Se(e,r){return(e.datum.datum_type===n||e.datum.datum_type===t)&&"WGS84"!==r.datumCode||(r.datum.datum_type===n||r.datum.datum_type===t)&&"WGS84"!==e.datumCode}function Be(e,n,t){var r;return Array.isArray(t)&&(t=Re(t)),Ie(t),e.datum&&n.datum&&Se(e,n)&&(t=Be(e,r=new ye("WGS84"),t),e=r),"enu"!==e.axis&&(t=we(e,!1,t)),"longlat"===e.projName?t={x:t.x*h,y:t.y*h}:(e.to_meter&&(t={x:t.x*e.to_meter,y:t.y*e.to_meter}),t=e.inverse(t)),e.from_greenwich&&(t.x+=e.from_greenwich),t=Ce(e.datum,n.datum,t),n.from_greenwich&&(t={x:t.x-n.from_greenwich,y:t.y}),"longlat"===n.projName?t={x:t.x*d,y:t.y*d}:(t=n.forward(t),n.to_meter&&(t={x:t.x/n.to_meter,y:t.y/n.to_meter})),"enu"!==n.axis?we(n,!0,t):t}var Ue=ye("WGS84");function ke(e,n,t){var r,a,i;return Array.isArray(t)?(r=Be(e,n,t),3===t.length?[r.x,r.y,r.z]:[r.x,r.y]):(a=Be(e,n,t),2===(i=Object.keys(t)).length||i.forEach((function(e){"x"!==e&&"y"!==e&&(a[e]=t[e])})),a)}function We(e){return e instanceof ye?e:e.oProj?e.oProj:ye(e)}function Ne(e,n,t){e=We(e);var r,a=!1;return void 0===n?(n=e,e=Ue,a=!0):(void 0!==n.x||Array.isArray(n))&&(t=n,n=e,e=Ue,a=!0),n=We(n),t?ke(e,n,t):(r={forward:function(t){return ke(e,n,t)},inverse:function(t){return ke(n,e,t)}},a&&(r.oProj=n),r)}var Ke=6,Fe="AJSAJS",je="AFAFAF",qe=65,Ve=73,Ge=79,ze=86,He=90,Xe={forward:Ye,inverse:Ze,toPoint:Qe};function Ye(e,n){return n=n||5,rn(en({lat:e[1],lon:e[0]}),n)}function Ze(e){var n=nn(_n(e.toUpperCase()));return n.lat&&n.lon?[n.lon,n.lat,n.lon,n.lat]:[n.left,n.bottom,n.right,n.top]}function Qe(e){var n=nn(_n(e.toUpperCase()));return n.lat&&n.lon?[n.lon,n.lat]:[(n.left+n.right)/2,(n.top+n.bottom)/2]}function $e(e){return e*(Math.PI/180)}function Je(e){return e/Math.PI*180}function en(e){var n,t,r,a,i,o,s,_=e.lat,u=e.lon,l=6378137,c=.00669438,h=.9996,d=$e(_),f=$e(u);s=Math.floor((u+180)/6)+1,180===u&&(s=60),_>=56&&_<64&&u>=3&&u<12&&(s=32),_>=72&&_<84&&(u>=0&&u<9?s=31:u>=9&&u<21?s=33:u>=21&&u<33?s=35:u>=33&&u<42&&(s=37)),o=$e(6*(s-1)-180+3),n=c/(1-c),t=l/Math.sqrt(1-c*Math.sin(d)*Math.sin(d)),r=Math.tan(d)*Math.tan(d),a=n*Math.cos(d)*Math.cos(d);var p=h*t*((i=Math.cos(d)*(f-o))+(1-r+a)*i*i*i/6+(5-18*r+r*r+72*a-58*n)*i*i*i*i*i/120)+5e5,m=h*(l*((1-c/4-3*c*c/64-5*c*c*c/256)*d-(3*c/8+3*c*c/32+45*c*c*c/1024)*Math.sin(2*d)+(15*c*c/256+45*c*c*c/1024)*Math.sin(4*d)-35*c*c*c/3072*Math.sin(6*d))+t*Math.tan(d)*(i*i/2+(5-r+9*a+4*a*a)*i*i*i*i/24+(61-58*r+r*r+600*a-330*n)*i*i*i*i*i*i/720));return _<0&&(m+=1e7),{northing:Math.round(m),easting:Math.round(p),zoneNumber:s,zoneLetter:tn(_)}}function nn(e){var n=e.northing,t=e.easting,r=e.zoneLetter,a=e.zoneNumber;if(a<0||a>60)return null;var i,o,s,_,u,l,c,h,d,f=.9996,p=6378137,m=.00669438,g=(1-Math.sqrt(1-m))/(1+Math.sqrt(1-m)),v=t-5e5,E=n;r<"N"&&(E-=1e7),c=6*(a-1)-180+3,i=m/(1-m),d=(h=E/f/(p*(1-m/4-3*m*m/64-5*m*m*m/256)))+(3*g/2-27*g*g*g/32)*Math.sin(2*h)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*h)+151*g*g*g/96*Math.sin(6*h),o=p/Math.sqrt(1-m*Math.sin(d)*Math.sin(d)),s=Math.tan(d)*Math.tan(d),_=i*Math.cos(d)*Math.cos(d),u=p*(1-m)/Math.pow(1-m*Math.sin(d)*Math.sin(d),1.5),l=v/(o*f);var b=d-o*Math.tan(d)/u*(l*l/2-(5+3*s+10*_-4*_*_-9*i)*l*l*l*l/24+(61+90*s+298*_+45*s*s-252*i-3*_*_)*l*l*l*l*l*l/720);b=Je(b);var M,y=(l-(1+2*s+_)*l*l*l/6+(5-2*_+28*s-3*_*_+8*i+24*s*s)*l*l*l*l*l/120)/Math.cos(d);if(y=c+Je(y),e.accuracy){var O=nn({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});M={top:O.lat,right:O.lon,bottom:b,left:y}}else M={lat:b,lon:y};return M}function tn(e){var n="Z";return 84>=e&&e>=72?n="X":72>e&&e>=64?n="W":64>e&&e>=56?n="V":56>e&&e>=48?n="U":48>e&&e>=40?n="T":40>e&&e>=32?n="S":32>e&&e>=24?n="R":24>e&&e>=16?n="Q":16>e&&e>=8?n="P":8>e&&e>=0?n="N":0>e&&e>=-8?n="M":-8>e&&e>=-16?n="L":-16>e&&e>=-24?n="K":-24>e&&e>=-32?n="J":-32>e&&e>=-40?n="H":-40>e&&e>=-48?n="G":-48>e&&e>=-56?n="F":-56>e&&e>=-64?n="E":-64>e&&e>=-72?n="D":-72>e&&e>=-80&&(n="C"),n}function rn(e,n){var t="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+an(e.easting,e.northing,e.zoneNumber)+t.substr(t.length-5,n)+r.substr(r.length-5,n)}function an(e,n,t){var r=on(t);return sn(Math.floor(e/1e5),Math.floor(n/1e5)%20,r)}function on(e){var n=e%Ke;return 0===n&&(n=Ke),n}function sn(e,n,t){var r=t-1,a=Fe.charCodeAt(r),i=je.charCodeAt(r),o=a+e-1,s=i+n,_=!1;return o>He&&(o=o-He+qe-1,_=!0),(o===Ve||a<Ve&&o>Ve||(o>Ve||a<Ve)&&_)&&o++,(o===Ge||a<Ge&&o>Ge||(o>Ge||a<Ge)&&_)&&++o===Ve&&o++,o>He&&(o=o-He+qe-1),s>ze?(s=s-ze+qe-1,_=!0):_=!1,(s===Ve||i<Ve&&s>Ve||(s>Ve||i<Ve)&&_)&&s++,(s===Ge||i<Ge&&s>Ge||(s>Ge||i<Ge)&&_)&&++s===Ve&&s++,s>ze&&(s=s-ze+qe-1),String.fromCharCode(o)+String.fromCharCode(s)}function _n(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var n,t=e.length,r=null,a="",i=0;!/[A-Z]/.test(n=e.charAt(i));){if(i>=2)throw"MGRSPoint bad conversion from: "+e;a+=n,i++}var o=parseInt(a,10);if(0===i||i+3>t)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(i++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+e;r=e.substring(i,i+=2);for(var _=on(o),u=un(r.charAt(0),_),l=ln(r.charAt(1),_);l<cn(s);)l+=2e6;var c=t-i;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var h,d,f,p=c/2,m=0,g=0;return p>0&&(h=1e5/Math.pow(10,p),d=e.substring(i,i+p),m=parseFloat(d)*h,f=e.substring(i+p),g=parseFloat(f)*h),{easting:m+u,northing:g+l,zoneLetter:s,zoneNumber:o,accuracy:h}}function un(e,n){for(var t=Fe.charCodeAt(n-1),r=1e5,a=!1;t!==e.charCodeAt(0);){if(++t===Ve&&t++,t===Ge&&t++,t>He){if(a)throw"Bad character: "+e;t=qe,a=!0}r+=1e5}return r}function ln(e,n){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var t=je.charCodeAt(n-1),r=0,a=!1;t!==e.charCodeAt(0);){if(++t===Ve&&t++,t===Ge&&t++,t>ze){if(a)throw"Bad character: "+e;t=qe,a=!0}r+=1e5}return r}function cn(e){var n;switch(e){case"C":n=11e5;break;case"D":n=2e6;break;case"E":n=28e5;break;case"F":n=37e5;break;case"G":n=46e5;break;case"H":n=55e5;break;case"J":n=64e5;break;case"K":n=73e5;break;case"L":n=82e5;break;case"M":n=91e5;break;case"N":n=0;break;case"P":n=8e5;break;case"Q":n=17e5;break;case"R":n=26e5;break;case"S":n=35e5;break;case"T":n=44e5;break;case"U":n=53e5;break;case"V":n=62e5;break;case"W":n=7e6;break;case"X":n=79e5;break;default:n=-1}if(n>=0)return n;throw"Invalid zone letter: "+e}function hn(e,n,t){if(!(this instanceof hn))return new hn(e,n,t);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&void 0===n){var a=e.split(",");this.x=parseFloat(a[0],10),this.y=parseFloat(a[1],10),this.z=parseFloat(a[2],10)||0}else this.x=e,this.y=n,this.z=t||0;r.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}hn.fromMGRS=function(e){return new hn(Qe(e))},hn.prototype.toMGRS=function(e){return Ye([this.x,this.y],e)};var dn="2.5.0",fn=1,pn=.25,mn=.046875,gn=.01953125,vn=.01068115234375,En=.75,bn=.46875,Mn=.013020833333333334,yn=.007120768229166667,On=.3645833333333333,Pn=.005696614583333333,xn=.3076171875,Dn=function(e){var n=[];n[0]=fn-e*(pn+e*(mn+e*(gn+e*vn))),n[1]=e*(En-e*(mn+e*(gn+e*vn)));var t=e*e;return n[2]=t*(bn-e*(Mn+e*yn)),t*=e,n[3]=t*(On-e*Pn),n[4]=t*e*xn,n},Tn=function(e,n,t,r){return t*=n,n*=n,r[0]*e-t*(r[1]+n*(r[2]+n*(r[3]+n*r[4])))},An=20,Cn=function(e,n,t){for(var r=1/(1-n),a=e,i=An;i;--i){var o=Math.sin(a),s=1-n*o*o;if(a-=s=(Tn(a,o,Math.cos(a),t)-e)*(s*Math.sqrt(s))*r,Math.abs(s)<c)return a}return a};function wn(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Dn(this.es),this.ml0=Tn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function Rn(e){var n,t,r,a=e.x,i=e.y,o=ne(a-this.long0),s=Math.sin(i),_=Math.cos(i);if(this.es){var u=_*o,l=Math.pow(u,2),h=this.ep2*Math.pow(_,2),d=Math.pow(h,2),f=Math.abs(_)>c?Math.tan(i):0,p=Math.pow(f,2),m=Math.pow(p,2);n=1-this.es*Math.pow(s,2),u/=Math.sqrt(n);var g=Tn(i,s,_,this.en);t=this.a*(this.k0*u*(1+l/6*(1-p+h+l/20*(5-18*p+m+14*h-58*p*h+l/42*(61+179*m-m*p-479*p)))))+this.x0,r=this.a*(this.k0*(g-this.ml0+s*o*u/2*(1+l/12*(5-p+9*h+4*d+l/30*(61+m-58*p+270*h-330*p*h+l/56*(1385+543*m-m*p-3111*p))))))+this.y0}else{var v=_*Math.sin(o);if(Math.abs(Math.abs(v)-1)<c)return 93;if(t=.5*this.a*this.k0*Math.log((1+v)/(1-v))+this.x0,r=_*Math.cos(o)/Math.sqrt(1-Math.pow(v,2)),(v=Math.abs(r))>=1){if(v-1>c)return 93;r=0}else r=Math.acos(r);i<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return e.x=t,e.y=r,e}function In(e){var n,t,r,a,i=(e.x-this.x0)*(1/this.a),o=(e.y-this.y0)*(1/this.a);if(this.es)if(n=this.ml0+o/this.k0,t=Cn(n,this.es,this.en),Math.abs(t)<s){var _=Math.sin(t),u=Math.cos(t),l=Math.abs(u)>c?Math.tan(t):0,h=this.ep2*Math.pow(u,2),d=Math.pow(h,2),f=Math.pow(l,2),p=Math.pow(f,2);n=1-this.es*Math.pow(_,2);var m=i*Math.sqrt(n)/this.k0,g=Math.pow(m,2);r=t-(n*=l)*g/(1-this.es)*.5*(1-g/12*(5+3*f-9*h*f+h-4*d-g/30*(61+90*f-252*h*f+45*p+46*h-g/56*(1385+3633*f+4095*p+1574*p*f)))),a=ne(this.long0+m*(1-g/6*(1+2*f+h-g/20*(5+28*f+24*p+8*h*f+6*h-g/42*(61+662*f+1320*p+720*p*f))))/u)}else r=s*ee(o),a=0;else{var v=Math.exp(i/this.k0),E=.5*(v-1/v),b=this.lat0+o/this.k0,M=Math.cos(b);n=Math.sqrt((1-Math.pow(M,2))/(1+Math.pow(E,2))),r=Math.asin(n),o<0&&(r=-r),a=0===E&&0===M?0:ne(Math.atan2(E,M)+this.long0)}return e.x=a,e.y=r,e}var Ln={init:wn,forward:Rn,inverse:In,names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Sn=function(e){var n=Math.exp(e);return n=(n-1/n)/2},Bn=function(e,n){e=Math.abs(e),n=Math.abs(n);var t=Math.max(e,n),r=Math.min(e,n)/(t||1);return t*Math.sqrt(1+Math.pow(r,2))},Un=function(e){var n=1+e,t=n-1;return 0===t?e:e*Math.log(n)/t},kn=function(e){var n=Math.abs(e);return n=Un(n*(1+n/(Bn(1,n)+1))),e<0?-n:n},Wn=function(e,n){for(var t,r=2*Math.cos(2*n),a=e.length-1,i=e[a],o=0;--a>=0;)t=r*i-o+e[a],o=i,i=t;return n+t*Math.sin(2*n)},Nn=function(e,n){for(var t,r=2*Math.cos(n),a=e.length-1,i=e[a],o=0;--a>=0;)t=r*i-o+e[a],o=i,i=t;return Math.sin(n)*t},Kn=function(e){var n=Math.exp(e);return n=(n+1/n)/2},Fn=function(e,n,t){for(var r,a,i=Math.sin(n),o=Math.cos(n),s=Sn(t),_=Kn(t),u=2*o*_,l=-2*i*s,c=e.length-1,h=e[c],d=0,f=0,p=0;--c>=0;)r=f,a=d,h=u*(f=h)-r-l*(d=p)+e[c],p=l*f-a+u*d;return[(u=i*_)*h-(l=o*s)*p,u*p+l*h]};function jn(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),n=e/(2-e),t=n;this.cgb[0]=n*(2+n*(-2/3+n*(n*(116/45+n*(26/45+n*(-2854/675)))-2))),this.cbg[0]=n*(n*(2/3+n*(4/3+n*(-82/45+n*(32/45+n*(4642/4725)))))-2),t*=n,this.cgb[1]=t*(7/3+n*(n*(-227/45+n*(2704/315+n*(2323/945)))-1.6)),this.cbg[1]=t*(5/3+n*(-16/15+n*(-13/9+n*(904/315+n*(-1522/945))))),t*=n,this.cgb[2]=t*(56/15+n*(-136/35+n*(-1262/105+n*(73814/2835)))),this.cbg[2]=t*(-26/15+n*(34/21+n*(1.6+n*(-12686/2835)))),t*=n,this.cgb[3]=t*(4279/630+n*(-332/35+n*(-399572/14175))),this.cbg[3]=t*(1237/630+n*(n*(-24832/14175)-2.4)),t*=n,this.cgb[4]=t*(4174/315+n*(-144838/6237)),this.cbg[4]=t*(-734/315+n*(109598/31185)),t*=n,this.cgb[5]=t*(601676/22275),this.cbg[5]=t*(444337/155925),t=Math.pow(n,2),this.Qn=this.k0/(1+n)*(1+t*(1/4+t*(1/64+t/256))),this.utg[0]=n*(n*(2/3+n*(-37/96+n*(1/360+n*(81/512+n*(-96199/604800)))))-.5),this.gtu[0]=n*(.5+n*(-2/3+n*(5/16+n*(41/180+n*(-127/288+n*(7891/37800)))))),this.utg[1]=t*(-1/48+n*(-1/15+n*(437/1440+n*(-46/105+n*(1118711/3870720))))),this.gtu[1]=t*(13/48+n*(n*(557/1440+n*(281/630+n*(-1983433/1935360)))-.6)),t*=n,this.utg[2]=t*(-17/480+n*(37/840+n*(209/4480+n*(-5569/90720)))),this.gtu[2]=t*(61/240+n*(-103/140+n*(15061/26880+n*(167603/181440)))),t*=n,this.utg[3]=t*(-4397/161280+n*(11/504+n*(830251/7257600))),this.gtu[3]=t*(49561/161280+n*(-179/168+n*(6601661/7257600))),t*=n,this.utg[4]=t*(-4583/161280+n*(108847/3991680)),this.gtu[4]=t*(34729/80640+n*(-3418889/1995840)),t*=n,this.utg[5]=t*(-20648693/638668800),this.gtu[5]=.6650675310896665*t;var r=Wn(this.cbg,this.lat0);this.Zb=-this.Qn*(r+Nn(this.gtu,2*r))}function qn(e){var n=ne(e.x-this.long0),t=e.y;t=Wn(this.cbg,t);var r=Math.sin(t),a=Math.cos(t),i=Math.sin(n),o=Math.cos(n);t=Math.atan2(r,o*a),n=Math.atan2(i*a,Bn(r,a*o)),n=kn(Math.tan(n));var s,_,u=Fn(this.gtu,2*t,2*n);return t+=u[0],n+=u[1],Math.abs(n)<=2.623395162778?(s=this.a*(this.Qn*n)+this.x0,_=this.a*(this.Qn*t+this.Zb)+this.y0):(s=1/0,_=1/0),e.x=s,e.y=_,e}function Vn(e){var n,t,r=(e.x-this.x0)*(1/this.a),a=(e.y-this.y0)*(1/this.a);if(a=(a-this.Zb)/this.Qn,r/=this.Qn,Math.abs(r)<=2.623395162778){var i=Fn(this.utg,2*a,2*r);a+=i[0],r+=i[1],r=Math.atan(Sn(r));var o=Math.sin(a),s=Math.cos(a),_=Math.sin(r),u=Math.cos(r);a=Math.atan2(o*u,Bn(_,u*s)),r=Math.atan2(_,u*s),n=ne(r+this.long0),t=Wn(this.cgb,a)}else n=1/0,t=1/0;return e.x=n,e.y=t,e}var Gn={init:jn,forward:qn,inverse:Vn,names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]},zn=function(e,n){if(void 0===e){if((e=Math.floor(30*(ne(n)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e};function Hn(){var e=zn(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*h,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Gn.init.apply(this),this.forward=Gn.forward,this.inverse=Gn.inverse}var Xn={init:Hn,names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Yn=function(e,n){return Math.pow((1-e)/(1+e),n)},Zn=20;function Qn(){var e=Math.sin(this.lat0),n=Math.cos(this.lat0);n*=n,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*n*n/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+f)/(Math.pow(Math.tan(.5*this.lat0+f),this.C)*Yn(this.e*e,this.ratexp))}function $n(e){var n=e.x,t=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*t+f),this.C)*Yn(this.e*Math.sin(t),this.ratexp))-s,e.x=this.C*n,e}function Jn(e){for(var n=1e-14,t=e.x/this.C,r=e.y,a=Math.pow(Math.tan(.5*r+f)/this.K,1/this.C),i=Zn;i>0&&(r=2*Math.atan(a*Yn(this.e*Math.sin(e.y),-.5*this.e))-s,!(Math.abs(r-e.y)<n));--i)e.y=r;return i?(e.x=t,e.y=r,e):null}var et={init:Qn,forward:$n,inverse:Jn,names:["gauss"]};function nt(){et.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function tt(e){var n,t,r,a;return e.x=ne(e.x-this.long0),et.forward.apply(this,[e]),n=Math.sin(e.y),t=Math.cos(e.y),r=Math.cos(e.x),a=this.k0*this.R2/(1+this.sinc0*n+this.cosc0*t*r),e.x=a*t*Math.sin(e.x),e.y=a*(this.cosc0*n-this.sinc0*t*r),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function rt(e){var n,t,r,a,i;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,i=Math.sqrt(e.x*e.x+e.y*e.y)){var o=2*Math.atan2(i,this.R2);n=Math.sin(o),t=Math.cos(o),a=Math.asin(t*this.sinc0+e.y*n*this.cosc0/i),r=Math.atan2(e.x*n,i*this.cosc0*t-e.y*this.sinc0*n)}else a=this.phic0,r=0;return e.x=r,e.y=a,et.inverse.apply(this,[e]),e.x=ne(e.x+this.long0),e}var at={init:nt,forward:tt,inverse:rt,names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};function it(e,n,t){return n*=t,Math.tan(.5*(s+e))*Math.pow((1-n)/(1+n),.5*t)}function ot(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=c&&(this.k0=.5*(1+ee(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=c&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=c&&(this.k0=.5*this.cons*J(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/te(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=J(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-s,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function st(e){var n,t,r,a,i,o,_=e.x,u=e.y,l=Math.sin(u),h=Math.cos(u),d=ne(_-this.long0);return Math.abs(Math.abs(_-this.long0)-Math.PI)<=c&&Math.abs(u+this.lat0)<=c?(e.x=NaN,e.y=NaN,e):this.sphere?(n=2*this.k0/(1+this.sinlat0*l+this.coslat0*h*Math.cos(d)),e.x=this.a*n*h*Math.sin(d)+this.x0,e.y=this.a*n*(this.coslat0*l-this.sinlat0*h*Math.cos(d))+this.y0,e):(t=2*Math.atan(this.ssfn_(u,l,this.e))-s,a=Math.cos(t),r=Math.sin(t),Math.abs(this.coslat0)<=c?(i=te(this.e,u*this.con,this.con*l),o=2*this.a*this.k0*i/this.cons,e.x=this.x0+o*Math.sin(_-this.long0),e.y=this.y0-this.con*o*Math.cos(_-this.long0),e):(Math.abs(this.sinlat0)<c?(n=2*this.a*this.k0/(1+a*Math.cos(d)),e.y=n*r):(n=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*a*Math.cos(d))),e.y=n*(this.cosX0*r-this.sinX0*a*Math.cos(d))+this.y0),e.x=n*a*Math.sin(d)+this.x0,e))}function _t(e){var n,t,r,a,i;e.x-=this.x0,e.y-=this.y0;var o=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var _=2*Math.atan(o/(2*this.a*this.k0));return n=this.long0,t=this.lat0,o<=c?(e.x=n,e.y=t,e):(t=Math.asin(Math.cos(_)*this.sinlat0+e.y*Math.sin(_)*this.coslat0/o),n=Math.abs(this.coslat0)<c?this.lat0>0?ne(this.long0+Math.atan2(e.x,-1*e.y)):ne(this.long0+Math.atan2(e.x,e.y)):ne(this.long0+Math.atan2(e.x*Math.sin(_),o*this.coslat0*Math.cos(_)-e.y*this.sinlat0*Math.sin(_))),e.x=n,e.y=t,e)}if(Math.abs(this.coslat0)<=c){if(o<=c)return t=this.lat0,n=this.long0,e.x=n,e.y=t,e;e.x*=this.con,e.y*=this.con,r=o*this.cons/(2*this.a*this.k0),t=this.con*re(this.e,r),n=this.con*ne(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else a=2*Math.atan(o*this.cosX0/(2*this.a*this.k0*this.ms1)),n=this.long0,o<=c?i=this.X0:(i=Math.asin(Math.cos(a)*this.sinX0+e.y*Math.sin(a)*this.cosX0/o),n=ne(this.long0+Math.atan2(e.x*Math.sin(a),o*this.cosX0*Math.cos(a)-e.y*this.sinX0*Math.sin(a)))),t=-1*re(this.e,Math.tan(.5*(s+i)));return e.x=n,e.y=t,e}var ut={init:ot,forward:st,inverse:_t,names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:it};function lt(){var e=this.lat0;this.lambda0=this.long0;var n=Math.sin(e),t=this.a,r=1/this.rf,a=2*r-Math.pow(r,2),i=this.e=Math.sqrt(a);this.R=this.k0*t*Math.sqrt(1-a)/(1-a*Math.pow(n,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(n/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+e/2)),_=Math.log((1+i*n)/(1-i*n));this.K=o-this.alpha*s+this.alpha*i/2*_}function ct(e){var n=Math.log(Math.tan(Math.PI/4-e.y/2)),t=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(n+t)+this.K,a=2*(Math.atan(Math.exp(r))-Math.PI/4),i=this.alpha*(e.x-this.lambda0),o=Math.atan(Math.sin(i)/(Math.sin(this.b0)*Math.tan(a)+Math.cos(this.b0)*Math.cos(i))),s=Math.asin(Math.cos(this.b0)*Math.sin(a)-Math.sin(this.b0)*Math.cos(a)*Math.cos(i));return e.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,e.x=this.R*o+this.x0,e}function ht(e){for(var n=e.x-this.x0,t=e.y-this.y0,r=n/this.R,a=2*(Math.atan(Math.exp(t/this.R))-Math.PI/4),i=Math.asin(Math.cos(this.b0)*Math.sin(a)+Math.sin(this.b0)*Math.cos(a)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(a))),s=this.lambda0+o/this.alpha,_=0,u=i,l=-1e3,c=0;Math.abs(u-l)>1e-7;){if(++c>20)return;_=1/this.alpha*(Math.log(Math.tan(Math.PI/4+i/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(u))/2)),l=u,u=2*Math.atan(Math.exp(_))-Math.PI/2}return e.x=s,e.y=u,e}var dt={init:lt,forward:ct,inverse:ht,names:["somerc"]};function ft(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),n=Math.cos(this.lat0),t=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(n,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-t*t);var r,a,i=te(this.e,this.lat0,e),o=this.bl/n*Math.sqrt((1-this.es)/(1-t*t));if(o*o<1&&(o=1),isNaN(this.longc)){var s=te(this.e,this.lat1,Math.sin(this.lat1)),_=te(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(o+Math.sqrt(o*o-1))*Math.pow(i,this.bl):this.el=(o-Math.sqrt(o*o-1))*Math.pow(i,this.bl);var u=Math.pow(s,this.bl),l=Math.pow(_,this.bl);a=.5*((r=this.el/u)-1/r);var c=(this.el*this.el-l*u)/(this.el*this.el+l*u),h=(l-u)/(l+u),d=ne(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(c*Math.tan(.5*this.bl*d)/h)/this.bl,this.long0=ne(this.long0);var f=ne(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*f)/a),this.alpha=Math.asin(o*Math.sin(this.gamma0))}else r=this.lat0>=0?o+Math.sqrt(o*o-1):o-Math.sqrt(o*o-1),this.el=r*Math.pow(i,this.bl),a=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/o),this.long0=this.longc-Math.asin(a*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha))}function pt(e){var n,t,r,a=e.x,i=e.y,o=ne(a-this.long0);if(Math.abs(Math.abs(i)-s)<=c)r=i>0?-1:1,t=this.al/this.bl*Math.log(Math.tan(f+r*this.gamma0*.5)),n=-1*r*s*this.al/this.bl;else{var _=te(this.e,i,Math.sin(i)),u=this.el/Math.pow(_,this.bl),l=.5*(u-1/u),h=.5*(u+1/u),d=Math.sin(this.bl*o),p=(l*Math.sin(this.gamma0)-d*Math.cos(this.gamma0))/h;t=Math.abs(Math.abs(p)-1)<=c?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,n=Math.abs(Math.cos(this.bl*o))<=c?this.al*this.bl*o:this.al*Math.atan2(l*Math.cos(this.gamma0)+d*Math.sin(this.gamma0),Math.cos(this.bl*o))/this.bl}return this.no_rot?(e.x=this.x0+n,e.y=this.y0+t):(n-=this.uc,e.x=this.x0+t*Math.cos(this.alpha)+n*Math.sin(this.alpha),e.y=this.y0+n*Math.cos(this.alpha)-t*Math.sin(this.alpha)),e}function mt(e){var n,t;this.no_rot?(t=e.y-this.y0,n=e.x-this.x0):(t=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),n=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),n+=this.uc);var r=Math.exp(-1*this.bl*t/this.al),a=.5*(r-1/r),i=.5*(r+1/r),o=Math.sin(this.bl*n/this.al),_=(o*Math.cos(this.gamma0)+a*Math.sin(this.gamma0))/i,u=Math.pow(this.el/Math.sqrt((1+_)/(1-_)),1/this.bl);return Math.abs(_-1)<c?(e.x=this.long0,e.y=s):Math.abs(_+1)<c?(e.x=this.long0,e.y=-1*s):(e.y=re(this.e,u),e.x=ne(this.long0-Math.atan2(a*Math.cos(this.gamma0)-o*Math.sin(this.gamma0),Math.cos(this.bl*n/this.al))/this.bl)),e}var gt={init:ft,forward:pt,inverse:mt,names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]};function vt(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<c)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var n=Math.sin(this.lat1),t=Math.cos(this.lat1),r=J(this.e,n,t),a=te(this.e,this.lat1,n),i=Math.sin(this.lat2),o=Math.cos(this.lat2),s=J(this.e,i,o),_=te(this.e,this.lat2,i),u=te(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>c?this.ns=Math.log(r/s)/Math.log(a/_):this.ns=n,isNaN(this.ns)&&(this.ns=n),this.f0=r/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(u,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Et(e){var n=e.x,t=e.y;Math.abs(2*Math.abs(t)-Math.PI)<=c&&(t=ee(t)*(s-2*c));var r,a,i=Math.abs(Math.abs(t)-s);if(i>c)r=te(this.e,t,Math.sin(t)),a=this.a*this.f0*Math.pow(r,this.ns);else{if((i=t*this.ns)<=0)return null;a=0}var o=this.ns*ne(n-this.long0);return e.x=this.k0*(a*Math.sin(o))+this.x0,e.y=this.k0*(this.rh-a*Math.cos(o))+this.y0,e}function bt(e){var n,t,r,a,i,o=(e.x-this.x0)/this.k0,_=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(n=Math.sqrt(o*o+_*_),t=1):(n=-Math.sqrt(o*o+_*_),t=-1);var u=0;if(0!==n&&(u=Math.atan2(t*o,t*_)),0!==n||this.ns>0){if(t=1/this.ns,r=Math.pow(n/(this.a*this.f0),t),-9999===(a=re(this.e,r)))return null}else a=-s;return i=ne(u/this.ns+this.long0),e.x=i,e.y=a,e}var Mt={init:vt,forward:Et,inverse:bt,names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]};function yt(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Ot(e){var n,t,r,a,i,o,s,_=e.x,u=e.y,l=ne(_-this.long0);return n=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),t=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/n)-this.s45),r=-l*this.alfa,a=Math.asin(Math.cos(this.ad)*Math.sin(t)+Math.sin(this.ad)*Math.cos(t)*Math.cos(r)),i=Math.asin(Math.cos(t)*Math.sin(r)/Math.cos(a)),o=this.n*i,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(a/2+this.s45),this.n),e.y=s*Math.cos(o)/1,e.x=s*Math.sin(o)/1,this.czech||(e.y*=-1,e.x*=-1),e}function Pt(e){var n,t,r,a,i,o,s,_=e.x;e.x=e.y,e.y=_,this.czech||(e.y*=-1,e.x*=-1),i=Math.sqrt(e.x*e.x+e.y*e.y),a=Math.atan2(e.y,e.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/i,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),n=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(a)),t=Math.asin(Math.cos(r)*Math.sin(a)/Math.cos(n)),e.x=this.long0-t/this.alfa,o=n,s=0;var u=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(n/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-e.y)<1e-10&&(s=1),o=e.y,u+=1}while(0===s&&u<15);return u>=15?null:e}var xt={init:yt,forward:Ot,inverse:Pt,names:["Krovak","krovak"]},Dt=function(e,n,t,r,a){return e*a-n*Math.sin(2*a)+t*Math.sin(4*a)-r*Math.sin(6*a)},Tt=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},At=function(e){return.375*e*(1+.25*e*(1+.46875*e))},Ct=function(e){return.05859375*e*e*(1+.75*e)},wt=function(e){return e*e*e*(35/3072)},Rt=function(e,n,t){var r=n*t;return e/Math.sqrt(1-r*r)},It=function(e){return Math.abs(e)<s?e:e-ee(e)*Math.PI},Lt=function(e,n,t,r,a){var i,o;i=e/n;for(var s=0;s<15;s++)if(i+=o=(e-(n*i-t*Math.sin(2*i)+r*Math.sin(4*i)-a*Math.sin(6*i)))/(n-2*t*Math.cos(2*i)+4*r*Math.cos(4*i)-6*a*Math.cos(6*i)),Math.abs(o)<=1e-10)return i;return NaN};function St(){this.sphere||(this.e0=Tt(this.es),this.e1=At(this.es),this.e2=Ct(this.es),this.e3=wt(this.es),this.ml0=this.a*Dt(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Bt(e){var n,t,r=e.x,a=e.y;if(r=ne(r-this.long0),this.sphere)n=this.a*Math.asin(Math.cos(a)*Math.sin(r)),t=this.a*(Math.atan2(Math.tan(a),Math.cos(r))-this.lat0);else{var i=Math.sin(a),o=Math.cos(a),s=Rt(this.a,this.e,i),_=Math.tan(a)*Math.tan(a),u=r*Math.cos(a),l=u*u,c=this.es*o*o/(1-this.es);n=s*u*(1-l*_*(1/6-(8-_+8*c)*l/120)),t=this.a*Dt(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+s*i/o*l*(.5+(5-_+6*c)*l/24)}return e.x=n+this.x0,e.y=t+this.y0,e}function Ut(e){e.x-=this.x0,e.y-=this.y0;var n,t,r=e.x/this.a,a=e.y/this.a;if(this.sphere){var i=a+this.lat0;n=Math.asin(Math.sin(i)*Math.cos(r)),t=Math.atan2(Math.tan(r),Math.cos(i))}else{var o=this.ml0/this.a+a,_=Lt(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(_)-s)<=c)return e.x=this.long0,e.y=s,a<0&&(e.y*=-1),e;var u=Rt(this.a,this.e,Math.sin(_)),l=u*u*u/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(_),2),d=r*this.a/u,f=d*d;n=_-u*Math.tan(_)/l*d*d*(.5-(1+3*h)*d*d/24),t=d*(1-f*(h/3+(1+3*h)*h*f/15))/Math.cos(_)}return e.x=ne(t+this.long0),e.y=It(n),e}var kt={init:St,forward:Bt,inverse:Ut,names:["Cassini","Cassini_Soldner","cass"]},Wt=function(e,n){var t;return e>1e-7?(1-e*e)*(n/(1-(t=e*n)*t)-.5/e*Math.log((1-t)/(1+t))):2*n};function Nt(){var e,n=Math.abs(this.lat0);if(Math.abs(n-s)<c?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(n)<c?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Wt(this.e,1),this.mmf=.5/(1-this.es),this.apa=Xt(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Wt(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Kt(e){var n,t,r,a,i,o,_,u,l,h,d=e.x,p=e.y;if(d=ne(d-this.long0),this.sphere){if(i=Math.sin(p),h=Math.cos(p),r=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((t=this.mode===this.EQUIT?1+h*r:1+this.sinph0*i+this.cosph0*h*r)<=c)return null;n=(t=Math.sqrt(2/t))*h*Math.sin(d),t*=this.mode===this.EQUIT?i:this.cosph0*i-this.sinph0*h*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(p+this.phi0)<c)return null;t=f-.5*p,n=(t=2*(this.mode===this.S_POLE?Math.cos(t):Math.sin(t)))*Math.sin(d),t*=r}}else{switch(_=0,u=0,l=0,r=Math.cos(d),a=Math.sin(d),i=Math.sin(p),o=Wt(this.e,i),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(_=o/this.qp,u=Math.sqrt(1-_*_)),this.mode){case this.OBLIQ:l=1+this.sinb1*_+this.cosb1*u*r;break;case this.EQUIT:l=1+u*r;break;case this.N_POLE:l=s+p,o=this.qp-o;break;case this.S_POLE:l=p-s,o=this.qp+o}if(Math.abs(l)<c)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),t=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*_-this.sinb1*u*r):(l=Math.sqrt(2/(1+u*r)))*_*this.ymf,n=this.xmf*l*u*a;break;case this.N_POLE:case this.S_POLE:o>=0?(n=(l=Math.sqrt(o))*a,t=r*(this.mode===this.S_POLE?l:-l)):n=t=0}}return e.x=this.a*n+this.x0,e.y=this.a*t+this.y0,e}function Ft(e){e.x-=this.x0,e.y-=this.y0;var n,t,r,a,i,o,_,u=e.x/this.a,l=e.y/this.a;if(this.sphere){var h,d=0,f=0;if((t=.5*(h=Math.sqrt(u*u+l*l)))>1)return null;switch(t=2*Math.asin(t),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(f=Math.sin(t),d=Math.cos(t)),this.mode){case this.EQUIT:t=Math.abs(h)<=c?0:Math.asin(l*f/h),u*=f,l=d*h;break;case this.OBLIQ:t=Math.abs(h)<=c?this.phi0:Math.asin(d*this.sinph0+l*f*this.cosph0/h),u*=f*this.cosph0,l=(d-Math.sin(t)*this.sinph0)*h;break;case this.N_POLE:l=-l,t=s-t;break;case this.S_POLE:t-=s}n=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,l):0}else{if(_=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,l*=this.dd,(o=Math.sqrt(u*u+l*l))<c)return e.x=0,e.y=this.phi0,e;a=2*Math.asin(.5*o/this.rq),r=Math.cos(a),u*=a=Math.sin(a),this.mode===this.OBLIQ?(_=r*this.sinb1+l*a*this.cosb1/o,i=this.qp*_,l=o*this.cosb1*r-l*this.sinb1*a):(_=l*a/o,i=this.qp*_,l=o*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),!(i=u*u+l*l))return e.x=0,e.y=this.phi0,e;_=1-i/this.qp,this.mode===this.S_POLE&&(_=-_)}n=Math.atan2(u,l),t=Yt(Math.asin(_),this.apa)}return e.x=ne(this.long0+n),e.y=t,e}var jt=.3333333333333333,qt=.17222222222222222,Vt=.10257936507936508,Gt=.06388888888888888,zt=.0664021164021164,Ht=.016415012942191543;function Xt(e){var n,t=[];return t[0]=e*jt,n=e*e,t[0]+=n*qt,t[1]=n*Gt,n*=e,t[0]+=n*Vt,t[1]+=n*zt,t[2]=n*Ht,t}function Yt(e,n){var t=e+e;return e+n[0]*Math.sin(t)+n[1]*Math.sin(t+t)+n[2]*Math.sin(t+t+t)}var Zt={init:Nt,forward:Kt,inverse:Ft,names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Qt=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)};function $t(){Math.abs(this.lat1+this.lat2)<c||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=J(this.e3,this.sin_po,this.cos_po),this.qs1=Wt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=J(this.e3,this.sin_po,this.cos_po),this.qs2=Wt(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Wt(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>c?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function Jt(e){var n=e.x,t=e.y;this.sin_phi=Math.sin(t),this.cos_phi=Math.cos(t);var r=Wt(this.e3,this.sin_phi,this.cos_phi),a=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,i=this.ns0*ne(n-this.long0),o=a*Math.sin(i)+this.x0,s=this.rh-a*Math.cos(i)+this.y0;return e.x=o,e.y=s,e}function er(e){var n,t,r,a,i,o;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),a=0,0!==n&&(a=Math.atan2(r*e.x,r*e.y)),r=n*this.ns0/this.a,this.sphere?o=Math.asin((this.c-r*r)/(2*this.ns0)):(t=(this.c-r*r)/this.ns0,o=this.phi1z(this.e3,t)),i=ne(a/this.ns0+this.long0),e.x=i,e.y=o,e}function nr(e,n){var t,r,a,i,o=Qt(.5*n);if(e<c)return o;for(var s=e*e,_=1;_<=25;_++)if(o+=i=.5*(a=1-(r=e*(t=Math.sin(o)))*r)*a/Math.cos(o)*(n/(1-s)-t/a+.5/e*Math.log((1-r)/(1+r))),Math.abs(i)<=1e-7)return o;return null}var tr={init:$t,forward:Jt,inverse:er,names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:nr};function rr(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function ar(e){var n,t,r,a,i,o,s,_,u=e.x,l=e.y;return r=ne(u-this.long0),n=Math.sin(l),t=Math.cos(l),a=Math.cos(r),i=1,(o=this.sin_p14*n+this.cos_p14*t*a)>0||Math.abs(o)<=c?(s=this.x0+this.a*i*t*Math.sin(r)/o,_=this.y0+this.a*i*(this.cos_p14*n-this.sin_p14*t*a)/o):(s=this.x0+this.infinity_dist*t*Math.sin(r),_=this.y0+this.infinity_dist*(this.cos_p14*n-this.sin_p14*t*a)),e.x=s,e.y=_,e}function ir(e){var n,t,r,a,i,o;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(n=Math.sqrt(e.x*e.x+e.y*e.y))?(a=Math.atan2(n,this.rc),t=Math.sin(a),r=Math.cos(a),o=Qt(r*this.sin_p14+e.y*t*this.cos_p14/n),i=Math.atan2(e.x*t,n*this.cos_p14*r-e.y*this.sin_p14*t),i=ne(this.long0+i)):(o=this.phic0,i=0),e.x=i,e.y=o,e}var or={init:rr,forward:ar,inverse:ir,names:["gnom"]},sr=function(e,n){var t=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(n)-t)<1e-6)return n<0?-1*s:s;for(var r,a,i,o,_=Math.asin(.5*n),u=0;u<30;u++)if(a=Math.sin(_),i=Math.cos(_),o=e*a,_+=r=Math.pow(1-o*o,2)/(2*i)*(n/(1-e*e)-a/(1-o*o)+.5/e*Math.log((1-o)/(1+o))),Math.abs(r)<=1e-10)return _;return NaN};function _r(){this.sphere||(this.k0=J(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function ur(e){var n,t,r=e.x,a=e.y,i=ne(r-this.long0);if(this.sphere)n=this.x0+this.a*i*Math.cos(this.lat_ts),t=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var o=Wt(this.e,Math.sin(a));n=this.x0+this.a*this.k0*i,t=this.y0+this.a*o*.5/this.k0}return e.x=n,e.y=t,e}function lr(e){var n,t;return e.x-=this.x0,e.y-=this.y0,this.sphere?(n=ne(this.long0+e.x/this.a/Math.cos(this.lat_ts)),t=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(t=sr(this.e,2*e.y*this.k0/this.a),n=ne(this.long0+e.x/(this.a*this.k0))),e.x=n,e.y=t,e}var cr={init:_r,forward:ur,inverse:lr,names:["cea"]};function hr(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function dr(e){var n=e.x,t=e.y,r=ne(n-this.long0),a=It(t-this.lat0);return e.x=this.x0+this.a*r*this.rc,e.y=this.y0+this.a*a,e}function fr(e){var n=e.x,t=e.y;return e.x=ne(this.long0+(n-this.x0)/(this.a*this.rc)),e.y=It(this.lat0+(t-this.y0)/this.a),e}var pr={init:hr,forward:dr,inverse:fr,names:["Equirectangular","Equidistant_Cylindrical","eqc"]},mr=20;function gr(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Tt(this.es),this.e1=At(this.es),this.e2=Ct(this.es),this.e3=wt(this.es),this.ml0=this.a*Dt(this.e0,this.e1,this.e2,this.e3,this.lat0)}function vr(e){var n,t,r,a=e.x,i=e.y,o=ne(a-this.long0);if(r=o*Math.sin(i),this.sphere)Math.abs(i)<=c?(n=this.a*o,t=-1*this.a*this.lat0):(n=this.a*Math.sin(r)/Math.tan(i),t=this.a*(It(i-this.lat0)+(1-Math.cos(r))/Math.tan(i)));else if(Math.abs(i)<=c)n=this.a*o,t=-1*this.ml0;else{var s=Rt(this.a,this.e,Math.sin(i))/Math.tan(i);n=s*Math.sin(r),t=this.a*Dt(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+s*(1-Math.cos(r))}return e.x=n+this.x0,e.y=t+this.y0,e}function Er(e){var n,t,r,a,i,o,s,_,u;if(r=e.x-this.x0,a=e.y-this.y0,this.sphere)if(Math.abs(a+this.a*this.lat0)<=c)n=ne(r/this.a+this.long0),t=0;else{var l;for(o=this.lat0+a/this.a,s=r*r/this.a/this.a+o*o,_=o,i=mr;i;--i)if(_+=u=-1*(o*(_*(l=Math.tan(_))+1)-_-.5*(_*_+s)*l)/((_-o)/l-1),Math.abs(u)<=c){t=_;break}n=ne(this.long0+Math.asin(r*Math.tan(_)/this.a)/Math.sin(t))}else if(Math.abs(a+this.ml0)<=c)t=0,n=ne(this.long0+r/this.a);else{var h,d,f,p,m;for(o=(this.ml0+a)/this.a,s=r*r/this.a/this.a+o*o,_=o,i=mr;i;--i)if(m=this.e*Math.sin(_),h=Math.sqrt(1-m*m)*Math.tan(_),d=this.a*Dt(this.e0,this.e1,this.e2,this.e3,_),f=this.e0-2*this.e1*Math.cos(2*_)+4*this.e2*Math.cos(4*_)-6*this.e3*Math.cos(6*_),_-=u=(o*(h*(p=d/this.a)+1)-p-.5*h*(p*p+s))/(this.es*Math.sin(2*_)*(p*p+s-2*o*p)/(4*h)+(o-p)*(h*f-2/Math.sin(2*_))-f),Math.abs(u)<=c){t=_;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(t),2))*Math.tan(t),n=ne(this.long0+Math.asin(r*h/this.a)/Math.sin(t))}return e.x=n,e.y=t,e}var br={init:gr,forward:vr,inverse:Er,names:["Polyconic","poly"]};function Mr(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function yr(e){var n,t=e.x,r=e.y-this.lat0,a=t-this.long0,i=r/o*1e-5,s=a,_=1,u=0;for(n=1;n<=10;n++)_*=i,u+=this.A[n]*_;var l,c=u,h=s,d=1,f=0,p=0,m=0;for(n=1;n<=6;n++)l=f*c+d*h,d=d*c-f*h,f=l,p=p+this.B_re[n]*d-this.B_im[n]*f,m=m+this.B_im[n]*d+this.B_re[n]*f;return e.x=m*this.a+this.x0,e.y=p*this.a+this.y0,e}function Or(e){var n,t,r=e.x,a=e.y,i=r-this.x0,s=(a-this.y0)/this.a,_=i/this.a,u=1,l=0,c=0,h=0;for(n=1;n<=6;n++)t=l*s+u*_,u=u*s-l*_,l=t,c=c+this.C_re[n]*u-this.C_im[n]*l,h=h+this.C_im[n]*u+this.C_re[n]*l;for(var d=0;d<this.iterations;d++){var f,p=c,m=h,g=s,v=_;for(n=2;n<=6;n++)f=m*c+p*h,p=p*c-m*h,m=f,g+=(n-1)*(this.B_re[n]*p-this.B_im[n]*m),v+=(n-1)*(this.B_im[n]*p+this.B_re[n]*m);p=1,m=0;var E=this.B_re[1],b=this.B_im[1];for(n=2;n<=6;n++)f=m*c+p*h,p=p*c-m*h,m=f,E+=n*(this.B_re[n]*p-this.B_im[n]*m),b+=n*(this.B_im[n]*p+this.B_re[n]*m);var M=E*E+b*b;c=(g*E+v*b)/M,h=(v*E-g*b)/M}var y=c,O=h,P=1,x=0;for(n=1;n<=9;n++)P*=y,x+=this.D[n]*P;var D=this.lat0+x*o*1e5,T=this.long0+O;return e.x=T,e.y=D,e}var Pr={init:Mr,forward:yr,inverse:Or,names:["New_Zealand_Map_Grid","nzmg"]};function xr(){}function Dr(e){var n=e.x,t=e.y,r=ne(n-this.long0),a=this.x0+this.a*r,i=this.y0+this.a*Math.log(Math.tan(Math.PI/4+t/2.5))*1.25;return e.x=a,e.y=i,e}function Tr(e){e.x-=this.x0,e.y-=this.y0;var n=ne(this.long0+e.x/this.a),t=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=n,e.y=t,e}var Ar={init:xr,forward:Dr,inverse:Tr,names:["Miller_Cylindrical","mill"]},Cr=20;function wr(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Dn(this.es)}function Rr(e){var n,t,r=e.x,a=e.y;if(r=ne(r-this.long0),this.sphere){if(this.m)for(var i=this.n*Math.sin(a),o=Cr;o;--o){var s=(this.m*a+Math.sin(a)-i)/(this.m+Math.cos(a));if(a-=s,Math.abs(s)<c)break}else a=1!==this.n?Math.asin(this.n*Math.sin(a)):a;n=this.a*this.C_x*r*(this.m+Math.cos(a)),t=this.a*this.C_y*a}else{var _=Math.sin(a),u=Math.cos(a);t=this.a*Tn(a,_,u,this.en),n=this.a*r*u/Math.sqrt(1-this.es*_*_)}return e.x=n,e.y=t,e}function Ir(e){var n,t,r,a;return e.x-=this.x0,r=e.x/this.a,e.y-=this.y0,n=e.y/this.a,this.sphere?(n/=this.C_y,r/=this.C_x*(this.m+Math.cos(n)),this.m?n=Qt((this.m*n+Math.sin(n))/this.n):1!==this.n&&(n=Qt(Math.sin(n)/this.n)),r=ne(r+this.long0),n=It(n)):(n=Cn(e.y/this.a,this.es,this.en),(a=Math.abs(n))<s?(a=Math.sin(n),t=this.long0+e.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(n)),r=ne(t)):a-c<s&&(r=this.long0)),e.x=r,e.y=n,e}var Lr={init:wr,forward:Rr,inverse:Ir,names:["Sinusoidal","sinu"]};function Sr(){}function Br(e){for(var n=e.x,t=e.y,r=ne(n-this.long0),a=t,i=Math.PI*Math.sin(t);;){var o=-(a+Math.sin(a)-i)/(1+Math.cos(a));if(a+=o,Math.abs(o)<c)break}a/=2,Math.PI/2-Math.abs(t)<c&&(r=0);var s=.900316316158*this.a*r*Math.cos(a)+this.x0,_=1.4142135623731*this.a*Math.sin(a)+this.y0;return e.x=s,e.y=_,e}function Ur(e){var n,t;e.x-=this.x0,e.y-=this.y0,t=e.y/(1.4142135623731*this.a),Math.abs(t)>.999999999999&&(t=.999999999999),n=Math.asin(t);var r=ne(this.long0+e.x/(.900316316158*this.a*Math.cos(n)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),t=(2*n+Math.sin(2*n))/Math.PI,Math.abs(t)>1&&(t=1);var a=Math.asin(t);return e.x=r,e.y=a,e}var kr={init:Sr,forward:Br,inverse:Ur,names:["Mollweide","moll"]};function Wr(){Math.abs(this.lat1+this.lat2)<c||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Tt(this.es),this.e1=At(this.es),this.e2=Ct(this.es),this.e3=wt(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=J(this.e,this.sinphi,this.cosphi),this.ml1=Dt(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<c?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=J(this.e,this.sinphi,this.cosphi),this.ml2=Dt(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Dt(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Nr(e){var n,t=e.x,r=e.y;if(this.sphere)n=this.a*(this.g-r);else{var a=Dt(this.e0,this.e1,this.e2,this.e3,r);n=this.a*(this.g-a)}var i=this.ns*ne(t-this.long0),o=this.x0+n*Math.sin(i),s=this.y0+this.rh-n*Math.cos(i);return e.x=o,e.y=s,e}function Kr(e){var n,t,r,a;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),n=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),n=-1);var i=0;if(0!==t&&(i=Math.atan2(n*e.x,n*e.y)),this.sphere)return a=ne(this.long0+i/this.ns),r=It(this.g-t/this.a),e.x=a,e.y=r,e;var o=this.g-t/this.a;return r=Lt(o,this.e0,this.e1,this.e2,this.e3),a=ne(this.long0+i/this.ns),e.x=a,e.y=r,e}var Fr={init:Wr,forward:Nr,inverse:Kr,names:["Equidistant_Conic","eqdc"]};function jr(){this.R=this.a}function qr(e){var n,t,r=e.x,a=e.y,i=ne(r-this.long0);Math.abs(a)<=c&&(n=this.x0+this.R*i,t=this.y0);var o=Qt(2*Math.abs(a/Math.PI));(Math.abs(i)<=c||Math.abs(Math.abs(a)-s)<=c)&&(n=this.x0,t=a>=0?this.y0+Math.PI*this.R*Math.tan(.5*o):this.y0+Math.PI*this.R*-Math.tan(.5*o));var _=.5*Math.abs(Math.PI/i-i/Math.PI),u=_*_,l=Math.sin(o),h=Math.cos(o),d=h/(l+h-1),f=d*d,p=d*(2/l-1),m=p*p,g=Math.PI*this.R*(_*(d-m)+Math.sqrt(u*(d-m)*(d-m)-(m+u)*(f-m)))/(m+u);i<0&&(g=-g),n=this.x0+g;var v=u+d;return g=Math.PI*this.R*(p*v-_*Math.sqrt((m+u)*(u+1)-v*v))/(m+u),t=a>=0?this.y0+g:this.y0-g,e.x=n,e.y=t,e}function Vr(e){var n,t,r,a,i,o,s,_,u,l,h,d;return e.x-=this.x0,e.y-=this.y0,h=Math.PI*this.R,i=(r=e.x/h)*r+(a=e.y/h)*a,h=3*(a*a/(_=-2*(o=-Math.abs(a)*(1+i))+1+2*a*a+i*i)+(2*(s=o-2*a*a+r*r)*s*s/_/_/_-9*o*s/_/_)/27)/(u=(o-s*s/3/_)/_)/(l=2*Math.sqrt(-u/3)),Math.abs(h)>1&&(h=h>=0?1:-1),d=Math.acos(h)/3,t=e.y>=0?(-l*Math.cos(d+Math.PI/3)-s/3/_)*Math.PI:-(-l*Math.cos(d+Math.PI/3)-s/3/_)*Math.PI,n=Math.abs(r)<c?this.long0:ne(this.long0+Math.PI*(i-1+Math.sqrt(1+2*(r*r-a*a)+i*i))/2/r),e.x=n,e.y=t,e}var Gr={init:jr,forward:qr,inverse:Vr,names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};function zr(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Hr(e){var n,t,r,a,i,o,_,u,l,h,d,f,p,m,g,v,E,b,M,y,O,P,x=e.x,D=e.y,T=Math.sin(e.y),A=Math.cos(e.y),C=ne(x-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=c?(e.x=this.x0+this.a*(s-D)*Math.sin(C),e.y=this.y0-this.a*(s-D)*Math.cos(C),e):Math.abs(this.sin_p12+1)<=c?(e.x=this.x0+this.a*(s+D)*Math.sin(C),e.y=this.y0+this.a*(s+D)*Math.cos(C),e):(b=this.sin_p12*T+this.cos_p12*A*Math.cos(C),E=(v=Math.acos(b))/Math.sin(v),e.x=this.x0+this.a*E*A*Math.sin(C),e.y=this.y0+this.a*E*(this.cos_p12*T-this.sin_p12*A*Math.cos(C)),e):(n=Tt(this.es),t=At(this.es),r=Ct(this.es),a=wt(this.es),Math.abs(this.sin_p12-1)<=c?(i=this.a*Dt(n,t,r,a,s),o=this.a*Dt(n,t,r,a,D),e.x=this.x0+(i-o)*Math.sin(C),e.y=this.y0-(i-o)*Math.cos(C),e):Math.abs(this.sin_p12+1)<=c?(i=this.a*Dt(n,t,r,a,s),o=this.a*Dt(n,t,r,a,D),e.x=this.x0+(i+o)*Math.sin(C),e.y=this.y0+(i+o)*Math.cos(C),e):(_=T/A,u=Rt(this.a,this.e,this.sin_p12),l=Rt(this.a,this.e,T),h=Math.atan((1-this.es)*_+this.es*u*this.sin_p12/(l*A)),M=0===(d=Math.atan2(Math.sin(C),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(C)))?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(d)-Math.PI)<=c?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(C)*Math.cos(h)/Math.sin(d)),f=this.e*this.sin_p12/Math.sqrt(1-this.es),v=u*M*(1-(y=M*M)*(g=(p=this.e*this.cos_p12*Math.cos(d)/Math.sqrt(1-this.es))*p)*(1-g)/6+(O=y*M)/8*(m=f*p)*(1-2*g)+(P=O*M)/120*(g*(4-7*g)-3*f*f*(1-7*g))-P*M/48*m),e.x=this.x0+v*Math.sin(d),e.y=this.y0+v*Math.cos(d),e))}function Xr(e){var n,t,r,a,i,o,_,u,l,h,d,f,p,m,g,v,E,b,M,y,O,P;if(e.x-=this.x0,e.y-=this.y0,this.sphere){if((n=Math.sqrt(e.x*e.x+e.y*e.y))>2*s*this.a)return;return t=n/this.a,r=Math.sin(t),a=Math.cos(t),i=this.long0,Math.abs(n)<=c?o=this.lat0:(o=Qt(a*this.sin_p12+e.y*r*this.cos_p12/n),_=Math.abs(this.lat0)-s,i=Math.abs(_)<=c?this.lat0>=0?ne(this.long0+Math.atan2(e.x,-e.y)):ne(this.long0-Math.atan2(-e.x,e.y)):ne(this.long0+Math.atan2(e.x*r,n*this.cos_p12*a-e.y*this.sin_p12*r))),e.x=i,e.y=o,e}return u=Tt(this.es),l=At(this.es),h=Ct(this.es),d=wt(this.es),Math.abs(this.sin_p12-1)<=c?(f=this.a*Dt(u,l,h,d,s),n=Math.sqrt(e.x*e.x+e.y*e.y),o=Lt((f-n)/this.a,u,l,h,d),i=ne(this.long0+Math.atan2(e.x,-1*e.y)),e.x=i,e.y=o,e):Math.abs(this.sin_p12+1)<=c?(f=this.a*Dt(u,l,h,d,s),n=Math.sqrt(e.x*e.x+e.y*e.y),o=Lt((n-f)/this.a,u,l,h,d),i=ne(this.long0+Math.atan2(e.x,e.y)),e.x=i,e.y=o,e):(n=Math.sqrt(e.x*e.x+e.y*e.y),g=Math.atan2(e.x,e.y),p=Rt(this.a,this.e,this.sin_p12),v=Math.cos(g),b=-(E=this.e*this.cos_p12*v)*E/(1-this.es),M=3*this.es*(1-b)*this.sin_p12*this.cos_p12*v/(1-this.es),P=1-b*(O=(y=n/p)-b*(1+b)*Math.pow(y,3)/6-M*(1+3*b)*Math.pow(y,4)/24)*O/2-y*O*O*O/6,m=Math.asin(this.sin_p12*Math.cos(O)+this.cos_p12*Math.sin(O)*v),i=ne(this.long0+Math.asin(Math.sin(g)*Math.sin(O)/Math.cos(m))),o=Math.atan((1-this.es*P*this.sin_p12/Math.sin(m))*Math.tan(m)/(1-this.es)),e.x=i,e.y=o,e)}var Yr={init:zr,forward:Hr,inverse:Xr,names:["Azimuthal_Equidistant","aeqd"]};function Zr(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Qr(e){var n,t,r,a,i,o,s,_,u=e.x,l=e.y;return r=ne(u-this.long0),n=Math.sin(l),t=Math.cos(l),a=Math.cos(r),i=1,((o=this.sin_p14*n+this.cos_p14*t*a)>0||Math.abs(o)<=c)&&(s=this.a*i*t*Math.sin(r),_=this.y0+this.a*i*(this.cos_p14*n-this.sin_p14*t*a)),e.x=s,e.y=_,e}function $r(e){var n,t,r,a,i,o,_;return e.x-=this.x0,e.y-=this.y0,n=Math.sqrt(e.x*e.x+e.y*e.y),t=Qt(n/this.a),r=Math.sin(t),a=Math.cos(t),o=this.long0,Math.abs(n)<=c?(_=this.lat0,e.x=o,e.y=_,e):(_=Qt(a*this.sin_p14+e.y*r*this.cos_p14/n),i=Math.abs(this.lat0)-s,Math.abs(i)<=c?(o=this.lat0>=0?ne(this.long0+Math.atan2(e.x,-e.y)):ne(this.long0-Math.atan2(-e.x,e.y)),e.x=o,e.y=_,e):(o=ne(this.long0+Math.atan2(e.x*r,n*this.cos_p14*a-e.y*this.sin_p14*r)),e.x=o,e.y=_,e))}var Jr={init:Zr,forward:Qr,inverse:$r,names:["ortho"]},ea={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},na={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function ta(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=s-f/2?this.face=ea.TOP:this.lat0<=-(s-f/2)?this.face=ea.BOTTOM:Math.abs(this.long0)<=f?this.face=ea.FRONT:Math.abs(this.long0)<=s+f?this.face=this.long0>0?ea.RIGHT:ea.LEFT:this.face=ea.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function ra(e){var n,t,r,a,i,o,_={x:0,y:0},u={value:0};if(e.x-=this.long0,n=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,t=e.x,this.face===ea.TOP)a=s-n,t>=f&&t<=s+f?(u.value=na.AREA_0,r=t-s):t>s+f||t<=-(s+f)?(u.value=na.AREA_1,r=t>0?t-m:t+m):t>-(s+f)&&t<=-f?(u.value=na.AREA_2,r=t+s):(u.value=na.AREA_3,r=t);else if(this.face===ea.BOTTOM)a=s+n,t>=f&&t<=s+f?(u.value=na.AREA_0,r=-t+s):t<f&&t>=-f?(u.value=na.AREA_1,r=-t):t<-f&&t>=-(s+f)?(u.value=na.AREA_2,r=-t-s):(u.value=na.AREA_3,r=t>0?-t+m:-t-m);else{var l,c,h,d,p,g;this.face===ea.RIGHT?t=oa(t,+s):this.face===ea.BACK?t=oa(t,+m):this.face===ea.LEFT&&(t=oa(t,-s)),d=Math.sin(n),p=Math.cos(n),g=Math.sin(t),l=p*Math.cos(t),c=p*g,h=d,this.face===ea.FRONT?r=ia(a=Math.acos(l),h,c,u):this.face===ea.RIGHT?r=ia(a=Math.acos(c),h,-l,u):this.face===ea.BACK?r=ia(a=Math.acos(-l),h,-c,u):this.face===ea.LEFT?r=ia(a=Math.acos(-c),h,l,u):(a=r=0,u.value=na.AREA_0)}return o=Math.atan(12/m*(r+Math.acos(Math.sin(r)*Math.cos(f))-s)),i=Math.sqrt((1-Math.cos(a))/(Math.cos(o)*Math.cos(o))/(1-Math.cos(Math.atan(1/Math.cos(r))))),u.value===na.AREA_1?o+=s:u.value===na.AREA_2?o+=m:u.value===na.AREA_3&&(o+=1.5*m),_.x=i*Math.cos(o),_.y=i*Math.sin(o),_.x=_.x*this.a+this.x0,_.y=_.y*this.a+this.y0,e.x=_.x,e.y=_.y,e}function aa(e){var n,t,r,a,i,o,_,u,l,c,h,d,f={lam:0,phi:0},p={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,t=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),n=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?p.value=na.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(p.value=na.AREA_1,n-=s):e.x<0&&-e.x>=Math.abs(e.y)?(p.value=na.AREA_2,n=n<0?n+m:n-m):(p.value=na.AREA_3,n+=s),l=m/12*Math.tan(n),i=Math.sin(l)/(Math.cos(l)-1/Math.sqrt(2)),o=Math.atan(i),(_=1-(r=Math.cos(n))*r*(a=Math.tan(t))*a*(1-Math.cos(Math.atan(1/Math.cos(o)))))<-1?_=-1:_>1&&(_=1),this.face===ea.TOP)u=Math.acos(_),f.phi=s-u,p.value===na.AREA_0?f.lam=o+s:p.value===na.AREA_1?f.lam=o<0?o+m:o-m:p.value===na.AREA_2?f.lam=o-s:f.lam=o;else if(this.face===ea.BOTTOM)u=Math.acos(_),f.phi=u-s,p.value===na.AREA_0?f.lam=-o+s:p.value===na.AREA_1?f.lam=-o:p.value===na.AREA_2?f.lam=-o-s:f.lam=o<0?-o-m:-o+m;else{var g,v,E;l=(g=_)*g,v=(l+=(E=l>=1?0:Math.sqrt(1-l)*Math.sin(o))*E)>=1?0:Math.sqrt(1-l),p.value===na.AREA_1?(l=v,v=-E,E=l):p.value===na.AREA_2?(v=-v,E=-E):p.value===na.AREA_3&&(l=v,v=E,E=-l),this.face===ea.RIGHT?(l=g,g=-v,v=l):this.face===ea.BACK?(g=-g,v=-v):this.face===ea.LEFT&&(l=g,g=v,v=-l),f.phi=Math.acos(-E)-s,f.lam=Math.atan2(v,g),this.face===ea.RIGHT?f.lam=oa(f.lam,-s):this.face===ea.BACK?f.lam=oa(f.lam,-m):this.face===ea.LEFT&&(f.lam=oa(f.lam,+s))}return 0!==this.es&&(c=f.phi<0?1:0,h=Math.tan(f.phi),d=this.b/Math.sqrt(h*h+this.one_minus_f_squared),f.phi=Math.atan(Math.sqrt(this.a*this.a-d*d)/(this.one_minus_f*d)),c&&(f.phi=-f.phi)),f.lam+=this.long0,e.x=f.lam,e.y=f.phi,e}function ia(e,n,t,r){var a;return e<c?(r.value=na.AREA_0,a=0):(a=Math.atan2(n,t),Math.abs(a)<=f?r.value=na.AREA_0:a>f&&a<=s+f?(r.value=na.AREA_1,a-=s):a>s+f||a<=-(s+f)?(r.value=na.AREA_2,a=a>=0?a-m:a+m):(r.value=na.AREA_3,a+=s)),a}function oa(e,n){var t=e+n;return t<-m?t+=p:t>+m&&(t-=p),t}var sa={init:ta,forward:ra,inverse:aa,names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},_a=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],ua=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],la=.8487,ca=1.3523,ha=d/5,da=1/ha,fa=18,pa=function(e,n){return e[0]+n*(e[1]+n*(e[2]+n*e[3]))},ma=function(e,n){return e[1]+n*(2*e[2]+3*n*e[3])};function ga(e,n,t,r){for(var a=n;r;--r){var i=e(a);if(a-=i,Math.abs(i)<t)break}return a}function va(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Ea(e){var n=ne(e.x-this.long0),t=Math.abs(e.y),r=Math.floor(t*ha);r<0?r=0:r>=fa&&(r=fa-1),t=d*(t-da*r);var a={x:pa(_a[r],t)*n,y:pa(ua[r],t)};return e.y<0&&(a.y=-a.y),a.x=a.x*this.a*la+this.x0,a.y=a.y*this.a*ca+this.y0,a}function ba(e){var n={x:(e.x-this.x0)/(this.a*la),y:Math.abs(e.y-this.y0)/(this.a*ca)};if(n.y>=1)n.x/=_a[fa][0],n.y=e.y<0?-s:s;else{var t=Math.floor(n.y*fa);for(t<0?t=0:t>=fa&&(t=fa-1);;)if(ua[t][0]>n.y)--t;else{if(!(ua[t+1][0]<=n.y))break;++t}var r=ua[t],a=5*(n.y-r[0])/(ua[t+1][0]-r[0]);a=ga((function(e){return(pa(r,e)-n.y)/ma(r,e)}),a,c,100),n.x/=pa(_a[t],a),n.y=(5*t+a)*h,e.y<0&&(n.y=-n.y)}return n.x=ne(n.x+this.long0),n}var Ma={init:va,forward:Ea,inverse:ba,names:["Robinson","robin"]},ya=function(e){e.Proj.projections.add(Ln),e.Proj.projections.add(Gn),e.Proj.projections.add(Xn),e.Proj.projections.add(at),e.Proj.projections.add(ut),e.Proj.projections.add(dt),e.Proj.projections.add(gt),e.Proj.projections.add(Mt),e.Proj.projections.add(xt),e.Proj.projections.add(kt),e.Proj.projections.add(Zt),e.Proj.projections.add(tr),e.Proj.projections.add(or),e.Proj.projections.add(cr),e.Proj.projections.add(pr),e.Proj.projections.add(br),e.Proj.projections.add(Pr),e.Proj.projections.add(Ar),e.Proj.projections.add(Lr),e.Proj.projections.add(kr),e.Proj.projections.add(Fr),e.Proj.projections.add(Gr),e.Proj.projections.add(Yr),e.Proj.projections.add(Jr),e.Proj.projections.add(sa),e.Proj.projections.add(Ma)};return Ne.defaultDatum="WGS84",Ne.Proj=ye,Ne.WGS84=new Ne.Proj("WGS84"),Ne.Point=hn,Ne.toPoint=Re,Ne.defs=j,Ne.transform=Be,Ne.mgrs=Xe,Ne.version=dn,ya(Ne),Ne}()},9282:(e,n,t)=>{"use strict";var r=t(4155),a=t(5108);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,o=void 0,o=function(e,n){if("object"!==i(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(a,"string"),"symbol"===i(o)?o:String(o)),r)}var a,o}function s(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var _,u,l=t(2136).codes,c=l.ERR_AMBIGUOUS_ARGUMENT,h=l.ERR_INVALID_ARG_TYPE,d=l.ERR_INVALID_ARG_VALUE,f=l.ERR_INVALID_RETURN_VALUE,p=l.ERR_MISSING_ARGS,m=t(5961),g=t(9539).inspect,v=t(9539).types,E=v.isPromise,b=v.isRegExp,M=t(8162)(),y=t(5624)(),O=t(1924)("RegExp.prototype.test");new Map;function P(){var e=t(9158);_=e.isDeepEqual,u=e.isDeepStrictEqual}var x=!1,D=e.exports=w,T={};function A(e){if(e.message instanceof Error)throw e.message;throw new m(e)}function C(e,n,t,r){if(!t){var a=!1;if(0===n)a=!0,r="No value argument passed to `assert.ok()`";else if(r instanceof Error)throw r;var i=new m({actual:t,expected:!0,message:r,operator:"==",stackStartFn:e});throw i.generatedMessage=a,i}}function w(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];C.apply(void 0,[w,n.length].concat(n))}D.fail=function e(n,t,i,o,s){var _,u=arguments.length;if(0===u)_="Failed";else if(1===u)i=n,n=void 0;else{if(!1===x)x=!0,(r.emitWarning?r.emitWarning:a.warn.bind(a))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094");2===u&&(o="!=")}if(i instanceof Error)throw i;var l={actual:n,expected:t,operator:void 0===o?"fail":o,stackStartFn:s||e};void 0!==i&&(l.message=i);var c=new m(l);throw _&&(c.message=_,c.generatedMessage=!0),c},D.AssertionError=m,D.ok=w,D.equal=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");n!=t&&A({actual:n,expected:t,message:r,operator:"==",stackStartFn:e})},D.notEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");n==t&&A({actual:n,expected:t,message:r,operator:"!=",stackStartFn:e})},D.deepEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");void 0===_&&P(),_(n,t)||A({actual:n,expected:t,message:r,operator:"deepEqual",stackStartFn:e})},D.notDeepEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");void 0===_&&P(),_(n,t)&&A({actual:n,expected:t,message:r,operator:"notDeepEqual",stackStartFn:e})},D.deepStrictEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");void 0===_&&P(),u(n,t)||A({actual:n,expected:t,message:r,operator:"deepStrictEqual",stackStartFn:e})},D.notDeepStrictEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");void 0===_&&P();u(n,t)&&A({actual:n,expected:t,message:r,operator:"notDeepStrictEqual",stackStartFn:e})},D.strictEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");y(n,t)||A({actual:n,expected:t,message:r,operator:"strictEqual",stackStartFn:e})},D.notStrictEqual=function e(n,t,r){if(arguments.length<2)throw new p("actual","expected");y(n,t)&&A({actual:n,expected:t,message:r,operator:"notStrictEqual",stackStartFn:e})};var R=s((function e(n,t,r){var a=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),t.forEach((function(e){e in n&&(void 0!==r&&"string"==typeof r[e]&&b(n[e])&&O(n[e],r[e])?a[e]=r[e]:a[e]=n[e])}))}));function I(e,n,t,r){if("function"!=typeof n){if(b(n))return O(n,e);if(2===arguments.length)throw new h("expected",["Function","RegExp"],n);if("object"!==i(e)||null===e){var a=new m({actual:e,expected:n,message:t,operator:"deepStrictEqual",stackStartFn:r});throw a.operator=r.name,a}var o=Object.keys(n);if(n instanceof Error)o.push("name","message");else if(0===o.length)throw new d("error",n,"may not be an empty object");return void 0===_&&P(),o.forEach((function(a){"string"==typeof e[a]&&b(n[a])&&O(n[a],e[a])||function(e,n,t,r,a,i){if(!(t in e)||!u(e[t],n[t])){if(!r){var o=new R(e,a),s=new R(n,a,e),_=new m({actual:o,expected:s,operator:"deepStrictEqual",stackStartFn:i});throw _.actual=e,_.expected=n,_.operator=i.name,_}A({actual:e,expected:n,message:r,operator:i.name,stackStartFn:i})}}(e,n,a,t,o,r)})),!0}return void 0!==n.prototype&&e instanceof n||!Error.isPrototypeOf(n)&&!0===n.call({},e)}function L(e){if("function"!=typeof e)throw new h("fn","Function",e);try{e()}catch(e){return e}return T}function S(e){return E(e)||null!==e&&"object"===i(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function B(e){return Promise.resolve().then((function(){var n;if("function"==typeof e){if(!S(n=e()))throw new f("instance of Promise","promiseFn",n)}else{if(!S(e))throw new h("promiseFn",["Function","Promise"],e);n=e}return Promise.resolve().then((function(){return n})).then((function(){return T})).catch((function(e){return e}))}))}function U(e,n,t,r){if("string"==typeof t){if(4===arguments.length)throw new h("error",["Object","Error","Function","RegExp"],t);if("object"===i(n)&&null!==n){if(n.message===t)throw new c("error/message",'The error message "'.concat(n.message,'" is identical to the message.'))}else if(n===t)throw new c("error/message",'The error "'.concat(n,'" is identical to the message.'));r=t,t=void 0}else if(null!=t&&"object"!==i(t)&&"function"!=typeof t)throw new h("error",["Object","Error","Function","RegExp"],t);if(n===T){var a="";t&&t.name&&(a+=" (".concat(t.name,")")),a+=r?": ".concat(r):".";var o="rejects"===e.name?"rejection":"exception";A({actual:void 0,expected:t,operator:e.name,message:"Missing expected ".concat(o).concat(a),stackStartFn:e})}if(t&&!I(n,t,r,e))throw n}function k(e,n,t,r){if(n!==T){if("string"==typeof t&&(r=t,t=void 0),!t||I(n,t)){var a=r?": ".concat(r):".",i="doesNotReject"===e.name?"rejection":"exception";A({actual:n,expected:t,operator:e.name,message:"Got unwanted ".concat(i).concat(a,"\n")+'Actual message: "'.concat(n&&n.message,'"'),stackStartFn:e})}throw n}}function W(e,n,t,r,a){if(!b(n))throw new h("regexp","RegExp",n);var o="match"===a;if("string"!=typeof e||O(n,e)!==o){if(t instanceof Error)throw t;var s=!t;t=t||("string"!=typeof e?'The "string" argument must be of type string. Received type '+"".concat(i(e)," (").concat(g(e),")"):(o?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(g(n),". Input:\n\n").concat(g(e),"\n"));var _=new m({actual:e,expected:n,message:t,operator:a,stackStartFn:r});throw _.generatedMessage=s,_}}function N(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];C.apply(void 0,[N,n.length].concat(n))}D.throws=function e(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];U.apply(void 0,[e,L(n)].concat(r))},D.rejects=function e(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return B(n).then((function(n){return U.apply(void 0,[e,n].concat(r))}))},D.doesNotThrow=function e(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];k.apply(void 0,[e,L(n)].concat(r))},D.doesNotReject=function e(n){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return B(n).then((function(n){return k.apply(void 0,[e,n].concat(r))}))},D.ifError=function e(n){if(null!=n){var t="ifError got unwanted exception: ";"object"===i(n)&&"string"==typeof n.message?0===n.message.length&&n.constructor?t+=n.constructor.name:t+=n.message:t+=g(n);var r=new m({actual:n,expected:null,operator:"ifError",message:t,stackStartFn:e}),a=n.stack;if("string"==typeof a){var o=a.split("\n");o.shift();for(var s=r.stack.split("\n"),_=0;_<o.length;_++){var u=s.indexOf(o[_]);if(-1!==u){s=s.slice(0,u);break}}r.stack="".concat(s.join("\n"),"\n").concat(o.join("\n"))}throw r}},D.match=function e(n,t,r){W(n,t,r,e,"match")},D.doesNotMatch=function e(n,t,r){W(n,t,r,e,"doesNotMatch")},D.strict=M(N,D,{equal:D.strictEqual,deepEqual:D.deepStrictEqual,notEqual:D.notStrictEqual,notDeepEqual:D.notDeepStrictEqual}),D.strict.strict=D.strict},5961:(e,n,t)=>{"use strict";var r=t(4155);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n,t){return(n=_(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_(r.key),r)}}function _(e){var n=function(e,n){if("object"!==m(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===m(n)?n:String(n)}function u(e,n){if(n&&("object"===m(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){var n="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return h(e,arguments,p(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)},c(e)}function h(e,n,t){return h=d()?Reflect.construct.bind():function(e,n,t){var r=[null];r.push.apply(r,n);var a=new(Function.bind.apply(e,r));return t&&f(a,t.prototype),a},h.apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,n){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},f(e,n)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var g=t(9539).inspect,v=t(2136).codes.ERR_INVALID_ARG_TYPE;function E(e,n,t){return(void 0===t||t>e.length)&&(t=e.length),e.substring(t-n.length,t)===n}var b="",M="",y="",O="",P={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function x(e){var n=Object.keys(e),t=Object.create(Object.getPrototypeOf(e));return n.forEach((function(n){t[n]=e[n]})),Object.defineProperty(t,"message",{value:e.message}),t}function D(e){return g(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function T(e,n,t){var a="",i="",o=0,s="",_=!1,u=D(e),l=u.split("\n"),c=D(n).split("\n"),h=0,d="";if("strictEqual"===t&&"object"===m(e)&&"object"===m(n)&&null!==e&&null!==n&&(t="strictEqualObject"),1===l.length&&1===c.length&&l[0]!==c[0]){var f=l[0].length+c[0].length;if(f<=10){if(!("object"===m(e)&&null!==e||"object"===m(n)&&null!==n||0===e&&0===n))return"".concat(P[t],"\n\n")+"".concat(l[0]," !== ").concat(c[0],"\n")}else if("strictEqualObject"!==t){if(f<(r.stderr&&r.stderr.isTTY?r.stderr.columns:80)){for(;l[0][h]===c[0][h];)h++;h>2&&(d="\n  ".concat(function(e,n){if(n=Math.floor(n),0==e.length||0==n)return"";var t=e.length*n;for(n=Math.floor(Math.log(n)/Math.log(2));n;)e+=e,n--;return e+e.substring(0,t-e.length)}(" ",h),"^"),h=0)}}}for(var p=l[l.length-1],g=c[c.length-1];p===g&&(h++<2?s="\n  ".concat(p).concat(s):a=p,l.pop(),c.pop(),0!==l.length&&0!==c.length);)p=l[l.length-1],g=c[c.length-1];var v=Math.max(l.length,c.length);if(0===v){var x=u.split("\n");if(x.length>30)for(x[26]="".concat(b,"...").concat(O);x.length>27;)x.pop();return"".concat(P.notIdentical,"\n\n").concat(x.join("\n"),"\n")}h>3&&(s="\n".concat(b,"...").concat(O).concat(s),_=!0),""!==a&&(s="\n  ".concat(a).concat(s),a="");var T=0,A=P[t]+"\n".concat(M,"+ actual").concat(O," ").concat(y,"- expected").concat(O),C=" ".concat(b,"...").concat(O," Lines skipped");for(h=0;h<v;h++){var w=h-o;if(l.length<h+1)w>1&&h>2&&(w>4?(i+="\n".concat(b,"...").concat(O),_=!0):w>3&&(i+="\n  ".concat(c[h-2]),T++),i+="\n  ".concat(c[h-1]),T++),o=h,a+="\n".concat(y,"-").concat(O," ").concat(c[h]),T++;else if(c.length<h+1)w>1&&h>2&&(w>4?(i+="\n".concat(b,"...").concat(O),_=!0):w>3&&(i+="\n  ".concat(l[h-2]),T++),i+="\n  ".concat(l[h-1]),T++),o=h,i+="\n".concat(M,"+").concat(O," ").concat(l[h]),T++;else{var R=c[h],I=l[h],L=I!==R&&(!E(I,",")||I.slice(0,-1)!==R);L&&E(R,",")&&R.slice(0,-1)===I&&(L=!1,I+=","),L?(w>1&&h>2&&(w>4?(i+="\n".concat(b,"...").concat(O),_=!0):w>3&&(i+="\n  ".concat(l[h-2]),T++),i+="\n  ".concat(l[h-1]),T++),o=h,i+="\n".concat(M,"+").concat(O," ").concat(I),a+="\n".concat(y,"-").concat(O," ").concat(R),T+=2):(i+=a,a="",1!==w&&0!==h||(i+="\n  ".concat(I),T++))}if(T>20&&h<v-2)return"".concat(A).concat(C,"\n").concat(i,"\n").concat(b,"...").concat(O).concat(a,"\n")+"".concat(b,"...").concat(O)}return"".concat(A).concat(_?C:"","\n").concat(i).concat(a).concat(s).concat(d)}var A=function(e,n){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&f(e,n)}(E,e);var t,a,o,_,c,h=(t=E,a=d(),function(){var e,n=p(t);if(a){var r=p(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return u(this,e)});function E(e){var n;if(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,E),"object"!==m(e)||null===e)throw new v("options","Object",e);var t=e.message,a=e.operator,i=e.stackStartFn,o=e.actual,s=e.expected,_=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=t)n=h.call(this,String(t));else if(r.stderr&&r.stderr.isTTY&&(r.stderr&&r.stderr.getColorDepth&&1!==r.stderr.getColorDepth()?(b="[34m",M="[32m",O="[39m",y="[31m"):(b="",M="",O="",y="")),"object"===m(o)&&null!==o&&"object"===m(s)&&null!==s&&"stack"in o&&o instanceof Error&&"stack"in s&&s instanceof Error&&(o=x(o),s=x(s)),"deepStrictEqual"===a||"strictEqual"===a)n=h.call(this,T(o,s,a));else if("notDeepStrictEqual"===a||"notStrictEqual"===a){var c=P[a],d=D(o).split("\n");if("notStrictEqual"===a&&"object"===m(o)&&null!==o&&(c=P.notStrictEqualObject),d.length>30)for(d[26]="".concat(b,"...").concat(O);d.length>27;)d.pop();n=1===d.length?h.call(this,"".concat(c," ").concat(d[0])):h.call(this,"".concat(c,"\n\n").concat(d.join("\n"),"\n"))}else{var f=D(o),p="",g=P[a];"notDeepEqual"===a||"notEqual"===a?(f="".concat(P[a],"\n\n").concat(f)).length>1024&&(f="".concat(f.slice(0,1021),"...")):(p="".concat(D(s)),f.length>512&&(f="".concat(f.slice(0,509),"...")),p.length>512&&(p="".concat(p.slice(0,509),"...")),"deepEqual"===a||"equal"===a?f="".concat(g,"\n\n").concat(f,"\n\nshould equal\n\n"):p=" ".concat(a," ").concat(p)),n=h.call(this,"".concat(f).concat(p))}return Error.stackTraceLimit=_,n.generatedMessage=!t,Object.defineProperty(l(n),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),n.code="ERR_ASSERTION",n.actual=o,n.expected=s,n.operator=a,Error.captureStackTrace&&Error.captureStackTrace(l(n),i),n.stack,n.name="AssertionError",u(n)}return o=E,(_=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:n,value:function(e,n){return g(this,i(i({},n),{},{customInspect:!1,depth:0}))}}])&&s(o.prototype,_),c&&s(o,c),Object.defineProperty(o,"prototype",{writable:!1}),E}(c(Error),g.custom);e.exports=A},2136:(e,n,t)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(i=a.key,o=void 0,o=function(e,n){if("object"!==r(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(i,"string"),"symbol"===r(o)?o:String(o)),a)}var i,o}function i(e,n){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},i(e,n)}function o(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,a=s(e);if(n){var i=s(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return function(e,n){if(n&&("object"===r(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,t)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var _,u,l={};function c(e,n,t){t||(t=Error);var r=function(t){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&i(e,n)}(l,t);var r,s,_,u=o(l);function l(t,r,a){var i;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,l),i=u.call(this,function(e,t,r){return"string"==typeof n?n:n(e,t,r)}(t,r,a)),i.code=e,i}return r=l,s&&a(r.prototype,s),_&&a(r,_),Object.defineProperty(r,"prototype",{writable:!1}),r}(t);l[e]=r}function h(e,n){if(Array.isArray(e)){var t=e.length;return e=e.map((function(e){return String(e)})),t>2?"one of ".concat(n," ").concat(e.slice(0,t-1).join(", "),", or ")+e[t-1]:2===t?"one of ".concat(n," ").concat(e[0]," or ").concat(e[1]):"of ".concat(n," ").concat(e[0])}return"of ".concat(n," ").concat(String(e))}c("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),c("ERR_INVALID_ARG_TYPE",(function(e,n,a){var i,o,s,u;if(void 0===_&&(_=t(9282)),_("string"==typeof e,"'name' must be a string"),"string"==typeof n&&(o="not ",n.substr(!s||s<0?0:+s,o.length)===o)?(i="must not be",n=n.replace(/^not /,"")):i="must be",function(e,n,t){return(void 0===t||t>e.length)&&(t=e.length),e.substring(t-n.length,t)===n}(e," argument"))u="The ".concat(e," ").concat(i," ").concat(h(n,"type"));else{var l=function(e,n,t){return"number"!=typeof t&&(t=0),!(t+n.length>e.length)&&-1!==e.indexOf(n,t)}(e,".")?"property":"argument";u='The "'.concat(e,'" ').concat(l," ").concat(i," ").concat(h(n,"type"))}return u+=". Received type ".concat(r(a))}),TypeError),c("ERR_INVALID_ARG_VALUE",(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===u&&(u=t(9539));var a=u.inspect(n);return a.length>128&&(a="".concat(a.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(r,". Received ").concat(a)}),TypeError,RangeError),c("ERR_INVALID_RETURN_VALUE",(function(e,n,t){var a;return a=t&&t.constructor&&t.constructor.name?"instance of ".concat(t.constructor.name):"type ".concat(r(t)),"Expected ".concat(e,' to be returned from the "').concat(n,'"')+" function but got ".concat(a,".")}),TypeError),c("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];void 0===_&&(_=t(9282)),_(n.length>0,"At least one arg needs to be specified");var a="The ",i=n.length;switch(n=n.map((function(e){return'"'.concat(e,'"')})),i){case 1:a+="".concat(n[0]," argument");break;case 2:a+="".concat(n[0]," and ").concat(n[1]," arguments");break;default:a+=n.slice(0,i-1).join(", "),a+=", and ".concat(n[i-1]," arguments")}return"".concat(a," must be specified")}),TypeError),e.exports.codes=l},9158:(e,n,t)=>{"use strict";function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i,o,s=[],_=!0,u=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;_=!1}else for(;!(_=(r=i.call(t)).done)&&(s.push(r.value),s.length!==n);_=!0);}catch(e){u=!0,a=e}finally{try{if(!_&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var o=void 0!==/a/g.flags,s=function(e){var n=[];return e.forEach((function(e){return n.push(e)})),n},_=function(e){var n=[];return e.forEach((function(e,t){return n.push([t,e])})),n},u=Object.is?Object.is:t(609),l=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},c=Number.isNaN?Number.isNaN:t(360);function h(e){return e.call.bind(e)}var d=h(Object.prototype.hasOwnProperty),f=h(Object.prototype.propertyIsEnumerable),p=h(Object.prototype.toString),m=t(9539).types,g=m.isAnyArrayBuffer,v=m.isArrayBufferView,E=m.isDate,b=m.isMap,M=m.isRegExp,y=m.isSet,O=m.isNativeError,P=m.isBoxedPrimitive,x=m.isNumberObject,D=m.isStringObject,T=m.isBooleanObject,A=m.isBigIntObject,C=m.isSymbolObject,w=m.isFloat32Array,R=m.isFloat64Array;function I(e){if(0===e.length||e.length>10)return!0;for(var n=0;n<e.length;n++){var t=e.charCodeAt(n);if(t<48||t>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function L(e){return Object.keys(e).filter(I).concat(l(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function S(e,n){if(e===n)return 0;for(var t=e.length,r=n.length,a=0,i=Math.min(t,r);a<i;++a)if(e[a]!==n[a]){t=e[a],r=n[a];break}return t<r?-1:r<t?1:0}var B=0,U=1,k=2,W=3;function N(e,n,t,r){if(e===n)return 0!==e||(!t||u(e,n));if(t){if("object"!==i(e))return"number"==typeof e&&c(e)&&c(n);if("object"!==i(n)||null===e||null===n)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(n))return!1}else{if(null===e||"object"!==i(e))return(null===n||"object"!==i(n))&&e==n;if(null===n||"object"!==i(n))return!1}var a,s,_,l,h=p(e);if(h!==p(n))return!1;if(Array.isArray(e)){if(e.length!==n.length)return!1;var d=L(e),f=L(n);return d.length===f.length&&F(e,n,t,r,U,d)}if("[object Object]"===h&&(!b(e)&&b(n)||!y(e)&&y(n)))return!1;if(E(e)){if(!E(n)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(n))return!1}else if(M(e)){if(!M(n)||(_=e,l=n,!(o?_.source===l.source&&_.flags===l.flags:RegExp.prototype.toString.call(_)===RegExp.prototype.toString.call(l))))return!1}else if(O(e)||e instanceof Error){if(e.message!==n.message||e.name!==n.name)return!1}else{if(v(e)){if(t||!w(e)&&!R(e)){if(!function(e,n){return e.byteLength===n.byteLength&&0===S(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}(e,n))return!1}else if(!function(e,n){if(e.byteLength!==n.byteLength)return!1;for(var t=0;t<e.byteLength;t++)if(e[t]!==n[t])return!1;return!0}(e,n))return!1;var m=L(e),I=L(n);return m.length===I.length&&F(e,n,t,r,B,m)}if(y(e))return!(!y(n)||e.size!==n.size)&&F(e,n,t,r,k);if(b(e))return!(!b(n)||e.size!==n.size)&&F(e,n,t,r,W);if(g(e)){if(s=n,(a=e).byteLength!==s.byteLength||0!==S(new Uint8Array(a),new Uint8Array(s)))return!1}else if(P(e)&&!function(e,n){return x(e)?x(n)&&u(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(n)):D(e)?D(n)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(n):T(e)?T(n)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(n):A(e)?A(n)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(n):C(n)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(n)}(e,n))return!1}return F(e,n,t,r,B)}function K(e,n){return n.filter((function(n){return f(e,n)}))}function F(e,n,t,a,o,u){if(5===arguments.length){u=Object.keys(e);var c=Object.keys(n);if(u.length!==c.length)return!1}for(var h=0;h<u.length;h++)if(!d(n,u[h]))return!1;if(t&&5===arguments.length){var p=l(e);if(0!==p.length){var m=0;for(h=0;h<p.length;h++){var g=p[h];if(f(e,g)){if(!f(n,g))return!1;u.push(g),m++}else if(f(n,g))return!1}var v=l(n);if(p.length!==v.length&&K(n,v).length!==m)return!1}else{var E=l(n);if(0!==E.length&&0!==K(n,E).length)return!1}}if(0===u.length&&(o===B||o===U&&0===e.length||0===e.size))return!0;if(void 0===a)a={val1:new Map,val2:new Map,position:0};else{var b=a.val1.get(e);if(void 0!==b){var M=a.val2.get(n);if(void 0!==M)return b===M}a.position++}a.val1.set(e,a.position),a.val2.set(n,a.position);var y=function(e,n,t,a,o,u){var l=0;if(u===k){if(!function(e,n,t,r){for(var a=null,o=s(e),_=0;_<o.length;_++){var u=o[_];if("object"===i(u)&&null!==u)null===a&&(a=new Set),a.add(u);else if(!n.has(u)){if(t)return!1;if(!V(e,n,u))return!1;null===a&&(a=new Set),a.add(u)}}if(null!==a){for(var l=s(n),c=0;c<l.length;c++){var h=l[c];if("object"===i(h)&&null!==h){if(!j(a,h,t,r))return!1}else if(!t&&!e.has(h)&&!j(a,h,t,r))return!1}return 0===a.size}return!0}(e,n,t,o))return!1}else if(u===W){if(!function(e,n,t,a){for(var o=null,s=_(e),u=0;u<s.length;u++){var l=r(s[u],2),c=l[0],h=l[1];if("object"===i(c)&&null!==c)null===o&&(o=new Set),o.add(c);else{var d=n.get(c);if(void 0===d&&!n.has(c)||!N(h,d,t,a)){if(t)return!1;if(!G(e,n,c,h,a))return!1;null===o&&(o=new Set),o.add(c)}}}if(null!==o){for(var f=_(n),p=0;p<f.length;p++){var m=r(f[p],2),g=m[0],v=m[1];if("object"===i(g)&&null!==g){if(!z(o,e,g,v,t,a))return!1}else if(!(t||e.has(g)&&N(e.get(g),v,!1,a)||z(o,e,g,v,!1,a)))return!1}return 0===o.size}return!0}(e,n,t,o))return!1}else if(u===U)for(;l<e.length;l++){if(!d(e,l)){if(d(n,l))return!1;for(var c=Object.keys(e);l<c.length;l++){var h=c[l];if(!d(n,h)||!N(e[h],n[h],t,o))return!1}return c.length===Object.keys(n).length}if(!d(n,l)||!N(e[l],n[l],t,o))return!1}for(l=0;l<a.length;l++){var f=a[l];if(!N(e[f],n[f],t,o))return!1}return!0}(e,n,t,u,a,o);return a.val1.delete(e),a.val2.delete(n),y}function j(e,n,t,r){for(var a=s(e),i=0;i<a.length;i++){var o=a[i];if(N(n,o,t,r))return e.delete(o),!0}return!1}function q(e){switch(i(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(c(e))return!1}return!0}function V(e,n,t){var r=q(t);return null!=r?r:n.has(r)&&!e.has(r)}function G(e,n,t,r,a){var i=q(t);if(null!=i)return i;var o=n.get(i);return!(void 0===o&&!n.has(i)||!N(r,o,!1,a))&&(!e.has(i)&&N(r,o,!1,a))}function z(e,n,t,r,a,i){for(var o=s(e),_=0;_<o.length;_++){var u=o[_];if(N(t,u,a,i)&&N(r,n.get(u),a,i))return e.delete(u),!0}return!1}e.exports={isDeepEqual:function(e,n){return N(e,n,false)},isDeepStrictEqual:function(e,n){return N(e,n,true)}}},6314:(e,n,t)=>{"use strict";var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],a="undefined"==typeof globalThis?t.g:globalThis;e.exports=function(){for(var e=[],n=0;n<r.length;n++)"function"==typeof a[r[n]]&&(e[e.length]=r[n]);return e}},9742:(e,n)=>{"use strict";n.byteLength=function(e){var n=s(e),t=n[0],r=n[1];return 3*(t+r)/4-r},n.toByteArray=function(e){var n,t,i=s(e),o=i[0],_=i[1],u=new a(function(e,n,t){return 3*(n+t)/4-t}(0,o,_)),l=0,c=_>0?o-4:o;for(t=0;t<c;t+=4)n=r[e.charCodeAt(t)]<<18|r[e.charCodeAt(t+1)]<<12|r[e.charCodeAt(t+2)]<<6|r[e.charCodeAt(t+3)],u[l++]=n>>16&255,u[l++]=n>>8&255,u[l++]=255&n;2===_&&(n=r[e.charCodeAt(t)]<<2|r[e.charCodeAt(t+1)]>>4,u[l++]=255&n);1===_&&(n=r[e.charCodeAt(t)]<<10|r[e.charCodeAt(t+1)]<<4|r[e.charCodeAt(t+2)]>>2,u[l++]=n>>8&255,u[l++]=255&n);return u},n.fromByteArray=function(e){for(var n,r=e.length,a=r%3,i=[],o=16383,s=0,u=r-a;s<u;s+=o)i.push(_(e,s,s+o>u?u:s+o));1===a?(n=e[r-1],i.push(t[n>>2]+t[n<<4&63]+"==")):2===a&&(n=(e[r-2]<<8)+e[r-1],i.push(t[n>>10]+t[n>>4&63]+t[n<<2&63]+"="));return i.join("")};for(var t=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)t[o]=i[o],r[i.charCodeAt(o)]=o;function s(e){var n=e.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");return-1===t&&(t=n),[t,t===n?0:4-t%4]}function _(e,n,r){for(var a,i,o=[],s=n;s<r;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(t[(i=a)>>18&63]+t[i>>12&63]+t[i>>6&63]+t[63&i]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},6624:(e,n,t)=>{var r=t(4155),a=t(5108),i;i=function(){var e,n,i;return function e(n,t,r){function a(o,s){if(!t[o]){if(!n[o]){var _="function"==typeof _dereq_&&_dereq_;if(!s&&_)return _(o,!0);if(i)return i(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=t[o]={exports:{}};n[o][0].call(l.exports,(function(e){var t=n[o][1][e];return a(t||e)}),l,l.exports,e,n,t,r)}return t[o].exports}for(var i="function"==typeof _dereq_&&_dereq_,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,n,t){"use strict";n.exports=function(e){var n=e._SomePromiseArray;function t(e){var t=new n(e),r=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),r}e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},{}],2:[function(e,n,t){"use strict";var a;try{throw new Error}catch(e){a=e}var i=e("./schedule"),o=e("./queue");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=i}function _(e){for(;e.length()>0;)u(e)}function u(e){var n=e.shift();if("function"!=typeof n)n._settlePromises();else{var t=e.shift(),r=e.shift();n.call(t,r)}}s.prototype.setScheduler=function(e){var n=this._schedule;return this._schedule=e,this._customScheduler=!0,n},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(e,n){n?(r.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),r.exit(2)):this.throwLater(e)},s.prototype.throwLater=function(e,n){if(1===arguments.length&&(n=e,e=function(){throw n}),"undefined"!=typeof setTimeout)setTimeout((function(){e(n)}),0);else try{this._schedule((function(){e(n)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.prototype.invokeLater=function(e,n,t){this._lateQueue.push(e,n,t),this._queueTick()},s.prototype.invoke=function(e,n,t){this._normalQueue.push(e,n,t),this._queueTick()},s.prototype.settlePromises=function(e){this._normalQueue._pushOne(e),this._queueTick()},s.prototype._drainQueues=function(){_(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,_(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},n.exports=s,n.exports.firstLineError=a},{"./queue":26,"./schedule":29}],3:[function(e,n,t){"use strict";n.exports=function(e,n,t,r){var a=!1,i=function(e,n){this._reject(n)},o=function(e,n){n.promiseRejectionQueued=!0,n.bindingPromise._then(i,i,null,this,e)},s=function(e,n){0==(50397184&this._bitField)&&this._resolveCallback(n.target)},_=function(e,n){n.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){a||(a=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var u=t(i),l=new e(n);l._propagateFrom(this,1);var c=this._target();if(l._setBoundTo(u),u instanceof e){var h={promiseRejectionQueued:!1,promise:l,target:c,bindingPromise:u};c._then(n,o,void 0,l,h),u._then(s,_,void 0,l,h),l._setOnCancel(u)}else l._resolveCallback(c);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(n,t){return e.resolve(t).bind(n)}}},{}],4:[function(e,n,t){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var a=e("./promise")();a.noConflict=function(){try{Promise===a&&(Promise=r)}catch(e){}return a},n.exports=a},{"./promise":22}],5:[function(e,n,t){"use strict";var r=Object.create;if(r){var a=r(null),i=r(null);a[" size"]=i[" size"]=0}n.exports=function(n){var t=e("./util"),r=t.canEvaluate;function a(e){var r=function(e,r){var a;if(null!=e&&(a=e[r]),"function"!=typeof a){var i="Object "+t.classString(e)+" has no method '"+t.toString(r)+"'";throw new n.TypeError(i)}return a}(e,this.pop());return r.apply(e,this)}function i(e){return e[this]}function o(e){var n=+this;return n<0&&(n=Math.max(0,n+e.length)),e[n]}t.isIdentifier,n.prototype.call=function(e){var n=[].slice.call(arguments,1);return n.push(e),this._then(a,void 0,void 0,n,void 0)},n.prototype.get=function(e){var n;if("number"==typeof e)n=o;else if(r){var t=(void 0)(e);n=null!==t?t:i}else n=i;return this._then(n,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,n,t){"use strict";n.exports=function(n,t,r,a){var i=e("./util"),o=i.tryCatch,s=i.errorObj,_=n._async;n.prototype.break=n.prototype.cancel=function(){if(!a.cancellation())return this._warn("cancellation is disabled");for(var e=this,n=e;e._isCancellable();){if(!e._cancelBy(n)){n._isFollowing()?n._followee().cancel():n._cancelBranched();break}var t=e._cancellationParent;if(null==t||!t._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),n=e,e=t}},n.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},n.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},n.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},n.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},n.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),_.invoke(this._cancelPromises,this,void 0))},n.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},n.prototype._unsetOnCancel=function(){this._onCancelField=void 0},n.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},n.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},n.prototype._doInvokeOnCancel=function(e,n){if(i.isArray(e))for(var t=0;t<e.length;++t)this._doInvokeOnCancel(e[t],n);else if(void 0!==e)if("function"==typeof e){if(!n){var r=o(e).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),_.throwLater(r.e))}}else e._resultCancelled(this)},n.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),_.invoke(this._doInvokeOnCancel,this,e)},n.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},n.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,n,t){"use strict";n.exports=function(n){var t=e("./util"),r=e("./es5").keys,a=t.tryCatch,i=t.errorObj;return function(e,o,s){return function(_){var u=s._boundValue();e:for(var l=0;l<e.length;++l){var c=e[l];if(c===Error||null!=c&&c.prototype instanceof Error){if(_ instanceof c)return a(o).call(u,_)}else if("function"==typeof c){var h=a(c).call(u,_);if(h===i)return h;if(h)return a(o).call(u,_)}else if(t.isObject(_)){for(var d=r(c),f=0;f<d.length;++f){var p=d[f];if(c[p]!=_[p])continue e}return a(o).call(u,_)}}return n}}}},{"./es5":13,"./util":36}],8:[function(e,n,t){"use strict";n.exports=function(e){var n=!1,t=[];function r(){this._trace=new r.CapturedTrace(a())}function a(){var e=t.length-1;if(e>=0)return t[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,t.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var e=t.pop(),n=e._promiseCreated;return e._promiseCreated=null,n}return null},r.CapturedTrace=null,r.create=function(){if(n)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var t=e.prototype._pushContext,i=e.prototype._popContext,o=e._peekContext,s=e.prototype._peekContext,_=e.prototype._promiseCreated;r.deactivateLongStackTraces=function(){e.prototype._pushContext=t,e.prototype._popContext=i,e._peekContext=o,e.prototype._peekContext=s,e.prototype._promiseCreated=_,n=!1},n=!0,e.prototype._pushContext=r.prototype._pushContext,e.prototype._popContext=r.prototype._popContext,e._peekContext=e.prototype._peekContext=a,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},r}},{}],9:[function(e,n,t){"use strict";n.exports=function(n,t,i,o){var s,_,u,l,c=n._async,h=e("./errors").Warning,d=e("./util"),f=e("./es5"),p=d.canAttachTrace,m=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,g=/\((?:timers\.js):\d+:\d+\)/,v=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,E=null,b=null,M=!1,y=!(0==d.env("BLUEBIRD_DEBUG")),O=!(0==d.env("BLUEBIRD_WARNINGS")||!y&&!d.env("BLUEBIRD_WARNINGS")),P=!(0==d.env("BLUEBIRD_LONG_STACK_TRACES")||!y&&!d.env("BLUEBIRD_LONG_STACK_TRACES")),x=0!=d.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(O||!!d.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var e=[];function t(){for(var n=0;n<e.length;++n)e[n]._notifyUnhandledRejection();r()}function r(){e.length=0}l=function(n){e.push(n),setTimeout(t,1)},f.defineProperty(n,"_unhandledRejectionCheck",{value:t}),f.defineProperty(n,"_unhandledRejectionClear",{value:r})}(),n.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),l(this))},n.prototype._notifyUnhandledRejectionIsHandled=function(){Y("rejectionHandled",s,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),Y("unhandledRejection",_,e,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(e,n,t){return G(e,n,t||this)},n.onPossiblyUnhandledRejection=function(e){var t=n._getContext();_=d.contextBind(t,e)},n.onUnhandledRejectionHandled=function(e){var t=n._getContext();s=d.contextBind(t,e)};var D=function(){};n.longStackTraces=function(){if(c.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!re.longStackTraces&&Q()){var e=n.prototype._captureStackTrace,r=n.prototype._attachExtraTrace,a=n.prototype._dereferenceTrace;re.longStackTraces=!0,D=function(){if(c.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=e,n.prototype._attachExtraTrace=r,n.prototype._dereferenceTrace=a,t.deactivateLongStackTraces(),re.longStackTraces=!1},n.prototype._captureStackTrace=j,n.prototype._attachExtraTrace=q,n.prototype._dereferenceTrace=V,t.activateLongStackTraces()}},n.hasLongStackTraces=function(){return re.longStackTraces&&Q()};var T={unhandledrejection:{before:function(){var e=d.global.onunhandledrejection;return d.global.onunhandledrejection=null,e},after:function(e){d.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=d.global.onrejectionhandled;return d.global.onrejectionhandled=null,e},after:function(e){d.global.onrejectionhandled=e}}},A=function(){var e=function(e,n){if(!e)return!d.global.dispatchEvent(n);var t;try{return t=e.before(),!d.global.dispatchEvent(n)}finally{e.after(t)}};try{if("function"==typeof CustomEvent){var n=new CustomEvent("CustomEvent");return d.global.dispatchEvent(n),function(n,t){n=n.toLowerCase();var r=new CustomEvent(n,{detail:t,cancelable:!0});return f.defineProperty(r,"promise",{value:t.promise}),f.defineProperty(r,"reason",{value:t.reason}),e(T[n],r)}}return"function"==typeof Event?(n=new Event("CustomEvent"),d.global.dispatchEvent(n),function(n,t){n=n.toLowerCase();var r=new Event(n,{cancelable:!0});return r.detail=t,f.defineProperty(r,"promise",{value:t.promise}),f.defineProperty(r,"reason",{value:t.reason}),e(T[n],r)}):((n=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),d.global.dispatchEvent(n),function(n,t){n=n.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(n,!1,!0,t),e(T[n],r)})}catch(e){}return function(){return!1}}(),C=d.isNode?function(){return r.emit.apply(r,arguments)}:d.global?function(e){var n="on"+e.toLowerCase(),t=d.global[n];return!!t&&(t.apply(d.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function w(e,n){return{promise:n}}var R={promiseCreated:w,promiseFulfilled:w,promiseRejected:w,promiseResolved:w,promiseCancelled:w,promiseChained:function(e,n,t){return{promise:n,child:t}},warning:function(e,n){return{warning:n}},unhandledRejection:function(e,n,t){return{reason:n,promise:t}},rejectionHandled:w},I=function(e){var n=!1;try{n=C.apply(null,arguments)}catch(e){c.throwLater(e),n=!0}var t=!1;try{t=A(e,R[e].apply(null,arguments))}catch(e){c.throwLater(e),t=!0}return t||n};function L(){return!1}function S(e,n,t){var r=this;try{e(n,t,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+d.toString(e));r._attachCancellationCallback(e)}))}catch(e){return e}}function B(e){if(!this._isCancellable())return this;var n=this._onCancel();void 0!==n?d.isArray(n)?n.push(e):this._setOnCancel([n,e]):this._setOnCancel(e)}function U(){return this._onCancelField}function k(e){this._onCancelField=e}function W(){this._cancellationParent=void 0,this._onCancelField=void 0}function N(e,n){if(0!=(1&n)){this._cancellationParent=e;var t=e._branchesRemainingToCancel;void 0===t&&(t=0),e._branchesRemainingToCancel=t+1}0!=(2&n)&&e._isBound()&&this._setBoundTo(e._boundTo)}n.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?n.longStackTraces():!e.longStackTraces&&n.hasLongStackTraces()&&D()),"warnings"in e){var t=e.warnings;re.warnings=!!t,x=re.warnings,d.isObject(t)&&"wForgottenReturn"in t&&(x=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!re.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=W,n.prototype._propagateFrom=N,n.prototype._onCancel=U,n.prototype._setOnCancel=k,n.prototype._attachCancellationCallback=B,n.prototype._execute=S,K=N,re.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!re.monitoring?(re.monitoring=!0,n.prototype._fireEvent=I):!e.monitoring&&re.monitoring&&(re.monitoring=!1,n.prototype._fireEvent=L)),"asyncHooks"in e&&d.nodeSupportsAsyncResource){var r=re.asyncHooks,a=!!e.asyncHooks;r!==a&&(re.asyncHooks=a,a?i():o())}return n},n.prototype._fireEvent=L,n.prototype._execute=function(e,n,t){try{e(n,t)}catch(e){return e}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(e){},n.prototype._attachCancellationCallback=function(e){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._dereferenceTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(e,n){};var K=function(e,n){0!=(2&n)&&e._isBound()&&this._setBoundTo(e._boundTo)};function F(){var e=this._boundTo;return void 0!==e&&e instanceof n?e.isFulfilled()?e.value():void 0:e}function j(){this._trace=new ne(this._peekContext())}function q(e,n){if(p(e)){var t=this._trace;if(void 0!==t&&n&&(t=t._parent),void 0!==t)t.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=H(e);d.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),d.notEnumerableProp(e,"__stackCleaned__",!0)}}}function V(){this._trace=void 0}function G(e,t,r){if(re.warnings){var a,i=new h(e);if(t)r._attachExtraTrace(i);else if(re.longStackTraces&&(a=n._peekContext()))a.attachExtraTrace(i);else{var o=H(i);i.stack=o.message+"\n"+o.stack.join("\n")}I("warning",i)||X(i,"",!0)}}function z(e){for(var n=[],t=0;t<e.length;++t){var r=e[t],a="    (No stack trace)"===r||E.test(r),i=a&&$(r);a&&!i&&(M&&" "!==r.charAt(0)&&(r="    "+r),n.push(r))}return n}function H(e){var n=e.stack,t=e.toString();return n="string"==typeof n&&n.length>0?function(e){for(var n=e.stack.replace(/\s+$/g,"").split("\n"),t=0;t<n.length;++t){var r=n[t];if("    (No stack trace)"===r||E.test(r))break}return t>0&&"SyntaxError"!=e.name&&(n=n.slice(t)),n}(e):["    (No stack trace)"],{message:t,stack:"SyntaxError"==e.name?n:z(n)}}function X(e,n,t){if(void 0!==a){var r;if(d.isObject(e)){var i=e.stack;r=n+b(i,e)}else r=n+String(e);"function"==typeof u?u(r,t):"function"!=typeof a.log&&"object"!=typeof a.log||a.log(r)}}function Y(e,n,t,r){var a=!1;try{"function"==typeof n&&(a=!0,"rejectionHandled"===e?n(r):n(t,r))}catch(e){c.throwLater(e)}"unhandledRejection"===e?I(e,t,r)||a||X(t,"Unhandled rejection "):I(e,r)}function Z(e){var n;if("function"==typeof e)n="[function "+(e.name||"anonymous")+"]";else{if(n=e&&"function"==typeof e.toString?e.toString():d.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(n))try{n=JSON.stringify(e)}catch(e){}0===n.length&&(n="(empty array)")}return"(<"+function(e){var n=41;return e.length<n?e:e.substr(0,n-3)+"..."}(n)+">, no stack trace)"}function Q(){return"function"==typeof te}var $=function(){return!1},J=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function ee(e){var n=e.match(J);if(n)return{fileName:n[1],line:parseInt(n[2],10)}}function ne(e){this._parent=e,this._promisesCreated=0;var n=this._length=1+(void 0===e?0:e._length);te(this,ne),n>32&&this.uncycle()}d.inherits(ne,Error),t.CapturedTrace=ne,ne.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var n=[],t={},r=0,a=this;void 0!==a;++r)n.push(a),a=a._parent;for(r=(e=this._length=r)-1;r>=0;--r){var i=n[r].stack;void 0===t[i]&&(t[i]=r)}for(r=0;r<e;++r){var o=t[n[r].stack];if(void 0!==o&&o!==r){o>0&&(n[o-1]._parent=void 0,n[o-1]._length=1),n[r]._parent=void 0,n[r]._length=1;var s=r>0?n[r-1]:this;o<e-1?(s._parent=n[o+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var _=s._length+1,u=r-2;u>=0;--u)n[u]._length=_,_++;return}}}},ne.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var n=H(e),t=n.message,r=[n.stack],a=this;void 0!==a;)r.push(z(a.stack.split("\n"))),a=a._parent;!function(e){for(var n=e[0],t=1;t<e.length;++t){for(var r=e[t],a=n.length-1,i=n[a],o=-1,s=r.length-1;s>=0;--s)if(r[s]===i){o=s;break}for(s=o;s>=0;--s){var _=r[s];if(n[a]!==_)break;n.pop(),a--}n=r}}(r),function(e){for(var n=0;n<e.length;++n)(0===e[n].length||n+1<e.length&&e[n][0]===e[n+1][0])&&(e.splice(n,1),n--)}(r),d.notEnumerableProp(e,"stack",function(e,n){for(var t=0;t<n.length-1;++t)n[t].push("From previous event:"),n[t]=n[t].join("\n");return t<n.length&&(n[t]=n[t].join("\n")),e+"\n"+n.join("\n")}(t,r)),d.notEnumerableProp(e,"__stackCleaned__",!0)}};var te=function(){var e=/^\s*at\s*/,n=function(e,n){return"string"==typeof e?e:void 0!==n.name&&void 0!==n.message?n.toString():Z(n)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,E=e,b=n;var t=Error.captureStackTrace;return $=function(e){return m.test(e)},function(e,n){Error.stackTraceLimit+=6,t(e,n),Error.stackTraceLimit-=6}}var r,a=new Error;if("string"==typeof a.stack&&a.stack.split("\n")[0].indexOf("stackDetection@")>=0)return E=/@/,b=n,M=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){r="stack"in e}return!("stack"in a)&&r&&"number"==typeof Error.stackTraceLimit?(E=e,b=n,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(n){e.stack=n.stack}Error.stackTraceLimit-=6}):(b=function(e,n){return"string"==typeof e?e:"object"!=typeof n&&"function"!=typeof n||void 0===n.name||void 0===n.message?Z(n):n.toString()},null)}();void 0!==a&&void 0!==a.warn&&(u=function(e){a.warn(e)},d.isNode&&r.stderr.isTTY?u=function(e,n){var t=n?"[33m":"[31m";a.warn(t+e+"[0m\n")}:d.isNode||"string"!=typeof(new Error).stack||(u=function(e,n){a.warn("%c"+e,n?"color: darkorange":"color: red")}));var re={warnings:O,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return P&&n.longStackTraces(),{asyncHooks:function(){return re.asyncHooks},longStackTraces:function(){return re.longStackTraces},warnings:function(){return re.warnings},cancellation:function(){return re.cancellation},monitoring:function(){return re.monitoring},propagateFromFunction:function(){return K},boundValueFunction:function(){return F},checkForgottenReturns:function(e,n,t,r,a){if(void 0===e&&null!==n&&x){if(void 0!==a&&a._returnedNonUndefined())return;if(0==(65535&r._bitField))return;t&&(t+=" ");var i="",o="";if(n._trace){for(var s=n._trace.stack.split("\n"),_=z(s),u=_.length-1;u>=0;--u){var l=_[u];if(!g.test(l)){var c=l.match(v);c&&(i="at "+c[1]+":"+c[2]+":"+c[3]+" ");break}}if(_.length>0){var h=_[0];for(u=0;u<s.length;++u)if(s[u]===h){u>0&&(o="\n"+s[u-1]);break}}}var d="a promise was created in a "+t+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+o;r._warn(d,!0,n)}},setBounds:function(e,n){if(Q()){for(var t,r,a=(e.stack||"").split("\n"),i=(n.stack||"").split("\n"),o=-1,s=-1,_=0;_<a.length;++_)if(u=ee(a[_])){t=u.fileName,o=u.line;break}for(_=0;_<i.length;++_){var u;if(u=ee(i[_])){r=u.fileName,s=u.line;break}}o<0||s<0||!t||!r||t!==r||o>=s||($=function(e){if(m.test(e))return!0;var n=ee(e);return!!(n&&n.fileName===t&&o<=n.line&&n.line<=s)})}},warn:G,deprecated:function(e,n){var t=e+" is deprecated and will be removed in a future version.";return n&&(t+=" Use "+n+" instead."),G(t)},CapturedTrace:ne,fireDomEvent:A,fireGlobalEvent:C}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,n,t){"use strict";n.exports=function(e){function n(){return this.value}function t(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(t){return t instanceof e&&t.suppressUnhandledRejections(),this._then(n,void 0,void 0,{value:t},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(t,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,t,void 0,{reason:e},void 0);var n=arguments[1];return this.caught(e,(function(){throw n}))},e.prototype.catchReturn=function(t){if(arguments.length<=1)return t instanceof e&&t.suppressUnhandledRejections(),this._then(void 0,n,void 0,{value:t},void 0);var r=arguments[1];return r instanceof e&&r.suppressUnhandledRejections(),this.caught(t,(function(){return r}))}}},{}],11:[function(e,n,t){"use strict";n.exports=function(e,n){var t=e.reduce,r=e.all;function a(){return r(this)}e.prototype.each=function(e){return t(this,e,n,0)._then(a,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return t(this,e,n,n)},e.each=function(e,r){return t(e,r,n,0)._then(a,void 0,void 0,e,void 0)},e.mapSeries=function(e,r){return t(e,r,n,n)}}},{}],12:[function(e,n,t){"use strict";var r,a,i=e("./es5"),o=i.freeze,s=e("./util"),_=s.inherits,u=s.notEnumerableProp;function l(e,n){function t(r){if(!(this instanceof t))return new t(r);u(this,"message","string"==typeof r?r:n),u(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return _(t,Error),t}var c=l("Warning","warning"),h=l("CancellationError","cancellation error"),d=l("TimeoutError","timeout error"),f=l("AggregateError","aggregate error");try{r=TypeError,a=RangeError}catch(e){r=l("TypeError","type error"),a=l("RangeError","range error")}for(var p="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<p.length;++m)"function"==typeof Array.prototype[p[m]]&&(f.prototype[p[m]]=Array.prototype[p[m]]);i.defineProperty(f.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),f.prototype.isOperational=!0;var g=0;function v(e){if(!(this instanceof v))return new v(e);u(this,"name","OperationalError"),u(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(u(this,"message",e.message),u(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}f.prototype.toString=function(){var e=Array(4*g+1).join(" "),n="\n"+e+"AggregateError of:\n";g++,e=Array(4*g+1).join(" ");for(var t=0;t<this.length;++t){for(var r=this[t]===this?"[Circular AggregateError]":this[t]+"",a=r.split("\n"),i=0;i<a.length;++i)a[i]=e+a[i];n+=(r=a.join("\n"))+"\n"}return g--,n},_(v,Error);var E=Error.__BluebirdErrorTypes__;E||(E=o({CancellationError:h,TimeoutError:d,OperationalError:v,RejectionError:v,AggregateError:f}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:E,writable:!1,enumerable:!1,configurable:!1})),n.exports={Error,TypeError:r,RangeError:a,CancellationError:E.CancellationError,OperationalError:E.OperationalError,TimeoutError:E.TimeoutError,AggregateError:E.AggregateError,Warning:c}},{"./es5":13,"./util":36}],13:[function(e,n,t){var r=function(){"use strict";return void 0===this}();if(r)n.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,n){var t=Object.getOwnPropertyDescriptor(e,n);return!(t&&!t.writable&&!t.set)}};else{var a={}.hasOwnProperty,i={}.toString,o={}.constructor.prototype,s=function(e){var n=[];for(var t in e)a.call(e,t)&&n.push(t);return n};n.exports={isArray:function(e){try{return"[object Array]"===i.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,n,t){return e[n]=t.value,e},getDescriptor:function(e,n){return{value:e[n]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return o}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,n,t){"use strict";n.exports=function(e,n){var t=e.map;e.prototype.filter=function(e,r){return t(this,e,r,n)},e.filter=function(e,r,a){return t(e,r,a,n)}}},{}],15:[function(e,n,t){"use strict";n.exports=function(n,t,r){var a=e("./util"),i=n.CancellationError,o=a.errorObj,s=e("./catch_filter")(r);function _(e,n,t){this.promise=e,this.type=n,this.handler=t,this.called=!1,this.cancelPromise=null}function u(e){this.finallyHandler=e}function l(e,n){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(n):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function c(){return d.call(this,this.promise._target()._settledValue())}function h(e){if(!l(this,e))return o.e=e,o}function d(e){var a=this.promise,s=this.handler;if(!this.called){this.called=!0;var _=this.isFinallyHandler()?s.call(a._boundValue()):s.call(a._boundValue(),e);if(_===r)return _;if(void 0!==_){a._setReturnedNonUndefined();var d=t(_,a);if(d instanceof n){if(null!=this.cancelPromise){if(d._isCancelled()){var f=new i("late cancellation observer");return a._attachExtraTrace(f),o.e=f,o}d.isPending()&&d._attachCancellationCallback(new u(this))}return d._then(c,h,void 0,this,void 0)}}}return a.isRejected()?(l(this),o.e=e,o):(l(this),e)}return _.prototype.isFinallyHandler=function(){return 0===this.type},u.prototype._resultCancelled=function(){l(this.finallyHandler)},n.prototype._passThrough=function(e,n,t,r){return"function"!=typeof e?this.then():this._then(t,r,void 0,new _(this,n,e),void 0)},n.prototype.lastly=n.prototype.finally=function(e){return this._passThrough(e,0,d,d)},n.prototype.tap=function(e){return this._passThrough(e,1,d)},n.prototype.tapCatch=function(e){var t=arguments.length;if(1===t)return this._passThrough(e,1,void 0,d);var r,i=new Array(t-1),o=0;for(r=0;r<t-1;++r){var _=arguments[r];if(!a.isObject(_))return n.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+a.classString(_)));i[o++]=_}i.length=o;var u=arguments[r];return this._passThrough(s(i,u,this),1,void 0,d)},_}},{"./catch_filter":7,"./util":36}],16:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i,o){var s=e("./errors").TypeError,_=e("./util"),u=_.errorObj,l=_.tryCatch,c=[];function h(e,t,a,i){if(o.cancellation()){var s=new n(r),_=this._finallyPromise=new n(r);this._promise=s.lastly((function(){return _})),s._captureStackTrace(),s._setOnCancel(this)}else(this._promise=new n(r))._captureStackTrace();this._stack=i,this._generatorFunction=e,this._receiver=t,this._generator=void 0,this._yieldHandlers="function"==typeof a?[a].concat(c):c,this._yieldedPromise=null,this._cancellationPhase=!1}_.inherits(h,i),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,o.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var t=new n.CancellationError("generator .return() sentinel");n.coroutine.returnSentinel=t,this._promise._attachExtraTrace(t),this._promise._pushContext(),e=l(this._generator.throw).call(this._generator,t),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},h.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var n=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(n)},h.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var n=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(n)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof n){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(e){var t=this._promise;if(e===u)return this._cleanup(),this._cancellationPhase?t.cancel():t._rejectCallback(e.e,!1);var r=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?t.cancel():t._resolveCallback(r);var i=a(r,this._promise);if(i instanceof n||(i=function(e,t,r){for(var i=0;i<t.length;++i){r._pushContext();var o=l(t[i])(e);if(r._popContext(),o===u){r._pushContext();var s=n.reject(u.e);return r._popContext(),s}var _=a(o,r);if(_ instanceof n)return _}return null}(i,this._yieldHandlers,this._promise),null!==i)){var o=(i=i._target())._bitField;0==(50397184&o)?(this._yieldedPromise=i,i._proxy(this,null)):0!=(33554432&o)?n._async.invoke(this._promiseFulfilled,this,i._value()):0!=(16777216&o)?n._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled()}else this._promiseRejected(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},n.coroutine=function(e,n){if("function"!=typeof e)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var t=Object(n).yieldHandler,r=h,a=(new Error).stack;return function(){var n=e.apply(this,arguments),i=new r(void 0,void 0,t,a),o=i.promise();return i._generator=n,i._promiseFulfilled(void 0),o}},n.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new s("expecting a function but got "+_.classString(e));c.push(e)},n.spawn=function(e){if(o.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new h(e,this),a=r.promise();return r._run(n.spawn),a}}},{"./errors":12,"./util":36}],17:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i){var o=e("./util");o.canEvaluate,o.tryCatch,o.errorObj,n.join=function(){var e,n=arguments.length-1;n>0&&"function"==typeof arguments[n]&&(e=arguments[n]);var r=[].slice.call(arguments);e&&r.pop();var a=new t(r).promise();return void 0!==e?a.spread(e):a}}},{"./util":36}],18:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i,o){var s=e("./util"),_=s.tryCatch,u=s.errorObj,l=n._async;function c(e,t,r,a){this.constructor$(e),this._promise._captureStackTrace();var o=n._getContext();if(this._callback=s.contextBind(o,t),this._preservedValues=a===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0),s.isArray(e))for(var _=0;_<e.length;++_){var u=e[_];u instanceof n&&u.suppressUnhandledRejections()}}function h(e,t,a,i){if("function"!=typeof t)return r("expecting a function but got "+s.classString(t));var o=0;if(void 0!==a){if("object"!=typeof a||null===a)return n.reject(new TypeError("options argument must be an object but it is "+s.classString(a)));if("number"!=typeof a.concurrency)return n.reject(new TypeError("'concurrency' must be a number but it is "+s.classString(a.concurrency)));o=a.concurrency}return new c(e,t,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,i).promise()}s.inherits(c,t),c.prototype._asyncInit=function(){this._init$(void 0,-2)},c.prototype._init=function(){},c.prototype._promiseFulfilled=function(e,t){var r=this._values,i=this.length(),s=this._preservedValues,l=this._limit;if(t<0){if(r[t=-1*t-1]=e,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return r[t]=e,this._queue.push(t),!1;null!==s&&(s[t]=e);var c=this._promise,h=this._callback,d=c._boundValue();c._pushContext();var f=_(h).call(d,e,t,i),p=c._popContext();if(o.checkForgottenReturns(f,p,null!==s?"Promise.filter":"Promise.map",c),f===u)return this._reject(f.e),!0;var m=a(f,this._promise);if(m instanceof n){var g=(m=m._target())._bitField;if(0==(50397184&g))return l>=1&&this._inFlight++,r[t]=m,m._proxy(this,-1*(t+1)),!1;if(0==(33554432&g))return 0!=(16777216&g)?(this._reject(m._reason()),!0):(this._cancel(),!0);f=m._value()}r[t]=f}return++this._totalResolved>=i&&(null!==s?this._filter(r,s):this._resolve(r),!0)},c.prototype._drainQueue=function(){for(var e=this._queue,n=this._limit,t=this._values;e.length>0&&this._inFlight<n;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(t[r],r)}},c.prototype._filter=function(e,n){for(var t=n.length,r=new Array(t),a=0,i=0;i<t;++i)e[i]&&(r[a++]=n[i]);r.length=a,this._resolve(r)},c.prototype.preservedValues=function(){return this._preservedValues},n.prototype.map=function(e,n){return h(this,e,n,null)},n.map=function(e,n,t,r){return h(e,n,t,r)}}},{"./util":36}],19:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i){var o=e("./util"),s=o.tryCatch;n.method=function(e){if("function"!=typeof e)throw new n.TypeError("expecting a function but got "+o.classString(e));return function(){var r=new n(t);r._captureStackTrace(),r._pushContext();var a=s(e).apply(this,arguments),o=r._popContext();return i.checkForgottenReturns(a,o,"Promise.method",r),r._resolveFromSyncValue(a),r}},n.attempt=n.try=function(e){if("function"!=typeof e)return a("expecting a function but got "+o.classString(e));var r,_=new n(t);if(_._captureStackTrace(),_._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];r=o.isArray(u)?s(e).apply(l,u):s(e).call(l,u)}else r=s(e)();var c=_._popContext();return i.checkForgottenReturns(r,c,"Promise.try",_),_._resolveFromSyncValue(r),_},n.prototype._resolveFromSyncValue=function(e){e===o.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,n,t){"use strict";var r=e("./util"),a=r.maybeWrapAsError,i=e("./errors").OperationalError,o=e("./es5"),s=/^(?:name|message|stack|cause)$/;function _(e){var n;if(function(e){return e instanceof Error&&o.getPrototypeOf(e)===Error.prototype}(e)){(n=new i(e)).name=e.name,n.message=e.message,n.stack=e.stack;for(var t=o.keys(e),a=0;a<t.length;++a){var _=t[a];s.test(_)||(n[_]=e[_])}return n}return r.markAsOriginatingFromRejection(e),e}n.exports=function(e,n){return function(t,r){if(null!==e){if(t){var i=_(a(t));e._attachExtraTrace(i),e._reject(i)}else if(n){var o=[].slice.call(arguments,1);e._fulfill(o)}else e._fulfill(r);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,n,t){"use strict";n.exports=function(n){var t=e("./util"),r=n._async,a=t.tryCatch,i=t.errorObj;function o(e,n){if(!t.isArray(e))return s.call(this,e,n);var o=a(n).apply(this._boundValue(),[null].concat(e));o===i&&r.throwLater(o.e)}function s(e,n){var t=this._boundValue(),o=void 0===e?a(n).call(t,null):a(n).call(t,null,e);o===i&&r.throwLater(o.e)}function _(e,n){if(!e){var t=new Error(e+"");t.cause=e,e=t}var o=a(n).call(this._boundValue(),e);o===i&&r.throwLater(o.e)}n.prototype.asCallback=n.prototype.nodeify=function(e,n){if("function"==typeof e){var t=s;void 0!==n&&Object(n).spread&&(t=o),this._then(t,_,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,n,t){"use strict";n.exports=function(){var t=function(){return new v("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},a=function(){return new L.PromiseInspection(this._target())},i=function(e){return L.reject(new v(e))};function o(){}var s={},_=e("./util");_.setReflectHandler(a);var u=function(){var e=r.domain;return void 0===e?null:e},l=function(){return{domain:u(),async:null}},c=_.isNode&&_.nodeSupportsAsyncResource?e("async_hooks").AsyncResource:null,h=function(){return{domain:u(),async:new c("Bluebird::Promise")}},d=_.isNode?l:function(){return null};_.notEnumerableProp(L,"_getContext",d);var f=e("./es5"),p=e("./async"),m=new p;f.defineProperty(L,"_async",{value:m});var g=e("./errors"),v=L.TypeError=g.TypeError;L.RangeError=g.RangeError;var E=L.CancellationError=g.CancellationError;L.TimeoutError=g.TimeoutError,L.OperationalError=g.OperationalError,L.RejectionError=g.OperationalError,L.AggregateError=g.AggregateError;var b=function(){},M={},y={},O=e("./thenables")(L,b),P=e("./promise_array")(L,b,O,i,o),x=e("./context")(L),D=x.create,T=e("./debuggability")(L,x,(function(){d=h,_.notEnumerableProp(L,"_getContext",h)}),(function(){d=l,_.notEnumerableProp(L,"_getContext",l)})),A=(T.CapturedTrace,e("./finally")(L,O,y)),C=e("./catch_filter")(y),w=e("./nodeback"),R=_.errorObj,I=_.tryCatch;function L(e){e!==b&&function(e,n){if(null==e||e.constructor!==L)throw new v("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof n)throw new v("expecting a function but got "+_.classString(n))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function S(e){this.promise._resolveCallback(e)}function B(e){this.promise._rejectCallback(e,!1)}function U(e){var n=new L(b);n._fulfillmentHandler0=e,n._rejectionHandler0=e,n._promise0=e,n._receiver0=e}return L.prototype.toString=function(){return"[object Promise]"},L.prototype.caught=L.prototype.catch=function(e){var n=arguments.length;if(n>1){var t,r=new Array(n-1),a=0;for(t=0;t<n-1;++t){var o=arguments[t];if(!_.isObject(o))return i("Catch statement predicate: expecting an object but got "+_.classString(o));r[a++]=o}if(r.length=a,"function"!=typeof(e=arguments[t]))throw new v("The last argument to .catch() must be a function, got "+_.toString(e));return this.then(void 0,C(r,e,this))}return this.then(void 0,e)},L.prototype.reflect=function(){return this._then(a,a,void 0,this,void 0)},L.prototype.then=function(e,n){if(T.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof n){var t=".then() only accepts functions but was passed: "+_.classString(e);arguments.length>1&&(t+=", "+_.classString(n)),this._warn(t)}return this._then(e,n,void 0,void 0,void 0)},L.prototype.done=function(e,n){this._then(e,n,void 0,void 0,void 0)._setIsFinal()},L.prototype.spread=function(e){return"function"!=typeof e?i("expecting a function but got "+_.classString(e)):this.all()._then(e,void 0,void 0,M,void 0)},L.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},L.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new P(this).promise()},L.prototype.error=function(e){return this.caught(_.originatesFromRejection,e)},L.getNewLibraryCopy=n.exports,L.is=function(e){return e instanceof L},L.fromNode=L.fromCallback=function(e){var n=new L(b);n._captureStackTrace();var t=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=I(e)(w(n,t));return r===R&&n._rejectCallback(r.e,!0),n._isFateSealed()||n._setAsyncGuaranteed(),n},L.all=function(e){return new P(e).promise()},L.cast=function(e){var n=O(e);return n instanceof L||((n=new L(b))._captureStackTrace(),n._setFulfilled(),n._rejectionHandler0=e),n},L.resolve=L.fulfilled=L.cast,L.reject=L.rejected=function(e){var n=new L(b);return n._captureStackTrace(),n._rejectCallback(e,!0),n},L.setScheduler=function(e){if("function"!=typeof e)throw new v("expecting a function but got "+_.classString(e));return m.setScheduler(e)},L.prototype._then=function(e,n,t,r,a){var i=void 0!==a,o=i?a:new L(b),s=this._target(),u=s._bitField;i||(o._propagateFrom(this,3),o._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&u)?this._boundValue():s===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,o));var l=d();if(0!=(50397184&u)){var c,h,f=s._settlePromiseCtx;0!=(33554432&u)?(h=s._rejectionHandler0,c=e):0!=(16777216&u)?(h=s._fulfillmentHandler0,c=n,s._unsetRejectionIsUnhandled()):(f=s._settlePromiseLateCancellationObserver,h=new E("late cancellation observer"),s._attachExtraTrace(h),c=n),m.invoke(f,s,{handler:_.contextBind(l,c),promise:o,receiver:r,value:h})}else s._addCallbacks(e,n,o,r,l);return o},L.prototype._length=function(){return 65535&this._bitField},L.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},L.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},L.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},L.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},L.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},L.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},L.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},L.prototype._isFinal=function(){return(4194304&this._bitField)>0},L.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},L.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},L.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},L.prototype._setAsyncGuaranteed=function(){if(!m.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},L.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},L.prototype._receiverAt=function(e){var n=0===e?this._receiver0:this[4*e-4+3];if(n!==s)return void 0===n&&this._isBound()?this._boundValue():n},L.prototype._promiseAt=function(e){return this[4*e-4+2]},L.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},L.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},L.prototype._boundValue=function(){},L.prototype._migrateCallback0=function(e){e._bitField;var n=e._fulfillmentHandler0,t=e._rejectionHandler0,r=e._promise0,a=e._receiverAt(0);void 0===a&&(a=s),this._addCallbacks(n,t,r,a,null)},L.prototype._migrateCallbackAt=function(e,n){var t=e._fulfillmentHandlerAt(n),r=e._rejectionHandlerAt(n),a=e._promiseAt(n),i=e._receiverAt(n);void 0===i&&(i=s),this._addCallbacks(t,r,a,i,null)},L.prototype._addCallbacks=function(e,n,t,r,a){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=t,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=_.contextBind(a,e)),"function"==typeof n&&(this._rejectionHandler0=_.contextBind(a,n));else{var o=4*i-4;this[o+2]=t,this[o+3]=r,"function"==typeof e&&(this[o+0]=_.contextBind(a,e)),"function"==typeof n&&(this[o+1]=_.contextBind(a,n))}return this._setLength(i+1),i},L.prototype._proxy=function(e,n){this._addCallbacks(void 0,void 0,n,e,null)},L.prototype._resolveCallback=function(e,n){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(t(),!1);var r=O(e,this);if(!(r instanceof L))return this._fulfill(e);n&&this._propagateFrom(r,2);var a=r._target();if(a!==this){var i=a._bitField;if(0==(50397184&i)){var o=this._length();o>0&&a._migrateCallback0(this);for(var s=1;s<o;++s)a._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&i))this._fulfill(a._value());else if(0!=(16777216&i))this._reject(a._reason());else{var _=new E("late cancellation observer");a._attachExtraTrace(_),this._reject(_)}}else this._reject(t())}},L.prototype._rejectCallback=function(e,n,t){var r=_.ensureErrorObject(e),a=r===e;if(!a&&!t&&T.warnings()){var i="a promise was rejected with a non-error: "+_.classString(e);this._warn(i,!0)}this._attachExtraTrace(r,!!n&&a),this._reject(e)},L.prototype._resolveFromExecutor=function(e){if(e!==b){var n=this;this._captureStackTrace(),this._pushContext();var t=!0,r=this._execute(e,(function(e){n._resolveCallback(e)}),(function(e){n._rejectCallback(e,t)}));t=!1,this._popContext(),void 0!==r&&n._rejectCallback(r,!0)}},L.prototype._settlePromiseFromHandler=function(e,n,t,r){var a=r._bitField;if(0==(65536&a)){var i;r._pushContext(),n===M?t&&"number"==typeof t.length?i=I(e).apply(this._boundValue(),t):(i=R).e=new v("cannot .spread() a non-array: "+_.classString(t)):i=I(e).call(n,t);var o=r._popContext();0==(65536&(a=r._bitField))&&(i===y?r._reject(t):i===R?r._rejectCallback(i.e,!1):(T.checkForgottenReturns(i,o,"",r,this),r._resolveCallback(i)))}},L.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},L.prototype._followee=function(){return this._rejectionHandler0},L.prototype._setFollowee=function(e){this._rejectionHandler0=e},L.prototype._settlePromise=function(e,n,t,r){var i=e instanceof L,s=this._bitField,_=0!=(134217728&s);0!=(65536&s)?(i&&e._invokeInternalOnCancel(),t instanceof A&&t.isFinallyHandler()?(t.cancelPromise=e,I(n).call(t,r)===R&&e._reject(R.e)):n===a?e._fulfill(a.call(t)):t instanceof o?t._promiseCancelled(e):i||e instanceof P?e._cancel():t.cancel()):"function"==typeof n?i?(_&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(n,t,r,e)):n.call(t,r,e):t instanceof o?t._isResolved()||(0!=(33554432&s)?t._promiseFulfilled(r,e):t._promiseRejected(r,e)):i&&(_&&e._setAsyncGuaranteed(),0!=(33554432&s)?e._fulfill(r):e._reject(r))},L.prototype._settlePromiseLateCancellationObserver=function(e){var n=e.handler,t=e.promise,r=e.receiver,a=e.value;"function"==typeof n?t instanceof L?this._settlePromiseFromHandler(n,r,a,t):n.call(r,a,t):t instanceof L&&t._reject(a)},L.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},L.prototype._settlePromise0=function(e,n,t){var r=this._promise0,a=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,a,n)},L.prototype._clearCallbackDataAtIndex=function(e){var n=4*e-4;this[n+2]=this[n+3]=this[n+0]=this[n+1]=void 0},L.prototype._fulfill=function(e){var n=this._bitField;if(!((117506048&n)>>>16)){if(e===this){var r=t();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&n)>0&&(0!=(134217728&n)?this._settlePromises():m.settlePromises(this),this._dereferenceTrace())}},L.prototype._reject=function(e){var n=this._bitField;if(!((117506048&n)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return m.fatalError(e,_.isNode);(65535&n)>0?m.settlePromises(this):this._ensurePossibleRejectionHandled()}},L.prototype._fulfillPromises=function(e,n){for(var t=1;t<e;t++){var r=this._fulfillmentHandlerAt(t),a=this._promiseAt(t),i=this._receiverAt(t);this._clearCallbackDataAtIndex(t),this._settlePromise(a,r,i,n)}},L.prototype._rejectPromises=function(e,n){for(var t=1;t<e;t++){var r=this._rejectionHandlerAt(t),a=this._promiseAt(t),i=this._receiverAt(t);this._clearCallbackDataAtIndex(t),this._settlePromise(a,r,i,n)}},L.prototype._settlePromises=function(){var e=this._bitField,n=65535&e;if(n>0){if(0!=(16842752&e)){var t=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,t,e),this._rejectPromises(n,t)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(n,r)}this._setLength(0)}this._clearCancellationData()},L.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&f.defineProperty(L.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),L.defer=L.pending=function(){return T.deprecated("Promise.defer","new Promise"),{promise:new L(b),resolve:S,reject:B}},_.notEnumerableProp(L,"_makeSelfResolutionError",t),e("./method")(L,b,O,i,T),e("./bind")(L,b,O,T),e("./cancel")(L,P,i,T),e("./direct_resolve")(L),e("./synchronous_inspection")(L),e("./join")(L,P,O,b,m),L.Promise=L,L.version="3.7.2",e("./call_get.js")(L),e("./generators.js")(L,i,b,O,o,T),e("./map.js")(L,P,i,O,b,T),e("./nodeify.js")(L),e("./promisify.js")(L,b),e("./props.js")(L,P,O,i),e("./race.js")(L,b,O,i),e("./reduce.js")(L,P,i,O,b,T),e("./settle.js")(L,P,T),e("./some.js")(L,P,i),e("./timers.js")(L,b,T),e("./using.js")(L,i,O,D,b,T),e("./any.js")(L),e("./each.js")(L,b),e("./filter.js")(L,b),_.toFastProperties(L),_.toFastProperties(L.prototype),U({a:1}),U({b:2}),U({c:3}),U(1),U((function(){})),U(void 0),U(!1),U(new L(b)),T.setBounds(p.firstLineError,_.lastLineError),L}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i){var o=e("./util");function s(e){var r=this._promise=new n(t);e instanceof n&&(r._propagateFrom(e,3),e.suppressUnhandledRejections()),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return o.isArray,o.inherits(s,i),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function e(t,i){var s=r(this._values,this._promise);if(s instanceof n){var _=(s=s._target())._bitField;if(this._values=s,0==(50397184&_))return this._promise._setAsyncGuaranteed(),s._then(e,this._reject,void 0,this,i);if(0==(33554432&_))return 0!=(16777216&_)?this._reject(s._reason()):this._cancel();s=s._value()}if(null!==(s=o.asArray(s)))0!==s.length?this._iterate(s):-5===i?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(i));else{var u=a("expecting an array or an iterable object but got "+o.classString(s)).reason();this._promise._rejectCallback(u,!1)}},s.prototype._iterate=function(e){var t=this.getActualLength(e.length);this._length=t,this._values=this.shouldCopyValues()?new Array(t):this._values;for(var a=this._promise,i=!1,o=null,s=0;s<t;++s){var _=r(e[s],a);o=_ instanceof n?(_=_._target())._bitField:null,i?null!==o&&_.suppressUnhandledRejections():null!==o?0==(50397184&o)?(_._proxy(this,s),this._values[s]=_):i=0!=(33554432&o)?this._promiseFulfilled(_._value(),s):0!=(16777216&o)?this._promiseRejected(_._reason(),s):this._promiseCancelled(s):i=this._promiseFulfilled(_,s)}i||a._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,n){return this._values[n]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof n)e.cancel();else for(var t=0;t<e.length;++t)e[t]instanceof n&&e[t].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},{"./util":36}],24:[function(e,n,t){"use strict";n.exports=function(n,t){var r={},a=e("./util"),i=e("./nodeback"),o=a.withAppended,s=a.maybeWrapAsError,_=a.canEvaluate,u=e("./errors").TypeError,l={__isPromisified__:!0},c=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(e){return a.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function d(e){return!c.test(e)}function f(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function p(e,n,t){var r=a.getDataPropertyOrDefault(e,n+t,l);return!!r&&f(r)}function m(e,n,t,r){for(var i=a.inheritedDataKeys(e),o=[],s=0;s<i.length;++s){var _=i[s],l=e[_],c=r===h||h(_,l,e);"function"!=typeof l||f(l)||p(e,_,n)||!r(_,l,e,c)||o.push(_,l)}return function(e,n,t){for(var r=0;r<e.length;r+=2){var a=e[r];if(t.test(a))for(var i=a.replace(t,""),o=0;o<e.length;o+=2)if(e[o]===i)throw new u("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",n))}}(o,n,t),o}var g=_?void 0:function(e,_,u,l,c,h){var d=function(){return this}(),f=e;function p(){var a=_;_===r&&(a=this);var u=new n(t);u._captureStackTrace();var l="string"==typeof f&&this!==d?this[f]:e,c=i(u,h);try{l.apply(a,o(arguments,c))}catch(e){u._rejectCallback(s(e),!0,!0)}return u._isFateSealed()||u._setAsyncGuaranteed(),u}return"string"==typeof f&&(e=l),a.notEnumerableProp(p,"__isPromisified__",!0),p};function v(e,n,t,i,o){for(var s=new RegExp(n.replace(/([$])/,"\\$")+"$"),_=m(e,n,s,t),u=0,l=_.length;u<l;u+=2){var c=_[u],h=_[u+1],d=c+n;if(i===g)e[d]=g(c,r,c,h,n,o);else{var f=i(h,(function(){return g(c,r,c,h,n,o)}));a.notEnumerableProp(f,"__isPromisified__",!0),e[d]=f}}return a.toFastProperties(e),e}n.promisify=function(e,n){if("function"!=typeof e)throw new u("expecting a function but got "+a.classString(e));if(f(e))return e;var t=function(e,n,t){return g(e,n,void 0,e,null,t)}(e,void 0===(n=Object(n)).context?r:n.context,!!n.multiArgs);return a.copyDescriptors(e,t,d),t},n.promisifyAll=function(e,n){if("function"!=typeof e&&"object"!=typeof e)throw new u("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var t=!!(n=Object(n)).multiArgs,r=n.suffix;"string"!=typeof r&&(r="Async");var i=n.filter;"function"!=typeof i&&(i=h);var o=n.promisifier;if("function"!=typeof o&&(o=g),!a.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=a.inheritedDataKeys(e),_=0;_<s.length;++_){var l=e[s[_]];"constructor"!==s[_]&&a.isClass(l)&&(v(l.prototype,r,i,o,t),v(l,r,i,o,t))}return v(e,r,i,o,t)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,n,t){"use strict";n.exports=function(n,t,r,a){var i,o=e("./util"),s=o.isObject,_=e("./es5");"function"==typeof Map&&(i=Map);var u=function(){var e=0,n=0;function t(t,r){this[e]=t,this[e+n]=r,e++}return function(r){n=r.size,e=0;var a=new Array(2*r.size);return r.forEach(t,a),a}}();function l(e){var n,t=!1;if(void 0!==i&&e instanceof i)n=u(e),t=!0;else{var r=_.keys(e),a=r.length;n=new Array(2*a);for(var o=0;o<a;++o){var s=r[o];n[o]=e[s],n[o+a]=s}}this.constructor$(n),this._isMap=t,this._init$(void 0,t?-6:-3)}function c(e){var t,i=r(e);return s(i)?(t=i instanceof n?i._then(n.props,void 0,void 0,void 0,void 0):new l(i).promise(),i instanceof n&&t._propagateFrom(i,2),t):a("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}o.inherits(l,t),l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,n){if(this._values[n]=e,++this._totalResolved>=this._length){var t;if(this._isMap)t=function(e){for(var n=new i,t=e.length/2|0,r=0;r<t;++r){var a=e[t+r],o=e[r];n.set(a,o)}return n}(this._values);else{t={};for(var r=this.length(),a=0,o=this.length();a<o;++a)t[this._values[a+r]]=this._values[a]}return this._resolve(t),!0}return!1},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(e){return e>>1},n.prototype.props=function(){return c(this)},n.props=function(e){return c(e)}}},{"./es5":13,"./util":36}],26:[function(e,n,t){"use strict";function r(e){this._capacity=e,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(e){return this._capacity<e},r.prototype._pushOne=function(e){var n=this.length();this._checkCapacity(n+1),this[this._front+n&this._capacity-1]=e,this._length=n+1},r.prototype.push=function(e,n,t){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(n),void this._pushOne(t);var a=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[a+0&i]=e,this[a+1&i]=n,this[a+2&i]=t,this._length=r},r.prototype.shift=function(){var e=this._front,n=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,n},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(e){var n=this._capacity;this._capacity=e,function(e,n,t,r,a){for(var i=0;i<a;++i)t[i+r]=e[i+n],e[i+n]=void 0}(this,0,this,n,this._front+this._length&n-1)},n.exports=r},{}],27:[function(e,n,t){"use strict";n.exports=function(n,t,r,a){var i=e("./util");function o(e,s){var _,u=r(e);if(u instanceof n)return(_=u).then((function(e){return o(e,_)}));if(null===(e=i.asArray(e)))return a("expecting an array or an iterable object but got "+i.classString(e));var l=new n(t);void 0!==s&&l._propagateFrom(s,3);for(var c=l._fulfill,h=l._reject,d=0,f=e.length;d<f;++d){var p=e[d];(void 0!==p||d in e)&&n.cast(p)._then(c,h,void 0,l,null)}return l}n.race=function(e){return o(e,void 0)},n.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i,o){var s=e("./util"),_=s.tryCatch;function u(e,t,r,a){this.constructor$(e);var o=n._getContext();this._fn=s.contextBind(o,t),void 0!==r&&(r=n.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=a===i?Array(this._length):0===a?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,n){this.isFulfilled()?n._resolve(e):n._reject(e)}function c(e,n,t,a){return"function"!=typeof n?r("expecting a function but got "+s.classString(n)):new u(e,n,t,a).promise()}function h(e){this.accum=e,this.array._gotAccum(e);var t=a(this.value,this.array._promise);return t instanceof n?(this.array._currentCancellable=t,t._then(d,void 0,void 0,this,void 0)):d.call(this,t)}function d(e){var t,r=this.array,a=r._promise,i=_(r._fn);a._pushContext(),(t=void 0!==r._eachValues?i.call(a._boundValue(),e,this.index,this.length):i.call(a._boundValue(),this.accum,e,this.index,this.length))instanceof n&&(r._currentCancellable=t);var s=a._popContext();return o.checkForgottenReturns(t,s,void 0!==r._eachValues?"Promise.each":"Promise.reduce",a),t}s.inherits(u,t),u.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},u.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},u.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof n&&this._currentCancellable.cancel(),this._initialValue instanceof n&&this._initialValue.cancel())},u.prototype._iterate=function(e){var t,r;this._values=e;var a=e.length;void 0!==this._initialValue?(t=this._initialValue,r=0):(t=n.resolve(e[0]),r=1),this._currentCancellable=t;for(var i=r;i<a;++i){var o=e[i];o instanceof n&&o.suppressUnhandledRejections()}if(!t.isRejected())for(;r<a;++r){var s={accum:null,value:e[r],index:r,length:a,array:this};t=t._then(h,void 0,void 0,s,void 0),0==(127&r)&&t._setNoAsyncGuarantee()}void 0!==this._eachValues&&(t=t._then(this._eachComplete,void 0,void 0,this,void 0)),t._then(l,l,void 0,t,this)},n.prototype.reduce=function(e,n){return c(this,e,n,null)},n.reduce=function(e,n,t,r){return c(e,n,t,r)}}},{"./util":36}],29:[function(e,n,a){"use strict";var i,o,s,_,u,l=e("./util"),c=l.getNativePromise();if(l.isNode&&"undefined"==typeof MutationObserver){var h=t.g.setImmediate,d=r.nextTick;i=l.isRecentNode?function(e){h.call(t.g,e)}:function(e){d.call(r,e)}}else if("function"==typeof c&&"function"==typeof c.resolve){var f=c.resolve();i=function(e){f.then(e)}}else i="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:(o=document.createElement("div"),s={attributes:!0},_=!1,u=document.createElement("div"),new MutationObserver((function(){o.classList.toggle("foo"),_=!1})).observe(u,s),function(e){var n=new MutationObserver((function(){n.disconnect(),e()}));n.observe(o,s),_||(_=!0,u.classList.toggle("foo"))});n.exports=i},{"./util":36}],30:[function(e,n,t){"use strict";n.exports=function(n,t,r){var a=n.PromiseInspection;function i(e){this.constructor$(e)}e("./util").inherits(i,t),i.prototype._promiseResolved=function(e,n){return this._values[e]=n,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,n){var t=new a;return t._bitField=33554432,t._settledValueField=e,this._promiseResolved(n,t)},i.prototype._promiseRejected=function(e,n){var t=new a;return t._bitField=16777216,t._settledValueField=e,this._promiseResolved(n,t)},n.settle=function(e){return r.deprecated(".settle()",".reflect()"),new i(e).promise()},n.allSettled=function(e){return new i(e).promise()},n.prototype.settle=function(){return n.settle(this)}}},{"./util":36}],31:[function(e,n,t){"use strict";n.exports=function(n,t,r){var a=e("./util"),i=e("./errors").RangeError,o=e("./errors").AggregateError,s=a.isArray,_={};function u(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,n){if((0|n)!==n||n<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var t=new u(e),a=t.promise();return t.setHowMany(n),t.init(),a}a.inherits(u,t),u.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=s(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},u.prototype.init=function(){this._initialized=!0,this._init()},u.prototype.setUnwrap=function(){this._unwrap=!0},u.prototype.howMany=function(){return this._howMany},u.prototype.setHowMany=function(e){this._howMany=e},u.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},u.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},u.prototype._promiseCancelled=function(){return this._values instanceof n||null==this._values?this._cancel():(this._addRejected(_),this._checkOutcome())},u.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new o,n=this.length();n<this._values.length;++n)this._values[n]!==_&&e.push(this._values[n]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},u.prototype._fulfilled=function(){return this._totalResolved},u.prototype._rejected=function(){return this._values.length-this.length()},u.prototype._addRejected=function(e){this._values.push(e)},u.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},u.prototype._getRangeError=function(e){var n="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new i(n)},u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},n.some=function(e,n){return l(e,n)},n.prototype.some=function(e){return l(this,e)},n._SomePromiseArray=u}},{"./errors":12,"./util":36}],32:[function(e,n,t){"use strict";n.exports=function(e){function n(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}n.prototype._settledValue=function(){return this._settledValueField};var t=n.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=n.prototype.error=n.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},a=n.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},i=n.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},o=n.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=n.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};n.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return o.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return a.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return t.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=n}},{}],33:[function(e,n,t){"use strict";n.exports=function(n,t){var r=e("./util"),a=r.errorObj,i=r.isObject,o={}.hasOwnProperty;return function(e,s){if(i(e)){if(e instanceof n)return e;var _=function(e){try{return function(e){return e.then}(e)}catch(e){return a.e=e,a}}(e);if(_===a){s&&s._pushContext();var u=n.reject(_.e);return s&&s._popContext(),u}if("function"==typeof _)return function(e){try{return o.call(e,"_promise0")}catch(e){return!1}}(e)?(u=new n(t),e._then(u._fulfill,u._reject,void 0,u,null),u):function(e,i,o){var s=new n(t),_=s;o&&o._pushContext(),s._captureStackTrace(),o&&o._popContext();var u=!0,l=r.tryCatch(i).call(e,c,h);function c(e){s&&(s._resolveCallback(e),s=null)}function h(e){s&&(s._rejectCallback(e,u,!0),s=null)}return u=!1,s&&l===a&&(s._rejectCallback(l.e,!0,!0),s=null),_}(e,_,s)}return e}}},{"./util":36}],34:[function(e,n,t){"use strict";n.exports=function(n,t,r){var a=e("./util"),i=n.TimeoutError;function o(e){this.handle=e}o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var s=function(e){return _(+this).thenReturn(e)},_=n.delay=function(e,a){var i,_;return void 0!==a?(i=n.resolve(a)._then(s,null,null,e,void 0),r.cancellation()&&a instanceof n&&i._setOnCancel(a)):(i=new n(t),_=setTimeout((function(){i._fulfill()}),+e),r.cancellation()&&i._setOnCancel(new o(_)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};function u(e){return clearTimeout(this.handle),e}function l(e){throw clearTimeout(this.handle),e}n.prototype.delay=function(e){return _(e,this)},n.prototype.timeout=function(e,n){var t,s;e=+e;var _=new o(setTimeout((function(){t.isPending()&&function(e,n,t){var r;r="string"!=typeof n?n instanceof Error?n:new i("operation timed out"):new i(n),a.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=t&&t.cancel()}(t,n,s)}),e));return r.cancellation()?(s=this.then(),(t=s._then(u,l,void 0,_,void 0))._setOnCancel(_)):t=this._then(u,l,void 0,_,void 0),t}}},{"./util":36}],35:[function(e,n,t){"use strict";n.exports=function(n,t,r,a,i,o){var s=e("./util"),_=e("./errors").TypeError,u=e("./util").inherits,l=s.errorObj,c=s.tryCatch,h={};function d(e){setTimeout((function(){throw e}),0)}function f(e,t){var a=0,o=e.length,s=new n(i);return function i(){if(a>=o)return s._fulfill();var _=function(e){var n=r(e);return n!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&n._setDisposable(e._getDisposer()),n}(e[a++]);if(_ instanceof n&&_._isDisposable()){try{_=r(_._getDisposer().tryDispose(t),e.promise)}catch(e){return d(e)}if(_ instanceof n)return _._then(i,d,null,null,null)}i()}(),s}function p(e,n,t){this._data=e,this._promise=n,this._context=t}function m(e,n,t){this.constructor$(e,n,t)}function g(e){return p.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function v(e){this.length=e,this.promise=null,this[e-1]=null}p.prototype.data=function(){return this._data},p.prototype.promise=function(){return this._promise},p.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},p.prototype.tryDispose=function(e){var n=this.resource(),t=this._context;void 0!==t&&t._pushContext();var r=n!==h?this.doDispose(n,e):null;return void 0!==t&&t._popContext(),this._promise._unsetDisposable(),this._data=null,r},p.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},u(m,p),m.prototype.doDispose=function(e,n){return this.data().call(e,e,n)},v.prototype._resultCancelled=function(){for(var e=this.length,t=0;t<e;++t){var r=this[t];r instanceof n&&r.cancel()}},n.using=function(){var e=arguments.length;if(e<2)return t("you must pass at least 2 arguments to Promise.using");var a,i=arguments[e-1];if("function"!=typeof i)return t("expecting a function but got "+s.classString(i));var _=!0;2===e&&Array.isArray(arguments[0])?(e=(a=arguments[0]).length,_=!1):(a=arguments,e--);for(var u=new v(e),h=0;h<e;++h){var d=a[h];if(p.isDisposer(d)){var m=d;(d=d.promise())._setDisposable(m)}else{var E=r(d);E instanceof n&&(d=E._then(g,null,null,{resources:u,index:h},void 0))}u[h]=d}var b=new Array(u.length);for(h=0;h<b.length;++h)b[h]=n.resolve(u[h]).reflect();var M=n.all(b).then((function(e){for(var n=0;n<e.length;++n){var t=e[n];if(t.isRejected())return l.e=t.error(),l;if(!t.isFulfilled())return void M.cancel();e[n]=t.value()}y._pushContext(),i=c(i);var r=_?i.apply(void 0,e):i(e),a=y._popContext();return o.checkForgottenReturns(r,a,"Promise.using",y),r})),y=M.lastly((function(){var e=new n.PromiseInspection(M);return f(u,e)}));return u.promise=y,y._setOnCancel(u),y},n.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},n.prototype._isDisposable=function(){return(131072&this._bitField)>0},n.prototype._getDisposer=function(){return this._disposer},n.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},n.prototype.disposer=function(e){if("function"==typeof e)return new m(e,this,a());throw new _}}},{"./errors":12,"./util":36}],36:[function(e,n,a){"use strict";var i=e("./es5"),o="undefined"==typeof navigator,s={e:{}},_,u="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t.g?t.g:void 0!==this?this:null;function l(){try{var e=_;return _=null,e.apply(this,arguments)}catch(e){return s.e=e,s}}function c(e){return _=e,l}var h=function(e,n){var t={}.hasOwnProperty;function r(){for(var r in this.constructor=e,this.constructor$=n,n.prototype)t.call(n.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=n.prototype[r])}return r.prototype=n.prototype,e.prototype=new r,e.prototype};function d(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function f(e){return"function"==typeof e||"object"==typeof e&&null!==e}function p(e){return d(e)?new Error(T(e)):e}function m(e,n){var t,r=e.length,a=new Array(r+1);for(t=0;t<r;++t)a[t]=e[t];return a[t]=n,a}function g(e,n,t){if(!i.isES5)return{}.hasOwnProperty.call(e,n)?e[n]:void 0;var r=Object.getOwnPropertyDescriptor(e,n);return null!=r?null==r.get&&null==r.set?r.value:t:void 0}function v(e,n,t){if(d(e))return e;var r={value:t,configurable:!0,enumerable:!1,writable:!0};return i.defineProperty(e,n,r),e}function E(e){throw e}var b=function(){var e=[Array.prototype,Object.prototype,Function.prototype],n=function(n){for(var t=0;t<e.length;++t)if(e[t]===n)return!0;return!1};if(i.isES5){var t=Object.getOwnPropertyNames;return function(e){for(var r=[],a=Object.create(null);null!=e&&!n(e);){var o;try{o=t(e)}catch(e){return r}for(var s=0;s<o.length;++s){var _=o[s];if(!a[_]){a[_]=!0;var u=Object.getOwnPropertyDescriptor(e,_);null!=u&&null==u.get&&null==u.set&&r.push(_)}}e=i.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(t){if(n(t))return[];var a=[];e:for(var i in t)if(r.call(t,i))a.push(i);else{for(var o=0;o<e.length;++o)if(r.call(e[o],i))continue e;a.push(i)}return a}}(),M=/this\s*\.\s*\S+\s*=/;function y(e){try{if("function"==typeof e){var n=i.names(e.prototype),t=i.isES5&&n.length>1,r=n.length>0&&!(1===n.length&&"constructor"===n[0]),a=M.test(e+"")&&i.names(e).length>0;if(t||r||a)return!0}return!1}catch(e){return!1}}function O(e){function n(){}n.prototype=e;var t=new n;function r(){return typeof t.foo}return r(),r(),e}var P=/^[a-z$_][a-z$_0-9]*$/i;function x(e){return P.test(e)}function D(e,n,t){for(var r=new Array(e),a=0;a<e;++a)r[a]=n+a+t;return r}function T(e){try{return e+""}catch(e){return"[no string representation]"}}function A(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function C(e){try{v(e,"isOperational",!0)}catch(e){}}function w(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function R(e){return A(e)&&i.propertyIsWritable(e,"stack")}var I="stack"in new Error?function(e){return R(e)?e:new Error(T(e))}:function(e){if(R(e))return e;try{throw new Error(T(e))}catch(e){return e}};function L(e){return{}.toString.call(e)}function S(e,n,t){for(var r=i.names(e),a=0;a<r.length;++a){var o=r[a];if(t(o))try{i.defineProperty(n,o,i.getDescriptor(e,o))}catch(e){}}}var B=function(e){return i.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var U="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var n,t=[],r=e[Symbol.iterator]();!(n=r.next()).done;)t.push(n.value);return t};B=function(e){return i.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?U(e):null}}var k=void 0!==r&&"[object process]"===L(r).toLowerCase(),W=void 0!==r&&void 0!==r.env,N;function K(e){return W?r.env[e]:void 0}function F(){if("function"==typeof Promise)try{if("[object Promise]"===L(new Promise((function(){}))))return Promise}catch(e){}}function j(e,n){if(null===e||"function"!=typeof n||n===N)return n;null!==e.domain&&(n=e.domain.bind(n));var t=e.async;if(null!==t){var r=n;n=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=r,e[1]=this,t.runInAsyncScope.apply(t,e)}}return n}var q={setReflectHandler:function(e){N=e},isClass:y,isIdentifier:x,inheritedDataKeys:b,getDataPropertyOrDefault:g,thrower:E,isArray:i.isArray,asArray:B,notEnumerableProp:v,isPrimitive:d,isObject:f,isError:A,canEvaluate:o,errorObj:s,tryCatch:c,inherits:h,withAppended:m,maybeWrapAsError:p,toFastProperties:O,filledRange:D,toString:T,canAttachTrace:R,ensureErrorObject:I,originatesFromRejection:w,markAsOriginatingFromRejection:C,classString:L,copyDescriptors:S,isNode:k,hasEnvVariables:W,env:K,global:u,getNativePromise:F,contextBind:j},V;q.isRecentNode=q.isNode&&(r.versions&&r.versions.node?V=r.versions.node.split(".").map(Number):r.version&&(V=r.version.split(".").map(Number)),0===V[0]&&V[1]>10||V[0]>0),q.nodeSupportsAsyncResource=q.isNode&&function(){var n=!1;try{n="function"==typeof e("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(e){n=!1}return n}(),q.isNode&&q.toFastProperties(r);try{throw new Error}catch(e){q.lastLineError=e}n.exports=q},{"./es5":13,async_hooks:void 0}]},{},[4])(4)},e.exports=i(),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)},4505:(e,n,t)=>{"use strict";var r=t(8764).Buffer,a=t(4155),i=t(9282),o=t(2292),s=t(405),_=t(7948),u=t(1619);for(var l in u)n[l]=u[l];n.NONE=0,n.DEFLATE=1,n.INFLATE=2,n.GZIP=3,n.GUNZIP=4,n.DEFLATERAW=5,n.INFLATERAW=6,n.UNZIP=7;function c(e){if("number"!=typeof e||e<n.DEFLATE||e>n.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}c.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,i(this.init_done,"close before init"),i(this.mode<=n.UNZIP),this.mode===n.DEFLATE||this.mode===n.GZIP||this.mode===n.DEFLATERAW?s.deflateEnd(this.strm):this.mode!==n.INFLATE&&this.mode!==n.GUNZIP&&this.mode!==n.INFLATERAW&&this.mode!==n.UNZIP||_.inflateEnd(this.strm),this.mode=n.NONE,this.dictionary=null)},c.prototype.write=function(e,n,t,r,a,i,o){return this._write(!0,e,n,t,r,a,i,o)},c.prototype.writeSync=function(e,n,t,r,a,i,o){return this._write(!1,e,n,t,r,a,i,o)},c.prototype._write=function(e,t,o,s,_,u,l,c){if(i.equal(arguments.length,8),i(this.init_done,"write before init"),i(this.mode!==n.NONE,"already finalized"),i.equal(!1,this.write_in_progress,"write already in progress"),i.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,i.equal(!1,void 0===t,"must provide flush value"),this.write_in_progress=!0,t!==n.Z_NO_FLUSH&&t!==n.Z_PARTIAL_FLUSH&&t!==n.Z_SYNC_FLUSH&&t!==n.Z_FULL_FLUSH&&t!==n.Z_FINISH&&t!==n.Z_BLOCK)throw new Error("Invalid flush value");if(null==o&&(o=r.alloc(0),_=0,s=0),this.strm.avail_in=_,this.strm.input=o,this.strm.next_in=s,this.strm.avail_out=c,this.strm.output=u,this.strm.next_out=l,this.flush=t,!e)return this._process(),this._checkError()?this._afterSync():void 0;var h=this;return a.nextTick((function(){h._process(),h._after()})),this},c.prototype._afterSync=function(){var e=this.strm.avail_out,n=this.strm.avail_in;return this.write_in_progress=!1,[n,e]},c.prototype._process=function(){var e=null;switch(this.mode){case n.DEFLATE:case n.GZIP:case n.DEFLATERAW:this.err=s.deflate(this.strm,this.flush);break;case n.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=n.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=n.GUNZIP):this.mode=n.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case n.INFLATE:case n.GUNZIP:case n.INFLATERAW:for(this.err=_.inflate(this.strm,this.flush),this.err===n.Z_NEED_DICT&&this.dictionary&&(this.err=_.inflateSetDictionary(this.strm,this.dictionary),this.err===n.Z_OK?this.err=_.inflate(this.strm,this.flush):this.err===n.Z_DATA_ERROR&&(this.err=n.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===n.GUNZIP&&this.err===n.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=_.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},c.prototype._checkError=function(){switch(this.err){case n.Z_OK:case n.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===n.Z_FINISH)return this._error("unexpected end of file"),!1;break;case n.Z_STREAM_END:break;case n.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},c.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,n=this.strm.avail_in;this.write_in_progress=!1,this.callback(n,e),this.pending_close&&this.close()}},c.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},c.prototype.init=function(e,t,r,a,o){i(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),i(e>=8&&e<=15,"invalid windowBits"),i(t>=-1&&t<=9,"invalid compression level"),i(r>=1&&r<=9,"invalid memlevel"),i(a===n.Z_FILTERED||a===n.Z_HUFFMAN_ONLY||a===n.Z_RLE||a===n.Z_FIXED||a===n.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(t,e,r,a,o),this._setDictionary()},c.prototype.params=function(){throw new Error("deflateParams Not supported")},c.prototype.reset=function(){this._reset(),this._setDictionary()},c.prototype._init=function(e,t,r,a,i){switch(this.level=e,this.windowBits=t,this.memLevel=r,this.strategy=a,this.flush=n.Z_NO_FLUSH,this.err=n.Z_OK,this.mode!==n.GZIP&&this.mode!==n.GUNZIP||(this.windowBits+=16),this.mode===n.UNZIP&&(this.windowBits+=32),this.mode!==n.DEFLATERAW&&this.mode!==n.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new o,this.mode){case n.DEFLATE:case n.GZIP:case n.DEFLATERAW:this.err=s.deflateInit2(this.strm,this.level,n.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case n.INFLATE:case n.GUNZIP:case n.INFLATERAW:case n.UNZIP:this.err=_.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==n.Z_OK&&this._error("Init error"),this.dictionary=i,this.write_in_progress=!1,this.init_done=!0},c.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=n.Z_OK,this.mode){case n.DEFLATE:case n.DEFLATERAW:this.err=s.deflateSetDictionary(this.strm,this.dictionary)}this.err!==n.Z_OK&&this._error("Failed to set dictionary")}},c.prototype._reset=function(){switch(this.err=n.Z_OK,this.mode){case n.DEFLATE:case n.DEFLATERAW:case n.GZIP:this.err=s.deflateReset(this.strm);break;case n.INFLATE:case n.INFLATERAW:case n.GUNZIP:this.err=_.inflateReset(this.strm)}this.err!==n.Z_OK&&this._error("Failed to reset stream")},n.Zlib=c},2635:(e,n,t)=>{"use strict";var r=t(4155),a=t(8764).Buffer,i=t(2830).Transform,o=t(4505),s=t(9539),_=t(9282).ok,u=t(8764).kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+u.toString(16)+" bytes";o.Z_MIN_WINDOWBITS=8,o.Z_MAX_WINDOWBITS=15,o.Z_DEFAULT_WINDOWBITS=15,o.Z_MIN_CHUNK=64,o.Z_MAX_CHUNK=1/0,o.Z_DEFAULT_CHUNK=16384,o.Z_MIN_MEMLEVEL=1,o.Z_MAX_MEMLEVEL=9,o.Z_DEFAULT_MEMLEVEL=8,o.Z_MIN_LEVEL=-1,o.Z_MAX_LEVEL=9,o.Z_DEFAULT_LEVEL=o.Z_DEFAULT_COMPRESSION;for(var c=Object.keys(o),h=0;h<c.length;h++){var d=c[h];d.match(/^Z/)&&Object.defineProperty(n,d,{enumerable:!0,value:o[d],writable:!1})}for(var f={Z_OK:o.Z_OK,Z_STREAM_END:o.Z_STREAM_END,Z_NEED_DICT:o.Z_NEED_DICT,Z_ERRNO:o.Z_ERRNO,Z_STREAM_ERROR:o.Z_STREAM_ERROR,Z_DATA_ERROR:o.Z_DATA_ERROR,Z_MEM_ERROR:o.Z_MEM_ERROR,Z_BUF_ERROR:o.Z_BUF_ERROR,Z_VERSION_ERROR:o.Z_VERSION_ERROR},p=Object.keys(f),m=0;m<p.length;m++){var g=p[m];f[f[g]]=g}function v(e,n,t){var r=[],i=0;function o(){for(var n;null!==(n=e.read());)r.push(n),i+=n.length;e.once("readable",o)}function s(){var n,o=null;i>=u?o=new RangeError(l):n=a.concat(r,i),r=[],e.close(),t(o,n)}e.on("error",(function(n){e.removeListener("end",s),e.removeListener("readable",o),t(n)})),e.on("end",s),e.end(n),o()}function E(e,n){if("string"==typeof n&&(n=a.from(n)),!a.isBuffer(n))throw new TypeError("Not a string or buffer");var t=e._finishFlushFlag;return e._processChunk(n,t)}function b(e){if(!(this instanceof b))return new b(e);A.call(this,e,o.DEFLATE)}function M(e){if(!(this instanceof M))return new M(e);A.call(this,e,o.INFLATE)}function y(e){if(!(this instanceof y))return new y(e);A.call(this,e,o.GZIP)}function O(e){if(!(this instanceof O))return new O(e);A.call(this,e,o.GUNZIP)}function P(e){if(!(this instanceof P))return new P(e);A.call(this,e,o.DEFLATERAW)}function x(e){if(!(this instanceof x))return new x(e);A.call(this,e,o.INFLATERAW)}function D(e){if(!(this instanceof D))return new D(e);A.call(this,e,o.UNZIP)}function T(e){return e===o.Z_NO_FLUSH||e===o.Z_PARTIAL_FLUSH||e===o.Z_SYNC_FLUSH||e===o.Z_FULL_FLUSH||e===o.Z_FINISH||e===o.Z_BLOCK}function A(e,t){var r=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||n.Z_DEFAULT_CHUNK,i.call(this,e),e.flush&&!T(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!T(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||o.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:o.Z_FINISH,e.chunkSize&&(e.chunkSize<n.Z_MIN_CHUNK||e.chunkSize>n.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<n.Z_MIN_WINDOWBITS||e.windowBits>n.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<n.Z_MIN_LEVEL||e.level>n.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<n.Z_MIN_MEMLEVEL||e.memLevel>n.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=n.Z_FILTERED&&e.strategy!=n.Z_HUFFMAN_ONLY&&e.strategy!=n.Z_RLE&&e.strategy!=n.Z_FIXED&&e.strategy!=n.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!a.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new o.Zlib(t);var s=this;this._hadError=!1,this._handle.onerror=function(e,t){C(s),s._hadError=!0;var r=new Error(e);r.errno=t,r.code=n.codes[t],s.emit("error",r)};var _=n.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(_=e.level);var u=n.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(u=e.strategy),this._handle.init(e.windowBits||n.Z_DEFAULT_WINDOWBITS,_,e.memLevel||n.Z_DEFAULT_MEMLEVEL,u,e.dictionary),this._buffer=a.allocUnsafe(this._chunkSize),this._offset=0,this._level=_,this._strategy=u,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!r._handle},configurable:!0,enumerable:!0})}function C(e,n){n&&r.nextTick(n),e._handle&&(e._handle.close(),e._handle=null)}function w(e){e.emit("close")}Object.defineProperty(n,"codes",{enumerable:!0,value:Object.freeze(f),writable:!1}),n.Deflate=b,n.Inflate=M,n.Gzip=y,n.Gunzip=O,n.DeflateRaw=P,n.InflateRaw=x,n.Unzip=D,n.createDeflate=function(e){return new b(e)},n.createInflate=function(e){return new M(e)},n.createDeflateRaw=function(e){return new P(e)},n.createInflateRaw=function(e){return new x(e)},n.createGzip=function(e){return new y(e)},n.createGunzip=function(e){return new O(e)},n.createUnzip=function(e){return new D(e)},n.deflate=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new b(n),e,t)},n.deflateSync=function(e,n){return E(new b(n),e)},n.gzip=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new y(n),e,t)},n.gzipSync=function(e,n){return E(new y(n),e)},n.deflateRaw=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new P(n),e,t)},n.deflateRawSync=function(e,n){return E(new P(n),e)},n.unzip=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new D(n),e,t)},n.unzipSync=function(e,n){return E(new D(n),e)},n.inflate=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new M(n),e,t)},n.inflateSync=function(e,n){return E(new M(n),e)},n.gunzip=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new O(n),e,t)},n.gunzipSync=function(e,n){return E(new O(n),e)},n.inflateRaw=function(e,n,t){return"function"==typeof n&&(t=n,n={}),v(new x(n),e,t)},n.inflateRawSync=function(e,n){return E(new x(n),e)},s.inherits(A,i),A.prototype.params=function(e,t,a){if(e<n.Z_MIN_LEVEL||e>n.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=n.Z_FILTERED&&t!=n.Z_HUFFMAN_ONLY&&t!=n.Z_RLE&&t!=n.Z_FIXED&&t!=n.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var i=this;this.flush(o.Z_SYNC_FLUSH,(function(){_(i._handle,"zlib binding closed"),i._handle.params(e,t),i._hadError||(i._level=e,i._strategy=t,a&&a())}))}else r.nextTick(a)},A.prototype.reset=function(){return _(this._handle,"zlib binding closed"),this._handle.reset()},A.prototype._flush=function(e){this._transform(a.alloc(0),"",e)},A.prototype.flush=function(e,n){var t=this,i=this._writableState;("function"==typeof e||void 0===e&&!n)&&(n=e,e=o.Z_FULL_FLUSH),i.ended?n&&r.nextTick(n):i.ending?n&&this.once("end",n):i.needDrain?n&&this.once("drain",(function(){return t.flush(e,n)})):(this._flushFlag=e,this.write(a.alloc(0),"",n))},A.prototype.close=function(e){C(this,e),r.nextTick(w,this)},A.prototype._transform=function(e,n,t){var r,i=this._writableState,s=(i.ending||i.ended)&&(!e||i.length===e.length);return null===e||a.isBuffer(e)?this._handle?(s?r=this._finishFlushFlag:(r=this._flushFlag,e.length>=i.length&&(this._flushFlag=this._opts.flush||o.Z_NO_FLUSH)),void this._processChunk(e,r,t)):t(new Error("zlib binding closed")):t(new Error("invalid input"))},A.prototype._processChunk=function(e,n,t){var r=e&&e.length,i=this._chunkSize-this._offset,o=0,s=this,c="function"==typeof t;if(!c){var h,d=[],f=0;this.on("error",(function(e){h=e})),_(this._handle,"zlib binding closed");do{var p=this._handle.writeSync(n,e,o,r,this._buffer,this._offset,i)}while(!this._hadError&&v(p[0],p[1]));if(this._hadError)throw h;if(f>=u)throw C(this),new RangeError(l);var m=a.concat(d,f);return C(this),m}_(this._handle,"zlib binding closed");var g=this._handle.write(n,e,o,r,this._buffer,this._offset,i);function v(u,l){if(this&&(this.buffer=null,this.callback=null),!s._hadError){var h=i-l;if(_(h>=0,"have should not go down"),h>0){var p=s._buffer.slice(s._offset,s._offset+h);s._offset+=h,c?s.push(p):(d.push(p),f+=p.length)}if((0===l||s._offset>=s._chunkSize)&&(i=s._chunkSize,s._offset=0,s._buffer=a.allocUnsafe(s._chunkSize)),0===l){if(o+=r-u,r=u,!c)return!0;var m=s._handle.write(n,e,o,r,s._buffer,s._offset,s._chunkSize);return m.callback=v,void(m.buffer=e)}if(!c)return!1;t()}}g.buffer=e,g.callback=v},s.inherits(b,A),s.inherits(M,A),s.inherits(y,A),s.inherits(O,A),s.inherits(P,A),s.inherits(x,A),s.inherits(D,A)},8764:(e,n,t)=>{"use strict";var r=t(5108);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const a=t(9742),i=t(645),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=u,n.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},n.INSPECT_MAX_BYTES=50;const s=2147483647;function _(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const n=new Uint8Array(e);return Object.setPrototypeOf(n,u.prototype),n}function u(e,n,t){if("number"==typeof e){if("string"==typeof n)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,n,t)}function l(e,n,t){if("string"==typeof e)return function(e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);const t=0|m(e,n);let r=_(t);const a=r.write(e,n);a!==t&&(r=r.slice(0,a));return r}(e,n);if(ArrayBuffer.isView(e))return function(e){if(Z(e,Uint8Array)){const n=new Uint8Array(e);return f(n.buffer,n.byteOffset,n.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Z(e,ArrayBuffer)||e&&Z(e.buffer,ArrayBuffer))return f(e,n,t);if("undefined"!=typeof SharedArrayBuffer&&(Z(e,SharedArrayBuffer)||e&&Z(e.buffer,SharedArrayBuffer)))return f(e,n,t);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return u.from(r,n,t);const a=function(e){if(u.isBuffer(e)){const n=0|p(e.length),t=_(n);return 0===t.length||e.copy(t,0,0,n),t}if(void 0!==e.length)return"number"!=typeof e.length||Q(e.length)?_(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),n,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return c(e),_(e<0?0:0|p(e))}function d(e){const n=e.length<0?0:0|p(e.length),t=_(n);for(let r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(e,n,t){if(n<0||e.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<n+(t||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===n&&void 0===t?new Uint8Array(e):void 0===t?new Uint8Array(e,n):new Uint8Array(e,n,t),Object.setPrototypeOf(r,u.prototype),r}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function m(e,n){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const t=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===t)return 0;let a=!1;for(;;)switch(n){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return X(e).length;default:if(a)return r?-1:H(e).length;n=(""+n).toLowerCase(),a=!0}}function g(e,n,t){let r=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(n>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,n,t);case"utf8":case"utf-8":return T(this,n,t);case"ascii":return C(this,n,t);case"latin1":case"binary":return w(this,n,t);case"base64":return D(this,n,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,n,t);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,n,t){const r=e[n];e[n]=e[t],e[t]=r}function E(e,n,t,r,a){if(0===e.length)return-1;if("string"==typeof t?(r=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),Q(t=+t)&&(t=a?0:e.length-1),t<0&&(t=e.length+t),t>=e.length){if(a)return-1;t=e.length-1}else if(t<0){if(!a)return-1;t=0}if("string"==typeof n&&(n=u.from(n,r)),u.isBuffer(n))return 0===n.length?-1:b(e,n,t,r,a);if("number"==typeof n)return n&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,n,t):Uint8Array.prototype.lastIndexOf.call(e,n,t):b(e,[n],t,r,a);throw new TypeError("val must be string, number or Buffer")}function b(e,n,t,r,a){let i,o=1,s=e.length,_=n.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||n.length<2)return-1;o=2,s/=2,_/=2,t/=2}function u(e,n){return 1===o?e[n]:e.readUInt16BE(n*o)}if(a){let r=-1;for(i=t;i<s;i++)if(u(e,i)===u(n,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===_)return r*o}else-1!==r&&(i-=i-r),r=-1}else for(t+_>s&&(t=s-_),i=t;i>=0;i--){let t=!0;for(let r=0;r<_;r++)if(u(e,i+r)!==u(n,r)){t=!1;break}if(t)return i}return-1}function M(e,n,t,r){t=Number(t)||0;const a=e.length-t;r?(r=Number(r))>a&&(r=a):r=a;const i=n.length;let o;for(r>i/2&&(r=i/2),o=0;o<r;++o){const r=parseInt(n.substr(2*o,2),16);if(Q(r))return o;e[t+o]=r}return o}function y(e,n,t,r){return Y(H(n,e.length-t),e,t,r)}function O(e,n,t,r){return Y(function(e){const n=[];for(let t=0;t<e.length;++t)n.push(255&e.charCodeAt(t));return n}(n),e,t,r)}function P(e,n,t,r){return Y(X(n),e,t,r)}function x(e,n,t,r){return Y(function(e,n){let t,r,a;const i=[];for(let o=0;o<e.length&&!((n-=2)<0);++o)t=e.charCodeAt(o),r=t>>8,a=t%256,i.push(a),i.push(r);return i}(n,e.length-t),e,t,r)}function D(e,n,t){return 0===n&&t===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(n,t))}function T(e,n,t){t=Math.min(e.length,t);const r=[];let a=n;for(;a<t;){const n=e[a];let i=null,o=n>239?4:n>223?3:n>191?2:1;if(a+o<=t){let t,r,s,_;switch(o){case 1:n<128&&(i=n);break;case 2:t=e[a+1],128==(192&t)&&(_=(31&n)<<6|63&t,_>127&&(i=_));break;case 3:t=e[a+1],r=e[a+2],128==(192&t)&&128==(192&r)&&(_=(15&n)<<12|(63&t)<<6|63&r,_>2047&&(_<55296||_>57343)&&(i=_));break;case 4:t=e[a+1],r=e[a+2],s=e[a+3],128==(192&t)&&128==(192&r)&&128==(192&s)&&(_=(15&n)<<18|(63&t)<<12|(63&r)<<6|63&s,_>65535&&_<1114112&&(i=_))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),a+=o}return function(e){const n=e.length;if(n<=A)return String.fromCharCode.apply(String,e);let t="",r=0;for(;r<n;)t+=String.fromCharCode.apply(String,e.slice(r,r+=A));return t}(r)}n.kMaxLength=s,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(e,n),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||void 0===r||"function"!=typeof r.error||r.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,n,t){return l(e,n,t)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,n,t){return function(e,n,t){return c(e),e<=0?_(e):void 0!==n?"string"==typeof t?_(e).fill(n,t):_(e).fill(n):_(e)}(e,n,t)},u.allocUnsafe=function(e){return h(e)},u.allocUnsafeSlow=function(e){return h(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,n){if(Z(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),Z(n,Uint8Array)&&(n=u.from(n,n.offset,n.byteLength)),!u.isBuffer(e)||!u.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===n)return 0;let t=e.length,r=n.length;for(let a=0,i=Math.min(t,r);a<i;++a)if(e[a]!==n[a]){t=e[a],r=n[a];break}return t<r?-1:r<t?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,n){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let t;if(void 0===n)for(n=0,t=0;t<e.length;++t)n+=e[t].length;const r=u.allocUnsafe(n);let a=0;for(t=0;t<e.length;++t){let n=e[t];if(Z(n,Uint8Array))a+n.length>r.length?(u.isBuffer(n)||(n=u.from(n)),n.copy(r,a)):Uint8Array.prototype.set.call(r,n,a);else{if(!u.isBuffer(n))throw new TypeError('"list" argument must be an Array of Buffers');n.copy(r,a)}a+=n.length}return r},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)v(this,n,n+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4)v(this,n,n+3),v(this,n+1,n+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8)v(this,n,n+7),v(this,n+1,n+6),v(this,n+2,n+5),v(this,n+3,n+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,n,t,r,a){if(Z(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=0),void 0===t&&(t=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),n<0||t>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&n>=t)return 0;if(r>=a)return-1;if(n>=t)return 1;if(this===e)return 0;let i=(a>>>=0)-(r>>>=0),o=(t>>>=0)-(n>>>=0);const s=Math.min(i,o),_=this.slice(r,a),l=e.slice(n,t);for(let e=0;e<s;++e)if(_[e]!==l[e]){i=_[e],o=l[e];break}return i<o?-1:o<i?1:0},u.prototype.includes=function(e,n,t){return-1!==this.indexOf(e,n,t)},u.prototype.indexOf=function(e,n,t){return E(this,e,n,t,!0)},u.prototype.lastIndexOf=function(e,n,t){return E(this,e,n,t,!1)},u.prototype.write=function(e,n,t,r){if(void 0===n)r="utf8",t=this.length,n=0;else if(void 0===t&&"string"==typeof n)r=n,t=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n>>>=0,isFinite(t)?(t>>>=0,void 0===r&&(r="utf8")):(r=t,t=void 0)}const a=this.length-n;if((void 0===t||t>a)&&(t=a),e.length>0&&(t<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return M(this,e,n,t);case"utf8":case"utf-8":return y(this,e,n,t);case"ascii":case"latin1":case"binary":return O(this,e,n,t);case"base64":return P(this,e,n,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,n,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function C(e,n,t){let r="";t=Math.min(e.length,t);for(let a=n;a<t;++a)r+=String.fromCharCode(127&e[a]);return r}function w(e,n,t){let r="";t=Math.min(e.length,t);for(let a=n;a<t;++a)r+=String.fromCharCode(e[a]);return r}function R(e,n,t){const r=e.length;(!n||n<0)&&(n=0),(!t||t<0||t>r)&&(t=r);let a="";for(let r=n;r<t;++r)a+=$[e[r]];return a}function I(e,n,t){const r=e.slice(n,t);let a="";for(let e=0;e<r.length-1;e+=2)a+=String.fromCharCode(r[e]+256*r[e+1]);return a}function L(e,n,t){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+n>t)throw new RangeError("Trying to access beyond buffer length")}function S(e,n,t,r,a,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>a||n<i)throw new RangeError('"value" argument is out of bounds');if(t+r>e.length)throw new RangeError("Index out of range")}function B(e,n,t,r,a){q(n,r,a,e,t,7);let i=Number(n&BigInt(4294967295));e[t++]=i,i>>=8,e[t++]=i,i>>=8,e[t++]=i,i>>=8,e[t++]=i;let o=Number(n>>BigInt(32)&BigInt(4294967295));return e[t++]=o,o>>=8,e[t++]=o,o>>=8,e[t++]=o,o>>=8,e[t++]=o,t}function U(e,n,t,r,a){q(n,r,a,e,t,7);let i=Number(n&BigInt(4294967295));e[t+7]=i,i>>=8,e[t+6]=i,i>>=8,e[t+5]=i,i>>=8,e[t+4]=i;let o=Number(n>>BigInt(32)&BigInt(4294967295));return e[t+3]=o,o>>=8,e[t+2]=o,o>>=8,e[t+1]=o,o>>=8,e[t]=o,t+8}function k(e,n,t,r,a,i){if(t+r>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function W(e,n,t,r,a){return n=+n,t>>>=0,a||k(e,0,t,4),i.write(e,n,t,r,23,4),t+4}function N(e,n,t,r,a){return n=+n,t>>>=0,a||k(e,0,t,8),i.write(e,n,t,r,52,8),t+8}u.prototype.slice=function(e,n){const t=this.length;(e=~~e)<0?(e+=t)<0&&(e=0):e>t&&(e=t),(n=void 0===n?t:~~n)<0?(n+=t)<0&&(n=0):n>t&&(n=t),n<e&&(n=e);const r=this.subarray(e,n);return Object.setPrototypeOf(r,u.prototype),r},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,n,t){e>>>=0,n>>>=0,t||L(e,n,this.length);let r=this[e],a=1,i=0;for(;++i<n&&(a*=256);)r+=this[e+i]*a;return r},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,n,t){e>>>=0,n>>>=0,t||L(e,n,this.length);let r=this[e+--n],a=1;for(;n>0&&(a*=256);)r+=this[e+--n]*a;return r},u.prototype.readUint8=u.prototype.readUInt8=function(e,n){return e>>>=0,n||L(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,n){return e>>>=0,n||L(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,n){return e>>>=0,n||L(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,n){return e>>>=0,n||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,n){return e>>>=0,n||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=J((function(e){V(e>>>=0,"offset");const n=this[e],t=this[e+7];void 0!==n&&void 0!==t||G(e,this.length-8);const r=n+256*this[++e]+65536*this[++e]+this[++e]*2**24,a=this[++e]+256*this[++e]+65536*this[++e]+t*2**24;return BigInt(r)+(BigInt(a)<<BigInt(32))})),u.prototype.readBigUInt64BE=J((function(e){V(e>>>=0,"offset");const n=this[e],t=this[e+7];void 0!==n&&void 0!==t||G(e,this.length-8);const r=n*2**24+65536*this[++e]+256*this[++e]+this[++e],a=this[++e]*2**24+65536*this[++e]+256*this[++e]+t;return(BigInt(r)<<BigInt(32))+BigInt(a)})),u.prototype.readIntLE=function(e,n,t){e>>>=0,n>>>=0,t||L(e,n,this.length);let r=this[e],a=1,i=0;for(;++i<n&&(a*=256);)r+=this[e+i]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*n)),r},u.prototype.readIntBE=function(e,n,t){e>>>=0,n>>>=0,t||L(e,n,this.length);let r=n,a=1,i=this[e+--r];for(;r>0&&(a*=256);)i+=this[e+--r]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*n)),i},u.prototype.readInt8=function(e,n){return e>>>=0,n||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,n){e>>>=0,n||L(e,2,this.length);const t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},u.prototype.readInt16BE=function(e,n){e>>>=0,n||L(e,2,this.length);const t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},u.prototype.readInt32LE=function(e,n){return e>>>=0,n||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,n){return e>>>=0,n||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=J((function(e){V(e>>>=0,"offset");const n=this[e],t=this[e+7];void 0!==n&&void 0!==t||G(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(t<<24);return(BigInt(r)<<BigInt(32))+BigInt(n+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=J((function(e){V(e>>>=0,"offset");const n=this[e],t=this[e+7];void 0!==n&&void 0!==t||G(e,this.length-8);const r=(n<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+t)})),u.prototype.readFloatLE=function(e,n){return e>>>=0,n||L(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,n){return e>>>=0,n||L(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,n){return e>>>=0,n||L(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,n){return e>>>=0,n||L(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,n,t,r){if(e=+e,n>>>=0,t>>>=0,!r){S(this,e,n,t,Math.pow(2,8*t)-1,0)}let a=1,i=0;for(this[n]=255&e;++i<t&&(a*=256);)this[n+i]=e/a&255;return n+t},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,n,t,r){if(e=+e,n>>>=0,t>>>=0,!r){S(this,e,n,t,Math.pow(2,8*t)-1,0)}let a=t-1,i=1;for(this[n+a]=255&e;--a>=0&&(i*=256);)this[n+a]=e/i&255;return n+t},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,1,255,0),this[n]=255&e,n+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,2,65535,0),this[n]=255&e,this[n+1]=e>>>8,n+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,2,65535,0),this[n]=e>>>8,this[n+1]=255&e,n+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,4,4294967295,0),this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=255&e,n+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,4,4294967295,0),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=255&e,n+4},u.prototype.writeBigUInt64LE=J((function(e,n=0){return B(this,e,n,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=J((function(e,n=0){return U(this,e,n,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,n,t,r){if(e=+e,n>>>=0,!r){const r=Math.pow(2,8*t-1);S(this,e,n,t,r-1,-r)}let a=0,i=1,o=0;for(this[n]=255&e;++a<t&&(i*=256);)e<0&&0===o&&0!==this[n+a-1]&&(o=1),this[n+a]=(e/i>>0)-o&255;return n+t},u.prototype.writeIntBE=function(e,n,t,r){if(e=+e,n>>>=0,!r){const r=Math.pow(2,8*t-1);S(this,e,n,t,r-1,-r)}let a=t-1,i=1,o=0;for(this[n+a]=255&e;--a>=0&&(i*=256);)e<0&&0===o&&0!==this[n+a+1]&&(o=1),this[n+a]=(e/i>>0)-o&255;return n+t},u.prototype.writeInt8=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,1,127,-128),e<0&&(e=255+e+1),this[n]=255&e,n+1},u.prototype.writeInt16LE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,2,32767,-32768),this[n]=255&e,this[n+1]=e>>>8,n+2},u.prototype.writeInt16BE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,2,32767,-32768),this[n]=e>>>8,this[n+1]=255&e,n+2},u.prototype.writeInt32LE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,4,2147483647,-2147483648),this[n]=255&e,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24,n+4},u.prototype.writeInt32BE=function(e,n,t){return e=+e,n>>>=0,t||S(this,e,n,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=255&e,n+4},u.prototype.writeBigInt64LE=J((function(e,n=0){return B(this,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=J((function(e,n=0){return U(this,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,n,t){return W(this,e,n,!0,t)},u.prototype.writeFloatBE=function(e,n,t){return W(this,e,n,!1,t)},u.prototype.writeDoubleLE=function(e,n,t){return N(this,e,n,!0,t)},u.prototype.writeDoubleBE=function(e,n,t){return N(this,e,n,!1,t)},u.prototype.copy=function(e,n,t,r){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(t||(t=0),r||0===r||(r=this.length),n>=e.length&&(n=e.length),n||(n=0),r>0&&r<t&&(r=t),r===t)return 0;if(0===e.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-n<r-t&&(r=e.length-n+t);const a=r-t;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(n,t,r):Uint8Array.prototype.set.call(e,this.subarray(t,r),n),a},u.prototype.fill=function(e,n,t,r){if("string"==typeof e){if("string"==typeof n?(r=n,n=0,t=this.length):"string"==typeof t&&(r=t,t=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const n=e.charCodeAt(0);("utf8"===r&&n<128||"latin1"===r)&&(e=n)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(n<0||this.length<n||this.length<t)throw new RangeError("Out of range index");if(t<=n)return this;let a;if(n>>>=0,t=void 0===t?this.length:t>>>0,e||(e=0),"number"==typeof e)for(a=n;a<t;++a)this[a]=e;else{const i=u.isBuffer(e)?e:u.from(e,r),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<t-n;++a)this[a+n]=i[a%o]}return this};const K={};function F(e,n,t){K[e]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:n.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let n="",t=e.length;const r="-"===e[0]?1:0;for(;t>=r+4;t-=3)n=`_${e.slice(t-3,t)}${n}`;return`${e.slice(0,t)}${n}`}function q(e,n,t,r,a,i){if(e>t||e<n){const r="bigint"==typeof n?"n":"";let a;throw a=i>3?0===n||n===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${n}${r} and <= ${t}${r}`,new K.ERR_OUT_OF_RANGE("value",a,e)}!function(e,n,t){V(n,"offset"),void 0!==e[n]&&void 0!==e[n+t]||G(n,e.length-(t+1))}(r,a,i)}function V(e,n){if("number"!=typeof e)throw new K.ERR_INVALID_ARG_TYPE(n,"number",e)}function G(e,n,t){if(Math.floor(e)!==e)throw V(e,t),new K.ERR_OUT_OF_RANGE(t||"offset","an integer",e);if(n<0)throw new K.ERR_BUFFER_OUT_OF_BOUNDS;throw new K.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${n}`,e)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(e,n){return`The "${e}" argument must be of type number. Received type ${typeof n}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(e,n,t){let r=`The value of "${e}" is out of range.`,a=t;return Number.isInteger(t)&&Math.abs(t)>2**32?a=j(String(t)):"bigint"==typeof t&&(a=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(a=j(a)),a+="n"),r+=` It must be ${n}. Received ${a}`,r}),RangeError);const z=/[^+/0-9A-Za-z-_]/g;function H(e,n){let t;n=n||1/0;const r=e.length;let a=null;const i=[];for(let o=0;o<r;++o){if(t=e.charCodeAt(o),t>55295&&t<57344){if(!a){if(t>56319){(n-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(n-=3)>-1&&i.push(239,191,189);continue}a=t;continue}if(t<56320){(n-=3)>-1&&i.push(239,191,189),a=t;continue}t=65536+(a-55296<<10|t-56320)}else a&&(n-=3)>-1&&i.push(239,191,189);if(a=null,t<128){if((n-=1)<0)break;i.push(t)}else if(t<2048){if((n-=2)<0)break;i.push(t>>6|192,63&t|128)}else if(t<65536){if((n-=3)<0)break;i.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return i}function X(e){return a.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,n,t,r){let a;for(a=0;a<r&&!(a+t>=n.length||a>=e.length);++a)n[a+t]=e[a];return a}function Z(e,n){return e instanceof n||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===n.name}function Q(e){return e!=e}const $=function(){const e="0123456789abcdef",n=new Array(256);for(let t=0;t<16;++t){const r=16*t;for(let a=0;a<16;++a)n[r+a]=e[t]+e[a]}return n}();function J(e){return"undefined"==typeof BigInt?ee:e}function ee(){throw new Error("BigInt not supported")}},1924:(e,n,t)=>{"use strict";var r=t(210),a=t(5559),i=a(r("String.prototype.indexOf"));e.exports=function(e,n){var t=r(e,!!n);return"function"==typeof t&&i(e,".prototype.")>-1?a(t):t}},5559:(e,n,t)=>{"use strict";var r=t(8612),a=t(210),i=a("%Function.prototype.apply%"),o=a("%Function.prototype.call%"),s=a("%Reflect.apply%",!0)||r.call(o,i),_=a("%Object.getOwnPropertyDescriptor%",!0),u=a("%Object.defineProperty%",!0),l=a("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var n=s(r,o,arguments);_&&u&&(_(n,"length").configurable&&u(n,"length",{value:1+l(0,e.length-(arguments.length-1))}));return n};var c=function(){return s(r,i,arguments)};u?u(e.exports,"apply",{value:c}):e.exports.apply=c},5108:(e,n,t)=>{var r=t(9539),a=t(9282);function i(){return(new Date).getTime()}var o,s=Array.prototype.slice,_={};o=void 0!==t.g&&t.g.console?t.g.console:"undefined"!=typeof window&&window.console?window.console:{};for(var u=[[function(){},"log"],[function(){o.log.apply(o,arguments)},"info"],[function(){o.log.apply(o,arguments)},"warn"],[function(){o.warn.apply(o,arguments)},"error"],[function(e){_[e]=i()},"time"],[function(e){var n=_[e];if(!n)throw new Error("No such label: "+e);delete _[e];var t=i()-n;o.log(e+": "+t+"ms")},"timeEnd"],[function(){var e=new Error;e.name="Trace",e.message=r.format.apply(null,arguments),o.error(e.stack)},"trace"],[function(e){o.log(r.inspect(e)+"\n")},"dir"],[function(e){if(!e){var n=s.call(arguments,1);a.ok(!1,r.format.apply(null,n))}},"assert"]],l=0;l<u.length;l++){var c=u[l],h=c[0],d=c[1];o[d]||(o[d]=h)}e.exports=o},2296:(e,n,t)=>{"use strict";var r=t(1044)(),a=t(210),i=r&&a("%Object.defineProperty%",!0),o=a("%SyntaxError%"),s=a("%TypeError%"),_=t(7296);e.exports=function(e,n,t){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new s("`obj` must be an object or a function`");if("string"!=typeof n&&"symbol"!=typeof n)throw new s("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new s("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new s("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new s("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new s("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,a=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,l=arguments.length>6&&arguments[6],c=!!_&&_(e,n);if(i)i(e,n,{configurable:null===u&&c?c.configurable:!u,enumerable:null===r&&c?c.enumerable:!r,value:t,writable:null===a&&c?c.writable:!a});else{if(!l&&(r||a||u))throw new o("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[n]=t}}},4289:(e,n,t)=>{"use strict";var r=t(2215),a="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,o=Array.prototype.concat,s=t(2296),_=t(1044)(),u=function(e,n,t,r){if(n in e)if(!0===r){if(e[n]===t)return}else if("function"!=typeof(a=r)||"[object Function]"!==i.call(a)||!r())return;var a;_?s(e,n,t,!0):s(e,n,t)},l=function(e,n){var t=arguments.length>2?arguments[2]:{},i=r(n);a&&(i=o.call(i,Object.getOwnPropertySymbols(n)));for(var s=0;s<i.length;s+=1)u(e,i[s],n[i[s]],t[i[s]])};l.supportsDescriptors=!!_,e.exports=l},7187:(e,n,t)=>{"use strict";var r,a=t(5108),i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,n,t){return Function.prototype.apply.call(e,n,t)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function _(){_.init.call(this)}e.exports=_,e.exports.once=function(e,n){return new Promise((function(t,r){function a(t){e.removeListener(n,i),r(t)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",a),t([].slice.call(arguments))}v(e,n,i,{once:!0}),"error"!==n&&function(e,n,t){"function"==typeof e.on&&v(e,"error",n,t)}(e,a,{once:!0})}))},_.EventEmitter=_,_.prototype._events=void 0,_.prototype._eventsCount=0,_.prototype._maxListeners=void 0;var u=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?_.defaultMaxListeners:e._maxListeners}function h(e,n,t,r){var i,o,s,_;if(l(t),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",n,t.listener?t.listener:t),o=e._events),s=o[n]),void 0===s)s=o[n]=t,++e._eventsCount;else if("function"==typeof s?s=o[n]=r?[t,s]:[s,t]:r?s.unshift(t):s.push(t),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=n,u.count=s.length,_=u,a&&a.warn&&a.warn(_)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,n,t){var r={fired:!1,wrapFn:void 0,target:e,type:n,listener:t},a=d.bind(r);return a.listener=t,r.wrapFn=a,a}function p(e,n,t){var r=e._events;if(void 0===r)return[];var a=r[n];return void 0===a?[]:"function"==typeof a?t?[a.listener||a]:[a]:t?function(e){for(var n=new Array(e.length),t=0;t<n.length;++t)n[t]=e[t].listener||e[t];return n}(a):g(a,a.length)}function m(e){var n=this._events;if(void 0!==n){var t=n[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function g(e,n){for(var t=new Array(n),r=0;r<n;++r)t[r]=e[r];return t}function v(e,n,t,r){if("function"==typeof e.on)r.once?e.once(n,t):e.on(n,t);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(n,(function a(i){r.once&&e.removeEventListener(n,a),t(i)}))}}Object.defineProperty(_,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),_.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},_.prototype.getMaxListeners=function(){return c(this)},_.prototype.emit=function(e){for(var n=[],t=1;t<arguments.length;t++)n.push(arguments[t]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var i;if(n.length>0&&(i=n[0]),i instanceof Error)throw i;var s=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw s.context=i,s}var _=a[e];if(void 0===_)return!1;if("function"==typeof _)o(_,this,n);else{var u=_.length,l=g(_,u);for(t=0;t<u;++t)o(l[t],this,n)}return!0},_.prototype.addListener=function(e,n){return h(this,e,n,!1)},_.prototype.on=_.prototype.addListener,_.prototype.prependListener=function(e,n){return h(this,e,n,!0)},_.prototype.once=function(e,n){return l(n),this.on(e,f(this,e,n)),this},_.prototype.prependOnceListener=function(e,n){return l(n),this.prependListener(e,f(this,e,n)),this},_.prototype.removeListener=function(e,n){var t,r,a,i,o;if(l(n),void 0===(r=this._events))return this;if(void 0===(t=r[e]))return this;if(t===n||t.listener===n)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,t.listener||n));else if("function"!=typeof t){for(a=-1,i=t.length-1;i>=0;i--)if(t[i]===n||t[i].listener===n){o=t[i].listener,a=i;break}if(a<0)return this;0===a?t.shift():function(e,n){for(;n+1<e.length;n++)e[n]=e[n+1];e.pop()}(t,a),1===t.length&&(r[e]=t[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||n)}return this},_.prototype.off=_.prototype.removeListener,_.prototype.removeAllListeners=function(e){var n,t,r;if(void 0===(t=this._events))return this;if(void 0===t.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==t[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete t[e]),this;if(0===arguments.length){var a,i=Object.keys(t);for(r=0;r<i.length;++r)"removeListener"!==(a=i[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(n=t[e]))this.removeListener(e,n);else if(void 0!==n)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this},_.prototype.listeners=function(e){return p(this,e,!0)},_.prototype.rawListeners=function(e){return p(this,e,!1)},_.listenerCount=function(e,n){return"function"==typeof e.listenerCount?e.listenerCount(n):m.call(e,n)},_.prototype.listenerCount=m,_.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},4029:(e,n,t)=>{"use strict";var r=t(5320),a=Object.prototype.toString,i=Object.prototype.hasOwnProperty;e.exports=function(e,n,t){if(!r(n))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=t),"[object Array]"===a.call(e)?function(e,n,t){for(var r=0,a=e.length;r<a;r++)i.call(e,r)&&(null==t?n(e[r],r,e):n.call(t,e[r],r,e))}(e,n,o):"string"==typeof e?function(e,n,t){for(var r=0,a=e.length;r<a;r++)null==t?n(e.charAt(r),r,e):n.call(t,e.charAt(r),r,e)}(e,n,o):function(e,n,t){for(var r in e)i.call(e,r)&&(null==t?n(e[r],r,e):n.call(t,e[r],r,e))}(e,n,o)}},7648:e=>{"use strict";var n=Array.prototype.slice,t=Object.prototype.toString;e.exports=function(e){var r=this;if("function"!=typeof r||"[object Function]"!==t.call(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var a,i=n.call(arguments,1),o=Math.max(0,r.length-i.length),s=[],_=0;_<o;_++)s.push("$"+_);if(a=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof a){var t=r.apply(this,i.concat(n.call(arguments)));return Object(t)===t?t:this}return r.apply(e,i.concat(n.call(arguments)))})),r.prototype){var u=function(){};u.prototype=r.prototype,a.prototype=new u,u.prototype=null}return a}},8612:(e,n,t)=>{"use strict";var r=t(7648);e.exports=Function.prototype.bind||r},210:(e,n,t)=>{"use strict";var r,a=SyntaxError,i=Function,o=TypeError,s=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},_=Object.getOwnPropertyDescriptor;if(_)try{_({},"")}catch(e){_=null}var u=function(){throw new o},l=_?function(){try{return u}catch(e){try{return _(arguments,"callee").get}catch(e){return u}}}():u,c=t(1405)(),h=t(8185)(),d=Object.getPrototypeOf||(h?function(e){return e.__proto__}:null),f={},p="undefined"!=typeof Uint8Array&&d?d(Uint8Array):r,m={"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":c&&d?d([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c&&d?d(d([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&c&&d?d((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&c&&d?d((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c&&d?d(""[Symbol.iterator]()):r,"%Symbol%":c?Symbol:r,"%SyntaxError%":a,"%ThrowTypeError%":l,"%TypedArray%":p,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(d)try{null.error}catch(e){var g=d(d(e));m["%Error.prototype%"]=g}var v=function e(n){var t;if("%AsyncFunction%"===n)t=s("async function () {}");else if("%GeneratorFunction%"===n)t=s("function* () {}");else if("%AsyncGeneratorFunction%"===n)t=s("async function* () {}");else if("%AsyncGenerator%"===n){var r=e("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if("%AsyncIteratorPrototype%"===n){var a=e("%AsyncGenerator%");a&&d&&(t=d(a.prototype))}return m[n]=t,t},E={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=t(8612),M=t(7642),y=b.call(Function.call,Array.prototype.concat),O=b.call(Function.apply,Array.prototype.splice),P=b.call(Function.call,String.prototype.replace),x=b.call(Function.call,String.prototype.slice),D=b.call(Function.call,RegExp.prototype.exec),T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,A=/\\(\\)?/g,C=function(e,n){var t,r=e;if(M(E,r)&&(r="%"+(t=E[r])[0]+"%"),M(m,r)){var i=m[r];if(i===f&&(i=v(r)),void 0===i&&!n)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:t,name:r,value:i}}throw new a("intrinsic "+e+" does not exist!")};e.exports=function(e,n){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof n)throw new o('"allowMissing" argument must be a boolean');if(null===D(/^%?[^%]*%?$/,e))throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var t=function(e){var n=x(e,0,1),t=x(e,-1);if("%"===n&&"%"!==t)throw new a("invalid intrinsic syntax, expected closing `%`");if("%"===t&&"%"!==n)throw new a("invalid intrinsic syntax, expected opening `%`");var r=[];return P(e,T,(function(e,n,t,a){r[r.length]=t?P(a,A,"$1"):n||e})),r}(e),r=t.length>0?t[0]:"",i=C("%"+r+"%",n),s=i.name,u=i.value,l=!1,c=i.alias;c&&(r=c[0],O(t,y([0,1],c)));for(var h=1,d=!0;h<t.length;h+=1){var f=t[h],p=x(f,0,1),g=x(f,-1);if(('"'===p||"'"===p||"`"===p||'"'===g||"'"===g||"`"===g)&&p!==g)throw new a("property names with quotes must have matching quotes");if("constructor"!==f&&d||(l=!0),M(m,s="%"+(r+="."+f)+"%"))u=m[s];else if(null!=u){if(!(f in u)){if(!n)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(_&&h+1>=t.length){var v=_(u,f);u=(d=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:u[f]}else d=M(u,f),u=u[f];d&&!l&&(m[s]=u)}}return u}},7296:(e,n,t)=>{"use strict";var r=t(210)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},840:(e,n,t)=>{var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(a,i,o,s){"use strict";var _,u=["","webkit","Moz","MS","ms","o"],l=i.createElement("div"),c="function",h=Math.round,d=Math.abs,f=Date.now;function p(e,n,t){return setTimeout(y(e,t),n)}function m(e,n,t){return!!Array.isArray(e)&&(g(e,t[n],t),!0)}function g(e,n,t){var r;if(e)if(e.forEach)e.forEach(n,t);else if(e.length!==s)for(r=0;r<e.length;)n.call(t,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&n.call(t,e[r],r,e)}function v(e,n,t){var r="DEPRECATED METHOD: "+n+"\n"+t+" AT \n";return function(){var n=new Error("get-stack-trace"),t=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=a.console&&(a.console.warn||a.console.log);return i&&i.call(a.console,r,t),e.apply(this,arguments)}}_="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),t=1;t<arguments.length;t++){var r=arguments[t];if(r!==s&&null!==r)for(var a in r)r.hasOwnProperty(a)&&(n[a]=r[a])}return n}:Object.assign;var E=v((function(e,n,t){for(var r=Object.keys(n),a=0;a<r.length;)(!t||t&&e[r[a]]===s)&&(e[r[a]]=n[r[a]]),a++;return e}),"extend","Use `assign`."),b=v((function(e,n){return E(e,n,!0)}),"merge","Use `assign`.");function M(e,n,t){var r,a=n.prototype;(r=e.prototype=Object.create(a)).constructor=e,r._super=a,t&&_(r,t)}function y(e,n){return function(){return e.apply(n,arguments)}}function O(e,n){return typeof e==c?e.apply(n&&n[0]||s,n):e}function P(e,n){return e===s?n:e}function x(e,n,t){g(C(n),(function(n){e.addEventListener(n,t,!1)}))}function D(e,n,t){g(C(n),(function(n){e.removeEventListener(n,t,!1)}))}function T(e,n){for(;e;){if(e==n)return!0;e=e.parentNode}return!1}function A(e,n){return e.indexOf(n)>-1}function C(e){return e.trim().split(/\s+/g)}function w(e,n,t){if(e.indexOf&&!t)return e.indexOf(n);for(var r=0;r<e.length;){if(t&&e[r][t]==n||!t&&e[r]===n)return r;r++}return-1}function R(e){return Array.prototype.slice.call(e,0)}function I(e,n,t){for(var r=[],a=[],i=0;i<e.length;){var o=n?e[i][n]:e[i];w(a,o)<0&&r.push(e[i]),a[i]=o,i++}return t&&(r=n?r.sort((function(e,t){return e[n]>t[n]})):r.sort()),r}function L(e,n){for(var t,r,a=n[0].toUpperCase()+n.slice(1),i=0;i<u.length;){if((r=(t=u[i])?t+a:n)in e)return r;i++}return s}var S=1;function B(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||a}var U="ontouchstart"in a,k=L(a,"PointerEvent")!==s,W=U&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",K="mouse",F=25,j=1,q=4,V=8,G=1,z=2,H=4,X=8,Y=16,Z=z|H,Q=X|Y,$=Z|Q,J=["x","y"],ee=["clientX","clientY"];function ne(e,n){var t=this;this.manager=e,this.callback=n,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(n){O(e.options.enable,[e])&&t.handler(n)},this.init()}function te(e,n,t){var r=t.pointers.length,a=t.changedPointers.length,i=n&j&&r-a==0,o=n&(q|V)&&r-a==0;t.isFirst=!!i,t.isFinal=!!o,i&&(e.session={}),t.eventType=n,function(e,n){var t=e.session,r=n.pointers,a=r.length;t.firstInput||(t.firstInput=re(n));a>1&&!t.firstMultiple?t.firstMultiple=re(n):1===a&&(t.firstMultiple=!1);var i=t.firstInput,o=t.firstMultiple,_=o?o.center:i.center,u=n.center=ae(r);n.timeStamp=f(),n.deltaTime=n.timeStamp-i.timeStamp,n.angle=_e(_,u),n.distance=se(_,u),function(e,n){var t=n.center,r=e.offsetDelta||{},a=e.prevDelta||{},i=e.prevInput||{};n.eventType!==j&&i.eventType!==q||(a=e.prevDelta={x:i.deltaX||0,y:i.deltaY||0},r=e.offsetDelta={x:t.x,y:t.y});n.deltaX=a.x+(t.x-r.x),n.deltaY=a.y+(t.y-r.y)}(t,n),n.offsetDirection=oe(n.deltaX,n.deltaY);var l=ie(n.deltaTime,n.deltaX,n.deltaY);n.overallVelocityX=l.x,n.overallVelocityY=l.y,n.overallVelocity=d(l.x)>d(l.y)?l.x:l.y,n.scale=o?(c=o.pointers,h=r,se(h[0],h[1],ee)/se(c[0],c[1],ee)):1,n.rotation=o?function(e,n){return _e(n[1],n[0],ee)+_e(e[1],e[0],ee)}(o.pointers,r):0,n.maxPointers=t.prevInput?n.pointers.length>t.prevInput.maxPointers?n.pointers.length:t.prevInput.maxPointers:n.pointers.length,function(e,n){var t,r,a,i,o=e.lastInterval||n,_=n.timeStamp-o.timeStamp;if(n.eventType!=V&&(_>F||o.velocity===s)){var u=n.deltaX-o.deltaX,l=n.deltaY-o.deltaY,c=ie(_,u,l);r=c.x,a=c.y,t=d(c.x)>d(c.y)?c.x:c.y,i=oe(u,l),e.lastInterval=n}else t=o.velocity,r=o.velocityX,a=o.velocityY,i=o.direction;n.velocity=t,n.velocityX=r,n.velocityY=a,n.direction=i}(t,n);var c,h;var p=e.element;T(n.srcEvent.target,p)&&(p=n.srcEvent.target);n.target=p}(e,t),e.emit("hammer.input",t),e.recognize(t),e.session.prevInput=t}function re(e){for(var n=[],t=0;t<e.pointers.length;)n[t]={clientX:h(e.pointers[t].clientX),clientY:h(e.pointers[t].clientY)},t++;return{timeStamp:f(),pointers:n,center:ae(n),deltaX:e.deltaX,deltaY:e.deltaY}}function ae(e){var n=e.length;if(1===n)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var t=0,r=0,a=0;a<n;)t+=e[a].clientX,r+=e[a].clientY,a++;return{x:h(t/n),y:h(r/n)}}function ie(e,n,t){return{x:n/e||0,y:t/e||0}}function oe(e,n){return e===n?G:d(e)>=d(n)?e<0?z:H:n<0?X:Y}function se(e,n,t){t||(t=J);var r=n[t[0]]-e[t[0]],a=n[t[1]]-e[t[1]];return Math.sqrt(r*r+a*a)}function _e(e,n,t){t||(t=J);var r=n[t[0]]-e[t[0]],a=n[t[1]]-e[t[1]];return 180*Math.atan2(a,r)/Math.PI}ne.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(B(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(B(this.element),this.evWin,this.domHandler)}};var ue={mousedown:j,mousemove:2,mouseup:q},le="mousedown",ce="mousemove mouseup";function he(){this.evEl=le,this.evWin=ce,this.pressed=!1,ne.apply(this,arguments)}M(he,ne,{handler:function(e){var n=ue[e.type];n&j&&0===e.button&&(this.pressed=!0),2&n&&1!==e.which&&(n=q),this.pressed&&(n&q&&(this.pressed=!1),this.callback(this.manager,n,{pointers:[e],changedPointers:[e],pointerType:K,srcEvent:e}))}});var de={pointerdown:j,pointermove:2,pointerup:q,pointercancel:V,pointerout:V},fe={2:N,3:"pen",4:K,5:"kinect"},pe="pointerdown",me="pointermove pointerup pointercancel";function ge(){this.evEl=pe,this.evWin=me,ne.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}a.MSPointerEvent&&!a.PointerEvent&&(pe="MSPointerDown",me="MSPointerMove MSPointerUp MSPointerCancel"),M(ge,ne,{handler:function(e){var n=this.store,t=!1,r=e.type.toLowerCase().replace("ms",""),a=de[r],i=fe[e.pointerType]||e.pointerType,o=i==N,s=w(n,e.pointerId,"pointerId");a&j&&(0===e.button||o)?s<0&&(n.push(e),s=n.length-1):a&(q|V)&&(t=!0),s<0||(n[s]=e,this.callback(this.manager,a,{pointers:n,changedPointers:[e],pointerType:i,srcEvent:e}),t&&n.splice(s,1))}});var ve={touchstart:j,touchmove:2,touchend:q,touchcancel:V};function Ee(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,ne.apply(this,arguments)}function be(e,n){var t=R(e.touches),r=R(e.changedTouches);return n&(q|V)&&(t=I(t.concat(r),"identifier",!0)),[t,r]}M(Ee,ne,{handler:function(e){var n=ve[e.type];if(n===j&&(this.started=!0),this.started){var t=be.call(this,e,n);n&(q|V)&&t[0].length-t[1].length==0&&(this.started=!1),this.callback(this.manager,n,{pointers:t[0],changedPointers:t[1],pointerType:N,srcEvent:e})}}});var Me={touchstart:j,touchmove:2,touchend:q,touchcancel:V},ye="touchstart touchmove touchend touchcancel";function Oe(){this.evTarget=ye,this.targetIds={},ne.apply(this,arguments)}function Pe(e,n){var t=R(e.touches),r=this.targetIds;if(n&(2|j)&&1===t.length)return r[t[0].identifier]=!0,[t,t];var a,i,o=R(e.changedTouches),s=[],_=this.target;if(i=t.filter((function(e){return T(e.target,_)})),n===j)for(a=0;a<i.length;)r[i[a].identifier]=!0,a++;for(a=0;a<o.length;)r[o[a].identifier]&&s.push(o[a]),n&(q|V)&&delete r[o[a].identifier],a++;return s.length?[I(i.concat(s),"identifier",!0),s]:void 0}M(Oe,ne,{handler:function(e){var n=Me[e.type],t=Pe.call(this,e,n);t&&this.callback(this.manager,n,{pointers:t[0],changedPointers:t[1],pointerType:N,srcEvent:e})}});var xe=2500;function De(){ne.apply(this,arguments);var e=y(this.handler,this);this.touch=new Oe(this.manager,e),this.mouse=new he(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Te(e,n){e&j?(this.primaryTouch=n.changedPointers[0].identifier,Ae.call(this,n)):e&(q|V)&&Ae.call(this,n)}function Ae(e){var n=e.changedPointers[0];if(n.identifier===this.primaryTouch){var t={x:n.clientX,y:n.clientY};this.lastTouches.push(t);var r=this.lastTouches;setTimeout((function(){var e=r.indexOf(t);e>-1&&r.splice(e,1)}),xe)}}function Ce(e){for(var n=e.srcEvent.clientX,t=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var a=this.lastTouches[r],i=Math.abs(n-a.x),o=Math.abs(t-a.y);if(i<=25&&o<=25)return!0}return!1}M(De,ne,{handler:function(e,n,t){var r=t.pointerType==N,a=t.pointerType==K;if(!(a&&t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents)){if(r)Te.call(this,n,t);else if(a&&Ce.call(this,t))return;this.callback(e,n,t)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var we=L(l.style,"touchAction"),Re=we!==s,Ie="compute",Le="auto",Se="manipulation",Be="none",Ue="pan-x",ke="pan-y",We=function(){if(!Re)return!1;var e={},n=a.CSS&&a.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(t){e[t]=!n||a.CSS.supports("touch-action",t)})),e}();function Ne(e,n){this.manager=e,this.set(n)}Ne.prototype={set:function(e){e==Ie&&(e=this.compute()),Re&&this.manager.element.style&&We[e]&&(this.manager.element.style[we]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return g(this.manager.recognizers,(function(n){O(n.options.enable,[n])&&(e=e.concat(n.getTouchAction()))})),function(e){if(A(e,Be))return Be;var n=A(e,Ue),t=A(e,ke);if(n&&t)return Be;if(n||t)return n?Ue:ke;if(A(e,Se))return Se;return Le}(e.join(" "))},preventDefaults:function(e){var n=e.srcEvent,t=e.offsetDirection;if(this.manager.session.prevented)n.preventDefault();else{var r=this.actions,a=A(r,Be)&&!We[Be],i=A(r,ke)&&!We[ke],o=A(r,Ue)&&!We[Ue];if(a){var s=1===e.pointers.length,_=e.distance<2,u=e.deltaTime<250;if(s&&_&&u)return}if(!o||!i)return a||i&&t&Z||o&&t&Q?this.preventSrc(n):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ke=1,Fe=32;function je(e){this.options=_({},this.defaults,e||{}),this.id=S++,this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=Ke,this.simultaneous={},this.requireFail=[]}function qe(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Ve(e){return e==Y?"down":e==X?"up":e==z?"left":e==H?"right":""}function Ge(e,n){var t=n.manager;return t?t.get(e):e}function ze(){je.apply(this,arguments)}function He(){ze.apply(this,arguments),this.pX=null,this.pY=null}function Xe(){ze.apply(this,arguments)}function Ye(){je.apply(this,arguments),this._timer=null,this._input=null}function Ze(){ze.apply(this,arguments)}function Qe(){ze.apply(this,arguments)}function $e(){je.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Je(e,n){return(n=n||{}).recognizers=P(n.recognizers,Je.defaults.preset),new en(e,n)}je.prototype={defaults:{},set:function(e){return _(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(m(e,"recognizeWith",this))return this;var n=this.simultaneous;return n[(e=Ge(e,this)).id]||(n[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return m(e,"dropRecognizeWith",this)||(e=Ge(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(m(e,"requireFailure",this))return this;var n=this.requireFail;return-1===w(n,e=Ge(e,this))&&(n.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(m(e,"dropRequireFailure",this))return this;e=Ge(e,this);var n=w(this.requireFail,e);return n>-1&&this.requireFail.splice(n,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var n=this,t=this.state;function r(t){n.manager.emit(t,e)}t<8&&r(n.options.event+qe(t)),r(n.options.event),e.additionalEvent&&r(e.additionalEvent),t>=8&&r(n.options.event+qe(t))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Fe},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Fe|Ke)))return!1;e++}return!0},recognize:function(e){var n=_({},e);if(!O(this.options.enable,[this,n]))return this.reset(),void(this.state=Fe);56&this.state&&(this.state=Ke),this.state=this.process(n),30&this.state&&this.tryEmit(n)},process:function(e){},getTouchAction:function(){},reset:function(){}},M(ze,je,{defaults:{pointers:1},attrTest:function(e){var n=this.options.pointers;return 0===n||e.pointers.length===n},process:function(e){var n=this.state,t=e.eventType,r=6&n,a=this.attrTest(e);return r&&(t&V||!a)?16|n:r||a?t&q?8|n:2&n?4|n:2:Fe}}),M(He,ze,{defaults:{event:"pan",threshold:10,pointers:1,direction:$},getTouchAction:function(){var e=this.options.direction,n=[];return e&Z&&n.push(ke),e&Q&&n.push(Ue),n},directionTest:function(e){var n=this.options,t=!0,r=e.distance,a=e.direction,i=e.deltaX,o=e.deltaY;return a&n.direction||(n.direction&Z?(a=0===i?G:i<0?z:H,t=i!=this.pX,r=Math.abs(e.deltaX)):(a=0===o?G:o<0?X:Y,t=o!=this.pY,r=Math.abs(e.deltaY))),e.direction=a,t&&r>n.threshold&&a&n.direction},attrTest:function(e){return ze.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var n=Ve(e.direction);n&&(e.additionalEvent=this.options.event+n),this._super.emit.call(this,e)}}),M(Xe,ze,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Be]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var n=e.scale<1?"in":"out";e.additionalEvent=this.options.event+n}this._super.emit.call(this,e)}}),M(Ye,je,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Le]},process:function(e){var n=this.options,t=e.pointers.length===n.pointers,r=e.distance<n.threshold,a=e.deltaTime>n.time;if(this._input=e,!r||!t||e.eventType&(q|V)&&!a)this.reset();else if(e.eventType&j)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),n.time,this);else if(e.eventType&q)return 8;return Fe},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&e.eventType&q?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),M(Ze,ze,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Be]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),M(Qe,ze,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|Q,pointers:1},getTouchAction:function(){return He.prototype.getTouchAction.call(this)},attrTest:function(e){var n,t=this.options.direction;return t&(Z|Q)?n=e.overallVelocity:t&Z?n=e.overallVelocityX:t&Q&&(n=e.overallVelocityY),this._super.attrTest.call(this,e)&&t&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(n)>this.options.velocity&&e.eventType&q},emit:function(e){var n=Ve(e.offsetDirection);n&&this.manager.emit(this.options.event+n,e),this.manager.emit(this.options.event,e)}}),M($e,je,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Se]},process:function(e){var n=this.options,t=e.pointers.length===n.pointers,r=e.distance<n.threshold,a=e.deltaTime<n.time;if(this.reset(),e.eventType&j&&0===this.count)return this.failTimeout();if(r&&a&&t){if(e.eventType!=q)return this.failTimeout();var i=!this.pTime||e.timeStamp-this.pTime<n.interval,o=!this.pCenter||se(this.pCenter,e.center)<n.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&i?this.count+=1:this.count=1,this._input=e,0===this.count%n.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),n.interval,this),2):8}return Fe},failTimeout:function(){return this._timer=p((function(){this.state=Fe}),this.options.interval,this),Fe},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Je.VERSION="2.0.7",Je.defaults={domEvents:!1,touchAction:Ie,enable:!0,inputTarget:null,inputClass:null,preset:[[Ze,{enable:!1}],[Xe,{enable:!1},["rotate"]],[Qe,{direction:Z}],[He,{direction:Z},["swipe"]],[$e],[$e,{event:"doubletap",taps:2},["tap"]],[Ye]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function en(e,n){var t;this.options=_({},Je.defaults,n||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((t=this).options.inputClass||(k?ge:W?Oe:U?De:he))(t,te),this.touchAction=new Ne(this,this.options.touchAction),nn(this,!0),g(this.options.recognizers,(function(e){var n=this.add(new e[0](e[1]));e[2]&&n.recognizeWith(e[2]),e[3]&&n.requireFailure(e[3])}),this)}function nn(e,n){var t,r=e.element;r.style&&(g(e.options.cssProps,(function(a,i){t=L(r.style,i),n?(e.oldCssProps[t]=r.style[t],r.style[t]=a):r.style[t]=e.oldCssProps[t]||""})),n||(e.oldCssProps={}))}en.prototype={set:function(e){return _(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var n=this.session;if(!n.stopped){var t;this.touchAction.preventDefaults(e);var r=this.recognizers,a=n.curRecognizer;(!a||a&&8&a.state)&&(a=n.curRecognizer=null);for(var i=0;i<r.length;)t=r[i],2===n.stopped||a&&t!=a&&!t.canRecognizeWith(a)?t.reset():t.recognize(e),!a&&14&t.state&&(a=n.curRecognizer=t),i++}},get:function(e){if(e instanceof je)return e;for(var n=this.recognizers,t=0;t<n.length;t++)if(n[t].options.event==e)return n[t];return null},add:function(e){if(m(e,"add",this))return this;var n=this.get(e.options.event);return n&&this.remove(n),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(m(e,"remove",this))return this;if(e=this.get(e)){var n=this.recognizers,t=w(n,e);-1!==t&&(n.splice(t,1),this.touchAction.update())}return this},on:function(e,n){if(e!==s&&n!==s){var t=this.handlers;return g(C(e),(function(e){t[e]=t[e]||[],t[e].push(n)})),this}},off:function(e,n){if(e!==s){var t=this.handlers;return g(C(e),(function(e){n?t[e]&&t[e].splice(w(t[e],n),1):delete t[e]})),this}},emit:function(e,n){this.options.domEvents&&function(e,n){var t=i.createEvent("Event");t.initEvent(e,!0,!0),t.gesture=n,n.target.dispatchEvent(t)}(e,n);var t=this.handlers[e]&&this.handlers[e].slice();if(t&&t.length){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var r=0;r<t.length;)t[r](n),r++}},destroy:function(){this.element&&nn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},_(Je,{INPUT_START:j,INPUT_MOVE:2,INPUT_END:q,INPUT_CANCEL:V,STATE_POSSIBLE:Ke,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Fe,DIRECTION_NONE:G,DIRECTION_LEFT:z,DIRECTION_RIGHT:H,DIRECTION_UP:X,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:Q,DIRECTION_ALL:$,Manager:en,Input:ne,TouchAction:Ne,TouchInput:Oe,MouseInput:he,PointerEventInput:ge,TouchMouseInput:De,SingleTouchInput:Ee,Recognizer:je,AttrRecognizer:ze,Tap:$e,Pan:He,Swipe:Qe,Pinch:Xe,Rotate:Ze,Press:Ye,on:x,off:D,each:g,merge:b,extend:E,assign:_,inherit:M,bindFn:y,prefixed:L}),(void 0!==a?a:"undefined"!=typeof self?self:{}).Hammer=Je,(r=function(){return Je}.call(n,t,n,e))===s||(e.exports=r)}(window,document)},1044:(e,n,t)=>{"use strict";var r=t(210)("%Object.defineProperty%",!0),a=function(){if(r)try{return r({},"a",{value:1}),!0}catch(e){return!1}return!1};a.hasArrayLengthDefineBug=function(){if(!a())return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=a},8185:e=>{"use strict";var n={foo:{}},t=Object;e.exports=function(){return{__proto__:n}.foo===n.foo&&!({__proto__:null}instanceof t)}},1405:(e,n,t)=>{"use strict";var r="undefined"!=typeof Symbol&&Symbol,a=t(5419);e.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&a())))}},5419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},n=Symbol("test"),t=Object(n);if("string"==typeof n)return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;for(n in e[n]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==n)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,n);if(42!==a.value||!0!==a.enumerable)return!1}return!0}},6410:(e,n,t)=>{"use strict";var r=t(5419);e.exports=function(){return r()&&!!Symbol.toStringTag}},7642:(e,n,t)=>{"use strict";var r=t(8612);e.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},645:(e,n)=>{
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
n.read=function(e,n,t,r,a){var i,o,s=8*a-r-1,_=(1<<s)-1,u=_>>1,l=-7,c=t?a-1:0,h=t?-1:1,d=e[n+c];for(c+=h,i=d&(1<<-l)-1,d>>=-l,l+=s;l>0;i=256*i+e[n+c],c+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[n+c],c+=h,l-=8);if(0===i)i=1-u;else{if(i===_)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),i-=u}return(d?-1:1)*o*Math.pow(2,i-r)},n.write=function(e,n,t,r,a,i){var o,s,_,u=8*i-a-1,l=(1<<u)-1,c=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,f=r?1:-1,p=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(s=isNaN(n)?1:0,o=l):(o=Math.floor(Math.log(n)/Math.LN2),n*(_=Math.pow(2,-o))<1&&(o--,_*=2),(n+=o+c>=1?h/_:h*Math.pow(2,1-c))*_>=2&&(o++,_/=2),o+c>=l?(s=0,o=l):o+c>=1?(s=(n*_-1)*Math.pow(2,a),o+=c):(s=n*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;e[t+d]=255&s,d+=f,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;e[t+d]=255&o,d+=f,o/=256,u-=8);e[t+d-f]|=128*p}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,n){if(n){e.super_=n;var t=function(){};t.prototype=n.prototype,e.prototype=new t,e.prototype.constructor=e}}},2584:(e,n,t)=>{"use strict";var r=t(6410)(),a=t(1924)("Object.prototype.toString"),i=function(e){return!(r&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===a(e)},o=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==a(e)&&"[object Function]"===a(e.callee)},s=function(){return i(arguments)}();i.isLegacyArguments=o,e.exports=s?i:o},5320:e=>{"use strict";var n,t,r=Function.prototype.toString,a="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof a&&"function"==typeof Object.defineProperty)try{n=Object.defineProperty({},"length",{get:function(){throw t}}),t={},a((function(){throw 42}),null,n)}catch(e){e!==t&&(a=null)}else a=null;var i=/^\s*class\b/,o=function(e){try{var n=r.call(e);return i.test(n)}catch(e){return!1}},s=function(e){try{return!o(e)&&(r.call(e),!0)}catch(e){return!1}},_=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,l=!(0 in[,]),c=function(){return!1};if("object"==typeof document){var h=document.all;_.call(h)===_.call(document.all)&&(c=function(e){if((l||!e)&&(void 0===e||"object"==typeof e))try{var n=_.call(e);return("[object HTMLAllCollection]"===n||"[object HTML document.all class]"===n||"[object HTMLCollection]"===n||"[object Object]"===n)&&null==e("")}catch(e){}return!1})}e.exports=a?function(e){if(c(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{a(e,null,n)}catch(e){if(e!==t)return!1}return!o(e)&&s(e)}:function(e){if(c(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(u)return s(e);if(o(e))return!1;var n=_.call(e);return!("[object Function]"!==n&&"[object GeneratorFunction]"!==n&&!/^\[object HTML/.test(n))&&s(e)}},8662:(e,n,t)=>{"use strict";var r,a=Object.prototype.toString,i=Function.prototype.toString,o=/^\s*(?:function)?\*/,s=t(6410)(),_=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(o.test(i.call(e)))return!0;if(!s)return"[object GeneratorFunction]"===a.call(e);if(!_)return!1;if(void 0===r){var n=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch(e){}}();r=!!n&&_(n)}return _(e)===r}},8611:e=>{"use strict";e.exports=function(e){return e!=e}},360:(e,n,t)=>{"use strict";var r=t(5559),a=t(4289),i=t(8611),o=t(9415),s=t(3194),_=r(o(),Number);a(_,{getPolyfill:o,implementation:i,shim:s}),e.exports=_},9415:(e,n,t)=>{"use strict";var r=t(8611);e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:r}},3194:(e,n,t)=>{"use strict";var r=t(4289),a=t(9415);e.exports=function(){var e=a();return r(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}},5692:(e,n,t)=>{"use strict";var r=t(6430);e.exports=function(e){return!!r(e)}},9755:function(e,n){var t;
/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */!function(n,t){"use strict";"object"==typeof e.exports?e.exports=n.document?t(n,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(n)}("undefined"!=typeof window?window:this,(function(r,a){"use strict";var i=[],o=Object.getPrototypeOf,s=i.slice,_=i.flat?function(e){return i.flat.call(e)}:function(e){return i.concat.apply([],e)},u=i.push,l=i.indexOf,c={},h=c.toString,d=c.hasOwnProperty,f=d.toString,p=f.call(Object),m={},g=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},v=function(e){return null!=e&&e===e.window},E=r.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function M(e,n,t){var r,a,i=(t=t||E).createElement("script");if(i.text=e,n)for(r in b)(a=n[r]||n.getAttribute&&n.getAttribute(r))&&i.setAttribute(r,a);t.head.appendChild(i).parentNode.removeChild(i)}function y(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[h.call(e)]||"object":typeof e}var O="3.7.1",P=/HTML$/i,x=function(e,n){return new x.fn.init(e,n)};function D(e){var n=!!e&&"length"in e&&e.length,t=y(e);return!g(e)&&!v(e)&&("array"===t||0===n||"number"==typeof n&&n>0&&n-1 in e)}function T(e,n){return e.nodeName&&e.nodeName.toLowerCase()===n.toLowerCase()}x.fn=x.prototype={jquery:O,constructor:x,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var n=x.merge(this.constructor(),e);return n.prevObject=this,n},each:function(e){return x.each(this,e)},map:function(e){return this.pushStack(x.map(this,(function(n,t){return e.call(n,t,n)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,(function(e,n){return(n+1)%2})))},odd:function(){return this.pushStack(x.grep(this,(function(e,n){return n%2})))},eq:function(e){var n=this.length,t=+e+(e<0?n:0);return this.pushStack(t>=0&&t<n?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:i.sort,splice:i.splice},x.extend=x.fn.extend=function(){var e,n,t,r,a,i,o=arguments[0]||{},s=1,_=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||g(o)||(o={}),s===_&&(o=this,s--);s<_;s++)if(null!=(e=arguments[s]))for(n in e)r=e[n],"__proto__"!==n&&o!==r&&(u&&r&&(x.isPlainObject(r)||(a=Array.isArray(r)))?(t=o[n],i=a&&!Array.isArray(t)?[]:a||x.isPlainObject(t)?t:{},a=!1,o[n]=x.extend(u,i,r)):void 0!==r&&(o[n]=r));return o},x.extend({expando:"jQuery"+(O+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var n,t;return!(!e||"[object Object]"!==h.call(e))&&(!(n=o(e))||"function"==typeof(t=d.call(n,"constructor")&&n.constructor)&&f.call(t)===p)},isEmptyObject:function(e){var n;for(n in e)return!1;return!0},globalEval:function(e,n,t){M(e,{nonce:n&&n.nonce},t)},each:function(e,n){var t,r=0;if(D(e))for(t=e.length;r<t&&!1!==n.call(e[r],r,e[r]);r++);else for(r in e)if(!1===n.call(e[r],r,e[r]))break;return e},text:function(e){var n,t="",r=0,a=e.nodeType;if(!a)for(;n=e[r++];)t+=x.text(n);return 1===a||11===a?e.textContent:9===a?e.documentElement.textContent:3===a||4===a?e.nodeValue:t},makeArray:function(e,n){var t=n||[];return null!=e&&(D(Object(e))?x.merge(t,"string"==typeof e?[e]:e):u.call(t,e)),t},inArray:function(e,n,t){return null==n?-1:l.call(n,e,t)},isXMLDoc:function(e){var n=e&&e.namespaceURI,t=e&&(e.ownerDocument||e).documentElement;return!P.test(n||t&&t.nodeName||"HTML")},merge:function(e,n){for(var t=+n.length,r=0,a=e.length;r<t;r++)e[a++]=n[r];return e.length=a,e},grep:function(e,n,t){for(var r=[],a=0,i=e.length,o=!t;a<i;a++)!n(e[a],a)!==o&&r.push(e[a]);return r},map:function(e,n,t){var r,a,i=0,o=[];if(D(e))for(r=e.length;i<r;i++)null!=(a=n(e[i],i,t))&&o.push(a);else for(i in e)null!=(a=n(e[i],i,t))&&o.push(a);return _(o)},guid:1,support:m}),"function"==typeof Symbol&&(x.fn[Symbol.iterator]=i[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,n){c["[object "+n+"]"]=n.toLowerCase()}));var A=i.pop,C=i.sort,w=i.splice,R="[\\x20\\t\\r\\n\\f]",I=new RegExp("^"+R+"+|((?:^|[^\\\\])(?:\\\\.)*)"+R+"+$","g");x.contains=function(e,n){var t=n&&n.parentNode;return e===t||!(!t||1!==t.nodeType||!(e.contains?e.contains(t):e.compareDocumentPosition&&16&e.compareDocumentPosition(t)))};var L=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function S(e,n){return n?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}x.escapeSelector=function(e){return(e+"").replace(L,S)};var B=E,U=u;!function(){var e,n,t,a,o,_,u,c,h,f,p=U,g=x.expando,v=0,E=0,b=ee(),M=ee(),y=ee(),O=ee(),P=function(e,n){return e===n&&(o=!0),0},D="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="(?:\\\\[\\da-fA-F]{1,6}"+R+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",S="\\["+R+"*("+L+")(?:"+R+"*([*^$|!~]?=)"+R+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+R+"*\\]",k=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+S+")*)|.*)\\)|)",W=new RegExp(R+"+","g"),N=new RegExp("^"+R+"*,"+R+"*"),K=new RegExp("^"+R+"*([>+~]|"+R+")"+R+"*"),F=new RegExp(R+"|>"),j=new RegExp(k),q=new RegExp("^"+L+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+S),PSEUDO:new RegExp("^"+k),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+R+"*(even|odd|(([+-]|)(\\d*)n|)"+R+"*(?:([+-]|)"+R+"*(\\d+)|))"+R+"*\\)|)","i"),bool:new RegExp("^(?:"+D+")$","i"),needsContext:new RegExp("^"+R+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+R+"*((?:-\\d)?\\d*)"+R+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,z=/^h\d$/i,H=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,X=/[+~]/,Y=new RegExp("\\\\[\\da-fA-F]{1,6}"+R+"?|\\\\([^\\r\\n\\f])","g"),Z=function(e,n){var t="0x"+e.slice(1)-65536;return n||(t<0?String.fromCharCode(t+65536):String.fromCharCode(t>>10|55296,1023&t|56320))},Q=function(){_e()},$=he((function(e){return!0===e.disabled&&T(e,"fieldset")}),{dir:"parentNode",next:"legend"});try{p.apply(i=s.call(B.childNodes),B.childNodes),i[B.childNodes.length].nodeType}catch(e){p={apply:function(e,n){U.apply(e,s.call(n))},call:function(e){U.apply(e,s.call(arguments,1))}}}function J(e,n,t,r){var a,i,o,s,u,l,d,f=n&&n.ownerDocument,v=n?n.nodeType:9;if(t=t||[],"string"!=typeof e||!e||1!==v&&9!==v&&11!==v)return t;if(!r&&(_e(n),n=n||_,c)){if(11!==v&&(u=H.exec(e)))if(a=u[1]){if(9===v){if(!(o=n.getElementById(a)))return t;if(o.id===a)return p.call(t,o),t}else if(f&&(o=f.getElementById(a))&&J.contains(n,o)&&o.id===a)return p.call(t,o),t}else{if(u[2])return p.apply(t,n.getElementsByTagName(e)),t;if((a=u[3])&&n.getElementsByClassName)return p.apply(t,n.getElementsByClassName(a)),t}if(!(O[e+" "]||h&&h.test(e))){if(d=e,f=n,1===v&&(F.test(e)||K.test(e))){for((f=X.test(e)&&se(n.parentNode)||n)==n&&m.scope||((s=n.getAttribute("id"))?s=x.escapeSelector(s):n.setAttribute("id",s=g)),i=(l=le(e)).length;i--;)l[i]=(s?"#"+s:":scope")+" "+ce(l[i]);d=l.join(",")}try{return p.apply(t,f.querySelectorAll(d)),t}catch(n){O(e,!0)}finally{s===g&&n.removeAttribute("id")}}}return ve(e.replace(I,"$1"),n,t,r)}function ee(){var e=[];return function t(r,a){return e.push(r+" ")>n.cacheLength&&delete t[e.shift()],t[r+" "]=a}}function ne(e){return e[g]=!0,e}function te(e){var n=_.createElement("fieldset");try{return!!e(n)}catch(e){return!1}finally{n.parentNode&&n.parentNode.removeChild(n),n=null}}function re(e){return function(n){return T(n,"input")&&n.type===e}}function ae(e){return function(n){return(T(n,"input")||T(n,"button"))&&n.type===e}}function ie(e){return function(n){return"form"in n?n.parentNode&&!1===n.disabled?"label"in n?"label"in n.parentNode?n.parentNode.disabled===e:n.disabled===e:n.isDisabled===e||n.isDisabled!==!e&&$(n)===e:n.disabled===e:"label"in n&&n.disabled===e}}function oe(e){return ne((function(n){return n=+n,ne((function(t,r){for(var a,i=e([],t.length,n),o=i.length;o--;)t[a=i[o]]&&(t[a]=!(r[a]=t[a]))}))}))}function se(e){return e&&void 0!==e.getElementsByTagName&&e}function _e(e){var t,r=e?e.ownerDocument||e:B;return r!=_&&9===r.nodeType&&r.documentElement?(u=(_=r).documentElement,c=!x.isXMLDoc(_),f=u.matches||u.webkitMatchesSelector||u.msMatchesSelector,u.msMatchesSelector&&B!=_&&(t=_.defaultView)&&t.top!==t&&t.addEventListener("unload",Q),m.getById=te((function(e){return u.appendChild(e).id=x.expando,!_.getElementsByName||!_.getElementsByName(x.expando).length})),m.disconnectedMatch=te((function(e){return f.call(e,"*")})),m.scope=te((function(){return _.querySelectorAll(":scope")})),m.cssHas=te((function(){try{return _.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}})),m.getById?(n.filter.ID=function(e){var n=e.replace(Y,Z);return function(e){return e.getAttribute("id")===n}},n.find.ID=function(e,n){if(void 0!==n.getElementById&&c){var t=n.getElementById(e);return t?[t]:[]}}):(n.filter.ID=function(e){var n=e.replace(Y,Z);return function(e){var t=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},n.find.ID=function(e,n){if(void 0!==n.getElementById&&c){var t,r,a,i=n.getElementById(e);if(i){if((t=i.getAttributeNode("id"))&&t.value===e)return[i];for(a=n.getElementsByName(e),r=0;i=a[r++];)if((t=i.getAttributeNode("id"))&&t.value===e)return[i]}return[]}}),n.find.TAG=function(e,n){return void 0!==n.getElementsByTagName?n.getElementsByTagName(e):n.querySelectorAll(e)},n.find.CLASS=function(e,n){if(void 0!==n.getElementsByClassName&&c)return n.getElementsByClassName(e)},h=[],te((function(e){var n;u.appendChild(e).innerHTML="<a id='"+g+"' href='' disabled='disabled'></a><select id='"+g+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||h.push("\\["+R+"*(?:value|"+D+")"),e.querySelectorAll("[id~="+g+"-]").length||h.push("~="),e.querySelectorAll("a#"+g+"+*").length||h.push(".#.+[+~]"),e.querySelectorAll(":checked").length||h.push(":checked"),(n=_.createElement("input")).setAttribute("type","hidden"),e.appendChild(n).setAttribute("name","D"),u.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&h.push(":enabled",":disabled"),(n=_.createElement("input")).setAttribute("name",""),e.appendChild(n),e.querySelectorAll("[name='']").length||h.push("\\["+R+"*name"+R+"*="+R+"*(?:''|\"\")")})),m.cssHas||h.push(":has"),h=h.length&&new RegExp(h.join("|")),P=function(e,n){if(e===n)return o=!0,0;var t=!e.compareDocumentPosition-!n.compareDocumentPosition;return t||(1&(t=(e.ownerDocument||e)==(n.ownerDocument||n)?e.compareDocumentPosition(n):1)||!m.sortDetached&&n.compareDocumentPosition(e)===t?e===_||e.ownerDocument==B&&J.contains(B,e)?-1:n===_||n.ownerDocument==B&&J.contains(B,n)?1:a?l.call(a,e)-l.call(a,n):0:4&t?-1:1)},_):_}for(e in J.matches=function(e,n){return J(e,null,null,n)},J.matchesSelector=function(e,n){if(_e(e),c&&!O[n+" "]&&(!h||!h.test(n)))try{var t=f.call(e,n);if(t||m.disconnectedMatch||e.document&&11!==e.document.nodeType)return t}catch(e){O(n,!0)}return J(n,_,null,[e]).length>0},J.contains=function(e,n){return(e.ownerDocument||e)!=_&&_e(e),x.contains(e,n)},J.attr=function(e,t){(e.ownerDocument||e)!=_&&_e(e);var r=n.attrHandle[t.toLowerCase()],a=r&&d.call(n.attrHandle,t.toLowerCase())?r(e,t,!c):void 0;return void 0!==a?a:e.getAttribute(t)},J.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},x.uniqueSort=function(e){var n,t=[],r=0,i=0;if(o=!m.sortStable,a=!m.sortStable&&s.call(e,0),C.call(e,P),o){for(;n=e[i++];)n===e[i]&&(r=t.push(i));for(;r--;)w.call(e,t[r],1)}return a=null,e},x.fn.uniqueSort=function(){return this.pushStack(x.uniqueSort(s.apply(this)))},n=x.expr={cacheLength:50,createPseudo:ne,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Y,Z),e[3]=(e[3]||e[4]||e[5]||"").replace(Y,Z),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||J.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&J.error(e[0]),e},PSEUDO:function(e){var n,t=!e[6]&&e[2];return V.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":t&&j.test(t)&&(n=le(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(e[0]=e[0].slice(0,n),e[2]=t.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var n=e.replace(Y,Z).toLowerCase();return"*"===e?function(){return!0}:function(e){return T(e,n)}},CLASS:function(e){var n=b[e+" "];return n||(n=new RegExp("(^|"+R+")"+e+"("+R+"|$)"))&&b(e,(function(e){return n.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,n,t){return function(r){var a=J.attr(r,e);return null==a?"!="===n:!n||(a+="","="===n?a===t:"!="===n?a!==t:"^="===n?t&&0===a.indexOf(t):"*="===n?t&&a.indexOf(t)>-1:"$="===n?t&&a.slice(-t.length)===t:"~="===n?(" "+a.replace(W," ")+" ").indexOf(t)>-1:"|="===n&&(a===t||a.slice(0,t.length+1)===t+"-"))}},CHILD:function(e,n,t,r,a){var i="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===n;return 1===r&&0===a?function(e){return!!e.parentNode}:function(n,t,_){var u,l,c,h,d,f=i!==o?"nextSibling":"previousSibling",p=n.parentNode,m=s&&n.nodeName.toLowerCase(),E=!_&&!s,b=!1;if(p){if(i){for(;f;){for(c=n;c=c[f];)if(s?T(c,m):1===c.nodeType)return!1;d=f="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?p.firstChild:p.lastChild],o&&E){for(b=(h=(u=(l=p[g]||(p[g]={}))[e]||[])[0]===v&&u[1])&&u[2],c=h&&p.childNodes[h];c=++h&&c&&c[f]||(b=h=0)||d.pop();)if(1===c.nodeType&&++b&&c===n){l[e]=[v,h,b];break}}else if(E&&(b=h=(u=(l=n[g]||(n[g]={}))[e]||[])[0]===v&&u[1]),!1===b)for(;(c=++h&&c&&c[f]||(b=h=0)||d.pop())&&(!(s?T(c,m):1===c.nodeType)||!++b||(E&&((l=c[g]||(c[g]={}))[e]=[v,b]),c!==n)););return(b-=a)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var r,a=n.pseudos[e]||n.setFilters[e.toLowerCase()]||J.error("unsupported pseudo: "+e);return a[g]?a(t):a.length>1?(r=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ne((function(e,n){for(var r,i=a(e,t),o=i.length;o--;)e[r=l.call(e,i[o])]=!(n[r]=i[o])})):function(e){return a(e,0,r)}):a}},pseudos:{not:ne((function(e){var n=[],t=[],r=ge(e.replace(I,"$1"));return r[g]?ne((function(e,n,t,a){for(var i,o=r(e,null,a,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(n[s]=i))})):function(e,a,i){return n[0]=e,r(n,null,i,t),n[0]=null,!t.pop()}})),has:ne((function(e){return function(n){return J(e,n).length>0}})),contains:ne((function(e){return e=e.replace(Y,Z),function(n){return(n.textContent||x.text(n)).indexOf(e)>-1}})),lang:ne((function(e){return q.test(e||"")||J.error("unsupported lang: "+e),e=e.replace(Y,Z).toLowerCase(),function(n){var t;do{if(t=c?n.lang:n.getAttribute("xml:lang")||n.getAttribute("lang"))return(t=t.toLowerCase())===e||0===t.indexOf(e+"-")}while((n=n.parentNode)&&1===n.nodeType);return!1}})),target:function(e){var n=r.location&&r.location.hash;return n&&n.slice(1)===e.id},root:function(e){return e===u},focus:function(e){return e===function(){try{return _.activeElement}catch(e){}}()&&_.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:ie(!1),disabled:ie(!0),checked:function(e){return T(e,"input")&&!!e.checked||T(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!n.pseudos.empty(e)},header:function(e){return z.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){return T(e,"input")&&"button"===e.type||T(e,"button")},text:function(e){var n;return T(e,"input")&&"text"===e.type&&(null==(n=e.getAttribute("type"))||"text"===n.toLowerCase())},first:oe((function(){return[0]})),last:oe((function(e,n){return[n-1]})),eq:oe((function(e,n,t){return[t<0?t+n:t]})),even:oe((function(e,n){for(var t=0;t<n;t+=2)e.push(t);return e})),odd:oe((function(e,n){for(var t=1;t<n;t+=2)e.push(t);return e})),lt:oe((function(e,n,t){var r;for(r=t<0?t+n:t>n?n:t;--r>=0;)e.push(r);return e})),gt:oe((function(e,n,t){for(var r=t<0?t+n:t;++r<n;)e.push(r);return e}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=re(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ae(e);function ue(){}function le(e,t){var r,a,i,o,s,_,u,l=M[e+" "];if(l)return t?0:l.slice(0);for(s=e,_=[],u=n.preFilter;s;){for(o in r&&!(a=N.exec(s))||(a&&(s=s.slice(a[0].length)||s),_.push(i=[])),r=!1,(a=K.exec(s))&&(r=a.shift(),i.push({value:r,type:a[0].replace(I," ")}),s=s.slice(r.length)),n.filter)!(a=V[o].exec(s))||u[o]&&!(a=u[o](a))||(r=a.shift(),i.push({value:r,type:o,matches:a}),s=s.slice(r.length));if(!r)break}return t?s.length:s?J.error(e):M(e,_).slice(0)}function ce(e){for(var n=0,t=e.length,r="";n<t;n++)r+=e[n].value;return r}function he(e,n,t){var r=n.dir,a=n.next,i=a||r,o=t&&"parentNode"===i,s=E++;return n.first?function(n,t,a){for(;n=n[r];)if(1===n.nodeType||o)return e(n,t,a);return!1}:function(n,t,_){var u,l,c=[v,s];if(_){for(;n=n[r];)if((1===n.nodeType||o)&&e(n,t,_))return!0}else for(;n=n[r];)if(1===n.nodeType||o)if(l=n[g]||(n[g]={}),a&&T(n,a))n=n[r]||n;else{if((u=l[i])&&u[0]===v&&u[1]===s)return c[2]=u[2];if(l[i]=c,c[2]=e(n,t,_))return!0}return!1}}function de(e){return e.length>1?function(n,t,r){for(var a=e.length;a--;)if(!e[a](n,t,r))return!1;return!0}:e[0]}function fe(e,n,t,r,a){for(var i,o=[],s=0,_=e.length,u=null!=n;s<_;s++)(i=e[s])&&(t&&!t(i,r,a)||(o.push(i),u&&n.push(s)));return o}function pe(e,n,t,r,a,i){return r&&!r[g]&&(r=pe(r)),a&&!a[g]&&(a=pe(a,i)),ne((function(i,o,s,_){var u,c,h,d,f=[],m=[],g=o.length,v=i||function(e,n,t){for(var r=0,a=n.length;r<a;r++)J(e,n[r],t);return t}(n||"*",s.nodeType?[s]:s,[]),E=!e||!i&&n?v:fe(v,f,e,s,_);if(t?t(E,d=a||(i?e:g||r)?[]:o,s,_):d=E,r)for(u=fe(d,m),r(u,[],s,_),c=u.length;c--;)(h=u[c])&&(d[m[c]]=!(E[m[c]]=h));if(i){if(a||e){if(a){for(u=[],c=d.length;c--;)(h=d[c])&&u.push(E[c]=h);a(null,d=[],u,_)}for(c=d.length;c--;)(h=d[c])&&(u=a?l.call(i,h):f[c])>-1&&(i[u]=!(o[u]=h))}}else d=fe(d===o?d.splice(g,d.length):d),a?a(null,o,d,_):p.apply(o,d)}))}function me(e){for(var r,a,i,o=e.length,s=n.relative[e[0].type],_=s||n.relative[" "],u=s?1:0,c=he((function(e){return e===r}),_,!0),h=he((function(e){return l.call(r,e)>-1}),_,!0),d=[function(e,n,a){var i=!s&&(a||n!=t)||((r=n).nodeType?c(e,n,a):h(e,n,a));return r=null,i}];u<o;u++)if(a=n.relative[e[u].type])d=[he(de(d),a)];else{if((a=n.filter[e[u].type].apply(null,e[u].matches))[g]){for(i=++u;i<o&&!n.relative[e[i].type];i++);return pe(u>1&&de(d),u>1&&ce(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(I,"$1"),a,u<i&&me(e.slice(u,i)),i<o&&me(e=e.slice(i)),i<o&&ce(e))}d.push(a)}return de(d)}function ge(e,r){var a,i=[],o=[],s=y[e+" "];if(!s){for(r||(r=le(e)),a=r.length;a--;)(s=me(r[a]))[g]?i.push(s):o.push(s);s=y(e,function(e,r){var a=r.length>0,i=e.length>0,o=function(o,s,u,l,h){var d,f,m,g=0,E="0",b=o&&[],M=[],y=t,O=o||i&&n.find.TAG("*",h),P=v+=null==y?1:Math.random()||.1,D=O.length;for(h&&(t=s==_||s||h);E!==D&&null!=(d=O[E]);E++){if(i&&d){for(f=0,s||d.ownerDocument==_||(_e(d),u=!c);m=e[f++];)if(m(d,s||_,u)){p.call(l,d);break}h&&(v=P)}a&&((d=!m&&d)&&g--,o&&b.push(d))}if(g+=E,a&&E!==g){for(f=0;m=r[f++];)m(b,M,s,u);if(o){if(g>0)for(;E--;)b[E]||M[E]||(M[E]=A.call(l));M=fe(M)}p.apply(l,M),h&&!o&&M.length>0&&g+r.length>1&&x.uniqueSort(l)}return h&&(v=P,t=y),b};return a?ne(o):o}(o,i)),s.selector=e}return s}function ve(e,t,r,a){var i,o,s,_,u,l="function"==typeof e&&e,h=!a&&le(e=l.selector||e);if(r=r||[],1===h.length){if((o=h[0]=h[0].slice(0)).length>2&&"ID"===(s=o[0]).type&&9===t.nodeType&&c&&n.relative[o[1].type]){if(!(t=(n.find.ID(s.matches[0].replace(Y,Z),t)||[])[0]))return r;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(i=V.needsContext.test(e)?0:o.length;i--&&(s=o[i],!n.relative[_=s.type]);)if((u=n.find[_])&&(a=u(s.matches[0].replace(Y,Z),X.test(o[0].type)&&se(t.parentNode)||t))){if(o.splice(i,1),!(e=a.length&&ce(o)))return p.apply(r,a),r;break}}return(l||ge(e,h))(a,t,!c,r,!t||X.test(e)&&se(t.parentNode)||t),r}ue.prototype=n.filters=n.pseudos,n.setFilters=new ue,m.sortStable=g.split("").sort(P).join("")===g,_e(),m.sortDetached=te((function(e){return 1&e.compareDocumentPosition(_.createElement("fieldset"))})),x.find=J,x.expr[":"]=x.expr.pseudos,x.unique=x.uniqueSort,J.compile=ge,J.select=ve,J.setDocument=_e,J.tokenize=le,J.escape=x.escapeSelector,J.getText=x.text,J.isXML=x.isXMLDoc,J.selectors=x.expr,J.support=x.support,J.uniqueSort=x.uniqueSort}();var k=function(e,n,t){for(var r=[],a=void 0!==t;(e=e[n])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&x(e).is(t))break;r.push(e)}return r},W=function(e,n){for(var t=[];e;e=e.nextSibling)1===e.nodeType&&e!==n&&t.push(e);return t},N=x.expr.match.needsContext,K=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function F(e,n,t){return g(n)?x.grep(e,(function(e,r){return!!n.call(e,r,e)!==t})):n.nodeType?x.grep(e,(function(e){return e===n!==t})):"string"!=typeof n?x.grep(e,(function(e){return l.call(n,e)>-1!==t})):x.filter(n,e,t)}x.filter=function(e,n,t){var r=n[0];return t&&(e=":not("+e+")"),1===n.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(n,(function(e){return 1===e.nodeType})))},x.fn.extend({find:function(e){var n,t,r=this.length,a=this;if("string"!=typeof e)return this.pushStack(x(e).filter((function(){for(n=0;n<r;n++)if(x.contains(a[n],this))return!0})));for(t=this.pushStack([]),n=0;n<r;n++)x.find(e,a[n],t);return r>1?x.uniqueSort(t):t},filter:function(e){return this.pushStack(F(this,e||[],!1))},not:function(e){return this.pushStack(F(this,e||[],!0))},is:function(e){return!!F(this,"string"==typeof e&&N.test(e)?x(e):e||[],!1).length}});var j,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(x.fn.init=function(e,n,t){var r,a;if(!e)return this;if(t=t||j,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:q.exec(e))||!r[1]&&n)return!n||n.jquery?(n||t).find(e):this.constructor(n).find(e);if(r[1]){if(n=n instanceof x?n[0]:n,x.merge(this,x.parseHTML(r[1],n&&n.nodeType?n.ownerDocument||n:E,!0)),K.test(r[1])&&x.isPlainObject(n))for(r in n)g(this[r])?this[r](n[r]):this.attr(r,n[r]);return this}return(a=E.getElementById(r[2]))&&(this[0]=a,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):g(e)?void 0!==t.ready?t.ready(e):e(x):x.makeArray(e,this)}).prototype=x.fn,j=x(E);var V=/^(?:parents|prev(?:Until|All))/,G={children:!0,contents:!0,next:!0,prev:!0};function z(e,n){for(;(e=e[n])&&1!==e.nodeType;);return e}x.fn.extend({has:function(e){var n=x(e,this),t=n.length;return this.filter((function(){for(var e=0;e<t;e++)if(x.contains(this,n[e]))return!0}))},closest:function(e,n){var t,r=0,a=this.length,i=[],o="string"!=typeof e&&x(e);if(!N.test(e))for(;r<a;r++)for(t=this[r];t&&t!==n;t=t.parentNode)if(t.nodeType<11&&(o?o.index(t)>-1:1===t.nodeType&&x.find.matchesSelector(t,e))){i.push(t);break}return this.pushStack(i.length>1?x.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?l.call(x(e),this[0]):l.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,n){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(e,n))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var n=e.parentNode;return n&&11!==n.nodeType?n:null},parents:function(e){return k(e,"parentNode")},parentsUntil:function(e,n,t){return k(e,"parentNode",t)},next:function(e){return z(e,"nextSibling")},prev:function(e){return z(e,"previousSibling")},nextAll:function(e){return k(e,"nextSibling")},prevAll:function(e){return k(e,"previousSibling")},nextUntil:function(e,n,t){return k(e,"nextSibling",t)},prevUntil:function(e,n,t){return k(e,"previousSibling",t)},siblings:function(e){return W((e.parentNode||{}).firstChild,e)},children:function(e){return W(e.firstChild)},contents:function(e){return null!=e.contentDocument&&o(e.contentDocument)?e.contentDocument:(T(e,"template")&&(e=e.content||e),x.merge([],e.childNodes))}},(function(e,n){x.fn[e]=function(t,r){var a=x.map(this,n,t);return"Until"!==e.slice(-5)&&(r=t),r&&"string"==typeof r&&(a=x.filter(r,a)),this.length>1&&(G[e]||x.uniqueSort(a),V.test(e)&&a.reverse()),this.pushStack(a)}}));var H=/[^\x20\t\r\n\f]+/g;function X(e){return e}function Y(e){throw e}function Z(e,n,t,r){var a;try{e&&g(a=e.promise)?a.call(e).done(n).fail(t):e&&g(a=e.then)?a.call(e,n,t):n.apply(void 0,[e].slice(r))}catch(e){t.apply(void 0,[e])}}x.Callbacks=function(e){e="string"==typeof e?function(e){var n={};return x.each(e.match(H)||[],(function(e,t){n[t]=!0})),n}(e):x.extend({},e);var n,t,r,a,i=[],o=[],s=-1,_=function(){for(a=a||e.once,r=n=!0;o.length;s=-1)for(t=o.shift();++s<i.length;)!1===i[s].apply(t[0],t[1])&&e.stopOnFalse&&(s=i.length,t=!1);e.memory||(t=!1),n=!1,a&&(i=t?[]:"")},u={add:function(){return i&&(t&&!n&&(s=i.length-1,o.push(t)),function n(t){x.each(t,(function(t,r){g(r)?e.unique&&u.has(r)||i.push(r):r&&r.length&&"string"!==y(r)&&n(r)}))}(arguments),t&&!n&&_()),this},remove:function(){return x.each(arguments,(function(e,n){for(var t;(t=x.inArray(n,i,t))>-1;)i.splice(t,1),t<=s&&s--})),this},has:function(e){return e?x.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return a=o=[],i=t="",this},disabled:function(){return!i},lock:function(){return a=o=[],t||n||(i=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],o.push(t),n||_()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},x.extend({Deferred:function(e){var n=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],t="pending",a={state:function(){return t},always:function(){return i.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var e=arguments;return x.Deferred((function(t){x.each(n,(function(n,r){var a=g(e[r[4]])&&e[r[4]];i[r[1]]((function(){var e=a&&a.apply(this,arguments);e&&g(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,a?[e]:arguments)}))})),e=null})).promise()},then:function(e,t,a){var i=0;function o(e,n,t,a){return function(){var s=this,_=arguments,u=function(){var r,u;if(!(e<i)){if((r=t.apply(s,_))===n.promise())throw new TypeError("Thenable self-resolution");u=r&&("object"==typeof r||"function"==typeof r)&&r.then,g(u)?a?u.call(r,o(i,n,X,a),o(i,n,Y,a)):(i++,u.call(r,o(i,n,X,a),o(i,n,Y,a),o(i,n,X,n.notifyWith))):(t!==X&&(s=void 0,_=[r]),(a||n.resolveWith)(s,_))}},l=a?u:function(){try{u()}catch(r){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(r,l.error),e+1>=i&&(t!==Y&&(s=void 0,_=[r]),n.rejectWith(s,_))}};e?l():(x.Deferred.getErrorHook?l.error=x.Deferred.getErrorHook():x.Deferred.getStackHook&&(l.error=x.Deferred.getStackHook()),r.setTimeout(l))}}return x.Deferred((function(r){n[0][3].add(o(0,r,g(a)?a:X,r.notifyWith)),n[1][3].add(o(0,r,g(e)?e:X)),n[2][3].add(o(0,r,g(t)?t:Y))})).promise()},promise:function(e){return null!=e?x.extend(e,a):a}},i={};return x.each(n,(function(e,r){var o=r[2],s=r[5];a[r[1]]=o.add,s&&o.add((function(){t=s}),n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),o.add(r[3].fire),i[r[0]]=function(){return i[r[0]+"With"](this===i?void 0:this,arguments),this},i[r[0]+"With"]=o.fireWith})),a.promise(i),e&&e.call(i,i),i},when:function(e){var n=arguments.length,t=n,r=Array(t),a=s.call(arguments),i=x.Deferred(),o=function(e){return function(t){r[e]=this,a[e]=arguments.length>1?s.call(arguments):t,--n||i.resolveWith(r,a)}};if(n<=1&&(Z(e,i.done(o(t)).resolve,i.reject,!n),"pending"===i.state()||g(a[t]&&a[t].then)))return i.then();for(;t--;)Z(a[t],o(t),i.reject);return i.promise()}});var Q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(e,n){r.console&&r.console.warn&&e&&Q.test(e.name)&&r.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},x.readyException=function(e){r.setTimeout((function(){throw e}))};var $=x.Deferred();function J(){E.removeEventListener("DOMContentLoaded",J),r.removeEventListener("load",J),x.ready()}x.fn.ready=function(e){return $.then(e).catch((function(e){x.readyException(e)})),this},x.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--x.readyWait:x.isReady)||(x.isReady=!0,!0!==e&&--x.readyWait>0||$.resolveWith(E,[x]))}}),x.ready.then=$.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?r.setTimeout(x.ready):(E.addEventListener("DOMContentLoaded",J),r.addEventListener("load",J));var ee=function(e,n,t,r,a,i,o){var s=0,_=e.length,u=null==t;if("object"===y(t))for(s in a=!0,t)ee(e,n,s,t[s],!0,i,o);else if(void 0!==r&&(a=!0,g(r)||(o=!0),u&&(o?(n.call(e,r),n=null):(u=n,n=function(e,n,t){return u.call(x(e),t)})),n))for(;s<_;s++)n(e[s],t,o?r:r.call(e[s],s,n(e[s],t)));return a?e:u?n.call(e):_?n(e[0],t):i},ne=/^-ms-/,te=/-([a-z])/g;function re(e,n){return n.toUpperCase()}function ae(e){return e.replace(ne,"ms-").replace(te,re)}var ie=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function oe(){this.expando=x.expando+oe.uid++}oe.uid=1,oe.prototype={cache:function(e){var n=e[this.expando];return n||(n={},ie(e)&&(e.nodeType?e[this.expando]=n:Object.defineProperty(e,this.expando,{value:n,configurable:!0}))),n},set:function(e,n,t){var r,a=this.cache(e);if("string"==typeof n)a[ae(n)]=t;else for(r in n)a[ae(r)]=n[r];return a},get:function(e,n){return void 0===n?this.cache(e):e[this.expando]&&e[this.expando][ae(n)]},access:function(e,n,t){return void 0===n||n&&"string"==typeof n&&void 0===t?this.get(e,n):(this.set(e,n,t),void 0!==t?t:n)},remove:function(e,n){var t,r=e[this.expando];if(void 0!==r){if(void 0!==n){t=(n=Array.isArray(n)?n.map(ae):(n=ae(n))in r?[n]:n.match(H)||[]).length;for(;t--;)delete r[n[t]]}(void 0===n||x.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var n=e[this.expando];return void 0!==n&&!x.isEmptyObject(n)}};var se=new oe,_e=new oe,ue=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,le=/[A-Z]/g;function ce(e,n,t){var r;if(void 0===t&&1===e.nodeType)if(r="data-"+n.replace(le,"-$&").toLowerCase(),"string"==typeof(t=e.getAttribute(r))){try{t=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:ue.test(e)?JSON.parse(e):e)}(t)}catch(e){}_e.set(e,n,t)}else t=void 0;return t}x.extend({hasData:function(e){return _e.hasData(e)||se.hasData(e)},data:function(e,n,t){return _e.access(e,n,t)},removeData:function(e,n){_e.remove(e,n)},_data:function(e,n,t){return se.access(e,n,t)},_removeData:function(e,n){se.remove(e,n)}}),x.fn.extend({data:function(e,n){var t,r,a,i=this[0],o=i&&i.attributes;if(void 0===e){if(this.length&&(a=_e.get(i),1===i.nodeType&&!se.get(i,"hasDataAttrs"))){for(t=o.length;t--;)o[t]&&0===(r=o[t].name).indexOf("data-")&&(r=ae(r.slice(5)),ce(i,r,a[r]));se.set(i,"hasDataAttrs",!0)}return a}return"object"==typeof e?this.each((function(){_e.set(this,e)})):ee(this,(function(n){var t;if(i&&void 0===n)return void 0!==(t=_e.get(i,e))||void 0!==(t=ce(i,e))?t:void 0;this.each((function(){_e.set(this,e,n)}))}),null,n,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){_e.remove(this,e)}))}}),x.extend({queue:function(e,n,t){var r;if(e)return n=(n||"fx")+"queue",r=se.get(e,n),t&&(!r||Array.isArray(t)?r=se.access(e,n,x.makeArray(t)):r.push(t)),r||[]},dequeue:function(e,n){n=n||"fx";var t=x.queue(e,n),r=t.length,a=t.shift(),i=x._queueHooks(e,n);"inprogress"===a&&(a=t.shift(),r--),a&&("fx"===n&&t.unshift("inprogress"),delete i.stop,a.call(e,(function(){x.dequeue(e,n)}),i)),!r&&i&&i.empty.fire()},_queueHooks:function(e,n){var t=n+"queueHooks";return se.get(e,t)||se.access(e,t,{empty:x.Callbacks("once memory").add((function(){se.remove(e,[n+"queue",t])}))})}}),x.fn.extend({queue:function(e,n){var t=2;return"string"!=typeof e&&(n=e,e="fx",t--),arguments.length<t?x.queue(this[0],e):void 0===n?this:this.each((function(){var t=x.queue(this,e,n);x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){x.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var t,r=1,a=x.Deferred(),i=this,o=this.length,s=function(){--r||a.resolveWith(i,[i])};for("string"!=typeof e&&(n=e,e=void 0),e=e||"fx";o--;)(t=se.get(i[o],e+"queueHooks"))&&t.empty&&(r++,t.empty.add(s));return s(),a.promise(n)}});var he=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,de=new RegExp("^(?:([+-])=|)("+he+")([a-z%]*)$","i"),fe=["Top","Right","Bottom","Left"],pe=E.documentElement,me=function(e){return x.contains(e.ownerDocument,e)},ge={composed:!0};pe.getRootNode&&(me=function(e){return x.contains(e.ownerDocument,e)||e.getRootNode(ge)===e.ownerDocument});var ve=function(e,n){return"none"===(e=n||e).style.display||""===e.style.display&&me(e)&&"none"===x.css(e,"display")};function Ee(e,n,t,r){var a,i,o=20,s=r?function(){return r.cur()}:function(){return x.css(e,n,"")},_=s(),u=t&&t[3]||(x.cssNumber[n]?"":"px"),l=e.nodeType&&(x.cssNumber[n]||"px"!==u&&+_)&&de.exec(x.css(e,n));if(l&&l[3]!==u){for(_/=2,u=u||l[3],l=+_||1;o--;)x.style(e,n,l+u),(1-i)*(1-(i=s()/_||.5))<=0&&(o=0),l/=i;l*=2,x.style(e,n,l+u),t=t||[]}return t&&(l=+l||+_||0,a=t[1]?l+(t[1]+1)*t[2]:+t[2],r&&(r.unit=u,r.start=l,r.end=a)),a}var be={};function Me(e){var n,t=e.ownerDocument,r=e.nodeName,a=be[r];return a||(n=t.body.appendChild(t.createElement(r)),a=x.css(n,"display"),n.parentNode.removeChild(n),"none"===a&&(a="block"),be[r]=a,a)}function ye(e,n){for(var t,r,a=[],i=0,o=e.length;i<o;i++)(r=e[i]).style&&(t=r.style.display,n?("none"===t&&(a[i]=se.get(r,"display")||null,a[i]||(r.style.display="")),""===r.style.display&&ve(r)&&(a[i]=Me(r))):"none"!==t&&(a[i]="none",se.set(r,"display",t)));for(i=0;i<o;i++)null!=a[i]&&(e[i].style.display=a[i]);return e}x.fn.extend({show:function(){return ye(this,!0)},hide:function(){return ye(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ve(this)?x(this).show():x(this).hide()}))}});var Oe,Pe,xe=/^(?:checkbox|radio)$/i,De=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Te=/^$|^module$|\/(?:java|ecma)script/i;Oe=E.createDocumentFragment().appendChild(E.createElement("div")),(Pe=E.createElement("input")).setAttribute("type","radio"),Pe.setAttribute("checked","checked"),Pe.setAttribute("name","t"),Oe.appendChild(Pe),m.checkClone=Oe.cloneNode(!0).cloneNode(!0).lastChild.checked,Oe.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!Oe.cloneNode(!0).lastChild.defaultValue,Oe.innerHTML="<option></option>",m.option=!!Oe.lastChild;var Ae={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ce(e,n){var t;return t=void 0!==e.getElementsByTagName?e.getElementsByTagName(n||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(n||"*"):[],void 0===n||n&&T(e,n)?x.merge([e],t):t}function we(e,n){for(var t=0,r=e.length;t<r;t++)se.set(e[t],"globalEval",!n||se.get(n[t],"globalEval"))}Ae.tbody=Ae.tfoot=Ae.colgroup=Ae.caption=Ae.thead,Ae.th=Ae.td,m.option||(Ae.optgroup=Ae.option=[1,"<select multiple='multiple'>","</select>"]);var Re=/<|&#?\w+;/;function Ie(e,n,t,r,a){for(var i,o,s,_,u,l,c=n.createDocumentFragment(),h=[],d=0,f=e.length;d<f;d++)if((i=e[d])||0===i)if("object"===y(i))x.merge(h,i.nodeType?[i]:i);else if(Re.test(i)){for(o=o||c.appendChild(n.createElement("div")),s=(De.exec(i)||["",""])[1].toLowerCase(),_=Ae[s]||Ae._default,o.innerHTML=_[1]+x.htmlPrefilter(i)+_[2],l=_[0];l--;)o=o.lastChild;x.merge(h,o.childNodes),(o=c.firstChild).textContent=""}else h.push(n.createTextNode(i));for(c.textContent="",d=0;i=h[d++];)if(r&&x.inArray(i,r)>-1)a&&a.push(i);else if(u=me(i),o=Ce(c.appendChild(i),"script"),u&&we(o),t)for(l=0;i=o[l++];)Te.test(i.type||"")&&t.push(i);return c}var Le=/^([^.]*)(?:\.(.+)|)/;function Se(){return!0}function Be(){return!1}function Ue(e,n,t,r,a,i){var o,s;if("object"==typeof n){for(s in"string"!=typeof t&&(r=r||t,t=void 0),n)Ue(e,s,t,r,n[s],i);return e}if(null==r&&null==a?(a=t,r=t=void 0):null==a&&("string"==typeof t?(a=r,r=void 0):(a=r,r=t,t=void 0)),!1===a)a=Be;else if(!a)return e;return 1===i&&(o=a,a=function(e){return x().off(e),o.apply(this,arguments)},a.guid=o.guid||(o.guid=x.guid++)),e.each((function(){x.event.add(this,n,a,r,t)}))}function ke(e,n,t){t?(se.set(e,n,!1),x.event.add(e,n,{namespace:!1,handler:function(e){var t,r=se.get(this,n);if(1&e.isTrigger&&this[n]){if(r)(x.event.special[n]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),se.set(this,n,r),this[n](),t=se.get(this,n),se.set(this,n,!1),r!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else r&&(se.set(this,n,x.event.trigger(r[0],r.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Se)}})):void 0===se.get(e,n)&&x.event.add(e,n,Se)}x.event={global:{},add:function(e,n,t,r,a){var i,o,s,_,u,l,c,h,d,f,p,m=se.get(e);if(ie(e))for(t.handler&&(t=(i=t).handler,a=i.selector),a&&x.find.matchesSelector(pe,a),t.guid||(t.guid=x.guid++),(_=m.events)||(_=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(n){return void 0!==x&&x.event.triggered!==n.type?x.event.dispatch.apply(e,arguments):void 0}),u=(n=(n||"").match(H)||[""]).length;u--;)d=p=(s=Le.exec(n[u])||[])[1],f=(s[2]||"").split(".").sort(),d&&(c=x.event.special[d]||{},d=(a?c.delegateType:c.bindType)||d,c=x.event.special[d]||{},l=x.extend({type:d,origType:p,data:r,handler:t,guid:t.guid,selector:a,needsContext:a&&x.expr.match.needsContext.test(a),namespace:f.join(".")},i),(h=_[d])||((h=_[d]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,r,f,o)||e.addEventListener&&e.addEventListener(d,o)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=t.guid)),a?h.splice(h.delegateCount++,0,l):h.push(l),x.event.global[d]=!0)},remove:function(e,n,t,r,a){var i,o,s,_,u,l,c,h,d,f,p,m=se.hasData(e)&&se.get(e);if(m&&(_=m.events)){for(u=(n=(n||"").match(H)||[""]).length;u--;)if(d=p=(s=Le.exec(n[u])||[])[1],f=(s[2]||"").split(".").sort(),d){for(c=x.event.special[d]||{},h=_[d=(r?c.delegateType:c.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=i=h.length;i--;)l=h[i],!a&&p!==l.origType||t&&t.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(i,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&!1!==c.teardown.call(e,f,m.handle)||x.removeEvent(e,d,m.handle),delete _[d])}else for(d in _)x.event.remove(e,d+n[u],t,r,!0);x.isEmptyObject(_)&&se.remove(e,"handle events")}},dispatch:function(e){var n,t,r,a,i,o,s=new Array(arguments.length),_=x.event.fix(e),u=(se.get(this,"events")||Object.create(null))[_.type]||[],l=x.event.special[_.type]||{};for(s[0]=_,n=1;n<arguments.length;n++)s[n]=arguments[n];if(_.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,_)){for(o=x.event.handlers.call(this,_,u),n=0;(a=o[n++])&&!_.isPropagationStopped();)for(_.currentTarget=a.elem,t=0;(i=a.handlers[t++])&&!_.isImmediatePropagationStopped();)_.rnamespace&&!1!==i.namespace&&!_.rnamespace.test(i.namespace)||(_.handleObj=i,_.data=i.data,void 0!==(r=((x.event.special[i.origType]||{}).handle||i.handler).apply(a.elem,s))&&!1===(_.result=r)&&(_.preventDefault(),_.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,_),_.result}},handlers:function(e,n){var t,r,a,i,o,s=[],_=n.delegateCount,u=e.target;if(_&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(i=[],o={},t=0;t<_;t++)void 0===o[a=(r=n[t]).selector+" "]&&(o[a]=r.needsContext?x(a,this).index(u)>-1:x.find(a,this,null,[u]).length),o[a]&&i.push(r);i.length&&s.push({elem:u,handlers:i})}return u=this,_<n.length&&s.push({elem:u,handlers:n.slice(_)}),s},addProp:function(e,n){Object.defineProperty(x.Event.prototype,e,{enumerable:!0,configurable:!0,get:g(n)?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(n){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:n})}})},fix:function(e){return e[x.expando]?e:new x.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var n=this||e;return xe.test(n.type)&&n.click&&T(n,"input")&&ke(n,"click",!0),!1},trigger:function(e){var n=this||e;return xe.test(n.type)&&n.click&&T(n,"input")&&ke(n,"click"),!0},_default:function(e){var n=e.target;return xe.test(n.type)&&n.click&&T(n,"input")&&se.get(n,"click")||T(n,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},x.removeEvent=function(e,n,t){e.removeEventListener&&e.removeEventListener(n,t)},x.Event=function(e,n){if(!(this instanceof x.Event))return new x.Event(e,n);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Se:Be,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,n&&x.extend(this,n),this.timeStamp=e&&e.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:Be,isPropagationStopped:Be,isImmediatePropagationStopped:Be,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Se,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Se,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Se,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},(function(e,n){function t(e){if(E.documentMode){var t=se.get(this,"handle"),r=x.event.fix(e);r.type="focusin"===e.type?"focus":"blur",r.isSimulated=!0,t(e),r.target===r.currentTarget&&t(r)}else x.event.simulate(n,e.target,x.event.fix(e))}x.event.special[e]={setup:function(){var r;if(ke(this,e,!0),!E.documentMode)return!1;(r=se.get(this,n))||this.addEventListener(n,t),se.set(this,n,(r||0)+1)},trigger:function(){return ke(this,e),!0},teardown:function(){var e;if(!E.documentMode)return!1;(e=se.get(this,n)-1)?se.set(this,n,e):(this.removeEventListener(n,t),se.remove(this,n))},_default:function(n){return se.get(n.target,e)},delegateType:n},x.event.special[n]={setup:function(){var r=this.ownerDocument||this.document||this,a=E.documentMode?this:r,i=se.get(a,n);i||(E.documentMode?this.addEventListener(n,t):r.addEventListener(e,t,!0)),se.set(a,n,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,a=E.documentMode?this:r,i=se.get(a,n)-1;i?se.set(a,n,i):(E.documentMode?this.removeEventListener(n,t):r.removeEventListener(e,t,!0),se.remove(a,n))}}})),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,n){x.event.special[e]={delegateType:n,bindType:n,handle:function(e){var t,r=e.relatedTarget,a=e.handleObj;return r&&(r===this||x.contains(this,r))||(e.type=a.origType,t=a.handler.apply(this,arguments),e.type=n),t}}})),x.fn.extend({on:function(e,n,t,r){return Ue(this,e,n,t,r)},one:function(e,n,t,r){return Ue(this,e,n,t,r,1)},off:function(e,n,t){var r,a;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(a in e)this.off(a,n,e[a]);return this}return!1!==n&&"function"!=typeof n||(t=n,n=void 0),!1===t&&(t=Be),this.each((function(){x.event.remove(this,e,t,n)}))}});var We=/<script|<style|<link/i,Ne=/checked\s*(?:[^=]|=\s*.checked.)/i,Ke=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Fe(e,n){return T(e,"table")&&T(11!==n.nodeType?n:n.firstChild,"tr")&&x(e).children("tbody")[0]||e}function je(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Ve(e,n){var t,r,a,i,o,s;if(1===n.nodeType){if(se.hasData(e)&&(s=se.get(e).events))for(a in se.remove(n,"handle events"),s)for(t=0,r=s[a].length;t<r;t++)x.event.add(n,a,s[a][t]);_e.hasData(e)&&(i=_e.access(e),o=x.extend({},i),_e.set(n,o))}}function Ge(e,n){var t=n.nodeName.toLowerCase();"input"===t&&xe.test(e.type)?n.checked=e.checked:"input"!==t&&"textarea"!==t||(n.defaultValue=e.defaultValue)}function ze(e,n,t,r){n=_(n);var a,i,o,s,u,l,c=0,h=e.length,d=h-1,f=n[0],p=g(f);if(p||h>1&&"string"==typeof f&&!m.checkClone&&Ne.test(f))return e.each((function(a){var i=e.eq(a);p&&(n[0]=f.call(this,a,i.html())),ze(i,n,t,r)}));if(h&&(i=(a=Ie(n,e[0].ownerDocument,!1,e,r)).firstChild,1===a.childNodes.length&&(a=i),i||r)){for(s=(o=x.map(Ce(a,"script"),je)).length;c<h;c++)u=a,c!==d&&(u=x.clone(u,!0,!0),s&&x.merge(o,Ce(u,"script"))),t.call(e[c],u,c);if(s)for(l=o[o.length-1].ownerDocument,x.map(o,qe),c=0;c<s;c++)u=o[c],Te.test(u.type||"")&&!se.access(u,"globalEval")&&x.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?x._evalUrl&&!u.noModule&&x._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):M(u.textContent.replace(Ke,""),u,l))}return e}function He(e,n,t){for(var r,a=n?x.filter(n,e):e,i=0;null!=(r=a[i]);i++)t||1!==r.nodeType||x.cleanData(Ce(r)),r.parentNode&&(t&&me(r)&&we(Ce(r,"script")),r.parentNode.removeChild(r));return e}x.extend({htmlPrefilter:function(e){return e},clone:function(e,n,t){var r,a,i,o,s=e.cloneNode(!0),_=me(e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=Ce(s),r=0,a=(i=Ce(e)).length;r<a;r++)Ge(i[r],o[r]);if(n)if(t)for(i=i||Ce(e),o=o||Ce(s),r=0,a=i.length;r<a;r++)Ve(i[r],o[r]);else Ve(e,s);return(o=Ce(s,"script")).length>0&&we(o,!_&&Ce(e,"script")),s},cleanData:function(e){for(var n,t,r,a=x.event.special,i=0;void 0!==(t=e[i]);i++)if(ie(t)){if(n=t[se.expando]){if(n.events)for(r in n.events)a[r]?x.event.remove(t,r):x.removeEvent(t,r,n.handle);t[se.expando]=void 0}t[_e.expando]&&(t[_e.expando]=void 0)}}}),x.fn.extend({detach:function(e){return He(this,e,!0)},remove:function(e){return He(this,e)},text:function(e){return ee(this,(function(e){return void 0===e?x.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return ze(this,arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Fe(this,e).appendChild(e)}))},prepend:function(){return ze(this,arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var n=Fe(this,e);n.insertBefore(e,n.firstChild)}}))},before:function(){return ze(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return ze(this,arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},empty:function(){for(var e,n=0;null!=(e=this[n]);n++)1===e.nodeType&&(x.cleanData(Ce(e,!1)),e.textContent="");return this},clone:function(e,n){return e=null!=e&&e,n=null==n?e:n,this.map((function(){return x.clone(this,e,n)}))},html:function(e){return ee(this,(function(e){var n=this[0]||{},t=0,r=this.length;if(void 0===e&&1===n.nodeType)return n.innerHTML;if("string"==typeof e&&!We.test(e)&&!Ae[(De.exec(e)||["",""])[1].toLowerCase()]){e=x.htmlPrefilter(e);try{for(;t<r;t++)1===(n=this[t]||{}).nodeType&&(x.cleanData(Ce(n,!1)),n.innerHTML=e);n=0}catch(e){}}n&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=[];return ze(this,arguments,(function(n){var t=this.parentNode;x.inArray(this,e)<0&&(x.cleanData(Ce(this)),t&&t.replaceChild(n,this))}),e)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,n){x.fn[e]=function(e){for(var t,r=[],a=x(e),i=a.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),x(a[o])[n](t),u.apply(r,t.get());return this.pushStack(r)}}));var Xe=new RegExp("^("+he+")(?!px)[a-z%]+$","i"),Ye=/^--/,Ze=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=r),n.getComputedStyle(e)},Qe=function(e,n,t){var r,a,i={};for(a in n)i[a]=e.style[a],e.style[a]=n[a];for(a in r=t.call(e),n)e.style[a]=i[a];return r},$e=new RegExp(fe.join("|"),"i");function Je(e,n,t){var r,a,i,o,s=Ye.test(n),_=e.style;return(t=t||Ze(e))&&(o=t.getPropertyValue(n)||t[n],s&&o&&(o=o.replace(I,"$1")||void 0),""!==o||me(e)||(o=x.style(e,n)),!m.pixelBoxStyles()&&Xe.test(o)&&$e.test(n)&&(r=_.width,a=_.minWidth,i=_.maxWidth,_.minWidth=_.maxWidth=_.width=o,o=t.width,_.width=r,_.minWidth=a,_.maxWidth=i)),void 0!==o?o+"":o}function en(e,n){return{get:function(){if(!e())return(this.get=n).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",pe.appendChild(u).appendChild(l);var e=r.getComputedStyle(l);t="1%"!==e.top,_=12===n(e.marginLeft),l.style.right="60%",o=36===n(e.right),a=36===n(e.width),l.style.position="absolute",i=12===n(l.offsetWidth/3),pe.removeChild(u),l=null}}function n(e){return Math.round(parseFloat(e))}var t,a,i,o,s,_,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===l.style.backgroundClip,x.extend(m,{boxSizingReliable:function(){return e(),a},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),t},reliableMarginLeft:function(){return e(),_},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,n,t,a;return null==s&&(e=E.createElement("table"),n=E.createElement("tr"),t=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",n.style.cssText="box-sizing:content-box;border:1px solid",n.style.height="1px",t.style.height="9px",t.style.display="block",pe.appendChild(e).appendChild(n).appendChild(t),a=r.getComputedStyle(n),s=parseInt(a.height,10)+parseInt(a.borderTopWidth,10)+parseInt(a.borderBottomWidth,10)===n.offsetHeight,pe.removeChild(e)),s}}))}();var nn=["Webkit","Moz","ms"],tn=E.createElement("div").style,rn={};function an(e){var n=x.cssProps[e]||rn[e];return n||(e in tn?e:rn[e]=function(e){for(var n=e[0].toUpperCase()+e.slice(1),t=nn.length;t--;)if((e=nn[t]+n)in tn)return e}(e)||e)}var on=/^(none|table(?!-c[ea]).+)/,sn={position:"absolute",visibility:"hidden",display:"block"},_n={letterSpacing:"0",fontWeight:"400"};function un(e,n,t){var r=de.exec(n);return r?Math.max(0,r[2]-(t||0))+(r[3]||"px"):n}function ln(e,n,t,r,a,i){var o="width"===n?1:0,s=0,_=0,u=0;if(t===(r?"border":"content"))return 0;for(;o<4;o+=2)"margin"===t&&(u+=x.css(e,t+fe[o],!0,a)),r?("content"===t&&(_-=x.css(e,"padding"+fe[o],!0,a)),"margin"!==t&&(_-=x.css(e,"border"+fe[o]+"Width",!0,a))):(_+=x.css(e,"padding"+fe[o],!0,a),"padding"!==t?_+=x.css(e,"border"+fe[o]+"Width",!0,a):s+=x.css(e,"border"+fe[o]+"Width",!0,a));return!r&&i>=0&&(_+=Math.max(0,Math.ceil(e["offset"+n[0].toUpperCase()+n.slice(1)]-i-_-s-.5))||0),_+u}function cn(e,n,t){var r=Ze(e),a=(!m.boxSizingReliable()||t)&&"border-box"===x.css(e,"boxSizing",!1,r),i=a,o=Je(e,n,r),s="offset"+n[0].toUpperCase()+n.slice(1);if(Xe.test(o)){if(!t)return o;o="auto"}return(!m.boxSizingReliable()&&a||!m.reliableTrDimensions()&&T(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===x.css(e,"display",!1,r))&&e.getClientRects().length&&(a="border-box"===x.css(e,"boxSizing",!1,r),(i=s in e)&&(o=e[s])),(o=parseFloat(o)||0)+ln(e,n,t||(a?"border":"content"),i,r,o)+"px"}function hn(e,n,t,r,a){return new hn.prototype.init(e,n,t,r,a)}x.extend({cssHooks:{opacity:{get:function(e,n){if(n){var t=Je(e,"opacity");return""===t?"1":t}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,n,t,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,i,o,s=ae(n),_=Ye.test(n),u=e.style;if(_||(n=an(s)),o=x.cssHooks[n]||x.cssHooks[s],void 0===t)return o&&"get"in o&&void 0!==(a=o.get(e,!1,r))?a:u[n];"string"===(i=typeof t)&&(a=de.exec(t))&&a[1]&&(t=Ee(e,n,a),i="number"),null!=t&&t==t&&("number"!==i||_||(t+=a&&a[3]||(x.cssNumber[s]?"":"px")),m.clearCloneStyle||""!==t||0!==n.indexOf("background")||(u[n]="inherit"),o&&"set"in o&&void 0===(t=o.set(e,t,r))||(_?u.setProperty(n,t):u[n]=t))}},css:function(e,n,t,r){var a,i,o,s=ae(n);return Ye.test(n)||(n=an(s)),(o=x.cssHooks[n]||x.cssHooks[s])&&"get"in o&&(a=o.get(e,!0,t)),void 0===a&&(a=Je(e,n,r)),"normal"===a&&n in _n&&(a=_n[n]),""===t||t?(i=parseFloat(a),!0===t||isFinite(i)?i||0:a):a}}),x.each(["height","width"],(function(e,n){x.cssHooks[n]={get:function(e,t,r){if(t)return!on.test(x.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?cn(e,n,r):Qe(e,sn,(function(){return cn(e,n,r)}))},set:function(e,t,r){var a,i=Ze(e),o=!m.scrollboxSize()&&"absolute"===i.position,s=(o||r)&&"border-box"===x.css(e,"boxSizing",!1,i),_=r?ln(e,n,r,s,i):0;return s&&o&&(_-=Math.ceil(e["offset"+n[0].toUpperCase()+n.slice(1)]-parseFloat(i[n])-ln(e,n,"border",!1,i)-.5)),_&&(a=de.exec(t))&&"px"!==(a[3]||"px")&&(e.style[n]=t,t=x.css(e,n)),un(0,t,_)}}})),x.cssHooks.marginLeft=en(m.reliableMarginLeft,(function(e,n){if(n)return(parseFloat(Je(e,"marginLeft"))||e.getBoundingClientRect().left-Qe(e,{marginLeft:0},(function(){return e.getBoundingClientRect().left})))+"px"})),x.each({margin:"",padding:"",border:"Width"},(function(e,n){x.cssHooks[e+n]={expand:function(t){for(var r=0,a={},i="string"==typeof t?t.split(" "):[t];r<4;r++)a[e+fe[r]+n]=i[r]||i[r-2]||i[0];return a}},"margin"!==e&&(x.cssHooks[e+n].set=un)})),x.fn.extend({css:function(e,n){return ee(this,(function(e,n,t){var r,a,i={},o=0;if(Array.isArray(n)){for(r=Ze(e),a=n.length;o<a;o++)i[n[o]]=x.css(e,n[o],!1,r);return i}return void 0!==t?x.style(e,n,t):x.css(e,n)}),e,n,arguments.length>1)}}),x.Tween=hn,hn.prototype={constructor:hn,init:function(e,n,t,r,a,i){this.elem=e,this.prop=t,this.easing=a||x.easing._default,this.options=n,this.start=this.now=this.cur(),this.end=r,this.unit=i||(x.cssNumber[t]?"":"px")},cur:function(){var e=hn.propHooks[this.prop];return e&&e.get?e.get(this):hn.propHooks._default.get(this)},run:function(e){var n,t=hn.propHooks[this.prop];return this.options.duration?this.pos=n=x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=n=e,this.now=(this.end-this.start)*n+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),t&&t.set?t.set(this):hn.propHooks._default.set(this),this}},hn.prototype.init.prototype=hn.prototype,hn.propHooks={_default:{get:function(e){var n;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(n=x.css(e.elem,e.prop,""))&&"auto"!==n?n:0},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):1!==e.elem.nodeType||!x.cssHooks[e.prop]&&null==e.elem.style[an(e.prop)]?e.elem[e.prop]=e.now:x.style(e.elem,e.prop,e.now+e.unit)}}},hn.propHooks.scrollTop=hn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},x.fx=hn.prototype.init,x.fx.step={};var dn,fn,pn=/^(?:toggle|show|hide)$/,mn=/queueHooks$/;function gn(){fn&&(!1===E.hidden&&r.requestAnimationFrame?r.requestAnimationFrame(gn):r.setTimeout(gn,x.fx.interval),x.fx.tick())}function vn(){return r.setTimeout((function(){dn=void 0})),dn=Date.now()}function En(e,n){var t,r=0,a={height:e};for(n=n?1:0;r<4;r+=2-n)a["margin"+(t=fe[r])]=a["padding"+t]=e;return n&&(a.opacity=a.width=e),a}function bn(e,n,t){for(var r,a=(Mn.tweeners[n]||[]).concat(Mn.tweeners["*"]),i=0,o=a.length;i<o;i++)if(r=a[i].call(t,n,e))return r}function Mn(e,n,t){var r,a,i=0,o=Mn.prefilters.length,s=x.Deferred().always((function(){delete _.elem})),_=function(){if(a)return!1;for(var n=dn||vn(),t=Math.max(0,u.startTime+u.duration-n),r=1-(t/u.duration||0),i=0,o=u.tweens.length;i<o;i++)u.tweens[i].run(r);return s.notifyWith(e,[u,r,t]),r<1&&o?t:(o||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:x.extend({},n),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},t),originalProperties:n,originalOptions:t,startTime:dn||vn(),duration:t.duration,tweens:[],createTween:function(n,t){var r=x.Tween(e,u.opts,n,t,u.opts.specialEasing[n]||u.opts.easing);return u.tweens.push(r),r},stop:function(n){var t=0,r=n?u.tweens.length:0;if(a)return this;for(a=!0;t<r;t++)u.tweens[t].run(1);return n?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,n])):s.rejectWith(e,[u,n]),this}}),l=u.props;for(!function(e,n){var t,r,a,i,o;for(t in e)if(a=n[r=ae(t)],i=e[t],Array.isArray(i)&&(a=i[1],i=e[t]=i[0]),t!==r&&(e[r]=i,delete e[t]),(o=x.cssHooks[r])&&"expand"in o)for(t in i=o.expand(i),delete e[r],i)t in e||(e[t]=i[t],n[t]=a);else n[r]=a}(l,u.opts.specialEasing);i<o;i++)if(r=Mn.prefilters[i].call(u,e,l,u.opts))return g(r.stop)&&(x._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return x.map(l,bn,u),g(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),x.fx.timer(x.extend(_,{elem:e,anim:u,queue:u.opts.queue})),u}x.Animation=x.extend(Mn,{tweeners:{"*":[function(e,n){var t=this.createTween(e,n);return Ee(t.elem,e,de.exec(n),t),t}]},tweener:function(e,n){g(e)?(n=e,e=["*"]):e=e.match(H);for(var t,r=0,a=e.length;r<a;r++)t=e[r],Mn.tweeners[t]=Mn.tweeners[t]||[],Mn.tweeners[t].unshift(n)},prefilters:[function(e,n,t){var r,a,i,o,s,_,u,l,c="width"in n||"height"in n,h=this,d={},f=e.style,p=e.nodeType&&ve(e),m=se.get(e,"fxshow");for(r in t.queue||(null==(o=x._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,s=o.empty.fire,o.empty.fire=function(){o.unqueued||s()}),o.unqueued++,h.always((function(){h.always((function(){o.unqueued--,x.queue(e,"fx").length||o.empty.fire()}))}))),n)if(a=n[r],pn.test(a)){if(delete n[r],i=i||"toggle"===a,a===(p?"hide":"show")){if("show"!==a||!m||void 0===m[r])continue;p=!0}d[r]=m&&m[r]||x.style(e,r)}if((_=!x.isEmptyObject(n))||!x.isEmptyObject(d))for(r in c&&1===e.nodeType&&(t.overflow=[f.overflow,f.overflowX,f.overflowY],null==(u=m&&m.display)&&(u=se.get(e,"display")),"none"===(l=x.css(e,"display"))&&(u?l=u:(ye([e],!0),u=e.style.display||u,l=x.css(e,"display"),ye([e]))),("inline"===l||"inline-block"===l&&null!=u)&&"none"===x.css(e,"float")&&(_||(h.done((function(){f.display=u})),null==u&&(l=f.display,u="none"===l?"":l)),f.display="inline-block")),t.overflow&&(f.overflow="hidden",h.always((function(){f.overflow=t.overflow[0],f.overflowX=t.overflow[1],f.overflowY=t.overflow[2]}))),_=!1,d)_||(m?"hidden"in m&&(p=m.hidden):m=se.access(e,"fxshow",{display:u}),i&&(m.hidden=!p),p&&ye([e],!0),h.done((function(){for(r in p||ye([e]),se.remove(e,"fxshow"),d)x.style(e,r,d[r])}))),_=bn(p?m[r]:0,r,h),r in m||(m[r]=_.start,p&&(_.end=_.start,_.start=0))}],prefilter:function(e,n){n?Mn.prefilters.unshift(e):Mn.prefilters.push(e)}}),x.speed=function(e,n,t){var r=e&&"object"==typeof e?x.extend({},e):{complete:t||!t&&n||g(e)&&e,duration:e,easing:t&&n||n&&!g(n)&&n};return x.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in x.fx.speeds?r.duration=x.fx.speeds[r.duration]:r.duration=x.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.fn.extend({fadeTo:function(e,n,t,r){return this.filter(ve).css("opacity",0).show().end().animate({opacity:n},e,t,r)},animate:function(e,n,t,r){var a=x.isEmptyObject(e),i=x.speed(n,t,r),o=function(){var n=Mn(this,x.extend({},e),i);(a||se.get(this,"finish"))&&n.stop(!0)};return o.finish=o,a||!1===i.queue?this.each(o):this.queue(i.queue,o)},stop:function(e,n,t){var r=function(e){var n=e.stop;delete e.stop,n(t)};return"string"!=typeof e&&(t=n,n=e,e=void 0),n&&this.queue(e||"fx",[]),this.each((function(){var n=!0,a=null!=e&&e+"queueHooks",i=x.timers,o=se.get(this);if(a)o[a]&&o[a].stop&&r(o[a]);else for(a in o)o[a]&&o[a].stop&&mn.test(a)&&r(o[a]);for(a=i.length;a--;)i[a].elem!==this||null!=e&&i[a].queue!==e||(i[a].anim.stop(t),n=!1,i.splice(a,1));!n&&t||x.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var n,t=se.get(this),r=t[e+"queue"],a=t[e+"queueHooks"],i=x.timers,o=r?r.length:0;for(t.finish=!0,x.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),n=i.length;n--;)i[n].elem===this&&i[n].queue===e&&(i[n].anim.stop(!0),i.splice(n,1));for(n=0;n<o;n++)r[n]&&r[n].finish&&r[n].finish.call(this);delete t.finish}))}}),x.each(["toggle","show","hide"],(function(e,n){var t=x.fn[n];x.fn[n]=function(e,r,a){return null==e||"boolean"==typeof e?t.apply(this,arguments):this.animate(En(n,!0),e,r,a)}})),x.each({slideDown:En("show"),slideUp:En("hide"),slideToggle:En("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,n){x.fn[e]=function(e,t,r){return this.animate(n,e,t,r)}})),x.timers=[],x.fx.tick=function(){var e,n=0,t=x.timers;for(dn=Date.now();n<t.length;n++)(e=t[n])()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),dn=void 0},x.fx.timer=function(e){x.timers.push(e),x.fx.start()},x.fx.interval=13,x.fx.start=function(){fn||(fn=!0,gn())},x.fx.stop=function(){fn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(e,n){return e=x.fx&&x.fx.speeds[e]||e,n=n||"fx",this.queue(n,(function(n,t){var a=r.setTimeout(n,e);t.stop=function(){r.clearTimeout(a)}}))},function(){var e=E.createElement("input"),n=E.createElement("select").appendChild(E.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=n.selected,(e=E.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var yn,On=x.expr.attrHandle;x.fn.extend({attr:function(e,n){return ee(this,x.attr,e,n,arguments.length>1)},removeAttr:function(e){return this.each((function(){x.removeAttr(this,e)}))}}),x.extend({attr:function(e,n,t){var r,a,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?x.prop(e,n,t):(1===i&&x.isXMLDoc(e)||(a=x.attrHooks[n.toLowerCase()]||(x.expr.match.bool.test(n)?yn:void 0)),void 0!==t?null===t?void x.removeAttr(e,n):a&&"set"in a&&void 0!==(r=a.set(e,t,n))?r:(e.setAttribute(n,t+""),t):a&&"get"in a&&null!==(r=a.get(e,n))?r:null==(r=x.find.attr(e,n))?void 0:r)},attrHooks:{type:{set:function(e,n){if(!m.radioValue&&"radio"===n&&T(e,"input")){var t=e.value;return e.setAttribute("type",n),t&&(e.value=t),n}}}},removeAttr:function(e,n){var t,r=0,a=n&&n.match(H);if(a&&1===e.nodeType)for(;t=a[r++];)e.removeAttribute(t)}}),yn={set:function(e,n,t){return!1===n?x.removeAttr(e,t):e.setAttribute(t,t),t}},x.each(x.expr.match.bool.source.match(/\w+/g),(function(e,n){var t=On[n]||x.find.attr;On[n]=function(e,n,r){var a,i,o=n.toLowerCase();return r||(i=On[o],On[o]=a,a=null!=t(e,n,r)?o:null,On[o]=i),a}}));var Pn=/^(?:input|select|textarea|button)$/i,xn=/^(?:a|area)$/i;function Dn(e){return(e.match(H)||[]).join(" ")}function Tn(e){return e.getAttribute&&e.getAttribute("class")||""}function An(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(H)||[]}x.fn.extend({prop:function(e,n){return ee(this,x.prop,e,n,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[x.propFix[e]||e]}))}}),x.extend({prop:function(e,n,t){var r,a,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&x.isXMLDoc(e)||(n=x.propFix[n]||n,a=x.propHooks[n]),void 0!==t?a&&"set"in a&&void 0!==(r=a.set(e,t,n))?r:e[n]=t:a&&"get"in a&&null!==(r=a.get(e,n))?r:e[n]},propHooks:{tabIndex:{get:function(e){var n=x.find.attr(e,"tabindex");return n?parseInt(n,10):Pn.test(e.nodeName)||xn.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(x.propHooks.selected={get:function(e){var n=e.parentNode;return n&&n.parentNode&&n.parentNode.selectedIndex,null},set:function(e){var n=e.parentNode;n&&(n.selectedIndex,n.parentNode&&n.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){x.propFix[this.toLowerCase()]=this})),x.fn.extend({addClass:function(e){var n,t,r,a,i,o;return g(e)?this.each((function(n){x(this).addClass(e.call(this,n,Tn(this)))})):(n=An(e)).length?this.each((function(){if(r=Tn(this),t=1===this.nodeType&&" "+Dn(r)+" "){for(i=0;i<n.length;i++)a=n[i],t.indexOf(" "+a+" ")<0&&(t+=a+" ");o=Dn(t),r!==o&&this.setAttribute("class",o)}})):this},removeClass:function(e){var n,t,r,a,i,o;return g(e)?this.each((function(n){x(this).removeClass(e.call(this,n,Tn(this)))})):arguments.length?(n=An(e)).length?this.each((function(){if(r=Tn(this),t=1===this.nodeType&&" "+Dn(r)+" "){for(i=0;i<n.length;i++)for(a=n[i];t.indexOf(" "+a+" ")>-1;)t=t.replace(" "+a+" "," ");o=Dn(t),r!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(e,n){var t,r,a,i,o=typeof e,s="string"===o||Array.isArray(e);return g(e)?this.each((function(t){x(this).toggleClass(e.call(this,t,Tn(this),n),n)})):"boolean"==typeof n&&s?n?this.addClass(e):this.removeClass(e):(t=An(e),this.each((function(){if(s)for(i=x(this),a=0;a<t.length;a++)r=t[a],i.hasClass(r)?i.removeClass(r):i.addClass(r);else void 0!==e&&"boolean"!==o||((r=Tn(this))&&se.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===e?"":se.get(this,"__className__")||""))})))},hasClass:function(e){var n,t,r=0;for(n=" "+e+" ";t=this[r++];)if(1===t.nodeType&&(" "+Dn(Tn(t))+" ").indexOf(n)>-1)return!0;return!1}});var Cn=/\r/g;x.fn.extend({val:function(e){var n,t,r,a=this[0];return arguments.length?(r=g(e),this.each((function(t){var a;1===this.nodeType&&(null==(a=r?e.call(this,t,x(this).val()):e)?a="":"number"==typeof a?a+="":Array.isArray(a)&&(a=x.map(a,(function(e){return null==e?"":e+""}))),(n=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,a,"value")||(this.value=a))}))):a?(n=x.valHooks[a.type]||x.valHooks[a.nodeName.toLowerCase()])&&"get"in n&&void 0!==(t=n.get(a,"value"))?t:"string"==typeof(t=a.value)?t.replace(Cn,""):null==t?"":t:void 0}}),x.extend({valHooks:{option:{get:function(e){var n=x.find.attr(e,"value");return null!=n?n:Dn(x.text(e))}},select:{get:function(e){var n,t,r,a=e.options,i=e.selectedIndex,o="select-one"===e.type,s=o?null:[],_=o?i+1:a.length;for(r=i<0?_:o?i:0;r<_;r++)if(((t=a[r]).selected||r===i)&&!t.disabled&&(!t.parentNode.disabled||!T(t.parentNode,"optgroup"))){if(n=x(t).val(),o)return n;s.push(n)}return s},set:function(e,n){for(var t,r,a=e.options,i=x.makeArray(n),o=a.length;o--;)((r=a[o]).selected=x.inArray(x.valHooks.option.get(r),i)>-1)&&(t=!0);return t||(e.selectedIndex=-1),i}}}}),x.each(["radio","checkbox"],(function(){x.valHooks[this]={set:function(e,n){if(Array.isArray(n))return e.checked=x.inArray(x(e).val(),n)>-1}},m.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}));var wn=r.location,Rn={guid:Date.now()},In=/\?/;x.parseXML=function(e){var n,t;if(!e||"string"!=typeof e)return null;try{n=(new r.DOMParser).parseFromString(e,"text/xml")}catch(e){}return t=n&&n.getElementsByTagName("parsererror")[0],n&&!t||x.error("Invalid XML: "+(t?x.map(t.childNodes,(function(e){return e.textContent})).join("\n"):e)),n};var Ln=/^(?:focusinfocus|focusoutblur)$/,Sn=function(e){e.stopPropagation()};x.extend(x.event,{trigger:function(e,n,t,a){var i,o,s,_,u,l,c,h,f=[t||E],p=d.call(e,"type")?e.type:e,m=d.call(e,"namespace")?e.namespace.split("."):[];if(o=h=s=t=t||E,3!==t.nodeType&&8!==t.nodeType&&!Ln.test(p+x.event.triggered)&&(p.indexOf(".")>-1&&(m=p.split("."),p=m.shift(),m.sort()),u=p.indexOf(":")<0&&"on"+p,(e=e[x.expando]?e:new x.Event(p,"object"==typeof e&&e)).isTrigger=a?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=t),n=null==n?[e]:x.makeArray(n,[e]),c=x.event.special[p]||{},a||!c.trigger||!1!==c.trigger.apply(t,n))){if(!a&&!c.noBubble&&!v(t)){for(_=c.delegateType||p,Ln.test(_+p)||(o=o.parentNode);o;o=o.parentNode)f.push(o),s=o;s===(t.ownerDocument||E)&&f.push(s.defaultView||s.parentWindow||r)}for(i=0;(o=f[i++])&&!e.isPropagationStopped();)h=o,e.type=i>1?_:c.bindType||p,(l=(se.get(o,"events")||Object.create(null))[e.type]&&se.get(o,"handle"))&&l.apply(o,n),(l=u&&o[u])&&l.apply&&ie(o)&&(e.result=l.apply(o,n),!1===e.result&&e.preventDefault());return e.type=p,a||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(f.pop(),n)||!ie(t)||u&&g(t[p])&&!v(t)&&((s=t[u])&&(t[u]=null),x.event.triggered=p,e.isPropagationStopped()&&h.addEventListener(p,Sn),t[p](),e.isPropagationStopped()&&h.removeEventListener(p,Sn),x.event.triggered=void 0,s&&(t[u]=s)),e.result}},simulate:function(e,n,t){var r=x.extend(new x.Event,t,{type:e,isSimulated:!0});x.event.trigger(r,null,n)}}),x.fn.extend({trigger:function(e,n){return this.each((function(){x.event.trigger(e,n,this)}))},triggerHandler:function(e,n){var t=this[0];if(t)return x.event.trigger(e,n,t,!0)}});var Bn=/\[\]$/,Un=/\r?\n/g,kn=/^(?:submit|button|image|reset|file)$/i,Wn=/^(?:input|select|textarea|keygen)/i;function Nn(e,n,t,r){var a;if(Array.isArray(n))x.each(n,(function(n,a){t||Bn.test(e)?r(e,a):Nn(e+"["+("object"==typeof a&&null!=a?n:"")+"]",a,t,r)}));else if(t||"object"!==y(n))r(e,n);else for(a in n)Nn(e+"["+a+"]",n[a],t,r)}x.param=function(e,n){var t,r=[],a=function(e,n){var t=g(n)?n():n;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==t?"":t)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,(function(){a(this.name,this.value)}));else for(t in e)Nn(t,e[t],n,a);return r.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&Wn.test(this.nodeName)&&!kn.test(e)&&(this.checked||!xe.test(e))})).map((function(e,n){var t=x(this).val();return null==t?null:Array.isArray(t)?x.map(t,(function(e){return{name:n.name,value:e.replace(Un,"\r\n")}})):{name:n.name,value:t.replace(Un,"\r\n")}})).get()}});var Kn=/%20/g,Fn=/#.*$/,jn=/([?&])_=[^&]*/,qn=/^(.*?):[ \t]*([^\r\n]*)$/gm,Vn=/^(?:GET|HEAD)$/,Gn=/^\/\//,zn={},Hn={},Xn="*/".concat("*"),Yn=E.createElement("a");function Zn(e){return function(n,t){"string"!=typeof n&&(t=n,n="*");var r,a=0,i=n.toLowerCase().match(H)||[];if(g(t))for(;r=i[a++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(t)):(e[r]=e[r]||[]).push(t)}}function Qn(e,n,t,r){var a={},i=e===Hn;function o(s){var _;return a[s]=!0,x.each(e[s]||[],(function(e,s){var u=s(n,t,r);return"string"!=typeof u||i||a[u]?i?!(_=u):void 0:(n.dataTypes.unshift(u),o(u),!1)})),_}return o(n.dataTypes[0])||!a["*"]&&o("*")}function $n(e,n){var t,r,a=x.ajaxSettings.flatOptions||{};for(t in n)void 0!==n[t]&&((a[t]?e:r||(r={}))[t]=n[t]);return r&&x.extend(!0,e,r),e}Yn.href=wn.href,x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wn.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(wn.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,n){return n?$n($n(e,x.ajaxSettings),n):$n(x.ajaxSettings,e)},ajaxPrefilter:Zn(zn),ajaxTransport:Zn(Hn),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0),n=n||{};var t,a,i,o,s,_,u,l,c,h,d=x.ajaxSetup({},n),f=d.context||d,p=d.context&&(f.nodeType||f.jquery)?x(f):x.event,m=x.Deferred(),g=x.Callbacks("once memory"),v=d.statusCode||{},b={},M={},y="canceled",O={readyState:0,getResponseHeader:function(e){var n;if(u){if(!o)for(o={};n=qn.exec(i);)o[n[1].toLowerCase()+" "]=(o[n[1].toLowerCase()+" "]||[]).concat(n[2]);n=o[e.toLowerCase()+" "]}return null==n?null:n.join(", ")},getAllResponseHeaders:function(){return u?i:null},setRequestHeader:function(e,n){return null==u&&(e=M[e.toLowerCase()]=M[e.toLowerCase()]||e,b[e]=n),this},overrideMimeType:function(e){return null==u&&(d.mimeType=e),this},statusCode:function(e){var n;if(e)if(u)O.always(e[O.status]);else for(n in e)v[n]=[v[n],e[n]];return this},abort:function(e){var n=e||y;return t&&t.abort(n),P(0,n),this}};if(m.promise(O),d.url=((e||d.url||wn.href)+"").replace(Gn,wn.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(H)||[""],null==d.crossDomain){_=E.createElement("a");try{_.href=d.url,_.href=_.href,d.crossDomain=Yn.protocol+"//"+Yn.host!=_.protocol+"//"+_.host}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=x.param(d.data,d.traditional)),Qn(zn,d,n,O),u)return O;for(c in(l=x.event&&d.global)&&0==x.active++&&x.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Vn.test(d.type),a=d.url.replace(Fn,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Kn,"+")):(h=d.url.slice(a.length),d.data&&(d.processData||"string"==typeof d.data)&&(a+=(In.test(a)?"&":"?")+d.data,delete d.data),!1===d.cache&&(a=a.replace(jn,"$1"),h=(In.test(a)?"&":"?")+"_="+Rn.guid+++h),d.url=a+h),d.ifModified&&(x.lastModified[a]&&O.setRequestHeader("If-Modified-Since",x.lastModified[a]),x.etag[a]&&O.setRequestHeader("If-None-Match",x.etag[a])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&O.setRequestHeader("Content-Type",d.contentType),O.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Xn+"; q=0.01":""):d.accepts["*"]),d.headers)O.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(!1===d.beforeSend.call(f,O,d)||u))return O.abort();if(y="abort",g.add(d.complete),O.done(d.success),O.fail(d.error),t=Qn(Hn,d,n,O)){if(O.readyState=1,l&&p.trigger("ajaxSend",[O,d]),u)return O;d.async&&d.timeout>0&&(s=r.setTimeout((function(){O.abort("timeout")}),d.timeout));try{u=!1,t.send(b,P)}catch(e){if(u)throw e;P(-1,e)}}else P(-1,"No Transport");function P(e,n,o,_){var c,h,E,b,M,y=n;u||(u=!0,s&&r.clearTimeout(s),t=void 0,i=_||"",O.readyState=e>0?4:0,c=e>=200&&e<300||304===e,o&&(b=function(e,n,t){for(var r,a,i,o,s=e.contents,_=e.dataTypes;"*"===_[0];)_.shift(),void 0===r&&(r=e.mimeType||n.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){_.unshift(a);break}if(_[0]in t)i=_[0];else{for(a in t){if(!_[0]||e.converters[a+" "+_[0]]){i=a;break}o||(o=a)}i=i||o}if(i)return i!==_[0]&&_.unshift(i),t[i]}(d,O,o)),!c&&x.inArray("script",d.dataTypes)>-1&&x.inArray("json",d.dataTypes)<0&&(d.converters["text script"]=function(){}),b=function(e,n,t,r){var a,i,o,s,_,u={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(i=l.shift();i;)if(e.responseFields[i]&&(t[e.responseFields[i]]=n),!_&&r&&e.dataFilter&&(n=e.dataFilter(n,e.dataType)),_=i,i=l.shift())if("*"===i)i=_;else if("*"!==_&&_!==i){if(!(o=u[_+" "+i]||u["* "+i]))for(a in u)if((s=a.split(" "))[1]===i&&(o=u[_+" "+s[0]]||u["* "+s[0]])){!0===o?o=u[a]:!0!==u[a]&&(i=s[0],l.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)n=o(n);else try{n=o(n)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+_+" to "+i}}}return{state:"success",data:n}}(d,b,O,c),c?(d.ifModified&&((M=O.getResponseHeader("Last-Modified"))&&(x.lastModified[a]=M),(M=O.getResponseHeader("etag"))&&(x.etag[a]=M)),204===e||"HEAD"===d.type?y="nocontent":304===e?y="notmodified":(y=b.state,h=b.data,c=!(E=b.error))):(E=y,!e&&y||(y="error",e<0&&(e=0))),O.status=e,O.statusText=(n||y)+"",c?m.resolveWith(f,[h,y,O]):m.rejectWith(f,[O,y,E]),O.statusCode(v),v=void 0,l&&p.trigger(c?"ajaxSuccess":"ajaxError",[O,d,c?h:E]),g.fireWith(f,[O,y]),l&&(p.trigger("ajaxComplete",[O,d]),--x.active||x.event.trigger("ajaxStop")))}return O},getJSON:function(e,n,t){return x.get(e,n,t,"json")},getScript:function(e,n){return x.get(e,void 0,n,"script")}}),x.each(["get","post"],(function(e,n){x[n]=function(e,t,r,a){return g(t)&&(a=a||r,r=t,t=void 0),x.ajax(x.extend({url:e,type:n,dataType:a,data:t,success:r},x.isPlainObject(e)&&e))}})),x.ajaxPrefilter((function(e){var n;for(n in e.headers)"content-type"===n.toLowerCase()&&(e.contentType=e.headers[n]||"")})),x._evalUrl=function(e,n,t){return x.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){x.globalEval(e,n,t)}})},x.fn.extend({wrapAll:function(e){var n;return this[0]&&(g(e)&&(e=e.call(this[0])),n=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&n.insertBefore(this[0]),n.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this},wrapInner:function(e){return g(e)?this.each((function(n){x(this).wrapInner(e.call(this,n))})):this.each((function(){var n=x(this),t=n.contents();t.length?t.wrapAll(e):n.append(e)}))},wrap:function(e){var n=g(e);return this.each((function(t){x(this).wrapAll(n?e.call(this,t):e)}))},unwrap:function(e){return this.parent(e).not("body").each((function(){x(this).replaceWith(this.childNodes)})),this}}),x.expr.pseudos.hidden=function(e){return!x.expr.pseudos.visible(e)},x.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new r.XMLHttpRequest}catch(e){}};var Jn={0:200,1223:204},et=x.ajaxSettings.xhr();m.cors=!!et&&"withCredentials"in et,m.ajax=et=!!et,x.ajaxTransport((function(e){var n,t;if(m.cors||et&&!e.crossDomain)return{send:function(a,i){var o,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)s[o]=e.xhrFields[o];for(o in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest"),a)s.setRequestHeader(o,a[o]);n=function(e){return function(){n&&(n=t=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?i(0,"error"):i(s.status,s.statusText):i(Jn[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),t=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=t:s.onreadystatechange=function(){4===s.readyState&&r.setTimeout((function(){n&&t()}))},n=n("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}})),x.ajaxPrefilter((function(e){e.crossDomain&&(e.contents.script=!1)})),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),x.ajaxTransport("script",(function(e){var n,t;if(e.crossDomain||e.scriptAttrs)return{send:function(r,a){n=x("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",t=function(e){n.remove(),t=null,e&&a("error"===e.type?404:200,e.type)}),E.head.appendChild(n[0])},abort:function(){t&&t()}}}));var nt,tt=[],rt=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=tt.pop()||x.expando+"_"+Rn.guid++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",(function(e,n,t){var a,i,o,s=!1!==e.jsonp&&(rt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rt.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return a=e.jsonpCallback=g(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(rt,"$1"+a):!1!==e.jsonp&&(e.url+=(In.test(e.url)?"&":"?")+e.jsonp+"="+a),e.converters["script json"]=function(){return o||x.error(a+" was not called"),o[0]},e.dataTypes[0]="json",i=r[a],r[a]=function(){o=arguments},t.always((function(){void 0===i?x(r).removeProp(a):r[a]=i,e[a]&&(e.jsonpCallback=n.jsonpCallback,tt.push(a)),o&&g(i)&&i(o[0]),o=i=void 0})),"script"})),m.createHTMLDocument=((nt=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===nt.childNodes.length),x.parseHTML=function(e,n,t){return"string"!=typeof e?[]:("boolean"==typeof n&&(t=n,n=!1),n||(m.createHTMLDocument?((r=(n=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,n.head.appendChild(r)):n=E),i=!t&&[],(a=K.exec(e))?[n.createElement(a[1])]:(a=Ie([e],n,i),i&&i.length&&x(i).remove(),x.merge([],a.childNodes)));var r,a,i},x.fn.load=function(e,n,t){var r,a,i,o=this,s=e.indexOf(" ");return s>-1&&(r=Dn(e.slice(s)),e=e.slice(0,s)),g(n)?(t=n,n=void 0):n&&"object"==typeof n&&(a="POST"),o.length>0&&x.ajax({url:e,type:a||"GET",dataType:"html",data:n}).done((function(e){i=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)})).always(t&&function(e,n){o.each((function(){t.apply(this,i||[e.responseText,n,e])}))}),this},x.expr.pseudos.animated=function(e){return x.grep(x.timers,(function(n){return e===n.elem})).length},x.offset={setOffset:function(e,n,t){var r,a,i,o,s,_,u=x.css(e,"position"),l=x(e),c={};"static"===u&&(e.style.position="relative"),s=l.offset(),i=x.css(e,"top"),_=x.css(e,"left"),("absolute"===u||"fixed"===u)&&(i+_).indexOf("auto")>-1?(o=(r=l.position()).top,a=r.left):(o=parseFloat(i)||0,a=parseFloat(_)||0),g(n)&&(n=n.call(e,t,x.extend({},s))),null!=n.top&&(c.top=n.top-s.top+o),null!=n.left&&(c.left=n.left-s.left+a),"using"in n?n.using.call(e,c):l.css(c)}},x.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(n){x.offset.setOffset(this,e,n)}));var n,t,r=this[0];return r?r.getClientRects().length?(n=r.getBoundingClientRect(),t=r.ownerDocument.defaultView,{top:n.top+t.pageYOffset,left:n.left+t.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,n,t,r=this[0],a={top:0,left:0};if("fixed"===x.css(r,"position"))n=r.getBoundingClientRect();else{for(n=this.offset(),t=r.ownerDocument,e=r.offsetParent||t.documentElement;e&&(e===t.body||e===t.documentElement)&&"static"===x.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((a=x(e).offset()).top+=x.css(e,"borderTopWidth",!0),a.left+=x.css(e,"borderLeftWidth",!0))}return{top:n.top-a.top-x.css(r,"marginTop",!0),left:n.left-a.left-x.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent;e&&"static"===x.css(e,"position");)e=e.offsetParent;return e||pe}))}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,n){var t="pageYOffset"===n;x.fn[e]=function(r){return ee(this,(function(e,r,a){var i;if(v(e)?i=e:9===e.nodeType&&(i=e.defaultView),void 0===a)return i?i[n]:e[r];i?i.scrollTo(t?i.pageXOffset:a,t?a:i.pageYOffset):e[r]=a}),e,r,arguments.length)}})),x.each(["top","left"],(function(e,n){x.cssHooks[n]=en(m.pixelPosition,(function(e,t){if(t)return t=Je(e,n),Xe.test(t)?x(e).position()[n]+"px":t}))})),x.each({Height:"height",Width:"width"},(function(e,n){x.each({padding:"inner"+e,content:n,"":"outer"+e},(function(t,r){x.fn[r]=function(a,i){var o=arguments.length&&(t||"boolean"!=typeof a),s=t||(!0===a||!0===i?"margin":"border");return ee(this,(function(n,t,a){var i;return v(n)?0===r.indexOf("outer")?n["inner"+e]:n.document.documentElement["client"+e]:9===n.nodeType?(i=n.documentElement,Math.max(n.body["scroll"+e],i["scroll"+e],n.body["offset"+e],i["offset"+e],i["client"+e])):void 0===a?x.css(n,t,s):x.style(n,t,a,s)}),n,o?a:void 0,o)}}))})),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,n){x.fn[n]=function(e){return this.on(n,e)}})),x.fn.extend({bind:function(e,n,t){return this.on(e,null,n,t)},unbind:function(e,n){return this.off(e,null,n)},delegate:function(e,n,t,r){return this.on(n,e,t,r)},undelegate:function(e,n,t){return 1===arguments.length?this.off(e,"**"):this.off(n,e||"**",t)},hover:function(e,n){return this.on("mouseenter",e).on("mouseleave",n||e)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(e,n){x.fn[n]=function(e,t){return arguments.length>0?this.on(n,null,e,t):this.trigger(n)}}));var at=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(e,n){var t,r,a;if("string"==typeof n&&(t=e[n],n=e,e=t),g(e))return r=s.call(arguments,2),a=function(){return e.apply(n||this,r.concat(s.call(arguments)))},a.guid=e.guid=e.guid||x.guid++,a},x.holdReady=function(e){e?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=T,x.isFunction=g,x.isWindow=v,x.camelCase=ae,x.type=y,x.now=Date.now,x.isNumeric=function(e){var n=x.type(e);return("number"===n||"string"===n)&&!isNaN(e-parseFloat(e))},x.trim=function(e){return null==e?"":(e+"").replace(at,"$1")},void 0===(t=function(){return x}.apply(n,[]))||(e.exports=t);var it=r.jQuery,ot=r.$;return x.noConflict=function(e){return r.$===x&&(r.$=ot),e&&r.jQuery===x&&(r.jQuery=it),x},void 0===a&&(r.jQuery=r.$=x),x}))},4244:e=>{"use strict";var n=function(e){return e!=e};e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||!(!n(e)||!n(t))}},609:(e,n,t)=>{"use strict";var r=t(4289),a=t(5559),i=t(4244),o=t(5624),s=t(2281),_=a(o(),Object);r(_,{getPolyfill:o,implementation:i,shim:s}),e.exports=_},5624:(e,n,t)=>{"use strict";var r=t(4244);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},2281:(e,n,t)=>{"use strict";var r=t(5624),a=t(4289);e.exports=function(){var e=r();return a(Object,{is:e},{is:function(){return Object.is!==e}}),e}},8987:(e,n,t)=>{"use strict";var r;if(!Object.keys){var a=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=t(1414),s=Object.prototype.propertyIsEnumerable,_=!s.call({toString:null},"toString"),u=s.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(e){var n=e.constructor;return n&&n.prototype===e},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&a.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{c(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(e){var n=null!==e&&"object"==typeof e,t="[object Function]"===i.call(e),r=o(e),s=n&&"[object String]"===i.call(e),h=[];if(!n&&!t&&!r)throw new TypeError("Object.keys called on a non-object");var f=u&&t;if(s&&e.length>0&&!a.call(e,0))for(var p=0;p<e.length;++p)h.push(String(p));if(r&&e.length>0)for(var m=0;m<e.length;++m)h.push(String(m));else for(var g in e)f&&"prototype"===g||!a.call(e,g)||h.push(String(g));if(_)for(var v=function(e){if("undefined"==typeof window||!d)return c(e);try{return c(e)}catch(e){return!1}}(e),E=0;E<l.length;++E)v&&"constructor"===l[E]||!a.call(e,l[E])||h.push(l[E]);return h}}e.exports=r},2215:(e,n,t)=>{"use strict";var r=Array.prototype.slice,a=t(1414),i=Object.keys,o=i?function(e){return i(e)}:t(8987),s=Object.keys;o.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return a(e)?s(r.call(e)):s(e)})}else Object.keys=o;return Object.keys||o},e.exports=o},1414:e=>{"use strict";var n=Object.prototype.toString;e.exports=function(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}},2837:(e,n,t)=>{"use strict";var r=t(2215),a=t(5419)(),i=t(1924),o=Object,s=i("Array.prototype.push"),_=i("Object.prototype.propertyIsEnumerable"),u=a?Object.getOwnPropertySymbols:null;e.exports=function(e,n){if(null==e)throw new TypeError("target must be an object");var t=o(e);if(1===arguments.length)return t;for(var i=1;i<arguments.length;++i){var l=o(arguments[i]),c=r(l),h=a&&(Object.getOwnPropertySymbols||u);if(h)for(var d=h(l),f=0;f<d.length;++f){var p=d[f];_(l,p)&&s(c,p)}for(var m=0;m<c.length;++m){var g=c[m];if(_(l,g)){var v=l[g];t[g]=v}}}return t}},8162:(e,n,t)=>{"use strict";var r=t(2837);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",n=e.split(""),t={},r=0;r<n.length;++r)t[n[r]]=n[r];var a=Object.assign({},t),i="";for(var o in a)i+=o;return e!==i}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(n){return"y"===e[1]}return!1}()?r:Object.assign:r}},4236:(e,n)=>{"use strict";var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,n){return Object.prototype.hasOwnProperty.call(e,n)}n.assign=function(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var t=n.shift();if(t){if("object"!=typeof t)throw new TypeError(t+"must be non-object");for(var a in t)r(t,a)&&(e[a]=t[a])}}return e},n.shrinkBuf=function(e,n){return e.length===n?e:e.subarray?e.subarray(0,n):(e.length=n,e)};var a={arraySet:function(e,n,t,r,a){if(n.subarray&&e.subarray)e.set(n.subarray(t,t+r),a);else for(var i=0;i<r;i++)e[a+i]=n[t+i]},flattenChunks:function(e){var n,t,r,a,i,o;for(r=0,n=0,t=e.length;n<t;n++)r+=e[n].length;for(o=new Uint8Array(r),a=0,n=0,t=e.length;n<t;n++)i=e[n],o.set(i,a),a+=i.length;return o}},i={arraySet:function(e,n,t,r,a){for(var i=0;i<r;i++)e[a+i]=n[t+i]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,i))},n.setTyped(t)},6069:e=>{"use strict";e.exports=function(e,n,t,r){for(var a=65535&e|0,i=e>>>16&65535|0,o=0;0!==t;){t-=o=t>2e3?2e3:t;do{i=i+(a=a+n[r++]|0)|0}while(--o);a%=65521,i%=65521}return a|i<<16|0}},1619:e=>{"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},2869:e=>{"use strict";var n=function(){for(var e,n=[],t=0;t<256;t++){e=t;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;n[t]=e}return n}();e.exports=function(e,t,r,a){var i=n,o=a+r;e^=-1;for(var s=a;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},405:(e,n,t)=>{"use strict";var r,a=t(4236),i=t(342),o=t(6069),s=t(2869),_=t(8898),u=0,l=4,c=0,h=-2,d=-1,f=4,p=2,m=8,g=9,v=286,E=30,b=19,M=2*v+1,y=15,O=3,P=258,x=P+O+1,D=42,T=103,A=113,C=666,w=1,R=2,I=3,L=4;function S(e,n){return e.msg=_[n],n}function B(e){return(e<<1)-(e>4?9:0)}function U(e){for(var n=e.length;--n>=0;)e[n]=0}function k(e){var n=e.state,t=n.pending;t>e.avail_out&&(t=e.avail_out),0!==t&&(a.arraySet(e.output,n.pending_buf,n.pending_out,t,e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,0===n.pending&&(n.pending_out=0))}function W(e,n){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,k(e.strm)}function N(e,n){e.pending_buf[e.pending++]=n}function K(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=255&n}function F(e,n){var t,r,a=e.max_chain_length,i=e.strstart,o=e.prev_length,s=e.nice_match,_=e.strstart>e.w_size-x?e.strstart-(e.w_size-x):0,u=e.window,l=e.w_mask,c=e.prev,h=e.strstart+P,d=u[i+o-1],f=u[i+o];e.prev_length>=e.good_match&&(a>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(t=n)+o]===f&&u[t+o-1]===d&&u[t]===u[i]&&u[++t]===u[i+1]){i+=2,t++;do{}while(u[++i]===u[++t]&&u[++i]===u[++t]&&u[++i]===u[++t]&&u[++i]===u[++t]&&u[++i]===u[++t]&&u[++i]===u[++t]&&u[++i]===u[++t]&&u[++i]===u[++t]&&i<h);if(r=P-(h-i),i=h-P,r>o){if(e.match_start=n,o=r,r>=s)break;d=u[i+o-1],f=u[i+o]}}}while((n=c[n&l])>_&&0!=--a);return o<=e.lookahead?o:e.lookahead}function j(e){var n,t,r,i,_,u,l,c,h,d,f=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-x)){a.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,n=t=e.hash_size;do{r=e.head[--n],e.head[n]=r>=f?r-f:0}while(--t);n=t=f;do{r=e.prev[--n],e.prev[n]=r>=f?r-f:0}while(--t);i+=f}if(0===e.strm.avail_in)break;if(u=e.strm,l=e.window,c=e.strstart+e.lookahead,h=i,d=void 0,(d=u.avail_in)>h&&(d=h),t=0===d?0:(u.avail_in-=d,a.arraySet(l,u.input,u.next_in,d,c),1===u.state.wrap?u.adler=o(u.adler,l,d,c):2===u.state.wrap&&(u.adler=s(u.adler,l,d,c)),u.next_in+=d,u.total_in+=d,d),e.lookahead+=t,e.lookahead+e.insert>=O)for(_=e.strstart-e.insert,e.ins_h=e.window[_],e.ins_h=(e.ins_h<<e.hash_shift^e.window[_+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[_+O-1])&e.hash_mask,e.prev[_&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=_,_++,e.insert--,!(e.lookahead+e.insert<O)););}while(e.lookahead<x&&0!==e.strm.avail_in)}function q(e,n){for(var t,r;;){if(e.lookahead<x){if(j(e),e.lookahead<x&&n===u)return w;if(0===e.lookahead)break}if(t=0,e.lookahead>=O&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==t&&e.strstart-t<=e.w_size-x&&(e.match_length=F(e,t)),e.match_length>=O)if(r=i._tr_tally(e,e.strstart-e.match_start,e.match_length-O),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=O){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(W(e,!1),0===e.strm.avail_out))return w}return e.insert=e.strstart<O-1?e.strstart:O-1,n===l?(W(e,!0),0===e.strm.avail_out?I:L):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?w:R}function V(e,n){for(var t,r,a;;){if(e.lookahead<x){if(j(e),e.lookahead<x&&n===u)return w;if(0===e.lookahead)break}if(t=0,e.lookahead>=O&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=O-1,0!==t&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-x&&(e.match_length=F(e,t),e.match_length<=5&&(1===e.strategy||e.match_length===O&&e.strstart-e.match_start>4096)&&(e.match_length=O-1)),e.prev_length>=O&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-O,r=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-O),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=O-1,e.strstart++,r&&(W(e,!1),0===e.strm.avail_out))return w}else if(e.match_available){if((r=i._tr_tally(e,0,e.window[e.strstart-1]))&&W(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return w}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<O-1?e.strstart:O-1,n===l?(W(e,!0),0===e.strm.avail_out?I:L):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?w:R}function G(e,n,t,r,a){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=r,this.func=a}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*M),this.dyn_dtree=new a.Buf16(2*(2*E+1)),this.bl_tree=new a.Buf16(2*(2*b+1)),U(this.dyn_ltree),U(this.dyn_dtree),U(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(y+1),this.heap=new a.Buf16(2*v+1),U(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*v+1),U(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function H(e){var n;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=p,(n=e.state).pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?D:A,e.adler=2===n.wrap?0:1,n.last_flush=u,i._tr_init(n),c):S(e,h)}function X(e){var n,t=H(e);return t===c&&((n=e.state).window_size=2*n.w_size,U(n.head),n.max_lazy_match=r[n.level].max_lazy,n.good_match=r[n.level].good_length,n.nice_match=r[n.level].nice_length,n.max_chain_length=r[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=O-1,n.match_available=0,n.ins_h=0),t}function Y(e,n,t,r,i,o){if(!e)return h;var s=1;if(n===d&&(n=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),i<1||i>g||t!==m||r<8||r>15||n<0||n>9||o<0||o>f)return S(e,h);8===r&&(r=9);var _=new z;return e.state=_,_.strm=e,_.wrap=s,_.gzhead=null,_.w_bits=r,_.w_size=1<<_.w_bits,_.w_mask=_.w_size-1,_.hash_bits=i+7,_.hash_size=1<<_.hash_bits,_.hash_mask=_.hash_size-1,_.hash_shift=~~((_.hash_bits+O-1)/O),_.window=new a.Buf8(2*_.w_size),_.head=new a.Buf16(_.hash_size),_.prev=new a.Buf16(_.w_size),_.lit_bufsize=1<<i+6,_.pending_buf_size=4*_.lit_bufsize,_.pending_buf=new a.Buf8(_.pending_buf_size),_.d_buf=1*_.lit_bufsize,_.l_buf=3*_.lit_bufsize,_.level=n,_.strategy=o,_.method=t,X(e)}r=[new G(0,0,0,0,(function(e,n){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(j(e),0===e.lookahead&&n===u)return w;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+t;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,W(e,!1),0===e.strm.avail_out))return w;if(e.strstart-e.block_start>=e.w_size-x&&(W(e,!1),0===e.strm.avail_out))return w}return e.insert=0,n===l?(W(e,!0),0===e.strm.avail_out?I:L):(e.strstart>e.block_start&&(W(e,!1),e.strm.avail_out),w)})),new G(4,4,8,4,q),new G(4,5,16,8,q),new G(4,6,32,32,q),new G(4,4,16,16,V),new G(8,16,32,32,V),new G(8,16,128,128,V),new G(8,32,128,256,V),new G(32,128,258,1024,V),new G(32,258,258,4096,V)],n.deflateInit=function(e,n){return Y(e,n,m,15,8,0)},n.deflateInit2=Y,n.deflateReset=X,n.deflateResetKeep=H,n.deflateSetHeader=function(e,n){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=n,c):h},n.deflate=function(e,n){var t,a,o,_;if(!e||!e.state||n>5||n<0)return e?S(e,h):h;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===C&&n!==l)return S(e,0===e.avail_out?-5:h);if(a.strm=e,t=a.last_flush,a.last_flush=n,a.status===D)if(2===a.wrap)e.adler=0,N(a,31),N(a,139),N(a,8),a.gzhead?(N(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),N(a,255&a.gzhead.time),N(a,a.gzhead.time>>8&255),N(a,a.gzhead.time>>16&255),N(a,a.gzhead.time>>24&255),N(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),N(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(N(a,255&a.gzhead.extra.length),N(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=s(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(N(a,0),N(a,0),N(a,0),N(a,0),N(a,0),N(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),N(a,3),a.status=A);else{var d=m+(a.w_bits-8<<4)<<8;d|=(a.strategy>=2||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(d|=32),d+=31-d%31,a.status=A,K(a,d),0!==a.strstart&&(K(a,e.adler>>>16),K(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(o=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),k(e),o=a.pending,a.pending!==a.pending_buf_size));)N(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),k(e),o=a.pending,a.pending===a.pending_buf_size)){_=1;break}_=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,N(a,_)}while(0!==_);a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),0===_&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),k(e),o=a.pending,a.pending===a.pending_buf_size)){_=1;break}_=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,N(a,_)}while(0!==_);a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),0===_&&(a.status=T)}else a.status=T;if(a.status===T&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&k(e),a.pending+2<=a.pending_buf_size&&(N(a,255&e.adler),N(a,e.adler>>8&255),e.adler=0,a.status=A)):a.status=A),0!==a.pending){if(k(e),0===e.avail_out)return a.last_flush=-1,c}else if(0===e.avail_in&&B(n)<=B(t)&&n!==l)return S(e,-5);if(a.status===C&&0!==e.avail_in)return S(e,-5);if(0!==e.avail_in||0!==a.lookahead||n!==u&&a.status!==C){var f=2===a.strategy?function(e,n){for(var t;;){if(0===e.lookahead&&(j(e),0===e.lookahead)){if(n===u)return w;break}if(e.match_length=0,t=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(W(e,!1),0===e.strm.avail_out))return w}return e.insert=0,n===l?(W(e,!0),0===e.strm.avail_out?I:L):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?w:R}(a,n):3===a.strategy?function(e,n){for(var t,r,a,o,s=e.window;;){if(e.lookahead<=P){if(j(e),e.lookahead<=P&&n===u)return w;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=O&&e.strstart>0&&(r=s[a=e.strstart-1])===s[++a]&&r===s[++a]&&r===s[++a]){o=e.strstart+P;do{}while(r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&a<o);e.match_length=P-(o-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=O?(t=i._tr_tally(e,1,e.match_length-O),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(W(e,!1),0===e.strm.avail_out))return w}return e.insert=0,n===l?(W(e,!0),0===e.strm.avail_out?I:L):e.last_lit&&(W(e,!1),0===e.strm.avail_out)?w:R}(a,n):r[a.level].func(a,n);if(f!==I&&f!==L||(a.status=C),f===w||f===I)return 0===e.avail_out&&(a.last_flush=-1),c;if(f===R&&(1===n?i._tr_align(a):5!==n&&(i._tr_stored_block(a,0,0,!1),3===n&&(U(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),k(e),0===e.avail_out))return a.last_flush=-1,c}return n!==l?c:a.wrap<=0?1:(2===a.wrap?(N(a,255&e.adler),N(a,e.adler>>8&255),N(a,e.adler>>16&255),N(a,e.adler>>24&255),N(a,255&e.total_in),N(a,e.total_in>>8&255),N(a,e.total_in>>16&255),N(a,e.total_in>>24&255)):(K(a,e.adler>>>16),K(a,65535&e.adler)),k(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?c:1)},n.deflateEnd=function(e){var n;return e&&e.state?(n=e.state.status)!==D&&69!==n&&73!==n&&91!==n&&n!==T&&n!==A&&n!==C?S(e,h):(e.state=null,n===A?S(e,-3):c):h},n.deflateSetDictionary=function(e,n){var t,r,i,s,_,u,l,d,f=n.length;if(!e||!e.state)return h;if(2===(s=(t=e.state).wrap)||1===s&&t.status!==D||t.lookahead)return h;for(1===s&&(e.adler=o(e.adler,n,f,0)),t.wrap=0,f>=t.w_size&&(0===s&&(U(t.head),t.strstart=0,t.block_start=0,t.insert=0),d=new a.Buf8(t.w_size),a.arraySet(d,n,f-t.w_size,t.w_size,0),n=d,f=t.w_size),_=e.avail_in,u=e.next_in,l=e.input,e.avail_in=f,e.next_in=0,e.input=n,j(t);t.lookahead>=O;){r=t.strstart,i=t.lookahead-(O-1);do{t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+O-1])&t.hash_mask,t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++}while(--i);t.strstart=r,t.lookahead=O-1,j(t)}return t.strstart+=t.lookahead,t.block_start=t.strstart,t.insert=t.lookahead,t.lookahead=0,t.match_length=t.prev_length=O-1,t.match_available=0,e.next_in=u,e.input=l,e.avail_in=_,t.wrap=s,c},n.deflateInfo="pako deflate (from Nodeca project)"},4264:e=>{"use strict";e.exports=function(e,n){var t,r,a,i,o,s,_,u,l,c,h,d,f,p,m,g,v,E,b,M,y,O,P,x,D;t=e.state,r=e.next_in,x=e.input,a=r+(e.avail_in-5),i=e.next_out,D=e.output,o=i-(n-e.avail_out),s=i+(e.avail_out-257),_=t.dmax,u=t.wsize,l=t.whave,c=t.wnext,h=t.window,d=t.hold,f=t.bits,p=t.lencode,m=t.distcode,g=(1<<t.lenbits)-1,v=(1<<t.distbits)-1;e:do{f<15&&(d+=x[r++]<<f,f+=8,d+=x[r++]<<f,f+=8),E=p[d&g];n:for(;;){if(d>>>=b=E>>>24,f-=b,0===(b=E>>>16&255))D[i++]=65535&E;else{if(!(16&b)){if(0==(64&b)){E=p[(65535&E)+(d&(1<<b)-1)];continue n}if(32&b){t.mode=12;break e}e.msg="invalid literal/length code",t.mode=30;break e}M=65535&E,(b&=15)&&(f<b&&(d+=x[r++]<<f,f+=8),M+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=x[r++]<<f,f+=8,d+=x[r++]<<f,f+=8),E=m[d&v];t:for(;;){if(d>>>=b=E>>>24,f-=b,!(16&(b=E>>>16&255))){if(0==(64&b)){E=m[(65535&E)+(d&(1<<b)-1)];continue t}e.msg="invalid distance code",t.mode=30;break e}if(y=65535&E,f<(b&=15)&&(d+=x[r++]<<f,(f+=8)<b&&(d+=x[r++]<<f,f+=8)),(y+=d&(1<<b)-1)>_){e.msg="invalid distance too far back",t.mode=30;break e}if(d>>>=b,f-=b,y>(b=i-o)){if((b=y-b)>l&&t.sane){e.msg="invalid distance too far back",t.mode=30;break e}if(O=0,P=h,0===c){if(O+=u-b,b<M){M-=b;do{D[i++]=h[O++]}while(--b);O=i-y,P=D}}else if(c<b){if(O+=u+c-b,(b-=c)<M){M-=b;do{D[i++]=h[O++]}while(--b);if(O=0,c<M){M-=b=c;do{D[i++]=h[O++]}while(--b);O=i-y,P=D}}}else if(O+=c-b,b<M){M-=b;do{D[i++]=h[O++]}while(--b);O=i-y,P=D}for(;M>2;)D[i++]=P[O++],D[i++]=P[O++],D[i++]=P[O++],M-=3;M&&(D[i++]=P[O++],M>1&&(D[i++]=P[O++]))}else{O=i-y;do{D[i++]=D[O++],D[i++]=D[O++],D[i++]=D[O++],M-=3}while(M>2);M&&(D[i++]=D[O++],M>1&&(D[i++]=D[O++]))}break}}break}}while(r<a&&i<s);r-=M=f>>3,d&=(1<<(f-=M<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=i<s?s-i+257:257-(i-s),t.hold=d,t.bits=f}},7948:(e,n,t)=>{"use strict";var r=t(4236),a=t(6069),i=t(2869),o=t(4264),s=t(9241),_=1,u=2,l=0,c=-2,h=1,d=12,f=30,p=852,m=592;function g(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(e){var n;return e&&e.state?(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=1&n.wrap),n.mode=h,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new r.Buf32(p),n.distcode=n.distdyn=new r.Buf32(m),n.sane=1,n.back=-1,l):c}function b(e){var n;return e&&e.state?((n=e.state).wsize=0,n.whave=0,n.wnext=0,E(e)):c}function M(e,n){var t,r;return e&&e.state?(r=e.state,n<0?(t=0,n=-n):(t=1+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?c:(null!==r.window&&r.wbits!==n&&(r.window=null),r.wrap=t,r.wbits=n,b(e))):c}function y(e,n){var t,r;return e?(r=new v,e.state=r,r.window=null,(t=M(e,n))!==l&&(e.state=null),t):c}var O,P,x=!0;function D(e){if(x){var n;for(O=new r.Buf32(512),P=new r.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(s(_,e.lens,0,288,O,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;s(u,e.lens,0,32,P,0,e.work,{bits:5}),x=!1}e.lencode=O,e.lenbits=9,e.distcode=P,e.distbits=5}function T(e,n,t,a){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),a>=o.wsize?(r.arraySet(o.window,n,t-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((i=o.wsize-o.wnext)>a&&(i=a),r.arraySet(o.window,n,t-a,i,o.wnext),(a-=i)?(r.arraySet(o.window,n,t-a,a,0),o.wnext=a,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}n.inflateReset=b,n.inflateReset2=M,n.inflateResetKeep=E,n.inflateInit=function(e){return y(e,15)},n.inflateInit2=y,n.inflate=function(e,n){var t,p,m,v,E,b,M,y,O,P,x,A,C,w,R,I,L,S,B,U,k,W,N,K,F=0,j=new r.Buf8(4),q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;(t=e.state).mode===d&&(t.mode=13),E=e.next_out,m=e.output,M=e.avail_out,v=e.next_in,p=e.input,b=e.avail_in,y=t.hold,O=t.bits,P=b,x=M,W=l;e:for(;;)switch(t.mode){case h:if(0===t.wrap){t.mode=13;break}for(;O<16;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(2&t.wrap&&35615===y){t.check=0,j[0]=255&y,j[1]=y>>>8&255,t.check=i(t.check,j,2,0),y=0,O=0,t.mode=2;break}if(t.flags=0,t.head&&(t.head.done=!1),!(1&t.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",t.mode=f;break}if(8!=(15&y)){e.msg="unknown compression method",t.mode=f;break}if(O-=4,k=8+(15&(y>>>=4)),0===t.wbits)t.wbits=k;else if(k>t.wbits){e.msg="invalid window size",t.mode=f;break}t.dmax=1<<k,e.adler=t.check=1,t.mode=512&y?10:d,y=0,O=0;break;case 2:for(;O<16;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(t.flags=y,8!=(255&t.flags)){e.msg="unknown compression method",t.mode=f;break}if(57344&t.flags){e.msg="unknown header flags set",t.mode=f;break}t.head&&(t.head.text=y>>8&1),512&t.flags&&(j[0]=255&y,j[1]=y>>>8&255,t.check=i(t.check,j,2,0)),y=0,O=0,t.mode=3;case 3:for(;O<32;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}t.head&&(t.head.time=y),512&t.flags&&(j[0]=255&y,j[1]=y>>>8&255,j[2]=y>>>16&255,j[3]=y>>>24&255,t.check=i(t.check,j,4,0)),y=0,O=0,t.mode=4;case 4:for(;O<16;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}t.head&&(t.head.xflags=255&y,t.head.os=y>>8),512&t.flags&&(j[0]=255&y,j[1]=y>>>8&255,t.check=i(t.check,j,2,0)),y=0,O=0,t.mode=5;case 5:if(1024&t.flags){for(;O<16;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}t.length=y,t.head&&(t.head.extra_len=y),512&t.flags&&(j[0]=255&y,j[1]=y>>>8&255,t.check=i(t.check,j,2,0)),y=0,O=0}else t.head&&(t.head.extra=null);t.mode=6;case 6:if(1024&t.flags&&((A=t.length)>b&&(A=b),A&&(t.head&&(k=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),r.arraySet(t.head.extra,p,v,A,k)),512&t.flags&&(t.check=i(t.check,p,A,v)),b-=A,v+=A,t.length-=A),t.length))break e;t.length=0,t.mode=7;case 7:if(2048&t.flags){if(0===b)break e;A=0;do{k=p[v+A++],t.head&&k&&t.length<65536&&(t.head.name+=String.fromCharCode(k))}while(k&&A<b);if(512&t.flags&&(t.check=i(t.check,p,A,v)),b-=A,v+=A,k)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=8;case 8:if(4096&t.flags){if(0===b)break e;A=0;do{k=p[v+A++],t.head&&k&&t.length<65536&&(t.head.comment+=String.fromCharCode(k))}while(k&&A<b);if(512&t.flags&&(t.check=i(t.check,p,A,v)),b-=A,v+=A,k)break e}else t.head&&(t.head.comment=null);t.mode=9;case 9:if(512&t.flags){for(;O<16;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(y!==(65535&t.check)){e.msg="header crc mismatch",t.mode=f;break}y=0,O=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=d;break;case 10:for(;O<32;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}e.adler=t.check=g(y),y=0,O=0,t.mode=11;case 11:if(0===t.havedict)return e.next_out=E,e.avail_out=M,e.next_in=v,e.avail_in=b,t.hold=y,t.bits=O,2;e.adler=t.check=1,t.mode=d;case d:if(5===n||6===n)break e;case 13:if(t.last){y>>>=7&O,O-=7&O,t.mode=27;break}for(;O<3;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}switch(t.last=1&y,O-=1,3&(y>>>=1)){case 0:t.mode=14;break;case 1:if(D(t),t.mode=20,6===n){y>>>=2,O-=2;break e}break;case 2:t.mode=17;break;case 3:e.msg="invalid block type",t.mode=f}y>>>=2,O-=2;break;case 14:for(y>>>=7&O,O-=7&O;O<32;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",t.mode=f;break}if(t.length=65535&y,y=0,O=0,t.mode=15,6===n)break e;case 15:t.mode=16;case 16:if(A=t.length){if(A>b&&(A=b),A>M&&(A=M),0===A)break e;r.arraySet(m,p,v,A,E),b-=A,v+=A,M-=A,E+=A,t.length-=A;break}t.mode=d;break;case 17:for(;O<14;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(t.nlen=257+(31&y),y>>>=5,O-=5,t.ndist=1+(31&y),y>>>=5,O-=5,t.ncode=4+(15&y),y>>>=4,O-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=f;break}t.have=0,t.mode=18;case 18:for(;t.have<t.ncode;){for(;O<3;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}t.lens[q[t.have++]]=7&y,y>>>=3,O-=3}for(;t.have<19;)t.lens[q[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,N={bits:t.lenbits},W=s(0,t.lens,0,19,t.lencode,0,t.work,N),t.lenbits=N.bits,W){e.msg="invalid code lengths set",t.mode=f;break}t.have=0,t.mode=19;case 19:for(;t.have<t.nlen+t.ndist;){for(;I=(F=t.lencode[y&(1<<t.lenbits)-1])>>>16&255,L=65535&F,!((R=F>>>24)<=O);){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(L<16)y>>>=R,O-=R,t.lens[t.have++]=L;else{if(16===L){for(K=R+2;O<K;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(y>>>=R,O-=R,0===t.have){e.msg="invalid bit length repeat",t.mode=f;break}k=t.lens[t.have-1],A=3+(3&y),y>>>=2,O-=2}else if(17===L){for(K=R+3;O<K;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}O-=R,k=0,A=3+(7&(y>>>=R)),y>>>=3,O-=3}else{for(K=R+7;O<K;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}O-=R,k=0,A=11+(127&(y>>>=R)),y>>>=7,O-=7}if(t.have+A>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=f;break}for(;A--;)t.lens[t.have++]=k}}if(t.mode===f)break;if(0===t.lens[256]){e.msg="invalid code -- missing end-of-block",t.mode=f;break}if(t.lenbits=9,N={bits:t.lenbits},W=s(_,t.lens,0,t.nlen,t.lencode,0,t.work,N),t.lenbits=N.bits,W){e.msg="invalid literal/lengths set",t.mode=f;break}if(t.distbits=6,t.distcode=t.distdyn,N={bits:t.distbits},W=s(u,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,N),t.distbits=N.bits,W){e.msg="invalid distances set",t.mode=f;break}if(t.mode=20,6===n)break e;case 20:t.mode=21;case 21:if(b>=6&&M>=258){e.next_out=E,e.avail_out=M,e.next_in=v,e.avail_in=b,t.hold=y,t.bits=O,o(e,x),E=e.next_out,m=e.output,M=e.avail_out,v=e.next_in,p=e.input,b=e.avail_in,y=t.hold,O=t.bits,t.mode===d&&(t.back=-1);break}for(t.back=0;I=(F=t.lencode[y&(1<<t.lenbits)-1])>>>16&255,L=65535&F,!((R=F>>>24)<=O);){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(I&&0==(240&I)){for(S=R,B=I,U=L;I=(F=t.lencode[U+((y&(1<<S+B)-1)>>S)])>>>16&255,L=65535&F,!(S+(R=F>>>24)<=O);){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}y>>>=S,O-=S,t.back+=S}if(y>>>=R,O-=R,t.back+=R,t.length=L,0===I){t.mode=26;break}if(32&I){t.back=-1,t.mode=d;break}if(64&I){e.msg="invalid literal/length code",t.mode=f;break}t.extra=15&I,t.mode=22;case 22:if(t.extra){for(K=t.extra;O<K;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}t.length+=y&(1<<t.extra)-1,y>>>=t.extra,O-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=23;case 23:for(;I=(F=t.distcode[y&(1<<t.distbits)-1])>>>16&255,L=65535&F,!((R=F>>>24)<=O);){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(0==(240&I)){for(S=R,B=I,U=L;I=(F=t.distcode[U+((y&(1<<S+B)-1)>>S)])>>>16&255,L=65535&F,!(S+(R=F>>>24)<=O);){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}y>>>=S,O-=S,t.back+=S}if(y>>>=R,O-=R,t.back+=R,64&I){e.msg="invalid distance code",t.mode=f;break}t.offset=L,t.extra=15&I,t.mode=24;case 24:if(t.extra){for(K=t.extra;O<K;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}t.offset+=y&(1<<t.extra)-1,y>>>=t.extra,O-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=f;break}t.mode=25;case 25:if(0===M)break e;if(A=x-M,t.offset>A){if((A=t.offset-A)>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=f;break}A>t.wnext?(A-=t.wnext,C=t.wsize-A):C=t.wnext-A,A>t.length&&(A=t.length),w=t.window}else w=m,C=E-t.offset,A=t.length;A>M&&(A=M),M-=A,t.length-=A;do{m[E++]=w[C++]}while(--A);0===t.length&&(t.mode=21);break;case 26:if(0===M)break e;m[E++]=t.length,M--,t.mode=21;break;case 27:if(t.wrap){for(;O<32;){if(0===b)break e;b--,y|=p[v++]<<O,O+=8}if(x-=M,e.total_out+=x,t.total+=x,x&&(e.adler=t.check=t.flags?i(t.check,m,x,E-x):a(t.check,m,x,E-x)),x=M,(t.flags?y:g(y))!==t.check){e.msg="incorrect data check",t.mode=f;break}y=0,O=0}t.mode=28;case 28:if(t.wrap&&t.flags){for(;O<32;){if(0===b)break e;b--,y+=p[v++]<<O,O+=8}if(y!==(4294967295&t.total)){e.msg="incorrect length check",t.mode=f;break}y=0,O=0}t.mode=29;case 29:W=1;break e;case f:W=-3;break e;case 31:return-4;default:return c}return e.next_out=E,e.avail_out=M,e.next_in=v,e.avail_in=b,t.hold=y,t.bits=O,(t.wsize||x!==e.avail_out&&t.mode<f&&(t.mode<27||4!==n))&&T(e,e.output,e.next_out,x-e.avail_out)?(t.mode=31,-4):(P-=e.avail_in,x-=e.avail_out,e.total_in+=P,e.total_out+=x,t.total+=x,t.wrap&&x&&(e.adler=t.check=t.flags?i(t.check,m,x,e.next_out-x):a(t.check,m,x,e.next_out-x)),e.data_type=t.bits+(t.last?64:0)+(t.mode===d?128:0)+(20===t.mode||15===t.mode?256:0),(0===P&&0===x||4===n)&&W===l&&(W=-5),W)},n.inflateEnd=function(e){if(!e||!e.state)return c;var n=e.state;return n.window&&(n.window=null),e.state=null,l},n.inflateGetHeader=function(e,n){var t;return e&&e.state?0==(2&(t=e.state).wrap)?c:(t.head=n,n.done=!1,l):c},n.inflateSetDictionary=function(e,n){var t,r=n.length;return e&&e.state?0!==(t=e.state).wrap&&11!==t.mode?c:11===t.mode&&a(1,n,r,0)!==t.check?-3:T(e,n,r,r)?(t.mode=31,-4):(t.havedict=1,l):c},n.inflateInfo="pako inflate (from Nodeca project)"},9241:(e,n,t)=>{"use strict";var r=t(4236),a=15,i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,n,t,u,l,c,h,d){var f,p,m,g,v,E,b,M,y,O=d.bits,P=0,x=0,D=0,T=0,A=0,C=0,w=0,R=0,I=0,L=0,S=null,B=0,U=new r.Buf16(16),k=new r.Buf16(16),W=null,N=0;for(P=0;P<=a;P++)U[P]=0;for(x=0;x<u;x++)U[n[t+x]]++;for(A=O,T=a;T>=1&&0===U[T];T--);if(A>T&&(A=T),0===T)return l[c++]=20971520,l[c++]=20971520,d.bits=1,0;for(D=1;D<T&&0===U[D];D++);for(A<D&&(A=D),R=1,P=1;P<=a;P++)if(R<<=1,(R-=U[P])<0)return-1;if(R>0&&(0===e||1!==T))return-1;for(k[1]=0,P=1;P<a;P++)k[P+1]=k[P]+U[P];for(x=0;x<u;x++)0!==n[t+x]&&(h[k[n[t+x]]++]=x);if(0===e?(S=W=h,E=19):1===e?(S=i,B-=257,W=o,N-=257,E=256):(S=s,W=_,E=-1),L=0,x=0,P=D,v=c,C=A,w=0,m=-1,g=(I=1<<A)-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){b=P-w,h[x]<E?(M=0,y=h[x]):h[x]>E?(M=W[N+h[x]],y=S[B+h[x]]):(M=96,y=0),f=1<<P-w,D=p=1<<C;do{l[v+(L>>w)+(p-=f)]=b<<24|M<<16|y|0}while(0!==p);for(f=1<<P-1;L&f;)f>>=1;if(0!==f?(L&=f-1,L+=f):L=0,x++,0==--U[P]){if(P===T)break;P=n[t+h[x]]}if(P>A&&(L&g)!==m){for(0===w&&(w=A),v+=D,R=1<<(C=P-w);C+w<T&&!((R-=U[C+w])<=0);)C++,R<<=1;if(I+=1<<C,1===e&&I>852||2===e&&I>592)return 1;l[m=L&g]=A<<24|C<<16|v-c|0}}return 0!==L&&(l[v+L]=P-w<<24|64<<16|0),d.bits=A,0}},8898:e=>{"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:(e,n,t)=>{"use strict";var r=t(4236),a=0,i=1;function o(e){for(var n=e.length;--n>=0;)e[n]=0}var s=0,_=29,u=256,l=u+1+_,c=30,h=19,d=2*l+1,f=15,p=16,m=7,g=256,v=16,E=17,b=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(l+2));o(x);var D=new Array(2*c);o(D);var T=new Array(512);o(T);var A=new Array(256);o(A);var C=new Array(_);o(C);var w,R,I,L=new Array(c);function S(e,n,t,r,a){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}function B(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function U(e){return e<256?T[e]:T[256+(e>>>7)]}function k(e,n){e.pending_buf[e.pending++]=255&n,e.pending_buf[e.pending++]=n>>>8&255}function W(e,n,t){e.bi_valid>p-t?(e.bi_buf|=n<<e.bi_valid&65535,k(e,e.bi_buf),e.bi_buf=n>>p-e.bi_valid,e.bi_valid+=t-p):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)}function N(e,n,t){W(e,t[2*n],t[2*n+1])}function K(e,n){var t=0;do{t|=1&e,e>>>=1,t<<=1}while(--n>0);return t>>>1}function F(e,n,t){var r,a,i=new Array(f+1),o=0;for(r=1;r<=f;r++)i[r]=o=o+t[r-1]<<1;for(a=0;a<=n;a++){var s=e[2*a+1];0!==s&&(e[2*a]=K(i[s]++,s))}}function j(e){var n;for(n=0;n<l;n++)e.dyn_ltree[2*n]=0;for(n=0;n<c;n++)e.dyn_dtree[2*n]=0;for(n=0;n<h;n++)e.bl_tree[2*n]=0;e.dyn_ltree[2*g]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function q(e){e.bi_valid>8?k(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function V(e,n,t,r){var a=2*n,i=2*t;return e[a]<e[i]||e[a]===e[i]&&r[n]<=r[t]}function G(e,n,t){for(var r=e.heap[t],a=t<<1;a<=e.heap_len&&(a<e.heap_len&&V(n,e.heap[a+1],e.heap[a],e.depth)&&a++,!V(n,r,e.heap[a],e.depth));)e.heap[t]=e.heap[a],t=a,a<<=1;e.heap[t]=r}function z(e,n,t){var r,a,i,o,s=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],a=e.pending_buf[e.l_buf+s],s++,0===r?N(e,a,n):(N(e,(i=A[a])+u+1,n),0!==(o=M[i])&&W(e,a-=C[i],o),N(e,i=U(--r),t),0!==(o=y[i])&&W(e,r-=L[i],o))}while(s<e.last_lit);N(e,g,n)}function H(e,n){var t,r,a,i=n.dyn_tree,o=n.stat_desc.static_tree,s=n.stat_desc.has_stree,_=n.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=d,t=0;t<_;t++)0!==i[2*t]?(e.heap[++e.heap_len]=u=t,e.depth[t]=0):i[2*t+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[a]=0,e.opt_len--,s&&(e.static_len-=o[2*a+1]);for(n.max_code=u,t=e.heap_len>>1;t>=1;t--)G(e,i,t);a=_;do{t=e.heap[1],e.heap[1]=e.heap[e.heap_len--],G(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=t,e.heap[--e.heap_max]=r,i[2*a]=i[2*t]+i[2*r],e.depth[a]=(e.depth[t]>=e.depth[r]?e.depth[t]:e.depth[r])+1,i[2*t+1]=i[2*r+1]=a,e.heap[1]=a++,G(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,n){var t,r,a,i,o,s,_=n.dyn_tree,u=n.max_code,l=n.stat_desc.static_tree,c=n.stat_desc.has_stree,h=n.stat_desc.extra_bits,p=n.stat_desc.extra_base,m=n.stat_desc.max_length,g=0;for(i=0;i<=f;i++)e.bl_count[i]=0;for(_[2*e.heap[e.heap_max]+1]=0,t=e.heap_max+1;t<d;t++)(i=_[2*_[2*(r=e.heap[t])+1]+1]+1)>m&&(i=m,g++),_[2*r+1]=i,r>u||(e.bl_count[i]++,o=0,r>=p&&(o=h[r-p]),s=_[2*r],e.opt_len+=s*(i+o),c&&(e.static_len+=s*(l[2*r+1]+o)));if(0!==g){do{for(i=m-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[m]--,g-=2}while(g>0);for(i=m;0!==i;i--)for(r=e.bl_count[i];0!==r;)(a=e.heap[--t])>u||(_[2*a+1]!==i&&(e.opt_len+=(i-_[2*a+1])*_[2*a],_[2*a+1]=i),r--)}}(e,n),F(i,u,e.bl_count)}function X(e,n,t){var r,a,i=-1,o=n[1],s=0,_=7,u=4;for(0===o&&(_=138,u=3),n[2*(t+1)+1]=65535,r=0;r<=t;r++)a=o,o=n[2*(r+1)+1],++s<_&&a===o||(s<u?e.bl_tree[2*a]+=s:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[2*v]++):s<=10?e.bl_tree[2*E]++:e.bl_tree[2*b]++,s=0,i=a,0===o?(_=138,u=3):a===o?(_=6,u=3):(_=7,u=4))}function Y(e,n,t){var r,a,i=-1,o=n[1],s=0,_=7,u=4;for(0===o&&(_=138,u=3),r=0;r<=t;r++)if(a=o,o=n[2*(r+1)+1],!(++s<_&&a===o)){if(s<u)do{N(e,a,e.bl_tree)}while(0!=--s);else 0!==a?(a!==i&&(N(e,a,e.bl_tree),s--),N(e,v,e.bl_tree),W(e,s-3,2)):s<=10?(N(e,E,e.bl_tree),W(e,s-3,3)):(N(e,b,e.bl_tree),W(e,s-11,7));s=0,i=a,0===o?(_=138,u=3):a===o?(_=6,u=3):(_=7,u=4)}}o(L);var Z=!1;function Q(e,n,t,a){W(e,(s<<1)+(a?1:0),3),function(e,n,t,a){q(e),a&&(k(e,t),k(e,~t)),r.arraySet(e.pending_buf,e.window,n,t,e.pending),e.pending+=t}(e,n,t,!0)}n._tr_init=function(e){Z||(!function(){var e,n,t,r,a,i=new Array(f+1);for(t=0,r=0;r<_-1;r++)for(C[r]=t,e=0;e<1<<M[r];e++)A[t++]=r;for(A[t-1]=r,a=0,r=0;r<16;r++)for(L[r]=a,e=0;e<1<<y[r];e++)T[a++]=r;for(a>>=7;r<c;r++)for(L[r]=a<<7,e=0;e<1<<y[r]-7;e++)T[256+a++]=r;for(n=0;n<=f;n++)i[n]=0;for(e=0;e<=143;)x[2*e+1]=8,e++,i[8]++;for(;e<=255;)x[2*e+1]=9,e++,i[9]++;for(;e<=279;)x[2*e+1]=7,e++,i[7]++;for(;e<=287;)x[2*e+1]=8,e++,i[8]++;for(F(x,l+1,i),e=0;e<c;e++)D[2*e+1]=5,D[2*e]=K(e,5);w=new S(x,M,u+1,l,f),R=new S(D,y,0,c,f),I=new S(new Array(0),O,0,h,m)}(),Z=!0),e.l_desc=new B(e.dyn_ltree,w),e.d_desc=new B(e.dyn_dtree,R),e.bl_desc=new B(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,j(e)},n._tr_stored_block=Q,n._tr_flush_block=function(e,n,t,r){var o,s,_=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var n,t=4093624447;for(n=0;n<=31;n++,t>>>=1)if(1&t&&0!==e.dyn_ltree[2*n])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return i;for(n=32;n<u;n++)if(0!==e.dyn_ltree[2*n])return i;return a}(e)),H(e,e.l_desc),H(e,e.d_desc),_=function(e){var n;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),H(e,e.bl_desc),n=h-1;n>=3&&0===e.bl_tree[2*P[n]+1];n--);return e.opt_len+=3*(n+1)+5+5+4,n}(e),o=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=o&&(o=s)):o=s=t+5,t+4<=o&&-1!==n?Q(e,n,t,r):4===e.strategy||s===o?(W(e,2+(r?1:0),3),z(e,x,D)):(W(e,4+(r?1:0),3),function(e,n,t,r){var a;for(W(e,n-257,5),W(e,t-1,5),W(e,r-4,4),a=0;a<r;a++)W(e,e.bl_tree[2*P[a]+1],3);Y(e,e.dyn_ltree,n-1),Y(e,e.dyn_dtree,t-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,_+1),z(e,e.dyn_ltree,e.dyn_dtree)),j(e),r&&q(e)},n._tr_tally=function(e,n,t){return e.pending_buf[e.d_buf+2*e.last_lit]=n>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&n,e.pending_buf[e.l_buf+e.last_lit]=255&t,e.last_lit++,0===n?e.dyn_ltree[2*t]++:(e.matches++,n--,e.dyn_ltree[2*(A[t]+u+1)]++,e.dyn_dtree[2*U(n)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){W(e,2,3),N(e,g,x),function(e){16===e.bi_valid?(k(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},2292:e=>{"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},4155:e=>{var n,t,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{t="function"==typeof clearTimeout?clearTimeout:i}catch(e){t=i}}();var s,_=[],u=!1,l=-1;function c(){u&&s&&(u=!1,s.length?_=s.concat(_):l=-1,_.length&&h())}function h(){if(!u){var e=o(c);u=!0;for(var n=_.length;n;){for(s=_,_=[];++l<n;)s&&s[l].run();l=-1,n=_.length}s=null,u=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{return t(e)}catch(n){try{return t.call(null,e)}catch(n){return t.call(this,e)}}}(e)}}function d(e,n){this.fun=e,this.array=n}function f(){}r.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];_.push(new d(e,n)),1!==_.length||u||o(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},9509:(e,n,t)=>{
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=t(8764),a=r.Buffer;function i(e,n){for(var t in e)n[t]=e[t]}function o(e,n,t){return a(e,n,t)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?e.exports=r:(i(r,n),n.Buffer=o),o.prototype=Object.create(a.prototype),i(a,o),o.from=function(e,n,t){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,n,t)},o.alloc=function(e,n,t){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=a(e);return void 0!==n?"string"==typeof t?r.fill(n,t):r.fill(n):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},2830:(e,n,t)=>{e.exports=a;var r=t(7187).EventEmitter;function a(){r.call(this)}t(5717)(a,r),a.Readable=t(6577),a.Writable=t(323),a.Duplex=t(8656),a.Transform=t(4473),a.PassThrough=t(2366),a.finished=t(1086),a.pipeline=t(6472),a.Stream=a,a.prototype.pipe=function(e,n){var t=this;function a(n){e.writable&&!1===e.write(n)&&t.pause&&t.pause()}function i(){t.readable&&t.resume&&t.resume()}t.on("data",a),e.on("drain",i),e._isStdio||n&&!1===n.end||(t.on("end",s),t.on("close",_));var o=!1;function s(){o||(o=!0,e.end())}function _(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){t.removeListener("data",a),e.removeListener("drain",i),t.removeListener("end",s),t.removeListener("close",_),t.removeListener("error",u),e.removeListener("error",u),t.removeListener("end",l),t.removeListener("close",l),e.removeListener("close",l)}return t.on("error",u),e.on("error",u),t.on("end",l),t.on("close",l),e.on("close",l),e.emit("pipe",t),e}},8106:e=>{"use strict";var n={};function t(e,t,r){r||(r=Error);var a=function(e){var n,r;function a(n,r,a){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,a))||this}return r=e,(n=a).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,a}(r);a.prototype.name=r.name,a.prototype.code=e,n[e]=a}function r(e,n){if(Array.isArray(e)){var t=e.length;return e=e.map((function(e){return String(e)})),t>2?"one of ".concat(n," ").concat(e.slice(0,t-1).join(", "),", or ")+e[t-1]:2===t?"one of ".concat(n," ").concat(e[0]," or ").concat(e[1]):"of ".concat(n," ").concat(e[0])}return"of ".concat(n," ").concat(String(e))}t("ERR_INVALID_OPT_VALUE",(function(e,n){return'The value "'+n+'" is invalid for option "'+e+'"'}),TypeError),t("ERR_INVALID_ARG_TYPE",(function(e,n,t){var a,i,o,s;if("string"==typeof n&&(i="not ",n.substr(!o||o<0?0:+o,i.length)===i)?(a="must not be",n=n.replace(/^not /,"")):a="must be",function(e,n,t){return(void 0===t||t>e.length)&&(t=e.length),e.substring(t-n.length,t)===n}(e," argument"))s="The ".concat(e," ").concat(a," ").concat(r(n,"type"));else{var _=function(e,n,t){return"number"!=typeof t&&(t=0),!(t+n.length>e.length)&&-1!==e.indexOf(n,t)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(_," ").concat(a," ").concat(r(n,"type"))}return s+=". Received type ".concat(typeof t)}),TypeError),t("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),t("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),t("ERR_STREAM_PREMATURE_CLOSE","Premature close"),t("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),t("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),t("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),t("ERR_STREAM_WRITE_AFTER_END","write after end"),t("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),t("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),t("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=n},8656:(e,n,t)=>{"use strict";var r=t(4155),a=Object.keys||function(e){var n=[];for(var t in e)n.push(t);return n};e.exports=l;var i=t(6577),o=t(323);t(5717)(l,i);for(var s=a(o.prototype),_=0;_<s.length;_++){var u=s[_];l.prototype[u]||(l.prototype[u]=o.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||r.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},2366:(e,n,t)=>{"use strict";e.exports=a;var r=t(4473);function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}t(5717)(a,r),a.prototype._transform=function(e,n,t){t(null,e)}},6577:(e,n,t)=>{"use strict";var r,a=t(4155);e.exports=x,x.ReadableState=P;t(7187).EventEmitter;var i=function(e,n){return e.listeners(n).length},o=t(3630),s=t(8764).Buffer,_=(void 0!==t.g?t.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var u,l=t(964);u=l&&l.debuglog?l.debuglog("stream"):function(){};var c,h,d,f=t(9686),p=t(1029),m=t(94).getHighWaterMark,g=t(8106).q,v=g.ERR_INVALID_ARG_TYPE,E=g.ERR_STREAM_PUSH_AFTER_EOF,b=g.ERR_METHOD_NOT_IMPLEMENTED,M=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t(5717)(x,o);var y=p.errorOrDestroy,O=["error","close","destroy","pause","resume"];function P(e,n,a){r=r||t(8656),e=e||{},"boolean"!=typeof a&&(a=n instanceof r),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=m(this,e,"readableHighWaterMark",a),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c||(c=t(2553).s),this.decoder=new c(e.encoding),this.encoding=e.encoding)}function x(e){if(r=r||t(8656),!(this instanceof x))return new x(e);var n=this instanceof r;this._readableState=new P(e,this,n),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function D(e,n,t,r,a){u("readableAddChunk",n);var i,o=e._readableState;if(null===n)o.reading=!1,function(e,n){if(u("onEofChunk"),n.ended)return;if(n.decoder){var t=n.decoder.end();t&&t.length&&(n.buffer.push(t),n.length+=n.objectMode?1:t.length)}n.ended=!0,n.sync?w(e):(n.needReadable=!1,n.emittedReadable||(n.emittedReadable=!0,R(e)))}(e,o);else if(a||(i=function(e,n){var t;r=n,s.isBuffer(r)||r instanceof _||"string"==typeof n||void 0===n||e.objectMode||(t=new v("chunk",["string","Buffer","Uint8Array"],n));var r;return t}(o,n)),i)y(e,i);else if(o.objectMode||n&&n.length>0)if("string"==typeof n||o.objectMode||Object.getPrototypeOf(n)===s.prototype||(n=function(e){return s.from(e)}(n)),r)o.endEmitted?y(e,new M):T(e,o,n,!0);else if(o.ended)y(e,new E);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!t?(n=o.decoder.write(n),o.objectMode||0!==n.length?T(e,o,n,!1):I(e,o)):T(e,o,n,!1)}else r||(o.reading=!1,I(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function T(e,n,t,r){n.flowing&&0===n.length&&!n.sync?(n.awaitDrain=0,e.emit("data",t)):(n.length+=n.objectMode?1:t.length,r?n.buffer.unshift(t):n.buffer.push(t),n.needReadable&&w(e)),I(e,n)}Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),x.prototype.destroy=p.destroy,x.prototype._undestroy=p.undestroy,x.prototype._destroy=function(e,n){n(e)},x.prototype.push=function(e,n){var t,r=this._readableState;return r.objectMode?t=!0:"string"==typeof e&&((n=n||r.defaultEncoding)!==r.encoding&&(e=s.from(e,n),n=""),t=!0),D(this,e,n,!1,t)},x.prototype.unshift=function(e){return D(this,e,null,!0,!1)},x.prototype.isPaused=function(){return!1===this._readableState.flowing},x.prototype.setEncoding=function(e){c||(c=t(2553).s);var n=new c(e);this._readableState.decoder=n,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,a="";null!==r;)a+=n.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==a&&this._readableState.buffer.push(a),this._readableState.length=a.length,this};var A=1073741824;function C(e,n){return e<=0||0===n.length&&n.ended?0:n.objectMode?1:e!=e?n.flowing&&n.length?n.buffer.head.data.length:n.length:(e>n.highWaterMark&&(n.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=n.length?e:n.ended?n.length:(n.needReadable=!0,0))}function w(e){var n=e._readableState;u("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(u("emitReadable",n.flowing),n.emittedReadable=!0,a.nextTick(R,e))}function R(e){var n=e._readableState;u("emitReadable_",n.destroyed,n.length,n.ended),n.destroyed||!n.length&&!n.ended||(e.emit("readable"),n.emittedReadable=!1),n.needReadable=!n.flowing&&!n.ended&&n.length<=n.highWaterMark,k(e)}function I(e,n){n.readingMore||(n.readingMore=!0,a.nextTick(L,e,n))}function L(e,n){for(;!n.reading&&!n.ended&&(n.length<n.highWaterMark||n.flowing&&0===n.length);){var t=n.length;if(u("maybeReadMore read 0"),e.read(0),t===n.length)break}n.readingMore=!1}function S(e){var n=e._readableState;n.readableListening=e.listenerCount("readable")>0,n.resumeScheduled&&!n.paused?n.flowing=!0:e.listenerCount("data")>0&&e.resume()}function B(e){u("readable nexttick read 0"),e.read(0)}function U(e,n){u("resume",n.reading),n.reading||e.read(0),n.resumeScheduled=!1,e.emit("resume"),k(e),n.flowing&&!n.reading&&e.read(0)}function k(e){var n=e._readableState;for(u("flow",n.flowing);n.flowing&&null!==e.read(););}function W(e,n){return 0===n.length?null:(n.objectMode?t=n.buffer.shift():!e||e>=n.length?(t=n.decoder?n.buffer.join(""):1===n.buffer.length?n.buffer.first():n.buffer.concat(n.length),n.buffer.clear()):t=n.buffer.consume(e,n.decoder),t);var t}function N(e){var n=e._readableState;u("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,a.nextTick(K,n,e))}function K(e,n){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,n.readable=!1,n.emit("end"),e.autoDestroy)){var t=n._writableState;(!t||t.autoDestroy&&t.finished)&&n.destroy()}}function F(e,n){for(var t=0,r=e.length;t<r;t++)if(e[t]===n)return t;return-1}x.prototype.read=function(e){u("read",e),e=parseInt(e,10);var n=this._readableState,t=e;if(0!==e&&(n.emittedReadable=!1),0===e&&n.needReadable&&((0!==n.highWaterMark?n.length>=n.highWaterMark:n.length>0)||n.ended))return u("read: emitReadable",n.length,n.ended),0===n.length&&n.ended?N(this):w(this),null;if(0===(e=C(e,n))&&n.ended)return 0===n.length&&N(this),null;var r,a=n.needReadable;return u("need readable",a),(0===n.length||n.length-e<n.highWaterMark)&&u("length less than watermark",a=!0),n.ended||n.reading?u("reading or ended",a=!1):a&&(u("do read"),n.reading=!0,n.sync=!0,0===n.length&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(e=C(t,n))),null===(r=e>0?W(e,n):null)?(n.needReadable=n.length<=n.highWaterMark,e=0):(n.length-=e,n.awaitDrain=0),0===n.length&&(n.ended||(n.needReadable=!0),t!==e&&n.ended&&N(this)),null!==r&&this.emit("data",r),r},x.prototype._read=function(e){y(this,new b("_read()"))},x.prototype.pipe=function(e,n){var t=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,u("pipe count=%d opts=%j",r.pipesCount,n);var o=(!n||!1!==n.end)&&e!==a.stdout&&e!==a.stderr?_:m;function s(n,a){u("onunpipe"),n===t&&a&&!1===a.hasUnpiped&&(a.hasUnpiped=!0,u("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",l),e.removeListener("error",d),e.removeListener("unpipe",s),t.removeListener("end",_),t.removeListener("end",m),t.removeListener("data",h),c=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function _(){u("onend"),e.end()}r.endEmitted?a.nextTick(o):t.once("end",o),e.on("unpipe",s);var l=function(e){return function(){var n=e._readableState;u("pipeOnDrain",n.awaitDrain),n.awaitDrain&&n.awaitDrain--,0===n.awaitDrain&&i(e,"data")&&(n.flowing=!0,k(e))}}(t);e.on("drain",l);var c=!1;function h(n){u("ondata");var a=e.write(n);u("dest.write",a),!1===a&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==F(r.pipes,e))&&!c&&(u("false write response, pause",r.awaitDrain),r.awaitDrain++),t.pause())}function d(n){u("onerror",n),m(),e.removeListener("error",d),0===i(e,"error")&&y(e,n)}function f(){e.removeListener("finish",p),m()}function p(){u("onfinish"),e.removeListener("close",f),m()}function m(){u("unpipe"),t.unpipe(e)}return t.on("data",h),function(e,n,t){if("function"==typeof e.prependListener)return e.prependListener(n,t);e._events&&e._events[n]?Array.isArray(e._events[n])?e._events[n].unshift(t):e._events[n]=[t,e._events[n]]:e.on(n,t)}(e,"error",d),e.once("close",f),e.once("finish",p),e.emit("pipe",t),r.flowing||(u("pipe resume"),t.resume()),e},x.prototype.unpipe=function(e){var n=this._readableState,t={hasUnpiped:!1};if(0===n.pipesCount)return this;if(1===n.pipesCount)return e&&e!==n.pipes||(e||(e=n.pipes),n.pipes=null,n.pipesCount=0,n.flowing=!1,e&&e.emit("unpipe",this,t)),this;if(!e){var r=n.pipes,a=n.pipesCount;n.pipes=null,n.pipesCount=0,n.flowing=!1;for(var i=0;i<a;i++)r[i].emit("unpipe",this,{hasUnpiped:!1});return this}var o=F(n.pipes,e);return-1===o||(n.pipes.splice(o,1),n.pipesCount-=1,1===n.pipesCount&&(n.pipes=n.pipes[0]),e.emit("unpipe",this,t)),this},x.prototype.on=function(e,n){var t=o.prototype.on.call(this,e,n),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,u("on readable",r.length,r.reading),r.length?w(this):r.reading||a.nextTick(B,this))),t},x.prototype.addListener=x.prototype.on,x.prototype.removeListener=function(e,n){var t=o.prototype.removeListener.call(this,e,n);return"readable"===e&&a.nextTick(S,this),t},x.prototype.removeAllListeners=function(e){var n=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||a.nextTick(S,this),n},x.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,n){n.resumeScheduled||(n.resumeScheduled=!0,a.nextTick(U,e,n))}(this,e)),e.paused=!1,this},x.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},x.prototype.wrap=function(e){var n=this,t=this._readableState,r=!1;for(var a in e.on("end",(function(){if(u("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(a){(u("wrapped data"),t.decoder&&(a=t.decoder.write(a)),t.objectMode&&null==a)||(t.objectMode||a&&a.length)&&(n.push(a)||(r=!0,e.pause()))})),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(n){return function(){return e[n].apply(e,arguments)}}(a));for(var i=0;i<O.length;i++)e.on(O[i],this.emit.bind(this,O[i]));return this._read=function(n){u("wrapped _read",n),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(x.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=t(828)),h(this)}),Object.defineProperty(x.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(x.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(x.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),x._fromList=W,Object.defineProperty(x.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(x.from=function(e,n){return void 0===d&&(d=t(1265)),d(x,e,n)})},4473:(e,n,t)=>{"use strict";e.exports=l;var r=t(8106).q,a=r.ERR_METHOD_NOT_IMPLEMENTED,i=r.ERR_MULTIPLE_CALLBACK,o=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=r.ERR_TRANSFORM_WITH_LENGTH_0,_=t(8656);function u(e,n){var t=this._transformState;t.transforming=!1;var r=t.writecb;if(null===r)return this.emit("error",new i);t.writechunk=null,t.writecb=null,null!=n&&this.push(n),r(e);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);_.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",c)}function c(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(n,t){h(e,n,t)}))}function h(e,n,t){if(n)return e.emit("error",n);if(null!=t&&e.push(t),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}t(5717)(l,_),l.prototype.push=function(e,n){return this._transformState.needTransform=!1,_.prototype.push.call(this,e,n)},l.prototype._transform=function(e,n,t){t(new a("_transform()"))},l.prototype._write=function(e,n,t){var r=this._transformState;if(r.writecb=t,r.writechunk=e,r.writeencoding=n,!r.transforming){var a=this._readableState;(r.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},l.prototype._read=function(e){var n=this._transformState;null===n.writechunk||n.transforming?n.needTransform=!0:(n.transforming=!0,this._transform(n.writechunk,n.writeencoding,n.afterTransform))},l.prototype._destroy=function(e,n){_.prototype._destroy.call(this,e,(function(e){n(e)}))}},323:(e,n,t)=>{"use strict";var r,a=t(4155);function i(e){var n=this;this.next=null,this.entry=null,this.finish=function(){!function(e,n,t){var r=e.entry;e.entry=null;for(;r;){var a=r.callback;n.pendingcb--,a(t),r=r.next}n.corkedRequestsFree.next=e}(n,e)}}e.exports=x,x.WritableState=P;var o={deprecate:t(4927)},s=t(3630),_=t(8764).Buffer,u=(void 0!==t.g?t.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var l,c=t(1029),h=t(94).getHighWaterMark,d=t(8106).q,f=d.ERR_INVALID_ARG_TYPE,p=d.ERR_METHOD_NOT_IMPLEMENTED,m=d.ERR_MULTIPLE_CALLBACK,g=d.ERR_STREAM_CANNOT_PIPE,v=d.ERR_STREAM_DESTROYED,E=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,M=d.ERR_UNKNOWN_ENCODING,y=c.errorOrDestroy;function O(){}function P(e,n,o){r=r||t(8656),e=e||{},"boolean"!=typeof o&&(o=n instanceof r),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,n){var t=e._writableState,r=t.sync,i=t.writecb;if("function"!=typeof i)throw new m;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(t),n)!function(e,n,t,r,i){--n.pendingcb,t?(a.nextTick(i,r),a.nextTick(R,e,n),e._writableState.errorEmitted=!0,y(e,r)):(i(r),e._writableState.errorEmitted=!0,y(e,r),R(e,n))}(e,t,r,n,i);else{var o=C(t)||e.destroyed;o||t.corked||t.bufferProcessing||!t.bufferedRequest||A(e,t),r?a.nextTick(T,e,t,o,i):T(e,t,o,i)}}(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function x(e){var n=this instanceof(r=r||t(8656));if(!n&&!l.call(x,this))return new x(e);this._writableState=new P(e,this,n),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function D(e,n,t,r,a,i,o){n.writelen=r,n.writecb=o,n.writing=!0,n.sync=!0,n.destroyed?n.onwrite(new v("write")):t?e._writev(a,n.onwrite):e._write(a,i,n.onwrite),n.sync=!1}function T(e,n,t,r){t||function(e,n){0===n.length&&n.needDrain&&(n.needDrain=!1,e.emit("drain"))}(e,n),n.pendingcb--,r(),R(e,n)}function A(e,n){n.bufferProcessing=!0;var t=n.bufferedRequest;if(e._writev&&t&&t.next){var r=n.bufferedRequestCount,a=new Array(r),o=n.corkedRequestsFree;o.entry=t;for(var s=0,_=!0;t;)a[s]=t,t.isBuf||(_=!1),t=t.next,s+=1;a.allBuffers=_,D(e,n,!0,n.length,a,"",o.finish),n.pendingcb++,n.lastBufferedRequest=null,o.next?(n.corkedRequestsFree=o.next,o.next=null):n.corkedRequestsFree=new i(n),n.bufferedRequestCount=0}else{for(;t;){var u=t.chunk,l=t.encoding,c=t.callback;if(D(e,n,!1,n.objectMode?1:u.length,u,l,c),t=t.next,n.bufferedRequestCount--,n.writing)break}null===t&&(n.lastBufferedRequest=null)}n.bufferedRequest=t,n.bufferProcessing=!1}function C(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,n){e._final((function(t){n.pendingcb--,t&&y(e,t),n.prefinished=!0,e.emit("prefinish"),R(e,n)}))}function R(e,n){var t=C(n);if(t&&(function(e,n){n.prefinished||n.finalCalled||("function"!=typeof e._final||n.destroyed?(n.prefinished=!0,e.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,a.nextTick(w,e,n)))}(e,n),0===n.pendingcb&&(n.finished=!0,e.emit("finish"),n.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return t}t(5717)(x,s),P.prototype.getBuffer=function(){for(var e=this.bufferedRequest,n=[];e;)n.push(e),e=e.next;return n},function(){try{Object.defineProperty(P.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!l.call(this,e)||this===x&&(e&&e._writableState instanceof P)}})):l=function(e){return e instanceof this},x.prototype.pipe=function(){y(this,new g)},x.prototype.write=function(e,n,t){var r,i=this._writableState,o=!1,s=!i.objectMode&&(r=e,_.isBuffer(r)||r instanceof u);return s&&!_.isBuffer(e)&&(e=function(e){return _.from(e)}(e)),"function"==typeof n&&(t=n,n=null),s?n="buffer":n||(n=i.defaultEncoding),"function"!=typeof t&&(t=O),i.ending?function(e,n){var t=new b;y(e,t),a.nextTick(n,t)}(this,t):(s||function(e,n,t,r){var i;return null===t?i=new E:"string"==typeof t||n.objectMode||(i=new f("chunk",["string","Buffer"],t)),!i||(y(e,i),a.nextTick(r,i),!1)}(this,i,e,t))&&(i.pendingcb++,o=function(e,n,t,r,a,i){if(!t){var o=function(e,n,t){e.objectMode||!1===e.decodeStrings||"string"!=typeof n||(n=_.from(n,t));return n}(n,r,a);r!==o&&(t=!0,a="buffer",r=o)}var s=n.objectMode?1:r.length;n.length+=s;var u=n.length<n.highWaterMark;u||(n.needDrain=!0);if(n.writing||n.corked){var l=n.lastBufferedRequest;n.lastBufferedRequest={chunk:r,encoding:a,isBuf:t,callback:i,next:null},l?l.next=n.lastBufferedRequest:n.bufferedRequest=n.lastBufferedRequest,n.bufferedRequestCount+=1}else D(e,n,!1,s,r,a,i);return u}(this,i,s,e,n,t)),o},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},x.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new M(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(x.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(x.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),x.prototype._write=function(e,n,t){t(new p("_write()"))},x.prototype._writev=null,x.prototype.end=function(e,n,t){var r=this._writableState;return"function"==typeof e?(t=e,e=null,n=null):"function"==typeof n&&(t=n,n=null),null!=e&&this.write(e,n),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,n,t){n.ending=!0,R(e,n),t&&(n.finished?a.nextTick(t):e.once("finish",t));n.ended=!0,e.writable=!1}(this,r,t),this},Object.defineProperty(x.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(x.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),x.prototype.destroy=c.destroy,x.prototype._undestroy=c.undestroy,x.prototype._destroy=function(e,n){n(e)}},828:(e,n,t)=>{"use strict";var r,a=t(4155);function i(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var o=t(1086),s=Symbol("lastResolve"),_=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function f(e,n){return{value:e,done:n}}function p(e){var n=e[s];if(null!==n){var t=e[d].read();null!==t&&(e[c]=null,e[s]=null,e[_]=null,n(f(t,!1)))}}function m(e){a.nextTick(p,e)}var g=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i(r={get stream(){return this[d]},next:function(){var e=this,n=this[u];if(null!==n)return Promise.reject(n);if(this[l])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise((function(n,t){a.nextTick((function(){e[u]?t(e[u]):n(f(void 0,!0))}))}));var t,r=this[c];if(r)t=new Promise(function(e,n){return function(t,r){e.then((function(){n[l]?t(f(void 0,!0)):n[h](t,r)}),r)}}(r,this));else{var i=this[d].read();if(null!==i)return Promise.resolve(f(i,!1));t=new Promise(this[h])}return this[c]=t,t}},Symbol.asyncIterator,(function(){return this})),i(r,"return",(function(){var e=this;return new Promise((function(n,t){e[d].destroy(null,(function(e){e?t(e):n(f(void 0,!0))}))}))})),r),g);e.exports=function(e){var n,t=Object.create(v,(i(n={},d,{value:e,writable:!0}),i(n,s,{value:null,writable:!0}),i(n,_,{value:null,writable:!0}),i(n,u,{value:null,writable:!0}),i(n,l,{value:e._readableState.endEmitted,writable:!0}),i(n,h,{value:function(e,n){var r=t[d].read();r?(t[c]=null,t[s]=null,t[_]=null,e(f(r,!1))):(t[s]=e,t[_]=n)},writable:!0}),n));return t[c]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var n=t[_];return null!==n&&(t[c]=null,t[s]=null,t[_]=null,n(e)),void(t[u]=e)}var r=t[s];null!==r&&(t[c]=null,t[s]=null,t[_]=null,r(f(void 0,!0))),t[l]=!0})),e.on("readable",m.bind(null,t)),t}},9686:(e,n,t)=>{"use strict";function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var n=function(e,n){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==typeof n?n:String(n)}var _=t(8764).Buffer,u=t(9862).inspect,l=u&&u.custom||"inspect";e.exports=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var n,t,r;return n=e,(t=[{key:"push",value:function(e){var n={data:e,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(e){var n={data:e,next:this.head};0===this.length&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var n=this.head,t=""+n.data;n=n.next;)t+=e+n.data;return t}},{key:"concat",value:function(e){if(0===this.length)return _.alloc(0);for(var n,t,r,a=_.allocUnsafe(e>>>0),i=this.head,o=0;i;)n=i.data,t=a,r=o,_.prototype.copy.call(n,t,r),o+=i.data.length,i=i.next;return a}},{key:"consume",value:function(e,n){var t;return e<this.head.data.length?(t=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):t=e===this.head.data.length?this.shift():n?this._getString(e):this._getBuffer(e),t}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var n=this.head,t=1,r=n.data;for(e-=r.length;n=n.next;){var a=n.data,i=e>a.length?a.length:e;if(i===a.length?r+=a:r+=a.slice(0,e),0==(e-=i)){i===a.length?(++t,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=a.slice(i));break}++t}return this.length-=t,r}},{key:"_getBuffer",value:function(e){var n=_.allocUnsafe(e),t=this.head,r=1;for(t.data.copy(n),e-=t.data.length;t=t.next;){var a=t.data,i=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,i),0==(e-=i)){i===a.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=a.slice(i));break}++r}return this.length-=r,n}},{key:l,value:function(e,n){return u(this,a(a({},n),{},{depth:0,customInspect:!1}))}}])&&o(n.prototype,t),r&&o(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}()},1029:(e,n,t)=>{"use strict";var r=t(4155);function a(e,n){o(e,n),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function o(e,n){e.emit("error",n)}e.exports={destroy:function(e,n){var t=this,s=this._readableState&&this._readableState.destroyed,_=this._writableState&&this._writableState.destroyed;return s||_?(n?n(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(o,this,e)):r.nextTick(o,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!n&&e?t._writableState?t._writableState.errorEmitted?r.nextTick(i,t):(t._writableState.errorEmitted=!0,r.nextTick(a,t,e)):r.nextTick(a,t,e):n?(r.nextTick(i,t),n(e)):r.nextTick(i,t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,n){var t=e._readableState,r=e._writableState;t&&t.autoDestroy||r&&r.autoDestroy?e.destroy(n):e.emit("error",n)}}},1086:(e,n,t)=>{"use strict";var r=t(8106).q.ERR_STREAM_PREMATURE_CLOSE;function a(){}e.exports=function e(n,t,i){if("function"==typeof t)return e(n,null,t);t||(t={}),i=function(e){var n=!1;return function(){if(!n){n=!0;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];e.apply(this,r)}}}(i||a);var o=t.readable||!1!==t.readable&&n.readable,s=t.writable||!1!==t.writable&&n.writable,_=function(){n.writable||l()},u=n._writableState&&n._writableState.finished,l=function(){s=!1,u=!0,o||i.call(n)},c=n._readableState&&n._readableState.endEmitted,h=function(){o=!1,c=!0,s||i.call(n)},d=function(e){i.call(n,e)},f=function(){var e;return o&&!c?(n._readableState&&n._readableState.ended||(e=new r),i.call(n,e)):s&&!u?(n._writableState&&n._writableState.ended||(e=new r),i.call(n,e)):void 0},p=function(){n.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(n)?s&&!n._writableState&&(n.on("end",_),n.on("close",_)):(n.on("complete",l),n.on("abort",f),n.req?p():n.on("request",p)),n.on("end",h),n.on("finish",l),!1!==t.error&&n.on("error",d),n.on("close",f),function(){n.removeListener("complete",l),n.removeListener("abort",f),n.removeListener("request",p),n.req&&n.req.removeListener("finish",l),n.removeListener("end",_),n.removeListener("close",_),n.removeListener("finish",l),n.removeListener("end",h),n.removeListener("error",d),n.removeListener("close",f)}}},1265:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},6472:(e,n,t)=>{"use strict";var r;var a=t(8106).q,i=a.ERR_MISSING_ARGS,o=a.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function _(e){e()}function u(e,n){return e.pipe(n)}e.exports=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var l,c=function(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}(n);if(Array.isArray(n[0])&&(n=n[0]),n.length<2)throw new i("streams");var h=n.map((function(e,a){var i=a<n.length-1;return function(e,n,a,i){i=function(e){var n=!1;return function(){n||(n=!0,e.apply(void 0,arguments))}}(i);var s=!1;e.on("close",(function(){s=!0})),void 0===r&&(r=t(1086)),r(e,{readable:n,writable:a},(function(e){if(e)return i(e);s=!0,i()}));var _=!1;return function(n){if(!s&&!_)return _=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void i(n||new o("pipe"))}}(e,i,a>0,(function(e){l||(l=e),e&&h.forEach(_),i||(h.forEach(_),c(l))}))}));return n.reduce(u)}},94:(e,n,t)=>{"use strict";var r=t(8106).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,n,t,a){var i=function(e,n,t){return null!=e.highWaterMark?e.highWaterMark:n?e[t]:null}(n,a,t);if(null!=i){if(!isFinite(i)||Math.floor(i)!==i||i<0)throw new r(a?t:"highWaterMark",i);return Math.floor(i)}return e.objectMode?16:16384}}},3630:(e,n,t)=>{e.exports=t(7187).EventEmitter},2553:(e,n,t)=>{"use strict";var r=t(9509).Buffer,a=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var n;switch(this.encoding=function(e){var n=function(e){if(!e)return"utf8";for(var n;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(n)return;e=(""+e).toLowerCase(),n=!0}}(e);if("string"!=typeof n&&(r.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return n||e}(e),this.encoding){case"utf16le":this.text=_,this.end=u,n=4;break;case"utf8":this.fillLast=s,n=4;break;case"base64":this.text=l,this.end=c,n=3;break;default:return this.write=h,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(n)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var n=this.lastTotal-this.lastNeed,t=function(e,n,t){if(128!=(192&n[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&n.length>1){if(128!=(192&n[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&n.length>2&&128!=(192&n[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==t?t:this.lastNeed<=e.length?(e.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,n,0,e.length),void(this.lastNeed-=e.length))}function _(e,n){if((e.length-n)%2==0){var t=e.toString("utf16le",n);if(t){var r=t.charCodeAt(t.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",n,e.length-1)}function u(e){var n=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return n+this.lastChar.toString("utf16le",0,t)}return n}function l(e,n){var t=(e.length-n)%3;return 0===t?e.toString("base64",n):(this.lastNeed=3-t,this.lastTotal=3,1===t?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",n,e.length-t))}function c(e){var n=e&&e.length?this.write(e):"";return this.lastNeed?n+this.lastChar.toString("base64",0,3-this.lastNeed):n}function h(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}n.s=i,i.prototype.write=function(e){if(0===e.length)return"";var n,t;if(this.lastNeed){if(void 0===(n=this.fillLast(e)))return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?n?n+this.text(e,t):this.text(e,t):n||""},i.prototype.end=function(e){var n=e&&e.length?this.write(e):"";return this.lastNeed?n+"�":n},i.prototype.text=function(e,n){var t=function(e,n,t){var r=n.length-1;if(r<t)return 0;var a=o(n[r]);if(a>=0)return a>0&&(e.lastNeed=a-1),a;if(--r<t||-2===a)return 0;if(a=o(n[r]),a>=0)return a>0&&(e.lastNeed=a-2),a;if(--r<t||-2===a)return 0;if(a=o(n[r]),a>=0)return a>0&&(2===a?a=0:e.lastNeed=a-3),a;return 0}(this,e,n);if(!this.lastNeed)return e.toString("utf8",n);this.lastTotal=t;var r=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",n,r)},i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},4927:(e,n,t)=>{var r=t(5108);function a(e){try{if(!t.g.localStorage)return!1}catch(e){return!1}var n=t.g.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,n){if(a("noDeprecation"))return e;var t=!1;return function(){if(!t){if(a("throwDeprecation"))throw new Error(n);a("traceDeprecation")?r.trace(n):r.warn(n),t=!0}return e.apply(this,arguments)}}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},5955:(e,n,t)=>{"use strict";var r=t(2584),a=t(8662),i=t(6430),o=t(5692);function s(e){return e.call.bind(e)}var _="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,l=s(Object.prototype.toString),c=s(Number.prototype.valueOf),h=s(String.prototype.valueOf),d=s(Boolean.prototype.valueOf);if(_)var f=s(BigInt.prototype.valueOf);if(u)var p=s(Symbol.prototype.valueOf);function m(e,n){if("object"!=typeof e)return!1;try{return n(e),!0}catch(e){return!1}}function g(e){return"[object Map]"===l(e)}function v(e){return"[object Set]"===l(e)}function E(e){return"[object WeakMap]"===l(e)}function b(e){return"[object WeakSet]"===l(e)}function M(e){return"[object ArrayBuffer]"===l(e)}function y(e){return"undefined"!=typeof ArrayBuffer&&(M.working?M(e):e instanceof ArrayBuffer)}function O(e){return"[object DataView]"===l(e)}function P(e){return"undefined"!=typeof DataView&&(O.working?O(e):e instanceof DataView)}n.isArgumentsObject=r,n.isGeneratorFunction=a,n.isTypedArray=o,n.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},n.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):o(e)||P(e)},n.isUint8Array=function(e){return"Uint8Array"===i(e)},n.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},n.isUint16Array=function(e){return"Uint16Array"===i(e)},n.isUint32Array=function(e){return"Uint32Array"===i(e)},n.isInt8Array=function(e){return"Int8Array"===i(e)},n.isInt16Array=function(e){return"Int16Array"===i(e)},n.isInt32Array=function(e){return"Int32Array"===i(e)},n.isFloat32Array=function(e){return"Float32Array"===i(e)},n.isFloat64Array=function(e){return"Float64Array"===i(e)},n.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},n.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},g.working="undefined"!=typeof Map&&g(new Map),n.isMap=function(e){return"undefined"!=typeof Map&&(g.working?g(e):e instanceof Map)},v.working="undefined"!=typeof Set&&v(new Set),n.isSet=function(e){return"undefined"!=typeof Set&&(v.working?v(e):e instanceof Set)},E.working="undefined"!=typeof WeakMap&&E(new WeakMap),n.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(E.working?E(e):e instanceof WeakMap)},b.working="undefined"!=typeof WeakSet&&b(new WeakSet),n.isWeakSet=function(e){return b(e)},M.working="undefined"!=typeof ArrayBuffer&&M(new ArrayBuffer),n.isArrayBuffer=y,O.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&O(new DataView(new ArrayBuffer(1),0,1)),n.isDataView=P;var x="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function D(e){return"[object SharedArrayBuffer]"===l(e)}function T(e){return void 0!==x&&(void 0===D.working&&(D.working=D(new x)),D.working?D(e):e instanceof x)}function A(e){return m(e,c)}function C(e){return m(e,h)}function w(e){return m(e,d)}function R(e){return _&&m(e,f)}function I(e){return u&&m(e,p)}n.isSharedArrayBuffer=T,n.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},n.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},n.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},n.isGeneratorObject=function(e){return"[object Generator]"===l(e)},n.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},n.isNumberObject=A,n.isStringObject=C,n.isBooleanObject=w,n.isBigIntObject=R,n.isSymbolObject=I,n.isBoxedPrimitive=function(e){return A(e)||C(e)||w(e)||R(e)||I(e)},n.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(y(e)||T(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(n,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},9539:(e,n,t)=>{var r=t(4155),a=t(5108),i=Object.getOwnPropertyDescriptors||function(e){for(var n=Object.keys(e),t={},r=0;r<n.length;r++)t[n[r]]=Object.getOwnPropertyDescriptor(e,n[r]);return t},o=/%[sdj%]/g;n.format=function(e){if(!b(e)){for(var n=[],t=0;t<arguments.length;t++)n.push(l(arguments[t]));return n.join(" ")}t=1;for(var r=arguments,a=r.length,i=String(e).replace(o,(function(e){if("%%"===e)return"%";if(t>=a)return e;switch(e){case"%s":return String(r[t++]);case"%d":return Number(r[t++]);case"%j":try{return JSON.stringify(r[t++])}catch(e){return"[Circular]"}default:return e}})),s=r[t];t<a;s=r[++t])v(s)||!O(s)?i+=" "+s:i+=" "+l(s);return i},n.deprecate=function(e,t){if(void 0!==r&&!0===r.noDeprecation)return e;if(void 0===r)return function(){return n.deprecate(e,t).apply(this,arguments)};var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(t);r.traceDeprecation?a.trace(t):a.error(t),i=!0}return e.apply(this,arguments)}};var s={},_=/^$/;if(r.env.NODE_DEBUG){var u=r.env.NODE_DEBUG;u=u.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),_=new RegExp("^"+u+"$","i")}function l(e,t){var r={seen:[],stylize:h};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(t)?r.showHidden=t:t&&n._extend(r,t),M(r.showHidden)&&(r.showHidden=!1),M(r.depth)&&(r.depth=2),M(r.colors)&&(r.colors=!1),M(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),d(r,e,r.depth)}function c(e,n){var t=l.styles[n];return t?"["+l.colors[t][0]+"m"+e+"["+l.colors[t][1]+"m":e}function h(e,n){return e}function d(e,t,r){if(e.customInspect&&t&&D(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var a=t.inspect(r,e);return b(a)||(a=d(e,a,r)),a}var i=function(e,n){if(M(n))return e.stylize("undefined","undefined");if(b(n)){var t="'"+JSON.stringify(n).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}if(E(n))return e.stylize(""+n,"number");if(g(n))return e.stylize(""+n,"boolean");if(v(n))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),s=function(e){var n={};return e.forEach((function(e,t){n[e]=!0})),n}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),x(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return f(t);if(0===o.length){if(D(t)){var _=t.name?": "+t.name:"";return e.stylize("[Function"+_+"]","special")}if(y(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(P(t))return e.stylize(Date.prototype.toString.call(t),"date");if(x(t))return f(t)}var u,l="",c=!1,h=["{","}"];(m(t)&&(c=!0,h=["[","]"]),D(t))&&(l=" [Function"+(t.name?": "+t.name:"")+"]");return y(t)&&(l=" "+RegExp.prototype.toString.call(t)),P(t)&&(l=" "+Date.prototype.toUTCString.call(t)),x(t)&&(l=" "+f(t)),0!==o.length||c&&0!=t.length?r<0?y(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=c?function(e,n,t,r,a){for(var i=[],o=0,s=n.length;o<s;++o)w(n,String(o))?i.push(p(e,n,t,r,String(o),!0)):i.push("");return a.forEach((function(a){a.match(/^\d+$/)||i.push(p(e,n,t,r,a,!0))})),i}(e,t,r,s,o):o.map((function(n){return p(e,t,r,s,n,c)})),e.seen.pop(),function(e,n,t){var r=e.reduce((function(e,n){return n.indexOf("\n")>=0&&0,e+n.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return t[0]+(""===n?"":n+"\n ")+" "+e.join(",\n  ")+" "+t[1];return t[0]+n+" "+e.join(", ")+" "+t[1]}(u,l,h)):h[0]+l+h[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,n,t,r,a,i){var o,s,_;if((_=Object.getOwnPropertyDescriptor(n,a)||{value:n[a]}).get?s=_.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):_.set&&(s=e.stylize("[Setter]","special")),w(r,a)||(o="["+a+"]"),s||(e.seen.indexOf(_.value)<0?(s=v(t)?d(e,_.value,null):d(e,_.value,t-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),M(o)){if(i&&a.match(/^\d+$/))return s;(o=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.slice(1,-1),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function m(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function v(e){return null===e}function E(e){return"number"==typeof e}function b(e){return"string"==typeof e}function M(e){return void 0===e}function y(e){return O(e)&&"[object RegExp]"===T(e)}function O(e){return"object"==typeof e&&null!==e}function P(e){return O(e)&&"[object Date]"===T(e)}function x(e){return O(e)&&("[object Error]"===T(e)||e instanceof Error)}function D(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function A(e){return e<10?"0"+e.toString(10):e.toString(10)}n.debuglog=function(e){if(e=e.toUpperCase(),!s[e])if(_.test(e)){var t=r.pid;s[e]=function(){var r=n.format.apply(n,arguments);a.error("%s %d: %s",e,t,r)}}else s[e]=function(){};return s[e]},n.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.types=t(5955),n.isArray=m,n.isBoolean=g,n.isNull=v,n.isNullOrUndefined=function(e){return null==e},n.isNumber=E,n.isString=b,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=M,n.isRegExp=y,n.types.isRegExp=y,n.isObject=O,n.isDate=P,n.types.isDate=P,n.isError=x,n.types.isNativeError=x,n.isFunction=D,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=t(384);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function w(e,n){return Object.prototype.hasOwnProperty.call(e,n)}n.log=function(){var e,t;a.log("%s - %s",(e=new Date,t=[A(e.getHours()),A(e.getMinutes()),A(e.getSeconds())].join(":"),[e.getDate(),C[e.getMonth()],t].join(" ")),n.format.apply(n,arguments))},n.inherits=t(5717),n._extend=function(e,n){if(!n||!O(n))return e;for(var t=Object.keys(n),r=t.length;r--;)e[t[r]]=n[t[r]];return e};var R="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(e,n){if(!e){var t=new Error("Promise was rejected with a falsy value");t.reason=e,e=t}return n(e)}n.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(R&&e[R]){var n;if("function"!=typeof(n=e[R]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(n,R,{value:n,enumerable:!1,writable:!1,configurable:!0}),n}function n(){for(var n,t,r=new Promise((function(e,r){n=e,t=r})),a=[],i=0;i<arguments.length;i++)a.push(arguments[i]);a.push((function(e,r){e?t(e):n(r)}));try{e.apply(this,a)}catch(e){t(e)}return r}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),R&&Object.defineProperty(n,R,{value:n,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(n,i(e))},n.promisify.custom=R,n.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],t=0;t<arguments.length;t++)n.push(arguments[t]);var a=n.pop();if("function"!=typeof a)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return a.apply(i,arguments)};e.apply(this,n).then((function(e){r.nextTick(o.bind(null,null,e))}),(function(e){r.nextTick(I.bind(null,e,o))}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}},6430:(e,n,t)=>{"use strict";var r=t(4029),a=t(6314),i=t(5559),o=t(1924),s=t(7296),_=o("Object.prototype.toString"),u=t(6410)(),l="undefined"==typeof globalThis?t.g:globalThis,c=a(),h=o("String.prototype.slice"),d=Object.getPrototypeOf,f=o("Array.prototype.indexOf",!0)||function(e,n){for(var t=0;t<e.length;t+=1)if(e[t]===n)return t;return-1},p={__proto__:null};r(c,u&&s&&d?function(e){var n=new l[e];if(Symbol.toStringTag in n){var t=d(n),r=s(t,Symbol.toStringTag);if(!r){var a=d(t);r=s(a,Symbol.toStringTag)}p["$"+e]=i(r.get)}}:function(e){var n=new l[e];p["$"+e]=i(n.slice)});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u){var n=h(_(e),8,-1);return f(c,n)>-1?n:"Object"===n&&function(e){var n=!1;return r(p,(function(t,r){if(!n)try{t(e),n=h(r,1)}catch(e){}})),n}(e)}return s?function(e){var n=!1;return r(p,(function(t,r){if(!n)try{"$"+t(e)===r&&(n=h(r,1))}catch(e){}})),n}(e):null}},8163:(e,n,t)=>{var r="undefined"!=typeof window?window:t.g;r.getScriptSrcPathbase=function(e){var n="./";return-1==e.lastIndexOf("/")||0==e.indexOf("./")?n:n=e.substr(0,e.lastIndexOf("/")+1)},r.getJsFileRuntimePath=function(){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;++n){var t=e[n].getAttribute("src");if(t&&-1!=t.indexOf("SpatiotemporalPlatform.js"))return SpatiotemporalPlatform.getScriptSrcPathbase(t)}return"./"},t.p="undefined"==typeof document?"":document.currentScript.src?getScriptSrcPathbase(document.currentScript.src):getJsFileRuntimePath()},391:(e,n,t)=>{"use strict";t.d(n,{Z:()=>v});t(5108);var r,a=[window.WebGLRenderingContext,window.WebGL2RenderingContext],i=0,o=new Map,s=new Map,_=new Map,u=new Map,l=new Map,c=new Map,h=function(e,n){return function(){n.apply(this,arguments),e.apply(this,arguments)}},d=function(e,n){return function(){var t=e.apply(this,arguments);return n.apply(this,[t]),t}},f=function(e,n){return function(){n.apply(this,arguments),e.apply(this,arguments)}},p=function(e,n){if(n){++i,e.set(i,n),n.globalGpuResourceId=i;try{var t=arguments.callee;n.debugStack=t}catch(e){n.debugStack=e}}},m=function(e,n){n&&e.delete(n.globalGpuResourceId)},g=!1;const v={values:{createBuffer:{caption:"Buffer"},createFrameBuffer:{caption:"FrameBuffer"},createProgram:{caption:"Program"},createRenderBuffer:{caption:"RenderBuffer"},createShader:{caption:"Shader"},createTexture:{caption:"Texture"}},groups:[{name:"webgl-create-delete",caption:"WebGL GPU Monitor",values:["createBuffer","createFrameBuffer","createProgram","createRenderBuffer","createShader","createTexture"]}],update:function(e){e.getCounter("createBuffer").set(o.size),e.getCounter("createFrameBuffer").set(s.size),e.getCounter("createProgram").set(_.size),e.getCounter("createRenderBuffer").set(u.size),e.getCounter("createShader").set(l.size),e.getCounter("createTexture").set(c.size)}.bind(void 0),init:function(){if(g)return!0;var e=!1;for(let n=0;n<a.length;++n){let t=a[n];if(t){e=!0,Object.defineProperties(t.prototype,{createBuffer:{value:d(t.prototype.createBuffer,(function(){p(o,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},createFrameBuffer:{value:d(t.prototype.createFrameBuffer,(function(){p(s,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},createProgram:{value:d(t.prototype.createProgram,(function(){p(_,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},createRenderBuffer:{value:d(t.prototype.createRenderBuffer,(function(){p(u,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},createShader:{value:d(t.prototype.createShader,(function(){p(l,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},createTexture:{value:d(t.prototype.createTexture,(function(){p(c,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},bindTexture:{value:h(t.prototype.bindTexture,(function(){arguments[1]&&(r=arguments[1].globalGpuResourceId)})),configurable:!1,enumerable:!0,writable:!1},texImage2D:{value:h(t.prototype.texImage2D,(function(){var e=c.get(r);e&&(e.texImage2DArguments=arguments)})),configurable:!1,enumerable:!0,writable:!1},compressedTexImage2D:{value:h(t.prototype.compressedTexImage2D,(function(){var e=c.get(r);e&&(e.texImage2DArguments=arguments)})),configurable:!1,enumerable:!0,writable:!1},deleteBuffer:{value:f(t.prototype.deleteBuffer,(function(){m(o,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},deleteFrameBuffer:{value:f(t.prototype.deleteFrameBuffer,(function(){m(s,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},deleteProgram:{value:f(t.prototype.deleteProgram,(function(){m(_,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},deleteRenderBuffer:{value:f(t.prototype.deleteRenderBuffer,(function(){m(u,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},deleteShader:{value:f(t.prototype.deleteShader,(function(){m(l,arguments[0])})),configurable:!1,enumerable:!0,writable:!1},deleteTexture:{value:f(t.prototype.deleteTexture,(function(){m(c,arguments[0])})),configurable:!1,enumerable:!0,writable:!1}});Object.getOwnPropertyDescriptor(t.prototype,"createBuffer"),Object.getOwnPropertyDescriptors(t.prototype)}}return g=!0,e}}},9862:()=>{},964:()=>{}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(void 0!==n)return n.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(n,{a:n}),n},__webpack_require__.d=(e,n)=>{for(var t in n)__webpack_require__.o(n,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="";var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SPOsgjs:()=>Ge,default:()=>ze});__webpack_require__(8163);var e=__webpack_require__(3061),n=__webpack_require__.n(e),t=__webpack_require__(5108);window.OSG=n(),t.log(n().name+" "+n().version+" "+n().author);const r={simpleSampleShader:{vertexShader:["// #version 100;","#ifdef GL_FRAGMENT_PRECISION_HIGH","   precision highp float;","#else","   precision mediump float;","#endif","#define SHADER_NAME simpleSampleShader","attribute vec3 Vertex;","attribute vec2 TexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","varying vec2 vTexCoord0;","void main(void) {","   vTexCoord0 = TexCoord0;","   // 此处的括号不能省略，后两个数要先乘","   // 否则大坐标时计算精度不够，会花屏","   gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex,1.0));","}"].join("\n"),fragmentShader:["// #version 100;","#ifdef GL_FRAGMENT_PRECISION_HIGH","   precision highp float;","#else","   precision mediump float;","#endif","#define SHADER_NAME simpleSampleShader","uniform sampler2D Texture0;","varying vec2 vTexCoord0;","void main() {","   gl_FragColor = texture2D(Texture0, vTexCoord0);","}"].join("\n")},skyboxShader:{vertexShader:["#ifdef GL_ES","precision highp float;","#endif","#define SHADER_NAME SkyboxShader","attribute vec3 Vertex;","attribute vec3 Normal;","attribute vec2 TexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","varying vec3 vViewNormal;","varying vec3 vLocalVertex;","void main(void) {","  vLocalVertex = Vertex;","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","}"].join("\n"),fragmentShader:["#ifdef GL_ES","precision highp float;","#endif","#define SHADER_NAME SkyboxShader","uniform samplerCube Texture0;","varying vec3 vLocalVertex;","void main(void) {","  vec3 eye = -normalize(vLocalVertex);","  gl_FragColor = textureCube(Texture0, eye);","}"].join("\n")},cityShader:{vertexShader:["#define SHADER_NAME CityShader","attribute vec3 Vertex;","attribute vec3 Normal;","attribute vec2 TexCoord0;","attribute vec4 TexCoord3;","attribute vec4 Tangent;","attribute vec4 HighlightColor;","","uniform mat4 uModelViewMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uProjectionMatrix;","uniform mat3 uModelViewNormalMatrix;","","varying vec2 vTexCoord0;","varying vec4 vTexCoord3;","varying vec3 vNormal;","varying vec4 vHighlightColor;","","void main(void) {","   vTexCoord0 = TexCoord0;","   vTexCoord3 = TexCoord3;","   vNormal = Normal;","   vHighlightColor = HighlightColor;","   ","   gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","}"].join("\n"),fragmentShader:["#extension GL_OES_standard_derivatives : enable","#extension GL_EXT_frag_depth : enable","#extension GL_EXT_shader_texture_lod : enable","#define SHADER_NAME CityShader","precision mediump float;","","uniform sampler2D Texture0;","","uniform vec4 uLight3_ambient;","uniform vec3 uLight3_viewDirection;","","varying vec2 vTexCoord0;","varying vec4 vTexCoord3;","varying vec3 vNormal;","varying vec4 vHighlightColor;","","uniform vec2 uTextureSize;","uniform float uSplicingImageThreshold;","","float mipmapLevel(vec2 uv, vec2 textureSize) {","   vec2 dx = dFdx(uv * textureSize.x);","   vec2 dy = dFdy(uv * textureSize.y);","   float d = max(dot(dx, dx), dot(dy, dy));","   return 0.25 * log2(d);","}","vec4 sampleTexturePackMipWrapped(const in sampler2D tex, in vec2 uv,const in vec4 texcoord_splice,const in int nNum) {","   // vec2 tSize = textureSize(tex, 0);","   vec2 tSize = uTextureSize;","   ","   float nWidth = tSize.x * texcoord_splice.z;","   float nHeight = tSize.y * texcoord_splice.w;","   float subtexlod = log2(float(nWidth > nHeight ? nHeight : nWidth));","   float lod = mipmapLevel(uv, vec2(nWidth, nHeight));","   lod = clamp(lod, 0.0, subtexlod);","","   // get width/height of the whole pack texture for the current lod level","   float size = pow(2.0, subtexlod - lod);","   float sizex = size / texcoord_splice.z;  // width in pixels","   float sizey = size / texcoord_splice.w;  // height in","   uv = fract(uv);","","   // tweak pixels for correct bilinear filtering, and add offset for the wanted tile","   uv.x = uv.x * ((sizex * texcoord_splice.z - 1.0) / sizex) + 0.5 / sizex + texcoord_splice.x;","   uv.y = uv.y * ((sizey * texcoord_splice.w - 1.0) / sizey) + 0.5 / sizey + texcoord_splice.y;","#ifdef texture2DLodEXT_support","   return texture2DLodEXT(tex, uv, lod);","#else","   return texture2D(tex, uv);","#endif","}","","vec4 sampleTexturePackMipWrapped2(const in sampler2D tex, in vec2 uv, const in vec2 offset, const in vec4 packTexFactors) {","   vec2 uvNew;","   uvNew.x = offset.x + uv.x*packTexFactors.x;","   uvNew.y = offset.y + uv.y*packTexFactors.y;","   return texture2D( tex, uvNew);","}","","void main() {","   vec4 color;","   if(uSplicingImageThreshold>0.0) {","       color = sampleTexturePackMipWrapped(Texture0,vTexCoord0,vTexCoord3,0);","   }","   else {","       color = texture2D(Texture0, vTexCoord0);","   }","   ","   // if a model width is less than 256, show red","   // if(uTextureSize.x<256.0) {","   //  color = vec4(1.0, 0.0, 0.0, 1.0);","   // }","   ","   gl_FragColor = color;","   ","   // AlphaTest","   //","   // https://stackoverflow.com/questions/7277047/alphafunctions-in-webgl","   // Is it possible to achieve an transparency effect ","   // where fragments with alpha lower than 0.5 are discarded ","   // and fragments with alpha higher than 0.5 are rendered rendered opaque","   // From what I have read,","   //      glEnable(GL_ALPHA_TEST);","   //      glAlphaFunc(GL_GREATER, 0.5); ","   // would be what I am looking for ","   // but unfortunately, AlphaFunction is not defined in WebGL. Is there a workaround?","   // ","   // You can completely discard fragments in the fragment shader using the discard statement. ","   // That is the modern way of doing alpha test, as it is also deprecated in desktop GL 3+","   if(gl_FragColor.a<0.4) {","       // gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);","       discard;","   }","   ","   // 光照","   // gl_FragColor.xyz = mix(gl_FragColor.xyz,","   //  uLight3_ambient.xyz,","   //  uLight3_ambient.w // 按照alpha通道融合 // 0.5","   // );","   // float dotLN = 0.5 + max(","   //  dot(normalize(uLight3_viewDirection), normalize(vNormal)),","   //  0.0);","   // gl_FragColor.xyz *= dotLN;","   ","   if(vHighlightColor.w < 0.0 ) {","       discard;","   }","   // 高亮 闪烁","   gl_FragColor.xyz = mix(gl_FragColor.xyz,","       vHighlightColor.xyz,","       vHighlightColor.w // 按照alpha通道融合 // 0.5","   );","}"].join("\n")},cityShaderMRT:{vertexShader:["#define SHADER_NAME CityShader","attribute vec3 Vertex;","attribute vec3 Normal;","attribute vec2 TexCoord0;","attribute vec4 TexCoord3;","attribute vec4 Tangent;","attribute vec4 HighlightColor;","","attribute vec4 IdsArray;                                                               ","attribute vec4 IdsArray2;                                                              ","varying vec4 IdsArrayPS;                                                               ","varying vec4 IdsArray2PS;                                                              ","uniform mat4 uModelViewMatrix;","uniform mat4 uModelMatrix;","uniform mat4 uProjectionMatrix;","uniform mat3 uModelViewNormalMatrix;","","varying vec2 vTexCoord0;","varying vec4 vTexCoord3;","varying vec3 vNormal;","varying vec4 vHighlightColor;","","void main(void) {","   vTexCoord0 = TexCoord0;","   vTexCoord3 = TexCoord3;","   vNormal = Normal;","   vHighlightColor = HighlightColor;","   ","   IdsArrayPS = IdsArray;                                                              ","   IdsArray2PS = IdsArray2;                                                            ","   gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","}"].join("\n"),fragmentShader:["#extension GL_EXT_draw_buffers : require                                                                           ","#extension GL_OES_standard_derivatives : enable","#extension GL_EXT_frag_depth : enable","#extension GL_EXT_draw_buffers : require","#extension GL_EXT_shader_texture_lod : enable","#define SHADER_NAME CityShader","precision mediump float;","","uniform sampler2D Texture0;","","uniform vec4 uLight3_ambient;","uniform vec3 uLight3_viewDirection;","","varying vec4 IdsArrayPS;                                                                                           ","varying vec4 IdsArray2PS;                                                                                          ","varying vec2 vTexCoord0;","varying vec4 vTexCoord3;","varying vec3 vNormal;","varying vec4 vHighlightColor;","","uniform vec2 uTextureSize;","uniform float uSplicingImageThreshold;","","float mipmapLevel(vec2 uv, vec2 textureSize) {","   vec2 dx = dFdx(uv * textureSize.x);","   vec2 dy = dFdy(uv * textureSize.y);","   float d = max(dot(dx, dx), dot(dy, dy));","   return 0.25 * log2(d);","}","vec4 sampleTexturePackMipWrapped(const in sampler2D tex, in vec2 uv,const in vec4 texcoord_splice,const in int nNum) {","   // vec2 tSize = textureSize(tex, 0);","   vec2 tSize = uTextureSize;","   ","   float nWidth = tSize.x * texcoord_splice.z;","   float nHeight = tSize.y * texcoord_splice.w;","   float subtexlod = log2(float(nWidth > nHeight ? nHeight : nWidth));","   float lod = mipmapLevel(uv, vec2(nWidth, nHeight));","   lod = clamp(lod, 0.0, subtexlod);","","   // get width/height of the whole pack texture for the current lod level","   float size = pow(2.0, subtexlod - lod);","   float sizex = size / texcoord_splice.z;  // width in pixels","   float sizey = size / texcoord_splice.w;  // height in","   uv = fract(uv);","","   // tweak pixels for correct bilinear filtering, and add offset for the wanted tile","   uv.x = uv.x * ((sizex * texcoord_splice.z - 1.0) / sizex) + 0.5 / sizex + texcoord_splice.x;","   uv.y = uv.y * ((sizey * texcoord_splice.w - 1.0) / sizey) + 0.5 / sizey + texcoord_splice.y;","#ifdef texture2DLodEXT_support","   return texture2DLodEXT(tex, uv, lod);","#else","   return texture2D(tex, uv);","#endif","}","","vec4 sampleTexturePackMipWrapped2(const in sampler2D tex, in vec2 uv, const in vec2 offset, const in vec4 packTexFactors) {","   vec2 uvNew;","   uvNew.x = offset.x + uv.x*packTexFactors.x;","   uvNew.y = offset.y + uv.y*packTexFactors.y;","   return texture2D( tex, uvNew);","}","","void main() {","   vec4 color;","   if(uSplicingImageThreshold>0.0) {","       color = sampleTexturePackMipWrapped(Texture0,vTexCoord0,vTexCoord3,0);","   }","   else {","       color = texture2D(Texture0, vTexCoord0);","   }","   ","   // if a model width is less than 256, show red","   // if(uTextureSize.x<256.0) {","   //  color = vec4(1.0, 0.0, 0.0, 1.0);","   // }","   ","   ","   // AlphaTest","   //","   // https://stackoverflow.com/questions/7277047/alphafunctions-in-webgl","   // Is it possible to achieve an transparency effect ","   // where fragments with alpha lower than 0.5 are discarded ","   // and fragments with alpha higher than 0.5 are rendered rendered opaque","   // From what I have read,","   //      glEnable(GL_ALPHA_TEST);","   //      glAlphaFunc(GL_GREATER, 0.5); ","   // would be what I am looking for ","   // but unfortunately, AlphaFunction is not defined in WebGL. Is there a workaround?","   // ","   // You can completely discard fragments in the fragment shader using the discard statement. ","   // That is the modern way of doing alpha test, as it is also deprecated in desktop GL 3+","   ","   // 光照","   // gl_FragColor.xyz = mix(gl_FragColor.xyz,","   //  uLight3_ambient.xyz,","   //  uLight3_ambient.w // 按照alpha通道融合 // 0.5","   // );","   // float dotLN = 0.5 + max(","   //  dot(normalize(uLight3_viewDirection), normalize(vNormal)),","   //  0.0);","   // gl_FragColor.xyz *= dotLN;","   ","   if(vHighlightColor.w < 0.0 ) {","       discard;","   }","   // 高亮 闪烁","   color.xyz = mix(color.xyz,","       vHighlightColor.xyz,","       vHighlightColor.w // 按照alpha通道融合 // 0.5","   );","   gl_FragData[0] = color;                                                                                     ","   gl_FragData[1] = color;                                                                                     ","   gl_FragData[2] = IdsArrayPS;                                                                                    ","   gl_FragData[3] = IdsArray2PS;                                                                                   ","}"].join("\n")}};var a,i,o,s,_=__webpack_require__(5108);"function"!=typeof Object.create&&(Object.create=function(e,n){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object: "+e);if(null===e)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(void 0!==n)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function t(){}return t.prototype=e,new t}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var a=arguments[r];if(null!=a)for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i])}return t},writable:!0,configurable:!0}),"function"!=typeof Object.supply&&Object.defineProperty(Object,"supply",{value:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var a=arguments[r];if(null!=a)for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&!Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=a[i])}return t},writable:!0,configurable:!0}),Object.supply(Object,{deepClone:function(e){return JSON.parse(JSON.stringify(e))}}),Object.supply(Number,{isNaN:function(e){return e!=e}}),Object.keys||(Object.keys=(a=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),s=(o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var n=[];for(var t in e)a.call(e,t)&&n.push(t);if(i)for(var r=0;r<s;r++)a.call(e,o[r])&&n.push(o[r]);return n})),Object.values||(Object.values=function(e){if(e!==Object(e))throw new TypeError("Object.values called on a non-object");var n,t=[];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(e[n]);return t});var u=function(){var e=[],n=!1;function t(){n||(n=!0,window.requestAnimationFrame?window.requestAnimationFrame(r):setTimeout(r,66))}function r(){e.forEach((function(e){e()})),n=!1}return{add:function(n){e.length||window.addEventListener("resize",t),function(n){n&&e.push(n)}(n)}}}(),l=OSG.osg;OSG.osgDB;Object.assign(l.Camera.prototype,{setInitialDrawCallback:function(e,n){this._userInitialDrawCallback&&this.getInitialDrawCallback()||(this._userInitialDrawCallback=new Map,this._initialDrawCallback=function(){for(var[e,n]of this._userInitialDrawCallback)for(var t=0;t<n.length;++t)n[t](arguments)}.bind(this)),n=n||0;var t=this._userInitialDrawCallback.get(n);t?t.push(e):this._userInitialDrawCallback.set(n,[e])},setFinalDrawCallback:function(e,n){this._userFinalDrawCallback&&this.getFinalDrawCallback()||(this._userFinalDrawCallback=new Map,this._finalDrawCallback=function(){for(var[e,n]of this._userFinalDrawCallback)for(var t=0;t<n.length;++t)n[t](arguments)}.bind(this)),n=n||0;var t=this._userFinalDrawCallback.get(n);t?t.push(e):this._userFinalDrawCallback.set(n,[e])},deleteInitialDrawCallback:function(e,n){if(this._userInitialDrawCallback&&this.getInitialDrawCallback())for(var[t,r]of this._userInitialDrawCallback){for(var a=!1,i=0;i<r.length;++i)if(r[i]===e){r.splice(i,1),a=!0;break}if(a)break}},deleteFinalDrawCallback:function(e,n){if(this._userFinalDrawCallback&&this.getFinalDrawCallback())for(var[t,r]of this._userFinalDrawCallback){for(var a=!1,i=0;i<r.length;++i)if(r[i]===e){r.splice(i,1),a=!0;break}if(a)break}}});Object.assign(function(e,n,t){var r=this;t=t||1,r._camera=e,r._canvas=n||document.getElementById("View"),r._rttList=[];for(var a=r._canvas.width,i=r._canvas.height,o=0;o<t;++o){var s=new l.Texture;s.setTextureSize(a,i),s.setMinFilter(l.Texture.LINEAR),s.setMagFilter(l.Texture.LINEAR),e.attachTexture(l.FrameBufferObject.COLOR_ATTACHMENT0+o,s,0),r._rttList[o]=s}var _=new l.Texture;_.setTextureSize(a,i),_.setMinFilter(l.Texture.NEAREST),_.setMagFilter(l.Texture.NEAREST),_.setInternalFormat(l.Texture.DEPTH_COMPONENT),_.setInternalFormatType(l.Texture.UNSIGNED_SHORT),e.attachTexture(l.FrameBufferObject.DEPTH_ATTACHMENT,_,0),r._rttList[t]=_,u.add((function(){for(var e=r._canvas.width,n=r._canvas.height,t=0;t<r._rttList.length;t++)r._rttList[t].setTextureSize(e,n);r._camera.getFrameBufferObject()&&r._camera.getFrameBufferObject().dirty(),r._camera.getViewport()&&r._camera.getViewport().setViewport(0,0,e,n)}))}.prototype,{readPixelsList:function(e,n,t,r,a){var i=this,o=function(s){var u=s.getGraphicContext(),l=u.checkFramebufferStatus(u.FRAMEBUFFER);if(l===u.FRAMEBUFFER_COMPLETE){for(var c=new Array(i._rttList.length),h=t*r*4,d=u.createFramebuffer(),f=0;f<i._rttList.length;f++)c[f]=new Uint8Array(h),f>0?(u.bindFramebuffer(u.FRAMEBUFFER,d),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,i._rttList[f].getTextureTarget(),i._rttList[f].getTextureObject()._id,0)):u.bindFramebuffer(u.FRAMEBUFFER,i._camera.frameBufferObject.getFrameBufferObject()),u.readPixels(e,n,t,r,u.RGBA,u.UNSIGNED_BYTE,c[f]);u.deleteFrameBuffer(d),u.bindFramebuffer(u.FRAMEBUFFER,null),i._camera.deleteFinalDrawCallback(o),a(c)}else{switch(l){case 36054:_.error("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case 36055:_.error("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case 36057:_.error("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case 36061:_.error("FRAMEBUFFER_UNSUPPORTED");break;default:_.error("FRAMEBUFFER unknown error "+code.toString(16))}a()}};i._camera.setFinalDrawCallback(o)}});var c=function(e){l.NodeVisitor.call(this,l.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._applyGeometry=e};c.prototype=l.objectInherit(l.NodeVisitor.prototype,{apply:function(e){e.getPrimitiveSetList?this._applyGeometry&&this._applyGeometry(e):this.traverse(e)}});var h,d,f=(h=l.mat4.create(),d=l.mat4.create(),function(e,n){l.mat4.identity(h),l.mat4.identity(d);var t=[0,0,0,0];if(e.getViewport()&&(l.mat4.mul(h,h,e.getViewport().computeWindowMatrix(d)),l.mat4.mul(h,h,e.getProjectionMatrix()),l.mat4.mul(h,h,e.getViewMatrix()),l.vec4.transformMat4(t,l.vec4.fromValues(n[0],n[1],n[2],1),h)),t[3]>0)return[t[0]/t[3],t[1]/t[3],t[2]/t[3]]});var p={parseFloatList:function(e){if(Array.prototype.map)return e.split(",").map((function(e){return parseFloat(e,10)}));for(var n=e.split(","),t=0,r=[];t<n.length;++t)r[t]=parseFloat(n[t]);return r},parseIntList:function(e){if(Array.prototype.map)return e.split(",").map((function(e){return parseInt(e,10)}));for(var n=e.split(","),t=0,r=[];t<n.length;++t)r[t]=parseInt(n[t]);return r},mergeArrays:function(e,n){Array.prototype.push.apply(e,n)},WebWorkerWrapper:function(e){var n=window.P,t=window.Worker;if(void 0!==t){var r,a=(r=new Blob(["("+e.toString()+")()"],{type:"application/javascript"}),URL.createObjectURL(r)),i=0,o=new Map,s=new t(a,{name:"WebWorkerWrapper"});return s.onmessage=function(e){e.data._buffer?(0,o.get(e.data._id)[0])(e.data._buffer):(0,o.get(e.data._id)[1])();o.delete(e.data._id)},s.onerror=function(e){_.error("Web Worker Error: "+e.filename+":"+e.lineno+e.message)},function(e){return e=[].slice.call(arguments),new n((function(n,t){o.set(++i,arguments),e=e.filter((e=>e instanceof ArrayBuffer||e instanceof MessagePort||e instanceof ImageBitmap));var r={_id:i,_buffer:e};s.postMessage(r)}))}}_.log("sorry, your browser does not support Web Worker")},funcProxy:function(e,n){return function(){n.apply(this,arguments),e.apply(this,arguments)}},funcProxyPromise:function(e,n){return function(){var t=arguments;return e.apply(this,arguments).then((function(){return n.apply(this,t)}))}},funcCreateProxy:function(e,n){return function(){var t=n.apply(this,arguments);e.apply(this,[t])}}};p.optimizedResize=u,p.releaseGLObjects=function(e){var n=function(){l.NodeVisitor.call(this,l.NodeVisitor.TRAVERSE_ALL_CHILDREN)};n.prototype=l.objectInherit(l.NodeVisitor.prototype,{apply:function(e){if(e.releaseGLObjects(),e instanceof l.Camera){var n=e.getAttachments();for(var t in n)n.hasOwnProperty(t)&&n[t].texture.releaseGLObjects();e.resetAttachments(),e.getFrameBufferObject()&&e.getFrameBufferObject().dirty()}this.traverse(e)}});var t=new n;e.accept(t)},p.TemplateGeometryVisitor=c,p.projectToScreen=f,p.isSupportFile=function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?(_.log("support"),!0):(_.log("nosupport"),!1)};const m=p;var g,v=OSG.osg,E={encodeIds:function(e){var n=[];return n[0]=[e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,255&e[2]],n[1]=[e[0]>>8&255,255&e[0],e[1]>>8&255,255&e[1]],n.forEach((function(e){v.vec4.scale(e,e,1/255)})),n},decodeIdsFromPixels:function(e,n){var t=[];return t[2]=e[0]<<24|e[1]<<16|e[2]<<8|e[3],t[0]=n[0]<<8|n[1],t[1]=n[2]<<8|n[3],t},decodeIdsFromArray:function(e,n){return this.decodeIdsFromPixels(e.map((e=>255*e)),n.map((e=>255*e)))},addIdToGeometry:function(e,n){if(n)for(var t=["IdsArray","IdsArray2"],r=t.length,a=n.idLayer||0,i=n.idScheme||0,o=n.idEntity||1,s=this.encodeIds([a,i,o]),_=e.getAttributes().Vertex,u=_.getElements().length/_.getItemSize(),l=0;l<r;l++){for(var c=new Float32Array(4*u),h=0;h<u;h++)c[4*h+0]=s[l][0],c[4*h+1]=s[l][1],c[4*h+2]=s[l][2],c[4*h+3]=s[l][3];e.setVertexAttribArray(t[l],new v.BufferArray(v.BufferArray.ARRAY_BUFFER,c,4))}}};v.Geometry.compile=(g=new m.TemplateGeometryVisitor((function(e){e.strTestCompile="",e.strCompile="";var n=e.getVertexAttributeList().IdsArray,t=e.getVertexAttributeList().IdsArray2,r=e.getVertexAttributeList().HighlightColor;if(n&&r&&t){for(var a=n.getElements(),i=t.getElements(),o=r.getElements(),s=[],_=0,u=o.length/4;_<u;++_){var l=E.decodeIdsFromArray(a.slice(4*_,4*_+4),i.slice(4*_,4*_+4)).join("@");-1==s.indexOf(l)&&s.push(l),e.strCompile+="%"+l+"#"+o[4*_+0]+"@"+o[4*_+1]+"@"+o[4*_+2]+"~"+o[4*_+3]}e.strTestCompile=s.join("|")}})),function(e){e.accept(g)}),v.Geometry.hideEntity=function(){var e,n,t=!1,r=new RegExp("[^#]*(#[^%]*)","g"),a=/[@~#]/,i=new m.TemplateGeometryVisitor((function(i){var o=i.strCompile;if(o&&0!=o.length&&e)if(e.test(i.strTestCompile)){var s=o.replace(n,"$1-1.0").replace(r,"$1").split(a);i.getVertexAttributeList().HighlightColor.setElements(new Float32Array((s.shift(),s)))}else{if(t)return;var _=i.getVertexAttributeList().HighlightColor;if(!_)return;for(var u=_.getElements(),l=0,c=u.length/4;l<c;++l)u[4*l+3]=0;_.dirty()}}));return function(r){var a,o=r.node;t=r.loading,r.ids&&(a=r.ids,e=[],a.forEach((function(n){e.push(n.join("@"))})),e=e.join("|"),n=new RegExp("(%("+e+")#[^~]*~)[^%]*","g"),e=new RegExp(e,"g")),o.accept(i)}}();var b={};b.Ids=E;const M=b;var y,O=OSG.osg,P=OSG.osgGA,x=OSG.osgUtil,D=function(e){P.OrbitManipulator.call(this,e)};D.prototype=O.objectInherit(P.OrbitManipulator.prototype,{init:function(){P.OrbitManipulator.prototype.init.call(this),this._locate=new x.DelayInterpolator(3)},setDelay:function(e){P.OrbitManipulator.prototype.setDelay.call(this,e),this._locate.setDelay(e)},getLocateInterpolator:function(){return this._locate},update:(y=O.vec3.create(),function(e){var n,t=e.getFrameStamp().getDeltaTime();n=this._rotate.update(t),this.computeRotation(.1*-n[0]*this._scaleMouseMotion,.1*-n[1]*this._scaleMouseMotion),n=this._pan.update(t),this.computePan(.002*-n[0],.002*-n[1]),n=this._zoom.update(t),this.computeZoom(1+n[0]/10),n=this._locate.update(t),O.vec3.add(this._target,this._target,n);var r=this._target,a=this._distance;O.mat4.invert(this._inverseMatrix,this._rotation),O.mat4.mul(this._inverseMatrix,this._vrMatrix,this._inverseMatrix),O.vec3.set(y,0,a,0),O.vec3.transformMat4(y,y,this._inverseMatrix),O.mat4.lookAt(this._inverseMatrix,O.vec3.add(y,r,y),r,this._upz)})});var T={locateInit:function(e,n,t){e.setupManipulator(new D),e.getManipulator().setAutoPushTarget(!1),e.getManipulator().setLimitZoomIn(0),e.getManipulator().setDistance(n),e.getManipulator().setTarget(t)},local2World:function(e){var n=O.mat4.create();O.computeLocalToWorld(e._nodePath.slice(1),!0,n);var t=[0,0,0];return O.vec3.transformMat4(t,e._localIntersectionPoint,n),t},locate:function(e,n,t){if(t){var r=e.getManipulator().getDistance()/2;e.getManipulator().setDistance(r)}e.getManipulator().setTarget(n)},locateDelay:function(e,n,t){var r=O.vec3.fromValues(0,0,0);if(e.getManipulator().getTarget(r),e.getManipulator().getZoomInterpolator().addTarget(-5,-5),t){var a=e.getManipulator().getDistance()/2;e.getManipulator().setDistance(a)}e.getManipulator().getLocateInterpolator().addTarget(n[0]-r[0],n[1]-r[1],n[2]-r[2])}};const A=T;var C,w,R=__webpack_require__(5108),I=window.OSG,L=I.osg,S=I.osgViewer,B=((C=function(e){this._highlightObjectsArray=[],this._bUpdate=!1}).prototype={constructor:C,addHighlightObject:function(e){e&&e._idsElement&&e._idsElement2?(this._highlightObjectsArray.push(e),this._bUpdate=!0):R.log("addHighlightObject() 无效的 object")},clearHighlightObjects:function(){this._highlightObjectsArray=[],this._bUpdate=!0}},new C),U=function(e,n){var t=this;return t._viewer=e,t._canvas=t._viewer._canvas,t._node=n,t._extDrawBuffers=L.WebGLCaps.instance().getWebGLExtension("WEBGL_draw_buffers"),t._extDepthTexture=L.WebGLCaps.instance().getWebGLExtension("WEBGL_depth_texture"),t._extDrawBuffers?t._extDepthTexture?(r.cityShader=r.cityShaderMRT,t._textureList=[],t._root=new L.Node,t._root.setName("MRTTechnique-root"),t._bResize=!1,t._root.addUpdateCallback({update:function(e,n){return!t._bResize||(t._bResize=!1,t.clearScene(),t.createScene(),!0)}}),void t.createScene()):(R.warn("WEBGL_depth_texture not support"),void(t._root=t._node)):(R.warn("WEBGL_draw_buffers not support"),void(t._root=t._node))};U.prototype={constructor:U,createColorTexture:function(e,n){var t=new L.Texture;return t.setTextureSize(e,n),t.setMinFilter(L.Texture.LINEAR),t.setMagFilter(L.Texture.LINEAR),t},createDephTexture:function(e,n){var t=new L.Texture;return t.setTextureSize(e,n),t.setMinFilter(L.Texture.NEAREST),t.setMagFilter(L.Texture.NEAREST),t.setInternalFormat(L.Texture.DEPTH_COMPONENT),t.setInternalFormatType(L.Texture.UNSIGNED_SHORT),t},createScreenSpaceQuad:function(e,n){return L.createTexturedQuadGeometry(0,0,0,e,0,0,0,n,0)},createPreRenderCamera:function(e,n,t){t=t||0;var r=new L.Camera;return r.setName("MRTTechnique-PreRenderCamera"),r.setEnableFrustumCulling(!0),r.setProjectionMatrix(L.mat4.create()),r.setViewMatrix(L.mat4.create()),r.setRenderOrder(L.Camera.PRE_RENDER,t),r.setReferenceFrame(L.Transform.RELATIVE_RF),r.setViewport(new L.Viewport(0,0,e,n)),r.setClearColor(L.vec4.create()),r},createHUDCamera:function(e,n,t){t=t||0;var r=new L.Camera;return r.setName("MRTTechnique-finalPass"),r.setEnableFrustumCulling(!0),L.mat4.ortho(r.getProjectionMatrix(),0,e,0,n,-5,5),r.setViewMatrix(L.mat4.create()),r.setRenderOrder(L.Camera.NESTED_RENDER,0),r.setReferenceFrame(L.Transform.ABSOLUTE_RF),r.setViewport(new L.Viewport(0,0,e,n)),r.setClearColor(L.vec4.create()),r.setClearMask(L.Camera.DEPTH_BUFFER_BIT),r},createHighLightCamera:function(e,n,t){t=t||0;var r=new L.Camera;return r.setName("MRTTechnique-HighLightCamera"),r.setEnableFrustumCulling(!0),L.mat4.ortho(r.getProjectionMatrix(),0,e,0,n,-5,5),r.setViewMatrix(L.mat4.create()),r.setRenderOrder(L.Camera.PRE_RENDER,t),r.setReferenceFrame(L.Transform.ABSOLUTE_RF),r.setViewport(new L.Viewport(0,0,e,n)),r.setClearColor(L.vec4.create()),r.setClearMask(L.Camera.DEPTH_BUFFER_BIT),r},generateFinalPassProgram:function(){var e=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","attribute vec3 Vertex;","attribute vec2 TexCoord0;","varying vec2 vTexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","void main(void) {","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","  vTexCoord0 = TexCoord0;","}"].join("\n"),n=["#ifdef GL_ES","precision highp float;","#endif","#extension GL_EXT_draw_buffers : require","varying vec2 vTexCoord0;","uniform vec2 mousePos;","uniform sampler2D Texture0;","uniform sampler2D Texture1;","uniform sampler2D Texture2;","uniform sampler2D Texture3;","uniform sampler2D DepthTexture;","void main (void) {","   vec4 IdsArrayPS = texture2D( Texture2, mousePos);","   vec4 IdsArray2PS = texture2D( Texture3, mousePos);","   vec4 IdsArrayPS_uv = texture2D( Texture2, vTexCoord0.xy);","   vec4 IdsArray2PS_uv = texture2D( Texture3, vTexCoord0.xy);","   bool bEqual = !all(lessThan(abs(IdsArrayPS_uv - IdsArray2PS_uv), vec4(0.8 / 255.0))) &&","       all(lessThan(abs(IdsArrayPS_uv - IdsArrayPS), vec4(0.8 / 255.0))) &&","       all(lessThan(abs(IdsArray2PS_uv - IdsArray2PS).xy, vec2(0.8 / 255.0)));","   vec4 vColor = bEqual ? vec4(1.0, 1.0, 0.0, 0.5) : vec4(0.0);","   vec4 vSceneColor = texture2D(Texture1, vTexCoord0);","   vSceneColor.xyz = mix(vSceneColor.xyz, vColor.xyz, vColor.w);","   gl_FragData[0] = vSceneColor;","}"].join("\n");return new L.Program(new L.Shader("VERTEX_SHADER",e),new L.Shader("FRAGMENT_SHADER",n))},generateHighlightProgram:function(){var e=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","attribute vec3 Vertex;","attribute vec2 TexCoord0;","varying vec2 vTexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","void main(void) {","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","  vTexCoord0 = TexCoord0;","}"].join("\n"),n=["#ifdef GL_ES","precision highp float;","#endif","varying vec2 vTexCoord0;","#ifdef transferHighlightInfoFromCpu2GpuUsingUniform","uniform vec4 IdsArrayPS;","uniform vec4 IdsArray2PS;","uniform vec4 highlightColor;","#else","uniform sampler2D HighlightIdsTexture;","#endif","uniform sampler2D Texture0;","uniform sampler2D Texture1;","uniform sampler2D Texture2;","uniform sampler2D Texture3;","uniform sampler2D DepthTexture;","void main (void) {","#ifndef transferHighlightInfoFromCpu2GpuUsingUniform","   vec4 IdsArrayPS = texture2D( HighlightIdsTexture, vec2(0.25, 0.25));","   vec4 IdsArray2PS = texture2D( HighlightIdsTexture, vec2(0.75, 0.25));","   vec4 highlightColor = texture2D( HighlightIdsTexture, vec2(0.25, 0.75));","#endif","   vec4 IdsArrayPS_uv = texture2D( Texture2, vTexCoord0.xy);","   vec4 IdsArray2PS_uv = texture2D( Texture3, vTexCoord0.xy);","   bool bEqual = !all(lessThan(abs(IdsArrayPS_uv - IdsArray2PS_uv), vec4(0.8 / 255.0))) &&","       all(lessThan(abs(IdsArrayPS_uv - IdsArrayPS), vec4(0.8 / 255.0))) &&","       all(lessThan(abs(IdsArray2PS_uv - IdsArray2PS).xy, vec2(0.8 / 255.0)));","   vec4 vColor = bEqual ? highlightColor : vec4(0.0);","   vec4 vSceneColor = texture2D(Texture1, vTexCoord0);","   vSceneColor.xyz = mix(vSceneColor.xyz, vColor.xyz, vColor.w);","   gl_FragData[0] = vSceneColor;","}"].join("\n"),t="#extension GL_EXT_draw_buffers : require\n";return t+="#define transferHighlightInfoFromCpu2GpuUsingUniform\n",new L.Program(new L.Shader("VERTEX_SHADER",t+e),new L.Shader("FRAGMENT_SHADER",t+n))},generateCopyProgram:function(){var e=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","attribute vec3 Vertex;","attribute vec2 TexCoord0;","varying vec2 vTexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","void main(void) {","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","  vTexCoord0 = TexCoord0;","}"].join("\n"),n=["#ifdef GL_ES","precision highp float;","#endif","#extension GL_EXT_draw_buffers : require","varying vec2 vTexCoord0;","uniform sampler2D Texture1;","void main (void) {","   vec4 vSceneColor = texture2D(Texture1, vTexCoord0);","   gl_FragData[0] = vSceneColor;","}"].join("\n");return new L.Program(new L.Shader("VERTEX_SHADER",e),new L.Shader("FRAGMENT_SHADER",n))},createDebugTextureList:function(e,n){var t=this._canvas.width/this._canvas.height,r=Math.floor(.3*this._canvas.width),a={x:0,y:100,w:r,h:Math.floor(r/t),horizontal:!0,screenW:this._canvas.width,screenH:this._canvas.height};n&&L.extend(a,n);var i=this._debugNodeRTT;i.setNodeMask(-1),i.removeChildren();var o=new L.Node;o.setName("debugComposerNode"),o.setCullingActive(!1);var s=new L.Camera;s.setName("composerDebugCamera"),i.addChild(s);var _=s.getProjectionMatrix();L.mat4.ortho(_,0,a.screenW,0,a.screenH,-5,5);var u=s.getViewMatrix();L.mat4.fromTranslation(u,[0,0,0]),s.setRenderOrder(L.Camera.NESTED_RENDER,0),s.setReferenceFrame(L.Transform.ABSOLUTE_RF),s.addChild(o);var l=a.x,c=a.y;o.getOrCreateStateSet().setAttributeAndModes(new L.Depth("DISABLE"));for(var h=0,d=e.length;h<d;h++){var f=e[h];if(f){var p=L.createTexturedQuadGeometry(l,c,0,a.w,0,0,0,a.h,0),m=p.getOrCreateStateSet();p.setName("debugComposerGeometry"+h),m.setTextureAttributeAndModes(0,f),f.getInternalFormat()!==L.Texture.DEPTH_COMPONENT?m.setAttributeAndModes(this.getDebugProgram()):m.setAttributeAndModes(this.getDebugDepthProgram()),o.addChild(p),a.horizontal?l+=a.w+2:c+=a.h+2}}},getDebugProgram:function(){if(void 0===this._debugProgram){var e=["#define SHADER_NAME DEBUG_RTT","attribute vec3 Vertex;","attribute vec2 TexCoord0;","varying vec2 vTexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","void main(void) {","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex,1.0));","  vTexCoord0 = TexCoord0;","}"].join("\n"),n=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","#define SHADER_NAME DEBUG_RTT","varying vec2 vTexCoord0;","uniform sampler2D Texture0;","","void main (void)","{","  vec2 uv = vTexCoord0;","  gl_FragColor = vec4(texture2D(Texture0, uv));","}"].join("\n");this._debugProgram=new L.Program(new L.Shader("VERTEX_SHADER",e),new L.Shader("FRAGMENT_SHADER",n))}return this._debugProgram},getDebugDepthProgram:function(){if(void 0===this._debugDepthProgram){var e=["#define SHADER_NAME DEBUG_RTT","attribute vec3 Vertex;","attribute vec2 TexCoord0;","varying vec2 vTexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","void main(void) {","  gl_Position = uProjectionMatrix * (uModelViewMatrix * vec4(Vertex,1.0));","  vTexCoord0 = TexCoord0;","}"].join("\n"),n=["#ifdef GL_FRAGMENT_PRECISION_HIGH","precision highp float;","#else","precision mediump float;","#endif","#define SHADER_NAME DEBUG_RTT","varying vec2 vTexCoord0;","uniform sampler2D Texture0;","","void main (void)","{","  vec2 uv = vTexCoord0;","  vec4 color = vec4(texture2D(Texture0, uv));","  gl_FragColor = vec4( color.r, color.r, color.r, 1.0 );","}"].join("\n");this._debugDepthProgram=new L.Program(new L.Shader("VERTEX_SHADER",e),new L.Shader("FRAGMENT_SHADER",n))}return this._debugDepthProgram},createScene:function(){var e=this;e._debugNodeRTT=new L.Node,e._debugNodeRTT.setName("MRTTechnique-debugNodeRTT"),e._debugNodeRTT.getOrCreateStateSet().setRenderBinDetails(1e3,"RenderBin"),e._root.addChild(e._debugNodeRTT);var n=e._canvas.width,t=e._canvas.height,r=e._viewer.getGraphicContext(),a=function(e,a){var i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i);var o=e._textureObject._id;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,o,0);var s=a._textureObject._id;r.bindTexture(r.TEXTURE_2D,s),r.copyTexImage2D(r.TEXTURE_2D,0,r.RGBA,0,0,n,t,0),r.deleteFramebuffer(i),r.bindFramebuffer(r.FRAMEBUFFER,null)};e.NUM_TEXTURES=4;for(var i=0;i<e.NUM_TEXTURES;++i)e._textureList[i]=e.createColorTexture(n,t),e._textureList[i]._name="texturecolor"+i;e.depthTexture=e.createDephTexture(n,t),e._textureList.push(e.depthTexture),e.cushionTexture=e.createColorTexture(n,t);var o=[];for(i=0;i<e._textureList.length;++i)o.push(e._textureList[i]);e.createDebugTextureList(o,{horizontal:!0,y:100,w:1*n/o.length,h:1*t/o.length});var s=new L.Node;s.setName("MRTTechnique-group"),e._root.addChild(s),e._cameraMRTRender=e.createPreRenderCamera(n,t,0),e._cameraMRTRender.addChild(e._node),s.addChild(e._cameraMRTRender),e._cameraMRTRender.attachTexture(r.COLOR_ATTACHMENT0,e._textureList[0],0),e._cameraMRTRender.attachTexture(r.COLOR_ATTACHMENT1,e._textureList[1],0),e._cameraMRTRender.attachTexture(r.COLOR_ATTACHMENT2,e._textureList[2],0),e._cameraMRTRender.attachTexture(r.COLOR_ATTACHMENT3,e._textureList[3],0),e._cameraMRTRender.attachTexture(L.FrameBufferObject.DEPTH_ATTACHMENT,e.depthTexture,0),e._cameraMRTRender.setFinalDrawCallback(a.bind(e,e._textureList[0],e._textureList[1]));var _=new L.Node;_.setName("MRTTechnique-postPass"),s.addChild(_),e.hudCamera=e.createHUDCamera(n,t),e.hudQuad=e.createScreenSpaceQuad(n,t),e.hudCamera.addChild(e.hudQuad);var u=e.hudCamera.getOrCreateStateSet();u.setAttributeAndModes(e.generateFinalPassProgram());var l=L.Uniform.createFloat2([0,0],"mousePos");u.addUniform(l);e._canvas.addEventListener("mousemove",function(e,n){var t=e.width/e.clientWidth,r=e.height/e.clientHeight;l.setFloat2([n.offsetX*t/e.width,(e.clientHeight-n.offsetY)*r/e.height])}.bind(e,e._canvas),!0);for(i=0;i<e.NUM_TEXTURES;++i)u.setTextureAttributeAndModes(i,e._textureList[i]),u.addUniform(L.Uniform.createInt1(i,"Texture"+i));u.setTextureAttributeAndModes(e.NUM_TEXTURES,e.depthTexture),u.addUniform(L.Uniform.createInt1(e.NUM_TEXTURES,"DepthTexture")),_.addChild(e.hudCamera),e.highlightQuad=e.createScreenSpaceQuad(n,t);var c=e.highlightQuad.getOrCreateStateSet();c.setAttributeAndModes(e.generateHighlightProgram());for(i=0;i<e.NUM_TEXTURES;++i)c.setTextureAttributeAndModes(i,e._textureList[i]),c.addUniform(L.Uniform.createInt1(i,"Texture"+i));c.setTextureAttributeAndModes(e.NUM_TEXTURES,e.depthTexture),c.addUniform(L.Uniform.createInt1(e.NUM_TEXTURES,"DepthTexture")),_.addUpdateCallback({update:function(i,o){if(!B._bUpdate)return!0;B._bUpdate=!1;for(var s=1;s<_.getNumChildren();++s)_.children[s].highlightIdsTexture&&_.children[s].highlightIdsTexture.releaseGLObjects();if(_.removeChildren(),_.addChild(e.hudCamera),0===B._highlightObjectsArray.length)return!0;for(var u=B._highlightObjectsArray.length,l=0;l<u;++l){var c=e.createHighLightCamera(n,t,2*l+1);c.attachTexture(r.COLOR_ATTACHMENT0,e.cushionTexture,0),c.addChild(e.highlightQuad),_.addChild(c);var h=c.getOrCreateStateSet(),d=L.Uniform.createFloat4(B._highlightObjectsArray[l]._highlightColor,"highlightColor");h.addUniform(d);var f=L.Uniform.createFloat4(B._highlightObjectsArray[l]._idsElement,"IdsArrayPS");h.addUniform(f);var p=L.Uniform.createFloat4(B._highlightObjectsArray[l]._idsElement2,"IdsArray2PS");h.addUniform(p),c.setFinalDrawCallback(a.bind(e,e.cushionTexture,e._textureList[1]))}return!0}})},resizeScene:function(){var e=this;e.cushionTexture.setTextureSize(e._canvas.width,e._canvas.height);for(var n=0;n<e._textureList.length;++n)e._textureList[n].setTextureSize(e._canvas.width,e._canvas.height);var t=e._cameraMRTRender.getViewport();t&&t.setViewport(0,0,e._canvas.width,e._canvas.height),e._cameraMRTRender.getFrameBufferObject()&&e._cameraMRTRender.getFrameBufferObject().dirty(),e.hudQuad=e.createScreenSpaceQuad(e._canvas.width,e._canvas.height);var r=e.hudCamera.getViewport();r&&r.setViewport(0,0,e._canvas.width,e._canvas.height),e.hudCamera.getFrameBufferObject()&&e.hudCamera.getFrameBufferObject().dirty(),e.hudCamera.removeChildren(),e.hudCamera.addChild(e.hudQuad),e.highlightQuad=e.createScreenSpaceQuad(e._canvas.width,e._canvas.height);var a=e.highlightQuad.getOrCreateStateSet();a.setAttributeAndModes(e.generateHighlightProgram());for(n=0;n<e.NUM_TEXTURES;++n)a.setTextureAttributeAndModes(n,e._textureList[n]),a.addUniform(L.Uniform.createInt1(n,"Texture"+n));if(a.setTextureAttributeAndModes(e.NUM_TEXTURES,e.depthTexture),a.addUniform(L.Uniform.createInt1(e.NUM_TEXTURES,"DepthTexture")),e.highlightCopyQuad){e.highlightCopyQuad=e.createScreenSpaceQuad(e._canvas.width,e._canvas.height);var i=e.highlightCopyQuad.getOrCreateStateSet();i.setAttributeAndModes(e.generateCopyProgram()),i.setTextureAttributeAndModes(1,e.cushionTexture),i.addUniform(L.Uniform.createInt1(1,"Texture1"))}B._bUpdate=!0},clearScene:function(){this._cameraMRTRender.removeChild(this._node),m.releaseGLObjects(this._root),this._cameraMRTRender=void 0,this._root.removeChildren(),this.cushionTexture.releaseGLObjects(),this._textureList=[],B._bUpdate=!0}},S.View.prototype.setSceneData=m.funcCreateProxy(S.View.prototype.setSceneData,(function(e){return(w=new U(this,e))._root})),S.View.prototype.getSceneData=function(){return w._node},m.optimizedResize.add((function(){w&&(w._bResize=!0)}));var k={HighlightObject:function(e){this._idsElement=e.idsElement,this._idsElement2=e.idsElement2,this._highlightColor=e.highlightColor||Float32Array.from([Math.random(),Math.random(),Math.random(),.5])}};k.highlightMgr=B;const W=k;var N=window.P,K=window.OSG,F=K.osg,j=K.osgText,q=K.osgDB,V=function(e){this.debug=!0,this.dispatchMode=e||{version:"1.1.0",url:"http://localhost:8080/geoserver/topp/wms?",srs:"EPSG:4326",layers:"topp:states",centerOffset:[0,0,0],minExtent:[-124.73142200000001,24.955967],maxExtent:[-66.969849,49.371735]}};V.prototype={constructor:V,createTileForGeometry:function(e,n,t,r,a,i,o,s){var _=this,u=F.createTexturedQuadGeometry(n,t,0,r,0,0,0,a,0);u.level=i,u.x=o,u.y=s;var l=n+","+t+","+(n+r)+","+(t+a);_.dispatchMode.srs;var c={request:"getmap",service:"wms",BBOX:l,srs:_.dispatchMode.srs,format:"image/jpeg",layers:_.dispatchMode.layers,width:256,height:256,version:_.dispatchMode.version},h=_.dispatchMode.url+jQuery.param(c);return new N((function(l,c){q.readImageURL(h,{imageCrossOrigin:!0}).then((function(c){var h=new F.Texture;if(h.setMinFilter("LINEAR"),h.setMagFilter("LINEAR"),h.setImage(c),u.getOrCreateStateSet().addUniform(F.Uniform.createInt1(0,"Texture0")),u.getOrCreateStateSet().setTextureAttributeAndModes(0,h),_.debug){var d=new F.Material,f=[];f.push(F.vec4.fromValues(1,0,0,1)),f.push(F.vec4.fromValues(0,1,0,1)),f.push(F.vec4.fromValues(0,0,1,1)),f.push(F.vec4.fromValues(1,1,0,1)),d.setAmbient(f[e]),u.getOrCreateStateSet().setAttributeAndModes(d);var p=new j.Text(i+"-"+o+"-"+s);p.setColor(F.vec4.fromValues(1,1,0,1)),p.setFont("MS YaHei"),p.setAlignment(2),p.setCharacterSize(50);var m=n+.5*r,g=t+.5*a;p.setPosition([m,g,0]),p.setAutoRotateToScreen(!0),p.setAutoScaleToScreen(!0),p.getOrCreateStateSet().setAttributeAndModes(new F.Depth("ALWAYS",void 0,void 0,!1));var v=new F.Node;v.addChild(u),v.addChild(p),v.level=u.level,v.x=u.x,v.y=u.y,l(v)}else l(u)}),(function(){c()}))}))},subTileLevelRowCol:function(e,n,t,r){var a=0,i=0;return 1===e?a=1:2===e?i=1:3===e&&(a=1,i=1),{sLevel:n+1,sCol:2*r+a,sRow:2*t+i}},levelRowColToXYWidthHeight:function(e,n,t,r){var a=n-e,i=this.computeExtent(a,t,r),o=i.maxx-i.minx,s=i.maxy-i.miny;return{x:i.minx,y:i.miny,width:o,height:s}},computeExtent:function(e,n,t){var r=1<<e,a=(this.dispatchMode.maxExtent[0]-this.dispatchMode.minExtent[0])/r,i=(this.dispatchMode.maxExtent[1]-this.dispatchMode.minExtent[1])/r,o=this.dispatchMode.minExtent[0]+n*a,s=this.dispatchMode.minExtent[1]+t*i;return{minx:o,miny:s,maxx:o+a,maxy:s+i}},load:function(){if(this.dispatchMode){var e=this,n=function(t){for(var r=[],a=new F.Node,i=0;i<4;i++){var o=e.subTileLevelRowCol(i,t.level,t.x,t.y),s=e.levelRowColToXYWidthHeight(0,o.sLevel,o.sRow,o.sCol),_=e.createTileForGeometry(i,s.x,s.y,s.width,s.height,o.sLevel,o.sRow,o.sCol);r.push(_),_.then((function(e){var r=new F.PagedLOD;r.level=e.level,r.x=e.x,r.y=e.y,r.addChild(e,t._range[0][0]/2,t._range[0][1]/2),r.setFunction(1,n),r.setRange(1,t._range[1][0]/2,t._range[1][1]/2),a.addChild(r)}))}return N.all(r).then((function(){return a}))},t=new F.MatrixTransform,a=new F.Program(new F.Shader("VERTEX_SHADER",r.simpleSampleShader.vertexShader),new F.Shader("FRAGMENT_SHADER",r.simpleSampleShader.fragmentShader));t.getOrCreateStateSet().setAttributeAndModes(a),t.getOrCreateStateSet().addUniform(F.Uniform.createInt1(0,"Texture0"),F.StateAttribute.ON),F.mat4.fromTranslation(t.getMatrix(),F.vec3.fromValues(e.dispatchMode.centerOffset[0],e.dispatchMode.centerOffset[1],e.dispatchMode.centerOffset[2]));var i=Math.max(e.dispatchMode.maxExtent[0]-e.dispatchMode.minExtent[0],e.dispatchMode.maxExtent[1]-e.dispatchMode.minExtent[1]);return e.createTileForGeometry(0,e.dispatchMode.minExtent[0],e.dispatchMode.minExtent[1],e.dispatchMode.maxExtent[0]-e.dispatchMode.minExtent[0],e.dispatchMode.maxExtent[1]-e.dispatchMode.minExtent[1],0,0,0).then((function(e){var r=new F.PagedLOD;r.level=e.level,r.x=e.x,r.y=e.y,r.addChild(e,i,3*i),r.setFunction(1,n),r.setRange(1,0,i),t.addChild(r)})),t}}};const G=V;var z=__webpack_require__(1383),H=__webpack_require__.n(z);H().defs("EPSG:32760","+proj=utm +zone=60 +south +datum=WGS84 +units=m +no_defs");var X=window.P,Y=window.OSG,Z=Y.osg,Q=Y.osgDB,$="EPSG:4326",J=function(e){this._zoom=e.zoom,this._x=e.x,this._y=e.y,this._lonlatLeftTop=e.lonlatLeftTop,this._lonlatRightBottom=e.lonlatRightBottom,this._showLeftTop=e.showLeftTop,this._showRightBottom=e.showRightBottom},ee=function(e){"string"==typeof e.mapsImageryProvider&&(e.mapsImageryProvider=new ee[e.mapsImageryProvider]),this._dispatchMode=e};ee.prototype={constructor:ee,createGeometryForTile:function(e){var n=this,t=Z.createTexturedQuadGeometry(e._showLeftTop.x,e._showRightBottom.y,0,e._showRightBottom.x-e._showLeftTop.x,0,0,0,e._showLeftTop.y-e._showRightBottom.y,0);t.tile=e;var r="";return r=n._dispatchMode.url.indexOf("?")?n._dispatchMode.url+n._dispatchMode.mapsImageryProvider.getTileName(e):n._dispatchMode.url+e._zoom+"/"+e._x+"/"+e._y+".png",new X((function(e,n){Q.readImageURL(r,{imageCrossOrigin:!0}).then((function(r){var a=new Z.Texture;a.setMinFilter("LINEAR"),a.setMagFilter("LINEAR"),a.setImage(r),t.getOrCreateStateSet().addUniform(Z.Uniform.createInt1(0,"Texture0")),t.getOrCreateStateSet().setTextureAttributeAndModes(0,a);r._mipmap&&r._mipmap[0]&&"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQIW2P8DwQACgAD/il4QJ8AAAAASUVORK5CYII="===r._mipmap[0].src?n():e(t)}),(function(){n()}))}))},load:function(){if(this._dispatchMode){var e=this,n=function(t){var r=[],a=new Z.Node,i=t.tile;if(!(i._zoom>=e._dispatchMode.maxZoom)){for(var o=e._dispatchMode.mapsImageryProvider.getTilesFromRange(i._lonlatLeftTop,i._lonlatRightBottom,i._zoom+1),s=0;s<o.length;s++){var _=e.createGeometryForTile(o[s]);_=_.catch((function(){})),r.push(_),_.then((function(e){var r=new Z.PagedLOD;r.tile=e.tile,r.addChild(e,t._range[0][0]/2,Number.MAX_VALUE),r.setFunction(1,n),r.setRange(1,t._range[1][0]/2,t._range[1][1]/2),a.addChild(r)}),(function(){}))}return X.all(r).then((function(){return a}))}},t=new Z.MatrixTransform,a=new Z.Program(new Z.Shader("VERTEX_SHADER",r.simpleSampleShader.vertexShader),new Z.Shader("FRAGMENT_SHADER",r.simpleSampleShader.fragmentShader));t.getOrCreateStateSet().setAttributeAndModes(a),t.getOrCreateStateSet().addUniform(Z.Uniform.createInt1(0,"Texture0"),Z.StateAttribute.ON),Z.mat4.fromTranslation(t.getMatrix(),Z.vec3.fromValues(e._dispatchMode.centerOffset[0],e._dispatchMode.centerOffset[1],e._dispatchMode.centerOffset[2]));for(var i=e._dispatchMode.mapsImageryProvider.getTilesFromRange(e._dispatchMode.lonlat0,e._dispatchMode.lonlat1,e._dispatchMode.minZoom,!0),o=0;o<i.length;++o)e.createGeometryForTile(i[o]).then((function(e){var r=new Z.PagedLOD;r.tile=e.tile;var a=2*Math.max(e.tile._showRightBottom.x-e.tile._showLeftTop.x,e.tile._showLeftTop.y-e.tile._showRightBottom.y);r.addChild(e,a,Number.MAX_VALUE),r.setFunction(1,n),r.setRange(1,0,a),t.addChild(r)}),(function(e){}));return t}}};var ne=function(){};ne.prototype={constructor:ne,getTilesFromRange:function(e,n,t,r){var a=H()("EPSG:4326","EPSG:3857",e),i=H()("EPSG:4326","EPSG:3857",n),o=Math.pow(2,t-18),s=Math.pow(2,18-t),_=Math.floor(a.x*o),u=Math.ceil(a.y*o),l=Math.ceil(i.x*o),c=Math.floor(i.y*o),h=Math.floor(_/256),d=Math.ceil(u/256),f=Math.ceil(l/256),p=Math.floor(c/256),m=[];r&&(this.lonlat0=H()("EPSG:3857","EPSG:4326",{x:256*h*s,y:256*d*s}),this.lonlat1=H()("EPSG:3857","EPSG:4326",{x:256*f*s,y:256*p*s}),this.lonlatWidthHeight={x:this.lonlat0.x-this.lonlat1.x,y:this.lonlat0.y-this.lonlat1.y},this.showLeftTop0=H()("EPSG:4326",$,{x:this.lonlat0.x,y:this.lonlat0.y}),this.showRightBottom0=H()("EPSG:4326",$,{x:this.lonlat1.x,y:this.lonlat1.y}),this.showWidthHeight={x:this.showLeftTop0.x-this.showRightBottom0.x,y:this.showLeftTop0.y-this.showRightBottom0.y});for(var g=h;g<f;++g)for(var v=p;v<d;++v){var E=H()("EPSG:3857","EPSG:4326",{x:256*g*s,y:256*(v+1)*s}),b=H()("EPSG:3857","EPSG:4326",{x:256*(g+1)*s,y:256*v*s}),M={x:(this.lonlat0.x-E.x)/this.lonlatWidthHeight.x,y:(this.lonlat0.y-E.y)/this.lonlatWidthHeight.y},y={x:(this.lonlat0.x-b.x)/this.lonlatWidthHeight.x,y:(this.lonlat0.y-b.y)/this.lonlatWidthHeight.y},O=new J({zoom:t,x:g,y:v,lonlatLeftTop:E,lonlatRightBottom:b,showLeftTop:{x:this.showLeftTop0.x-M.x*this.showWidthHeight.x,y:this.showLeftTop0.y-M.y*this.showWidthHeight.y},showRightBottom:{x:this.showLeftTop0.x-y.x*this.showWidthHeight.x,y:this.showLeftTop0.y-y.y*this.showWidthHeight.y}});m.push(O)}return m},getTileName(e){var n={qt:"tile",x:e._x,y:e._y,z:e._zoom,styles:"pl",scaler:1,udt:"20141103"};return jQuery.param(n)}};var te=function(){};te.prototype={constructor:te,getTilesFromRange:function(e,n,t,r){var a=H().defs("EPSG:3857").a,i=H()("EPSG:4326","EPSG:3857",{x:e.x,y:-e.y}),o=H()("EPSG:4326","EPSG:3857",{x:n.x,y:-n.y});i.x-=-Math.PI*a,i.y-=-Math.PI*a,o.x-=-Math.PI*a,o.y-=-Math.PI*a;var s=2*Math.PI*a/Math.pow(2,t),_=1/s,u=i.x*_,l=i.y*_,c=o.x*_,h=o.y*_,d=Math.floor(u),f=Math.floor(l),p=Math.ceil(c),m=Math.ceil(h),g=[];r&&(this.lonlat0=H()("EPSG:3857","EPSG:4326",{x:d*s-Math.PI*a,y:f*s-Math.PI*a}),this.lonlat1=H()("EPSG:3857","EPSG:4326",{x:p*s-Math.PI*a,y:m*s-Math.PI*a}),this.lonlat0.y=-this.lonlat0.y,this.lonlat1.y=-this.lonlat1.y,this.lonlatWidthHeight={x:this.lonlat0.x-this.lonlat1.x,y:this.lonlat0.y-this.lonlat1.y},this.showLeftTop0=H()("EPSG:4326",$,{x:this.lonlat0.x,y:this.lonlat0.y}),this.showRightBottom0=H()("EPSG:4326",$,{x:this.lonlat1.x,y:this.lonlat1.y}),this.showWidthHeight={x:this.showLeftTop0.x-this.showRightBottom0.x,y:this.showLeftTop0.y-this.showRightBottom0.y});for(var v=d;v<p;++v)for(var E=f;E<m;++E){var b=H()("EPSG:3857","EPSG:4326",{x:v*s-Math.PI*a,y:E*s-Math.PI*a}),M=H()("EPSG:3857","EPSG:4326",{x:(v+1)*s-Math.PI*a,y:(E+1)*s-Math.PI*a});b.y=-b.y,M.y=-M.y;var y={x:(this.lonlat0.x-b.x)/this.lonlatWidthHeight.x,y:(this.lonlat0.y-b.y)/this.lonlatWidthHeight.y},O={x:(this.lonlat0.x-M.x)/this.lonlatWidthHeight.x,y:(this.lonlat0.y-M.y)/this.lonlatWidthHeight.y},P=new J({zoom:t,x:v,y:E,lonlatLeftTop:b,lonlatRightBottom:M,showLeftTop:{x:this.showLeftTop0.x-y.x*this.showWidthHeight.x,y:this.showLeftTop0.y-y.y*this.showWidthHeight.y},showRightBottom:{x:this.showLeftTop0.x-O.x*this.showWidthHeight.x,y:this.showLeftTop0.y-O.y*this.showWidthHeight.y}});g.push(P)}return g},getTileName:e=>""},ee.BaiduMapsImageryProvider=ne,ee.GaodeMapsImageryProvider=te;const re=ee;var ae=function(e){this.mapId2Marker=new Map};ae.prototype={constructor:ae,addMarker:function(e,n){var t=document.createElement("div");t.classList.add("picking"),t.style.position="absolute",t.markerOptions=n,t.setAttribute("id",e);var r=document.createElement("p");r.innerHTML=n.name,t.append(r);var a=document.createElement("img");return a.setAttribute("width","96px"),a.setAttribute("height","72px"),a.src=n.markImage,t.append(a),document.body.append(t),t},deleteMarker:function(e){for(var n=document.body.getElementsByClassName("picking"),t=[],r=0;r<n.length;++r)e===n[r].markerOptions.id&&t.push(n[r]);for(r=0;r<t.length;++r)document.body.removeChild(t[r])},deleteAllMarker:function(e){for(var n=document.body.getElementsByClassName("picking");n.length>0;)document.body.removeChild(n[0])}},ae.onFrameCallbackUpdateOverlay=function(e){for(var n=document.getElementById("View"),t=document.body.getElementsByClassName("picking"),r=0;r<t.length;++r){var a=t[r],i=a.markerOptions.coordinates,o=m.projectToScreen(window.viewer.getCamera(),i);o?(a.style.display="",o[1]=n.height-o[1],a.style.transform="translate3d("+o[0]+"px,"+o[1]+"px, 0)"):a.style.display="none"}};const ie=ae;var oe=__webpack_require__(5108),se=(window.P,window.OSG),_e=se.osg,ue=se.osgDB;document.write('<script src="js/three.min.js"><\/script>'),document.write('<script src="js/panolens-offline.js"><\/script>');var le,ce,he=function(e,n,t,a){var i=function(){_e.NodeVisitor.call(this)};i.prototype=_e.objectInherit(_e.NodeVisitor.prototype,{apply:function(e){if(e.getPrimitiveSetList){for(var n=e.getVertexAttributeList().Normal.getElements(),t=0;t<n.length/3;++t)n[3*t+0]=-n[3*t+0],n[3*t+1]=-n[3*t+1],n[3*t+2]=-n[3*t+2];var r=e.getVertexAttributeList().TexCoord0.getElements();for(t=0;t<r.length/2;++t)r[2*t+0]=1-r[2*t+0]}}});var o=new _e.MatrixTransform;_e.mat4.fromTranslation(o.getMatrix(),t);var s=_e.createTexturedSphere(e,64,32);s.accept(new i);var _=s.getOrCreateStateSet();_.setAttributeAndModes(new _e.CullFace("DISABLE"));var u=new _e.MatrixTransform;_e.mat4.fromRotation(u.getMatrix(),Math.PI/2,[1,0,0]),ue.readImageURL(n).then((function(e){var n=new _e.Texture;n.setImage(e),n.setWrapT("REPEAT"),n.setWrapS("REPEAT"),n.setMinFilter("LINEAR_MIPMAP_LINEAR"),n.setMagFilter("LINEAR"),_.setTextureAttributeAndModes(0,n),_.addUniform(_e.Uniform.createInt1(0,"Texture0"),_e.StateAttribute.ON),u.addChild(s),a&&a(o)}));var l=new _e.Program(new _e.Shader("VERTEX_SHADER",r.simpleSampleShader.vertexShader),new _e.Shader("FRAGMENT_SHADER",r.simpleSampleShader.fragmentShader));return _.setAttributeAndModes(l),o.addChild(u),o},de=function(e){};de.prototype={constructor:de,load:function(e){e.url&&ue.readNodeURL(e.url).then((function(e){for(var n=new Map,t=0;t<e.features.length;++t){var r=e.features[t];if("Point"===r.geometry.type){var a={};for(var i in a.name=r.properties.name,a.description=r.properties.description,a.coordinates=r.geometry.coordinates,a.panoramaImage=r.properties.panoramaImage,a.linkPanoramaImage=r.properties.linkPanoramaImage,a.marks=[],r.properties)if("name"!==i&&"description"!==i&&"panoramaImage"!==i&&"linkPanoramaImage"!==i){var o={};o.name=i,o.coordinates=r.properties[i],a.marks.push(o)}n.set(r.id,a)}}return n})).then((function(e){oe.log(e);var n=new _e.Node;for(var t of e)he(1e3,t[1].panoramaImage,t[1].coordinates,(function(e){n.addChild(e)}));window.rootNode.addChild(n)}))},unload:function(){document.querySelector("#ViewContainer").style.display="",document.querySelector(".panolens-container").style.display="none";var e=document.querySelector(".panolens-container");e&&e.parentElement.removeChild(e)}};var fe=function(e,n,t){Array.isArray(e)||(e=[e]),0!==e.length&&ue.readImageURL(e[0],{imageCrossOrigin:!0}).then((function(r){n.setImage(r),n.setWrapT("REPEAT"),n.setWrapS("REPEAT"),n.setMinFilter("LINEAR_MIPMAP_LINEAR"),n.setMagFilter("LINEAR"),t&&t(),e=e.slice(1),fe(e,n)}))},pe=(he=function(e,n,t,r){var a=function(){_e.NodeVisitor.call(this)};a.prototype=_e.objectInherit(_e.NodeVisitor.prototype,{apply:function(e){if(e.getPrimitiveSetList){for(var n=e.getVertexAttributeList().Normal.getElements(),t=0;t<n.length/3;++t)n[3*t+0]=-n[3*t+0],n[3*t+1]=-n[3*t+1],n[3*t+2]=-n[3*t+2];var r=e.getVertexAttributeList().TexCoord0.getElements();for(t=0;t<r.length/2;++t)r[2*t+0]=1-r[2*t+0]}}});var i=_e.createTexturedSphere(e,64,32);i.accept(new a);var o=new _e.MatrixTransform;_e.mat4.fromRotation(o.getMatrix(),Math.PI/2,[1,0,0]),o.addChild(i);var s=new _e.MatrixTransform;_e.mat4.fromTranslation(s.getMatrix(),t),s.addChild(o);var _=le.getOrCreateStateSet().getTextureAttribute(0,"Texture");return fe(n,_,(function(){r&&r(s)})),s},function(e){oe.log(e.currentTarget.innerText);var n=e.currentTarget.markerOptions.id;this.switchPanorama(n)}),me=function(e){this.markerLayer=new ie};me.prototype={constructor:me,loadPanorama:function(e){var n=this;(le=new _e.Node).setName("PanoramaLayer"),window.rootNode.addChild(le);var t=le.getOrCreateStateSet();t.setAttributeAndModes(new _e.CullFace("DISABLE"));var a=new _e.Program(new _e.Shader("VERTEX_SHADER",r.simpleSampleShader.vertexShader),new _e.Shader("FRAGMENT_SHADER",r.simpleSampleShader.fragmentShader));t.setAttributeAndModes(a);var i=new _e.Texture;t.setTextureAttributeAndModes(0,i),t.addUniform(_e.Uniform.createInt1(0,"Texture0"),_e.StateAttribute.ON),ue.requestFile(e.url).then((function(e){var t;try{t=JSON.parse(e)}catch(e){oe.error("cannot parse url: "+url),oe.error(e)}if(t){oe.log(t);for(var r=(ce=t).panoramas,a=0,i=0;i<r.length;++i)for(var o=r[i],s=0;s<o.marks.length;++s){(u=o.marks[s]).id=++a}o=r[0],he(ce.radius,o.panoramaImage,ce.singleSphere?ce.coordinates:o.coordinates,function(e){le.addChild(e)}.bind(o));for(var _=0;_<o.marks.length;++_){var u=o.marks[_];n.markerLayer.addMarker(u.id,u).addEventListener("click",pe.bind(n))}A.locate(window.viewer,ce.coordinates,!1)}}))},switchPanorama:function(e){for(var n,t,r=this,a=ce.panoramas,i=0,o=!1;i<a.length;++i){for(var s=a[i],_=0;_<s.marks.length;++_){if(e===(l=s.marks[_]).id){t=l,n=s,o=!0;break}}if(o)break}if(n&&t){for(var u=0;u<n.marks.length;++u){var l=n.marks[u];r.markerLayer.deleteMarker(l.id)}for(i=0;i<a.length;++i){s=a[i];if(t.name===s.name){if(ce.singleSphere){var c=le.getOrCreateStateSet().getTextureAttribute(0,"Texture");fe(s.panoramaImage,c)}else he(ce.radius,s.panoramaImage,ce.singleSphere?ce.coordinates:s.coordinates,function(e){le.getChildren().forEach((function(e){m.releaseGLObjects(e)})),le.removeChildren(),le.addChild(e),A.locate(window.viewer,ce.coordinates,!1)}.bind(s));for(_=0;_<s.marks.length;++_){l=s.marks[_];r.markerLayer.addMarker(l.id,l).addEventListener("click",pe.bind(r))}return}}}},unloadPanorama:function(){this.markerLayer.deleteAllMarker(),m.releaseGLObjects(le),le.removeChildren(),window.rootNode.removeChild(le),le=void 0}};const ge=me,ve=new WeakMap;function Ee(e,n,t){const r=ve.get(e);if(!r)return[];if(!n&&!t)return r.slice();if(!r[n])return[];if(!t||t===Event.AT_TARGET)return r[n].slice();if(t===Event.CAPTURING_PHASE)return r[n].filter((e=>e.capture));if(t===Event.BUBBLING_PHASE)return r[n].filter((e=>!e.capture));throw new Error("Illegal event phase for getEventListeners: phase can only be Event.BUBBLING_PHASE, Event.CAPTURING_PHASE, or Event.AT_TARGET.")}function be(e,n,t){return e.findIndex((e=>e.listener===n&&e.capture===t))}function Me(e,n,t,r){let a=ve.get(e);a||ve.set(e,a={});let i=a[n]||(a[n]=[]);if(-1!==be(i,t,!!(r instanceof Object?r.capture:r)))return null;const o=function(e,n,t,r){const a=r instanceof Object?Object.assign({},r,{listener:t,type:n}):{listener:t,type:n,capture:!!r};return a.capture=!!a.capture,a.bubbles=!!a.bubbles,a.once=!!a.once,a.passive=!!a.passive,a.target=e,Object.defineProperty(a,"removed",{get:function(){return Oe.has(this)}}),Object.freeze(a),a}(e,n,t,r);return i.push(o),o}const ye=new WeakMap,Oe=new WeakSet;let Pe,xe;Element.prototype._addEventListener=Element.prototype.addEventListener,Element.prototype._removeEventListener=Element.prototype.removeEventListener,Element.prototype.addEventListener=function(e,n,t=!1){this._addEventListener(e,n,t),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]),this.eventListenerList[e].push({type:e,listener:n,useCapture:t})},Element.prototype.removeEventListener=function(e,n,t=!1){this._removeEventListener(e,n,t),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]);for(let r=0;r<this.eventListenerList[e].length;r++)if(this.eventListenerList[e][r].listener===n&&this.eventListenerList[e][r].useCapture===t){this.eventListenerList[e].splice(r,1);break}0==this.eventListenerList[e].length&&delete this.eventListenerList[e]},Element.prototype.getEventListeners=function(e){return this.eventListenerList||(this.eventListenerList={}),void 0===e?this.eventListenerList:this.eventListenerList[e]};var De=__webpack_require__(5108);window.getEventListeners=function(){function e(e){let n=ye.get(e)||e.listener;xe.call(e.target,e.type,n,e)}return Pe=EventTarget.prototype.addEventListener,xe=EventTarget.prototype.removeEventListener,Object.defineProperty(EventTarget.prototype,"addEventListener",{value:function(n,t,r){const a=Me(this,n,t,r);a&&function(n){let t=n.target,r=n.type,a=n.listener,i=n;n.once&&(i=Object.assign({},i),i.once=!1,a=function(t){e(n),n.listener.call(this,t)},ye.set(n,a)),Pe.call(t,r,a,i)}(a)}}),Object.defineProperty(EventTarget.prototype,"removeEventListener",{value:function(n,t,r){const a=function(e,n,t,r){let a=ve.get(e);if(!a)return null;let i=a[n];if(!i)return null;const o=be(i,t,!!(r instanceof Object?r.capture:r));return-1===o?null:i.splice(o,1)[0]}(this,n,t,r);a&&(Oe.add(a),e(a))}}),Ee}();SpatiotemporalPlatform.urliMyGIS,SpatiotemporalPlatform.urlData;var Te,Ae,Ce=window.P,we=OSG.osg,Re=(OSG.osgShader,OSG.osgDB),Ie=OSG.osgViewer,Le=(OSG.Options,OSG.osgGA,OSG.osgUtil),Se=OSG.osgWrappers,Be=OSG.osgStats,Ue=function(){we.NodeVisitor.call(this,we.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._a=Math.random(),this._b=Math.random()};Ue.prototype=we.objectInherit(we.NodeVisitor.prototype,{apply:function(e){if(e._perRangeDataList);else if(e.getPrimitiveSetList)return void this.applyGeometry(e);this.traverse(e)},applyGeometry:function(e){var n=e.getVertexAttributeList().Vertex,t=n.getElements().length/n.getItemSize(),r=function(e,n){for(var t=new Float32Array(4*e),r=0,a=e;r<a;++r)t[4*r+0]=n,t[4*r+1]=n,t[4*r+2]=n,t[4*r+3]=n;return t};if(e.getVertexAttributeList().IdsArray=new we.BufferArray("ARRAY_BUFFER",r(t,this._a),4),e.getVertexAttributeList().IdsArray2=new we.BufferArray("ARRAY_BUFFER",r(t,this._b),4),e.getOrCreateStateSet().addUniform(we.Uniform.createFloat(e.getVertexAttributeList().TexCoord3?1:0,"uSplicingImageThreshold")),!!e.getVertexAttributeList().InstMatR1&&null!=e.getVertexAttributeList().InstMatR1.getAttributeDivisor()){var a=new BoundingBox;e.computeBoundingBox(a);for(var i=e.getAttributes().InstMatR1._elements,o=e.getAttributes().InstMatR2._elements,s=e.getAttributes().InstMatR3._elements,_=e.getAttributes().InstMatR4._elements,u=new BoundingBox,l=mat4.create(),c=0;c<i.length/4;++c){l=mat4.fromValues(i[0+4*c],i[1+4*c],i[2+4*c],i[3+4*c],o[0+4*c],o[1+4*c],o[2+4*c],o[3+4*c],s[0+4*c],s[1+4*c],s[2+4*c],s[3+4*c],_[0+4*c],_[1+4*c],_[2+4*c],_[3+4*c]);var h=new BoundingBox;a.transformMat4(h,l),u.expandByBoundingBox(h)}e.setBound(u)}we.Geometry.compile(e),we.Geometry.hideEntity({node:e,loading:!0})}});(function(){we.Texture.prototype.setImageFormat;we.Texture.prototype.setImageFormat=function(e){var n=e;n?("string"==typeof n&&(n=we.Texture[n]),this._imageFormat=n):this._image&&this._image.format?(this._imageFormat=this._image.format,this.setInternalFormat(this._image.format)):this._imageFormat=we.Texture.RGBA};var e=we.Texture.prototype.checkIsCompressed;we.Texture.prototype.checkIsCompressed=function(n){switch(n||this._internalFormat){case 33777:case 33778:case 33779:case 33780:return!0;default:return e.apply(this,arguments)}};var n=we.PagedLOD.prototype.addChildNode;we.PagedLOD.prototype.addChildNode=function(e){e&&n.apply(this,arguments)},Se.osg.StateSet=m.funcProxyPromise(Se.osg.StateSet,(function(){var e=arguments[1],n=e.getTextureAttribute(0,"Texture");if(void 0!==n){var t=n.getImage();void 0!==t&&(e.addUniform(we.Uniform.createFloat2(we.vec2.fromValues(t.getWidth(),t.getHeight()),"uTextureSize")),33779===t.format&&e.setRenderingHint("TRANSPARENT_BIN"))}else De.error("texture lost");return e})),Se.osg.Texture=function(e,n){var t=e.getJSON();Se.osg.Object(e,n),t.MinFilter&&n.setMinFilter(t.MinFilter),t.MagFilter&&n.setMagFilter(t.MagFilter),t.WrapT&&n.setWrapT(t.WrapT),t.WrapS&&n.setWrapS(t.WrapS);var r=t.File;return void 0===r&&(r="no-image-provided"),r=e.computeURL(r),Re.readImageURL(r).then((function(e){return e&&!e.hasMipmap()&&(9987===n.getMinFilter()&&n.setMinFilter(9729),De.warn(e._url+" 缺失Mipmap数据")),n.setImage(e),n}))}})(),Le.IntersectFunctor.Intersection=m.funcProxy((function(){this._ids={}}),Le.IntersectFunctor.Intersection),Le.IntersectFunctor.prototype.operatorTriangle=function(){var e=we.vec3,n=we.mat4,t=e.create(),r=e.create(),a=e.create(),i=e.create(),o=e.create(),s=e.create(),_=n.create(),u=e.create(),l=e.create(),c=e.create(),h=e.create(),d=e.create();return function(f,p,m){if(!(this._limitOneIntersection&&this._hit||0==(this._primitiveMask&Le.TRIANGLE_PRIMITIVES))){var g=this._vertices;e.set(t,g[3*f],g[3*f+1],g[3*f+2]),e.set(r,g[3*p],g[3*p+1],g[3*p+2]),e.set(a,g[3*m],g[3*m+1],g[3*m+2]);var v=this._geometry.getVertexAttributeList(),E=v.IdsArray?v.IdsArray._elements:void 0,b=v.IdsArray2?v.IdsArray2._elements:void 0;if(v.InstMatR1){for(var y=v.InstMatR1._elements,O=v.InstMatR2._elements,P=v.InstMatR3._elements,x=v.InstMatR4._elements,D=!1,T=this._geometry.getOrCreateStateSet().getUserData(),A=this._intersectionVisitor.nodePath[0],C=0;C<T.length;++C)if("uBillboard"===T[C].Name&&"1"===T[C].Value){if(A.getViewMatrix){var w=A.getViewMatrix();n.getLookAt(u,l,c,w),D=!0}break}for(var R=0;R<y.length/4;++R){if(D){e.set(h,x[0+4*R],x[1+4*R],x[2+4*R]),e.set(d,h[0]-u[0],h[1]-u[1],0);var I=e.length(d)+1e-6,L=d[0]/I,S=d[1]/I;_=n.fromValues(S,-L,0,0,L,S,0,0,0,0,1,0,0,0,0,1),e.transformMat4(i,t,_),e.transformMat4(o,r,_),e.transformMat4(s,a,_),e.add(i,h,i),e.add(o,h,o),e.add(s,h,s)}else _=n.fromValues(y[0+4*R],y[1+4*R],y[2+4*R],y[3+4*R],O[0+4*R],O[1+4*R],O[2+4*R],O[3+4*R],P[0+4*R],P[1+4*R],P[2+4*R],P[3+4*R],x[0+4*R],x[1+4*R],x[2+4*R],x[3+4*R]),e.transformMat4(i,t,_),e.transformMat4(o,r,_),e.transformMat4(s,a,_);let l={};E&&(l.layerId=E[3*R+0],l.schemeId=E[3*R+1],l.objectId=E[3*R+2]),this.intersectTriangle(i,o,s,f,p,m,l),this._primitiveIndex++}}else{let e={};E&&b&&(e.idsParsed=M.Ids.decodeIdsFromArray(E.slice(4*f,4*f+4),b.slice(4*f,4*f+4)),e.idsElement=E.slice(4*f,4*f+4),e.idsElement2=b.slice(4*f,4*f+4)),this.intersectTriangle(t,r,a,f,p,m,e,this._intersector.getIntersections().length),this._primitiveIndex++}}}}(),Le.LineSegmentIntersectFunctor.prototype.intersectTriangle=m.funcProxy((function(e,n,t,r,a,i,o,s){var _=this._intersector.getIntersections();1+s===_.length&&o&&(_[_.length-1]._ids=o)}),Le.LineSegmentIntersectFunctor.prototype.intersectTriangle),Le.IntersectionVisitor.prototype.apply=function(e){e.getViewMatrix?this.applyCamera(e):e.getMatrix?this.applyTransform(e):e.setAllChildrenOff?this.applySwitch(e):this.applyNode(e)},Le.IntersectionVisitor.prototype.applyPagedLOD=function(e){if(this.enter(e)&&0!==e._perRangeDataList.length){var n;n=e._rangeMode===Lod.DISTANCE_FROM_EYE_POINT?1e6:0;for(let t=0;t<e._range.length;++t)e._rangeMode===Lod.DISTANCE_FROM_EYE_POINT?e._range[t][0]<n&&(n=e._range[t][0]):e._range[t][0]>n&&(n=e._range[t][0]);var t=0;for(let a=0;a<e._range.length;++a,t++){var r;e._range[a][0]==n&&(e.getNumChildren()>t&&(r=e.getChild(t)),!r&&e.getNumChildren()>0&&(r=e.getChild(e.getNumChildren()-1)),r&&r.accept(this))}}},Le.IntersectionVisitor.prototype.applySwitch=function(e){if(this.enter(e)){var n=e.children.length;e._values.length<n&&(n=e._values.length);for(var t=0;t<n;++t)!0===e._values[t]&&e.children[t].accept(this)}};var ke,We=function(){var e=new Set,n=function(e,n,t){return 1e3*e*1e5+1e5*n+t},t=function(e){we.NodeVisitor.call(this,we.NodeVisitor.TRAVERSE_ALL_CHILDREN),this._alpha=e};t.prototype=we.objectInherit(we.NodeVisitor.prototype,{apply:function(e){e.getPrimitiveSetList?this.applyGeometry(e):this.traverse(e)},applyGeometry:function(t){var r=t.getAttributes().IdsArray,a=t.getVertexAttributeList().HighlightColor;if(r&&a){for(var i=r.getElements(),o=a.getElements(),s=0;s<o.length/4;++s){var _=n(i[3*s+0],i[3*s+1],i[3*s+2]);o[4*s+3]=e.has(_)?this._alpha:0}a.dirty()}}});var r=function(e,n){e=e||Ae;var r=new t(n||.5);e.accept(r)},a=function(){};a.prototype={update:function(e,n){var r=n.getFrameStamp().getSimulationTime(),a=new t(r=r%3/3);e.accept(a)}};var i=new a;return Se.osg.Geometry=m.funcProxyPromise(Se.osg.Geometry,(function(){var e=arguments[1],n=0,t=e.getVertexAttributeList().IdsArray;if(t)n=t.getElements().length/t.getItemSize();else{var a=e.getVertexAttributeList().Vertex;n=a.getElements().length/a.getItemSize()}if(0!==n){var i=new we.BufferArray("ARRAY_BUFFER",function(e){for(var n=new Float32Array(4*e),t=0,r=e;t<r;t++)n[4*t+0]=1,n[4*t+1]=1,n[4*t+2]=0,n[4*t+3]=0;return n}(n),4);e.getVertexAttributeList().HighlightColor=i,!!e.getVertexAttributeList().InstMatR1&&null!=e.getVertexAttributeList().InstMatR1.getAttributeDivisor()&&e.getVertexAttributeList().HighlightColor.setAttributeDivisor(1)}return r(e,.5),e})),{highlightIds:e,uniqueObjectId:n,highlight:r,twinkle:function(e,n){e=e||Ae,n?e.addUpdateCallback(i):e.removeUpdateCallback(i)}}}(),Ne=[];function Ke(){function e(){var e=["","#ifdef GL_ES","precision highp float;","#endif","attribute vec3 Vertex;","attribute vec3 Normal;","attribute vec2 TexCoord0;","uniform mat4 uModelViewMatrix;","uniform mat4 uProjectionMatrix;","varying vec3 vViewNormal;","varying vec3 vLocalVertex;","void main(void) {","  vLocalVertex = Vertex;","  gl_Position = uProjectionMatrix * uModelViewMatrix * vec4(Vertex,1.0);","}"].join("\n"),n=["","#ifdef GL_ES","precision highp float;","#endif","uniform samplerCube Texture0;","varying vec3 vLocalVertex;","void main(void) {","  vec3 eye = -normalize(vLocalVertex);","  gl_FragColor = textureCube(Texture0, eye);","  //fragColor.w = 0.0;","  //gl_FragColor = fragColor;","  //discard;","}",""].join("\n"),t=new we.Program(new we.Shader("VERTEX_SHADER",e),new we.Shader("FRAGMENT_SHADER",n));return De.log(t),t}!function(){var n=function(n,t){var r=we.createTexturedBoxGeometry(0,0,0,n,n,n);r.getOrCreateStateSet().setAttributeAndModes(new we.CullFace("DISABLE")),r.getOrCreateStateSet().setAttributeAndModes(e());var a=we.Uniform.createMatrix4(we.mat4.create(),"CubemapTransform"),i=new we.MatrixTransform;i.setMatrix(we.mat4.fromRotation(we.mat4.create(),-Math.PI/2,[1,0,0])),i.addChild(r),i.setCullCallback(new function(){this.cull=function(e,n){we.mat4.setTranslation(n.getCurrentModelViewMatrix(),[0,0,0]);var t=n.getCurrentModelViewMatrix();return we.mat4.copy(a.getInternalArray(),t),!0}}),t.getOrCreateStateSet().addUniform(a);var o=new we.Camera;return o.setReferenceFrame(we.Transform.ABSOLUTE_RF),o.addChild(i),o.addUpdateCallback(new function(){this.update=function(){var e=Te.getCamera(),n={};we.mat4.getPerspective(n,e.getProjectionMatrix());var t=[];return we.mat4.perspective(t,Math.PI/180*n.fovy,n.aspectRatio,1,1e3),o.setProjectionMatrix(t),o.setViewMatrix(e.getViewMatrix()),!0}}),t.addChild(o),r}(1e4,Ae),t=new we.TextureCubeMap;t.setTextureSize(1,1);var r=n.getOrCreateStateSet();r.setAttributeAndModes(new we.CullFace("DISABLE")),r.setAttributeAndModes(e()),r.setTextureAttributeAndModes(0,t),r.addUniform(we.Uniform.createInt1(0,"Texture0")),Ce.all([Re.readImage("textures/RT-posx.jpg"),Re.readImage("textures/LF-negx.jpg"),Re.readImage("textures/UP-posy.jpg"),Re.readImage("textures/DN-negy.jpg"),Re.readImage("textures/BK-posz.jpg"),Re.readImage("textures/FR-negz.jpg")]).then((function(e){t.setImage("TEXTURE_CUBE_MAP_POSITIVE_X",e[0]),t.setImage("TEXTURE_CUBE_MAP_NEGATIVE_X",e[1]),t.setImage("TEXTURE_CUBE_MAP_POSITIVE_Y",e[2]),t.setImage("TEXTURE_CUBE_MAP_NEGATIVE_Y",e[3]),t.setImage("TEXTURE_CUBE_MAP_POSITIVE_Z",e[4]),t.setImage("TEXTURE_CUBE_MAP_NEGATIVE_Z",e[5]),t.setMinFilter("LINEAR_MIPMAP_LINEAR")}))}()}var Fe,je={};je.MODEL=0,je.WMS=1,je.WMTS=2;const qe={init:function(e){we.Geometry.enableVAO=!0;we.WebGLCaps.prototype.initPlatformSupport;we.WebGLCaps.prototype.initPlatformSupport=function(){var e=this._webGLPlatforms;e.Apple=-1!==navigator.vendor.indexOf("Apple")||-1!==navigator.vendor.indexOf("OS X"),e.Mobile=/Mobi/.test(navigator.userAgent)||/ablet/.test(navigator.userAgent),e.Android=!!/(Android)/.test(navigator.userAgent),e.MobileDevice=!!/(iPad|iPhone|iPod|Android)/.test(navigator.userAgent),e.IExplore=!(-1===navigator.userAgent.indexOf("MSIE ")&&!navigator.userAgent.match(/Trident.*rv\:11\./))};var n=Be.glStats;n.init(),n.init=void 0;var t=__webpack_require__(391).Z;t.init();var a=new we.Options;a.stats=!0,a.EventBackend={},a.EventBackend.StandardMouseKeyboard={},a.EventBackend.StandardMouseKeyboard.mouseEventNode=e.canvas,a.EventBackend.StandardMouseKeyboard.keyboardEventNode=document,Te=new Ie.Viewer(e.canvas,a),window.viewer=Te,Te.init(),Te.getCamera().setName("OSGJS camera"),Te.getScene().setName("OSGJS Scene"),Te.getViewerStats()&&Te.getViewerStats().addConfig(t);var i,o=we.WebGLCaps.instance().getWebGLPlatforms();if(o.MobileDevice||o.IExplore||(r.cityShader.vertexShader="#define texture2DLodEXT_support\n"+r.cityShader.vertexShader,r.cityShader.fragmentShader="#define texture2DLodEXT_support\n"+r.cityShader.fragmentShader),De.log("WebGLPlatforms%o",o),De.log("WebGLParameters%o",we.WebGLCaps.instance().getWebGLParameters()),De.log("WebGLExtensions%o",we.WebGLCaps.instance().getWebGLExtensions()),Ae=new we.Node,window.rootNode=Ae,Ae.setName("rootNode"),Te.setSceneData(Ae),e.displayGraphRenderer){let e=Le.DisplayGraph.instance();e.setDisplayGraphRenderer(!0),e.createGraph(Ae)}i=new we.LightSource,(ke=new we.Light(3)).setAmbient(we.vec4.fromValues(1,1,1,.1)),ke.setDirection(we.vec3.fromValues(1,1,0)),i.setLight(ke),Ae.addChild(i),A.locateInit(Te,100,[0,0,0]),Te.getCamera().setEnableFrustumCulling(!0);Re.Registry.instance().addReaderWriter("zzp",new function(){}),Re.Input.prototype.readNodeURL=function(e,n){var t=n;if(void 0===t&&(t=this._defaultOptions),t.readNodeURL)return t.readNodeURL.call(this,e,t);e=this.computeURL(e);var r=this;if(!(t=we.objectMix({},t)).prefixURL){var a=r.getPrefixURL(),i=e.lastIndexOf("/");-1!==i&&(a=e.substring(0,i+1)),t.prefixURL=a,t.databasePath=a}var o=function(n){return Re.parseSceneGraph(n,t).then((function(n){return we.log("loaded "+e),n}))};return we.time("osgjs.metric:Input.readNodeURL",we.INFO),r.requestFile(e).then((function(n){var t;try{t=JSON.parse(n)}catch(n){we.error("cant parse url "+e+" try to gunzip")}return t?o(t):r.requestFile(e,{responseType:"arraybuffer"}).then((function(e){var n,r,a=(r=n=e,Re.isGunzipBuffer(n)&&(r=Re.gunzip(n)),function(e){for(var n,t="",r=0,a=e.length;r<a;++r)t+="%"+((n=e[r].toString(16)).length<2?"0"+n:n);return decodeURIComponent(t)}(new Uint8Array(r)));return t=JSON.parse(a),o(t)})).catch((function(n){var t="cant read file "+e+" status "+n;return we.error(t),Ce.reject(r)}))})).catch((function(n){var t="cant get file "+e+" status "+n;return we.error(t),Ce.reject(r)})).finally((function(){we.timeEnd("osgjs.metric:Input.readNodeURL")}))};var s=Re.registry(),_=s.getOptions();_.readImageURL=function(e,n){"data:image"!==e.substr(0,10)&&(e=this.computeURL(e));var t=new we.Image;if(!0!==n.imageLoadingUsePromise)return this.fetchImage(t,e,n);if(-1!=e.indexOf(".dds")){De.log("FIND DDS PIC");var r=Ce.defer();t.setImage=function(e){this._mipmap=e.mipmaps,this.setWidth(e.width),this.setHeight(e.height),this._mipmap.length=e.mipmapCount,this._imageObject=this._mipmap[0].data,this.format=e.format,this.dirty()};var a=new XMLHttpRequest;return a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){var n=getruldds(this.response,!0);t.setURL(e),t.setImage(n),r.resolve(t)},a.send(null),r.promise}return n.imageCrossOrigin="Anonymous",this.fetchImage(t,e,n)},s.setOptions(_);Re.requestFile.requestFileCallback;Re.requestFile.requestFileCallback=function(e,n){return new Ce((function(t,r){var a=new XMLHttpRequest;a.open("GET",e,!0),n&&n.responseType&&(a.responseType=n.responseType),n&&n.progress&&a.addEventListener("progress",n.progress,!1),a.addEventListener("error",r,!1),a.addEventListener("load",(function(){"arraybuffer"===a.responseType||"blob"===a.responseType?t(a.response):"document"===a.responseType?t(a.responseXML):"json"===a.responseType?t(a.response):"text"===a.responseType?t(a.responseText):t(a.response)})),a.send(null)}))};Re.readNodeURL.parseNodeCallback;Re.readNodeURL.parseNodeCallback=function(e){var n=new Ue;e.accept(n)};var u=m.WebWorkerWrapper((function(){importScripts(location.origin+"/vendors/zlib.pretty.js");onmessage=function(e){var n=e.data._buffer[0];if(function(e){var n=new Uint8Array(e);return 31===n[0]&&139===n[1]}(n)){var t=new Uint8Array(n);n=new Zlib.Gunzip(t).decompress().buffer}var r={_id:e.data._id,_buffer:n};postMessage(r)}}));u&&(Re.Input.prototype._unzipTypedArray=function(e){return u(e)});Te.getCamera().setFinalDrawCallback((function(e){ie.onFrameCallbackUpdateOverlay(e)})),Ke(),function(e){var n=new we.Node;Ae.addChild(n);var t=new we.Program(new we.Shader("VERTEX_SHADER",r.cityShader.vertexShader),new we.Shader("FRAGMENT_SHADER",r.cityShader.fragmentShader));t.setTrackAttributes({attributeKeys:[ke],textureAttributeKeys:[]}),n.getOrCreateStateSet().setAttributeAndModes(t),n.getOrCreateStateSet().addUniform(we.Uniform.createInt1(0,"Texture0"));for(let t=0;t<e.layers.length;++t){let r=e.layers[t];if(je.MODEL===r.layerType)for(let e=0;e<r.dispatchMode.urls.length;++e){var a=r.dispatchMode.urls[e];Re.readNodeURL(a).then((function(e){var t=new we.MatrixTransform;we.mat4.setTranslation(t.getMatrix(),we.vec3.fromValues(-572500,-2542500,-36.55688621419176)),t.addChild(e),n.addChild(t);var r=document.getElementById("loading");document.body.removeChild(r)})).catch((function(e){we.warn("cannot load "+a)}))}else if(je.WMS===r.layerType){var i=new G(r.dispatchMode);Ae.addChild(i.load())}else if(je.WMTS===r.layerType){var o=new re(r.dispatchMode);Ae.addChild(o.load())}else De.error("Unknown layer type")}Fe=new ge}(e);try{Te.run()}catch(e){De.error("exception in osgViewer "+e)}},uninit:function(){if(Te){var e={viewer:Te,rootNode:Ae};Te.contextLost(),requestAnimationFrame(function(e,n){var t=e.viewer,r=e.rootNode;m.releaseGLObjects(r),r.removeChildren();var a=t.getState().getShaderGeneratorProxy()._generators;for(var i in a){var o=a[i]._cache;if(o){for(var s in o)o[s].releaseGLObjects();a[i].resetCache()}}t.flushAllDeletedGLObjects()}.bind(null,e)),Ae=void 0,Te=void 0}},pick:function(e,n,t){if(e=we.vec2.fromValues(e.x,e.y),0!==Ne.length){for(let e=0;e<Ne.length;++e)highlight(Ne[e],!1),twinkle(Ne[e],!1);Ne=[]}var r=Te.computeIntersections(e[0],e[1],t);if(0!==r.length&&(r.sort((function(e,n){return e._ratio-n._ratio})),n&&(r=n(r)),0!==r.length)){for(let e=0;e<r.length;++e)r[e]._worldIntersectionPoint=A.local2World(r[e]);for(var a,i=!1,o=(a=r[0]._nodePath).length-1;o-1>=0;--o){var s=a[o],_=a[o-1];if(s&&_&&_ instanceof we.PagedLOD){for(var u=_._perRangeDataList,l=0;l<u.length;++l){var c;if((c=u[l].dbrequest)&&c._loadedModel&&s._instanceID===c._loadedModel._instanceID){i=!0,De.error(c._url);break}}if(i)break}}return r}},highlight:We.highlight,hideEntity:function(e){we.Geometry.hideEntity({node:Ae,ids:e})},locate:function(e){A.locate(Te,e,!0)},locateDelay:function(e){A.locateDelay(Te,e,!1)},LayerType:je,loadPanoramaLayer:function(){Fe.loadPanorama({url:"../../../db/PanoramaAsset/全景图.json"})},unloadPanoramaLayer:function(){Fe.unloadPanorama()},MRTTechnique:W};var Ve=__webpack_require__(5108);
/**
* @file Manages api
* @module SpatiotemporalPlatform-iClient-osgjs
* @author imygis <imygis@sina.cn>
* @version 0.0
* @copyright imygis <imygis@sina.cn> All Rights Reserved
* @license GPL
* @todo text describing thing to do.
*/if("undefined"==typeof SpatiotemporalPlatform)throw"缺少 SpatiotemporalPlatform";function Ge(e){this._VERSION="0.0.1",Ve.log("%cSpatiotemporalPlatform-iClient-osgjs %cVERSION: "+this._VERSION,"color: red; font: larger bold","color: purple",e)}Ge.api=qe,SpatiotemporalPlatform.SPOsgjs=Ge;const ze=Ge})(),__webpack_exports__})()));
//# sourceMappingURL=osg.js.map