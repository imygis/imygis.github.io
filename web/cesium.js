!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i=t();for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(this,(()=>(()=>{var __webpack_modules__={9919:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AlphaMode:()=>Ym,AlphaPipelineStage:()=>K2,Animation:()=>B4,AnimationViewModel:()=>k4,Appearance:()=>no,ApproximateTerrainHeights:()=>li,ArcGISTiledElevationTerrainProvider:()=>BZ,ArcGisBaseMapType:()=>wh,ArcGisMapServerImageryProvider:()=>$_,ArcGisMapService:()=>Wu,ArcType:()=>Yt,ArticulationStageType:()=>cc,AssociativeArray:()=>bt,AttributeCompression:()=>Gn,AttributeType:()=>nn,AutoExposure:()=>YO,AutomaticUniforms:()=>eg,Axis:()=>wo,AxisAlignedBoundingBox:()=>Ky,B3dmLoader:()=>f2,B3dmParser:()=>XO,BaseLayerPicker:()=>T8,BaseLayerPickerViewModel:()=>x8,BatchTable:()=>JT,BatchTableHierarchy:()=>eA,BatchTexture:()=>il,BatchTexturePipelineStage:()=>Z2,Billboard:()=>mo,BillboardCollection:()=>$u,BillboardGraphics:()=>Sc,BillboardVisualizer:()=>EU,BingMapsGeocoderService:()=>GZ,BingMapsImageryProvider:()=>OL,BingMapsStyle:()=>aw,BlendEquation:()=>La,BlendFunction:()=>To,BlendOption:()=>Ao,BlendingState:()=>ln,BoundingRectangle:()=>qe,BoundingSphere:()=>se,BoundingSphereState:()=>at,BoundingVolumeSemantics:()=>iA,BoxEmitter:()=>Loe,BoxGeometry:()=>Dl,BoxGeometryUpdater:()=>wU,BoxGraphics:()=>NC,BoxOutlineGeometry:()=>lh,BrdfLutGenerator:()=>ML,Buffer:()=>ut,BufferLoader:()=>oA,BufferUsage:()=>Be,CPUStylingPipelineStage:()=>eF,CallbackProperty:()=>lm,Camera:()=>oo,CameraEventAggregator:()=>aN,CameraEventType:()=>Li,CameraFlightPath:()=>JL,Cartesian2:()=>U,Cartesian3:()=>h,Cartesian4:()=>oe,Cartographic:()=>fe,CartographicGeocoderService:()=>QZ,CatmullRomSpline:()=>r$,Cesium3DContentGroup:()=>fA,Cesium3DTile:()=>_d,Cesium3DTileBatchTable:()=>ag,Cesium3DTileColorBlendMode:()=>Vl,Cesium3DTileContent:()=>Lle,Cesium3DTileContentFactory:()=>BA,Cesium3DTileContentState:()=>Ho,Cesium3DTileContentType:()=>Es,Cesium3DTileFeature:()=>Fs,Cesium3DTileFeatureTable:()=>kh,Cesium3DTileOptimizationHint:()=>dd,Cesium3DTileOptimizations:()=>BB,Cesium3DTilePass:()=>Io,Cesium3DTilePassState:()=>gd,Cesium3DTilePointFeature:()=>Og,Cesium3DTileRefine:()=>Uo,Cesium3DTileStyle:()=>QA,Cesium3DTileStyleEngine:()=>GB,Cesium3DTilesInspector:()=>O8,Cesium3DTilesInspectorViewModel:()=>I8,Cesium3DTilesVoxelProvider:()=>aue,Cesium3DTileset:()=>ca,Cesium3DTilesetBaseTraversal:()=>jB,Cesium3DTilesetCache:()=>VB,Cesium3DTilesetGraphics:()=>HC,Cesium3DTilesetHeatmap:()=>zB,Cesium3DTilesetMetadata:()=>YA,Cesium3DTilesetMostDetailedTraversal:()=>WB,Cesium3DTilesetSkipTraversal:()=>YB,Cesium3DTilesetStatistics:()=>Bg,Cesium3DTilesetTraversal:()=>zs,Cesium3DTilesetVisualizer:()=>vU,CesiumInspector:()=>L8,CesiumInspectorViewModel:()=>R8,CesiumTerrainProvider:()=>KP,CesiumWidget:()=>CU,Check:()=>El,CheckerboardMaterialProperty:()=>qD,CircleEmitter:()=>e3,CircleGeometry:()=>K$,CircleOutlineGeometry:()=>J$,ClassificationModelDrawCommand:()=>v2,ClassificationPipelineStage:()=>$2,ClassificationPrimitive:()=>bv,ClassificationType:()=>zn,ClearCommand:()=>ti,ClippingPlane:()=>sA,ClippingPlaneCollection:()=>ys,Clock:()=>ph,ClockRange:()=>Dr,ClockStep:()=>ho,ClockViewModel:()=>R4,CloudCollection:()=>Due,CloudType:()=>Tv,Color:()=>z,ColorBlendMode:()=>xc,ColorGeometryInstanceAttribute:()=>kt,ColorMaterialProperty:()=>Nt,Command:()=>wxe,ComponentDatatype:()=>X,Composite3DTileContent:()=>cN,CompositeEntityCollection:()=>ppe,CompositeMaterialProperty:()=>XD,CompositePositionProperty:()=>ma,CompositeProperty:()=>Dc,CompressedTextureBuffer:()=>u1,ComputeCommand:()=>od,ComputeEngine:()=>MV,ConditionsExpression:()=>KB,ConeEmitter:()=>Iue,ConstantPositionProperty:()=>gl,ConstantProperty:()=>Zn,ConstantSpline:()=>f1,ContentMetadata:()=>SB,Context:()=>BV,ContextLimits:()=>zt,CoplanarPolygonGeometry:()=>b1,CoplanarPolygonGeometryLibrary:()=>x_,CoplanarPolygonOutlineGeometry:()=>zf,CornerType:()=>Ri,CorridorGeometry:()=>lT,CorridorGeometryLibrary:()=>Bi,CorridorGeometryUpdater:()=>PU,CorridorGraphics:()=>BC,CorridorOutlineGeometry:()=>I1,Credit:()=>xt,CreditDisplay:()=>T3,CubeMap:()=>bc,CubeMapFace:()=>fp,CubicRealPolynomial:()=>Ob,CullFace:()=>gi,CullingVolume:()=>ns,CumulusCloud:()=>uf,CustomDataSource:()=>RU,CustomHeightmapTerrainProvider:()=>lJ,CustomShader:()=>PC,CustomShaderMode:()=>Dg,CustomShaderPipelineStage:()=>aF,CustomShaderTranslucencyMode:()=>ex,CylinderGeometry:()=>P1,CylinderGeometryLibrary:()=>dT,CylinderGeometryUpdater:()=>MU,CylinderGraphics:()=>kC,CylinderOutlineGeometry:()=>O1,CzmlDataSource:()=>UU,DataSource:()=>Nr,DataSourceClock:()=>um,DataSourceCollection:()=>HU,DataSourceDisplay:()=>az,DebugAppearance:()=>sfe,DebugCameraPrimitive:()=>kp,DebugInspector:()=>C3,DebugModelMatrixPrimitive:()=>w3,DefaultProxy:()=>hJ,DepthFunction:()=>yc,DepthPlane:()=>P3,DequantizationPipelineStage:()=>cF,DerivedCommand:()=>Hg,DeveloperError:()=>de,DeviceOrientationCameraController:()=>R3,DirectionalLight:()=>dfe,DiscardEmptyTileImagePolicy:()=>lw,DiscardMissingTileImagePolicy:()=>UO,DistanceDisplayCondition:()=>wt,DistanceDisplayConditionGeometryInstanceAttribute:()=>Vn,DoubleEndedPriorityQueue:()=>pT,DoublyLinkedList:()=>N1,DracoLoader:()=>fg,DrawCommand:()=>et,DynamicGeometryBatch:()=>cE,DynamicGeometryUpdater:()=>ri,EarthOrientationParameters:()=>bP,EarthOrientationParametersSample:()=>$y,EasingFunction:()=>Ir,EllipseGeometry:()=>Yc,EllipseGeometryLibrary:()=>Pl,EllipseGeometryUpdater:()=>GU,EllipseGraphics:()=>VC,EllipseOutlineGeometry:()=>Ru,Ellipsoid:()=>ie,EllipsoidGeodesic:()=>Hf,EllipsoidGeometry:()=>Ms,EllipsoidGeometryUpdater:()=>WU,EllipsoidGraphics:()=>UC,EllipsoidOutlineGeometry:()=>Fu,EllipsoidPrimitive:()=>L3,EllipsoidRhumbLine:()=>Ia,EllipsoidSurfaceAppearance:()=>hfe,EllipsoidTangentPlane:()=>Vr,EllipsoidTerrainProvider:()=>Wm,EllipsoidalOccluder:()=>i_,Empty3DTileContent:()=>av,EncodedCartesian3:()=>Wn,Entity:()=>er,EntityCluster:()=>bf,EntityCollection:()=>Ks,EntityView:()=>uz,Event:()=>pe,EventHelper:()=>Pr,Expression:()=>Jf,ExpressionNodeType:()=>dt,ExtrapolationType:()=>Bu,FeatureDetection:()=>Bt,FeatureIdPipelineStage:()=>J0,Fog:()=>k3,ForEach:()=>Ie,FrameRateMonitor:()=>V3,FrameState:()=>U3,Framebuffer:()=>oa,FramebufferManager:()=>di,FrustumCommands:()=>z3,FrustumGeometry:()=>bT,FrustumOutlineGeometry:()=>V1,Fullscreen:()=>hr,FullscreenButton:()=>H4,FullscreenButtonViewModel:()=>U4,GeoJsonDataSource:()=>r4,GeoJsonLoader:()=>h2,GeocodeType:()=>y0,Geocoder:()=>j4,GeocoderService:()=>PS,GeocoderViewModel:()=>G4,GeographicProjection:()=>Ii,GeographicTilingScheme:()=>Ui,Geometry:()=>ct,Geometry3DTileContent:()=>gN,GeometryAttribute:()=>Se,GeometryAttributes:()=>hn,GeometryFactory:()=>RJ,GeometryInstance:()=>yt,GeometryInstanceAttribute:()=>hc,GeometryOffsetAttribute:()=>on,GeometryPipeline:()=>Fn,GeometryPipelineStage:()=>fF,GeometryType:()=>Bf,GeometryUpdater:()=>si,GeometryVisualizer:()=>QU,GetFeatureInfoFormat:()=>sC,Globe:()=>_k,GlobeDepth:()=>gk,GlobeSurfaceShaderSet:()=>j3,GlobeSurfaceTile:()=>Td,GlobeSurfaceTileProvider:()=>rk,GlobeTranslucency:()=>sk,GlobeTranslucencyFramebuffer:()=>yk,GlobeTranslucencyState:()=>xk,GltfBufferViewLoader:()=>xw,GltfDracoLoader:()=>bw,GltfImageLoader:()=>Tw,GltfIndexBufferLoader:()=>Aw,GltfJsonLoader:()=>Ew,GltfLoader:()=>Tg,GltfLoaderUtil:()=>Gl,GltfStructuralMetadataLoader:()=>JN,GltfTextureLoader:()=>Sw,GltfVertexBufferLoader:()=>ww,GoogleEarthEnterpriseImageryProvider:()=>lde,GoogleEarthEnterpriseMapsProvider:()=>m3,GoogleEarthEnterpriseMetadata:()=>O_,GoogleEarthEnterpriseTerrainData:()=>OS,GoogleEarthEnterpriseTerrainProvider:()=>HJ,GoogleEarthEnterpriseTileInformation:()=>H1,GoogleMaps:()=>TT,GpxDataSource:()=>p4,GregorianDate:()=>o_,GridImageryProvider:()=>ude,GridMaterialProperty:()=>QD,GroundGeometryUpdater:()=>qn,GroundPolylineGeometry:()=>AT,GroundPolylinePrimitive:()=>$h,GroundPrimitive:()=>pl,GroupMetadata:()=>fv,HeadingPitchRange:()=>qf,HeadingPitchRoll:()=>oc,Heap:()=>rP,HeightReference:()=>We,HeightmapEncoding:()=>Mf,HeightmapTerrainData:()=>va,HeightmapTessellator:()=>iS,HermitePolynomialApproximation:()=>$1,HermiteSpline:()=>i0,HilbertOrder:()=>MS,HomeButton:()=>X4,HomeButtonViewModel:()=>q4,HorizontalOrigin:()=>yi,I3SDataProvider:()=>hC,I3SDecoder:()=>wk,I3SFeature:()=>vk,I3SField:()=>Dk,I3SGeometry:()=>Wv,I3SLayer:()=>qv,I3SNode:()=>jv,I3dmLoader:()=>y2,I3dmParser:()=>p2,Iau2000Orientation:()=>J1,Iau2006XysData:()=>TP,Iau2006XysSample:()=>Mb,IauOrientationAxes:()=>eO,IauOrientationParameters:()=>Q1,ImageBasedLighting:()=>CA,ImageBasedLightingPipelineStage:()=>M2,ImageMaterialProperty:()=>jx,Imagery:()=>Fv,ImageryLayer:()=>la,ImageryLayerCollection:()=>ck,ImageryLayerFeatureInfo:()=>vh,ImageryProvider:()=>el,ImageryState:()=>oi,Implicit3DTileContent:()=>Rw,ImplicitAvailabilityBitstream:()=>_w,ImplicitMetadataView:()=>gw,ImplicitSubdivisionScheme:()=>Gr,ImplicitSubtree:()=>_A,ImplicitSubtreeCache:()=>ZB,ImplicitSubtreeMetadata:()=>xN,ImplicitTileCoordinates:()=>ZA,ImplicitTileset:()=>KA,IndexDatatype:()=>ke,InfoBox:()=>$4,InfoBoxViewModel:()=>K4,InspectorShared:()=>Ja,InstanceAttributeSemantic:()=>Wr,InstancingPipelineStage:()=>j2,InterpolationAlgorithm:()=>Oee,InterpolationType:()=>Ah,Intersect:()=>Zt,IntersectionTests:()=>Ai,Intersections2D:()=>__,Interval:()=>Uc,InvertClassification:()=>Yv,Ion:()=>uh,IonGeocoderService:()=>nO,IonImageryProvider:()=>Vg,IonResource:()=>Iu,IonWorldImageryStyle:()=>Ug,Iso8601:()=>ze,JobScheduler:()=>Rk,JobType:()=>Ha,JsonMetadataTable:()=>xg,JulianDate:()=>J,KTX2Transcoder:()=>iO,KeyboardEventModifier:()=>na,KeyframeNode:()=>Qi,KmlCamera:()=>_4,KmlDataSource:()=>I4,KmlLookAt:()=>g4,KmlTour:()=>x4,KmlTourFlyTo:()=>T4,KmlTourWait:()=>A4,Label:()=>rx,LabelCollection:()=>bp,LabelGraphics:()=>rm,LabelStyle:()=>zo,LabelVisualizer:()=>JU,LagrangePolynomialApproximation:()=>oO,LeapSecond:()=>zi,Light:()=>bde,LightingModel:()=>gp,LightingPipelineStage:()=>hF,LinearApproximation:()=>ET,LinearSpline:()=>n0,ManagedArray:()=>Jc,MapMode2D:()=>kl,MapProjection:()=>Fee,MapboxImageryProvider:()=>p3,MapboxStyleImageryProvider:()=>Ade,Material:()=>Wi,MaterialAppearance:()=>ao,MaterialPipelineStage:()=>pF,MaterialProperty:()=>Jo,Math:()=>P,Matrix2:()=>Ji,Matrix3:()=>$,Matrix4:()=>L,Megatexture:()=>Xv,MetadataClass:()=>Nh,MetadataClassProperty:()=>H0,MetadataComponentType:()=>Jt,MetadataEntity:()=>Bn,MetadataEnum:()=>WN,MetadataEnumValue:()=>HN,MetadataPipelineStage:()=>rd,MetadataSchema:()=>Fh,MetadataSchemaLoader:()=>Dw,MetadataSemantic:()=>gA,MetadataTable:()=>zl,MetadataTableProperty:()=>TN,MetadataType:()=>Gt,MipmapHint:()=>Xm,Model:()=>Hh,Model3DTileContent:()=>yp,ModelAlphaOptions:()=>OF,ModelAnimation:()=>b2,ModelAnimationChannel:()=>x2,ModelAnimationCollection:()=>A2,ModelAnimationLoop:()=>jl,ModelAnimationState:()=>Vh,ModelArticulation:()=>F2,ModelArticulationStage:()=>L2,ModelClippingPlanesPipelineStage:()=>V2,ModelColorPipelineStage:()=>Q0,ModelComponents:()=>Mt,ModelDrawCommand:()=>I2,ModelFeature:()=>C2,ModelFeatureTable:()=>E2,ModelGraphics:()=>oy,ModelLightingOptions:()=>zF,ModelMatrixUpdateStage:()=>q2,ModelNode:()=>U2,ModelRenderResources:()=>RF,ModelRuntimeNode:()=>X2,ModelRuntimePrimitive:()=>IF,ModelSceneGraph:()=>WF,ModelSilhouettePipelineStage:()=>FF,ModelSkin:()=>PF,ModelSplitterPipelineStage:()=>VF,ModelStatistics:()=>jF,ModelType:()=>lr,ModelUtility:()=>en,ModelVisualizer:()=>ez,Moon:()=>Hk,MorphTargetsPipelineStage:()=>gF,MorphWeightSpline:()=>Bee,MortonOrder:()=>b0,Multiple3DTileContent:()=>DB,MultisampleFramebuffer:()=>GO,NavigationHelpButton:()=>e8,NavigationHelpButtonViewModel:()=>Q4,NearFarScalar:()=>Pt,NeverTileDiscardPolicy:()=>Cde,NodeRenderResources:()=>UF,NodeStatisticsPipelineStage:()=>Y2,NodeTransformationProperty:()=>zC,OIT:()=>Wk,Occluder:()=>lO,OctahedralProjectedCubeMap:()=>Bh,OffsetGeometryInstanceAttribute:()=>Zi,OpenCageGeocoderService:()=>Hee,OpenStreetMapImageryProvider:()=>Yg,OrderedGroundPrimitiveCollection:()=>Yk,OrientedBoundingBox:()=>Pn,OrthographicFrustum:()=>Qt,OrthographicOffCenterFrustum:()=>Or,Packable:()=>Gee,PackableForInterpolation:()=>Wee,Particle:()=>$v,ParticleBurst:()=>Dde,ParticleEmitter:()=>Pde,ParticleSystem:()=>Mde,Pass:()=>Ee,PassState:()=>Ac,PathGraphics:()=>ry,PathVisualizer:()=>tz,PeliasGeocoderService:()=>tO,PerInstanceColorAppearance:()=>rn,PerformanceDisplay:()=>Xg,PerformanceWatchdog:()=>i8,PerformanceWatchdogViewModel:()=>t8,PerspectiveFrustum:()=>Ei,PerspectiveOffCenterFrustum:()=>$c,PickDepth:()=>Zk,PickDepthFramebuffer:()=>$k,PickFramebuffer:()=>Qk,Picking:()=>sV,PickingPipelineStage:()=>yF,PinBuilder:()=>F_,PixelDatatype:()=>Ye,PixelFormat:()=>rt,Plane:()=>tn,PlaneGeometry:()=>hO,PlaneGeometryUpdater:()=>jU,PlaneGraphics:()=>SU,PlaneOutlineGeometry:()=>pO,PntsLoader:()=>YF,PntsParser:()=>PA,PointCloud:()=>lV,PointCloudEyeDomeLighting:()=>Ag,PointCloudShading:()=>dp,PointCloudStylingPipelineStage:()=>bF,PointGraphics:()=>GC,PointPrimitive:()=>Ys,PointPrimitiveCollection:()=>sD,PointVisualizer:()=>nz,PolygonGeometry:()=>MT,PolygonGeometryLibrary:()=>kn,PolygonGeometryUpdater:()=>qU,PolygonGraphics:()=>sm,PolygonHierarchy:()=>Pa,PolygonOutlineGeometry:()=>yO,PolygonPipeline:()=>ei,Polyline:()=>ad,PolylineArrowMaterialProperty:()=>JD,PolylineCollection:()=>jh,PolylineColorAppearance:()=>qr,PolylineDashMaterialProperty:()=>eI,PolylineGeometry:()=>V_,PolylineGeometryUpdater:()=>oz,PolylineGlowMaterialProperty:()=>tI,PolylineGraphics:()=>wc,PolylineMaterialAppearance:()=>fa,PolylineOutlineMaterialProperty:()=>Kx,PolylinePipeline:()=>Mi,PolylineVisualizer:()=>sz,PolylineVolumeGeometry:()=>xO,PolylineVolumeGeometryLibrary:()=>_h,PolylineVolumeGeometryUpdater:()=>YU,PolylineVolumeGraphics:()=>WC,PolylineVolumeOutlineGeometry:()=>bO,PositionProperty:()=>iy,PositionPropertyArray:()=>dy,PostProcessStage:()=>_o,PostProcessStageCollection:()=>OV,PostProcessStageComposite:()=>_l,PostProcessStageLibrary:()=>Sd,PostProcessStageSampleMode:()=>gf,PostProcessStageTextureCache:()=>TC,Primitive:()=>Sn,PrimitiveCollection:()=>tu,PrimitiveLoadPlan:()=>AA,PrimitiveOutlineGenerator:()=>TA,PrimitiveOutlinePipelineStage:()=>CF,PrimitivePipeline:()=>zA,PrimitiveRenderResources:()=>HF,PrimitiveState:()=>br,PrimitiveStatisticsPipelineStage:()=>EF,PrimitiveType:()=>Ne,ProjectionPicker:()=>a8,ProjectionPickerViewModel:()=>r8,Property:()=>j,PropertyArray:()=>nI,PropertyAttribute:()=>xA,PropertyAttributeProperty:()=>ZN,PropertyBag:()=>au,PropertyTable:()=>sl,PropertyTexture:()=>yA,PropertyTextureProperty:()=>KN,ProviderViewModel:()=>Yr,Proxy:()=>mte,QuadraticRealPolynomial:()=>zc,QuadtreeOccluders:()=>lk,QuadtreePrimitive:()=>pk,QuadtreeTile:()=>fk,QuadtreeTileLoadState:()=>Gs,QuadtreeTileProvider:()=>She,QuantizedMeshTerrainData:()=>jb,QuarticRealPolynomial:()=>pP,Quaternion:()=>Le,QuaternionSpline:()=>TO,Queue:()=>f0,Ray:()=>Tn,Rectangle:()=>ce,RectangleCollisionChecker:()=>NT,RectangleGeometry:()=>kT,RectangleGeometryLibrary:()=>ps,RectangleGeometryUpdater:()=>XU,RectangleGraphics:()=>am,RectangleOutlineGeometry:()=>zT,ReferenceFrame:()=>to,ReferenceProperty:()=>my,RenderState:()=>Ue,Renderbuffer:()=>ju,RenderbufferFormat:()=>nl,Request:()=>Ko,RequestErrorEvent:()=>wm,RequestScheduler:()=>nc,RequestState:()=>Qn,RequestType:()=>Jr,Resource:()=>ve,ResourceCache:()=>Gi,ResourceCacheKey:()=>Wl,ResourceCacheStatistics:()=>YN,ResourceLoader:()=>io,ResourceLoaderState:()=>St,Rotation:()=>Od,RuntimeError:()=>ue,S2Cell:()=>W_,SDFSettings:()=>Ns,SampledPositionProperty:()=>pa,SampledProperty:()=>Tf,Sampler:()=>un,ScaledPositionProperty:()=>$p,Scene:()=>tU,SceneFramebuffer:()=>_C,SceneMode:()=>te,SceneMode2DPipelineStage:()=>SF,SceneModePicker:()=>f8,SceneModePickerViewModel:()=>l8,SceneTransforms:()=>$i,SceneTransitioner:()=>VV,ScreenSpaceCameraController:()=>KV,ScreenSpaceEventHandler:()=>Hu,ScreenSpaceEventType:()=>_n,SelectedFeatureIdPipelineStage:()=>tx,SelectionIndicator:()=>p8,SelectionIndicatorViewModel:()=>h8,ShaderBuilder:()=>aA,ShaderCache:()=>LV,ShaderDestination:()=>Ce,ShaderFunction:()=>NL,ShaderProgram:()=>Kt,ShaderSource:()=>He,ShaderStruct:()=>LL,ShadowMap:()=>Zg,ShadowMapShader:()=>Gp,ShadowMode:()=>yn,ShadowVolumeAppearance:()=>lf,ShowGeometryInstanceAttribute:()=>gn,Simon1994PlanetaryPositions:()=>D0,SimplePolylineGeometry:()=>vne,SingleTileImageryProvider:()=>_3,SkinningPipelineStage:()=>vF,SkyAtmosphere:()=>oU,SkyBox:()=>lU,SpatialNode:()=>uU,SphereEmitter:()=>Mme,SphereGeometry:()=>Dne,SphereOutlineGeometry:()=>X_,Spherical:()=>RO,Spline:()=>eo,SplitDirection:()=>al,Splitter:()=>iD,StaticGeometryColorBatch:()=>Fd,StaticGeometryPerMaterialBatch:()=>kd,StaticGroundGeometryColorBatch:()=>uI,StaticGroundGeometryPerMaterialBatch:()=>ZU,StaticGroundPolylinePerMaterialBatch:()=>rz,StaticOutlineGeometryBatch:()=>fI,StencilConstants:()=>Lt,StencilFunction:()=>Un,StencilOperation:()=>ft,SteppedSpline:()=>MO,Stereographic:()=>_c,StripeMaterialProperty:()=>iI,StripeOrientation:()=>fm,StructuralMetadata:()=>ja,StyleCommandsNeeded:()=>Uh,StyleExpression:()=>Lme,Sun:()=>mU,SunLight:()=>Qg,SunPostProcess:()=>QV,SupportedImageFormats:()=>n2,SvgPathBindingHandler:()=>O4,TaskProcessor:()=>pi,Terrain:()=>_U,TerrainData:()=>sh,TerrainEncoding:()=>sc,TerrainExaggeration:()=>Wc,TerrainFillMesh:()=>Vv,TerrainMesh:()=>Ff,TerrainOffsetProperty:()=>YC,TerrainProvider:()=>Ur,TerrainQuantization:()=>Os,TerrainState:()=>so,Texture:()=>Ot,TextureAtlas:()=>F0,TextureCache:()=>NV,TextureMagnificationFilter:()=>wi,TextureManager:()=>AU,TextureMinificationFilter:()=>an,TextureUniform:()=>gxe,TextureWrap:()=>vn,TileAvailability:()=>ah,TileBoundingRegion:()=>md,TileBoundingS2Cell:()=>NB,TileBoundingSphere:()=>Ng,TileBoundingVolume:()=>Nme,TileCoordinatesImageryProvider:()=>gU,TileDiscardPolicy:()=>Fme,TileEdge:()=>pn,TileImagery:()=>Bv,TileMapServiceImageryProvider:()=>hx,TileMetadata:()=>wB,TileOrientedBoundingBox:()=>pd,TileProviderError:()=>bo,TileReplacementQueue:()=>hk,TileSelectionResult:()=>Kn,TileState:()=>Bme,Tileset3DTileContent:()=>KF,TilesetMetadata:()=>kB,TilesetPipelineStage:()=>O2,TilingScheme:()=>Ine,TimeConstants:()=>Xn,TimeDynamicImagery:()=>aC,TimeDynamicPointCloud:()=>AD,TimeInterval:()=>Cn,TimeIntervalCollection:()=>Mr,TimeIntervalCollectionPositionProperty:()=>_y,TimeIntervalCollectionProperty:()=>gy,TimeStandard:()=>Yn,Timeline:()=>y8,TimelineHighlightRange:()=>_8,TimelineTrack:()=>g8,Tipsify:()=>$P,ToggleButtonViewModel:()=>ab,Tonemapper:()=>Mx,Transforms:()=>Rt,TranslationRotationScale:()=>P0,TranslucentTileClassification:()=>tV,TridiagonalSystemSolver:()=>sS,TrustedServers:()=>YE,TweenCollection:()=>EC,UniformState:()=>FV,UniformType:()=>ED,UrlTemplateImageryProvider:()=>qa,VERSION:()=>jXi,VRButton:()=>v8,VRButtonViewModel:()=>S8,VRTheWorldTerrainProvider:()=>Nne,VaryingType:()=>yxe,Vector3DTileBatch:()=>op,Vector3DTileClampedPolylines:()=>CB,Vector3DTileContent:()=>EB,Vector3DTileGeometry:()=>ug,Vector3DTilePoints:()=>yB,Vector3DTilePolygons:()=>xB,Vector3DTilePolylines:()=>FA,Vector3DTilePrimitive:()=>dA,VelocityOrientationProperty:()=>NU,VelocityVectorProperty:()=>sE,VertexArray:()=>ni,VertexArrayFacade:()=>tg,VertexAttributeSemantic:()=>Tt,VertexFormat:()=>Pe,VerticalOrigin:()=>On,VideoSynchronizer:()=>Rne,View:()=>yC,Viewer:()=>ebe,ViewportQuad:()=>Hme,Visibility:()=>rr,Visualizer:()=>_xe,VoxelBoxShape:()=>Fp,VoxelContent:()=>QB,VoxelCylinderShape:()=>Bp,VoxelEllipsoidShape:()=>JA,VoxelInspector:()=>B8,VoxelInspectorViewModel:()=>N8,VoxelPrimitive:()=>vD,VoxelProvider:()=>$me,VoxelRenderResources:()=>KL,VoxelShape:()=>Qme,VoxelShapeType:()=>ji,VoxelTraversal:()=>CD,VulkanConstants:()=>Fne,WallGeometry:()=>BO,WallGeometryLibrary:()=>YT,WallGeometryUpdater:()=>$U,WallGraphics:()=>sy,WallOutlineGeometry:()=>kO,WebGLConstants:()=>ee,WebMapServiceImageryProvider:()=>y3,WebMapTileServiceImageryProvider:()=>x3,WebMercatorProjection:()=>Oi,WebMercatorTilingScheme:()=>zr,WindingOrder:()=>ts,WireframeIndexGenerator:()=>$S,WireframePipelineStage:()=>DF,_shadersAcesTonemappingStage:()=>dV,_shadersAdditiveBlend:()=>ZV,_shadersAdjustTranslucentFS:()=>Zv,_shadersAllMaterialAppearanceFS:()=>Lk,_shadersAllMaterialAppearanceVS:()=>Nk,_shadersAmbientOcclusionGenerate:()=>hV,_shadersAmbientOcclusionModulate:()=>mV,_shadersAspectRampMaterial:()=>QF,_shadersAtmosphereCommon:()=>Gg,_shadersBasicMaterialAppearanceFS:()=>Fk,_shadersBasicMaterialAppearanceVS:()=>Bk,_shadersBillboardCollectionFS:()=>vL,_shadersBillboardCollectionVS:()=>DL,_shadersBlackAndWhite:()=>pV,_shadersBloomComposite:()=>_V,_shadersBrdfLutGeneratorFS:()=>RL,_shadersBrightPass:()=>$V,_shadersBrightness:()=>gV,_shadersBumpMapMaterial:()=>JF,_shadersCPUStylingStageFS:()=>J2,_shadersCPUStylingStageVS:()=>Q2,_shadersCheckerboardMaterial:()=>eB,_shadersCloudCollectionFS:()=>i3,_shadersCloudCollectionVS:()=>o3,_shadersCloudNoiseFS:()=>r3,_shadersCloudNoiseVS:()=>s3,_shadersCompareAndPackTranslucentDepth:()=>eV,_shadersCompositeOITFS:()=>Gk,_shadersCompositeTranslucentClassification:()=>gC,_shadersContrastBias:()=>yV,_shadersCustomShaderStageFS:()=>nF,_shadersCustomShaderStageVS:()=>tF,_shadersCzmBuiltins:()=>tA,_shadersDepthOfField:()=>xV,_shadersDepthPlaneFS:()=>v3,_shadersDepthPlaneVS:()=>D3,_shadersDepthView:()=>bV,_shadersDepthViewPacked:()=>xxe,_shadersDotMaterial:()=>tB,_shadersEdgeDetection:()=>TV,_shadersElevationBandMaterial:()=>nB,_shadersElevationContourMaterial:()=>iB,_shadersElevationRampMaterial:()=>oB,_shadersEllipsoidFS:()=>Mv,_shadersEllipsoidSurfaceAppearanceFS:()=>N3,_shadersEllipsoidSurfaceAppearanceVS:()=>F3,_shadersEllipsoidVS:()=>Lv,_shadersFXAA:()=>CV,_shadersFXAA3_11:()=>IV,_shadersFadeMaterial:()=>rB,_shadersFeatureIdStageFS:()=>iF,_shadersFeatureIdStageVS:()=>oF,_shadersFilmicTonemapping:()=>AV,_shadersGaussianBlur1D:()=>Ox,_shadersGeometryStageFS:()=>lF,_shadersGeometryStageVS:()=>uF,_shadersGlobeFS:()=>G3,_shadersGlobeVS:()=>W3,_shadersGridMaterial:()=>sB,_shadersGroundAtmosphere:()=>Nv,_shadersHSBToRGB:()=>wM,_shadersHSLToRGB:()=>vM,_shadersImageBasedLightingStageFS:()=>R2,_shadersInstancingStageCommon:()=>z2,_shadersInstancingStageVS:()=>H2,_shadersIntersectBox:()=>zL,_shadersIntersectClippingPlanes:()=>UL,_shadersIntersectCylinder:()=>HL,_shadersIntersectDepth:()=>VL,_shadersIntersectEllipsoid:()=>GL,_shadersIntersection:()=>cA,_shadersIntersectionUtils:()=>kL,_shadersLegacyInstancingStageVS:()=>G2,_shadersLensFlare:()=>EV,_shadersLightingStageFS:()=>dF,_shadersMaterialStageFS:()=>mF,_shadersMegatexture:()=>XL,_shadersMetadataStageFS:()=>rF,_shadersMetadataStageVS:()=>sF,_shadersModelClippingPlanesStageFS:()=>k2,_shadersModelColorStageFS:()=>B2,_shadersModelFS:()=>S2,_shadersModelSilhouetteStageFS:()=>MF,_shadersModelSilhouetteStageVS:()=>LF,_shadersModelSplitterStageFS:()=>BF,_shadersModelVS:()=>w2,_shadersModifiedReinhardTonemapping:()=>SV,_shadersMorphTargetsStageVS:()=>_F,_shadersNightVision:()=>wV,_shadersNormalMapMaterial:()=>aB,_shadersOctahedralProjectionAtlasFS:()=>s2,_shadersOctahedralProjectionFS:()=>a2,_shadersOctahedralProjectionVS:()=>c2,_shadersOctree:()=>YL,_shadersPassThrough:()=>Jl,_shadersPassThroughDepth:()=>yx,_shadersPerInstanceColorAppearanceFS:()=>IB,_shadersPerInstanceColorAppearanceVS:()=>PB,_shadersPerInstanceFlatColorAppearanceFS:()=>UA,_shadersPerInstanceFlatColorAppearanceVS:()=>OB,_shadersPointCloudEyeDomeLighting:()=>u2,_shadersPointCloudStylingStageVS:()=>xF,_shadersPointPrimitiveCollectionFS:()=>Ix,_shadersPointPrimitiveCollectionVS:()=>uV,_shadersPolylineArrowMaterial:()=>cB,_shadersPolylineColorAppearanceVS:()=>E3,_shadersPolylineCommon:()=>of,_shadersPolylineDashMaterial:()=>lB,_shadersPolylineFS:()=>MA,_shadersPolylineGlowMaterial:()=>uB,_shadersPolylineMaterialAppearanceVS:()=>Ek,_shadersPolylineOutlineMaterial:()=>fB,_shadersPolylineShadowVolumeFS:()=>bk,_shadersPolylineShadowVolumeMorphFS:()=>Tk,_shadersPolylineShadowVolumeMorphVS:()=>Ak,_shadersPolylineShadowVolumeVS:()=>Ck,_shadersPolylineVS:()=>$F,_shadersPrimitiveOutlineStageFS:()=>AF,_shadersPrimitiveOutlineStageVS:()=>TF,_shadersRGBToHSB:()=>JM,_shadersRGBToHSL:()=>eL,_shadersRGBToXYZ:()=>tL,_shadersReinhardTonemapping:()=>vV,_shadersReprojectWebMercatorFS:()=>q3,_shadersReprojectWebMercatorVS:()=>Y3,_shadersRimLightingMaterial:()=>dB,_shadersSelectedFeatureIdStageCommon:()=>jw,_shadersShadowVolumeAppearanceFS:()=>xv,_shadersShadowVolumeAppearanceVS:()=>t3,_shadersShadowVolumeFS:()=>k0,_shadersSilhouette:()=>DV,_shadersSkinningStageVS:()=>wF,_shadersSkyAtmosphereCommon:()=>_D,_shadersSkyAtmosphereFS:()=>nU,_shadersSkyAtmosphereVS:()=>iU,_shadersSkyBoxFS:()=>sU,_shadersSkyBoxVS:()=>aU,_shadersSlopeRampMaterial:()=>hB,_shadersStripeMaterial:()=>mB,_shadersSunFS:()=>fU,_shadersSunTextureFS:()=>dU,_shadersSunVS:()=>hU,_shadersTexturedMaterialAppearanceFS:()=>kk,_shadersTexturedMaterialAppearanceVS:()=>Vk,_shadersVector3DTileClampedPolylinesFS:()=>AB,_shadersVector3DTileClampedPolylinesVS:()=>TB,_shadersVector3DTilePolylinesVS:()=>bB,_shadersVectorTileVS:()=>pw,_shadersViewportQuadFS:()=>yU,_shadersViewportQuadVS:()=>AC,_shadersVoxelFS:()=>FL,_shadersVoxelVS:()=>BL,_shadersWater:()=>pB,_shadersXYZToRGB:()=>SL,_shadersacesTonemapping:()=>ZR,_shadersalphaWeight:()=>$R,_shadersantialias:()=>QR,_shadersapproximateSphericalCoordinates:()=>JR,_shadersbackFacing:()=>eM,_shadersbranchFreeTernary:()=>tM,_shaderscascadeColor:()=>nM,_shaderscascadeDistance:()=>iM,_shaderscascadeMatrix:()=>oM,_shaderscascadeWeights:()=>rM,_shaderscolumbusViewMorph:()=>sM,_shaderscomputePosition:()=>aM,_shadersconvertUvToBox:()=>WL,_shadersconvertUvToCylinder:()=>jL,_shadersconvertUvToEllipsoid:()=>qL,_shaderscosineAndSine:()=>cM,_shadersdecompressTextureCoordinates:()=>lM,_shadersdefaultPbrMaterial:()=>uM,_shadersdegreesPerRadian:()=>iR,_shadersdepthClamp:()=>fM,_shadersdepthRange:()=>oR,_shadersdepthRangeStruct:()=>zR,_shaderseastNorthUpToEyeCoordinates:()=>dM,_shadersellipsoidContainsPoint:()=>hM,_shadersellipsoidWgs84TextureCoordinates:()=>mM,_shadersepsilon1:()=>rR,_shadersepsilon2:()=>sR,_shadersepsilon3:()=>aR,_shadersepsilon4:()=>cR,_shadersepsilon5:()=>lR,_shadersepsilon6:()=>uR,_shadersepsilon7:()=>fR,_shadersequalsEpsilon:()=>pM,_shaderseyeOffset:()=>_M,_shaderseyeToWindowCoordinates:()=>gM,_shadersfastApproximateAtan:()=>yM,_shadersfog:()=>xM,_shadersgammaCorrect:()=>bM,_shadersgeodeticSurfaceNormal:()=>TM,_shadersgetDefaultMaterial:()=>AM,_shadersgetLambertDiffuse:()=>CM,_shadersgetSpecular:()=>EM,_shadersgetWaterNoise:()=>SM,_shadershue:()=>DM,_shadersinfinity:()=>dR,_shadersinverseGamma:()=>IM,_shadersisEmpty:()=>PM,_shadersisFull:()=>OM,_shaderslatitudeToWebMercatorFraction:()=>RM,_shaderslineDistance:()=>LM,_shaderslinearToSrgb:()=>MM,_shadersluminance:()=>NM,_shadersmaterial:()=>HR,_shadersmaterialInput:()=>GR,_shadersmetersPerPixel:()=>FM,_shadersmodelMaterial:()=>WR,_shadersmodelToWindowCoordinates:()=>BM,_shadersmodelVertexOutput:()=>jR,_shadersmultiplyWithColorBalance:()=>kM,_shadersnearFarScalar:()=>VM,_shadersoctDecode:()=>UM,_shadersoneOverPi:()=>hR,_shadersoneOverTwoPi:()=>mR,_shaderspackDepth:()=>zM,_shaderspassCesium3DTile:()=>pR,_shaderspassCesium3DTileClassification:()=>_R,_shaderspassCesium3DTileClassificationIgnoreShow:()=>gR,_shaderspassClassification:()=>yR,_shaderspassCompute:()=>xR,_shaderspassEnvironment:()=>bR,_shaderspassGlobe:()=>TR,_shaderspassOpaque:()=>AR,_shaderspassOverlay:()=>CR,_shaderspassTerrainClassification:()=>ER,_shaderspassTranslucent:()=>SR,_shaderspassVoxels:()=>wR,_shaderspbrLighting:()=>HM,_shaderspbrMetallicRoughnessMaterial:()=>GM,_shaderspbrParameters:()=>qR,_shaderspbrSpecularGlossinessMaterial:()=>WM,_shadersphong:()=>jM,_shaderspi:()=>vR,_shaderspiOverFour:()=>DR,_shaderspiOverSix:()=>IR,_shaderspiOverThree:()=>PR,_shaderspiOverTwo:()=>OR,_shadersplaneDistance:()=>qM,_shaderspointAlongRay:()=>YM,_shadersradiansPerDegree:()=>RR,_shadersray:()=>YR,_shadersrayEllipsoidIntersectionInterval:()=>XM,_shadersraySegment:()=>XR,_shadersraySphereIntersectionInterval:()=>KM,_shadersreadDepth:()=>ZM,_shadersreadNonPerspective:()=>$M,_shadersreverseLogDepth:()=>QM,_shadersround:()=>nL,_shaderssampleOctahedralProjection:()=>iL,_shaderssaturation:()=>oL,_shaderssceneMode2D:()=>MR,_shaderssceneMode3D:()=>LR,_shaderssceneModeColumbusView:()=>NR,_shaderssceneModeMorphing:()=>FR,_shadersshadowDepthCompare:()=>rL,_shadersshadowParameters:()=>KR,_shadersshadowVisibility:()=>sL,_shaderssignNotZero:()=>aL,_shaderssolarRadius:()=>BR,_shaderssphericalHarmonics:()=>cL,_shaderssrgbToLinear:()=>lL,_shaderstangentToEyeSpaceMatrix:()=>uL,_shaderstextureCube:()=>fL,_shadersthreePiOver2:()=>kR,_shaderstransformPlane:()=>dL,_shaderstranslateRelativeToEye:()=>hL,_shaderstranslucentPhong:()=>mL,_shaderstranspose:()=>pL,_shaderstwoPi:()=>VR,_shadersunpackDepth:()=>_L,_shadersunpackFloat:()=>gL,_shadersunpackUint:()=>yL,_shadersvalueTransform:()=>xL,_shadersvertexLogDepth:()=>bL,_shaderswebMercatorMaxLatitude:()=>UR,_shaderswindowToEyeCoordinates:()=>TL,_shaderswriteDepthClamp:()=>AL,_shaderswriteLogDepth:()=>CL,_shaderswriteNonPerspective:()=>EL,addBuffer:()=>RN,addDefaults:()=>AN,addExtensionsRequired:()=>IN,addExtensionsUsed:()=>td,addPipelineExtras:()=>j0,addToArray:()=>Ts,appendForwardSlash:()=>jI,arrayRemoveDuplicates:()=>go,barycentricCoordinates:()=>Ub,binarySearch:()=>Eo,buildDrawCommand:()=>P2,buildModuleUrl:()=>$t,buildVoxelDrawCommands:()=>QL,clone:()=>Ge,combine:()=>gt,computeFlyToLocationForRectangle:()=>tC,createBillboardPointCallback:()=>OA,createCommand:()=>En,createDefaultImageryProviderViewModels:()=>A8,createDefaultTerrainProviderViewModels:()=>C8,createElevationBandMaterial:()=>Mue,createGooglePhotorealistic3DTileset:()=>Nue,createGuid:()=>jn,createMaterialPropertyDescriptor:()=>Oo,createOsmBuildingsAsync:()=>Fue,createPropertyDescriptor:()=>ae,createRawPropertyDescriptor:()=>su,createTangentSpaceDebugPrimitive:()=>Bue,createTaskProcessorWorker:()=>bxe,createUniform:()=>eR,createUniformArray:()=>tR,createWorldImageryAsync:()=>zg,createWorldTerrainAsync:()=>uT,decodeGoogleEarthEnterpriseData:()=>R1,decodeVectorPolylinePositions:()=>M1,defaultValue:()=>y,defer:()=>wl,defined:()=>u,demodernizeShader:()=>wL,deprecationWarning:()=>is,destroyObject:()=>le,exportKml:()=>Pye,findAccessorMinMax:()=>mA,findContentMetadata:()=>kA,findGroupMetadata:()=>VA,findTileMetadata:()=>vB,forEachTextureInMaterial:()=>Cw,formatError:()=>Om,freezeRenderState:()=>_ie,getAbsoluteUri:()=>Sm,getAccessorByteStride:()=>Hl,getBaseUri:()=>nP,getBinaryAccessor:()=>qu,getClipAndStyleCode:()=>H3,getClippingFunction:()=>og,getComponentReader:()=>mg,getElement:()=>In,getExtensionFromUri:()=>Cb,getFilenameFromUri:()=>P_,getImageFromTypedArray:()=>z1,getImagePixels:()=>Qd,getJsonFromTypedArray:()=>So,getMagic:()=>bh,getStringFromTypedArray:()=>Il,getTimestamp:()=>_i,hasExtension:()=>ii,heightReferenceOnEntityPropertyChanged:()=>ay,isBitSet:()=>mc,isBlobUri:()=>Eb,isCrossOriginUrl:()=>Sb,isDataUri:()=>t_,isLeapYear:()=>r_,knockout:()=>Te,knockout_3_5_1:()=>FE,knockout_es5:()=>P4,loadAndExecuteScript:()=>wb,loadCubeMap:()=>rU,loadImageFromTypedArray:()=>ST,loadKTX2:()=>Ll,mergeSort:()=>N_,moveTechniqueRenderStates:()=>DN,moveTechniquesToExtension:()=>PN,numberOfComponentsForType:()=>ef,objectToQuery:()=>vb,oneTimeWarning:()=>It,parseBatchTable:()=>Cg,parseFeatureMetadataLegacy:()=>QN,parseGlb:()=>SN,parseResponseHeaders:()=>oP,parseStructuralMetadata:()=>$N,pointInsideTriangle:()=>Yee,preprocess3DTileContent:()=>Dp,processVoxelProperties:()=>$L,queryToObject:()=>wu,readAccessorPacked:()=>MN,removeExtension:()=>pA,removeExtensionsRequired:()=>EN,removeExtensionsUsed:()=>hA,removePipelineExtras:()=>vN,removeUnusedElements:()=>ON,resizeImageToNextPowerOfTwo:()=>S0,sampleTerrain:()=>wO,sampleTerrainMostDetailed:()=>j_,scaleToGeodeticSurface:()=>yb,subdivideArray:()=>LO,subscribeAndEvaluate:()=>ya,updateAccessorComponentTypes:()=>NN,updateVersion:()=>VN,usesExtension:()=>cr,viewerCesium3DTilesInspectorMixin:()=>obe,viewerCesiumInspectorMixin:()=>rbe,viewerDragDropMixin:()=>abe,viewerPerformanceWatchdogMixin:()=>cbe,viewerVoxelInspectorMixin:()=>ube,webGLConstantToGlslType:()=>Wne,wrapFunction:()=>VO,writeTextToCanvas:()=>vT});var console=__webpack_require__(5108),Buffer=__webpack_require__(8764).Buffer,bbe=Object.create,EX=Object.defineProperty,Tbe=Object.getOwnPropertyDescriptor,Abe=Object.getOwnPropertyNames,Cbe=Object.getPrototypeOf,Ebe=Object.prototype.hasOwnProperty,WI=__webpack_require__(1580),Vc=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Sbe=(e,t,i,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of Abe(t))!Ebe.call(e,r)&&r!==i&&EX(e,r,{get:()=>t[r],enumerable:!(n=Tbe(t,r))||n.enumerable});return e},or=(e,t,i)=>(i=null!=e?bbe(Cbe(e)):{},Sbe(!t&&e&&e.__esModule?i:EX(i,"default",{value:e,enumerable:!0}),e)),qI=Vc(((e,t)=>{var i=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,e.constructor==Array?this.init_by_array(e,e.length):this.init_seed(e)};i.prototype.init_seed=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},i.prototype.init_by_array=function(e,t){var i,n,r;for(this.init_seed(19650218),i=1,n=0,r=this.N>t?this.N:t;r;r--){var o=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(1664525*((4294901760&o)>>>16)<<16)+1664525*(65535&o))+e[n]+n,this.mt[i]>>>=0,n++,++i>=this.N&&(this.mt[0]=this.mt[this.N-1],i=1),n>=t&&(n=0)}for(r=this.N-1;r;r--){o=this.mt[i-1]^this.mt[i-1]>>>30;this.mt[i]=(this.mt[i]^(1566083941*((4294901760&o)>>>16)<<16)+1566083941*(65535&o))-i,this.mt[i]>>>=0,++i>=this.N&&(this.mt[0]=this.mt[this.N-1],i=1)}this.mt[0]=2147483648},i.prototype.random_int=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var i;for(this.mti==this.N+1&&this.init_seed(5489),i=0;i<this.N-this.M;i++)e=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+this.M]^e>>>1^t[1&e];for(;i<this.N-1;i++)e=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},i.prototype.random_int31=function(){return this.random_int()>>>1},i.prototype.random_incl=function(){return this.random_int()*(1/4294967295)},i.prototype.random=function(){return this.random_int()*(1/4294967296)},i.prototype.random_excl=function(){return(this.random_int()+.5)*(1/4294967296)},i.prototype.random_long=function(){return(67108864*(this.random_int()>>>5)+(this.random_int()>>>6))*(1/9007199254740992)},t.exports=i})),kX=Vc(((e,t)=>{/*! https://mths.be/punycode v1.4.0 by @mathias */!function(i){var n="object"==typeof e&&e&&!e.nodeType&&e,r="object"==typeof t&&t&&!t.nodeType&&t,o="object"==typeof __webpack_require__.g&&__webpack_require__.g;(o.global===o||o.window===o||o.self===o)&&(i=o);var a,s,l=2147483647,u=36,c=1,h=26,d=38,p=700,f=72,m=128,_="-",g=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=u-c,T=Math.floor,E=String.fromCharCode;function C(e){throw new RangeError(b[e])}function x(e,t){for(var i=e.length,n=[];i--;)n[i]=t(e[i]);return n}function S(e,t){var i=e.split("@"),n="";return i.length>1&&(n=i[0]+"@",e=i[1]),n+x((e=e.replace(v,".")).split("."),t).join(".")}function w(e){for(var t,i,n=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function I(e){return x(e,(function(e){var t="";return e>65535&&(t+=E((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=E(e)})).join("")}function P(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:u}function D(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,i){var n=0;for(e=i?T(e/p):e>>1,e+=T(e/t);e>A*h>>1;n+=u)e=T(e/A);return T(n+(A+1)*e/(e+d))}function L(e){var t,i,n,r,o,a,s,d,p,g,y=[],v=e.length,b=0,A=m,E=f;for((i=e.lastIndexOf(_))<0&&(i=0),n=0;n<i;++n)e.charCodeAt(n)>=128&&C("not-basic"),y.push(e.charCodeAt(n));for(r=i>0?i+1:0;r<v;){for(o=b,a=1,s=u;r>=v&&C("invalid-input"),((d=P(e.charCodeAt(r++)))>=u||d>T((l-b)/a))&&C("overflow"),b+=d*a,!(d<(p=s<=E?c:s>=E+h?h:s-E));s+=u)a>T(l/(g=u-p))&&C("overflow"),a*=g;E=O(b-o,t=y.length+1,0==o),T(b/t)>l-A&&C("overflow"),A+=T(b/t),b%=t,y.splice(b++,0,A)}return I(y)}function R(e){var t,i,n,r,o,a,s,d,p,g,y,v,b,A,x,S=[];for(v=(e=w(e)).length,t=m,i=0,o=f,a=0;a<v;++a)(y=e[a])<128&&S.push(E(y));for(n=r=S.length,r&&S.push(_);n<v;){for(s=l,a=0;a<v;++a)(y=e[a])>=t&&y<s&&(s=y);for(s-t>T((l-i)/(b=n+1))&&C("overflow"),i+=(s-t)*b,t=s,a=0;a<v;++a)if((y=e[a])<t&&++i>l&&C("overflow"),y==t){for(d=i,p=u;!(d<(g=p<=o?c:p>=o+h?h:p-o));p+=u)x=d-g,A=u-g,S.push(E(D(g+x%A,0))),d=T(x/A);S.push(E(D(d,0))),o=O(i,b,n==r),i=0,++n}++i,++t}return S.join("")}if(a={version:"1.3.2",ucs2:{decode:w,encode:I},decode:L,encode:R,toASCII:function(e){return S(e,(function(e){return y.test(e)?"xn--"+R(e):e}))},toUnicode:function(e){return S(e,(function(e){return g.test(e)?L(e.slice(4).toLowerCase()):e}))}},"function"==typeof define&&__webpack_require__.amdO)define("punycode",(function(){return a}));else if(n&&r)if(t.exports==n)r.exports=a;else for(s in a)a.hasOwnProperty(s)&&(n[s]=a[s]);else i.punycode=a}(e)})),UX=Vc(((e,t)=>{
/*!
 * URI.js - Mutating URLs
 * IPv6 Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */
var i,n;i=e,n=function(e){var t=e&&e.IPv6;return{best:function(e){var t,i=e.toLowerCase().split(":"),n=i.length,r=8;for(""===i[0]&&""===i[1]&&""===i[2]?(i.shift(),i.shift()):""===i[0]&&""===i[1]?i.shift():""===i[n-1]&&""===i[n-2]&&i.pop(),-1!==i[(n=i.length)-1].indexOf(".")&&(r=7),t=0;t<n&&""!==i[t];t++);if(t<r)for(i.splice(t,1,"0000");i.length<r;)i.splice(t,0,"0000");for(var o,a=0;a<r;a++){o=i[a].split("");for(var s=0;s<3&&"0"===o[0]&&o.length>1;s++)o.splice(0,1);i[a]=o.join("")}var l=-1,u=0,c=0,h=-1,d=!1;for(a=0;a<r;a++)d?"0"===i[a]?c+=1:(d=!1,c>u&&(l=h,u=c)):"0"===i[a]&&(d=!0,h=a,c=1);c>u&&(l=h,u=c),u>1&&i.splice(l,u,""),n=i.length;var p="";for(""===i[0]&&(p=":"),a=0;a<n&&(p+=i[a],a!==n-1);a++)p+=":";return""===i[n-1]&&(p+=":"),p},noConflict:function(){return e.IPv6===this&&(e.IPv6=t),this}}},"object"==typeof t&&t.exports?t.exports=n():"function"==typeof define&&__webpack_require__.amdO?define(n):i.IPv6=n(i)})),HX=Vc(((e,t)=>{
/*!
 * URI.js - Mutating URLs
 * Second Level Domain (SLD) Support
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */
var i,n;i=e,n=function(e){var t=e&&e.SecondLevelDomains,i={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch ",com:"ar br cn de eu gb gr hu jpn kr no qc ru sa se uk us uy za ",net:"gb jp se uk ",org:"ae",de:"com "},has:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return!1;var r=i.list[e.slice(t+1)];return!!r&&r.indexOf(" "+e.slice(n+1,t)+" ")>=0},is:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return!1;if(e.lastIndexOf(".",t-1)>=0)return!1;var n=i.list[e.slice(t+1)];return!!n&&n.indexOf(" "+e.slice(0,t)+" ")>=0},get:function(e){var t=e.lastIndexOf(".");if(t<=0||t>=e.length-1)return null;var n=e.lastIndexOf(".",t-1);if(n<=0||n>=t-1)return null;var r=i.list[e.slice(t+1)];return!r||r.indexOf(" "+e.slice(n+1,t)+" ")<0?null:e.slice(n+1)},noConflict:function(){return e.SecondLevelDomains===this&&(e.SecondLevelDomains=t),this}};return i},"object"==typeof t&&t.exports?t.exports=n():"function"==typeof define&&__webpack_require__.amdO?define(n):i.SecondLevelDomains=n(i)})),Sl=Vc(((e,t)=>{
/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.11
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */
var i,n;i=e,n=function(e,t,i,n){var r=n&&n.URI;function o(e,t){var i=arguments.length>=1;if(!(this instanceof o))return i?arguments.length>=2?new o(e,t):new o(e):new o;if(void 0===e){if(i)throw new TypeError("undefined is not a valid argument for URI");e=typeof location<"u"?location.href+"":""}if(null===e&&i)throw new TypeError("null is not a valid argument for URI");return this.href(e),void 0!==t?this.absoluteTo(t):this}o.version="1.19.11";var a=o.prototype,s=Object.prototype.hasOwnProperty;function l(e){return e.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function u(e){return void 0===e?"Undefined":String(Object.prototype.toString.call(e)).slice(8,-1)}function c(e){return"Array"===u(e)}function h(e,t){var i,n,r={};if("RegExp"===u(t))r=null;else if(c(t))for(i=0,n=t.length;i<n;i++)r[t[i]]=!0;else r[t]=!0;for(i=0,n=e.length;i<n;i++)(r&&void 0!==r[e[i]]||!r&&t.test(e[i]))&&(e.splice(i,1),n--,i--);return e}function d(e,t){var i,n;if(c(t)){for(i=0,n=t.length;i<n;i++)if(!d(e,t[i]))return!1;return!0}var r=u(t);for(i=0,n=e.length;i<n;i++)if("RegExp"===r){if("string"==typeof e[i]&&e[i].match(t))return!0}else if(e[i]===t)return!0;return!1}function p(e,t){if(!c(e)||!c(t)||e.length!==t.length)return!1;e.sort(),t.sort();for(var i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function f(e){return e.replace(/^\/+|\/+$/g,"")}function m(e){return escape(e)}function _(e){return encodeURIComponent(e).replace(/[!'()*]/g,m).replace(/\*/g,"%2A")}o._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,preventInvalidHostname:o.preventInvalidHostname,duplicateQueryParameters:o.duplicateQueryParameters,escapeQuerySpace:o.escapeQuerySpace}},o.preventInvalidHostname=!1,o.duplicateQueryParameters=!1,o.escapeQuerySpace=!0,o.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,o.idn_expression=/[^a-z0-9\._-]/i,o.punycode_expression=/(xn--)/i,o.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,o.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,o.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi,o.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?]+$/,parens:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},o.leading_whitespace_expression=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o.ascii_tab_whitespace=/[\u0009\u000A\u000D]+/g,o.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},o.hostProtocols=["http","https"],o.invalid_hostname_characters=/[^a-zA-Z0-9\.\-:_]/,o.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},o.getDomAttribute=function(e){if(e&&e.nodeName){var t=e.nodeName.toLowerCase();if("input"!==t||"image"===e.type)return o.domAttributes[t]}},o.encode=_,o.decode=decodeURIComponent,o.iso8859=function(){o.encode=escape,o.decode=unescape},o.unicode=function(){o.encode=_,o.decode=decodeURIComponent},o.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},urnpath:{encode:{expression:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{"%21":"!","%24":"$","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{expression:/[\/\?#:]/g,map:{"/":"%2F","?":"%3F","#":"%23",":":"%3A"}}}},o.encodeQuery=function(e,t){var i=o.encode(e+"");return void 0===t&&(t=o.escapeQuerySpace),t?i.replace(/%20/g,"+"):i},o.decodeQuery=function(e,t){e+="",void 0===t&&(t=o.escapeQuerySpace);try{return o.decode(t?e.replace(/\+/g,"%20"):e)}catch{return e}};var g,y={encode:"encode",decode:"decode"},v=function(e,t){return function(i){try{return o[t](i+"").replace(o.characters[e][t].expression,(function(i){return o.characters[e][t].map[i]}))}catch{return i}}};for(g in y)o[g+"PathSegment"]=v("pathname",y[g]),o[g+"UrnPathSegment"]=v("urnpath",y[g]);var b=function(e,t,i){return function(n){var r;r=i?function(e){return o[t](o[i](e))}:o[t];for(var a=(n+"").split(e),s=0,l=a.length;s<l;s++)a[s]=r(a[s]);return a.join(e)}};function A(e){return function(t,i){return void 0===t?this._parts[e]||"":(this._parts[e]=t||null,this.build(!i),this)}}function T(e,t){return function(i,n){return void 0===i?this._parts[e]||"":(null!==i&&(i+="").charAt(0)===t&&(i=i.substring(1)),this._parts[e]=i,this.build(!n),this)}}o.decodePath=b("/","decodePathSegment"),o.decodeUrnPath=b(":","decodeUrnPathSegment"),o.recodePath=b("/","encodePathSegment","decode"),o.recodeUrnPath=b(":","encodeUrnPathSegment","decode"),o.encodeReserved=v("reserved","encode"),o.parse=function(e,t){var i;return t||(t={preventInvalidHostname:o.preventInvalidHostname}),(i=(e=(e=e.replace(o.leading_whitespace_expression,"")).replace(o.ascii_tab_whitespace,"")).indexOf("#"))>-1&&(t.fragment=e.substring(i+1)||null,e=e.substring(0,i)),(i=e.indexOf("?"))>-1&&(t.query=e.substring(i+1)||null,e=e.substring(0,i)),"//"===(e=(e=e.replace(/^(https?|ftp|wss?)?:+[/\\]*/i,"$1://")).replace(/^[/\\]{2,}/i,"//")).substring(0,2)?(t.protocol=null,e=e.substring(2),e=o.parseAuthority(e,t)):(i=e.indexOf(":"))>-1&&(t.protocol=e.substring(0,i)||null,t.protocol&&!t.protocol.match(o.protocol_expression)?t.protocol=void 0:"//"===e.substring(i+1,i+3).replace(/\\/g,"/")?(e=e.substring(i+3),e=o.parseAuthority(e,t)):(e=e.substring(i+1),t.urn=!0)),t.path=e,t},o.parseHost=function(e,t){e||(e="");var i,n,r=(e=e.replace(/\\/g,"/")).indexOf("/");if(-1===r&&(r=e.length),"["===e.charAt(0))i=e.indexOf("]"),t.hostname=e.substring(1,i)||null,t.port=e.substring(i+2,r)||null,"/"===t.port&&(t.port=null);else{var a=e.indexOf(":"),s=e.indexOf("/"),l=e.indexOf(":",a+1);-1!==l&&(-1===s||l<s)?(t.hostname=e.substring(0,r)||null,t.port=null):(n=e.substring(0,r).split(":"),t.hostname=n[0]||null,t.port=n[1]||null)}return t.hostname&&"/"!==e.substring(r).charAt(0)&&(r++,e="/"+e),t.preventInvalidHostname&&o.ensureValidHostname(t.hostname,t.protocol),t.port&&o.ensureValidPort(t.port),e.substring(r)||"/"},o.parseAuthority=function(e,t){return e=o.parseUserinfo(e,t),o.parseHost(e,t)},o.parseUserinfo=function(e,t){var i=e;-1!==e.indexOf("\\")&&(e=e.replace(/\\/g,"/"));var n,r=e.indexOf("/"),a=e.lastIndexOf("@",r>-1?r:e.length-1);return a>-1&&(-1===r||a<r)?(n=e.substring(0,a).split(":"),t.username=n[0]?o.decode(n[0]):null,n.shift(),t.password=n[0]?o.decode(n.join(":")):null,e=i.substring(a+1)):(t.username=null,t.password=null),e},o.parseQuery=function(e,t){if(!e)return{};if(!(e=e.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var i,n,r,a={},l=e.split("&"),u=l.length,c=0;c<u;c++)i=l[c].split("="),n=o.decodeQuery(i.shift(),t),r=i.length?o.decodeQuery(i.join("="),t):null,"__proto__"!==n&&(s.call(a,n)?(("string"==typeof a[n]||null===a[n])&&(a[n]=[a[n]]),a[n].push(r)):a[n]=r);return a},o.build=function(e){var t="",i=!1;return e.protocol&&(t+=e.protocol+":"),!e.urn&&(t||e.hostname)&&(t+="//",i=!0),t+=o.buildAuthority(e)||"","string"==typeof e.path&&("/"!==e.path.charAt(0)&&i&&(t+="/"),t+=e.path),"string"==typeof e.query&&e.query&&(t+="?"+e.query),"string"==typeof e.fragment&&e.fragment&&(t+="#"+e.fragment),t},o.buildHost=function(e){var t="";return e.hostname?(o.ip6_expression.test(e.hostname)?t+="["+e.hostname+"]":t+=e.hostname,e.port&&(t+=":"+e.port),t):""},o.buildAuthority=function(e){return o.buildUserinfo(e)+o.buildHost(e)},o.buildUserinfo=function(e){var t="";return e.username&&(t+=o.encode(e.username)),e.password&&(t+=":"+o.encode(e.password)),t&&(t+="@"),t},o.buildQuery=function(e,t,i){var n,r,a,l,u="";for(r in e)if("__proto__"!==r&&s.call(e,r))if(c(e[r]))for(n={},a=0,l=e[r].length;a<l;a++)void 0!==e[r][a]&&void 0===n[e[r][a]+""]&&(u+="&"+o.buildQueryParameter(r,e[r][a],i),!0!==t&&(n[e[r][a]+""]=!0));else void 0!==e[r]&&(u+="&"+o.buildQueryParameter(r,e[r],i));return u.substring(1)},o.buildQueryParameter=function(e,t,i){return o.encodeQuery(e,i)+(null!==t?"="+o.encodeQuery(t,i):"")},o.addQuery=function(e,t,i){if("object"==typeof t)for(var n in t)s.call(t,n)&&o.addQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===e[t])return void(e[t]=i);"string"==typeof e[t]&&(e[t]=[e[t]]),c(i)||(i=[i]),e[t]=(e[t]||[]).concat(i)}},o.setQuery=function(e,t,i){if("object"==typeof t)for(var n in t)s.call(t,n)&&o.setQuery(e,n,t[n]);else{if("string"!=typeof t)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");e[t]=void 0===i?null:i}},o.removeQuery=function(e,t,i){var n,r,a;if(c(t))for(n=0,r=t.length;n<r;n++)e[t[n]]=void 0;else if("RegExp"===u(t))for(a in e)t.test(a)&&(e[a]=void 0);else if("object"==typeof t)for(a in t)s.call(t,a)&&o.removeQuery(e,a,t[a]);else{if("string"!=typeof t)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==i?"RegExp"===u(i)?!c(e[t])&&i.test(e[t])?e[t]=void 0:e[t]=h(e[t],i):e[t]!==String(i)||c(i)&&1!==i.length?c(e[t])&&(e[t]=h(e[t],i)):e[t]=void 0:e[t]=void 0}},o.hasQuery=function(e,t,i,n){switch(u(t)){case"String":break;case"RegExp":for(var r in e)if(s.call(e,r)&&t.test(r)&&(void 0===i||o.hasQuery(e,r,i)))return!0;return!1;case"Object":for(var a in t)if(s.call(t,a)&&!o.hasQuery(e,a,t[a]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(u(i)){case"Undefined":return t in e;case"Boolean":return i===!!(c(e[t])?e[t].length:e[t]);case"Function":return!!i(e[t],t,e);case"Array":return!!c(e[t])&&(n?d:p)(e[t],i);case"RegExp":return c(e[t])?!!n&&d(e[t],i):!(!e[t]||!e[t].match(i));case"Number":i=String(i);case"String":return c(e[t])?!!n&&d(e[t],i):e[t]===i;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},o.joinPaths=function(){for(var e=[],t=[],i=0,n=0;n<arguments.length;n++){var r=new o(arguments[n]);e.push(r);for(var a=r.segment(),s=0;s<a.length;s++)"string"==typeof a[s]&&t.push(a[s]),a[s]&&i++}if(!t.length||!i)return new o("");var l=new o("").segment(t);return(""===e[0].path()||"/"===e[0].path().slice(0,1))&&l.path("/"+l.path()),l.normalize()},o.commonPath=function(e,t){var i,n=Math.min(e.length,t.length);for(i=0;i<n;i++)if(e.charAt(i)!==t.charAt(i)){i--;break}return i<1?e.charAt(0)===t.charAt(0)&&"/"===e.charAt(0)?"/":"":(("/"!==e.charAt(i)||"/"!==t.charAt(i))&&(i=e.substring(0,i).lastIndexOf("/")),e.substring(0,i+1))},o.withinString=function(e,t,i){i||(i={});var n=i.start||o.findUri.start,r=i.end||o.findUri.end,a=i.trim||o.findUri.trim,s=i.parens||o.findUri.parens,l=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var u=n.exec(e);if(!u)break;var c=u.index;if(i.ignoreHtml){var h=e.slice(Math.max(c-3,0),c);if(h&&l.test(h))continue}for(var d=c+e.slice(c).search(r),p=e.slice(c,d),f=-1;;){var m=s.exec(p);if(!m)break;var _=m.index+m[0].length;f=Math.max(f,_)}if(!((p=f>-1?p.slice(0,f)+p.slice(f).replace(a,""):p.replace(a,"")).length<=u[0].length||i.ignore&&i.ignore.test(p))){var g=t(p,c,d=c+p.length,e);if(void 0===g){n.lastIndex=d;continue}g=String(g),e=e.slice(0,c)+g+e.slice(d),n.lastIndex=c+g.length}}return n.lastIndex=0,e},o.ensureValidHostname=function(t,i){var n=!!t,r=!1;if(!!i&&(r=d(o.hostProtocols,i)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+i);if(t&&t.match(o.invalid_hostname_characters)){if(!e)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(e.toASCII(t).match(o.invalid_hostname_characters))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},o.ensureValidPort=function(e){if(e){var t=Number(e);if(!(function(e){return/^[0-9]+$/.test(e)}(t)&&t>0&&t<65536))throw new TypeError('Port "'+e+'" is not a valid port')}},o.noConflict=function(e){if(e){var t={URI:this.noConflict()};return n.URITemplate&&"function"==typeof n.URITemplate.noConflict&&(t.URITemplate=n.URITemplate.noConflict()),n.IPv6&&"function"==typeof n.IPv6.noConflict&&(t.IPv6=n.IPv6.noConflict()),n.SecondLevelDomains&&"function"==typeof n.SecondLevelDomains.noConflict&&(t.SecondLevelDomains=n.SecondLevelDomains.noConflict()),t}return n.URI===this&&(n.URI=r),this},a.build=function(e){return!0===e?this._deferred_build=!0:(void 0===e||this._deferred_build)&&(this._string=o.build(this._parts),this._deferred_build=!1),this},a.clone=function(){return new o(this)},a.valueOf=a.toString=function(){return this.build(!1)._string},a.protocol=A("protocol"),a.username=A("username"),a.password=A("password"),a.hostname=A("hostname"),a.port=A("port"),a.query=T("query","?"),a.fragment=T("fragment","#"),a.search=function(e,t){var i=this.query(e,t);return"string"==typeof i&&i.length?"?"+i:i},a.hash=function(e,t){var i=this.fragment(e,t);return"string"==typeof i&&i.length?"#"+i:i},a.pathname=function(e,t){if(void 0===e||!0===e){var i=this._parts.path||(this._parts.hostname?"/":"");return e?(this._parts.urn?o.decodeUrnPath:o.decodePath)(i):i}return this._parts.urn?this._parts.path=e?o.recodeUrnPath(e):"":this._parts.path=e?o.recodePath(e):"/",this.build(!t),this},a.path=a.pathname,a.href=function(e,t){var i;if(void 0===e)return this.toString();this._string="",this._parts=o._parts();var n=e instanceof o,r="object"==typeof e&&(e.hostname||e.path||e.pathname);if(e.nodeName&&(e=e[o.getDomAttribute(e)]||"",r=!1),!n&&r&&void 0!==e.pathname&&(e=e.toString()),"string"==typeof e||e instanceof String)this._parts=o.parse(String(e),this._parts);else{if(!n&&!r)throw new TypeError("invalid input");var a=n?e._parts:e;for(i in a)"query"!==i&&s.call(this._parts,i)&&(this._parts[i]=a[i]);a.query&&this.query(a.query,!1)}return this.build(!t),this},a.is=function(e){var t=!1,n=!1,r=!1,a=!1,s=!1,l=!1,u=!1,c=!this._parts.urn;switch(this._parts.hostname&&(c=!1,n=o.ip4_expression.test(this._parts.hostname),r=o.ip6_expression.test(this._parts.hostname),s=(a=!(t=n||r))&&i&&i.has(this._parts.hostname),l=a&&o.idn_expression.test(this._parts.hostname),u=a&&o.punycode_expression.test(this._parts.hostname)),e.toLowerCase()){case"relative":return c;case"absolute":return!c;case"domain":case"name":return a;case"sld":return s;case"ip":return t;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return l;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return u}return null};var E=a.protocol,C=a.port,x=a.hostname;a.protocol=function(e,t){if(e&&!(e=e.replace(/:(\/\/)?$/,"")).match(o.protocol_expression))throw new TypeError('Protocol "'+e+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return E.call(this,e,t)},a.scheme=a.protocol,a.port=function(e,t){return this._parts.urn?void 0===e?"":this:(void 0!==e&&(0===e&&(e=null),e&&(":"===(e+="").charAt(0)&&(e=e.substring(1)),o.ensureValidPort(e))),C.call(this,e,t))},a.hostname=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0!==e){var i={preventInvalidHostname:this._parts.preventInvalidHostname};if("/"!==o.parseHost(e,i))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');e=i.hostname,this._parts.preventInvalidHostname&&o.ensureValidHostname(e,this._parts.protocol)}return x.call(this,e,t)},a.origin=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var i=this.protocol();return this.authority()?(i?i+"://":"")+this.authority():""}var n=o(e);return this.protocol(n.protocol()).authority(n.authority()).build(!t),this},a.host=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildHost(this._parts):"";if("/"!==o.parseHost(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},a.authority=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e)return this._parts.hostname?o.buildAuthority(this._parts):"";if("/"!==o.parseAuthority(e,this._parts))throw new TypeError('Hostname "'+e+'" contains characters other than [A-Z0-9.-]');return this.build(!t),this},a.userinfo=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){var i=o.buildUserinfo(this._parts);return i&&i.substring(0,i.length-1)}return"@"!==e[e.length-1]&&(e+="@"),o.parseUserinfo(e,this._parts),this.build(!t),this},a.resource=function(e,t){var i;return void 0===e?this.path()+this.search()+this.hash():(i=o.parse(e),this._parts.path=i.path,this._parts.query=i.query,this._parts.fragment=i.fragment,this.build(!t),this)},a.subdomain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var i=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,i)||""}var n=this._parts.hostname.length-this.domain().length,r=this._parts.hostname.substring(0,n),a=new RegExp("^"+l(r));if(e&&"."!==e.charAt(e.length-1)&&(e+="."),-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");return e&&o.ensureValidHostname(e,this._parts.protocol),this._parts.hostname=this._parts.hostname.replace(a,e),this.build(!t),this},a.domain=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var i=this._parts.hostname.match(/\./g);if(i&&i.length<2)return this._parts.hostname;var n=this._parts.hostname.length-this.tld(t).length-1;return n=this._parts.hostname.lastIndexOf(".",n-1)+1,this._parts.hostname.substring(n)||""}if(!e)throw new TypeError("cannot set domain empty");if(-1!==e.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(o.ensureValidHostname(e,this._parts.protocol),!this._parts.hostname||this.is("IP"))this._parts.hostname=e;else{var r=new RegExp(l(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(r,e)}return this.build(!t),this},a.tld=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("boolean"==typeof e&&(t=e,e=void 0),void 0===e){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),r=this._parts.hostname.substring(n+1);return!0!==t&&i&&i.list[r.toLowerCase()]&&i.get(this._parts.hostname)||r}var o;if(!e)throw new TypeError("cannot set TLD empty");if(e.match(/[^a-zA-Z0-9-]/)){if(!i||!i.is(e))throw new TypeError('TLD "'+e+'" contains characters other than [A-Z0-9]');o=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");o=new RegExp(l(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,e)}return this.build(!t),this},a.directory=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var i=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,i)||(this._parts.hostname?"/":"");return e?o.decodePath(n):n}var r=this._parts.path.length-this.filename().length,a=this._parts.path.substring(0,r),s=new RegExp("^"+l(a));return this.is("relative")||(e||(e="/"),"/"!==e.charAt(0)&&(e="/"+e)),e&&"/"!==e.charAt(e.length-1)&&(e+="/"),e=o.recodePath(e),this._parts.path=this._parts.path.replace(s,e),this.build(!t),this},a.filename=function(e,t){if(this._parts.urn)return void 0===e?"":this;if("string"!=typeof e){if(!this._parts.path||"/"===this._parts.path)return"";var i=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(i+1);return e?o.decodePathSegment(n):n}var r=!1;"/"===e.charAt(0)&&(e=e.substring(1)),e.match(/\.?\//)&&(r=!0);var a=new RegExp(l(this.filename())+"$");return e=o.recodePath(e),this._parts.path=this._parts.path.replace(a,e),r?this.normalizePath(t):this.build(!t),this},a.suffix=function(e,t){if(this._parts.urn)return void 0===e?"":this;if(void 0===e||!0===e){if(!this._parts.path||"/"===this._parts.path)return"";var i,n,r=this.filename(),a=r.lastIndexOf(".");return-1===a?"":(i=r.substring(a+1),n=/^[a-z0-9%]+$/i.test(i)?i:"",e?o.decodePathSegment(n):n)}"."===e.charAt(0)&&(e=e.substring(1));var s,u=this.suffix();if(u)s=e?new RegExp(l(u)+"$"):new RegExp(l("."+u)+"$");else{if(!e)return this;this._parts.path+="."+o.recodePath(e)}return s&&(e=o.recodePath(e),this._parts.path=this._parts.path.replace(s,e)),this.build(!t),this},a.segment=function(e,t,i){var n=this._parts.urn?":":"/",r=this.path(),o="/"===r.substring(0,1),a=r.split(n);if(void 0!==e&&"number"!=typeof e&&(i=t,t=e,e=void 0),void 0!==e&&"number"!=typeof e)throw new Error('Bad segment "'+e+'", must be 0-based integer');if(o&&a.shift(),e<0&&(e=Math.max(a.length+e,0)),void 0===t)return void 0===e?a:a[e];if(null===e||void 0===a[e])if(c(t)){a=[];for(var s=0,l=t.length;s<l;s++)!t[s].length&&(!a.length||!a[a.length-1].length)||(a.length&&!a[a.length-1].length&&a.pop(),a.push(f(t[s])))}else(t||"string"==typeof t)&&(t=f(t),""===a[a.length-1]?a[a.length-1]=t:a.push(t));else t?a[e]=f(t):a.splice(e,1);return o&&a.unshift(""),this.path(a.join(n),i)},a.segmentCoded=function(e,t,i){var n,r,a;if("number"!=typeof e&&(i=t,t=e,e=void 0),void 0===t){if(c(n=this.segment(e,t,i)))for(r=0,a=n.length;r<a;r++)n[r]=o.decode(n[r]);else n=void 0!==n?o.decode(n):void 0;return n}if(c(t))for(r=0,a=t.length;r<a;r++)t[r]=o.encode(t[r]);else t="string"==typeof t||t instanceof String?o.encode(t):t;return this.segment(e,t,i)};var S=a.query;return a.query=function(e,t){if(!0===e)return o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof e){var i=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=e.call(this,i);return this._parts.query=o.buildQuery(n||i,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this}return void 0!==e&&"string"!=typeof e?(this._parts.query=o.buildQuery(e,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!t),this):S.call(this,e,t)},a.setQuery=function(e,t,i){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof e||e instanceof String)n[e]=void 0!==t?t:null;else{if("object"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var r in e)s.call(e,r)&&(n[r]=e[r])}return this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(i=t),this.build(!i),this},a.addQuery=function(e,t,i){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.addQuery(n,e,void 0===t?null:t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(i=t),this.build(!i),this},a.removeQuery=function(e,t,i){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.removeQuery(n,e,t),this._parts.query=o.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof e&&(i=t),this.build(!i),this},a.hasQuery=function(e,t,i){var n=o.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return o.hasQuery(n,e,t,i)},a.setSearch=a.setQuery,a.addSearch=a.addQuery,a.removeSearch=a.removeQuery,a.hasSearch=a.hasQuery,a.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},a.normalizeProtocol=function(e){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!e)),this},a.normalizeHostname=function(i){return this._parts.hostname&&(this.is("IDN")&&e?this._parts.hostname=e.toASCII(this._parts.hostname):this.is("IPv6")&&t&&(this._parts.hostname=t.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!i)),this},a.normalizePort=function(e){return"string"==typeof this._parts.protocol&&this._parts.port===o.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!e)),this},a.normalizePath=function(e){var t=this._parts.path;if(!t)return this;if(this._parts.urn)return this._parts.path=o.recodeUrnPath(this._parts.path),this.build(!e),this;if("/"===this._parts.path)return this;var i,n,r,a="";for("/"!==(t=o.recodePath(t)).charAt(0)&&(i=!0,t="/"+t),("/.."===t.slice(-3)||"/."===t.slice(-2))&&(t+="/"),t=t.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(a=t.substring(1).match(/^(\.\.\/)+/)||"")&&(a=a[0]);-1!==(n=t.search(/\/\.\.(\/|$)/));)0!==n?(-1===(r=t.substring(0,n).lastIndexOf("/"))&&(r=n),t=t.substring(0,r)+t.substring(n+3)):t=t.substring(3);return i&&this.is("relative")&&(t=a+t.substring(1)),this._parts.path=t,this.build(!e),this},a.normalizePathname=a.normalizePath,a.normalizeQuery=function(e){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(o.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!e)),this},a.normalizeFragment=function(e){return this._parts.fragment||(this._parts.fragment=null,this.build(!e)),this},a.normalizeSearch=a.normalizeQuery,a.normalizeHash=a.normalizeFragment,a.iso8859=function(){var e=o.encode,t=o.decode;o.encode=escape,o.decode=decodeURIComponent;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},a.unicode=function(){var e=o.encode,t=o.decode;o.encode=_,o.decode=unescape;try{this.normalize()}finally{o.encode=e,o.decode=t}return this},a.readable=function(){var t=this.clone();t.username("").password("").normalize();var i="";if(t._parts.protocol&&(i+=t._parts.protocol+"://"),t._parts.hostname&&(t.is("punycode")&&e?(i+=e.toUnicode(t._parts.hostname),t._parts.port&&(i+=":"+t._parts.port)):i+=t.host()),t._parts.hostname&&t._parts.path&&"/"!==t._parts.path.charAt(0)&&(i+="/"),i+=t.path(!0),t._parts.query){for(var n="",r=0,a=t._parts.query.split("&"),s=a.length;r<s;r++){var l=(a[r]||"").split("=");n+="&"+o.decodeQuery(l[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==l[1]&&(n+="="+o.decodeQuery(l[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}i+="?"+n.substring(1)}return i+=o.decodeQuery(t.hash(),!0)},a.absoluteTo=function(e){var t,i,n,r=this.clone(),a=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e instanceof o||(e=new o(e)),r._parts.protocol||(r._parts.protocol=e._parts.protocol,this._parts.hostname))return r;for(i=0;n=a[i];i++)r._parts[n]=e._parts[n];return r._parts.path?(".."===r._parts.path.substring(-2)&&(r._parts.path+="/"),"/"!==r.path().charAt(0)&&(t=(t=e.directory())||(0===e.path().indexOf("/")?"/":""),r._parts.path=(t?t+"/":"")+r._parts.path,r.normalizePath())):(r._parts.path=e._parts.path,r._parts.query||(r._parts.query=e._parts.query)),r.build(),r},a.relativeTo=function(e){var t,i,n,r,a,s=this.clone().normalize();if(s._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(e=new o(e).normalize(),t=s._parts,i=e._parts,r=s.path(),a=e.path(),"/"!==r.charAt(0))throw new Error("URI is already relative");if("/"!==a.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(t.protocol===i.protocol&&(t.protocol=null),t.username!==i.username||t.password!==i.password||null!==t.protocol||null!==t.username||null!==t.password)return s.build();if(t.hostname!==i.hostname||t.port!==i.port)return s.build();if(t.hostname=null,t.port=null,r===a)return t.path="",s.build();if(!(n=o.commonPath(r,a)))return s.build();var l=i.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return t.path=l+t.path.substring(n.length)||"./",s.build()},a.equals=function(e){var t,i,n,r,a,l=this.clone(),u=new o(e),h={};if(l.normalize(),u.normalize(),l.toString()===u.toString())return!0;if(n=l.query(),r=u.query(),l.query(""),u.query(""),l.toString()!==u.toString()||n.length!==r.length)return!1;for(a in t=o.parseQuery(n,this._parts.escapeQuerySpace),i=o.parseQuery(r,this._parts.escapeQuerySpace),t)if(s.call(t,a)){if(c(t[a])){if(!p(t[a],i[a]))return!1}else if(t[a]!==i[a])return!1;h[a]=!0}for(a in i)if(s.call(i,a)&&!h[a])return!1;return!0},a.preventInvalidHostname=function(e){return this._parts.preventInvalidHostname=!!e,this},a.duplicateQueryParameters=function(e){return this._parts.duplicateQueryParameters=!!e,this},a.escapeQuerySpace=function(e){return this._parts.escapeQuerySpace=!!e,this},o},"object"==typeof t&&t.exports?t.exports=n(kX(),UX(),HX()):"function"==typeof define&&__webpack_require__.amdO?define(["./punycode","./IPv6","./SecondLevelDomains"],n):i.URI=n(i.punycode,i.IPv6,i.SecondLevelDomains,i)})),yK=Vc(((e,t)=>{/*! @license DOMPurify 3.0.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.6/LICENSE */var i,n;i=e,n=function(){let{entries:e,setPrototypeOf:t,isFrozen:i,getPrototypeOf:n,getOwnPropertyDescriptor:r}=Object,{freeze:o,seal:a,create:s}=Object,{apply:l,construct:u}=typeof Reflect<"u"&&Reflect;o||(o=function(e){return e}),a||(a=function(e){return e}),l||(l=function(e,t,i){return e.apply(t,i)}),u||(u=function(e,t){return new e(...t)});let c=T(Array.prototype.forEach),h=T(Array.prototype.pop),d=T(Array.prototype.push),p=T(String.prototype.toLowerCase),f=T(String.prototype.toString),m=T(String.prototype.match),_=T(String.prototype.replace),g=T(String.prototype.indexOf),y=T(String.prototype.trim),v=T(RegExp.prototype.test),b=(A=TypeError,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return u(A,t)});var A;function T(e){return function(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return l(e,t,n)}}function E(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;t&&t(e,null);let o=n.length;for(;o--;){let t=n[o];if("string"==typeof t){let e=r(t);e!==t&&(i(n)||(n[o]=e),t=e)}e[t]=!0}return e}function C(t){let i=s(null);for(let[n,o]of e(t))void 0!==r(t,n)&&(i[n]=o);return i}function x(e,t){for(;null!==e;){let i=r(e,t);if(i){if(i.get)return T(i.get);if("function"==typeof i.value)return T(i.value)}e=n(e)}return function(e){return console.warn("fallback value for",e),null}}let S=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),w=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),I=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),P=o(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),O=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),L=o(["#text"]),R=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),N=o(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),M=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),F=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=a(/<%[\w\W]*|[\w\W]*%>/gm),U=a(/\${[\w\W]*}/gm),k=a(/^data-[\-\w.\u00B7-\uFFFF]/),V=a(/^aria-[\-\w]+$/),H=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=a(/^(?:\w+script|data):/i),j=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),W=a(/^html$/i);var q=Object.freeze({__proto__:null,MUSTACHE_EXPR:B,ERB_EXPR:z,TMPLIT_EXPR:U,DATA_ATTR:k,ARIA_ATTR:V,IS_ALLOWED_URI:H,IS_SCRIPT_OR_DATA:G,ATTR_WHITESPACE:j,DOCTYPE_NAME:W}),Y=function t(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:typeof window>"u"?null:window,n=e=>t(e);if(n.version="3.0.6",n.removed=[],!i||!i.document||9!==i.document.nodeType)return n.isSupported=!1,n;let{document:r}=i,a=r,l=a.currentScript,{DocumentFragment:u,HTMLTemplateElement:A,Node:T,Element:B,NodeFilter:z,NamedNodeMap:U=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:k,DOMParser:V,trustedTypes:G}=i,j=B.prototype,Y=x(j,"cloneNode"),X=x(j,"nextSibling"),$=x(j,"childNodes"),K=x(j,"parentNode");if("function"==typeof A){let e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let J,Q="",{implementation:Z,createNodeIterator:ee,createDocumentFragment:te,getElementsByTagName:ie}=r,{importNode:ne}=a,re={};n.isSupported="function"==typeof e&&"function"==typeof K&&Z&&void 0!==Z.createHTMLDocument;let{MUSTACHE_EXPR:oe,ERB_EXPR:ae,TMPLIT_EXPR:se,DATA_ATTR:le,ARIA_ATTR:ue,IS_SCRIPT_OR_DATA:ce,ATTR_WHITESPACE:he}=q,{IS_ALLOWED_URI:de}=q,pe=null,fe=E({},[...S,...w,...I,...D,...L]),me=null,_e=E({},[...R,...N,...M,...F]),ge=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ye=null,ve=null,be=!0,Ae=!0,Te=!1,Ee=!0,Ce=!1,xe=!1,Se=!1,we=!1,Ie=!1,Pe=!1,De=!1,Oe=!0,Le=!1,Re=!0,Ne=!1,Me={},Fe=null,Be=E({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ze=null,Ue=E({},["audio","video","img","source","image","track"]),ke=null,Ve=E({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),He="http://www.w3.org/1998/Math/MathML",Ge="http://www.w3.org/2000/svg",je="http://www.w3.org/1999/xhtml",We=je,qe=!1,Ye=null,Xe=E({},[He,Ge,je],f),$e=null,Ke=["application/xhtml+xml","text/html"],Je=null,Qe=null,Ze=r.createElement("form"),et=function(e){return e instanceof RegExp||e instanceof Function},tt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Qe||Qe!==e){if((!e||"object"!=typeof e)&&(e={}),e=C(e),$e=$e=-1===Ke.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Je="application/xhtml+xml"===$e?f:p,pe="ALLOWED_TAGS"in e?E({},e.ALLOWED_TAGS,Je):fe,me="ALLOWED_ATTR"in e?E({},e.ALLOWED_ATTR,Je):_e,Ye="ALLOWED_NAMESPACES"in e?E({},e.ALLOWED_NAMESPACES,f):Xe,ke="ADD_URI_SAFE_ATTR"in e?E(C(Ve),e.ADD_URI_SAFE_ATTR,Je):Ve,ze="ADD_DATA_URI_TAGS"in e?E(C(Ue),e.ADD_DATA_URI_TAGS,Je):Ue,Fe="FORBID_CONTENTS"in e?E({},e.FORBID_CONTENTS,Je):Be,ye="FORBID_TAGS"in e?E({},e.FORBID_TAGS,Je):{},ve="FORBID_ATTR"in e?E({},e.FORBID_ATTR,Je):{},Me="USE_PROFILES"in e&&e.USE_PROFILES,be=!1!==e.ALLOW_ARIA_ATTR,Ae=!1!==e.ALLOW_DATA_ATTR,Te=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ce=e.SAFE_FOR_TEMPLATES||!1,xe=e.WHOLE_DOCUMENT||!1,Ie=e.RETURN_DOM||!1,Pe=e.RETURN_DOM_FRAGMENT||!1,De=e.RETURN_TRUSTED_TYPE||!1,we=e.FORCE_BODY||!1,Oe=!1!==e.SANITIZE_DOM,Le=e.SANITIZE_NAMED_PROPS||!1,Re=!1!==e.KEEP_CONTENT,Ne=e.IN_PLACE||!1,de=e.ALLOWED_URI_REGEXP||H,We=e.NAMESPACE||je,ge=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&et(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ge.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&et(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ge.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ge.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ce&&(Ae=!1),Pe&&(Ie=!0),Me&&(pe=E({},[...L]),me=[],!0===Me.html&&(E(pe,S),E(me,R)),!0===Me.svg&&(E(pe,w),E(me,N),E(me,F)),!0===Me.svgFilters&&(E(pe,I),E(me,N),E(me,F)),!0===Me.mathMl&&(E(pe,D),E(me,M),E(me,F))),e.ADD_TAGS&&(pe===fe&&(pe=C(pe)),E(pe,e.ADD_TAGS,Je)),e.ADD_ATTR&&(me===_e&&(me=C(me)),E(me,e.ADD_ATTR,Je)),e.ADD_URI_SAFE_ATTR&&E(ke,e.ADD_URI_SAFE_ATTR,Je),e.FORBID_CONTENTS&&(Fe===Be&&(Fe=C(Fe)),E(Fe,e.FORBID_CONTENTS,Je)),Re&&(pe["#text"]=!0),xe&&E(pe,["html","head","body"]),pe.table&&(E(pe,["tbody"]),delete ye.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw b('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw b('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');J=e.TRUSTED_TYPES_POLICY,Q=J.createHTML("")}else void 0===J&&(J=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let i=null,n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));let r="dompurify"+(i?"#"+i:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}}(G,l)),null!==J&&"string"==typeof Q&&(Q=J.createHTML(""));o&&o(e),Qe=e}},it=E({},["mi","mo","mn","ms","mtext"]),nt=E({},["foreignobject","desc","title","annotation-xml"]),rt=E({},["title","style","font","a","script"]),ot=E({},w);E(ot,I),E(ot,P);let at=E({},D);E(at,O);let st=function(e){d(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch{e.remove()}},lt=function(e,t){try{d(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch{d(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!me[e])if(Ie||Pe)try{st(t)}catch{}else try{t.setAttribute(e,"")}catch{}},ut=function(e){let t=null,i=null;if(we)e="<remove></remove>"+e;else{let t=m(e,/^[\r\n\t ]+/);i=t&&t[0]}"application/xhtml+xml"===$e&&We===je&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");let n=J?J.createHTML(e):e;if(We===je)try{t=(new V).parseFromString(n,$e)}catch{}if(!t||!t.documentElement){t=Z.createDocument(We,"template",null);try{t.documentElement.innerHTML=qe?Q:n}catch{}}let o=t.body||t.documentElement;return e&&i&&o.insertBefore(r.createTextNode(i),o.childNodes[0]||null),We===je?ie.call(t,xe?"html":"body")[0]:xe?t.documentElement:o},ct=function(e){return ee.call(e.ownerDocument||e,e,z.SHOW_ELEMENT|z.SHOW_COMMENT|z.SHOW_TEXT,null)},ht=function(e){return"function"==typeof T&&e instanceof T},dt=function(e,t,i){re[e]&&c(re[e],(e=>{e.call(n,t,i,Qe)}))},pt=function(e){let t=null;if(dt("beforeSanitizeElements",e,null),function(e){return e instanceof k&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof U)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)}(e))return st(e),!0;let i=Je(e.nodeName);if(dt("uponSanitizeElement",e,{tagName:i,allowedTags:pe}),e.hasChildNodes()&&!ht(e.firstElementChild)&&v(/<[/\w]/g,e.innerHTML)&&v(/<[/\w]/g,e.textContent))return st(e),!0;if(!pe[i]||ye[i]){if(!ye[i]&&mt(i)&&(ge.tagNameCheck instanceof RegExp&&v(ge.tagNameCheck,i)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(i)))return!1;if(Re&&!Fe[i]){let t=K(e)||e.parentNode,i=$(e)||e.childNodes;if(i&&t)for(let n=i.length-1;n>=0;--n)t.insertBefore(Y(i[n],!0),X(e))}return st(e),!0}return e instanceof B&&!function(e){let t=K(e);(!t||!t.tagName)&&(t={namespaceURI:We,tagName:"template"});let i=p(e.tagName),n=p(t.tagName);return!!Ye[e.namespaceURI]&&(e.namespaceURI===Ge?t.namespaceURI===je?"svg"===i:t.namespaceURI===He?"svg"===i&&("annotation-xml"===n||it[n]):!!ot[i]:e.namespaceURI===He?t.namespaceURI===je?"math"===i:t.namespaceURI===Ge?"math"===i&&nt[n]:!!at[i]:e.namespaceURI===je?!(t.namespaceURI===Ge&&!nt[n]||t.namespaceURI===He&&!it[n])&&!at[i]&&(rt[i]||!ot[i]):!("application/xhtml+xml"!==$e||!Ye[e.namespaceURI]))}(e)||("noscript"===i||"noembed"===i||"noframes"===i)&&v(/<\/no(script|embed|frames)/i,e.innerHTML)?(st(e),!0):(Ce&&3===e.nodeType&&(t=e.textContent,c([oe,ae,se],(e=>{t=_(t,e," ")})),e.textContent!==t&&(d(n.removed,{element:e.cloneNode()}),e.textContent=t)),dt("afterSanitizeElements",e,null),!1)},ft=function(e,t,i){if(Oe&&("id"===t||"name"===t)&&(i in r||i in Ze))return!1;if((!Ae||ve[t]||!v(le,t))&&(!be||!v(ue,t)))if(!me[t]||ve[t]){if(!(mt(e)&&(ge.tagNameCheck instanceof RegExp&&v(ge.tagNameCheck,e)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(e))&&(ge.attributeNameCheck instanceof RegExp&&v(ge.attributeNameCheck,t)||ge.attributeNameCheck instanceof Function&&ge.attributeNameCheck(t))||"is"===t&&ge.allowCustomizedBuiltInElements&&(ge.tagNameCheck instanceof RegExp&&v(ge.tagNameCheck,i)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(i))))return!1}else if(!ke[t]&&!v(de,_(i,he,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==g(i,"data:")||!ze[e])&&(!Te||v(ce,_(i,he,"")))&&i)return!1;return!0},mt=function(e){return e.indexOf("-")>0},_t=function(e){dt("beforeSanitizeAttributes",e,null);let{attributes:t}=e;if(!t)return;let i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:me},r=t.length;for(;r--;){let o=t[r],{name:a,namespaceURI:s,value:l}=o,u=Je(a),d="value"===a?l:y(l);if(i.attrName=u,i.attrValue=d,i.keepAttr=!0,i.forceKeepAttr=void 0,dt("uponSanitizeAttribute",e,i),d=i.attrValue,i.forceKeepAttr||(lt(a,e),!i.keepAttr))continue;if(!Ee&&v(/\/>/i,d)){lt(a,e);continue}Ce&&c([oe,ae,se],(e=>{d=_(d,e," ")}));let p=Je(e.nodeName);if(ft(p,u,d)){if(Le&&("id"===u||"name"===u)&&(lt(a,e),d="user-content-"+d),J&&"object"==typeof G&&"function"==typeof G.getAttributeType&&!s)switch(G.getAttributeType(p,u)){case"TrustedHTML":d=J.createHTML(d);break;case"TrustedScriptURL":d=J.createScriptURL(d)}try{s?e.setAttributeNS(s,a,d):e.setAttribute(a,d),h(n.removed)}catch{}}}dt("afterSanitizeAttributes",e,null)},gt=function e(t){let i=null,n=ct(t);for(dt("beforeSanitizeShadowDOM",t,null);i=n.nextNode();)dt("uponSanitizeShadowNode",i,null),!pt(i)&&(i.content instanceof u&&e(i.content),_t(i));dt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,r=null,o=null,s=null;if(qe=!e,qe&&(e="\x3c!--\x3e"),"string"!=typeof e&&!ht(e)){if("function"!=typeof e.toString)throw b("toString is not a function");if("string"!=typeof(e=e.toString()))throw b("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Se||tt(t),n.removed=[],"string"==typeof e&&(Ne=!1),Ne){if(e.nodeName){let t=Je(e.nodeName);if(!pe[t]||ye[t])throw b("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof T)i=ut("\x3c!----\x3e"),r=i.ownerDocument.importNode(e,!0),1===r.nodeType&&"BODY"===r.nodeName||"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!Ie&&!Ce&&!xe&&-1===e.indexOf("<"))return J&&De?J.createHTML(e):e;if(i=ut(e),!i)return Ie?null:De?Q:""}i&&we&&st(i.firstChild);let l=ct(Ne?e:i);for(;o=l.nextNode();)pt(o)||(o.content instanceof u&&gt(o.content),_t(o));if(Ne)return e;if(Ie){if(Pe)for(s=te.call(i.ownerDocument);i.firstChild;)s.appendChild(i.firstChild);else s=i;return(me.shadowroot||me.shadowrootmode)&&(s=ne.call(a,s,!0)),s}let h=xe?i.outerHTML:i.innerHTML;return xe&&pe["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&v(W,i.ownerDocument.doctype.name)&&(h="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+h),Ce&&c([oe,ae,se],(e=>{h=_(h,e," ")})),J&&De?J.createHTML(h):h},n.setConfig=function(){tt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Se=!0},n.clearConfig=function(){Qe=null,Se=!1},n.isValidAttribute=function(e,t,i){Qe||tt({});let n=Je(e),r=Je(t);return ft(n,r,i)},n.addHook=function(e,t){"function"==typeof t&&(re[e]=re[e]||[],d(re[e],t))},n.removeHook=function(e){if(re[e])return h(re[e])},n.removeHooks=function(e){re[e]&&(re[e]=[])},n.removeAllHooks=function(){re={}},n}();return Y},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&__webpack_require__.amdO?define(n):(i=typeof globalThis<"u"?globalThis:i||self).DOMPurify=n()})),fQ=Vc(((e,t)=>{function i(e,t,i){i=i||2;var r,a,s,l,u,d,p,m=t&&t.length,_=m?t[0]*i:e.length,g=n(e,0,_,i,!0),y=[];if(!g||g.next===g.prev)return y;if(m&&(g=function(e,t,i,r){var o,a,s,l,u,d=[];for(o=0,a=t.length;o<a;o++)s=t[o]*r,l=o<a-1?t[o+1]*r:e.length,(u=n(e,s,l,r,!1))===u.next&&(u.steiner=!0),d.push(f(u));for(d.sort(c),o=0;o<d.length;o++)i=h(d[o],i);return i}(e,t,g,i)),e.length>80*i){r=s=e[0],a=l=e[1];for(var v=i;v<_;v+=i)(u=e[v])<r&&(r=u),(d=e[v+1])<a&&(a=d),u>s&&(s=u),d>l&&(l=d);p=0!==(p=Math.max(s-r,l-a))?32767/p:0}return o(g,y,i,r,a,p,0),y}function n(e,t,i,n,r){var o,a;if(r===w(e,t,i,n)>0)for(o=t;o<i;o+=n)a=C(o,e[o],e[o+1],a);else for(o=i-n;o>=t;o-=n)a=C(o,e[o],e[o+1],a);return a&&y(a,a.next)&&(x(a),a=a.next),a}function r(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!y(n,n.next)&&0!==g(n.prev,n,n.next))n=n.next;else{if(x(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function o(e,t,i,n,c,h,d){if(e){!d&&h&&function(e,t,i,n){var r=e;do{0===r.z&&(r.z=p(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,o,a,s,l,u=1;do{for(i=e,e=null,o=null,a=0;i;){for(a++,n=i,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;i=n}o.nextZ=null,u*=2}while(a>1)}(r)}(e,n,c,h);for(var f,m,_=e;e.prev!==e.next;)if(f=e.prev,m=e.next,h?s(e,n,c,h):a(e))t.push(f.i/i|0),t.push(e.i/i|0),t.push(m.i/i|0),x(e),e=m.next,_=m.next;else if((e=m)===_){d?1===d?o(e=l(r(e),t,i),t,i,n,c,h,2):2===d&&u(e,t,i,n,c,h):o(r(e),t,i,n,c,h,1);break}}}function a(e){var t=e.prev,i=e,n=e.next;if(g(t,i,n)>=0)return!1;for(var r=t.x,o=i.x,a=n.x,s=t.y,l=i.y,u=n.y,c=r<o?r<a?r:a:o<a?o:a,h=s<l?s<u?s:u:l<u?l:u,d=r>o?r>a?r:a:o>a?o:a,p=s>l?s>u?s:u:l>u?l:u,f=n.next;f!==t;){if(f.x>=c&&f.x<=d&&f.y>=h&&f.y<=p&&m(r,s,o,l,a,u,f.x,f.y)&&g(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function s(e,t,i,n){var r=e.prev,o=e,a=e.next;if(g(r,o,a)>=0)return!1;for(var s=r.x,l=o.x,u=a.x,c=r.y,h=o.y,d=a.y,f=s<l?s<u?s:u:l<u?l:u,_=c<h?c<d?c:d:h<d?h:d,y=s>l?s>u?s:u:l>u?l:u,v=c>h?c>d?c:d:h>d?h:d,b=p(f,_,t,i,n),A=p(y,v,t,i,n),T=e.prevZ,E=e.nextZ;T&&T.z>=b&&E&&E.z<=A;){if(T.x>=f&&T.x<=y&&T.y>=_&&T.y<=v&&T!==r&&T!==a&&m(s,c,l,h,u,d,T.x,T.y)&&g(T.prev,T,T.next)>=0||(T=T.prevZ,E.x>=f&&E.x<=y&&E.y>=_&&E.y<=v&&E!==r&&E!==a&&m(s,c,l,h,u,d,E.x,E.y)&&g(E.prev,E,E.next)>=0))return!1;E=E.nextZ}for(;T&&T.z>=b;){if(T.x>=f&&T.x<=y&&T.y>=_&&T.y<=v&&T!==r&&T!==a&&m(s,c,l,h,u,d,T.x,T.y)&&g(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;E&&E.z<=A;){if(E.x>=f&&E.x<=y&&E.y>=_&&E.y<=v&&E!==r&&E!==a&&m(s,c,l,h,u,d,E.x,E.y)&&g(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function l(e,t,i){var n=e;do{var o=n.prev,a=n.next.next;!y(o,a)&&v(o,n,n.next,a)&&T(o,a)&&T(a,o)&&(t.push(o.i/i|0),t.push(n.i/i|0),t.push(a.i/i|0),x(n),x(n.next),n=e=a),n=n.next}while(n!==e);return r(n)}function u(e,t,i,n,a,s){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&_(l,u)){var c=E(l,u);return l=r(l,l.next),c=r(c,c.next),o(l,t,i,n,a,s,0),void o(c,t,i,n,a,s,0)}u=u.next}l=l.next}while(l!==e)}function c(e,t){return e.x-t.x}function h(e,t){var i=function(e,t){var i,n=t,r=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a&&(a=s,i=n.x<n.next.x?n:n.next,s===r))return i}n=n.next}while(n!==t);if(!i)return null;var l,u=i,c=i.x,h=i.y,p=1/0;n=i;do{r>=n.x&&n.x>=c&&r!==n.x&&m(o<h?r:a,o,c,h,o<h?a:r,o,n.x,n.y)&&(l=Math.abs(o-n.y)/(r-n.x),T(n,e)&&(l<p||l===p&&(n.x>i.x||n.x===i.x&&d(i,n)))&&(i=n,p=l)),n=n.next}while(n!==u);return i}(e,t);if(!i)return t;var n=E(i,e);return r(n,n.next),r(i,i.next)}function d(e,t){return g(e.prev,e,t.prev)<0&&g(t.next,e,e.next)<0}function p(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function f(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function m(e,t,i,n,r,o,a,s){return(r-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(i-a)*(t-s)&&(i-a)*(o-s)>=(r-a)*(n-s)}function _(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&v(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(T(e,t)&&T(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(g(e.prev,e,t.prev)||g(e,t.prev,t))||y(e,t)&&g(e.prev,e,e.next)>0&&g(t.prev,t,t.next)>0)}function g(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,i,n){var r=A(g(e,t,i)),o=A(g(e,t,n)),a=A(g(i,n,e)),s=A(g(i,n,t));return!!(r!==o&&a!==s||0===r&&b(e,i,t)||0===o&&b(e,n,t)||0===a&&b(i,e,n)||0===s&&b(i,t,n))}function b(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function A(e){return e>0?1:e<0?-1:0}function T(e,t){return g(e.prev,e,e.next)<0?g(e,t,e.next)>=0&&g(e,e.prev,t)>=0:g(e,t,e.prev)<0||g(e,e.next,t)<0}function E(e,t){var i=new S(e.i,e.x,e.y),n=new S(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function C(e,t,i,n){var r=new S(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function x(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function S(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function w(e,t,i,n){for(var r=0,o=t,a=i-n;o<i;o+=n)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}t.exports=i,t.exports.default=i,i.deviation=function(e,t,i,n){var r=t&&t.length,o=r?t[0]*i:e.length,a=Math.abs(w(e,0,o,i));if(r)for(var s=0,l=t.length;s<l;s++){var u=t[s]*i,c=s<l-1?t[s+1]*i:e.length;a-=Math.abs(w(e,u,c,i))}var h=0;for(s=0;s<n.length;s+=3){var d=n[s]*i,p=n[s+1]*i,f=n[s+2]*i;h+=Math.abs((e[d]-e[f])*(e[p+1]-e[d+1])-(e[d]-e[p])*(e[f+1]-e[d+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},i.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var a=0;a<t;a++)i.vertices.push(e[r][o][a]);r>0&&(n+=e[r-1].length,i.holes.push(n))}return i}})),gG=Vc(((exports,module)=>{
/*!
 * protobuf.js v7.2.5 (c) 2016, daniel wirtz
 * compiled tue, 22 aug 2023 00:04:28 utc
 * licensed under the bsd-3-clause license
 * see: https://github.com/dcodeio/protobuf.js for details
 */
(function(undefined){var t,n,r;t={1:[function(e,t,i){t.exports=function(e,t){for(var i=new Array(arguments.length-1),n=0,r=2,o=!0;r<arguments.length;)i[n++]=arguments[r++];return new Promise((function(r,a){i[n]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];r.apply(null,t)}};try{e.apply(t||null,i)}catch(e){o&&(o=!1,a(e))}}))}},{}],2:[function(e,t,i){var n=i;n.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var r=new Array(64),o=new Array(123),a=0;a<64;)o[r[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;n.encode=function(e,t,i){for(var n,o=null,a=[],s=0,l=0;t<i;){var u=e[t++];switch(l){case 0:a[s++]=r[u>>2],n=(3&u)<<4,l=1;break;case 1:a[s++]=r[n|u>>4],n=(15&u)<<2,l=2;break;case 2:a[s++]=r[n|u>>6],a[s++]=r[63&u],l=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return l&&(a[s++]=r[n],a[s++]=61,1===l&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var s="invalid encoding";n.decode=function(e,t,i){for(var n,r=i,a=0,l=0;l<e.length;){var u=e.charCodeAt(l++);if(61===u&&a>1)break;if((u=o[u])===undefined)throw Error(s);switch(a){case 0:n=u,a=1;break;case 1:t[i++]=n<<2|(48&u)>>4,n=u,a=2;break;case 2:t[i++]=(15&n)<<4|(60&u)>>2,n=u,a=3;break;case 3:t[i++]=(3&n)<<6|u,a=0}}if(1===a)throw Error(s);return i-r},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,i){function n(){this._listeners={}}t.exports=n,n.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},n.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},{}],4:[function(e,t,i){function n(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),n=128===i[3];function r(e,n,r){t[0]=e,n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2],n[r+3]=i[3]}function o(e,n,r){t[0]=e,n[r]=i[3],n[r+1]=i[2],n[r+2]=i[1],n[r+3]=i[0]}function a(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t[0]}function s(e,n){return i[3]=e[n],i[2]=e[n+1],i[1]=e[n+2],i[0]=e[n+3],t[0]}e.writeFloatLE=n?r:o,e.writeFloatBE=n?o:r,e.readFloatLE=n?a:s,e.readFloatBE=n?s:a}():function(){function t(e,t,i,n){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((r<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,i,n)}}function i(e,t,i){var n=e(t,i),r=2*(n>>31)+1,o=n>>>23&255,a=8388607&n;return 255===o?a?NaN:r*(1/0):0===o?1401298464324817e-60*r*a:r*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,o),e.readFloatLE=i.bind(null,a),e.readFloatBE=i.bind(null,s)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),n=128===i[7];function r(e,n,r){t[0]=e,n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2],n[r+3]=i[3],n[r+4]=i[4],n[r+5]=i[5],n[r+6]=i[6],n[r+7]=i[7]}function o(e,n,r){t[0]=e,n[r]=i[7],n[r+1]=i[6],n[r+2]=i[5],n[r+3]=i[4],n[r+4]=i[3],n[r+5]=i[2],n[r+6]=i[1],n[r+7]=i[0]}function a(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],i[4]=e[n+4],i[5]=e[n+5],i[6]=e[n+6],i[7]=e[n+7],t[0]}function s(e,n){return i[7]=e[n],i[6]=e[n+1],i[5]=e[n+2],i[4]=e[n+3],i[3]=e[n+4],i[2]=e[n+5],i[1]=e[n+6],i[0]=e[n+7],t[0]}e.writeDoubleLE=n?r:o,e.writeDoubleBE=n?o:r,e.readDoubleLE=n?a:s,e.readDoubleBE=n?s:a}():function(){function t(e,t,i,n,r,o){var a=n<0?1:0;if(a&&(n=-n),0===n)e(0,r,o+t),e(1/n>0?0:2147483648,r,o+i);else if(isNaN(n))e(0,r,o+t),e(2146959360,r,o+i);else if(n>17976931348623157e292)e(0,r,o+t),e((a<<31|2146435072)>>>0,r,o+i);else{var s;if(n<22250738585072014e-324)e((s=n/5e-324)>>>0,r,o+t),e((a<<31|s/4294967296)>>>0,r,o+i);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(s=n*Math.pow(2,-l))>>>0,r,o+t),e((a<<31|l+1023<<20|1048576*s&1048575)>>>0,r,o+i)}}}function i(e,t,i,n,r){var o=e(n,r+t),a=e(n,r+i),s=2*(a>>31)+1,l=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===l?u?NaN:s*(1/0):0===l?5e-324*s*u:s*Math.pow(2,l-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=i.bind(null,a,0,4),e.readDoubleBE=i.bind(null,s,4,0)}(),e}function r(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function o(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=n(n)},{}],5:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],6:[function(e,t,i){t.exports=function(e,t,i){var n=i||8192,r=n>>>1,o=null,a=n;return function(i){if(i<1||i>r)return e(i);a+i>n&&(o=e(n),a=0);var s=t.call(o,a,a+=i);return 7&a&&(a=1+(7|a)),s}}},{}],7:[function(e,t,i){var n=i;n.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},n.read=function(e,t,i){if(i-t<1)return"";for(var n,r=null,o=[],a=0;t<i;)(n=e[t++])<128?o[a++]=n:n>191&&n<224?o[a++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(n>>10),o[a++]=56320+(1023&n)):o[a++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,o)),a=0);return r?(a&&r.push(String.fromCharCode.apply(String,o.slice(0,a))),r.join("")):String.fromCharCode.apply(String,o.slice(0,a))},n.write=function(e,t,i){for(var n,r,o=i,a=0;a<e.length;++a)(n=e.charCodeAt(a))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296==(64512&n)&&56320==(64512&(r=e.charCodeAt(a+1)))?(n=65536+((1023&n)<<10)+(1023&r),++a,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-o}},{}],8:[function(e,t,i){var n=i;function r(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=e(16),n.BufferWriter=e(17),n.Reader=e(9),n.BufferReader=e(10),n.util=e(15),n.rpc=e(12),n.roots=e(11),n.configure=r,r()},{10:10,11:11,12:12,15:15,16:16,17:17,9:9}],9:[function(e,t,i){t.exports=l;var n,r=e(15),o=r.LongBits,a=r.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var u,c=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},h=function(){return r.Buffer?function(e){return(l.create=function(e){return r.Buffer.isBuffer(e)?new n(e):c(e)})(e)}:c};function d(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw s(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}l.create=h(),l.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,l.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw s(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,i);if(t===i){var n=r.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,i)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){n=e,l.create=h(),n._configure();var t=r.Long?"toLong":"toNumber";r.merge(l.prototype,{int64:function(){return d.call(this)[t](!1)},uint64:function(){return d.call(this)[t](!0)},sint64:function(){return d.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},{15:15}],10:[function(e,t,i){t.exports=o;var n=e(9);(o.prototype=Object.create(n.prototype)).constructor=o;var r=e(15);function o(e){n.call(this,e)}o._configure=function(){r.Buffer&&(o.prototype._slice=r.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},{15:15,9:9}],11:[function(e,t,i){t.exports={}},{}],12:[function(e,t,i){i.Service=e(13)},{13:13}],13:[function(e,t,i){t.exports=r;var n=e(15);function r(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!i}(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,i,r,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return n.asPromise(e,s,t,i,r,o);if(!s.rpcImpl)return setTimeout((function(){a(Error("already ended"))}),0),undefined;try{return s.rpcImpl(t,i[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,i){if(e)return s.emit("error",e,t),a(e);if(null===i)return s.end(!0),undefined;if(!(i instanceof r))try{i=r[s.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",i,t),a(null,i)}))}catch(e){return s.emit("error",e,t),setTimeout((function(){a(e)}),0),undefined}},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{15:15}],14:[function(e,t,i){t.exports=r;var n=e(15);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=r.zero=new r(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new r(i,n)},r.from=function(e){if("number"==typeof e)return r.fromNumber(e);if(n.isString(e)){if(!n.Long)return r.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):o},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var s=String.prototype.charCodeAt;r.fromHash=function(e){return e===a?o:new r((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},{15:15}],15:[function(e,t,i){var n=i;function r(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;++r)(e[n[r]]===undefined||!i)&&(e[n[r]]=t[n[r]]);return e}function o(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&r(this,i)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:undefined,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=e(1),n.base64=e(2),n.EventEmitter=e(3),n.float=e(4),n.inquire=e(5),n.utf8=e(7),n.pool=e(6),n.LongBits=e(14),n.isNode=!!(typeof __webpack_require__.g<"u"&&__webpack_require__.g&&__webpack_require__.g.process&&__webpack_require__.g.process.versions&&__webpack_require__.g.process.versions.node),n.global=n.isNode&&__webpack_require__.g||typeof window<"u"&&window||typeof self<"u"&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!=typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)},n.Array=typeof Uint8Array<"u"?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(!!t)},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&this[e[i]]!==undefined&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},{1:1,14:14,2:2,3:3,4:4,5:5,6:6,7:7}],16:[function(e,t,i){t.exports=h;var n,r=e(15),o=r.LongBits,a=r.base64,s=r.utf8;function l(e,t,i){this.fn=e,this.len=t,this.next=undefined,this.val=i}function u(){}function c(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new l(u,0,0),this.tail=this.head,this.states=null}var d=function(){return r.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function p(e,t,i){t[i]=255&e}function f(e,t){this.len=e,this.next=undefined,this.val=t}function m(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function _(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}h.create=d(),h.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(h.alloc=r.pool(h.alloc,r.Array.prototype.subarray)),h.prototype._push=function(e,t,i){return this.tail=this.tail.next=new l(e,t,i),this.len+=t,this},f.prototype=Object.create(l.prototype),f.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(p,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(_,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(_,4,t.lo)._push(_,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var g=r.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(r.isString(e)){var i=h.alloc(t=a.length(e));a.decode(e,i,0),e=i}return this.uint32(t)._push(g,t,e)},h.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new c(this),this.head=this.tail=new l(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=d(),n._configure()}},{15:15}],17:[function(e,t,i){t.exports=o;var n=e(16);(o.prototype=Object.create(n.prototype)).constructor=o;var r=e(15);function o(){n.call(this)}function a(e,t,i){e.length<40?r.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}o._configure=function(){o.alloc=r._Buffer_allocUnsafe,o.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}},o.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},{15:15,16:16}]},n={},r=function e(i){var r=n[i];return r||t[i][0].call(r=n[i]={exports:{}},e,r,r.exports),r.exports}(8),r.util.global.protobuf=r,"function"==typeof define&&__webpack_require__.amdO&&define(["long"],(function(e){return e&&e.isLong&&(r.util.Long=e,r.configure()),r})),"object"==typeof module&&module&&module.exports&&(module.exports=r)})()})),pte=Vc(((e,t)=>{var i,n;i=e,n=function(){function e(e,n,r,o,a){!function e(i,n,r,o,a){for(;o>r;){if(o-r>600){var s=o-r+1,l=n-r+1,u=Math.log(s),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1);e(i,n,Math.max(r,Math.floor(n-l*c/s+h)),Math.min(o,Math.floor(n+(s-l)*c/s+h)),a)}var d=i[n],p=r,f=o;for(t(i,r,n),a(i[o],d)>0&&t(i,r,o);p<f;){for(t(i,p,f),p++,f--;a(i[p],d)<0;)p++;for(;a(i[f],d)>0;)f--}0===a(i[r],d)?t(i,r,f):t(i,++f,o),f<=n&&(r=f+1),n<=f&&(o=f-1)}}(e,n,r||0,o||e.length-1,a||i)}function t(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function i(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(e,t,i){if(!i)return t.indexOf(e);for(var n=0;n<t.length;n++)if(i(e,t[n]))return n;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,i,n,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=t;o<i;o++){var a=e.children[o];s(r,e.leaf?n(a):a)}return r}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function u(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function h(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function p(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function f(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,i,n,r,o){for(var a=[i,n];a.length;)if(!((n=a.pop())-(i=a.pop())<=r)){var s=i+Math.ceil((n-i)/r/2)*r;e(t,s,i,n,o),a.push(i,s,s,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,i=[];if(!p(e,t))return i;for(var n=this.toBBox,r=[];t;){for(var o=0;o<t.children.length;o++){var a=t.children[o],s=t.leaf?n(a):a;p(e,s)&&(t.leaf?i.push(a):d(e,s)?this._all(a,i):r.push(a))}t=r.pop()}return i},n.prototype.collides=function(e){var t=this.data;if(!p(e,t))return!1;for(var i=[];t;){for(var n=0;n<t.children.length;n++){var r=t.children[n],o=t.leaf?this.toBBox(r):r;if(p(e,o)){if(t.leaf||d(e,o))return!0;i.push(r)}}t=i.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var i,n,o,a=this.data,s=this.toBBox(e),l=[],u=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],i=u.pop(),o=!0),a.leaf){var c=r(e,a.children,t);if(-1!==c)return a.children.splice(c,1),l.push(a),this._condense(l),this}o||a.leaf||!d(a,s)?n?(i++,a=n.children[i],o=!1):a=null:(l.push(a),u.push(i),i=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},n.prototype._build=function(e,t,i,n){var r,a=i-t+1,s=this._maxEntries;if(a<=s)return o(r=f(e.slice(t,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(r=f([])).leaf=!1,r.height=n;var l=Math.ceil(a/s),u=l*Math.ceil(Math.sqrt(s));m(e,t,i,u,this.compareMinX);for(var c=t;c<=i;c+=u){var h=Math.min(c+u-1,i);m(e,c,h,l,this.compareMinY);for(var d=c;d<=h;d+=l){var p=Math.min(d+l-1,h);r.children.push(this._build(e,d,p,n-1))}}return o(r,this.toBBox),r},n.prototype._chooseSubtree=function(e,t,i,n){for(;n.push(t),!t.leaf&&n.length-1!==i;){for(var r=1/0,o=1/0,a=void 0,s=0;s<t.children.length;s++){var l=t.children[s],u=c(l),h=(d=e,p=l,(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u);h<o?(o=h,r=u<r?u:r,a=l):h===o&&u<r&&(r=u,a=l)}t=a||t.children[0]}var d,p;return t},n.prototype._insert=function(e,t,i){var n=i?e:this.toBBox(e),r=[],o=this._chooseSubtree(n,this.data,t,r);for(o.children.push(e),s(o,n);t>=0&&r[t].children.length>this._maxEntries;)this._split(r,t),t--;this._adjustParentBBoxes(n,r,t)},n.prototype._split=function(e,t){var i=e[t],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var a=this._chooseSplitIndex(i,r,n),s=f(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,o(i,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(i,s)},n.prototype._splitRoot=function(e,t){this.data=f([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,i){for(var n,r,o,s,l,u,h,d=1/0,p=1/0,f=t;f<=i-t;f++){var m=a(e,0,f,this.toBBox),_=a(e,f,i,this.toBBox),g=(r=m,o=_,s=Math.max(r.minX,o.minX),l=Math.max(r.minY,o.minY),u=Math.min(r.maxX,o.maxX),h=Math.min(r.maxY,o.maxY),Math.max(0,u-s)*Math.max(0,h-l)),y=c(m)+c(_);g<d?(d=g,n=f,p=y<p?y:p):g===d&&y<p&&(p=y,n=f)}return n||i-t},n.prototype._chooseSplitAxis=function(e,t,i){var n=e.leaf?this.compareMinX:l,r=e.leaf?this.compareMinY:u;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,r)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,i,n){e.children.sort(n);for(var r=this.toBBox,o=a(e,0,t,r),l=a(e,i-t,i,r),u=h(o)+h(l),c=t;c<i-t;c++){var d=e.children[c];s(o,e.leaf?r(d):d),u+=h(o)}for(var p=i-t-1;p>=t;p--){var f=e.children[p];s(l,e.leaf?r(f):f),u+=h(l)}return u},n.prototype._adjustParentBBoxes=function(e,t,i){for(var n=i;n>=0;n--)s(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,i=void 0;t>=0;t--)0===e[t].children.length?t>0?(i=e[t-1].children).splice(i.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},n},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&__webpack_require__.amdO?define(n):(i=i||self).RBush=n()})),Tce=Vc(((e,t)=>{t.exports=function(e,t){t||(t={});var r,o,a,s,l,u,c,h,d,p,f,m=null==t.cutoff?.25:t.cutoff,_=null==t.radius?8:t.radius,g=t.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");r=t.width,o=t.height,s=e,u=t.stride?t.stride:Math.floor(e.length/r/o)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(c=(h=e).getContext("2d"),r=h.width,o=h.height,d=c.getImageData(0,0,r,o),s=d.data,u=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(h=e.canvas,c=e,r=h.width,o=h.height,d=c.getImageData(0,0,r,o),s=d.data,u=4):window.ImageData&&e instanceof window.ImageData&&(d=e,r=e.width,o=e.height,s=d.data,u=4);if(a=Math.max(r,o),window.Uint8ClampedArray&&s instanceof window.Uint8ClampedArray||window.Uint8Array&&s instanceof window.Uint8Array)for(l=s,s=Array(r*o),p=0,f=Math.floor(l.length/u);p<f;p++)s[p]=l[p*u+g]/255;else if(1!==u)throw Error("Raw data can have only 1 value per pixel");var y=Array(r*o),v=Array(r*o),b=Array(a),A=Array(a),T=Array(a+1),E=Array(a);for(p=0,f=r*o;p<f;p++){var C=s[p];y[p]=1===C?0:0===C?i:Math.pow(Math.max(0,.5-C),2),v[p]=1===C?i:0===C?0:Math.pow(Math.max(0,C-.5),2)}n(y,r,o,b,A,E,T),n(v,r,o,b,A,E,T);var x=window.Float32Array?new Float32Array(r*o):new Array(r*o);for(p=0,f=r*o;p<f;p++)x[p]=Math.min(Math.max(1-((y[p]-v[p])/_+m),0),1);return x};var i=1e20;function n(e,t,i,n,o,a,s){for(var l=0;l<t;l++){for(var u=0;u<i;u++)n[u]=e[u*t+l];for(r(n,o,a,s,i),u=0;u<i;u++)e[u*t+l]=o[u]}for(u=0;u<i;u++){for(l=0;l<t;l++)n[l]=e[u*t+l];for(r(n,o,a,s,t),l=0;l<t;l++)e[u*t+l]=Math.sqrt(o[l])}}function r(e,t,n,r,o){n[0]=0,r[0]=-i,r[1]=+i;for(var a=1,s=0;a<o;a++){for(var l=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);l<=r[s];)s--,l=(e[a]+a*a-(e[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);n[++s]=a,r[s]=l,r[s+1]=+i}for(a=0,s=0;a<o;a++){for(;r[s+1]<a;)s++;t[a]=(a-n[s])*(a-n[s])+e[n[s]]}}})),wce=Vc(((e,t)=>{typeof t<"u"&&t.exports&&(t.exports=function(){var e=3,t=4,i=12,n=13,r=16,o=17;function a(e,t){return 55296<=e.charCodeAt(t)&&e.charCodeAt(t)<=56319&&56320<=e.charCodeAt(t+1)&&e.charCodeAt(t+1)<=57343}function s(e,t){void 0===t&&(t=0);var i=e.charCodeAt(t);if(55296<=i&&i<=56319&&t<e.length-1){var n=i;return 56320<=(r=e.charCodeAt(t+1))&&r<=57343?1024*(n-55296)+(r-56320)+65536:n}if(56320<=i&&i<=57343&&t>=1){var r=i;return 55296<=(n=e.charCodeAt(t-1))&&n<=56319?1024*(n-55296)+(r-56320)+65536:r}return i}function l(a,s,l){var u=[a].concat(s).concat([l]),c=u[u.length-2],h=l,d=u.lastIndexOf(14);if(d>1&&u.slice(1,d).every((function(t){return t==e}))&&-1==[e,n,o].indexOf(a))return 2;var p=u.lastIndexOf(t);if(p>0&&u.slice(1,p).every((function(e){return e==t}))&&-1==[i,t].indexOf(c))return u.filter((function(e){return e==t})).length%2==1?3:4;if(0==c&&1==h)return 0;if(2==c||0==c||1==c)return 14==h&&s.every((function(t){return t==e}))?2:1;if(2==h||0==h||1==h)return 1;if(6==c&&(6==h||7==h||9==h||10==h))return 0;if(!(9!=c&&7!=c||7!=h&&8!=h))return 0;if((10==c||8==c)&&8==h)return 0;if(h==e||15==h)return 0;if(5==h)return 0;if(c==i)return 0;var f=-1!=u.indexOf(e)?u.lastIndexOf(e)-1:u.length-2;return-1!=[n,o].indexOf(u[f])&&u.slice(f+1,-1).every((function(t){return t==e}))&&14==h||15==c&&-1!=[r,o].indexOf(h)?0:-1!=s.indexOf(t)?2:c==t&&h==t?0:1}function u(a){return 1536<=a&&a<=1541||1757==a||1807==a||2274==a||3406==a||69821==a||70082<=a&&a<=70083||72250==a||72326<=a&&a<=72329||73030==a?i:13==a?0:10==a?1:0<=a&&a<=9||11<=a&&a<=12||14<=a&&a<=31||127<=a&&a<=159||173==a||1564==a||6158==a||8203==a||8206<=a&&a<=8207||8232==a||8233==a||8234<=a&&a<=8238||8288<=a&&a<=8292||8293==a||8294<=a&&a<=8303||55296<=a&&a<=57343||65279==a||65520<=a&&a<=65528||65529<=a&&a<=65531||113824<=a&&a<=113827||119155<=a&&a<=119162||917504==a||917505==a||917506<=a&&a<=917535||917632<=a&&a<=917759||918e3<=a&&a<=921599?2:768<=a&&a<=879||1155<=a&&a<=1159||1160<=a&&a<=1161||1425<=a&&a<=1469||1471==a||1473<=a&&a<=1474||1476<=a&&a<=1477||1479==a||1552<=a&&a<=1562||1611<=a&&a<=1631||1648==a||1750<=a&&a<=1756||1759<=a&&a<=1764||1767<=a&&a<=1768||1770<=a&&a<=1773||1809==a||1840<=a&&a<=1866||1958<=a&&a<=1968||2027<=a&&a<=2035||2070<=a&&a<=2073||2075<=a&&a<=2083||2085<=a&&a<=2087||2089<=a&&a<=2093||2137<=a&&a<=2139||2260<=a&&a<=2273||2275<=a&&a<=2306||2362==a||2364==a||2369<=a&&a<=2376||2381==a||2385<=a&&a<=2391||2402<=a&&a<=2403||2433==a||2492==a||2494==a||2497<=a&&a<=2500||2509==a||2519==a||2530<=a&&a<=2531||2561<=a&&a<=2562||2620==a||2625<=a&&a<=2626||2631<=a&&a<=2632||2635<=a&&a<=2637||2641==a||2672<=a&&a<=2673||2677==a||2689<=a&&a<=2690||2748==a||2753<=a&&a<=2757||2759<=a&&a<=2760||2765==a||2786<=a&&a<=2787||2810<=a&&a<=2815||2817==a||2876==a||2878==a||2879==a||2881<=a&&a<=2884||2893==a||2902==a||2903==a||2914<=a&&a<=2915||2946==a||3006==a||3008==a||3021==a||3031==a||3072==a||3134<=a&&a<=3136||3142<=a&&a<=3144||3146<=a&&a<=3149||3157<=a&&a<=3158||3170<=a&&a<=3171||3201==a||3260==a||3263==a||3266==a||3270==a||3276<=a&&a<=3277||3285<=a&&a<=3286||3298<=a&&a<=3299||3328<=a&&a<=3329||3387<=a&&a<=3388||3390==a||3393<=a&&a<=3396||3405==a||3415==a||3426<=a&&a<=3427||3530==a||3535==a||3538<=a&&a<=3540||3542==a||3551==a||3633==a||3636<=a&&a<=3642||3655<=a&&a<=3662||3761==a||3764<=a&&a<=3769||3771<=a&&a<=3772||3784<=a&&a<=3789||3864<=a&&a<=3865||3893==a||3895==a||3897==a||3953<=a&&a<=3966||3968<=a&&a<=3972||3974<=a&&a<=3975||3981<=a&&a<=3991||3993<=a&&a<=4028||4038==a||4141<=a&&a<=4144||4146<=a&&a<=4151||4153<=a&&a<=4154||4157<=a&&a<=4158||4184<=a&&a<=4185||4190<=a&&a<=4192||4209<=a&&a<=4212||4226==a||4229<=a&&a<=4230||4237==a||4253==a||4957<=a&&a<=4959||5906<=a&&a<=5908||5938<=a&&a<=5940||5970<=a&&a<=5971||6002<=a&&a<=6003||6068<=a&&a<=6069||6071<=a&&a<=6077||6086==a||6089<=a&&a<=6099||6109==a||6155<=a&&a<=6157||6277<=a&&a<=6278||6313==a||6432<=a&&a<=6434||6439<=a&&a<=6440||6450==a||6457<=a&&a<=6459||6679<=a&&a<=6680||6683==a||6742==a||6744<=a&&a<=6750||6752==a||6754==a||6757<=a&&a<=6764||6771<=a&&a<=6780||6783==a||6832<=a&&a<=6845||6846==a||6912<=a&&a<=6915||6964==a||6966<=a&&a<=6970||6972==a||6978==a||7019<=a&&a<=7027||7040<=a&&a<=7041||7074<=a&&a<=7077||7080<=a&&a<=7081||7083<=a&&a<=7085||7142==a||7144<=a&&a<=7145||7149==a||7151<=a&&a<=7153||7212<=a&&a<=7219||7222<=a&&a<=7223||7376<=a&&a<=7378||7380<=a&&a<=7392||7394<=a&&a<=7400||7405==a||7412==a||7416<=a&&a<=7417||7616<=a&&a<=7673||7675<=a&&a<=7679||8204==a||8400<=a&&a<=8412||8413<=a&&a<=8416||8417==a||8418<=a&&a<=8420||8421<=a&&a<=8432||11503<=a&&a<=11505||11647==a||11744<=a&&a<=11775||12330<=a&&a<=12333||12334<=a&&a<=12335||12441<=a&&a<=12442||42607==a||42608<=a&&a<=42610||42612<=a&&a<=42621||42654<=a&&a<=42655||42736<=a&&a<=42737||43010==a||43014==a||43019==a||43045<=a&&a<=43046||43204<=a&&a<=43205||43232<=a&&a<=43249||43302<=a&&a<=43309||43335<=a&&a<=43345||43392<=a&&a<=43394||43443==a||43446<=a&&a<=43449||43452==a||43493==a||43561<=a&&a<=43566||43569<=a&&a<=43570||43573<=a&&a<=43574||43587==a||43596==a||43644==a||43696==a||43698<=a&&a<=43700||43703<=a&&a<=43704||43710<=a&&a<=43711||43713==a||43756<=a&&a<=43757||43766==a||44005==a||44008==a||44013==a||64286==a||65024<=a&&a<=65039||65056<=a&&a<=65071||65438<=a&&a<=65439||66045==a||66272==a||66422<=a&&a<=66426||68097<=a&&a<=68099||68101<=a&&a<=68102||68108<=a&&a<=68111||68152<=a&&a<=68154||68159==a||68325<=a&&a<=68326||69633==a||69688<=a&&a<=69702||69759<=a&&a<=69761||69811<=a&&a<=69814||69817<=a&&a<=69818||69888<=a&&a<=69890||69927<=a&&a<=69931||69933<=a&&a<=69940||70003==a||70016<=a&&a<=70017||70070<=a&&a<=70078||70090<=a&&a<=70092||70191<=a&&a<=70193||70196==a||70198<=a&&a<=70199||70206==a||70367==a||70371<=a&&a<=70378||70400<=a&&a<=70401||70460==a||70462==a||70464==a||70487==a||70502<=a&&a<=70508||70512<=a&&a<=70516||70712<=a&&a<=70719||70722<=a&&a<=70724||70726==a||70832==a||70835<=a&&a<=70840||70842==a||70845==a||70847<=a&&a<=70848||70850<=a&&a<=70851||71087==a||71090<=a&&a<=71093||71100<=a&&a<=71101||71103<=a&&a<=71104||71132<=a&&a<=71133||71219<=a&&a<=71226||71229==a||71231<=a&&a<=71232||71339==a||71341==a||71344<=a&&a<=71349||71351==a||71453<=a&&a<=71455||71458<=a&&a<=71461||71463<=a&&a<=71467||72193<=a&&a<=72198||72201<=a&&a<=72202||72243<=a&&a<=72248||72251<=a&&a<=72254||72263==a||72273<=a&&a<=72278||72281<=a&&a<=72283||72330<=a&&a<=72342||72344<=a&&a<=72345||72752<=a&&a<=72758||72760<=a&&a<=72765||72767==a||72850<=a&&a<=72871||72874<=a&&a<=72880||72882<=a&&a<=72883||72885<=a&&a<=72886||73009<=a&&a<=73014||73018==a||73020<=a&&a<=73021||73023<=a&&a<=73029||73031==a||92912<=a&&a<=92916||92976<=a&&a<=92982||94095<=a&&a<=94098||113821<=a&&a<=113822||119141==a||119143<=a&&a<=119145||119150<=a&&a<=119154||119163<=a&&a<=119170||119173<=a&&a<=119179||119210<=a&&a<=119213||119362<=a&&a<=119364||121344<=a&&a<=121398||121403<=a&&a<=121452||121461==a||121476==a||121499<=a&&a<=121503||121505<=a&&a<=121519||122880<=a&&a<=122886||122888<=a&&a<=122904||122907<=a&&a<=122913||122915<=a&&a<=122916||122918<=a&&a<=122922||125136<=a&&a<=125142||125252<=a&&a<=125258||917536<=a&&a<=917631||917760<=a&&a<=917999?e:127462<=a&&a<=127487?t:2307==a||2363==a||2366<=a&&a<=2368||2377<=a&&a<=2380||2382<=a&&a<=2383||2434<=a&&a<=2435||2495<=a&&a<=2496||2503<=a&&a<=2504||2507<=a&&a<=2508||2563==a||2622<=a&&a<=2624||2691==a||2750<=a&&a<=2752||2761==a||2763<=a&&a<=2764||2818<=a&&a<=2819||2880==a||2887<=a&&a<=2888||2891<=a&&a<=2892||3007==a||3009<=a&&a<=3010||3014<=a&&a<=3016||3018<=a&&a<=3020||3073<=a&&a<=3075||3137<=a&&a<=3140||3202<=a&&a<=3203||3262==a||3264<=a&&a<=3265||3267<=a&&a<=3268||3271<=a&&a<=3272||3274<=a&&a<=3275||3330<=a&&a<=3331||3391<=a&&a<=3392||3398<=a&&a<=3400||3402<=a&&a<=3404||3458<=a&&a<=3459||3536<=a&&a<=3537||3544<=a&&a<=3550||3570<=a&&a<=3571||3635==a||3763==a||3902<=a&&a<=3903||3967==a||4145==a||4155<=a&&a<=4156||4182<=a&&a<=4183||4228==a||6070==a||6078<=a&&a<=6085||6087<=a&&a<=6088||6435<=a&&a<=6438||6441<=a&&a<=6443||6448<=a&&a<=6449||6451<=a&&a<=6456||6681<=a&&a<=6682||6741==a||6743==a||6765<=a&&a<=6770||6916==a||6965==a||6971==a||6973<=a&&a<=6977||6979<=a&&a<=6980||7042==a||7073==a||7078<=a&&a<=7079||7082==a||7143==a||7146<=a&&a<=7148||7150==a||7154<=a&&a<=7155||7204<=a&&a<=7211||7220<=a&&a<=7221||7393==a||7410<=a&&a<=7411||7415==a||43043<=a&&a<=43044||43047==a||43136<=a&&a<=43137||43188<=a&&a<=43203||43346<=a&&a<=43347||43395==a||43444<=a&&a<=43445||43450<=a&&a<=43451||43453<=a&&a<=43456||43567<=a&&a<=43568||43571<=a&&a<=43572||43597==a||43755==a||43758<=a&&a<=43759||43765==a||44003<=a&&a<=44004||44006<=a&&a<=44007||44009<=a&&a<=44010||44012==a||69632==a||69634==a||69762==a||69808<=a&&a<=69810||69815<=a&&a<=69816||69932==a||70018==a||70067<=a&&a<=70069||70079<=a&&a<=70080||70188<=a&&a<=70190||70194<=a&&a<=70195||70197==a||70368<=a&&a<=70370||70402<=a&&a<=70403||70463==a||70465<=a&&a<=70468||70471<=a&&a<=70472||70475<=a&&a<=70477||70498<=a&&a<=70499||70709<=a&&a<=70711||70720<=a&&a<=70721||70725==a||70833<=a&&a<=70834||70841==a||70843<=a&&a<=70844||70846==a||70849==a||71088<=a&&a<=71089||71096<=a&&a<=71099||71102==a||71216<=a&&a<=71218||71227<=a&&a<=71228||71230==a||71340==a||71342<=a&&a<=71343||71350==a||71456<=a&&a<=71457||71462==a||72199<=a&&a<=72200||72249==a||72279<=a&&a<=72280||72343==a||72751==a||72766==a||72873==a||72881==a||72884==a||94033<=a&&a<=94078||119142==a||119149==a?5:4352<=a&&a<=4447||43360<=a&&a<=43388?6:4448<=a&&a<=4519||55216<=a&&a<=55238?7:4520<=a&&a<=4607||55243<=a&&a<=55291?8:44032==a||44060==a||44088==a||44116==a||44144==a||44172==a||44200==a||44228==a||44256==a||44284==a||44312==a||44340==a||44368==a||44396==a||44424==a||44452==a||44480==a||44508==a||44536==a||44564==a||44592==a||44620==a||44648==a||44676==a||44704==a||44732==a||44760==a||44788==a||44816==a||44844==a||44872==a||44900==a||44928==a||44956==a||44984==a||45012==a||45040==a||45068==a||45096==a||45124==a||45152==a||45180==a||45208==a||45236==a||45264==a||45292==a||45320==a||45348==a||45376==a||45404==a||45432==a||45460==a||45488==a||45516==a||45544==a||45572==a||45600==a||45628==a||45656==a||45684==a||45712==a||45740==a||45768==a||45796==a||45824==a||45852==a||45880==a||45908==a||45936==a||45964==a||45992==a||46020==a||46048==a||46076==a||46104==a||46132==a||46160==a||46188==a||46216==a||46244==a||46272==a||46300==a||46328==a||46356==a||46384==a||46412==a||46440==a||46468==a||46496==a||46524==a||46552==a||46580==a||46608==a||46636==a||46664==a||46692==a||46720==a||46748==a||46776==a||46804==a||46832==a||46860==a||46888==a||46916==a||46944==a||46972==a||47e3==a||47028==a||47056==a||47084==a||47112==a||47140==a||47168==a||47196==a||47224==a||47252==a||47280==a||47308==a||47336==a||47364==a||47392==a||47420==a||47448==a||47476==a||47504==a||47532==a||47560==a||47588==a||47616==a||47644==a||47672==a||47700==a||47728==a||47756==a||47784==a||47812==a||47840==a||47868==a||47896==a||47924==a||47952==a||47980==a||48008==a||48036==a||48064==a||48092==a||48120==a||48148==a||48176==a||48204==a||48232==a||48260==a||48288==a||48316==a||48344==a||48372==a||48400==a||48428==a||48456==a||48484==a||48512==a||48540==a||48568==a||48596==a||48624==a||48652==a||48680==a||48708==a||48736==a||48764==a||48792==a||48820==a||48848==a||48876==a||48904==a||48932==a||48960==a||48988==a||49016==a||49044==a||49072==a||49100==a||49128==a||49156==a||49184==a||49212==a||49240==a||49268==a||49296==a||49324==a||49352==a||49380==a||49408==a||49436==a||49464==a||49492==a||49520==a||49548==a||49576==a||49604==a||49632==a||49660==a||49688==a||49716==a||49744==a||49772==a||49800==a||49828==a||49856==a||49884==a||49912==a||49940==a||49968==a||49996==a||50024==a||50052==a||50080==a||50108==a||50136==a||50164==a||50192==a||50220==a||50248==a||50276==a||50304==a||50332==a||50360==a||50388==a||50416==a||50444==a||50472==a||50500==a||50528==a||50556==a||50584==a||50612==a||50640==a||50668==a||50696==a||50724==a||50752==a||50780==a||50808==a||50836==a||50864==a||50892==a||50920==a||50948==a||50976==a||51004==a||51032==a||51060==a||51088==a||51116==a||51144==a||51172==a||51200==a||51228==a||51256==a||51284==a||51312==a||51340==a||51368==a||51396==a||51424==a||51452==a||51480==a||51508==a||51536==a||51564==a||51592==a||51620==a||51648==a||51676==a||51704==a||51732==a||51760==a||51788==a||51816==a||51844==a||51872==a||51900==a||51928==a||51956==a||51984==a||52012==a||52040==a||52068==a||52096==a||52124==a||52152==a||52180==a||52208==a||52236==a||52264==a||52292==a||52320==a||52348==a||52376==a||52404==a||52432==a||52460==a||52488==a||52516==a||52544==a||52572==a||52600==a||52628==a||52656==a||52684==a||52712==a||52740==a||52768==a||52796==a||52824==a||52852==a||52880==a||52908==a||52936==a||52964==a||52992==a||53020==a||53048==a||53076==a||53104==a||53132==a||53160==a||53188==a||53216==a||53244==a||53272==a||53300==a||53328==a||53356==a||53384==a||53412==a||53440==a||53468==a||53496==a||53524==a||53552==a||53580==a||53608==a||53636==a||53664==a||53692==a||53720==a||53748==a||53776==a||53804==a||53832==a||53860==a||53888==a||53916==a||53944==a||53972==a||54e3==a||54028==a||54056==a||54084==a||54112==a||54140==a||54168==a||54196==a||54224==a||54252==a||54280==a||54308==a||54336==a||54364==a||54392==a||54420==a||54448==a||54476==a||54504==a||54532==a||54560==a||54588==a||54616==a||54644==a||54672==a||54700==a||54728==a||54756==a||54784==a||54812==a||54840==a||54868==a||54896==a||54924==a||54952==a||54980==a||55008==a||55036==a||55064==a||55092==a||55120==a||55148==a||55176==a?9:44033<=a&&a<=44059||44061<=a&&a<=44087||44089<=a&&a<=44115||44117<=a&&a<=44143||44145<=a&&a<=44171||44173<=a&&a<=44199||44201<=a&&a<=44227||44229<=a&&a<=44255||44257<=a&&a<=44283||44285<=a&&a<=44311||44313<=a&&a<=44339||44341<=a&&a<=44367||44369<=a&&a<=44395||44397<=a&&a<=44423||44425<=a&&a<=44451||44453<=a&&a<=44479||44481<=a&&a<=44507||44509<=a&&a<=44535||44537<=a&&a<=44563||44565<=a&&a<=44591||44593<=a&&a<=44619||44621<=a&&a<=44647||44649<=a&&a<=44675||44677<=a&&a<=44703||44705<=a&&a<=44731||44733<=a&&a<=44759||44761<=a&&a<=44787||44789<=a&&a<=44815||44817<=a&&a<=44843||44845<=a&&a<=44871||44873<=a&&a<=44899||44901<=a&&a<=44927||44929<=a&&a<=44955||44957<=a&&a<=44983||44985<=a&&a<=45011||45013<=a&&a<=45039||45041<=a&&a<=45067||45069<=a&&a<=45095||45097<=a&&a<=45123||45125<=a&&a<=45151||45153<=a&&a<=45179||45181<=a&&a<=45207||45209<=a&&a<=45235||45237<=a&&a<=45263||45265<=a&&a<=45291||45293<=a&&a<=45319||45321<=a&&a<=45347||45349<=a&&a<=45375||45377<=a&&a<=45403||45405<=a&&a<=45431||45433<=a&&a<=45459||45461<=a&&a<=45487||45489<=a&&a<=45515||45517<=a&&a<=45543||45545<=a&&a<=45571||45573<=a&&a<=45599||45601<=a&&a<=45627||45629<=a&&a<=45655||45657<=a&&a<=45683||45685<=a&&a<=45711||45713<=a&&a<=45739||45741<=a&&a<=45767||45769<=a&&a<=45795||45797<=a&&a<=45823||45825<=a&&a<=45851||45853<=a&&a<=45879||45881<=a&&a<=45907||45909<=a&&a<=45935||45937<=a&&a<=45963||45965<=a&&a<=45991||45993<=a&&a<=46019||46021<=a&&a<=46047||46049<=a&&a<=46075||46077<=a&&a<=46103||46105<=a&&a<=46131||46133<=a&&a<=46159||46161<=a&&a<=46187||46189<=a&&a<=46215||46217<=a&&a<=46243||46245<=a&&a<=46271||46273<=a&&a<=46299||46301<=a&&a<=46327||46329<=a&&a<=46355||46357<=a&&a<=46383||46385<=a&&a<=46411||46413<=a&&a<=46439||46441<=a&&a<=46467||46469<=a&&a<=46495||46497<=a&&a<=46523||46525<=a&&a<=46551||46553<=a&&a<=46579||46581<=a&&a<=46607||46609<=a&&a<=46635||46637<=a&&a<=46663||46665<=a&&a<=46691||46693<=a&&a<=46719||46721<=a&&a<=46747||46749<=a&&a<=46775||46777<=a&&a<=46803||46805<=a&&a<=46831||46833<=a&&a<=46859||46861<=a&&a<=46887||46889<=a&&a<=46915||46917<=a&&a<=46943||46945<=a&&a<=46971||46973<=a&&a<=46999||47001<=a&&a<=47027||47029<=a&&a<=47055||47057<=a&&a<=47083||47085<=a&&a<=47111||47113<=a&&a<=47139||47141<=a&&a<=47167||47169<=a&&a<=47195||47197<=a&&a<=47223||47225<=a&&a<=47251||47253<=a&&a<=47279||47281<=a&&a<=47307||47309<=a&&a<=47335||47337<=a&&a<=47363||47365<=a&&a<=47391||47393<=a&&a<=47419||47421<=a&&a<=47447||47449<=a&&a<=47475||47477<=a&&a<=47503||47505<=a&&a<=47531||47533<=a&&a<=47559||47561<=a&&a<=47587||47589<=a&&a<=47615||47617<=a&&a<=47643||47645<=a&&a<=47671||47673<=a&&a<=47699||47701<=a&&a<=47727||47729<=a&&a<=47755||47757<=a&&a<=47783||47785<=a&&a<=47811||47813<=a&&a<=47839||47841<=a&&a<=47867||47869<=a&&a<=47895||47897<=a&&a<=47923||47925<=a&&a<=47951||47953<=a&&a<=47979||47981<=a&&a<=48007||48009<=a&&a<=48035||48037<=a&&a<=48063||48065<=a&&a<=48091||48093<=a&&a<=48119||48121<=a&&a<=48147||48149<=a&&a<=48175||48177<=a&&a<=48203||48205<=a&&a<=48231||48233<=a&&a<=48259||48261<=a&&a<=48287||48289<=a&&a<=48315||48317<=a&&a<=48343||48345<=a&&a<=48371||48373<=a&&a<=48399||48401<=a&&a<=48427||48429<=a&&a<=48455||48457<=a&&a<=48483||48485<=a&&a<=48511||48513<=a&&a<=48539||48541<=a&&a<=48567||48569<=a&&a<=48595||48597<=a&&a<=48623||48625<=a&&a<=48651||48653<=a&&a<=48679||48681<=a&&a<=48707||48709<=a&&a<=48735||48737<=a&&a<=48763||48765<=a&&a<=48791||48793<=a&&a<=48819||48821<=a&&a<=48847||48849<=a&&a<=48875||48877<=a&&a<=48903||48905<=a&&a<=48931||48933<=a&&a<=48959||48961<=a&&a<=48987||48989<=a&&a<=49015||49017<=a&&a<=49043||49045<=a&&a<=49071||49073<=a&&a<=49099||49101<=a&&a<=49127||49129<=a&&a<=49155||49157<=a&&a<=49183||49185<=a&&a<=49211||49213<=a&&a<=49239||49241<=a&&a<=49267||49269<=a&&a<=49295||49297<=a&&a<=49323||49325<=a&&a<=49351||49353<=a&&a<=49379||49381<=a&&a<=49407||49409<=a&&a<=49435||49437<=a&&a<=49463||49465<=a&&a<=49491||49493<=a&&a<=49519||49521<=a&&a<=49547||49549<=a&&a<=49575||49577<=a&&a<=49603||49605<=a&&a<=49631||49633<=a&&a<=49659||49661<=a&&a<=49687||49689<=a&&a<=49715||49717<=a&&a<=49743||49745<=a&&a<=49771||49773<=a&&a<=49799||49801<=a&&a<=49827||49829<=a&&a<=49855||49857<=a&&a<=49883||49885<=a&&a<=49911||49913<=a&&a<=49939||49941<=a&&a<=49967||49969<=a&&a<=49995||49997<=a&&a<=50023||50025<=a&&a<=50051||50053<=a&&a<=50079||50081<=a&&a<=50107||50109<=a&&a<=50135||50137<=a&&a<=50163||50165<=a&&a<=50191||50193<=a&&a<=50219||50221<=a&&a<=50247||50249<=a&&a<=50275||50277<=a&&a<=50303||50305<=a&&a<=50331||50333<=a&&a<=50359||50361<=a&&a<=50387||50389<=a&&a<=50415||50417<=a&&a<=50443||50445<=a&&a<=50471||50473<=a&&a<=50499||50501<=a&&a<=50527||50529<=a&&a<=50555||50557<=a&&a<=50583||50585<=a&&a<=50611||50613<=a&&a<=50639||50641<=a&&a<=50667||50669<=a&&a<=50695||50697<=a&&a<=50723||50725<=a&&a<=50751||50753<=a&&a<=50779||50781<=a&&a<=50807||50809<=a&&a<=50835||50837<=a&&a<=50863||50865<=a&&a<=50891||50893<=a&&a<=50919||50921<=a&&a<=50947||50949<=a&&a<=50975||50977<=a&&a<=51003||51005<=a&&a<=51031||51033<=a&&a<=51059||51061<=a&&a<=51087||51089<=a&&a<=51115||51117<=a&&a<=51143||51145<=a&&a<=51171||51173<=a&&a<=51199||51201<=a&&a<=51227||51229<=a&&a<=51255||51257<=a&&a<=51283||51285<=a&&a<=51311||51313<=a&&a<=51339||51341<=a&&a<=51367||51369<=a&&a<=51395||51397<=a&&a<=51423||51425<=a&&a<=51451||51453<=a&&a<=51479||51481<=a&&a<=51507||51509<=a&&a<=51535||51537<=a&&a<=51563||51565<=a&&a<=51591||51593<=a&&a<=51619||51621<=a&&a<=51647||51649<=a&&a<=51675||51677<=a&&a<=51703||51705<=a&&a<=51731||51733<=a&&a<=51759||51761<=a&&a<=51787||51789<=a&&a<=51815||51817<=a&&a<=51843||51845<=a&&a<=51871||51873<=a&&a<=51899||51901<=a&&a<=51927||51929<=a&&a<=51955||51957<=a&&a<=51983||51985<=a&&a<=52011||52013<=a&&a<=52039||52041<=a&&a<=52067||52069<=a&&a<=52095||52097<=a&&a<=52123||52125<=a&&a<=52151||52153<=a&&a<=52179||52181<=a&&a<=52207||52209<=a&&a<=52235||52237<=a&&a<=52263||52265<=a&&a<=52291||52293<=a&&a<=52319||52321<=a&&a<=52347||52349<=a&&a<=52375||52377<=a&&a<=52403||52405<=a&&a<=52431||52433<=a&&a<=52459||52461<=a&&a<=52487||52489<=a&&a<=52515||52517<=a&&a<=52543||52545<=a&&a<=52571||52573<=a&&a<=52599||52601<=a&&a<=52627||52629<=a&&a<=52655||52657<=a&&a<=52683||52685<=a&&a<=52711||52713<=a&&a<=52739||52741<=a&&a<=52767||52769<=a&&a<=52795||52797<=a&&a<=52823||52825<=a&&a<=52851||52853<=a&&a<=52879||52881<=a&&a<=52907||52909<=a&&a<=52935||52937<=a&&a<=52963||52965<=a&&a<=52991||52993<=a&&a<=53019||53021<=a&&a<=53047||53049<=a&&a<=53075||53077<=a&&a<=53103||53105<=a&&a<=53131||53133<=a&&a<=53159||53161<=a&&a<=53187||53189<=a&&a<=53215||53217<=a&&a<=53243||53245<=a&&a<=53271||53273<=a&&a<=53299||53301<=a&&a<=53327||53329<=a&&a<=53355||53357<=a&&a<=53383||53385<=a&&a<=53411||53413<=a&&a<=53439||53441<=a&&a<=53467||53469<=a&&a<=53495||53497<=a&&a<=53523||53525<=a&&a<=53551||53553<=a&&a<=53579||53581<=a&&a<=53607||53609<=a&&a<=53635||53637<=a&&a<=53663||53665<=a&&a<=53691||53693<=a&&a<=53719||53721<=a&&a<=53747||53749<=a&&a<=53775||53777<=a&&a<=53803||53805<=a&&a<=53831||53833<=a&&a<=53859||53861<=a&&a<=53887||53889<=a&&a<=53915||53917<=a&&a<=53943||53945<=a&&a<=53971||53973<=a&&a<=53999||54001<=a&&a<=54027||54029<=a&&a<=54055||54057<=a&&a<=54083||54085<=a&&a<=54111||54113<=a&&a<=54139||54141<=a&&a<=54167||54169<=a&&a<=54195||54197<=a&&a<=54223||54225<=a&&a<=54251||54253<=a&&a<=54279||54281<=a&&a<=54307||54309<=a&&a<=54335||54337<=a&&a<=54363||54365<=a&&a<=54391||54393<=a&&a<=54419||54421<=a&&a<=54447||54449<=a&&a<=54475||54477<=a&&a<=54503||54505<=a&&a<=54531||54533<=a&&a<=54559||54561<=a&&a<=54587||54589<=a&&a<=54615||54617<=a&&a<=54643||54645<=a&&a<=54671||54673<=a&&a<=54699||54701<=a&&a<=54727||54729<=a&&a<=54755||54757<=a&&a<=54783||54785<=a&&a<=54811||54813<=a&&a<=54839||54841<=a&&a<=54867||54869<=a&&a<=54895||54897<=a&&a<=54923||54925<=a&&a<=54951||54953<=a&&a<=54979||54981<=a&&a<=55007||55009<=a&&a<=55035||55037<=a&&a<=55063||55065<=a&&a<=55091||55093<=a&&a<=55119||55121<=a&&a<=55147||55149<=a&&a<=55175||55177<=a&&a<=55203?10:9757==a||9977==a||9994<=a&&a<=9997||127877==a||127938<=a&&a<=127940||127943==a||127946<=a&&a<=127948||128066<=a&&a<=128067||128070<=a&&a<=128080||128110==a||128112<=a&&a<=128120||128124==a||128129<=a&&a<=128131||128133<=a&&a<=128135||128170==a||128372<=a&&a<=128373||128378==a||128400==a||128405<=a&&a<=128406||128581<=a&&a<=128583||128587<=a&&a<=128591||128675==a||128692<=a&&a<=128694||128704==a||128716==a||129304<=a&&a<=129308||129310<=a&&a<=129311||129318==a||129328<=a&&a<=129337||129341<=a&&a<=129342||129489<=a&&a<=129501?n:127995<=a&&a<=127999?14:8205==a?15:9792==a||9794==a||9877<=a&&a<=9878||9992==a||10084==a||127752==a||127806==a||127859==a||127891==a||127908==a||127912==a||127979==a||127981==a||128139==a||128187<=a&&a<=128188||128295==a||128300==a||128488==a||128640==a||128658==a?r:128102<=a&&a<=128105?o:11}return this.nextBreak=function(e,t){if(void 0===t&&(t=0),t<0)return 0;if(t>=e.length-1)return e.length;for(var i=u(s(e,t)),n=[],r=t+1;r<e.length;r++)if(!a(e,r-1)){var o=u(s(e,r));if(l(i,n,o))return r;n.push(o)}return e.length},this.splitGraphemes=function(e){for(var t,i=[],n=0;(t=this.nextBreak(e,n))<e.length;)i.push(e.slice(n,t)),n=t;return n<e.length&&i.push(e.slice(n)),i},this.iterateGraphemes=function(e){var t=0,i={next:function(){var i,n;return(n=this.nextBreak(e,t))<e.length?(i=e.slice(t,n),t=n,{value:i,done:!1}):t<e.length?(i=e.slice(t),t=e.length,{value:i,done:!1}):{value:void 0,done:!0}}.bind(this)};return typeof Symbol<"u"&&Symbol.iterator&&(i[Symbol.iterator]=function(){return i}),i},this.countGraphemes=function(e){for(var t,i=0,n=0;(t=this.nextBreak(e,n))<e.length;)n=t,i++;return n<e.length&&i++,i},this})})),_de=Vc(((e,t)=>{/* Copyright 2015-2018 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */!function(){var e,i,n,r,o,a,s=(e={defaultNoDataValue:-34027999387901484e22,decode:function(t,a){var s=(a=a||{}).encodedMaskData||null===a.encodedMaskData,l=o(t,a.inputOffset||0,s),u=null!==a.noDataValue?a.noDataValue:e.defaultNoDataValue,c=i(l,a.pixelType||Float32Array,a.encodedMaskData,u,a.returnMask),h={width:l.width,height:l.height,pixelData:c.resultPixels,minValue:c.minValue,maxValue:l.pixels.maxValue,noDataValue:u};return c.resultMask&&(h.maskData=c.resultMask),a.returnEncodedMask&&l.mask&&(h.encodedMaskData=l.mask.bitset?l.mask.bitset:null),a.returnFileInfo&&(h.fileInfo=n(l),a.computeUsedBitDepths&&(h.fileInfo.bitDepths=r(l))),h}},i=function(e,t,i,n,r){var o,s,l,u=0,c=e.pixels.numBlocksX,h=e.pixels.numBlocksY,d=Math.floor(e.width/c),p=Math.floor(e.height/h),f=2*e.maxZError,m=Number.MAX_VALUE;i=i||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),r&&i&&(l=new Uint8Array(e.width*e.height));for(var _,g,y=new Float32Array(d*p),v=0;v<=h;v++){var b=v!==h?p:e.height%h;if(0!==b)for(var A=0;A<=c;A++){var T=A!==c?d:e.width%c;if(0!==T){var E,C,x,S,w=v*e.width*p+A*d,I=e.width-T,P=e.pixels.blocks[u];if(P.encoding<2?(0===P.encoding?E=P.rawData:(a(P.stuffedData,P.bitsPerPixel,P.numValidPixels,P.offset,f,y,e.pixels.maxValue),E=y),C=0):x=2===P.encoding?0:P.offset,i)for(g=0;g<b;g++){for(7&w&&(S=i[w>>3],S<<=7&w),_=0;_<T;_++)7&w||(S=i[w>>3]),128&S?(l&&(l[w]=1),m=m>(o=P.encoding<2?E[C++]:x)?o:m,s[w++]=o):(l&&(l[w]=0),s[w++]=n),S<<=1;w+=I}else if(P.encoding<2)for(g=0;g<b;g++){for(_=0;_<T;_++)m=m>(o=E[C++])?o:m,s[w++]=o;w+=I}else for(m=m>x?x:m,g=0;g<b;g++){for(_=0;_<T;_++)s[w++]=x;w+=I}if(1===P.encoding&&C!==P.numValidPixels)throw"Block and Mask do not match";u++}}}return{resultPixels:s,resultMask:l,minValue:m}},n=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},r=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,i={},n=0;n<t;n++){var r=e.pixels.blocks[n];0===r.encoding?i.float32=!0:1===r.encoding?i[r.bitsPerPixel]=!0:i[0]=!0}return Object.keys(i)},o=function(e,t,i){var n={},r=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,r),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var o=new DataView(e,t,24);if(n.fileVersion=o.getInt32(0,!0),n.imageType=o.getInt32(4,!0),n.height=o.getUint32(8,!0),n.width=o.getUint32(12,!0),n.maxZError=o.getFloat64(16,!0),t+=24,!i)if(o=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=o.getUint32(0,!0),n.mask.numBlocksX=o.getUint32(4,!0),n.mask.numBytes=o.getUint32(8,!0),n.mask.maxValue=o.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var a=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(o=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),l=2,u=0;do{if(s>0)for(;s--;)a[u++]=o.getUint8(l++);else{var c=o.getUint8(l++);for(s=-s;s--;)a[u++]=c}s=o.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==s||u<a.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=a,t+=n.mask.numBytes}else n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue||(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));o=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=o.getUint32(0,!0),n.pixels.numBlocksX=o.getUint32(4,!0),n.pixels.numBytes=o.getUint32(8,!0),n.pixels.maxValue=o.getFloat32(12,!0),t+=16;var h=n.pixels.numBlocksX,d=n.pixels.numBlocksY,p=h+(n.width%h>0?1:0),f=d+(n.height%d>0?1:0);n.pixels.blocks=new Array(p*f);for(var m=0,_=0;_<f;_++)for(var g=0;g<p;g++){var y=0,v=e.byteLength-t;o=new DataView(e,t,Math.min(10,v));var b={};n.pixels.blocks[m++]=b;var A=o.getUint8(0);if(y++,b.encoding=63&A,b.encoding>3)throw"Invalid block encoding ("+b.encoding+")";if(2!==b.encoding){if(0!==A&&2!==A){if(A>>=6,b.offsetType=A,2===A)b.offset=o.getInt8(1),y++;else if(1===A)b.offset=o.getInt16(1,!0),y+=2;else{if(0!==A)throw"Invalid block offset type";b.offset=o.getFloat32(1,!0),y+=4}if(1===b.encoding)if(A=o.getUint8(y),y++,b.bitsPerPixel=63&A,A>>=6,b.numValidPixelsType=A,2===A)b.numValidPixels=o.getUint8(y),y++;else if(1===A)b.numValidPixels=o.getUint16(y,!0),y+=2;else{if(0!==A)throw"Invalid valid pixel count type";b.numValidPixels=o.getUint32(y,!0),y+=4}}var T;if(t+=y,3!==b.encoding)if(0===b.encoding){var E=(n.pixels.numBytes-1)/4;if(E!==Math.floor(E))throw"uncompressed block has invalid length";T=new ArrayBuffer(4*E),new Uint8Array(T).set(new Uint8Array(e,t,4*E));var C=new Float32Array(T);b.rawData=C,t+=4*E}else if(1===b.encoding){var x=Math.ceil(b.numValidPixels*b.bitsPerPixel/8),S=Math.ceil(x/4);T=new ArrayBuffer(4*S),new Uint8Array(T).set(new Uint8Array(e,t,x)),b.stuffedData=new Uint32Array(T),t+=x}}else t++}return n.eofOffset=t,n},a=function(e,t,i,n,r,o,a){var s,l,u,c=(1<<t)-1,h=0,d=0,p=Math.ceil((a-n)/r),f=4*e.length-Math.ceil(t*i/8);for(e[e.length-1]<<=8*f,s=0;s<i;s++){if(0===d&&(u=e[h++],d=32),d>=t)l=u>>>d-t&c,d-=t;else{var m=t-d;l=(u&c)<<m&c,l+=(u=e[h++])>>>(d=32-m)}o[s]=l<p?n+l*r:a}return o},e),l=function(){var e=function(e,t,i,n,r,o,a,s){var l,u,c,h,d,p=(1<<i)-1,f=0,m=0,_=4*e.length-Math.ceil(i*n/8);if(e[e.length-1]<<=8*_,r)for(l=0;l<n;l++)0===m&&(c=e[f++],m=32),m>=i?(u=c>>>m-i&p,m-=i):(u=(c&p)<<(h=i-m)&p,u+=(c=e[f++])>>>(m=32-h)),t[l]=r[u];else for(d=Math.ceil((s-o)/a),l=0;l<n;l++)0===m&&(c=e[f++],m=32),m>=i?(u=c>>>m-i&p,m-=i):(u=(c&p)<<(h=i-m)&p,u+=(c=e[f++])>>>(m=32-h)),t[l]=u<d?o+u*a:s},t=function(e,t,i,n,r,o){var a,s=(1<<t)-1,l=0,u=0,c=0,h=0,d=0,p=[],f=4*e.length-Math.ceil(t*i/8);e[e.length-1]<<=8*f;var m=Math.ceil((o-n)/r);for(u=0;u<i;u++)0===h&&(a=e[l++],h=32),h>=t?(d=a>>>h-t&s,h-=t):(d=(a&s)<<(c=t-h)&s,d+=(a=e[l++])>>>(h=32-c)),p[u]=d<m?n+d*r:o;return p.unshift(n),p},i=function(e,t,i,n,r,o,a,s){var l,u,c,h,d=(1<<i)-1,p=0,f=0,m=0;if(r)for(l=0;l<n;l++)0===f&&(c=e[p++],f=32,m=0),f>=i?(u=c>>>m&d,f-=i,m+=i):(u=c>>>m&d,f=32-(h=i-f),u|=((c=e[p++])&(1<<h)-1)<<i-h,m=h),t[l]=r[u];else{var _=Math.ceil((s-o)/a);for(l=0;l<n;l++)0===f&&(c=e[p++],f=32,m=0),f>=i?(u=c>>>m&d,f-=i,m+=i):(u=c>>>m&d,f=32-(h=i-f),u|=((c=e[p++])&(1<<h)-1)<<i-h,m=h),t[l]=u<_?o+u*a:s}return t},n=function(e,t,i,n,r,o){var a,s=(1<<t)-1,l=0,u=0,c=0,h=0,d=0,p=0,f=[],m=Math.ceil((o-n)/r);for(u=0;u<i;u++)0===h&&(a=e[l++],h=32,p=0),h>=t?(d=a>>>p&s,h-=t,p+=t):(d=a>>>p&s,h=32-(c=t-h),d|=((a=e[l++])&(1<<c)-1)<<t-c,p=c),f[u]=d<m?n+d*r:o;return f.unshift(n),f},r=function(e,t,i,n){var r,o,a,s,l=(1<<i)-1,u=0,c=0,h=4*e.length-Math.ceil(i*n/8);for(e[e.length-1]<<=8*h,r=0;r<n;r++)0===c&&(a=e[u++],c=32),c>=i?(o=a>>>c-i&l,c-=i):(o=(a&l)<<(s=i-c)&l,o+=(a=e[u++])>>>(c=32-s)),t[r]=o;return t},o=function(e,t,i,n){var r,o,a,s,l=(1<<i)-1,u=0,c=0,h=0;for(r=0;r<n;r++)0===c&&(a=e[u++],c=32,h=0),c>=i?(o=a>>>h&l,c-=i,h+=i):(o=a>>>h&l,c=32-(s=i-c),o|=((a=e[u++])&(1<<s)-1)<<i-s,h=s),t[r]=o;return t},a={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,i=65535,n=e.length,r=Math.floor(n/2),o=0;r;){var a=r>=359?359:r;r-=a;do{t+=e[o++]<<8,i+=t+=e[o++]}while(--a);t=(65535&t)+(t>>>16),i=(65535&i)+(i>>>16)}return 1&n&&(i+=t+=e[o]<<8),((i=(65535&i)+(i>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var i=t.ptr,n=new Uint8Array(e,i,6),r={};if(r.fileIdentifierString=String.fromCharCode.apply(null,n),0!==r.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+r.fileIdentifierString;i+=6;var o,a=new DataView(e,i,8),s=a.getInt32(0,!0);if(r.fileVersion=s,i+=4,s>=3&&(r.checksum=a.getUint32(4,!0),i+=4),a=new DataView(e,i,12),r.height=a.getUint32(0,!0),r.width=a.getUint32(4,!0),i+=8,s>=4?(r.numDims=a.getUint32(8,!0),i+=4):r.numDims=1,a=new DataView(e,i,40),r.numValidPixel=a.getUint32(0,!0),r.microBlockSize=a.getInt32(4,!0),r.blobSize=a.getInt32(8,!0),r.imageType=a.getInt32(12,!0),r.maxZError=a.getFloat64(16,!0),r.zMin=a.getFloat64(24,!0),r.zMax=a.getFloat64(32,!0),i+=40,t.headerInfo=r,t.ptr=i,s>=3&&(o=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,i-o,r.blobSize-14))!==r.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var i=t.headerInfo,n=this.getDataTypeArray(i.imageType),r=i.numDims*this.getDataTypeSize(i.imageType),o=this.readSubArray(e,t.ptr,n,r),a=this.readSubArray(e,t.ptr+r,n,r);t.ptr+=2*r;var s,l=!0;for(s=0;s<i.numDims;s++)if(o[s]!==a[s]){l=!1;break}return i.minValues=o,i.maxValues=a,l},readSubArray:function(e,t,i,n){var r;if(i===Uint8Array)r=new Uint8Array(e,t,n);else{var o=new ArrayBuffer(n);new Uint8Array(o).set(new Uint8Array(e,t,n)),r=new i(o)}return r},readMask:function(e,t){var i,n,r=t.ptr,o=t.headerInfo,a=o.width*o.height,s=o.numValidPixel,l=new DataView(e,r,4),u={};if(u.numBytes=l.getUint32(0,!0),r+=4,(0===s||a===s)&&0!==u.numBytes)throw"invalid mask";if(0===s)i=new Uint8Array(Math.ceil(a/8)),u.bitset=i,n=new Uint8Array(a),t.pixels.resultMask=n,r+=u.numBytes;else if(u.numBytes>0){i=new Uint8Array(Math.ceil(a/8));var c=(l=new DataView(e,r,u.numBytes)).getInt16(0,!0),h=2,d=0,p=0;do{if(c>0)for(;c--;)i[d++]=l.getUint8(h++);else for(p=l.getUint8(h++),c=-c;c--;)i[d++]=p;c=l.getInt16(h,!0),h+=2}while(h<u.numBytes);if(-32768!==c||d<i.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(a);var f=0,m=0;for(m=0;m<a;m++)7&m?(f=i[m>>3],f<<=7&m):f=i[m>>3],128&f&&(n[m]=1);t.pixels.resultMask=n,u.bitset=i,r+=u.numBytes}return t.ptr=r,t.mask=u,!0},readDataOneSweep:function(e,t,i){var n,r=t.ptr,o=t.headerInfo,s=o.numDims,l=o.width*o.height,u=o.imageType,c=o.numValidPixel*a.getDataTypeSize(u)*s,h=t.pixels.resultMask;if(i===Uint8Array)n=new Uint8Array(e,r,c);else{var d=new ArrayBuffer(c);new Uint8Array(d).set(new Uint8Array(e,r,c)),n=new i(d)}if(n.length===l*s)t.pixels.resultPixels=n;else{t.pixels.resultPixels=new i(l*s);var p=0,f=0,m=0,_=0;if(s>1)for(m=0;m<s;m++)for(_=m*l,f=0;f<l;f++)h[f]&&(t.pixels.resultPixels[_+f]=n[p++]);else for(f=0;f<l;f++)h[f]&&(t.pixels.resultPixels[f]=n[p++])}return r+=c,t.ptr=r,!0},readHuffmanTree:function(e,t){var i=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var r=n.getInt32(4,!0),o=n.getInt32(8,!0),l=n.getInt32(12,!0);if(o>=l)return!1;var u=new Uint32Array(l-o);a.decodeBits(e,t,u);var c,h,d,p,f=[];for(c=o;c<l;c++)f[h=c-(c<r?0:r)]={first:u[c-o],second:null};var m=e.byteLength-t.ptr,_=Math.ceil(m/4),g=new ArrayBuffer(4*_);new Uint8Array(g).set(new Uint8Array(e,t.ptr,m));var y,v=new Uint32Array(g),b=0,A=0;for(y=v[0],c=o;c<l;c++)(p=f[h=c-(c<r?0:r)].first)>0&&(f[h].second=y<<b>>>32-p,32-b>=p?32===(b+=p)&&(b=0,y=v[++A]):(b+=p-32,y=v[++A],f[h].second|=y>>>32-b));var T=0,E=0,C=new s;for(c=0;c<f.length;c++)void 0!==f[c]&&(T=Math.max(T,f[c].first));E=T>=i?i:T,T>=30&&console.log("WARning, large NUM LUT BITS IS "+T);var x,S,w,I,P,D=[];for(c=o;c<l;c++)if((p=f[h=c-(c<r?0:r)].first)>0)if(x=[p,h],p<=E)for(S=f[h].second<<E-p,w=1<<E-p,d=0;d<w;d++)D[S|d]=x;else for(S=f[h].second,P=C,I=p-1;I>=0;I--)S>>>I&1?(P.right||(P.right=new s),P=P.right):(P.left||(P.left=new s),P=P.left),0===I&&!P.val&&(P.val=x[1]);return{decodeLut:D,numBitsLUTQick:E,numBitsLUT:T,tree:C,stuffedData:v,srcPtr:A,bitPos:b}},readHuffman:function(e,t,i){var n,r,o,a,s,l,u,c,h,d=t.headerInfo,p=d.numDims,f=t.headerInfo.height,m=t.headerInfo.width,_=m*f,g=this.readHuffmanTree(e,t),y=g.decodeLut,v=g.tree,b=g.stuffedData,A=g.srcPtr,T=g.bitPos,E=g.numBitsLUTQick,C=g.numBitsLUT,x=0===t.headerInfo.imageType?128:0,S=t.pixels.resultMask,w=0;T>0&&(A++,T=0);var I,P=b[A],D=1===t.encodeMode,O=new i(_*p),L=O;for(I=0;I<d.numDims;I++){if(p>1&&(L=new i(O.buffer,_*I,_),w=0),t.headerInfo.numValidPixel===m*f)for(c=0,l=0;l<f;l++)for(u=0;u<m;u++,c++){if(r=0,s=a=P<<T>>>32-E,32-T<E&&(s=a|=b[A+1]>>>64-T-E),y[s])r=y[s][1],T+=y[s][0];else for(s=a=P<<T>>>32-C,32-T<C&&(s=a|=b[A+1]>>>64-T-C),n=v,h=0;h<C;h++)if(!(n=a>>>C-h-1&1?n.right:n.left).left&&!n.right){r=n.val,T=T+h+1;break}T>=32&&(T-=32,P=b[++A]),o=r-x,D?(o+=u>0?w:l>0?L[c-m]:w,o&=255,L[c]=o,w=o):L[c]=o}else for(c=0,l=0;l<f;l++)for(u=0;u<m;u++,c++)if(S[c]){if(r=0,s=a=P<<T>>>32-E,32-T<E&&(s=a|=b[A+1]>>>64-T-E),y[s])r=y[s][1],T+=y[s][0];else for(s=a=P<<T>>>32-C,32-T<C&&(s=a|=b[A+1]>>>64-T-C),n=v,h=0;h<C;h++)if(!(n=a>>>C-h-1&1?n.right:n.left).left&&!n.right){r=n.val,T=T+h+1;break}T>=32&&(T-=32,P=b[++A]),o=r-x,D?(u>0&&S[c-1]?o+=w:l>0&&S[c-m]?o+=L[c-m]:o+=w,o&=255,L[c]=o,w=o):L[c]=o}t.ptr=t.ptr+4*(A+1)+(T>0?4:0)}t.pixels.resultPixels=O},decodeBits:function(a,s,l,u,c){var h=s.headerInfo,d=h.fileVersion,p=0,f=new DataView(a,s.ptr,5),m=f.getUint8(0);p++;var _=m>>6,g=0===_?4:3-_,y=(32&m)>0,v=31&m,b=0;if(1===g)b=f.getUint8(p),p++;else if(2===g)b=f.getUint16(p,!0),p+=2;else{if(4!==g)throw"Invalid valid pixel count type";b=f.getUint32(p,!0),p+=4}var A,T,E,C,x,S,w,I,P,D=2*h.maxZError,O=h.numDims>1?h.maxValues[c]:h.zMax;if(y){for(s.counter.lut++,I=f.getUint8(p),v,p++,C=Math.ceil((I-1)*v/8),x=Math.ceil(C/4),T=new ArrayBuffer(4*x),E=new Uint8Array(T),s.ptr+=p,E.set(new Uint8Array(a,s.ptr,C)),w=new Uint32Array(T),s.ptr+=C,P=0;I-1>>>P;)P++;C=Math.ceil(b*P/8),x=Math.ceil(C/4),T=new ArrayBuffer(4*x),(E=new Uint8Array(T)).set(new Uint8Array(a,s.ptr,C)),A=new Uint32Array(T),s.ptr+=C,S=d>=3?n(w,v,I-1,u,D,O):t(w,v,I-1,u,D,O),d>=3?i(A,l,P,b,S):e(A,l,P,b,S)}else s.counter.bitstuffer++,P=v,s.ptr+=p,P>0&&(C=Math.ceil(b*P/8),x=Math.ceil(C/4),T=new ArrayBuffer(4*x),(E=new Uint8Array(T)).set(new Uint8Array(a,s.ptr,C)),A=new Uint32Array(T),s.ptr+=C,d>=3?null==u?o(A,l,P,b):i(A,l,P,b,!1,u,D,O):null==u?r(A,l,P,b):e(A,l,P,b,!1,u,D,O))},readTiles:function(e,t,i){var n=t.headerInfo,r=n.width,o=n.height,s=n.microBlockSize,l=n.imageType,u=a.getDataTypeSize(l),c=Math.ceil(r/s),h=Math.ceil(o/s);t.pixels.numBlocksY=h,t.pixels.numBlocksX=c,t.pixels.ptr=0;var d,p,f,m,_,g,y,v,b=0,A=0,T=0,E=0,C=0,x=0,S=0,w=0,I=0,P=0,D=0,O=0,L=0,R=0,N=0,M=new i(s*s),F=o%s||s,B=r%s||s,z=n.numDims,U=t.pixels.resultMask,k=t.pixels.resultPixels;for(T=0;T<h;T++)for(C=T!==h-1?s:F,E=0;E<c;E++)for(P=T*r*s+E*s,D=r-(x=E!==c-1?s:B),v=0;v<z;v++){if(z>1&&(k=new i(t.pixels.resultPixels.buffer,r*o*v*u,r*o)),S=e.byteLength-t.ptr,p={},N=0,N++,I=(w=(d=new DataView(e,t.ptr,Math.min(10,S))).getUint8(0))>>6&255,(w>>2&15)!==(E*s>>3&15))throw"integrity issue";if((_=3&w)>3)throw t.ptr+=N,"Invalid block encoding ("+_+")";if(2!==_)if(0===_){if(t.counter.uncompressed++,t.ptr+=N,O=(O=C*x*u)<(L=e.byteLength-t.ptr)?O:L,f=new ArrayBuffer(O%u==0?O:O+u-O%u),new Uint8Array(f).set(new Uint8Array(e,t.ptr,O)),m=new i(f),R=0,U)for(b=0;b<C;b++){for(A=0;A<x;A++)U[P]&&(k[P]=m[R++]),P++;P+=D}else for(b=0;b<C;b++){for(A=0;A<x;A++)k[P++]=m[R++];P+=D}t.ptr+=R*u}else if(g=a.getDataTypeUsed(l,I),y=a.getOnePixel(p,N,g,d),N+=a.getDataTypeSize(g),3===_)if(t.ptr+=N,t.counter.constantoffset++,U)for(b=0;b<C;b++){for(A=0;A<x;A++)U[P]&&(k[P]=y),P++;P+=D}else for(b=0;b<C;b++){for(A=0;A<x;A++)k[P++]=y;P+=D}else if(t.ptr+=N,a.decodeBits(e,t,M,y,v),N=0,U)for(b=0;b<C;b++){for(A=0;A<x;A++)U[P]&&(k[P]=M[N++]),P++;P+=D}else for(b=0;b<C;b++){for(A=0;A<x;A++)k[P++]=M[N++];P+=D}else t.counter.constant++,t.ptr+=N}},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:a.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e){var t=e.headerInfo.zMax,i=e.headerInfo.numDims,n=e.headerInfo.height*e.headerInfo.width,r=n*i,o=0,a=0,s=0,l=e.pixels.resultMask;if(l)if(i>1)for(o=0;o<i;o++)for(s=o*n,a=0;a<n;a++)l[a]&&(e.pixels.resultPixels[s+a]=t);else for(a=0;a<n;a++)l[a]&&(e.pixels.resultPixels[a]=t);else if(e.pixels.resultPixels.fill)e.pixels.resultPixels.fill(t);else for(a=0;a<r;a++)e.pixels.resultPixels[a]=t},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:default:t=Float32Array;break;case 7:t=Float64Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:default:t="F32";break;case 7:t="F64"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var i;switch(e){case 0:i=t>=-128&&t<=127;break;case 1:i=t>=0&&t<=255;break;case 2:i=t>=-32768&&t<=32767;break;case 3:i=t>=0&&t<=65536;break;case 4:i=t>=-2147483648&&t<=2147483647;break;case 5:i=t>=0&&t<=4294967296;break;case 6:i=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:i=t>=5e-324&&t<=17976931348623157e292;break;default:i=!1}return i},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var i=e;switch(e){case 2:case 4:i=e-t;break;case 3:case 5:i=e-2*t;break;case 6:i=0===t?e:1===t?2:1;break;case 7:i=0===t?e:e-2*t+1;break;default:i=e}return i},getOnePixel:function(e,t,i,n){var r=0;switch(i){case 0:r=n.getInt8(t);break;case 1:r=n.getUint8(t);break;case 2:r=n.getInt16(t,!0);break;case 3:r=n.getUint16(t,!0);break;case 4:r=n.getInt32(t,!0);break;case 5:r=n.getUInt32(t,!0);break;case 6:r=n.getFloat32(t,!0);break;case 7:r=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return r}},s=function(e,t,i){this.val=e,this.left=t,this.right=i},l={decode:function(e,t){var i=(t=t||{}).noDataValue,n=0,r={};if(r.ptr=t.inputOffset||0,r.pixels={},a.readHeaderInfo(e,r)){var o=r.headerInfo,s=o.fileVersion,l=a.getDataTypeArray(o.imageType);a.readMask(e,r),o.numValidPixel!==o.width*o.height&&!r.pixels.resultMask&&(r.pixels.resultMask=t.maskData);var u,c=o.width*o.height;if(r.pixels.resultPixels=new l(c*o.numDims),r.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},0!==o.numValidPixel)if(o.zMax===o.zMin)a.constructConstantSurface(r);else if(s>=4&&a.checkMinMaxRanges(e,r))a.constructConstantSurface(r);else{var h=new DataView(e,r.ptr,2),d=h.getUint8(0);if(r.ptr++,d)a.readDataOneSweep(e,r,l);else if(s>1&&o.imageType<=1&&Math.abs(o.maxZError-.5)<1e-5){var p=h.getUint8(1);if(r.ptr++,r.encodeMode=p,p>2||s<4&&p>1)throw"Invalid Huffman flag "+p;p?a.readHuffman(e,r,l):a.readTiles(e,r,l)}else a.readTiles(e,r,l)}r.eofOffset=r.ptr,t.inputOffset?(u=r.headerInfo.blobSize+t.inputOffset-r.ptr,Math.abs(u)>=1&&(r.eofOffset=t.inputOffset+r.headerInfo.blobSize)):(u=r.headerInfo.blobSize-r.ptr,Math.abs(u)>=1&&(r.eofOffset=r.headerInfo.blobSize));var f={width:o.width,height:o.height,pixelData:r.pixels.resultPixels,minValue:o.zMin,maxValue:o.zMax,validPixelCount:o.numValidPixel,dimCount:o.numDims,dimStats:{minValues:o.minValues,maxValues:o.maxValues},maskData:r.pixels.resultMask};if(r.pixels.resultMask&&a.isValidPixelValue(o.imageType,i)){var m=r.pixels.resultMask;for(n=0;n<c;n++)m[n]||(f.pixelData[n]=i);f.noDataValue=i}return r.noDataValue=i,t.returnFileInfo&&(f.fileInfo=a.formatFileInfo(r)),f}},getBandCount:function(e){for(var t=0,i=0,n={ptr:0,pixels:{}};i<e.byteLength-58;)a.readHeaderInfo(e,n),i+=n.headerInfo.blobSize,t++,n.ptr=i;return t}};return l}(),u=function(){var e=new ArrayBuffer(4),t=new Uint8Array(e);return new Uint32Array(e)[0]=1,1===t[0]}(),c={decode:function(e,t){if(!u)throw"Big endian system is not supported.";var i,n,r,o,a,c=(t=t||{}).inputOffset||0,h=new Uint8Array(e,c,10),d=String.fromCharCode.apply(null,h);if("CntZImage"===d.trim())i=s,n=1;else{if("Lerc2"!==d.substring(0,5))throw"Unexpected file identifier string: "+d;i=l,n=2}for(var p,f,m,_=0,g=e.byteLength-10,y=[],v={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]};c<g;){var b=i.decode(e,{inputOffset:c,encodedMaskData:p,maskData:m,returnMask:0===_,returnEncodedMask:0===_,returnFileInfo:!0,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});c=b.fileInfo.eofOffset,0===_&&(p=b.encodedMaskData,m=b.maskData,v.width=b.width,v.height=b.height,v.dimCount=b.dimCount||1,v.pixelType=b.pixelType||b.fileInfo.pixelType,v.mask=b.maskData),n>1&&b.fileInfo.mask&&b.fileInfo.mask.numBytes>0&&y.push(b.maskData),_++,v.pixels.push(b.pixelData),v.statistics.push({minValue:b.minValue,maxValue:b.maxValue,noDataValue:b.noDataValue,dimStats:b.dimStats})}if(n>1&&y.length>1){for(a=v.width*v.height,v.bandMasks=y,(m=new Uint8Array(a)).set(y[0]),r=1;r<y.length;r++)for(f=y[r],o=0;o<a;o++)m[o]=m[o]&f[o];v.maskData=m}return v}};"function"==typeof define&&__webpack_require__.amdO?define([],(function(){return c})):typeof t<"u"&&t.exports?t.exports=c:this.Lerc=c}()})),Wxe=Vc(((e,t)=>{t.exports={webm:"data:video/webm;base64,GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4EEQoWBAhhTgGcBAAAAAAAVkhFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsghV17AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU1LjMzLjEwMFdBjUxhdmY1NS4zMy4xMDBzpJBlrrXf3DCDVB8KcgbMpcr+RImIQJBgAAAAAAAWVK5rAQAAAAAAD++uAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDiDgQEj44OEAmJaAOABAAAAAAAABrCBsLqBkK4BAAAAAAAPq9eBAnPFgQKcgQAitZyDdW5khohBX1ZPUkJJU4OBAuEBAAAAAAAAEZ+BArWIQOdwAAAAAABiZIEgY6JPbwIeVgF2b3JiaXMAAAAAAoC7AAAAAAAAgLUBAAAAAAC4AQN2b3JiaXMtAAAAWGlwaC5PcmcgbGliVm9yYmlzIEkgMjAxMDExMDEgKFNjaGF1ZmVudWdnZXQpAQAAABUAAABlbmNvZGVyPUxhdmM1NS41Mi4xMDIBBXZvcmJpcyVCQ1YBAEAAACRzGCpGpXMWhBAaQlAZ4xxCzmvsGUJMEYIcMkxbyyVzkCGkoEKIWyiB0JBVAABAAACHQXgUhIpBCCGEJT1YkoMnPQghhIg5eBSEaUEIIYQQQgghhBBCCCGERTlokoMnQQgdhOMwOAyD5Tj4HIRFOVgQgydB6CCED0K4moOsOQghhCQ1SFCDBjnoHITCLCiKgsQwuBaEBDUojILkMMjUgwtCiJqDSTX4GoRnQXgWhGlBCCGEJEFIkIMGQcgYhEZBWJKDBjm4FITLQagahCo5CB+EIDRkFQCQAACgoiiKoigKEBqyCgDIAAAQQFEUx3EcyZEcybEcCwgNWQUAAAEACAAAoEiKpEiO5EiSJFmSJVmSJVmS5omqLMuyLMuyLMsyEBqyCgBIAABQUQxFcRQHCA1ZBQBkAAAIoDiKpViKpWiK54iOCISGrAIAgAAABAAAEDRDUzxHlETPVFXXtm3btm3btm3btm3btm1blmUZCA1ZBQBAAAAQ0mlmqQaIMAMZBkJDVgEACAAAgBGKMMSA0JBVAABAAACAGEoOogmtOd+c46BZDppKsTkdnEi1eZKbirk555xzzsnmnDHOOeecopxZDJoJrTnnnMSgWQqaCa0555wnsXnQmiqtOeeccc7pYJwRxjnnnCateZCajbU555wFrWmOmkuxOeecSLl5UptLtTnnnHPOOeecc84555zqxekcnBPOOeecqL25lpvQxTnnnE/G6d6cEM4555xzzjnnnHPOOeecIDRkFQAABABAEIaNYdwpCNLnaCBGEWIaMulB9+gwCRqDnELq0ehopJQ6CCWVcVJKJwgNWQUAAAIAQAghhRRSSCGFFFJIIYUUYoghhhhyyimnoIJKKqmooowyyyyzzDLLLLPMOuyssw47DDHEEEMrrcRSU2011lhr7jnnmoO0VlprrbVSSimllFIKQkNWAQAgAAAEQgYZZJBRSCGFFGKIKaeccgoqqIDQkFUAACAAgAAAAABP8hzRER3RER3RER3RER3R8RzPESVREiVREi3TMjXTU0VVdWXXlnVZt31b2IVd933d933d+HVhWJZlWZZlWZZlWZZlWZZlWZYgNGQVAAACAAAghBBCSCGFFFJIKcYYc8w56CSUEAgNWQUAAAIACAAAAHAUR3EcyZEcSbIkS9IkzdIsT/M0TxM9URRF0zRV0RVdUTdtUTZl0zVdUzZdVVZtV5ZtW7Z125dl2/d93/d93/d93/d93/d9XQdCQ1YBABIAADqSIymSIimS4ziOJElAaMgqAEAGAEAAAIriKI7jOJIkSZIlaZJneZaomZrpmZ4qqkBoyCoAABAAQAAAAAAAAIqmeIqpeIqoeI7oiJJomZaoqZoryqbsuq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq7ruq4LhIasAgAkAAB0JEdyJEdSJEVSJEdygNCQVQCADACAAAAcwzEkRXIsy9I0T/M0TxM90RM901NFV3SB0JBVAAAgAIAAAAAAAAAMybAUy9EcTRIl1VItVVMt1VJF1VNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVN0zRNEwgNWQkAkAEAkBBTLS3GmgmLJGLSaqugYwxS7KWxSCpntbfKMYUYtV4ah5RREHupJGOKQcwtpNApJq3WVEKFFKSYYyoVUg5SIDRkhQAQmgHgcBxAsixAsiwAAAAAAAAAkDQN0DwPsDQPAAAAAAAAACRNAyxPAzTPAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAA0DwP8DwR8EQRAAAAAAAAACzPAzTRAzxRBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABA0jRA8zxA8zwAAAAAAAAAsDwP8EQR0DwRAAAAAAAAACzPAzxRBDzRAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAEOAAABBgIRQasiIAiBMAcEgSJAmSBM0DSJYFTYOmwTQBkmVB06BpME0AAAAAAAAAAAAAJE2DpkHTIIoASdOgadA0iCIAAAAAAAAAAAAAkqZB06BpEEWApGnQNGgaRBEAAAAAAAAAAAAAzzQhihBFmCbAM02IIkQRpgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAGHAAAAgwoQwUGrIiAIgTAHA4imUBAIDjOJYFAACO41gWAABYliWKAABgWZooAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAYcAAACDChDBQashIAiAIAcCiKZQHHsSzgOJYFJMmyAJYF0DyApgFEEQAIAAAocAAACLBBU2JxgEJDVgIAUQAABsWxLE0TRZKkaZoniiRJ0zxPFGma53meacLzPM80IYqiaJoQRVE0TZimaaoqME1VFQAAUOAAABBgg6bE4gCFhqwEAEICAByKYlma5nmeJ4qmqZokSdM8TxRF0TRNU1VJkqZ5niiKommapqqyLE3zPFEURdNUVVWFpnmeKIqiaaqq6sLzPE8URdE0VdV14XmeJ4qiaJqq6roQRVE0TdNUTVV1XSCKpmmaqqqqrgtETxRNU1Vd13WB54miaaqqq7ouEE3TVFVVdV1ZBpimaaqq68oyQFVV1XVdV5YBqqqqruu6sgxQVdd1XVmWZQCu67qyLMsCAAAOHAAAAoygk4wqi7DRhAsPQKEhKwKAKAAAwBimFFPKMCYhpBAaxiSEFEImJaXSUqogpFJSKRWEVEoqJaOUUmopVRBSKamUCkIqJZVSAADYgQMA2IGFUGjISgAgDwCAMEYpxhhzTiKkFGPOOScRUoox55yTSjHmnHPOSSkZc8w556SUzjnnnHNSSuacc845KaVzzjnnnJRSSuecc05KKSWEzkEnpZTSOeecEwAAVOAAABBgo8jmBCNBhYasBABSAQAMjmNZmuZ5omialiRpmud5niiapiZJmuZ5nieKqsnzPE8URdE0VZXneZ4oiqJpqirXFUXTNE1VVV2yLIqmaZqq6rowTdNUVdd1XZimaaqq67oubFtVVdV1ZRm2raqq6rqyDFzXdWXZloEsu67s2rIAAPAEBwCgAhtWRzgpGgssNGQlAJABAEAYg5BCCCFlEEIKIYSUUggJAAAYcAAACDChDBQashIASAUAAIyx1lprrbXWQGettdZaa62AzFprrbXWWmuttdZaa6211lJrrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmuttdZaa6211lprrbXWWmstpZRSSimllFJKKaWUUkoppZRSSgUA+lU4APg/2LA6wknRWGChISsBgHAAAMAYpRhzDEIppVQIMeacdFRai7FCiDHnJKTUWmzFc85BKCGV1mIsnnMOQikpxVZjUSmEUlJKLbZYi0qho5JSSq3VWIwxqaTWWoutxmKMSSm01FqLMRYjbE2ptdhqq7EYY2sqLbQYY4zFCF9kbC2m2moNxggjWywt1VprMMYY3VuLpbaaizE++NpSLDHWXAAAd4MDAESCjTOsJJ0VjgYXGrISAAgJACAQUooxxhhzzjnnpFKMOeaccw5CCKFUijHGnHMOQgghlIwx5pxzEEIIIYRSSsaccxBCCCGEkFLqnHMQQgghhBBKKZ1zDkIIIYQQQimlgxBCCCGEEEoopaQUQgghhBBCCKmklEIIIYRSQighlZRSCCGEEEIpJaSUUgohhFJCCKGElFJKKYUQQgillJJSSimlEkoJJYQSUikppRRKCCGUUkpKKaVUSgmhhBJKKSWllFJKIYQQSikFAAAcOAAABBhBJxlVFmGjCRcegEJDVgIAZAAAkKKUUiktRYIipRikGEtGFXNQWoqocgxSzalSziDmJJaIMYSUk1Qy5hRCDELqHHVMKQYtlRhCxhik2HJLoXMOAAAAQQCAgJAAAAMEBTMAwOAA4XMQdAIERxsAgCBEZohEw0JweFAJEBFTAUBigkIuAFRYXKRdXECXAS7o4q4DIQQhCEEsDqCABByccMMTb3jCDU7QKSp1IAAAAAAADADwAACQXAAREdHMYWRobHB0eHyAhIiMkAgAAAAAABcAfAAAJCVAREQ0cxgZGhscHR4fICEiIyQBAIAAAgAAAAAggAAEBAQAAAAAAAIAAAAEBB9DtnUBAAAAAAAEPueBAKOFggAAgACjzoEAA4BwBwCdASqwAJAAAEcIhYWIhYSIAgIABhwJ7kPfbJyHvtk5D32ych77ZOQ99snIe+2TkPfbJyHvtk5D32ych77ZOQ99YAD+/6tQgKOFggADgAqjhYIAD4AOo4WCACSADqOZgQArADECAAEQEAAYABhYL/QACIBDmAYAAKOFggA6gA6jhYIAT4AOo5mBAFMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAGSADqOFggB6gA6jmYEAewAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAj4AOo5mBAKMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAKSADqOFggC6gA6jmYEAywAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIAz4AOo4WCAOSADqOZgQDzADECAAEQEAAYABhYL/QACIBDmAYAAKOFggD6gA6jhYIBD4AOo5iBARsAEQIAARAQFGAAYWC/0AAiAQ5gGACjhYIBJIAOo4WCATqADqOZgQFDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggFPgA6jhYIBZIAOo5mBAWsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAXqADqOFggGPgA6jmYEBkwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIBpIAOo4WCAbqADqOZgQG7ADECAAEQEAAYABhYL/QACIBDmAYAAKOFggHPgA6jmYEB4wAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIB5IAOo4WCAfqADqOZgQILADECAAEQEAAYABhYL/QACIBDmAYAAKOFggIPgA6jhYICJIAOo5mBAjMAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAjqADqOFggJPgA6jmYECWwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYICZIAOo4WCAnqADqOZgQKDADECAAEQEAAYABhYL/QACIBDmAYAAKOFggKPgA6jhYICpIAOo5mBAqsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCArqADqOFggLPgA6jmIEC0wARAgABEBAUYABhYL/QACIBDmAYAKOFggLkgA6jhYIC+oAOo5mBAvsAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCAw+ADqOZgQMjADECAAEQEAAYABhYL/QACIBDmAYAAKOFggMkgA6jhYIDOoAOo5mBA0sAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA0+ADqOFggNkgA6jmYEDcwAxAgABEBAAGAAYWC/0AAiAQ5gGAACjhYIDeoAOo4WCA4+ADqOZgQObADECAAEQEAAYABhYL/QACIBDmAYAAKOFggOkgA6jhYIDuoAOo5mBA8MAMQIAARAQABgAGFgv9AAIgEOYBgAAo4WCA8+ADqOFggPkgA6jhYID+oAOo4WCBA+ADhxTu2sBAAAAAAAAEbuPs4EDt4r3gQHxghEr8IEK",mp4:"data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw"}})),qxe=Vc(((e,t)=>{var{webm:i,mp4:n}=Wxe(),r=()=>typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,o=()=>"wakeLock"in navigator;t.exports=class{constructor(){if(this.enabled=!1,o()){this._wakeLock=null;let e=()=>{null!==this._wakeLock&&"visible"===document.visibilityState&&this.enable()};document.addEventListener("visibilitychange",e),document.addEventListener("fullscreenchange",e)}else r()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",i),this._addSourceToVideo(this.noSleepVideo,"mp4",n),this.noSleepVideo.addEventListener("loadedmetadata",(()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",(()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}))})))}_addSourceToVideo(e,t,i){var n=document.createElement("source");n.src=i,n.type=`video/${t}`,e.appendChild(n)}get isEnabled(){return this.enabled}enable(){return o()?navigator.wakeLock.request("screen").then((e=>{this._wakeLock=e,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",(()=>{console.log("Wake Lock released.")}))})).catch((e=>{throw this.enabled=!1,console.error(`${e.name}, ${e.message}`),e})):r()?(this.disable(),console.warn("\n        NoSleep enabled for older iOS devices. This can interrupt\n        active or long-running network requests from completing successfully.\n        See https://github.com/richtr/NoSleep.js/issues/15 for more details.\n      "),this.noSleepTimer=window.setInterval((()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))}),15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then((e=>(this.enabled=!0,e))).catch((e=>{throw this.enabled=!1,e}))}disable(){o()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):r()?this.noSleepTimer&&(console.warn("\n          NoSleep now disabled for older iOS devices.\n        "),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}}}));function wbe(e){return(0===e.length||"/"!==e[e.length-1])&&(e=`${e}/`),e}var jI=wbe;function vbe(e){return null!=e}var u=vbe;function Wy(e){let t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}u(Object.create)&&(Wy.prototype=Object.create(Error.prototype),Wy.prototype.constructor=Wy),Wy.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return u(this.stack)&&(e+=`\n${this.stack.toString()}`),e},Wy.throwInstantiationError=function(){throw new Wy("This function defines an interface and should not be called directly.")};var de=Wy,Qr={};function Dbe(e){return`${e} is required, actual value was undefined`}function _b(e,t,i){return`Expected ${i} to be typeof ${t}, actual typeof was ${e}`}Qr.typeOf={},Qr.defined=function(e,t){if(!u(t))throw new de(Dbe(e))},Qr.typeOf.func=function(e,t){if("function"!=typeof t)throw new de(_b(typeof t,"function",e))},Qr.typeOf.string=function(e,t){if("string"!=typeof t)throw new de(_b(typeof t,"string",e))},Qr.typeOf.number=function(e,t){if("number"!=typeof t)throw new de(_b(typeof t,"number",e))},Qr.typeOf.number.lessThan=function(e,t,i){if(Qr.typeOf.number(e,t),t>=i)throw new de(`Expected ${e} to be less than ${i}, actual value was ${t}`)},Qr.typeOf.number.lessThanOrEquals=function(e,t,i){if(Qr.typeOf.number(e,t),t>i)throw new de(`Expected ${e} to be less than or equal to ${i}, actual value was ${t}`)},Qr.typeOf.number.greaterThan=function(e,t,i){if(Qr.typeOf.number(e,t),t<=i)throw new de(`Expected ${e} to be greater than ${i}, actual value was ${t}`)},Qr.typeOf.number.greaterThanOrEquals=function(e,t,i){if(Qr.typeOf.number(e,t),t<i)throw new de(`Expected ${e} to be greater than or equal to ${i}, actual value was ${t}`)},Qr.typeOf.object=function(e,t){if("object"!=typeof t)throw new de(_b(typeof t,"object",e))},Qr.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new de(_b(typeof t,"boolean",e))},Qr.typeOf.bigint=function(e,t){if("bigint"!=typeof t)throw new de(_b(typeof t,"bigint",e))},Qr.typeOf.number.equals=function(e,t,i,n){if(Qr.typeOf.number(e,i),Qr.typeOf.number(t,n),i!==n)throw new de(`${e} must be equal to ${t}, the actual values are ${i} and ${n}`)};var El=Qr;function SX(e,t){return e??t}SX.EMPTY_OBJECT=Object.freeze({});var y=SX,j8=or(qI(),1),ot={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296};ot.sign=y(Math.sign,(function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1})),ot.signNotZero=function(e){return e<0?-1:1},ot.toSNorm=function(e,t){return t=y(t,255),Math.round((.5*ot.clamp(e,-1,1)+.5)*t)},ot.fromSNorm=function(e,t){return t=y(t,255),ot.clamp(e,0,t)/t*2-1},ot.normalize=function(e,t,i){return 0===(i=Math.max(i-t,0))?0:ot.clamp((e-t)/i,0,1)},ot.sinh=y(Math.sinh,(function(e){return(Math.exp(e)-Math.exp(-e))/2})),ot.cosh=y(Math.cosh,(function(e){return(Math.exp(e)+Math.exp(-e))/2})),ot.lerp=function(e,t,i){return(1-i)*e+i*t},ot.PI=Math.PI,ot.ONE_OVER_PI=1/Math.PI,ot.PI_OVER_TWO=Math.PI/2,ot.PI_OVER_THREE=Math.PI/3,ot.PI_OVER_FOUR=Math.PI/4,ot.PI_OVER_SIX=Math.PI/6,ot.THREE_PI_OVER_TWO=3*Math.PI/2,ot.TWO_PI=2*Math.PI,ot.ONE_OVER_TWO_PI=1/(2*Math.PI),ot.RADIANS_PER_DEGREE=Math.PI/180,ot.DEGREES_PER_RADIAN=180/Math.PI,ot.RADIANS_PER_ARCSECOND=ot.RADIANS_PER_DEGREE/3600,ot.toRadians=function(e){return e*ot.RADIANS_PER_DEGREE},ot.toDegrees=function(e){return e*ot.DEGREES_PER_RADIAN},ot.convertLongitudeRange=function(e){let t=ot.TWO_PI,i=e-Math.floor(e/t)*t;return i<-Math.PI?i+t:i>=Math.PI?i-t:i},ot.clampToLatitudeRange=function(e){return ot.clamp(e,-1*ot.PI_OVER_TWO,ot.PI_OVER_TWO)},ot.negativePiToPi=function(e){return e>=-ot.PI&&e<=ot.PI?e:ot.zeroToTwoPi(e+ot.PI)-ot.PI},ot.zeroToTwoPi=function(e){if(e>=0&&e<=ot.TWO_PI)return e;let t=ot.mod(e,ot.TWO_PI);return Math.abs(t)<ot.EPSILON14&&Math.abs(e)>ot.EPSILON14?ot.TWO_PI:t},ot.mod=function(e,t){return ot.sign(e)===ot.sign(t)&&Math.abs(e)<Math.abs(t)?e:(e%t+t)%t},ot.equalsEpsilon=function(e,t,i,n){i=y(i,0),n=y(n,i);let r=Math.abs(e-t);return r<=n||r<=i*Math.max(Math.abs(e),Math.abs(t))},ot.lessThan=function(e,t,i){return e-t<-i},ot.lessThanOrEquals=function(e,t,i){return e-t<i},ot.greaterThan=function(e,t,i){return e-t>i},ot.greaterThanOrEquals=function(e,t,i){return e-t>-i};var YI=[1];ot.factorial=function(e){let t=YI.length;if(e>=t){let i=YI[t-1];for(let n=t;n<=e;n++){let e=i*n;YI.push(e),i=e}}return YI[e]},ot.incrementWrap=function(e,t,i){return i=y(i,0),++e>t&&(e=i),e},ot.isPowerOfTwo=function(e){return 0!==e&&0==(e&e-1)},ot.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},ot.previousPowerOfTwo=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e=((e|=e>>32)>>>0)-(e>>>1)},ot.clamp=function(e,t,i){return e<t?t:e>i?i:e};var vX=new j8.default;ot.setRandomNumberSeed=function(e){vX=new j8.default(e)},ot.nextRandomNumber=function(){return vX.random()},ot.randomBetween=function(e,t){return ot.nextRandomNumber()*(t-e)+e},ot.acosClamped=function(e){return Math.acos(ot.clamp(e,-1,1))},ot.asinClamped=function(e){return Math.asin(ot.clamp(e,-1,1))},ot.chordLength=function(e,t){return 2*t*Math.sin(.5*e)},ot.logBase=function(e,t){return Math.log(e)/Math.log(t)},ot.cbrt=y(Math.cbrt,(function(e){let t=Math.pow(Math.abs(e),.3333333333333333);return e<0?-t:t})),ot.log2=y(Math.log2,(function(e){return Math.log(e)*Math.LOG2E})),ot.fog=function(e,t){let i=e*t;return 1-Math.exp(-i*i)},ot.fastApproximateAtan=function(e){return e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},ot.fastApproximateAtan2=function(e,t){let i,n=Math.abs(e);i=Math.abs(t);let r=Math.max(n,i);i=Math.min(n,i);let o=i/r;return n=ot.fastApproximateAtan(o),n=Math.abs(t)>Math.abs(e)?ot.PI_OVER_TWO-n:n,n=e<0?ot.PI-n:n,n=t<0?-n:n,n};var P=ot;function Qe(e,t,i){this.x=y(e,0),this.y=y(t,0),this.z=y(i,0)}Qe.fromSpherical=function(e,t){u(t)||(t=new Qe);let i=e.clock,n=e.cone,r=y(e.magnitude,1),o=r*Math.sin(n);return t.x=o*Math.cos(i),t.y=o*Math.sin(i),t.z=r*Math.cos(n),t},Qe.fromElements=function(e,t,i,n){return u(n)?(n.x=e,n.y=t,n.z=i,n):new Qe(e,t,i)},Qe.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new Qe(e.x,e.y,e.z)},Qe.fromCartesian4=Qe.clone,Qe.packedLength=3,Qe.pack=function(e,t,i){return i=y(i,0),t[i++]=e.x,t[i++]=e.y,t[i]=e.z,t},Qe.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Qe),i.x=e[t++],i.y=e[t++],i.z=e[t],i},Qe.packArray=function(e,t){let i=e.length,n=3*i;u(t)?!Array.isArray(t)&&t.length!==n||t.length!==n&&(t.length=n):t=new Array(n);for(let n=0;n<i;++n)Qe.pack(e[n],t,3*n);return t},Qe.unpackArray=function(e,t){let i=e.length;u(t)?t.length=i/3:t=new Array(i/3);for(let n=0;n<i;n+=3){let i=n/3;t[i]=Qe.unpack(e,n,t[i])}return t},Qe.fromArray=Qe.unpack,Qe.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)},Qe.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)},Qe.minimumByComponent=function(e,t,i){return i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.z=Math.min(e.z,t.z),i},Qe.maximumByComponent=function(e,t,i){return i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i.z=Math.max(e.z,t.z),i},Qe.clamp=function(e,t,i,n){let r=P.clamp(e.x,t.x,i.x),o=P.clamp(e.y,t.y,i.y),a=P.clamp(e.z,t.z,i.z);return n.x=r,n.y=o,n.z=a,n},Qe.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z},Qe.magnitude=function(e){return Math.sqrt(Qe.magnitudeSquared(e))};var KI=new Qe;Qe.distance=function(e,t){return Qe.subtract(e,t,KI),Qe.magnitude(KI)},Qe.distanceSquared=function(e,t){return Qe.subtract(e,t,KI),Qe.magnitudeSquared(KI)},Qe.normalize=function(e,t){let i=Qe.magnitude(e);return t.x=e.x/i,t.y=e.y/i,t.z=e.z/i,t},Qe.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},Qe.multiplyComponents=function(e,t,i){return i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i},Qe.divideComponents=function(e,t,i){return i.x=e.x/t.x,i.y=e.y/t.y,i.z=e.z/t.z,i},Qe.add=function(e,t,i){return i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i},Qe.subtract=function(e,t,i){return i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i},Qe.multiplyByScalar=function(e,t,i){return i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i},Qe.divideByScalar=function(e,t,i){return i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i},Qe.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},Qe.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var DX=new Qe;Qe.lerp=function(e,t,i,n){return Qe.multiplyByScalar(t,i,DX),n=Qe.multiplyByScalar(e,1-i,n),Qe.add(DX,n,n)};var XI=new Qe,q8=new Qe;Qe.angleBetween=function(e,t){Qe.normalize(e,XI),Qe.normalize(t,q8);let i=Qe.dot(XI,q8),n=Qe.magnitude(Qe.cross(XI,q8,XI));return Math.atan2(n,i)};var Ibe=new Qe;Qe.mostOrthogonalAxis=function(e,t){let i=Qe.normalize(e,Ibe);return Qe.abs(i,i),t=i.x<=i.y?i.x<=i.z?Qe.clone(Qe.UNIT_X,t):Qe.clone(Qe.UNIT_Z,t):i.y<=i.z?Qe.clone(Qe.UNIT_Y,t):Qe.clone(Qe.UNIT_Z,t)},Qe.projectVector=function(e,t,i){let n=Qe.dot(e,t)/Qe.dot(t,t);return Qe.multiplyByScalar(t,n,i)},Qe.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},Qe.equalsArray=function(e,t,i){return e.x===t[i]&&e.y===t[i+1]&&e.z===t[i+2]},Qe.equalsEpsilon=function(e,t,i,n){return e===t||u(e)&&u(t)&&P.equalsEpsilon(e.x,t.x,i,n)&&P.equalsEpsilon(e.y,t.y,i,n)&&P.equalsEpsilon(e.z,t.z,i,n)},Qe.cross=function(e,t,i){let n=e.x,r=e.y,o=e.z,a=t.x,s=t.y,l=t.z,u=r*l-o*s,c=o*a-n*l,h=n*s-r*a;return i.x=u,i.y=c,i.z=h,i},Qe.midpoint=function(e,t,i){return i.x=.5*(e.x+t.x),i.y=.5*(e.y+t.y),i.z=.5*(e.z+t.z),i},Qe.fromDegrees=function(e,t,i,n,r){return e=P.toRadians(e),t=P.toRadians(t),Qe.fromRadians(e,t,i,n,r)};var Su=new Qe,gb=new Qe,Pbe=new Qe(40680631590769,40680631590769,40408299984661.445);Qe.fromRadians=function(e,t,i,n,r){i=y(i,0);let o=u(n)?n.radiiSquared:Pbe,a=Math.cos(t);Su.x=a*Math.cos(e),Su.y=a*Math.sin(e),Su.z=Math.sin(t),Su=Qe.normalize(Su,Su),Qe.multiplyComponents(o,Su,gb);let s=Math.sqrt(Qe.dot(Su,gb));return gb=Qe.divideByScalar(gb,s,gb),Su=Qe.multiplyByScalar(Su,i,Su),u(r)||(r=new Qe),Qe.add(gb,Su,r)},Qe.fromDegreesArray=function(e,t,i){let n=e.length;u(i)?i.length=n/2:i=new Array(n/2);for(let r=0;r<n;r+=2){let n=e[r],o=e[r+1],a=r/2;i[a]=Qe.fromDegrees(n,o,0,t,i[a])}return i},Qe.fromRadiansArray=function(e,t,i){let n=e.length;u(i)?i.length=n/2:i=new Array(n/2);for(let r=0;r<n;r+=2){let n=e[r],o=e[r+1],a=r/2;i[a]=Qe.fromRadians(n,o,0,t,i[a])}return i},Qe.fromDegreesArrayHeights=function(e,t,i){let n=e.length;u(i)?i.length=n/3:i=new Array(n/3);for(let r=0;r<n;r+=3){let n=e[r],o=e[r+1],a=e[r+2],s=r/3;i[s]=Qe.fromDegrees(n,o,a,t,i[s])}return i},Qe.fromRadiansArrayHeights=function(e,t,i){let n=e.length;u(i)?i.length=n/3:i=new Array(n/3);for(let r=0;r<n;r+=3){let n=e[r],o=e[r+1],a=e[r+2],s=r/3;i[s]=Qe.fromRadians(n,o,a,t,i[s])}return i},Qe.ZERO=Object.freeze(new Qe(0,0,0)),Qe.ONE=Object.freeze(new Qe(1,1,1)),Qe.UNIT_X=Object.freeze(new Qe(1,0,0)),Qe.UNIT_Y=Object.freeze(new Qe(0,1,0)),Qe.UNIT_Z=Object.freeze(new Qe(0,0,1)),Qe.prototype.clone=function(e){return Qe.clone(this,e)},Qe.prototype.equals=function(e){return Qe.equals(this,e)},Qe.prototype.equalsEpsilon=function(e,t,i){return Qe.equalsEpsilon(this,e,t,i)},Qe.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`};var h=Qe,Obe=new h,Rbe=new h;function Mbe(e,t,i,n,r){let o=e.x,a=e.y,s=e.z,l=t.x,c=t.y,d=t.z,p=o*o*l*l,f=a*a*c*c,m=s*s*d*d,_=p+f+m,g=Math.sqrt(1/_),y=h.multiplyByScalar(e,g,Obe);if(_<n)return isFinite(g)?h.clone(y,r):void 0;let v=i.x,b=i.y,A=i.z,T=Rbe;T.x=y.x*v*2,T.y=y.y*b*2,T.z=y.z*A*2;let E,C,x,S,w,I,D,O,L,R,N,M=(1-g)*h.magnitude(e)/(.5*h.magnitude(T)),F=0;do{M-=F,x=1/(1+M*v),S=1/(1+M*b),w=1/(1+M*A),I=x*x,D=S*S,O=w*w,L=I*x,R=D*S,N=O*w,E=p*I+f*D+m*O-1,C=p*L*v+f*R*b+m*N*A,F=E/(-2*C)}while(Math.abs(E)>P.EPSILON12);return u(r)?(r.x=o*x,r.y=a*S,r.z=s*w,r):new h(o*x,a*S,s*w)}var yb=Mbe;function kr(e,t,i){this.longitude=y(e,0),this.latitude=y(t,0),this.height=y(i,0)}kr.fromRadians=function(e,t,i,n){return i=y(i,0),u(n)?(n.longitude=e,n.latitude=t,n.height=i,n):new kr(e,t,i)},kr.fromDegrees=function(e,t,i,n){return e=P.toRadians(e),t=P.toRadians(t),kr.fromRadians(e,t,i,n)};var Lbe=new h,Nbe=new h,Fbe=new h,Bbe=new h(1/6378137,1/6378137,1/6356752.314245179),kbe=new h(1/40680631590769,1/40680631590769,1/40408299984661.445),Vbe=P.EPSILON1;kr.fromCartesian=function(e,t,i){let n=u(t)?t.oneOverRadii:Bbe,r=u(t)?t.oneOverRadiiSquared:kbe,o=u(t)?t._centerToleranceSquared:Vbe,a=yb(e,n,r,o,Nbe);if(!u(a))return;let s=h.multiplyComponents(a,r,Lbe);s=h.normalize(s,s);let l=h.subtract(e,a,Fbe),c=Math.atan2(s.y,s.x),d=Math.asin(s.z),p=P.sign(h.dot(l,e))*h.magnitude(l);return u(i)?(i.longitude=c,i.latitude=d,i.height=p,i):new kr(c,d,p)},kr.toCartesian=function(e,t,i){return h.fromRadians(e.longitude,e.latitude,e.height,t,i)},kr.clone=function(e,t){if(u(e))return u(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new kr(e.longitude,e.latitude,e.height)},kr.equals=function(e,t){return e===t||u(e)&&u(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},kr.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e.longitude-t.longitude)<=i&&Math.abs(e.latitude-t.latitude)<=i&&Math.abs(e.height-t.height)<=i},kr.ZERO=Object.freeze(new kr(0,0,0)),kr.prototype.clone=function(e){return kr.clone(this,e)},kr.prototype.equals=function(e){return kr.equals(this,e)},kr.prototype.equalsEpsilon=function(e,t){return kr.equalsEpsilon(this,e,t)},kr.prototype.toString=function(){return`(${this.longitude}, ${this.latitude}, ${this.height})`};var fe=kr;function PX(e,t,i,n){t=y(t,0),i=y(i,0),n=y(n,0),e._radii=new h(t,i,n),e._radiiSquared=new h(t*t,i*i,n*n),e._radiiToTheFourth=new h(t*t*t*t,i*i*i*i,n*n*n*n),e._oneOverRadii=new h(0===t?0:1/t,0===i?0:1/i,0===n?0:1/n),e._oneOverRadiiSquared=new h(0===t?0:1/(t*t),0===i?0:1/(i*i),0===n?0:1/(n*n)),e._minimumRadius=Math.min(t,i,n),e._maximumRadius=Math.max(t,i,n),e._centerToleranceSquared=P.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function Yi(e,t,i){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,PX(this,e,t,i)}Object.defineProperties(Yi.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),Yi.clone=function(e,t){if(!u(e))return;let i=e._radii;return u(t)?(h.clone(i,t._radii),h.clone(e._radiiSquared,t._radiiSquared),h.clone(e._radiiToTheFourth,t._radiiToTheFourth),h.clone(e._oneOverRadii,t._oneOverRadii),h.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new Yi(i.x,i.y,i.z)},Yi.fromCartesian3=function(e,t){return u(t)||(t=new Yi),u(e)&&PX(t,e.x,e.y,e.z),t},Yi.WGS84=Object.freeze(new Yi(6378137,6378137,6356752.314245179)),Yi.UNIT_SPHERE=Object.freeze(new Yi(1,1,1)),Yi.MOON=Object.freeze(new Yi(P.LUNAR_RADIUS,P.LUNAR_RADIUS,P.LUNAR_RADIUS)),Yi.prototype.clone=function(e){return Yi.clone(this,e)},Yi.packedLength=h.packedLength,Yi.pack=function(e,t,i){return i=y(i,0),h.pack(e._radii,t,i),t},Yi.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t);return Yi.fromCartesian3(n,i)},Yi.prototype.geocentricSurfaceNormal=h.normalize,Yi.prototype.geodeticSurfaceNormalCartographic=function(e,t){let i=e.longitude,n=e.latitude,r=Math.cos(n),o=r*Math.cos(i),a=r*Math.sin(i),s=Math.sin(n);return u(t)||(t=new h),t.x=o,t.y=a,t.z=s,h.normalize(t,t)},Yi.prototype.geodeticSurfaceNormal=function(e,t){if(!h.equalsEpsilon(e,h.ZERO,P.EPSILON14))return u(t)||(t=new h),t=h.multiplyComponents(e,this._oneOverRadiiSquared,t),h.normalize(t,t)};var Ube=new h,zbe=new h;Yi.prototype.cartographicToCartesian=function(e,t){let i=Ube,n=zbe;this.geodeticSurfaceNormalCartographic(e,i),h.multiplyComponents(this._radiiSquared,i,n);let r=Math.sqrt(h.dot(i,n));return h.divideByScalar(n,r,n),h.multiplyByScalar(i,e.height,i),u(t)||(t=new h),h.add(n,i,t)},Yi.prototype.cartographicArrayToCartesianArray=function(e,t){let i=e.length;u(t)?t.length=i:t=new Array(i);for(let n=0;n<i;n++)t[n]=this.cartographicToCartesian(e[n],t[n]);return t};var Hbe=new h,Gbe=new h,Wbe=new h;Yi.prototype.cartesianToCartographic=function(e,t){let i=this.scaleToGeodeticSurface(e,Gbe);if(!u(i))return;let n=this.geodeticSurfaceNormal(i,Hbe),r=h.subtract(e,i,Wbe),o=Math.atan2(n.y,n.x),a=Math.asin(n.z),s=P.sign(h.dot(r,e))*h.magnitude(r);return u(t)?(t.longitude=o,t.latitude=a,t.height=s,t):new fe(o,a,s)},Yi.prototype.cartesianArrayToCartographicArray=function(e,t){let i=e.length;u(t)?t.length=i:t=new Array(i);for(let n=0;n<i;++n)t[n]=this.cartesianToCartographic(e[n],t[n]);return t},Yi.prototype.scaleToGeodeticSurface=function(e,t){return yb(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},Yi.prototype.scaleToGeocentricSurface=function(e,t){u(t)||(t=new h);let i=e.x,n=e.y,r=e.z,o=this._oneOverRadiiSquared,a=1/Math.sqrt(i*i*o.x+n*n*o.y+r*r*o.z);return h.multiplyByScalar(e,a,t)},Yi.prototype.transformPositionToScaledSpace=function(e,t){return u(t)||(t=new h),h.multiplyComponents(e,this._oneOverRadii,t)},Yi.prototype.transformPositionFromScaledSpace=function(e,t){return u(t)||(t=new h),h.multiplyComponents(e,this._radii,t)},Yi.prototype.equals=function(e){return this===e||u(e)&&h.equals(this._radii,e._radii)},Yi.prototype.toString=function(){return this._radii.toString()},Yi.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,i){t=y(t,0);let n=this._squaredXOverSquaredZ;if(u(i)||(i=new h),i.x=0,i.y=0,i.z=e.z*(1-n),!(Math.abs(i.z)>=this._radii.z-t))return i};var jbe=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],qbe=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function IX(e,t,i){let n=.5*(t+e),r=.5*(t-e),o=0;for(let e=0;e<5;e++){let t=r*jbe[e];o+=qbe[e]*(i(n+t)+i(n-t))}return o*=r,o}Yi.prototype.surfaceArea=function(e){let t=e.west,i=e.east,n=e.south,r=e.north;for(;i<t;)i+=P.TWO_PI;let o=this._radiiSquared,a=o.x,s=o.y,l=o.z,u=a*s;return IX(n,r,(function(e){let n=Math.cos(e),r=Math.sin(e);return Math.cos(e)*IX(t,i,(function(e){let t=Math.cos(e),i=Math.sin(e);return Math.sqrt(u*r*r+l*(s*t*t+a*i*i)*n*n)}))}))};var ie=Yi;function ZI(e){this._ellipsoid=y(e,ie.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(ZI.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),ZI.prototype.project=function(e,t){let i=this._semimajorAxis,n=e.longitude*i,r=e.latitude*i,o=e.height;return u(t)?(t.x=n,t.y=r,t.z=o,t):new h(n,r,o)},ZI.prototype.unproject=function(e,t){let i=this._oneOverSemimajorAxis,n=e.x*i,r=e.y*i,o=e.z;return u(t)?(t.longitude=n,t.latitude=r,t.height=o,t):new fe(n,r,o)};var Ii=ZI,Ybe={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},Zt=Object.freeze(Ybe);function Xbe(e,t){this.start=y(e,0),this.stop=y(t,0)}var Uc=Xbe;function Je(e,t,i,n,r,o,a,s,l){this[0]=y(e,0),this[1]=y(n,0),this[2]=y(a,0),this[3]=y(t,0),this[4]=y(r,0),this[5]=y(s,0),this[6]=y(i,0),this[7]=y(o,0),this[8]=y(l,0)}Je.packedLength=9,Je.pack=function(e,t,i){return i=y(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t[i++]=e[4],t[i++]=e[5],t[i++]=e[6],t[i++]=e[7],t[i++]=e[8],t},Je.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Je),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i[4]=e[t++],i[5]=e[t++],i[6]=e[t++],i[7]=e[t++],i[8]=e[t++],i},Je.packArray=function(e,t){let i=e.length,n=9*i;u(t)?!Array.isArray(t)&&t.length!==n||t.length!==n&&(t.length=n):t=new Array(n);for(let n=0;n<i;++n)Je.pack(e[n],t,9*n);return t},Je.unpackArray=function(e,t){let i=e.length;u(t)?t.length=i/9:t=new Array(i/9);for(let n=0;n<i;n+=9){let i=n/9;t[i]=Je.unpack(e,n,t[i])}return t},Je.clone=function(e,t){if(u(e))return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new Je(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},Je.fromArray=Je.unpack,Je.fromColumnMajorArray=function(e,t){return Je.clone(e,t)},Je.fromRowMajorArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new Je(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Je.fromQuaternion=function(e,t){let i=e.x*e.x,n=e.x*e.y,r=e.x*e.z,o=e.x*e.w,a=e.y*e.y,s=e.y*e.z,l=e.y*e.w,c=e.z*e.z,h=e.z*e.w,d=e.w*e.w,p=i-a-c+d,f=2*(n-h),m=2*(r+l),_=2*(n+h),g=-i+a-c+d,y=2*(s-o),v=2*(r-l),b=2*(s+o),A=-i-a+c+d;return u(t)?(t[0]=p,t[1]=_,t[2]=v,t[3]=f,t[4]=g,t[5]=b,t[6]=m,t[7]=y,t[8]=A,t):new Je(p,f,m,_,g,y,v,b,A)},Je.fromHeadingPitchRoll=function(e,t){let i=Math.cos(-e.pitch),n=Math.cos(-e.heading),r=Math.cos(e.roll),o=Math.sin(-e.pitch),a=Math.sin(-e.heading),s=Math.sin(e.roll),l=i*n,c=-r*a+s*o*n,h=s*a+r*o*n,d=i*a,p=r*n+s*o*a,f=-s*n+r*o*a,m=-o,_=s*i,g=r*i;return u(t)?(t[0]=l,t[1]=d,t[2]=m,t[3]=c,t[4]=p,t[5]=_,t[6]=h,t[7]=f,t[8]=g,t):new Je(l,c,h,d,p,f,m,_,g)},Je.fromScale=function(e,t){return u(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new Je(e.x,0,0,0,e.y,0,0,0,e.z)},Je.fromUniformScale=function(e,t){return u(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new Je(e,0,0,0,e,0,0,0,e)},Je.fromCrossProduct=function(e,t){return u(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new Je(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},Je.fromRotationX=function(e,t){let i=Math.cos(e),n=Math.sin(e);return u(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=i,t[5]=n,t[6]=0,t[7]=-n,t[8]=i,t):new Je(1,0,0,0,i,-n,0,n,i)},Je.fromRotationY=function(e,t){let i=Math.cos(e),n=Math.sin(e);return u(t)?(t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=1,t[5]=0,t[6]=n,t[7]=0,t[8]=i,t):new Je(i,0,n,0,1,0,-n,0,i)},Je.fromRotationZ=function(e,t){let i=Math.cos(e),n=Math.sin(e);return u(t)?(t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new Je(i,-n,0,n,i,0,0,0,1)},Je.toArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},Je.getElementIndex=function(e,t){return 3*e+t},Je.getColumn=function(e,t,i){let n=3*t,r=e[n],o=e[n+1],a=e[n+2];return i.x=r,i.y=o,i.z=a,i},Je.setColumn=function(e,t,i,n){let r=3*t;return(n=Je.clone(e,n))[r]=i.x,n[r+1]=i.y,n[r+2]=i.z,n},Je.getRow=function(e,t,i){let n=e[t],r=e[t+3],o=e[t+6];return i.x=n,i.y=r,i.z=o,i},Je.setRow=function(e,t,i,n){return(n=Je.clone(e,n))[t]=i.x,n[t+3]=i.y,n[t+6]=i.z,n};var Kbe=new h;Je.setScale=function(e,t,i){let n=Je.getScale(e,Kbe),r=t.x/n.x,o=t.y/n.y,a=t.z/n.z;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*o,i[4]=e[4]*o,i[5]=e[5]*o,i[6]=e[6]*a,i[7]=e[7]*a,i[8]=e[8]*a,i};var Zbe=new h;Je.setUniformScale=function(e,t,i){let n=Je.getScale(e,Zbe),r=t/n.x,o=t/n.y,a=t/n.z;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*o,i[4]=e[4]*o,i[5]=e[5]*o,i[6]=e[6]*a,i[7]=e[7]*a,i[8]=e[8]*a,i};var Y8=new h;Je.getScale=function(e,t){return t.x=h.magnitude(h.fromElements(e[0],e[1],e[2],Y8)),t.y=h.magnitude(h.fromElements(e[3],e[4],e[5],Y8)),t.z=h.magnitude(h.fromElements(e[6],e[7],e[8],Y8)),t};var OX=new h;Je.getMaximumScale=function(e){return Je.getScale(e,OX),h.maximumComponent(OX)};var $be=new h;Je.setRotation=function(e,t,i){let n=Je.getScale(e,$be);return i[0]=t[0]*n.x,i[1]=t[1]*n.x,i[2]=t[2]*n.x,i[3]=t[3]*n.y,i[4]=t[4]*n.y,i[5]=t[5]*n.y,i[6]=t[6]*n.z,i[7]=t[7]*n.z,i[8]=t[8]*n.z,i};var Qbe=new h;function Jbe(e){let t=0;for(let i=0;i<9;++i){let n=e[i];t+=n*n}return Math.sqrt(t)}Je.getRotation=function(e,t){let i=Je.getScale(e,Qbe);return t[0]=e[0]/i.x,t[1]=e[1]/i.x,t[2]=e[2]/i.x,t[3]=e[3]/i.y,t[4]=e[4]/i.y,t[5]=e[5]/i.y,t[6]=e[6]/i.z,t[7]=e[7]/i.z,t[8]=e[8]/i.z,t},Je.multiply=function(e,t,i){let n=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],r=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],o=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],a=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],s=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],l=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],u=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],c=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],h=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return i[0]=n,i[1]=r,i[2]=o,i[3]=a,i[4]=s,i[5]=l,i[6]=u,i[7]=c,i[8]=h,i},Je.add=function(e,t,i){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i},Je.subtract=function(e,t,i){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i},Je.multiplyByVector=function(e,t,i){let n=t.x,r=t.y,o=t.z,a=e[0]*n+e[3]*r+e[6]*o,s=e[1]*n+e[4]*r+e[7]*o,l=e[2]*n+e[5]*r+e[8]*o;return i.x=a,i.y=s,i.z=l,i},Je.multiplyByScalar=function(e,t,i){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i},Je.multiplyByScale=function(e,t,i){return i[0]=e[0]*t.x,i[1]=e[1]*t.x,i[2]=e[2]*t.x,i[3]=e[3]*t.y,i[4]=e[4]*t.y,i[5]=e[5]*t.y,i[6]=e[6]*t.z,i[7]=e[7]*t.z,i[8]=e[8]*t.z,i},Je.multiplyByUniformScale=function(e,t,i){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i},Je.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},Je.transpose=function(e,t){let i=e[0],n=e[3],r=e[6],o=e[1],a=e[4],s=e[7],l=e[2],u=e[5],c=e[8];return t[0]=i,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=s,t[6]=l,t[7]=u,t[8]=c,t};var X8=[1,0,0],K8=[2,2,1];function eTe(e){let t=0;for(let i=0;i<3;++i){let n=e[Je.getElementIndex(K8[i],X8[i])];t+=2*n*n}return Math.sqrt(t)}function tTe(e,t){let i=P.EPSILON15,n=0,r=1;for(let t=0;t<3;++t){let i=Math.abs(e[Je.getElementIndex(K8[t],X8[t])]);i>n&&(r=t,n=i)}let o=1,a=0,s=X8[r],l=K8[r];if(Math.abs(e[Je.getElementIndex(l,s)])>i){let t,i=(e[Je.getElementIndex(l,l)]-e[Je.getElementIndex(s,s)])/2/e[Je.getElementIndex(l,s)];t=i<0?-1/(-i+Math.sqrt(1+i*i)):1/(i+Math.sqrt(1+i*i)),o=1/Math.sqrt(1+t*t),a=t*o}return(t=Je.clone(Je.IDENTITY,t))[Je.getElementIndex(s,s)]=t[Je.getElementIndex(l,l)]=o,t[Je.getElementIndex(l,s)]=a,t[Je.getElementIndex(s,l)]=-a,t}var $I=new Je,RX=new Je;Je.computeEigenDecomposition=function(e,t){let i=P.EPSILON20,n=0,r=0;u(t)||(t={});let o=t.unitary=Je.clone(Je.IDENTITY,t.unitary),a=t.diagonal=Je.clone(e,t.diagonal),s=i*Jbe(a);for(;r<10&&eTe(a)>s;)tTe(a,$I),Je.transpose($I,RX),Je.multiply(a,$I,a),Je.multiply(RX,a,a),Je.multiply(o,$I,o),++n>2&&(++r,n=0);return t},Je.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},Je.determinant=function(e){let t=e[0],i=e[3],n=e[6],r=e[1],o=e[4],a=e[7],s=e[2],l=e[5],u=e[8];return t*(o*u-l*a)+r*(l*n-i*u)+s*(i*a-o*n)},Je.inverse=function(e,t){let i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=Je.determinant(e);t[0]=a*c-u*s,t[1]=u*r-n*c,t[2]=n*s-a*r,t[3]=l*s-o*c,t[4]=i*c-l*r,t[5]=o*r-i*s,t[6]=o*u-l*a,t[7]=l*n-i*u,t[8]=i*a-o*n;let d=1/h;return Je.multiplyByScalar(t,d,t)};var nTe=new Je;Je.inverseTranspose=function(e,t){return Je.inverse(Je.transpose(e,nTe),t)},Je.equals=function(e,t){return e===t||u(e)&&u(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},Je.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i},Je.IDENTITY=Object.freeze(new Je(1,0,0,0,1,0,0,0,1)),Je.ZERO=Object.freeze(new Je(0,0,0,0,0,0,0,0,0)),Je.COLUMN0ROW0=0,Je.COLUMN0ROW1=1,Je.COLUMN0ROW2=2,Je.COLUMN1ROW0=3,Je.COLUMN1ROW1=4,Je.COLUMN1ROW2=5,Je.COLUMN2ROW0=6,Je.COLUMN2ROW1=7,Je.COLUMN2ROW2=8,Object.defineProperties(Je.prototype,{length:{get:function(){return Je.packedLength}}}),Je.prototype.clone=function(e){return Je.clone(this,e)},Je.prototype.equals=function(e){return Je.equals(this,e)},Je.equalsArray=function(e,t,i){return e[0]===t[i]&&e[1]===t[i+1]&&e[2]===t[i+2]&&e[3]===t[i+3]&&e[4]===t[i+4]&&e[5]===t[i+5]&&e[6]===t[i+6]&&e[7]===t[i+7]&&e[8]===t[i+8]},Je.prototype.equalsEpsilon=function(e,t){return Je.equalsEpsilon(this,e,t)},Je.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})\n(${this[1]}, ${this[4]}, ${this[7]})\n(${this[2]}, ${this[5]}, ${this[8]})`};var $=Je;function mt(e,t,i,n){this.x=y(e,0),this.y=y(t,0),this.z=y(i,0),this.w=y(n,0)}mt.fromElements=function(e,t,i,n,r){return u(r)?(r.x=e,r.y=t,r.z=i,r.w=n,r):new mt(e,t,i,n)},mt.fromColor=function(e,t){return u(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new mt(e.red,e.green,e.blue,e.alpha)},mt.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new mt(e.x,e.y,e.z,e.w)},mt.packedLength=4,mt.pack=function(e,t,i){return i=y(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.z,t[i]=e.w,t},mt.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new mt),i.x=e[t++],i.y=e[t++],i.z=e[t++],i.w=e[t],i},mt.packArray=function(e,t){let i=e.length,n=4*i;u(t)?!Array.isArray(t)&&t.length!==n||t.length!==n&&(t.length=n):t=new Array(n);for(let n=0;n<i;++n)mt.pack(e[n],t,4*n);return t},mt.unpackArray=function(e,t){let i=e.length;u(t)?t.length=i/4:t=new Array(i/4);for(let n=0;n<i;n+=4){let i=n/4;t[i]=mt.unpack(e,n,t[i])}return t},mt.fromArray=mt.unpack,mt.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)},mt.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)},mt.minimumByComponent=function(e,t,i){return i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.z=Math.min(e.z,t.z),i.w=Math.min(e.w,t.w),i},mt.maximumByComponent=function(e,t,i){return i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i.z=Math.max(e.z,t.z),i.w=Math.max(e.w,t.w),i},mt.clamp=function(e,t,i,n){let r=P.clamp(e.x,t.x,i.x),o=P.clamp(e.y,t.y,i.y),a=P.clamp(e.z,t.z,i.z),s=P.clamp(e.w,t.w,i.w);return n.x=r,n.y=o,n.z=a,n.w=s,n},mt.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},mt.magnitude=function(e){return Math.sqrt(mt.magnitudeSquared(e))};var QI=new mt;mt.distance=function(e,t){return mt.subtract(e,t,QI),mt.magnitude(QI)},mt.distanceSquared=function(e,t){return mt.subtract(e,t,QI),mt.magnitudeSquared(QI)},mt.normalize=function(e,t){let i=mt.magnitude(e);return t.x=e.x/i,t.y=e.y/i,t.z=e.z/i,t.w=e.w/i,t},mt.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},mt.multiplyComponents=function(e,t,i){return i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i.w=e.w*t.w,i},mt.divideComponents=function(e,t,i){return i.x=e.x/t.x,i.y=e.y/t.y,i.z=e.z/t.z,i.w=e.w/t.w,i},mt.add=function(e,t,i){return i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w,i},mt.subtract=function(e,t,i){return i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w,i},mt.multiplyByScalar=function(e,t,i){return i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t,i},mt.divideByScalar=function(e,t,i){return i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i.w=e.w/t,i},mt.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},mt.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var MX=new mt;mt.lerp=function(e,t,i,n){return mt.multiplyByScalar(t,i,MX),n=mt.multiplyByScalar(e,1-i,n),mt.add(MX,n,n)};var iTe=new mt;mt.mostOrthogonalAxis=function(e,t){let i=mt.normalize(e,iTe);return mt.abs(i,i),t=i.x<=i.y?i.x<=i.z?i.x<=i.w?mt.clone(mt.UNIT_X,t):mt.clone(mt.UNIT_W,t):i.z<=i.w?mt.clone(mt.UNIT_Z,t):mt.clone(mt.UNIT_W,t):i.y<=i.z?i.y<=i.w?mt.clone(mt.UNIT_Y,t):mt.clone(mt.UNIT_W,t):i.z<=i.w?mt.clone(mt.UNIT_Z,t):mt.clone(mt.UNIT_W,t)},mt.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},mt.equalsArray=function(e,t,i){return e.x===t[i]&&e.y===t[i+1]&&e.z===t[i+2]&&e.w===t[i+3]},mt.equalsEpsilon=function(e,t,i,n){return e===t||u(e)&&u(t)&&P.equalsEpsilon(e.x,t.x,i,n)&&P.equalsEpsilon(e.y,t.y,i,n)&&P.equalsEpsilon(e.z,t.z,i,n)&&P.equalsEpsilon(e.w,t.w,i,n)},mt.ZERO=Object.freeze(new mt(0,0,0,0)),mt.ONE=Object.freeze(new mt(1,1,1,1)),mt.UNIT_X=Object.freeze(new mt(1,0,0,0)),mt.UNIT_Y=Object.freeze(new mt(0,1,0,0)),mt.UNIT_Z=Object.freeze(new mt(0,0,1,0)),mt.UNIT_W=Object.freeze(new mt(0,0,0,1)),mt.prototype.clone=function(e){return mt.clone(this,e)},mt.prototype.equals=function(e){return mt.equals(this,e)},mt.prototype.equalsEpsilon=function(e,t,i){return mt.equalsEpsilon(this,e,t,i)},mt.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var Z8=new Float32Array(1),Aa=new Uint8Array(Z8.buffer),oTe=new Uint32Array([287454020]),rTe=new Uint8Array(oTe.buffer),LX=68===rTe[0];mt.packFloat=function(e,t){return u(t)||(t=new mt),Z8[0]=e,LX?(t.x=Aa[0],t.y=Aa[1],t.z=Aa[2],t.w=Aa[3]):(t.x=Aa[3],t.y=Aa[2],t.z=Aa[1],t.w=Aa[0]),t},mt.unpackFloat=function(e){return LX?(Aa[0]=e.x,Aa[1]=e.y,Aa[2]=e.z,Aa[3]=e.w):(Aa[0]=e.w,Aa[1]=e.z,Aa[2]=e.y,Aa[3]=e.x),Z8[0]};var oe=mt;function GE(e){let t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}u(Object.create)&&(GE.prototype=Object.create(Error.prototype),GE.prototype.constructor=GE),GE.prototype.toString=function(){let e=`${this.name}: ${this.message}`;return u(this.stack)&&(e+=`\n${this.stack.toString()}`),e};var ue=GE;function $e(e,t,i,n,r,o,a,s,l,u,c,h,d,p,f,m){this[0]=y(e,0),this[1]=y(r,0),this[2]=y(l,0),this[3]=y(d,0),this[4]=y(t,0),this[5]=y(o,0),this[6]=y(u,0),this[7]=y(p,0),this[8]=y(i,0),this[9]=y(a,0),this[10]=y(c,0),this[11]=y(f,0),this[12]=y(n,0),this[13]=y(s,0),this[14]=y(h,0),this[15]=y(m,0)}$e.packedLength=16,$e.pack=function(e,t,i){return i=y(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t[i++]=e[4],t[i++]=e[5],t[i++]=e[6],t[i++]=e[7],t[i++]=e[8],t[i++]=e[9],t[i++]=e[10],t[i++]=e[11],t[i++]=e[12],t[i++]=e[13],t[i++]=e[14],t[i]=e[15],t},$e.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new $e),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i[4]=e[t++],i[5]=e[t++],i[6]=e[t++],i[7]=e[t++],i[8]=e[t++],i[9]=e[t++],i[10]=e[t++],i[11]=e[t++],i[12]=e[t++],i[13]=e[t++],i[14]=e[t++],i[15]=e[t],i},$e.packArray=function(e,t){let i=e.length,n=16*i;u(t)?!Array.isArray(t)&&t.length!==n||t.length!==n&&(t.length=n):t=new Array(n);for(let n=0;n<i;++n)$e.pack(e[n],t,16*n);return t},$e.unpackArray=function(e,t){let i=e.length;u(t)?t.length=i/16:t=new Array(i/16);for(let n=0;n<i;n+=16){let i=n/16;t[i]=$e.unpack(e,n,t[i])}return t},$e.clone=function(e,t){if(u(e))return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new $e(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},$e.fromArray=$e.unpack,$e.fromColumnMajorArray=function(e,t){return $e.clone(e,t)},$e.fromRowMajorArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new $e(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},$e.fromRotationTranslation=function(e,t,i){return t=y(t,h.ZERO),u(i)?(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=0,i[4]=e[3],i[5]=e[4],i[6]=e[5],i[7]=0,i[8]=e[6],i[9]=e[7],i[10]=e[8],i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,i):new $e(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},$e.fromTranslationQuaternionRotationScale=function(e,t,i,n){u(n)||(n=new $e);let r=i.x,o=i.y,a=i.z,s=t.x*t.x,l=t.x*t.y,c=t.x*t.z,h=t.x*t.w,d=t.y*t.y,p=t.y*t.z,f=t.y*t.w,m=t.z*t.z,_=t.z*t.w,g=t.w*t.w,y=s-d-m+g,v=2*(l-_),b=2*(c+f),A=2*(l+_),T=-s+d-m+g,E=2*(p-h),C=2*(c-f),x=2*(p+h),S=-s-d+m+g;return n[0]=y*r,n[1]=A*r,n[2]=C*r,n[3]=0,n[4]=v*o,n[5]=T*o,n[6]=x*o,n[7]=0,n[8]=b*a,n[9]=E*a,n[10]=S*a,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,n},$e.fromTranslationRotationScale=function(e,t){return $e.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},$e.fromTranslation=function(e,t){return $e.fromRotationTranslation($.IDENTITY,e,t)},$e.fromScale=function(e,t){return u(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new $e(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},$e.fromUniformScale=function(e,t){return u(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new $e(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)},$e.fromRotation=function(e,t){return u(t)||(t=new $e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=0,t[4]=e[3],t[5]=e[4],t[6]=e[5],t[7]=0,t[8]=e[6],t[9]=e[7],t[10]=e[8],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};var xb=new h,bb=new h,WE=new h;$e.fromCamera=function(e,t){let i=e.position,n=e.direction,r=e.up;h.normalize(n,xb),h.normalize(h.cross(xb,r,bb),bb),h.normalize(h.cross(bb,xb,WE),WE);let o=bb.x,a=bb.y,s=bb.z,l=xb.x,c=xb.y,d=xb.z,p=WE.x,f=WE.y,m=WE.z,_=i.x,g=i.y,y=i.z,v=o*-_+a*-g+s*-y,b=p*-_+f*-g+m*-y,A=l*_+c*g+d*y;return u(t)?(t[0]=o,t[1]=p,t[2]=-l,t[3]=0,t[4]=a,t[5]=f,t[6]=-c,t[7]=0,t[8]=s,t[9]=m,t[10]=-d,t[11]=0,t[12]=v,t[13]=b,t[14]=A,t[15]=1,t):new $e(o,a,s,v,p,f,m,b,-l,-c,-d,A,0,0,0,1)},$e.computePerspectiveFieldOfView=function(e,t,i,n,r){let o=1/Math.tan(.5*e),a=o/t,s=(n+i)/(i-n),l=2*n*i/(i-n);return r[0]=a,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=o,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=s,r[11]=-1,r[12]=0,r[13]=0,r[14]=l,r[15]=0,r},$e.computeOrthographicOffCenter=function(e,t,i,n,r,o,a){let s=1/(t-e),l=1/(n-i),u=1/(o-r),c=-(t+e)*s,h=-(n+i)*l,d=-(o+r)*u;return s*=2,l*=2,u*=-2,a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=u,a[11]=0,a[12]=c,a[13]=h,a[14]=d,a[15]=1,a},$e.computePerspectiveOffCenter=function(e,t,i,n,r,o,a){let s=2*r/(t-e),l=2*r/(n-i),u=(t+e)/(t-e),c=(n+i)/(n-i),h=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=u,a[9]=c,a[10]=h,a[11]=-1,a[12]=0,a[13]=0,a[14]=d,a[15]=0,a},$e.computeInfinitePerspectiveOffCenter=function(e,t,i,n,r,o){let a=2*r/(t-e),s=2*r/(n-i),l=(t+e)/(t-e),u=(n+i)/(n-i),c=-2*r;return o[0]=a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=l,o[9]=u,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=c,o[15]=0,o},$e.computeViewportTransformation=function(e,t,i,n){u(n)||(n=new $e),e=y(e,y.EMPTY_OBJECT);let r=y(e.x,0),o=y(e.y,0),a=y(e.width,0),s=y(e.height,0);t=y(t,0);let l=.5*a,c=.5*s,h=.5*((i=y(i,1))-t),d=l,p=c,f=h,m=r+l,_=o+c,g=t+h;return n[0]=d,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=p,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=f,n[11]=0,n[12]=m,n[13]=_,n[14]=g,n[15]=1,n},$e.computeView=function(e,t,i,n,r){return r[0]=n.x,r[1]=i.x,r[2]=-t.x,r[3]=0,r[4]=n.y,r[5]=i.y,r[6]=-t.y,r[7]=0,r[8]=n.z,r[9]=i.z,r[10]=-t.z,r[11]=0,r[12]=-h.dot(n,e),r[13]=-h.dot(i,e),r[14]=h.dot(t,e),r[15]=1,r},$e.toArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},$e.getElementIndex=function(e,t){return 4*e+t},$e.getColumn=function(e,t,i){let n=4*t,r=e[n],o=e[n+1],a=e[n+2],s=e[n+3];return i.x=r,i.y=o,i.z=a,i.w=s,i},$e.setColumn=function(e,t,i,n){let r=4*t;return(n=$e.clone(e,n))[r]=i.x,n[r+1]=i.y,n[r+2]=i.z,n[r+3]=i.w,n},$e.getRow=function(e,t,i){let n=e[t],r=e[t+4],o=e[t+8],a=e[t+12];return i.x=n,i.y=r,i.z=o,i.w=a,i},$e.setRow=function(e,t,i,n){return(n=$e.clone(e,n))[t]=i.x,n[t+4]=i.y,n[t+8]=i.z,n[t+12]=i.w,n},$e.setTranslation=function(e,t,i){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=e[15],i};var sTe=new h;$e.setScale=function(e,t,i){let n=$e.getScale(e,sTe),r=t.x/n.x,o=t.y/n.y,a=t.z/n.z;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3],i[4]=e[4]*o,i[5]=e[5]*o,i[6]=e[6]*o,i[7]=e[7],i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i};var aTe=new h;$e.setUniformScale=function(e,t,i){let n=$e.getScale(e,aTe),r=t/n.x,o=t/n.y,a=t/n.z;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3],i[4]=e[4]*o,i[5]=e[5]*o,i[6]=e[6]*o,i[7]=e[7],i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i};var $8=new h;$e.getScale=function(e,t){return t.x=h.magnitude(h.fromElements(e[0],e[1],e[2],$8)),t.y=h.magnitude(h.fromElements(e[4],e[5],e[6],$8)),t.z=h.magnitude(h.fromElements(e[8],e[9],e[10],$8)),t};var NX=new h;$e.getMaximumScale=function(e){return $e.getScale(e,NX),h.maximumComponent(NX)};var cTe=new h;$e.setRotation=function(e,t,i){let n=$e.getScale(e,cTe);return i[0]=t[0]*n.x,i[1]=t[1]*n.x,i[2]=t[2]*n.x,i[3]=e[3],i[4]=t[3]*n.y,i[5]=t[4]*n.y,i[6]=t[5]*n.y,i[7]=e[7],i[8]=t[6]*n.z,i[9]=t[7]*n.z,i[10]=t[8]*n.z,i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i};var lTe=new h;$e.getRotation=function(e,t){let i=$e.getScale(e,lTe);return t[0]=e[0]/i.x,t[1]=e[1]/i.x,t[2]=e[2]/i.x,t[3]=e[4]/i.y,t[4]=e[5]/i.y,t[5]=e[6]/i.y,t[6]=e[8]/i.z,t[7]=e[9]/i.z,t[8]=e[10]/i.z,t},$e.multiply=function(e,t,i){let n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],_=e[13],g=e[14],y=e[15],v=t[0],b=t[1],A=t[2],T=t[3],E=t[4],C=t[5],x=t[6],S=t[7],w=t[8],I=t[9],P=t[10],D=t[11],O=t[12],L=t[13],R=t[14],N=t[15],M=n*v+s*b+h*A+m*T,F=r*v+l*b+d*A+_*T,B=o*v+u*b+p*A+g*T,z=a*v+c*b+f*A+y*T,U=n*E+s*C+h*x+m*S,k=r*E+l*C+d*x+_*S,V=o*E+u*C+p*x+g*S,H=a*E+c*C+f*x+y*S,G=n*w+s*I+h*P+m*D,j=r*w+l*I+d*P+_*D,W=o*w+u*I+p*P+g*D,q=a*w+c*I+f*P+y*D,Y=n*O+s*L+h*R+m*N,X=r*O+l*L+d*R+_*N,$=o*O+u*L+p*R+g*N,K=a*O+c*L+f*R+y*N;return i[0]=M,i[1]=F,i[2]=B,i[3]=z,i[4]=U,i[5]=k,i[6]=V,i[7]=H,i[8]=G,i[9]=j,i[10]=W,i[11]=q,i[12]=Y,i[13]=X,i[14]=$,i[15]=K,i},$e.add=function(e,t,i){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i},$e.subtract=function(e,t,i){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i},$e.multiplyTransformation=function(e,t,i){let n=e[0],r=e[1],o=e[2],a=e[4],s=e[5],l=e[6],u=e[8],c=e[9],h=e[10],d=e[12],p=e[13],f=e[14],m=t[0],_=t[1],g=t[2],y=t[4],v=t[5],b=t[6],A=t[8],T=t[9],E=t[10],C=t[12],x=t[13],S=t[14],w=n*m+a*_+u*g,I=r*m+s*_+c*g,P=o*m+l*_+h*g,D=n*y+a*v+u*b,O=r*y+s*v+c*b,L=o*y+l*v+h*b,R=n*A+a*T+u*E,N=r*A+s*T+c*E,M=o*A+l*T+h*E,F=n*C+a*x+u*S+d,B=r*C+s*x+c*S+p,z=o*C+l*x+h*S+f;return i[0]=w,i[1]=I,i[2]=P,i[3]=0,i[4]=D,i[5]=O,i[6]=L,i[7]=0,i[8]=R,i[9]=N,i[10]=M,i[11]=0,i[12]=F,i[13]=B,i[14]=z,i[15]=1,i},$e.multiplyByMatrix3=function(e,t,i){let n=e[0],r=e[1],o=e[2],a=e[4],s=e[5],l=e[6],u=e[8],c=e[9],h=e[10],d=t[0],p=t[1],f=t[2],m=t[3],_=t[4],g=t[5],y=t[6],v=t[7],b=t[8],A=n*d+a*p+u*f,T=r*d+s*p+c*f,E=o*d+l*p+h*f,C=n*m+a*_+u*g,x=r*m+s*_+c*g,S=o*m+l*_+h*g,w=n*y+a*v+u*b,I=r*y+s*v+c*b,P=o*y+l*v+h*b;return i[0]=A,i[1]=T,i[2]=E,i[3]=0,i[4]=C,i[5]=x,i[6]=S,i[7]=0,i[8]=w,i[9]=I,i[10]=P,i[11]=0,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},$e.multiplyByTranslation=function(e,t,i){let n=t.x,r=t.y,o=t.z,a=n*e[0]+r*e[4]+o*e[8]+e[12],s=n*e[1]+r*e[5]+o*e[9]+e[13],l=n*e[2]+r*e[6]+o*e[10]+e[14];return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=a,i[13]=s,i[14]=l,i[15]=e[15],i},$e.multiplyByScale=function(e,t,i){let n=t.x,r=t.y,o=t.z;return 1===n&&1===r&&1===o?$e.clone(e,i):(i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=e[3],i[4]=r*e[4],i[5]=r*e[5],i[6]=r*e[6],i[7]=e[7],i[8]=o*e[8],i[9]=o*e[9],i[10]=o*e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i)},$e.multiplyByUniformScale=function(e,t,i){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3],i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7],i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},$e.multiplyByVector=function(e,t,i){let n=t.x,r=t.y,o=t.z,a=t.w,s=e[0]*n+e[4]*r+e[8]*o+e[12]*a,l=e[1]*n+e[5]*r+e[9]*o+e[13]*a,u=e[2]*n+e[6]*r+e[10]*o+e[14]*a,c=e[3]*n+e[7]*r+e[11]*o+e[15]*a;return i.x=s,i.y=l,i.z=u,i.w=c,i},$e.multiplyByPointAsVector=function(e,t,i){let n=t.x,r=t.y,o=t.z,a=e[0]*n+e[4]*r+e[8]*o,s=e[1]*n+e[5]*r+e[9]*o,l=e[2]*n+e[6]*r+e[10]*o;return i.x=a,i.y=s,i.z=l,i},$e.multiplyByPoint=function(e,t,i){let n=t.x,r=t.y,o=t.z,a=e[0]*n+e[4]*r+e[8]*o+e[12],s=e[1]*n+e[5]*r+e[9]*o+e[13],l=e[2]*n+e[6]*r+e[10]*o+e[14];return i.x=a,i.y=s,i.z=l,i},$e.multiplyByScalar=function(e,t,i){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i},$e.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},$e.transpose=function(e,t){let i=e[1],n=e[2],r=e[3],o=e[6],a=e[7],s=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[10]=e[10],t[11]=e[14],t[12]=r,t[13]=a,t[14]=s,t[15]=e[15],t},$e.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},$e.equals=function(e,t){return e===t||u(e)&&u(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},$e.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i&&Math.abs(e[9]-t[9])<=i&&Math.abs(e[10]-t[10])<=i&&Math.abs(e[11]-t[11])<=i&&Math.abs(e[12]-t[12])<=i&&Math.abs(e[13]-t[13])<=i&&Math.abs(e[14]-t[14])<=i&&Math.abs(e[15]-t[15])<=i},$e.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t},$e.getMatrix3=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var uTe=new $,fTe=new $,dTe=new oe,hTe=new oe(0,0,0,1);$e.inverse=function(e,t){let i=e[0],n=e[4],r=e[8],o=e[12],a=e[1],s=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],p=e[14],f=e[3],m=e[7],_=e[11],g=e[15],y=d*g,v=p*_,b=h*g,A=p*m,T=h*_,E=d*m,C=c*g,x=p*f,S=c*_,w=d*f,I=c*m,D=h*f,O=y*s+A*l+T*u-(v*s+b*l+E*u),L=v*a+C*l+w*u-(y*a+x*l+S*u),R=b*a+x*s+I*u-(A*a+C*s+D*u),N=E*a+S*s+D*l-(T*a+w*s+I*l),M=v*n+b*r+E*o-(y*n+A*r+T*o),F=y*i+x*r+S*o-(v*i+C*r+w*o),B=A*i+C*n+D*o-(b*i+x*n+I*o),z=T*i+w*n+I*r-(E*i+S*n+D*r);y=r*u,v=o*l,b=n*u,A=o*s,T=n*l,E=r*s,C=i*u,x=o*a,S=i*l,w=r*a,I=i*s,D=n*a;let U=y*m+A*_+T*g-(v*m+b*_+E*g),k=v*f+C*_+w*g-(y*f+x*_+S*g),V=b*f+x*m+I*g-(A*f+C*m+D*g),H=E*f+S*m+D*_-(T*f+w*m+I*_),G=b*d+E*p+v*h-(T*p+y*h+A*d),j=S*p+y*c+x*d-(C*d+w*p+v*c),W=C*h+D*p+A*c-(I*p+b*c+x*h),q=I*d+T*c+w*h-(S*h+D*d+E*c),Y=i*O+n*L+r*R+o*N;if(Math.abs(Y)<P.EPSILON21){if($.equalsEpsilon($e.getMatrix3(e,uTe),fTe,P.EPSILON7)&&oe.equals($e.getRow(e,3,dTe),hTe))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new ue("matrix is not invertible because its determinate is zero.")}return Y=1/Y,t[0]=O*Y,t[1]=L*Y,t[2]=R*Y,t[3]=N*Y,t[4]=M*Y,t[5]=F*Y,t[6]=B*Y,t[7]=z*Y,t[8]=U*Y,t[9]=k*Y,t[10]=V*Y,t[11]=H*Y,t[12]=G*Y,t[13]=j*Y,t[14]=W*Y,t[15]=q*Y,t},$e.inverseTransformation=function(e,t){let i=e[0],n=e[1],r=e[2],o=e[4],a=e[5],s=e[6],l=e[8],u=e[9],c=e[10],h=e[12],d=e[13],p=e[14],f=-i*h-n*d-r*p,m=-o*h-a*d-s*p,_=-l*h-u*d-c*p;return t[0]=i,t[1]=o,t[2]=l,t[3]=0,t[4]=n,t[5]=a,t[6]=u,t[7]=0,t[8]=r,t[9]=s,t[10]=c,t[11]=0,t[12]=f,t[13]=m,t[14]=_,t[15]=1,t};var mTe=new $e;$e.inverseTranspose=function(e,t){return $e.inverse($e.transpose(e,mTe),t)},$e.IDENTITY=Object.freeze(new $e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),$e.ZERO=Object.freeze(new $e(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),$e.COLUMN0ROW0=0,$e.COLUMN0ROW1=1,$e.COLUMN0ROW2=2,$e.COLUMN0ROW3=3,$e.COLUMN1ROW0=4,$e.COLUMN1ROW1=5,$e.COLUMN1ROW2=6,$e.COLUMN1ROW3=7,$e.COLUMN2ROW0=8,$e.COLUMN2ROW1=9,$e.COLUMN2ROW2=10,$e.COLUMN2ROW3=11,$e.COLUMN3ROW0=12,$e.COLUMN3ROW1=13,$e.COLUMN3ROW2=14,$e.COLUMN3ROW3=15,Object.defineProperties($e.prototype,{length:{get:function(){return $e.packedLength}}}),$e.prototype.clone=function(e){return $e.clone(this,e)},$e.prototype.equals=function(e){return $e.equals(this,e)},$e.equalsArray=function(e,t,i){return e[0]===t[i]&&e[1]===t[i+1]&&e[2]===t[i+2]&&e[3]===t[i+3]&&e[4]===t[i+4]&&e[5]===t[i+5]&&e[6]===t[i+6]&&e[7]===t[i+7]&&e[8]===t[i+8]&&e[9]===t[i+9]&&e[10]===t[i+10]&&e[11]===t[i+11]&&e[12]===t[i+12]&&e[13]===t[i+13]&&e[14]===t[i+14]&&e[15]===t[i+15]},$e.prototype.equalsEpsilon=function(e,t){return $e.equalsEpsilon(this,e,t)},$e.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})\n(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})\n(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})\n(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};var L=$e;function Nn(e,t,i,n){this.west=y(e,0),this.south=y(t,0),this.east=y(i,0),this.north=y(n,0)}Object.defineProperties(Nn.prototype,{width:{get:function(){return Nn.computeWidth(this)}},height:{get:function(){return Nn.computeHeight(this)}}}),Nn.packedLength=4,Nn.pack=function(e,t,i){return i=y(i,0),t[i++]=e.west,t[i++]=e.south,t[i++]=e.east,t[i]=e.north,t},Nn.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Nn),i.west=e[t++],i.south=e[t++],i.east=e[t++],i.north=e[t],i},Nn.computeWidth=function(e){let t=e.east,i=e.west;return t<i&&(t+=P.TWO_PI),t-i},Nn.computeHeight=function(e){return e.north-e.south},Nn.fromDegrees=function(e,t,i,n,r){return e=P.toRadians(y(e,0)),t=P.toRadians(y(t,0)),i=P.toRadians(y(i,0)),n=P.toRadians(y(n,0)),u(r)?(r.west=e,r.south=t,r.east=i,r.north=n,r):new Nn(e,t,i,n)},Nn.fromRadians=function(e,t,i,n,r){return u(r)?(r.west=y(e,0),r.south=y(t,0),r.east=y(i,0),r.north=y(n,0),r):new Nn(e,t,i,n)},Nn.fromCartographicArray=function(e,t){let i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=Number.MAX_VALUE,s=-Number.MAX_VALUE;for(let t=0,l=e.length;t<l;t++){let l=e[t];i=Math.min(i,l.longitude),n=Math.max(n,l.longitude),a=Math.min(a,l.latitude),s=Math.max(s,l.latitude);let u=l.longitude>=0?l.longitude:l.longitude+P.TWO_PI;r=Math.min(r,u),o=Math.max(o,u)}return n-i>o-r&&(i=r,n=o,n>P.PI&&(n-=P.TWO_PI),i>P.PI&&(i-=P.TWO_PI)),u(t)?(t.west=i,t.south=a,t.east=n,t.north=s,t):new Nn(i,a,n,s)},Nn.fromCartesianArray=function(e,t,i){t=y(t,ie.WGS84);let n=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,s=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(let i=0,u=e.length;i<u;i++){let u=t.cartesianToCartographic(e[i]);n=Math.min(n,u.longitude),r=Math.max(r,u.longitude),s=Math.min(s,u.latitude),l=Math.max(l,u.latitude);let c=u.longitude>=0?u.longitude:u.longitude+P.TWO_PI;o=Math.min(o,c),a=Math.max(a,c)}return r-n>a-o&&(n=o,r=a,r>P.PI&&(r-=P.TWO_PI),n>P.PI&&(n-=P.TWO_PI)),u(i)?(i.west=n,i.south=s,i.east=r,i.north=l,i):new Nn(n,s,r,l)},Nn.clone=function(e,t){if(u(e))return u(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new Nn(e.west,e.south,e.east,e.north)},Nn.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e.west-t.west)<=i&&Math.abs(e.south-t.south)<=i&&Math.abs(e.east-t.east)<=i&&Math.abs(e.north-t.north)<=i},Nn.prototype.clone=function(e){return Nn.clone(this,e)},Nn.prototype.equals=function(e){return Nn.equals(this,e)},Nn.equals=function(e,t){return e===t||u(e)&&u(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},Nn.prototype.equalsEpsilon=function(e,t){return Nn.equalsEpsilon(this,e,t)},Nn.validate=function(e){},Nn.southwest=function(e,t){return u(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new fe(e.west,e.south)},Nn.northwest=function(e,t){return u(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new fe(e.west,e.north)},Nn.northeast=function(e,t){return u(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new fe(e.east,e.north)},Nn.southeast=function(e,t){return u(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new fe(e.east,e.south)},Nn.center=function(e,t){let i=e.east,n=e.west;i<n&&(i+=P.TWO_PI);let r=P.negativePiToPi(.5*(n+i)),o=.5*(e.south+e.north);return u(t)?(t.longitude=r,t.latitude=o,t.height=0,t):new fe(r,o)},Nn.intersection=function(e,t,i){let n=e.east,r=e.west,o=t.east,a=t.west;n<r&&o>0?n+=P.TWO_PI:o<a&&n>0&&(o+=P.TWO_PI),n<r&&a<0?a+=P.TWO_PI:o<a&&r<0&&(r+=P.TWO_PI);let s=P.negativePiToPi(Math.max(r,a)),l=P.negativePiToPi(Math.min(n,o));if((e.west<e.east||t.west<t.east)&&l<=s)return;let c=Math.max(e.south,t.south),h=Math.min(e.north,t.north);return c>=h?void 0:u(i)?(i.west=s,i.south=c,i.east=l,i.north=h,i):new Nn(s,c,l,h)},Nn.simpleIntersection=function(e,t,i){let n=Math.max(e.west,t.west),r=Math.max(e.south,t.south),o=Math.min(e.east,t.east),a=Math.min(e.north,t.north);if(!(r>=a||n>=o))return u(i)?(i.west=n,i.south=r,i.east=o,i.north=a,i):new Nn(n,r,o,a)},Nn.union=function(e,t,i){u(i)||(i=new Nn);let n=e.east,r=e.west,o=t.east,a=t.west;n<r&&o>0?n+=P.TWO_PI:o<a&&n>0&&(o+=P.TWO_PI),n<r&&a<0?a+=P.TWO_PI:o<a&&r<0&&(r+=P.TWO_PI);let s=P.negativePiToPi(Math.min(r,a)),l=P.negativePiToPi(Math.max(n,o));return i.west=s,i.south=Math.min(e.south,t.south),i.east=l,i.north=Math.max(e.north,t.north),i},Nn.expand=function(e,t,i){return u(i)||(i=new Nn),i.west=Math.min(e.west,t.longitude),i.south=Math.min(e.south,t.latitude),i.east=Math.max(e.east,t.longitude),i.north=Math.max(e.north,t.latitude),i},Nn.contains=function(e,t){let i=t.longitude,n=t.latitude,r=e.west,o=e.east;return o<r&&(o+=P.TWO_PI,i<0&&(i+=P.TWO_PI)),(i>r||P.equalsEpsilon(i,r,P.EPSILON14))&&(i<o||P.equalsEpsilon(i,o,P.EPSILON14))&&n>=e.south&&n<=e.north};var pTe=new fe;Nn.subsample=function(e,t,i,n){t=y(t,ie.WGS84),i=y(i,0),u(n)||(n=[]);let r=0,o=e.north,a=e.south,s=e.east,l=e.west,c=pTe;c.height=i,c.longitude=l,c.latitude=o,n[r]=t.cartographicToCartesian(c,n[r]),r++,c.longitude=s,n[r]=t.cartographicToCartesian(c,n[r]),r++,c.latitude=a,n[r]=t.cartographicToCartesian(c,n[r]),r++,c.longitude=l,n[r]=t.cartographicToCartesian(c,n[r]),r++,c.latitude=o<0?o:a>0?a:0;for(let i=1;i<8;++i)c.longitude=-Math.PI+i*P.PI_OVER_TWO,Nn.contains(e,c)&&(n[r]=t.cartographicToCartesian(c,n[r]),r++);return 0===c.latitude&&(c.longitude=l,n[r]=t.cartographicToCartesian(c,n[r]),r++,c.longitude=s,n[r]=t.cartographicToCartesian(c,n[r]),r++),n.length=r,n},Nn.subsection=function(e,t,i,n,r,o){if(u(o)||(o=new Nn),e.west<=e.east){let i=e.east-e.west;o.west=e.west+t*i,o.east=e.west+n*i}else{let i=P.TWO_PI+e.east-e.west;o.west=P.negativePiToPi(e.west+t*i),o.east=P.negativePiToPi(e.west+n*i)}let a=e.north-e.south;return o.south=e.south+i*a,o.north=e.south+r*a,1===t&&(o.west=e.east),1===n&&(o.east=e.east),1===i&&(o.south=e.north),1===r&&(o.north=e.north),o},Nn.MAX_VALUE=Object.freeze(new Nn(-Math.PI,-P.PI_OVER_TWO,Math.PI,P.PI_OVER_TWO));var ce=Nn;function dn(e,t){this.center=h.clone(y(e,h.ZERO)),this.radius=y(t,0)}var eH=new h,tH=new h,nH=new h,iH=new h,oH=new h,rH=new h,sH=new h,Ps=new h,aH=new h,cH=new h,lH=new h,uH=new h,_Te=4/3*P.PI;dn.fromPoints=function(e,t){if(u(t)||(t=new dn),!u(e)||0===e.length)return t.center=h.clone(h.ZERO,t.center),t.radius=0,t;let i,n=h.clone(e[0],sH),r=h.clone(n,eH),o=h.clone(n,tH),a=h.clone(n,nH),s=h.clone(n,iH),l=h.clone(n,oH),c=h.clone(n,rH),d=e.length;for(i=1;i<d;i++){h.clone(e[i],n);let t=n.x,u=n.y,d=n.z;t<r.x&&h.clone(n,r),t>s.x&&h.clone(n,s),u<o.y&&h.clone(n,o),u>l.y&&h.clone(n,l),d<a.z&&h.clone(n,a),d>c.z&&h.clone(n,c)}let p=h.magnitudeSquared(h.subtract(s,r,Ps)),f=h.magnitudeSquared(h.subtract(l,o,Ps)),m=h.magnitudeSquared(h.subtract(c,a,Ps)),_=r,g=s,y=p;f>y&&(y=f,_=o,g=l),m>y&&(y=m,_=a,g=c);let v=aH;v.x=.5*(_.x+g.x),v.y=.5*(_.y+g.y),v.z=.5*(_.z+g.z);let b=h.magnitudeSquared(h.subtract(g,v,Ps)),A=Math.sqrt(b),T=cH;T.x=r.x,T.y=o.y,T.z=a.z;let E=lH;E.x=s.x,E.y=l.y,E.z=c.z;let C=h.midpoint(T,E,uH),x=0;for(i=0;i<d;i++){h.clone(e[i],n);let t=h.magnitude(h.subtract(n,C,Ps));t>x&&(x=t);let r=h.magnitudeSquared(h.subtract(n,v,Ps));if(r>b){let e=Math.sqrt(r);A=.5*(A+e),b=A*A;let t=e-A;v.x=(A*v.x+t*n.x)/e,v.y=(A*v.y+t*n.y)/e,v.z=(A*v.z+t*n.z)/e}}return A<x?(h.clone(v,t.center),t.radius=A):(h.clone(C,t.center),t.radius=x),t};var gTe=new Ii,yTe=new h,xTe=new h,Q8=new fe,J8=new fe;dn.fromRectangle2D=function(e,t,i){return dn.fromRectangleWithHeights2D(e,t,0,0,i)},dn.fromRectangleWithHeights2D=function(e,t,i,n,r){if(u(r)||(r=new dn),!u(e))return r.center=h.clone(h.ZERO,r.center),r.radius=0,r;t=y(t,gTe),ce.southwest(e,Q8),Q8.height=i,ce.northeast(e,J8),J8.height=n;let o=t.project(Q8,yTe),a=t.project(J8,xTe),s=a.x-o.x,l=a.y-o.y,c=a.z-o.z;r.radius=.5*Math.sqrt(s*s+l*l+c*c);let d=r.center;return d.x=o.x+.5*s,d.y=o.y+.5*l,d.z=o.z+.5*c,r};var bTe=[];dn.fromRectangle3D=function(e,t,i,n){if(t=y(t,ie.WGS84),i=y(i,0),u(n)||(n=new dn),!u(e))return n.center=h.clone(h.ZERO,n.center),n.radius=0,n;let r=ce.subsample(e,t,i,bTe);return dn.fromPoints(r,n)},dn.fromVertices=function(e,t,i,n){if(u(n)||(n=new dn),!u(e)||0===e.length)return n.center=h.clone(h.ZERO,n.center),n.radius=0,n;t=y(t,h.ZERO),i=y(i,3);let r=sH;r.x=e[0]+t.x,r.y=e[1]+t.y,r.z=e[2]+t.z;let o,a=h.clone(r,eH),s=h.clone(r,tH),l=h.clone(r,nH),c=h.clone(r,iH),d=h.clone(r,oH),p=h.clone(r,rH),f=e.length;for(o=0;o<f;o+=i){let i=e[o]+t.x,n=e[o+1]+t.y,u=e[o+2]+t.z;r.x=i,r.y=n,r.z=u,i<a.x&&h.clone(r,a),i>c.x&&h.clone(r,c),n<s.y&&h.clone(r,s),n>d.y&&h.clone(r,d),u<l.z&&h.clone(r,l),u>p.z&&h.clone(r,p)}let m=h.magnitudeSquared(h.subtract(c,a,Ps)),_=h.magnitudeSquared(h.subtract(d,s,Ps)),g=h.magnitudeSquared(h.subtract(p,l,Ps)),v=a,b=c,A=m;_>A&&(A=_,v=s,b=d),g>A&&(A=g,v=l,b=p);let T=aH;T.x=.5*(v.x+b.x),T.y=.5*(v.y+b.y),T.z=.5*(v.z+b.z);let E=h.magnitudeSquared(h.subtract(b,T,Ps)),C=Math.sqrt(E),x=cH;x.x=a.x,x.y=s.y,x.z=l.z;let S=lH;S.x=c.x,S.y=d.y,S.z=p.z;let w=h.midpoint(x,S,uH),I=0;for(o=0;o<f;o+=i){r.x=e[o]+t.x,r.y=e[o+1]+t.y,r.z=e[o+2]+t.z;let i=h.magnitude(h.subtract(r,w,Ps));i>I&&(I=i);let n=h.magnitudeSquared(h.subtract(r,T,Ps));if(n>E){let e=Math.sqrt(n);C=.5*(C+e),E=C*C;let t=e-C;T.x=(C*T.x+t*r.x)/e,T.y=(C*T.y+t*r.y)/e,T.z=(C*T.z+t*r.z)/e}}return C<I?(h.clone(T,n.center),n.radius=C):(h.clone(w,n.center),n.radius=I),n},dn.fromEncodedCartesianVertices=function(e,t,i){if(u(i)||(i=new dn),!u(e)||!u(t)||e.length!==t.length||0===e.length)return i.center=h.clone(h.ZERO,i.center),i.radius=0,i;let n=sH;n.x=e[0]+t[0],n.y=e[1]+t[1],n.z=e[2]+t[2];let r,o=h.clone(n,eH),a=h.clone(n,tH),s=h.clone(n,nH),l=h.clone(n,iH),c=h.clone(n,oH),d=h.clone(n,rH),p=e.length;for(r=0;r<p;r+=3){let i=e[r]+t[r],u=e[r+1]+t[r+1],p=e[r+2]+t[r+2];n.x=i,n.y=u,n.z=p,i<o.x&&h.clone(n,o),i>l.x&&h.clone(n,l),u<a.y&&h.clone(n,a),u>c.y&&h.clone(n,c),p<s.z&&h.clone(n,s),p>d.z&&h.clone(n,d)}let f=h.magnitudeSquared(h.subtract(l,o,Ps)),m=h.magnitudeSquared(h.subtract(c,a,Ps)),_=h.magnitudeSquared(h.subtract(d,s,Ps)),g=o,y=l,v=f;m>v&&(v=m,g=a,y=c),_>v&&(v=_,g=s,y=d);let b=aH;b.x=.5*(g.x+y.x),b.y=.5*(g.y+y.y),b.z=.5*(g.z+y.z);let A=h.magnitudeSquared(h.subtract(y,b,Ps)),T=Math.sqrt(A),E=cH;E.x=o.x,E.y=a.y,E.z=s.z;let C=lH;C.x=l.x,C.y=c.y,C.z=d.z;let x=h.midpoint(E,C,uH),S=0;for(r=0;r<p;r+=3){n.x=e[r]+t[r],n.y=e[r+1]+t[r+1],n.z=e[r+2]+t[r+2];let i=h.magnitude(h.subtract(n,x,Ps));i>S&&(S=i);let o=h.magnitudeSquared(h.subtract(n,b,Ps));if(o>A){let e=Math.sqrt(o);T=.5*(T+e),A=T*T;let t=e-T;b.x=(T*b.x+t*n.x)/e,b.y=(T*b.y+t*n.y)/e,b.z=(T*b.z+t*n.z)/e}}return T<S?(h.clone(b,i.center),i.radius=T):(h.clone(x,i.center),i.radius=S),i},dn.fromCornerPoints=function(e,t,i){u(i)||(i=new dn);let n=h.midpoint(e,t,i.center);return i.radius=h.distance(n,t),i},dn.fromEllipsoid=function(e,t){return u(t)||(t=new dn),h.clone(h.ZERO,t.center),t.radius=e.maximumRadius,t};var TTe=new h;dn.fromBoundingSpheres=function(e,t){if(u(t)||(t=new dn),!u(e)||0===e.length)return t.center=h.clone(h.ZERO,t.center),t.radius=0,t;let i=e.length;if(1===i)return dn.clone(e[0],t);if(2===i)return dn.union(e[0],e[1],t);let n,r=[];for(n=0;n<i;n++)r.push(e[n].center);let o=(t=dn.fromPoints(r,t)).center,a=t.radius;for(n=0;n<i;n++){let t=e[n];a=Math.max(a,h.distance(o,t.center,TTe)+t.radius)}return t.radius=a,t};var ATe=new h,CTe=new h,ETe=new h;dn.fromOrientedBoundingBox=function(e,t){u(t)||(t=new dn);let i=e.halfAxes,n=$.getColumn(i,0,ATe),r=$.getColumn(i,1,CTe),o=$.getColumn(i,2,ETe);return h.add(n,r,n),h.add(n,o,n),t.center=h.clone(e.center,t.center),t.radius=h.magnitude(n),t};var STe=new h,wTe=new h;dn.fromTransformation=function(e,t){u(t)||(t=new dn);let i=L.getTranslation(e,STe),n=L.getScale(e,wTe),r=.5*h.magnitude(n);return t.center=h.clone(i,t.center),t.radius=r,t},dn.clone=function(e,t){if(u(e))return u(t)?(t.center=h.clone(e.center,t.center),t.radius=e.radius,t):new dn(e.center,e.radius)},dn.packedLength=4,dn.pack=function(e,t,i){i=y(i,0);let n=e.center;return t[i++]=n.x,t[i++]=n.y,t[i++]=n.z,t[i]=e.radius,t},dn.unpack=function(e,t,i){t=y(t,0),u(i)||(i=new dn);let n=i.center;return n.x=e[t++],n.y=e[t++],n.z=e[t++],i.radius=e[t],i};var vTe=new h,DTe=new h;dn.union=function(e,t,i){u(i)||(i=new dn);let n=e.center,r=e.radius,o=t.center,a=t.radius,s=h.subtract(o,n,vTe),l=h.magnitude(s);if(r>=l+a)return e.clone(i),i;if(a>=l+r)return t.clone(i),i;let c=.5*(r+l+a),d=h.multiplyByScalar(s,(-r+c)/l,DTe);return h.add(d,n,d),h.clone(d,i.center),i.radius=c,i};var ITe=new h;dn.expand=function(e,t,i){i=dn.clone(e,i);let n=h.magnitude(h.subtract(t,i.center,ITe));return n>i.radius&&(i.radius=n),i},dn.intersectPlane=function(e,t){let i=e.center,n=e.radius,r=t.normal,o=h.dot(r,i)+t.distance;return o<-n?Zt.OUTSIDE:o<n?Zt.INTERSECTING:Zt.INSIDE},dn.transform=function(e,t,i){return u(i)||(i=new dn),i.center=L.multiplyByPoint(t,e.center,i.center),i.radius=L.getMaximumScale(t)*e.radius,i};var PTe=new h;dn.distanceSquaredTo=function(e,t){let i=h.subtract(e.center,t,PTe),n=h.magnitude(i)-e.radius;return n<=0?0:n*n},dn.transformWithoutScale=function(e,t,i){return u(i)||(i=new dn),i.center=L.multiplyByPoint(t,e.center,i.center),i.radius=e.radius,i};var OTe=new h;dn.computePlaneDistances=function(e,t,i,n){u(n)||(n=new Uc);let r=h.subtract(e.center,t,OTe),o=h.dot(i,r);return n.start=o-e.radius,n.stop=o+e.radius,n};var FX=new h,RTe=new h,MTe=new h,LTe=new h,NTe=new h,FTe=new fe,BX=new Array(8);for(let e=0;e<8;++e)BX[e]=new h;var BTe=new Ii;dn.projectTo2D=function(e,t,i){let n,r=(t=y(t,BTe)).ellipsoid,o=e.center,a=e.radius;n=h.equals(o,h.ZERO)?h.clone(h.UNIT_X,FX):r.geodeticSurfaceNormal(o,FX);let s=h.cross(h.UNIT_Z,n,RTe);h.normalize(s,s);let l=h.cross(n,s,MTe);h.normalize(l,l),h.multiplyByScalar(n,a,n),h.multiplyByScalar(l,a,l),h.multiplyByScalar(s,a,s);let u=h.negate(l,NTe),c=h.negate(s,LTe),d=BX,p=d[0];h.add(n,l,p),h.add(p,s,p),p=d[1],h.add(n,l,p),h.add(p,c,p),p=d[2],h.add(n,u,p),h.add(p,c,p),p=d[3],h.add(n,u,p),h.add(p,s,p),h.negate(n,n),p=d[4],h.add(n,l,p),h.add(p,s,p),p=d[5],h.add(n,l,p),h.add(p,c,p),p=d[6],h.add(n,u,p),h.add(p,c,p),p=d[7],h.add(n,u,p),h.add(p,s,p);let f=d.length;for(let e=0;e<f;++e){let i=d[e];h.add(o,i,i);let n=r.cartesianToCartographic(i,FTe);t.project(n,i)}o=(i=dn.fromPoints(d,i)).center;let m=o.x,_=o.y,g=o.z;return o.x=g,o.y=m,o.z=_,i},dn.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)},dn.equals=function(e,t){return e===t||u(e)&&u(t)&&h.equals(e.center,t.center)&&e.radius===t.radius},dn.prototype.intersectPlane=function(e){return dn.intersectPlane(this,e)},dn.prototype.distanceSquaredTo=function(e){return dn.distanceSquaredTo(this,e)},dn.prototype.computePlaneDistances=function(e,t,i){return dn.computePlaneDistances(this,e,t,i)},dn.prototype.isOccluded=function(e){return dn.isOccluded(this,e)},dn.prototype.equals=function(e){return dn.equals(this,e)},dn.prototype.clone=function(e){return dn.clone(this,e)},dn.prototype.volume=function(){let e=this.radius;return _Te*e*e*e};var se=dn,WX=or(Sl(),1);function fH(e,t){let i;return typeof document<"u"&&(i=document),fH._implementation(e,t,i)}fH._implementation=function(e,t,i){if(!u(t)){if(typeof i>"u")return e;t=y(i.baseURI,i.location.href)}let n=new WX.default(e);return""!==n.scheme()?n.toString():n.absoluteTo(t).toString()};var Sm=fH,iK=or(Sl(),1);function jX(e,t){if(null===e||"object"!=typeof e)return e;t=y(t,!1);let i=new e.constructor;for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t&&(r=jX(r,t)),i[n]=r}return i}var Ge=jX;function qX(e,t,i){i=y(i,!1);let n,r,o,a={},s=u(e),l=u(t);if(s)for(n in e)e.hasOwnProperty(n)&&(r=e[n],l&&i&&"object"==typeof r&&t.hasOwnProperty(n)?(o=t[n],a[n]="object"==typeof o?qX(r,o,i):r):a[n]=r);if(l)for(n in t)t.hasOwnProperty(n)&&!a.hasOwnProperty(n)&&(o=t[n],a[n]=o);return a}var gt=qX;function kTe(){let e,t,i=new Promise((function(i,n){e=i,t=n}));return{resolve:e,reject:t,promise:i}}var wl=kTe,YX=or(Sl(),1);function VTe(e,t){let i="",n=e.lastIndexOf("/");return-1!==n&&(i=e.substring(0,n+1)),t&&(0!==(e=new YX.default(e)).query().length&&(i+=`?${e.query()}`),0!==e.fragment().length&&(i+=`#${e.fragment()}`)),i}var nP=VTe,XX=or(Sl(),1);function UTe(e){let t=new XX.default(e);t.normalize();let i=t.path(),n=i.lastIndexOf("/");return-1!==n&&(i=i.substr(n+1)),n=i.lastIndexOf("."),i=-1===n?"":i.substr(n+1),i}var Cb=UTe,KX={};function zTe(e,t,i){u(t)||(t=e.width),u(i)||(i=e.height);let n=KX[t];u(n)||(n={},KX[t]=n);let r=n[i];if(!u(r)){let e=document.createElement("canvas");e.width=t,e.height=i,r=e.getContext("2d",{willReadFrequently:!0}),r.globalCompositeOperation="copy",n[i]=r}return r.drawImage(e,0,0,t,i),r.getImageData(0,0,t,i).data}var Qd=zTe,HTe=/^blob:/i;function GTe(e){return HTe.test(e)}var Eb=GTe,Jd;function WTe(e){u(Jd)||(Jd=document.createElement("a")),Jd.href=window.location.href;let t=Jd.host,i=Jd.protocol;return Jd.href=e,Jd.href=Jd.href,i!==Jd.protocol||t!==Jd.host}var Sb=WTe,jTe=/^data:/i;function qTe(e){return jTe.test(e)}var t_=qTe;function YTe(e){let t=document.createElement("script");return t.async=!0,t.src=e,new Promise(((e,i)=>{window.crossOriginIsolated&&t.setAttribute("crossorigin","anonymous");let n=document.getElementsByTagName("head")[0];t.onload=function(){t.onload=void 0,n.removeChild(t),e()},t.onerror=function(e){i(e)},n.appendChild(t)}))}var wb=YTe;function XTe(e){let t="";for(let i in e)if(e.hasOwnProperty(i)){let n=e[i],r=`${encodeURIComponent(i)}=`;if(Array.isArray(n))for(let e=0,i=n.length;e<i;++e)t+=`${r+encodeURIComponent(n[e])}&`;else t+=`${r+encodeURIComponent(n)}&`}return t=t.slice(0,-1),t}var vb=XTe;function KTe(e){let t={};if(""===e)return t;let i=e.replace(/\+/g,"%20").split(/[&;]/);for(let e=0,n=i.length;e<n;++e){let n=i[e].split("="),r=decodeURIComponent(n[0]),o=n[1];o=u(o)?decodeURIComponent(o):"";let a=t[r];"string"==typeof a?t[r]=[a,o]:Array.isArray(a)?a.push(o):t[r]=o}return t}var wu=KTe,ZTe={UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5},Qn=Object.freeze(ZTe),$Te={TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3},Jr=Object.freeze($Te);function iP(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.throttleByServer,!1),i=y(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=y(e.priority,0),this.throttle=i,this.throttleByServer=t,this.type=y(e.type,Jr.OTHER),this.serverKey=e.serverKey,this.state=Qn.UNISSUED,this.deferred=void 0,this.cancelled=!1}iP.prototype.cancel=function(){this.cancelled=!0},iP.prototype.clone=function(e){return u(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=Qn.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new iP(this)};var Ko=iP;function QTe(e){let t={};if(!e)return t;let i=e.split("\r\n");for(let e=0;e<i.length;++e){let n=i[e],r=n.indexOf(": ");if(r>0){let e=n.substring(0,r),i=n.substring(r+2);t[e]=i}}return t}var oP=QTe;function ZX(e,t,i){this.statusCode=e,this.response=t,this.responseHeaders=i,"string"==typeof this.responseHeaders&&(this.responseHeaders=oP(this.responseHeaders))}ZX.prototype.toString=function(){let e="Request has failed.";return u(this.statusCode)&&(e+=` Status Code: ${this.statusCode}`),e};var wm=ZX,sP=or(Sl(),1);function jE(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function JTe(e,t){return t-e}Object.defineProperties(jE.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),jE.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);let i=this;return function(){i.removeEventListener(e,t)}},jE.prototype.removeEventListener=function(e,t){let i=this._listeners,n=this._scopes,r=-1;for(let o=0;o<i.length;o++)if(i[o]===e&&n[o]===t){r=o;break}return-1!==r&&(this._insideRaiseEvent?(this._toRemove.push(r),i[r]=void 0,n[r]=void 0):(i.splice(r,1),n.splice(r,1)),!0)},jE.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;let e,t=this._listeners,i=this._scopes,n=t.length;for(e=0;e<n;e++){let n=t[e];u(n)&&t[e].apply(i[e],arguments)}let r=this._toRemove;if(n=r.length,n>0){for(r.sort(JTe),e=0;e<n;e++){let n=r[e];t.splice(n,1),i.splice(n,1)}r.length=0}this._insideRaiseEvent=!1};var pe=jE;function jy(e){this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function dH(e,t,i){let n=e[t];e[t]=e[i],e[i]=n}Object.defineProperties(jy.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){let t=this._length;if(e<t){let i=this._array;for(let n=e;n<t;++n)i[n]=void 0;this._length=e,i.length=e}this._maximumLength=e}},comparator:{get:function(){return this._comparator}}}),jy.prototype.reserve=function(e){e=y(e,this._length),this._array.length=e},jy.prototype.heapify=function(e){e=y(e,0);let t=this._length,i=this._comparator,n=this._array,r=-1,o=!0;for(;o;){let a=2*(e+1),s=a-1;r=s<t&&i(n[s],n[e])<0?s:e,a<t&&i(n[a],n[r])<0&&(r=a),r!==e?(dH(n,r,e),e=r):o=!1}},jy.prototype.resort=function(){let e=this._length;for(let t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},jy.prototype.insert=function(e){let t,i=this._array,n=this._comparator,r=this._maximumLength,o=this._length++;for(o<i.length?i[o]=e:i.push(e);0!==o;){let e=Math.floor((o-1)/2);if(!(n(i[o],i[e])<0))break;dH(i,o,e),o=e}return u(r)&&this._length>r&&(t=i[r],this._length=r),t},jy.prototype.pop=function(e){if(e=y(e,0),0===this._length)return;let t=this._array,i=t[e];return dH(t,e,--this._length),this.heapify(e),t[this._length]=void 0,i};var rP=jy;function eAe(e,t){return e.priority-t.priority}var Xi={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},Db=20,Ca=new rP({comparator:eAe});Ca.maximumLength=Db,Ca.reserve(Db);var eh=[],vm={},tAe=typeof document<"u"?new sP.default(document.location.href):new sP.default,aP=new pe;function No(){}function $X(e){u(e.priorityFunction)&&(e.priority=e.priorityFunction())}function QX(e){return e.state===Qn.UNISSUED&&(e.state=Qn.ISSUED,e.deferred=wl()),e.deferred.promise}function nAe(e){return function(t){if(e.state===Qn.CANCELLED)return;let i=e.deferred;--Xi.numberOfActiveRequests,--vm[e.serverKey],aP.raiseEvent(),e.state=Qn.RECEIVED,e.deferred=void 0,i.resolve(t)}}function iAe(e){return function(t){e.state!==Qn.CANCELLED&&(++Xi.numberOfFailedRequests,--Xi.numberOfActiveRequests,--vm[e.serverKey],aP.raiseEvent(t),e.state=Qn.FAILED,e.deferred.reject(t))}}function JX(e){let t=QX(e);return e.state=Qn.ACTIVE,eh.push(e),++Xi.numberOfActiveRequests,++Xi.numberOfActiveRequestsEver,++vm[e.serverKey],e.requestFunction().then(nAe(e)).catch(iAe(e)),t}function qy(e){let t=e.state===Qn.ACTIVE;if(e.state=Qn.CANCELLED,++Xi.numberOfCancelledRequests,u(e.deferred)){let t=e.deferred;e.deferred=void 0,t.reject()}t&&(--Xi.numberOfActiveRequests,--vm[e.serverKey],++Xi.numberOfCancelledActiveRequests),u(e.cancelFunction)&&e.cancelFunction()}function oAe(){No.debugShowStatistics&&(0===Xi.numberOfActiveRequests&&Xi.lastNumberOfActiveRequests>0&&(Xi.numberOfAttemptedRequests>0&&(console.log(`Number of attempted requests: ${Xi.numberOfAttemptedRequests}`),Xi.numberOfAttemptedRequests=0),Xi.numberOfCancelledRequests>0&&(console.log(`Number of cancelled requests: ${Xi.numberOfCancelledRequests}`),Xi.numberOfCancelledRequests=0),Xi.numberOfCancelledActiveRequests>0&&(console.log(`Number of cancelled active requests: ${Xi.numberOfCancelledActiveRequests}`),Xi.numberOfCancelledActiveRequests=0),Xi.numberOfFailedRequests>0&&(console.log(`Number of failed requests: ${Xi.numberOfFailedRequests}`),Xi.numberOfFailedRequests=0)),Xi.lastNumberOfActiveRequests=Xi.numberOfActiveRequests)}No.maximumRequests=50,No.maximumRequestsPerServer=6,No.requestsByServer={"api.cesium.com:443":18,"assets.ion.cesium.com:443":18,"ibasemaps-api.arcgis.com:443":18,"tile.googleapis.com:443":18,"tile.openstreetmap.org:443":18},No.throttleRequests=!0,No.debugShowStatistics=!1,No.requestCompletedEvent=aP,Object.defineProperties(No,{statistics:{get:function(){return Xi}},priorityHeapLength:{get:function(){return Db},set:function(e){if(e<Db)for(;Ca.length>e;){qy(Ca.pop())}Db=e,Ca.maximumLength=e,Ca.reserve(e)}}}),No.serverHasOpenSlots=function(e,t){t=y(t,1);let i=y(No.requestsByServer[e],No.maximumRequestsPerServer);return vm[e]+t<=i},No.heapHasOpenSlots=function(e){return Ca.length+e<=Db},No.update=function(){let e,t,i=0,n=eh.length;for(e=0;e<n;++e)t=eh[e],t.cancelled&&qy(t),t.state===Qn.ACTIVE?i>0&&(eh[e-i]=t):++i;eh.length-=i;let r=Ca.internalArray,o=Ca.length;for(e=0;e<o;++e)$X(r[e]);Ca.resort();let a=Math.max(No.maximumRequests-eh.length,0),s=0;for(;s<a&&Ca.length>0;)t=Ca.pop(),t.cancelled?qy(t):!t.throttleByServer||No.serverHasOpenSlots(t.serverKey)?(JX(t),++s):qy(t);oAe()},No.getServerKey=function(e){let t=new sP.default(e);""===t.scheme()&&(t=t.absoluteTo(tAe),t.normalize());let i=t.authority();/:/.test(i)||(i=`${i}:${"https"===t.scheme()?"443":"80"}`);let n=vm[i];return u(n)||(vm[i]=0),i},No.request=function(e){if(t_(e.url)||Eb(e.url))return aP.raiseEvent(),e.state=Qn.RECEIVED,e.requestFunction();if(++Xi.numberOfAttemptedRequests,u(e.serverKey)||(e.serverKey=No.getServerKey(e.url)),No.throttleRequests&&e.throttleByServer&&!No.serverHasOpenSlots(e.serverKey))return;if(!No.throttleRequests||!e.throttle)return JX(e);if(eh.length>=No.maximumRequests)return;$X(e);let t=Ca.insert(e);if(u(t)){if(t===e)return;qy(t)}return QX(e)},No.clearForSpecs=function(){for(;Ca.length>0;){qy(Ca.pop())}let e=eh.length;for(let t=0;t<e;++t)qy(eh[t]);eh.length=0,vm={},Xi.numberOfAttemptedRequests=0,Xi.numberOfActiveRequests=0,Xi.numberOfCancelledRequests=0,Xi.numberOfCancelledActiveRequests=0,Xi.numberOfFailedRequests=0,Xi.numberOfActiveRequestsEver=0,Xi.lastNumberOfActiveRequests=0},No.numberOfActiveRequestsByServer=function(e){return vm[e]},No.requestHeap=Ca;var nc=No,eK=or(Sl(),1),qE={},Ib={};function rAe(e){let t=new eK.default(e);t.normalize();let i=t.authority();if(0!==i.length){if(t.authority(i),-1!==i.indexOf("@")&&(i=i.split("@")[1]),-1===i.indexOf(":")){let e=t.scheme();if(0===e.length&&(e=window.location.protocol,e=e.substring(0,e.length-1)),"http"===e)i+=":80";else{if("https"!==e)return;i+=":443"}}return i}}qE.add=function(e,t){let i=`${e.toLowerCase()}:${t}`;u(Ib[i])||(Ib[i]=!0)},qE.remove=function(e,t){let i=`${e.toLowerCase()}:${t}`;u(Ib[i])&&delete Ib[i]},qE.contains=function(e){let t=rAe(e);return!(!u(t)||!u(Ib[t]))},qE.clear=function(){Ib={}};var YE=qE,oK=function(){try{let e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch{return!1}}(),Pb;function At(e){"string"==typeof(e=y(e,y.EMPTY_OBJECT))&&(e={url:e}),this._url=void 0,this._templateValues=th(e.templateValues,{}),this._queryParameters=th(e.queryParameters,{}),this.headers=th(e.headers,{}),this.request=y(e.request,new Ko),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=y(e.retryAttempts,0),this._retryCount=0,y(e.parseUrl,!0)?this.parseUrl(e.url,!0,!0):this._url=e.url,this._credits=e.credits}function th(e,t){return u(e)?Ge(e):t}function sAe(e){return 0===e.length?{}:-1===e.indexOf("=")?{[e]:void 0}:wu(e)}function lP(e,t,i){if(!i)return gt(e,t);let n=Ge(e,!0);for(let e in t)if(t.hasOwnProperty(e)){let i=n[e],r=t[e];u(i)?(Array.isArray(i)||(i=n[e]=[i]),n[e]=i.concat(r)):n[e]=Array.isArray(r)?r.slice():r}return n}function aAe(e){let t=Object.keys(e);return 0===t.length?"":1!==t.length||u(e[t[0]])?`?${vb(e)}`:`?${t[0]}`}function hH(e){let t=e.resource,i=e.flipY,n=e.skipColorSpaceConversion,r=e.preferImageBitmap,o=t.request;o.url=t.url,o.requestFunction=function(){let e=!1;!t.isDataUri&&!t.isBlobUri&&(e=t.isCrossOriginUrl);let a=wl();return At._Implementations.createImage(o,e,a,i,n,r),a.promise};let a=nc.request(o);if(u(a))return a.catch((function(e){return o.state!==Qn.FAILED?Promise.reject(e):t.retryOnError(e).then((function(a){return a?(o.state=Qn.UNISSUED,o.deferred=void 0,hH({resource:t,flipY:i,skipColorSpaceConversion:n,preferImageBitmap:r})):Promise.reject(e)}))}))}function rK(e,t,i){let n={};n[t]=i,e.setQueryParameters(n);let r=e.request,o=e.url;r.url=o,r.requestFunction=function(){let e=wl();return window[i]=function(t){e.resolve(t);try{delete window[i]}catch{window[i]=void 0}},At._Implementations.loadAndExecuteScript(o,i,e),e.promise};let a=nc.request(r);if(u(a))return a.catch((function(n){return r.state!==Qn.FAILED?Promise.reject(n):e.retryOnError(n).then((function(o){return o?(r.state=Qn.UNISSUED,r.deferred=void 0,rK(e,t,i)):Promise.reject(n)}))}))}function mH(e){if(e.state===Qn.ISSUED||e.state===Qn.ACTIVE)throw new ue("The Resource is already being fetched.");e.state=Qn.UNISSUED,e.deferred=void 0}At.createIfNeeded=function(e){return e instanceof At?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new At({url:e})},At.supportsImageBitmapOptions=function(){if(u(Pb))return Pb;if("function"!=typeof createImageBitmap)return Pb=Promise.resolve(!1);return Pb=At.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAABGdBTUEAAE4g3rEiDgAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAADElEQVQI12Ng6GAAAAEUAIngE3ZiAAAAAElFTkSuQmCC"}).then((function(e){return Promise.all([createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none",colorSpaceConversion:"none"}),createImageBitmap(e)])})).then((function(e){let t=Qd(e[0]),i=Qd(e[1]);return t[1]!==i[1]})).catch((function(){return!1}))},Object.defineProperties(At,{isBlobSupported:{get:function(){return oK}}}),Object.defineProperties(At.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){this.parseUrl(e,!1,!1)}},extension:{get:function(){return Cb(this._url)}},isDataUri:{get:function(){return t_(this._url)}},isBlobUri:{get:function(){return Eb(this._url)}},isCrossOriginUrl:{get:function(){return Sb(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}},credits:{get:function(){return this._credits}}}),At.prototype.toString=function(){return this.getUrlComponent(!0,!0)},At.prototype.parseUrl=function(e,t,i,n){let r=new iK.default(e),o=sAe(r.query());this._queryParameters=t?lP(o,this.queryParameters,i):o,r.search(""),r.fragment(""),u(n)&&""===r.scheme()&&(r=r.absoluteTo(Sm(n))),this._url=r.toString()},At.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;let i=this._url;e&&(i=`${i}${aAe(this.queryParameters)}`),i=i.replace(/%7B/g,"{").replace(/%7D/g,"}");let n=this._templateValues;return Object.keys(n).length>0&&(i=i.replace(/{(.*?)}/g,(function(e,t){let i=n[t];return u(i)?encodeURIComponent(i):e}))),t&&u(this.proxy)&&(i=this.proxy.getURL(i)),i},At.prototype.setQueryParameters=function(e,t){this._queryParameters=t?lP(this._queryParameters,e,!1):lP(e,this._queryParameters,!1)},At.prototype.appendQueryParameters=function(e){this._queryParameters=lP(e,this._queryParameters,!0)},At.prototype.setTemplateValues=function(e,t){this._templateValues=t?gt(this._templateValues,e):gt(e,this._templateValues)},At.prototype.getDerivedResource=function(e){let t=this.clone();if(t._retryCount=0,u(e.url)){let i=y(e.preserveQueryParameters,!1);t.parseUrl(e.url,!0,i,this._url)}return u(e.queryParameters)&&(t._queryParameters=gt(e.queryParameters,t.queryParameters)),u(e.templateValues)&&(t._templateValues=gt(e.templateValues,t.templateValues)),u(e.headers)&&(t.headers=gt(e.headers,t.headers)),u(e.proxy)&&(t.proxy=e.proxy),u(e.request)&&(t.request=e.request),u(e.retryCallback)&&(t.retryCallback=e.retryCallback),u(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},At.prototype.retryOnError=function(e){let t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return Promise.resolve(!1);let i=this;return Promise.resolve(t(this,e)).then((function(e){return++i._retryCount,e}))},At.prototype.clone=function(e){return u(e)?(e._url=this._url,e._queryParameters=Ge(this._queryParameters),e._templateValues=Ge(this._templateValues),e.headers=Ge(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e):new At({url:this._url,queryParameters:this.queryParameters,templateValues:this.templateValues,headers:this.headers,proxy:this.proxy,retryCallback:this.retryCallback,retryAttempts:this.retryAttempts,request:this.request.clone(),parseUrl:!1,credits:u(this.credits)?this.credits.slice():void 0})},At.prototype.getBaseUri=function(e){return nP(this.getUrlComponent(e),e)},At.prototype.appendForwardSlash=function(){this._url=jI(this._url)},At.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},At.fetchArrayBuffer=function(e){return new At(e).fetchArrayBuffer()},At.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},At.fetchBlob=function(e){return new At(e).fetchBlob()},At.prototype.fetchImage=function(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.preferImageBitmap,!1),i=y(e.preferBlob,!1),n=y(e.flipY,!1),r=y(e.skipColorSpaceConversion,!1);if(mH(this.request),!oK||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!i)return hH({resource:this,flipY:n,skipColorSpaceConversion:r,preferImageBitmap:t});let o,a,s,l,c=this.fetchBlob();return u(c)?At.supportsImageBitmapOptions().then((function(e){return o=e,a=o&&t,c})).then((function(e){if(!u(e))return;if(l=e,a)return At.createImageBitmapFromBlob(e,{flipY:n,premultiplyAlpha:!1,skipColorSpaceConversion:r});let t=window.URL.createObjectURL(e);return s=new At({url:t}),hH({resource:s,flipY:n,skipColorSpaceConversion:r,preferImageBitmap:!1})})).then((function(e){if(u(e))return e.blob=l,a||window.URL.revokeObjectURL(s.url),e})).catch((function(e){return u(s)&&window.URL.revokeObjectURL(s.url),e.blob=l,Promise.reject(e)})):void 0},At.fetchImage=function(e){return new At(e).fetchImage({flipY:e.flipY,skipColorSpaceConversion:e.skipColorSpaceConversion,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},At.prototype.fetchText=function(){return this.fetch({responseType:"text"})},At.fetchText=function(e){return new At(e).fetchText()},At.prototype.fetchJson=function(){let e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(u(e))return e.then((function(e){if(u(e))return JSON.parse(e)}))},At.fetchJson=function(e){return new At(e).fetchJson()},At.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},At.fetchXML=function(e){return new At(e).fetchXML()},At.prototype.fetchJsonp=function(e){let t;e=y(e,"callback"),mH(this.request);do{t=`loadJsonp${P.nextRandomNumber().toString().substring(2,8)}`}while(u(window[t]));return rK(this,e,t)},At.fetchJsonp=function(e){return new At(e).fetchJsonp(e.callbackParameterName)},At.prototype._makeRequest=function(e){let t=this;mH(t.request);let i=t.request,n=t.url;i.url=n,i.requestFunction=function(){let r=e.responseType,o=gt(e.headers,t.headers),a=e.overrideMimeType,s=e.method,l=e.data,c=wl(),h=At._Implementations.loadWithXhr(n,r,s,l,o,c,a);return u(h)&&u(h.abort)&&(i.cancelFunction=function(){h.abort()}),c.promise};let r=nc.request(i);if(u(r))return r.then((function(e){return i.cancelFunction=void 0,e})).catch((function(n){return i.cancelFunction=void 0,i.state!==Qn.FAILED?Promise.reject(n):t.retryOnError(n).then((function(r){return r?(i.state=Qn.UNISSUED,i.deferred=void 0,t.fetch(e)):Promise.reject(n)}))}))};var cAe=/^data:(.*?)(;base64)?,(.*)$/;function cP(e,t){let i=decodeURIComponent(t);return e?atob(i):i}function tK(e,t){let i=cP(e,t),n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);return n}function lAe(e,t){t=y(t,"");let i,n,r=e[1],o=!!e[2],a=e[3];switch(t){case"":case"text":return cP(o,a);case"arraybuffer":return tK(o,a);case"blob":return i=tK(o,a),new Blob([i],{type:r});case"document":return n=new DOMParser,n.parseFromString(cP(o,a),r);case"json":return JSON.parse(cP(o,a))}}function nK(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}function uAe(e,t,i,n,r,o,a){let s,l;Promise.all([Promise.all([__webpack_require__.e(575),__webpack_require__.e(654)]).then(__webpack_require__.t.bind(__webpack_require__,8575,19)),Promise.all([__webpack_require__.e(258),__webpack_require__.e(635),__webpack_require__.e(113)]).then(__webpack_require__.t.bind(__webpack_require__,2635,23))]).then((([t,i])=>(s=t.parse(e),l=i,"https:"===s.protocol?Promise.all([__webpack_require__.e(575),__webpack_require__.e(258),__webpack_require__.e(501),__webpack_require__.e(773)]).then(__webpack_require__.t.bind(__webpack_require__,9267,23)):Promise.all([__webpack_require__.e(575),__webpack_require__.e(258),__webpack_require__.e(501),__webpack_require__.e(204)]).then(__webpack_require__.t.bind(__webpack_require__,8501,23))))).then((e=>{let n={protocol:s.protocol,hostname:s.hostname,port:s.port,path:s.path,query:s.query,method:i,headers:r};e.request(n).on("response",(function(e){if(e.statusCode<200||e.statusCode>=300)return void o.reject(new wm(e.statusCode,e,e.headers));let i=[];e.on("data",(function(e){i.push(e)})),e.on("end",(function(){let n=Buffer.concat(i);"gzip"===e.headers["content-encoding"]?l.gunzip(n,(function(e,i){e?o.reject(new ue("Error decompressing response.")):o.resolve(nK(i,t))})):o.resolve(nK(n,t))}))})).on("error",(function(e){o.reject(new wm)})).end()}))}At.prototype.fetch=function(e){return(e=th(e,{})).method="GET",this._makeRequest(e)},At.fetch=function(e){return new At(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},At.prototype.delete=function(e){return(e=th(e,{})).method="DELETE",this._makeRequest(e)},At.delete=function(e){return new At(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},At.prototype.head=function(e){return(e=th(e,{})).method="HEAD",this._makeRequest(e)},At.head=function(e){return new At(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},At.prototype.options=function(e){return(e=th(e,{})).method="OPTIONS",this._makeRequest(e)},At.options=function(e){return new At(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},At.prototype.post=function(e,t){return El.defined("data",e),(t=th(t,{})).method="POST",t.data=e,this._makeRequest(t)},At.post=function(e){return new At(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},At.prototype.put=function(e,t){return El.defined("data",e),(t=th(t,{})).method="PUT",t.data=e,this._makeRequest(t)},At.put=function(e){return new At(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},At.prototype.patch=function(e,t){return El.defined("data",e),(t=th(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},At.patch=function(e){return new At(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},At._Implementations={},At._Implementations.loadImageElement=function(e,t,i){let n=new Image;n.onload=function(){0===n.naturalWidth&&0===n.naturalHeight&&0===n.width&&0===n.height&&(n.width=300,n.height=150),i.resolve(n)},n.onerror=function(e){i.reject(e)},t&&(YE.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e},At._Implementations.createImage=function(e,t,i,n,r,o){let a=e.url;At.supportsImageBitmapOptions().then((function(s){if(!s||!o)return void At._Implementations.loadImageElement(a,t,i);let l=wl(),c=At._Implementations.loadWithXhr(a,"blob","GET",void 0,void 0,l,void 0,void 0,void 0);return u(c)&&u(c.abort)&&(e.cancelFunction=function(){c.abort()}),l.promise.then((function(e){if(u(e))return At.createImageBitmapFromBlob(e,{flipY:n,premultiplyAlpha:!1,skipColorSpaceConversion:r});i.reject(new ue(`Successfully retrieved ${a} but it contained no content.`))})).then((function(e){i.resolve(e)}))})).catch((function(e){i.reject(e)}))},At.createImageBitmapFromBlob=function(e,t){return El.defined("options",t),El.typeOf.bool("options.flipY",t.flipY),El.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),El.typeOf.bool("options.skipColorSpaceConversion",t.skipColorSpaceConversion),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none",colorSpaceConversion:t.skipColorSpaceConversion?"none":"default"})};var fAe=typeof XMLHttpRequest>"u";At._Implementations.loadWithXhr=function(e,t,i,n,r,o,a){let s=cAe.exec(e);if(null!==s)return void o.resolve(lAe(s,t));if(fAe)return void uAe(e,t,i,n,r,o,a);let l=new XMLHttpRequest;if(YE.contains(e)&&(l.withCredentials=!0),l.open(i,e,!0),u(a)&&u(l.overrideMimeType)&&l.overrideMimeType(a),u(r))for(let e in r)r.hasOwnProperty(e)&&l.setRequestHeader(e,r[e]);u(t)&&(l.responseType=t);let c=!1;return"string"==typeof e&&(c=0===e.indexOf("file://")||typeof window<"u"&&"file://"===window.location.origin),l.onload=function(){if((l.status<200||l.status>=300)&&(!c||0!==l.status))return void o.reject(new wm(l.status,l.response,l.getAllResponseHeaders()));let e=l.response,n=l.responseType;if("HEAD"===i||"OPTIONS"===i){let e=l.getAllResponseHeaders().trim().split(/[\r\n]+/),t={};return e.forEach((function(e){let i=e.split(": "),n=i.shift();t[n]=i.join(": ")})),void o.resolve(t)}if(204===l.status)o.resolve();else if(!u(e)||u(t)&&n!==t)if("json"===t&&"string"==typeof e)try{o.resolve(JSON.parse(e))}catch(e){o.reject(e)}else(""===n||"document"===n)&&u(l.responseXML)&&l.responseXML.hasChildNodes()?o.resolve(l.responseXML):""!==n&&"text"!==n||!u(l.responseText)?o.reject(new ue("Invalid XMLHttpRequest response type.")):o.resolve(l.responseText);else o.resolve(e)},l.onerror=function(e){o.reject(new wm)},l.send(n),l},At._Implementations.loadAndExecuteScript=function(e,t,i){return wb(e,t).catch((function(e){i.reject(e)}))},At._DefaultImplementations={},At._DefaultImplementations.createImage=At._Implementations.createImage,At._DefaultImplementations.loadWithXhr=At._Implementations.loadWithXhr,At._DefaultImplementations.loadAndExecuteScript=At._Implementations.loadAndExecuteScript,At.DEFAULT=Object.freeze(new At({url:typeof document>"u"?"":document.location.href.split("?")[0]}));var ve=At,sK=/((?:.*\/)|^)Cesium\.js(?:\?|\#|$)/,uP,Yy,fP;function dAe(){let e=document.getElementsByTagName("script");for(let t=0,i=e.length;t<i;++t){let i=e[t].getAttribute("src"),n=sK.exec(i);if(null!==n)return n[1]}}function aK(e){return typeof document>"u"?e:(u(uP)||(uP=document.createElement("a")),uP.href=e,uP.href)}function cK(){if(u(Yy))return Yy;let e;return e=typeof CESIUM_BASE_URL<"u"?CESIUM_BASE_URL:u("file:///E:/Code/SpatiotemporalPlatformJS/SpatiotemporalPlatform-iClient-JavaScript/lib/cesium/Cesium/index.js")?Sm(".","file:///E:/Code/SpatiotemporalPlatformJS/SpatiotemporalPlatform-iClient-JavaScript/lib/cesium/Cesium/index.js"):"object"==typeof define&&u(__webpack_require__.amdO)&&!__webpack_require__.amdO.toUrlUndefined&&u(WI.toUrl)?Sm("..",Xy("Core/buildModuleUrl.js")):dAe(),(Yy=new ve({url:aK(e)})).appendForwardSlash(),Yy}function hAe(e){return aK(WI.toUrl(`../${e}`))}function lK(e){return cK().getDerivedResource({url:e}).url}function Xy(e){return u(fP)||(fP="object"==typeof define&&u(__webpack_require__.amdO)&&!__webpack_require__.amdO.toUrlUndefined&&u(WI.toUrl)?hAe:lK),fP(e)}Xy._cesiumScriptRegex=sK,Xy._buildModuleUrlFromBaseUrl=lK,Xy._clearBaseResource=function(){Yy=void 0},Xy.setBaseUrl=function(e){Yy=ve.DEFAULT.getDerivedResource({url:e})},Xy.getCesiumBaseUrl=cK;var $t=Xy;function Dt(e,t){this.x=y(e,0),this.y=y(t,0)}Dt.fromElements=function(e,t,i){return u(i)?(i.x=e,i.y=t,i):new Dt(e,t)},Dt.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t):new Dt(e.x,e.y)},Dt.fromCartesian3=Dt.clone,Dt.fromCartesian4=Dt.clone,Dt.packedLength=2,Dt.pack=function(e,t,i){return i=y(i,0),t[i++]=e.x,t[i]=e.y,t},Dt.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Dt),i.x=e[t++],i.y=e[t],i},Dt.packArray=function(e,t){let i=e.length,n=2*i;u(t)?!Array.isArray(t)&&t.length!==n||t.length!==n&&(t.length=n):t=new Array(n);for(let n=0;n<i;++n)Dt.pack(e[n],t,2*n);return t},Dt.unpackArray=function(e,t){let i=e.length;u(t)?t.length=i/2:t=new Array(i/2);for(let n=0;n<i;n+=2){let i=n/2;t[i]=Dt.unpack(e,n,t[i])}return t},Dt.fromArray=Dt.unpack,Dt.maximumComponent=function(e){return Math.max(e.x,e.y)},Dt.minimumComponent=function(e){return Math.min(e.x,e.y)},Dt.minimumByComponent=function(e,t,i){return i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i},Dt.maximumByComponent=function(e,t,i){return i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i},Dt.clamp=function(e,t,i,n){let r=P.clamp(e.x,t.x,i.x),o=P.clamp(e.y,t.y,i.y);return n.x=r,n.y=o,n},Dt.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},Dt.magnitude=function(e){return Math.sqrt(Dt.magnitudeSquared(e))};var dP=new Dt;Dt.distance=function(e,t){return Dt.subtract(e,t,dP),Dt.magnitude(dP)},Dt.distanceSquared=function(e,t){return Dt.subtract(e,t,dP),Dt.magnitudeSquared(dP)},Dt.normalize=function(e,t){let i=Dt.magnitude(e);return t.x=e.x/i,t.y=e.y/i,t},Dt.dot=function(e,t){return e.x*t.x+e.y*t.y},Dt.cross=function(e,t){return e.x*t.y-e.y*t.x},Dt.multiplyComponents=function(e,t,i){return i.x=e.x*t.x,i.y=e.y*t.y,i},Dt.divideComponents=function(e,t,i){return i.x=e.x/t.x,i.y=e.y/t.y,i},Dt.add=function(e,t,i){return i.x=e.x+t.x,i.y=e.y+t.y,i},Dt.subtract=function(e,t,i){return i.x=e.x-t.x,i.y=e.y-t.y,i},Dt.multiplyByScalar=function(e,t,i){return i.x=e.x*t,i.y=e.y*t,i},Dt.divideByScalar=function(e,t,i){return i.x=e.x/t,i.y=e.y/t,i},Dt.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t},Dt.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var uK=new Dt;Dt.lerp=function(e,t,i,n){return Dt.multiplyByScalar(t,i,uK),n=Dt.multiplyByScalar(e,1-i,n),Dt.add(uK,n,n)};var fK=new Dt,dK=new Dt;Dt.angleBetween=function(e,t){return Dt.normalize(e,fK),Dt.normalize(t,dK),P.acosClamped(Dt.dot(fK,dK))};var mAe=new Dt;Dt.mostOrthogonalAxis=function(e,t){let i=Dt.normalize(e,mAe);return Dt.abs(i,i),t=i.x<=i.y?Dt.clone(Dt.UNIT_X,t):Dt.clone(Dt.UNIT_Y,t)},Dt.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y},Dt.equalsArray=function(e,t,i){return e.x===t[i]&&e.y===t[i+1]},Dt.equalsEpsilon=function(e,t,i,n){return e===t||u(e)&&u(t)&&P.equalsEpsilon(e.x,t.x,i,n)&&P.equalsEpsilon(e.y,t.y,i,n)},Dt.ZERO=Object.freeze(new Dt(0,0)),Dt.ONE=Object.freeze(new Dt(1,1)),Dt.UNIT_X=Object.freeze(new Dt(1,0)),Dt.UNIT_Y=Object.freeze(new Dt(0,1)),Dt.prototype.clone=function(e){return Dt.clone(this,e)},Dt.prototype.equals=function(e){return Dt.equals(this,e)},Dt.prototype.equalsEpsilon=function(e,t,i){return Dt.equalsEpsilon(this,e,t,i)},Dt.prototype.toString=function(){return`(${this.x}, ${this.y})`};var U=Dt;function n_(e){e=y(e,y.EMPTY_OBJECT),this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._rectangle=y(e.rectangle,ce.MAX_VALUE),this._projection=new Ii(this._ellipsoid),this._numberOfLevelZeroTilesX=y(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=y(e.numberOfLevelZeroTilesY,1)}Object.defineProperties(n_.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),n_.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},n_.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},n_.prototype.rectangleToNativeRectangle=function(e,t){let i=P.toDegrees(e.west),n=P.toDegrees(e.south),r=P.toDegrees(e.east),o=P.toDegrees(e.north);return u(t)?(t.west=i,t.south=n,t.east=r,t.north=o,t):new ce(i,n,r,o)},n_.prototype.tileXYToNativeRectangle=function(e,t,i,n){let r=this.tileXYToRectangle(e,t,i,n);return r.west=P.toDegrees(r.west),r.south=P.toDegrees(r.south),r.east=P.toDegrees(r.east),r.north=P.toDegrees(r.north),r},n_.prototype.tileXYToRectangle=function(e,t,i,n){let r=this._rectangle,o=this.getNumberOfXTilesAtLevel(i),a=this.getNumberOfYTilesAtLevel(i),s=r.width/o,l=e*s+r.west,c=(e+1)*s+r.west,h=r.height/a,d=r.north-t*h,p=r.north-(t+1)*h;return u(n)||(n=new ce(l,p,c,d)),n.west=l,n.south=p,n.east=c,n.north=d,n},n_.prototype.positionToTileXY=function(e,t,i){let n=this._rectangle;if(!ce.contains(n,e))return;let r=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),a=n.width/r,s=n.height/o,l=e.longitude;n.east<n.west&&(l+=P.TWO_PI);let c=(l-n.west)/a|0;c>=r&&(c=r-1);let h=(n.north-e.latitude)/s|0;return h>=o&&(h=o-1),u(i)?(i.x=c,i.y=h,i):new U(c,h)};var Ui=n_,hK=new h,mK=new h,pK=new fe,pH=new h,pAe=new h,_K=new se,_Ae=new Ui,XE=[new fe,new fe,new fe,new fe],KE=new U,vr={};function gK(e){fe.fromRadians(e.east,e.north,0,XE[0]),fe.fromRadians(e.west,e.north,0,XE[1]),fe.fromRadians(e.east,e.south,0,XE[2]),fe.fromRadians(e.west,e.south,0,XE[3]);let t,i=0,n=0,r=0,o=0,a=vr._terrainHeightsMaxLevel;for(t=0;t<=a;++t){let e=!1;for(let i=0;i<4;++i){let n=XE[i];if(_Ae.positionToTileXY(n,t,KE),0===i)r=KE.x,o=KE.y;else if(r!==KE.x||o!==KE.y){e=!0;break}}if(e)break;i=r,n=o}if(0!==t)return{x:i,y:n,level:t>a?a:t-1}}vr.initialize=function(){let e=vr._initPromise;return u(e)||(e=ve.fetchJson($t("Assets/approximateTerrainHeights.json")).then((function(e){vr._terrainHeights=e})),vr._initPromise=e),e},vr.getMinimumMaximumHeights=function(e,t){t=y(t,ie.WGS84);let i=gK(e),n=vr._defaultMinTerrainHeight,r=vr._defaultMaxTerrainHeight;if(u(i)){let o=`${i.level}-${i.x}-${i.y}`,a=vr._terrainHeights[o];u(a)&&(n=a[0],r=a[1]),t.cartographicToCartesian(ce.northeast(e,pK),hK),t.cartographicToCartesian(ce.southwest(e,pK),mK),h.midpoint(mK,hK,pH);let s=t.scaleToGeodeticSurface(pH,pAe);if(u(s)){let e=h.distance(pH,s);n=Math.min(n,-e)}else n=vr._defaultMinTerrainHeight}return n=Math.max(vr._defaultMinTerrainHeight,n),{minimumTerrainHeight:n,maximumTerrainHeight:r}},vr.getBoundingSphere=function(e,t){t=y(t,ie.WGS84);let i=gK(e),n=vr._defaultMaxTerrainHeight;if(u(i)){let e=`${i.level}-${i.x}-${i.y}`,t=vr._terrainHeights[e];u(t)&&(n=t[1])}let r=se.fromRectangle3D(e,t,0);return se.fromRectangle3D(e,t,n,_K),se.union(r,_K,r)},vr._terrainHeightsMaxLevel=6,vr._defaultMaxTerrainHeight=9e3,vr._defaultMinTerrainHeight=-1e5,vr._terrainHeights=void 0,vr._initPromise=void 0,Object.defineProperties(vr,{initialized:{get:function(){return u(vr._terrainHeights)}}});var li=vr,xK=or(yK(),1),gAe=0,yH={};function nh(e,t){let i,n=e;u(yH[n])?i=yH[n]:(i=gAe++,yH[n]=i),t=y(t,!1),this._id=i,this._html=e,this._showOnScreen=t,this._element=void 0}Object.defineProperties(nh.prototype,{html:{get:function(){return this._html}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen},set:function(e){this._showOnScreen=e}},element:{get:function(){if(!u(this._element)){let e=xK.default.sanitize(this._html),t=document.createElement("div");t._creditId=this._id,t.style.display="inline",t.innerHTML=e;let i=t.querySelectorAll("a");for(let e=0;e<i.length;e++)i[e].setAttribute("target","_blank");this._element=t}return this._element}}}),nh.equals=function(e,t){return e===t||u(e)&&u(t)&&e._id===t._id&&e._showOnScreen===t._showOnScreen},nh.prototype.equals=function(e){return nh.equals(this,e)},nh.prototype.isIon=function(){return-1!==this.html.indexOf("ion-credit.png")},nh.getIonCredit=function(e){let t=u(e.collapsible)&&!e.collapsible;return new nh(e.html,t)},nh.clone=function(e){if(u(e))return new nh(e.html,e.showOnScreen)};var xt=nh,yAe={NONE:0,LERC:1},Mf=Object.freeze(yAe);function ic(e,t,i){this.minimum=h.clone(y(e,h.ZERO)),this.maximum=h.clone(y(t,h.ZERO)),i=u(i)?h.clone(i):h.midpoint(this.minimum,this.maximum,new h),this.center=i}ic.fromCorners=function(e,t,i){return u(i)||(i=new ic),i.minimum=h.clone(e,i.minimum),i.maximum=h.clone(t,i.maximum),i.center=h.midpoint(e,t,i.center),i},ic.fromPoints=function(e,t){if(u(t)||(t=new ic),!u(e)||0===e.length)return t.minimum=h.clone(h.ZERO,t.minimum),t.maximum=h.clone(h.ZERO,t.maximum),t.center=h.clone(h.ZERO,t.center),t;let i=e[0].x,n=e[0].y,r=e[0].z,o=e[0].x,a=e[0].y,s=e[0].z,l=e.length;for(let t=1;t<l;t++){let l=e[t],u=l.x,c=l.y,h=l.z;i=Math.min(u,i),o=Math.max(u,o),n=Math.min(c,n),a=Math.max(c,a),r=Math.min(h,r),s=Math.max(h,s)}let c=t.minimum;c.x=i,c.y=n,c.z=r;let d=t.maximum;return d.x=o,d.y=a,d.z=s,t.center=h.midpoint(c,d,t.center),t},ic.clone=function(e,t){if(u(e))return u(t)?(t.minimum=h.clone(e.minimum,t.minimum),t.maximum=h.clone(e.maximum,t.maximum),t.center=h.clone(e.center,t.center),t):new ic(e.minimum,e.maximum,e.center)},ic.equals=function(e,t){return e===t||u(e)&&u(t)&&h.equals(e.center,t.center)&&h.equals(e.minimum,t.minimum)&&h.equals(e.maximum,t.maximum)};var hP=new h;ic.intersectPlane=function(e,t){hP=h.subtract(e.maximum,e.minimum,hP);let i=h.multiplyByScalar(hP,.5,hP),n=t.normal,r=i.x*Math.abs(n.x)+i.y*Math.abs(n.y)+i.z*Math.abs(n.z),o=h.dot(e.center,n)+t.distance;return o-r>0?Zt.INSIDE:o+r<0?Zt.OUTSIDE:Zt.INTERSECTING},ic.prototype.clone=function(e){return ic.clone(this,e)},ic.prototype.intersectPlane=function(e){return ic.intersectPlane(this,e)},ic.prototype.equals=function(e){return ic.equals(this,e)};var Ky=ic;function ih(e,t){this._ellipsoid=e,this._cameraPosition=new h,this._cameraPositionInScaledSpace=new h,this._distanceToLimbInScaledSpaceSquared=0,u(t)&&(this.cameraPosition=t)}Object.defineProperties(ih.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){let t=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),i=h.magnitudeSquared(t)-1;h.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=t,this._distanceToLimbInScaledSpaceSquared=i}}});var bK=new h;ih.prototype.isPointVisible=function(e){return bH(this._ellipsoid.transformPositionToScaledSpace(e,bK),this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)},ih.prototype.isScaledSpacePointVisible=function(e){return bH(e,this._cameraPositionInScaledSpace,this._distanceToLimbInScaledSpaceSquared)};var xAe=new h;ih.prototype.isScaledSpacePointVisiblePossiblyUnderEllipsoid=function(e,t){let i,n,r=this._ellipsoid;return u(t)&&t<0&&r.minimumRadius>-t?(n=xAe,n.x=this._cameraPosition.x/(r.radii.x+t),n.y=this._cameraPosition.y/(r.radii.y+t),n.z=this._cameraPosition.z/(r.radii.z+t),i=n.x*n.x+n.y*n.y+n.z*n.z-1):(n=this._cameraPositionInScaledSpace,i=this._distanceToLimbInScaledSpaceSquared),bH(e,n,i)},ih.prototype.computeHorizonCullingPoint=function(e,t,i){return CK(this._ellipsoid,e,t,i)};var TK=ie.clone(ie.UNIT_SPHERE);ih.prototype.computeHorizonCullingPointPossiblyUnderEllipsoid=function(e,t,i,n){return CK(AK(this._ellipsoid,i,TK),e,t,n)},ih.prototype.computeHorizonCullingPointFromVertices=function(e,t,i,n,r){return EK(this._ellipsoid,e,t,i,n,r)},ih.prototype.computeHorizonCullingPointFromVerticesPossiblyUnderEllipsoid=function(e,t,i,n,r,o){return EK(AK(this._ellipsoid,r,TK),e,t,i,n,o)};var bAe=[];ih.prototype.computeHorizonCullingPointFromRectangle=function(e,t,i){let n=ce.subsample(e,t,0,bAe),r=se.fromPoints(n);if(!(h.magnitude(r.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(r.center,n,i)};var TAe=new h;function AK(e,t,i){if(u(t)&&t<0&&e.minimumRadius>-t){let n=h.fromElements(e.radii.x+t,e.radii.y+t,e.radii.z+t,TAe);e=ie.fromCartesian3(n,i)}return e}function CK(e,t,i,n){u(n)||(n=new h);let r=vK(e,t),o=0;for(let t=0,n=i.length;t<n;++t){let n=SK(e,i[t],r);if(n<0)return;o=Math.max(o,n)}return wK(r,o,n)}var mP=new h;function EK(e,t,i,n,r,o){u(o)||(o=new h),n=y(n,3),r=y(r,h.ZERO);let a=vK(e,t),s=0;for(let t=0,o=i.length;t<o;t+=n){mP.x=i[t]+r.x,mP.y=i[t+1]+r.y,mP.z=i[t+2]+r.z;let n=SK(e,mP,a);if(n<0)return;s=Math.max(s,n)}return wK(a,s,o)}function bH(e,t,i){let n=t,r=i,o=h.subtract(e,n,bK),a=-h.dot(o,n);return!(r<0?a>0:a>r&&a*a/h.magnitudeSquared(o)>r)}var AAe=new h,CAe=new h;function SK(e,t,i){let n=e.transformPositionToScaledSpace(t,AAe),r=h.magnitudeSquared(n),o=Math.sqrt(r),a=h.divideByScalar(n,o,CAe);r=Math.max(1,r),o=Math.max(1,o);let s=1/o;return 1/(h.dot(a,i)*s-h.magnitude(h.cross(a,i,a))*(Math.sqrt(r-1)*s))}function wK(e,t,i){if(!(t<=0||t===1/0||t!=t))return h.multiplyByScalar(e,t,i)}var xH=new h;function vK(e,t){return h.equals(t,h.ZERO)?t:(e.transformPositionToScaledSpace(t,xH),h.normalize(xH,xH))}var i_=ih,TH={};function DK(e,t,i){let n=e+t;return P.sign(e)!==P.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<i?0:n}TH.computeDiscriminant=function(e,t,i){return t*t-4*e*i},TH.computeRealRoots=function(e,t,i){let n;if(0===e)return 0===t?[]:[-i/t];if(0===t){if(0===i)return[0,0];let t=Math.abs(i),r=Math.abs(e);if(t<r&&t/r<P.EPSILON14)return[0,0];if(t>r&&r/t<P.EPSILON14)return[];if(n=-i/e,n<0)return[];let o=Math.sqrt(n);return[-o,o]}if(0===i)return n=-t/e,n<0?[n,0]:[0,n];let r=DK(t*t,-(4*e*i),P.EPSILON14);if(r<0)return[];let o=-.5*DK(t,P.sign(t)*Math.sqrt(r),P.EPSILON14);return t>0?[o/e,i/o]:[i/o,o/e]};var zc=TH,CH={};function AH(e,t,i,n){let r,o,a=e,s=t/3,l=i/3,u=n,c=a*l,h=s*u,d=s*s,p=l*l,f=a*l-d,m=a*u-s*l,_=s*u-p,g=4*f*_-m*m;if(g<0){let e,t,i;d*h>=c*p?(e=a,t=f,i=-2*s*f+a*m):(e=u,t=_,i=-u*m+2*l*_);let n=-(i<0?-1:1)*Math.abs(e)*Math.sqrt(-g);o=-i+n;let y=o/2,v=y<0?-Math.pow(-y,1/3):Math.pow(y,1/3),b=o===n?-v:-t/v;return r=t<=0?v+b:-i/(v*v+b*b+t),d*h>=c*p?[(r-s)/a]:[-u/(r+l)]}let y=f,v=-2*s*f+a*m,b=_,A=-u*m+2*l*_,T=Math.sqrt(g),E=Math.sqrt(3)/2,C=Math.abs(Math.atan2(a*T,-v)/3);r=2*Math.sqrt(-y);let x=Math.cos(C);o=r*x;let S=r*(-x/2-E*Math.sin(C)),w=o+S>2*s?o-s:S-s,I=a,P=w/I;C=Math.abs(Math.atan2(u*T,-A)/3),r=2*Math.sqrt(-b),x=Math.cos(C),o=r*x,S=r*(-x/2-E*Math.sin(C));let D=-u,O=o+S<2*l?o+l:S+l,L=D/O,R=-w*O-I*D,N=(l*R-s*(w*D))/(-s*R+l*(I*O));return P<=N?P<=L?N<=L?[P,N,L]:[P,L,N]:[L,P,N]:P<=L?[N,P,L]:N<=L?[N,L,P]:[L,N,P]}CH.computeDiscriminant=function(e,t,i,n){let r=t*t,o=i*i;return 18*e*t*i*n+r*o-27*(e*e)*(n*n)-4*(e*o*i+r*t*n)},CH.computeRealRoots=function(e,t,i,n){let r,o;if(0===e)return zc.computeRealRoots(t,i,n);if(0===t){if(0===i){if(0===n)return[0,0,0];o=-n/e;let t=o<0?-Math.pow(-o,1/3):Math.pow(o,1/3);return[t,t,t]}return 0===n?(r=zc.computeRealRoots(e,0,i),0===r.Length?[0]:[r[0],0,r[1]]):AH(e,0,i,n)}return 0===i?0===n?(o=-t/e,o<0?[o,0,0]:[0,0,o]):AH(e,t,0,n):0===n?(r=zc.computeRealRoots(e,t,i),0===r.length?[0]:r[1]<=0?[r[0],r[1],0]:r[0]>=0?[0,r[0],r[1]]:[r[0],0,r[1]]):AH(e,t,i,n)};var Ob=CH,EH={};function Lf(e,t,i,n){let r=e*e,o=t-3*r/8,a=i-t*e/2+r*e/8,s=n-i*e/4+t*r/16-3*r*r/256,l=Ob.computeRealRoots(1,2*o,o*o-4*s,-a*a);if(l.length>0){let t=-e/4,i=l[l.length-1];if(Math.abs(i)<P.EPSILON14){let e=zc.computeRealRoots(1,o,s);if(2===e.length){let i,n=e[0],r=e[1];if(n>=0&&r>=0){let e=Math.sqrt(n),i=Math.sqrt(r);return[t-i,t-e,t+e,t+i]}if(n>=0&&r<0)return i=Math.sqrt(n),[t-i,t+i];if(n<0&&r>=0)return i=Math.sqrt(r),[t-i,t+i]}return[]}if(i>0){let e=Math.sqrt(i),n=(o+i-a/e)/2,r=(o+i+a/e)/2,s=zc.computeRealRoots(1,e,n),l=zc.computeRealRoots(1,-e,r);return 0!==s.length?(s[0]+=t,s[1]+=t,0!==l.length?(l[0]+=t,l[1]+=t,s[1]<=l[0]?[s[0],s[1],l[0],l[1]]:l[1]<=s[0]?[l[0],l[1],s[0],s[1]]:s[0]>=l[0]&&s[1]<=l[1]?[l[0],s[0],s[1],l[1]]:l[0]>=s[0]&&l[1]<=s[1]?[s[0],l[0],l[1],s[1]]:s[0]>l[0]&&s[0]<l[1]?[l[0],s[0],l[1],s[1]]:[s[0],l[0],s[1],l[1]]):s):0!==l.length?(l[0]+=t,l[1]+=t,l):[]}}return[]}function ZE(e,t,i,n){let r=e*e,o=-2*t,a=i*e+t*t-4*n,s=r*n-i*t*e+i*i,l=Ob.computeRealRoots(1,o,a,s);if(l.length>0){let o,a,s,u,c,h,d=l[0],p=t-d,f=p*p,m=e/2,_=p/2,g=f-4*n,y=f+4*Math.abs(n),v=r-4*d,b=r+4*Math.abs(d);if(d<0||g*b<v*y){let t=Math.sqrt(v);o=t/2,a=0===t?0:(e*_-i)/t}else{let t=Math.sqrt(g);o=0===t?0:(e*_-i)/t,a=t/2}0===m&&0===o?(s=0,u=0):P.sign(m)===P.sign(o)?(s=m+o,u=d/s):(u=m-o,s=d/u),0===_&&0===a?(c=0,h=0):P.sign(_)===P.sign(a)?(c=_+a,h=n/c):(h=_-a,c=n/h);let A=zc.computeRealRoots(1,s,c),T=zc.computeRealRoots(1,u,h);if(0!==A.length)return 0!==T.length?A[1]<=T[0]?[A[0],A[1],T[0],T[1]]:T[1]<=A[0]?[T[0],T[1],A[0],A[1]]:A[0]>=T[0]&&A[1]<=T[1]?[T[0],A[0],A[1],T[1]]:T[0]>=A[0]&&T[1]<=A[1]?[A[0],T[0],T[1],A[1]]:A[0]>T[0]&&A[0]<T[1]?[T[0],A[0],T[1],A[1]]:[A[0],T[0],A[1],T[1]]:A;if(0!==T.length)return T}return[]}EH.computeDiscriminant=function(e,t,i,n,r){let o=e*e,a=t*t,s=a*t,l=i*i,u=l*i,c=n*n,h=c*n,d=r*r;return a*l*c-4*s*h-4*e*u*c+18*e*t*i*h-27*o*c*c+256*(o*e)*(d*r)+r*(18*s*i*n-4*a*u+16*e*l*l-80*e*t*l*n-6*e*a*c+144*o*i*c)+d*(144*e*a*i-27*a*a-128*o*l-192*o*t*n)},EH.computeRealRoots=function(e,t,i,n,r){if(Math.abs(e)<P.EPSILON15)return Ob.computeRealRoots(t,i,n,r);let o=t/e,a=i/e,s=n/e,l=r/e,u=o<0?1:0;switch(u+=a<0?u+1:u,u+=s<0?u+1:u,u+=l<0?u+1:u,u){case 0:case 3:case 4:case 6:case 7:case 9:case 10:case 12:case 13:case 14:case 15:return Lf(o,a,s,l);case 1:case 2:case 5:case 8:case 11:return ZE(o,a,s,l);default:return}};var pP=EH;function _P(e,t){t=h.clone(y(t,h.ZERO)),h.equals(t,h.ZERO)||h.normalize(t,t),this.origin=h.clone(y(e,h.ZERO)),this.direction=t}_P.clone=function(e,t){if(u(e))return u(t)?(t.origin=h.clone(e.origin),t.direction=h.clone(e.direction),t):new _P(e.origin,e.direction)},_P.getPoint=function(e,t,i){return u(i)||(i=new h),i=h.multiplyByScalar(e.direction,t,i),h.add(e.origin,i,i)};var Tn=_P,Zo={rayPlane:function(e,t,i){u(i)||(i=new h);let n=e.origin,r=e.direction,o=t.normal,a=h.dot(o,r);if(Math.abs(a)<P.EPSILON15)return;let s=(-t.distance-h.dot(o,n))/a;return s<0?void 0:(i=h.multiplyByScalar(r,s,i),h.add(n,i,i))}},EAe=new h,SAe=new h,FK=new h,IK=new h,PK=new h;Zo.rayTriangleParametric=function(e,t,i,n,r){r=y(r,!1);let o,a,s,l,u,c=e.origin,d=e.direction,p=h.subtract(i,t,EAe),f=h.subtract(n,t,SAe),m=h.cross(d,f,FK),_=h.dot(p,m);if(r){if(_<P.EPSILON6||(o=h.subtract(c,t,IK),s=h.dot(o,m),s<0||s>_)||(a=h.cross(o,p,PK),l=h.dot(d,a),l<0||s+l>_))return;u=h.dot(f,a)/_}else{if(Math.abs(_)<P.EPSILON6)return;let e=1/_;if(o=h.subtract(c,t,IK),s=h.dot(o,m)*e,s<0||s>1||(a=h.cross(o,p,PK),l=h.dot(d,a)*e,l<0||s+l>1))return;u=h.dot(f,a)*e}return u},Zo.rayTriangle=function(e,t,i,n,r,o){let a=Zo.rayTriangleParametric(e,t,i,n,r);if(u(a)&&!(a<0))return u(o)||(o=new h),h.multiplyByScalar(e.direction,a,o),h.add(e.origin,o,o)};var wAe=new Tn;function vAe(e,t,i,n){let r=t*t-4*e*i;if(r<0)return;if(r>0){let i=1/(2*e),o=Math.sqrt(r),a=(-t+o)*i,s=(-t-o)*i;return a<s?(n.root0=a,n.root1=s):(n.root0=s,n.root1=a),n}let o=-t/(2*e);return 0!==o?(n.root0=n.root1=o,n):void 0}Zo.lineSegmentTriangle=function(e,t,i,n,r,o,a){let s=wAe;h.clone(e,s.origin),h.subtract(t,e,s.direction),h.normalize(s.direction,s.direction);let l=Zo.rayTriangleParametric(s,i,n,r,o);if(!(!u(l)||l<0||l>h.distance(e,t)))return u(a)||(a=new h),h.multiplyByScalar(s.direction,l,a),h.add(s.origin,a,a)};var DAe={root0:0,root1:0};function BK(e,t,i){u(i)||(i=new Uc);let n=e.origin,r=e.direction,o=t.center,a=t.radius*t.radius,s=h.subtract(n,o,FK),l=vAe(h.dot(r,r),2*h.dot(r,s),h.magnitudeSquared(s)-a,DAe);if(u(l))return i.start=l.root0,i.stop=l.root1,i}Zo.raySphere=function(e,t,i){if(i=BK(e,t,i),u(i)&&!(i.stop<0))return i.start=Math.max(i.start,0),i};var IAe=new Tn;Zo.lineSegmentSphere=function(e,t,i,n){let r=IAe;h.clone(e,r.origin);let o=h.subtract(t,e,r.direction),a=h.magnitude(o);if(h.normalize(o,o),n=BK(r,i,n),!(!u(n)||n.stop<0||n.start>a))return n.start=Math.max(n.start,0),n.stop=Math.min(n.stop,a),n};var PAe=new h,OAe=new h;function Zy(e,t,i){let n=e+t;return P.sign(e)!==P.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<i?0:n}function RAe(e,t,i,n,r){let o,a=n*n,s=r*r,l=(e[$.COLUMN1ROW1]-e[$.COLUMN2ROW2])*s,u=r*(n*Zy(e[$.COLUMN1ROW0],e[$.COLUMN0ROW1],P.EPSILON15)+t.y),c=e[$.COLUMN0ROW0]*a+e[$.COLUMN2ROW2]*s+n*t.x+i,d=s*Zy(e[$.COLUMN2ROW1],e[$.COLUMN1ROW2],P.EPSILON15),p=r*(n*Zy(e[$.COLUMN2ROW0],e[$.COLUMN0ROW2])+t.z),f=[];if(0===p&&0===d){if(o=zc.computeRealRoots(l,u,c),0===o.length)return f;let e=o[0],t=Math.sqrt(Math.max(1-e*e,0));if(f.push(new h(n,r*e,r*-t)),f.push(new h(n,r*e,r*t)),2===o.length){let e=o[1],t=Math.sqrt(Math.max(1-e*e,0));f.push(new h(n,r*e,r*-t)),f.push(new h(n,r*e,r*t))}return f}let m=p*p,_=d*d,g=p*d,y=l*l+_,v=2*(u*l+g),b=2*c*l+u*u-_+m,A=2*(c*u-g),T=c*c-m;if(0===y&&0===v&&0===b&&0===A)return f;o=pP.computeRealRoots(y,v,b,A,T);let E=o.length;if(0===E)return f;for(let e=0;e<E;++e){let t,i=o[e],a=i*i,s=Math.max(1-a,0),m=Math.sqrt(s);t=P.sign(l)===P.sign(c)?Zy(l*a+c,u*i,P.EPSILON12):P.sign(c)===P.sign(u*i)?Zy(l*a,u*i+c,P.EPSILON12):Zy(l*a+u*i,c,P.EPSILON12);let _=t*Zy(d*i,p,P.EPSILON15);_<0?f.push(new h(n,r*i,r*m)):_>0?f.push(new h(n,r*i,r*-m)):0!==m?(f.push(new h(n,r*i,r*-m)),f.push(new h(n,r*i,r*m)),++e):f.push(new h(n,r*i,r*m))}return f}Zo.rayEllipsoid=function(e,t){let i,n,r,o,a,s=t.oneOverRadii,l=h.multiplyComponents(s,e.origin,PAe),u=h.multiplyComponents(s,e.direction,OAe),c=h.magnitudeSquared(l),d=h.dot(l,u);if(c>1){if(d>=0)return;let e=d*d;if(i=c-1,n=h.magnitudeSquared(u),r=n*i,e<r)return;if(e>r){o=d*d-r,a=-d+Math.sqrt(o);let e=a/n,t=i/a;return e<t?new Uc(e,t):{start:t,stop:e}}let t=Math.sqrt(i/n);return new Uc(t,t)}return c<1?(i=c-1,n=h.magnitudeSquared(u),r=n*i,o=d*d-r,a=-d+Math.sqrt(o),new Uc(0,a/n)):d<0?(n=h.magnitudeSquared(u),new Uc(0,-d/n)):void 0};var SH=new h,OK=new h,RK=new h,gP=new h,MAe=new h,LAe=new $,NAe=new $,FAe=new $,BAe=new $,kAe=new $,MK=new $,LK=new $,NK=new h,VAe=new h,UAe=new fe;Zo.grazingAltitudeLocation=function(e,t){let i=e.origin,n=e.direction;if(!h.equals(i,h.ZERO)){let e=t.geodeticSurfaceNormal(i,SH);if(h.dot(n,e)>=0)return i}let r=u(this.rayEllipsoid(e,t)),o=t.transformPositionToScaledSpace(n,SH),a=h.normalize(o,o),s=h.mostOrthogonalAxis(o,gP),l=h.normalize(h.cross(s,a,OK),OK),c=h.normalize(h.cross(a,l,RK),RK),d=LAe;d[0]=a.x,d[1]=a.y,d[2]=a.z,d[3]=l.x,d[4]=l.y,d[5]=l.z,d[6]=c.x,d[7]=c.y,d[8]=c.z;let p=$.transpose(d,NAe),f=$.fromScale(t.radii,FAe),m=$.fromScale(t.oneOverRadii,BAe),_=kAe;_[0]=0,_[1]=-n.z,_[2]=n.y,_[3]=n.z,_[4]=0,_[5]=-n.x,_[6]=-n.y,_[7]=n.x,_[8]=0;let g,y,v=$.multiply($.multiply(p,m,MK),_,MK),b=$.multiply($.multiply(v,f,LK),d,LK),A=$.multiplyByVector(v,i,MAe),T=RAe(b,h.negate(A,SH),0,0,1),E=T.length;if(E>0){let e=h.clone(h.ZERO,VAe),o=Number.NEGATIVE_INFINITY;for(let t=0;t<E;++t){g=$.multiplyByVector(f,$.multiplyByVector(d,T[t],NK),NK);let r=h.normalize(h.subtract(g,i,gP),gP),a=h.dot(r,n);a>o&&(o=a,e=h.clone(g,e))}let a=t.cartesianToCartographic(e,UAe);return o=P.clamp(o,0,1),y=h.magnitude(h.subtract(e,i,gP))*Math.sqrt(1-o*o),y=r?-y:y,a.height=y,t.cartographicToCartesian(a,new h)}};var zAe=new h;Zo.lineSegmentPlane=function(e,t,i,n){u(n)||(n=new h);let r=h.subtract(t,e,zAe),o=i.normal,a=h.dot(o,r);if(Math.abs(a)<P.EPSILON6)return;let s=h.dot(o,e),l=-(i.distance+s)/a;return l<0||l>1?void 0:(h.multiplyByScalar(r,l,n),h.add(e,n,n),n)},Zo.trianglePlaneIntersection=function(e,t,i,n){let r,o,a=n.normal,s=n.distance,l=h.dot(a,e)+s<0,u=h.dot(a,t)+s<0,c=h.dot(a,i)+s<0,d=0;if(d+=l?1:0,d+=u?1:0,d+=c?1:0,(1===d||2===d)&&(r=new h,o=new h),1===d){if(l)return Zo.lineSegmentPlane(e,t,n,r),Zo.lineSegmentPlane(e,i,n,o),{positions:[e,t,i,r,o],indices:[0,3,4,1,2,4,1,4,3]};if(u)return Zo.lineSegmentPlane(t,i,n,r),Zo.lineSegmentPlane(t,e,n,o),{positions:[e,t,i,r,o],indices:[1,3,4,2,0,4,2,4,3]};if(c)return Zo.lineSegmentPlane(i,e,n,r),Zo.lineSegmentPlane(i,t,n,o),{positions:[e,t,i,r,o],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===d){if(!l)return Zo.lineSegmentPlane(t,e,n,r),Zo.lineSegmentPlane(i,e,n,o),{positions:[e,t,i,r,o],indices:[1,2,4,1,4,3,0,3,4]};if(!u)return Zo.lineSegmentPlane(i,t,n,r),Zo.lineSegmentPlane(e,t,n,o),{positions:[e,t,i,r,o],indices:[2,0,4,2,4,3,1,3,4]};if(!c)return Zo.lineSegmentPlane(e,i,n,r),Zo.lineSegmentPlane(t,i,n,o),{positions:[e,t,i,r,o],indices:[0,1,4,0,4,3,2,3,4]}}};var Ai=Zo;function hs(e,t){this.normal=h.clone(e),this.distance=t}hs.fromPointNormal=function(e,t,i){let n=-h.dot(t,e);return u(i)?(h.clone(t,i.normal),i.distance=n,i):new hs(t,n)};var HAe=new h;hs.fromCartesian4=function(e,t){let i=h.fromCartesian4(e,HAe),n=e.w;return u(t)?(h.clone(i,t.normal),t.distance=n,t):new hs(i,n)},hs.getPointDistance=function(e,t){return h.dot(e.normal,t)+e.distance};var GAe=new h;hs.projectPointOntoPlane=function(e,t,i){u(i)||(i=new h);let n=hs.getPointDistance(e,t),r=h.multiplyByScalar(e.normal,n,GAe);return h.subtract(t,r,i)};var WAe=new L,jAe=new oe,qAe=new h;hs.transform=function(e,t,i){let n=e.normal,r=e.distance,o=L.inverseTranspose(t,WAe),a=oe.fromElements(n.x,n.y,n.z,r,jAe);a=L.multiplyByVector(o,a,a);let s=h.fromCartesian4(a,qAe);return a=oe.divideByScalar(a,h.magnitude(s),a),hs.fromCartesian4(a,i)},hs.clone=function(e,t){return u(t)?(h.clone(e.normal,t.normal),t.distance=e.distance,t):new hs(e.normal,e.distance)},hs.equals=function(e,t){return e.distance===t.distance&&h.equals(e.normal,t.normal)},hs.ORIGIN_XY_PLANE=Object.freeze(new hs(h.UNIT_Z,0)),hs.ORIGIN_YZ_PLANE=Object.freeze(new hs(h.UNIT_X,0)),hs.ORIGIN_ZX_PLANE=Object.freeze(new hs(h.UNIT_Y,0));var tn=hs;function YAe(e,t,i){let n,r,o=0,a=e.length-1;for(;o<=a;)if(n=~~((o+a)/2),r=i(e[n],t),r<0)o=n+1;else{if(!(r>0))return n;a=n-1}return~(a+1)}var Eo=YAe;function XAe(e,t,i,n,r){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=i,this.yPoleOffset=n,this.ut1MinusUtc=r}var $y=XAe;function KAe(e,t,i,n,r,o,a,s){this.year=e,this.month=t,this.day=i,this.hour=n,this.minute=r,this.second=o,this.millisecond=a,this.isLeapSecond=s}var o_=KAe;function ZAe(e){return e%4==0&&e%100!=0||e%400==0}var r_=ZAe;function $Ae(e,t){this.julianDate=e,this.offset=t}var zi=$Ae,QAe={SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5},Xn=Object.freeze(QAe),JAe={UTC:0,TAI:1},Yn=Object.freeze(JAe),VK=new o_,wH=[31,28,31,30,31,30,31,31,30,31,30,31],vH=29;function DH(e,t){return Ct.compare(e.julianDate,t.julianDate)}var Rb=new zi;function xP(e){Rb.julianDate=e;let t=Ct.leapSeconds,i=Eo(t,Rb,DH);i<0&&(i=~i),i>=t.length&&(i=t.length-1);let n=t[i].offset;i>0&&Ct.secondsDifference(t[i].julianDate,e)>n&&(i--,n=t[i].offset),Ct.addSeconds(e,n,e)}function kK(e,t){Rb.julianDate=e;let i=Ct.leapSeconds,n=Eo(i,Rb,DH);if(n<0&&(n=~n),0===n)return Ct.addSeconds(e,-i[0].offset,t);if(n>=i.length)return Ct.addSeconds(e,-i[n-1].offset,t);let r=Ct.secondsDifference(i[n].julianDate,e);return 0===r?Ct.addSeconds(e,-i[n].offset,t):r<=1?void 0:Ct.addSeconds(e,-i[--n].offset,t)}function s_(e,t,i){let n=t/Xn.SECONDS_PER_DAY|0;return e+=n,(t-=Xn.SECONDS_PER_DAY*n)<0&&(e--,t+=Xn.SECONDS_PER_DAY),i.dayNumber=e,i.secondsOfDay=t,i}function IH(e,t,i,n,r,o,a){let s=(t-14)/12|0,l=e+4800+s,u=(1461*l/4|0)+(367*(t-2-12*s)/12|0)-(3*((l+100)/100|0)/4|0)+i-32075;(n-=12)<0&&(n+=24);let c=o+(n*Xn.SECONDS_PER_HOUR+r*Xn.SECONDS_PER_MINUTE+a*Xn.SECONDS_PER_MILLISECOND);return c>=43200&&(u-=1),[u,c]}var eCe=/^(\d{4})$/,tCe=/^(\d{4})-(\d{2})$/,nCe=/^(\d{4})-?(\d{3})$/,iCe=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,oCe=/^(\d{4})-?(\d{2})-?(\d{2})$/,PH=/([Z+\-])?(\d{2})?:?(\d{2})?$/,rCe=/^(\d{2})(\.\d+)?/.source+PH.source,sCe=/^(\d{2}):?(\d{2})(\.\d+)?/.source+PH.source,aCe=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+PH.source;function Ct(e,t,i){this.dayNumber=void 0,this.secondsOfDay=void 0,e=y(e,0),t=y(t,0),i=y(i,Yn.UTC);let n=0|e;s_(n,t+=(e-n)*Xn.SECONDS_PER_DAY,this),i===Yn.UTC&&xP(this)}Ct.fromGregorianDate=function(e,t){let i=IH(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return u(t)?(s_(i[0],i[1],t),xP(t),t):new Ct(i[0],i[1],Yn.UTC)},Ct.fromDate=function(e,t){let i=IH(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return u(t)?(s_(i[0],i[1],t),xP(t),t):new Ct(i[0],i[1],Yn.UTC)},Ct.fromIso8601=function(e,t){let i,n,r,o,a=(e=e.replace(",",".")).split("T"),s=1,l=1,c=0,h=0,d=0,p=0,f=a[0],m=a[1];if(a=f.match(oCe),null!==a)i=+a[1],s=+a[2],l=+a[3];else if(a=f.match(tCe),null!==a)i=+a[1],s=+a[2];else if(a=f.match(eCe),null!==a)i=+a[1];else{let e;if(a=f.match(nCe),null!==a)i=+a[1],e=+a[2],r=r_(i);else if(a=f.match(iCe),null!==a){i=+a[1],e=7*+a[2]+(+a[3]||0)-new Date(Date.UTC(i,0,4)).getUTCDay()-3}n=new Date(Date.UTC(i,0,1)),n.setUTCDate(e),s=n.getUTCMonth()+1,l=n.getUTCDate()}if(r=r_(i),u(m)){a=m.match(aCe),null!==a?(c=+a[1],h=+a[2],d=+a[3],p=1e3*+(a[4]||0),o=5):(a=m.match(sCe),null!==a?(c=+a[1],h=+a[2],d=60*+(a[3]||0),o=4):(a=m.match(rCe),null!==a&&(c=+a[1],h=60*+(a[2]||0),o=3)));let e=a[o],t=+a[o+1],n=+(a[o+2]||0);switch(e){case"+":c-=t,h-=n;break;case"-":c+=t,h+=n;break;case"Z":break;default:h+=new Date(Date.UTC(i,s-1,l,c,h)).getTimezoneOffset()}}let _=60===d;for(_&&d--;h>=60;)h-=60,c++;for(;c>=24;)c-=24,l++;for(n=r&&2===s?vH:wH[s-1];l>n;)l-=n,s++,s>12&&(s-=12,i++),n=r&&2===s?vH:wH[s-1];for(;h<0;)h+=60,c--;for(;c<0;)c+=24,l--;for(;l<1;)s--,s<1&&(s+=12,i--),n=r&&2===s?vH:wH[s-1],l+=n;let g=IH(i,s,l,c,h,d,p);return u(t)?(s_(g[0],g[1],t),xP(t)):t=new Ct(g[0],g[1],Yn.UTC),_&&Ct.addSeconds(t,1,t),t},Ct.now=function(e){return Ct.fromDate(new Date,e)};var yP=new Ct(0,0,Yn.TAI);Ct.toGregorianDate=function(e,t){let i=!1,n=kK(e,yP);u(n)||(Ct.addSeconds(e,-1,yP),n=kK(yP,yP),i=!0);let r=n.dayNumber,o=n.secondsOfDay;o>=43200&&(r+=1);let a=r+68569|0,s=4*a/146097|0;a=a-((146097*s+3)/4|0)|0;let l=4e3*(a+1)/1461001|0;a=a-(1461*l/4|0)+31|0;let c=80*a/2447|0,h=a-(2447*c/80|0)|0;a=c/11|0;let d=c+2-12*a|0,p=100*(s-49)+l+a|0,f=o/Xn.SECONDS_PER_HOUR|0,m=o-f*Xn.SECONDS_PER_HOUR,_=m/Xn.SECONDS_PER_MINUTE|0;m-=_*Xn.SECONDS_PER_MINUTE;let g=0|m,y=(m-g)/Xn.SECONDS_PER_MILLISECOND;return f+=12,f>23&&(f-=24),i&&(g+=1),u(t)?(t.year=p,t.month=d,t.day=h,t.hour=f,t.minute=_,t.second=g,t.millisecond=y,t.isLeapSecond=i,t):new o_(p,d,h,f,_,g,y,i)},Ct.toDate=function(e){let t=Ct.toGregorianDate(e,VK),i=t.second;return t.isLeapSecond&&(i-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,i,t.millisecond))},Ct.toIso8601=function(e,t){let i,n=Ct.toGregorianDate(e,VK),r=n.year,o=n.month,a=n.day,s=n.hour,l=n.minute,c=n.second,h=n.millisecond;return 1e4===r&&1===o&&1===a&&0===s&&0===l&&0===c&&0===h&&(r=9999,o=12,a=31,s=24),u(t)||0===h?u(t)&&0!==t?(i=(.01*h).toFixed(t).replace(".","").slice(0,t),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}.${i}Z`):`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}Z`:(i=(.01*h).toString().replace(".",""),`${r.toString().padStart(4,"0")}-${o.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}T${s.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}.${i}Z`)},Ct.clone=function(e,t){if(u(e))return u(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new Ct(e.dayNumber,e.secondsOfDay,Yn.TAI)},Ct.compare=function(e,t){let i=e.dayNumber-t.dayNumber;return 0!==i?i:e.secondsOfDay-t.secondsOfDay},Ct.equals=function(e,t){return e===t||u(e)&&u(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},Ct.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(Ct.secondsDifference(e,t))<=i},Ct.totalDays=function(e){return e.dayNumber+e.secondsOfDay/Xn.SECONDS_PER_DAY},Ct.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*Xn.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},Ct.daysDifference=function(e,t){return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/Xn.SECONDS_PER_DAY},Ct.computeTaiMinusUtc=function(e){Rb.julianDate=e;let t=Ct.leapSeconds,i=Eo(t,Rb,DH);return i<0&&(i=~i,--i,i<0&&(i=0)),t[i].offset},Ct.addSeconds=function(e,t,i){return s_(e.dayNumber,e.secondsOfDay+t,i)},Ct.addMinutes=function(e,t,i){let n=e.secondsOfDay+t*Xn.SECONDS_PER_MINUTE;return s_(e.dayNumber,n,i)},Ct.addHours=function(e,t,i){let n=e.secondsOfDay+t*Xn.SECONDS_PER_HOUR;return s_(e.dayNumber,n,i)},Ct.addDays=function(e,t,i){return s_(e.dayNumber+t,e.secondsOfDay,i)},Ct.lessThan=function(e,t){return Ct.compare(e,t)<0},Ct.lessThanOrEquals=function(e,t){return Ct.compare(e,t)<=0},Ct.greaterThan=function(e,t){return Ct.compare(e,t)>0},Ct.greaterThanOrEquals=function(e,t){return Ct.compare(e,t)>=0},Ct.prototype.clone=function(e){return Ct.clone(this,e)},Ct.prototype.equals=function(e){return Ct.equals(this,e)},Ct.prototype.equalsEpsilon=function(e,t){return Ct.equalsEpsilon(this,e,t)},Ct.prototype.toString=function(){return Ct.toIso8601(this)},Ct.leapSeconds=[new zi(new Ct(2441317,43210,Yn.TAI),10),new zi(new Ct(2441499,43211,Yn.TAI),11),new zi(new Ct(2441683,43212,Yn.TAI),12),new zi(new Ct(2442048,43213,Yn.TAI),13),new zi(new Ct(2442413,43214,Yn.TAI),14),new zi(new Ct(2442778,43215,Yn.TAI),15),new zi(new Ct(2443144,43216,Yn.TAI),16),new zi(new Ct(2443509,43217,Yn.TAI),17),new zi(new Ct(2443874,43218,Yn.TAI),18),new zi(new Ct(2444239,43219,Yn.TAI),19),new zi(new Ct(2444786,43220,Yn.TAI),20),new zi(new Ct(2445151,43221,Yn.TAI),21),new zi(new Ct(2445516,43222,Yn.TAI),22),new zi(new Ct(2446247,43223,Yn.TAI),23),new zi(new Ct(2447161,43224,Yn.TAI),24),new zi(new Ct(2447892,43225,Yn.TAI),25),new zi(new Ct(2448257,43226,Yn.TAI),26),new zi(new Ct(2448804,43227,Yn.TAI),27),new zi(new Ct(2449169,43228,Yn.TAI),28),new zi(new Ct(2449534,43229,Yn.TAI),29),new zi(new Ct(2450083,43230,Yn.TAI),30),new zi(new Ct(2450630,43231,Yn.TAI),31),new zi(new Ct(2451179,43232,Yn.TAI),32),new zi(new Ct(2453736,43233,Yn.TAI),33),new zi(new Ct(2454832,43234,Yn.TAI),34),new zi(new Ct(2456109,43235,Yn.TAI),35),new zi(new Ct(2457204,43236,Yn.TAI),36),new zi(new Ct(2457754,43237,Yn.TAI),37)];var J=Ct;function QE(e){e=y(e,y.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._addNewLeapSeconds=y(e.addNewLeapSeconds,!0),u(e.data)?UK(this,e.data):UK(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function cCe(e,t){return J.compare(e.julianDate,t)}function UK(e,t){if(!u(t.columnNames))throw new ue("Error in loaded EOP data: The columnNames property is required.");if(!u(t.samples))throw new ue("Error in loaded EOP data: The samples property is required.");let i=t.columnNames.indexOf("modifiedJulianDateUtc"),n=t.columnNames.indexOf("xPoleWanderRadians"),r=t.columnNames.indexOf("yPoleWanderRadians"),o=t.columnNames.indexOf("ut1MinusUtcSeconds"),a=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),s=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),l=t.columnNames.indexOf("taiMinusUtcSeconds");if(i<0||n<0||r<0||o<0||a<0||s<0||l<0)throw new ue("Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns");let c=e._samples=t.samples,h=e._dates=[];e._dateColumn=i,e._xPoleWanderRadiansColumn=n,e._yPoleWanderRadiansColumn=r,e._ut1MinusUtcSecondsColumn=o,e._xCelestialPoleOffsetRadiansColumn=a,e._yCelestialPoleOffsetRadiansColumn=s,e._taiMinusUtcSecondsColumn=l,e._columnCount=t.columnNames.length,e._lastIndex=void 0;let d,p=e._addNewLeapSeconds;for(let t=0,n=c.length;t<n;t+=e._columnCount){let e=c[t+i],n=c[t+l],r=e+Xn.MODIFIED_JULIAN_DATE_DIFFERENCE,o=new J(r,n,Yn.TAI);if(h.push(o),p){if(n!==d&&u(d)){let e=J.leapSeconds,t=Eo(e,o,cCe);if(t<0){let i=new zi(o,n);e.splice(~t,0,i)}}d=n}}}function zK(e,t,i,n,r){let o=i*n;r.xPoleWander=t[o+e._xPoleWanderRadiansColumn],r.yPoleWander=t[o+e._yPoleWanderRadiansColumn],r.xPoleOffset=t[o+e._xCelestialPoleOffsetRadiansColumn],r.yPoleOffset=t[o+e._yCelestialPoleOffsetRadiansColumn],r.ut1MinusUtc=t[o+e._ut1MinusUtcSecondsColumn]}function $E(e,t,i){return t+e*(i-t)}function HK(e,t,i,n,r,o,a){let s=e._columnCount;if(o>t.length-1)return a.xPoleWander=0,a.yPoleWander=0,a.xPoleOffset=0,a.yPoleOffset=0,a.ut1MinusUtc=0,a;let l=t[r],u=t[o];if(l.equals(u)||n.equals(l))return zK(e,i,r,s,a),a;if(n.equals(u))return zK(e,i,o,s,a),a;let c=J.secondsDifference(n,l)/J.secondsDifference(u,l),h=r*s,d=o*s,p=i[h+e._ut1MinusUtcSecondsColumn],f=i[d+e._ut1MinusUtcSecondsColumn],m=f-p;if(m>.5||m<-.5){let t=i[h+e._taiMinusUtcSecondsColumn],r=i[d+e._taiMinusUtcSecondsColumn];t!==r&&(u.equals(n)?p=f:f-=r-t)}return a.xPoleWander=$E(c,i[h+e._xPoleWanderRadiansColumn],i[d+e._xPoleWanderRadiansColumn]),a.yPoleWander=$E(c,i[h+e._yPoleWanderRadiansColumn],i[d+e._yPoleWanderRadiansColumn]),a.xPoleOffset=$E(c,i[h+e._xCelestialPoleOffsetRadiansColumn],i[d+e._xCelestialPoleOffsetRadiansColumn]),a.yPoleOffset=$E(c,i[h+e._yCelestialPoleOffsetRadiansColumn],i[d+e._yCelestialPoleOffsetRadiansColumn]),a.ut1MinusUtc=$E(c,p,f),a}QE.fromUrl=async function(e,t){t=y(t,y.EMPTY_OBJECT);let i,n=ve.createIfNeeded(e);try{i=await n.fetchJson()}catch{throw new ue(`An error occurred while retrieving the EOP data from the URL ${n.url}.`)}return new QE({addNewLeapSeconds:t.addNewLeapSeconds,data:i})},QE.NONE=Object.freeze({compute:function(e,t){return u(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new $y(0,0,0,0,0),t}}),QE.prototype.compute=function(e,t){if(!u(this._samples))return;if(u(t)||(t=new $y(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;let i=this._dates,n=this._lastIndex,r=0,o=0;if(u(n)){let a=i[n],s=i[n+1],l=J.lessThanOrEquals(a,e),c=!u(s),h=c||J.greaterThanOrEquals(s,e);if(l&&h)return r=n,!c&&s.equals(e)&&++r,o=r+1,HK(this,i,this._samples,e,r,o,t),t}let a=Eo(i,e,J.compare,this._dateColumn);return a>=0?(a<i.length-1&&i[a+1].equals(e)&&++a,r=a,o=a):(o=~a,r=o-1,r<0&&(r=0)),this._lastIndex=r,HK(this,i,this._samples,e,r,o,t),t};var bP=QE;function Ea(e,t,i){this.heading=y(e,0),this.pitch=y(t,0),this.roll=y(i,0)}Ea.fromQuaternion=function(e,t){u(t)||(t=new Ea);let i=2*(e.w*e.y-e.z*e.x),n=1-2*(e.x*e.x+e.y*e.y),r=2*(e.w*e.x+e.y*e.z),o=1-2*(e.y*e.y+e.z*e.z),a=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(a,o),t.roll=Math.atan2(r,n),t.pitch=-P.asinClamped(i),t},Ea.fromDegrees=function(e,t,i,n){return u(n)||(n=new Ea),n.heading=e*P.RADIANS_PER_DEGREE,n.pitch=t*P.RADIANS_PER_DEGREE,n.roll=i*P.RADIANS_PER_DEGREE,n},Ea.clone=function(e,t){if(u(e))return u(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new Ea(e.heading,e.pitch,e.roll)},Ea.equals=function(e,t){return e===t||u(e)&&u(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},Ea.equalsEpsilon=function(e,t,i,n){return e===t||u(e)&&u(t)&&P.equalsEpsilon(e.heading,t.heading,i,n)&&P.equalsEpsilon(e.pitch,t.pitch,i,n)&&P.equalsEpsilon(e.roll,t.roll,i,n)},Ea.prototype.clone=function(e){return Ea.clone(this,e)},Ea.prototype.equals=function(e){return Ea.equals(this,e)},Ea.prototype.equalsEpsilon=function(e,t,i){return Ea.equalsEpsilon(this,e,t,i)},Ea.prototype.toString=function(){return`(${this.heading}, ${this.pitch}, ${this.roll})`};var oc=Ea;function lCe(e,t,i){this.x=e,this.y=t,this.s=i}var Mb=lCe;function MH(e){e=y(e,y.EMPTY_OBJECT),this._xysFileUrlTemplate=ve.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=y(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=y(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new J(this._sampleZeroJulianEphemerisDate,0,Yn.TAI),this._stepSizeDays=y(e.stepSizeDays,1),this._samplesPerXysFile=y(e.samplesPerXysFile,1e3),this._totalSamples=y(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];let t=this._interpolationOrder,i=this._denominators=new Array(t+1),n=this._xTable=new Array(t+1),r=Math.pow(this._stepSizeDays,t);for(let e=0;e<=t;++e){i[e]=r,n[e]=e*this._stepSizeDays;for(let n=0;n<=t;++n)n!==e&&(i[e]*=e-n);i[e]=1/i[e]}this._work=new Array(t+1),this._coef=new Array(t+1)}var uCe=new J(0,0,Yn.TAI);function OH(e,t,i){let n=uCe;return n.dayNumber=t,n.secondsOfDay=i,J.daysDifference(n,e._sampleZeroDateTT)}function RH(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];let i,n=e._xysFileUrlTemplate;i=u(n)?n.getDerivedResource({templateValues:{0:t}}):new ve({url:$t(`Assets/IAU2006_XYS/IAU2006_XYS_${t}.json`)});let r=i.fetchJson().then((function(i){e._chunkDownloadsInProgress[t]=!1;let n=e._samples,r=i.samples,o=t*e._samplesPerXysFile*3;for(let e=0,t=r.length;e<t;++e)n[o+e]=r[e]}));return e._chunkDownloadsInProgress[t]=r,r}MH.prototype.preload=function(e,t,i,n){let r=OH(this,e,t),o=OH(this,i,n),a=r/this._stepSizeDays-this._interpolationOrder/2|0;a<0&&(a=0);let s=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;s>=this._totalSamples&&(s=this._totalSamples-1);let l=a/this._samplesPerXysFile|0,u=s/this._samplesPerXysFile|0,c=[];for(let e=l;e<=u;++e)c.push(RH(this,e));return Promise.all(c)},MH.prototype.computeXysRadians=function(e,t,i){let n=OH(this,e,t);if(n<0)return;let r=n/this._stepSizeDays|0;if(r>=this._totalSamples)return;let o=this._interpolationOrder,a=r-(o/2|0);a<0&&(a=0);let s=a+o;s>=this._totalSamples&&(s=this._totalSamples-1,a=s-o,a<0&&(a=0));let l=!1,c=this._samples;if(u(c[3*a])||(RH(this,a/this._samplesPerXysFile|0),l=!0),u(c[3*s])||(RH(this,s/this._samplesPerXysFile|0),l=!0),l)return;u(i)?(i.x=0,i.y=0,i.s=0):i=new Mb(0,0,0);let h,d,p=n-a*this._stepSizeDays,f=this._work,m=this._denominators,_=this._coef,g=this._xTable;for(h=0;h<=o;++h)f[h]=p-g[h];for(h=0;h<=o;++h){for(_[h]=1,d=0;d<=o;++d)d!==h&&(_[h]*=f[d]);_[h]*=m[h];let e=3*(a+h);i.x+=_[h]*c[e++],i.y+=_[h]*c[e++],i.s+=_[h]*c[e]}return i};var TP=MH,a_,dr={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},Hc={};Object.defineProperties(Hc,{element:{get:function(){if(Hc.supportsFullscreen())return document[dr.fullscreenElement]}},changeEventName:{get:function(){if(Hc.supportsFullscreen())return dr.fullscreenchange}},errorEventName:{get:function(){if(Hc.supportsFullscreen())return dr.fullscreenerror}},enabled:{get:function(){if(Hc.supportsFullscreen())return document[dr.fullscreenEnabled]}},fullscreen:{get:function(){if(Hc.supportsFullscreen())return null!==Hc.element}}}),Hc.supportsFullscreen=function(){if(u(a_))return a_;a_=!1;let e=document.body;if("function"==typeof e.requestFullscreen)return dr.requestFullscreen="requestFullscreen",dr.exitFullscreen="exitFullscreen",dr.fullscreenEnabled="fullscreenEnabled",dr.fullscreenElement="fullscreenElement",dr.fullscreenchange="fullscreenchange",dr.fullscreenerror="fullscreenerror",a_=!0;let t,i=["webkit","moz","o","ms","khtml"];for(let n=0,r=i.length;n<r;++n){let r=i[n];t=`${r}RequestFullscreen`,"function"==typeof e[t]?(dr.requestFullscreen=t,a_=!0):(t=`${r}RequestFullScreen`,"function"==typeof e[t]&&(dr.requestFullscreen=t,a_=!0)),t=`${r}ExitFullscreen`,"function"==typeof document[t]?dr.exitFullscreen=t:(t=`${r}CancelFullScreen`,"function"==typeof document[t]&&(dr.exitFullscreen=t)),t=`${r}FullscreenEnabled`,void 0!==document[t]?dr.fullscreenEnabled=t:(t=`${r}FullScreenEnabled`,void 0!==document[t]&&(dr.fullscreenEnabled=t)),t=`${r}FullscreenElement`,void 0!==document[t]?dr.fullscreenElement=t:(t=`${r}FullScreenElement`,void 0!==document[t]&&(dr.fullscreenElement=t)),t=`${r}fullscreenchange`,void 0!==document[`on${t}`]&&("ms"===r&&(t="MSFullscreenChange"),dr.fullscreenchange=t),t=`${r}fullscreenerror`,void 0!==document[`on${t}`]&&("ms"===r&&(t="MSFullscreenError"),dr.fullscreenerror=t)}return a_},Hc.requestFullscreen=function(e,t){Hc.supportsFullscreen()&&e[dr.requestFullscreen]({vrDisplay:t})},Hc.exitFullscreen=function(){Hc.supportsFullscreen()&&document[dr.exitFullscreen]()},Hc._names=dr;var hr=Hc,Sa,AP,GK,CP,WK,EP,BH,JE,kH,SP,XK,wP,UH,LH,NH,FH,KK,vP;function Qy(e){let t=e.split(".");for(let e=0,i=t.length;e<i;++e)t[e]=parseInt(t[e],10);return t}function VH(){if(!u(AP)&&(AP=!1,!DP())){let e=/ Chrome\/([\.0-9]+)/.exec(Sa.userAgent);null!==e&&(AP=!0,GK=Qy(e[1]))}return AP}function fCe(){return VH()&&GK}function jK(){if(!u(CP)&&(CP=!1,!VH()&&!DP()&&/ Safari\/[\.0-9]+/.test(Sa.userAgent))){let e=/ Version\/([\.0-9]+)/.exec(Sa.userAgent);null!==e&&(CP=!0,WK=Qy(e[1]))}return CP}function dCe(){return jK()&&WK}function qK(){if(!u(EP)){EP=!1;let e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(Sa.userAgent);null!==e&&(EP=!0,(BH=Qy(e[1])).isNightly=!!e[2])}return EP}function hCe(){return qK()&&BH}function YK(){if(!u(JE)){let e;JE=!1,"Microsoft Internet Explorer"===Sa.appName?(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(Sa.userAgent),null!==e&&(JE=!0,kH=Qy(e[1]))):"Netscape"===Sa.appName&&(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(Sa.userAgent),null!==e&&(JE=!0,kH=Qy(e[1])))}return JE}function mCe(){return YK()&&kH}function DP(){if(!u(SP)){SP=!1;let e=/ Edg\/([\.0-9]+)/.exec(Sa.userAgent);null!==e&&(SP=!0,XK=Qy(e[1]))}return SP}function pCe(){return DP()&&XK}function IP(){if(!u(wP)){wP=!1;let e=/Firefox\/([\.0-9]+)/.exec(Sa.userAgent);null!==e&&(wP=!0,UH=Qy(e[1]))}return wP}function _Ce(){return u(LH)||(LH=/Windows/i.test(Sa.appVersion)),LH}function gCe(){return u(NH)||(NH="iPhone"===navigator.platform||"iPod"===navigator.platform||"iPad"===navigator.platform),NH}function yCe(){return IP()&&UH}function xCe(){return u(FH)||(FH=!IP()&&typeof PointerEvent<"u"&&(!u(Sa.pointerEnabled)||Sa.pointerEnabled)),FH}function ZK(){if(!u(vP)){let e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");let t=e.style.imageRendering;(vP=u(t)&&""!==t)&&(KK=t)}return vP}function bCe(){return ZK()?KK:void 0}function rc(){return rc._result}Sa=typeof navigator<"u"?navigator:{},rc._promise=void 0,rc._result=void 0,rc.initialize=function(){return u(rc._promise)||(rc._promise=new Promise((e=>{let t=new Image;t.onload=function(){rc._result=t.width>0&&t.height>0,e(rc._result)},t.onerror=function(){rc._result=!1,e(rc._result)},t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"}))),rc._promise},Object.defineProperties(rc,{initialized:{get:function(){return u(rc._result)}}});var Lb=[];typeof ArrayBuffer<"u"&&(Lb.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),typeof Uint8ClampedArray<"u"&&Lb.push(Uint8ClampedArray),typeof Uint8ClampedArray<"u"&&Lb.push(Uint8ClampedArray),typeof BigInt64Array<"u"&&Lb.push(BigInt64Array),typeof BigUint64Array<"u"&&Lb.push(BigUint64Array));var vu={isChrome:VH,chromeVersion:fCe,isSafari:jK,safariVersion:dCe,isWebkit:qK,webkitVersion:hCe,isInternetExplorer:YK,internetExplorerVersion:mCe,isEdge:DP,edgeVersion:pCe,isFirefox:IP,firefoxVersion:yCe,isWindows:_Ce,isIPadOrIOS:gCe,hardwareConcurrency:y(Sa.hardwareConcurrency,3),supportsPointerEvents:xCe,supportsImageRenderingPixelated:ZK,supportsWebP:rc,imageRenderingValue:bCe,typedArrayTypes:Lb,supportsBasis:function(e){return vu.supportsWebAssembly()&&e.context.supportsBasis},supportsFullscreen:function(){return hr.supportsFullscreen()},supportsTypedArrays:function(){return typeof ArrayBuffer<"u"},supportsBigInt64Array:function(){return typeof BigInt64Array<"u"},supportsBigUint64Array:function(){return typeof BigUint64Array<"u"},supportsBigInt:function(){return typeof BigInt<"u"},supportsWebWorkers:function(){return typeof Worker<"u"},supportsWebAssembly:function(){return typeof WebAssembly<"u"},supportsWebgl2:function(e){return e.context.webgl2},supportsEsmWebWorkers:function(){return!IP()||parseInt(UH)>=114}},Bt=vu;function tt(e,t,i,n){this.x=y(e,0),this.y=y(t,0),this.z=y(i,0),this.w=y(n,0)}var eS=new h;tt.fromAxisAngle=function(e,t,i){let n=t/2,r=Math.sin(n),o=(eS=h.normalize(e,eS)).x*r,a=eS.y*r,s=eS.z*r,l=Math.cos(n);return u(i)?(i.x=o,i.y=a,i.z=s,i.w=l,i):new tt(o,a,s,l)};var TCe=[1,2,0],ACe=new Array(3);tt.fromRotationMatrix=function(e,t){let i,n,r,o,a,s=e[$.COLUMN0ROW0],l=e[$.COLUMN1ROW1],c=e[$.COLUMN2ROW2],h=s+l+c;if(h>0)i=Math.sqrt(h+1),a=.5*i,i=.5/i,n=(e[$.COLUMN1ROW2]-e[$.COLUMN2ROW1])*i,r=(e[$.COLUMN2ROW0]-e[$.COLUMN0ROW2])*i,o=(e[$.COLUMN0ROW1]-e[$.COLUMN1ROW0])*i;else{let t=TCe,u=0;l>s&&(u=1),c>s&&c>l&&(u=2);let h=t[u],d=t[h];i=Math.sqrt(e[$.getElementIndex(u,u)]-e[$.getElementIndex(h,h)]-e[$.getElementIndex(d,d)]+1);let p=ACe;p[u]=.5*i,i=.5/i,a=(e[$.getElementIndex(d,h)]-e[$.getElementIndex(h,d)])*i,p[h]=(e[$.getElementIndex(h,u)]+e[$.getElementIndex(u,h)])*i,p[d]=(e[$.getElementIndex(d,u)]+e[$.getElementIndex(u,d)])*i,n=-p[0],r=-p[1],o=-p[2]}return u(t)?(t.x=n,t.y=r,t.z=o,t.w=a,t):new tt(n,r,o,a)};var $K=new tt,QK=new tt,zH=new tt,JK=new tt;tt.fromHeadingPitchRoll=function(e,t){return JK=tt.fromAxisAngle(h.UNIT_X,e.roll,$K),zH=tt.fromAxisAngle(h.UNIT_Y,-e.pitch,t),t=tt.multiply(zH,JK,zH),QK=tt.fromAxisAngle(h.UNIT_Z,-e.heading,$K),tt.multiply(QK,t,t)};var PP=new h,HH=new h,Nf=new tt,eZ=new tt,OP=new tt;tt.packedLength=4,tt.pack=function(e,t,i){return i=y(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.z,t[i]=e.w,t},tt.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new tt),i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3],i},tt.packedInterpolationLength=3,tt.convertPackedArrayForInterpolation=function(e,t,i,n){tt.unpack(e,4*i,OP),tt.conjugate(OP,OP);for(let r=0,o=i-t+1;r<o;r++){let i=3*r;tt.unpack(e,4*(t+r),Nf),tt.multiply(Nf,OP,Nf),Nf.w<0&&tt.negate(Nf,Nf),tt.computeAxis(Nf,PP);let o=tt.computeAngle(Nf);u(n)||(n=[]),n[i]=PP.x*o,n[i+1]=PP.y*o,n[i+2]=PP.z*o}},tt.unpackInterpolationResult=function(e,t,i,n,r){u(r)||(r=new tt),h.fromArray(e,0,HH);let o=h.magnitude(HH);return tt.unpack(t,4*n,eZ),0===o?tt.clone(tt.IDENTITY,Nf):tt.fromAxisAngle(HH,o,Nf),tt.multiply(Nf,eZ,r)},tt.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new tt(e.x,e.y,e.z,e.w)},tt.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},tt.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},tt.magnitude=function(e){return Math.sqrt(tt.magnitudeSquared(e))},tt.normalize=function(e,t){let i=1/tt.magnitude(e),n=e.x*i,r=e.y*i,o=e.z*i,a=e.w*i;return t.x=n,t.y=r,t.z=o,t.w=a,t},tt.inverse=function(e,t){let i=tt.magnitudeSquared(e);return t=tt.conjugate(e,t),tt.multiplyByScalar(t,1/i,t)},tt.add=function(e,t,i){return i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w,i},tt.subtract=function(e,t,i){return i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w,i},tt.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},tt.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},tt.multiply=function(e,t,i){let n=e.x,r=e.y,o=e.z,a=e.w,s=t.x,l=t.y,u=t.z,c=t.w,h=a*s+n*c+r*u-o*l,d=a*l-n*u+r*c+o*s,p=a*u+n*l-r*s+o*c,f=a*c-n*s-r*l-o*u;return i.x=h,i.y=d,i.z=p,i.w=f,i},tt.multiplyByScalar=function(e,t,i){return i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t,i},tt.divideByScalar=function(e,t,i){return i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i.w=e.w/t,i},tt.computeAxis=function(e,t){let i=e.w;if(Math.abs(i-1)<P.EPSILON6)return t.x=t.y=t.z=0,t;let n=1/Math.sqrt(1-i*i);return t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t},tt.computeAngle=function(e){return Math.abs(e.w-1)<P.EPSILON6?0:2*Math.acos(e.w)};var GH=new tt;tt.lerp=function(e,t,i,n){return GH=tt.multiplyByScalar(t,i,GH),n=tt.multiplyByScalar(e,1-i,n),tt.add(GH,n,n)};var tZ=new tt,WH=new tt,jH=new tt;tt.slerp=function(e,t,i,n){let r=tt.dot(e,t),o=t;if(r<0&&(r=-r,o=tZ=tt.negate(t,tZ)),1-r<P.EPSILON6)return tt.lerp(e,o,i,n);let a=Math.acos(r);return WH=tt.multiplyByScalar(e,Math.sin((1-i)*a),WH),jH=tt.multiplyByScalar(o,Math.sin(i*a),jH),n=tt.add(WH,jH,n),tt.multiplyByScalar(n,1/Math.sin(a),n)},tt.log=function(e,t){let i=P.acosClamped(e.w),n=0;return 0!==i&&(n=i/Math.sin(i)),h.multiplyByScalar(e,n,t)},tt.exp=function(e,t){let i=h.magnitude(e),n=0;return 0!==i&&(n=Math.sin(i)/i),t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t.w=Math.cos(i),t};var CCe=new h,ECe=new h,tS=new tt,Nb=new tt;tt.computeInnerQuadrangle=function(e,t,i,n){let r=tt.conjugate(t,tS);tt.multiply(r,i,Nb);let o=tt.log(Nb,CCe);tt.multiply(r,e,Nb);let a=tt.log(Nb,ECe);return h.add(o,a,o),h.multiplyByScalar(o,.25,o),h.negate(o,o),tt.exp(o,tS),tt.multiply(t,tS,n)},tt.squad=function(e,t,i,n,r,o){let a=tt.slerp(e,t,r,tS),s=tt.slerp(i,n,r,Nb);return tt.slerp(a,s,2*r*(1-r),o)};var SCe=new tt,nZ=1.9011074535173003,RP=Bt.supportsTypedArrays()?new Float32Array(8):[],MP=Bt.supportsTypedArrays()?new Float32Array(8):[],Dm=Bt.supportsTypedArrays()?new Float32Array(8):[],Im=Bt.supportsTypedArrays()?new Float32Array(8):[];for(let e=0;e<7;++e){let t=e+1,i=2*t+1;RP[e]=1/(t*i),MP[e]=t/i}RP[7]=nZ/136,MP[7]=8*nZ/17,tt.fastSlerp=function(e,t,i,n){let r,o=tt.dot(e,t);o>=0?r=1:(r=-1,o=-o);let a=o-1,s=1-i,l=i*i,u=s*s;for(let e=7;e>=0;--e)Dm[e]=(RP[e]*l-MP[e])*a,Im[e]=(RP[e]*u-MP[e])*a;let c=r*i*(1+Dm[0]*(1+Dm[1]*(1+Dm[2]*(1+Dm[3]*(1+Dm[4]*(1+Dm[5]*(1+Dm[6]*(1+Dm[7])))))))),h=s*(1+Im[0]*(1+Im[1]*(1+Im[2]*(1+Im[3]*(1+Im[4]*(1+Im[5]*(1+Im[6]*(1+Im[7])))))))),d=tt.multiplyByScalar(e,h,SCe);return tt.multiplyByScalar(t,c,n),tt.add(d,n,n)},tt.fastSquad=function(e,t,i,n,r,o){let a=tt.fastSlerp(e,t,r,tS),s=tt.fastSlerp(i,n,r,Nb);return tt.fastSlerp(a,s,2*r*(1-r),o)},tt.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},tt.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e.x-t.x)<=i&&Math.abs(e.y-t.y)<=i&&Math.abs(e.z-t.z)<=i&&Math.abs(e.w-t.w)<=i},tt.ZERO=Object.freeze(new tt(0,0,0,0)),tt.IDENTITY=Object.freeze(new tt(0,0,0,1)),tt.prototype.clone=function(e){return tt.clone(this,e)},tt.prototype.equals=function(e){return tt.equals(this,e)},tt.prototype.equalsEpsilon=function(e,t){return tt.equalsEpsilon(this,e,t)},tt.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};var Le=tt,Hi={},qH={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Fb={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},YH={},Gc={east:new h,north:new h,up:new h,west:new h,south:new h,down:new h},c_=new h,l_=new h,u_=new h;Hi.localFrameToFixedFrameGenerator=function(e,t){if(!qH.hasOwnProperty(e)||!qH[e].hasOwnProperty(t))throw new de("firstAxis and secondAxis must be east, north, up, west, south or down.");let i,n=qH[e][t],r=e+t;return u(YH[r])?i=YH[r]:(i=function(i,r,o){if(u(o)||(o=new L),h.equalsEpsilon(i,h.ZERO,P.EPSILON14))h.unpack(Fb[e],0,c_),h.unpack(Fb[t],0,l_),h.unpack(Fb[n],0,u_);else if(P.equalsEpsilon(i.x,0,P.EPSILON14)&&P.equalsEpsilon(i.y,0,P.EPSILON14)){let r=P.sign(i.z);h.unpack(Fb[e],0,c_),"east"!==e&&"west"!==e&&h.multiplyByScalar(c_,r,c_),h.unpack(Fb[t],0,l_),"east"!==t&&"west"!==t&&h.multiplyByScalar(l_,r,l_),h.unpack(Fb[n],0,u_),"east"!==n&&"west"!==n&&h.multiplyByScalar(u_,r,u_)}else{(r=y(r,ie.WGS84)).geodeticSurfaceNormal(i,Gc.up);let o=Gc.up,a=Gc.east;a.x=-i.y,a.y=i.x,a.z=0,h.normalize(a,Gc.east),h.cross(o,a,Gc.north),h.multiplyByScalar(Gc.up,-1,Gc.down),h.multiplyByScalar(Gc.east,-1,Gc.west),h.multiplyByScalar(Gc.north,-1,Gc.south),c_=Gc[e],l_=Gc[t],u_=Gc[n]}return o[0]=c_.x,o[1]=c_.y,o[2]=c_.z,o[3]=0,o[4]=l_.x,o[5]=l_.y,o[6]=l_.z,o[7]=0,o[8]=u_.x,o[9]=u_.y,o[10]=u_.z,o[11]=0,o[12]=i.x,o[13]=i.y,o[14]=i.z,o[15]=1,o},YH[r]=i),i},Hi.eastNorthUpToFixedFrame=Hi.localFrameToFixedFrameGenerator("east","north"),Hi.northEastDownToFixedFrame=Hi.localFrameToFixedFrameGenerator("north","east"),Hi.northUpEastToFixedFrame=Hi.localFrameToFixedFrameGenerator("north","up"),Hi.northWestUpToFixedFrame=Hi.localFrameToFixedFrameGenerator("north","west");var wCe=new Le,vCe=new h(1,1,1),DCe=new L;Hi.headingPitchRollToFixedFrame=function(e,t,i,n,r){n=y(n,Hi.eastNorthUpToFixedFrame);let o=Le.fromHeadingPitchRoll(t,wCe),a=L.fromTranslationQuaternionRotationScale(h.ZERO,o,vCe,DCe);return r=n(e,i,r),L.multiply(r,a,r)};var ICe=new L,PCe=new $;Hi.headingPitchRollQuaternion=function(e,t,i,n,r){let o=Hi.headingPitchRollToFixedFrame(e,t,i,n,ICe),a=L.getMatrix3(o,PCe);return Le.fromRotationMatrix(a,r)};var OCe=new h(1,1,1),RCe=new h,iZ=new L,MCe=new L,LCe=new $,NCe=new Le;Hi.fixedFrameToHeadingPitchRoll=function(e,t,i,n){t=y(t,ie.WGS84),i=y(i,Hi.eastNorthUpToFixedFrame),u(n)||(n=new oc);let r=L.getTranslation(e,RCe);if(h.equals(r,h.ZERO))return n.heading=0,n.pitch=0,n.roll=0,n;let o=L.inverseTransformation(i(r,t,iZ),iZ),a=L.setScale(e,OCe,MCe);a=L.setTranslation(a,h.ZERO,a),o=L.multiply(o,a,o);let s=Le.fromRotationMatrix(L.getMatrix3(o,LCe),NCe);return s=Le.normalize(s,s),oc.fromQuaternion(s,n)};var FCe=24110.54841,BCe=8640184.812866,kCe=.093104,VCe=-62e-7,UCe=11772758384668e-32,zCe=72921158553e-15,HCe=P.TWO_PI/86400,LP=new J;Hi.computeTemeToPseudoFixedMatrix=function(e,t){let i,n=(LP=J.addSeconds(e,-J.computeTaiMinusUtc(e),LP)).dayNumber,r=LP.secondsOfDay,o=n-2451545;i=r>=43200?(o+.5)/Xn.DAYS_PER_JULIAN_CENTURY:(o-.5)/Xn.DAYS_PER_JULIAN_CENTURY;let a=(FCe+i*(BCe+i*(kCe+i*VCe)))*HCe%P.TWO_PI+(zCe+UCe*(n-2451545.5))*((r+.5*Xn.SECONDS_PER_DAY)%Xn.SECONDS_PER_DAY),s=Math.cos(a),l=Math.sin(a);return u(t)?(t[0]=s,t[1]=-l,t[2]=0,t[3]=l,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new $(s,l,0,-l,s,0,0,0,1)},Hi.iau2006XysData=new TP,Hi.earthOrientationParameters=bP.NONE;var ZH=32.184,GCe=2451545;Hi.preloadIcrfFixed=function(e){let t=e.start.dayNumber,i=e.start.secondsOfDay+ZH,n=e.stop.dayNumber,r=e.stop.secondsOfDay+ZH;return Hi.iau2006XysData.preload(t,i,n,r)},Hi.computeIcrfToFixedMatrix=function(e,t){u(t)||(t=new $);let i=Hi.computeFixedToIcrfMatrix(e,t);if(u(i))return $.transpose(i,t)};var WCe=new Mb(0,0,0),jCe=new $y(0,0,0,0,0,0),XH=new $,KH=new $;Hi.computeFixedToIcrfMatrix=function(e,t){u(t)||(t=new $);let i=Hi.earthOrientationParameters.compute(e,jCe);if(!u(i))return;let n=e.dayNumber,r=e.secondsOfDay+ZH,o=Hi.iau2006XysData.computeXysRadians(n,r,WCe);if(!u(o))return;let a=o.x+i.xPoleOffset,s=o.y+i.yPoleOffset,l=1/(1+Math.sqrt(1-a*a-s*s)),c=XH;c[0]=1-l*a*a,c[3]=-l*a*s,c[6]=a,c[1]=-l*a*s,c[4]=1-l*s*s,c[7]=s,c[2]=-a,c[5]=-s,c[8]=1-l*(a*a+s*s);let h=$.fromRotationZ(-o.s,KH),d=$.multiply(c,h,XH),p=e.dayNumber-2451545,f=(e.secondsOfDay-J.computeTaiMinusUtc(e)+i.ut1MinusUtc)/Xn.SECONDS_PER_DAY,m=.779057273264+f+.00273781191135448*(p+f);m=m%1*P.TWO_PI;let _=$.fromRotationZ(m,KH),g=$.multiply(d,_,XH),y=Math.cos(i.xPoleWander),v=Math.cos(i.yPoleWander),b=Math.sin(i.xPoleWander),A=Math.sin(i.yPoleWander),T=n-GCe+r/Xn.SECONDS_PER_DAY;T/=36525;let E=-47e-6*T*P.RADIANS_PER_DEGREE/3600,C=Math.cos(E),x=Math.sin(E),S=KH;return S[0]=y*C,S[1]=y*x,S[2]=b,S[3]=-v*x+A*b*C,S[4]=v*C+A*b*x,S[5]=-A*y,S[6]=-A*x-v*b*C,S[7]=A*C-v*b*x,S[8]=v*y,$.multiply(g,S,t)};var qCe=new oe;Hi.pointToWindowCoordinates=function(e,t,i,n){return(n=Hi.pointToGLWindowCoordinates(e,t,i,n)).y=2*t[5]-n.y,n},Hi.pointToGLWindowCoordinates=function(e,t,i,n){u(n)||(n=new U);let r=qCe;return L.multiplyByVector(e,oe.fromElements(i.x,i.y,i.z,1,r),r),oe.multiplyByScalar(r,1/r.w,r),L.multiplyByVector(t,r,r),U.fromCartesian4(r,n)};var YCe=new h,XCe=new h,KCe=new h;Hi.rotationMatrixFromPositionVelocity=function(e,t,i,n){let r=y(i,ie.WGS84).geodeticSurfaceNormal(e,YCe),o=h.cross(t,r,XCe);h.equalsEpsilon(o,h.ZERO,P.EPSILON6)&&(o=h.clone(h.UNIT_X,o));let a=h.cross(o,t,KCe);return h.normalize(a,a),h.cross(t,a,o),h.negate(o,o),h.normalize(o,o),u(n)||(n=new $),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=o.x,n[4]=o.y,n[5]=o.z,n[6]=a.x,n[7]=a.y,n[8]=a.z,n};var oZ=new L(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),rZ=new fe,sZ=new h,ZCe=new h,$Ce=new $,$H=new L,aZ=new L;Hi.basisTo2D=function(e,t,i){let n=L.getTranslation(t,ZCe),r=e.ellipsoid,o=r.cartesianToCartographic(n,rZ),a=e.project(o,sZ);h.fromElements(a.z,a.x,a.y,a);let s=Hi.eastNorthUpToFixedFrame(n,r,$H),l=L.inverseTransformation(s,aZ),u=L.getMatrix3(t,$Ce),c=L.multiplyByMatrix3(l,u,i);return L.multiply(oZ,c,i),L.setTranslation(i,a,i),i},Hi.wgs84To2DModelMatrix=function(e,t,i){let n=e.ellipsoid,r=Hi.eastNorthUpToFixedFrame(t,n,$H),o=L.inverseTransformation(r,aZ),a=n.cartesianToCartographic(t,rZ),s=e.project(a,sZ);h.fromElements(s.z,s.x,s.y,s);let l=L.fromTranslation(s,$H);return L.multiply(oZ,o,i),L.multiply(l,i,i),i};var Rt=Hi,QH=new oe;function oh(e,t){e=(t=y(t,ie.WGS84)).scaleToGeodeticSurface(e);let i=Rt.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=h.fromCartesian4(L.getColumn(i,0,QH)),this._yAxis=h.fromCartesian4(L.getColumn(i,1,QH));let n=h.fromCartesian4(L.getColumn(i,2,QH));this._plane=tn.fromPointNormal(e,n)}Object.defineProperties(oh.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var QCe=new Ky;oh.fromPoints=function(e,t){return new oh(Ky.fromPoints(e,QCe).center,t)};var cZ=new Tn,NP=new h;oh.prototype.projectPointOntoPlane=function(e,t){let i=cZ;i.origin=e,h.normalize(e,i.direction);let n=Ai.rayPlane(i,this._plane,NP);if(u(n)||(h.negate(i.direction,i.direction),n=Ai.rayPlane(i,this._plane,NP)),u(n)){let e=h.subtract(n,this._origin,n),i=h.dot(this._xAxis,e),r=h.dot(this._yAxis,e);return u(t)?(t.x=i,t.y=r,t):new U(i,r)}},oh.prototype.projectPointsOntoPlane=function(e,t){u(t)||(t=[]);let i=0,n=e.length;for(let r=0;r<n;r++){let n=this.projectPointOntoPlane(e[r],t[i]);u(n)&&(t[i]=n,i++)}return t.length=i,t},oh.prototype.projectPointToNearestOnPlane=function(e,t){u(t)||(t=new U);let i=cZ;i.origin=e,h.clone(this._plane.normal,i.direction);let n=Ai.rayPlane(i,this._plane,NP);u(n)||(h.negate(i.direction,i.direction),n=Ai.rayPlane(i,this._plane,NP));let r=h.subtract(n,this._origin,n),o=h.dot(this._xAxis,r),a=h.dot(this._yAxis,r);return t.x=o,t.y=a,t},oh.prototype.projectPointsToNearestOnPlane=function(e,t){u(t)||(t=[]);let i=e.length;t.length=i;for(let n=0;n<i;n++)t[n]=this.projectPointToNearestOnPlane(e[n],t[n]);return t};var JCe=new h;oh.prototype.projectPointOntoEllipsoid=function(e,t){u(t)||(t=new h);let i=this._ellipsoid,n=this._origin,r=this._xAxis,o=this._yAxis,a=JCe;return h.multiplyByScalar(r,e.x,a),t=h.add(n,a,t),h.multiplyByScalar(o,e.y,a),h.add(t,a,t),i.scaleToGeocentricSurface(t,t),t},oh.prototype.projectPointsOntoEllipsoid=function(e,t){let i=e.length;u(t)?t.length=i:t=new Array(i);for(let n=0;n<i;++n)t[n]=this.projectPointOntoEllipsoid(e[n],t[n]);return t};var Vr=oh;function Pi(e,t){this.center=h.clone(y(e,h.ZERO)),this.halfAxes=$.clone(y(t,$.ZERO))}Pi.packedLength=h.packedLength+$.packedLength,Pi.pack=function(e,t,i){return i=y(i,0),h.pack(e.center,t,i),$.pack(e.halfAxes,t,i+h.packedLength),t},Pi.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Pi),h.unpack(e,t,i.center),$.unpack(e,t+h.packedLength,i.halfAxes),i};var eEe=new h,tEe=new h,nEe=new h,iEe=new h,oEe=new h,rEe=new h,sEe=new $,aEe={unitary:new $,diagonal:new $};Pi.fromPoints=function(e,t){if(u(t)||(t=new Pi),!u(e)||0===e.length)return t.halfAxes=$.ZERO,t.center=h.ZERO,t;let i,n=e.length,r=h.clone(e[0],eEe);for(i=1;i<n;i++)h.add(r,e[i],r);let o=1/n;h.multiplyByScalar(r,o,r);let a,s=0,l=0,c=0,d=0,p=0,f=0;for(i=0;i<n;i++)a=h.subtract(e[i],r,tEe),s+=a.x*a.x,l+=a.x*a.y,c+=a.x*a.z,d+=a.y*a.y,p+=a.y*a.z,f+=a.z*a.z;s*=o,l*=o,c*=o,d*=o,p*=o,f*=o;let m=sEe;m[0]=s,m[1]=l,m[2]=c,m[3]=l,m[4]=d,m[5]=p,m[6]=c,m[7]=p,m[8]=f;let _=$.computeEigenDecomposition(m,aEe),g=$.clone(_.unitary,t.halfAxes),y=$.getColumn(g,0,iEe),v=$.getColumn(g,1,oEe),b=$.getColumn(g,2,rEe),A=-Number.MAX_VALUE,T=-Number.MAX_VALUE,E=-Number.MAX_VALUE,C=Number.MAX_VALUE,x=Number.MAX_VALUE,S=Number.MAX_VALUE;for(i=0;i<n;i++)a=e[i],A=Math.max(h.dot(y,a),A),T=Math.max(h.dot(v,a),T),E=Math.max(h.dot(b,a),E),C=Math.min(h.dot(y,a),C),x=Math.min(h.dot(v,a),x),S=Math.min(h.dot(b,a),S);y=h.multiplyByScalar(y,.5*(C+A),y),v=h.multiplyByScalar(v,.5*(x+T),v),b=h.multiplyByScalar(b,.5*(S+E),b);let w=h.add(y,v,t.center);h.add(w,b,w);let I=nEe;return I.x=A-C,I.y=T-x,I.z=E-S,h.multiplyByScalar(I,.5,I),$.multiplyByScale(t.halfAxes,I,t.halfAxes),t};var mZ=new h,cEe=new h;function lZ(e,t,i,n,r,o,a,s,l,c,d){u(d)||(d=new Pi);let p=d.halfAxes;$.setColumn(p,0,t,p),$.setColumn(p,1,i,p),$.setColumn(p,2,n,p);let f=mZ;f.x=(r+o)/2,f.y=(a+s)/2,f.z=(l+c)/2;let m=cEe;m.x=(o-r)/2,m.y=(s-a)/2,m.z=(c-l)/2;let _=d.center;return f=$.multiplyByVector(p,f,f),h.add(e,f,_),$.multiplyByScale(p,m,p),d}var uZ=new fe,lEe=new h,uEe=new fe,fEe=new fe,dEe=new fe,hEe=new fe,mEe=new fe,pEe=new h,fZ=new h,_Ee=new h,dZ=new h,gEe=new h,yEe=new U,xEe=new U,bEe=new U,TEe=new U,AEe=new U,CEe=new h,EEe=new h,SEe=new h,wEe=new h,vEe=new U,DEe=new h,IEe=new h,PEe=new h,OEe=new tn(h.UNIT_X,0);Pi.fromRectangle=function(e,t,i,n,r){let o,a,s,l,u,c,d;if(t=y(t,0),i=y(i,0),n=y(n,ie.WGS84),e.width<=P.PI){let h=ce.center(e,uZ),p=n.cartographicToCartesian(h,lEe),f=new Vr(p,n);d=f.plane;let m=h.longitude,_=e.south<0&&e.north>0?0:h.latitude,g=fe.fromRadians(m,e.north,i,uEe),y=fe.fromRadians(e.west,e.north,i,fEe),v=fe.fromRadians(e.west,_,i,dEe),b=fe.fromRadians(e.west,e.south,i,hEe),A=fe.fromRadians(m,e.south,i,mEe),T=n.cartographicToCartesian(g,pEe),E=n.cartographicToCartesian(y,fZ),C=n.cartographicToCartesian(v,_Ee),x=n.cartographicToCartesian(b,dZ),S=n.cartographicToCartesian(A,gEe),w=f.projectPointToNearestOnPlane(T,yEe),I=f.projectPointToNearestOnPlane(E,xEe),P=f.projectPointToNearestOnPlane(C,bEe),D=f.projectPointToNearestOnPlane(x,TEe),O=f.projectPointToNearestOnPlane(S,AEe);return o=Math.min(I.x,P.x,D.x),a=-o,l=Math.max(I.y,w.y),s=Math.min(D.y,O.y),y.height=b.height=t,E=n.cartographicToCartesian(y,fZ),x=n.cartographicToCartesian(b,dZ),u=Math.min(tn.getPointDistance(d,E),tn.getPointDistance(d,x)),c=i,lZ(f.origin,f.xAxis,f.yAxis,f.zAxis,o,a,s,l,u,c,r)}let p=e.south>0,f=e.north<0,m=p?e.south:f?e.north:0,_=ce.center(e,uZ).longitude,g=h.fromRadians(_,m,i,n,CEe);g.z=0;let v=Math.abs(g.x)<P.EPSILON10&&Math.abs(g.y)<P.EPSILON10?h.UNIT_X:h.normalize(g,EEe),b=h.UNIT_Z,A=h.cross(v,b,SEe);d=tn.fromPointNormal(g,v,OEe);let T=h.fromRadians(_+P.PI_OVER_TWO,m,i,n,wEe);a=h.dot(tn.projectPointOntoPlane(d,T,vEe),A),o=-a,l=h.fromRadians(0,e.north,f?t:i,n,DEe).z,s=h.fromRadians(0,e.south,p?t:i,n,IEe).z;let E=h.fromRadians(e.east,m,i,n,PEe);return u=tn.getPointDistance(d,E),c=0,lZ(g,A,b,v,o,a,s,l,u,c,r)},Pi.fromTransformation=function(e,t){return u(t)||(t=new Pi),t.center=L.getTranslation(e,t.center),t.halfAxes=L.getMatrix3(e,t.halfAxes),t.halfAxes=$.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},Pi.clone=function(e,t){if(u(e))return u(t)?(h.clone(e.center,t.center),$.clone(e.halfAxes,t.halfAxes),t):new Pi(e.center,e.halfAxes)},Pi.intersectPlane=function(e,t){let i=e.center,n=t.normal,r=e.halfAxes,o=n.x,a=n.y,s=n.z,l=Math.abs(o*r[$.COLUMN0ROW0]+a*r[$.COLUMN0ROW1]+s*r[$.COLUMN0ROW2])+Math.abs(o*r[$.COLUMN1ROW0]+a*r[$.COLUMN1ROW1]+s*r[$.COLUMN1ROW2])+Math.abs(o*r[$.COLUMN2ROW0]+a*r[$.COLUMN2ROW1]+s*r[$.COLUMN2ROW2]),u=h.dot(n,i)+t.distance;return u<=-l?Zt.OUTSIDE:u>=l?Zt.INSIDE:Zt.INTERSECTING};var pZ=new h,_Z=new h,gZ=new h,REe=new h,hZ=new h,MEe=new h;Pi.distanceSquaredTo=function(e,t){let i=h.subtract(t,e.center,mZ),n=e.halfAxes,r=$.getColumn(n,0,pZ),o=$.getColumn(n,1,_Z),a=$.getColumn(n,2,gZ),s=h.magnitude(r),l=h.magnitude(o),u=h.magnitude(a),c=!0,d=!0,p=!0;s>0?h.divideByScalar(r,s,r):c=!1,l>0?h.divideByScalar(o,l,o):d=!1,u>0?h.divideByScalar(a,u,a):p=!1;let f,m,_,g=!c+!d+!p;if(1===g){let e=r;f=o,m=a,d?p||(e=a,m=r):(e=o,f=r),_=h.cross(f,m,hZ),e===r?r=_:e===o?o=_:e===a&&(a=_)}else if(2===g){f=r,d?f=o:p&&(f=a);let e=h.UNIT_Y;e.equalsEpsilon(f,P.EPSILON3)&&(e=h.UNIT_X),m=h.cross(f,e,REe),h.normalize(m,m),_=h.cross(f,m,hZ),h.normalize(_,_),f===r?(o=m,a=_):f===o?(a=m,r=_):f===a&&(r=m,o=_)}else 3===g&&(r=h.UNIT_X,o=h.UNIT_Y,a=h.UNIT_Z);let y=MEe;y.x=h.dot(i,r),y.y=h.dot(i,o),y.z=h.dot(i,a);let v,b=0;return y.x<-s?(v=y.x+s,b+=v*v):y.x>s&&(v=y.x-s,b+=v*v),y.y<-l?(v=y.y+l,b+=v*v):y.y>l&&(v=y.y-l,b+=v*v),y.z<-u?(v=y.z+u,b+=v*v):y.z>u&&(v=y.z-u,b+=v*v),b};var LEe=new h,NEe=new h;Pi.computePlaneDistances=function(e,t,i,n){u(n)||(n=new Uc);let r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=e.center,s=e.halfAxes,l=$.getColumn(s,0,pZ),c=$.getColumn(s,1,_Z),d=$.getColumn(s,2,gZ),p=h.add(l,c,LEe);h.add(p,d,p),h.add(p,a,p);let f=h.subtract(p,t,NEe),m=h.dot(i,f);return r=Math.min(m,r),o=Math.max(m,o),h.add(a,l,p),h.add(p,c,p),h.subtract(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),h.add(a,l,p),h.subtract(p,c,p),h.add(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),h.add(a,l,p),h.subtract(p,c,p),h.subtract(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),h.subtract(a,l,p),h.add(p,c,p),h.add(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),h.subtract(a,l,p),h.add(p,c,p),h.subtract(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),h.subtract(a,l,p),h.subtract(p,c,p),h.add(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),h.subtract(a,l,p),h.subtract(p,c,p),h.subtract(p,d,p),h.subtract(p,t,f),m=h.dot(i,f),r=Math.min(m,r),o=Math.max(m,o),n.start=r,n.stop=o,n};var FEe=new h,BEe=new h,kEe=new h;Pi.computeCorners=function(e,t){u(t)||(t=[new h,new h,new h,new h,new h,new h,new h,new h]);let i=e.center,n=e.halfAxes,r=$.getColumn(n,0,FEe),o=$.getColumn(n,1,BEe),a=$.getColumn(n,2,kEe);return h.clone(i,t[0]),h.subtract(t[0],r,t[0]),h.subtract(t[0],o,t[0]),h.subtract(t[0],a,t[0]),h.clone(i,t[1]),h.subtract(t[1],r,t[1]),h.subtract(t[1],o,t[1]),h.add(t[1],a,t[1]),h.clone(i,t[2]),h.subtract(t[2],r,t[2]),h.add(t[2],o,t[2]),h.subtract(t[2],a,t[2]),h.clone(i,t[3]),h.subtract(t[3],r,t[3]),h.add(t[3],o,t[3]),h.add(t[3],a,t[3]),h.clone(i,t[4]),h.add(t[4],r,t[4]),h.subtract(t[4],o,t[4]),h.subtract(t[4],a,t[4]),h.clone(i,t[5]),h.add(t[5],r,t[5]),h.subtract(t[5],o,t[5]),h.add(t[5],a,t[5]),h.clone(i,t[6]),h.add(t[6],r,t[6]),h.add(t[6],o,t[6]),h.subtract(t[6],a,t[6]),h.clone(i,t[7]),h.add(t[7],r,t[7]),h.add(t[7],o,t[7]),h.add(t[7],a,t[7]),t};var VEe=new $;Pi.computeTransformation=function(e,t){u(t)||(t=new L);let i=e.center,n=$.multiplyByUniformScale(e.halfAxes,2,VEe);return L.fromRotationTranslation(n,i,t)};var UEe=new se;Pi.isOccluded=function(e,t){let i=se.fromOrientedBoundingBox(e,UEe);return!t.isBoundingSphereVisible(i)},Pi.prototype.intersectPlane=function(e){return Pi.intersectPlane(this,e)},Pi.prototype.distanceSquaredTo=function(e){return Pi.distanceSquaredTo(this,e)},Pi.prototype.computePlaneDistances=function(e,t,i){return Pi.computePlaneDistances(this,e,t,i)},Pi.prototype.computeCorners=function(e){return Pi.computeCorners(this,e)},Pi.prototype.computeTransformation=function(e){return Pi.computeTransformation(this,e)},Pi.prototype.isOccluded=function(e){return Pi.isOccluded(this,e)},Pi.equals=function(e,t){return e===t||u(e)&&u(t)&&h.equals(e.center,t.center)&&$.equals(e.halfAxes,t.halfAxes)},Pi.prototype.clone=function(e){return Pi.clone(this,e)},Pi.prototype.equals=function(e){return Pi.equals(this,e)};var Pn=Pi,zEe={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_ASTC_4x4_WEBGL:37808,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGBA_BPTC_UNORM:36492,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047},ee=Object.freeze(zEe),An={BYTE:ee.BYTE,UNSIGNED_BYTE:ee.UNSIGNED_BYTE,SHORT:ee.SHORT,UNSIGNED_SHORT:ee.UNSIGNED_SHORT,INT:ee.INT,UNSIGNED_INT:ee.UNSIGNED_INT,FLOAT:ee.FLOAT,DOUBLE:ee.DOUBLE,getSizeInBytes:function(e){switch(e){case An.BYTE:return Int8Array.BYTES_PER_ELEMENT;case An.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case An.SHORT:return Int16Array.BYTES_PER_ELEMENT;case An.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case An.INT:return Int32Array.BYTES_PER_ELEMENT;case An.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case An.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case An.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}},fromTypedArray:function(e){return e instanceof Int8Array?An.BYTE:e instanceof Uint8Array?An.UNSIGNED_BYTE:e instanceof Int16Array?An.SHORT:e instanceof Uint16Array?An.UNSIGNED_SHORT:e instanceof Int32Array?An.INT:e instanceof Uint32Array?An.UNSIGNED_INT:e instanceof Float32Array?An.FLOAT:e instanceof Float64Array?An.DOUBLE:void 0},validate:function(e){return u(e)&&(e===An.BYTE||e===An.UNSIGNED_BYTE||e===An.SHORT||e===An.UNSIGNED_SHORT||e===An.INT||e===An.UNSIGNED_INT||e===An.FLOAT||e===An.DOUBLE)},createTypedArray:function(e,t){switch(e){case An.BYTE:return new Int8Array(t);case An.UNSIGNED_BYTE:return new Uint8Array(t);case An.SHORT:return new Int16Array(t);case An.UNSIGNED_SHORT:return new Uint16Array(t);case An.INT:return new Int32Array(t);case An.UNSIGNED_INT:return new Uint32Array(t);case An.FLOAT:return new Float32Array(t);case An.DOUBLE:return new Float64Array(t)}},createArrayBufferView:function(e,t,i,n){switch(i=y(i,0),n=y(n,(t.byteLength-i)/An.getSizeInBytes(e)),e){case An.BYTE:return new Int8Array(t,i,n);case An.UNSIGNED_BYTE:return new Uint8Array(t,i,n);case An.SHORT:return new Int16Array(t,i,n);case An.UNSIGNED_SHORT:return new Uint16Array(t,i,n);case An.INT:return new Int32Array(t,i,n);case An.UNSIGNED_INT:return new Uint32Array(t,i,n);case An.FLOAT:return new Float32Array(t,i,n);case An.DOUBLE:return new Float64Array(t,i,n)}},fromName:function(e){switch(e){case"BYTE":return An.BYTE;case"UNSIGNED_BYTE":return An.UNSIGNED_BYTE;case"SHORT":return An.SHORT;case"UNSIGNED_SHORT":return An.UNSIGNED_SHORT;case"INT":return An.INT;case"UNSIGNED_INT":return An.UNSIGNED_INT;case"FLOAT":return An.FLOAT;case"DOUBLE":return An.DOUBLE}}},X=Object.freeze(An);function qt(e,t,i,n){this[0]=y(e,0),this[1]=y(i,0),this[2]=y(t,0),this[3]=y(n,0)}qt.packedLength=4,qt.pack=function(e,t,i){return i=y(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t},qt.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new qt),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i},qt.packArray=function(e,t){let i=e.length,n=4*i;u(t)?!Array.isArray(t)&&t.length!==n||t.length!==n&&(t.length=n):t=new Array(n);for(let n=0;n<i;++n)qt.pack(e[n],t,4*n);return t},qt.unpackArray=function(e,t){let i=e.length;u(t)?t.length=i/4:t=new Array(i/4);for(let n=0;n<i;n+=4){let i=n/4;t[i]=qt.unpack(e,n,t[i])}return t},qt.clone=function(e,t){if(u(e))return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new qt(e[0],e[2],e[1],e[3])},qt.fromArray=qt.unpack,qt.fromColumnMajorArray=function(e,t){return qt.clone(e,t)},qt.fromRowMajorArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new qt(e[0],e[1],e[2],e[3])},qt.fromScale=function(e,t){return u(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new qt(e.x,0,0,e.y)},qt.fromUniformScale=function(e,t){return u(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new qt(e,0,0,e)},qt.fromRotation=function(e,t){let i=Math.cos(e),n=Math.sin(e);return u(t)?(t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t):new qt(i,-n,n,i)},qt.toArray=function(e,t){return u(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},qt.getElementIndex=function(e,t){return 2*e+t},qt.getColumn=function(e,t,i){let n=2*t,r=e[n],o=e[n+1];return i.x=r,i.y=o,i},qt.setColumn=function(e,t,i,n){let r=2*t;return(n=qt.clone(e,n))[r]=i.x,n[r+1]=i.y,n},qt.getRow=function(e,t,i){let n=e[t],r=e[t+2];return i.x=n,i.y=r,i},qt.setRow=function(e,t,i,n){return(n=qt.clone(e,n))[t]=i.x,n[t+2]=i.y,n};var HEe=new U;qt.setScale=function(e,t,i){let n=qt.getScale(e,HEe),r=t.x/n.x,o=t.y/n.y;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*o,i[3]=e[3]*o,i};var GEe=new U;qt.setUniformScale=function(e,t,i){let n=qt.getScale(e,GEe),r=t/n.x,o=t/n.y;return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*o,i[3]=e[3]*o,i};var yZ=new U;qt.getScale=function(e,t){return t.x=U.magnitude(U.fromElements(e[0],e[1],yZ)),t.y=U.magnitude(U.fromElements(e[2],e[3],yZ)),t};var xZ=new U;qt.getMaximumScale=function(e){return qt.getScale(e,xZ),U.maximumComponent(xZ)};var WEe=new U;qt.setRotation=function(e,t,i){let n=qt.getScale(e,WEe);return i[0]=t[0]*n.x,i[1]=t[1]*n.x,i[2]=t[2]*n.y,i[3]=t[3]*n.y,i};var jEe=new U;qt.getRotation=function(e,t){let i=qt.getScale(e,jEe);return t[0]=e[0]/i.x,t[1]=e[1]/i.x,t[2]=e[2]/i.y,t[3]=e[3]/i.y,t},qt.multiply=function(e,t,i){let n=e[0]*t[0]+e[2]*t[1],r=e[0]*t[2]+e[2]*t[3],o=e[1]*t[0]+e[3]*t[1],a=e[1]*t[2]+e[3]*t[3];return i[0]=n,i[1]=o,i[2]=r,i[3]=a,i},qt.add=function(e,t,i){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i},qt.subtract=function(e,t,i){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i},qt.multiplyByVector=function(e,t,i){let n=e[0]*t.x+e[2]*t.y,r=e[1]*t.x+e[3]*t.y;return i.x=n,i.y=r,i},qt.multiplyByScalar=function(e,t,i){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i},qt.multiplyByScale=function(e,t,i){return i[0]=e[0]*t.x,i[1]=e[1]*t.x,i[2]=e[2]*t.y,i[3]=e[3]*t.y,i},qt.multiplyByUniformScale=function(e,t,i){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i},qt.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},qt.transpose=function(e,t){let i=e[0],n=e[2],r=e[1],o=e[3];return t[0]=i,t[1]=n,t[2]=r,t[3]=o,t},qt.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},qt.equals=function(e,t){return e===t||u(e)&&u(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},qt.equalsArray=function(e,t,i){return e[0]===t[i]&&e[1]===t[i+1]&&e[2]===t[i+2]&&e[3]===t[i+3]},qt.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i},qt.IDENTITY=Object.freeze(new qt(1,0,0,1)),qt.ZERO=Object.freeze(new qt(0,0,0,0)),qt.COLUMN0ROW0=0,qt.COLUMN0ROW1=1,qt.COLUMN1ROW0=2,qt.COLUMN1ROW1=3,Object.defineProperties(qt.prototype,{length:{get:function(){return qt.packedLength}}}),qt.prototype.clone=function(e){return qt.clone(this,e)},qt.prototype.equals=function(e){return qt.equals(this,e)},qt.prototype.equalsEpsilon=function(e,t){return qt.equalsEpsilon(this,e,t)},qt.prototype.toString=function(){return`(${this[0]}, ${this[2]})\n(${this[1]}, ${this[3]})`};var Ji=qt,Ki={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",getMathType:function(e){switch(e){case Ki.SCALAR:return Number;case Ki.VEC2:return U;case Ki.VEC3:return h;case Ki.VEC4:return oe;case Ki.MAT2:return Ji;case Ki.MAT3:return $;case Ki.MAT4:return L}},getNumberOfComponents:function(e){switch(e){case Ki.SCALAR:return 1;case Ki.VEC2:return 2;case Ki.VEC3:return 3;case Ki.VEC4:case Ki.MAT2:return 4;case Ki.MAT3:return 9;case Ki.MAT4:return 16}},getAttributeLocationCount:function(e){switch(e){case Ki.SCALAR:case Ki.VEC2:case Ki.VEC3:case Ki.VEC4:return 1;case Ki.MAT2:return 2;case Ki.MAT3:return 3;case Ki.MAT4:return 4}},getGlslType:function(e){switch(e){case Ki.SCALAR:return"float";case Ki.VEC2:return"vec2";case Ki.VEC3:return"vec3";case Ki.VEC4:return"vec4";case Ki.MAT2:return"mat2";case Ki.MAT3:return"mat3";case Ki.MAT4:return"mat4"}}},nn=Object.freeze(Ki),bZ=1/256,TZ=256,fo={octEncodeInRange:function(e,t,i){if(i.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),i.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){let e=i.x,t=i.y;i.x=(1-Math.abs(t))*P.signNotZero(e),i.y=(1-Math.abs(e))*P.signNotZero(t)}return i.x=P.toSNorm(i.x,t),i.y=P.toSNorm(i.y,t),i},octEncode:function(e,t){return fo.octEncodeInRange(e,255,t)}},nS=new U,AZ=new Uint8Array(1);function FP(e){return AZ[0]=e,AZ[0]}fo.octEncodeToCartesian4=function(e,t){return fo.octEncodeInRange(e,65535,nS),t.x=FP(nS.x*bZ),t.y=FP(nS.x),t.z=FP(nS.y*bZ),t.w=FP(nS.y),t},fo.octDecodeInRange=function(e,t,i,n){if(n.x=P.fromSNorm(e,i),n.y=P.fromSNorm(t,i),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){let e=n.x;n.x=(1-Math.abs(n.y))*P.signNotZero(e),n.y=(1-Math.abs(e))*P.signNotZero(n.y)}return h.normalize(n,n)},fo.octDecode=function(e,t,i){return fo.octDecodeInRange(e,t,255,i)},fo.octDecodeFromCartesian4=function(e,t){let i=e.x,n=e.y,r=e.z,o=e.w,a=i*TZ+n,s=r*TZ+o;return fo.octDecodeInRange(a,s,65535,t)},fo.octPackFloat=function(e){return 256*e.x+e.y};var e5=new U;function JH(e){return e>>1^-(1&e)}fo.octEncodeFloat=function(e){return fo.octEncode(e,e5),fo.octPackFloat(e5)},fo.octDecodeFloat=function(e,t){let i=e/256,n=Math.floor(i),r=256*(i-n);return fo.octDecode(n,r,t)},fo.octPack=function(e,t,i,n){let r=fo.octEncodeFloat(e),o=fo.octEncodeFloat(t),a=fo.octEncode(i,e5);return n.x=65536*a.x+r,n.y=65536*a.y+o,n},fo.octUnpack=function(e,t,i,n){let r=e.x/65536,o=Math.floor(r),a=65536*(r-o);r=e.y/65536;let s=Math.floor(r),l=65536*(r-s);fo.octDecodeFloat(a,t),fo.octDecodeFloat(l,i),fo.octDecode(o,s,n)},fo.compressTextureCoordinates=function(e){return 4096*(4095*e.x|0)+(4095*e.y|0)},fo.decompressTextureCoordinates=function(e,t){let i=e/4096,n=Math.floor(i);return t.x=n/4095,t.y=(e-4096*n)/4095,t},fo.zigZagDeltaDecode=function(e,t,i){let n=e.length,r=0,o=0,a=0;for(let s=0;s<n;++s)r+=JH(e[s]),o+=JH(t[s]),e[s]=r,t[s]=o,u(i)&&(a+=JH(i[s]),i[s]=a)},fo.dequantize=function(e,t,i,n){let r,o=nn.getNumberOfComponents(i);switch(t){case X.BYTE:r=127;break;case X.UNSIGNED_BYTE:r=255;break;case X.SHORT:r=32767;break;case X.UNSIGNED_SHORT:r=65535;break;case X.INT:r=2147483647;break;case X.UNSIGNED_INT:r=4294967295}let a=new Float32Array(n*o);for(let t=0;t<n;t++)for(let i=0;i<o;i++){let n=t*o+i;a[n]=Math.max(e[n]/r,-1)}return a},fo.decodeRGB565=function(e,t){let i=e.length;u(t)||(t=new Float32Array(3*i));let n=1/31;for(let r=0;r<i;r++){let i=e[r],o=i>>11,a=i>>5&63,s=31&i,l=3*r;t[l]=o*n,t[l+1]=.015873015873015872*a,t[l+2]=s*n}return t};var Gn=fo,BP={getHeight:function(e,t,i){return(e-i)*t+i}},qEe=new h;BP.getPosition=function(e,t,i,n,r){let o=t.cartesianToCartographic(e,qEe),a=BP.getHeight(o.height,i,n);return h.fromRadians(o.longitude,o.latitude,a,t,r)};var Wc=BP,YEe={NONE:0,BITS12:1},Os=Object.freeze(YEe),Jy=new h,XEe=new h,Du=new U,kP=new L,KEe=new L,ZEe=Math.pow(2,12);function wa(e,t,i,n,r,o,a,s,l,c){let d,p,f=Os.NONE;if(u(t)&&u(i)&&u(n)&&u(r)){let e=t.minimum,o=t.maximum,a=h.subtract(o,e,XEe),s=n-i;f=Math.max(h.maximumComponent(a),s)<ZEe-1?Os.BITS12:Os.NONE,d=L.inverseTransformation(r,new L);let l=h.negate(e,Jy);L.multiply(L.fromTranslation(l,kP),d,d);let u=Jy;u.x=1/a.x,u.y=1/a.y,u.z=1/a.z,L.multiply(L.fromScale(u,kP),d,d),p=L.clone(r),L.setTranslation(p,h.ZERO,p),r=L.clone(r,new L);let c=L.fromTranslation(e,kP),m=L.fromScale(a,KEe),_=L.multiply(c,m,kP);L.multiply(r,_,r),L.multiply(p,_,p)}this.quantization=f,this.minimumHeight=i,this.maximumHeight=n,this.center=h.clone(e),this.toScaledENU=d,this.fromScaledENU=r,this.matrix=p,this.hasVertexNormals=o,this.hasWebMercatorT=y(a,!1),this.hasGeodeticSurfaceNormals=y(s,!1),this.exaggeration=y(l,1),this.exaggerationRelativeHeight=y(c,0),this.stride=0,this._offsetGeodeticSurfaceNormal=0,this._offsetVertexNormal=0,this._calculateStrideAndOffsets()}wa.prototype.encode=function(e,t,i,n,r,o,a,s){let l=n.x,u=n.y;if(this.quantization===Os.BITS12){(i=L.multiplyByPoint(this.toScaledENU,i,Jy)).x=P.clamp(i.x,0,1),i.y=P.clamp(i.y,0,1),i.z=P.clamp(i.z,0,1);let n=this.maximumHeight-this.minimumHeight,o=P.clamp((r-this.minimumHeight)/n,0,1);U.fromElements(i.x,i.y,Du);let s=Gn.compressTextureCoordinates(Du);U.fromElements(i.z,o,Du);let c=Gn.compressTextureCoordinates(Du);U.fromElements(l,u,Du);let h=Gn.compressTextureCoordinates(Du);if(e[t++]=s,e[t++]=c,e[t++]=h,this.hasWebMercatorT){U.fromElements(a,0,Du);let i=Gn.compressTextureCoordinates(Du);e[t++]=i}}else h.subtract(i,this.center,Jy),e[t++]=Jy.x,e[t++]=Jy.y,e[t++]=Jy.z,e[t++]=r,e[t++]=l,e[t++]=u,this.hasWebMercatorT&&(e[t++]=a);return this.hasVertexNormals&&(e[t++]=Gn.octPackFloat(o)),this.hasGeodeticSurfaceNormals&&(e[t++]=s.x,e[t++]=s.y,e[t++]=s.z),t};var $Ee=new h,CZ=new h;wa.prototype.addGeodeticSurfaceNormals=function(e,t,i){if(this.hasGeodeticSurfaceNormals)return;let n=this.stride,r=e.length/n;this.hasGeodeticSurfaceNormals=!0,this._calculateStrideAndOffsets();let o=this.stride;for(let a=0;a<r;a++){for(let i=0;i<n;i++){let r=a*n+i;t[a*o+i]=e[r]}let r=this.decodePosition(t,a,$Ee),s=i.geodeticSurfaceNormal(r,CZ),l=a*o+this._offsetGeodeticSurfaceNormal;t[l]=s.x,t[l+1]=s.y,t[l+2]=s.z}},wa.prototype.removeGeodeticSurfaceNormals=function(e,t){if(!this.hasGeodeticSurfaceNormals)return;let i=this.stride,n=e.length/i;this.hasGeodeticSurfaceNormals=!1,this._calculateStrideAndOffsets();let r=this.stride;for(let o=0;o<n;o++)for(let n=0;n<r;n++){let a=o*i+n;t[o*r+n]=e[a]}},wa.prototype.decodePosition=function(e,t,i){if(u(i)||(i=new h),t*=this.stride,this.quantization===Os.BITS12){let n=Gn.decompressTextureCoordinates(e[t],Du);i.x=n.x,i.y=n.y;let r=Gn.decompressTextureCoordinates(e[t+1],Du);return i.z=r.x,L.multiplyByPoint(this.fromScaledENU,i,i)}return i.x=e[t],i.y=e[t+1],i.z=e[t+2],h.add(i,this.center,i)},wa.prototype.getExaggeratedPosition=function(e,t,i){i=this.decodePosition(e,t,i);let n=this.exaggeration,r=this.exaggerationRelativeHeight;if(1!==n&&this.hasGeodeticSurfaceNormals){let o=this.decodeGeodeticSurfaceNormal(e,t,CZ),a=this.decodeHeight(e,t),s=Wc.getHeight(a,n,r)-a;i.x+=o.x*s,i.y+=o.y*s,i.z+=o.z*s}return i},wa.prototype.decodeTextureCoordinates=function(e,t,i){return u(i)||(i=new U),t*=this.stride,this.quantization===Os.BITS12?Gn.decompressTextureCoordinates(e[t+2],i):U.fromElements(e[t+4],e[t+5],i)},wa.prototype.decodeHeight=function(e,t){return t*=this.stride,this.quantization===Os.BITS12?Gn.decompressTextureCoordinates(e[t+1],Du).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight:e[t+3]},wa.prototype.decodeWebMercatorT=function(e,t){return t*=this.stride,this.quantization===Os.BITS12?Gn.decompressTextureCoordinates(e[t+3],Du).x:e[t+6]},wa.prototype.getOctEncodedNormal=function(e,t,i){let n=e[t=t*this.stride+this._offsetVertexNormal]/256,r=Math.floor(n),o=256*(n-r);return U.fromElements(r,o,i)},wa.prototype.decodeGeodeticSurfaceNormal=function(e,t,i){return t=t*this.stride+this._offsetGeodeticSurfaceNormal,i.x=e[t],i.y=e[t+1],i.z=e[t+2],i},wa.prototype._calculateStrideAndOffsets=function(){let e=0;if(this.quantization===Os.BITS12)e+=3;else e+=6;this.hasWebMercatorT&&(e+=1),this.hasVertexNormals&&(this._offsetVertexNormal=e,e+=1),this.hasGeodeticSurfaceNormals&&(this._offsetGeodeticSurfaceNormal=e,e+=3),this.stride=e};var VP={position3DAndHeight:0,textureCoordAndEncodedNormals:1,geodeticSurfaceNormal:2},UP={compressed0:0,compressed1:1,geodeticSurfaceNormal:2};wa.prototype.getAttributes=function(e){let t=X.FLOAT,i=X.getSizeInBytes(t),n=this.stride*i,r=0,o=[];function a(a,s){o.push({index:a,vertexBuffer:e,componentDatatype:t,componentsPerAttribute:s,offsetInBytes:r,strideInBytes:n}),r+=s*i}if(this.quantization===Os.NONE){a(VP.position3DAndHeight,4);let e=2;e+=this.hasWebMercatorT?1:0,e+=this.hasVertexNormals?1:0,a(VP.textureCoordAndEncodedNormals,e),this.hasGeodeticSurfaceNormals&&a(VP.geodeticSurfaceNormal,3)}else{let e=this.hasWebMercatorT||this.hasVertexNormals,t=this.hasWebMercatorT&&this.hasVertexNormals;a(UP.compressed0,e?4:3),t&&a(UP.compressed1,1),this.hasGeodeticSurfaceNormals&&a(UP.geodeticSurfaceNormal,3)}return o},wa.prototype.getAttributeLocations=function(){return this.quantization===Os.NONE?VP:UP},wa.clone=function(e,t){if(u(e))return u(t)||(t=new wa),t.quantization=e.quantization,t.minimumHeight=e.minimumHeight,t.maximumHeight=e.maximumHeight,t.center=h.clone(e.center),t.toScaledENU=L.clone(e.toScaledENU),t.fromScaledENU=L.clone(e.fromScaledENU),t.matrix=L.clone(e.matrix),t.hasVertexNormals=e.hasVertexNormals,t.hasWebMercatorT=e.hasWebMercatorT,t.hasGeodeticSurfaceNormals=e.hasGeodeticSurfaceNormals,t.exaggeration=e.exaggeration,t.exaggerationRelativeHeight=e.exaggerationRelativeHeight,t._calculateStrideAndOffsets(),t};var sc=wa;function jc(e){this._ellipsoid=y(e,ie.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(jc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),jc.mercatorAngleToGeodeticLatitude=function(e){return P.PI_OVER_TWO-2*Math.atan(Math.exp(-e))},jc.geodeticLatitudeToMercatorAngle=function(e){e>jc.MaximumLatitude?e=jc.MaximumLatitude:e<-jc.MaximumLatitude&&(e=-jc.MaximumLatitude);let t=Math.sin(e);return.5*Math.log((1+t)/(1-t))},jc.MaximumLatitude=jc.mercatorAngleToGeodeticLatitude(Math.PI),jc.prototype.project=function(e,t){let i=this._semimajorAxis,n=e.longitude*i,r=jc.geodeticLatitudeToMercatorAngle(e.latitude)*i,o=e.height;return u(t)?(t.x=n,t.y=r,t.z=o,t):new h(n,r,o)},jc.prototype.unproject=function(e,t){let i=this._oneOverSemimajorAxis,n=e.x*i,r=jc.mercatorAngleToGeodeticLatitude(e.y*i),o=e.z;return u(t)?(t.longitude=n,t.latitude=r,t.height=o,t):new fe(n,r,o)};var Oi=jc,rh={};rh.DEFAULT_STRUCTURE=Object.freeze({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var t5=new h,QEe=new L,JEe=new h,eSe=new h;rh.computeVertices=function(e){let t,i,n,r,o=Math.cos,a=Math.sin,s=Math.sqrt,l=Math.atan,c=Math.exp,d=P.PI_OVER_TWO,p=P.toRadians,f=e.heightmap,m=e.width,_=e.height,g=e.skirtHeight,v=g>0,b=y(e.isGeographic,!0),A=y(e.ellipsoid,ie.WGS84),T=1/A.maximumRadius,E=ce.clone(e.nativeRectangle),C=ce.clone(e.rectangle);u(C)?(t=C.west,i=C.south,n=C.east,r=C.north):b?(t=p(E.west),i=p(E.south),n=p(E.east),r=p(E.north)):(t=E.west*T,i=d-2*l(c(-E.south*T)),n=E.east*T,r=d-2*l(c(-E.north*T)));let x=e.relativeToCenter,S=u(x);x=S?x:h.ZERO;let w=y(e.includeWebMercatorT,!1),I=y(e.exaggeration,1),D=y(e.exaggerationRelativeHeight,0),O=1!==I,R=y(e.structure,rh.DEFAULT_STRUCTURE),N=y(R.heightScale,rh.DEFAULT_STRUCTURE.heightScale),M=y(R.heightOffset,rh.DEFAULT_STRUCTURE.heightOffset),F=y(R.elementsPerHeight,rh.DEFAULT_STRUCTURE.elementsPerHeight),B=y(R.stride,rh.DEFAULT_STRUCTURE.stride),z=y(R.elementMultiplier,rh.DEFAULT_STRUCTURE.elementMultiplier),k=y(R.isBigEndian,rh.DEFAULT_STRUCTURE.isBigEndian),V=ce.computeWidth(E),H=ce.computeHeight(E),G=V/(m-1),j=H/(_-1);b||(V*=T,H*=T);let W,q,Y=A.radiiSquared,X=Y.x,$=Y.y,K=Y.z,J=65536,Q=-65536,Z=Rt.eastNorthUpToFixedFrame(x,A),ee=L.inverseTransformation(Z,QEe);w&&(W=Oi.geodeticLatitudeToMercatorAngle(i),q=1/(Oi.geodeticLatitudeToMercatorAngle(r)-W));let te=JEe;te.x=Number.POSITIVE_INFINITY,te.y=Number.POSITIVE_INFINITY,te.z=Number.POSITIVE_INFINITY;let ne=eSe;ne.x=Number.NEGATIVE_INFINITY,ne.y=Number.NEGATIVE_INFINITY,ne.z=Number.NEGATIVE_INFINITY;let re=Number.POSITIVE_INFINITY,oe=m*_,ae=oe+(g>0?2*m+2*_:0),le=new Array(ae),ue=new Array(ae),he=new Array(ae),de=w?new Array(ae):[],pe=O?new Array(ae):[],fe=0,me=_,_e=0,ge=m;v&&(--fe,++me,--_e,++ge);let ye=1e-5;for(let e=fe;e<me;++e){let u=e;u<0&&(u=0),u>=_&&(u=_-1);let y=E.north-j*u;y=b?p(y):d-2*l(c(-y*T));let v=(y-i)/(r-i);v=P.clamp(v,0,1);let C=e===fe,x=e===me-1;g>0&&(C?y+=ye*H:x&&(y-=ye*H));let S,I=o(y),D=a(y),R=K*D;w&&(S=(Oi.geodeticLatitudeToMercatorAngle(y)-W)*q);for(let e=_e;e<ge;++e){let i=e;i<0&&(i=0),i>=m&&(i=m-1);let r,l=u*(m*B)+i*B;if(1===F)r=f[l];else{let e;if(r=0,k)for(e=0;e<F;++e)r=r*z+f[l+e];else for(e=F-1;e>=0;--e)r=r*z+f[l+e]}r=r*N+M,Q=Math.max(Q,r),J=Math.min(J,r);let c=E.west+G*i;b?c=p(c):c*=T;let d=(c-t)/(n-t);d=P.clamp(d,0,1);let y=u*m+i;if(g>0){let t=e===_e,n=e===ge-1,o=C||x||t||n;if((C||x)&&(t||n))continue;o&&(r-=g,t?(y=oe+(_-u-1),c-=ye*V):x?y=oe+_+(m-i-1):n?(y=oe+_+m+u,c+=ye*V):C&&(y=oe+_+m+_+i))}let H=I*o(c),j=I*a(c),W=X*H,q=$*j,Y=1/s(W*H+q*j+R*D),K=W*Y,Z=q*Y,ie=R*Y,ae=new h;ae.x=K+H*r,ae.y=Z+j*r,ae.z=ie+D*r,L.multiplyByPoint(ee,ae,t5),h.minimumByComponent(t5,te,te),h.maximumByComponent(t5,ne,ne),re=Math.min(re,r),le[y]=ae,he[y]=new U(d,v),ue[y]=r,w&&(de[y]=S),O&&(pe[y]=A.geodeticSurfaceNormal(ae))}}let ve,be,Ae=se.fromPoints(le);u(C)&&(ve=Pn.fromRectangle(C,J,Q,A)),S&&(be=new i_(A).computeHorizonCullingPointPossiblyUnderEllipsoid(x,le,J));let Te=new Ky(te,ne,x),Ee=new sc(x,Te,re,Q,Z,!1,w,O,I,D),Ce=new Float32Array(ae*Ee.stride),xe=0;for(let e=0;e<ae;++e)xe=Ee.encode(Ce,xe,le[e],he[e],ue[e],void 0,de[e],pe[e]);return{vertices:Ce,maximumHeight:Q,minimumHeight:J,encoding:Ee,boundingSphere3D:Ae,orientedBoundingBox:ve,occludeePointInScaledSpace:be}};var iS=rh,EZ=or(Sl(),1);function tSe(){return!0}function nSe(e,t){function i(){}t=y(t,"This object was destroyed, i.e., destroy() was called.");for(let t in e)"function"==typeof e[t]&&(e[t]=i);e.isDestroyed=tSe}var le=nSe;function SZ(){if(!u(ea._canTransferArrayBuffer)){let e=o5("transferTypedArrayTest");e.postMessage=y(e.webkitPostMessage,e.postMessage);let t=99,i=new Int8Array([t]);try{e.postMessage({array:i},[i.buffer])}catch{return ea._canTransferArrayBuffer=!1,ea._canTransferArrayBuffer}ea._canTransferArrayBuffer=new Promise((i=>{e.onmessage=function(n){let r=n.data.array,o=u(r)&&r[0]===t;i(o),e.terminate(),ea._canTransferArrayBuffer=o}}))}return ea._canTransferArrayBuffer}var i5=new pe;function n5(e){let t;try{t=new Blob([e],{type:"application/javascript"})}catch{let i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);i.append(e),t=i.getBlob("application/javascript")}return(window.URL||window.webkitURL).createObjectURL(t)}function o5(e){let t,i=new EZ.default(e),n=0!==i.scheme().length&&0===i.fragment().length,r={};if(Sb(e)){return t=n5(`importScripts("${e}");`),new Worker(t,r)}let o=e.replace(/\.js$/,"");if(!n&&typeof CESIUM_WORKERS<"u"){let e=`\n      importScripts("${n5(CESIUM_WORKERS)}");\n      CesiumWorkers["${o}"]();\n    `;return t=n5(e),new Worker(t,r)}if(t=e,n||(t=$t(`${ea._workerModulePrefix+o}.js`)),!Bt.supportsEsmWebWorkers())throw new ue("This browser is not supported. Please update your browser to continue.");return r.type="module",new Worker(t,r)}async function iSe(e,t){let i={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!Bt.supportsWebAssembly()){if(!u(t.fallbackModulePath))throw new ue(`This browser does not support Web Assembly, and no backup module was provided for ${e._workerPath}`);return i.modulePath=$t(t.fallbackModulePath),i}i.wasmBinaryFile=$t(t.wasmBinaryFile);let n=await ve.fetchArrayBuffer({url:i.wasmBinaryFile});return i.wasmBinary=n,i}function ea(e,t){this._workerPath=e,this._maximumActiveTasks=y(t,Number.POSITIVE_INFINITY),this._activeTasks=0,this._nextID=0,this._webAssemblyPromise=void 0}var oSe=(e,t,i,n)=>{let r=({data:o})=>{if(o.id===t){if(u(o.error)){let e=o.error;"RuntimeError"===e.name?(e=new ue(o.error.message),e.stack=o.error.stack):"DeveloperError"===e.name?(e=new de(o.error.message),e.stack=o.error.stack):"Error"===e.name&&(e=new Error(o.error.message),e.stack=o.error.stack),i5.raiseEvent(e),n(e)}else i5.raiseEvent(),i(o.result);e.removeEventListener("message",r)}};return r},rSe=[];async function sSe(e,t,i){let n=await Promise.resolve(SZ());u(i)?n||(i.length=0):i=rSe;let r=e._nextID++,o=new Promise(((t,i)=>{e._worker.addEventListener("message",oSe(e._worker,r,t,i))}));return e._worker.postMessage({id:r,baseUrl:$t.getCesiumBaseUrl().url,parameters:t,canTransferArrayBuffer:n},i),o}async function aSe(e,t,i){++e._activeTasks;try{let n=await sSe(e,t,i);return--e._activeTasks,n}catch(t){throw--e._activeTasks,t}}ea.prototype.scheduleTask=function(e,t){if(u(this._worker)||(this._worker=o5(this._workerPath)),!(this._activeTasks>=this._maximumActiveTasks))return aSe(this,e,t)},ea.prototype.initWebAssemblyModule=async function(e){if(u(this._webAssemblyPromise))return this._webAssemblyPromise;return this._webAssemblyPromise=(async()=>{let t,i=this._worker=o5(this._workerPath),n=await iSe(this,e),r=await Promise.resolve(SZ()),o=n.wasmBinary;u(o)&&r&&(t=[o]);let a=new Promise(((e,t)=>{i.onmessage=function({data:i}){u(i)?e(i.result):t(new ue("Could not configure wasm module"))}}));return i.postMessage({canTransferArrayBuffer:r,parameters:{webAssemblyConfig:n}},t),a})(),this._webAssemblyPromise},ea.prototype.isDestroyed=function(){return!1},ea.prototype.destroy=function(){return u(this._worker)&&this._worker.terminate(),le(this)},ea.taskCompletedEvent=i5,ea._defaultWorkerModulePrefix="Workers/",ea._workerModulePrefix=ea._defaultWorkerModulePrefix,ea._canTransferArrayBuffer=void 0;var pi=ea;function f_(){de.throwInstantiationError()}Object.defineProperties(f_.prototype,{credits:{get:de.throwInstantiationError},waterMask:{get:de.throwInstantiationError}}),f_.prototype.interpolateHeight=de.throwInstantiationError,f_.prototype.isChildAvailable=de.throwInstantiationError,f_.prototype.createMesh=de.throwInstantiationError,f_.prototype.upsample=de.throwInstantiationError,f_.prototype.wasCreatedByUpsampling=de.throwInstantiationError,f_.maximumAsynchronousTasks=5;var sh=f_;function cSe(e,t,i,n,r,o,a,s,l,u,c,h,d,p,f,m){this.center=e,this.vertices=t,this.stride=y(u,6),this.indices=i,this.indexCountWithoutSkirts=n,this.vertexCountWithoutSkirts=r,this.minimumHeight=o,this.maximumHeight=a,this.boundingSphere3D=s,this.occludeePointInScaledSpace=l,this.orientedBoundingBox=c,this.encoding=h,this.westIndicesSouthToNorth=d,this.southIndicesEastToWest=p,this.eastIndicesNorthToSouth=f,this.northIndicesWestToEast=m}var Ff=cSe,ms={UNSIGNED_BYTE:ee.UNSIGNED_BYTE,UNSIGNED_SHORT:ee.UNSIGNED_SHORT,UNSIGNED_INT:ee.UNSIGNED_INT,getSizeInBytes:function(e){switch(e){case ms.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ms.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ms.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}},fromSizeInBytes:function(e){switch(e){case 2:return ms.UNSIGNED_SHORT;case 4:return ms.UNSIGNED_INT;case 1:return ms.UNSIGNED_BYTE}},validate:function(e){return u(e)&&(e===ms.UNSIGNED_BYTE||e===ms.UNSIGNED_SHORT||e===ms.UNSIGNED_INT)},createTypedArray:function(e,t){return e>=P.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},createTypedArrayFromArrayBuffer:function(e,t,i,n){return e>=P.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,i,n):new Uint16Array(t,i,n)},fromTypedArray:function(e){return e instanceof Uint8Array?ms.UNSIGNED_BYTE:e instanceof Uint16Array?ms.UNSIGNED_SHORT:e instanceof Uint32Array?ms.UNSIGNED_INT:void 0}},ke=Object.freeze(ms);function ac(){de.throwInstantiationError()}Object.defineProperties(ac.prototype,{errorEvent:{get:de.throwInstantiationError},credit:{get:de.throwInstantiationError},tilingScheme:{get:de.throwInstantiationError},hasWaterMask:{get:de.throwInstantiationError},hasVertexNormals:{get:de.throwInstantiationError},availability:{get:de.throwInstantiationError}});var wZ=[];ac.getRegularGridIndices=function(e,t){let i=wZ[e];u(i)||(wZ[e]=i=[]);let n=i[t];return u(n)||(n=e*t<P.SIXTY_FOUR_KILOBYTES?i[t]=new Uint16Array((e-1)*(t-1)*6):i[t]=new Uint32Array((e-1)*(t-1)*6),PZ(e,t,n,0)),n};var vZ=[];ac.getRegularGridIndicesAndEdgeIndices=function(e,t){let i=vZ[e];u(i)||(vZ[e]=i=[]);let n=i[t];if(!u(n)){let r=ac.getRegularGridIndices(e,t),o=IZ(e,t),a=o.westIndicesSouthToNorth,s=o.southIndicesEastToWest,l=o.eastIndicesNorthToSouth,u=o.northIndicesWestToEast;n=i[t]={indices:r,westIndicesSouthToNorth:a,southIndicesEastToWest:s,eastIndicesNorthToSouth:l,northIndicesWestToEast:u}}return n};var DZ=[];function IZ(e,t){let i,n=new Array(t),r=new Array(e),o=new Array(t),a=new Array(e);for(i=0;i<e;++i)a[i]=i,r[i]=e*t-1-i;for(i=0;i<t;++i)o[i]=(i+1)*e-1,n[i]=(t-i-1)*e;return{westIndicesSouthToNorth:n,southIndicesEastToWest:r,eastIndicesNorthToSouth:o,northIndicesWestToEast:a}}function PZ(e,t,i,n){let r=0;for(let o=0;o<t-1;++o){for(let t=0;t<e-1;++t){let t=r,o=t+e,a=o+1,s=t+1;i[n++]=t,i[n++]=o,i[n++]=s,i[n++]=s,i[n++]=o,i[n++]=a,++r}++r}}function zP(e,t,i,n){let r=e[0],o=e.length;for(let a=1;a<o;++a){let o=e[a];i[n++]=r,i[n++]=o,i[n++]=t,i[n++]=t,i[n++]=o,i[n++]=t+1,r=o,++t}return n}ac.getRegularGridAndSkirtIndicesAndEdgeIndices=function(e,t){let i=DZ[e];u(i)||(DZ[e]=i=[]);let n=i[t];if(!u(n)){let r=e*t,o=(e-1)*(t-1)*6,a=2*e+2*t,s=r+a,l=o+6*Math.max(0,a-4),u=IZ(e,t),c=u.westIndicesSouthToNorth,h=u.southIndicesEastToWest,d=u.eastIndicesNorthToSouth,p=u.northIndicesWestToEast,f=ke.createTypedArray(s,l);PZ(e,t,f,0),ac.addSkirtIndices(c,h,d,p,r,f,o),n=i[t]={indices:f,westIndicesSouthToNorth:c,southIndicesEastToWest:h,eastIndicesNorthToSouth:d,northIndicesWestToEast:p,indexCountWithoutSkirts:o}}return n},ac.addSkirtIndices=function(e,t,i,n,r,o,a){let s=r;a=zP(e,s,o,a),s+=e.length,a=zP(t,s,o,a),s+=t.length,a=zP(i,s,o,a),s+=i.length,zP(n,s,o,a)},ac.heightmapTerrainQuality=.25,ac.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,i){return 2*e.maximumRadius*Math.PI*ac.heightmapTerrainQuality/(t*i)},ac.prototype.requestTileGeometry=de.throwInstantiationError,ac.prototype.getLevelMaximumGeometricError=de.throwInstantiationError,ac.prototype.getTileDataAvailable=de.throwInstantiationError,ac.prototype.loadTileDataAvailability=de.throwInstantiationError;var Ur=ac;function Pm(e){this._buffer=e.buffer,this._width=e.width,this._height=e.height,this._childTileMask=y(e.childTileMask,15),this._encoding=y(e.encoding,Mf.NONE);let t=iS.DEFAULT_STRUCTURE,i=e.structure;u(i)?i!==t&&(i.heightScale=y(i.heightScale,t.heightScale),i.heightOffset=y(i.heightOffset,t.heightOffset),i.elementsPerHeight=y(i.elementsPerHeight,t.elementsPerHeight),i.stride=y(i.stride,t.stride),i.elementMultiplier=y(i.elementMultiplier,t.elementMultiplier),i.isBigEndian=y(i.isBigEndian,t.isBigEndian)):i=t,this._structure=i,this._createdByUpsampling=y(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._skirtHeight=void 0,this._bufferType=this._encoding===Mf.LERC?Float32Array:this._buffer.constructor,this._mesh=void 0}Object.defineProperties(Pm.prototype,{credits:{get:function(){}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}}});var OZ="createVerticesFromHeightmap",lSe=new pi(OZ),uSe=new pi(OZ,sh.maximumAsynchronousTasks);function fSe(e,t,i,n,r,o,a,s,l,u){let c=(l-o.west)*(a-1)/(o.east-o.west),h=(u-o.south)*(s-1)/(o.north-o.south),d=0|c,p=d+1;p>=a&&(p=a-1,d=a-2);let f=0|h,m=f+1;m>=s&&(m=s-1,f=s-2);let _=h-f;return f=s-1-f,m=s-1-m,MZ(c-d,_,HP(e,t,i,n,r,f*a+d),HP(e,t,i,n,r,f*a+p),HP(e,t,i,n,r,m*a+d),HP(e,t,i,n,r,m*a+p))}function RZ(e,t,i,n,r,o,a,s,l){let u=(s-r.west)*(o-1)/(r.east-r.west),c=(l-r.south)*(a-1)/(r.north-r.south),h=0|u,d=h+1;d>=o&&(d=o-1,h=o-2);let p=0|c,f=p+1;f>=a&&(f=a-1,p=a-2);let m=c-p;return p=a-1-p,f=a-1-f,MZ(u-h,m,(t.decodeHeight(e,p*o+h)-i)/n,(t.decodeHeight(e,p*o+d)-i)/n,(t.decodeHeight(e,f*o+h)-i)/n,(t.decodeHeight(e,f*o+d)-i)/n)}function MZ(e,t,i,n,r,o){return t<e?i+e*(n-i)+t*(o-n):i+e*(o-r)+t*(r-i)}function HP(e,t,i,n,r,o){o*=n;let a,s=0;if(r)for(a=0;a<t;++a)s=s*i+e[o+a];else for(a=t-1;a>=0;--a)s=s*i+e[o+a];return s}function dSe(e,t,i,n,r,o,a,s){let l;if(a*=r,o)for(l=0;l<t-1;++l)e[a+l]=s/n|0,s-=e[a+l]*n,n/=i;else for(l=t-1;l>0;--l)e[a+l]=s/n|0,s-=e[a+l]*n,n/=i;e[a+l]=s}Pm.prototype.createMesh=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).tilingScheme,i=e.x,n=e.y,r=e.level,o=y(e.exaggeration,1),a=y(e.exaggerationRelativeHeight,0),s=y(e.throttle,!0),l=t.ellipsoid,c=t.tileXYToNativeRectangle(i,n,r),d=t.tileXYToRectangle(i,n,r),p=l.cartographicToCartesian(ce.center(d)),f=this._structure,m=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(l,this._width,t.getNumberOfXTilesAtLevel(0))/(1<<r);this._skirtHeight=Math.min(4*m,1e3);let _=(s?uSe:lSe).scheduleTask({heightmap:this._buffer,structure:f,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:c,rectangle:d,relativeToCenter:p,ellipsoid:l,skirtHeight:this._skirtHeight,isGeographic:t.projection instanceof Ii,exaggeration:o,exaggerationRelativeHeight:a,encoding:this._encoding});if(!u(_))return;let g=this;return Promise.resolve(_).then((function(e){let t;t=g._skirtHeight>0?Ur.getRegularGridAndSkirtIndicesAndEdgeIndices(e.gridWidth,e.gridHeight):Ur.getRegularGridIndicesAndEdgeIndices(e.gridWidth,e.gridHeight);let i=e.gridWidth*e.gridHeight;return g._mesh=new Ff(p,new Float32Array(e.vertices),t.indices,t.indexCountWithoutSkirts,i,e.minimumHeight,e.maximumHeight,se.clone(e.boundingSphere3D),h.clone(e.occludeePointInScaledSpace),e.numberOfAttributes,Pn.clone(e.orientedBoundingBox),sc.clone(e.encoding),t.westIndicesSouthToNorth,t.southIndicesEastToWest,t.eastIndicesNorthToSouth,t.northIndicesWestToEast),g._buffer=void 0,g._mesh}))},Pm.prototype._createMeshSync=function(e){let t=e.tilingScheme,i=e.x,n=e.y,r=e.level,o=y(e.exaggeration,1),a=y(e.exaggerationRelativeHeight,0),s=t.ellipsoid,l=t.tileXYToNativeRectangle(i,n,r),u=t.tileXYToRectangle(i,n,r),c=s.cartographicToCartesian(ce.center(u)),h=this._structure,d=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(s,this._width,t.getNumberOfXTilesAtLevel(0))/(1<<r);this._skirtHeight=Math.min(4*d,1e3);let p,f=iS.computeVertices({heightmap:this._buffer,structure:h,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:l,rectangle:u,relativeToCenter:c,ellipsoid:s,skirtHeight:this._skirtHeight,isGeographic:t.projection instanceof Ii,exaggeration:o,exaggerationRelativeHeight:a});this._buffer=void 0,p=this._skirtHeight>0?Ur.getRegularGridAndSkirtIndicesAndEdgeIndices(this._width,this._height):Ur.getRegularGridIndicesAndEdgeIndices(this._width,this._height);let m=f.gridWidth*f.gridHeight;return this._mesh=new Ff(c,f.vertices,p.indices,p.indexCountWithoutSkirts,m,f.minimumHeight,f.maximumHeight,f.boundingSphere3D,f.occludeePointInScaledSpace,f.encoding.stride,f.orientedBoundingBox,f.encoding,p.westIndicesSouthToNorth,p.southIndicesEastToWest,p.eastIndicesNorthToSouth,p.northIndicesWestToEast),this._mesh},Pm.prototype.interpolateHeight=function(e,t,i){let n,r=this._width,o=this._height,a=this._structure,s=a.stride,l=a.elementsPerHeight,c=a.elementMultiplier,h=a.isBigEndian,d=a.heightOffset,p=a.heightScale,f=u(this._mesh),m=this._encoding===Mf.LERC;if(f||!m){if(f){n=RZ(this._mesh.vertices,this._mesh.encoding,d,p,e,r,o,t,i)}else n=fSe(this._buffer,l,c,s,h,e,r,o,t,i),n=n*p+d;return n}},Pm.prototype.upsample=function(e,t,i,n,r,o,a){let s=this._mesh;if(!u(s))return;let l=this._width,c=this._height,h=this._structure,d=h.stride,p=new this._bufferType(l*c*d),f=s.vertices,m=s.encoding,_=e.tileXYToRectangle(t,i,n),g=e.tileXYToRectangle(r,o,a),y=h.heightOffset,v=h.heightScale,b=h.elementsPerHeight,A=h.elementMultiplier,T=h.isBigEndian,E=Math.pow(A,b-1);for(let e=0;e<c;++e){let t=P.lerp(g.north,g.south,e/(c-1));for(let i=0;i<l;++i){let n=RZ(f,m,y,v,_,l,c,P.lerp(g.west,g.east,i/(l-1)),t);n=n<h.lowestEncodedHeight?h.lowestEncodedHeight:n,n=n>h.highestEncodedHeight?h.highestEncodedHeight:n,dSe(p,b,A,E,d,T,e*l+i,n)}}return Promise.resolve(new Pm({buffer:p,width:l,height:c,childTileMask:0,structure:this._structure,createdByUpsampling:!0}))},Pm.prototype.isChildAvailable=function(e,t,i,n){let r=2;return i!==2*e&&++r,n!==2*t&&(r-=2),0!=(this._childTileMask&1<<r)},Pm.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var va=Pm;function Vb(e,t){this._tilingScheme=e,this._maximumLevel=t,this._rootNodes=[]}var e0=new ce;function hSe(e,t,i,n){let r=n.length;for(let o=0;o<r;++o){let r=n[o];if(r.x===t&&r.y===i&&r.level===e)return!0}return!1}Vb.prototype.addAvailableTileRange=function(e,t,i,n,r){let o=this._tilingScheme,a=this._rootNodes;if(0===e)for(let s=i;s<=r;++s)for(let i=t;i<=n;++i)hSe(e,i,s,a)||a.push(new Bb(o,void 0,0,i,s));o.tileXYToRectangle(t,i,e,e0);let s=e0.west,l=e0.north;o.tileXYToRectangle(n,r,e,e0);let u=e0.east,c=new ySe(e,s,e0.south,u,l);for(let e=0;e<a.length;++e){let t=a[e];r5(t.extent,c)&&xSe(this._maximumLevel,t,c)}},Vb.prototype.computeMaximumLevelAtPosition=function(e){let t;for(let i=0;i<this._rootNodes.length;++i){let n=this._rootNodes[i];if(kb(n.extent,e)){t=n;break}}return u(t)?oS(void 0,t,e):-1};var mSe=[],pSe=[],_Se=new ce,gSe=new ce;Vb.prototype.computeBestAvailableLevelOverRectangle=function(e){let t=mSe;t.length=0,e.east<e.west?(t.push(ce.fromRadians(-Math.PI,e.south,e.east,e.north,_Se)),t.push(ce.fromRadians(e.west,e.south,Math.PI,e.north,gSe))):t.push(e);let i,n=pSe;for(n.length=0,i=0;i<this._rootNodes.length;++i)rS(n,this._rootNodes[i],t);for(i=n.length-1;i>=0;--i)if(u(n[i])&&0===n[i].length)return i;return 0};var LZ=new fe;function Bb(e,t,i,n,r){this.tilingScheme=e,this.parent=t,this.level=i,this.x=n,this.y=r,this.extent=e.tileXYToRectangle(n,r,i),this.rectangles=[],this._sw=void 0,this._se=void 0,this._nw=void 0,this._ne=void 0}function ySe(e,t,i,n,r){this.level=e,this.west=t,this.south=i,this.east=n,this.north=r}function r5(e,t){let i=Math.max(e.west,t.west),n=Math.max(e.south,t.south),r=Math.min(e.east,t.east);return n<Math.min(e.north,t.north)&&i<r}function xSe(e,t,i){for(;t.level<e;)if(GP(t.nw.extent,i))t=t.nw;else if(GP(t.ne.extent,i))t=t.ne;else if(GP(t.sw.extent,i))t=t.sw;else{if(!GP(t.se.extent,i))break;t=t.se}if(0===t.rectangles.length||t.rectangles[t.rectangles.length-1].level<=i.level)t.rectangles.push(i);else{let e=Eo(t.rectangles,i.level,bSe);e<0&&(e=~e),t.rectangles.splice(e,0,i)}}function bSe(e,t){return e.level-t}function GP(e,t){return t.west>=e.west&&t.east<=e.east&&t.south>=e.south&&t.north<=e.north}function kb(e,t){return t.longitude>=e.west&&t.longitude<=e.east&&t.latitude>=e.south&&t.latitude<=e.north}function oS(e,t,i){let n=0,r=!1;for(;!r;){let e=t._nw&&kb(t._nw.extent,i),o=t._ne&&kb(t._ne.extent,i),a=t._sw&&kb(t._sw.extent,i),s=t._se&&kb(t._se.extent,i);if(e+o+a+s>1){e&&(n=Math.max(n,oS(t,t._nw,i))),o&&(n=Math.max(n,oS(t,t._ne,i))),a&&(n=Math.max(n,oS(t,t._sw,i))),s&&(n=Math.max(n,oS(t,t._se,i)));break}e?t=t._nw:o?t=t._ne:a?t=t._sw:s?t=t._se:r=!0}for(;t!==e;){let e=t.rectangles;for(let t=e.length-1;t>=0&&e[t].level>n;--t){let r=e[t];kb(r,i)&&(n=r.level)}t=t.parent}return n}function rS(e,t,i){if(!t)return;let n,r=!1;for(n=0;n<i.length;++n)r=r||r5(t.extent,i[n]);if(!r)return;let o=t.rectangles;for(n=0;n<o.length;++n){let t=o[n];e[t.level]||(e[t.level]=i),e[t.level]=TSe(e[t.level],t)}rS(e,t._nw,i),rS(e,t._ne,i),rS(e,t._sw,i),rS(e,t._se,i)}function TSe(e,t){let i=[];for(let n=0;n<e.length;++n){let r=e[n];r5(r,t)?(r.west<t.west&&i.push(new ce(r.west,r.south,t.west,r.north)),r.east>t.east&&i.push(new ce(t.east,r.south,r.east,r.north)),r.south<t.south&&i.push(new ce(Math.max(t.west,r.west),r.south,Math.min(t.east,r.east),t.south)),r.north>t.north&&i.push(new ce(Math.max(t.west,r.west),t.north,Math.min(t.east,r.east),r.north))):i.push(r)}return i}Vb.prototype.isTileAvailable=function(e,t,i){let n=this._tilingScheme.tileXYToRectangle(t,i,e,e0);return ce.center(n,LZ),this.computeMaximumLevelAtPosition(LZ)>=e},Vb.prototype.computeChildMaskForTile=function(e,t,i){let n=e+1;if(n>=this._maximumLevel)return 0;let r=0;return r|=this.isTileAvailable(n,2*t,2*i+1)?1:0,r|=this.isTileAvailable(n,2*t+1,2*i+1)?2:0,r|=this.isTileAvailable(n,2*t,2*i)?4:0,r|=this.isTileAvailable(n,2*t+1,2*i)?8:0,r},Object.defineProperties(Bb.prototype,{nw:{get:function(){return this._nw||(this._nw=new Bb(this.tilingScheme,this,this.level+1,2*this.x,2*this.y)),this._nw}},ne:{get:function(){return this._ne||(this._ne=new Bb(this.tilingScheme,this,this.level+1,2*this.x+1,2*this.y)),this._ne}},sw:{get:function(){return this._sw||(this._sw=new Bb(this.tilingScheme,this,this.level+1,2*this.x,2*this.y+1)),this._sw}},se:{get:function(){return this._se||(this._se=new Bb(this.tilingScheme,this,this.level+1,2*this.x+1,2*this.y+1)),this._se}}});var ah=Vb;function ASe(e){let t,i=e.name,n=e.message;t=u(i)&&u(n)?`${i}: ${n}`:e.toString();let r=e.stack;return u(r)&&(t+=`\n${r}`),t}var Om=ASe;function WP(e,t,i,n,r,o,a){this.provider=e,this.message=t,this.x=i,this.y=n,this.level=r,this.timesRetried=y(o,0),this.retry=!1,this.error=a}WP.reportError=function(e,t,i,n,r,o,a,s){let l=e;return u(e)?(l.provider=t,l.message=n,l.x=r,l.y=o,l.level=a,l.retry=!1,l.error=s,++l.timesRetried):l=new WP(t,n,r,o,a,0,s),u(i)&&i.numberOfListeners>0?i.raiseEvent(l):u(t)&&console.log(`An error occurred in "${t.constructor.name}": ${Om(n)}`),l},WP.reportSuccess=function(e){u(e)&&(e.timesRetried=-1)};var bo=WP;function d_(e){if(e=y(e,y.EMPTY_OBJECT),this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._numberOfLevelZeroTilesX=y(e.numberOfLevelZeroTilesX,1),this._numberOfLevelZeroTilesY=y(e.numberOfLevelZeroTilesY,1),this._projection=new Oi(this._ellipsoid),u(e.rectangleSouthwestInMeters)&&u(e.rectangleNortheastInMeters))this._rectangleSouthwestInMeters=e.rectangleSouthwestInMeters,this._rectangleNortheastInMeters=e.rectangleNortheastInMeters;else{let e=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new U(-e,-e),this._rectangleNortheastInMeters=new U(e,e)}let t=this._projection.unproject(this._rectangleSouthwestInMeters),i=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new ce(t.longitude,t.latitude,i.longitude,i.latitude)}Object.defineProperties(d_.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),d_.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},d_.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},d_.prototype.rectangleToNativeRectangle=function(e,t){let i=this._projection,n=i.project(ce.southwest(e)),r=i.project(ce.northeast(e));return u(t)?(t.west=n.x,t.south=n.y,t.east=r.x,t.north=r.y,t):new ce(n.x,n.y,r.x,r.y)},d_.prototype.tileXYToNativeRectangle=function(e,t,i,n){let r=this.getNumberOfXTilesAtLevel(i),o=this.getNumberOfYTilesAtLevel(i),a=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/r,s=this._rectangleSouthwestInMeters.x+e*a,l=this._rectangleSouthwestInMeters.x+(e+1)*a,c=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/o,h=this._rectangleNortheastInMeters.y-t*c,d=this._rectangleNortheastInMeters.y-(t+1)*c;return u(n)?(n.west=s,n.south=d,n.east=l,n.north=h,n):new ce(s,d,l,h)},d_.prototype.tileXYToRectangle=function(e,t,i,n){let r=this.tileXYToNativeRectangle(e,t,i,n),o=this._projection,a=o.unproject(new U(r.west,r.south)),s=o.unproject(new U(r.east,r.north));return r.west=a.longitude,r.south=a.latitude,r.east=s.longitude,r.north=s.latitude,r},d_.prototype.positionToTileXY=function(e,t,i){let n=this._rectangle;if(!ce.contains(n,e))return;let r=this.getNumberOfXTilesAtLevel(t),o=this.getNumberOfYTilesAtLevel(t),a=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/r,s=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/o,l=this._projection.project(e),c=(l.x-this._rectangleSouthwestInMeters.x)/a|0;c>=r&&(c=r-1);let h=(this._rectangleNortheastInMeters.y-l.y)/s|0;return h>=o&&(h=o-1),u(i)?(i.x=c,i.y=h,i):new U(c,h)};var zr=d_,CSe=15;function NZ(e){this.ellipsoid=y(e.ellipsoid,ie.WGS84),this.credit=void 0,this.tilingScheme=void 0,this.height=void 0,this.width=void 0,this.encoding=void 0,this.lodCount=void 0,this.hasAvailability=!1,this.tilesAvailable=void 0,this.tilesAvailabilityLoaded=void 0,this.levelZeroMaximumGeometricError=void 0,this.terrainDataStructure=void 0}function ESe(e,t){let i=t.copyrightText;u(i)&&(e.credit=new xt(i));let n=t.spatialReference,r=y(n.latestWkid,n.wkid),o=t.extent,a={ellipsoid:e.ellipsoid};if(4326===r)a.rectangle=ce.fromDegrees(o.xmin,o.ymin,o.xmax,o.ymax),e.tilingScheme=new Ui(a);else{if(3857!==r)throw new ue("Invalid spatial reference");{let i=Math.PI*e.ellipsoid.maximumRadius;t.extent.xmax>i&&(t.extent.xmax=i),t.extent.ymax>i&&(t.extent.ymax=i),t.extent.xmin<-i&&(t.extent.xmin=-i),t.extent.ymin<-i&&(t.extent.ymin=-i),a.rectangleSouthwestInMeters=new U(o.xmin,o.ymin),a.rectangleNortheastInMeters=new U(o.xmax,o.ymax),e.tilingScheme=new zr(a)}}let s=t.tileInfo;if(!u(s))throw new ue("tileInfo is required");e.width=s.rows+1,e.height=s.cols+1,e.encoding="LERC"===s.format?Mf.LERC:Mf.NONE,e.lodCount=s.lods.length-1,(e.hasAvailability=-1!==t.capabilities.indexOf("Tilemap"))&&(e.tilesAvailable=new ah(e.tilingScheme,e.lodCount),e.tilesAvailable.addAvailableTileRange(0,0,0,e.tilingScheme.getNumberOfXTilesAtLevel(0),e.tilingScheme.getNumberOfYTilesAtLevel(0)),e.tilesAvailabilityLoaded=new ah(e.tilingScheme,e.lodCount)),e.levelZeroMaximumGeometricError=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.tilingScheme.ellipsoid,e.width,e.tilingScheme.getNumberOfXTilesAtLevel(0)),t.bandCount>1&&console.log("ArcGISTiledElevationTerrainProvider: Terrain data has more than 1 band. Using the first one."),u(t.minValues)&&u(t.maxValues)?e.terrainDataStructure={elementMultiplier:1,lowestEncodedHeight:t.minValues[0],highestEncodedHeight:t.maxValues[0]}:e.terrainDataStructure={elementMultiplier:1}}async function SSe(e,t,i){try{ESe(e,await t.fetchJson())}catch(e){let n=`An error occurred while accessing ${t}.`;throw bo.reportError(void 0,i,u(i)?i._errorEvent:void 0,n),e}}function h_(e){e=y(e,y.EMPTY_OBJECT),this._resource=void 0,this._credit=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._maxLevel=void 0,this._terrainDataStructure=void 0,this._width=void 0,this._height=void 0,this._encoding=void 0,this._lodCount=void 0,this._hasAvailability=!1,this._tilesAvailable=void 0,this._tilesAvailabilityLoaded=void 0,this._availableCache={},this._errorEvent=new pe}function s5(e,t,i,n){if(!e._hasAvailability)return;let r=e._tilesAvailabilityLoaded,o=e._tilesAvailable;return!(t>e._lodCount)&&(!!o.isTileAvailable(t,i,n)||!r.isTileAvailable(t,i,n)&&void 0)}function wSe(e,t,i,n){let r=t-1,o=i-1,a=n[e.y*t+e.x],s=[],l={startX:e.x,startY:e.y,endX:0,endY:0},u=new U(e.x+1,e.y+1),c=!1,h=!1;for(;!c||!h;){let i=u.x,d=h?u.y+1:u.y;if(!c){for(let i=e.y;i<d;++i)if(n[i*t+u.x]!==a){c=!0;break}c?(s.push(new U(u.x,e.y)),--u.x,--i,l.endX=u.x):u.x===r?(l.endX=u.x,c=!0):++u.x}if(!h){let r=u.y*t;for(let t=e.x;t<=i;++t)if(n[r+t]!==a){h=!0;break}h?(s.push(new U(e.x,u.y)),--u.y,l.endY=u.y):u.y===o?(l.endY=u.y,h=!0):++u.y}}return{endingIndices:s,range:l,value:a}}function vSe(e,t,i,n,r){let o=[];if(r.every((function(e){return e===r[0]})))return 1===r[0]&&o.push({startX:e,startY:t,endX:e+i-1,endY:t+n-1}),o;let a=[new U(0,0)];for(;a.length>0;){let s=wSe(a.pop(),i,n,r);if(1===s.value){let i=s.range;i.startX+=e,i.endX+=e,i.startY+=t,i.endY+=t,o.push(i)}let l=s.endingIndices;l.length>0&&(a=a.concat(l))}return o}function FZ(e,t,i,n){if(!e._hasAvailability)return{};let r=128*Math.floor(i/128),o=128*Math.floor(n/128),a=Math.min(1<<t,128),s=`tilemap/${t}/${o}/${r}/${a}/${a}`,l=e._availableCache;if(u(l[s]))return l[s];let c=new Ko({throttle:!1,throttleByServer:!0,type:Jr.TERRAIN}),h=e._resource.getDerivedResource({url:s,request:c}).fetchJson();return u(h)?(h=h.then((function(s){let l=vSe(r,o,a,a,s.data);e._tilesAvailabilityLoaded.addAvailableTileRange(t,r,o,r+a,o+a);let u=e._tilesAvailable;for(let e=0;e<l.length;++e){let i=l[e];u.addAvailableTileRange(t,i.startX,i.startY,i.endX,i.endY)}return s5(e,t,i,n)})),l[s]={promise:h,request:c},h=h.finally((function(e){return delete l[s],e})),{promise:h,request:c}):{}}NZ.prototype.build=function(e){e._credit=this.credit,e._tilingScheme=this.tilingScheme,e._height=this.height,e._width=this.width,e._encoding=this.encoding,e._lodCount=this.lodCount,e._hasAvailability=this.hasAvailability,e._tilesAvailable=this.tilesAvailable,e._tilesAvailabilityLoaded=this.tilesAvailabilityLoaded,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._terrainDataStructure=this.terrainDataStructure},Object.defineProperties(h_.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){return this._tilesAvailable}}}),h_.fromUrl=async function(e,t){t=y(t,y.EMPTY_OBJECT),e=await Promise.resolve(e);let i=ve.createIfNeeded(e);i.appendForwardSlash(),u(t.token)&&(i=i.getDerivedResource({queryParameters:{token:t.token}}));let n=i.getDerivedResource({queryParameters:{f:"pjson"}}),r=new NZ(t);await SSe(r,n);let o=new h_(t);return r.build(o),o._resource=i,o},h_.prototype.requestTileGeometry=function(e,t,i,n){let r,o=this._resource.getDerivedResource({url:`tile/${i}/${t}/${e}`,request:n}),a=this._hasAvailability,s=Promise.resolve(!0);if(a&&!u(s5(this,i+1,2*e,2*t))){let n=FZ(this,i+1,2*e,2*t);s=n.promise,r=n.request}let l=o.fetchArrayBuffer();if(!u(l)||!u(s))return;let c=this,h=this._tilesAvailable;return Promise.all([l,s]).then((function(n){return new va({buffer:n[0],width:c._width,height:c._height,childTileMask:a?h.computeChildMaskForTile(i,e,t):CSe,structure:c._terrainDataStructure,encoding:c._encoding})})).catch((function(e){return u(r)&&r.state===Qn.CANCELLED?(n.cancel(),n.deferred.promise.finally((function(){return n.state=Qn.CANCELLED,Promise.reject(e)}))):Promise.reject(e)}))},h_.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},h_.prototype.getTileDataAvailable=function(e,t,i){if(!this._hasAvailability)return;let n=s5(this,i,e,t);if(u(n))return n;FZ(this,i,e,t)},h_.prototype.loadTileDataAvailability=function(e,t,i){};var BZ=h_,DSe={NONE:0,GEODESIC:1,RHUMB:2},Yt=Object.freeze(DSe),kZ=P.EPSILON10;function ISe(e,t,i,n){if(!u(e))return;i=y(i,!1);let r=u(n),o=e.length;if(o<2)return e;let a,s,l,c=e[0],h=0,d=-1;for(a=1;a<o;++a)s=e[a],t(c,s,kZ)?(u(l)||(l=e.slice(0,a),h=a-1,d=0),r&&n.push(a)):(u(l)&&(l.push(s),h=a,r&&(d=n.length)),c=s);return i&&t(e[0],e[o-1],kZ)&&(r&&(u(l)?n.splice(d,0,h):n.push(o-1)),u(l)?l.length-=1:l=e.slice(0,-1)),u(l)?l:e}var go=ISe,PSe={XTRANSLATE:"xTranslate",YTRANSLATE:"yTranslate",ZTRANSLATE:"zTranslate",XROTATE:"xRotate",YROTATE:"yRotate",ZROTATE:"zRotate",XSCALE:"xScale",YSCALE:"yScale",ZSCALE:"zScale",UNIFORMSCALE:"uniformScale"},cc=Object.freeze(PSe);function t0(){this._array=[],this._hash={}}Object.defineProperties(t0.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}}),t0.prototype.contains=function(e){return u(this._hash[e])},t0.prototype.set=function(e,t){t!==this._hash[e]&&(this.remove(e),this._hash[e]=t,this._array.push(t))},t0.prototype.get=function(e){return this._hash[e]},t0.prototype.remove=function(e){let t=this._hash[e],i=u(t);if(i){let i=this._array;i.splice(i.indexOf(t),1),delete this._hash[e]}return i},t0.prototype.removeAll=function(){let e=this._array;e.length>0&&(this._hash={},e.length=0)};var bt=t0,VZ=new h,UZ=new h,zZ=new h;function OSe(e,t,i,n,r){let o,a,s,l,c,d,p,f;if(u(r)||(r=new h),u(t.z)){if(h.equalsEpsilon(e,t,P.EPSILON14))return h.clone(h.UNIT_X,r);if(h.equalsEpsilon(e,i,P.EPSILON14))return h.clone(h.UNIT_Y,r);if(h.equalsEpsilon(e,n,P.EPSILON14))return h.clone(h.UNIT_Z,r);o=h.subtract(i,t,VZ),a=h.subtract(n,t,UZ),s=h.subtract(e,t,zZ),l=h.dot(o,o),c=h.dot(o,a),d=h.dot(o,s),p=h.dot(a,a),f=h.dot(a,s)}else{if(U.equalsEpsilon(e,t,P.EPSILON14))return h.clone(h.UNIT_X,r);if(U.equalsEpsilon(e,i,P.EPSILON14))return h.clone(h.UNIT_Y,r);if(U.equalsEpsilon(e,n,P.EPSILON14))return h.clone(h.UNIT_Z,r);o=U.subtract(i,t,VZ),a=U.subtract(n,t,UZ),s=U.subtract(e,t,zZ),l=U.dot(o,o),c=U.dot(o,a),d=U.dot(o,s),p=U.dot(a,a),f=U.dot(a,s)}r.y=p*d-c*f,r.z=l*f-c*d;let m=l*p-c*c;if(0!==m)return r.y/=m,r.z/=m,r.x=1-r.y-r.z,r}var Ub=OSe,HZ="https://dev.virtualearth.net/REST/v1/Locations";function a5(e){let t=(e=y(e,y.EMPTY_OBJECT)).key;this._key=t;let i={key:t};u(e.culture)&&(i.culture=e.culture),this._resource=new ve({url:HZ,queryParameters:i}),this._credit=new xt('<img src="http://dev.virtualearth.net/Branding/logo_powered_by.png"/>',!1)}Object.defineProperties(a5.prototype,{url:{get:function(){return HZ}},key:{get:function(){return this._key}},credit:{get:function(){return this._credit}}}),a5.prototype.geocode=async function(e){return this._resource.getDerivedResource({queryParameters:{query:e}}).fetchJsonp("jsonp").then((function(e){return 0===e.resourceSets.length?[]:e.resourceSets[0].resources.map((function(e){let t=e.bbox,i=t[0],n=t[1],r=t[2],o=t[3];return{displayName:e.name,destination:ce.fromDegrees(n,i,o,r)}}))}))};var GZ=a5;function mr(e,t,i,n){this.x=y(e,0),this.y=y(t,0),this.width=y(i,0),this.height=y(n,0)}mr.packedLength=4,mr.pack=function(e,t,i){return i=y(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.width,t[i]=e.height,t},mr.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new mr),i.x=e[t++],i.y=e[t++],i.width=e[t++],i.height=e[t],i},mr.fromPoints=function(e,t){if(u(t)||(t=new mr),!u(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;let i=e.length,n=e[0].x,r=e[0].y,o=e[0].x,a=e[0].y;for(let t=1;t<i;t++){let i=e[t],s=i.x,l=i.y;n=Math.min(s,n),o=Math.max(s,o),r=Math.min(l,r),a=Math.max(l,a)}return t.x=n,t.y=r,t.width=o-n,t.height=a-r,t};var RSe=new Ii,MSe=new fe,LSe=new fe;mr.fromRectangle=function(e,t,i){if(u(i)||(i=new mr),!u(e))return i.x=0,i.y=0,i.width=0,i.height=0,i;let n=(t=y(t,RSe)).project(ce.southwest(e,MSe)),r=t.project(ce.northeast(e,LSe));return U.subtract(r,n,r),i.x=n.x,i.y=n.y,i.width=r.x,i.height=r.y,i},mr.clone=function(e,t){if(u(e))return u(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new mr(e.x,e.y,e.width,e.height)},mr.union=function(e,t,i){u(i)||(i=new mr);let n=Math.min(e.x,t.x),r=Math.min(e.y,t.y),o=Math.max(e.x+e.width,t.x+t.width),a=Math.max(e.y+e.height,t.y+t.height);return i.x=n,i.y=r,i.width=o-n,i.height=a-r,i},mr.expand=function(e,t,i){i=mr.clone(e,i);let n=t.x-i.x,r=t.y-i.y;return n>i.width?i.width=n:n<0&&(i.width-=n,i.x=t.x),r>i.height?i.height=r:r<0&&(i.height-=r,i.y=t.y),i},mr.intersect=function(e,t){let i=e.x,n=e.y,r=t.x,o=t.y;return i>r+t.width||i+e.width<r||n+e.height<o||n>o+t.height?Zt.OUTSIDE:Zt.INTERSECTING},mr.equals=function(e,t){return e===t||u(e)&&u(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},mr.prototype.clone=function(e){return mr.clone(this,e)},mr.prototype.intersect=function(e){return mr.intersect(this,e)},mr.prototype.equals=function(e){return mr.equals(this,e)};var qe=mr,NSe={NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3},Bf=Object.freeze(NSe),ta={POINTS:ee.POINTS,LINES:ee.LINES,LINE_LOOP:ee.LINE_LOOP,LINE_STRIP:ee.LINE_STRIP,TRIANGLES:ee.TRIANGLES,TRIANGLE_STRIP:ee.TRIANGLE_STRIP,TRIANGLE_FAN:ee.TRIANGLE_FAN,isLines:function(e){return e===ta.LINES||e===ta.LINE_LOOP||e===ta.LINE_STRIP},isTriangles:function(e){return e===ta.TRIANGLES||e===ta.TRIANGLE_STRIP||e===ta.TRIANGLE_FAN},validate:function(e){return e===ta.POINTS||e===ta.LINES||e===ta.LINE_LOOP||e===ta.LINE_STRIP||e===ta.TRIANGLES||e===ta.TRIANGLE_STRIP||e===ta.TRIANGLE_FAN}},Ne=Object.freeze(ta);function c5(e){e=y(e,y.EMPTY_OBJECT),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=y(e.primitiveType,Ne.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=y(e.geometryType,Bf.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}c5.computeNumberOfVertices=function(e){let t=-1;for(let i in e.attributes)if(e.attributes.hasOwnProperty(i)&&u(e.attributes[i])&&u(e.attributes[i].values)){let n=e.attributes[i];t=n.values.length/n.componentsPerAttribute}return t};var FSe=new fe,BSe=new h,WZ=new L,kSe=[new fe,new fe,new fe],VSe=[new U,new U,new U],USe=[new U,new U,new U],zSe=new h,HSe=new Le,GSe=new L,WSe=new Ji;c5._textureCoordinateRotationPoints=function(e,t,i,n){let r,o=ce.center(n,FSe),a=fe.toCartesian(o,i,BSe),s=Rt.eastNorthUpToFixedFrame(a,i,WZ),l=L.inverse(s,WZ),u=VSe,c=kSe;c[0].longitude=n.west,c[0].latitude=n.south,c[1].longitude=n.west,c[1].latitude=n.north,c[2].longitude=n.east,c[2].latitude=n.south;let d=zSe;for(r=0;r<3;r++)fe.toCartesian(c[r],i,d),d=L.multiplyByPointAsVector(l,d,d),u[r].x=d.x,u[r].y=d.y;let p=Le.fromAxisAngle(h.UNIT_Z,-t,HSe),f=$.fromQuaternion(p,GSe),m=e.length,_=Number.POSITIVE_INFINITY,g=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(r=0;r<m;r++)d=L.multiplyByPointAsVector(l,e[r],d),d=$.multiplyByVector(f,d,d),_=Math.min(_,d.x),g=Math.min(g,d.y),y=Math.max(y,d.x),v=Math.max(v,d.y);let b=Ji.fromRotation(t,WSe),A=USe;A[0].x=_,A[0].y=g,A[1].x=_,A[1].y=v,A[2].x=y,A[2].y=g;let T=u[0],E=u[2].x-T.x,C=u[1].y-T.y;for(r=0;r<3;r++){let e=A[r];Ji.multiplyByVector(b,e,e),e.x=(e.x-T.x)/E,e.y=(e.y-T.y)/C}let x=A[0],S=A[1],w=A[2],I=new Array(6);return U.pack(x,I),U.pack(S,I,2),U.pack(w,I,4),I};var ct=c5;function jSe(e){e=y(e,y.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=y(e.normalize,!1),this.values=e.values}var Se=jSe;function qSe(e){e=y(e,y.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color}var hn=qSe,YSe={NONE:0,TOP:1,ALL:2},on=Object.freeze(YSe);function Hr(e){e=y(e,y.EMPTY_OBJECT),this.position=y(e.position,!1),this.normal=y(e.normal,!1),this.st=y(e.st,!1),this.bitangent=y(e.bitangent,!1),this.tangent=y(e.tangent,!1),this.color=y(e.color,!1)}Hr.POSITION_ONLY=Object.freeze(new Hr({position:!0})),Hr.POSITION_AND_NORMAL=Object.freeze(new Hr({position:!0,normal:!0})),Hr.POSITION_NORMAL_AND_ST=Object.freeze(new Hr({position:!0,normal:!0,st:!0})),Hr.POSITION_AND_ST=Object.freeze(new Hr({position:!0,st:!0})),Hr.POSITION_AND_COLOR=Object.freeze(new Hr({position:!0,color:!0})),Hr.ALL=Object.freeze(new Hr({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0})),Hr.DEFAULT=Hr.POSITION_NORMAL_AND_ST,Hr.packedLength=6,Hr.pack=function(e,t,i){return i=y(i,0),t[i++]=e.position?1:0,t[i++]=e.normal?1:0,t[i++]=e.st?1:0,t[i++]=e.tangent?1:0,t[i++]=e.bitangent?1:0,t[i]=e.color?1:0,t},Hr.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Hr),i.position=1===e[t++],i.normal=1===e[t++],i.st=1===e[t++],i.tangent=1===e[t++],i.bitangent=1===e[t++],i.color=1===e[t],i},Hr.clone=function(e,t){if(u(e))return u(t)||(t=new Hr),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};var Pe=Hr,XSe=new h;function vl(e){let t=(e=y(e,y.EMPTY_OBJECT)).minimum,i=e.maximum,n=y(e.vertexFormat,Pe.DEFAULT);this._minimum=h.clone(t),this._maximum=h.clone(i),this._vertexFormat=n,this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxGeometry"}vl.fromDimensions=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).dimensions,i=h.multiplyByScalar(t,.5,new h);return new vl({minimum:h.negate(i,new h),maximum:i,vertexFormat:e.vertexFormat,offsetAttribute:e.offsetAttribute})},vl.fromAxisAlignedBoundingBox=function(e){return new vl({minimum:e.minimum,maximum:e.maximum})},vl.packedLength=2*h.packedLength+Pe.packedLength+1,vl.pack=function(e,t,i){return i=y(i,0),h.pack(e._minimum,t,i),h.pack(e._maximum,t,i+h.packedLength),Pe.pack(e._vertexFormat,t,i+2*h.packedLength),t[i+2*h.packedLength+Pe.packedLength]=y(e._offsetAttribute,-1),t};var qZ=new h,YZ=new h,XZ=new Pe,jZ={minimum:qZ,maximum:YZ,vertexFormat:XZ,offsetAttribute:void 0},l5;vl.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t,qZ),r=h.unpack(e,t+h.packedLength,YZ),o=Pe.unpack(e,t+2*h.packedLength,XZ),a=e[t+2*h.packedLength+Pe.packedLength];return u(i)?(i._minimum=h.clone(n,i._minimum),i._maximum=h.clone(r,i._maximum),i._vertexFormat=Pe.clone(o,i._vertexFormat),i._offsetAttribute=-1===a?void 0:a,i):(jZ.offsetAttribute=-1===a?void 0:a,new vl(jZ))},vl.createGeometry=function(e){let t=e._minimum,i=e._maximum,n=e._vertexFormat;if(h.equals(t,i))return;let r,o,a=new hn;if(n.position&&(n.st||n.normal||n.tangent||n.bitangent)){if(n.position&&(o=new Float64Array(72),o[0]=t.x,o[1]=t.y,o[2]=i.z,o[3]=i.x,o[4]=t.y,o[5]=i.z,o[6]=i.x,o[7]=i.y,o[8]=i.z,o[9]=t.x,o[10]=i.y,o[11]=i.z,o[12]=t.x,o[13]=t.y,o[14]=t.z,o[15]=i.x,o[16]=t.y,o[17]=t.z,o[18]=i.x,o[19]=i.y,o[20]=t.z,o[21]=t.x,o[22]=i.y,o[23]=t.z,o[24]=i.x,o[25]=t.y,o[26]=t.z,o[27]=i.x,o[28]=i.y,o[29]=t.z,o[30]=i.x,o[31]=i.y,o[32]=i.z,o[33]=i.x,o[34]=t.y,o[35]=i.z,o[36]=t.x,o[37]=t.y,o[38]=t.z,o[39]=t.x,o[40]=i.y,o[41]=t.z,o[42]=t.x,o[43]=i.y,o[44]=i.z,o[45]=t.x,o[46]=t.y,o[47]=i.z,o[48]=t.x,o[49]=i.y,o[50]=t.z,o[51]=i.x,o[52]=i.y,o[53]=t.z,o[54]=i.x,o[55]=i.y,o[56]=i.z,o[57]=t.x,o[58]=i.y,o[59]=i.z,o[60]=t.x,o[61]=t.y,o[62]=t.z,o[63]=i.x,o[64]=t.y,o[65]=t.z,o[66]=i.x,o[67]=t.y,o[68]=i.z,o[69]=t.x,o[70]=t.y,o[71]=i.z,a.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:o})),n.normal){let e=new Float32Array(72);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=1,e[9]=0,e[10]=0,e[11]=1,e[12]=0,e[13]=0,e[14]=-1,e[15]=0,e[16]=0,e[17]=-1,e[18]=0,e[19]=0,e[20]=-1,e[21]=0,e[22]=0,e[23]=-1,e[24]=1,e[25]=0,e[26]=0,e[27]=1,e[28]=0,e[29]=0,e[30]=1,e[31]=0,e[32]=0,e[33]=1,e[34]=0,e[35]=0,e[36]=-1,e[37]=0,e[38]=0,e[39]=-1,e[40]=0,e[41]=0,e[42]=-1,e[43]=0,e[44]=0,e[45]=-1,e[46]=0,e[47]=0,e[48]=0,e[49]=1,e[50]=0,e[51]=0,e[52]=1,e[53]=0,e[54]=0,e[55]=1,e[56]=0,e[57]=0,e[58]=1,e[59]=0,e[60]=0,e[61]=-1,e[62]=0,e[63]=0,e[64]=-1,e[65]=0,e[66]=0,e[67]=-1,e[68]=0,e[69]=0,e[70]=-1,e[71]=0,a.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}if(n.st){let e=new Float32Array(48);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=1,e[5]=1,e[6]=0,e[7]=1,e[8]=1,e[9]=0,e[10]=0,e[11]=0,e[12]=0,e[13]=1,e[14]=1,e[15]=1,e[16]=0,e[17]=0,e[18]=1,e[19]=0,e[20]=1,e[21]=1,e[22]=0,e[23]=1,e[24]=1,e[25]=0,e[26]=0,e[27]=0,e[28]=0,e[29]=1,e[30]=1,e[31]=1,e[32]=1,e[33]=0,e[34]=0,e[35]=0,e[36]=0,e[37]=1,e[38]=1,e[39]=1,e[40]=0,e[41]=0,e[42]=1,e[43]=0,e[44]=1,e[45]=1,e[46]=0,e[47]=1,a.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:e})}if(n.tangent){let e=new Float32Array(72);e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=1,e[7]=0,e[8]=0,e[9]=1,e[10]=0,e[11]=0,e[12]=-1,e[13]=0,e[14]=0,e[15]=-1,e[16]=0,e[17]=0,e[18]=-1,e[19]=0,e[20]=0,e[21]=-1,e[22]=0,e[23]=0,e[24]=0,e[25]=1,e[26]=0,e[27]=0,e[28]=1,e[29]=0,e[30]=0,e[31]=1,e[32]=0,e[33]=0,e[34]=1,e[35]=0,e[36]=0,e[37]=-1,e[38]=0,e[39]=0,e[40]=-1,e[41]=0,e[42]=0,e[43]=-1,e[44]=0,e[45]=0,e[46]=-1,e[47]=0,e[48]=-1,e[49]=0,e[50]=0,e[51]=-1,e[52]=0,e[53]=0,e[54]=-1,e[55]=0,e[56]=0,e[57]=-1,e[58]=0,e[59]=0,e[60]=1,e[61]=0,e[62]=0,e[63]=1,e[64]=0,e[65]=0,e[66]=1,e[67]=0,e[68]=0,e[69]=1,e[70]=0,e[71]=0,a.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}if(n.bitangent){let e=new Float32Array(72);e[0]=0,e[1]=1,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=1,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=1,e[14]=0,e[15]=0,e[16]=1,e[17]=0,e[18]=0,e[19]=1,e[20]=0,e[21]=0,e[22]=1,e[23]=0,e[24]=0,e[25]=0,e[26]=1,e[27]=0,e[28]=0,e[29]=1,e[30]=0,e[31]=0,e[32]=1,e[33]=0,e[34]=0,e[35]=1,e[36]=0,e[37]=0,e[38]=1,e[39]=0,e[40]=0,e[41]=1,e[42]=0,e[43]=0,e[44]=1,e[45]=0,e[46]=0,e[47]=1,e[48]=0,e[49]=0,e[50]=1,e[51]=0,e[52]=0,e[53]=1,e[54]=0,e[55]=0,e[56]=1,e[57]=0,e[58]=0,e[59]=1,e[60]=0,e[61]=0,e[62]=1,e[63]=0,e[64]=0,e[65]=1,e[66]=0,e[67]=0,e[68]=1,e[69]=0,e[70]=0,e[71]=1,a.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}r=new Uint16Array(36),r[0]=0,r[1]=1,r[2]=2,r[3]=0,r[4]=2,r[5]=3,r[6]=6,r[7]=5,r[8]=4,r[9]=7,r[10]=6,r[11]=4,r[12]=8,r[13]=9,r[14]=10,r[15]=8,r[16]=10,r[17]=11,r[18]=14,r[19]=13,r[20]=12,r[21]=15,r[22]=14,r[23]=12,r[24]=18,r[25]=17,r[26]=16,r[27]=19,r[28]=18,r[29]=16,r[30]=20,r[31]=21,r[32]=22,r[33]=20,r[34]=22,r[35]=23}else o=new Float64Array(24),o[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=i.x,o[4]=t.y,o[5]=t.z,o[6]=i.x,o[7]=i.y,o[8]=t.z,o[9]=t.x,o[10]=i.y,o[11]=t.z,o[12]=t.x,o[13]=t.y,o[14]=i.z,o[15]=i.x,o[16]=t.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=t.x,o[22]=i.y,o[23]=i.z,a.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:o}),r=new Uint16Array(36),r[0]=4,r[1]=5,r[2]=6,r[3]=4,r[4]=6,r[5]=7,r[6]=1,r[7]=0,r[8]=3,r[9]=1,r[10]=3,r[11]=2,r[12]=1,r[13]=6,r[14]=5,r[15]=1,r[16]=2,r[17]=6,r[18]=2,r[19]=3,r[20]=7,r[21]=2,r[22]=7,r[23]=6,r[24]=3,r[25]=0,r[26]=4,r[27]=3,r[28]=4,r[29]=7,r[30]=0,r[31]=1,r[32]=5,r[33]=0,r[34]=5,r[35]=4;let s=h.subtract(i,t,XSe),l=.5*h.magnitude(s);if(u(e._offsetAttribute)){let t=o.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);a.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:a,indices:r,primitiveType:Ne.TRIANGLES,boundingSphere:new se(h.ZERO,l),offsetAttribute:e._offsetAttribute})},vl.getUnitBox=function(){return u(l5)||(l5=vl.createGeometry(vl.fromDimensions({dimensions:new h(1,1,1),vertexFormat:Pe.POSITION_ONLY}))),l5};var Dl=vl,KSe=new h;function ch(e){let t=(e=y(e,y.EMPTY_OBJECT)).minimum,i=e.maximum;this._min=h.clone(t),this._max=h.clone(i),this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxOutlineGeometry"}ch.fromDimensions=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).dimensions,i=h.multiplyByScalar(t,.5,new h);return new ch({minimum:h.negate(i,new h),maximum:i,offsetAttribute:e.offsetAttribute})},ch.fromAxisAlignedBoundingBox=function(e){return new ch({minimum:e.minimum,maximum:e.maximum})},ch.packedLength=2*h.packedLength+1,ch.pack=function(e,t,i){return i=y(i,0),h.pack(e._min,t,i),h.pack(e._max,t,i+h.packedLength),t[i+2*h.packedLength]=y(e._offsetAttribute,-1),t};var ZZ=new h,$Z=new h,KZ={minimum:ZZ,maximum:$Z,offsetAttribute:void 0};ch.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t,ZZ),r=h.unpack(e,t+h.packedLength,$Z),o=e[t+2*h.packedLength];return u(i)?(i._min=h.clone(n,i._min),i._max=h.clone(r,i._max),i._offsetAttribute=-1===o?void 0:o,i):(KZ.offsetAttribute=-1===o?void 0:o,new ch(KZ))},ch.createGeometry=function(e){let t=e._min,i=e._max;if(h.equals(t,i))return;let n=new hn,r=new Uint16Array(24),o=new Float64Array(24);o[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=i.x,o[4]=t.y,o[5]=t.z,o[6]=i.x,o[7]=i.y,o[8]=t.z,o[9]=t.x,o[10]=i.y,o[11]=t.z,o[12]=t.x,o[13]=t.y,o[14]=i.z,o[15]=i.x,o[16]=t.y,o[17]=i.z,o[18]=i.x,o[19]=i.y,o[20]=i.z,o[21]=t.x,o[22]=i.y,o[23]=i.z,n.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:o}),r[0]=4,r[1]=5,r[2]=5,r[3]=6,r[4]=6,r[5]=7,r[6]=7,r[7]=4,r[8]=0,r[9]=1,r[10]=1,r[11]=2,r[12]=2,r[13]=3,r[14]=3,r[15]=0,r[16]=0,r[17]=4,r[18]=1,r[19]=5,r[20]=2,r[21]=6,r[22]=3,r[23]=7;let a=h.subtract(i,t,KSe),s=.5*h.magnitude(a);if(u(e._offsetAttribute)){let t=o.length,i=e._offsetAttribute===on.NONE?0:1,r=new Uint8Array(t/3).fill(i);n.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:r})}return new ct({attributes:n,indices:r,primitiveType:Ne.LINES,boundingSphere:new se(h.ZERO,s),offsetAttribute:e._offsetAttribute})};var lh=ch;function u5(){}Object.defineProperties(u5.prototype,{credit:{get:function(){}}}),u5.prototype.geocode=function(e){let t=e.match(/[^\s,\n]+/g);if(2===t.length||3===t.length){let i=+t[0],n=+t[1],r=3===t.length?+t[2]:300;if(isNaN(i)&&isNaN(n)){let e=/^(\d+.?\d*)([nsew])/i;for(let r=0;r<t.length;++r){let o=t[r].match(e);e.test(t[r])&&3===o.length&&(/^[ns]/i.test(o[2])?n=/^[n]/i.test(o[2])?+o[1]:-o[1]:/^[ew]/i.test(o[2])&&(i=/^[e]/i.test(o[2])?+o[1]:-o[1]))}}if(!isNaN(i)&&!isNaN(n)&&!isNaN(r)){let t={displayName:e,destination:h.fromDegrees(i,n,r)};return Promise.resolve([t])}}return Promise.resolve([])};var QZ=u5;function zb(){this.times=void 0,this.points=void 0,de.throwInstantiationError()}zb.getPointType=function(e){return"number"==typeof e?Number:e instanceof h?h:e instanceof Le?Le:void 0},zb.prototype.evaluate=de.throwInstantiationError,zb.prototype.findTimeInterval=function(e,t){let i,n=this.times,r=n.length;if(e>=n[t=y(t,0)]){if(t+1<r&&e<n[t+1])return t;if(t+2<r&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;if(e>n[t])for(i=t;i<r-1&&!(e>=n[i]&&e<n[i+1]);++i);else for(i=t-1;i>=0&&!(e>=n[i]&&e<n[i+1]);--i);return i===r-1&&(i=r-2),i},zb.prototype.wrapTime=function(e){let t,i=this.times,n=i[i.length-1],r=i[0],o=n-r;return e<r&&(t=Math.floor((r-e)/o)+1,e+=t*o),e>n&&(t=Math.floor((e-n)/o)+1,e-=t*o),e},zb.prototype.clampTime=function(e){let t=this.times;return P.clamp(e,t[0],t[t.length-1])};var eo=zb;function Hb(e){let t=(e=y(e,y.EMPTY_OBJECT)).points,i=e.times;this._times=i,this._points=t,this._pointType=eo.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(Hb.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),Hb.prototype.findTimeInterval=eo.prototype.findTimeInterval,Hb.prototype.wrapTime=eo.prototype.wrapTime,Hb.prototype.clampTime=eo.prototype.clampTime,Hb.prototype.evaluate=function(e,t){let i=this.points,n=this.times,r=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),o=(e-n[r])/(n[r+1]-n[r]);return this._pointType===Number?(1-o)*i[r]+o*i[r+1]:(u(t)||(t=new h),h.lerp(i[r],i[r+1],o,t))};var n0=Hb,JZ={solve:function(e,t,i,n){let r,o,a=new Array(i.length),s=new Array(n.length),l=new Array(n.length);for(r=0;r<s.length;r++)s[r]=new h,l[r]=new h;for(a[0]=i[0]/t[0],s[0]=h.multiplyByScalar(n[0],1/t[0],s[0]),r=1;r<a.length;++r)o=1/(t[r]-a[r-1]*e[r-1]),a[r]=i[r]*o,s[r]=h.subtract(n[r],h.multiplyByScalar(s[r-1],e[r-1],s[r]),s[r]),s[r]=h.multiplyByScalar(s[r],o,s[r]);for(o=1/(t[r]-a[r-1]*e[r-1]),s[r]=h.subtract(n[r],h.multiplyByScalar(s[r-1],e[r-1],s[r]),s[r]),s[r]=h.multiplyByScalar(s[r],o,s[r]),l[l.length-1]=s[s.length-1],r=l.length-2;r>=0;--r)l[r]=h.subtract(s[r],h.multiplyByScalar(l[r+1],a[r],l[r]),l[r]);return l}},sS=JZ,e$=[],t$=[],n$=[],i$=[];function ZSe(e,t,i){let n,r=e$,o=n$,a=t$,s=i$;r.length=o.length=e.length-1,a.length=s.length=e.length,r[0]=a[0]=1,o[0]=0;let l=s[0];for(u(l)||(l=s[0]=new h),h.clone(t,l),n=1;n<r.length-1;++n)r[n]=o[n]=1,a[n]=4,l=s[n],u(l)||(l=s[n]=new h),h.subtract(e[n+1],e[n-1],l),h.multiplyByScalar(l,3,l);return r[n]=0,o[n]=1,a[n]=4,l=s[n],u(l)||(l=s[n]=new h),h.subtract(e[n+1],e[n-1],l),h.multiplyByScalar(l,3,l),a[n+1]=1,l=s[n+1],u(l)||(l=s[n+1]=new h),h.clone(i,l),sS.solve(r,a,o,s)}function $Se(e){let t,i=e$,n=n$,r=t$,o=i$;i.length=n.length=e.length-1,r.length=o.length=e.length,i[0]=n[0]=1,r[0]=2;let a=o[0];for(u(a)||(a=o[0]=new h),h.subtract(e[1],e[0],a),h.multiplyByScalar(a,3,a),t=1;t<i.length;++t)i[t]=n[t]=1,r[t]=4,a=o[t],u(a)||(a=o[t]=new h),h.subtract(e[t+1],e[t-1],a),h.multiplyByScalar(a,3,a);return r[t]=2,a=o[t],u(a)||(a=o[t]=new h),h.subtract(e[t],e[t-1],a),h.multiplyByScalar(a,3,a),sS.solve(i,r,n,o)}function qc(e){let t=(e=y(e,y.EMPTY_OBJECT)).points,i=e.times,n=e.inTangents,r=e.outTangents;this._times=i,this._points=t,this._pointType=eo.getPointType(t[0]),this._inTangents=n,this._outTangents=r,this._lastTimeIndex=0}Object.defineProperties(qc.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}}),qc.createC1=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).times,i=e.points,n=e.tangents,r=n.slice(0,n.length-1);return new qc({times:t,points:i,inTangents:n.slice(1,n.length),outTangents:r})},qc.createNaturalCubic=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).times,i=e.points;if(i.length<3)return new n0({points:i,times:t});let n=$Se(i),r=n.slice(0,n.length-1);return new qc({times:t,points:i,inTangents:n.slice(1,n.length),outTangents:r})},qc.createClampedCubic=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).times,i=e.points,n=e.firstTangent,r=e.lastTangent;eo.getPointType(i[0]);if(i.length<3)return new n0({points:i,times:t});let o=ZSe(i,n,r),a=o.slice(0,o.length-1);return new qc({times:t,points:i,inTangents:o.slice(1,o.length),outTangents:a})},qc.hermiteCoefficientMatrix=new L(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0),qc.prototype.findTimeInterval=eo.prototype.findTimeInterval;var QSe=new oe,Gb=new h;qc.prototype.wrapTime=eo.prototype.wrapTime,qc.prototype.clampTime=eo.prototype.clampTime,qc.prototype.evaluate=function(e,t){let i=this.points,n=this.times,r=this.inTangents,o=this.outTangents;this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);let a=this._lastTimeIndex,s=n[a+1]-n[a],l=(e-n[a])/s,c=QSe;c.z=l,c.y=l*l,c.x=c.y*l,c.w=1;let h=L.multiplyByVector(qc.hermiteCoefficientMatrix,c,c);h.z*=s,h.w*=s;let d=this._pointType;return d===Number?i[a]*h.x+i[a+1]*h.y+o[a]*h.z+r[a]*h.w:(u(t)||(t=new d),t=d.multiplyByScalar(i[a],h.x,t),d.multiplyByScalar(i[a+1],h.y,Gb),d.add(t,Gb,t),d.multiplyByScalar(o[a],h.z,Gb),d.add(t,Gb,t),d.multiplyByScalar(r[a],h.w,Gb),d.add(t,Gb,t))};var i0=qc,JSe=new oe,o$=new h,Wb=new h;function ewe(e){let t=e.points,i=e.times;if(t.length<3){let e=i[0],n=1/(i[1]-e),r=t[0],o=t[1];return function(t,i){u(i)||(i=new h);let a=(t-e)*n;return h.lerp(r,o,a,i)}}return function(n,r){u(r)||(r=new h);let o,a,s,l,c,d=e._lastTimeIndex=e.findTimeInterval(n,e._lastTimeIndex),p=(n-i[d])/(i[d+1]-i[d]),f=JSe;return f.z=p,f.y=p*p,f.x=f.y*p,f.w=1,0===d?(o=t[0],a=t[1],s=e.firstTangent,l=h.subtract(t[2],o,o$),h.multiplyByScalar(l,.5,l),c=L.multiplyByVector(i0.hermiteCoefficientMatrix,f,f)):d===t.length-2?(o=t[d],a=t[d+1],l=e.lastTangent,s=h.subtract(a,t[d-1],o$),h.multiplyByScalar(s,.5,s),c=L.multiplyByVector(i0.hermiteCoefficientMatrix,f,f)):(o=t[d-1],a=t[d],s=t[d+1],l=t[d+2],c=L.multiplyByVector(m_.catmullRomCoefficientMatrix,f,f)),r=h.multiplyByScalar(o,c.x,r),h.multiplyByScalar(a,c.y,Wb),h.add(r,Wb,r),h.multiplyByScalar(s,c.z,Wb),h.add(r,Wb,r),h.multiplyByScalar(l,c.w,Wb),h.add(r,Wb,r)}}var twe=new h,nwe=new h;function m_(e){let t=(e=y(e,y.EMPTY_OBJECT)).points,i=e.times,n=e.firstTangent,r=e.lastTangent;if(t.length>2&&(u(n)||(n=twe,h.multiplyByScalar(t[1],2,n),h.subtract(n,t[2],n),h.subtract(n,t[0],n),h.multiplyByScalar(n,.5,n)),!u(r))){let e=t.length-1;r=nwe,h.multiplyByScalar(t[e-1],2,r),h.subtract(t[e],r,r),h.add(r,t[e-2],r),h.multiplyByScalar(r,.5,r)}this._times=i,this._points=t,this._firstTangent=h.clone(n),this._lastTangent=h.clone(r),this._evaluateFunction=ewe(this),this._lastTimeIndex=0}Object.defineProperties(m_.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}}),m_.catmullRomCoefficientMatrix=new L(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0),m_.prototype.findTimeInterval=eo.prototype.findTimeInterval,m_.prototype.wrapTime=eo.prototype.wrapTime,m_.prototype.clampTime=eo.prototype.clampTime,m_.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var r$=m_;function p_(e,t,i){return t=y(t,0),i=y(i,e.byteLength-t),e=e.subarray(t,t+i),p_.decode(e)}function aS(e,t,i){return t<=e&&e<=i}function iwe(e){let t=0,i=0,n=0,r=128,o=191,a=[],s=e.length;for(let l=0;l<s;++l){let s=e[l];if(0===n){if(aS(s,0,127)){a.push(s);continue}if(aS(s,194,223)){n=1,t=31&s;continue}if(aS(s,224,239)){224===s&&(r=160),237===s&&(o=159),n=2,t=15&s;continue}if(aS(s,240,244)){240===s&&(r=144),244===s&&(o=143),n=3,t=7&s;continue}throw new ue("String decoding failed.")}aS(s,r,o)?(r=128,o=191,t=t<<6|63&s,++i,i===n&&(a.push(t),t=n=i=0)):(t=n=i=0,r=128,o=191,--l)}return a}p_.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)},p_.decodeWithFromCharCode=function(e){let t="",i=iwe(e),n=i.length;for(let e=0;e<n;++e){let n=i[e];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return t},typeof TextDecoder<"u"?p_.decode=p_.decodeWithTextDecoder:p_.decode=p_.decodeWithFromCharCode;var Il=p_;function owe(e,t,i){return JSON.parse(Il(e,t,i))}var So=owe,d5=or(Sl(),1),f5,s$="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyMzVjZDg3Yi0wMjVkLTQ0MzctOTZjOC1jZjMwNjkzZmI5MWUiLCJpZCI6MjU5LCJpYXQiOjE2OTg4NTM0MDl9.L_g01CjNKNVijEJ_8kOxiO02OADnuSjRFLkZWvhupcc",jP={};jP.defaultAccessToken=s$,jP.defaultServer=new ve({url:"https://api.cesium.com/"}),jP.getDefaultTokenCredit=function(e){if(e===s$){if(!u(f5)){f5=new xt('<b>             This application is using Cesium\'s default ion access token. Please assign <i>Cesium.Ion.defaultAccessToken</i>             with an access token from your ion account before making any Cesium API calls.             You can sign up for a free ion account at <a href="https://cesium.com">https://cesium.com</a>.</b>',!0)}return f5}};var uh=jP;function lc(e,t){let i,n=e.externalType,r=u(n);if(r){if("3DTILES"!==n&&"STK_TERRAIN_SERVER"!==n)throw new ue("Ion.createResource does not support external imagery assets; use IonImageryProvider instead.");i={url:e.options.url}}else i={url:e.url,retryAttempts:1,retryCallback:rwe};ve.call(this,i),this._ionEndpoint=e,this._ionEndpointDomain=r?void 0:new d5.default(e.url).authority(),this._ionEndpointResource=t,this._ionRoot=void 0,this._pendingPromise=void 0,this._credits=void 0,this._isExternal=r}function rwe(e,t){let i=y(e._ionRoot,e),n=i._ionEndpointResource,r=typeof Image<"u";return u(t)&&(401===t.statusCode||r&&t.target instanceof Image)?(u(i._pendingPromise)||(i._pendingPromise=n.fetchJson().then((function(e){return i._ionEndpoint=e,e})).finally((function(e){return i._pendingPromise=void 0,e}))),i._pendingPromise.then((function(t){return e._ionEndpoint=t,!0}))):Promise.resolve(!1)}u(Object.create)&&(lc.prototype=Object.create(ve.prototype),lc.prototype.constructor=lc),lc.fromAssetId=function(e,t){let i=lc._createEndpointResource(e,t);return i.fetchJson().then((function(e){return new lc(e,i)}))},Object.defineProperties(lc.prototype,{credits:{get:function(){return u(this._ionRoot)?this._ionRoot.credits:(u(this._credits)||(this._credits=lc.getCreditsFromEndpoint(this._ionEndpoint,this._ionEndpointResource)),this._credits)}}}),lc.getCreditsFromEndpoint=function(e,t){let i=e.attributions.map(xt.getIonCredit),n=uh.getDefaultTokenCredit(t.queryParameters.access_token);return u(n)&&i.push(xt.clone(n)),i},lc.prototype.clone=function(e){let t=y(this._ionRoot,this);return u(e)||(e=new lc(t._ionEndpoint,t._ionEndpointResource)),(e=ve.prototype.clone.call(this,e))._ionRoot=t,e._isExternal=this._isExternal,e},lc.prototype.fetchImage=function(e){if(!this._isExternal){let t=e;e={preferBlob:!0},u(t)&&(e.flipY=t.flipY,e.preferImageBitmap=t.preferImageBitmap)}return ve.prototype.fetchImage.call(this,e)},lc.prototype._makeRequest=function(e){return this._isExternal||new d5.default(this.url).authority()!==this._ionEndpointDomain||(u(e.headers)||(e.headers={}),e.headers.Authorization=`Bearer ${this._ionEndpoint.accessToken}`,e.headers["X-Cesium-Client"]="CesiumJS",typeof CESIUM_VERSION<"u"&&(e.headers["X-Cesium-Client-Version"]=CESIUM_VERSION)),ve.prototype._makeRequest.call(this,e)},lc._createEndpointResource=function(e,t){t=y(t,y.EMPTY_OBJECT);let i=y(t.server,uh.defaultServer),n=y(t.accessToken,uh.defaultAccessToken);i=ve.createIfNeeded(i);let r={url:`v1/assets/${e}/endpoint`};return u(n)&&(r.queryParameters={access_token:n}),i.getDerivedResource(r)};var Iu=lc,qP={clipTriangleAtAxisAlignedThreshold:function(e,t,i,n,r,o){let a,s,l;u(o)?o.length=0:o=[],t?(a=i<e,s=n<e,l=r<e):(a=i>e,s=n>e,l=r>e);let c,h,d,p,f,m,_=a+s+l;return 1===_?a?(c=(e-i)/(n-i),h=(e-i)/(r-i),o.push(1),o.push(2),1!==h&&(o.push(-1),o.push(0),o.push(2),o.push(h)),1!==c&&(o.push(-1),o.push(0),o.push(1),o.push(c))):s?(d=(e-n)/(r-n),p=(e-n)/(i-n),o.push(2),o.push(0),1!==p&&(o.push(-1),o.push(1),o.push(0),o.push(p)),1!==d&&(o.push(-1),o.push(1),o.push(2),o.push(d))):l&&(f=(e-r)/(i-r),m=(e-r)/(n-r),o.push(0),o.push(1),1!==m&&(o.push(-1),o.push(2),o.push(1),o.push(m)),1!==f&&(o.push(-1),o.push(2),o.push(0),o.push(f))):2===_?a||i===e?s||n===e?!l&&r!==e&&(h=(e-i)/(r-i),d=(e-n)/(r-n),o.push(2),o.push(-1),o.push(0),o.push(2),o.push(h),o.push(-1),o.push(1),o.push(2),o.push(d)):(m=(e-r)/(n-r),c=(e-i)/(n-i),o.push(1),o.push(-1),o.push(2),o.push(1),o.push(m),o.push(-1),o.push(0),o.push(1),o.push(c)):(p=(e-n)/(i-n),f=(e-r)/(i-r),o.push(0),o.push(-1),o.push(1),o.push(0),o.push(p),o.push(-1),o.push(2),o.push(0),o.push(f)):3!==_&&(o.push(0),o.push(1),o.push(2)),o},computeBarycentricCoordinates:function(e,t,i,n,r,o,a,s,l){let c=i-a,d=a-r,p=o-s,f=n-s,m=1/(p*c+d*f),_=t-s,g=e-a,y=(p*g+d*_)*m,v=(-f*g+c*_)*m,b=1-y-v;return u(l)?(l.x=y,l.y=v,l.z=b,l):new h(y,v,b)},computeLineSegmentLineSegmentIntersection:function(e,t,i,n,r,o,a,s,l){let c=(s-o)*(i-e)-(a-r)*(n-t);if(0===c)return;let h=((a-r)*(t-o)-(s-o)*(e-r))/c,d=((i-e)*(t-o)-(n-t)*(e-r))/c;return h>=0&&h<=1&&d>=0&&d<=1?(u(l)||(l=new U),l.x=e+h*(i-e),l.y=t+h*(n-t),l):void 0}},__=qP;function g_(e){this._quantizedVertices=e.quantizedVertices,this._encodedNormals=e.encodedNormals,this._indices=e.indices,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._boundingSphere=e.boundingSphere,this._orientedBoundingBox=e.orientedBoundingBox,this._horizonOcclusionPoint=e.horizonOcclusionPoint,this._credits=e.credits;let t=this._quantizedVertices.length/3,i=this._uValues=this._quantizedVertices.subarray(0,t),n=this._vValues=this._quantizedVertices.subarray(t,2*t);function r(e,t){return n[e]-n[t]}function o(e,t){return i[e]-i[t]}this._heightValues=this._quantizedVertices.subarray(2*t,3*t),this._westIndices=XP(e.westIndices,r,t),this._southIndices=XP(e.southIndices,o,t),this._eastIndices=XP(e.eastIndices,r,t),this._northIndices=XP(e.northIndices,o,t),this._westSkirtHeight=e.westSkirtHeight,this._southSkirtHeight=e.southSkirtHeight,this._eastSkirtHeight=e.eastSkirtHeight,this._northSkirtHeight=e.northSkirtHeight,this._childTileMask=y(e.childTileMask,15),this._createdByUpsampling=y(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._mesh=void 0}Object.defineProperties(g_.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return this._waterMask}},childTileMask:{get:function(){return this._childTileMask}},canUpsample:{get:function(){return u(this._mesh)}}});var YP=[];function XP(e,t,i){YP.length=e.length;let n=!1;for(let i=0,r=e.length;i<r;++i)YP[i]=e[i],n=n||i>0&&t(e[i-1],e[i])>0;return n?(YP.sort(t),ke.createTypedArray(i,YP)):e}var a$="createVerticesFromQuantizedTerrainMesh",swe=new pi(a$),awe=new pi(a$,sh.maximumAsynchronousTasks);g_.prototype.createMesh=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).tilingScheme,i=e.x,n=e.y,r=e.level,o=y(e.exaggeration,1),a=y(e.exaggerationRelativeHeight,0),s=y(e.throttle,!0),l=t.ellipsoid,c=t.tileXYToRectangle(i,n,r),d=(s?awe:swe).scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:!0,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:c,relativeToCenter:this._boundingSphere.center,ellipsoid:l,exaggeration:o,exaggerationRelativeHeight:a});if(!u(d))return;let p=this;return Promise.resolve(d).then((function(e){let t=p._quantizedVertices.length/3,i=t+p._westIndices.length+p._southIndices.length+p._eastIndices.length+p._northIndices.length,n=ke.createTypedArray(i,e.indices),r=new Float32Array(e.vertices),o=e.center,a=e.minimumHeight,s=e.maximumHeight,l=p._boundingSphere,u=p._orientedBoundingBox,c=y(h.clone(e.occludeePointInScaledSpace),p._horizonOcclusionPoint),d=e.vertexStride,f=sc.clone(e.encoding);return p._mesh=new Ff(o,r,n,e.indexCountWithoutSkirts,t,a,s,l,c,d,u,f,e.westIndicesSouthToNorth,e.southIndicesEastToWest,e.eastIndicesNorthToSouth,e.northIndicesWestToEast),p._quantizedVertices=void 0,p._encodedNormals=void 0,p._indices=void 0,p._uValues=void 0,p._vValues=void 0,p._heightValues=void 0,p._westIndices=void 0,p._southIndices=void 0,p._eastIndices=void 0,p._northIndices=void 0,p._mesh}))};var cwe=new pi("upsampleQuantizedTerrainMesh",sh.maximumAsynchronousTasks);g_.prototype.upsample=function(e,t,i,n,r,o,a){let s=this._mesh;if(!u(this._mesh))return;let l=2*t!==r,c=2*i===o,d=e.ellipsoid,p=e.tileXYToRectangle(r,o,a),f=cwe.scheduleTask({vertices:s.vertices,vertexCountWithoutSkirts:s.vertexCountWithoutSkirts,indices:s.indices,indexCountWithoutSkirts:s.indexCountWithoutSkirts,encoding:s.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:l,isNorthChild:c,childRectangle:p,ellipsoid:d});if(!u(f))return;let m=Math.min(this._westSkirtHeight,this._eastSkirtHeight);m=Math.min(m,this._southSkirtHeight),m=Math.min(m,this._northSkirtHeight);let _=l?.5*m:this._westSkirtHeight,g=c?.5*m:this._southSkirtHeight,y=l?this._eastSkirtHeight:.5*m,v=c?this._northSkirtHeight:.5*m,b=this._credits;return Promise.resolve(f).then((function(e){let t,i=new Uint16Array(e.vertices),n=ke.createTypedArray(i.length/3,e.indices);return u(e.encodedNormals)&&(t=new Uint8Array(e.encodedNormals)),new g_({quantizedVertices:i,indices:n,encodedNormals:t,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:se.clone(e.boundingSphere),orientedBoundingBox:Pn.clone(e.orientedBoundingBox),horizonOcclusionPoint:h.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:_,southSkirtHeight:g,eastSkirtHeight:y,northSkirtHeight:v,childTileMask:0,credits:b,createdByUpsampling:!0})}))};var h5=32767,c$=new h;function l$(e,t,i,n,r,o,a,s){let l=Math.min(i,r,a),u=Math.max(i,r,a),c=Math.min(n,o,s),h=Math.max(n,o,s);return e>=l&&e<=u&&t>=c&&t<=h}g_.prototype.interpolateHeight=function(e,t,i){let n=P.clamp((t-e.west)/e.width,0,1);n*=h5;let r=P.clamp((i-e.south)/e.height,0,1);return r*=h5,u(this._mesh)?dwe(this,n,r):hwe(this,n,r)};var lwe=new U,uwe=new U,fwe=new U;function dwe(e,t,i){let n=e._mesh,r=n.vertices,o=n.encoding,a=n.indices;for(let e=0,n=a.length;e<n;e+=3){let n=a[e],s=a[e+1],l=a[e+2],u=o.decodeTextureCoordinates(r,n,lwe),c=o.decodeTextureCoordinates(r,s,uwe),h=o.decodeTextureCoordinates(r,l,fwe);if(l$(t,i,u.x,u.y,c.x,c.y,h.x,h.y)){let e=__.computeBarycentricCoordinates(t,i,u.x,u.y,c.x,c.y,h.x,h.y,c$);if(e.x>=-1e-15&&e.y>=-1e-15&&e.z>=-1e-15){let t=o.decodeHeight(r,n),i=o.decodeHeight(r,s),a=o.decodeHeight(r,l);return e.x*t+e.y*i+e.z*a}}}}function hwe(e,t,i){let n=e._uValues,r=e._vValues,o=e._heightValues,a=e._indices;for(let s=0,l=a.length;s<l;s+=3){let l=a[s],u=a[s+1],c=a[s+2],h=n[l],d=n[u],p=n[c],f=r[l],m=r[u],_=r[c];if(l$(t,i,h,f,d,m,p,_)){let n=__.computeBarycentricCoordinates(t,i,h,f,d,m,p,_,c$);if(n.x>=-1e-15&&n.y>=-1e-15&&n.z>=-1e-15){let t=n.x*o[l]+n.y*o[u]+n.z*o[c];return P.lerp(e._minimumHeight,e._maximumHeight,t/h5)}}}}g_.prototype.isChildAvailable=function(e,t,i,n){let r=2;return i!==2*e&&++r,n!==2*t&&(r-=2),0!=(this._childTileMask&1<<r)},g_.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var jb=g_;function mwe(e){this.resource=e.resource,this.version=e.version,this.isHeightmap=e.isHeightmap,this.tileUrlTemplates=e.tileUrlTemplates,this.availability=e.availability,this.hasVertexNormals=e.hasVertexNormals,this.hasWaterMask=e.hasWaterMask,this.hasMetadata=e.hasMetadata,this.availabilityLevels=e.availabilityLevels,this.availabilityTilesLoaded=e.availabilityTilesLoaded,this.littleEndianExtensionSize=e.littleEndianExtensionSize,this.availabilityPromiseCache={}}function f$(e){this.requestVertexNormals=y(e.requestVertexNormals,!1),this.requestWaterMask=y(e.requestWaterMask,!1),this.requestMetadata=y(e.requestMetadata,!0),this.ellipsoid=e.ellipsoid,this.heightmapWidth=65,this.heightmapStructure=void 0,this.hasWaterMask=!1,this.hasMetadata=!1,this.hasVertexNormals=!1,this.scheme=void 0,this.lastResource=void 0,this.layerJsonResource=void 0,this.previousError=void 0,this.availability=void 0,this.tilingScheme=void 0,this.levelZeroMaximumGeometricError=void 0,this.heightmapStructure=void 0,this.layers=[],this.attribution="",this.overallAvailability=[],this.overallMaxZoom=0,this.tileCredits=[]}async function d$(e,t,i){if(!t.format){let t="The tile format is not specified in the layer.json file.";throw e.previousError=bo.reportError(e.previousError,i,u(i)?i._errorEvent:void 0,t),new ue(t)}if(!t.tiles||0===t.tiles.length){let t="The layer.json file does not specify any tile URL templates.";throw e.previousError=bo.reportError(e.previousError,i,u(i)?i._errorEvent:void 0,t),new ue(t)}let n=!1,r=!1,o=!1,a=!0,s=!1;if("heightmap-1.0"===t.format)s=!0,u(e.heightmapStructure)||(e.heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535}),r=!0,e.requestWaterMask=!0;else if(0!==t.format.indexOf("quantized-mesh-1.")){let n=`The tile format "${t.format}" is invalid or not supported.`;throw e.previousError=bo.reportError(e.previousError,i,u(i)?i._errorEvent:void 0,n),new ue(n)}let l,c=t.tiles,h=t.maxzoom;if(e.overallMaxZoom=Math.max(e.overallMaxZoom,h),t.projection&&"EPSG:4326"!==t.projection){if("EPSG:3857"!==t.projection){let n=`The projection "${t.projection}" is invalid or not supported.`;throw e.previousError=bo.reportError(e.previousError,i,u(i)?i._errorEvent:void 0,n),new ue(n)}e.tilingScheme=new zr({numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid})}else e.tilingScheme=new Ui({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});if(e.levelZeroMaximumGeometricError=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.tilingScheme.ellipsoid,e.heightmapWidth,e.tilingScheme.getNumberOfXTilesAtLevel(0)),t.scheme&&"tms"!==t.scheme&&"slippyMap"!==t.scheme){let n=`The scheme "${t.scheme}" is invalid or not supported.`;throw e.previousError=bo.reportError(e.previousError,i,u(i)?i._errorEvent:void 0,n),new ue(n)}e.scheme=t.scheme,u(t.extensions)&&-1!==t.extensions.indexOf("octvertexnormals")?n=!0:u(t.extensions)&&-1!==t.extensions.indexOf("vertexnormals")&&(n=!0,a=!1),u(t.extensions)&&-1!==t.extensions.indexOf("watermask")&&(r=!0),u(t.extensions)&&-1!==t.extensions.indexOf("metadata")&&(o=!0);let d,p=t.metadataAvailability,f=t.available;if(u(f)&&!u(p)){d=new ah(e.tilingScheme,f.length);for(let t=0;t<f.length;++t){let i=f[t],n=e.tilingScheme.getNumberOfYTilesAtLevel(t);u(e.overallAvailability[t])||(e.overallAvailability[t]=[]);for(let r=0;r<i.length;++r){let o=i[r],a=n-o.endY-1,s=n-o.startY-1;e.overallAvailability[t].push([o.startX,a,o.endX,s]),d.addAvailableTileRange(t,o.startX,a,o.endX,s)}}}else u(p)&&(l=new ah(e.tilingScheme,h),d=new ah(e.tilingScheme,h),e.overallAvailability[0]=[[0,0,1,0]],d.addAvailableTileRange(0,0,0,1,0));e.hasWaterMask=e.hasWaterMask||r,e.hasVertexNormals=e.hasVertexNormals||n,e.hasMetadata=e.hasMetadata||o,u(t.attribution)&&(e.attribution.length>0&&(e.attribution+=" "),e.attribution+=t.attribution),e.layers.push(new mwe({resource:e.lastResource,version:t.version,isHeightmap:s,tileUrlTemplates:c,availability:d,hasVertexNormals:n,hasWaterMask:r,hasMetadata:o,availabilityLevels:p,availabilityTilesLoaded:l,littleEndianExtensionSize:a}));let m=t.parentUrl;return!u(m)||(u(d)?(e.lastResource=e.lastResource.getDerivedResource({url:m}),e.lastResource.appendForwardSlash(),e.layerJsonResource=e.lastResource.getDerivedResource({url:"layer.json"}),await _5(e),!0):(console.log("A layer.json can't have a parentUrl if it does't have an available array."),!0))}function pwe(e,t,i){let n=`An error occurred while accessing ${e.layerJsonResource.url}.`;if(u(t)&&(n+=`\n${t.message}`),e.previousError=bo.reportError(e.previousError,i,u(i)?i._errorEvent:void 0,n),e.previousError.retry)return _5(e,i);throw new ue(n)}async function _we(e,t,i){await d$(e,t,i);let n=e.overallAvailability.length;if(n>0){let t=e.availability=new ah(e.tilingScheme,e.overallMaxZoom);for(let i=0;i<n;++i){let n=e.overallAvailability[i];for(let e=0;e<n.length;++e){let r=n[e];t.addAvailableTileRange(i,r[0],r[1],r[2],r[3])}}}if(e.attribution.length>0){let t=new xt(e.attribution);e.tileCredits.push(t)}return!0}async function _5(e,t){try{let i=await e.layerJsonResource.fetchJson();return _we(e,i,t)}catch(i){return u(i)&&404===i.statusCode?(await d$(e,{tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]},t),!0):pwe(e,i,t)}}function kf(e){e=y(e,y.EMPTY_OBJECT),this._heightmapWidth=void 0,this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._hasMetadata=!1,this._scheme=void 0,this._ellipsoid=e.ellipsoid,this._requestVertexNormals=y(e.requestVertexNormals,!1),this._requestWaterMask=y(e.requestWaterMask,!1),this._requestMetadata=y(e.requestMetadata,!0),this._errorEvent=new pe;let t=e.credit;"string"==typeof t&&(t=new xt(t)),this._credit=t,this._availability=void 0,this._tilingScheme=void 0,this._levelZeroMaximumGeometricError=void 0,this._layers=void 0,this._tileCredits=void 0}f$.prototype.build=function(e){e._heightmapWidth=this.heightmapWidth,e._scheme=this.scheme;let t=u(this.lastResource.credits)?this.lastResource.credits:[];e._tileCredits=t.concat(this.tileCredits),e._availability=this.availability,e._tilingScheme=this.tilingScheme,e._requestWaterMask=this.requestWaterMask,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._heightmapStructure=this.heightmapStructure,e._layers=this.layers,e._hasWaterMask=this.hasWaterMask,e._hasVertexNormals=this.hasVertexNormals,e._hasMetadata=this.hasMetadata};var m5={OCT_VERTEX_NORMALS:1,WATER_MASK:2,METADATA:4};function u$(e){return u(e)&&0!==e.length?{Accept:`application/vnd.quantized-mesh;extensions=${e.join("-")},application/octet-stream;q=0.9,*/*;q=0.01`}:{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}}function gwe(e,t,i,n,r){let o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new va({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure,credits:e._tileCredits})}function ywe(e,t,i,n,r,o){let a=o.littleEndianExtensionSize,s=0,l=3*Float64Array.BYTES_PER_ELEMENT,c=4*Float64Array.BYTES_PER_ELEMENT,d=3*Uint16Array.BYTES_PER_ELEMENT,p=Uint16Array.BYTES_PER_ELEMENT,f=3*p,m=new DataView(t),_=new h(m.getFloat64(s,!0),m.getFloat64(s+8,!0),m.getFloat64(s+16,!0));s+=l;let g=m.getFloat32(s,!0);s+=Float32Array.BYTES_PER_ELEMENT;let y=m.getFloat32(s,!0);s+=Float32Array.BYTES_PER_ELEMENT;let v=new se(new h(m.getFloat64(s,!0),m.getFloat64(s+8,!0),m.getFloat64(s+16,!0)),m.getFloat64(s+l,!0));s+=c;let b=new h(m.getFloat64(s,!0),m.getFloat64(s+8,!0),m.getFloat64(s+16,!0));s+=l;let A=m.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;let T=new Uint16Array(t,s,3*A);s+=A*d,A>65536&&(p=Uint32Array.BYTES_PER_ELEMENT,f=3*p);let E=T.subarray(0,A),C=T.subarray(A,2*A),x=T.subarray(2*A,3*A);Gn.zigZagDeltaDecode(E,C,x),s%p!=0&&(s+=p-s%p);let S=m.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;let w=ke.createTypedArrayFromArrayBuffer(A,t,s,3*S);s+=S*f;let I=0,P=w.length;for(let e=0;e<P;++e){let t=w[e];w[e]=I-t,0===t&&++I}let D=m.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;let O=ke.createTypedArrayFromArrayBuffer(A,t,s,D);s+=D*p;let L=m.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;let R=ke.createTypedArrayFromArrayBuffer(A,t,s,L);s+=L*p;let N=m.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;let M=ke.createTypedArrayFromArrayBuffer(A,t,s,N);s+=N*p;let F=m.getUint32(s,!0);s+=Uint32Array.BYTES_PER_ELEMENT;let B,z,U=ke.createTypedArrayFromArrayBuffer(A,t,s,F);for(s+=F*p;s<m.byteLength;){let l=m.getUint8(s,!0);s+=Uint8Array.BYTES_PER_ELEMENT;let c=m.getUint32(s,a);if(s+=Uint32Array.BYTES_PER_ELEMENT,l===m5.OCT_VERTEX_NORMALS&&e._requestVertexNormals)B=new Uint8Array(t,s,2*A);else if(l===m5.WATER_MASK&&e._requestWaterMask)z=new Uint8Array(t,s,c);else if(l===m5.METADATA&&e._requestMetadata){let a=m.getUint32(s,!0);if(a>0){let n=So(new Uint8Array(t),s+Uint32Array.BYTES_PER_ELEMENT,a).available;if(u(n))for(let t=0;t<n.length;++t){let r=i+t+1,a=n[t],s=e._tilingScheme.getNumberOfYTilesAtLevel(r);for(let t=0;t<a.length;++t){let i=a[t],n=s-i.endY-1,l=s-i.startY-1;e.availability.addAvailableTileRange(r,i.startX,n,i.endX,l),o.availability.addAvailableTileRange(r,i.startX,n,i.endX,l)}}}o.availabilityTilesLoaded.addAvailableTileRange(i,n,r,n,r)}s+=c}let k=5*e.getLevelMaximumGeometricError(i),V=e._tilingScheme.tileXYToRectangle(n,r,i),H=Pn.fromRectangle(V,g,y,e._tilingScheme.ellipsoid);return new jb({center:_,minimumHeight:g,maximumHeight:y,boundingSphere:v,orientedBoundingBox:H,horizonOcclusionPoint:b,quantizedVertices:T,encodedNormals:B,indices:w,westIndices:O,southIndices:R,eastIndices:M,northIndices:U,westSkirtHeight:k,southSkirtHeight:k,eastSkirtHeight:k,northSkirtHeight:k,childTileMask:e.availability.computeChildMaskForTile(i,n,r),waterMask:z,credits:e._tileCredits})}function h$(e,t,i,n,r,o){if(!u(r))return Promise.reject(new ue("Terrain tile doesn't exist"));let a,s=r.tileUrlTemplates;if(0===s.length)return;a=e._scheme&&"tms"!==e._scheme?i:e._tilingScheme.getNumberOfYTilesAtLevel(n)-i-1;let l=[];e._requestVertexNormals&&r.hasVertexNormals&&l.push(r.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),e._requestWaterMask&&r.hasWaterMask&&l.push("watermask"),e._requestMetadata&&r.hasMetadata&&l.push("metadata");let c,h,d=s[(t+a+n)%s.length],p=r.resource;u(p._ionEndpoint)&&!u(p._ionEndpoint.externalType)?(0!==l.length&&(h={extensions:l.join("-")}),c=u$(void 0)):c=u$(l);let f=p.getDerivedResource({url:d,templateValues:{version:r.version,z:n,x:t,y:a},queryParameters:h,headers:c,request:o}).fetchArrayBuffer();return u(f)?f.then((function(o){return u(o)?u(e._heightmapStructure)?gwe(e,o,n,t,i):ywe(e,o,n,t,i,r):Promise.reject(new ue("Mesh buffer doesn't exist."))})):void 0}function p5(e,t,i,n){if(0===n)return;let r=e.availabilityLevels,o=n%r==0?n-r:(n/r|0)*r,a=1<<n-o;return{level:o,x:t/a|0,y:i/a|0}}function g5(e,t,i,n,r,o){if(!u(r.availabilityLevels))return{result:!1};let a,s=function(){delete r.availabilityPromiseCache[a]},l=r.availabilityTilesLoaded,c=r.availability,h=p5(r,t,i,n);for(;u(h);){if(c.isTileAvailable(h.level,h.x,h.y)&&!l.isTileAvailable(h.level,h.x,h.y)){let t;if(!o&&(a=`${h.level}-${h.x}-${h.y}`,t=r.availabilityPromiseCache[a],!u(t))){let i=new Ko({throttle:!1,throttleByServer:!0,type:Jr.TERRAIN});t=h$(e,h.x,h.y,h.level,r,i),u(t)&&(r.availabilityPromiseCache[a]=t,t.then(s))}return{result:!0,promise:t}}h=p5(r,h.x,h.y,h.level)}return{result:!1}}kf.prototype.requestTileGeometry=function(e,t,i,n){let r,o=this._layers,a=o.length,s=!1,l=Promise.resolve();if(1===a)r=o[0];else for(let n=0;n<a;++n){let a=o[n];if(!u(a.availability)||a.availability.isTileAvailable(i,e,t)){r=a;break}let c=g5(this,e,t,i,a,0===n);c.result&&(s=!0,l=l.then((()=>c.promise)))}return!u(r)&&s?l.then((()=>this.requestTileGeometry(e,t,i,n))):h$(this,e,t,i,r,n)},Object.defineProperties(kf.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){return this._availability}}}),kf.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},kf.fromIonAssetId=async function(e,t){let i=await Iu.fromAssetId(e);return kf.fromUrl(i,t)},kf.fromUrl=async function(e,t){t=y(t,y.EMPTY_OBJECT),e=await Promise.resolve(e);let i=ve.createIfNeeded(e);i.appendForwardSlash();let n=new f$(t);n.lastResource=i,n.layerJsonResource=n.lastResource.getDerivedResource({url:"layer.json"}),await _5(n);let r=new kf(t);return n.build(r),r},kf.prototype.getTileDataAvailable=function(e,t,i){if(!u(this._availability))return;if(i>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(i,e,t))return!0;if(!this._hasMetadata)return!1;let n=this._layers,r=n.length;for(let o=0;o<r;++o)if(g5(this,e,t,i,n[o],0===o).result)return;return!1},kf.prototype.loadTileDataAvailability=function(e,t,i){if(!u(this._availability)||i>this._availability._maximumLevel||this._availability.isTileAvailable(i,e,t)||!this._hasMetadata)return;let n=this._layers,r=n.length;for(let o=0;o<r;++o){let r=g5(this,e,t,i,n[o],0===o);if(u(r.promise))return r.promise}},kf._getAvailabilityTile=p5;var KP=kf,x5={},ZP=new h,m$=new h,p$=new Le,_$=new $;function qb(e,t,i,n,r,o,a,s,l,u){let c=e+t;h.multiplyByScalar(n,Math.cos(c),ZP),h.multiplyByScalar(i,Math.sin(c),m$),h.add(ZP,m$,ZP);let d=Math.cos(e);d*=d;let p=Math.sin(e);p*=p;let f=o/Math.sqrt(a*d+r*p)/s;return Le.fromAxisAngle(ZP,f,p$),$.fromQuaternion(p$,_$),$.multiplyByVector(_$,l,u),h.normalize(u,u),h.multiplyByScalar(u,s,u),u}var g$=new h,y$=new h,y5=new h,xwe=new h;x5.raisePositionsToHeight=function(e,t,i){let n=t.ellipsoid,r=t.height,o=t.extrudedHeight,a=i?e.length/3*2:e.length/3,s=new Float64Array(3*a),l=e.length,u=i?l:0;for(let t=0;t<l;t+=3){let a=t+1,l=t+2,c=h.fromArray(e,t,g$);n.scaleToGeodeticSurface(c,c);let d=h.clone(c,y$),p=n.geodeticSurfaceNormal(c,xwe),f=h.multiplyByScalar(p,r,y5);h.add(c,f,c),i&&(h.multiplyByScalar(p,o,f),h.add(d,f,d),s[t+u]=d.x,s[a+u]=d.y,s[l+u]=d.z),s[t]=c.x,s[a]=c.y,s[l]=c.z}return s};var bwe=new h,Twe=new h,Awe=new h;x5.computeEllipsePositions=function(e,t,i){let n=e.semiMinorAxis,r=e.semiMajorAxis,o=e.rotation,a=e.center,s=8*e.granularity,l=n*n,u=r*r,c=r*n,d=h.magnitude(a),p=h.normalize(a,bwe),f=h.cross(h.UNIT_Z,a,Twe);f=h.normalize(f,f);let m=h.cross(p,f,Awe),_=1+Math.ceil(P.PI_OVER_TWO/s),g=P.PI_OVER_TWO/(_-1),y=P.PI_OVER_TWO-_*g;y<0&&(_-=Math.ceil(Math.abs(y)/g));let v,b,A,T,E,C=t?new Array(3*(_*(_+2)*2)):void 0,x=0,S=g$,w=y$,I=4*_*3,D=I-1,O=0,L=i?new Array(I):void 0;for(y=P.PI_OVER_TWO,S=qb(y,o,m,f,l,c,u,d,p,S),t&&(C[x++]=S.x,C[x++]=S.y,C[x++]=S.z),i&&(L[D--]=S.z,L[D--]=S.y,L[D--]=S.x),y=P.PI_OVER_TWO-g,v=1;v<_+1;++v){if(S=qb(y,o,m,f,l,c,u,d,p,S),w=qb(Math.PI-y,o,m,f,l,c,u,d,p,w),t){for(C[x++]=S.x,C[x++]=S.y,C[x++]=S.z,A=2*v+2,b=1;b<A-1;++b)T=b/(A-1),E=h.lerp(S,w,T,y5),C[x++]=E.x,C[x++]=E.y,C[x++]=E.z;C[x++]=w.x,C[x++]=w.y,C[x++]=w.z}i&&(L[D--]=S.z,L[D--]=S.y,L[D--]=S.x,L[O++]=w.x,L[O++]=w.y,L[O++]=w.z),y=P.PI_OVER_TWO-(v+1)*g}for(v=_;v>1;--v){if(y=P.PI_OVER_TWO-(v-1)*g,S=qb(-y,o,m,f,l,c,u,d,p,S),w=qb(y+Math.PI,o,m,f,l,c,u,d,p,w),t){for(C[x++]=S.x,C[x++]=S.y,C[x++]=S.z,A=2*(v-1)+2,b=1;b<A-1;++b)T=b/(A-1),E=h.lerp(S,w,T,y5),C[x++]=E.x,C[x++]=E.y,C[x++]=E.z;C[x++]=w.x,C[x++]=w.y,C[x++]=w.z}i&&(L[D--]=S.z,L[D--]=S.y,L[D--]=S.x,L[O++]=w.x,L[O++]=w.y,L[O++]=w.z)}y=P.PI_OVER_TWO,S=qb(-y,o,m,f,l,c,u,d,p,S);let R={};return t&&(C[x++]=S.x,C[x++]=S.y,C[x++]=S.z,R.positions=C,R.numPts=_),i&&(L[D--]=S.z,L[D--]=S.y,L[D--]=S.x,R.outerPositions=L),R};var Pl=x5;function Cwe(e){e=y(e,y.EMPTY_OBJECT),this.geometry=e.geometry,this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=y(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}var yt=Cwe;function fh(){this.high=h.clone(h.ZERO),this.low=h.clone(h.ZERO)}fh.encode=function(e,t){let i;return u(t)||(t={high:0,low:0}),e>=0?(i=65536*Math.floor(e/65536),t.high=i,t.low=e-i):(i=65536*Math.floor(-e/65536),t.high=-i,t.low=e+i),t};var Rm={high:0,low:0};fh.fromCartesian=function(e,t){u(t)||(t=new fh);let i=t.high,n=t.low;return fh.encode(e.x,Rm),i.x=Rm.high,n.x=Rm.low,fh.encode(e.y,Rm),i.y=Rm.high,n.y=Rm.low,fh.encode(e.z,Rm),i.z=Rm.high,n.z=Rm.low,t};var b5=new fh;fh.writeElements=function(e,t,i){fh.fromCartesian(e,b5);let n=b5.high,r=b5.low;t[i]=n.x,t[i+1]=n.y,t[i+2]=n.z,t[i+3]=r.x,t[i+4]=r.y,t[i+5]=r.z};var Wn=fh,T5={calculateACMR:function(e){let t=(e=y(e,y.EMPTY_OBJECT)).indices,i=e.maximumIndex,n=y(e.cacheSize,24),r=t.length;if(!u(i)){i=0;let e=0,n=t[e];for(;e<r;)n>i&&(i=n),++e,n=t[e]}let o=[];for(let e=0;e<i+1;e++)o[e]=0;let a=n+1;for(let e=0;e<r;++e)a-o[t[e]]>n&&(o[t[e]]=a,++a);return(a-n+1)/(r/3)}};T5.tipsify=function(e){let t,i=(e=y(e,y.EMPTY_OBJECT)).indices,n=e.maximumIndex,r=y(e.cacheSize,24);function o(e,i,n,r,o,a,s){let l,u=-1,c=-1,h=0;for(;h<n.length;){let e=n[h];r[e].numLiveTriangles&&(l=0,o-r[e].timeStamp+2*r[e].numLiveTriangles<=i&&(l=o-r[e].timeStamp),(l>c||-1===c)&&(c=l,u=e)),++h}return-1===u?function(e,i,n,r){for(;i.length>=1;){let t=i[i.length-1];if(i.splice(i.length-1,1),e[t].numLiveTriangles>0)return t}for(;t<r;){if(e[t].numLiveTriangles>0)return++t,t-1;++t}return-1}(r,a,0,s):u}let a=i.length,s=0,l=0,c=i[l],h=a;if(u(n))s=n+1;else{for(;l<h;)c>s&&(s=c),++l,c=i[l];if(-1===s)return 0;++s}let d,p=[];for(d=0;d<s;d++)p[d]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};l=0;let f=0;for(;l<h;)p[i[l]].vertexTriangles.push(f),++p[i[l]].numLiveTriangles,p[i[l+1]].vertexTriangles.push(f),++p[i[l+1]].numLiveTriangles,p[i[l+2]].vertexTriangles.push(f),++p[i[l+2]].numLiveTriangles,++f,l+=3;let m=0,_=r+1;t=1;let g,v,b,A,T=[],E=[],C=0,x=[],S=a/3,w=[];for(d=0;d<S;d++)w[d]=!1;for(;-1!==m;){T=[],v=p[m],A=v.vertexTriangles.length;for(let e=0;e<A;++e)if(f=v.vertexTriangles[e],!w[f]){w[f]=!0,l=f+f+f;for(let e=0;e<3;++e)b=i[l],T.push(b),E.push(b),x[C]=b,++C,g=p[b],--g.numLiveTriangles,_-g.timeStamp>r&&(g.timeStamp=_,++_),++l}m=o(0,r,T,p,_,E,s)}return x};var $P=T5,uc={};function o1(e,t,i,n,r){e[t++]=i,e[t++]=n,e[t++]=n,e[t++]=r,e[t++]=r,e[t]=i}function Ewe(e){let t=e.length,i=t/3*6,n=ke.createTypedArray(t,i),r=0;for(let i=0;i<t;i+=3,r+=6)o1(n,r,e[i],e[i+1],e[i+2]);return n}function Swe(e){let t=e.length;if(t>=3){let i=6*(t-2),n=ke.createTypedArray(t,i);o1(n,0,e[0],e[1],e[2]);let r=6;for(let i=3;i<t;++i,r+=6)o1(n,r,e[i-1],e[i],e[i-2]);return n}return new Uint16Array}function wwe(e){if(e.length>0){let t=e.length-1,i=6*(t-1),n=ke.createTypedArray(t,i),r=e[0],o=0;for(let i=1;i<t;++i,o+=6)o1(n,o,r,e[i],e[i+1]);return n}return new Uint16Array}function x$(e){let t={};for(let i in e)if(e.hasOwnProperty(i)&&u(e[i])&&u(e[i].values)){let n=e[i];t[i]=new Se({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}return t}function vwe(e,t,i){for(let n in t)if(t.hasOwnProperty(n)&&u(t[n])&&u(t[n].values)){let r=t[n];for(let t=0;t<r.componentsPerAttribute;++t)e[n].values.push(r.values[i*r.componentsPerAttribute+t])}}uc.toWireframe=function(e){let t=e.indices;if(u(t)){switch(e.primitiveType){case Ne.TRIANGLES:e.indices=Ewe(t);break;case Ne.TRIANGLE_STRIP:e.indices=Swe(t);break;case Ne.TRIANGLE_FAN:e.indices=wwe(t)}e.primitiveType=Ne.LINES}return e},uc.createLineSegmentsForVectors=function(e,t,i){t=y(t,"normal"),i=y(i,1e4);let n=e.attributes.position.values,r=e.attributes[t].values,o=n.length,a=new Float64Array(2*o),s=0;for(let e=0;e<o;e+=3)a[s++]=n[e],a[s++]=n[e+1],a[s++]=n[e+2],a[s++]=n[e]+r[e]*i,a[s++]=n[e+1]+r[e+1]*i,a[s++]=n[e+2]+r[e+2]*i;let l,c=e.boundingSphere;return u(c)&&(l=new se(c.center,c.radius+i)),new ct({attributes:{position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:a})},primitiveType:Ne.LINES,boundingSphere:l})},uc.createAttributeLocations=function(e){let t,i=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,r={},o=0,a=i.length;for(t=0;t<a;++t){let e=i[t];u(n[e])&&(r[e]=o++)}for(let e in n)n.hasOwnProperty(e)&&!u(r[e])&&(r[e]=o++);return r},uc.reorderForPreVertexCache=function(e){let t=ct.computeNumberOfVertices(e),i=e.indices;if(u(i)){let n=new Int32Array(t);for(let e=0;e<t;e++)n[e]=-1;let r,o=i,a=o.length,s=ke.createTypedArray(t,a),l=0,c=0,h=0;for(;l<a;)r=n[o[l]],-1!==r?s[c]=r:(r=o[l],n[r]=h,s[c]=h,++h),++l,++c;e.indices=s;let d=e.attributes;for(let e in d)if(d.hasOwnProperty(e)&&u(d[e])&&u(d[e].values)){let i=d[e],r=i.values,o=0,a=i.componentsPerAttribute,s=X.createTypedArray(i.componentDatatype,h*a);for(;o<t;){let e=n[o];if(-1!==e)for(let t=0;t<a;t++)s[a*e+t]=r[a*o+t];++o}i.values=s}}return e},uc.reorderForPostVertexCache=function(e,t){let i=e.indices;if(e.primitiveType===Ne.TRIANGLES&&u(i)){let n=i.length,r=0;for(let e=0;e<n;e++)i[e]>r&&(r=i[e]);e.indices=$P.tipsify({indices:i,maximumIndex:r,cacheSize:t})}return e},uc.fitToUnsignedShortIndices=function(e){let t=[],i=ct.computeNumberOfVertices(e);if(u(e.indices)&&i>=P.SIXTY_FOUR_KILOBYTES){let i,n=[],r=[],o=0,a=x$(e.attributes),s=e.indices,l=s.length;e.primitiveType===Ne.TRIANGLES?i=3:e.primitiveType===Ne.LINES?i=2:e.primitiveType===Ne.POINTS&&(i=1);for(let c=0;c<l;c+=i){for(let t=0;t<i;++t){let i=s[c+t],l=n[i];u(l)||(l=o++,n[i]=l,vwe(a,e.attributes,i)),r.push(l)}o+i>=P.SIXTY_FOUR_KILOBYTES&&(t.push(new ct({attributes:a,indices:r,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),n=[],r=[],o=0,a=x$(e.attributes))}0!==r.length&&t.push(new ct({attributes:a,indices:r,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var b$=new h,Dwe=new fe;uc.projectTo2D=function(e,t,i,n,r){let o=e.attributes[t],a=(r=u(r)?r:new Ii).ellipsoid,s=o.values,l=new Float64Array(s.length),c=0;for(let e=0;e<s.length;e+=3){let t=h.fromArray(s,e,b$),i=a.cartesianToCartographic(t,Dwe),n=r.project(i,b$);l[c++]=n.x,l[c++]=n.y,l[c++]=n.z}return e.attributes[i]=o,e.attributes[n]=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:l}),delete e.attributes[t],e};var A5={high:0,low:0};uc.encodeAttribute=function(e,t,i,n){let r=e.attributes[t],o=r.values,a=o.length,s=new Float32Array(a),l=new Float32Array(a);for(let e=0;e<a;++e)Wn.encode(o[e],A5),s[e]=A5.high,l[e]=A5.low;let u=r.componentsPerAttribute;return e.attributes[i]=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:u,values:s}),e.attributes[n]=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:u,values:l}),delete e.attributes[t],e};var Uf=new h;function C5(e,t){if(u(t)){let i=t.values,n=i.length;for(let t=0;t<n;t+=3)h.unpack(i,t,Uf),L.multiplyByPoint(e,Uf,Uf),h.pack(Uf,i,t)}}function E5(e,t){if(u(t)){let i=t.values,n=i.length;for(let t=0;t<n;t+=3)h.unpack(i,t,Uf),$.multiplyByVector(e,Uf,Uf),Uf=h.normalize(Uf,Uf),h.pack(Uf,i,t)}}var QP=new L,JP=new $;function Iwe(e,t){let i,n=e.length,r={},o=e[0][t].attributes;for(i in o)if(o.hasOwnProperty(i)&&u(o[i])&&u(o[i].values)){let a=o[i],s=a.values.length,l=!0;for(let r=1;r<n;++r){let n=e[r][t].attributes[i];if(!u(n)||a.componentDatatype!==n.componentDatatype||a.componentsPerAttribute!==n.componentsPerAttribute||a.normalize!==n.normalize){l=!1;break}s+=n.values.length}l&&(r[i]=new Se({componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,values:X.createTypedArray(a.componentDatatype,s)}))}return r}uc.transformToWorldCoordinates=function(e){let t=e.modelMatrix;if(L.equals(t,L.IDENTITY))return e;let i=e.geometry.attributes;C5(t,i.position),C5(t,i.prevPosition),C5(t,i.nextPosition),(u(i.normal)||u(i.tangent)||u(i.bitangent))&&(L.inverse(t,QP),L.transpose(QP,QP),L.getMatrix3(QP,JP),E5(JP,i.normal),E5(JP,i.tangent),E5(JP,i.bitangent));let n=e.geometry.boundingSphere;return u(n)&&(e.geometry.boundingSphere=se.transform(n,t,n)),e.modelMatrix=L.clone(L.IDENTITY),e};var Pwe=new h;function S5(e,t){let i,n,r,o,a,s,l,c,d=e.length,p=(e[0].modelMatrix,u(e[0][t].indices)),f=e[0][t].primitiveType,m=Iwe(e,t);for(i in m)if(m.hasOwnProperty(i))for(a=m[i].values,o=0,n=0;n<d;++n)for(s=e[n][t].attributes[i].values,l=s.length,r=0;r<l;++r)a[o++]=s[r];if(p){let i=0;for(n=0;n<d;++n)i+=e[n][t].indices.length;let r=ct.computeNumberOfVertices(new ct({attributes:m,primitiveType:Ne.POINTS})),a=ke.createTypedArray(r,i),s=0,l=0;for(n=0;n<d;++n){let i=e[n][t].indices,r=i.length;for(o=0;o<r;++o)a[s++]=l+i[o];l+=ct.computeNumberOfVertices(e[n][t])}c=a}let _,g=new h,y=0;for(n=0;n<d;++n){if(_=e[n][t].boundingSphere,!u(_)){g=void 0;break}h.add(_.center,g,g)}if(u(g))for(h.divideByScalar(g,d,g),n=0;n<d;++n){_=e[n][t].boundingSphere;let i=h.magnitude(h.subtract(_.center,g,Pwe))+_.radius;i>y&&(y=i)}return new ct({attributes:m,indices:c,primitiveType:f,boundingSphere:u(g)?new se(g,y):void 0})}uc.combineInstances=function(e){let t=[],i=[],n=e.length;for(let r=0;r<n;++r){let n=e[r];u(n.geometry)?t.push(n):u(n.westHemisphereGeometry)&&u(n.eastHemisphereGeometry)&&i.push(n)}let r=[];return t.length>0&&r.push(S5(t,"geometry")),i.length>0&&(r.push(S5(i,"westHemisphereGeometry")),r.push(S5(i,"eastHemisphereGeometry"))),r};var Pu=new h,cS=new h,Yb=new h,Xb=new h;uc.computeNormal=function(e){let t,i=e.indices,n=e.attributes,r=n.position.values,o=n.position.values.length/3,a=i.length,s=new Array(o),l=new Array(a/3),u=new Array(a);for(t=0;t<o;t++)s[t]={indexOffset:0,count:0,currentCount:0};let c=0;for(t=0;t<a;t+=3){let e=i[t],n=i[t+1],o=i[t+2],a=3*e,u=3*n,d=3*o;cS.x=r[a],cS.y=r[a+1],cS.z=r[a+2],Yb.x=r[u],Yb.y=r[u+1],Yb.z=r[u+2],Xb.x=r[d],Xb.y=r[d+1],Xb.z=r[d+2],s[e].count++,s[n].count++,s[o].count++,h.subtract(Yb,cS,Yb),h.subtract(Xb,cS,Xb),l[c]=h.cross(Yb,Xb,new h),c++}let d,p=0;for(t=0;t<o;t++)s[t].indexOffset+=p,p+=s[t].count;for(c=0,t=0;t<a;t+=3){d=s[i[t]];let e=d.indexOffset+d.currentCount;u[e]=c,d.currentCount++,d=s[i[t+1]],e=d.indexOffset+d.currentCount,u[e]=c,d.currentCount++,d=s[i[t+2]],e=d.indexOffset+d.currentCount,u[e]=c,d.currentCount++,c++}let f=new Float32Array(3*o);for(t=0;t<o;t++){let e=3*t;if(d=s[t],h.clone(h.ZERO,Pu),d.count>0){for(c=0;c<d.count;c++)h.add(Pu,l[u[d.indexOffset+c]],Pu);h.equalsEpsilon(h.ZERO,Pu,P.EPSILON10)&&h.clone(l[u[d.indexOffset]],Pu)}h.equalsEpsilon(h.ZERO,Pu,P.EPSILON10)&&(Pu.z=1),h.normalize(Pu,Pu),f[e]=Pu.x,f[e+1]=Pu.y,f[e+2]=Pu.z}return e.attributes.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:f}),e};var Owe=new h,T$=new h,Rwe=new h;uc.computeTangentAndBitangent=function(e){e.attributes;let t,i,n,r,o=e.indices,a=e.attributes.position.values,s=e.attributes.normal.values,l=e.attributes.st.values,u=e.attributes.position.values.length/3,c=o.length,d=new Array(3*u);for(t=0;t<d.length;t++)d[t]=0;for(t=0;t<c;t+=3){let e=o[t],s=o[t+1],u=o[t+2];i=3*e,n=3*s,r=3*u;let c=2*e,h=2*s,p=2*u,f=a[i],m=a[i+1],_=a[i+2],g=l[c],y=l[c+1],v=l[h+1]-y,b=l[p+1]-y,A=1/((l[h]-g)*b-(l[p]-g)*v),T=(b*(a[n]-f)-v*(a[r]-f))*A,E=(b*(a[n+1]-m)-v*(a[r+1]-m))*A,C=(b*(a[n+2]-_)-v*(a[r+2]-_))*A;d[i]+=T,d[i+1]+=E,d[i+2]+=C,d[n]+=T,d[n+1]+=E,d[n+2]+=C,d[r]+=T,d[r+1]+=E,d[r+2]+=C}let p=new Float32Array(3*u),f=new Float32Array(3*u);for(t=0;t<u;t++){i=3*t,n=i+1,r=i+2;let e=h.fromArray(s,i,Owe),o=h.fromArray(d,i,Rwe),a=h.dot(e,o);h.multiplyByScalar(e,a,T$),h.normalize(h.subtract(o,T$,o),o),p[i]=o.x,p[n]=o.y,p[r]=o.z,h.normalize(h.cross(e,o,o),o),f[i]=o.x,f[n]=o.y,f[r]=o.z}return e.attributes.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:p}),e.attributes.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:f}),e};var lS=new U,Vf=new h,A$=new h,C$=new h,e1=new U;function Mwe(e){if(u(e.indices))return e;let t=ct.computeNumberOfVertices(e),i=ke.createTypedArray(t,t);for(let e=0;e<t;++e)i[e]=e;return e.indices=i,e}function Lwe(e){let t=ct.computeNumberOfVertices(e),i=ke.createTypedArray(t,3*(t-2));i[0]=1,i[1]=0,i[2]=2;let n=3;for(let e=3;e<t;++e)i[n++]=e-1,i[n++]=0,i[n++]=e;return e.indices=i,e.primitiveType=Ne.TRIANGLES,e}function Nwe(e){let t=ct.computeNumberOfVertices(e),i=ke.createTypedArray(t,3*(t-2));i[0]=0,i[1]=1,i[2]=2,t>3&&(i[3]=0,i[4]=2,i[5]=3);let n=6;for(let e=3;e<t-1;e+=2)i[n++]=e,i[n++]=e-1,i[n++]=e+1,e+2<t&&(i[n++]=e,i[n++]=e+1,i[n++]=e+2);return e.indices=i,e.primitiveType=Ne.TRIANGLES,e}function Fwe(e){if(u(e.indices))return e;let t=ct.computeNumberOfVertices(e),i=ke.createTypedArray(t,t);for(let e=0;e<t;++e)i[e]=e;return e.indices=i,e}function Bwe(e){let t=ct.computeNumberOfVertices(e),i=ke.createTypedArray(t,2*(t-1));i[0]=0,i[1]=1;let n=2;for(let e=2;e<t;++e)i[n++]=e-1,i[n++]=e;return e.indices=i,e.primitiveType=Ne.LINES,e}function kwe(e){let t=ct.computeNumberOfVertices(e),i=ke.createTypedArray(t,2*t);i[0]=0,i[1]=1;let n=2;for(let e=2;e<t;++e)i[n++]=e-1,i[n++]=e;return i[n++]=t-1,i[n]=0,e.indices=i,e.primitiveType=Ne.LINES,e}function Vwe(e){switch(e.primitiveType){case Ne.TRIANGLE_FAN:return Lwe(e);case Ne.TRIANGLE_STRIP:return Nwe(e);case Ne.TRIANGLES:return Mwe(e);case Ne.LINE_STRIP:return Bwe(e);case Ne.LINE_LOOP:return kwe(e);case Ne.LINES:return Fwe(e)}return e}function y_(e,t){Math.abs(e.y)<P.EPSILON6&&(e.y=t?-P.EPSILON6:P.EPSILON6)}function Uwe(e,t,i){if(0!==e.y&&0!==t.y&&0!==i.y)return y_(e,e.y<0),y_(t,t.y<0),void y_(i,i.y<0);let n,r=Math.abs(e.y),o=Math.abs(t.y),a=Math.abs(i.y);n=r>o?r>a?P.sign(e.y):P.sign(i.y):o>a?P.sign(t.y):P.sign(i.y);let s=n<0;y_(e,s),y_(t,s),y_(i,s)}uc.compressVertices=function(e){let t,i,n=e.attributes.extrudeDirection;if(u(n)){let r=n.values;i=r.length/3;let o=new Float32Array(2*i),a=0;for(t=0;t<i;++t)h.fromArray(r,3*t,Vf),h.equals(Vf,h.ZERO)?a+=2:(e1=Gn.octEncodeInRange(Vf,65535,e1),o[a++]=e1.x,o[a++]=e1.y);return e.attributes.compressedAttributes=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:o}),delete e.attributes.extrudeDirection,e}let r=e.attributes.normal,o=e.attributes.st,a=u(r),s=u(o);if(!a&&!s)return e;let l,c,d,p,f=e.attributes.tangent,m=e.attributes.bitangent,_=u(f),g=u(m);a&&(l=r.values),s&&(c=o.values),_&&(d=f.values),g&&(p=m.values),i=(a?l.length:c.length)/(a?3:2);let y=i,v=s&&a?2:1;v+=_||g?1:0,y*=v;let b=new Float32Array(y),A=0;for(t=0;t<i;++t){s&&(U.fromArray(c,2*t,lS),b[A++]=Gn.compressTextureCoordinates(lS));let e=3*t;a&&u(d)&&u(p)?(h.fromArray(l,e,Vf),h.fromArray(d,e,A$),h.fromArray(p,e,C$),Gn.octPack(Vf,A$,C$,lS),b[A++]=lS.x,b[A++]=lS.y):(a&&(h.fromArray(l,e,Vf),b[A++]=Gn.octEncodeFloat(Vf)),_&&(h.fromArray(d,e,Vf),b[A++]=Gn.octEncodeFloat(Vf)),g&&(h.fromArray(p,e,Vf),b[A++]=Gn.octEncodeFloat(Vf)))}return e.attributes.compressedAttributes=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:v,values:b}),a&&delete e.attributes.normal,s&&delete e.attributes.st,g&&delete e.attributes.bitangent,_&&delete e.attributes.tangent,e};var E$=new h;function Ou(e,t,i,n){h.add(e,h.multiplyByScalar(h.subtract(t,e,E$),e.y/(e.y-t.y),E$),i),h.clone(i,n),y_(i,!0),y_(n,!1)}var o0=new h,r0=new h,s0=new h,a0=new h,w5={positions:new Array(7),indices:new Array(9)};function zwe(e,t,i){if(e.x>=0||t.x>=0||i.x>=0)return;Uwe(e,t,i);let n=e.y<0,r=t.y<0,o=i.y<0,a=0;a+=n?1:0,a+=r?1:0,a+=o?1:0;let s=w5.indices;1===a?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,n?(Ou(e,t,o0,s0),Ou(e,i,r0,a0),s[0]=0,s[3]=1,s[4]=2,s[6]=1):r?(Ou(t,i,o0,s0),Ou(t,e,r0,a0),s[0]=1,s[3]=2,s[4]=0,s[6]=2):o&&(Ou(i,e,o0,s0),Ou(i,t,r0,a0),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===a&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,n?r?o||(Ou(i,e,o0,s0),Ou(i,t,r0,a0),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(Ou(t,i,o0,s0),Ou(t,e,r0,a0),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(Ou(e,t,o0,s0),Ou(e,i,r0,a0),s[0]=1,s[1]=2,s[3]=1,s[6]=0));let l=w5.positions;return l[0]=e,l[1]=t,l[2]=i,l.length=3,(1===a||2===a)&&(l[3]=o0,l[4]=r0,l[5]=s0,l[6]=a0,l.length=7),w5}function S$(e,t){let i=e.attributes;if(0===i.position.values.length)return;for(let e in i)if(i.hasOwnProperty(e)&&u(i[e])&&u(i[e].values)){let t=i[e];t.values=X.createTypedArray(t.componentDatatype,t.values)}let n=ct.computeNumberOfVertices(e);return e.indices=ke.createTypedArray(n,e.indices),t&&(e.boundingSphere=se.fromVertices(i.position.values)),e}function Zb(e){let t=e.attributes,i={};for(let e in t)if(t.hasOwnProperty(e)&&u(t[e])&&u(t[e].values)){let n=t[e];i[e]=new Se({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}return new ct({attributes:i,indices:[],primitiveType:e.primitiveType})}function P5(e,t,i){let n=u(e.geometry.boundingSphere);t=S$(t,n),i=S$(i,n),u(i)&&!u(t)?e.geometry=i:!u(i)&&u(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=i,e.geometry=void 0)}function O5(e,t){let i=new e,n=new e,r=new e;return function(o,a,s,l,u,c,h,d){let p=e.fromArray(u,o*t,i),f=e.fromArray(u,a*t,n),m=e.fromArray(u,s*t,r);e.multiplyByScalar(p,l.x,p),e.multiplyByScalar(f,l.y,f),e.multiplyByScalar(m,l.z,m);let _=e.add(p,f,p);e.add(_,m,_),d&&e.normalize(_,_),e.pack(_,c,h*t)}}var Hwe=O5(oe,4),i1=O5(h,3),O$=O5(U,2),Gwe=function(e,t,i,n,r,o,a){let s=r[e]*n.x,l=r[t]*n.y,u=r[i]*n.z;o[a]=s+l+u>P.EPSILON6?1:0},uS=new h,v5=new h,D5=new h,Wwe=new h;function t1(e,t,i,n,r,o,a,s,l,c,d,p,f,m,_,g){if(!(u(o)||u(a)||u(s)||u(l)||u(c)||0!==m))return;let y=h.fromArray(r,3*e,uS),v=h.fromArray(r,3*t,v5),b=h.fromArray(r,3*i,D5),A=Ub(n,y,v,b,Wwe);if(u(A)){if(u(o)&&i1(e,t,i,A,o,p.normal.values,g,!0),u(c)){let n,r=h.fromArray(c,3*e,uS),o=h.fromArray(c,3*t,v5),a=h.fromArray(c,3*i,D5);h.multiplyByScalar(r,A.x,r),h.multiplyByScalar(o,A.y,o),h.multiplyByScalar(a,A.z,a),h.equals(r,h.ZERO)&&h.equals(o,h.ZERO)&&h.equals(a,h.ZERO)?(n=uS,n.x=0,n.y=0,n.z=0):(n=h.add(r,o,r),h.add(n,a,n),h.normalize(n,n)),h.pack(n,p.extrudeDirection.values,3*g)}if(u(d)&&Gwe(e,t,i,A,d,p.applyOffset.values,g),u(a)&&i1(e,t,i,A,a,p.tangent.values,g,!0),u(s)&&i1(e,t,i,A,s,p.bitangent.values,g,!0),u(l)&&O$(e,t,i,A,l,p.st.values,g),m>0)for(let n=0;n<m;n++){let r=f[n];jwe(e,t,i,A,g,_[r],p[r])}}}function jwe(e,t,i,n,r,o,a){let s=o.componentsPerAttribute,l=o.values,u=a.values;switch(s){case 4:Hwe(e,t,i,n,l,u,r,!1);break;case 3:i1(e,t,i,n,l,u,r,!1);break;case 2:O$(e,t,i,n,l,u,r,!1);break;default:u[r]=l[e]*n.x+l[t]*n.y+l[i]*n.z}}function dh(e,t,i,n,r,o){let a=e.position.values.length/3;if(-1!==r){let s=n[r],l=i[s];return-1===l?(i[s]=a,e.position.values.push(o.x,o.y,o.z),t.push(a),a):(t.push(l),l)}return e.position.values.push(o.x,o.y,o.z),t.push(a),a}var qwe={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function w$(e){let t=e.geometry,i=t.attributes,n=i.position.values,r=u(i.normal)?i.normal.values:void 0,o=u(i.bitangent)?i.bitangent.values:void 0,a=u(i.tangent)?i.tangent.values:void 0,s=u(i.st)?i.st.values:void 0,l=u(i.extrudeDirection)?i.extrudeDirection.values:void 0,c=u(i.applyOffset)?i.applyOffset.values:void 0,d=t.indices,p=[];for(let e in i)i.hasOwnProperty(e)&&!qwe[e]&&u(i[e])&&p.push(e);let f,m,_,g,y,v=p.length,b=Zb(t),A=Zb(t),T=[];T.length=n.length/3;let E=[];for(E.length=n.length/3,y=0;y<T.length;++y)T[y]=-1,E[y]=-1;let C=d.length;for(y=0;y<C;y+=3){let e=d[y],t=d[y+1],C=d[y+2],x=h.fromArray(n,3*e),S=h.fromArray(n,3*t),w=h.fromArray(n,3*C),I=zwe(x,S,w);if(u(I)&&I.positions.length>3){let u=I.positions,h=I.indices,x=h.length;for(let S=0;S<x;++S){let x=h[S],w=u[x];w.y<0?(f=A.attributes,m=A.indices,_=T):(f=b.attributes,m=b.indices,_=E),g=dh(f,m,_,d,x<3?y+x:-1,w),t1(e,t,C,w,n,r,a,o,s,l,c,f,p,v,i,g)}}else u(I)&&(x=I.positions[0],S=I.positions[1],w=I.positions[2]),x.y<0?(f=A.attributes,m=A.indices,_=T):(f=b.attributes,m=b.indices,_=E),g=dh(f,m,_,d,y,x),t1(e,t,C,x,n,r,a,o,s,l,c,f,p,v,i,g),g=dh(f,m,_,d,y+1,S),t1(e,t,C,S,n,r,a,o,s,l,c,f,p,v,i,g),g=dh(f,m,_,d,y+2,w),t1(e,t,C,w,n,r,a,o,s,l,c,f,p,v,i,g)}P5(e,A,b)}var R$=tn.fromPointNormal(h.ZERO,h.UNIT_Y),Ywe=new h,Xwe=new h;function Kb(e,t,i,n,r,o,a){if(!u(a))return;let s=h.fromArray(n,3*e,uS);h.equalsEpsilon(s,i,P.EPSILON10)?o.applyOffset.values[r]=a[e]:o.applyOffset.values[r]=a[t]}function v$(e){let t,i=e.geometry,n=i.attributes,r=n.position.values,o=u(n.applyOffset)?n.applyOffset.values:void 0,a=i.indices,s=Zb(i),l=Zb(i),c=a.length,d=[];d.length=r.length/3;let p=[];for(p.length=r.length/3,t=0;t<d.length;++t)d[t]=-1,p[t]=-1;for(t=0;t<c;t+=2){let e,i=a[t],n=a[t+1],c=h.fromArray(r,3*i,uS),f=h.fromArray(r,3*n,v5);Math.abs(c.y)<P.EPSILON6&&(c.y<0?c.y=-P.EPSILON6:c.y=P.EPSILON6),Math.abs(f.y)<P.EPSILON6&&(f.y<0?f.y=-P.EPSILON6:f.y=P.EPSILON6);let m=s.attributes,_=s.indices,g=p,y=l.attributes,v=l.indices,b=d,A=Ai.lineSegmentPlane(c,f,R$,D5);if(u(A)){let u=h.multiplyByScalar(h.UNIT_Y,5*P.EPSILON9,Ywe);c.y<0&&(h.negate(u,u),m=l.attributes,_=l.indices,g=d,y=s.attributes,v=s.indices,b=p);let T=h.add(A,u,Xwe);e=dh(m,_,g,a,t,c),Kb(i,n,c,r,e,m,o),e=dh(m,_,g,a,-1,T),Kb(i,n,T,r,e,m,o),h.negate(u,u),h.add(A,u,T),e=dh(y,v,b,a,-1,T),Kb(i,n,T,r,e,y,o),e=dh(y,v,b,a,t+1,f),Kb(i,n,f,r,e,y,o)}else{let u,h,m;c.y<0?(u=l.attributes,h=l.indices,m=d):(u=s.attributes,h=s.indices,m=p),e=dh(u,h,m,a,t,c),Kb(i,n,c,r,e,u,o),e=dh(u,h,m,a,t+1,f),Kb(i,n,f,r,e,u,o)}}P5(e,l,s)}var D$=new U,Kwe=new U,M$=new h,L$=new h,I5=new h,Zwe=new h,$we=new h,Qwe=new h,I$=new oe;function P$(e){let t=e.attributes,i=t.position.values,n=t.prevPosition.values,r=t.nextPosition.values,o=i.length;for(let e=0;e<o;e+=3){let t=h.unpack(i,e,M$);if(t.x>0)continue;let a=h.unpack(n,e,L$);(t.y<0&&a.y>0||t.y>0&&a.y<0)&&(e-3>0?(n[e]=i[e-3],n[e+1]=i[e-2],n[e+2]=i[e-1]):h.pack(t,n,e));let s=h.unpack(r,e,I5);(t.y<0&&s.y>0||t.y>0&&s.y<0)&&(e+3<o?(r[e]=i[e+3],r[e+1]=i[e+4],r[e+2]=i[e+5]):h.pack(t,r,e))}}var Jwe=5*P.EPSILON9,n1=P.EPSILON6;function eve(e){let t,i,n,r=e.geometry,o=r.attributes,a=o.position.values,s=o.prevPosition.values,l=o.nextPosition.values,c=o.expandAndWidth.values,d=u(o.st)?o.st.values:void 0,p=u(o.color)?o.color.values:void 0,f=Zb(r),m=Zb(r),_=!1,g=a.length/3;for(t=0;t<g;t+=4){let e=t,r=t+2,o=h.fromArray(a,3*e,M$),g=h.fromArray(a,3*r,L$);if(Math.abs(o.y)<n1)for(o.y=n1*(g.y<0?-1:1),a[3*t+1]=o.y,a[3*(t+1)+1]=o.y,i=3*e;i<3*e+12;i+=3)s[i]=a[3*t],s[i+1]=a[3*t+1],s[i+2]=a[3*t+2];if(Math.abs(g.y)<n1)for(g.y=n1*(o.y<0?-1:1),a[3*(t+2)+1]=g.y,a[3*(t+3)+1]=g.y,i=3*e;i<3*e+12;i+=3)l[i]=a[3*(t+2)],l[i+1]=a[3*(t+2)+1],l[i+2]=a[3*(t+2)+2];let y=f.attributes,v=f.indices,b=m.attributes,A=m.indices,T=Ai.lineSegmentPlane(o,g,R$,Zwe);if(u(T)){_=!0;let a=h.multiplyByScalar(h.UNIT_Y,Jwe,$we);o.y<0&&(h.negate(a,a),y=m.attributes,v=m.indices,b=f.attributes,A=f.indices);let E=h.add(T,a,Qwe);y.position.values.push(o.x,o.y,o.z,o.x,o.y,o.z),y.position.values.push(E.x,E.y,E.z),y.position.values.push(E.x,E.y,E.z),y.prevPosition.values.push(s[3*e],s[3*e+1],s[3*e+2]),y.prevPosition.values.push(s[3*e+3],s[3*e+4],s[3*e+5]),y.prevPosition.values.push(o.x,o.y,o.z,o.x,o.y,o.z),y.nextPosition.values.push(E.x,E.y,E.z),y.nextPosition.values.push(E.x,E.y,E.z),y.nextPosition.values.push(E.x,E.y,E.z),y.nextPosition.values.push(E.x,E.y,E.z),h.negate(a,a),h.add(T,a,E),b.position.values.push(E.x,E.y,E.z),b.position.values.push(E.x,E.y,E.z),b.position.values.push(g.x,g.y,g.z,g.x,g.y,g.z),b.prevPosition.values.push(E.x,E.y,E.z),b.prevPosition.values.push(E.x,E.y,E.z),b.prevPosition.values.push(E.x,E.y,E.z),b.prevPosition.values.push(E.x,E.y,E.z),b.nextPosition.values.push(g.x,g.y,g.z,g.x,g.y,g.z),b.nextPosition.values.push(l[3*r],l[3*r+1],l[3*r+2]),b.nextPosition.values.push(l[3*r+3],l[3*r+4],l[3*r+5]);let C=U.fromArray(c,2*e,D$),x=Math.abs(C.y);y.expandAndWidth.values.push(-1,x,1,x),y.expandAndWidth.values.push(-1,-x,1,-x),b.expandAndWidth.values.push(-1,x,1,x),b.expandAndWidth.values.push(-1,-x,1,-x);let S=h.magnitudeSquared(h.subtract(T,o,I5));if(S/=h.magnitudeSquared(h.subtract(g,o,I5)),u(p)){let t=oe.fromArray(p,4*e,I$),n=oe.fromArray(p,4*r,I$),o=P.lerp(t.x,n.x,S),a=P.lerp(t.y,n.y,S),s=P.lerp(t.z,n.z,S),l=P.lerp(t.w,n.w,S);for(i=4*e;i<4*e+8;++i)y.color.values.push(p[i]);for(y.color.values.push(o,a,s,l),y.color.values.push(o,a,s,l),b.color.values.push(o,a,s,l),b.color.values.push(o,a,s,l),i=4*r;i<4*r+8;++i)b.color.values.push(p[i])}if(u(d)){let n=U.fromArray(d,2*e,D$),o=U.fromArray(d,2*(t+3),Kwe),a=P.lerp(n.x,o.x,S);for(i=2*e;i<2*e+4;++i)y.st.values.push(d[i]);for(y.st.values.push(a,n.y),y.st.values.push(a,o.y),b.st.values.push(a,n.y),b.st.values.push(a,o.y),i=2*r;i<2*r+4;++i)b.st.values.push(d[i])}n=y.position.values.length/3-4,v.push(n,n+2,n+1),v.push(n+1,n+2,n+3),n=b.position.values.length/3-4,A.push(n,n+2,n+1),A.push(n+1,n+2,n+3)}else{let e,r;for(o.y<0?(e=m.attributes,r=m.indices):(e=f.attributes,r=f.indices),e.position.values.push(o.x,o.y,o.z),e.position.values.push(o.x,o.y,o.z),e.position.values.push(g.x,g.y,g.z),e.position.values.push(g.x,g.y,g.z),i=3*t;i<3*t+12;++i)e.prevPosition.values.push(s[i]),e.nextPosition.values.push(l[i]);for(i=2*t;i<2*t+8;++i)e.expandAndWidth.values.push(c[i]),u(d)&&e.st.values.push(d[i]);if(u(p))for(i=4*t;i<4*t+16;++i)e.color.values.push(p[i]);n=e.position.values.length/3-4,r.push(n,n+2,n+1),r.push(n+1,n+2,n+3)}}_&&(P$(m),P$(f)),P5(e,m,f)}uc.splitLongitude=function(e){let t=e.geometry,i=t.boundingSphere;if(u(i)&&(i.center.x-i.radius>0||se.intersectPlane(i,tn.ORIGIN_ZX_PLANE)!==Zt.INTERSECTING))return e;if(t.geometryType!==Bf.NONE)switch(t.geometryType){case Bf.POLYLINES:eve(e);break;case Bf.TRIANGLES:w$(e);break;case Bf.LINES:v$(e)}else Vwe(t),t.primitiveType===Ne.TRIANGLES?w$(e):t.primitiveType===Ne.LINES&&v$(e);return e};var Fn=uc,$b=new h,R5=new h,M5=new h,N$=new h,es=new U,F$=new $,tve=new $,L5=new Le,B$=new h,k$=new h,V$=new h,a1=new fe,U$=new h,z$=new U,H$=new U;function G$(e,t,i){let n=t.vertexFormat,r=t.center,o=t.semiMajorAxis,a=t.semiMinorAxis,s=t.ellipsoid,l=t.stRotation,c=i?e.length/3*2:e.length/3,d=t.shadowVolume,p=n.st?new Float32Array(2*c):void 0,f=n.normal?new Float32Array(3*c):void 0,m=n.tangent?new Float32Array(3*c):void 0,_=n.bitangent?new Float32Array(3*c):void 0,g=d?new Float32Array(3*c):void 0,y=0,v=B$,b=k$,A=V$,T=new Ii(s),E=T.project(s.cartesianToCartographic(r,a1),U$),C=s.scaleToGeodeticSurface(r,$b);s.geodeticSurfaceNormal(C,C);let x=F$,S=tve;if(0!==l){let e=Le.fromAxisAngle(C,l,L5);x=$.fromQuaternion(e,x),e=Le.fromAxisAngle(C,-l,L5),S=$.fromQuaternion(e,S)}else x=$.clone($.IDENTITY,x),S=$.clone($.IDENTITY,S);let w=U.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,z$),I=U.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,H$),P=e.length,D=i?P:0,O=D/3*2;for(let t=0;t<P;t+=3){let r=t+1,l=t+2,u=h.fromArray(e,t,$b);if(n.st){let e=$.multiplyByVector(x,u,R5),t=T.project(s.cartesianToCartographic(e,a1),M5);h.subtract(t,E,t),es.x=(t.x+o)/(2*o),es.y=(t.y+a)/(2*a),w.x=Math.min(es.x,w.x),w.y=Math.min(es.y,w.y),I.x=Math.max(es.x,I.x),I.y=Math.max(es.y,I.y),i&&(p[y+O]=es.x,p[y+1+O]=es.y),p[y++]=es.x,p[y++]=es.y}(n.normal||n.tangent||n.bitangent||d)&&(v=s.geodeticSurfaceNormal(u,v),d&&(g[t+D]=-v.x,g[r+D]=-v.y,g[l+D]=-v.z),(n.normal||n.tangent||n.bitangent)&&((n.tangent||n.bitangent)&&(b=h.normalize(h.cross(h.UNIT_Z,v,b),b),$.multiplyByVector(S,b,b)),n.normal&&(f[t]=v.x,f[r]=v.y,f[l]=v.z,i&&(f[t+D]=-v.x,f[r+D]=-v.y,f[l+D]=-v.z)),n.tangent&&(m[t]=b.x,m[r]=b.y,m[l]=b.z,i&&(m[t+D]=-b.x,m[r+D]=-b.y,m[l+D]=-b.z)),n.bitangent&&(A=h.normalize(h.cross(v,b,A),A),_[t]=A.x,_[r]=A.y,_[l]=A.z,i&&(_[t+D]=A.x,_[r+D]=A.y,_[l+D]=A.z))))}if(n.st){P=p.length;for(let e=0;e<P;e+=2)p[e]=(p[e]-w.x)/(I.x-w.x),p[e+1]=(p[e+1]-w.y)/(I.y-w.y)}let L=new hn;if(n.position){let n=Pl.raisePositionsToHeight(e,t,i);L.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:n})}if(n.st&&(L.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:p})),n.normal&&(L.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:f})),n.tangent&&(L.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:m})),n.bitangent&&(L.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:_})),d&&(L.extrudeDirection=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:g})),i&&u(t.offsetAttribute)){let e=new Uint8Array(c);if(t.offsetAttribute===on.TOP)e=e.fill(1,0,c/2);else{let i=t.offsetAttribute===on.NONE?0:1;e=e.fill(i)}L.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:e})}return L}function W$(e){let t,i,n,r,o,a=new Array(e*(e+1)*12-6),s=0;for(t=0,n=1,r=0;r<3;r++)a[s++]=n++,a[s++]=t,a[s++]=n;for(r=2;r<e+1;++r){for(n=r*(r+1)-1,t=(r-1)*r-1,a[s++]=n++,a[s++]=t,a[s++]=n,i=2*r,o=0;o<i-1;++o)a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t,a[s++]=n;a[s++]=n++,a[s++]=t,a[s++]=n}for(i=2*e,++n,++t,r=0;r<i-1;++r)a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t,a[s++]=n;for(a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t++,a[s++]=t,++t,r=e-1;r>1;--r){for(a[s++]=t++,a[s++]=t,a[s++]=n,i=2*r,o=0;o<i-1;++o)a[s++]=n,a[s++]=t++,a[s++]=t,a[s++]=n++,a[s++]=t,a[s++]=n;a[s++]=t++,a[s++]=t++,a[s++]=n++}for(r=0;r<3;r++)a[s++]=t++,a[s++]=t,a[s++]=n;return a}var c0=new h;function nve(e){let t=e.center;c0=h.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,c0),e.height,c0),c0=h.add(t,c0,c0);let i=new se(c0,e.semiMajorAxis),n=Pl.computeEllipsePositions(e,!0,!1),r=n.positions,o=n.numPts,a=G$(r,e,!1),s=W$(o);return s=ke.createTypedArray(r.length/3,s),{boundingSphere:i,attributes:a,indices:s}}function ive(e,t){let i=t.vertexFormat,n=t.center,r=t.semiMajorAxis,o=t.semiMinorAxis,a=t.ellipsoid,s=t.height,l=t.extrudedHeight,c=t.stRotation,d=e.length/3*2,p=new Float64Array(3*d),f=i.st?new Float32Array(2*d):void 0,m=i.normal?new Float32Array(3*d):void 0,_=i.tangent?new Float32Array(3*d):void 0,g=i.bitangent?new Float32Array(3*d):void 0,y=t.shadowVolume,v=y?new Float32Array(3*d):void 0,b=0,A=B$,T=k$,E=V$,C=new Ii(a),x=C.project(a.cartesianToCartographic(n,a1),U$),S=a.scaleToGeodeticSurface(n,$b);a.geodeticSurfaceNormal(S,S);let w=Le.fromAxisAngle(S,c,L5),I=$.fromQuaternion(w,F$),P=U.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,z$),D=U.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,H$),O=e.length,L=O/3*2;for(let t=0;t<O;t+=3){let n,u=t+1,c=t+2,d=h.fromArray(e,t,$b);if(i.st){let e=$.multiplyByVector(I,d,R5),t=C.project(a.cartesianToCartographic(e,a1),M5);h.subtract(t,x,t),es.x=(t.x+r)/(2*r),es.y=(t.y+o)/(2*o),P.x=Math.min(es.x,P.x),P.y=Math.min(es.y,P.y),D.x=Math.max(es.x,D.x),D.y=Math.max(es.y,D.y),f[b+L]=es.x,f[b+1+L]=es.y,f[b++]=es.x,f[b++]=es.y}d=a.scaleToGeodeticSurface(d,d),n=h.clone(d,R5),A=a.geodeticSurfaceNormal(d,A),y&&(v[t+O]=-A.x,v[u+O]=-A.y,v[c+O]=-A.z);let S=h.multiplyByScalar(A,s,N$);if(d=h.add(d,S,d),S=h.multiplyByScalar(A,l,S),n=h.add(n,S,n),i.position&&(p[t+O]=n.x,p[u+O]=n.y,p[c+O]=n.z,p[t]=d.x,p[u]=d.y,p[c]=d.z),i.normal||i.tangent||i.bitangent){E=h.clone(A,E);let r=h.fromArray(e,(t+3)%O,N$);h.subtract(r,d,r);let o=h.subtract(n,d,M5);A=h.normalize(h.cross(o,r,A),A),i.normal&&(m[t]=A.x,m[u]=A.y,m[c]=A.z,m[t+O]=A.x,m[u+O]=A.y,m[c+O]=A.z),i.tangent&&(T=h.normalize(h.cross(E,A,T),T),_[t]=T.x,_[u]=T.y,_[c]=T.z,_[t+O]=T.x,_[t+1+O]=T.y,_[t+2+O]=T.z),i.bitangent&&(g[t]=E.x,g[u]=E.y,g[c]=E.z,g[t+O]=E.x,g[u+O]=E.y,g[c+O]=E.z)}}if(i.st){O=f.length;for(let e=0;e<O;e+=2)f[e]=(f[e]-P.x)/(D.x-P.x),f[e+1]=(f[e+1]-P.y)/(D.y-P.y)}let R=new hn;if(i.position&&(R.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:p})),i.st&&(R.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:f})),i.normal&&(R.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:m})),i.tangent&&(R.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:_})),i.bitangent&&(R.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:g})),y&&(R.extrudeDirection=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:v})),u(t.offsetAttribute)){let e=new Uint8Array(d);if(t.offsetAttribute===on.TOP)e=e.fill(1,0,d/2);else{let i=t.offsetAttribute===on.NONE?0:1;e=e.fill(i)}R.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:e})}return R}function ove(e){let t=e.length/3,i=ke.createTypedArray(t,6*t),n=0;for(let e=0;e<t;e++){let r=e,o=e+t,a=(r+1)%t,s=a+t;i[n++]=r,i[n++]=o,i[n++]=a,i[n++]=a,i[n++]=o,i[n++]=s}return i}var r1=new se,s1=new se;function rve(e){let t=e.center,i=e.ellipsoid,n=e.semiMajorAxis,r=h.multiplyByScalar(i.geodeticSurfaceNormal(t,$b),e.height,$b);r1.center=h.add(t,r,r1.center),r1.radius=n,r=h.multiplyByScalar(i.geodeticSurfaceNormal(t,r),e.extrudedHeight,r),s1.center=h.add(t,r,s1.center),s1.radius=n;let o=Pl.computeEllipsePositions(e,!0,!0),a=o.positions,s=o.numPts,l=o.outerPositions,u=se.union(r1,s1),c=G$(a,e,!0),d=W$(s),p=d.length;d.length=2*p;let f=a.length/3;for(let e=0;e<p;e+=3)d[e+p]=d[e+2]+f,d[e+1+p]=d[e+1]+f,d[e+2+p]=d[e]+f;let m=ke.createTypedArray(2*f/3,d),_=new ct({attributes:c,indices:m,primitiveType:Ne.TRIANGLES}),g=ive(l,e);d=ove(l);let y=ke.createTypedArray(2*l.length/3,d),v=new ct({attributes:g,indices:y,primitiveType:Ne.TRIANGLES}),b=Fn.combineInstances([new yt({geometry:_}),new yt({geometry:v})]);return{boundingSphere:u,attributes:b[0].attributes,indices:b[0].indices}}function j$(e,t,i,n,r,o,a){let s=Pl.computeEllipsePositions({center:e,semiMajorAxis:t,semiMinorAxis:i,rotation:n,granularity:r},!1,!0).outerPositions,l=s.length/3,u=new Array(l);for(let e=0;e<l;++e)u[e]=h.fromArray(s,3*e);let c=ce.fromCartesianArray(u,o,a);return c.width>P.PI&&(c.north=c.north>0?P.PI_OVER_TWO-P.EPSILON7:c.north,c.south=c.south<0?P.EPSILON7-P.PI_OVER_TWO:c.south,c.east=P.PI,c.west=-P.PI),c}function mh(e){let t=(e=y(e,y.EMPTY_OBJECT)).center,i=y(e.ellipsoid,ie.WGS84),n=e.semiMajorAxis,r=e.semiMinorAxis,o=y(e.granularity,P.RADIANS_PER_DEGREE),a=y(e.vertexFormat,Pe.DEFAULT),s=y(e.height,0),l=y(e.extrudedHeight,s);this._center=h.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=r,this._ellipsoid=ie.clone(i),this._rotation=y(e.rotation,0),this._stRotation=y(e.stRotation,0),this._height=Math.max(l,s),this._granularity=o,this._vertexFormat=Pe.clone(a),this._extrudedHeight=Math.min(l,s),this._shadowVolume=y(e.shadowVolume,!1),this._workerName="createEllipseGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}mh.packedLength=h.packedLength+ie.packedLength+Pe.packedLength+9,mh.pack=function(e,t,i){return i=y(i,0),h.pack(e._center,t,i),i+=h.packedLength,ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._stRotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._shadowVolume?1:0,t[i]=y(e._offsetAttribute,-1),t};var q$=new h,Y$=new ie,X$=new Pe,hh={center:q$,ellipsoid:Y$,vertexFormat:X$,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};function sve(e){let t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];let i=Pl.computeEllipsePositions({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,rotation:e._rotation,granularity:e._granularity},!1,!0).outerPositions,n=i.length/3,r=new Array(n);for(let e=0;e<n;++e)r[e]=h.fromArray(i,3*e);let o=e._ellipsoid,a=e.rectangle;return ct._textureCoordinateRotationPoints(r,t,o,a)}mh.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t,q$);t+=h.packedLength;let r=ie.unpack(e,t,Y$);t+=ie.packedLength;let o=Pe.unpack(e,t,X$);t+=Pe.packedLength;let a=e[t++],s=e[t++],l=e[t++],c=e[t++],d=e[t++],p=e[t++],f=e[t++],m=1===e[t++],_=e[t];return u(i)?(i._center=h.clone(n,i._center),i._ellipsoid=ie.clone(r,i._ellipsoid),i._vertexFormat=Pe.clone(o,i._vertexFormat),i._semiMajorAxis=a,i._semiMinorAxis=s,i._rotation=l,i._stRotation=c,i._height=d,i._granularity=p,i._extrudedHeight=f,i._shadowVolume=m,i._offsetAttribute=-1===_?void 0:_,i):(hh.height=d,hh.extrudedHeight=f,hh.granularity=p,hh.stRotation=c,hh.rotation=l,hh.semiMajorAxis=a,hh.semiMinorAxis=s,hh.shadowVolume=m,hh.offsetAttribute=-1===_?void 0:_,new mh(hh))},mh.computeRectangle=function(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).center,n=y(e.ellipsoid,ie.WGS84),r=e.semiMajorAxis,o=e.semiMinorAxis,a=y(e.granularity,P.RADIANS_PER_DEGREE);return j$(i,r,o,y(e.rotation,0),a,n,t)},mh.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;let t=e._height,i=e._extrudedHeight,n=!P.equalsEpsilon(t,i,0,P.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);let r,o={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation};if(n)o.extrudedHeight=i,o.shadowVolume=e._shadowVolume,o.offsetAttribute=e._offsetAttribute,r=rve(o);else if(r=nve(o),u(e._offsetAttribute)){let t=r.attributes.position.values.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);r.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:r.attributes,indices:r.indices,primitiveType:Ne.TRIANGLES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})},mh.createShadowVolume=function(e,t,i){let n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new mh({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:r,rotation:e._rotation,stRotation:e._stRotation,granularity:n,extrudedHeight:o,height:a,vertexFormat:Pe.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(mh.prototype,{rectangle:{get:function(){return u(this._rectangle)||(this._rectangle=j$(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=sve(this)),this._textureCoordinateRotationPoints}}});var Yc=mh;function Mm(e){let t=(e=y(e,y.EMPTY_OBJECT)).radius,i={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new Yc(i),this._workerName="createCircleGeometry"}Mm.packedLength=Yc.packedLength,Mm.pack=function(e,t,i){return Yc.pack(e._ellipseGeometry,t,i)};var ave=new Yc({center:new h,semiMajorAxis:1,semiMinorAxis:1}),Da={center:new h,radius:void 0,ellipsoid:ie.clone(ie.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new Pe,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0,shadowVolume:void 0};Mm.unpack=function(e,t,i){let n=Yc.unpack(e,t,ave);return Da.center=h.clone(n._center,Da.center),Da.ellipsoid=ie.clone(n._ellipsoid,Da.ellipsoid),Da.height=n._height,Da.extrudedHeight=n._extrudedHeight,Da.granularity=n._granularity,Da.vertexFormat=Pe.clone(n._vertexFormat,Da.vertexFormat),Da.stRotation=n._stRotation,Da.shadowVolume=n._shadowVolume,u(i)?(Da.semiMajorAxis=n._semiMajorAxis,Da.semiMinorAxis=n._semiMinorAxis,i._ellipseGeometry=new Yc(Da),i):(Da.radius=n._semiMajorAxis,new Mm(Da))},Mm.createGeometry=function(e){return Yc.createGeometry(e._ellipseGeometry)},Mm.createShadowVolume=function(e,t,i){let n=e._ellipseGeometry._granularity,r=e._ellipseGeometry._ellipsoid,o=t(n,r),a=i(n,r);return new Mm({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:r,stRotation:e._ellipseGeometry._stRotation,granularity:n,extrudedHeight:o,height:a,vertexFormat:Pe.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(Mm.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}},textureCoordinateRotationPoints:{get:function(){return this._ellipseGeometry.textureCoordinateRotationPoints}}});var K$=Mm,Z$=new h,l0=new h;function cve(e){let t=e.center;l0=h.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,l0),e.height,l0),l0=h.add(t,l0,l0);let i=new se(l0,e.semiMajorAxis),n=Pl.computeEllipsePositions(e,!1,!0).outerPositions,r=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:Pl.raisePositionsToHeight(n,e,!1)})}),o=n.length/3,a=ke.createTypedArray(o,2*o),s=0;for(let e=0;e<o;++e)a[s++]=e,a[s++]=(e+1)%o;return{boundingSphere:i,attributes:r,indices:a}}var c1=new se,l1=new se;function lve(e){let t=e.center,i=e.ellipsoid,n=e.semiMajorAxis,r=h.multiplyByScalar(i.geodeticSurfaceNormal(t,Z$),e.height,Z$);c1.center=h.add(t,r,c1.center),c1.radius=n,r=h.multiplyByScalar(i.geodeticSurfaceNormal(t,r),e.extrudedHeight,r),l1.center=h.add(t,r,l1.center),l1.radius=n;let o=Pl.computeEllipsePositions(e,!1,!0).outerPositions,a=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:Pl.raisePositionsToHeight(o,e,!0)})});o=a.position.values;let s=se.union(c1,l1),l=o.length/3;if(u(e.offsetAttribute)){let t=new Uint8Array(l);if(e.offsetAttribute===on.TOP)t=t.fill(1,0,l/2);else{let i=e.offsetAttribute===on.NONE?0:1;t=t.fill(i)}a.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let c=y(e.numberOfVerticalLines,16);c=P.clamp(c,0,l/2);let d=ke.createTypedArray(l,2*l+2*c);l/=2;let p,f,m=0;for(p=0;p<l;++p)d[m++]=p,d[m++]=(p+1)%l,d[m++]=p+l,d[m++]=(p+1)%l+l;if(c>0){let e=Math.min(c,l);f=Math.round(l/e);let t=Math.min(f*c,l);for(p=0;p<t;p+=f)d[m++]=p,d[m++]=p+l}return{boundingSphere:s,attributes:a,indices:d}}function Qb(e){let t=(e=y(e,y.EMPTY_OBJECT)).center,i=y(e.ellipsoid,ie.WGS84),n=e.semiMajorAxis,r=e.semiMinorAxis,o=y(e.granularity,P.RADIANS_PER_DEGREE),a=y(e.height,0),s=y(e.extrudedHeight,a);this._center=h.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=r,this._ellipsoid=ie.clone(i),this._rotation=y(e.rotation,0),this._height=Math.max(s,a),this._granularity=o,this._extrudedHeight=Math.min(s,a),this._numberOfVerticalLines=Math.max(y(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}Qb.packedLength=h.packedLength+ie.packedLength+8,Qb.pack=function(e,t,i){return i=y(i,0),h.pack(e._center,t,i),i+=h.packedLength,ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._numberOfVerticalLines,t[i]=y(e._offsetAttribute,-1),t};var $$=new h,Q$=new ie,Lm={center:$$,ellipsoid:Q$,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};Qb.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t,$$);t+=h.packedLength;let r=ie.unpack(e,t,Q$);t+=ie.packedLength;let o=e[t++],a=e[t++],s=e[t++],l=e[t++],c=e[t++],d=e[t++],p=e[t++],f=e[t];return u(i)?(i._center=h.clone(n,i._center),i._ellipsoid=ie.clone(r,i._ellipsoid),i._semiMajorAxis=o,i._semiMinorAxis=a,i._rotation=s,i._height=l,i._granularity=c,i._extrudedHeight=d,i._numberOfVerticalLines=p,i._offsetAttribute=-1===f?void 0:f,i):(Lm.height=l,Lm.extrudedHeight=d,Lm.granularity=c,Lm.rotation=s,Lm.semiMajorAxis=o,Lm.semiMinorAxis=a,Lm.numberOfVerticalLines=p,Lm.offsetAttribute=-1===f?void 0:f,new Qb(Lm))},Qb.createGeometry=function(e){if(e._semiMajorAxis<=0||e._semiMinorAxis<=0)return;let t=e._height,i=e._extrudedHeight,n=!P.equalsEpsilon(t,i,0,P.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);let r,o={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};if(n)o.extrudedHeight=i,o.offsetAttribute=e._offsetAttribute,r=lve(o);else if(r=cve(o),u(e._offsetAttribute)){let t=r.attributes.position.values.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);r.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:r.attributes,indices:r.indices,primitiveType:Ne.LINES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})};var Ru=Qb;function Jb(e){let t=(e=y(e,y.EMPTY_OBJECT)).radius,i={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new Ru(i),this._workerName="createCircleOutlineGeometry"}Jb.packedLength=Ru.packedLength,Jb.pack=function(e,t,i){return Ru.pack(e._ellipseGeometry,t,i)};var uve=new Ru({center:new h,semiMajorAxis:1,semiMinorAxis:1}),Ol={center:new h,radius:void 0,ellipsoid:ie.clone(ie.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};Jb.unpack=function(e,t,i){let n=Ru.unpack(e,t,uve);return Ol.center=h.clone(n._center,Ol.center),Ol.ellipsoid=ie.clone(n._ellipsoid,Ol.ellipsoid),Ol.height=n._height,Ol.extrudedHeight=n._extrudedHeight,Ol.granularity=n._granularity,Ol.numberOfVerticalLines=n._numberOfVerticalLines,u(i)?(Ol.semiMajorAxis=n._semiMajorAxis,Ol.semiMinorAxis=n._semiMinorAxis,i._ellipseGeometry=new Ru(Ol),i):(Ol.radius=n._semiMajorAxis,new Jb(Ol))},Jb.createGeometry=function(e){return Ru.createGeometry(e._ellipseGeometry)};var J$=Jb,fve={UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2},Dr=Object.freeze(fve),dve={TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2},ho=Object.freeze(dve),N5;N5=typeof performance<"u"&&"function"==typeof performance.now&&isFinite(performance.now())?function(){return performance.now()}:function(){return Date.now()};var _i=N5;function F5(e){let t=(e=y(e,y.EMPTY_OBJECT)).currentTime,i=e.startTime,n=e.stopTime;t=u(t)?J.clone(t):u(i)?J.clone(i):u(n)?J.addDays(n,-1,new J):J.now(),i=u(i)?J.clone(i):J.clone(t),n=u(n)?J.clone(n):J.addDays(i,1,new J),this.startTime=i,this.stopTime=n,this.clockRange=y(e.clockRange,Dr.UNBOUNDED),this.canAnimate=y(e.canAnimate,!0),this.onTick=new pe,this.onStop=new pe,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=_i(),this.currentTime=t,this.multiplier=y(e.multiplier,1),this.shouldAnimate=y(e.shouldAnimate,!1),this.clockStep=y(e.clockStep,ho.SYSTEM_CLOCK_MULTIPLIER)}Object.defineProperties(F5.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){J.equals(this._currentTime,e)||(this._clockStep===ho.SYSTEM_CLOCK&&(this._clockStep=ho.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===ho.SYSTEM_CLOCK&&(this._clockStep=ho.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===ho.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=J.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===ho.SYSTEM_CLOCK&&(this._clockStep=ho.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}}),F5.prototype.tick=function(){let e=_i(),t=J.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){let i=this._clockStep;if(i===ho.SYSTEM_CLOCK)t=J.now(t);else{let n=this._multiplier;if(i===ho.TICK_DEPENDENT)t=J.addSeconds(t,n,t);else{let i=e-this._lastSystemTime;t=J.addSeconds(t,n*(i/1e3),t)}let r=this.clockRange,o=this.startTime,a=this.stopTime;if(r===Dr.CLAMPED)J.lessThan(t,o)?t=J.clone(o,t):J.greaterThan(t,a)&&(t=J.clone(a,t),this.onStop.raiseEvent(this));else if(r===Dr.LOOP_STOP)for(J.lessThan(t,o)&&(t=J.clone(o,t));J.greaterThan(t,a);)t=J.addSeconds(o,J.secondsDifference(t,a),t),this.onStop.raiseEvent(this)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t};var ph=F5,k5,V5,Nm;function B5(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),6*i<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function ne(e,t,i,n){this.red=y(e,1),this.green=y(t,1),this.blue=y(i,1),this.alpha=y(n,1)}ne.fromCartesian4=function(e,t){return u(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new ne(e.x,e.y,e.z,e.w)},ne.fromBytes=function(e,t,i,n,r){return e=ne.byteToFloat(y(e,255)),t=ne.byteToFloat(y(t,255)),i=ne.byteToFloat(y(i,255)),n=ne.byteToFloat(y(n,255)),u(r)?(r.red=e,r.green=t,r.blue=i,r.alpha=n,r):new ne(e,t,i,n)},ne.fromAlpha=function(e,t,i){return u(i)?(i.red=e.red,i.green=e.green,i.blue=e.blue,i.alpha=t,i):new ne(e.red,e.green,e.blue,t)},Bt.supportsTypedArrays()&&(k5=new ArrayBuffer(4),V5=new Uint32Array(k5),Nm=new Uint8Array(k5)),ne.fromRgba=function(e,t){return V5[0]=e,ne.fromBytes(Nm[0],Nm[1],Nm[2],Nm[3],t)},ne.fromHsl=function(e,t,i,n,r){e=y(e,0)%1,t=y(t,0),i=y(i,0),n=y(n,1);let o=i,a=i,s=i;if(0!==t){let n;n=i<.5?i*(1+t):i+t-i*t;let r=2*i-n;o=B5(r,n,e+1/3),a=B5(r,n,e),s=B5(r,n,e-1/3)}return u(r)?(r.red=o,r.green=a,r.blue=s,r.alpha=n,r):new ne(o,a,s,n)},ne.fromRandom=function(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).red;if(!u(i)){let t=y(e.minimumRed,0),n=y(e.maximumRed,1);i=t+P.nextRandomNumber()*(n-t)}let n=e.green;if(!u(n)){let t=y(e.minimumGreen,0),i=y(e.maximumGreen,1);n=t+P.nextRandomNumber()*(i-t)}let r=e.blue;if(!u(r)){let t=y(e.minimumBlue,0),i=y(e.maximumBlue,1);r=t+P.nextRandomNumber()*(i-t)}let o=e.alpha;if(!u(o)){let t=y(e.minimumAlpha,0),i=y(e.maximumAlpha,1);o=t+P.nextRandomNumber()*(i-t)}return u(t)?(t.red=i,t.green=n,t.blue=r,t.alpha=o,t):new ne(i,n,r,o)};var hve=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,mve=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,pve=/^rgba?\s*\(\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)\s*[,\s]+\s*([0-9.]+%?)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i,_ve=/^hsla?\s*\(\s*([0-9.]+)\s*[,\s]+\s*([0-9.]+%)\s*[,\s]+\s*([0-9.]+%)(?:\s*[,\s/]+\s*([0-9.]+))?\s*\)$/i;ne.fromCssColorString=function(e,t){u(t)||(t=new ne);let i=ne[(e=e.trim()).toUpperCase()];if(u(i))return ne.clone(i,t),t;let n=hve.exec(e);return null!==n?(t.red=parseInt(n[1],16)/15,t.green=parseInt(n[2],16)/15,t.blue=parseInt(n[3],16)/15,t.alpha=parseInt(y(n[4],"f"),16)/15,t):(n=mve.exec(e),null!==n?(t.red=parseInt(n[1],16)/255,t.green=parseInt(n[2],16)/255,t.blue=parseInt(n[3],16)/255,t.alpha=parseInt(y(n[4],"ff"),16)/255,t):(n=pve.exec(e),null!==n?(t.red=parseFloat(n[1])/("%"===n[1].substr(-1)?100:255),t.green=parseFloat(n[2])/("%"===n[2].substr(-1)?100:255),t.blue=parseFloat(n[3])/("%"===n[3].substr(-1)?100:255),t.alpha=parseFloat(y(n[4],"1.0")),t):(n=_ve.exec(e),null!==n?ne.fromHsl(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,parseFloat(y(n[4],"1.0")),t):t=void 0)))},ne.packedLength=4,ne.pack=function(e,t,i){return i=y(i,0),t[i++]=e.red,t[i++]=e.green,t[i++]=e.blue,t[i]=e.alpha,t},ne.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new ne),i.red=e[t++],i.green=e[t++],i.blue=e[t++],i.alpha=e[t],i},ne.byteToFloat=function(e){return e/255},ne.floatToByte=function(e){return 1===e?255:256*e|0},ne.clone=function(e,t){if(u(e))return u(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new ne(e.red,e.green,e.blue,e.alpha)},ne.equals=function(e,t){return e===t||u(e)&&u(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},ne.equalsArray=function(e,t,i){return e.red===t[i]&&e.green===t[i+1]&&e.blue===t[i+2]&&e.alpha===t[i+3]},ne.prototype.clone=function(e){return ne.clone(this,e)},ne.prototype.equals=function(e){return ne.equals(this,e)},ne.prototype.equalsEpsilon=function(e,t){return this===e||u(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},ne.prototype.toString=function(){return`(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`},ne.prototype.toCssColorString=function(){let e=ne.floatToByte(this.red),t=ne.floatToByte(this.green),i=ne.floatToByte(this.blue);return 1===this.alpha?`rgb(${e},${t},${i})`:`rgba(${e},${t},${i},${this.alpha})`},ne.prototype.toCssHexString=function(){let e=ne.floatToByte(this.red).toString(16);e.length<2&&(e=`0${e}`);let t=ne.floatToByte(this.green).toString(16);t.length<2&&(t=`0${t}`);let i=ne.floatToByte(this.blue).toString(16);if(i.length<2&&(i=`0${i}`),this.alpha<1){let n=ne.floatToByte(this.alpha).toString(16);return n.length<2&&(n=`0${n}`),`#${e}${t}${i}${n}`}return`#${e}${t}${i}`},ne.prototype.toBytes=function(e){let t=ne.floatToByte(this.red),i=ne.floatToByte(this.green),n=ne.floatToByte(this.blue),r=ne.floatToByte(this.alpha);return u(e)?(e[0]=t,e[1]=i,e[2]=n,e[3]=r,e):[t,i,n,r]},ne.prototype.toRgba=function(){return Nm[0]=ne.floatToByte(this.red),Nm[1]=ne.floatToByte(this.green),Nm[2]=ne.floatToByte(this.blue),Nm[3]=ne.floatToByte(this.alpha),V5[0]},ne.prototype.brighten=function(e,t){return e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},ne.prototype.darken=function(e,t){return e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},ne.prototype.withAlpha=function(e,t){return ne.fromAlpha(this,e,t)},ne.add=function(e,t,i){return i.red=e.red+t.red,i.green=e.green+t.green,i.blue=e.blue+t.blue,i.alpha=e.alpha+t.alpha,i},ne.subtract=function(e,t,i){return i.red=e.red-t.red,i.green=e.green-t.green,i.blue=e.blue-t.blue,i.alpha=e.alpha-t.alpha,i},ne.multiply=function(e,t,i){return i.red=e.red*t.red,i.green=e.green*t.green,i.blue=e.blue*t.blue,i.alpha=e.alpha*t.alpha,i},ne.divide=function(e,t,i){return i.red=e.red/t.red,i.green=e.green/t.green,i.blue=e.blue/t.blue,i.alpha=e.alpha/t.alpha,i},ne.mod=function(e,t,i){return i.red=e.red%t.red,i.green=e.green%t.green,i.blue=e.blue%t.blue,i.alpha=e.alpha%t.alpha,i},ne.lerp=function(e,t,i,n){return n.red=P.lerp(e.red,t.red,i),n.green=P.lerp(e.green,t.green,i),n.blue=P.lerp(e.blue,t.blue,i),n.alpha=P.lerp(e.alpha,t.alpha,i),n},ne.multiplyByScalar=function(e,t,i){return i.red=e.red*t,i.green=e.green*t,i.blue=e.blue*t,i.alpha=e.alpha*t,i},ne.divideByScalar=function(e,t,i){return i.red=e.red/t,i.green=e.green/t,i.blue=e.blue/t,i.alpha=e.alpha/t,i},ne.ALICEBLUE=Object.freeze(ne.fromCssColorString("#F0F8FF")),ne.ANTIQUEWHITE=Object.freeze(ne.fromCssColorString("#FAEBD7")),ne.AQUA=Object.freeze(ne.fromCssColorString("#00FFFF")),ne.AQUAMARINE=Object.freeze(ne.fromCssColorString("#7FFFD4")),ne.AZURE=Object.freeze(ne.fromCssColorString("#F0FFFF")),ne.BEIGE=Object.freeze(ne.fromCssColorString("#F5F5DC")),ne.BISQUE=Object.freeze(ne.fromCssColorString("#FFE4C4")),ne.BLACK=Object.freeze(ne.fromCssColorString("#000000")),ne.BLANCHEDALMOND=Object.freeze(ne.fromCssColorString("#FFEBCD")),ne.BLUE=Object.freeze(ne.fromCssColorString("#0000FF")),ne.BLUEVIOLET=Object.freeze(ne.fromCssColorString("#8A2BE2")),ne.BROWN=Object.freeze(ne.fromCssColorString("#A52A2A")),ne.BURLYWOOD=Object.freeze(ne.fromCssColorString("#DEB887")),ne.CADETBLUE=Object.freeze(ne.fromCssColorString("#5F9EA0")),ne.CHARTREUSE=Object.freeze(ne.fromCssColorString("#7FFF00")),ne.CHOCOLATE=Object.freeze(ne.fromCssColorString("#D2691E")),ne.CORAL=Object.freeze(ne.fromCssColorString("#FF7F50")),ne.CORNFLOWERBLUE=Object.freeze(ne.fromCssColorString("#6495ED")),ne.CORNSILK=Object.freeze(ne.fromCssColorString("#FFF8DC")),ne.CRIMSON=Object.freeze(ne.fromCssColorString("#DC143C")),ne.CYAN=Object.freeze(ne.fromCssColorString("#00FFFF")),ne.DARKBLUE=Object.freeze(ne.fromCssColorString("#00008B")),ne.DARKCYAN=Object.freeze(ne.fromCssColorString("#008B8B")),ne.DARKGOLDENROD=Object.freeze(ne.fromCssColorString("#B8860B")),ne.DARKGRAY=Object.freeze(ne.fromCssColorString("#A9A9A9")),ne.DARKGREEN=Object.freeze(ne.fromCssColorString("#006400")),ne.DARKGREY=ne.DARKGRAY,ne.DARKKHAKI=Object.freeze(ne.fromCssColorString("#BDB76B")),ne.DARKMAGENTA=Object.freeze(ne.fromCssColorString("#8B008B")),ne.DARKOLIVEGREEN=Object.freeze(ne.fromCssColorString("#556B2F")),ne.DARKORANGE=Object.freeze(ne.fromCssColorString("#FF8C00")),ne.DARKORCHID=Object.freeze(ne.fromCssColorString("#9932CC")),ne.DARKRED=Object.freeze(ne.fromCssColorString("#8B0000")),ne.DARKSALMON=Object.freeze(ne.fromCssColorString("#E9967A")),ne.DARKSEAGREEN=Object.freeze(ne.fromCssColorString("#8FBC8F")),ne.DARKSLATEBLUE=Object.freeze(ne.fromCssColorString("#483D8B")),ne.DARKSLATEGRAY=Object.freeze(ne.fromCssColorString("#2F4F4F")),ne.DARKSLATEGREY=ne.DARKSLATEGRAY,ne.DARKTURQUOISE=Object.freeze(ne.fromCssColorString("#00CED1")),ne.DARKVIOLET=Object.freeze(ne.fromCssColorString("#9400D3")),ne.DEEPPINK=Object.freeze(ne.fromCssColorString("#FF1493")),ne.DEEPSKYBLUE=Object.freeze(ne.fromCssColorString("#00BFFF")),ne.DIMGRAY=Object.freeze(ne.fromCssColorString("#696969")),ne.DIMGREY=ne.DIMGRAY,ne.DODGERBLUE=Object.freeze(ne.fromCssColorString("#1E90FF")),ne.FIREBRICK=Object.freeze(ne.fromCssColorString("#B22222")),ne.FLORALWHITE=Object.freeze(ne.fromCssColorString("#FFFAF0")),ne.FORESTGREEN=Object.freeze(ne.fromCssColorString("#228B22")),ne.FUCHSIA=Object.freeze(ne.fromCssColorString("#FF00FF")),ne.GAINSBORO=Object.freeze(ne.fromCssColorString("#DCDCDC")),ne.GHOSTWHITE=Object.freeze(ne.fromCssColorString("#F8F8FF")),ne.GOLD=Object.freeze(ne.fromCssColorString("#FFD700")),ne.GOLDENROD=Object.freeze(ne.fromCssColorString("#DAA520")),ne.GRAY=Object.freeze(ne.fromCssColorString("#808080")),ne.GREEN=Object.freeze(ne.fromCssColorString("#008000")),ne.GREENYELLOW=Object.freeze(ne.fromCssColorString("#ADFF2F")),ne.GREY=ne.GRAY,ne.HONEYDEW=Object.freeze(ne.fromCssColorString("#F0FFF0")),ne.HOTPINK=Object.freeze(ne.fromCssColorString("#FF69B4")),ne.INDIANRED=Object.freeze(ne.fromCssColorString("#CD5C5C")),ne.INDIGO=Object.freeze(ne.fromCssColorString("#4B0082")),ne.IVORY=Object.freeze(ne.fromCssColorString("#FFFFF0")),ne.KHAKI=Object.freeze(ne.fromCssColorString("#F0E68C")),ne.LAVENDER=Object.freeze(ne.fromCssColorString("#E6E6FA")),ne.LAVENDAR_BLUSH=Object.freeze(ne.fromCssColorString("#FFF0F5")),ne.LAWNGREEN=Object.freeze(ne.fromCssColorString("#7CFC00")),ne.LEMONCHIFFON=Object.freeze(ne.fromCssColorString("#FFFACD")),ne.LIGHTBLUE=Object.freeze(ne.fromCssColorString("#ADD8E6")),ne.LIGHTCORAL=Object.freeze(ne.fromCssColorString("#F08080")),ne.LIGHTCYAN=Object.freeze(ne.fromCssColorString("#E0FFFF")),ne.LIGHTGOLDENRODYELLOW=Object.freeze(ne.fromCssColorString("#FAFAD2")),ne.LIGHTGRAY=Object.freeze(ne.fromCssColorString("#D3D3D3")),ne.LIGHTGREEN=Object.freeze(ne.fromCssColorString("#90EE90")),ne.LIGHTGREY=ne.LIGHTGRAY,ne.LIGHTPINK=Object.freeze(ne.fromCssColorString("#FFB6C1")),ne.LIGHTSEAGREEN=Object.freeze(ne.fromCssColorString("#20B2AA")),ne.LIGHTSKYBLUE=Object.freeze(ne.fromCssColorString("#87CEFA")),ne.LIGHTSLATEGRAY=Object.freeze(ne.fromCssColorString("#778899")),ne.LIGHTSLATEGREY=ne.LIGHTSLATEGRAY,ne.LIGHTSTEELBLUE=Object.freeze(ne.fromCssColorString("#B0C4DE")),ne.LIGHTYELLOW=Object.freeze(ne.fromCssColorString("#FFFFE0")),ne.LIME=Object.freeze(ne.fromCssColorString("#00FF00")),ne.LIMEGREEN=Object.freeze(ne.fromCssColorString("#32CD32")),ne.LINEN=Object.freeze(ne.fromCssColorString("#FAF0E6")),ne.MAGENTA=Object.freeze(ne.fromCssColorString("#FF00FF")),ne.MAROON=Object.freeze(ne.fromCssColorString("#800000")),ne.MEDIUMAQUAMARINE=Object.freeze(ne.fromCssColorString("#66CDAA")),ne.MEDIUMBLUE=Object.freeze(ne.fromCssColorString("#0000CD")),ne.MEDIUMORCHID=Object.freeze(ne.fromCssColorString("#BA55D3")),ne.MEDIUMPURPLE=Object.freeze(ne.fromCssColorString("#9370DB")),ne.MEDIUMSEAGREEN=Object.freeze(ne.fromCssColorString("#3CB371")),ne.MEDIUMSLATEBLUE=Object.freeze(ne.fromCssColorString("#7B68EE")),ne.MEDIUMSPRINGGREEN=Object.freeze(ne.fromCssColorString("#00FA9A")),ne.MEDIUMTURQUOISE=Object.freeze(ne.fromCssColorString("#48D1CC")),ne.MEDIUMVIOLETRED=Object.freeze(ne.fromCssColorString("#C71585")),ne.MIDNIGHTBLUE=Object.freeze(ne.fromCssColorString("#191970")),ne.MINTCREAM=Object.freeze(ne.fromCssColorString("#F5FFFA")),ne.MISTYROSE=Object.freeze(ne.fromCssColorString("#FFE4E1")),ne.MOCCASIN=Object.freeze(ne.fromCssColorString("#FFE4B5")),ne.NAVAJOWHITE=Object.freeze(ne.fromCssColorString("#FFDEAD")),ne.NAVY=Object.freeze(ne.fromCssColorString("#000080")),ne.OLDLACE=Object.freeze(ne.fromCssColorString("#FDF5E6")),ne.OLIVE=Object.freeze(ne.fromCssColorString("#808000")),ne.OLIVEDRAB=Object.freeze(ne.fromCssColorString("#6B8E23")),ne.ORANGE=Object.freeze(ne.fromCssColorString("#FFA500")),ne.ORANGERED=Object.freeze(ne.fromCssColorString("#FF4500")),ne.ORCHID=Object.freeze(ne.fromCssColorString("#DA70D6")),ne.PALEGOLDENROD=Object.freeze(ne.fromCssColorString("#EEE8AA")),ne.PALEGREEN=Object.freeze(ne.fromCssColorString("#98FB98")),ne.PALETURQUOISE=Object.freeze(ne.fromCssColorString("#AFEEEE")),ne.PALEVIOLETRED=Object.freeze(ne.fromCssColorString("#DB7093")),ne.PAPAYAWHIP=Object.freeze(ne.fromCssColorString("#FFEFD5")),ne.PEACHPUFF=Object.freeze(ne.fromCssColorString("#FFDAB9")),ne.PERU=Object.freeze(ne.fromCssColorString("#CD853F")),ne.PINK=Object.freeze(ne.fromCssColorString("#FFC0CB")),ne.PLUM=Object.freeze(ne.fromCssColorString("#DDA0DD")),ne.POWDERBLUE=Object.freeze(ne.fromCssColorString("#B0E0E6")),ne.PURPLE=Object.freeze(ne.fromCssColorString("#800080")),ne.RED=Object.freeze(ne.fromCssColorString("#FF0000")),ne.ROSYBROWN=Object.freeze(ne.fromCssColorString("#BC8F8F")),ne.ROYALBLUE=Object.freeze(ne.fromCssColorString("#4169E1")),ne.SADDLEBROWN=Object.freeze(ne.fromCssColorString("#8B4513")),ne.SALMON=Object.freeze(ne.fromCssColorString("#FA8072")),ne.SANDYBROWN=Object.freeze(ne.fromCssColorString("#F4A460")),ne.SEAGREEN=Object.freeze(ne.fromCssColorString("#2E8B57")),ne.SEASHELL=Object.freeze(ne.fromCssColorString("#FFF5EE")),ne.SIENNA=Object.freeze(ne.fromCssColorString("#A0522D")),ne.SILVER=Object.freeze(ne.fromCssColorString("#C0C0C0")),ne.SKYBLUE=Object.freeze(ne.fromCssColorString("#87CEEB")),ne.SLATEBLUE=Object.freeze(ne.fromCssColorString("#6A5ACD")),ne.SLATEGRAY=Object.freeze(ne.fromCssColorString("#708090")),ne.SLATEGREY=ne.SLATEGRAY,ne.SNOW=Object.freeze(ne.fromCssColorString("#FFFAFA")),ne.SPRINGGREEN=Object.freeze(ne.fromCssColorString("#00FF7F")),ne.STEELBLUE=Object.freeze(ne.fromCssColorString("#4682B4")),ne.TAN=Object.freeze(ne.fromCssColorString("#D2B48C")),ne.TEAL=Object.freeze(ne.fromCssColorString("#008080")),ne.THISTLE=Object.freeze(ne.fromCssColorString("#D8BFD8")),ne.TOMATO=Object.freeze(ne.fromCssColorString("#FF6347")),ne.TURQUOISE=Object.freeze(ne.fromCssColorString("#40E0D0")),ne.VIOLET=Object.freeze(ne.fromCssColorString("#EE82EE")),ne.WHEAT=Object.freeze(ne.fromCssColorString("#F5DEB3")),ne.WHITE=Object.freeze(ne.fromCssColorString("#FFFFFF")),ne.WHITESMOKE=Object.freeze(ne.fromCssColorString("#F5F5F5")),ne.YELLOW=Object.freeze(ne.fromCssColorString("#FFFF00")),ne.YELLOWGREEN=Object.freeze(ne.fromCssColorString("#9ACD32")),ne.TRANSPARENT=Object.freeze(new ne(0,0,0,0));var z=ne;function eT(e,t,i,n){e=y(e,1),t=y(t,1),i=y(i,1),n=y(n,1),this.value=new Uint8Array([z.floatToByte(e),z.floatToByte(t),z.floatToByte(i),z.floatToByte(n)])}Object.defineProperties(eT.prototype,{componentDatatype:{get:function(){return X.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}}),eT.fromColor=function(e){return new eT(e.red,e.green,e.blue,e.alpha)},eT.toValue=function(e,t){return u(t)?e.toBytes(t):new Uint8Array(e.toBytes())},eT.equals=function(e,t){return e===t||u(e)&&u(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};var kt=eT;function tT(e,t,i,n,r){this._format=e,this._datatype=t,this._width=i,this._height=n,this._buffer=r}Object.defineProperties(tT.prototype,{internalFormat:{get:function(){return this._format}},pixelDatatype:{get:function(){return this._datatype}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}}),tT.clone=function(e){if(u(e))return new tT(e._format,e._datatype,e._width,e._height,e._buffer)},tT.prototype.clone=function(){return tT.clone(this)};var u1=tT;function nT(e){this._value=e,this._valueType=eo.getPointType(e)}Object.defineProperties(nT.prototype,{value:{get:function(){return this._value}}}),nT.prototype.findTimeInterval=function(e){},nT.prototype.wrapTime=function(e){return 0},nT.prototype.clampTime=function(e){return 0},nT.prototype.evaluate=function(e,t){let i=this._value,n=this._valueType;return n===Number?i:n.clone(i,t)};var f1=nT,fS={},gve=new h,eQ=new h,tQ=new h,nQ=new h,iQ=new Pn;function oQ(e,t,i,n,r){let o=h.subtract(e,t,gve),a=h.dot(i,o),s=h.dot(n,o);return U.fromElements(a,s,r)}fS.validOutline=function(e){let t=Pn.fromPoints(e,iQ).halfAxes,i=$.getColumn(t,0,eQ),n=$.getColumn(t,1,tQ),r=$.getColumn(t,2,nQ),o=h.magnitude(i),a=h.magnitude(n),s=h.magnitude(r);return!(0===o&&(0===a||0===s)||0===a&&0===s)},fS.computeProjectTo2DArguments=function(e,t,i,n){let r,o,a=Pn.fromPoints(e,iQ),s=a.halfAxes,l=$.getColumn(s,0,eQ),u=$.getColumn(s,1,tQ),c=$.getColumn(s,2,nQ),d=h.magnitude(l),p=h.magnitude(u),f=h.magnitude(c),m=Math.min(d,p,f);return(0!==d||0!==p&&0!==f)&&(0!==p||0!==f)&&((m===p||m===f)&&(r=l),m===d?r=u:m===f&&(o=u),(m===d||m===p)&&(o=c),h.normalize(r,i),h.normalize(o,n),h.clone(a.center,t),!0)},fS.createProjectPointsTo2DFunction=function(e,t,i){return function(n){let r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=oQ(n[o],e,t,i);return r}},fS.createProjectPointTo2DFunction=function(e,t,i){return function(n,r){return oQ(n,e,t,i,r)}};var x_=fS;function z5(e,t,i){if(0===e)return t*i;let n=e*e,r=n*n,o=r*n,a=o*n,s=a*n,l=s*n,u=i;return t*((1-n/4-3*r/64-5*o/256-175*a/16384-441*s/65536-4851*l/1048576)*u-(3*n/8+3*r/32+45*o/1024+105*a/4096+2205*s/131072+6237*l/524288)*Math.sin(2*u)+(15*r/256+45*o/1024+525*a/16384+1575*s/65536+155925*l/8388608)*Math.sin(4*u)-(35*o/3072+175*a/12288+3675*s/262144+13475*l/1048576)*Math.sin(6*u)+(315*a/131072+2205*s/524288+43659*l/8388608)*Math.sin(8*u)-(693*s/1310720+6237*l/5242880)*Math.sin(10*u)+1001*l/8388608*Math.sin(12*u))}function yve(e,t,i){let n=e/i;if(0===t)return n;let r=n*n,o=r*n,a=o*n,s=t*t,l=s*s,u=l*s,c=u*s,h=c*s,d=h*s,p=Math.sin(2*n),f=Math.cos(2*n),m=Math.sin(4*n),_=Math.cos(4*n),g=Math.sin(6*n),y=Math.cos(6*n),v=Math.sin(8*n),b=Math.cos(8*n),A=Math.sin(10*n);return n+n*s/4+7*n*l/64+15*n*u/256+579*n*c/16384+1515*n*h/65536+16837*n*d/1048576+(3*n*l/16+45*n*u/256-n*(32*r-561)*c/4096-n*(232*r-1677)*h/16384+n*(399985-90560*r+512*a)*d/5242880)*f+(21*n*u/256+483*n*c/4096-n*(224*r-1969)*h/16384-n*(33152*r-112599)*d/1048576)*_+(151*n*c/4096+4681*n*h/65536+1479*n*d/16384-453*o*d/32768)*y+(1097*n*h/65536+42783*n*d/1048576)*b+8011*n*d/1048576*Math.cos(10*n)+(3*s/8+3*l/16+213*u/2048-3*r*u/64+255*c/4096-33*r*c/512+20861*h/524288-33*r*h/512+a*h/1024+28273*d/1048576-471*r*d/8192+9*a*d/4096)*p+(21*l/256+21*u/256+533*c/8192-21*r*c/512+197*h/4096-315*r*h/4096+584039*d/16777216-12517*r*d/131072+7*a*d/2048)*m+(151*u/6144+151*c/4096+5019*h/131072-453*r*h/16384+26965*d/786432-8607*r*d/131072)*g+(1097*c/131072+1097*h/65536+225797*d/10485760-1097*r*d/65536)*v+(8011*h/2621440+8011*d/1048576)*A+293393*d/251658240*Math.sin(12*n)}function iT(e,t){if(0===e)return Math.log(Math.tan(.5*(P.PI_OVER_TWO+t)));let i=e*Math.sin(t);return Math.log(Math.tan(.5*(P.PI_OVER_TWO+t)))-e/2*Math.log((1+i)/(1-i))}function xve(e,t,i,n,r){let o=iT(e._ellipticity,i),a=iT(e._ellipticity,r);return Math.atan2(P.negativePiToPi(n-t),a-o)}function bve(e,t,i,n,r,o,a){let s=e._heading,l=o-n,u=0;if(P.equalsEpsilon(Math.abs(s),P.PI_OVER_TWO,P.EPSILON8))if(t===i)u=t*Math.cos(r)*P.negativePiToPi(l);else{let i=Math.sin(r);u=t*Math.cos(r)*P.negativePiToPi(l)/Math.sqrt(1-e._ellipticitySquared*i*i)}else{let i=z5(e._ellipticity,t,r);u=(z5(e._ellipticity,t,a)-i)/Math.cos(s)}return Math.abs(u)}var Tve=new h,U5=new h;function rQ(e,t,i,n){h.normalize(n.cartographicToCartesian(t,U5),Tve),h.normalize(n.cartographicToCartesian(i,U5),U5);let r=n.maximumRadius,o=n.minimumRadius,a=r*r,s=o*o;e._ellipticitySquared=(a-s)/a,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=fe.clone(t,e._start),e._start.height=0,e._end=fe.clone(i,e._end),e._end.height=0,e._heading=xve(e,t.longitude,t.latitude,i.longitude,i.latitude),e._distance=bve(e,n.maximumRadius,n.minimumRadius,t.longitude,t.latitude,i.longitude,i.latitude)}function sQ(e,t,i,n,r,o){if(0===i)return fe.clone(e,o);let a,s,l,c=r*r;if(Math.abs(P.PI_OVER_TWO-Math.abs(t))>P.EPSILON8){if(s=yve(z5(r,n,e.latitude)+i*Math.cos(t),r,n),Math.abs(t)<P.EPSILON10)a=P.negativePiToPi(e.longitude);else{let i=iT(r,e.latitude),n=iT(r,s);l=Math.tan(t)*(n-i),a=P.negativePiToPi(e.longitude+l)}}else{let o;if(s=e.latitude,0===r)o=n*Math.cos(e.latitude);else{let t=Math.sin(e.latitude);o=n*Math.cos(e.latitude)/Math.sqrt(1-c*t*t)}l=i/o,a=t>0?P.negativePiToPi(e.longitude+l):P.negativePiToPi(e.longitude-l)}return u(o)?(o.longitude=a,o.latitude=s,o.height=0,o):new fe(a,s,0)}function Fm(e,t,i){let n=y(i,ie.WGS84);this._ellipsoid=n,this._start=new fe,this._end=new fe,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,u(e)&&u(t)&&rQ(this,e,t,n)}Object.defineProperties(Fm.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return this._heading}}}),Fm.fromStartHeadingDistance=function(e,t,i,n,r){let o=y(n,ie.WGS84),a=o.maximumRadius,s=o.minimumRadius,l=a*a,c=s*s,h=Math.sqrt((l-c)/l),d=sQ(e,t=P.negativePiToPi(t),i,o.maximumRadius,h);return!u(r)||u(n)&&!n.equals(r.ellipsoid)?new Fm(e,d,o):(r.setEndPoints(e,d),r)},Fm.prototype.setEndPoints=function(e,t){rQ(this,e,t,this._ellipsoid)},Fm.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)},Fm.prototype.interpolateUsingSurfaceDistance=function(e,t){return sQ(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)},Fm.prototype.findIntersectionWithLongitude=function(e,t){let i=this._ellipticity,n=this._heading,r=Math.abs(n),o=this._start;if(e=P.negativePiToPi(e),P.equalsEpsilon(Math.abs(e),Math.PI,P.EPSILON14)&&(e=P.sign(o.longitude)*Math.PI),u(t)||(t=new fe),Math.abs(P.PI_OVER_TWO-r)<=P.EPSILON8)return t.longitude=e,t.latitude=o.latitude,t.height=0,t;if(P.equalsEpsilon(Math.abs(P.PI_OVER_TWO-r),P.PI_OVER_TWO,P.EPSILON8))return P.equalsEpsilon(e,o.longitude,P.EPSILON12)?void 0:(t.longitude=e,t.latitude=P.PI_OVER_TWO*P.sign(P.PI_OVER_TWO-n),t.height=0,t);let a,s=o.latitude,l=i*Math.sin(s),c=Math.tan(.5*(P.PI_OVER_TWO+s))*Math.exp((e-o.longitude)/Math.tan(n)),h=(1+l)/(1-l),d=o.latitude;do{a=d;let e=i*Math.sin(a),t=(1+e)/(1-e);d=2*Math.atan(c*Math.pow(t/h,i/2))-P.PI_OVER_TWO}while(!P.equalsEpsilon(d,a,P.EPSILON12));return t.longitude=e,t.latitude=d,t.height=0,t},Fm.prototype.findIntersectionWithLatitude=function(e,t){let i=this._ellipticity,n=this._heading,r=this._start;if(P.equalsEpsilon(Math.abs(n),P.PI_OVER_TWO,P.EPSILON8))return;let o=iT(i,r.latitude),a=iT(i,e),s=Math.tan(n)*(a-o),l=P.negativePiToPi(r.longitude+s);return u(t)?(t.longitude=l,t.latitude=e,t.height=0,t):new fe(l,e,0)};var Ia=Fm;function Ave(e,t){this.positions=u(e)?e:[],this.holes=u(t)?t:[]}var Pa=Ave,pQ=or(fQ(),1),_1={CLOCKWISE:ee.CW,COUNTER_CLOCKWISE:ee.CCW,validate:function(e){return e===_1.CLOCKWISE||e===_1.COUNTER_CLOCKWISE}},ts=Object.freeze(_1),kve=new h,Vve=new h,b_={computeArea2D:function(e){let t=e.length,i=0;for(let n=t-1,r=0;r<t;n=r++){let t=e[n],o=e[r];i+=t.x*o.y-o.x*t.y}return.5*i},computeWindingOrder2D:function(e){return b_.computeArea2D(e)>0?ts.COUNTER_CLOCKWISE:ts.CLOCKWISE},triangulate:function(e,t){let i=U.packArray(e);return(0,pQ.default)(i,t,2)}},_Q=new h,gQ=new h,yQ=new h,dQ=new h,hQ=new h,mQ=new h,Bm=new h,xQ=new U,bQ=new U,TQ=new U,rT=new U;b_.computeSubdivision=function(e,t,i,n,r){r=y(r,P.RADIANS_PER_DEGREE);let o,a=u(n),s=i.slice(0),l=t.length,c=new Array(3*l),d=new Array(2*l),p=0,f=0;for(o=0;o<l;o++){let e=t[o];if(c[p++]=e.x,c[p++]=e.y,c[p++]=e.z,a){let e=n[o];d[f++]=e.x,d[f++]=e.y}}let m=[],_={},g=e.maximumRadius,v=P.chordLength(r,g),b=v*v;for(;s.length>0;){let e,t,i,n=s.pop(),r=s.pop(),l=s.pop(),p=h.fromArray(c,3*l,_Q),f=h.fromArray(c,3*r,gQ),y=h.fromArray(c,3*n,yQ);a&&(e=U.fromArray(d,2*l,xQ),t=U.fromArray(d,2*r,bQ),i=U.fromArray(d,2*n,TQ));let v,A,T,E=h.multiplyByScalar(h.normalize(p,dQ),g,dQ),C=h.multiplyByScalar(h.normalize(f,hQ),g,hQ),x=h.multiplyByScalar(h.normalize(y,mQ),g,mQ),S=h.magnitudeSquared(h.subtract(E,C,Bm)),w=h.magnitudeSquared(h.subtract(C,x,Bm)),I=h.magnitudeSquared(h.subtract(x,E,Bm)),P=Math.max(S,w,I);P>b?S===P?(v=`${Math.min(l,r)} ${Math.max(l,r)}`,o=_[v],u(o)||(A=h.add(p,f,Bm),h.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),o=c.length/3-1,_[v]=o,a&&(T=U.add(e,t,rT),U.multiplyByScalar(T,.5,T),d.push(T.x,T.y))),s.push(l,o,n),s.push(o,r,n)):w===P?(v=`${Math.min(r,n)} ${Math.max(r,n)}`,o=_[v],u(o)||(A=h.add(f,y,Bm),h.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),o=c.length/3-1,_[v]=o,a&&(T=U.add(t,i,rT),U.multiplyByScalar(T,.5,T),d.push(T.x,T.y))),s.push(r,o,l),s.push(o,n,l)):I===P&&(v=`${Math.min(n,l)} ${Math.max(n,l)}`,o=_[v],u(o)||(A=h.add(y,p,Bm),h.multiplyByScalar(A,.5,A),c.push(A.x,A.y,A.z),o=c.length/3-1,_[v]=o,a&&(T=U.add(i,e,rT),U.multiplyByScalar(T,.5,T),d.push(T.x,T.y))),s.push(n,o,r),s.push(o,l,r)):(m.push(l),m.push(r),m.push(n))}let A={attributes:{position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:c})},indices:m,primitiveType:Ne.TRIANGLES};return a&&(A.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:d})),new ct(A)};var Uve=new fe,zve=new fe,Hve=new fe,q5=new fe;b_.computeRhumbLineSubdivision=function(e,t,i,n,r){r=y(r,P.RADIANS_PER_DEGREE);let o,a=u(n),s=i.slice(0),l=t.length,c=new Array(3*l),d=new Array(2*l),p=0,f=0;for(o=0;o<l;o++){let e=t[o];if(c[p++]=e.x,c[p++]=e.y,c[p++]=e.z,a){let e=n[o];d[f++]=e.x,d[f++]=e.y}}let m=[],_={},g=e.maximumRadius,v=P.chordLength(r,g),b=new Ia(void 0,void 0,e),A=new Ia(void 0,void 0,e),T=new Ia(void 0,void 0,e);for(;s.length>0;){let t,i,n,r=s.pop(),l=s.pop(),p=s.pop(),f=h.fromArray(c,3*p,_Q),g=h.fromArray(c,3*l,gQ),y=h.fromArray(c,3*r,yQ);a&&(t=U.fromArray(d,2*p,xQ),i=U.fromArray(d,2*l,bQ),n=U.fromArray(d,2*r,TQ));let E=e.cartesianToCartographic(f,Uve),C=e.cartesianToCartographic(g,zve),x=e.cartesianToCartographic(y,Hve);b.setEndPoints(E,C);let S=b.surfaceDistance;A.setEndPoints(C,x);let w=A.surfaceDistance;T.setEndPoints(x,E);let I,P,D,O,L,R=T.surfaceDistance,N=Math.max(S,w,R);N>v?S===N?(I=`${Math.min(p,l)} ${Math.max(p,l)}`,o=_[I],u(o)||(P=b.interpolateUsingFraction(.5,q5),D=.5*(E.height+C.height),O=h.fromRadians(P.longitude,P.latitude,D,e,Bm),c.push(O.x,O.y,O.z),o=c.length/3-1,_[I]=o,a&&(L=U.add(t,i,rT),U.multiplyByScalar(L,.5,L),d.push(L.x,L.y))),s.push(p,o,r),s.push(o,l,r)):w===N?(I=`${Math.min(l,r)} ${Math.max(l,r)}`,o=_[I],u(o)||(P=A.interpolateUsingFraction(.5,q5),D=.5*(C.height+x.height),O=h.fromRadians(P.longitude,P.latitude,D,e,Bm),c.push(O.x,O.y,O.z),o=c.length/3-1,_[I]=o,a&&(L=U.add(i,n,rT),U.multiplyByScalar(L,.5,L),d.push(L.x,L.y))),s.push(l,o,p),s.push(o,r,p)):R===N&&(I=`${Math.min(r,p)} ${Math.max(r,p)}`,o=_[I],u(o)||(P=T.interpolateUsingFraction(.5,q5),D=.5*(x.height+E.height),O=h.fromRadians(P.longitude,P.latitude,D,e,Bm),c.push(O.x,O.y,O.z),o=c.length/3-1,_[I]=o,a&&(L=U.add(n,t,rT),U.multiplyByScalar(L,.5,L),d.push(L.x,L.y))),s.push(r,o,l),s.push(o,p,l)):(m.push(p),m.push(l),m.push(r))}let E={attributes:{position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:c})},indices:m,primitiveType:Ne.TRIANGLES};return a&&(E.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:d})),new ct(E)},b_.scaleToGeodeticHeight=function(e,t,i,n){i=y(i,ie.WGS84);let r=kve,o=Vve;if(t=y(t,0),n=y(n,!0),u(e)){let a=e.length;for(let s=0;s<a;s+=3)h.fromArray(e,s,o),n&&(o=i.scaleToGeodeticSurface(o,o)),0!==t&&(r=i.geodeticSurfaceNormal(o,r),h.multiplyByScalar(r,t,r),h.add(o,r,o)),e[s]=o.x,e[s+1]=o.y,e[s+2]=o.z}return e};var ei=b_;function T_(){this._array=[],this._offset=0,this._length=0}Object.defineProperties(T_.prototype,{length:{get:function(){return this._length}}}),T_.prototype.enqueue=function(e){this._array.push(e),this._length++},T_.prototype.dequeue=function(){if(0===this._length)return;let e=this._array,t=this._offset,i=e[t];return e[t]=void 0,t++,t>10&&2*t>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,i},T_.prototype.peek=function(){if(0!==this._length)return this._array[this._offset]},T_.prototype.contains=function(e){return-1!==this._array.indexOf(e)},T_.prototype.clear=function(){this._array.length=this._offset=this._length=0},T_.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)};var f0=T_,Fo={computeHierarchyPackedLength:function(e,t){let i=0,n=[e];for(;n.length>0;){let e=n.pop();if(!u(e))continue;i+=2;let r=e.positions,o=e.holes;if(u(r)&&r.length>0&&(i+=r.length*t.packedLength),u(o)){let e=o.length;for(let t=0;t<e;++t)n.push(o[t])}}return i},packPolygonHierarchy:function(e,t,i,n){let r=[e];for(;r.length>0;){let e=r.pop();if(!u(e))continue;let o=e.positions,a=e.holes;if(t[i++]=u(o)?o.length:0,t[i++]=u(a)?a.length:0,u(o)){let e=o.length;for(let r=0;r<e;++r,i+=n.packedLength)n.pack(o[r],t,i)}if(u(a)){let e=a.length;for(let t=0;t<e;++t)r.push(a[t])}}return i},unpackPolygonHierarchy:function(e,t,i){let n=e[t++],r=e[t++],o=new Array(n),a=r>0?new Array(r):void 0;for(let r=0;r<n;++r,t+=i.packedLength)o[r]=i.unpack(e,t);for(let n=0;n<r;++n)a[n]=Fo.unpackPolygonHierarchy(e,t,i),t=a[n].startingIndex,delete a[n].startingIndex;return{positions:o,holes:a,startingIndex:t}}},d0=new U;function EQ(e,t,i,n){return U.subtract(t,e,d0),U.multiplyByScalar(d0,i/n,d0),U.add(e,d0,d0),[d0.x,d0.y]}var A_=new h;function Gve(e,t,i,n){return h.subtract(t,e,A_),h.multiplyByScalar(A_,i/n,A_),h.add(e,A_,A_),[A_.x,A_.y,A_.z]}Fo.subdivideLineCount=function(e,t,i){let n=h.distance(e,t)/i,r=Math.max(0,Math.ceil(P.log2(n)));return Math.pow(2,r)};var y1=new fe,x1=new fe,Wve=new fe,jve=new h,g1=new Ia;Fo.subdivideRhumbLineCount=function(e,t,i,n){let r=e.cartesianToCartographic(t,y1),o=e.cartesianToCartographic(i,x1),a=new Ia(r,o,e).surfaceDistance/n,s=Math.max(0,Math.ceil(P.log2(a)));return Math.pow(2,s)},Fo.subdivideTexcoordLine=function(e,t,i,n,r,o){let a=Fo.subdivideLineCount(i,n,r),s=U.distance(e,t),l=s/a,u=o;u.length=2*a;let c=0;for(let i=0;i<a;i++){let n=EQ(e,t,i*l,s);u[c++]=n[0],u[c++]=n[1]}return u},Fo.subdivideLine=function(e,t,i,n){let r=Fo.subdivideLineCount(e,t,i),o=h.distance(e,t),a=o/r;u(n)||(n=[]);let s=n;s.length=3*r;let l=0;for(let i=0;i<r;i++){let n=Gve(e,t,i*a,o);s[l++]=n[0],s[l++]=n[1],s[l++]=n[2]}return s},Fo.subdivideTexcoordRhumbLine=function(e,t,i,n,r,o,a){let s=i.cartesianToCartographic(n,y1),l=i.cartesianToCartographic(r,x1);g1.setEndPoints(s,l);let u=g1.surfaceDistance/o,c=Math.max(0,Math.ceil(P.log2(u))),h=Math.pow(2,c),d=U.distance(e,t),p=d/h,f=a;f.length=2*h;let m=0;for(let i=0;i<h;i++){let n=EQ(e,t,i*p,d);f[m++]=n[0],f[m++]=n[1]}return f},Fo.subdivideRhumbLine=function(e,t,i,n,r){let o=e.cartesianToCartographic(t,y1),a=e.cartesianToCartographic(i,x1),s=new Ia(o,a,e),l=s.surfaceDistance/n,c=Math.max(0,Math.ceil(P.log2(l))),h=Math.pow(2,c),d=s.surfaceDistance/h;u(r)||(r=[]);let p=r;p.length=3*h;let f=0;for(let t=0;t<h;t++){let i=s.interpolateUsingSurfaceDistance(t*d,Wve),n=e.cartographicToCartesian(i,jve);p[f++]=n.x,p[f++]=n.y,p[f++]=n.z}return p};var qve=new h,Yve=new h,Xve=new h,Kve=new h;Fo.scaleToGeodeticHeightExtruded=function(e,t,i,n,r){n=y(n,ie.WGS84);let o=qve,a=Yve,s=Xve,l=Kve;if(u(e)&&u(e.attributes)&&u(e.attributes.position)){let u=e.attributes.position.values,c=u.length/2;for(let e=0;e<c;e+=3)h.fromArray(u,e,s),n.geodeticSurfaceNormal(s,o),l=n.scaleToGeodeticSurface(s,l),a=h.multiplyByScalar(o,i,a),a=h.add(l,a,a),u[e+c]=a.x,u[e+1+c]=a.y,u[e+2+c]=a.z,r&&(l=h.clone(s,l)),a=h.multiplyByScalar(o,t,a),a=h.add(l,a,a),u[e]=a.x,u[e+1]=a.y,u[e+2]=a.z}return e},Fo.polygonOutlinesFromHierarchy=function(e,t,i){let n,r,o,a=[],s=new f0;for(s.enqueue(e);0!==s.length;){let e=s.dequeue(),l=e.positions;if(t)for(o=l.length,n=0;n<o;n++)i.scaleToGeodeticSurface(l[n],l[n]);if(l=go(l,h.equalsEpsilon,!0),l.length<3)continue;let c=e.holes?e.holes.length:0;for(n=0;n<c;n++){let l=e.holes[n],c=l.positions;if(t)for(o=c.length,r=0;r<o;++r)i.scaleToGeodeticSurface(c[r],c[r]);if(c=go(c,h.equalsEpsilon,!0),c.length<3)continue;a.push(c);let d=0;for(u(l.holes)&&(d=l.holes.length),r=0;r<d;r++)s.enqueue(l.holes[r])}a.push(l)}return a};var Zve=new fe;function $ve(e,t,i){let n=i.cartesianToCartographic(e,y1),r=i.cartesianToCartographic(t,x1);if(Math.sign(n.latitude)===Math.sign(r.latitude))return;g1.setEndPoints(n,r);let o=g1.findIntersectionWithLatitude(0,Zve);if(!u(o))return;let a=Math.min(n.longitude,r.longitude),s=Math.max(n.longitude,r.longitude);if(Math.abs(s-a)>P.PI){let e=a;a=s,s=e}return o.longitude<a||o.longitude>s?void 0:i.cartographicToCartesian(o)}function Qve(e,t,i,n){if(n===Yt.RHUMB)return $ve(e,t,i);let r=Ai.lineSegmentPlane(e,t,tn.ORIGIN_XY_PLANE);return u(r)?i.scaleToGeodeticSurface(r,r):void 0}var Jve=new fe;function eDe(e,t,i){let n,r,o,a,s,l=[],c=0;for(;c<e.length;){n=e[c],r=e[(c+1)%e.length],o=P.sign(n.z),a=P.sign(r.z);let h=e=>t.cartesianToCartographic(e,Jve).longitude;if(0===o)l.push({position:c,type:o,visited:!1,next:a,theta:h(n)});else if(0!==a){if(s=Qve(n,r,t,i),++c,!u(s))continue;e.splice(c,0,s),l.push({position:c,type:o,visited:!1,next:a,theta:h(s)})}++c}return l}function SQ(e,t,i,n,r,o,a){let s=[],l=o,c=e=>t=>t.position===e,h=[];do{let e=i[l];s.push(e);let t=n.findIndex(c(l)),r=n[t];if(!u(r)){++l;continue}let{visited:d,type:p,next:f}=r;if(r.visited=!0,0===p){if(0===f){let e=n[t-(a?1:-1)];if(e?.position!==l+1){++l;continue}e.visited=!0}if(!d&&a&&f>0||o===l&&!a&&f<0){++l;continue}}if(!(a?p>=0:p<=0)){++l;continue}d||h.push(l);let m=n[t+(a?1:-1)];u(m)?l=m.position:++l}while(l<i.length&&l>=0&&l!==o&&s.length<i.length);e.splice(t,r,s);for(let r of h)t=SQ(e,++t,i,n,0,r,!a);return t}Fo.splitPolygonsOnEquator=function(e,t,i,n){u(n)||(n=[]),n.splice(0,0,...e),n.length=e.length;let r=0;for(;r<n.length;){let e=n[r],o=e.slice();if(e.length<3){n[r]=o,++r;continue}let a=eDe(o,t,i);o.length===e.length||a.length<=1?(n[r]=o,++r):(a.sort(((e,t)=>e.theta-t.theta)),r=SQ(n,r,o,a,1,0,o[0].z>=0))}return n},Fo.polygonsFromHierarchy=function(e,t,i,n,r,o){let a=[],s=[],l=new f0;l.enqueue(e);let c=u(o);for(;0!==l.length;){let e,d,p=l.dequeue(),f=p.positions,m=p.holes;if(n)for(d=f.length,e=0;e<d;e++)r.scaleToGeodeticSurface(f[e],f[e]);if(t||(f=go(f,h.equalsEpsilon,!0)),f.length<3)continue;let _=i(f);if(!u(_))continue;let g=[],y=ei.computeWindingOrder2D(_);if(y===ts.CLOCKWISE&&(_.reverse(),f=f.slice().reverse()),c){c=!1;let e=[f];if(e=o(e,e),e.length>1){for(let t of e)l.enqueue(new Pa(t,m));continue}}let v,b=f.slice(),A=u(m)?m.length:0,T=[];for(e=0;e<A;e++){let o=m[e],a=o.positions;if(n)for(d=a.length,v=0;v<d;++v)r.scaleToGeodeticSurface(a[v],a[v]);if(t||(a=go(a,h.equalsEpsilon,!0)),a.length<3)continue;let s=i(a);if(!u(s))continue;y=ei.computeWindingOrder2D(s),y===ts.CLOCKWISE&&(s.reverse(),a=a.slice().reverse()),T.push(a),g.push(b.length),b=b.concat(a),_=_.concat(s);let c=0;for(u(o.holes)&&(c=o.holes.length),v=0;v<c;v++)l.enqueue(o.holes[v])}a.push({outerRing:f,holes:T}),s.push({positions:b,positions2D:_,holes:g})}return{hierarchy:a,polygons:s}};var tDe=new U,nDe=new h,iDe=new Le,oDe=new $;Fo.computeBoundingRectangle=function(e,t,i,n,r){let o=Le.fromAxisAngle(e,n,iDe),a=$.fromQuaternion(o,oDe),s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,p=i.length;for(let e=0;e<p;++e){let n=h.clone(i[e],nDe);$.multiplyByVector(a,n,n);let r=t(n,tDe);u(r)&&(s=Math.min(s,r.x),l=Math.max(l,r.x),c=Math.min(c,r.y),d=Math.max(d,r.y))}return r.x=s,r.y=c,r.width=l-s,r.height=d-c,r},Fo.createGeometryFromPositions=function(e,t,i,n,r,o,a){let s=ei.triangulate(t.positions2D,t.holes);s.length<3&&(s=[0,1,2]);let l=t.positions,c=u(i),h=c?i.positions:void 0;if(r){let e=l.length,t=new Array(3*e),i=0;for(let n=0;n<e;n++){let e=l[n];t[i++]=e.x,t[i++]=e.y,t[i++]=e.z}let n={attributes:{position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:t})},indices:s,primitiveType:Ne.TRIANGLES};c&&(n.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:U.packArray(h)}));let r=new ct(n);return o.normal?Fn.computeNormal(r):r}return a===Yt.GEODESIC?ei.computeSubdivision(e,l,s,h,n):a===Yt.RHUMB?ei.computeRhumbLineSubdivision(e,l,s,h,n):void 0};var AQ=[],CQ=[],rDe=new h,sDe=new h;Fo.computeWallGeometry=function(e,t,i,n,r,o){let a,s,l,c,d,p,f,m,_,g=e.length,y=0,v=0,b=u(t),A=b?t.positions:void 0;if(r)for(s=3*g*2,a=new Array(2*s),b&&(_=2*g*2,m=new Array(2*_)),l=0;l<g;l++)c=e[l],d=e[(l+1)%g],a[y]=a[y+s]=c.x,++y,a[y]=a[y+s]=c.y,++y,a[y]=a[y+s]=c.z,++y,a[y]=a[y+s]=d.x,++y,a[y]=a[y+s]=d.y,++y,a[y]=a[y+s]=d.z,++y,b&&(p=A[l],f=A[(l+1)%g],m[v]=m[v+_]=p.x,++v,m[v]=m[v+_]=p.y,++v,m[v]=m[v+_]=f.x,++v,m[v]=m[v+_]=f.y,++v);else{let t=P.chordLength(n,i.maximumRadius),r=0;if(o===Yt.GEODESIC)for(l=0;l<g;l++)r+=Fo.subdivideLineCount(e[l],e[(l+1)%g],t);else if(o===Yt.RHUMB)for(l=0;l<g;l++)r+=Fo.subdivideRhumbLineCount(i,e[l],e[(l+1)%g],t);for(s=3*(r+g),a=new Array(2*s),b&&(_=2*(r+g),m=new Array(2*_)),l=0;l<g;l++){let n,r;c=e[l],d=e[(l+1)%g],b&&(p=A[l],f=A[(l+1)%g]),o===Yt.GEODESIC?(n=Fo.subdivideLine(c,d,t,CQ),b&&(r=Fo.subdivideTexcoordLine(p,f,c,d,t,AQ))):o===Yt.RHUMB&&(n=Fo.subdivideRhumbLine(i,c,d,t,CQ),b&&(r=Fo.subdivideTexcoordRhumbLine(p,f,i,c,d,t,AQ)));let u=n.length;for(let e=0;e<u;++e,++y)a[y]=n[e],a[y+s]=n[e];if(a[y]=d.x,a[y+s]=d.x,++y,a[y]=d.y,a[y+s]=d.y,++y,a[y]=d.z,a[y+s]=d.z,++y,b){let e=r.length;for(let t=0;t<e;++t,++v)m[v]=r[t],m[v+_]=r[t];m[v]=f.x,m[v+_]=f.x,++v,m[v]=f.y,m[v+_]=f.y,++v}}}g=a.length;let T=ke.createTypedArray(g/3,g-6*e.length),E=0;for(g/=6,l=0;l<g;l++){let e=l,t=e+1,i=e+g,n=i+1;c=h.fromArray(a,3*e,rDe),d=h.fromArray(a,3*t,sDe),!h.equalsEpsilon(c,d,P.EPSILON10,P.EPSILON10)&&(T[E++]=e,T[E++]=i,T[E++]=t,T[E++]=t,T[E++]=i,T[E++]=n)}let C={attributes:new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:a})}),indices:T,primitiveType:Ne.TRIANGLES};return b&&(C.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:m})),new ct(C)};var kn=Fo,aDe=new h,cDe=new qe,lDe=new U,uDe=new U,fDe=new h,dDe=new h,hDe=new h,pS=new h,mDe=new h,pDe=new h,wQ=new Le,_De=new $,gDe=new $,yDe=new h;function xDe(e,t,i,n,r,o,a,s,l){let c=e.positions,d=ei.triangulate(e.positions2D,e.holes);d.length<3&&(d=[0,1,2]);let p=ke.createTypedArray(c.length,d.length);p.set(d);let f=_De;if(0!==n){let e=Le.fromAxisAngle(a,n,wQ);if(f=$.fromQuaternion(e,f),t.tangent||t.bitangent){e=Le.fromAxisAngle(a,-n,wQ);let i=$.fromQuaternion(e,gDe);s=h.normalize($.multiplyByVector(i,s,s),s),t.bitangent&&(l=h.normalize(h.cross(a,s,l),l))}}else f=$.clone($.IDENTITY,f);let m=uDe;t.st&&(m.x=i.x,m.y=i.y);let _=c.length,g=3*_,y=new Float64Array(g),v=t.normal?new Float32Array(g):void 0,b=t.tangent?new Float32Array(g):void 0,A=t.bitangent?new Float32Array(g):void 0,T=t.st?new Float32Array(2*_):void 0,E=0,C=0,x=0,S=0,w=0;for(let e=0;e<_;e++){let n=c[e];if(y[E++]=n.x,y[E++]=n.y,y[E++]=n.z,t.st)if(u(r)&&r.positions.length===_)T[w++]=r.positions[e].x,T[w++]=r.positions[e].y;else{let e=o($.multiplyByVector(f,n,aDe),lDe);U.subtract(e,m,e);let t=P.clamp(e.x/i.width,0,1),r=P.clamp(e.y/i.height,0,1);T[w++]=t,T[w++]=r}t.normal&&(v[C++]=a.x,v[C++]=a.y,v[C++]=a.z),t.tangent&&(b[S++]=s.x,b[S++]=s.y,b[S++]=s.z),t.bitangent&&(A[x++]=l.x,A[x++]=l.y,A[x++]=l.z)}let I=new hn;return t.position&&(I.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:y})),t.normal&&(I.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:v})),t.tangent&&(I.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:b})),t.bitangent&&(I.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:A})),t.st&&(I.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:T})),new ct({attributes:I,indices:p,primitiveType:Ne.TRIANGLES})}function h0(e){let t=(e=y(e,y.EMPTY_OBJECT)).polygonHierarchy,i=e.textureCoordinates,n=y(e.vertexFormat,Pe.DEFAULT);this._vertexFormat=Pe.clone(n),this._polygonHierarchy=t,this._stRotation=y(e.stRotation,0),this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._workerName="createCoplanarPolygonGeometry",this._textureCoordinates=i,this.packedLength=kn.computeHierarchyPackedLength(t,h)+Pe.packedLength+ie.packedLength+(u(i)?kn.computeHierarchyPackedLength(i,U):1)+2}h0.fromPositions=function(e){return new h0({polygonHierarchy:{positions:(e=y(e,y.EMPTY_OBJECT)).positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,textureCoordinates:e.textureCoordinates})},h0.pack=function(e,t,i){return i=y(i,0),i=kn.packPolygonHierarchy(e._polygonHierarchy,t,i,h),ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._stRotation,u(e._textureCoordinates)?i=kn.packPolygonHierarchy(e._textureCoordinates,t,i,U):t[i++]=-1,t[i++]=e.packedLength,t};var bDe=ie.clone(ie.UNIT_SPHERE),TDe=new Pe,ADe={polygonHierarchy:{}};h0.unpack=function(e,t,i){t=y(t,0);let n=kn.unpackPolygonHierarchy(e,t,h);t=n.startingIndex,delete n.startingIndex;let r=ie.unpack(e,t,bDe);t+=ie.packedLength;let o=Pe.unpack(e,t,TDe);t+=Pe.packedLength;let a=e[t++],s=-1===e[t]?void 0:kn.unpackPolygonHierarchy(e,t,U);u(s)?(t=s.startingIndex,delete s.startingIndex):t++;let l=e[t++];return u(i)||(i=new h0(ADe)),i._polygonHierarchy=n,i._ellipsoid=ie.clone(r,i._ellipsoid),i._vertexFormat=Pe.clone(o,i._vertexFormat),i._stRotation=a,i._textureCoordinates=s,i.packedLength=l,i},h0.createGeometry=function(e){let t=e._vertexFormat,i=e._polygonHierarchy,n=e._stRotation,r=e._textureCoordinates,o=u(r),a=i.positions;if(a=go(a,h.equalsEpsilon,!0),a.length<3)return;let s=fDe,l=dDe,c=hDe,d=mDe,p=pDe;if(!x_.computeProjectTo2DArguments(a,pS,d,p))return;if(s=h.cross(d,p,s),s=h.normalize(s,s),!h.equalsEpsilon(pS,h.ZERO,P.EPSILON6)){let t=e._ellipsoid.geodeticSurfaceNormal(pS,yDe);h.dot(s,t)<0&&(s=h.negate(s,s),d=h.negate(d,d))}let f=x_.createProjectPointsTo2DFunction(pS,d,p),m=x_.createProjectPointTo2DFunction(pS,d,p);t.tangent&&(l=h.clone(d,l)),t.bitangent&&(c=h.clone(p,c));let _=kn.polygonsFromHierarchy(i,o,f,!1),g=_.hierarchy,y=_.polygons,v=o?kn.polygonsFromHierarchy(r,!0,(function(e){return e}),!1).polygons:void 0;if(0===g.length)return;a=g[0].outerRing;let b=se.fromPoints(a),A=kn.computeBoundingRectangle(s,m,a,n,cDe),T=[];for(let e=0;e<y.length;e++){let i=new yt({geometry:xDe(y[e],t,A,n,o?v[e]:void 0,m,s,l,c)});T.push(i)}let E=Fn.combineInstances(T)[0];E.attributes.position.values=new Float64Array(E.attributes.position.values),E.indices=ke.createTypedArray(E.attributes.position.values.length/3,E.indices);let C=E.attributes;return t.position||delete C.position,new ct({attributes:C,indices:E.indices,primitiveType:E.primitiveType,boundingSphere:b})};var b1=h0;function CDe(e){let t=e.length,i=new Float64Array(3*t),n=ke.createTypedArray(t,2*t),r=0,o=0;for(let a=0;a<t;a++){let s=e[a];i[r++]=s.x,i[r++]=s.y,i[r++]=s.z,n[o++]=a,n[o++]=(a+1)%t}let a=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:i})});return new ct({attributes:a,indices:n,primitiveType:Ne.LINES})}function m0(e){let t=(e=y(e,y.EMPTY_OBJECT)).polygonHierarchy;this._polygonHierarchy=t,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=kn.computeHierarchyPackedLength(t,h)+1}m0.fromPositions=function(e){return new m0({polygonHierarchy:{positions:(e=y(e,y.EMPTY_OBJECT)).positions}})},m0.pack=function(e,t,i){return i=y(i,0),t[i=kn.packPolygonHierarchy(e._polygonHierarchy,t,i,h)]=e.packedLength,t};var EDe={polygonHierarchy:{}};m0.unpack=function(e,t,i){t=y(t,0);let n=kn.unpackPolygonHierarchy(e,t,h);t=n.startingIndex,delete n.startingIndex;let r=e[t];return u(i)||(i=new m0(EDe)),i._polygonHierarchy=n,i.packedLength=r,i},m0.createGeometry=function(e){let t=e._polygonHierarchy,i=t.positions;if(i=go(i,h.equalsEpsilon,!0),i.length<3||!x_.validOutline(i))return;let n=kn.polygonOutlinesFromHierarchy(t,!1);if(0===n.length)return;let r=[];for(let e=0;e<n.length;e++){let t=new yt({geometry:CDe(n[e])});r.push(t)}let o=Fn.combineInstances(r)[0],a=se.fromPoints(t.positions);return new ct({attributes:o.attributes,indices:o.indices,primitiveType:o.primitiveType,boundingSphere:a})};var zf=m0,SDe={ROUNDED:0,MITERED:1,BEVELED:2},Ri=Object.freeze(SDe);function wDe(e){let t=e._uSquared,i=e._ellipsoid.maximumRadius,n=e._ellipsoid.minimumRadius,r=(i-n)/i,o=Math.cos(e._startHeading),a=Math.sin(e._startHeading),s=(1-r)*Math.tan(e._start.latitude),l=1/Math.sqrt(1+s*s),u=l*s,c=Math.atan2(s,o),h=l*a,d=h*h,p=1-d,f=Math.sqrt(p),m=t/4,_=m*m,g=_*m,y=_*_,v=1+m-3*_/4+5*g/4-175*y/64,b=1-m+15*_/8-35*g/8,A=1-3*m+35*_/4,T=1-5*m,E=v*c-b*Math.sin(2*c)*m/2-A*Math.sin(4*c)*_/16-T*Math.sin(6*c)*g/48-5*Math.sin(8*c)*y/512,C=e._constants;C.a=i,C.b=n,C.f=r,C.cosineHeading=o,C.sineHeading=a,C.tanU=s,C.cosineU=l,C.sineU=u,C.sigma=c,C.sineAlpha=h,C.sineSquaredAlpha=d,C.cosineSquaredAlpha=p,C.cosineAlpha=f,C.u2Over4=m,C.u4Over16=_,C.u6Over64=g,C.u8Over256=y,C.a0=v,C.a1=b,C.a2=A,C.a3=T,C.distanceRatio=E}function vDe(e,t){return e*t*(4+e*(4-3*t))/16}function vQ(e,t,i,n,r,o,a){let s=vDe(e,i);return(1-s)*e*t*(n+s*r*(a+s*o*(2*a*a-1)))}function DDe(e,t,i,n,r,o,a){let s,l,u,c,h,d=(t-i)/t,p=o-n,f=Math.atan((1-d)*Math.tan(r)),m=Math.atan((1-d)*Math.tan(a)),_=Math.cos(f),g=Math.sin(f),y=Math.cos(m),v=Math.sin(m),b=_*y,A=_*v,T=g*v,E=g*y,C=p,x=P.TWO_PI,S=Math.cos(C),w=Math.sin(C);do{S=Math.cos(C),w=Math.sin(C);let e,t=A-E*S;u=Math.sqrt(y*y*w*w+t*t),l=T+b*S,s=Math.atan2(u,l),0===u?(e=0,c=1):(e=b*w/u,c=1-e*e),x=C,h=l-2*T/c,isFinite(h)||(h=0),C=p+vQ(d,e,c,s,u,l,h)}while(Math.abs(C-x)>P.EPSILON12);let I=c*(t*t-i*i)/(i*i),D=I*(256+I*(I*(74-47*I)-128))/1024,O=h*h,L=i*(1+I*(4096+I*(I*(320-175*I)-768))/16384)*(s-D*u*(h+D*(l*(2*O-1)-D*h*(4*u*u-3)*(4*O-3)/6)/4)),R=Math.atan2(y*w,A-E*S),N=Math.atan2(_*w,A*S-E);e._distance=L,e._startHeading=R,e._endHeading=N,e._uSquared=I}var IDe=new h,Y5=new h;function DQ(e,t,i,n){h.normalize(n.cartographicToCartesian(t,Y5),IDe),h.normalize(n.cartographicToCartesian(i,Y5),Y5);DDe(e,n.maximumRadius,n.minimumRadius,t.longitude,t.latitude,i.longitude,i.latitude),e._start=fe.clone(t,e._start),e._end=fe.clone(i,e._end),e._start.height=0,e._end.height=0,wDe(e)}function _S(e,t,i){let n=y(i,ie.WGS84);this._ellipsoid=n,this._start=new fe,this._end=new fe,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,u(e)&&u(t)&&DQ(this,e,t,n)}Object.defineProperties(_S.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}}),_S.prototype.setEndPoints=function(e,t){DQ(this,e,t,this._ellipsoid)},_S.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)},_S.prototype.interpolateUsingSurfaceDistance=function(e,t){let i=this._constants,n=i.distanceRatio+e/i.b,r=Math.cos(2*n),o=Math.cos(4*n),a=Math.cos(6*n),s=Math.sin(2*n),l=Math.sin(4*n),c=Math.sin(6*n),h=Math.sin(8*n),d=n*n,p=n*d,f=i.u8Over256,m=i.u2Over4,_=i.u6Over64,g=i.u4Over16,y=2*p*f*r/3+n*(1-m+7*g/4-15*_/4+579*f/64-(g-15*_/4+187*f/16)*r-(5*_/4-115*f/16)*o-29*f*a/16)+(m/2-g+71*_/32-85*f/16)*s+(5*g/16-5*_/4+383*f/96)*l-d*((_-11*f/2)*s+5*f*l/2)+(29*_/96-29*f/16)*c+539*f*h/1536,v=Math.asin(Math.sin(y)*i.cosineAlpha),b=Math.atan(i.a/i.b*Math.tan(v));y-=i.sigma;let A=Math.cos(2*i.sigma+y),T=Math.sin(y),E=Math.cos(y),C=i.cosineU*E,x=i.sineU*T,S=Math.atan2(T*i.sineHeading,C-x*i.cosineHeading)-vQ(i.f,i.sineAlpha,i.cosineSquaredAlpha,y,T,E,A);return u(t)?(t.longitude=this._start.longitude+S,t.latitude=b,t.height=0,t):new fe(this._start.longitude+S,b,0)};var Hf=_S,fc={numberOfPoints:function(e,t,i){let n=h.distance(e,t);return Math.ceil(n/i)},numberOfPointsRhumbLine:function(e,t,i){let n=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.max(1,Math.ceil(Math.sqrt(n/(i*i))))}},PDe=new fe;fc.extractHeights=function(e,t){let i=e.length,n=new Array(i);for(let r=0;r<i;r++){let i=e[r];n[r]=t.cartesianToCartographic(i,PDe).height}return n};var ODe=new L,RDe=new h,IQ=new h,MDe=new tn(h.UNIT_X,0),PQ=new h,LDe=new tn(h.UNIT_X,0),NDe=new h,FDe=new h,K5=[];function RQ(e,t,i){let n,r=K5;if(r.length=e,t===i){for(n=0;n<e;n++)r[n]=t;return r}let o=(i-t)/e;for(n=0;n<e;n++){let e=t+n*o;r[n]=e}return r}var A1=new fe,T1=new fe,C_=new h,Z5=new h,BDe=new h,X5=new Hf,gS=new Ia;function kDe(e,t,i,n,r,o,a,s){let l=n.scaleToGeodeticSurface(e,Z5),u=n.scaleToGeodeticSurface(t,BDe),c=fc.numberOfPoints(e,t,i),d=n.cartesianToCartographic(l,A1),p=n.cartesianToCartographic(u,T1),f=RQ(c,r,o);X5.setEndPoints(d,p);let m=X5.surfaceDistance/c,_=s;d.height=r;let g=n.cartographicToCartesian(d,C_);h.pack(g,a,_),_+=3;for(let e=1;e<c;e++){let t=X5.interpolateUsingSurfaceDistance(e*m,T1);t.height=f[e],g=n.cartographicToCartesian(t,C_),h.pack(g,a,_),_+=3}return _}function VDe(e,t,i,n,r,o,a,s){let l=n.cartesianToCartographic(e,A1),u=n.cartesianToCartographic(t,T1),c=fc.numberOfPointsRhumbLine(l,u,i);l.height=0,u.height=0;let d=RQ(c,r,o);gS.ellipsoid.equals(n)||(gS=new Ia(void 0,void 0,n)),gS.setEndPoints(l,u);let p=gS.surfaceDistance/c,f=s;l.height=r;let m=n.cartographicToCartesian(l,C_);h.pack(m,a,f),f+=3;for(let e=1;e<c;e++){let t=gS.interpolateUsingSurfaceDistance(e*p,T1);t.height=d[e],m=n.cartographicToCartesian(t,C_),h.pack(m,a,f),f+=3}return f}fc.wrapLongitude=function(e,t){let i=[],n=[];if(u(e)&&e.length>0){t=y(t,L.IDENTITY);let r=L.inverseTransformation(t,ODe),o=L.multiplyByPoint(r,h.ZERO,RDe),a=h.normalize(L.multiplyByPointAsVector(r,h.UNIT_Y,IQ),IQ),s=tn.fromPointNormal(o,a,MDe),l=h.normalize(L.multiplyByPointAsVector(r,h.UNIT_X,PQ),PQ),c=tn.fromPointNormal(o,l,LDe),d=1;i.push(h.clone(e[0]));let p=i[0],f=e.length;for(let t=1;t<f;++t){let r=e[t];if(tn.getPointDistance(c,p)<0||tn.getPointDistance(c,r)<0){let e=Ai.lineSegmentPlane(p,r,s,NDe);if(u(e)){let t=h.multiplyByScalar(a,5e-9,FDe);tn.getPointDistance(s,p)<0&&h.negate(t,t),i.push(h.add(e,t,new h)),n.push(d+1),h.negate(t,t),i.push(h.add(e,t,new h)),d=1}}i.push(h.clone(e[t])),d++,p=r}n.push(d)}return{positions:i,lengths:n}},fc.generateArc=function(e){u(e)||(e={});let t=e.positions,i=t.length,n=y(e.ellipsoid,ie.WGS84),r=y(e.height,0),o=Array.isArray(r);if(i<1)return[];if(1===i){let e=n.scaleToGeodeticSurface(t[0],Z5);if(r=o?r[0]:r,0!==r){let t=n.geodeticSurfaceNormal(e,C_);h.multiplyByScalar(t,r,t),h.add(e,t,e)}return[e.x,e.y,e.z]}let a=e.minDistance;if(!u(a)){let t=y(e.granularity,P.RADIANS_PER_DEGREE);a=P.chordLength(t,n.maximumRadius)}let s,l=0;for(s=0;s<i-1;s++)l+=fc.numberOfPoints(t[s],t[s+1],a);let c=3*(l+1),d=new Array(c),p=0;for(s=0;s<i-1;s++){p=kDe(t[s],t[s+1],a,n,o?r[s]:r,o?r[s+1]:r,d,p)}K5.length=0;let f=t[i-1],m=n.cartesianToCartographic(f,A1);m.height=o?r[i-1]:r;let _=n.cartographicToCartesian(m,C_);return h.pack(_,d,c-3),d};var OQ=new fe,UDe=new fe;fc.generateRhumbArc=function(e){u(e)||(e={});let t=e.positions,i=t.length,n=y(e.ellipsoid,ie.WGS84),r=y(e.height,0),o=Array.isArray(r);if(i<1)return[];if(1===i){let e=n.scaleToGeodeticSurface(t[0],Z5);if(r=o?r[0]:r,0!==r){let t=n.geodeticSurfaceNormal(e,C_);h.multiplyByScalar(t,r,t),h.add(e,t,e)}return[e.x,e.y,e.z]}let a,s,l=y(e.granularity,P.RADIANS_PER_DEGREE),c=0,d=n.cartesianToCartographic(t[0],OQ);for(a=0;a<i-1;a++)s=n.cartesianToCartographic(t[a+1],UDe),c+=fc.numberOfPointsRhumbLine(d,s,l),d=fe.clone(s,OQ);let p=3*(c+1),f=new Array(p),m=0;for(a=0;a<i-1;a++){m=VDe(t[a],t[a+1],l,n,o?r[a]:r,o?r[a+1]:r,f,m)}K5.length=0;let _=t[i-1],g=n.cartesianToCartographic(_,A1);g.height=o?r[i-1]:r;let v=n.cartographicToCartesian(g,C_);return h.pack(v,f,p-3),f},fc.generateCartesianArc=function(e){let t=fc.generateArc(e),i=t.length/3,n=new Array(i);for(let e=0;e<i;e++)n[e]=h.unpack(t,3*e);return n},fc.generateCartesianRhumbArc=function(e){let t=fc.generateRhumbArc(e),i=t.length/3,n=new Array(i);for(let e=0;e<i;e++)n[e]=h.unpack(t,3*e);return n};var Mi=fc,MQ={};function yS(e,t){u(MQ[e])||(MQ[e]=!0,console.warn(y(t,e)))}yS.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",yS.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",yS.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",yS.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var It=yS,Rs=[new h,new h],zDe=new h,HDe=new h,GDe=new h,WDe=new h,jDe=new h,qDe=new h,YDe=new h,XDe=new h,KDe=new h,sT=new h,C1=new h,xS={},$5=new fe;function ZDe(e,t){let i=new Array(e.length);for(let n=0;n<e.length;n++){let r=e[n];$5=t.cartesianToCartographic(r,$5),i[n]=$5.height,e[n]=t.scaleToGeodeticSurface(r,r)}return i}function Q5(e,t,i,n){let r,o=e[0],a=e[1],s=h.angleBetween(o,a),l=Math.ceil(s/n),u=new Array(l);if(t===i){for(r=0;r<l;r++)u[r]=t;return u.push(i),u}let c=(i-t)/l;for(r=1;r<l;r++){let e=t+r*c;u[r]=e}return u[0]=t,u.push(i),u}var E1=new h,S1=new h;function $De(e,t,i,n){let r=new Vr(i,n),o=r.projectPointOntoPlane(h.add(i,e,E1),E1),a=r.projectPointOntoPlane(h.add(i,t,S1),S1),s=U.angleBetween(o,a);return a.x*o.y-a.y*o.x>=0?-s:s}var QDe=new h(-1,0,0),p0=new L,JDe=new L,J5=new $,eIe=$.IDENTITY.clone(),tIe=new h,nIe=new oe,LQ=new h;function km(e,t,i,n,r,o,a,s){let l=tIe,u=nIe;p0=Rt.eastNorthUpToFixedFrame(e,r,p0),l=L.multiplyByPointAsVector(p0,QDe,l),l=h.normalize(l,l);let c=$De(l,t,e,r);J5=$.fromRotationZ(c,J5),LQ.z=o,p0=L.multiplyTransformation(p0,L.fromRotationTranslation(J5,LQ,JDe),p0);let d=eIe;d[0]=a;for(let e=0;e<s;e++)for(let e=0;e<i.length;e+=3)u=h.fromArray(i,e,u),u=$.multiplyByVector(d,u,u),u=L.multiplyByPoint(p0,u,u),n.push(u.x,u.y,u.z);return n}var iIe=new h;function eG(e,t,i,n,r,o,a){for(let s=0;s<e.length;s+=3){n=km(h.fromArray(e,s,iIe),t,i,n,r,o[s/3],a,1)}return n}function oIe(e,t){let i=e.length,n=new Array(6*i),r=0,o=t.x+t.width/2,a=t.y+t.height/2,s=e[0];n[r++]=s.x-o,n[r++]=0,n[r++]=s.y-a;for(let t=1;t<i;t++){s=e[t];let i=s.x-o,l=s.y-a;n[r++]=i,n[r++]=0,n[r++]=l,n[r++]=i,n[r++]=0,n[r++]=l}return s=e[0],n[r++]=s.x-o,n[r++]=0,n[r++]=s.y-a,n}function NQ(e,t){let i=e.length,n=new Array(3*i),r=0,o=t.x+t.width/2,a=t.y+t.height/2;for(let t=0;t<i;t++)n[r++]=e[t].x-o,n[r++]=0,n[r++]=e[t].y-a;return n}var FQ=new Le,BQ=new h,kQ=new $;function VQ(e,t,i,n,r,o,a,s,l,u){let c,d,p,f=h.angleBetween(h.subtract(t,e,sT),h.subtract(i,e,C1)),m=n===Ri.BEVELED?0:Math.ceil(f/P.toRadians(5));if(c=r?$.fromQuaternion(Le.fromAxisAngle(h.negate(e,sT),f/(m+1),FQ),kQ):$.fromQuaternion(Le.fromAxisAngle(e,f/(m+1),FQ),kQ),t=h.clone(t,BQ),m>0){let i=u?2:1;for(let n=0;n<m;n++)t=$.multiplyByVector(c,t,t),d=h.subtract(t,e,sT),d=h.normalize(d,d),r||(d=h.negate(d,d)),p=o.scaleToGeodeticSurface(t,C1),a=km(p,d,s,a,o,l,1,i)}else d=h.subtract(t,e,sT),d=h.normalize(d,d),r||(d=h.negate(d,d)),p=o.scaleToGeodeticSurface(t,C1),a=km(p,d,s,a,o,l,1,1),i=h.clone(i,BQ),d=h.subtract(i,e,sT),d=h.normalize(d,d),r||(d=h.negate(d,d)),p=o.scaleToGeodeticSurface(i,C1),a=km(p,d,s,a,o,l,1,1);return a}xS.removeDuplicatesFromShape=function(e){let t=e.length,i=[];for(let n=t-1,r=0;r<t;n=r++){let t=e[n],o=e[r];U.equals(t,o)||i.push(o)}return i},xS.angleIsGreaterThanPi=function(e,t,i,n){let r=new Vr(i,n),o=r.projectPointOntoPlane(h.add(i,e,E1),E1),a=r.projectPointOntoPlane(h.add(i,t,S1),S1);return a.x*o.y-a.y*o.x>=0};var rIe=new h,sIe=new h;xS.computePositions=function(e,t,i,n,r){let o=n._ellipsoid,a=ZDe(e,o),s=n._granularity,l=n._cornerType,u=r?oIe(t,i):NQ(t,i),c=r?NQ(t,i):void 0,d=i.height/2,p=i.width/2,f=e.length,m=[],_=r?[]:void 0,g=zDe,y=HDe,v=GDe,b=WDe,A=jDe,T=qDe,E=YDe,C=XDe,x=KDe,S=e[0],w=e[1];b=o.geodeticSurfaceNormal(S,b),g=h.subtract(w,S,g),g=h.normalize(g,g),C=h.cross(b,g,C),C=h.normalize(C,C);let I,D,O=a[0],L=a[1];r&&(_=km(S,C,c,_,o,O+d,1,1)),x=h.clone(S,x),S=w,y=h.negate(g,y);for(let t=1;t<f-1;t++){let i=r?2:1;if(w=e[t+1],S.equals(w)){It("Positions are too close and are considered equivalent with rounding error.");continue}g=h.subtract(w,S,g),g=h.normalize(g,g),v=h.add(g,y,v),v=h.normalize(v,v),b=o.geodeticSurfaceNormal(S,b);let n=h.multiplyByScalar(b,h.dot(g,b),rIe);h.subtract(g,n,n),h.normalize(n,n);let c=h.multiplyByScalar(b,h.dot(y,b),sIe);if(h.subtract(y,c,c),h.normalize(c,c),P.equalsEpsilon(Math.abs(h.dot(n,c)),1,P.EPSILON7))m=km(x,C,u,m,o,O+d,1,1),x=S;else{v=h.cross(v,b,v),v=h.cross(b,v,v),v=h.normalize(v,v);let e=1/Math.max(.25,h.magnitude(h.cross(v,y,sT))),t=xS.angleIsGreaterThanPi(g,y,S,o);t?(A=h.add(S,h.multiplyByScalar(v,e*p,v),A),T=h.add(A,h.multiplyByScalar(C,p,T),T),Rs[0]=h.clone(x,Rs[0]),Rs[1]=h.clone(T,Rs[1]),I=Q5(Rs,O+d,L+d,s),D=Mi.generateArc({positions:Rs,granularity:s,ellipsoid:o}),m=eG(D,C,u,m,o,I,1),C=h.cross(b,g,C),C=h.normalize(C,C),E=h.add(A,h.multiplyByScalar(C,p,E),E),l===Ri.ROUNDED||l===Ri.BEVELED?VQ(A,T,E,l,t,o,m,u,L+d,r):(v=h.negate(v,v),m=km(S,v,u,m,o,L+d,e,i)),x=h.clone(E,x)):(A=h.add(S,h.multiplyByScalar(v,e*p,v),A),T=h.add(A,h.multiplyByScalar(C,-p,T),T),Rs[0]=h.clone(x,Rs[0]),Rs[1]=h.clone(T,Rs[1]),I=Q5(Rs,O+d,L+d,s),D=Mi.generateArc({positions:Rs,granularity:s,ellipsoid:o}),m=eG(D,C,u,m,o,I,1),C=h.cross(b,g,C),C=h.normalize(C,C),E=h.add(A,h.multiplyByScalar(C,-p,E),E),l===Ri.ROUNDED||l===Ri.BEVELED?VQ(A,T,E,l,t,o,m,u,L+d,r):m=km(S,v,u,m,o,L+d,e,i),x=h.clone(E,x)),y=h.negate(g,y)}O=L,L=a[t+1],S=w}Rs[0]=h.clone(x,Rs[0]),Rs[1]=h.clone(S,Rs[1]),I=Q5(Rs,O+d,L+d,s),D=Mi.generateArc({positions:Rs,granularity:s,ellipsoid:o}),m=eG(D,C,u,m,o,I,1),r&&(_=km(S,C,c,_,o,L+d,1,1)),f=m.length;let R=r?f+_.length:f,N=new Float64Array(R);return N.set(m),r&&N.set(_,f),N};var _h=xS,nG={},aT=new h,WQ=new h,aIe=new h,UQ=new h,dc=[new h,new h],jQ=new h,qQ=new h,YQ=new h,cIe=new h,lIe=new h,uIe=new h,fIe=new h,dIe=new h,hIe=new h,mIe=new h,zQ=new Le,HQ=new $;function w1(e,t,i,n,r){let o,a=h.angleBetween(h.subtract(t,e,aT),h.subtract(i,e,WQ)),s=n===Ri.BEVELED?1:Math.ceil(a/P.toRadians(5))+1,l=3*s,u=new Array(l);u[l-3]=i.x,u[l-2]=i.y,u[l-1]=i.z,o=r?$.fromQuaternion(Le.fromAxisAngle(h.negate(e,aT),a/s,zQ),HQ):$.fromQuaternion(Le.fromAxisAngle(e,a/s,zQ),HQ);let c=0;t=h.clone(t,aT);for(let e=0;e<s;e++)t=$.multiplyByVector(o,t,t),u[c++]=t.x,u[c++]=t.y,u[c++]=t.z;return u}function pIe(e){let t=jQ,i=qQ,n=YQ,r=e[1];i=h.fromArray(e[1],r.length-3,i),n=h.fromArray(e[0],0,n),t=h.midpoint(i,n,t);let o=w1(t,i,n,Ri.ROUNDED,!1),a=e.length-1,s=e[a-1];return r=e[a],i=h.fromArray(s,s.length-3,i),n=h.fromArray(r,0,n),t=h.midpoint(i,n,t),[o,w1(t,i,n,Ri.ROUNDED,!1)]}function GQ(e,t,i,n){let r=aT;return n||(t=h.negate(t,t)),r=h.add(e,t,r),[r.x,r.y,r.z,i.x,i.y,i.z]}function tG(e,t,i,n){let r=new Array(e.length),o=new Array(e.length),a=h.multiplyByScalar(t,i,aT),s=h.negate(a,WQ),l=0,u=e.length-1;for(let t=0;t<e.length;t+=3){let i=h.fromArray(e,t,aIe),n=h.add(i,s,UQ);r[l++]=n.x,r[l++]=n.y,r[l++]=n.z;let c=h.add(i,a,UQ);o[u--]=c.z,o[u--]=c.y,o[u--]=c.x}return n.push(r,o),n}nG.addAttribute=function(e,t,i,n){let r=t.x,o=t.y,a=t.z;u(i)&&(e[i]=r,e[i+1]=o,e[i+2]=a),u(n)&&(e[n]=a,e[n-1]=o,e[n-2]=r)};var _Ie=new h,gIe=new h;nG.computePositions=function(e){let t=e.granularity,i=e.positions,n=e.ellipsoid,r=e.width/2,o=e.cornerType,a=e.saveAttributes,s=jQ,l=qQ,u=YQ,c=cIe,d=lIe,p=uIe,f=fIe,m=dIe,_=hIe,g=mIe,y=[],v=a?[]:void 0,b=a?[]:void 0,A=i[0],T=i[1];l=h.normalize(h.subtract(T,A,l),l),s=n.geodeticSurfaceNormal(A,s),c=h.normalize(h.cross(s,l,c),c),a&&(v.push(c.x,c.y,c.z),b.push(s.x,s.y,s.z)),f=h.clone(A,f),A=T,u=h.negate(l,u);let E,C,x,S=[],w=i.length;for(C=1;C<w-1;C++){s=n.geodeticSurfaceNormal(A,s),T=i[C+1],l=h.normalize(h.subtract(T,A,l),l),d=h.normalize(h.add(l,u,d),d);let e=h.multiplyByScalar(s,h.dot(l,s),_Ie);h.subtract(l,e,e),h.normalize(e,e);let x=h.multiplyByScalar(s,h.dot(u,s),gIe);if(h.subtract(u,x,x),h.normalize(x,x),!P.equalsEpsilon(Math.abs(h.dot(e,x)),1,P.EPSILON7)){d=h.cross(d,s,d),d=h.cross(s,d,d),d=h.normalize(d,d);let e=r/Math.max(.25,h.magnitude(h.cross(d,u,aT))),i=_h.angleIsGreaterThanPi(l,u,A,n);d=h.multiplyByScalar(d,e,d),i?(m=h.add(A,d,m),g=h.add(m,h.multiplyByScalar(c,r,g),g),_=h.add(m,h.multiplyByScalar(c,2*r,_),_),dc[0]=h.clone(f,dc[0]),dc[1]=h.clone(g,dc[1]),E=Mi.generateArc({positions:dc,granularity:t,ellipsoid:n}),y=tG(E,c,r,y),a&&(v.push(c.x,c.y,c.z),b.push(s.x,s.y,s.z)),p=h.clone(_,p),c=h.normalize(h.cross(s,l,c),c),_=h.add(m,h.multiplyByScalar(c,2*r,_),_),f=h.add(m,h.multiplyByScalar(c,r,f),f),o===Ri.ROUNDED||o===Ri.BEVELED?S.push({leftPositions:w1(m,p,_,o,i)}):S.push({leftPositions:GQ(A,h.negate(d,d),_,i)})):(_=h.add(A,d,_),g=h.add(_,h.negate(h.multiplyByScalar(c,r,g),g),g),m=h.add(_,h.negate(h.multiplyByScalar(c,2*r,m),m),m),dc[0]=h.clone(f,dc[0]),dc[1]=h.clone(g,dc[1]),E=Mi.generateArc({positions:dc,granularity:t,ellipsoid:n}),y=tG(E,c,r,y),a&&(v.push(c.x,c.y,c.z),b.push(s.x,s.y,s.z)),p=h.clone(m,p),c=h.normalize(h.cross(s,l,c),c),m=h.add(_,h.negate(h.multiplyByScalar(c,2*r,m),m),m),f=h.add(_,h.negate(h.multiplyByScalar(c,r,f),f),f),o===Ri.ROUNDED||o===Ri.BEVELED?S.push({rightPositions:w1(_,p,m,o,i)}):S.push({rightPositions:GQ(A,d,m,i)})),u=h.negate(l,u)}A=T}return s=n.geodeticSurfaceNormal(A,s),dc[0]=h.clone(f,dc[0]),dc[1]=h.clone(A,dc[1]),E=Mi.generateArc({positions:dc,granularity:t,ellipsoid:n}),y=tG(E,c,r,y),a&&(v.push(c.x,c.y,c.z),b.push(s.x,s.y,s.z)),o===Ri.ROUNDED&&(x=pIe(y)),{positions:y,corners:S,lefts:v,normals:b,endPositions:x}};var Bi=nG,ZQ=new h,$Q=new h,v1=new h,D1=new h,yIe=new h,QQ=new h,E_=new h,cT=new h;function JQ(e,t){for(let i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function Gf(e,t,i,n,r,o){let a=e.normals,s=e.tangents,l=e.bitangents,u=h.normalize(h.cross(i,t,E_),E_);o.normal&&Bi.addAttribute(a,t,n,r),o.tangent&&Bi.addAttribute(s,u,n,r),o.bitangent&&Bi.addAttribute(l,i,n,r)}function eJ(e,t,i){let n,r,o,a=e.positions,s=e.corners,l=e.endPositions,c=e.lefts,d=e.normals,p=new hn,f=0,m=0,_=0;for(r=0;r<a.length;r+=2)o=a[r].length-3,f+=o,_+=2*o,m+=a[r+1].length-3;for(f+=3,m+=3,r=0;r<s.length;r++){n=s[r];let e=s[r].leftPositions;u(e)?(o=e.length,f+=o,_+=o):(o=s[r].rightPositions.length,m+=o,_+=o)}let g,y=u(l);y&&(g=l[0].length-3,f+=g,m+=g,g/=3,_+=6*g);let v,b,A,T,E,C,x=f+m,S=new Float64Array(x),w={normals:t.normal?new Float32Array(x):void 0,tangents:t.tangent?new Float32Array(x):void 0,bitangents:t.bitangent?new Float32Array(x):void 0},I=0,D=x-1,O=ZQ,L=$Q,R=g/2,N=ke.createTypedArray(x/3,_),M=0;if(y){C=v1,E=D1;let e=l[0];for(O=h.fromArray(d,0,O),L=h.fromArray(c,0,L),r=0;r<R;r++)C=h.fromArray(e,3*(R-1-r),C),E=h.fromArray(e,3*(R+r),E),Bi.addAttribute(S,E,I),Bi.addAttribute(S,C,void 0,D),Gf(w,O,L,I,D,t),b=I/3,T=b+1,v=(D-2)/3,A=v-1,N[M++]=v,N[M++]=b,N[M++]=A,N[M++]=A,N[M++]=b,N[M++]=T,I+=3,D-=3}let F,B,z=0,U=0,k=a[z++],V=a[z++];for(S.set(k,I),S.set(V,D-V.length+1),L=h.fromArray(c,U,L),o=V.length-3,r=0;r<o;r+=3)F=i.geodeticSurfaceNormal(h.fromArray(k,r,E_),E_),B=i.geodeticSurfaceNormal(h.fromArray(V,o-r,cT),cT),O=h.normalize(h.add(F,B,O),O),Gf(w,O,L,I,D,t),b=I/3,T=b+1,v=(D-2)/3,A=v-1,N[M++]=v,N[M++]=b,N[M++]=A,N[M++]=A,N[M++]=b,N[M++]=T,I+=3,D-=3;for(F=i.geodeticSurfaceNormal(h.fromArray(k,o,E_),E_),B=i.geodeticSurfaceNormal(h.fromArray(V,o,cT),cT),O=h.normalize(h.add(F,B,O),O),U+=3,r=0;r<s.length;r++){let e;n=s[r];let l,p,f=n.leftPositions,m=n.rightPositions,_=QQ,g=v1,y=D1;if(O=h.fromArray(d,U,O),u(f)){for(Gf(w,O,L,void 0,D,t),D-=3,l=T,p=A,e=0;e<f.length/3;e++)_=h.fromArray(f,3*e,_),N[M++]=l,N[M++]=p-e-1,N[M++]=p-e,Bi.addAttribute(S,_,void 0,D),g=h.fromArray(S,3*(p-e-1),g),y=h.fromArray(S,3*l,y),L=h.normalize(h.subtract(g,y,L),L),Gf(w,O,L,void 0,D,t),D-=3;_=h.fromArray(S,3*l,_),g=h.subtract(h.fromArray(S,3*p,g),_,g),y=h.subtract(h.fromArray(S,3*(p-e),y),_,y),L=h.normalize(h.add(g,y,L),L),Gf(w,O,L,I,void 0,t),I+=3}else{for(Gf(w,O,L,I,void 0,t),I+=3,l=A,p=T,e=0;e<m.length/3;e++)_=h.fromArray(m,3*e,_),N[M++]=l,N[M++]=p+e,N[M++]=p+e+1,Bi.addAttribute(S,_,I),g=h.fromArray(S,3*l,g),y=h.fromArray(S,3*(p+e),y),L=h.normalize(h.subtract(g,y,L),L),Gf(w,O,L,I,void 0,t),I+=3;_=h.fromArray(S,3*l,_),g=h.subtract(h.fromArray(S,3*(p+e),g),_,g),y=h.subtract(h.fromArray(S,3*p,y),_,y),L=h.normalize(h.negate(h.add(y,g,L),L),L),Gf(w,O,L,void 0,D,t),D-=3}for(k=a[z++],V=a[z++],k.splice(0,3),V.splice(V.length-3,3),S.set(k,I),S.set(V,D-V.length+1),o=V.length-3,U+=3,L=h.fromArray(c,U,L),e=0;e<V.length;e+=3)F=i.geodeticSurfaceNormal(h.fromArray(k,e,E_),E_),B=i.geodeticSurfaceNormal(h.fromArray(V,o-e,cT),cT),O=h.normalize(h.add(F,B,O),O),Gf(w,O,L,I,D,t),T=I/3,b=T-1,A=(D-2)/3,v=A+1,N[M++]=v,N[M++]=b,N[M++]=A,N[M++]=A,N[M++]=b,N[M++]=T,I+=3,D-=3;I-=3,D+=3}if(O=h.fromArray(d,d.length-3,O),Gf(w,O,L,I,D,t),y){I+=3,D-=3,C=v1,E=D1;let e=l[1];for(r=0;r<R;r++)C=h.fromArray(e,3*(g-r-1),C),E=h.fromArray(e,3*r,E),Bi.addAttribute(S,C,void 0,D),Bi.addAttribute(S,E,I),Gf(w,O,L,I,D,t),T=I/3,b=T-1,A=(D-2)/3,v=A+1,N[M++]=v,N[M++]=b,N[M++]=A,N[M++]=A,N[M++]=b,N[M++]=T,I+=3,D-=3}if(p.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:S}),t.st){let e,t,i=new Float32Array(x/3*2),n=0;if(y){f/=3,m/=3;let o=Math.PI/(g+1);t=1/(f-g+1),e=1/(m-g+1);let a,s=g/2;for(r=s+1;r<g+1;r++)a=P.PI_OVER_TWO+o*r,i[n++]=e*(1+Math.cos(a)),i[n++]=.5*(1+Math.sin(a));for(r=1;r<m-g+1;r++)i[n++]=r*e,i[n++]=0;for(r=g;r>s;r--)a=P.PI_OVER_TWO-r*o,i[n++]=1-e*(1+Math.cos(a)),i[n++]=.5*(1+Math.sin(a));for(r=s;r>0;r--)a=P.PI_OVER_TWO-o*r,i[n++]=1-t*(1+Math.cos(a)),i[n++]=.5*(1+Math.sin(a));for(r=f-g;r>0;r--)i[n++]=r*t,i[n++]=1;for(r=1;r<s+1;r++)a=P.PI_OVER_TWO+o*r,i[n++]=t*(1+Math.cos(a)),i[n++]=.5*(1+Math.sin(a))}else{for(f/=3,m/=3,t=1/(f-1),e=1/(m-1),r=0;r<m;r++)i[n++]=r*e,i[n++]=0;for(r=f;r>0;r--)i[n++]=(r-1)*t,i[n++]=1}p.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:i})}return t.normal&&(p.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:w.normals})),t.tangent&&(p.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:w.tangents})),t.bitangent&&(p.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:w.bitangents})),{attributes:p,indices:N}}function xIe(e,t){if(!(t.normal||t.tangent||t.bitangent||t.st))return e;let i,n,r=e.position.values;(t.normal||t.bitangent)&&(i=e.normal.values,n=e.bitangent.values);let o,a=e.position.values.length/18,s=3*a,l=2*a,u=2*s;if(t.normal||t.bitangent||t.tangent){let a=t.normal?new Float32Array(6*s):void 0,l=t.tangent?new Float32Array(6*s):void 0,c=t.bitangent?new Float32Array(6*s):void 0,d=ZQ,p=$Q,f=v1,m=D1,_=yIe,g=QQ,y=u;for(o=0;o<s;o+=3){let e=y+u;d=h.fromArray(r,o,d),p=h.fromArray(r,o+s,p),f=h.fromArray(r,(o+3)%s,f),p=h.subtract(p,d,p),f=h.subtract(f,d,f),m=h.normalize(h.cross(p,f,m),m),t.normal&&(Bi.addAttribute(a,m,e),Bi.addAttribute(a,m,e+3),Bi.addAttribute(a,m,y),Bi.addAttribute(a,m,y+3)),(t.tangent||t.bitangent)&&(g=h.fromArray(i,o,g),t.bitangent&&(Bi.addAttribute(c,g,e),Bi.addAttribute(c,g,e+3),Bi.addAttribute(c,g,y),Bi.addAttribute(c,g,y+3)),t.tangent&&(_=h.normalize(h.cross(g,m,_),_),Bi.addAttribute(l,_,e),Bi.addAttribute(l,_,e+3),Bi.addAttribute(l,_,y),Bi.addAttribute(l,_,y+3))),y+=6}if(t.normal){for(a.set(i),o=0;o<s;o+=3)a[o+s]=-i[o],a[o+s+1]=-i[o+1],a[o+s+2]=-i[o+2];e.normal.values=a}else e.normal=void 0;if(t.bitangent?(c.set(n),c.set(n,s),e.bitangent.values=c):e.bitangent=void 0,t.tangent){let t=e.tangent.values;l.set(t),l.set(t,s),e.tangent.values=l}}if(t.st){let t=e.st.values,i=new Float32Array(6*l);i.set(t),i.set(t,l);let n=2*l;for(let e=0;e<2;e++){for(i[n++]=t[0],i[n++]=t[1],o=2;o<l;o+=2){let e=t[o],r=t[o+1];i[n++]=e,i[n++]=r,i[n++]=e,i[n++]=r}i[n++]=t[0],i[n++]=t[1]}e.st.values=i}return e}function iG(e,t,i){i[t++]=e[0],i[t++]=e[1],i[t++]=e[2];for(let n=3;n<e.length;n+=3){let r=e[n],o=e[n+1],a=e[n+2];i[t++]=r,i[t++]=o,i[t++]=a,i[t++]=r,i[t++]=o,i[t++]=a}return i[t++]=e[0],i[t++]=e[1],i[t++]=e[2],i}function bIe(e,t){let i=new Pe({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st}),n=e.ellipsoid,r=eJ(Bi.computePositions(e),i,n),o=e.height,a=e.extrudedHeight,s=r.attributes,l=r.indices,c=s.position.values,h=c.length,d=new Float64Array(6*h),p=new Float64Array(h);p.set(c);let f=new Float64Array(4*h);c=ei.scaleToGeodeticHeight(c,o,n),f=iG(c,0,f),p=ei.scaleToGeodeticHeight(p,a,n),f=iG(p,2*h,f),d.set(c),d.set(p,h),d.set(f,2*h),s.position.values=d,s=xIe(s,t);let m,_=h/3;if(e.shadowVolume){let e=s.normal.values;h=e.length;let i=new Float32Array(6*h);for(m=0;m<h;m++)e[m]=-e[m];i.set(e,h),i=iG(e,4*h,i),s.extrudeDirection=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:i}),t.normal||(s.normal=void 0)}if(u(e.offsetAttribute)){let t=new Uint8Array(6*_);if(e.offsetAttribute===on.TOP)t=t.fill(1,0,_).fill(1,2*_,4*_);else{let i=e.offsetAttribute===on.NONE?0:1;t=t.fill(i)}s.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let g=l.length,y=_+_,v=ke.createTypedArray(d.length/3,2*g+3*y);v.set(l);let b,A,T,E,C=g;for(m=0;m<g;m+=3){let e=l[m],t=l[m+1],i=l[m+2];v[C++]=i+_,v[C++]=t+_,v[C++]=e+_}for(m=0;m<y;m+=2)b=m+y,A=b+y,T=b+1,E=A+1,v[C++]=b,v[C++]=A,v[C++]=T,v[C++]=T,v[C++]=A,v[C++]=E;return{attributes:s,indices:v}}var XQ=new h,bS=new h,Lu=new fe;function KQ(e,t,i,n,r,o){let a=h.subtract(t,e,XQ);h.normalize(a,a);let s=i.geodeticSurfaceNormal(e,bS),l=h.cross(a,s,XQ);h.multiplyByScalar(l,n,l);let u=r.latitude,c=r.longitude,d=o.latitude,p=o.longitude;h.add(e,l,bS),i.cartesianToCartographic(bS,Lu);let f=Lu.latitude,m=Lu.longitude;u=Math.min(u,f),c=Math.min(c,m),d=Math.max(d,f),p=Math.max(p,m),h.subtract(e,l,bS),i.cartesianToCartographic(bS,Lu),f=Lu.latitude,m=Lu.longitude,u=Math.min(u,f),c=Math.min(c,m),d=Math.max(d,f),p=Math.max(p,m),r.latitude=u,r.longitude=c,o.latitude=d,o.longitude=p}var Mu=new h,TS=new h,Xc=new fe,Kc=new fe;function tJ(e,t,i,n,r){e=JQ(e,t);let o=go(e,h.equalsEpsilon),a=o.length;if(a<2||i<=0)return new ce;let s,l,c=.5*i;if(Xc.latitude=Number.POSITIVE_INFINITY,Xc.longitude=Number.POSITIVE_INFINITY,Kc.latitude=Number.NEGATIVE_INFINITY,Kc.longitude=Number.NEGATIVE_INFINITY,n===Ri.ROUNDED){let e=o[0];h.subtract(e,o[1],Mu),h.normalize(Mu,Mu),h.multiplyByScalar(Mu,c,Mu),h.add(e,Mu,TS),t.cartesianToCartographic(TS,Lu),s=Lu.latitude,l=Lu.longitude,Xc.latitude=Math.min(Xc.latitude,s),Xc.longitude=Math.min(Xc.longitude,l),Kc.latitude=Math.max(Kc.latitude,s),Kc.longitude=Math.max(Kc.longitude,l)}for(let e=0;e<a-1;++e)KQ(o[e],o[e+1],t,c,Xc,Kc);let d=o[a-1];h.subtract(d,o[a-2],Mu),h.normalize(Mu,Mu),h.multiplyByScalar(Mu,c,Mu),h.add(d,Mu,TS),KQ(d,TS,t,c,Xc,Kc),n===Ri.ROUNDED&&(t.cartesianToCartographic(TS,Lu),s=Lu.latitude,l=Lu.longitude,Xc.latitude=Math.min(Xc.latitude,s),Xc.longitude=Math.min(Xc.longitude,l),Kc.latitude=Math.max(Kc.latitude,s),Kc.longitude=Math.max(Kc.longitude,l));let p=u(r)?r:new ce;return p.north=Kc.latitude,p.south=Xc.latitude,p.east=Kc.longitude,p.west=Xc.longitude,p}function Um(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions,i=e.width,n=y(e.height,0),r=y(e.extrudedHeight,n);this._positions=t,this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._vertexFormat=Pe.clone(y(e.vertexFormat,Pe.DEFAULT)),this._width=i,this._height=Math.max(n,r),this._extrudedHeight=Math.min(n,r),this._cornerType=y(e.cornerType,Ri.ROUNDED),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._shadowVolume=y(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*h.packedLength+ie.packedLength+Pe.packedLength+7}Um.pack=function(e,t,i){i=y(i,0);let n=e._positions,r=n.length;t[i++]=r;for(let e=0;e<r;++e,i+=h.packedLength)h.pack(n[e],t,i);return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i++]=e._shadowVolume?1:0,t[i]=y(e._offsetAttribute,-1),t};var nJ=ie.clone(ie.UNIT_SPHERE),iJ=new Pe,Vm={positions:void 0,ellipsoid:nJ,vertexFormat:iJ,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};Um.unpack=function(e,t,i){t=y(t,0);let n=e[t++],r=new Array(n);for(let i=0;i<n;++i,t+=h.packedLength)r[i]=h.unpack(e,t);let o=ie.unpack(e,t,nJ);t+=ie.packedLength;let a=Pe.unpack(e,t,iJ);t+=Pe.packedLength;let s=e[t++],l=e[t++],c=e[t++],d=e[t++],p=e[t++],f=1===e[t++],m=e[t];return u(i)?(i._positions=r,i._ellipsoid=ie.clone(o,i._ellipsoid),i._vertexFormat=Pe.clone(a,i._vertexFormat),i._width=s,i._height=l,i._extrudedHeight=c,i._cornerType=d,i._granularity=p,i._shadowVolume=f,i._offsetAttribute=-1===m?void 0:m,i):(Vm.positions=r,Vm.width=s,Vm.height=l,Vm.extrudedHeight=c,Vm.cornerType=d,Vm.granularity=p,Vm.shadowVolume=f,Vm.offsetAttribute=-1===m?void 0:m,new Um(Vm))},Um.computeRectangle=function(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).positions,n=e.width;return tJ(i,y(e.ellipsoid,ie.WGS84),n,y(e.cornerType,Ri.ROUNDED),t)},Um.createGeometry=function(e){let t=e._positions,i=e._width,n=e._ellipsoid;t=JQ(t,n);let r=go(t,h.equalsEpsilon);if(r.length<2||i<=0)return;let o,a=e._height,s=e._extrudedHeight,l=!P.equalsEpsilon(a,s,0,P.EPSILON2),c=e._vertexFormat,d={ellipsoid:n,positions:r,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0};if(l)d.height=a,d.extrudedHeight=s,d.shadowVolume=e._shadowVolume,d.offsetAttribute=e._offsetAttribute,o=bIe(d,c);else{if(o=eJ(Bi.computePositions(d),c,n),o.attributes.position.values=ei.scaleToGeodeticHeight(o.attributes.position.values,a,n),u(e._offsetAttribute)){let t=e._offsetAttribute===on.NONE?0:1,i=o.attributes.position.values.length,n=new Uint8Array(i/3).fill(t);o.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}}let p=o.attributes,f=se.fromVertices(p.position.values,void 0,3);return c.position||(o.attributes.position.values=void 0),new ct({attributes:p,indices:o.indices,primitiveType:Ne.TRIANGLES,boundingSphere:f,offsetAttribute:e._offsetAttribute})},Um.createShadowVolume=function(e,t,i){let n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new Um({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:r,granularity:n,extrudedHeight:o,height:a,vertexFormat:Pe.POSITION_ONLY,shadowVolume:!0})},Object.defineProperties(Um.prototype,{rectangle:{get:function(){return u(this._rectangle)||(this._rectangle=tJ(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});var lT=Um,oJ=new h,rJ=new h,TIe=new h;function AIe(e,t){for(let i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function sJ(e,t){let i,n,r,o=[],a=e.positions,s=e.corners,l=e.endPositions,c=new hn,d=0,p=0,f=0;for(n=0;n<a.length;n+=2)r=a[n].length-3,d+=r,f+=r/3*4,p+=a[n+1].length-3;for(d+=3,p+=3,n=0;n<s.length;n++){i=s[n];let e=s[n].leftPositions;u(e)?(r=e.length,d+=r,f+=r/3*2):(r=s[n].rightPositions.length,p+=r,f+=r/3*2)}let m,_=u(l);_&&(m=l[0].length-3,d+=m,p+=m,m/=3,f+=4*m);let g,y,v,b,A,T,E=d+p,C=new Float64Array(E),x=0,S=E-1,w=m/2,I=ke.createTypedArray(E/3,f+4),P=0;if(I[P++]=x/3,I[P++]=(S-2)/3,_){o.push(x/3),T=oJ,A=rJ;let e=l[0];for(n=0;n<w;n++)T=h.fromArray(e,3*(w-1-n),T),A=h.fromArray(e,3*(w+n),A),Bi.addAttribute(C,A,x),Bi.addAttribute(C,T,void 0,S),y=x/3,b=y+1,g=(S-2)/3,v=g-1,I[P++]=g,I[P++]=v,I[P++]=y,I[P++]=b,x+=3,S-=3}let D=0,O=a[D++],L=a[D++];for(C.set(O,x),C.set(L,S-L.length+1),r=L.length-3,o.push(x/3,(S-2)/3),n=0;n<r;n+=3)y=x/3,b=y+1,g=(S-2)/3,v=g-1,I[P++]=g,I[P++]=v,I[P++]=y,I[P++]=b,x+=3,S-=3;for(n=0;n<s.length;n++){let e;i=s[n];let l,c=i.leftPositions,d=i.rightPositions,p=TIe;if(u(c)){for(S-=3,l=v,o.push(b),e=0;e<c.length/3;e++)p=h.fromArray(c,3*e,p),I[P++]=l-e-1,I[P++]=l-e,Bi.addAttribute(C,p,void 0,S),S-=3;o.push(l-Math.floor(c.length/6)),t===Ri.BEVELED&&o.push((S-2)/3+1),x+=3}else{for(x+=3,l=b,o.push(v),e=0;e<d.length/3;e++)p=h.fromArray(d,3*e,p),I[P++]=l+e,I[P++]=l+e+1,Bi.addAttribute(C,p,x),x+=3;o.push(l+Math.floor(d.length/6)),t===Ri.BEVELED&&o.push(x/3-1),S-=3}for(O=a[D++],L=a[D++],O.splice(0,3),L.splice(L.length-3,3),C.set(O,x),C.set(L,S-L.length+1),r=L.length-3,e=0;e<L.length;e+=3)b=x/3,y=b-1,v=(S-2)/3,g=v+1,I[P++]=g,I[P++]=v,I[P++]=y,I[P++]=b,x+=3,S-=3;x-=3,S+=3,o.push(x/3,(S-2)/3)}if(_){x+=3,S-=3,T=oJ,A=rJ;let e=l[1];for(n=0;n<w;n++)T=h.fromArray(e,3*(m-n-1),T),A=h.fromArray(e,3*n,A),Bi.addAttribute(C,T,void 0,S),Bi.addAttribute(C,A,x),b=x/3,y=b-1,v=(S-2)/3,g=v+1,I[P++]=g,I[P++]=v,I[P++]=y,I[P++]=b,x+=3,S-=3;o.push(x/3)}else o.push(x/3,(S-2)/3);return I[P++]=x/3,I[P++]=(S-2)/3,c.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:C}),{attributes:c,indices:I,wallIndices:o}}function CIe(e){let t=e.ellipsoid,i=sJ(Bi.computePositions(e),e.cornerType),n=i.wallIndices,r=e.height,o=e.extrudedHeight,a=i.attributes,s=i.indices,l=a.position.values,c=l.length,h=new Float64Array(c);h.set(l);let d=new Float64Array(2*c);if(l=ei.scaleToGeodeticHeight(l,r,t),h=ei.scaleToGeodeticHeight(h,o,t),d.set(l),d.set(h,c),a.position.values=d,c/=3,u(e.offsetAttribute)){let t=new Uint8Array(2*c);if(e.offsetAttribute===on.TOP)t=t.fill(1,0,c);else{let i=e.offsetAttribute===on.NONE?0:1;t=t.fill(i)}a.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let p,f=s.length,m=ke.createTypedArray(d.length/3,2*(f+n.length));m.set(s);let _,g,y=f;for(p=0;p<f;p+=2){let e=s[p],t=s[p+1];m[y++]=e+c,m[y++]=t+c}for(p=0;p<n.length;p++)_=n[p],g=_+c,m[y++]=_,m[y++]=g;return{attributes:a,indices:m}}function AS(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions,i=e.width,n=y(e.height,0),r=y(e.extrudedHeight,n);this._positions=t,this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._width=i,this._height=Math.max(n,r),this._extrudedHeight=Math.min(n,r),this._cornerType=y(e.cornerType,Ri.ROUNDED),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*h.packedLength+ie.packedLength+6}AS.pack=function(e,t,i){i=y(i,0);let n=e._positions,r=n.length;t[i++]=r;for(let e=0;e<r;++e,i+=h.packedLength)h.pack(n[e],t,i);return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=y(e._offsetAttribute,-1),t};var aJ=ie.clone(ie.UNIT_SPHERE),S_={positions:void 0,ellipsoid:aJ,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};AS.unpack=function(e,t,i){t=y(t,0);let n=e[t++],r=new Array(n);for(let i=0;i<n;++i,t+=h.packedLength)r[i]=h.unpack(e,t);let o=ie.unpack(e,t,aJ);t+=ie.packedLength;let a=e[t++],s=e[t++],l=e[t++],c=e[t++],d=e[t++],p=e[t];return u(i)?(i._positions=r,i._ellipsoid=ie.clone(o,i._ellipsoid),i._width=a,i._height=s,i._extrudedHeight=l,i._cornerType=c,i._granularity=d,i._offsetAttribute=-1===p?void 0:p,i):(S_.positions=r,S_.width=a,S_.height=s,S_.extrudedHeight=l,S_.cornerType=c,S_.granularity=d,S_.offsetAttribute=-1===p?void 0:p,new AS(S_))},AS.createGeometry=function(e){let t=e._positions,i=e._width,n=e._ellipsoid;t=AIe(t,n);let r=go(t,h.equalsEpsilon);if(r.length<2||i<=0)return;let o,a=e._height,s=e._extrudedHeight,l=!P.equalsEpsilon(a,s,0,P.EPSILON2),c={ellipsoid:n,positions:r,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1};if(l)c.height=a,c.extrudedHeight=s,c.offsetAttribute=e._offsetAttribute,o=CIe(c);else{if(o=sJ(Bi.computePositions(c),c.cornerType),o.attributes.position.values=ei.scaleToGeodeticHeight(o.attributes.position.values,a,n),u(e._offsetAttribute)){let t=o.attributes.position.values.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);o.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}}let d=o.attributes,p=se.fromVertices(d.position.values,void 0,3);return new ct({attributes:d,indices:o.indices,primitiveType:Ne.LINES,boundingSphere:p,offsetAttribute:e._offsetAttribute})};var I1=AS;function EIe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}var jn=EIe;function SIe(e){return e=y(e,y.EMPTY_OBJECT),KP.fromIonAssetId(1,{requestVertexNormals:y(e.requestVertexNormals,!1),requestWaterMask:y(e.requestWaterMask,!1)})}var uT=SIe;function Nu(e){this.planes=y(e,[])}var CS=[new h,new h,new h];h.clone(h.UNIT_X,CS[0]),h.clone(h.UNIT_Y,CS[1]),h.clone(h.UNIT_Z,CS[2]);var w_=new h,wIe=new h,cJ=new tn(new h(1,0,0),0);Nu.fromBoundingSphere=function(e,t){u(t)||(t=new Nu);let i=CS.length,n=t.planes;n.length=2*i;let r=e.center,o=e.radius,a=0;for(let e=0;e<i;++e){let t=CS[e],i=n[a],s=n[a+1];u(i)||(i=n[a]=new oe),u(s)||(s=n[a+1]=new oe),h.multiplyByScalar(t,-o,w_),h.add(r,w_,w_),i.x=t.x,i.y=t.y,i.z=t.z,i.w=-h.dot(t,w_),h.multiplyByScalar(t,o,w_),h.add(r,w_,w_),s.x=-t.x,s.y=-t.y,s.z=-t.z,s.w=-h.dot(h.negate(t,wIe),w_),a+=2}return t},Nu.prototype.computeVisibility=function(e){let t=this.planes,i=!1;for(let n=0,r=t.length;n<r;++n){let r=e.intersectPlane(tn.fromCartesian4(t[n],cJ));if(r===Zt.OUTSIDE)return Zt.OUTSIDE;r===Zt.INTERSECTING&&(i=!0)}return i?Zt.INTERSECTING:Zt.INSIDE},Nu.prototype.computeVisibilityWithPlaneMask=function(e,t){if(t===Nu.MASK_OUTSIDE||t===Nu.MASK_INSIDE)return t;let i=Nu.MASK_INSIDE,n=this.planes;for(let r=0,o=n.length;r<o;++r){let o=r<31?1<<r:0;if(r<31&&!(t&o))continue;let a=e.intersectPlane(tn.fromCartesian4(n[r],cJ));if(a===Zt.OUTSIDE)return Nu.MASK_OUTSIDE;a===Zt.INTERSECTING&&(i|=o)}return i},Nu.MASK_OUTSIDE=4294967295,Nu.MASK_INSIDE=0,Nu.MASK_INDETERMINATE=2147483647;var ns=Nu;function fT(e){e=y(e,y.EMPTY_OBJECT),this._callback=e.callback,this._tilingScheme=e.tilingScheme,u(this._tilingScheme)||(this._tilingScheme=new Ui({ellipsoid:y(e.ellipsoid,ie.WGS84)})),this._width=e.width,this._height=e.height;let t=Math.max(this._width,this._height);this._levelZeroMaximumGeometricError=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,t,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new pe;let i=e.credit;"string"==typeof i&&(i=new xt(i)),this._credit=i}Object.defineProperties(fT.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),fT.prototype.requestTileGeometry=function(e,t,i,n){let r=this._callback(e,t,i);if(!u(r))return;let o=this._width,a=this._height;return Promise.resolve(r).then((function(e){let t=e;return Array.isArray(t)&&(t=new Float64Array(t)),new va({buffer:t,width:o,height:a})}))},fT.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},fT.prototype.getTileDataAvailable=function(e,t,i){},fT.prototype.loadTileDataAvailability=function(e,t,i){};var lJ=fT,uJ={computePositions:function(e,t,i,n,r){let o,a=.5*e,s=-a,l=n+n,u=new Float64Array(3*(r?2*l:l)),c=0,h=0,d=r?3*l:0,p=r?3*(l+n):3*n;for(o=0;o<n;o++){let e=o/n*P.TWO_PI,l=Math.cos(e),f=Math.sin(e),m=l*i,_=f*i,g=l*t,y=f*t;u[h+d]=m,u[h+d+1]=_,u[h+d+2]=s,u[h+p]=g,u[h+p+1]=y,u[h+p+2]=a,h+=3,r&&(u[c++]=m,u[c++]=_,u[c++]=s,u[c++]=g,u[c++]=y,u[c++]=a)}return u}},dT=uJ,oG=new U,vIe=new h,DIe=new h,IIe=new h,PIe=new h;function zm(e){let t=(e=y(e,y.EMPTY_OBJECT)).length,i=e.topRadius,n=e.bottomRadius,r=y(e.vertexFormat,Pe.DEFAULT),o=y(e.slices,128);this._length=t,this._topRadius=i,this._bottomRadius=n,this._vertexFormat=Pe.clone(r),this._slices=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}zm.packedLength=Pe.packedLength+5,zm.pack=function(e,t,i){return i=y(i,0),Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i]=y(e._offsetAttribute,-1),t};var fJ=new Pe,hT={vertexFormat:fJ,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0},rG;zm.unpack=function(e,t,i){t=y(t,0);let n=Pe.unpack(e,t,fJ);t+=Pe.packedLength;let r=e[t++],o=e[t++],a=e[t++],s=e[t++],l=e[t];return u(i)?(i._vertexFormat=Pe.clone(n,i._vertexFormat),i._length=r,i._topRadius=o,i._bottomRadius=a,i._slices=s,i._offsetAttribute=-1===l?void 0:l,i):(hT.length=r,hT.topRadius=o,hT.bottomRadius=a,hT.slices=s,hT.offsetAttribute=-1===l?void 0:l,new zm(hT))},zm.createGeometry=function(e){let t=e._length,i=e._topRadius,n=e._bottomRadius,r=e._vertexFormat,o=e._slices;if(t<=0||i<0||n<0||0===i&&0===n)return;let a,s=o+o,l=o+s,c=s+s,d=dT.computePositions(t,i,n,o,!0),p=r.st?new Float32Array(2*c):void 0,f=r.normal?new Float32Array(3*c):void 0,m=r.tangent?new Float32Array(3*c):void 0,_=r.bitangent?new Float32Array(3*c):void 0,g=r.normal||r.tangent||r.bitangent;if(g){let e=r.tangent||r.bitangent,s=0,l=0,u=0,c=Math.atan2(n-i,t),d=vIe;d.z=Math.sin(c);let p=Math.cos(c),y=IIe,v=DIe;for(a=0;a<o;a++){let t=a/o*P.TWO_PI,i=p*Math.cos(t),n=p*Math.sin(t);g&&(d.x=i,d.y=n,e&&(y=h.normalize(h.cross(h.UNIT_Z,d,y),y)),r.normal&&(f[s++]=d.x,f[s++]=d.y,f[s++]=d.z,f[s++]=d.x,f[s++]=d.y,f[s++]=d.z),r.tangent&&(m[l++]=y.x,m[l++]=y.y,m[l++]=y.z,m[l++]=y.x,m[l++]=y.y,m[l++]=y.z),r.bitangent&&(v=h.normalize(h.cross(d,y,v),v),_[u++]=v.x,_[u++]=v.y,_[u++]=v.z,_[u++]=v.x,_[u++]=v.y,_[u++]=v.z))}for(a=0;a<o;a++)r.normal&&(f[s++]=0,f[s++]=0,f[s++]=-1),r.tangent&&(m[l++]=1,m[l++]=0,m[l++]=0),r.bitangent&&(_[u++]=0,_[u++]=-1,_[u++]=0);for(a=0;a<o;a++)r.normal&&(f[s++]=0,f[s++]=0,f[s++]=1),r.tangent&&(m[l++]=1,m[l++]=0,m[l++]=0),r.bitangent&&(_[u++]=0,_[u++]=1,_[u++]=0)}let y=12*o-12,v=ke.createTypedArray(c,y),b=0,A=0;for(a=0;a<o-1;a++)v[b++]=A,v[b++]=A+2,v[b++]=A+3,v[b++]=A,v[b++]=A+3,v[b++]=A+1,A+=2;for(v[b++]=s-2,v[b++]=0,v[b++]=1,v[b++]=s-2,v[b++]=1,v[b++]=s-1,a=1;a<o-1;a++)v[b++]=s+a+1,v[b++]=s+a,v[b++]=s;for(a=1;a<o-1;a++)v[b++]=l,v[b++]=l+a,v[b++]=l+a+1;let T=0;if(r.st){let e=Math.max(i,n);for(a=0;a<c;a++){let t=h.fromArray(d,3*a,PIe);p[T++]=(t.x+e)/(2*e),p[T++]=(t.y+e)/(2*e)}}let E=new hn;r.position&&(E.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:d})),r.normal&&(E.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:f})),r.tangent&&(E.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:m})),r.bitangent&&(E.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:_})),r.st&&(E.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:p})),oG.x=.5*t,oG.y=Math.max(n,i);let C=new se(h.ZERO,U.magnitude(oG));if(u(e._offsetAttribute)){t=d.length;let i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);E.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:E,indices:v,primitiveType:Ne.TRIANGLES,boundingSphere:C,offsetAttribute:e._offsetAttribute})},zm.getUnitCylinder=function(){return u(rG)||(rG=zm.createGeometry(new zm({topRadius:1,bottomRadius:1,length:1,vertexFormat:Pe.POSITION_ONLY}))),rG};var P1=zm,sG=new U;function mT(e){let t=(e=y(e,y.EMPTY_OBJECT)).length,i=e.topRadius,n=e.bottomRadius,r=y(e.slices,128),o=Math.max(y(e.numberOfVerticalLines,16),0);this._length=t,this._topRadius=i,this._bottomRadius=n,this._slices=r,this._numberOfVerticalLines=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}mT.packedLength=6,mT.pack=function(e,t,i){return i=y(i,0),t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i++]=e._numberOfVerticalLines,t[i]=y(e._offsetAttribute,-1),t};var _0={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};mT.unpack=function(e,t,i){t=y(t,0);let n=e[t++],r=e[t++],o=e[t++],a=e[t++],s=e[t++],l=e[t];return u(i)?(i._length=n,i._topRadius=r,i._bottomRadius=o,i._slices=a,i._numberOfVerticalLines=s,i._offsetAttribute=-1===l?void 0:l,i):(_0.length=n,_0.topRadius=r,_0.bottomRadius=o,_0.slices=a,_0.numberOfVerticalLines=s,_0.offsetAttribute=-1===l?void 0:l,new mT(_0))},mT.createGeometry=function(e){let t=e._length,i=e._topRadius,n=e._bottomRadius,r=e._slices,o=e._numberOfVerticalLines;if(t<=0||i<0||n<0||0===i&&0===n)return;let a,s=2*r,l=dT.computePositions(t,i,n,r,!1),c=2*r;if(o>0){let e=Math.min(o,r);a=Math.round(r/e),c+=e}let d,p=ke.createTypedArray(s,2*c),f=0;for(d=0;d<r-1;d++)p[f++]=d,p[f++]=d+1,p[f++]=d+r,p[f++]=d+1+r;if(p[f++]=r-1,p[f++]=0,p[f++]=r+r-1,p[f++]=r,o>0)for(d=0;d<r;d+=a)p[f++]=d,p[f++]=d+r;let m=new hn;m.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:l}),sG.x=.5*t,sG.y=Math.max(n,i);let _=new se(h.ZERO,U.magnitude(sG));if(u(e._offsetAttribute)){t=l.length;let i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);m.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:m,indices:p,primitiveType:Ne.LINES,boundingSphere:_,offsetAttribute:e._offsetAttribute})};var O1=mT,OIe=1953029805,RIe=2917034100;function aG(e,t){if(aG.passThroughDataForTesting)return t;let i=e.byteLength;if(0===i||i%4!=0)throw new ue("The length of key must be greater than 0 and a multiple of 4.");let n=new DataView(t),r=n.getUint32(0,!0);if(r===OIe||r===RIe)return t;let o,a=new DataView(e),s=0,l=t.byteLength,u=l-l%8,c=i,h=8;for(;s<u;)for(h=(h+8)%24,o=h;s<u&&o<c;)n.setUint32(s,n.getUint32(s,!0)^a.getUint32(o,!0),!0),n.setUint32(s+4,n.getUint32(s+4,!0)^a.getUint32(o+4,!0),!0),s+=8,o+=24;if(s<l)for(o>=c&&(h=(h+8)%24,o=h);s<l;)n.setUint8(s,n.getUint8(s)^a.getUint8(o)),s++,o++}aG.passThroughDataForTesting=!1;var R1=aG,cG=32767,MIe=new fe,LIe=new h;function NIe(e,t,i,n,r){let o=e.length/3,a=e.subarray(0,o),s=e.subarray(o,2*o),l=e.subarray(2*o,3*o);Gn.zigZagDeltaDecode(a,s,l);let u=new Float64Array(e.length);for(let e=0;e<o;++e){let o=a[e],c=s[e],d=l[e],p=P.lerp(t.west,t.east,o/cG),f=P.lerp(t.south,t.north,c/cG),m=P.lerp(i,n,d/cG),_=fe.fromRadians(p,f,m,MIe),g=r.cartographicToCartesian(_,LIe);h.pack(g,u,3*e)}return u}var M1=NIe;function dJ(e){this.proxy=e}dJ.prototype.getURL=function(e){let t=-1===this.proxy.indexOf("?")?"?":"";return this.proxy+t+encodeURIComponent(e)};var hJ=dJ;function FIe(e,t){It(e,t)}var is=FIe;function Rl(e,t){e=y(e,0),this._near=e,t=y(t,Number.MAX_VALUE),this._far=t}Object.defineProperties(Rl.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}}),Rl.packedLength=2,Rl.pack=function(e,t,i){return i=y(i,0),t[i++]=e.near,t[i]=e.far,t},Rl.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Rl),i.near=e[t++],i.far=e[t],i},Rl.equals=function(e,t){return e===t||u(e)&&u(t)&&e.near===t.near&&e.far===t.far},Rl.clone=function(e,t){if(u(e))return u(t)||(t=new Rl),t.near=e.near,t.far=e.far,t},Rl.prototype.clone=function(e){return Rl.clone(this,e)},Rl.prototype.equals=function(e){return Rl.equals(this,e)};var wt=Rl;function ES(e,t){e=y(e,0),t=y(t,Number.MAX_VALUE),this.value=new Float32Array([e,t])}Object.defineProperties(ES.prototype,{componentDatatype:{get:function(){return X.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),ES.fromDistanceDisplayCondition=function(e){return new ES(e.near,e.far)},ES.toValue=function(e,t){return u(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])};var Vn=ES;function Wf(e){this._comparator=e.comparator,this._maximumLength=e.maximumLength,this._array=u(e.maximumLength)?new Array(e.maximumLength):[],this._length=0}function L1(e,t,i){let n=e._array,r=n[t];n[t]=n[i],n[i]=r}function SS(e,t,i){return e._comparator(e._array[t],e._array[i])<0}function lG(e,t,i){return e._comparator(e._array[t],e._array[i])>0}function mJ(e,t){if(0===t)return;let i=Math.floor(P.log2(t+1))%2==0,n=Math.floor((t-1)/2),r=SS(e,t,n);for(r!==i&&(L1(e,t,n),t=n);t>=3;){let i=Math.floor((t-3)/4);if(SS(e,t,i)!==r)break;L1(e,t,i),t=i}}function pJ(e,t){let i,n=e._length,r=Math.floor(P.log2(t+1))%2==0;for(;(i=2*t+1)<n;){let o=i,a=i+1;if(a<n){SS(e,a,o)===r&&(o=a);let t=2*i+1,s=Math.max(Math.min(n-t,4),0);for(let i=0;i<s;i++){let n=t+i;SS(e,n,o)===r&&(o=n)}}if(SS(e,o,t)===r&&(L1(e,o,t),o!==i&&o!==a)){let t=Math.floor((o-1)/2);lG(e,o,t)===r&&L1(e,o,t)}t=o}}Object.defineProperties(Wf.prototype,{length:{get:function(){return this._length}},maximumLength:{get:function(){return this._maximumLength},set:function(e){if(u(e)){for(;this._length>e;)this.removeMinimum();this._array.length=e}this._maximumLength=e}},internalArray:{get:function(){return this._array}},comparator:{get:function(){return this._comparator}}}),Wf.prototype.clone=function(){let e=this._maximumLength,t=this._comparator,i=this._array,n=this._length,r=new Wf({comparator:t,maximumLength:e});r._length=n;for(let e=0;e<n;e++)r._array[e]=i[e];return r},Wf.prototype.reset=function(){this._length=0;let e=this._maximumLength;if(u(e))for(let t=0;t<e;t++)this._array[t]=void 0;else this._array.length=0},Wf.prototype.resort=function(){let e=this._length;for(let t=0;t<e;t++)mJ(this,t)},Wf.prototype.insert=function(e){let t,i=this._maximumLength;if(u(i)){if(0===i)return;if(this._length===i){let i=this._array[0];if(this._comparator(e,i)<=0)return e;t=this.removeMinimum()}}let n=this._length;return this._array[n]=e,this._length++,mJ(this,n),t},Wf.prototype.removeMinimum=function(){let e=this._length;if(0===e)return;this._length--;let t=this._array[0];return e>=2&&(this._array[0]=this._array[e-1],pJ(this,0)),this._array[e-1]=void 0,t},Wf.prototype.removeMaximum=function(){let e,t=this._length;if(0!==t){if(this._length--,t<=2)e=this._array[t-1];else{let i=lG(this,1,2)?1:2;e=this._array[i],this._array[i]=this._array[t-1],t>=4&&pJ(this,i)}return this._array[t-1]=void 0,e}},Wf.prototype.getMinimum=function(){if(0!==this._length)return this._array[0]},Wf.prototype.getMaximum=function(){let e=this._length;if(0!==e)return e<=2?this._array[e-1]:this._array[lG(this,1,2)?1:2]};var pT=Wf;function wS(){this.head=void 0,this.tail=void 0,this._length=0}function BIe(e,t,i){this.item=e,this.previous=t,this.next=i}function _J(e,t){u(t.previous)&&u(t.next)?(t.previous.next=t.next,t.next.previous=t.previous):u(t.previous)?(t.previous.next=void 0,e.tail=t.previous):u(t.next)?(t.next.previous=void 0,e.head=t.next):(e.head=void 0,e.tail=void 0),t.next=void 0,t.previous=void 0}Object.defineProperties(wS.prototype,{length:{get:function(){return this._length}}}),wS.prototype.add=function(e){let t=new BIe(e,this.tail,void 0);return u(this.tail)?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t},wS.prototype.remove=function(e){u(e)&&(_J(this,e),--this._length)},wS.prototype.splice=function(e,t){if(e===t)return;_J(this,t);let i=e.next;e.next=t,this.tail===e?this.tail=t:i.previous=t,t.next=i,t.previous=e};var N1=wS,Ci=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-Ci.Bounce.Out(1-e)},Out:function(e){return e<.36363636363636365?7.5625*e*e:e<.7272727272727273?7.5625*(e-=.5454545454545454)*e+.75:e<.9090909090909091?7.5625*(e-=.8181818181818182)*e+.9375:7.5625*(e-=.9545454545454546)*e+.984375},InOut:function(e){return e<.5?.5*Ci.Bounce.In(2*e):.5*Ci.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),vS=function(){return performance.now()},kIe=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=vS()),void 0===t&&(t=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var r=this._tweens[i[n]],o=!t;r&&!1===r.update(e,o)&&!t&&delete this._tweens[i[n]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),_T={Linear:function(e,t){var i=e.length-1,n=i*t,r=Math.floor(n),o=_T.Utils.Linear;return t<0?o(e[0],e[1],n):t>1?o(e[i],e[i-1],i-n):o(e[r],e[r+1>i?i:r+1],n-r)},Bezier:function(e,t){for(var i=0,n=e.length-1,r=Math.pow,o=_T.Utils.Bernstein,a=0;a<=n;a++)i+=r(1-t,n-a)*r(t,a)*e[a]*o(n,a);return i},CatmullRom:function(e,t){var i=e.length-1,n=i*t,r=Math.floor(n),o=_T.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(r=Math.floor(n=i*(1+t))),o(e[(r-1+i)%i],e[r],e[(r+1)%i],e[(r+2)%i],n-r)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(o(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):o(e[r?r-1:0],e[r],e[i<r+1?i:r+1],e[i<r+2?i:r+2],n-r)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=_T.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:(e=[1],function(t){var i=1;if(e[t])return e[t];for(var n=t;n>1;n--)i*=n;return e[t]=i,i}),CatmullRom:function(e,t,i,n,r){var o=.5*(i-e),a=.5*(n-t),s=r*r;return(2*t-2*i+o+a)*(r*s)+(-3*t+3*i-2*o-a)*s+o*r+t}}},gJ=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),uG=new kIe,yJ=function(){function e(e,t){void 0===t&&(t=uG),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Ci.Linear.None,this._interpolationFunction=_T.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=gJ.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=vS()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var i in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var n={};for(var r in this._valuesEnd)n[r]=this._valuesEnd[r];this._valuesEnd=n}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,i,n,r){for(var o in i){var a=e[o],s=Array.isArray(a),l=s?"array":typeof a,u=!s&&Array.isArray(i[o]);if("undefined"!==l&&"function"!==l){if(u){if(0===(_=i[o]).length)continue;for(var c=[a],h=0,d=_.length;h<d;h+=1){var p=this._handleRelativeValue(a,_[h]);if(isNaN(p)){u=!1,console.warn("Found invalid interpolation list. Skipping.");break}c.push(p)}u&&(i[o]=c)}if("object"!==l&&!s||!a||u)(typeof t[o]>"u"||r)&&(t[o]=a),s||(t[o]*=1),n[o]=u?i[o].slice().reverse():t[o]||0;else{t[o]=s?[]:{};var f=a;for(var m in f)t[o][m]=f[m];n[o]=s?[]:{};var _=i[o];if(!this._isDynamic){var g={};for(var m in _)g[m]=_[m];i[o]=_=g}this._setupProperties(f,t[o],_,n[o],r)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=vS()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=vS()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return void 0===e&&(e=uG),this._group=e,this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=Ci.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=_T.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=vS()),void 0===t&&(t=!0),this._isPaused)return!0;var i,n,r=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>r)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||n>1?1:n;var o=this._easingFunction(n);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)!this._yoyo&&"string"==typeof this._valuesEnd[i]&&(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var a=0,s=this._chainedTweens.length;a<s;a++)this._chainedTweens[a].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,i,n){for(var r in i)if(void 0!==t[r]){var o=t[r]||0,a=i[r],s=Array.isArray(e[r]),l=Array.isArray(a);!s&&l?e[r]=this._interpolationFunction(a,n):"object"==typeof a&&a?this._updateProperties(e[r],o,a,n):"number"==typeof(a=this._handleRelativeValue(o,a))&&(e[r]=o+(a-o)*n)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof i?this._valuesStartRepeat[e]+parseFloat(i):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),e,n2t=gJ.nextId,gh=uG,i2t=gh.getAll.bind(gh),o2t=gh.removeAll.bind(gh),r2t=gh.add.bind(gh),s2t=gh.remove.bind(gh),a2t=gh.update.bind(gh),VIe={LINEAR_NONE:Ci.Linear.None,QUADRATIC_IN:Ci.Quadratic.In,QUADRATIC_OUT:Ci.Quadratic.Out,QUADRATIC_IN_OUT:Ci.Quadratic.InOut,CUBIC_IN:Ci.Cubic.In,CUBIC_OUT:Ci.Cubic.Out,CUBIC_IN_OUT:Ci.Cubic.InOut,QUARTIC_IN:Ci.Quartic.In,QUARTIC_OUT:Ci.Quartic.Out,QUARTIC_IN_OUT:Ci.Quartic.InOut,QUINTIC_IN:Ci.Quintic.In,QUINTIC_OUT:Ci.Quintic.Out,QUINTIC_IN_OUT:Ci.Quintic.InOut,SINUSOIDAL_IN:Ci.Sinusoidal.In,SINUSOIDAL_OUT:Ci.Sinusoidal.Out,SINUSOIDAL_IN_OUT:Ci.Sinusoidal.InOut,EXPONENTIAL_IN:Ci.Exponential.In,EXPONENTIAL_OUT:Ci.Exponential.Out,EXPONENTIAL_IN_OUT:Ci.Exponential.InOut,CIRCULAR_IN:Ci.Circular.In,CIRCULAR_OUT:Ci.Circular.Out,CIRCULAR_IN_OUT:Ci.Circular.InOut,ELASTIC_IN:Ci.Elastic.In,ELASTIC_OUT:Ci.Elastic.Out,ELASTIC_IN_OUT:Ci.Elastic.InOut,BACK_IN:Ci.Back.In,BACK_OUT:Ci.Back.Out,BACK_IN_OUT:Ci.Back.InOut,BOUNCE_IN:Ci.Bounce.In,BOUNCE_OUT:Ci.Bounce.Out,BOUNCE_IN_OUT:Ci.Bounce.InOut},Ir=Object.freeze(VIe),UIe=new h,zIe=new h,HIe=new h,GIe=new h,WIe=new h,jIe=new h(1,1,1),xJ=Math.cos,bJ=Math.sin;function Hm(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.radii,jIe),i=y(e.innerRadii,t),n=y(e.minimumClock,0),r=y(e.maximumClock,P.TWO_PI),o=y(e.minimumCone,0),a=y(e.maximumCone,P.PI),s=Math.round(y(e.stackPartitions,64)),l=Math.round(y(e.slicePartitions,64)),u=y(e.vertexFormat,Pe.DEFAULT);this._radii=h.clone(t),this._innerRadii=h.clone(i),this._minimumClock=n,this._maximumClock=r,this._minimumCone=o,this._maximumCone=a,this._stackPartitions=s,this._slicePartitions=l,this._vertexFormat=Pe.clone(u),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}Hm.packedLength=2*h.packedLength+Pe.packedLength+7,Hm.pack=function(e,t,i){return i=y(i,0),h.pack(e._radii,t,i),i+=h.packedLength,h.pack(e._innerRadii,t,i),i+=h.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._minimumClock,t[i++]=e._maximumClock,t[i++]=e._minimumCone,t[i++]=e._maximumCone,t[i++]=e._stackPartitions,t[i++]=e._slicePartitions,t[i]=y(e._offsetAttribute,-1),t};var TJ=new h,AJ=new h,CJ=new Pe,v_={radii:TJ,innerRadii:AJ,vertexFormat:CJ,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0},fG;Hm.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t,TJ);t+=h.packedLength;let r=h.unpack(e,t,AJ);t+=h.packedLength;let o=Pe.unpack(e,t,CJ);t+=Pe.packedLength;let a=e[t++],s=e[t++],l=e[t++],c=e[t++],d=e[t++],p=e[t++],f=e[t];return u(i)?(i._radii=h.clone(n,i._radii),i._innerRadii=h.clone(r,i._innerRadii),i._vertexFormat=Pe.clone(o,i._vertexFormat),i._minimumClock=a,i._maximumClock=s,i._minimumCone=l,i._maximumCone=c,i._stackPartitions=d,i._slicePartitions=p,i._offsetAttribute=-1===f?void 0:f,i):(v_.minimumClock=a,v_.maximumClock=s,v_.minimumCone=l,v_.maximumCone=c,v_.stackPartitions=d,v_.slicePartitions=p,v_.offsetAttribute=-1===f?void 0:f,new Hm(v_))},Hm.createGeometry=function(e){let t=e._radii;if(t.x<=0||t.y<=0||t.z<=0)return;let i=e._innerRadii;if(i.x<=0||i.y<=0||i.z<=0)return;let n=e._minimumClock,r=e._maximumClock,o=e._minimumCone,a=e._maximumCone,s=e._vertexFormat,l=e._slicePartitions+1,c=e._stackPartitions+1;l=Math.round(l*Math.abs(r-n)/P.TWO_PI),c=Math.round(c*Math.abs(a-o)/P.PI),l<2&&(l=2),c<2&&(c=2);let d,p,f=0,m=[o],_=[n];for(d=0;d<c;d++)m.push(o+d*(a-o)/(c-1));for(m.push(a),p=0;p<l;p++)_.push(n+p*(r-n)/(l-1));_.push(r);let g=m.length,y=_.length,v=0,b=1,A=i.x!==t.x||i.y!==t.y||i.z!==t.z,T=!1,E=!1,C=!1;A&&(b=2,o>0&&(T=!0,v+=l-1),a<Math.PI&&(E=!0,v+=l-1),(r-n)%P.TWO_PI?(C=!0,v+=2*(c-1)+1):v+=1);let x=y*g*b,S=new Float64Array(3*x),w=new Array(x).fill(!1),I=new Array(x).fill(!1),D=l*c*b,O=6*(D+v+1-(l+c)*b),L=ke.createTypedArray(D,O),R=s.normal?new Float32Array(3*x):void 0,N=s.tangent?new Float32Array(3*x):void 0,M=s.bitangent?new Float32Array(3*x):void 0,F=s.st?new Float32Array(2*x):void 0,B=new Array(g),z=new Array(g);for(d=0;d<g;d++)B[d]=bJ(m[d]),z[d]=xJ(m[d]);let k=new Array(y),V=new Array(y);for(p=0;p<y;p++)V[p]=xJ(_[p]),k[p]=bJ(_[p]);for(d=0;d<g;d++)for(p=0;p<y;p++)S[f++]=t.x*B[d]*V[p],S[f++]=t.y*B[d]*k[p],S[f++]=t.z*z[d];let H,G,j,W,q=x/2;if(A)for(d=0;d<g;d++)for(p=0;p<y;p++)S[f++]=i.x*B[d]*V[p],S[f++]=i.y*B[d]*k[p],S[f++]=i.z*z[d],w[q]=!0,d>0&&d!==g-1&&0!==p&&p!==y-1&&(I[q]=!0),q++;for(f=0,d=1;d<g-2;d++)for(H=d*y,G=(d+1)*y,p=1;p<y-2;p++)L[f++]=G+p,L[f++]=G+p+1,L[f++]=H+p+1,L[f++]=G+p,L[f++]=H+p+1,L[f++]=H+p;if(A){let e=g*y;for(d=1;d<g-2;d++)for(H=e+d*y,G=e+(d+1)*y,p=1;p<y-2;p++)L[f++]=G+p,L[f++]=H+p,L[f++]=H+p+1,L[f++]=G+p,L[f++]=H+p+1,L[f++]=G+p+1}if(A){if(T)for(W=g*y,d=1;d<y-2;d++)L[f++]=d,L[f++]=d+1,L[f++]=W+d+1,L[f++]=d,L[f++]=W+d+1,L[f++]=W+d;if(E)for(j=g*y-y,W=g*y*b-y,d=1;d<y-2;d++)L[f++]=j+d+1,L[f++]=j+d,L[f++]=W+d,L[f++]=j+d+1,L[f++]=W+d,L[f++]=W+d+1}if(C){for(d=1;d<g-2;d++)W=y*g+y*d,j=y*d,L[f++]=W,L[f++]=j+y,L[f++]=j,L[f++]=W,L[f++]=W+y,L[f++]=j+y;for(d=1;d<g-2;d++)W=y*g+y*(d+1)-1,j=y*(d+1)-1,L[f++]=j+y,L[f++]=W,L[f++]=j,L[f++]=j+y,L[f++]=W+y,L[f++]=W}let Y=new hn;s.position&&(Y.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:S}));let $,K=0,J=0,Q=0,Z=0,ee=x/2,te=ie.fromCartesian3(t),ne=ie.fromCartesian3(i);if(s.st||s.normal||s.tangent||s.bitangent){for(d=0;d<x;d++){$=w[d]?ne:te;let e=h.fromArray(S,3*d,UIe),t=$.geodeticSurfaceNormal(e,zIe);if(I[d]&&h.negate(t,t),s.st){let e=U.negate(t,WIe);F[K++]=Math.atan2(e.y,e.x)/P.TWO_PI+.5,F[K++]=Math.asin(t.z)/Math.PI+.5}if(s.normal&&(R[J++]=t.x,R[J++]=t.y,R[J++]=t.z),s.tangent||s.bitangent){let e,i=HIe,n=0;if(w[d]&&(n=ee),e=!T&&d>=n&&d<n+2*y?h.UNIT_X:h.UNIT_Z,h.cross(e,t,i),h.normalize(i,i),s.tangent&&(N[Q++]=i.x,N[Q++]=i.y,N[Q++]=i.z),s.bitangent){let e=h.cross(t,i,GIe);h.normalize(e,e),M[Z++]=e.x,M[Z++]=e.y,M[Z++]=e.z}}}s.st&&(Y.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:F})),s.normal&&(Y.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:R})),s.tangent&&(Y.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:N})),s.bitangent&&(Y.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:M}))}if(u(e._offsetAttribute)){let t=S.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);Y.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:Y,indices:L,primitiveType:Ne.TRIANGLES,boundingSphere:se.fromEllipsoid(te),offsetAttribute:e._offsetAttribute})},Hm.getUnitEllipsoid=function(){return u(fG)||(fG=Hm.createGeometry(new Hm({radii:new h(1,1,1),vertexFormat:Pe.POSITION_ONLY}))),fG};var Ms=Hm,qIe=new h(1,1,1),F1=Math.cos,B1=Math.sin;function gT(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.radii,qIe),i=y(e.innerRadii,t),n=y(e.minimumClock,0),r=y(e.maximumClock,P.TWO_PI),o=y(e.minimumCone,0),a=y(e.maximumCone,P.PI),s=Math.round(y(e.stackPartitions,10)),l=Math.round(y(e.slicePartitions,8)),u=Math.round(y(e.subdivisions,128));this._radii=h.clone(t),this._innerRadii=h.clone(i),this._minimumClock=n,this._maximumClock=r,this._minimumCone=o,this._maximumCone=a,this._stackPartitions=s,this._slicePartitions=l,this._subdivisions=u,this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidOutlineGeometry"}gT.packedLength=2*h.packedLength+8,gT.pack=function(e,t,i){return i=y(i,0),h.pack(e._radii,t,i),i+=h.packedLength,h.pack(e._innerRadii,t,i),i+=h.packedLength,t[i++]=e._minimumClock,t[i++]=e._maximumClock,t[i++]=e._minimumCone,t[i++]=e._maximumCone,t[i++]=e._stackPartitions,t[i++]=e._slicePartitions,t[i++]=e._subdivisions,t[i]=y(e._offsetAttribute,-1),t};var EJ=new h,SJ=new h,Gm={radii:EJ,innerRadii:SJ,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0,offsetAttribute:void 0};gT.unpack=function(e,t,i){t=y(t,0);let n=h.unpack(e,t,EJ);t+=h.packedLength;let r=h.unpack(e,t,SJ);t+=h.packedLength;let o=e[t++],a=e[t++],s=e[t++],l=e[t++],c=e[t++],d=e[t++],p=e[t++],f=e[t];return u(i)?(i._radii=h.clone(n,i._radii),i._innerRadii=h.clone(r,i._innerRadii),i._minimumClock=o,i._maximumClock=a,i._minimumCone=s,i._maximumCone=l,i._stackPartitions=c,i._slicePartitions=d,i._subdivisions=p,i._offsetAttribute=-1===f?void 0:f,i):(Gm.minimumClock=o,Gm.maximumClock=a,Gm.minimumCone=s,Gm.maximumCone=l,Gm.stackPartitions=c,Gm.slicePartitions=d,Gm.subdivisions=p,Gm.offsetAttribute=-1===f?void 0:f,new gT(Gm))},gT.createGeometry=function(e){let t=e._radii;if(t.x<=0||t.y<=0||t.z<=0)return;let i=e._innerRadii;if(i.x<=0||i.y<=0||i.z<=0)return;let n=e._minimumClock,r=e._maximumClock,o=e._minimumCone,a=e._maximumCone,s=e._subdivisions,l=ie.fromCartesian3(t),c=e._slicePartitions+1,h=e._stackPartitions+1;c=Math.round(c*Math.abs(r-n)/P.TWO_PI),h=Math.round(h*Math.abs(a-o)/P.PI),c<2&&(c=2),h<2&&(h=2);let d=0,p=1,f=i.x!==t.x||i.y!==t.y||i.z!==t.z,m=!1,_=!1;f&&(p=2,o>0&&(m=!0,d+=c),a<Math.PI&&(_=!0,d+=c));let g,y,v,b,A=s*p*(h+c),T=new Float64Array(3*A),E=2*(A+d-(c+h)*p),C=ke.createTypedArray(A,E),x=0,S=new Array(h),w=new Array(h);for(g=0;g<h;g++)b=o+g*(a-o)/(h-1),S[g]=B1(b),w[g]=F1(b);let I=new Array(s),D=new Array(s);for(g=0;g<s;g++)v=n+g*(r-n)/(s-1),I[g]=B1(v),D[g]=F1(v);for(g=0;g<h;g++)for(y=0;y<s;y++)T[x++]=t.x*S[g]*D[y],T[x++]=t.y*S[g]*I[y],T[x++]=t.z*w[g];if(f)for(g=0;g<h;g++)for(y=0;y<s;y++)T[x++]=i.x*S[g]*D[y],T[x++]=i.y*S[g]*I[y],T[x++]=i.z*w[g];for(S.length=s,w.length=s,g=0;g<s;g++)b=o+g*(a-o)/(s-1),S[g]=B1(b),w[g]=F1(b);for(I.length=c,D.length=c,g=0;g<c;g++)v=n+g*(r-n)/(c-1),I[g]=B1(v),D[g]=F1(v);for(g=0;g<s;g++)for(y=0;y<c;y++)T[x++]=t.x*S[g]*D[y],T[x++]=t.y*S[g]*I[y],T[x++]=t.z*w[g];if(f)for(g=0;g<s;g++)for(y=0;y<c;y++)T[x++]=i.x*S[g]*D[y],T[x++]=i.y*S[g]*I[y],T[x++]=i.z*w[g];for(x=0,g=0;g<h*p;g++){let e=g*s;for(y=0;y<s-1;y++)C[x++]=e+y,C[x++]=e+y+1}let O=h*s*p;for(g=0;g<c;g++)for(y=0;y<s-1;y++)C[x++]=O+g+y*c,C[x++]=O+g+(y+1)*c;if(f)for(O=h*s*p+c*s,g=0;g<c;g++)for(y=0;y<s-1;y++)C[x++]=O+g+y*c,C[x++]=O+g+(y+1)*c;if(f){let e=h*s*p,t=e+s*c;if(m)for(g=0;g<c;g++)C[x++]=e+g,C[x++]=t+g;if(_)for(e+=s*c-c,t+=s*c-c,g=0;g<c;g++)C[x++]=e+g,C[x++]=t+g}let L=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:T})});if(u(e._offsetAttribute)){let t=T.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);L.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return new ct({attributes:L,indices:C,primitiveType:Ne.LINES,boundingSphere:se.fromEllipsoid(l),offsetAttribute:e._offsetAttribute})};var Fu=gT;function yT(e){e=y(e,y.EMPTY_OBJECT),this._tilingScheme=e.tilingScheme,u(this._tilingScheme)||(this._tilingScheme=new Ui({ellipsoid:y(e.ellipsoid,ie.WGS84)})),this._levelZeroMaximumGeometricError=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new pe}Object.defineProperties(yT.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}}),yT.prototype.requestTileGeometry=function(e,t,i,n){return Promise.resolve(new va({buffer:new Uint8Array(256),width:16,height:16}))},yT.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},yT.prototype.getTileDataAvailable=function(e,t,i){},yT.prototype.loadTileDataAvailability=function(e,t,i){};var Wm=yT;function dG(){this._removalFunctions=[]}dG.prototype.add=function(e,t,i){let n=e.addEventListener(t,i);this._removalFunctions.push(n);let r=this;return function(){n();let e=r._removalFunctions;e.splice(e.indexOf(n),1)}},dG.prototype.removeAll=function(){let e=this._removalFunctions;for(let t=0,i=e.length;t<i;++t)e[t]();e.length=0};var Pr=dG,YIe={NONE:0,HOLD:1,EXTRAPOLATE:2},Bu=Object.freeze(YIe);function yh(e){e=y(e,y.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=y(e.near,1),this._near=this.near,this.far=y(e.far,5e8),this._far=this.far,this._cullingVolume=new ns,this._orthographicMatrix=new L}function wJ(e){(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far)&&(e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=L.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix))}Object.defineProperties(yh.prototype,{projectionMatrix:{get:function(){return wJ(this),this._orthographicMatrix}}});var XIe=new h,KIe=new h,ZIe=new h,hG=new h;yh.prototype.computeCullingVolume=function(e,t,i){let n=this._cullingVolume.planes,r=this.top,o=this.bottom,a=this.right,s=this.left,l=this.near,c=this.far,d=h.cross(t,i,XIe);h.normalize(d,d);let p=KIe;h.multiplyByScalar(t,l,p),h.add(e,p,p);let f=ZIe;h.multiplyByScalar(d,s,f),h.add(p,f,f);let m=n[0];return u(m)||(m=n[0]=new oe),m.x=d.x,m.y=d.y,m.z=d.z,m.w=-h.dot(d,f),h.multiplyByScalar(d,a,f),h.add(p,f,f),m=n[1],u(m)||(m=n[1]=new oe),m.x=-d.x,m.y=-d.y,m.z=-d.z,m.w=-h.dot(h.negate(d,hG),f),h.multiplyByScalar(i,o,f),h.add(p,f,f),m=n[2],u(m)||(m=n[2]=new oe),m.x=i.x,m.y=i.y,m.z=i.z,m.w=-h.dot(i,f),h.multiplyByScalar(i,r,f),h.add(p,f,f),m=n[3],u(m)||(m=n[3]=new oe),m.x=-i.x,m.y=-i.y,m.z=-i.z,m.w=-h.dot(h.negate(i,hG),f),m=n[4],u(m)||(m=n[4]=new oe),m.x=t.x,m.y=t.y,m.z=t.z,m.w=-h.dot(t,p),h.multiplyByScalar(t,c,f),h.add(e,f,f),m=n[5],u(m)||(m=n[5]=new oe),m.x=-t.x,m.y=-t.y,m.z=-t.z,m.w=-h.dot(h.negate(t,hG),f),this._cullingVolume},yh.prototype.getPixelDimensions=function(e,t,i,n,r){wJ(this);let o=n*(this.right-this.left)/e,a=n*(this.top-this.bottom)/t;return r.x=o,r.y=a,r},yh.prototype.clone=function(e){return u(e)||(e=new yh),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},yh.prototype.equals=function(e){return u(e)&&e instanceof yh&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},yh.prototype.equalsEpsilon=function(e,t,i){return e===this||u(e)&&e instanceof yh&&P.equalsEpsilon(this.right,e.right,t,i)&&P.equalsEpsilon(this.left,e.left,t,i)&&P.equalsEpsilon(this.top,e.top,t,i)&&P.equalsEpsilon(this.bottom,e.bottom,t,i)&&P.equalsEpsilon(this.near,e.near,t,i)&&P.equalsEpsilon(this.far,e.far,t,i)};var Or=yh;function Zc(e){e=y(e,y.EMPTY_OBJECT),this._offCenterFrustum=new Or,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=y(e.near,1),this._near=this.near,this.far=y(e.far,5e8),this._far=this.far}function D_(e){let t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;let i=1/e.aspectRatio;t.right=.5*e.width,t.left=-t.right,t.top=i*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}Zc.packedLength=4,Zc.pack=function(e,t,i){return i=y(i,0),t[i++]=e.width,t[i++]=e.aspectRatio,t[i++]=e.near,t[i]=e.far,t},Zc.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Zc),i.width=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t],i},Object.defineProperties(Zc.prototype,{projectionMatrix:{get:function(){return D_(this),this._offCenterFrustum.projectionMatrix}},offCenterFrustum:{get:function(){return D_(this),this._offCenterFrustum}}}),Zc.prototype.computeCullingVolume=function(e,t,i){return D_(this),this._offCenterFrustum.computeCullingVolume(e,t,i)},Zc.prototype.getPixelDimensions=function(e,t,i,n,r){return D_(this),this._offCenterFrustum.getPixelDimensions(e,t,i,n,r)},Zc.prototype.clone=function(e){return u(e)||(e=new Zc),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},Zc.prototype.equals=function(e){return!!(u(e)&&e instanceof Zc)&&(D_(this),D_(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},Zc.prototype.equalsEpsilon=function(e,t,i){return!!(u(e)&&e instanceof Zc)&&(D_(this),D_(e),P.equalsEpsilon(this.width,e.width,t,i)&&P.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var Qt=Zc;function xh(e){e=y(e,y.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=y(e.near,1),this._near=this.near,this.far=y(e.far,5e8),this._far=this.far,this._cullingVolume=new ns,this._perspectiveMatrix=new L,this._infinitePerspective=new L}function mG(e){let t=e.top,i=e.bottom,n=e.right,r=e.left,o=e.near,a=e.far;(t!==e._top||i!==e._bottom||r!==e._left||n!==e._right||o!==e._near||a!==e._far)&&(e._left=r,e._right=n,e._top=t,e._bottom=i,e._near=o,e._far=a,e._perspectiveMatrix=L.computePerspectiveOffCenter(r,n,i,t,o,a,e._perspectiveMatrix),e._infinitePerspective=L.computeInfinitePerspectiveOffCenter(r,n,i,t,o,e._infinitePerspective))}Object.defineProperties(xh.prototype,{projectionMatrix:{get:function(){return mG(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return mG(this),this._infinitePerspective}}});var $Ie=new h,QIe=new h,JIe=new h,ePe=new h;xh.prototype.computeCullingVolume=function(e,t,i){let n=this._cullingVolume.planes,r=this.top,o=this.bottom,a=this.right,s=this.left,l=this.near,c=this.far,d=h.cross(t,i,$Ie),p=QIe;h.multiplyByScalar(t,l,p),h.add(e,p,p);let f=JIe;h.multiplyByScalar(t,c,f),h.add(e,f,f);let m=ePe;h.multiplyByScalar(d,s,m),h.add(p,m,m),h.subtract(m,e,m),h.normalize(m,m),h.cross(m,i,m),h.normalize(m,m);let _=n[0];return u(_)||(_=n[0]=new oe),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-h.dot(m,e),h.multiplyByScalar(d,a,m),h.add(p,m,m),h.subtract(m,e,m),h.cross(i,m,m),h.normalize(m,m),_=n[1],u(_)||(_=n[1]=new oe),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-h.dot(m,e),h.multiplyByScalar(i,o,m),h.add(p,m,m),h.subtract(m,e,m),h.cross(d,m,m),h.normalize(m,m),_=n[2],u(_)||(_=n[2]=new oe),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-h.dot(m,e),h.multiplyByScalar(i,r,m),h.add(p,m,m),h.subtract(m,e,m),h.cross(m,d,m),h.normalize(m,m),_=n[3],u(_)||(_=n[3]=new oe),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-h.dot(m,e),_=n[4],u(_)||(_=n[4]=new oe),_.x=t.x,_.y=t.y,_.z=t.z,_.w=-h.dot(t,p),h.negate(t,m),_=n[5],u(_)||(_=n[5]=new oe),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-h.dot(m,f),this._cullingVolume},xh.prototype.getPixelDimensions=function(e,t,i,n,r){mG(this);let o=1/this.near,a=this.top*o,s=2*n*i*a/t;a=this.right*o;let l=2*n*i*a/e;return r.x=l,r.y=s,r},xh.prototype.clone=function(e){return u(e)||(e=new xh),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},xh.prototype.equals=function(e){return u(e)&&e instanceof xh&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},xh.prototype.equalsEpsilon=function(e,t,i){return e===this||u(e)&&e instanceof xh&&P.equalsEpsilon(this.right,e.right,t,i)&&P.equalsEpsilon(this.left,e.left,t,i)&&P.equalsEpsilon(this.top,e.top,t,i)&&P.equalsEpsilon(this.bottom,e.bottom,t,i)&&P.equalsEpsilon(this.near,e.near,t,i)&&P.equalsEpsilon(this.far,e.far,t,i)};var $c=xh;function Qc(e){e=y(e,y.EMPTY_OBJECT),this._offCenterFrustum=new $c,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=y(e.near,1),this._near=this.near,this.far=y(e.far,5e8),this._far=this.far,this.xOffset=y(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=y(e.yOffset,0),this._yOffset=this.yOffset}function jf(e){let t=e._offCenterFrustum;(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset)&&(e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}Qc.packedLength=6,Qc.pack=function(e,t,i){return i=y(i,0),t[i++]=e.fov,t[i++]=e.aspectRatio,t[i++]=e.near,t[i++]=e.far,t[i++]=e.xOffset,t[i]=e.yOffset,t},Qc.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Qc),i.fov=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t++],i.xOffset=e[t++],i.yOffset=e[t],i},Object.defineProperties(Qc.prototype,{projectionMatrix:{get:function(){return jf(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return jf(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return jf(this),this._fovy}},sseDenominator:{get:function(){return jf(this),this._sseDenominator}},offCenterFrustum:{get:function(){return jf(this),this._offCenterFrustum}}}),Qc.prototype.computeCullingVolume=function(e,t,i){return jf(this),this._offCenterFrustum.computeCullingVolume(e,t,i)},Qc.prototype.getPixelDimensions=function(e,t,i,n,r){return jf(this),this._offCenterFrustum.getPixelDimensions(e,t,i,n,r)},Qc.prototype.clone=function(e){return u(e)||(e=new Qc),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},Qc.prototype.equals=function(e){return!!(u(e)&&e instanceof Qc)&&(jf(this),jf(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},Qc.prototype.equalsEpsilon=function(e,t,i){return!!(u(e)&&e instanceof Qc)&&(jf(this),jf(e),P.equalsEpsilon(this.fov,e.fov,t,i)&&P.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var Ei=Qc,k1=0,tPe=1;function g0(e){let t,i,n=e.frustum,r=e.orientation,o=e.origin,a=y(e.vertexFormat,Pe.DEFAULT),s=y(e._drawNearPlane,!0);n instanceof Ei?(t=k1,i=Ei.packedLength):n instanceof Qt&&(t=tPe,i=Qt.packedLength),this._frustumType=t,this._frustum=n.clone(),this._origin=h.clone(o),this._orientation=Le.clone(r),this._drawNearPlane=s,this._vertexFormat=a,this._workerName="createFrustumGeometry",this.packedLength=2+i+h.packedLength+Le.packedLength+Pe.packedLength}g0.pack=function(e,t,i){i=y(i,0);let n=e._frustumType,r=e._frustum;return t[i++]=n,n===k1?(Ei.pack(r,t,i),i+=Ei.packedLength):(Qt.pack(r,t,i),i+=Qt.packedLength),h.pack(e._origin,t,i),i+=h.packedLength,Le.pack(e._orientation,t,i),i+=Le.packedLength,Pe.pack(e._vertexFormat,t,i),t[i+=Pe.packedLength]=e._drawNearPlane?1:0,t};var nPe=new Ei,iPe=new Qt,oPe=new Le,rPe=new h,sPe=new Pe;function xT(e,t,i,n,r,o,a,s){let l=e/3*2;for(let r=0;r<4;++r)u(t)&&(t[e]=o.x,t[e+1]=o.y,t[e+2]=o.z),u(i)&&(i[e]=a.x,i[e+1]=a.y,i[e+2]=a.z),u(n)&&(n[e]=s.x,n[e+1]=s.y,n[e+2]=s.z),e+=3;r[l]=0,r[l+1]=0,r[l+2]=1,r[l+3]=0,r[l+4]=1,r[l+5]=1,r[l+6]=0,r[l+7]=1}g0.unpack=function(e,t,i){t=y(t,0);let n,r=e[t++];r===k1?(n=Ei.unpack(e,t,nPe),t+=Ei.packedLength):(n=Qt.unpack(e,t,iPe),t+=Qt.packedLength);let o=h.unpack(e,t,rPe);t+=h.packedLength;let a=Le.unpack(e,t,oPe);t+=Le.packedLength;let s=Pe.unpack(e,t,sPe),l=1===e[t+=Pe.packedLength];if(!u(i))return new g0({frustum:n,origin:o,orientation:a,vertexFormat:s,_drawNearPlane:l});let c=r===i._frustumType?i._frustum:void 0;return i._frustum=n.clone(c),i._frustumType=r,i._origin=h.clone(o,i._origin),i._orientation=Le.clone(a,i._orientation),i._vertexFormat=Pe.clone(s,i._vertexFormat),i._drawNearPlane=l,i};var aPe=new $,cPe=new L,pG=new L,vJ=new h,DJ=new h,IJ=new h,lPe=new h,uPe=new h,fPe=new h,I_=new Array(3),DS=new Array(4);DS[0]=new oe(-1,-1,1,1),DS[1]=new oe(1,-1,1,1),DS[2]=new oe(1,1,1,1),DS[3]=new oe(-1,1,1,1);var PJ=new Array(4);for(let e=0;e<4;++e)PJ[e]=new oe;g0._computeNearFarPlanes=function(e,t,i,n,r,o,a,s){let l=$.fromQuaternion(t,aPe),c=y(o,vJ),d=y(a,DJ),p=y(s,IJ);c=$.getColumn(l,0,c),d=$.getColumn(l,1,d),p=$.getColumn(l,2,p),h.normalize(c,c),h.normalize(d,d),h.normalize(p,p),h.negate(c,c);let f,m,_=L.computeView(e,p,d,c,cPe),g=n.projectionMatrix;if(i===k1){let e=L.multiply(g,_,pG);m=L.inverse(e,pG)}else f=L.inverseTransformation(_,pG);u(m)?(I_[0]=n.near,I_[1]=n.far):(I_[0]=0,I_[1]=n.near,I_[2]=n.far);for(let t=0;t<2;++t)for(let i=0;i<4;++i){let o=oe.clone(DS[i],PJ[i]);if(u(m)){o=L.multiplyByVector(m,o,o);let i=1/o.w;h.multiplyByScalar(o,i,o),h.subtract(o,e,o),h.normalize(o,o);let n=h.dot(p,o);h.multiplyByScalar(o,I_[t]/n,o),h.add(o,e,o)}else{let e=n.offCenterFrustum;u(e)&&(n=e);let i=I_[t],r=I_[t+1];o.x=.5*(o.x*(n.right-n.left)+n.left+n.right),o.y=.5*(o.y*(n.top-n.bottom)+n.bottom+n.top),o.z=.5*(o.z*(i-r)-i-r),o.w=1,L.multiplyByVector(f,o,o)}r[12*t+3*i]=o.x,r[12*t+3*i+1]=o.y,r[12*t+3*i+2]=o.z}},g0.createGeometry=function(e){let t=e._frustumType,i=e._frustum,n=e._origin,r=e._orientation,o=e._drawNearPlane,a=e._vertexFormat,s=o?6:5,l=new Float64Array(72);g0._computeNearFarPlanes(n,r,t,i,l);let c=24;l[c]=l[12],l[c+1]=l[13],l[c+2]=l[14],l[c+3]=l[0],l[c+4]=l[1],l[c+5]=l[2],l[c+6]=l[9],l[c+7]=l[10],l[c+8]=l[11],l[c+9]=l[21],l[c+10]=l[22],l[c+11]=l[23],c+=12,l[c]=l[15],l[c+1]=l[16],l[c+2]=l[17],l[c+3]=l[3],l[c+4]=l[4],l[c+5]=l[5],l[c+6]=l[0],l[c+7]=l[1],l[c+8]=l[2],l[c+9]=l[12],l[c+10]=l[13],l[c+11]=l[14],c+=12,l[c]=l[3],l[c+1]=l[4],l[c+2]=l[5],l[c+3]=l[15],l[c+4]=l[16],l[c+5]=l[17],l[c+6]=l[18],l[c+7]=l[19],l[c+8]=l[20],l[c+9]=l[6],l[c+10]=l[7],l[c+11]=l[8],c+=12,l[c]=l[6],l[c+1]=l[7],l[c+2]=l[8],l[c+3]=l[18],l[c+4]=l[19],l[c+5]=l[20],l[c+6]=l[21],l[c+7]=l[22],l[c+8]=l[23],l[c+9]=l[9],l[c+10]=l[10],l[c+11]=l[11],o||(l=l.subarray(12));let d=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:l})});if(u(a.normal)||u(a.tangent)||u(a.bitangent)||u(a.st)){let e=u(a.normal)?new Float32Array(12*s):void 0,t=u(a.tangent)?new Float32Array(12*s):void 0,i=u(a.bitangent)?new Float32Array(12*s):void 0,n=u(a.st)?new Float32Array(8*s):void 0,r=vJ,l=DJ,p=IJ,f=h.negate(r,lPe),m=h.negate(l,uPe),_=h.negate(p,fPe);c=0,o&&(xT(c,e,t,i,n,_,r,l),c+=12),xT(c,e,t,i,n,p,f,l),c+=12,xT(c,e,t,i,n,f,_,l),c+=12,xT(c,e,t,i,n,m,_,f),c+=12,xT(c,e,t,i,n,r,p,l),c+=12,xT(c,e,t,i,n,l,p,f),u(e)&&(d.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})),u(t)&&(d.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:t})),u(i)&&(d.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:i})),u(n)&&(d.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:n}))}let p=new Uint16Array(6*s);for(let e=0;e<s;++e){let t=6*e,i=4*e;p[t]=i,p[t+1]=i+1,p[t+2]=i+2,p[t+3]=i,p[t+4]=i+2,p[t+5]=i+3}return new ct({attributes:d,indices:p,primitiveType:Ne.TRIANGLES,boundingSphere:se.fromVertices(l)})};var bT=g0,_G=0,dPe=1;function IS(e){let t,i,n=e.frustum,r=e.orientation,o=e.origin,a=y(e._drawNearPlane,!0);n instanceof Ei?(t=_G,i=Ei.packedLength):n instanceof Qt&&(t=dPe,i=Qt.packedLength),this._frustumType=t,this._frustum=n.clone(),this._origin=h.clone(o),this._orientation=Le.clone(r),this._drawNearPlane=a,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+i+h.packedLength+Le.packedLength}IS.pack=function(e,t,i){i=y(i,0);let n=e._frustumType,r=e._frustum;return t[i++]=n,n===_G?(Ei.pack(r,t,i),i+=Ei.packedLength):(Qt.pack(r,t,i),i+=Qt.packedLength),h.pack(e._origin,t,i),i+=h.packedLength,Le.pack(e._orientation,t,i),t[i+=Le.packedLength]=e._drawNearPlane?1:0,t};var hPe=new Ei,mPe=new Qt,pPe=new Le,_Pe=new h;IS.unpack=function(e,t,i){t=y(t,0);let n,r=e[t++];r===_G?(n=Ei.unpack(e,t,hPe),t+=Ei.packedLength):(n=Qt.unpack(e,t,mPe),t+=Qt.packedLength);let o=h.unpack(e,t,_Pe);t+=h.packedLength;let a=Le.unpack(e,t,pPe),s=1===e[t+=Le.packedLength];if(!u(i))return new IS({frustum:n,origin:o,orientation:a,_drawNearPlane:s});let l=r===i._frustumType?i._frustum:void 0;return i._frustum=n.clone(l),i._frustumType=r,i._origin=h.clone(o,i._origin),i._orientation=Le.clone(a,i._orientation),i._drawNearPlane=s,i},IS.createGeometry=function(e){let t=e._frustumType,i=e._frustum,n=e._origin,r=e._orientation,o=e._drawNearPlane,a=new Float64Array(24);bT._computeNearFarPlanes(n,r,t,i,a);let s,l,u=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:a})}),c=o?2:1,h=new Uint16Array(8*(c+1)),d=o?0:1;for(;d<2;++d)s=o?8*d:0,l=4*d,h[s]=l,h[s+1]=l+1,h[s+2]=l+1,h[s+3]=l+2,h[s+4]=l+2,h[s+5]=l+3,h[s+6]=l+3,h[s+7]=l;for(d=0;d<2;++d)s=8*(c+d),l=4*d,h[s]=l,h[s+1]=l+4,h[s+2]=l+1,h[s+3]=l+5,h[s+4]=l+2,h[s+5]=l+6,h[s+6]=l+3,h[s+7]=l+7;return new ct({attributes:u,indices:h,primitiveType:Ne.LINES,boundingSphere:se.fromVertices(a)})};var V1=IS;function U1(){de.throwInstantiationError()}Object.defineProperties(U1.prototype,{credit:{get:de.throwInstantiationError}}),U1.getCreditsFromResult=function(e){if(u(e.attributions))return e.attributions.map(xt.getIonCredit)},U1.prototype.geocode=de.throwInstantiationError;var PS=U1,gPe={SEARCH:0,AUTOCOMPLETE:1},y0=Object.freeze(gPe);function OJ(){de.throwInstantiationError()}OJ.createGeometry=function(e){de.throwInstantiationError()};var RJ=OJ;function yPe(e){e=y(e,y.EMPTY_OBJECT),this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=y(e.normalize,!1),this.value=e.value}var hc=yPe,MJ=or(Sl(),1);function xPe(e){let t=new MJ.default(e);t.normalize();let i=t.path(),n=i.lastIndexOf("/");return-1!==n&&(i=i.substr(n+1)),i}var P_=xPe;function bPe(e,t,i){let n=new Uint8ClampedArray(e.buffer),r=new ImageData(n,t,i),o=document.createElement("canvas");return o.width=t,o.height=i,o.getContext("2d").putImageData(r,0,0),o}var z1=bPe;function TPe(e,t){return t=y(t,0),Il(e,t,Math.min(4,e.length))}var bh=TPe,vPe=or(gG(),1);function APe(e,t){return 0!=(e&t)}var mc=APe,CPe=[1,2,4,8],LJ=15,EPe=16,SPe=64,wPe=128;function Th(e,t,i,n,r,o){this._bits=e,this.cnodeVersion=t,this.imageryVersion=i,this.terrainVersion=n,this.imageryProvider=r,this.terrainProvider=o,this.ancestorHasTerrain=!1,this.terrainState=void 0}Th.clone=function(e,t){return u(t)?(t._bits=e._bits,t.cnodeVersion=e.cnodeVersion,t.imageryVersion=e.imageryVersion,t.terrainVersion=e.terrainVersion,t.imageryProvider=e.imageryProvider,t.terrainProvider=e.terrainProvider):t=new Th(e._bits,e.cnodeVersion,e.imageryVersion,e.terrainVersion,e.imageryProvider,e.terrainProvider),t.ancestorHasTerrain=e.ancestorHasTerrain,t.terrainState=e.terrainState,t},Th.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()},Th.prototype.hasSubtree=function(){return mc(this._bits,EPe)},Th.prototype.hasImagery=function(){return mc(this._bits,SPe)},Th.prototype.hasTerrain=function(){return mc(this._bits,wPe)},Th.prototype.hasChildren=function(){return mc(this._bits,LJ)},Th.prototype.hasChild=function(e){return mc(this._bits,CPe[e])},Th.prototype.getChildBitmask=function(){return this._bits&LJ};var H1=Th;function DPe(e){let t=e.length,i=new ArrayBuffer(t),n=new Uint8Array(i);for(let i=0;i<t;++i)n[i]=e.charCodeAt(i);return i}var IPe=DPe('E\vyjE",qIFgQ\0B%a,f)\b4jb%y\nwmikNuA[@V\fr|3SOlq{EVZwUe\v3*l50s3>mF8J.uDt"a"\f3"So9D\v99L\\P_"uxqh;<VqH\'UfYNeuaF}a?A\04MF\'{+Mg0\\P[/Fn5/\'C.\n\f^se4l.jC\'c#U?q{gC}:TUK/(\\-f;/*"Nk.\r}}GC+>M>}Ix\fa1-O~q \r1N\v\0nPh}=\b\rnh$[k#s\r\v@Q]".jI\0wUj{GLFS+S4Y81NXFk-#p\x005"1&/u-6,rt#G&7r\0D3-`i#i*|KQ\rT9w.)PjoP\\>TP[\vEm(w7JfJo pq~\fmI-zrY0]s x B|G`&q3=c+SD\\qD2O<)=RaX}e\r=\bB#\t^PIMGLO{+1;ol\r?_FaZU\0gJi H]~q NV<rv)I]-6;fj=P^RKsWx.YoKW>\'\'`;SD>?mw\n?RU^1I7&-\'Tj *xprh_H~XL?f>ep8iVldI\'xtOV9\0w\v-5O\bQ`\nZGM&30xFG[y`In7gS\n>F94\rSun\fY){IIwyIV.6\v:Ob{M1/8{O!Fpv})"x\n\\QYRe|3H*u`5(1-F|["');function Ml(e){this.imageryPresent=!0,this.protoImagery=void 0,this.terrainPresent=!0,this.negativeAltitudeExponentBias=32,this.negativeAltitudeThreshold=P.EPSILON12,this.providers={},this.key=void 0,this._resource=void 0,this._quadPacketVersion=1,this._tileInfo={},this._subtreePromises={}}Object.defineProperties(Ml.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},resource:{get:function(){return this._resource}}}),Ml.fromUrl=async function(e){let t=e;"string"!=typeof t&&!(t instanceof ve)&&(t=e.url);let i=ve.createIfNeeded(t);i.appendForwardSlash();let n=new Ml;n._resource=i;try{await PPe(n),await n.getQuadTreePacket("",n._quadPacketVersion)}catch(e){let t=`An error occurred while accessing ${FJ(n,"",1).url}: ${e}`;throw new ue(t)}return n},Ml.tileXYToQuadKey=function(e,t,i){let n="";for(let r=i;r>=0;--r){let i=1<<r,o=0;mc(t,i)?mc(e,i)&&(o|=1):(o|=2,mc(e,i)||(o|=1)),n+=o}return n},Ml.quadKeyToTileXY=function(e){let t=0,i=0,n=e.length-1;for(let r=n;r>=0;--r){let o=1<<r,a=+e[n-r];mc(a,2)?mc(a,1)||(t|=o):(i|=o,mc(a,1)&&(t|=o))}return{x:t,y:i,level:n}},Ml.prototype.isValid=function(e){let t=this.getTileInformationFromQuadKey(e);if(u(t))return null!==t;let i,n=!0,r=e;for(;r.length>1;){if(i=r.substring(r.length-1),r=r.substring(0,r.length-1),t=this.getTileInformationFromQuadKey(r),u(t)){!t.hasSubtree()&&!t.hasChild(parseInt(i))&&(n=!1);break}if(null===t){n=!1;break}}return n};var NJ=new pi("decodeGoogleEarthEnterprisePacket"),yG,xG;function bG(e,t,i){let n=e._tileInfo,r=t,o=n[r];if(u(o)&&(!o.hasSubtree()||o.hasChildren()))return o;for(;void 0===o&&r.length>1;)r=r.substring(0,r.length-1),o=n[r];let a,s=e._subtreePromises,l=s[r];return u(l)?l.then((function(){return a=new Ko({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction}),bG(e,t,a)})):u(o)&&o.hasSubtree()?(l=e.getQuadTreePacket(r,o.cnodeVersion,i),u(l)?(s[r]=l,l.then((function(){return a=new Ko({throttle:i.throttle,throttleByServer:i.throttleByServer,type:i.type,priorityFunction:i.priorityFunction}),bG(e,t,a)})).finally((function(){delete s[r]}))):void 0):Promise.reject(new ue(`Couldn't load metadata for tile ${t}`))}function FJ(e,t,i,n){return e._resource.getDerivedResource({url:`flatfile?q2-0${t}-q.${i.toString()}`,request:n})}function PPe(e){let t=e._resource.getDerivedResource({url:"dbRoot.v5",queryParameters:{output:"proto"}});if(!u(xG)){let e=$t("ThirdParty/google-earth-dbroot-parser.js"),t=window.cesiumGoogleEarthDbRootParser;xG=wb(e).then((function(){yG=window.cesiumGoogleEarthDbRootParser(vPe),u(t)?window.cesiumGoogleEarthDbRootParser=t:delete window.cesiumGoogleEarthDbRootParser}))}return xG.then((function(){return t.fetchArrayBuffer()})).then((function(t){let i=yG.EncryptedDbRootProto.decode(new Uint8Array(t)),n=i.encryptionData,r=n.byteOffset,o=r+n.byteLength,a=e.key=n.buffer.slice(r,o);n=i.dbrootData,r=n.byteOffset,o=r+n.byteLength;let s=n.buffer.slice(r,o);return NJ.scheduleTask({buffer:s,type:"DbRoot",key:a},[s])})).then((function(t){let i=yG.DbRootProto.decode(new Uint8Array(t.buffer));if(e.imageryPresent=y(i.imageryPresent,e.imageryPresent),e.protoImagery=i.protoImagery,e.terrainPresent=y(i.terrainPresent,e.terrainPresent),u(i.endSnippet)&&u(i.endSnippet.model)){let t=i.endSnippet.model;e.negativeAltitudeExponentBias=y(t.negativeAltitudeExponentBias,e.negativeAltitudeExponentBias),e.negativeAltitudeThreshold=y(t.compressedNegativeAltitudeThreshold,e.negativeAltitudeThreshold)}u(i.databaseVersion)&&(e._quadPacketVersion=y(i.databaseVersion.quadtreeVersion,e._quadPacketVersion));let n=e.providers,r=y(i.providerInfo,[]),o=r.length;for(let e=0;e<o;++e){let t=r[e],i=t.copyrightString;u(i)&&(n[t.providerId]=new xt(i.value))}})).catch((function(){console.log(`Failed to retrieve ${t.url}. Using defaults.`),e.key=IPe}))}Ml.prototype.getQuadTreePacket=function(e,t,i){t=y(t,1);let n=FJ(this,e=y(e,""),t,i).fetchArrayBuffer();if(!u(n))return;let r=this._tileInfo,o=this.key;return n.then((function(t){return NJ.scheduleTask({buffer:t,quadKey:e,type:"Metadata",key:o},[t]).then((function(t){let i,n=-1;if(""!==e){n=e.length+1;let o=t[e];i=r[e],i._bits|=o._bits,delete t[e]}let o=Object.keys(t);o.sort((function(e,t){return e.length-t.length}));let a=o.length;for(let e=0;e<a;++e){let a=o[e];if(null!==t[a]){let e=H1.clone(t[a]),o=a.length;if(o===n)e.setParent(i);else if(o>1){let t=r[a.substring(0,a.length-1)];e.setParent(t)}r[a]=e}else r[a]=null}}))}))},Ml.prototype.populateSubtree=function(e,t,i,n){return bG(this,Ml.tileXYToQuadKey(e,t,i),n)},Ml.prototype.getTileInformation=function(e,t,i){let n=Ml.tileXYToQuadKey(e,t,i);return this._tileInfo[n]},Ml.prototype.getTileInformationFromQuadKey=function(e){return this._tileInfo[e]};var O_=Ml;function x0(e){e=y(e,y.EMPTY_OBJECT),this._buffer=e.buffer,this._credits=e.credits,this._negativeAltitudeExponentBias=e.negativeAltitudeExponentBias,this._negativeElevationThreshold=e.negativeElevationThreshold;let t=y(e.childTileMask,15),i=3&t;i|=4&t?8:0,i|=8&t?4:0,this._childTileMask=i,this._createdByUpsampling=y(e.createdByUpsampling,!1),this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0,this._minimumHeight=void 0,this._maximumHeight=void 0}Object.defineProperties(x0.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){}}});var VJ="createVerticesFromGoogleEarthEnterpriseBuffer",OPe=new pi(VJ),RPe=new pi(VJ,sh.maximumAsynchronousTasks),BJ=new ce,TG=new ce;x0.prototype.createMesh=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).tilingScheme,i=e.x,n=e.y,r=e.level,o=y(e.exaggeration,1),a=y(e.exaggerationRelativeHeight,0),s=y(e.throttle,!0),l=t.ellipsoid;t.tileXYToNativeRectangle(i,n,r,BJ),t.tileXYToRectangle(i,n,r,TG);let c=l.cartographicToCartesian(ce.center(TG)),d=40075.16/(1<<r);this._skirtHeight=Math.min(8*d,1e3);let p=(s?RPe:OPe).scheduleTask({buffer:this._buffer,nativeRectangle:BJ,rectangle:TG,relativeToCenter:c,ellipsoid:l,skirtHeight:this._skirtHeight,exaggeration:o,exaggerationRelativeHeight:a,includeWebMercatorT:!0,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(!u(p))return;let f=this;return p.then((function(e){return f._mesh=new Ff(c,new Float32Array(e.vertices),new Uint16Array(e.indices),e.indexCountWithoutSkirts,e.vertexCountWithoutSkirts,e.minimumHeight,e.maximumHeight,se.clone(e.boundingSphere3D),h.clone(e.occludeePointInScaledSpace),e.numberOfAttributes,Pn.clone(e.orientedBoundingBox),sc.clone(e.encoding),e.westIndicesSouthToNorth,e.southIndicesEastToWest,e.eastIndicesNorthToSouth,e.northIndicesWestToEast),f._minimumHeight=e.minimumHeight,f._maximumHeight=e.maximumHeight,f._buffer=void 0,f._mesh}))},x0.prototype.interpolateHeight=function(e,t,i){let n=P.clamp((t-e.west)/e.width,0,1),r=P.clamp((i-e.south)/e.height,0,1);return u(this._mesh)?BPe(this,n,r):UPe(this,n,r,e)};var MPe=new pi("upsampleQuantizedTerrainMesh",sh.maximumAsynchronousTasks);x0.prototype.upsample=function(e,t,i,n,r,o,a){let s=this._mesh;if(!u(this._mesh))return;let l=2*t!==r,c=2*i===o,d=e.ellipsoid,p=e.tileXYToRectangle(r,o,a),f=MPe.scheduleTask({vertices:s.vertices,indices:s.indices,indexCountWithoutSkirts:s.indexCountWithoutSkirts,vertexCountWithoutSkirts:s.vertexCountWithoutSkirts,encoding:s.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:l,isNorthChild:c,childRectangle:p,ellipsoid:d});if(!u(f))return;let m=this;return f.then((function(e){let t=new Uint16Array(e.vertices),i=ke.createTypedArray(t.length/3,e.indices),n=m._skirtHeight;return new jb({quantizedVertices:t,indices:i,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:se.clone(e.boundingSphere),orientedBoundingBox:Pn.clone(e.orientedBoundingBox),horizonOcclusionPoint:h.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:n,southSkirtHeight:n,eastSkirtHeight:n,northSkirtHeight:n,childTileMask:0,createdByUpsampling:!0,credits:m._credits})}))},x0.prototype.isChildAvailable=function(e,t,i,n){let r=2;return i!==2*e&&++r,n!==2*t&&(r-=2),0!=(this._childTileMask&1<<r)},x0.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var LPe=new U,NPe=new U,FPe=new U,UJ=new h;function BPe(e,t,i){let n=e._mesh,r=n.vertices,o=n.encoding,a=n.indices;for(let e=0,n=a.length;e<n;e+=3){let n=a[e],s=a[e+1],l=a[e+2],u=o.decodeTextureCoordinates(r,n,LPe),c=o.decodeTextureCoordinates(r,s,NPe),h=o.decodeTextureCoordinates(r,l,FPe),d=__.computeBarycentricCoordinates(t,i,u.x,u.y,c.x,c.y,h.x,h.y,UJ);if(d.x>=-1e-15&&d.y>=-1e-15&&d.z>=-1e-15){let e=o.decodeHeight(r,n),t=o.decodeHeight(r,s),i=o.decodeHeight(r,l);return d.x*e+d.y*t+d.z*i}}}var kPe=Uint16Array.BYTES_PER_ELEMENT,kJ=Uint32Array.BYTES_PER_ELEMENT,AG=Int32Array.BYTES_PER_ELEMENT,VPe=Float32Array.BYTES_PER_ELEMENT,CG=Float64Array.BYTES_PER_ELEMENT;function UPe(e,t,i,n){let r=e._buffer,o=0,a=0,s=0;i>.5?(t>.5?(o=2,a=.5):o=3,s=.5):t>.5&&(o=1,a=.5);let l=new DataView(r),u=0;for(let e=0;e<o;++e)u+=l.getUint32(u,!0),u+=kJ;u+=kJ,u+=2*CG;let c=P.toRadians(180*l.getFloat64(u,!0));u+=CG;let h=P.toRadians(180*l.getFloat64(u,!0));u+=CG;let d=n.width/c/2,p=n.height/h/2,f=l.getInt32(u,!0);u+=AG;let m=3*l.getInt32(u,!0);u+=AG,u+=AG;let _,g=new Array(f),y=new Array(f),v=new Array(f);for(_=0;_<f;++_)g[_]=a+l.getUint8(u++)*d,y[_]=s+l.getUint8(u++)*p,v[_]=6371010*l.getFloat32(u,!0),u+=VPe;let b=new Array(m);for(_=0;_<m;++_)b[_]=l.getUint16(u,!0),u+=kPe;for(_=0;_<m;_+=3){let e=b[_],n=b[_+1],r=b[_+2],o=g[e],a=g[n],s=g[r],l=y[e],u=y[n],c=y[r],h=__.computeBarycentricCoordinates(t,i,o,l,a,u,s,c,UJ);if(h.x>=-1e-15&&h.y>=-1e-15&&h.z>=-1e-15)return h.x*v[e]+h.y*v[n]+h.z*v[r]}}var OS=x0,ku={UNKNOWN:0,NONE:1,SELF:2,PARENT:3},G1=new J;function W1(){this._terrainCache={},this._lastTidy=J.now()}function R_(e){e=y(e,y.EMPTY_OBJECT),this._tilingScheme=new Ui({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new ce(-P.PI,-P.PI,P.PI,P.PI),ellipsoid:e.ellipsoid});let t=e.credit;"string"==typeof t&&(t=new xt(t)),this._credit=t,this._levelZeroMaximumGeometricError=40075.16,this._terrainCache=new W1,this._terrainPromises={},this._terrainRequests={},this._errorEvent=new pe}W1.prototype.add=function(e,t){this._terrainCache[e]={buffer:t,timestamp:J.now()}},W1.prototype.get=function(e){let t=this._terrainCache[e];if(u(t))return delete this._terrainCache[e],t.buffer},W1.prototype.tidy=function(){if(J.now(G1),J.secondsDifference(G1,this._lastTidy)>10){let e=this._terrainCache,t=Object.keys(e),i=t.length;for(let n=0;n<i;++n){let i=t[n],r=e[i];J.secondsDifference(G1,r.timestamp)>10&&delete e[i]}J.clone(G1,this._lastTidy)}},Object.defineProperties(R_.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tilingScheme:{get:function(){return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}}),R_.fromMetadata=function(e,t){if(!e.terrainPresent)throw new ue(`The server ${e.url} doesn't have terrain`);let i=new R_(t);return i._metadata=e,i};var zPe=new pi("decodeGoogleEarthEnterprisePacket");function zJ(e,t,i){let n=t.getChildBitmask();if(t.terrainState===ku.PARENT){n=0;for(let t=0;t<4;++t){let r=i.getTileInformationFromQuadKey(e+t.toString());u(r)&&r.hasTerrain()&&(n|=1<<t)}}return n}function HPe(e,t,i,n){return i=u(i)&&i>0?i:1,e._metadata.resource.getDerivedResource({url:`flatfile?f1c-0${t}-t.${i.toString()}`,request:n})}R_.prototype.requestTileGeometry=function(e,t,i,n){let r=O_.tileXYToQuadKey(e,t,i),o=this._terrainCache,a=this._metadata,s=a.getTileInformationFromQuadKey(r);if(!u(s))return Promise.reject(new ue("Terrain tile doesn't exist"));let l=s.terrainState;u(l)||(l=s.terrainState=ku.UNKNOWN);let c=o.get(r);if(u(c)){let e=a.providers[s.terrainProvider];return Promise.resolve(new OS({buffer:c,childTileMask:zJ(r,s,a),credits:u(e)?[e]:void 0,negativeAltitudeExponentBias:a.negativeAltitudeExponentBias,negativeElevationThreshold:a.negativeAltitudeThreshold}))}if(o.tidy(),!s.ancestorHasTerrain)return Promise.resolve(new va({buffer:new Uint8Array(256),width:16,height:16}));if(l===ku.NONE)return Promise.reject(new ue("Terrain tile doesn't exist"));let h,d=r,p=-1;switch(l){case ku.SELF:p=s.terrainVersion;break;case ku.PARENT:d=d.substring(0,d.length-1),h=a.getTileInformationFromQuadKey(d),p=h.terrainVersion;break;case ku.UNKNOWN:s.hasTerrain()?p=s.terrainVersion:(d=d.substring(0,d.length-1),h=a.getTileInformationFromQuadKey(d),u(h)&&h.hasTerrain()&&(p=h.terrainVersion))}if(p<0)return Promise.reject(new ue("Terrain tile doesn't exist"));let f,m,_=this._terrainPromises,g=this._terrainRequests;if(u(_[d]))f=_[d],m=g[d];else{m=n;let e=HPe(this,d,p,m).fetchArrayBuffer();if(!u(e))return;f=e.then((function(e){return u(e)?zPe.scheduleTask({buffer:e,type:"Terrain",key:a.key},[e]).then((function(e){let t=a.getTileInformationFromQuadKey(d);t.terrainState=ku.SELF,o.add(d,e[0]);let i=t.terrainProvider,n=e.length-1;for(let t=0;t<n;++t){let n=d+t.toString(),r=a.getTileInformationFromQuadKey(n);u(r)&&(o.add(n,e[t+1]),r.terrainState=ku.PARENT,0===r.terrainProvider&&(r.terrainProvider=i))}})):Promise.reject(new ue("Failed to load terrain."))})),_[d]=f,g[d]=m,f=f.finally((function(){delete _[d],delete g[d]}))}return f.then((function(){let e=o.get(r);if(u(e)){let t=a.providers[s.terrainProvider];return new OS({buffer:e,childTileMask:zJ(r,s,a),credits:u(t)?[t]:void 0,negativeAltitudeExponentBias:a.negativeAltitudeExponentBias,negativeElevationThreshold:a.negativeAltitudeThreshold})}return Promise.reject(new ue("Failed to load terrain."))})).catch((function(e){return m.state===Qn.CANCELLED?(n.state=m.state,Promise.reject(e)):(s.terrainState=ku.NONE,Promise.reject(e))}))},R_.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},R_.prototype.getTileDataAvailable=function(e,t,i){let n=this._metadata,r=O_.tileXYToQuadKey(e,t,i),o=n.getTileInformation(e,t,i);if(null===o)return!1;if(u(o)){if(!o.ancestorHasTerrain)return!0;let e=o.terrainState;if(e===ku.NONE)return!1;if(!(u(e)&&e!==ku.UNKNOWN||(o.terrainState=ku.UNKNOWN,o.hasTerrain()))){r=r.substring(0,r.length-1);let e=n.getTileInformationFromQuadKey(r);if(!u(e)||!e.hasTerrain())return!1}return!0}if(n.isValid(r)){let r=new Ko({throttle:!1,throttleByServer:!0,type:Jr.TERRAIN});n.populateSubtree(e,t,i,r)}return!1},R_.prototype.loadTileDataAvailability=function(e,t,i){};var HJ=R_,j1={defaultApiKey:void 0};j1.mapTilesApiEndpoint=new ve({url:"https://tile.googleapis.com/v1/"}),j1.getDefaultCredit=function(){return new xt('<img src="https://assets.ion-development.cesium.com/google-credit.png" alt="Google">',!0)};var TT=j1,OG=[Ii,Oi],GPe=OG.length,cee=Math.cos(P.toRadians(30)),GJ=Math.cos(P.toRadians(150)),lee=0,uee=1e3;function L_(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions;this.width=y(e.width,1),this._positions=t,this.granularity=y(e.granularity,9999),this.loop=y(e.loop,!1),this.arcType=y(e.arcType,Yt.GEODESIC),this._ellipsoid=ie.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object.defineProperties(L_.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+1+ie.packedLength+1+1}}}),L_.setProjectionAndEllipsoid=function(e,t){let i=0;for(let e=0;e<GPe;e++)if(t instanceof OG[e]){i=e;break}e._projectionIndex=i,e._ellipsoid=t.ellipsoid};var WPe=new h,WJ=new h,jJ=new h;function PG(e,t,i,n,r){let o=pc(n,e,0,WPe),a=pc(n,e,i,WJ),s=pc(n,t,0,jJ),l=jm(a,o,WJ),u=jm(s,o,jJ);return h.cross(u,l,r),h.normalize(r,r)}var jPe=new fe,qPe=new h,YPe=new h,XPe=new h;function EG(e,t,i,n,r,o,a,s,l,u,c){if(0===r)return;let d;o===Yt.GEODESIC?d=new Hf(e,t,a):o===Yt.RHUMB&&(d=new Ia(e,t,a));let p=d.surfaceDistance;if(p<r)return;let f=PG(e,t,n,a,XPe),m=Math.ceil(p/r),_=p/m,g=_,y=m-1,v=s.length;for(let e=0;e<y;e++){let e=d.interpolateUsingSurfaceDistance(g,jPe),t=pc(a,e,i,qPe),r=pc(a,e,n,YPe);h.pack(f,s,v),h.pack(t,l,v),h.pack(r,u,v),c.push(e.latitude),c.push(e.longitude),v+=3,g+=_}}var SG=new fe;function pc(e,t,i,n){return fe.clone(t,SG),SG.height=i,fe.toCartesian(SG,e,n)}function jm(e,t,i){return h.subtract(e,t,i),h.normalize(i,i),i}function qJ(e,t,i,n){return n=jm(e,t,n),n=h.cross(n,i,n),n=h.normalize(n,n),n=h.cross(i,n,n)}L_.pack=function(e,t,i){let n=y(i,0),r=e._positions,o=r.length;t[n++]=o;for(let e=0;e<o;++e){let i=r[e];h.pack(i,t,n),n+=3}return t[n++]=e.granularity,t[n++]=e.loop?1:0,t[n++]=e.arcType,ie.pack(e._ellipsoid,t,n),n+=ie.packedLength,t[n++]=e._projectionIndex,t[n++]=e._scene3DOnly?1:0,t},L_.unpack=function(e,t,i){let n=y(t,0),r=e[n++],o=new Array(r);for(let t=0;t<r;t++)o[t]=h.unpack(e,n),n+=3;let a=e[n++],s=1===e[n++],l=e[n++],c=ie.unpack(e,n);n+=ie.packedLength;let d=e[n++],p=1===e[n++];return u(i)||(i=new L_({positions:o})),i._positions=o,i.granularity=a,i.loop=s,i.arcType=l,i._ellipsoid=c,i._projectionIndex=d,i._scene3DOnly=p,i};var KPe=new h,ZPe=new h,$Pe=new h,fee=new h,QPe=0,JPe=-1;function wG(e,t,i,n,r){let o=jm(i,t,fee),a=qJ(e,t,o,KPe),s=qJ(n,t,o,ZPe);if(P.equalsEpsilon(h.dot(a,s),JPe,P.EPSILON5))return r=h.cross(o,a,r),r=h.normalize(r,r);r=h.add(s,a,r),r=h.normalize(r,r);let l=h.cross(o,r,$Pe);return h.dot(s,l)<QPe&&(r=h.negate(r,r)),r}var K1=tn.fromPointNormal(h.ZERO,h.UNIT_Y),e1e=new h,t1e=new h,n1e=new h,i1e=new h,o1e=new h,q1=new h,Y1=new fe,YJ=new fe,XJ=new fe;L_.createGeometry=function(e){let t,i,n=!e._scene3DOnly,r=e.loop,o=e._ellipsoid,a=e.granularity,s=e.arcType,l=new OG[e._projectionIndex](o),c=lee,d=uee,p=e._positions,f=p.length;2===f&&(r=!1);let m,_,g,y,v,b,A,T=new Ia(void 0,void 0,o),E=[p[0]];for(i=0;i<f-1;i++)m=p[i],_=p[i+1],v=Ai.lineSegmentPlane(m,_,K1,q1),u(v)&&!h.equalsEpsilon(v,m,P.EPSILON7)&&!h.equalsEpsilon(v,_,P.EPSILON7)&&(e.arcType===Yt.GEODESIC?E.push(h.clone(v)):e.arcType===Yt.RHUMB&&(A=o.cartesianToCartographic(v,Y1).longitude,g=o.cartesianToCartographic(m,Y1),y=o.cartesianToCartographic(_,YJ),T.setEndPoints(g,y),b=T.findIntersectionWithLongitude(A,XJ),v=o.cartographicToCartesian(b,q1),u(v)&&!h.equalsEpsilon(v,m,P.EPSILON7)&&!h.equalsEpsilon(v,_,P.EPSILON7)&&E.push(h.clone(v)))),E.push(_);r&&(m=p[f-1],_=p[0],v=Ai.lineSegmentPlane(m,_,K1,q1),u(v)&&!h.equalsEpsilon(v,m,P.EPSILON7)&&!h.equalsEpsilon(v,_,P.EPSILON7)&&(e.arcType===Yt.GEODESIC?E.push(h.clone(v)):e.arcType===Yt.RHUMB&&(A=o.cartesianToCartographic(v,Y1).longitude,g=o.cartesianToCartographic(m,Y1),y=o.cartesianToCartographic(_,YJ),T.setEndPoints(g,y),b=T.findIntersectionWithLongitude(A,XJ),v=o.cartographicToCartesian(b,q1),u(v)&&!h.equalsEpsilon(v,m,P.EPSILON7)&&!h.equalsEpsilon(v,_,P.EPSILON7)&&E.push(h.clone(v)))));let C=E.length,x=new Array(C);for(i=0;i<C;i++){let e=fe.fromCartesian(E[i],o);e.height=0,x[i]=e}if(x=go(x,fe.equalsEpsilon),C=x.length,C<2)return;let S=[],w=[],I=[],D=[],O=e1e,L=t1e,R=n1e,N=i1e,M=o1e,F=x[0],B=x[1];for(O=pc(o,x[C-1],c,O),N=pc(o,B,c,N),L=pc(o,F,c,L),R=pc(o,F,d,R),M=r?wG(O,L,R,N,M):PG(F,B,d,o,M),h.pack(M,w,0),h.pack(L,I,0),h.pack(R,D,0),S.push(F.latitude),S.push(F.longitude),EG(F,B,c,d,a,s,o,w,I,D,S),i=1;i<C-1;++i){O=h.clone(L,O),L=h.clone(N,L);let e=x[i];pc(o,e,d,R),pc(o,x[i+1],c,N),wG(O,L,R,N,M),t=w.length,h.pack(M,w,t),h.pack(L,I,t),h.pack(R,D,t),S.push(e.latitude),S.push(e.longitude),EG(x[i],x[i+1],c,d,a,s,o,w,I,D,S)}let z=x[C-1],U=x[C-2];if(L=pc(o,z,c,L),R=pc(o,z,d,R),r){let e=x[0];O=pc(o,U,c,O),N=pc(o,e,c,N),M=wG(O,L,R,N,M)}else M=PG(U,z,d,o,M);if(t=w.length,h.pack(M,w,t),h.pack(L,I,t),h.pack(R,D,t),S.push(z.latitude),S.push(z.longitude),r){for(EG(z,F,c,d,a,s,o,w,I,D,S),t=w.length,i=0;i<3;++i)w[t+i]=w[i],I[t+i]=I[i],D[t+i]=D[i];S.push(F.latitude),S.push(F.longitude)}return P1e(r,l,I,D,w,S,n)};var r1e=new h,s1e=new $,a1e=new Le;function KJ(e,t,i,n){let r=jm(i,t,r1e),o=h.dot(r,e);if(o>cee||o<GJ){let t=jm(n,i,fee),r=o<GJ?P.PI_OVER_TWO:-P.PI_OVER_TWO,a=Le.fromAxisAngle(t,r,a1e),s=$.fromQuaternion(a,s1e);return $.multiplyByVector(s,e,e),!0}return!1}var ZJ=new fe,c1e=new h,$J=new h;function RS(e,t,i,n,r){let o=fe.toCartesian(t,e._ellipsoid,c1e),a=h.add(o,i,$J),s=!1,l=e._ellipsoid,u=l.cartesianToCartographic(a,ZJ);Math.abs(t.longitude-u.longitude)>P.PI_OVER_TWO&&(s=!0,a=h.subtract(o,i,$J),u=l.cartesianToCartographic(a,ZJ)),u.height=0;let c=e.project(u,r);return(r=h.subtract(c,n,r)).z=0,r=h.normalize(r,r),s&&h.negate(r,r),r}var l1e=new h,QJ=new h;function JJ(e,t,i,n,r,o){let a=h.subtract(t,e,l1e);h.normalize(a,a);let s=i-lee,l=h.multiplyByScalar(a,s,QJ);h.add(e,l,r);let u=n-uee;l=h.multiplyByScalar(a,u,QJ),h.add(t,l,o)}var u1e=new h;function X1(e,t){let i=tn.getPointDistance(K1,e),n=tn.getPointDistance(K1,t),r=u1e;P.equalsEpsilon(i,0,P.EPSILON2)?(r=jm(t,e,r),h.multiplyByScalar(r,P.EPSILON2,r),h.add(e,r,e)):P.equalsEpsilon(n,0,P.EPSILON2)&&(r=jm(e,t,r),h.multiplyByScalar(r,P.EPSILON2,r),h.add(t,r,t))}function f1e(e,t){let i=Math.abs(e.longitude),n=Math.abs(t.longitude);if(P.equalsEpsilon(i,P.PI,P.EPSILON11)){let n=P.sign(t.longitude);return e.longitude=n*(i-P.EPSILON11),1}if(P.equalsEpsilon(n,P.PI,P.EPSILON11)){let i=P.sign(e.longitude);return t.longitude=i*(n-P.EPSILON11),2}return 0}var dee=new fe,hee=new fe,eee=new h,vG=new h,tee=new h,nee=new h,d1e=new h,iee=new h,h1e=[dee,hee],m1e=new ce,p1e=new h,_1e=new h,g1e=new h,y1e=new h,x1e=new h,b1e=new h,DG=new h,IG=new h,T1e=new h,A1e=new h,C1e=new h,oee=new h,E1e=new h,S1e=new h,w1e=new Wn,v1e=new Wn,ree=new h,D1e=new h,see=new h,I1e=[new se,new se],mee=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],aee=mee.length;function P1e(e,t,i,n,r,o,a){let s,l,u,c,d,p,f=t._ellipsoid,m=i.length/3-1,_=8*m,g=4*_,y=36*m,v=_>65535?new Uint32Array(y):new Uint16Array(y),b=new Float64Array(3*_),A=new Float32Array(g),T=new Float32Array(g),E=new Float32Array(g),C=new Float32Array(g),x=new Float32Array(g);a&&(u=new Float32Array(g),c=new Float32Array(g),d=new Float32Array(g),p=new Float32Array(2*_));let S=o.length/2,w=0,I=dee;I.height=0;let D=hee;D.height=0;let O=eee,L=vG;if(a)for(l=0,s=1;s<S;s++)I.latitude=o[l],I.longitude=o[l+1],D.latitude=o[l+2],D.longitude=o[l+3],O=t.project(I,O),L=t.project(D,L),w+=h.distance(O,L),l+=2;let R=n.length/3;L=h.unpack(n,0,L);let N,M=0;for(l=3,s=1;s<R;s++)O=h.clone(L,O),L=h.unpack(n,l,L),M+=h.distance(O,L),l+=3;l=3;let F=0,B=0,z=0,U=0,k=!1,V=h.unpack(i,0,nee),H=h.unpack(n,0,vG),G=h.unpack(r,0,iee);if(e){KJ(G,h.unpack(i,i.length-6,tee),V,H)&&(G=h.negate(G,G))}let j=0,W=0,q=0;for(s=0;s<m;s++){let e,s,m,_,g=h.clone(V,tee),y=h.clone(H,eee),v=h.clone(G,d1e);if(k&&(v=h.negate(v,v)),V=h.unpack(i,l,nee),H=h.unpack(n,l,vG),G=h.unpack(r,l,iee),k=KJ(G,g,V,H),I.latitude=o[F],I.longitude=o[F+1],D.latitude=o[F+2],D.longitude=o[F+3],a){let i=f1e(I,D);e=t.project(I,x1e),s=t.project(D,b1e);let n=jm(s,e,ree);n.y=Math.abs(n.y),m=DG,_=IG,0===i||h.dot(n,h.UNIT_Y)>cee?(m=RS(t,I,v,e,DG),_=RS(t,D,G,s,IG)):1===i?(_=RS(t,D,G,s,IG),m.x=0,m.y=P.sign(I.longitude-Math.abs(D.longitude)),m.z=0):(m=RS(t,I,v,e,DG),_.x=0,_.y=P.sign(I.longitude-D.longitude),_.z=0)}let S=h.distance(y,H),O=Wn.fromCartesian(g,w1e),L=h.subtract(V,g,T1e),R=h.normalize(L,oee),Y=h.subtract(y,g,A1e);Y=h.normalize(Y,Y);let X=h.cross(R,Y,oee);X=h.normalize(X,X);let $=h.cross(Y,v,E1e);$=h.normalize($,$);let K=h.subtract(H,V,C1e);K=h.normalize(K,K);let J=h.cross(G,K,S1e);J=h.normalize(J,J);let Q,Z,ee,te=S/M,ie=j/M,ne=0,re=0,oe=0;if(a){ne=h.distance(e,s),Q=Wn.fromCartesian(e,v1e),Z=h.subtract(s,e,ree),ee=h.normalize(Z,D1e);let t=ee.x;ee.x=ee.y,ee.y=-t,re=ne/w,oe=W/w}for(N=0;N<8;N++){let e=U+4*N,t=B+2*N,i=e+3,n=N<4?1:-1,r=2===N||3===N||6===N||7===N?1:-1;h.pack(O.high,A,e),A[i]=L.x,h.pack(O.low,T,e),T[i]=L.y,h.pack($,E,e),E[i]=L.z,h.pack(J,C,e),C[i]=te*n,h.pack(X,x,e);let o=ie*r;0===o&&r<0&&(o=9),x[i]=o,a&&(u[e]=Q.high.x,u[e+1]=Q.high.y,u[e+2]=Q.low.x,u[e+3]=Q.low.y,d[e]=-m.y,d[e+1]=m.x,d[e+2]=_.y,d[e+3]=-_.x,c[e]=Z.x,c[e+1]=Z.y,c[e+2]=ee.x,c[e+3]=ee.y,p[t]=re*n,o=oe*r,0===o&&r<0&&(o=9),p[t+1]=o)}let ae=g1e,se=y1e,le=p1e,ue=_1e,he=ce.fromCartographicArray(h1e,m1e),de=li.getMinimumMaximumHeights(he,f),pe=de.minimumTerrainHeight,fe=de.maximumTerrainHeight;q+=Math.abs(pe),q+=Math.abs(fe),JJ(g,y,pe,fe,ae,le),JJ(V,H,pe,fe,se,ue);let me=h.multiplyByScalar(X,P.EPSILON5,see);h.add(ae,me,ae),h.add(se,me,se),h.add(le,me,le),h.add(ue,me,ue),X1(ae,se),X1(le,ue),h.pack(ae,b,z),h.pack(se,b,z+3),h.pack(ue,b,z+6),h.pack(le,b,z+9),me=h.multiplyByScalar(X,-2*P.EPSILON5,see),h.add(ae,me,ae),h.add(se,me,se),h.add(le,me,le),h.add(ue,me,ue),X1(ae,se),X1(le,ue),h.pack(ae,b,z+12),h.pack(se,b,z+15),h.pack(ue,b,z+18),h.pack(le,b,z+21),F+=2,l+=3,B+=16,z+=24,U+=32,j+=S,W+=ne}l=0;let Y=0;for(s=0;s<m;s++){for(N=0;N<aee;N++)v[l+N]=mee[N]+Y;Y+=8,l+=aee}let $=I1e;se.fromVertices(i,h.ZERO,3,$[0]),se.fromVertices(n,h.ZERO,3,$[1]);let K=se.fromBoundingSpheres($);K.radius+=q/(2*m);let J={position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,normalize:!1,values:b}),startHiAndForwardOffsetX:M_(A),startLoAndForwardOffsetY:M_(T),startNormalAndForwardOffsetZ:M_(E),endNormalAndTextureCoordinateNormalizationX:M_(C),rightNormalAndTextureCoordinateNormalizationY:M_(x)};return a&&(J.startHiLo2D=M_(u),J.offsetAndRight2D=M_(c),J.startEndNormals2D=M_(d),J.texcoordNormalization2D=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,normalize:!1,values:p})),new ct({attributes:J,indices:v,boundingSphere:K})}function M_(e){return new Se({componentDatatype:X.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}L_._projectNormal=RS;var AT=L_;function RG(e,t,i){this.heading=y(e,0),this.pitch=y(t,0),this.range=y(i,0)}RG.clone=function(e,t){if(u(e))return u(t)||(t=new RG),t.heading=e.heading,t.pitch=e.pitch,t.range=e.range,t};var qf=RG,O1e=P.factorial;function MG(e,t,i,n,r,o){let a,s,l,u=0;if(n>0){for(s=0;s<r;s++){for(a=!1,l=0;l<o.length&&!a;l++)s===o[l]&&(a=!0);a||(o.push(s),u+=MG(e,t,i,n-1,r,o),o.splice(o.length-1,1))}return u}for(u=1,s=0;s<r;s++){for(a=!1,l=0;l<o.length&&!a;l++)s===o[l]&&(a=!0);a||(u*=e-i[t[s]])}return u}var Z1={type:"Hermite",getRequiredDataPoints:function(e,t){return t=y(t,0),Math.max(Math.floor((e+1)/(t+1)),2)},interpolateOrderZero:function(e,t,i,n,r){u(r)||(r=new Array(n));let o,a,s,l,c,h,d=t.length,p=new Array(n);for(o=0;o<n;o++){r[o]=0;let e=new Array(d);for(p[o]=e,a=0;a<d;a++)e[a]=[]}let f=d,m=new Array(f);for(o=0;o<f;o++)m[o]=o;let _=d-1;for(l=0;l<n;l++){for(a=0;a<f;a++)h=m[a]*n+l,p[l][0].push(i[h]);for(o=1;o<f;o++){let e=!1;for(a=0;a<f-o;a++){let r,s=t[m[a]],u=t[m[a+o]];u-s<=0?(h=m[a]*n+n*o+l,r=i[h],p[l][o].push(r/O1e(o))):(r=p[l][o-1][a+1]-p[l][o-1][a],p[l][o].push(r/(u-s))),e=e||0!==r}e||(_=o-1)}}for(s=0,c=0;s<=0;s++)for(o=s;o<=_;o++){let i=MG(e,m,t,s,o,[]);for(l=0;l<n;l++){let e=p[l][o][0];r[l+s*n]+=e*i}}return r}},R1e=[];function M1e(e,t,i,n,r,o){let a,s,l=-1,u=t.length,c=u*(u+1)/2;for(let h=0;h<r;h++){let d=Math.floor(h*c);for(a=0;a<u;a++)s=t[a]*r*(o+1)+h,e[d+a]=n[s];for(let c=1;c<u;c++){let p=0,f=Math.floor(c*(1-c)/2)+u*c,m=!1;for(a=0;a<u-c;a++){let l,_,g=i[t[a]],y=i[t[a+c]];if(y-g<=0)s=t[a]*r*(o+1)+r*c+h,l=n[s],_=l/P.factorial(c),e[d+f+p]=_,p++;else{let t=Math.floor((c-1)*(2-c)/2)+u*(c-1);l=e[d+t+a+1]-e[d+t+a],_=l/(y-g),e[d+f+p]=_,p++}m=m||0!==l}m&&(l=Math.max(l,c))}}return l}Z1.interpolate=function(e,t,i,n,r,o,a){let s=n*(o+1);u(a)||(a=new Array(s));for(let e=0;e<s;e++)a[e]=0;let l,c=t.length,h=new Array(c*(r+1));for(l=0;l<c;l++)for(let e=0;e<r+1;e++)h[l*(r+1)+e]=l;let d=h.length,p=R1e,f=M1e(p,h,t,i,n,r),m=[],_=d*(d+1)/2,g=Math.min(f,o);for(let i=0;i<=g;i++)for(l=i;l<=f;l++){m.length=0;let r=MG(e,h,t,i,l,m),o=Math.floor(l*(1-l)/2)+d*l;for(let e=0;e<n;e++){let t=p[Math.floor(e*_)+o];a[e+i*n]+=t*r}}return a};var $1=Z1,LG={};function pee(e,t,i,n){if(0!==n)return;1===i&&(t.x=e-1-t.x,t.y=e-1-t.y);let r=t.x;t.x=t.y,t.y=r}LG.encode2D=function(e,t,i){let n,r,o,a=Math.pow(2,e),s={x:t,y:i},l=BigInt(0);for(o=a/2;o>0;o/=2)n=(s.x&o)>0?1:0,r=(s.y&o)>0?1:0,l+=BigInt((3*n^r)*o*o),pee(a,s,n,r);return l},LG.decode2D=function(e,t){let i,n,r,o,a=Math.pow(2,e),s={x:0,y:0};for(r=1,o=t;r<a;r*=2)i=1&Number(o/BigInt(2)),n=1&Number(o^BigInt(i)),pee(r,s,i,n),s.x+=r*i,s.y+=r*n,o/=BigInt(4);return[s.x,s.y]};var MS=LG;function L1e(e,t,i,n){this.rightAscension=e,this.declination=t,this.rotation=i,this.rotationRate=n}var Q1=L1e,Iee={},N1e=32.184,F1e=2451545,_ee=-.0529921,gee=-.1059842,yee=13.0120009,xee=13.3407154,bee=.9856003,Tee=26.4057084,Aee=13.064993,Cee=.3287146,Eee=1.7484877,See=-.1589763,wee=.0036096,vee=.1643573,Dee=12.9590088,NG=new J;Iee.ComputeMoon=function(e,t){u(e)||(e=J.now()),NG=J.addSeconds(e,N1e,NG);let i=J.totalDays(NG)-F1e,n=i/Xn.DAYS_PER_JULIAN_CENTURY,r=(125.045+_ee*i)*P.RADIANS_PER_DEGREE,o=(250.089+gee*i)*P.RADIANS_PER_DEGREE,a=(260.008+yee*i)*P.RADIANS_PER_DEGREE,s=(176.625+xee*i)*P.RADIANS_PER_DEGREE,l=(357.529+bee*i)*P.RADIANS_PER_DEGREE,c=(311.589+Tee*i)*P.RADIANS_PER_DEGREE,h=(134.963+Aee*i)*P.RADIANS_PER_DEGREE,d=(276.617+Cee*i)*P.RADIANS_PER_DEGREE,p=(34.226+Eee*i)*P.RADIANS_PER_DEGREE,f=(15.134+See*i)*P.RADIANS_PER_DEGREE,m=(119.743+wee*i)*P.RADIANS_PER_DEGREE,_=(239.961+vee*i)*P.RADIANS_PER_DEGREE,g=(25.053+Dee*i)*P.RADIANS_PER_DEGREE,y=Math.sin(r),v=Math.sin(o),b=Math.sin(a),A=Math.sin(s),T=Math.sin(l),E=Math.sin(c),C=Math.sin(h),x=Math.sin(d),S=Math.sin(p),w=Math.sin(f),I=Math.sin(m),D=Math.sin(_),O=Math.sin(g),L=Math.cos(r),R=Math.cos(o),N=Math.cos(a),M=Math.cos(s),F=Math.cos(l),B=Math.cos(c),z=Math.cos(h),U=Math.cos(d),k=Math.cos(p),V=Math.cos(f),H=Math.cos(m),G=Math.cos(_),j=Math.cos(g),W=(269.9949+.0031*n-3.8787*y-.1204*v+.07*b-.0172*A+.0072*E-.0052*w+.0043*O)*P.RADIANS_PER_DEGREE,q=(66.5392+.013*n+1.5419*L+.0239*R-.0278*N+.0068*M-.0029*B+9e-4*z+8e-4*V-9e-4*j)*P.RADIANS_PER_DEGREE,Y=(38.3213+13.17635815*i-14e-13*i*i+3.561*y+.1208*v-.0642*b+.0158*A+.0252*T-.0066*E-.0047*C-.0046*x+.0028*S+.0052*w+.004*I+.0019*D-.0044*O)*P.RADIANS_PER_DEGREE,X=(13.17635815-2*i*14e-13+3.561*L*_ee+.1208*R*gee-.0642*N*yee+.0158*M*xee+.0252*F*bee-.0066*B*Tee-.0047*z*Aee-.0046*U*Cee+.0028*k*Eee+.0052*V*See+.004*H*wee+.0019*G*vee-.0044*j*Dee)/86400*P.RADIANS_PER_DEGREE;return u(t)||(t=new Q1),t.rightAscension=W,t.declination=q,t.rotation=Y,t.rotationRate=X,t};var J1=Iee;function Pee(e){(!u(e)||"function"!=typeof e)&&(e=J1.ComputeMoon),this._computeFunction=e}var B1e=new h,k1e=new h,V1e=new h;function U1e(e,t,i){let n=B1e;n.x=Math.cos(e+P.PI_OVER_TWO),n.y=Math.sin(e+P.PI_OVER_TWO),n.z=0;let r=Math.cos(t),o=V1e;o.x=r*Math.cos(e),o.y=r*Math.sin(e),o.z=Math.sin(t);let a=h.cross(o,n,k1e);return u(i)||(i=new $),i[0]=n.x,i[1]=a.x,i[2]=o.x,i[3]=n.y,i[4]=a.y,i[5]=o.y,i[6]=n.z,i[7]=a.z,i[8]=o.z,i}var z1e=new $,H1e=new Le;Pee.prototype.evaluate=function(e,t){u(e)||(e=J.now());let i=this._computeFunction(e),n=U1e(i.rightAscension,i.declination,t),r=P.zeroToTwoPi(i.rotation),o=Le.fromAxisAngle(h.UNIT_Z,r,H1e),a=$.fromQuaternion(Le.conjugate(o,o),z1e);return $.multiply(a,n,n)};var eO=Pee,LS={type:void 0};LS.getRequiredDataPoints=de.throwInstantiationError,LS.interpolateOrderZero=de.throwInstantiationError,LS.interpolate=de.throwInstantiationError;var Oee=LS,G1e={STEP:0,LINEAR:1,CUBICSPLINE:2},Ah=Object.freeze(G1e);function FG(e){this._url=ve.createIfNeeded(e),this._url.appendForwardSlash()}Object.defineProperties(FG.prototype,{url:{get:function(){return this._url}},credit:{get:function(){}}}),FG.prototype.geocode=async function(e,t){return this._url.getDerivedResource({url:t===y0.AUTOCOMPLETE?"autocomplete":"search",queryParameters:{text:e}}).fetchJson().then((function(e){return e.features.map((function(t){let i,n=t.bbox;if(u(n))i=ce.fromDegrees(n[0],n[1],n[2],n[3]);else{let e=t.geometry.coordinates[0],n=t.geometry.coordinates[1];i=h.fromDegrees(e,n)}return{displayName:t.properties.label,destination:i,attributions:e.attributions}}))}))};var tO=FG;function BG(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.accessToken,uh.defaultAccessToken),i=ve.createIfNeeded(y(e.server,uh.defaultServer));i.appendForwardSlash();let n=uh.getDefaultTokenCredit(t);u(n)&&e.scene.frameState.creditDisplay.addStaticCredit(xt.clone(n));let r=i.getDerivedResource({url:"v1/geocode"});u(t)&&r.appendQueryParameters({access_token:t}),this._accessToken=t,this._server=i,this._pelias=new tO(r)}Object.defineProperties(BG.prototype,{credit:{get:function(){}}}),BG.prototype.geocode=async function(e,t){return this._pelias.geocode(e,t)};var nO=BG;function Bo(e){e=y(e,y.EMPTY_OBJECT),this.start=u(e.start)?J.clone(e.start):new J,this.stop=u(e.stop)?J.clone(e.stop):new J,this.data=e.data,this.isStartIncluded=y(e.isStartIncluded,!0),this.isStopIncluded=y(e.isStopIncluded,!0)}Object.defineProperties(Bo.prototype,{isEmpty:{get:function(){let e=J.compare(this.stop,this.start);return e<0||0===e&&(!this.isStartIncluded||!this.isStopIncluded)}}});var CT={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};Bo.fromIso8601=function(e,t){let i=e.iso8601.split("/");if(2!==i.length)throw new de("options.iso8601 is an invalid ISO 8601 interval.");let n=J.fromIso8601(i[0]),r=J.fromIso8601(i[1]),o=y(e.isStartIncluded,!0),a=y(e.isStopIncluded,!0),s=e.data;return u(t)?(t.start=n,t.stop=r,t.isStartIncluded=o,t.isStopIncluded=a,t.data=s,t):(CT.start=n,CT.stop=r,CT.isStartIncluded=o,CT.isStopIncluded=a,CT.data=s,new Bo(CT))},Bo.toIso8601=function(e,t){return`${J.toIso8601(e.start,t)}/${J.toIso8601(e.stop,t)}`},Bo.clone=function(e,t){if(u(e))return u(t)?(t.start=e.start,t.stop=e.stop,t.isStartIncluded=e.isStartIncluded,t.isStopIncluded=e.isStopIncluded,t.data=e.data,t):new Bo(e)},Bo.equals=function(e,t,i){return e===t||u(e)&&u(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&J.equals(e.start,t.start)&&J.equals(e.stop,t.stop)&&(e.data===t.data||u(i)&&i(e.data,t.data)))},Bo.equalsEpsilon=function(e,t,i,n){return i=y(i,0),e===t||u(e)&&u(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&J.equalsEpsilon(e.start,t.start,i)&&J.equalsEpsilon(e.stop,t.stop,i)&&(e.data===t.data||u(n)&&n(e.data,t.data)))},Bo.intersect=function(e,t,i,n){if(!u(t))return Bo.clone(Bo.EMPTY,i);let r=e.start,o=e.stop,a=t.start,s=t.stop,l=J.greaterThanOrEquals(a,r)&&J.greaterThanOrEquals(o,a),c=!l&&J.lessThanOrEquals(a,r)&&J.lessThanOrEquals(r,s);if(!l&&!c)return Bo.clone(Bo.EMPTY,i);let h=e.isStartIncluded,d=e.isStopIncluded,p=t.isStartIncluded,f=t.isStopIncluded,m=J.lessThan(o,s);return u(i)||(i=new Bo),i.start=l?a:r,i.isStartIncluded=h&&p||!J.equals(a,r)&&(l&&p||c&&h),i.stop=m?o:s,i.isStopIncluded=m?d:d&&f||!J.equals(s,o)&&f,i.data=u(n)?n(e.data,t.data):e.data,i},Bo.contains=function(e,t){if(e.isEmpty)return!1;let i=J.compare(e.start,t);if(0===i)return e.isStartIncluded;let n=J.compare(t,e.stop);return 0===n?e.isStopIncluded:i<0&&n<0},Bo.prototype.clone=function(e){return Bo.clone(this,e)},Bo.prototype.equals=function(e,t){return Bo.equals(this,e,t)},Bo.prototype.equalsEpsilon=function(e,t,i){return Bo.equalsEpsilon(this,e,t,i)},Bo.prototype.toString=function(){return Bo.toIso8601(this)},Bo.EMPTY=Object.freeze(new Bo({start:new J,stop:new J,isStartIncluded:!1,isStopIncluded:!1}));var Cn=Bo,Ree=Object.freeze(J.fromIso8601("0000-01-01T00:00:00Z")),Mee=Object.freeze(J.fromIso8601("9999-12-31T24:00:00Z")),W1e=Object.freeze(new Cn({start:Ree,stop:Mee})),j1e={MINIMUM_VALUE:Ree,MAXIMUM_VALUE:Mee,MAXIMUM_INTERVAL:W1e},ze=j1e,q1e={SHIFT:0,CTRL:1,ALT:2},na=Object.freeze(q1e);function qm(){}function Y1e(){let e=qm._transcodeTaskProcessor.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/basis_transcoder.wasm"}).then((function(e){if(e)return qm._transcodeTaskProcessor;throw new ue("KTX2 transcoder could not be initialized.")}));qm._readyPromise=e}qm._transcodeTaskProcessor=new pi("transcodeKTX2",Number.POSITIVE_INFINITY),qm._readyPromise=void 0,qm.transcode=function(e,t){return u(qm._readyPromise)||Y1e(),qm._readyPromise.then((function(i){let n;if(e instanceof ArrayBuffer){let r=new Uint8Array(e);return n={supportedTargetFormats:t,ktx2Buffer:r},i.scheduleTask(n,[e])}return n={supportedTargetFormats:t,ktx2Buffer:e},i.scheduleTask(n,[e.buffer])})).then((function(e){let t,i=e.length,n=Object.keys(e[0]),r=n.length;for(t=0;t<i;t++){let i=e[t];for(let e=0;e<r;e++){let t=i[n[e]];i[n[e]]=new u1(t.internalFormat,t.datatype,t.width,t.height,t.levelBuffer)}}if(1===r){for(t=0;t<i;++t)e[t]=e[t][n[0]];1===i&&(e=e[0])}return e})).catch((function(e){throw e}))};var iO=qm,kG={type:"Lagrange",getRequiredDataPoints:function(e){return Math.max(e+1,2)},interpolateOrderZero:function(e,t,i,n,r){u(r)||(r=new Array(n));let o,a,s=t.length;for(o=0;o<n;o++)r[o]=0;for(o=0;o<s;o++){let l=1;for(a=0;a<s;a++)if(a!==o){let i=t[o]-t[a];l*=(e-t[a])/i}for(a=0;a<n;a++)r[a]+=l*i[o*n+a]}return r}},oO=kG,VG={type:"Linear",getRequiredDataPoints:function(e){return 2},interpolateOrderZero:function(e,t,i,n,r){u(r)||(r=new Array(n));let o,a,s,l=t[0],c=t[1];for(o=0;o<n;o++)a=i[o],s=i[o+n],r[o]=((s-a)*e+c*a-l*s)/(c-l);return r}},ET=VG;function X1e(e){let t,i=e.uint8Array,n=e.format,r=e.request,o=y(e.flipY,!1),a=y(e.skipColorSpaceConversion,!1),s=new Blob([i],{type:n});return ve.supportsImageBitmapOptions().then((function(e){return e?Promise.resolve(ve.createImageBitmapFromBlob(s,{flipY:o,premultiplyAlpha:!1,skipColorSpaceConversion:a})):(t=window.URL.createObjectURL(s),new ve({url:t,request:r}).fetchImage({flipY:o,skipColorSpaceConversion:a}))})).then((function(e){return u(t)&&window.URL.revokeObjectURL(t),e})).catch((function(e){return u(t)&&window.URL.revokeObjectURL(t),Promise.reject(e)}))}var ST=X1e,Lee;function Nee(e){let t;return t=e instanceof ArrayBuffer||ArrayBuffer.isView(e)?Promise.resolve(e):ve.createIfNeeded(e).fetchArrayBuffer(),t.then((function(e){return iO.transcode(e,Lee)}))}Nee.setKTX2SupportedFormats=function(e,t,i,n,r,o){Lee={s3tc:e,pvrtc:t,astc:i,etc:n,etc1:r,bc7:o}};var Ll=Nee;function Ch(e){e=y(e,0),this._array=new Array(e),this._length=e}Object.defineProperties(Ch.prototype,{length:{get:function(){return this._length},set:function(e){let t=this._array,i=this._length;if(e<i)for(let n=e;n<i;++n)t[n]=void 0;else e>t.length&&(t.length=e);this._length=e}},values:{get:function(){return this._array}}}),Ch.prototype.get=function(e){return this._array[e]},Ch.prototype.set=function(e,t){e>=this._length&&(this.length=e+1),this._array[e]=t},Ch.prototype.peek=function(){return this._array[this._length-1]},Ch.prototype.push=function(e){let t=this.length++;this._array[t]=e},Ch.prototype.pop=function(){if(0===this._length)return;let e=this._array[this._length-1];return--this.length,e},Ch.prototype.reserve=function(e){e>this._array.length&&(this._array.length=e)},Ch.prototype.resize=function(e){this.length=e},Ch.prototype.trim=function(e){e=y(e,this._length),this._array.length=e};var Jc=Ch;function rO(){de.throwInstantiationError()}Object.defineProperties(rO.prototype,{ellipsoid:{get:de.throwInstantiationError}}),rO.prototype.project=de.throwInstantiationError,rO.prototype.unproject=de.throwInstantiationError;var Fee=rO,UG=[],zG=[];function K1e(e,t,i,n,r,o){let a,s,l=r-n+1,u=o-r,c=UG,h=zG;for(a=0;a<l;++a)c[a]=e[n+a];for(s=0;s<u;++s)h[s]=e[r+s+1];a=0,s=0;for(let r=n;r<=o;++r){let n=c[a],o=h[s];a<l&&(s>=u||t(n,o,i)<=0)?(e[r]=n,++a):s<u&&(e[r]=o,++s)}}function HG(e,t,i,n,r){if(n>=r)return;let o=Math.floor(.5*(n+r));HG(e,t,i,n,o),HG(e,t,i,o+1,r),K1e(e,t,i,n,o,r)}function Z1e(e,t,i){let n=e.length,r=Math.ceil(.5*n);UG.length=r,zG.length=r,HG(e,t,i,0,n-1),UG.length=0,zG.length=0}var N_=Z1e;function wT(e){let t=(e=y(e,y.EMPTY_OBJECT)).weights,i=e.times;this._times=i,this._weights=t,this._count=t.length/i.length,this._lastTimeIndex=0}Object.defineProperties(wT.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}}),wT.prototype.findTimeInterval=eo.prototype.findTimeInterval,wT.prototype.wrapTime=eo.prototype.wrapTime,wT.prototype.clampTime=eo.prototype.clampTime,wT.prototype.evaluate=function(e,t){let i=this.weights,n=this.times,r=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),o=(e-n[r])/(n[r+1]-n[r]);u(t)||(t=new Array(this._count));for(let e=0;e<this._count;e++){let n=r*this._count+e;t[e]=i[n]*(1-o)+i[n+this._count]*o}return t};var Bee=wT,NS={};function kee(e){return e=1431655765&((e=858993459&((e=252645135&((e=16711935&(e^e<<8))^e<<4))^e<<2))^e<<1)}function GG(e){return e=153391689&((e=51130563&((e=50393103&((e=50331903&(e^e<<16))^e<<8))^e<<4))^e<<2)}function Vee(e){return e=65535&((e=16711935&((e=252645135&((e=858993459&((e&=1431655765)^e>>1))^e>>2))^e>>4))^e>>8)}function WG(e){return e=1023&((e=4278190335&((e=50393103&((e=51130563&((e&=153391689)^e>>2))^e>>4))^e>>8))^e>>16)}NS.encode2D=function(e,t){return(kee(e)|kee(t)<<1)>>>0},NS.decode2D=function(e,t){return u(t)||(t=new Array(2)),t[0]=Vee(e),t[1]=Vee(e>>1),t},NS.encode3D=function(e,t,i){return GG(e)|GG(t)<<1|GG(i)<<2},NS.decode3D=function(e,t){return u(t)||(t=new Array(3)),t[0]=WG(e),t[1]=WG(e>>1),t[2]=WG(e>>2),t};var b0=NS;function Vu(e,t,i,n){this.near=y(e,0),this.nearValue=y(t,0),this.far=y(i,1),this.farValue=y(n,0)}Vu.clone=function(e,t){if(u(e))return u(t)?(t.near=e.near,t.nearValue=e.nearValue,t.far=e.far,t.farValue=e.farValue,t):new Vu(e.near,e.nearValue,e.far,e.farValue)},Vu.packedLength=4,Vu.pack=function(e,t,i){return i=y(i,0),t[i++]=e.near,t[i++]=e.nearValue,t[i++]=e.far,t[i]=e.farValue,t},Vu.unpack=function(e,t,i){return t=y(t,0),u(i)||(i=new Vu),i.near=e[t++],i.nearValue=e[t++],i.far=e[t++],i.farValue=e[t],i},Vu.equals=function(e,t){return e===t||u(e)&&u(t)&&e.near===t.near&&e.nearValue===t.nearValue&&e.far===t.far&&e.farValue===t.farValue},Vu.prototype.clone=function(e){return Vu.clone(this,e)},Vu.prototype.equals=function(e){return Vu.equals(this,e)};var Pt=Vu,$1e={NONE:-1,PARTIAL:0,FULL:1},rr=Object.freeze($1e);function Oa(e,t){this._occluderPosition=h.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=t}var sO=new h;Object.defineProperties(Oa.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){e=h.clone(e,this._cameraPosition);let t,i,n,r=h.subtract(this._occluderPosition,e,sO),o=h.magnitudeSquared(r),a=this._occluderRadius*this._occluderRadius;if(o>a){t=Math.sqrt(o-a),o=1/Math.sqrt(o),i=h.multiplyByScalar(r,o,sO);let s=t*t*o;n=h.add(e,h.multiplyByScalar(i,s,sO),sO)}else t=Number.MAX_VALUE;this._horizonDistance=t,this._horizonPlaneNormal=i,this._horizonPlanePosition=n,this._cameraPosition=e}}}),Oa.fromBoundingSphere=function(e,t,i){return u(i)?(h.clone(e.center,i._occluderPosition),i._occluderRadius=e.radius,i.cameraPosition=t,i):new Oa(e,t)};var zee=new h;Oa.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){let t=h.subtract(e,this._occluderPosition,zee),i=this._occluderRadius;if(i=h.magnitudeSquared(t)-i*i,i>0)return i=Math.sqrt(i)+this._horizonDistance,t=h.subtract(e,this._cameraPosition,t),i*i>h.magnitudeSquared(t)}return!1};var Q1e=new h;Oa.prototype.isBoundingSphereVisible=function(e){let t=h.clone(e.center,Q1e),i=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){let e=h.subtract(t,this._occluderPosition,zee),n=this._occluderRadius-i;if(n=h.magnitudeSquared(e)-n*n,i<this._occluderRadius)return n>0&&(n=Math.sqrt(n)+this._horizonDistance,e=h.subtract(t,this._cameraPosition,e),n*n+i*i>h.magnitudeSquared(e));if(n>0){e=h.subtract(t,this._cameraPosition,e);let r=h.magnitudeSquared(e),o=this._occluderRadius*this._occluderRadius,a=i*i;return(this._horizonDistance*this._horizonDistance+o)*a>r*o||(n=Math.sqrt(n)+this._horizonDistance,n*n+a>r)}return!0}return!1};var J1e=new h;Oa.prototype.computeVisibility=function(e){let t=h.clone(e.center),i=e.radius;if(i>this._occluderRadius)return rr.FULL;if(this._horizonDistance!==Number.MAX_VALUE){let e=h.subtract(t,this._occluderPosition,J1e),n=this._occluderRadius-i,r=h.magnitudeSquared(e);if(n=r-n*n,n>0){n=Math.sqrt(n)+this._horizonDistance,e=h.subtract(t,this._cameraPosition,e);let o=h.magnitudeSquared(e);return n*n+i*i<o?rr.NONE:(n=this._occluderRadius+i,n=r-n*n,n>0?(n=Math.sqrt(n)+this._horizonDistance,o<n*n+i*i?rr.FULL:rr.PARTIAL):(e=h.subtract(t,this._horizonPlanePosition,e),h.dot(e,this._horizonPlaneNormal)>-i?rr.PARTIAL:rr.FULL))}}return rr.NONE};var aO=new h;Oa.computeOccludeePoint=function(e,t,i){let n,r=h.clone(t),o=h.clone(e.center),a=e.radius,s=i.length,l=h.normalize(h.subtract(r,o,aO),aO),u=-h.dot(l,o),c=Oa._anyRotationVector(o,l,u),d=Oa._horizonToPlaneNormalDotProduct(e,l,u,c,i[0]);if(!d)return;for(let t=1;t<s;++t){if(n=Oa._horizonToPlaneNormalDotProduct(e,l,u,c,i[t]),!n)return;n<d&&(d=n)}if(d<.0017453283658983088)return;let p=a/d;return h.add(o,h.multiplyByScalar(l,p,aO),aO)};var eOe=[];Oa.computeOccludeePointFromRectangle=function(e,t){t=y(t,ie.WGS84);let i=ce.subsample(e,t,0,eOe),n=se.fromPoints(i),r=h.ZERO;if(!h.equals(r,n.center))return Oa.computeOccludeePoint(new se(r,t.minimumRadius),n.center,i)};var tOe=new h;Oa._anyRotationVector=function(e,t,i){let n=h.abs(t,tOe),r=n.x>n.y?0:1;(0===r&&n.z>n.x||1===r&&n.z>n.y)&&(r=2);let o,a=new h;0===r?(n.x=e.x,n.y=e.y+1,n.z=e.z+1,o=h.UNIT_X):1===r?(n.x=e.x+1,n.y=e.y,n.z=e.z+1,o=h.UNIT_Y):(n.x=e.x+1,n.y=e.y+1,n.z=e.z,o=h.UNIT_Z);let s=(h.dot(t,n)+i)/-h.dot(t,o);return h.normalize(h.subtract(h.add(n,h.multiplyByScalar(o,s,a),n),e,n),n)};var nOe=new h;Oa._rotationVector=function(e,t,i,n,r){let o=h.subtract(n,e,nOe);if(o=h.normalize(o,o),h.dot(t,o)<.9999999847691291){let e=h.cross(t,o,o);if(h.magnitude(e)>P.EPSILON13)return h.normalize(e,new h)}return r};var jG=new h,iOe=new h,cO=new h,Uee=new h;Oa._horizonToPlaneNormalDotProduct=function(e,t,i,n,r){let o=h.clone(r,jG),a=h.clone(e.center,iOe),s=e.radius,l=h.subtract(a,o,cO),u=h.magnitudeSquared(l),c=s*s;if(u<c)return!1;let d=u-c,p=Math.sqrt(d),f=p*(1/Math.sqrt(u))*p;l=h.normalize(l,l);let m=h.add(o,h.multiplyByScalar(l,f,Uee),Uee),_=Math.sqrt(d-f*f),g=this._rotationVector(a,t,i,o,n),y=h.fromElements(g.x*g.x*l.x+(g.x*g.y-g.z)*l.y+(g.x*g.z+g.y)*l.z,(g.x*g.y+g.z)*l.x+g.y*g.y*l.y+(g.y*g.z-g.x)*l.z,(g.x*g.z-g.y)*l.x+(g.y*g.z+g.x)*l.y+g.z*g.z*l.z,jG);y=h.normalize(y,y);let v=h.multiplyByScalar(y,_,jG);g=h.normalize(h.subtract(h.add(m,v,cO),a,cO),cO);let b=h.dot(t,g);g=h.normalize(h.subtract(h.subtract(m,v,g),a,g),g);let A=h.dot(t,g);return b<A?b:A};var lO=Oa;function FS(e,t,i){e=y(e,0),t=y(t,0),i=y(i,0),this.value=new Float32Array([e,t,i])}Object.defineProperties(FS.prototype,{componentDatatype:{get:function(){return X.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}}),FS.fromCartesian3=function(e){return new FS(e.x,e.y,e.z)},FS.toValue=function(e,t){return u(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t};var Zi=FS;function qG(e,t,i){(e=ve.createIfNeeded(e)).appendForwardSlash(),e.setQueryParameters({key:t}),this._url=e,this._params=y(i,{}),this._credit=new xt('Geodata copyright <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',!1)}Object.defineProperties(qG.prototype,{url:{get:function(){return this._url}},params:{get:function(){return this._params}},credit:{get:function(){return this._credit}}}),qG.prototype.geocode=async function(e){return this._url.getDerivedResource({url:"json",queryParameters:gt(this._params,{q:e})}).fetchJson().then((function(e){return e.results.map((function(e){let t,i=e.bounds;if(u(i))t=ce.fromDegrees(i.southwest.lng,i.southwest.lat,i.northeast.lng,i.northeast.lat);else{let i=e.geometry.lat,n=e.geometry.lng;t=h.fromDegrees(i,n)}return{displayName:e.formatted,destination:t}}))}))};var Hee=qG,oOe={packedLength:void 0,pack:de.throwInstantiationError,unpack:de.throwInstantiationError},Gee=oOe,rOe={packedInterpolationLength:void 0,convertPackedArrayForInterpolation:de.throwInstantiationError,unpackInterpolationResult:de.throwInstantiationError},Wee=rOe,T0;function sOe(e,t,i,n,r){let o=e.measureText(t);if(/\S/.test(t)){let a=document.defaultView.getComputedStyle(e.canvas).getPropertyValue("font-size").replace("px",""),s=document.createElement("canvas"),l=100,u=o.width+l|0,c=3*a,h=c/2;s.width=u,s.height=c;let d=s.getContext("2d");d.font=i,d.fillStyle="white",d.fillRect(0,0,s.width+1,s.height+1),n&&(d.strokeStyle="black",d.lineWidth=e.lineWidth,d.strokeText(t,l/2,h)),r&&(d.fillStyle="black",d.fillText(t,l/2,h));let p,f,m,_,g=d.getImageData(0,0,u,c).data,y=g.length,v=4*u;for(p=0;p<y;++p)if(255!==g[p]){m=p/v|0;break}for(p=y-1;p>=0;--p)if(255!==g[p]){_=p/v|0;break}let b=-1;for(p=0;p<u&&-1===b;++p)for(f=0;f<c;++f){let e=4*p+f*v;if(255!==g[e]||255!==g[e+1]||255!==g[e+2]||255!==g[e+3]){b=p;break}}return{width:o.width,height:_-m,ascent:h-m,descent:_-h,minx:b-l/2}}return{width:o.width,height:0,ascent:0,descent:0,minx:0}}function aOe(e,t){if(""===e)return;t=y(t,y.EMPTY_OBJECT);let i=y(t.font,"10px sans-serif"),n=y(t.stroke,!1),r=y(t.fill,!0),o=y(t.strokeWidth,1),a=y(t.backgroundColor,z.TRANSPARENT),s=y(t.padding,0),l=2*s,c=document.createElement("canvas");c.width=1,c.height=1,c.style.font=i;let h=c.getContext("2d",{willReadFrequently:!0});u(T0)||(u(h.imageSmoothingEnabled)?T0="imageSmoothingEnabled":u(h.mozImageSmoothingEnabled)?T0="mozImageSmoothingEnabled":u(h.webkitImageSmoothingEnabled)?T0="webkitImageSmoothingEnabled":u(h.msImageSmoothingEnabled)&&(T0="msImageSmoothingEnabled")),h.font=i,h.lineJoin="round",h.lineWidth=o,h[T0]=!1,c.style.visibility="hidden",document.body.appendChild(c);let d=sOe(h,e,i,n,r);c.dimensions=d,document.body.removeChild(c),c.style.visibility="";let p=-d.minx,f=Math.ceil(d.width)+p+l,m=d.height+l,_=m-(m-d.ascent+s)+l;if(c.width=f,c.height=m,h.font=i,h.lineJoin="round",h.lineWidth=o,h[T0]=!1,a!==z.TRANSPARENT&&(h.fillStyle=a.toCssColorString(),h.fillRect(0,0,c.width,c.height)),n){let i=y(t.strokeColor,z.BLACK);h.strokeStyle=i.toCssColorString(),h.strokeText(e,p+s,_)}if(r){let i=y(t.fillColor,z.WHITE);h.fillStyle=i.toCssColorString(),h.fillText(e,p+s,_)}return c}var vT=aOe;function kS(){this._cache={}}kS.prototype.fromColor=function(e,t){return uO(void 0,void 0,e,t,this._cache)},kS.prototype.fromUrl=function(e,t,i){return uO(e,void 0,t,i,this._cache)},kS.prototype.fromMakiIconId=function(e,t,i){return uO($t(`Assets/Textures/maki/${encodeURIComponent(e)}.png`),void 0,t,i,this._cache)},kS.prototype.fromText=function(e,t,i){return uO(void 0,e,t,i,this._cache)};var cOe=new z;function lOe(e,t,i){e.save(),e.scale(i/24,i/24),e.fillStyle=t.toCssColorString(),e.strokeStyle=t.brighten(.6,cOe).toCssColorString(),e.lineWidth=.846,e.beginPath(),e.moveTo(6.72,.422),e.lineTo(17.28,.422),e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),e.lineTo(19.577,10.973),e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),e.lineTo(14.386,14.008),e.lineTo(11.826,23.578),e.lineTo(9.614,14.008),e.lineTo(6.719,13.965),e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),e.lineTo(4.422,3.416),e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),e.closePath(),e.fill(),e.stroke(),e.restore()}function jee(e,t,i){let n=i/2.5,r=n,o=n;t.width>t.height?o=n*(t.height/t.width):t.width<t.height&&(r=n*(t.width/t.height));let a=Math.round((i-r)/2),s=Math.round(7/24*i-o/2);e.globalCompositeOperation="destination-out",e.drawImage(t,a-1,s,r,o),e.drawImage(t,a,s-1,r,o),e.drawImage(t,a+1,s,r,o),e.drawImage(t,a,s+1,r,o),e.globalCompositeOperation="destination-over",e.fillStyle=z.BLACK.toCssColorString(),e.fillRect(a-1,s-1,r+2,o+2),e.globalCompositeOperation="destination-out",e.drawImage(t,a,s,r,o),e.globalCompositeOperation="destination-over",e.fillStyle=z.WHITE.toCssColorString(),e.fillRect(a-1,s-2,r+2,o+2)}var BS=new Array(4);function uO(e,t,i,n,r){BS[0]=e,BS[1]=t,BS[2]=i,BS[3]=n;let o=JSON.stringify(BS),a=r[o];if(u(a))return a;let s=document.createElement("canvas");s.width=n,s.height=n;let l=s.getContext("2d");if(lOe(l,i,n),u(e)){let t=ve.createIfNeeded(e).fetchImage().then((function(e){return jee(l,e,n),r[o]=s,s}));return r[o]=t,t}if(u(t)){let e=vT(t,{font:`bold ${n}px sans-serif`});jee(l,e,n)}return r[o]=s,s}var F_=kS,Si={UNSIGNED_BYTE:ee.UNSIGNED_BYTE,UNSIGNED_SHORT:ee.UNSIGNED_SHORT,UNSIGNED_INT:ee.UNSIGNED_INT,FLOAT:ee.FLOAT,HALF_FLOAT:ee.HALF_FLOAT_OES,UNSIGNED_INT_24_8:ee.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:ee.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:ee.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:ee.UNSIGNED_SHORT_5_6_5,toWebGLConstant:function(e,t){switch(e){case Si.UNSIGNED_BYTE:return ee.UNSIGNED_BYTE;case Si.UNSIGNED_SHORT:return ee.UNSIGNED_SHORT;case Si.UNSIGNED_INT:return ee.UNSIGNED_INT;case Si.FLOAT:return ee.FLOAT;case Si.HALF_FLOAT:return t.webgl2?ee.HALF_FLOAT:ee.HALF_FLOAT_OES;case Si.UNSIGNED_INT_24_8:return ee.UNSIGNED_INT_24_8;case Si.UNSIGNED_SHORT_4_4_4_4:return ee.UNSIGNED_SHORT_4_4_4_4;case Si.UNSIGNED_SHORT_5_5_5_1:return ee.UNSIGNED_SHORT_5_5_5_1;case Si.UNSIGNED_SHORT_5_6_5:return Si.UNSIGNED_SHORT_5_6_5}},isPacked:function(e){return e===Si.UNSIGNED_INT_24_8||e===Si.UNSIGNED_SHORT_4_4_4_4||e===Si.UNSIGNED_SHORT_5_5_5_1||e===Si.UNSIGNED_SHORT_5_6_5},sizeInBytes:function(e){switch(e){case Si.UNSIGNED_BYTE:return 1;case Si.UNSIGNED_SHORT:case Si.UNSIGNED_SHORT_4_4_4_4:case Si.UNSIGNED_SHORT_5_5_5_1:case Si.UNSIGNED_SHORT_5_6_5:case Si.HALF_FLOAT:return 2;case Si.UNSIGNED_INT:case Si.FLOAT:case Si.UNSIGNED_INT_24_8:return 4}},validate:function(e){return e===Si.UNSIGNED_BYTE||e===Si.UNSIGNED_SHORT||e===Si.UNSIGNED_INT||e===Si.FLOAT||e===Si.HALF_FLOAT||e===Si.UNSIGNED_INT_24_8||e===Si.UNSIGNED_SHORT_4_4_4_4||e===Si.UNSIGNED_SHORT_5_5_5_1||e===Si.UNSIGNED_SHORT_5_6_5}},Ye=Object.freeze(Si),it={DEPTH_COMPONENT:ee.DEPTH_COMPONENT,DEPTH_STENCIL:ee.DEPTH_STENCIL,ALPHA:ee.ALPHA,RED:ee.RED,RG:ee.RG,RGB:ee.RGB,RGBA:ee.RGBA,LUMINANCE:ee.LUMINANCE,LUMINANCE_ALPHA:ee.LUMINANCE_ALPHA,RGB_DXT1:ee.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:ee.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:ee.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:ee.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:ee.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:ee.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:ee.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:ee.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGBA_ASTC:ee.COMPRESSED_RGBA_ASTC_4x4_WEBGL,RGB_ETC1:ee.COMPRESSED_RGB_ETC1_WEBGL,RGB8_ETC2:ee.COMPRESSED_RGB8_ETC2,RGBA8_ETC2_EAC:ee.COMPRESSED_RGBA8_ETC2_EAC,RGBA_BC7:ee.COMPRESSED_RGBA_BPTC_UNORM,componentsLength:function(e){switch(e){case it.RGB:return 3;case it.RGBA:return 4;case it.LUMINANCE_ALPHA:case it.RG:return 2;case it.ALPHA:case it.RED:case it.LUMINANCE:default:return 1}},validate:function(e){return e===it.DEPTH_COMPONENT||e===it.DEPTH_STENCIL||e===it.ALPHA||e===it.RED||e===it.RG||e===it.RGB||e===it.RGBA||e===it.LUMINANCE||e===it.LUMINANCE_ALPHA||e===it.RGB_DXT1||e===it.RGBA_DXT1||e===it.RGBA_DXT3||e===it.RGBA_DXT5||e===it.RGB_PVRTC_4BPPV1||e===it.RGB_PVRTC_2BPPV1||e===it.RGBA_PVRTC_4BPPV1||e===it.RGBA_PVRTC_2BPPV1||e===it.RGBA_ASTC||e===it.RGB_ETC1||e===it.RGB8_ETC2||e===it.RGBA8_ETC2_EAC||e===it.RGBA_BC7},isColorFormat:function(e){return e===it.ALPHA||e===it.RGB||e===it.RGBA||e===it.LUMINANCE||e===it.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===it.DEPTH_COMPONENT||e===it.DEPTH_STENCIL},isCompressedFormat:function(e){return e===it.RGB_DXT1||e===it.RGBA_DXT1||e===it.RGBA_DXT3||e===it.RGBA_DXT5||e===it.RGB_PVRTC_4BPPV1||e===it.RGB_PVRTC_2BPPV1||e===it.RGBA_PVRTC_4BPPV1||e===it.RGBA_PVRTC_2BPPV1||e===it.RGBA_ASTC||e===it.RGB_ETC1||e===it.RGB8_ETC2||e===it.RGBA8_ETC2_EAC||e===it.RGBA_BC7},isDXTFormat:function(e){return e===it.RGB_DXT1||e===it.RGBA_DXT1||e===it.RGBA_DXT3||e===it.RGBA_DXT5},isPVRTCFormat:function(e){return e===it.RGB_PVRTC_4BPPV1||e===it.RGB_PVRTC_2BPPV1||e===it.RGBA_PVRTC_4BPPV1||e===it.RGBA_PVRTC_2BPPV1},isASTCFormat:function(e){return e===it.RGBA_ASTC},isETC1Format:function(e){return e===it.RGB_ETC1},isETC2Format:function(e){return e===it.RGB8_ETC2||e===it.RGBA8_ETC2_EAC},isBC7Format:function(e){return e===it.RGBA_BC7},compressedTextureSizeInBytes:function(e,t,i){switch(e){case it.RGB_DXT1:case it.RGBA_DXT1:case it.RGB_ETC1:case it.RGB8_ETC2:return Math.floor((t+3)/4)*Math.floor((i+3)/4)*8;case it.RGBA_DXT3:case it.RGBA_DXT5:case it.RGBA_ASTC:case it.RGBA8_ETC2_EAC:return Math.floor((t+3)/4)*Math.floor((i+3)/4)*16;case it.RGB_PVRTC_4BPPV1:case it.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(i,8)*4+7)/8);case it.RGB_PVRTC_2BPPV1:case it.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(i,8)*2+7)/8);case it.RGBA_BC7:return Math.ceil(t/4)*Math.ceil(i/4)*16;default:return 0}},textureSizeInBytes:function(e,t,i,n){let r=it.componentsLength(e);return Ye.isPacked(t)&&(r=1),r*Ye.sizeInBytes(t)*i*n},alignmentInBytes:function(e,t,i){let n=it.textureSizeInBytes(e,t,i,1)%4;return 0===n?4:2===n?2:1},createTypedArray:function(e,t,i,n){let r,o=Ye.sizeInBytes(t);return r=o===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:o===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:o===Float32Array.BYTES_PER_ELEMENT&&t===Ye.FLOAT?Float32Array:Uint32Array,new r(it.componentsLength(e)*i*n)},flipY:function(e,t,i,n,r){if(1===r)return e;let o=it.createTypedArray(t,i,n,r),a=it.componentsLength(t),s=n*a;for(let t=0;t<r;++t){let i=t*n*a,l=(r-t-1)*n*a;for(let t=0;t<s;++t)o[l+t]=e[i+t]}return o},toInternalFormat:function(e,t,i){if(!i.webgl2)return e;if(e===it.DEPTH_STENCIL)return ee.DEPTH24_STENCIL8;if(e===it.DEPTH_COMPONENT){if(t===Ye.UNSIGNED_SHORT)return ee.DEPTH_COMPONENT16;if(t===Ye.UNSIGNED_INT)return ee.DEPTH_COMPONENT24}if(t===Ye.FLOAT)switch(e){case it.RGBA:return ee.RGBA32F;case it.RGB:return ee.RGB32F;case it.RG:return ee.RG32F;case it.RED:return ee.R32F}if(t===Ye.HALF_FLOAT)switch(e){case it.RGBA:return ee.RGBA16F;case it.RGB:return ee.RGB16F;case it.RG:return ee.RG16F;case it.RED:return ee.R16F}return e}},rt=Object.freeze(it);function DT(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.vertexFormat,Pe.DEFAULT);this._vertexFormat=t,this._workerName="createPlaneGeometry"}DT.packedLength=Pe.packedLength,DT.pack=function(e,t,i){return i=y(i,0),Pe.pack(e._vertexFormat,t,i),t};var qee=new Pe,uOe={vertexFormat:qee};DT.unpack=function(e,t,i){t=y(t,0);let n=Pe.unpack(e,t,qee);return u(i)?(i._vertexFormat=Pe.clone(n,i._vertexFormat),i):new DT(uOe)};var fO=new h(-.5,-.5,0),dO=new h(.5,.5,0);DT.createGeometry=function(e){let t,i,n=e._vertexFormat,r=new hn;if(n.position){if(i=new Float64Array(12),i[0]=fO.x,i[1]=fO.y,i[2]=0,i[3]=dO.x,i[4]=fO.y,i[5]=0,i[6]=dO.x,i[7]=dO.y,i[8]=0,i[9]=fO.x,i[10]=dO.y,i[11]=0,r.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:i}),n.normal){let e=new Float32Array(12);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=1,e[9]=0,e[10]=0,e[11]=1,r.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}if(n.st){let e=new Float32Array(8);e[0]=0,e[1]=0,e[2]=1,e[3]=0,e[4]=1,e[5]=1,e[6]=0,e[7]=1,r.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:e})}if(n.tangent){let e=new Float32Array(12);e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=1,e[7]=0,e[8]=0,e[9]=1,e[10]=0,e[11]=0,r.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}if(n.bitangent){let e=new Float32Array(12);e[0]=0,e[1]=1,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=1,e[8]=0,e[9]=0,e[10]=1,e[11]=0,r.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}t=new Uint16Array(6),t[0]=0,t[1]=1,t[2]=2,t[3]=0,t[4]=2,t[5]=3}return new ct({attributes:r,indices:t,primitiveType:Ne.TRIANGLES,boundingSphere:new se(h.ZERO,Math.sqrt(2))})};var hO=DT;function IT(){this._workerName="createPlaneOutlineGeometry"}IT.packedLength=0,IT.pack=function(e,t){return t},IT.unpack=function(e,t,i){return u(i)?i:new IT};var B_=new h(-.5,-.5,0),mO=new h(.5,.5,0);IT.createGeometry=function(){let e=new hn,t=new Uint16Array(8),i=new Float64Array(12);return i[0]=B_.x,i[1]=B_.y,i[2]=B_.z,i[3]=mO.x,i[4]=B_.y,i[5]=B_.z,i[6]=mO.x,i[7]=mO.y,i[8]=B_.z,i[9]=B_.x,i[10]=mO.y,i[11]=B_.z,e.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:i}),t[0]=0,t[1]=1,t[2]=1,t[3]=2,t[4]=2,t[5]=3,t[6]=3,t[7]=0,new ct({attributes:e,indices:t,primitiveType:Ne.LINES,boundingSphere:new se(h.ZERO,Math.sqrt(2))})};var pO=IT,fOe=new h;function dOe(e,t,i,n){let r=Ub(e,t,i,n,fOe);return!!u(r)&&(r.x>0&&r.y>0&&r.z>0)}var Yee=dOe;function _r(e,t){this.position=e,u(this.position)||(this.position=new U),this.tangentPlane=t,u(this.tangentPlane)||(this.tangentPlane=_r.NORTH_POLE_TANGENT_PLANE)}Object.defineProperties(_r.prototype,{ellipsoid:{get:function(){return this.tangentPlane.ellipsoid}},x:{get:function(){return this.position.x}},y:{get:function(){return this.position.y}},conformalLatitude:{get:function(){let e=U.magnitude(this.position),t=2*this.ellipsoid.maximumRadius;return this.tangentPlane.plane.normal.z*(P.PI_OVER_TWO-2*Math.atan2(e,t))}},longitude:{get:function(){let e=P.PI_OVER_TWO+Math.atan2(this.y,this.x);return e>Math.PI&&(e-=P.TWO_PI),e}}});var PT=new fe,hOe=new h;_r.prototype.getLatitude=function(e){u(e)||(e=ie.WGS84),PT.latitude=this.conformalLatitude,PT.longitude=this.longitude,PT.height=0;let t=this.ellipsoid.cartographicToCartesian(PT,hOe);return e.cartesianToCartographic(t,PT),PT.latitude};var mOe=new Tn,pOe=new h,_Oe=new h;_r.fromCartesian=function(e,t){let i=P.signNotZero(e.z),n=_r.NORTH_POLE_TANGENT_PLANE,r=_r.SOUTH_POLE;i<0&&(n=_r.SOUTH_POLE_TANGENT_PLANE,r=_r.NORTH_POLE);let o=mOe;o.origin=n.ellipsoid.scaleToGeocentricSurface(e,o.origin),o.direction=h.subtract(o.origin,r,pOe),h.normalize(o.direction,o.direction);let a=Ai.rayPlane(o,n.plane,_Oe),s=h.subtract(a,r,a),l=h.dot(n.xAxis,s),c=i*h.dot(n.yAxis,s);return u(t)?(t.position=new U(l,c),t.tangentPlane=n,t):new _r(new U(l,c),n)},_r.fromCartesianArray=function(e,t){let i=e.length;u(t)?t.length=i:t=new Array(i);for(let n=0;n<i;n++)t[n]=_r.fromCartesian(e[n],t[n]);return t},_r.clone=function(e,t){if(u(e))return u(t)?(t.position=e.position,t.tangentPlane=e.tangentPlane,t):new _r(e.position,e.tangentPlane)},_r.HALF_UNIT_SPHERE=Object.freeze(new ie(.5,.5,.5)),_r.NORTH_POLE=Object.freeze(new h(0,0,.5)),_r.SOUTH_POLE=Object.freeze(new h(0,0,-.5)),_r.NORTH_POLE_TANGENT_PLANE=Object.freeze(new Vr(_r.NORTH_POLE,_r.HALF_UNIT_SPHERE)),_r.SOUTH_POLE_TANGENT_PLANE=Object.freeze(new Vr(_r.SOUTH_POLE,_r.HALF_UNIT_SPHERE));var _c=_r,gOe=new fe,Xee=new fe;function yOe(e,t,i,n){let r=n.cartesianToCartographic(e,gOe).height,o=n.cartesianToCartographic(t,Xee);o.height=r,n.cartographicToCartesian(o,t);let a=n.cartesianToCartographic(i,Xee);a.height=r-100,n.cartographicToCartesian(a,i)}var Kee=new qe,xOe=new h,bOe=new h,TOe=new h,AOe=new h,COe=new h,EOe=new h,_O=new h,Eh=new h,OT=new h,SOe=new U,wOe=new U,vOe=new h,Zee=new Le,DOe=new $,IOe=new $;function YG(e){let t=e.vertexFormat,i=e.geometry,n=e.shadowVolume,r=i.attributes.position.values,o=u(i.attributes.st)?i.attributes.st.values:void 0,a=r.length,s=e.wall,l=e.top||s,c=e.bottom||s;if(t.st||t.normal||t.tangent||t.bitangent||n){let d=e.boundingRectangle,p=e.rotationAxis,f=e.projectTo2d,m=e.ellipsoid,_=e.stRotation,g=e.perPositionHeight,y=SOe;y.x=d.x,y.y=d.y;let v,b=t.st?new Float32Array(a/3*2):void 0;t.normal&&(v=g&&l&&!s?i.attributes.normal.values:new Float32Array(a));let A=t.tangent?new Float32Array(a):void 0,T=t.bitangent?new Float32Array(a):void 0,E=n?new Float32Array(a):void 0,C=0,x=0,S=bOe,w=TOe,I=AOe,D=!0,O=DOe,L=IOe;if(0!==_){let e=Le.fromAxisAngle(p,_,Zee);O=$.fromQuaternion(e,O),e=Le.fromAxisAngle(p,-_,Zee),L=$.fromQuaternion(e,L)}else O=$.clone($.IDENTITY,O),L=$.clone($.IDENTITY,L);let R=0,N=0;l&&c&&(R=a/2,N=a/3,a/=2);for(let i=0;i<a;i+=3){let p=h.fromArray(r,i,vOe);if(t.st&&!u(o)){let e=$.multiplyByVector(O,p,xOe);e=m.scaleToGeodeticSurface(e,e);let t=f(e,wOe);U.subtract(t,y,t);let i=P.clamp(t.x/d.width,0,1),n=P.clamp(t.y/d.height,0,1);c&&(b[C+N]=i,b[C+1+N]=n),l&&(b[C]=i,b[C+1]=n),C+=2}if(t.normal||t.tangent||t.bitangent||n){let o=x+1,u=x+2;if(s){if(i+3<a){let e=h.fromArray(r,i+3,COe);if(D){let t=h.fromArray(r,i+a,EOe);g&&yOe(p,e,t,m),h.subtract(e,p,e),h.subtract(t,p,t),S=h.normalize(h.cross(t,e,S),S),D=!1}h.equalsEpsilon(e,p,P.EPSILON10)&&(D=!0)}(t.tangent||t.bitangent)&&(I=m.geodeticSurfaceNormal(p,I),t.tangent&&(w=h.normalize(h.cross(I,S,w),w)))}else S=m.geodeticSurfaceNormal(p,S),(t.tangent||t.bitangent)&&(g&&(_O=h.fromArray(v,x,_O),Eh=h.cross(h.UNIT_Z,_O,Eh),Eh=h.normalize($.multiplyByVector(L,Eh,Eh),Eh),t.bitangent&&(OT=h.normalize(h.cross(_O,Eh,OT),OT))),w=h.cross(h.UNIT_Z,S,w),w=h.normalize($.multiplyByVector(L,w,w),w),t.bitangent&&(I=h.normalize(h.cross(S,w,I),I)));t.normal&&(e.wall?(v[x+R]=S.x,v[o+R]=S.y,v[u+R]=S.z):c&&(v[x+R]=-S.x,v[o+R]=-S.y,v[u+R]=-S.z),(l&&!g||s)&&(v[x]=S.x,v[o]=S.y,v[u]=S.z)),n&&(s&&(S=m.geodeticSurfaceNormal(p,S)),E[x+R]=-S.x,E[o+R]=-S.y,E[u+R]=-S.z),t.tangent&&(e.wall?(A[x+R]=w.x,A[o+R]=w.y,A[u+R]=w.z):c&&(A[x+R]=-w.x,A[o+R]=-w.y,A[u+R]=-w.z),l&&(g?(A[x]=Eh.x,A[o]=Eh.y,A[u]=Eh.z):(A[x]=w.x,A[o]=w.y,A[u]=w.z))),t.bitangent&&(c&&(T[x+R]=I.x,T[o+R]=I.y,T[u+R]=I.z),l&&(g?(T[x]=OT.x,T[o]=OT.y,T[u]=OT.z):(T[x]=I.x,T[o]=I.y,T[u]=I.z))),x+=3}}t.st&&!u(o)&&(i.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:b})),t.normal&&(i.attributes.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:v})),t.tangent&&(i.attributes.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:A})),t.bitangent&&(i.attributes.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:T})),n&&(i.attributes.extrudeDirection=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:E}))}if(e.extrude&&u(e.offsetAttribute)){let t=r.length/3,n=new Uint8Array(t);if(e.offsetAttribute===on.TOP)l&&c||s?n=n.fill(1,0,t/2):l&&(n=n.fill(1));else{let t=e.offsetAttribute===on.NONE?0:1;n=n.fill(t)}i.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}return i}var POe=new fe,OOe=new fe,k_={westOverIDL:0,eastOverIDL:0},RT=new Hf;function ROe(e,t,i,n,r){if(r=y(r,new ce),!u(e)||e.length<3)return r.west=0,r.north=0,r.south=0,r.east=0,r;if(i===Yt.RHUMB)return ce.fromCartesianArray(e,t,r);RT.ellipsoid.equals(t)||(RT=new Hf(void 0,void 0,t)),r.west=Number.POSITIVE_INFINITY,r.east=Number.NEGATIVE_INFINITY,r.south=Number.POSITIVE_INFINITY,r.north=Number.NEGATIVE_INFINITY,k_.westOverIDL=Number.POSITIVE_INFINITY,k_.eastOverIDL=Number.NEGATIVE_INFINITY;let o,a=1/P.chordLength(n,t.maximumRadius),s=e.length,l=t.cartesianToCartographic(e[0],OOe),c=POe;for(let i=1;i<s;i++)o=c,c=l,l=t.cartesianToCartographic(e[i],o),RT.setEndPoints(c,l),$ee(RT,a,r,k_);return o=c,c=l,l=t.cartesianToCartographic(e[0],o),RT.setEndPoints(c,l),$ee(RT,a,r,k_),r.east-r.west>k_.eastOverIDL-k_.westOverIDL&&(r.west=k_.westOverIDL,r.east=k_.eastOverIDL,r.east>P.PI&&(r.east=r.east-P.TWO_PI),r.west>P.PI&&(r.west=r.west-P.TWO_PI)),r}var MOe=new fe;function $ee(e,t,i,n){let r=e.surfaceDistance,o=Math.ceil(r*t),a=o>0?r/(o-1):Number.POSITIVE_INFINITY,s=0;for(let t=0;t<o;t++){let t=e.interpolateUsingSurfaceDistance(s,MOe);s+=a;let r=t.longitude,o=t.latitude;i.west=Math.min(i.west,r),i.east=Math.max(i.east,r),i.south=Math.min(i.south,o),i.north=Math.max(i.north,o);let l=r>=0?r:r+P.TWO_PI;n.westOverIDL=Math.min(n.westOverIDL,l),n.eastOverIDL=Math.max(n.eastOverIDL,l)}}var Qee=[];function LOe(e,t,i,n,r,o,a,s,l,c){let h,d={walls:[]};if(a||s){let r,p,f=kn.createGeometryFromPositions(e,t,i,n,o,l,c),m=f.attributes.position.values,_=f.indices;if(a&&s){let e=m.concat(m);r=e.length/3,p=ke.createTypedArray(r,2*_.length),p.set(_);let t=_.length,n=r/2;for(h=0;h<t;h+=3){let e=p[h]+n,i=p[h+1]+n,r=p[h+2]+n;p[h+t]=r,p[h+1+t]=i,p[h+2+t]=e}if(f.attributes.position.values=e,o&&l.normal){let t=f.attributes.normal.values;f.attributes.normal.values=new Float32Array(e.length),f.attributes.normal.values.set(t)}if(l.st&&u(i)){let e=f.attributes.st.values;f.attributes.st.values=new Float32Array(2*r),f.attributes.st.values=e.concat(e)}f.indices=p}else if(s){for(r=m.length/3,p=ke.createTypedArray(r,_.length),h=0;h<_.length;h+=3)p[h]=_[h+2],p[h+1]=_[h+1],p[h+2]=_[h];f.indices=p}d.topAndBottom=new yt({geometry:f})}let p=r.outerRing,f=Vr.fromPoints(p,e),m=f.projectPointsOntoPlane(p,Qee),_=ei.computeWindingOrder2D(m);_===ts.CLOCKWISE&&(p=p.slice().reverse());let g=kn.computeWallGeometry(p,i,e,n,o,c);d.walls.push(new yt({geometry:g}));let y=r.holes;for(h=0;h<y.length;h++){let t=y[h];m=f.projectPointsOntoPlane(t,Qee),_=ei.computeWindingOrder2D(m),_===ts.COUNTER_CLOCKWISE&&(t=t.slice().reverse()),g=kn.computeWallGeometry(t,i,e,n,o,c),d.walls.push(new yt({geometry:g}))}return d}function Nl(e){let t=e.polygonHierarchy,i=y(e.vertexFormat,Pe.DEFAULT),n=y(e.ellipsoid,ie.WGS84),r=y(e.granularity,P.RADIANS_PER_DEGREE),o=y(e.stRotation,0),a=e.textureCoordinates,s=y(e.perPositionHeight,!1),l=s&&u(e.extrudedHeight),c=y(e.height,0),d=y(e.extrudedHeight,c);if(!l){let e=Math.max(c,d);d=Math.min(c,d),c=e}this._vertexFormat=Pe.clone(i),this._ellipsoid=ie.clone(n),this._granularity=r,this._stRotation=o,this._height=c,this._extrudedHeight=d,this._closeTop=y(e.closeTop,!0),this._closeBottom=y(e.closeBottom,!0),this._polygonHierarchy=t,this._perPositionHeight=s,this._perPositionHeightExtrude=l,this._shadowVolume=y(e.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=e.offsetAttribute,this._arcType=y(e.arcType,Yt.GEODESIC),this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this._textureCoordinates=a,this.packedLength=kn.computeHierarchyPackedLength(t,h)+ie.packedLength+Pe.packedLength+(a?kn.computeHierarchyPackedLength(a,U):1)+12}Nl.fromPositions=function(e){return new Nl({polygonHierarchy:{positions:(e=y(e,y.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom,offsetAttribute:e.offsetAttribute,arcType:e.arcType,textureCoordinates:e.textureCoordinates})},Nl.pack=function(e,t,i){return i=y(i,0),i=kn.packPolygonHierarchy(e._polygonHierarchy,t,i,h),ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._stRotation,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._closeTop?1:0,t[i++]=e._closeBottom?1:0,t[i++]=e._shadowVolume?1:0,t[i++]=y(e._offsetAttribute,-1),t[i++]=e._arcType,u(e._textureCoordinates)?i=kn.packPolygonHierarchy(e._textureCoordinates,t,i,U):t[i++]=-1,t[i++]=e.packedLength,t};var NOe=ie.clone(ie.UNIT_SPHERE),FOe=new Pe,BOe={polygonHierarchy:{}};Nl.unpack=function(e,t,i){t=y(t,0);let n=kn.unpackPolygonHierarchy(e,t,h);t=n.startingIndex,delete n.startingIndex;let r=ie.unpack(e,t,NOe);t+=ie.packedLength;let o=Pe.unpack(e,t,FOe);t+=Pe.packedLength;let a=e[t++],s=e[t++],l=e[t++],c=e[t++],d=1===e[t++],p=1===e[t++],f=1===e[t++],m=1===e[t++],_=1===e[t++],g=e[t++],v=e[t++],b=-1===e[t]?void 0:kn.unpackPolygonHierarchy(e,t,U);u(b)?(t=b.startingIndex,delete b.startingIndex):t++;let A=e[t++];return u(i)||(i=new Nl(BOe)),i._polygonHierarchy=n,i._ellipsoid=ie.clone(r,i._ellipsoid),i._vertexFormat=Pe.clone(o,i._vertexFormat),i._height=a,i._extrudedHeight=s,i._granularity=l,i._stRotation=c,i._perPositionHeightExtrude=d,i._perPositionHeight=p,i._closeTop=f,i._closeBottom=m,i._shadowVolume=_,i._offsetAttribute=-1===g?void 0:g,i._arcType=v,i._textureCoordinates=b,i.packedLength=A,i};var kOe=new U,VOe=new U,UOe=new _c;function Jee(e,t,i,n,r,o){let a=e.longitude,s=a>=0?a:a+P.TWO_PI;r.westOverIdl=Math.min(r.westOverIdl,s),r.eastOverIdl=Math.max(r.eastOverIdl,s),o.west=Math.min(o.west,a),o.east=Math.max(o.east,a);let l=e.getLatitude(i),u=l;if(o.south=Math.min(o.south,l),o.north=Math.max(o.north,l),n!==Yt.RHUMB){let n=U.subtract(t.position,e.position,kOe),r=U.dot(t.position,n)/U.dot(n,n);if(r>0&&r<1){let e=U.add(t.position,U.multiplyByScalar(n,-r,n),VOe),a=_c.clone(t,UOe);a.position=e;let s=a.getLatitude(i);o.south=Math.min(o.south,s),o.north=Math.max(o.north,s),Math.abs(l)>Math.abs(s)&&(u=s)}}let c=t.x*e.y-e.x*t.y,h=Math.sign(c);0!==h&&(h*=U.angleBetween(t.position,e.position)),u>=0&&(r.northAngle+=h),u<=0&&(r.southAngle+=h)}var ete=new _c,zOe=new _c,Uu={northAngle:0,southAngle:0,westOverIdl:0,eastOverIdl:0};Nl.computeRectangleFromPositions=function(e,t,i,n){if(u(n)||(n=new ce),e.length<3)return n;n.west=Number.POSITIVE_INFINITY,n.east=Number.NEGATIVE_INFINITY,n.south=Number.POSITIVE_INFINITY,n.north=Number.NEGATIVE_INFINITY,Uu.northAngle=0,Uu.southAngle=0,Uu.westOverIdl=Number.POSITIVE_INFINITY,Uu.eastOverIdl=Number.NEGATIVE_INFINITY;let r=e.length,o=_c.fromCartesian(e[0],zOe);for(let a=1;a<r;a++){let r=_c.fromCartesian(e[a],ete);Jee(r,o,t,i,Uu,n),o=_c.clone(r,o)}return Jee(_c.fromCartesian(e[0],ete),o,t,i,Uu,n),n.east-n.west>Uu.eastOverIdl-Uu.westOverIdl&&(n.west=Uu.westOverIdl,n.east=Uu.eastOverIdl,n.east>P.PI&&(n.east=n.east-P.TWO_PI),n.west>P.PI&&(n.west=n.west-P.TWO_PI)),P.equalsEpsilon(Math.abs(Uu.northAngle),P.TWO_PI,P.EPSILON10)&&(n.north=P.PI_OVER_TWO,n.east=P.PI,n.west=-P.PI),P.equalsEpsilon(Math.abs(Uu.southAngle),P.TWO_PI,P.EPSILON10)&&(n.south=-P.PI_OVER_TWO,n.east=P.PI,n.west=-P.PI),n},Nl.computeRectangle=function(e,t){is("PolygonGeometry.computeRectangle","PolygonGeometry.computeRectangle was deprecated in CesiumJS 1.110.  It will be removed in CesiumJS 1.112. Use PolygonGeometry.computeRectangleFromPositions instead.");let i=y(e.granularity,P.RADIANS_PER_DEGREE),n=y(e.arcType,Yt.GEODESIC),r=e.polygonHierarchy,o=y(e.ellipsoid,ie.WGS84);return ROe(r.positions,o,n,i,t)};var HOe=new _c;function GOe(e,t,i){return e.height>=P.PI||e.width>=P.PI?_c.fromCartesian(t[0],HOe).tangentPlane:Vr.fromPoints(t,i)}var tte=new fe;function WOe(e,t,i){return(n,r)=>{if(e.height>=P.PI||e.width>=P.PI){if(e.south<0&&e.north>0){u(r)||(r=[]);for(let e=0;e<n.length;++e){let t=i.cartesianToCartographic(n[e],tte);r[e]=new U(t.longitude/P.PI,t.latitude/P.PI_OVER_TWO)}return r.length=n.length,r}return _c.fromCartesianArray(n,r)}return Vr.fromPoints(t,i).projectPointsOntoPlane(n,r)}}function jOe(e,t,i){if(e.height>=P.PI||e.width>=P.PI)return(t,n)=>{if(e.south<0&&e.north>0){let e=i.cartesianToCartographic(t,tte);return u(n)||(n=new U),n.x=e.longitude/P.PI,n.y=e.latitude/P.PI_OVER_TWO,n}return _c.fromCartesian(t,n)};let n=Vr.fromPoints(t,i);return(e,t)=>n.projectPointsOntoPlane(e,t)}function qOe(e,t,i,n){return(r,o)=>!n&&(e.height>=P.PI_OVER_TWO||e.width>=2*P.PI_OVER_THREE)?kn.splitPolygonsOnEquator(r,t,i,o):r}function YOe(e,t,i,n){if(t.height>=P.PI||t.width>=P.PI)return qe.fromRectangle(t,void 0,Kee);let r=e,o=Vr.fromPoints(r,i);return kn.computeBoundingRectangle(o.plane.normal,o.projectPointOntoPlane.bind(o),r,n,Kee)}function XOe(e){let t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];let i=e._ellipsoid,n=e._polygonHierarchy.positions,r=e.rectangle;return ct._textureCoordinateRotationPoints(n,t,i,r)}Nl.createGeometry=function(e){let t=e._vertexFormat,i=e._ellipsoid,n=e._granularity,r=e._stRotation,o=e._polygonHierarchy,a=e._perPositionHeight,s=e._closeTop,l=e._closeBottom,c=e._arcType,h=e._textureCoordinates,d=u(h),p=o.positions;if(p.length<3)return;let f=e.rectangle,m=kn.polygonsFromHierarchy(o,d,WOe(f,p,i),!a,i,qOe(f,i,c,a)),_=m.hierarchy,g=m.polygons,y=d?kn.polygonsFromHierarchy(h,!0,(function(e){return e}),!1,i).polygons:void 0;if(0===_.length)return;let v,b=_[0].outerRing,A=YOe(b,f,i,r),T=[],E=e._height,C=e._extrudedHeight,x=e._perPositionHeightExtrude||!P.equalsEpsilon(E,C,0,P.EPSILON2),S={perPositionHeight:a,vertexFormat:t,geometry:void 0,rotationAxis:GOe(f,b,i).plane.normal,projectTo2d:jOe(f,b,i),boundingRectangle:A,ellipsoid:i,stRotation:r,textureCoordinates:void 0,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:c};if(x)for(S.extrude=!0,S.top=s,S.bottom=l,S.shadowVolume=e._shadowVolume,S.offsetAttribute=e._offsetAttribute,v=0;v<g.length;v++){let e,r=LOe(i,g[v],d?y[v]:void 0,n,_[v],a,s,l,t,c);s&&l?(e=r.topAndBottom,S.geometry=kn.scaleToGeodeticHeightExtruded(e.geometry,E,C,i,a)):s?(e=r.topAndBottom,e.geometry.attributes.position.values=ei.scaleToGeodeticHeight(e.geometry.attributes.position.values,E,i,!a),S.geometry=e.geometry):l&&(e=r.topAndBottom,e.geometry.attributes.position.values=ei.scaleToGeodeticHeight(e.geometry.attributes.position.values,C,i,!0),S.geometry=e.geometry),(s||l)&&(S.wall=!1,e.geometry=YG(S),T.push(e));let o=r.walls;S.wall=!0;for(let e=0;e<o.length;e++){let t=o[e];S.geometry=kn.scaleToGeodeticHeightExtruded(t.geometry,E,C,i,a),t.geometry=YG(S),T.push(t)}}else for(v=0;v<g.length;v++){let r=new yt({geometry:kn.createGeometryFromPositions(i,g[v],d?y[v]:void 0,n,a,t,c)});if(r.geometry.attributes.position.values=ei.scaleToGeodeticHeight(r.geometry.attributes.position.values,E,i,!a),S.geometry=r.geometry,r.geometry=YG(S),u(e._offsetAttribute)){let t=r.geometry.attributes.position.values.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);r.geometry.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}T.push(r)}let w=Fn.combineInstances(T)[0];w.attributes.position.values=new Float64Array(w.attributes.position.values),w.indices=ke.createTypedArray(w.attributes.position.values.length/3,w.indices);let I=w.attributes,D=se.fromVertices(I.position.values);return t.position||delete I.position,new ct({attributes:I,indices:w.indices,primitiveType:w.primitiveType,boundingSphere:D,offsetAttribute:e._offsetAttribute})},Nl.createShadowVolume=function(e,t,i){let n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new Nl({polygonHierarchy:e._polygonHierarchy,ellipsoid:r,stRotation:e._stRotation,granularity:n,perPositionHeight:!1,extrudedHeight:o,height:a,vertexFormat:Pe.POSITION_ONLY,shadowVolume:!0,arcType:e._arcType})},Object.defineProperties(Nl.prototype,{rectangle:{get:function(){if(!u(this._rectangle)){let e=this._polygonHierarchy.positions;this._rectangle=Nl.computeRectangleFromPositions(e,this._ellipsoid,this._arcType)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=XOe(this)),this._textureCoordinateRotationPoints}}});var MT=Nl,nte=[],gO=[];function KOe(e,t,i,n,r){let o=Vr.fromPoints(t,e).projectPointsOntoPlane(t,nte);ei.computeWindingOrder2D(o)===ts.CLOCKWISE&&(o.reverse(),t=t.slice().reverse());let a,s,l=t.length,u=0;if(n)for(a=new Float64Array(2*l*3),s=0;s<l;s++){let e=t[s],i=t[(s+1)%l];a[u++]=e.x,a[u++]=e.y,a[u++]=e.z,a[u++]=i.x,a[u++]=i.y,a[u++]=i.z}else{let n=0;if(r===Yt.GEODESIC)for(s=0;s<l;s++)n+=kn.subdivideLineCount(t[s],t[(s+1)%l],i);else if(r===Yt.RHUMB)for(s=0;s<l;s++)n+=kn.subdivideRhumbLineCount(e,t[s],t[(s+1)%l],i);for(a=new Float64Array(3*n),s=0;s<l;s++){let n;r===Yt.GEODESIC?n=kn.subdivideLine(t[s],t[(s+1)%l],i,gO):r===Yt.RHUMB&&(n=kn.subdivideRhumbLine(e,t[s],t[(s+1)%l],i,gO));let o=n.length;for(let e=0;e<o;++e)a[u++]=n[e]}}l=a.length/3;let c=2*l,h=ke.createTypedArray(l,c);for(u=0,s=0;s<l-1;s++)h[u++]=s,h[u++]=s+1;return h[u++]=l-1,h[u++]=0,new yt({geometry:new ct({attributes:new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:a})}),indices:h,primitiveType:Ne.LINES})})}function ZOe(e,t,i,n,r){let o=Vr.fromPoints(t,e).projectPointsOntoPlane(t,nte);ei.computeWindingOrder2D(o)===ts.CLOCKWISE&&(o.reverse(),t=t.slice().reverse());let a,s,l=t.length,u=new Array(l),c=0;if(n)for(a=new Float64Array(2*l*3*2),s=0;s<l;++s){u[s]=c/3;let e=t[s],i=t[(s+1)%l];a[c++]=e.x,a[c++]=e.y,a[c++]=e.z,a[c++]=i.x,a[c++]=i.y,a[c++]=i.z}else{let n=0;if(r===Yt.GEODESIC)for(s=0;s<l;s++)n+=kn.subdivideLineCount(t[s],t[(s+1)%l],i);else if(r===Yt.RHUMB)for(s=0;s<l;s++)n+=kn.subdivideRhumbLineCount(e,t[s],t[(s+1)%l],i);for(a=new Float64Array(3*n*2),s=0;s<l;++s){let n;u[s]=c/3,r===Yt.GEODESIC?n=kn.subdivideLine(t[s],t[(s+1)%l],i,gO):r===Yt.RHUMB&&(n=kn.subdivideRhumbLine(e,t[s],t[(s+1)%l],i,gO));let o=n.length;for(let e=0;e<o;++e)a[c++]=n[e]}}l=a.length/6;let h=u.length,d=2*(2*l+h),p=ke.createTypedArray(l+h,d);for(c=0,s=0;s<l;++s)p[c++]=s,p[c++]=(s+1)%l,p[c++]=s+l,p[c++]=(s+1)%l+l;for(s=0;s<h;s++){let e=u[s];p[c++]=e,p[c++]=e+l}return new yt({geometry:new ct({attributes:new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:a})}),indices:p,primitiveType:Ne.LINES})})}function A0(e){let t=e.polygonHierarchy,i=y(e.ellipsoid,ie.WGS84),n=y(e.granularity,P.RADIANS_PER_DEGREE),r=y(e.perPositionHeight,!1),o=r&&u(e.extrudedHeight),a=y(e.arcType,Yt.GEODESIC),s=y(e.height,0),l=y(e.extrudedHeight,s);if(!o){let e=Math.max(s,l);l=Math.min(s,l),s=e}this._ellipsoid=ie.clone(i),this._granularity=n,this._height=s,this._extrudedHeight=l,this._arcType=a,this._polygonHierarchy=t,this._perPositionHeight=r,this._perPositionHeightExtrude=o,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=kn.computeHierarchyPackedLength(t,h)+ie.packedLength+8}A0.pack=function(e,t,i){return i=y(i,0),i=kn.packPolygonHierarchy(e._polygonHierarchy,t,i,h),ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._arcType,t[i++]=y(e._offsetAttribute,-1),t[i]=e.packedLength,t};var $Oe=ie.clone(ie.UNIT_SPHERE),QOe={polygonHierarchy:{}};A0.unpack=function(e,t,i){t=y(t,0);let n=kn.unpackPolygonHierarchy(e,t,h);t=n.startingIndex,delete n.startingIndex;let r=ie.unpack(e,t,$Oe);t+=ie.packedLength;let o=e[t++],a=e[t++],s=e[t++],l=1===e[t++],c=1===e[t++],d=e[t++],p=e[t++],f=e[t];return u(i)||(i=new A0(QOe)),i._polygonHierarchy=n,i._ellipsoid=ie.clone(r,i._ellipsoid),i._height=o,i._extrudedHeight=a,i._granularity=s,i._perPositionHeight=c,i._perPositionHeightExtrude=l,i._arcType=d,i._offsetAttribute=-1===p?void 0:p,i.packedLength=f,i},A0.fromPositions=function(e){return new A0({polygonHierarchy:{positions:(e=y(e,y.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},A0.createGeometry=function(e){let t=e._ellipsoid,i=e._granularity,n=e._polygonHierarchy,r=e._perPositionHeight,o=e._arcType,a=kn.polygonOutlinesFromHierarchy(n,!r,t);if(0===a.length)return;let s,l,c,h=[],d=P.chordLength(i,t.maximumRadius),p=e._height,f=e._extrudedHeight;if(e._perPositionHeightExtrude||!P.equalsEpsilon(p,f,0,P.EPSILON2))for(c=0;c<a.length;c++){if(s=ZOe(t,a[c],d,r,o),s.geometry=kn.scaleToGeodeticHeightExtruded(s.geometry,p,f,t,r),u(e._offsetAttribute)){let t=s.geometry.attributes.position.values.length/3,i=new Uint8Array(t);e._offsetAttribute===on.TOP?i=i.fill(1,0,t/2):(l=e._offsetAttribute===on.NONE?0:1,i=i.fill(l)),s.geometry.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}h.push(s)}else for(c=0;c<a.length;c++){if(s=KOe(t,a[c],d,r,o),s.geometry.attributes.position.values=ei.scaleToGeodeticHeight(s.geometry.attributes.position.values,p,t,!r),u(e._offsetAttribute)){let t=s.geometry.attributes.position.values.length;l=e._offsetAttribute===on.NONE?0:1;let i=new Uint8Array(t/3).fill(l);s.geometry.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}h.push(s)}let m=Fn.combineInstances(h)[0],_=se.fromVertices(m.attributes.position.values);return new ct({attributes:m.attributes,indices:m.indices,primitiveType:m.primitiveType,boundingSphere:_,offsetAttribute:e._offsetAttribute})};var yO=A0,ate=[];function JOe(e,t,i,n,r){let o=ate;o.length=r;let a,s=i.red,l=i.green,u=i.blue,c=i.alpha,h=n.red,d=n.green,p=n.blue,f=n.alpha;if(z.equals(i,n)){for(a=0;a<r;a++)o[a]=z.clone(i);return o}let m=(h-s)/r,_=(d-l)/r,g=(p-u)/r,y=(f-c)/r;for(a=0;a<r;a++)o[a]=new z(s+a*m,l+a*_,u+a*g,c+a*y);return o}function VS(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions,i=e.colors,n=y(e.width,1),r=y(e.colorsPerVertex,!1);this._positions=t,this._colors=i,this._width=n,this._colorsPerVertex=r,this._vertexFormat=Pe.clone(y(e.vertexFormat,Pe.DEFAULT)),this._arcType=y(e.arcType,Yt.GEODESIC),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._workerName="createPolylineGeometry";let o=1+t.length*h.packedLength;o+=u(i)?1+i.length*z.packedLength:1,this.packedLength=o+ie.packedLength+Pe.packedLength+4}VS.pack=function(e,t,i){i=y(i,0);let n,r=e._positions,o=r.length;for(t[i++]=o,n=0;n<o;++n,i+=h.packedLength)h.pack(r[n],t,i);let a=e._colors;for(o=u(a)?a.length:0,t[i++]=o,n=0;n<o;++n,i+=z.packedLength)z.pack(a[n],t,i);return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._width,t[i++]=e._colorsPerVertex?1:0,t[i++]=e._arcType,t[i]=e._granularity,t};var cte=ie.clone(ie.UNIT_SPHERE),lte=new Pe,C0={positions:void 0,colors:void 0,ellipsoid:cte,vertexFormat:lte,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};VS.unpack=function(e,t,i){t=y(t,0);let n,r=e[t++],o=new Array(r);for(n=0;n<r;++n,t+=h.packedLength)o[n]=h.unpack(e,t);r=e[t++];let a=r>0?new Array(r):void 0;for(n=0;n<r;++n,t+=z.packedLength)a[n]=z.unpack(e,t);let s=ie.unpack(e,t,cte);t+=ie.packedLength;let l=Pe.unpack(e,t,lte);t+=Pe.packedLength;let c=e[t++],d=1===e[t++],p=e[t++],f=e[t];return u(i)?(i._positions=o,i._colors=a,i._ellipsoid=ie.clone(s,i._ellipsoid),i._vertexFormat=Pe.clone(l,i._vertexFormat),i._width=c,i._colorsPerVertex=d,i._arcType=p,i._granularity=f,i):(C0.positions=o,C0.colors=a,C0.width=c,C0.colorsPerVertex=d,C0.arcType=p,C0.granularity=f,new VS(C0))};var ite=new h,ote=new h,rte=new h,ste=new h;VS.createGeometry=function(e){let t,i,n,r=e._width,o=e._vertexFormat,a=e._colors,s=e._colorsPerVertex,l=e._arcType,c=e._granularity,d=e._ellipsoid,p=[],f=go(e._positions,h.equalsEpsilon,!1,p);if(u(a)&&p.length>0){let e=0,t=p[0];a=a.filter((function(i,n){let r=!1;return r=s?n===t||0===n&&1===t:n+1===t,!r||(e++,t=p[e],!1)}))}let m=f.length;if(m<2||r<=0)return;if(l===Yt.GEODESIC||l===Yt.RHUMB){let e,n;l===Yt.GEODESIC?(e=P.chordLength(c,d.maximumRadius),n=Mi.numberOfPoints):(e=c,n=Mi.numberOfPointsRhumbLine);let r=Mi.extractHeights(f,d);if(u(a)){let r=1;for(t=0;t<m-1;++t)r+=n(f[t],f[t+1],e);let o=new Array(r),l=0;for(t=0;t<m-1;++t){let u=f[t],c=f[t+1],h=a[t],d=n(u,c,e);if(s&&t<r){let e=JOe(u,c,h,a[t+1],d),n=e.length;for(i=0;i<n;++i)o[l++]=e[i]}else for(i=0;i<d;++i)o[l++]=z.clone(h)}o[l]=z.clone(a[a.length-1]),a=o,ate.length=0}f=l===Yt.GEODESIC?Mi.generateCartesianArc({positions:f,minDistance:e,ellipsoid:d,height:r}):Mi.generateCartesianRhumbArc({positions:f,granularity:e,ellipsoid:d,height:r})}m=f.length;let _,g=4*m-4,y=new Float64Array(3*g),v=new Float64Array(3*g),b=new Float64Array(3*g),A=new Float32Array(2*g),T=o.st?new Float32Array(2*g):void 0,E=u(a)?new Uint8Array(4*g):void 0,C=0,x=0,S=0,w=0;for(i=0;i<m;++i){let e,t;0===i?(_=ite,h.subtract(f[0],f[1],_),h.add(f[0],_,_)):_=f[i-1],h.clone(_,rte),h.clone(f[i],ote),i===m-1?(_=ite,h.subtract(f[m-1],f[m-2],_),h.add(f[m-1],_,_)):_=f[i+1],h.clone(_,ste),u(E)&&(e=0===i||s?a[i]:a[i-1],i!==m-1&&(t=a[i]));let l=i===m-1?2:4;for(n=0===i?2:0;n<l;++n){h.pack(ote,y,C),h.pack(rte,v,C),h.pack(ste,b,C),C+=3;let a=n-2<0?-1:1;if(A[x++]=n%2*2-1,A[x++]=a*r,o.st&&(T[S++]=i/(m-1),T[S++]=Math.max(A[x-2],0)),u(E)){let i=n<2?e:t;E[w++]=z.floatToByte(i.red),E[w++]=z.floatToByte(i.green),E[w++]=z.floatToByte(i.blue),E[w++]=z.floatToByte(i.alpha)}}}let I=new hn;I.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:y}),I.prevPosition=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:v}),I.nextPosition=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:b}),I.expandAndWidth=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:A}),o.st&&(I.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:T})),u(E)&&(I.color=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:4,values:E,normalize:!0}));let D=ke.createTypedArray(g,6*m-6),O=0,L=0,R=m-1;for(i=0;i<R;++i)D[L++]=O,D[L++]=O+2,D[L++]=O+1,D[L++]=O+1,D[L++]=O+2,D[L++]=O+3,O+=4;return new ct({attributes:I,indices:D,primitiveType:Ne.TRIANGLES,boundingSphere:se.fromPoints(f),geometryType:Bf.POLYLINES})};var V_=VS;function eRe(e,t,i,n){let r=new hn;n.position&&(r.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:e}));let o,a,s,l,u,c,h=t.length,d=e.length/3,p=(d-2*h)/(2*h),f=ei.triangulate(t),m=(p-1)*h*6+2*f.length,_=ke.createTypedArray(d,m),g=2*h,y=0;for(o=0;o<p-1;o++){for(a=0;a<h-1;a++)s=2*a+o*h*2,c=s+g,l=s+1,u=l+g,_[y++]=l,_[y++]=s,_[y++]=u,_[y++]=u,_[y++]=s,_[y++]=c;s=2*h-2+o*h*2,l=s+1,u=l+g,c=s+g,_[y++]=l,_[y++]=s,_[y++]=u,_[y++]=u,_[y++]=s,_[y++]=c}if(n.st||n.tangent||n.bitangent){let e,n,s=new Float32Array(2*d),l=1/(p-1),u=1/i.height,c=i.height/2,f=0;for(o=0;o<p;o++){for(e=o*l,n=u*(t[0].y+c),s[f++]=e,s[f++]=n,a=1;a<h;a++)n=u*(t[a].y+c),s[f++]=e,s[f++]=n,s[f++]=e,s[f++]=n;n=u*(t[0].y+c),s[f++]=e,s[f++]=n}for(a=0;a<h;a++)e=0,n=u*(t[a].y+c),s[f++]=e,s[f++]=n;for(a=0;a<h;a++)e=(p-1)*l,n=u*(t[a].y+c),s[f++]=e,s[f++]=n;r.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:new Float32Array(s)})}let v=d-2*h;for(o=0;o<f.length;o+=3){let e=f[o]+v,t=f[o+1]+v,i=f[o+2]+v;_[y++]=e,_[y++]=t,_[y++]=i,_[y++]=i+h,_[y++]=t+h,_[y++]=e+h}let b=new ct({attributes:r,indices:_,boundingSphere:se.fromVertices(e),primitiveType:Ne.TRIANGLES});if(n.normal&&(b=Fn.computeNormal(b)),n.tangent||n.bitangent){try{b=Fn.computeTangentAndBitangent(b)}catch{It("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}n.tangent||(b.attributes.tangent=void 0),n.bitangent||(b.attributes.bitangent=void 0),n.st||(b.attributes.st=void 0)}return b}function zS(e){let t=(e=y(e,y.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;this._positions=t,this._shape=i,this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._cornerType=y(e.cornerType,Ri.ROUNDED),this._vertexFormat=Pe.clone(y(e.vertexFormat,Pe.DEFAULT)),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";let n=1+t.length*h.packedLength;n+=1+i.length*U.packedLength,this.packedLength=n+ie.packedLength+Pe.packedLength+2}zS.pack=function(e,t,i){i=y(i,0);let n,r=e._positions,o=r.length;for(t[i++]=o,n=0;n<o;++n,i+=h.packedLength)h.pack(r[n],t,i);let a=e._shape;for(o=a.length,t[i++]=o,n=0;n<o;++n,i+=U.packedLength)U.pack(a[n],t,i);return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var ute=ie.clone(ie.UNIT_SPHERE),fte=new Pe,US={polylinePositions:void 0,shapePositions:void 0,ellipsoid:ute,vertexFormat:fte,cornerType:void 0,granularity:void 0};zS.unpack=function(e,t,i){t=y(t,0);let n,r=e[t++],o=new Array(r);for(n=0;n<r;++n,t+=h.packedLength)o[n]=h.unpack(e,t);r=e[t++];let a=new Array(r);for(n=0;n<r;++n,t+=U.packedLength)a[n]=U.unpack(e,t);let s=ie.unpack(e,t,ute);t+=ie.packedLength;let l=Pe.unpack(e,t,fte);t+=Pe.packedLength;let c=e[t++],d=e[t];return u(i)?(i._positions=o,i._shape=a,i._ellipsoid=ie.clone(s,i._ellipsoid),i._vertexFormat=Pe.clone(l,i._vertexFormat),i._cornerType=c,i._granularity=d,i):(US.polylinePositions=o,US.shapePositions=a,US.cornerType=c,US.granularity=d,new zS(US))};var tRe=new qe;zS.createGeometry=function(e){let t=e._positions,i=go(t,h.equalsEpsilon),n=e._shape;if(n=_h.removeDuplicatesFromShape(n),i.length<2||n.length<3)return;ei.computeWindingOrder2D(n)===ts.CLOCKWISE&&n.reverse();let r=qe.fromPoints(n,tRe);return eRe(_h.computePositions(i,n,r,e,!0),n,r,e._vertexFormat)};var xO=zS;function nRe(e,t){let i=new hn;i.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:e});let n,r,o=t.length,a=i.position.values.length/3,s=e.length/3/o,l=ke.createTypedArray(a,2*o*(s+1)),u=0;n=0;let c=n*o;for(r=0;r<o-1;r++)l[u++]=r+c,l[u++]=r+c+1;for(l[u++]=o-1+c,l[u++]=c,n=s-1,c=n*o,r=0;r<o-1;r++)l[u++]=r+c,l[u++]=r+c+1;for(l[u++]=o-1+c,l[u++]=c,n=0;n<s-1;n++){let e=o*n,t=e+o;for(r=0;r<o;r++)l[u++]=r+e,l[u++]=r+t}return new ct({attributes:i,indices:ke.createTypedArray(a,l),boundingSphere:se.fromVertices(e),primitiveType:Ne.LINES})}function GS(e){let t=(e=y(e,y.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;this._positions=t,this._shape=i,this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._cornerType=y(e.cornerType,Ri.ROUNDED),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";let n=1+t.length*h.packedLength;n+=1+i.length*U.packedLength,this.packedLength=n+ie.packedLength+2}GS.pack=function(e,t,i){i=y(i,0);let n,r=e._positions,o=r.length;for(t[i++]=o,n=0;n<o;++n,i+=h.packedLength)h.pack(r[n],t,i);let a=e._shape;for(o=a.length,t[i++]=o,n=0;n<o;++n,i+=U.packedLength)U.pack(a[n],t,i);return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var dte=ie.clone(ie.UNIT_SPHERE),HS={polylinePositions:void 0,shapePositions:void 0,ellipsoid:dte,height:void 0,cornerType:void 0,granularity:void 0};GS.unpack=function(e,t,i){t=y(t,0);let n,r=e[t++],o=new Array(r);for(n=0;n<r;++n,t+=h.packedLength)o[n]=h.unpack(e,t);r=e[t++];let a=new Array(r);for(n=0;n<r;++n,t+=U.packedLength)a[n]=U.unpack(e,t);let s=ie.unpack(e,t,dte);t+=ie.packedLength;let l=e[t++],c=e[t];return u(i)?(i._positions=o,i._shape=a,i._ellipsoid=ie.clone(s,i._ellipsoid),i._cornerType=l,i._granularity=c,i):(HS.polylinePositions=o,HS.shapePositions=a,HS.cornerType=l,HS.granularity=c,new GS(HS))};var iRe=new qe;GS.createGeometry=function(e){let t=e._positions,i=go(t,h.equalsEpsilon),n=e._shape;if(n=_h.removeDuplicatesFromShape(n),i.length<2||n.length<3)return;ei.computeWindingOrder2D(n)===ts.CLOCKWISE&&n.reverse();let r=qe.fromPoints(n,iRe);return nRe(_h.computePositions(i,n,r,e,!1),n)};var bO=GS;function hte(){de.throwInstantiationError()}hte.prototype.getURL=de.throwInstantiationError;var mte=hte;function oRe(e){let t=e.points,i=e.times;return function(n,r){u(r)||(r=new Le);let o=e._lastTimeIndex=e.findTimeInterval(n,e._lastTimeIndex),a=(n-i[o])/(i[o+1]-i[o]),s=t[o],l=t[o+1];return Le.fastSlerp(s,l,a,r)}}function LT(e){let t=(e=y(e,y.EMPTY_OBJECT)).points,i=e.times;this._times=i,this._points=t,this._evaluateFunction=oRe(this),this._lastTimeIndex=0}Object.defineProperties(LT.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),LT.prototype.findTimeInterval=eo.prototype.findTimeInterval,LT.prototype.wrapTime=eo.prototype.wrapTime,LT.prototype.clampTime=eo.prototype.clampTime,LT.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var TO=LT,_te=or(pte(),1);function AO(){this._tree=new _te.default}function E0(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}function rRe(e,t){return e.id===t.id}E0.fromRectangleAndId=function(e,t,i){return i.minX=t.west,i.minY=t.south,i.maxX=t.east,i.maxY=t.north,i.id=e,i},AO.prototype.insert=function(e,t){let i=E0.fromRectangleAndId(e,t,new E0);this._tree.insert(i)};var sRe=new E0;AO.prototype.remove=function(e,t){let i=E0.fromRectangleAndId(e,t,sRe);this._tree.remove(i,rRe)};var aRe=new E0;AO.prototype.collides=function(e){let t=E0.fromRectangleAndId("",e,aRe);return this._tree.collides(t)};var NT=AO,gte=Math.cos,yte=Math.sin,cRe=Math.sqrt,$G={computePosition:function(e,t,i,n,r,o,a){let s=t.radiiSquared,l=e.nwCorner,c=e.boundingRectangle,h=l.latitude-e.granYCos*n+r*e.granXSin,d=gte(h),p=yte(h),f=s.z*p,m=l.longitude+n*e.granYSin+r*e.granXCos,_=d*gte(m),g=d*yte(m),y=s.x*_,v=s.y*g,b=cRe(y*_+v*g+f*p);if(o.x=y/b,o.y=v/b,o.z=f/b,i){let t=e.stNwCorner;u(t)?(h=t.latitude-e.stGranYCos*n+r*e.stGranXSin,m=t.longitude+n*e.stGranYSin+r*e.stGranXCos,a.x=(m-e.stWest)*e.lonScalar,a.y=(h-e.stSouth)*e.latScalar):(a.x=(m-c.west)*e.lonScalar,a.y=(h-c.south)*e.latScalar)}}},lRe=new Ji,zu=new h,uRe=new fe,CO=new h,ZG=new Ii;function xte(e,t,i,n,r,o,a){let s=Math.cos(t),l=n*s,u=i*s,c=Math.sin(t),d=n*c,p=i*c;zu=ZG.project(e,zu),zu=h.subtract(zu,CO,zu);let f=Ji.fromRotation(t,lRe);zu=Ji.multiplyByVector(f,zu,zu),zu=h.add(zu,CO,zu),o-=1,a-=1;let m=(e=ZG.unproject(zu,e)).latitude,_=m+o*p,g=m-l*a,y=m-l*a+o*p,v=Math.max(m,_,g,y),b=Math.min(m,_,g,y),A=e.longitude,T=A+o*u,E=A+a*d,C=A+a*d+o*u;return{north:v,south:b,east:Math.max(A,T,E,C),west:Math.min(A,T,E,C),granYCos:l,granYSin:d,granXCos:u,granXSin:p,nwCorner:e}}$G.computeOptions=function(e,t,i,n,r,o,a){let s=e.east,l=e.west,u=e.north,c=e.south,h=!1,d=!1;u===P.PI_OVER_TWO&&(h=!0),c===-P.PI_OVER_TWO&&(d=!0);let p,f=u-c;p=l>s?P.TWO_PI-l+s:s-l;let m=Math.ceil(p/t)+1,_=Math.ceil(f/t)+1,g=p/(m-1),y=f/(_-1),v=ce.northwest(e,o),b=ce.center(e,uRe);(0!==i||0!==n)&&(b.longitude<v.longitude&&(b.longitude+=P.TWO_PI),CO=ZG.project(b,CO));let A=y,T=g,E=ce.clone(e,r),C={granYCos:A,granYSin:0,granXCos:T,granXSin:0,nwCorner:v,boundingRectangle:E,width:m,height:_,northCap:h,southCap:d};if(0!==i){let e=xte(v,i,g,y,b,m,_);u=e.north,c=e.south,s=e.east,l=e.west,C.granYCos=e.granYCos,C.granYSin=e.granYSin,C.granXCos=e.granXCos,C.granXSin=e.granXSin,E.north=u,E.south=c,E.east=s,E.west=l}if(0!==n){i-=n;let e=ce.northwest(E,a),t=xte(e,i,g,y,b,m,_);C.stGranYCos=t.granYCos,C.stGranXCos=t.granXCos,C.stGranYSin=t.granYSin,C.stGranXSin=t.granXSin,C.stNwCorner=e,C.stWest=t.west,C.stSouth=t.south}return C};var ps=$G,QG=new h,Ate=new h,Cte=new h,Ete=new h,Ste=new ce,fRe=new U,dRe=new se,hRe=new se;function wte(e,t){let i=new ct({attributes:new hn,primitiveType:Ne.TRIANGLES});return i.attributes.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:t.positions}),e.normal&&(i.attributes.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:t.normals})),e.tangent&&(i.attributes.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:t.tangents})),e.bitangent&&(i.attributes.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:t.bitangents})),i}function mRe(e,t,i,n){let r=e.length,o=t.normal?new Float32Array(r):void 0,a=t.tangent?new Float32Array(r):void 0,s=t.bitangent?new Float32Array(r):void 0,l=0,u=Ete,c=Cte,d=Ate;if(t.normal||t.tangent||t.bitangent)for(let p=0;p<r;p+=3){let r=h.fromArray(e,p,QG),f=l+1,m=l+2;d=i.geodeticSurfaceNormal(r,d),(t.tangent||t.bitangent)&&(h.cross(h.UNIT_Z,d,c),$.multiplyByVector(n,c,c),h.normalize(c,c),t.bitangent&&h.normalize(h.cross(d,c,u),u)),t.normal&&(o[l]=d.x,o[f]=d.y,o[m]=d.z),t.tangent&&(a[l]=c.x,a[f]=c.y,a[m]=c.z),t.bitangent&&(s[l]=u.x,s[f]=u.y,s[m]=u.z),l+=3}return wte(t,{positions:e,normals:o,tangents:a,bitangents:s})}var JG=new h,vte=new h;function pRe(e,t,i){let n=e.length,r=t.normal?new Float32Array(n):void 0,o=t.tangent?new Float32Array(n):void 0,a=t.bitangent?new Float32Array(n):void 0,s=0,l=0,u=0,c=!0,d=Ete,p=Cte,f=Ate;if(t.normal||t.tangent||t.bitangent)for(let m=0;m<n;m+=6){let _=h.fromArray(e,m,QG),g=h.fromArray(e,(m+6)%n,JG);if(c){let t=h.fromArray(e,(m+3)%n,vte);h.subtract(g,_,g),h.subtract(t,_,t),f=h.normalize(h.cross(t,g,f),f),c=!1}h.equalsEpsilon(g,_,P.EPSILON10)&&(c=!0),(t.tangent||t.bitangent)&&(d=i.geodeticSurfaceNormal(_,d),t.tangent&&(p=h.normalize(h.cross(d,f,p),p))),t.normal&&(r[s++]=f.x,r[s++]=f.y,r[s++]=f.z,r[s++]=f.x,r[s++]=f.y,r[s++]=f.z),t.tangent&&(o[l++]=p.x,o[l++]=p.y,o[l++]=p.z,o[l++]=p.x,o[l++]=p.y,o[l++]=p.z),t.bitangent&&(a[u++]=d.x,a[u++]=d.y,a[u++]=d.z,a[u++]=d.x,a[u++]=d.y,a[u++]=d.z)}return wte(t,{positions:e,normals:r,tangents:o,bitangents:a})}function Dte(e,t){let i=e._vertexFormat,n=e._ellipsoid,r=t.height,o=t.width,a=t.northCap,s=t.southCap,l=0,u=r,c=r,h=0;a&&(l=1,c-=1,h+=1),s&&(u-=1,c-=1,h+=1),h+=o*c;let d=i.position?new Float64Array(3*h):void 0,p=i.st?new Float32Array(2*h):void 0,f=0,m=0,_=QG,g=fRe,y=Number.MAX_VALUE,v=Number.MAX_VALUE,b=-Number.MAX_VALUE,A=-Number.MAX_VALUE;for(let e=l;e<u;++e)for(let r=0;r<o;++r)ps.computePosition(t,n,i.st,e,r,_,g),d[f++]=_.x,d[f++]=_.y,d[f++]=_.z,i.st&&(p[m++]=g.x,p[m++]=g.y,y=Math.min(y,g.x),v=Math.min(v,g.y),b=Math.max(b,g.x),A=Math.max(A,g.y));if(a&&(ps.computePosition(t,n,i.st,0,0,_,g),d[f++]=_.x,d[f++]=_.y,d[f++]=_.z,i.st&&(p[m++]=g.x,p[m++]=g.y,y=g.x,v=g.y,b=g.x,A=g.y)),s&&(ps.computePosition(t,n,i.st,r-1,0,_,g),d[f++]=_.x,d[f++]=_.y,d[f]=_.z,i.st&&(p[m++]=g.x,p[m]=g.y,y=Math.min(y,g.x),v=Math.min(v,g.y),b=Math.max(b,g.x),A=Math.max(A,g.y))),i.st&&(y<0||v<0||b>1||A>1))for(let e=0;e<p.length;e+=2)p[e]=(p[e]-y)/(b-y),p[e+1]=(p[e+1]-v)/(A-v);let T=mRe(d,i,n,t.tangentRotationMatrix),E=6*(o-1)*(c-1);a&&(E+=3*(o-1)),s&&(E+=3*(o-1));let C,x=ke.createTypedArray(h,E),S=0,w=0;for(C=0;C<c-1;++C){for(let e=0;e<o-1;++e){let e=S,t=e+o,i=t+1,n=e+1;x[w++]=e,x[w++]=t,x[w++]=n,x[w++]=n,x[w++]=t,x[w++]=i,++S}++S}if(a||s){let e,t,i=h-1,n=h-1;if(a&&s&&(i=h-2),S=0,a)for(C=0;C<o-1;C++)e=S,t=e+1,x[w++]=i,x[w++]=e,x[w++]=t,++S;if(s)for(S=(c-1)*o,C=0;C<o-1;C++)e=S,t=e+1,x[w++]=e,x[w++]=n,x[w++]=t,++S}return T.indices=x,i.st&&(T.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:p})),T}function FT(e,t,i,n,r){return e[t++]=n[i],e[t++]=n[i+1],e[t++]=n[i+2],e[t++]=r[i],e[t++]=r[i+1],e[t]=r[i+2],e}function BT(e,t,i,n){return e[t++]=n[i],e[t++]=n[i+1],e[t++]=n[i],e[t]=n[i+1],e}var e6=new Pe;function _Re(e,t){let i,n=e._shadowVolume,r=e._offsetAttribute,o=e._vertexFormat,a=e._extrudedHeight,s=e._surfaceHeight,l=e._ellipsoid,c=t.height,d=t.width;if(n){let t=Pe.clone(o,e6);t.normal=!0,e._vertexFormat=t}let p=Dte(e,t);n&&(e._vertexFormat=o);let f=ei.scaleToGeodeticHeight(p.attributes.position.values,s,l,!1);f=new Float64Array(f);let m=f.length,_=2*m,g=new Float64Array(_);g.set(f);let y=ei.scaleToGeodeticHeight(p.attributes.position.values,a,l);g.set(y,m),p.attributes.position.values=g;let v,b,A=o.normal?new Float32Array(_):void 0,T=o.tangent?new Float32Array(_):void 0,E=o.bitangent?new Float32Array(_):void 0,C=o.st?new Float32Array(_/3*2):void 0;if(o.normal){for(b=p.attributes.normal.values,A.set(b),i=0;i<m;i++)b[i]=-b[i];A.set(b,m),p.attributes.normal.values=A}if(n){b=p.attributes.normal.values,o.normal||(p.attributes.normal=void 0);let e=new Float32Array(_);for(i=0;i<m;i++)b[i]=-b[i];e.set(b,m),p.attributes.extrudeDirection=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:e})}let x,S=u(r);if(S){let e=m/3*2,t=new Uint8Array(e);r===on.TOP?t=t.fill(1,0,e/2):(x=r===on.NONE?0:1,t=t.fill(x)),p.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}if(o.tangent){let e=p.attributes.tangent.values;for(T.set(e),i=0;i<m;i++)e[i]=-e[i];T.set(e,m),p.attributes.tangent.values=T}if(o.bitangent){let e=p.attributes.bitangent.values;E.set(e),E.set(e,m),p.attributes.bitangent.values=E}o.st&&(v=p.attributes.st.values,C.set(v),C.set(v,m/3*2),p.attributes.st.values=C);let w=p.indices,I=w.length,D=m/3,O=ke.createTypedArray(_/3,2*I);for(O.set(w),i=0;i<I;i+=3)O[i+I]=w[i+2]+D,O[i+1+I]=w[i+1]+D,O[i+2+I]=w[i]+D;p.indices=O;let L=t.northCap,R=t.southCap,N=c,M=2,F=0,B=4,z=4;L&&(M-=1,N-=1,F+=1,B-=2,z-=1),R&&(M-=1,N-=1,F+=1,B-=2,z-=1),F+=M*d+2*N-B;let U=2*(F+z),k=new Float64Array(3*U),V=n?new Float32Array(3*U):void 0,H=S?new Uint8Array(U):void 0,G=o.st?new Float32Array(2*U):void 0,j=r===on.TOP;S&&!j&&(x=r===on.ALL?1:0,H=H.fill(x));let W,q=0,Y=0,$=0,K=0,J=d*N;for(i=0;i<J;i+=d)W=3*i,k=FT(k,q,W,f,y),q+=6,o.st&&(G=BT(G,Y,2*i,v),Y+=4),n&&($+=3,V[$++]=b[W],V[$++]=b[W+1],V[$++]=b[W+2]),j&&(H[K++]=1,K+=1);if(R){let e=L?J+1:J;for(W=3*e,i=0;i<2;i++)k=FT(k,q,W,f,y),q+=6,o.st&&(G=BT(G,Y,2*e,v),Y+=4),n&&($+=3,V[$++]=b[W],V[$++]=b[W+1],V[$++]=b[W+2]),j&&(H[K++]=1,K+=1)}else for(i=J-d;i<J;i++)W=3*i,k=FT(k,q,W,f,y),q+=6,o.st&&(G=BT(G,Y,2*i,v),Y+=4),n&&($+=3,V[$++]=b[W],V[$++]=b[W+1],V[$++]=b[W+2]),j&&(H[K++]=1,K+=1);for(i=J-1;i>0;i-=d)W=3*i,k=FT(k,q,W,f,y),q+=6,o.st&&(G=BT(G,Y,2*i,v),Y+=4),n&&($+=3,V[$++]=b[W],V[$++]=b[W+1],V[$++]=b[W+2]),j&&(H[K++]=1,K+=1);if(L){let e=J;for(W=3*e,i=0;i<2;i++)k=FT(k,q,W,f,y),q+=6,o.st&&(G=BT(G,Y,2*e,v),Y+=4),n&&($+=3,V[$++]=b[W],V[$++]=b[W+1],V[$++]=b[W+2]),j&&(H[K++]=1,K+=1)}else for(i=d-1;i>=0;i--)W=3*i,k=FT(k,q,W,f,y),q+=6,o.st&&(G=BT(G,Y,2*i,v),Y+=4),n&&($+=3,V[$++]=b[W],V[$++]=b[W+1],V[$++]=b[W+2]),j&&(H[K++]=1,K+=1);let Q=pRe(k,o,l);o.st&&(Q.attributes.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:G})),n&&(Q.attributes.extrudeDirection=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:V})),S&&(Q.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:H}));let Z,ee,te,ie,ne=ke.createTypedArray(U,6*F);m=k.length/3;let re=0;for(i=0;i<m-1;i+=2){Z=i,ie=(Z+2)%m;let e=h.fromArray(k,3*Z,JG),t=h.fromArray(k,3*ie,vte);h.equalsEpsilon(e,t,P.EPSILON10)||(ee=(Z+1)%m,te=(ee+2)%m,ne[re++]=Z,ne[re++]=ee,ne[re++]=ie,ne[re++]=ie,ne[re++]=ee,ne[re++]=te)}return Q.indices=ne,Q=Fn.combineInstances([new yt({geometry:p}),new yt({geometry:Q})]),Q[0]}var gRe=[new h,new h,new h,new h],Ite=new fe,yRe=new fe;function t6(e,t,i,n,r){if(0===i)return ce.clone(e,r);let o=ps.computeOptions(e,t,i,0,Ste,Ite),a=o.height,s=o.width,l=gRe;return ps.computePosition(o,n,!1,0,0,l[0]),ps.computePosition(o,n,!1,0,s-1,l[1]),ps.computePosition(o,n,!1,a-1,0,l[2]),ps.computePosition(o,n,!1,a-1,s-1,l[3]),ce.fromCartesianArray(l,n,r)}function Sh(e){let t=(e=y(e,y.EMPTY_OBJECT)).rectangle,i=y(e.height,0),n=y(e.extrudedHeight,i);this._rectangle=ce.clone(t),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._ellipsoid=ie.clone(y(e.ellipsoid,ie.WGS84)),this._surfaceHeight=Math.max(i,n),this._rotation=y(e.rotation,0),this._stRotation=y(e.stRotation,0),this._vertexFormat=Pe.clone(y(e.vertexFormat,Pe.DEFAULT)),this._extrudedHeight=Math.min(i,n),this._shadowVolume=y(e.shadowVolume,!1),this._workerName="createRectangleGeometry",this._offsetAttribute=e.offsetAttribute,this._rotatedRectangle=void 0,this._textureCoordinateRotationPoints=void 0}Sh.packedLength=ce.packedLength+ie.packedLength+Pe.packedLength+7,Sh.pack=function(e,t,i){return i=y(i,0),ce.pack(e._rectangle,t,i),i+=ce.packedLength,ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),i+=Pe.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._stRotation,t[i++]=e._extrudedHeight,t[i++]=e._shadowVolume?1:0,t[i]=y(e._offsetAttribute,-1),t};var Pte=new ce,Ote=ie.clone(ie.UNIT_SPHERE),U_={rectangle:Pte,ellipsoid:Ote,vertexFormat:e6,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};Sh.unpack=function(e,t,i){t=y(t,0);let n=ce.unpack(e,t,Pte);t+=ce.packedLength;let r=ie.unpack(e,t,Ote);t+=ie.packedLength;let o=Pe.unpack(e,t,e6);t+=Pe.packedLength;let a=e[t++],s=e[t++],l=e[t++],c=e[t++],h=e[t++],d=1===e[t++],p=e[t];return u(i)?(i._rectangle=ce.clone(n,i._rectangle),i._ellipsoid=ie.clone(r,i._ellipsoid),i._vertexFormat=Pe.clone(o,i._vertexFormat),i._granularity=a,i._surfaceHeight=s,i._rotation=l,i._stRotation=c,i._extrudedHeight=h,i._shadowVolume=d,i._offsetAttribute=-1===p?void 0:p,i):(U_.granularity=a,U_.height=s,U_.rotation=l,U_.stRotation=c,U_.extrudedHeight=h,U_.shadowVolume=d,U_.offsetAttribute=-1===p?void 0:p,new Sh(U_))},Sh.computeRectangle=function(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).rectangle,n=y(e.granularity,P.RADIANS_PER_DEGREE),r=y(e.ellipsoid,ie.WGS84);return t6(i,n,y(e.rotation,0),r,t)};var xRe=new $,bte=new Le,bRe=new fe;Sh.createGeometry=function(e){if(P.equalsEpsilon(e._rectangle.north,e._rectangle.south,P.EPSILON10)||P.equalsEpsilon(e._rectangle.east,e._rectangle.west,P.EPSILON10))return;let t=e._rectangle,i=e._ellipsoid,n=e._rotation,r=e._stRotation,o=e._vertexFormat,a=ps.computeOptions(t,e._granularity,n,r,Ste,Ite,yRe),s=xRe;if(0!==r||0!==n){let e=ce.center(t,bRe),n=i.geodeticSurfaceNormalCartographic(e,JG);Le.fromAxisAngle(n,-r,bte),$.fromQuaternion(bte,s)}else $.clone($.IDENTITY,s);let l,c,h=e._surfaceHeight,d=e._extrudedHeight,p=!P.equalsEpsilon(h,d,0,P.EPSILON2);if(a.lonScalar=1/e._rectangle.width,a.latScalar=1/e._rectangle.height,a.tangentRotationMatrix=s,t=e._rectangle,p){l=_Re(e,a);let n=se.fromRectangle3D(t,i,h,hRe),r=se.fromRectangle3D(t,i,d,dRe);c=se.union(n,r)}else{if(l=Dte(e,a),l.attributes.position.values=ei.scaleToGeodeticHeight(l.attributes.position.values,h,i,!1),u(e._offsetAttribute)){let t=l.attributes.position.values.length,i=e._offsetAttribute===on.NONE?0:1,n=new Uint8Array(t/3).fill(i);l.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}c=se.fromRectangle3D(t,i,h)}return o.position||delete l.attributes.position,new ct({attributes:l.attributes,indices:l.indices,primitiveType:l.primitiveType,boundingSphere:c,offsetAttribute:e._offsetAttribute})},Sh.createShadowVolume=function(e,t,i){let n=e._granularity,r=e._ellipsoid,o=t(n,r),a=i(n,r);return new Sh({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:r,stRotation:e._stRotation,granularity:n,extrudedHeight:a,height:o,vertexFormat:Pe.POSITION_ONLY,shadowVolume:!0})};var Tte=new ce,TRe=[new U,new U,new U],ARe=new Ji,CRe=new fe;function ERe(e){if(0===e._stRotation)return[0,0,0,1,1,0];let t=ce.clone(e._rectangle,Tte),i=e._granularity,n=e._ellipsoid,r=t6(t,i,e._rotation-e._stRotation,n,Tte),o=TRe;o[0].x=r.west,o[0].y=r.south,o[1].x=r.west,o[1].y=r.north,o[2].x=r.east,o[2].y=r.south;let a=e.rectangle,s=Ji.fromRotation(e._stRotation,ARe),l=ce.center(a,CRe);for(let e=0;e<3;++e){let t=o[e];t.x-=l.longitude,t.y-=l.latitude,Ji.multiplyByVector(s,t,t),t.x+=l.longitude,t.y+=l.latitude,t.x=(t.x-a.west)/a.width,t.y=(t.y-a.south)/a.height}let u=o[0],c=o[1],h=o[2],d=new Array(6);return U.pack(u,d),U.pack(c,d,2),U.pack(h,d,4),d}Object.defineProperties(Sh.prototype,{rectangle:{get:function(){return u(this._rotatedRectangle)||(this._rotatedRectangle=t6(this._rectangle,this._granularity,this._rotation,this._ellipsoid)),this._rotatedRectangle}},textureCoordinateRotationPoints:{get:function(){return u(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=ERe(this)),this._textureCoordinateRotationPoints}}});var kT=Sh,SRe=new se,wRe=new se,vRe=new h,DRe=new ce;function Rte(e,t){let i=e._ellipsoid,n=t.height,r=t.width,o=t.northCap,a=t.southCap,s=n,l=2,u=0,c=4;o&&(l-=1,s-=1,u+=1,c-=2),a&&(l-=1,s-=1,u+=1,c-=2),u+=l*r+2*s-c;let h,d=new Float64Array(3*u),p=0,f=0,m=vRe;if(o)ps.computePosition(t,i,!1,f,0,m),d[p++]=m.x,d[p++]=m.y,d[p++]=m.z;else for(h=0;h<r;h++)ps.computePosition(t,i,!1,f,h,m),d[p++]=m.x,d[p++]=m.y,d[p++]=m.z;for(h=r-1,f=1;f<n;f++)ps.computePosition(t,i,!1,f,h,m),d[p++]=m.x,d[p++]=m.y,d[p++]=m.z;if(f=n-1,!a)for(h=r-2;h>=0;h--)ps.computePosition(t,i,!1,f,h,m),d[p++]=m.x,d[p++]=m.y,d[p++]=m.z;for(h=0,f=n-2;f>0;f--)ps.computePosition(t,i,!1,f,h,m),d[p++]=m.x,d[p++]=m.y,d[p++]=m.z;let _=d.length/3*2,g=ke.createTypedArray(d.length/3,_),y=0;for(let e=0;e<d.length/3-1;e++)g[y++]=e,g[y++]=e+1;g[y++]=d.length/3-1,g[y++]=0;let v=new ct({attributes:new hn,primitiveType:Ne.LINES});return v.attributes.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:d}),v.indices=g,v}function IRe(e,t){let i=e._surfaceHeight,n=e._extrudedHeight,r=e._ellipsoid,o=n,a=i,s=Rte(e,t),l=t.height,u=t.width,c=ei.scaleToGeodeticHeight(s.attributes.position.values,a,r,!1),h=c.length,d=new Float64Array(2*h);d.set(c);let p=ei.scaleToGeodeticHeight(s.attributes.position.values,o,r);d.set(p,h),s.attributes.position.values=d;let f=t.northCap,m=t.southCap,_=4;f&&(_-=1),m&&(_-=1);let g=2*(d.length/3+_),y=ke.createTypedArray(d.length/3,g);h=d.length/6;let v,b=0;for(let e=0;e<h-1;e++)y[b++]=e,y[b++]=e+1,y[b++]=e+h,y[b++]=e+h+1;if(y[b++]=h-1,y[b++]=0,y[b++]=h+h-1,y[b++]=h,y[b++]=0,y[b++]=h,f)v=l-1;else{let e=u-1;y[b++]=e,y[b++]=e+h,v=u+l-2}if(y[b++]=v,y[b++]=v+h,!m){let e=u+v-1;y[b++]=e,y[b]=e+h}return s.indices=y,s}function UT(e){let t=(e=y(e,y.EMPTY_OBJECT)).rectangle,i=y(e.granularity,P.RADIANS_PER_DEGREE),n=y(e.ellipsoid,ie.WGS84),r=y(e.rotation,0),o=y(e.height,0),a=y(e.extrudedHeight,o);this._rectangle=ce.clone(t),this._granularity=i,this._ellipsoid=n,this._surfaceHeight=Math.max(o,a),this._rotation=r,this._extrudedHeight=Math.min(o,a),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}UT.packedLength=ce.packedLength+ie.packedLength+5,UT.pack=function(e,t,i){return i=y(i,0),ce.pack(e._rectangle,t,i),i+=ce.packedLength,ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=y(e._offsetAttribute,-1),t};var Mte=new ce,Lte=ie.clone(ie.UNIT_SPHERE),VT={rectangle:Mte,ellipsoid:Lte,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};UT.unpack=function(e,t,i){t=y(t,0);let n=ce.unpack(e,t,Mte);t+=ce.packedLength;let r=ie.unpack(e,t,Lte);t+=ie.packedLength;let o=e[t++],a=e[t++],s=e[t++],l=e[t++],c=e[t];return u(i)?(i._rectangle=ce.clone(n,i._rectangle),i._ellipsoid=ie.clone(r,i._ellipsoid),i._surfaceHeight=a,i._rotation=s,i._extrudedHeight=l,i._offsetAttribute=-1===c?void 0:c,i):(VT.granularity=o,VT.height=a,VT.rotation=s,VT.extrudedHeight=l,VT.offsetAttribute=-1===c?void 0:c,new UT(VT))};var PRe=new fe;UT.createGeometry=function(e){let t,i,n=e._rectangle,r=e._ellipsoid,o=ps.computeOptions(n,e._granularity,e._rotation,0,DRe,PRe);if(P.equalsEpsilon(n.north,n.south,P.EPSILON10)||P.equalsEpsilon(n.east,n.west,P.EPSILON10))return;let a,s=e._surfaceHeight,l=e._extrudedHeight;if(!P.equalsEpsilon(s,l,0,P.EPSILON2)){if(t=IRe(e,o),u(e._offsetAttribute)){let i=t.attributes.position.values.length/3,n=new Uint8Array(i);e._offsetAttribute===on.TOP?n=n.fill(1,0,i/2):(a=e._offsetAttribute===on.NONE?0:1,n=n.fill(a)),t.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}let c=se.fromRectangle3D(n,r,s,wRe),h=se.fromRectangle3D(n,r,l,SRe);i=se.union(c,h)}else{if(t=Rte(e,o),t.attributes.position.values=ei.scaleToGeodeticHeight(t.attributes.position.values,s,r,!1),u(e._offsetAttribute)){let i=t.attributes.position.values.length;a=e._offsetAttribute===on.NONE?0:1;let n=new Uint8Array(i/3).fill(a);t.attributes.applyOffset=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,values:n})}i=se.fromRectangle3D(n,r,s)}return new ct({attributes:t.attributes,indices:t.indices,primitiveType:Ne.LINES,boundingSphere:i,offsetAttribute:e._offsetAttribute})};var zT=UT,ORe={FIXED:0,INERTIAL:1},to=Object.freeze(ORe);function RRe(e){let t=document.createElement("canvas");return t.width=P.nextPowerOfTwo(e.width),t.height=P.nextPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t}var S0=RRe,w0=30,MRe=1<<w0,LRe=1<<w0+1>>>0,n6=2*w0+1,z_=4,Bte=[],kte=[],NRe=[[0,1,3,2],[0,2,3,1],[3,2,0,1],[3,1,0,2]],H_=1,HT=2,EO=[H_,0,0,H_|HT];function Rr(e){if(!Bt.supportsBigInt())throw new ue("S2 required BigInt support");this._cellId=e,this._level=Rr.getLevel(e)}function FRe(e,t){let i=kRe(e,t);return VRe(i[0],i[1],i[2])}function BRe(e,t,i){let n=Vte(e,t),r=URe([n[1],n[2]],t),o=i>>1&1;return Ute(n[0],r[0][o^1&i],r[1][o])}function kRe(e,t){let i=Vte(e),n=i[0],r=i[1],o=i[2],a=30===t,s=!a&&(BigInt(r)^e>>BigInt(2))&BigInt(1),l=a?1:s?2:0;return[n,(r<<1)+l,(o<<1)+l]}function Vte(e){0===Bte.length&&HRe();let t=Number(e>>BigInt(n6)),i=t&H_,n=(1<<z_)-1,r=0,o=0;for(let t=7;t>=0;t--){let a=(1<<2*(7===t?w0-7*z_:z_))-1;i+=Number(e>>BigInt(2*t*z_+1)&BigInt(a))<<2,i=kte[i];let s=t*z_;r+=i>>z_+2<<s,o+=(i>>2&n)<<s,i&=H_|HT}return[t,r,o]}function VRe(e,t,i){let n=Nte(t),r=Nte(i);return Ute(e,SO(n),SO(r))}function Ute(e,t,i){switch(e){case 0:return new h(1,t,i);case 1:return new h(-t,1,i);case 2:return new h(-t,-i,1);case 3:return new h(-1,-i,-t);case 4:return new h(i,-1,-t);default:return new h(i,t,-1)}}function SO(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function Nte(e){return 1/LRe*e}function URe(e,t){let i=[[],[]],n=zRe(t);for(let t=0;t<2;++t){let r=e[t]&-n,o=r+n;i[t][0]=SO(Fte(r)),i[t][1]=SO(Fte(o))}return i}function zRe(e){return 1<<w0-e>>>0}function Fte(e){return 1/MRe*e}function G_(e,t,i,n,r,o){if(e===z_){let e=(t<<z_)+i;Bte[(e<<2)+n]=(r<<2)+o,kte[(r<<2)+n]=(e<<2)+o}else{e++,t<<=1,i<<=1,r<<=2;let a=NRe[o];G_(e,t+(a[0]>>1),i+(1&a[0]),n,r,o^EO[0]),G_(e,t+(a[1]>>1),i+(1&a[1]),n,r+1,o^EO[1]),G_(e,t+(a[2]>>1),i+(1&a[2]),n,r+2,o^EO[2]),G_(e,t+(a[3]>>1),i+(1&a[3]),n,r+3,o^EO[3])}}function HRe(){G_(0,0,0,0,0,0),G_(0,0,0,H_,0,H_),G_(0,0,0,HT,0,HT),G_(0,0,0,H_|HT,0,H_|HT)}function zte(e){return e&~e+BigInt(1)}function GRe(e){return BigInt(1)<<BigInt(2*(w0-e))}Rr.fromToken=function(e){return new Rr(Rr.getIdFromToken(e))},Rr.isValidId=function(e){return!(e<=0||e>>BigInt(n6)>5||!(e&~e+BigInt(1)&BigInt("0x1555555555555555")))},Rr.isValidToken=function(e){return!!/^[0-9a-fA-F]{1,16}$/.test(e)&&Rr.isValidId(Rr.getIdFromToken(e))},Rr.getIdFromToken=function(e){return BigInt("0x"+e+"0".repeat(16-e.length))},Rr.getTokenFromId=function(e){let t=Math.floor(jRe(e)/4),i=e.toString(16).replace(/0*$/,"");return Array(17-t-i.length).join("0")+i},Rr.getLevel=function(e){let t=0;for(;e!==BigInt(0)&&!(e&BigInt(1));)t++,e>>=BigInt(1);return w0-(t>>1)},Rr.prototype.getChild=function(e){let t=zte(this._cellId)>>BigInt(2);return new Rr(this._cellId+BigInt(2*e+1-4)*t)},Rr.prototype.getParent=function(){let e=zte(this._cellId)<<BigInt(2);return new Rr(this._cellId&~e+BigInt(1)|e)},Rr.prototype.getParentAtLevel=function(e){let t=GRe(e);return new Rr(this._cellId&-t|t)},Rr.prototype.getCenter=function(e){e=y(e,ie.WGS84);let t=FRe(this._cellId,this._level);t=h.normalize(t,t);let i=new fe.fromCartesian(t,ie.UNIT_SPHERE);return fe.toCartesian(i,e,new h)},Rr.prototype.getVertex=function(e,t){t=y(t,ie.WGS84);let i=BRe(this._cellId,this._level,e);i=h.normalize(i,i);let n=new fe.fromCartesian(i,ie.UNIT_SPHERE);return fe.toCartesian(n,t,new h)},Rr.fromFacePositionLevel=function(e,t,i){let n=(e<4?"0":"")+(e<2?"0":"")+e.toString(2),r=t.toString(2),o=Array(2*i-r.length+1).join("0"),a=Array(n6-2*i).join("0");return new Rr(BigInt(`0b${n}${o}${r}1${a}`))};var WRe=[64,0,1,39,2,15,40,23,3,12,16,59,41,19,24,54,4,64,13,10,17,62,60,28,42,30,20,51,25,44,55,47,5,32,65,38,14,22,11,58,18,53,63,9,61,27,29,50,43,46,31,37,21,57,52,8,26,49,45,36,56,7,48,35,6,34,33,0];function jRe(e){return WRe[(-e&e)%BigInt(67)]}var W_=Rr;async function qRe(e,t,i,n){return u(n)||(n=!1),KRe(e,t,i,n)}function YRe(e,t,i){let n,r=e[0],o=r.terrainProvider.requestTileGeometry(r.x,r.y,r.level);return!!o&&(n=i?o.then(Gte(r)):o.then(Gte(r)).catch(ZRe(r)),e.shift(),t.push(n),!0)}function XRe(e){return new Promise((function(t){setTimeout(t,e)}))}function i6(e,t,i){return e.length?YRe(e,t,i)?i6(e,t):XRe(100).then((()=>i6(e,t))):Promise.resolve()}function KRe(e,t,i,n){let r,o=e.tilingScheme,a=[],s={};for(r=0;r<i.length;++r){let n=o.positionToTileXY(i[r],t);if(!u(n))continue;let l=n.toString();if(!s.hasOwnProperty(l)){let i={x:n.x,y:n.y,level:t,tilingScheme:o,terrainProvider:e,positions:[]};s[l]=i,a.push(i)}s[l].positions.push(i[r])}let l=[];return i6(a,l,n).then((function(){return Promise.all(l).then((function(){return i}))}))}function Hte(e,t,i){let n=t.interpolateHeight(i,e.longitude,e.latitude);return void 0!==n&&(e.height=n,!0)}function Gte(e){let t=e.positions,i=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(n){let r=!1;for(let e=0;e<t.length;++e){if(!Hte(t[e],n,i)){r=!0;break}}return r?n.createMesh({tilingScheme:e.tilingScheme,x:e.x,y:e.y,level:e.level,throttle:!1}).then((function(){for(let e=0;e<t.length;++e){Hte(t[e],n,i)}})):Promise.resolve()}}function ZRe(e){let t=e.positions;return function(){for(let e=0;e<t.length;++e){t[e].height=void 0}}}var wO=qRe,o6=new U;async function Wte(e,t,i){u(i)||(i=!1);let n=[],r=[],o=e.availability,a=[];for(let i=0;i<t.length;++i){let s=t[i],l=o.computeMaximumLevelAtPosition(s);if(r[i]=l,0===l){e.tilingScheme.positionToTileXY(s,1,o6);let t=e.loadTileDataAvailability(o6.x,o6.y,1);u(t)&&a.push(t)}let c=n[l];u(c)||(n[l]=c=[]),c.push(s)}await Promise.all(a),await Promise.all(n.map((function(t,n){if(u(t))return wO(e,n,t,i)})));let s=[];for(let e=0;e<t.length;++e){let i=t[e];o.computeMaximumLevelAtPosition(i)!==r[e]&&s.push(i)}return s.length>0&&await Wte(e,s,i),t}var j_=Wte,$Re={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19},_n=Object.freeze($Re);function q_(e,t,i){let n=e._element;if(n===document)return i.x=t.clientX,i.y=t.clientY,i;let r=n.getBoundingClientRect();return i.x=t.clientX-r.left,i.y=t.clientY-r.top,i}function u6(e,t){let i=e;return u(t)&&(i+=`+${t}`),i}function v0(e){return e.shiftKey?na.SHIFT:e.ctrlKey?na.CTRL:e.altKey?na.ALT:void 0}var os={LEFT:0,MIDDLE:1,RIGHT:2};function Fl(e,t,i,n){function r(t){n(e,t)}Bt.isInternetExplorer()?i.addEventListener(t,r,!1):i.addEventListener(t,r,{capture:!1,passive:!1}),e._removalFunctions.push((function(){i.removeEventListener(t,r,!1)}))}function QRe(e){let t,i=e._element,n=u(i.disableRootEvents)?i:document;Bt.supportsPointerEvents()?(Fl(e,"pointerdown",i,oMe),Fl(e,"pointerup",i,ene),Fl(e,"pointermove",i,rMe),Fl(e,"pointercancel",i,ene)):(Fl(e,"mousedown",i,tne),Fl(e,"mouseup",n,nne),Fl(e,"mousemove",n,ine),Fl(e,"touchstart",i,nMe),Fl(e,"touchend",n,Kte),Fl(e,"touchmove",n,iMe),Fl(e,"touchcancel",n,Kte)),Fl(e,"dblclick",i,eMe),t="onwheel"in i?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",Fl(e,t,i,tMe)}function JRe(e){let t=e._removalFunctions;for(let e=0;e<t.length;++e)t[e]()}var jte={position:new U};function f6(e){e._lastSeenTouchEvent=_i()}function d6(e){return _i()-e._lastSeenTouchEvent>Yf.mouseEmulationIgnoreMilliseconds}function l6(e,t,i){let n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)<i}function tne(e,t){if(!d6(e))return;let i,n=t.button;if(e._buttonDown[n]=!0,n===os.LEFT)i=_n.LEFT_DOWN;else if(n===os.MIDDLE)i=_n.MIDDLE_DOWN;else{if(n!==os.RIGHT)return;i=_n.RIGHT_DOWN}let r=q_(e,t,e._primaryPosition);U.clone(r,e._primaryStartPosition),U.clone(r,e._primaryPreviousPosition);let o=v0(t),a=e.getInputAction(i,o);u(a)&&(U.clone(r,jte.position),a(jte),t.preventDefault())}var qte={position:new U},Yte={position:new U};function r6(e,t,i,n){let r=v0(n),o=e.getInputAction(t,r),a=e.getInputAction(i,r);if(u(o)||u(a)){let t=q_(e,n,e._primaryPosition);if(u(o)&&(U.clone(t,qte.position),o(qte)),u(a)){l6(e._primaryStartPosition,t,e._clickPixelTolerance)&&(U.clone(t,Yte.position),a(Yte))}}}function nne(e,t){if(!d6(e))return;let i=t.button;i!==os.LEFT&&i!==os.MIDDLE&&i!==os.RIGHT||(e._buttonDown[os.LEFT]&&(r6(e,_n.LEFT_UP,_n.LEFT_CLICK,t),e._buttonDown[os.LEFT]=!1),e._buttonDown[os.MIDDLE]&&(r6(e,_n.MIDDLE_UP,_n.MIDDLE_CLICK,t),e._buttonDown[os.MIDDLE]=!1),e._buttonDown[os.RIGHT]&&(r6(e,_n.RIGHT_UP,_n.RIGHT_CLICK,t),e._buttonDown[os.RIGHT]=!1))}var s6={startPosition:new U,endPosition:new U};function ine(e,t){if(!d6(e))return;let i=v0(t),n=q_(e,t,e._primaryPosition),r=e._primaryPreviousPosition,o=e.getInputAction(_n.MOUSE_MOVE,i);u(o)&&(U.clone(r,s6.startPosition),U.clone(n,s6.endPosition),o(s6)),U.clone(n,r),(e._buttonDown[os.LEFT]||e._buttonDown[os.MIDDLE]||e._buttonDown[os.RIGHT])&&t.preventDefault()}var Xte={position:new U};function eMe(e,t){let i;if(t.button!==os.LEFT)return;i=_n.LEFT_DOUBLE_CLICK;let n=v0(t),r=e.getInputAction(i,n);u(r)&&(q_(e,t,Xte.position),r(Xte))}function tMe(e,t){let i;if(u(t.deltaY)){let e=t.deltaMode;i=e===t.DOM_DELTA_PIXEL?-t.deltaY:e===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}else i=t.detail>0?-120*t.detail:t.wheelDelta;if(!u(i))return;let n=v0(t),r=e.getInputAction(_n.WHEEL,n);u(r)&&(r(i),t.preventDefault())}function nMe(e,t){f6(e);let i,n,r,o=t.changedTouches,a=o.length,s=e._positions;for(i=0;i<a;++i)n=o[i],r=n.identifier,s.set(r,q_(e,n,new U));vO(e,t);let l=e._previousPositions;for(i=0;i<a;++i)n=o[i],r=n.identifier,l.set(r,U.clone(s.get(r)))}function Kte(e,t){f6(e);let i,n,r,o=t.changedTouches,a=o.length,s=e._positions;for(i=0;i<a;++i)n=o[i],r=n.identifier,s.remove(r);vO(e,t);let l=e._previousPositions;for(i=0;i<a;++i)n=o[i],r=n.identifier,l.remove(r)}var Zte={position:new U},a6={position1:new U,position2:new U},$te={position:new U},Qte={position:new U},Jte={position:new U};function vO(e,t){let i,n,r=v0(t),o=e._positions,a=o.length,s=e._isPinching;if(1!==a&&e._buttonDown[os.LEFT]){if(e._buttonDown[os.LEFT]=!1,u(e._touchHoldTimer)&&(clearTimeout(e._touchHoldTimer),e._touchHoldTimer=void 0),i=e.getInputAction(_n.LEFT_UP,r),u(i)&&(U.clone(e._primaryPosition,$te.position),i($te)),0===a&&!e._isTouchHolding&&(n=e.getInputAction(_n.LEFT_CLICK,r),u(n))){l6(e._primaryStartPosition,e._previousPositions.values[0],e._clickPixelTolerance)&&(U.clone(e._primaryPosition,Qte.position),n(Qte))}e._isTouchHolding=!1}if(0===a&&s&&(e._isPinching=!1,i=e.getInputAction(_n.PINCH_END,r),u(i)&&i()),1===a&&!s){let a=o.values[0];U.clone(a,e._primaryPosition),U.clone(a,e._primaryStartPosition),U.clone(a,e._primaryPreviousPosition),e._buttonDown[os.LEFT]=!0,i=e.getInputAction(_n.LEFT_DOWN,r),u(i)&&(U.clone(a,Zte.position),i(Zte)),e._touchHoldTimer=setTimeout((function(){if(!e.isDestroyed()&&(e._touchHoldTimer=void 0,e._isTouchHolding=!0,n=e.getInputAction(_n.RIGHT_CLICK,r),u(n))){l6(e._primaryStartPosition,e._previousPositions.values[0],e._holdPixelTolerance)&&(U.clone(e._primaryPosition,Jte.position),n(Jte))}}),Yf.touchHoldDelayMilliseconds),t.preventDefault()}2===a&&!s&&(e._isPinching=!0,i=e.getInputAction(_n.PINCH_START,r),u(i)&&(U.clone(o.values[0],a6.position1),U.clone(o.values[1],a6.position2),i(a6),t.preventDefault()))}function iMe(e,t){f6(e);let i,n,r,o=t.changedTouches,a=o.length,s=e._positions;for(i=0;i<a;++i){n=o[i],r=n.identifier;let t=s.get(r);u(t)&&q_(e,n,t)}one(e,t);let l=e._previousPositions;for(i=0;i<a;++i)n=o[i],r=n.identifier,U.clone(s.get(r),l.get(r))}var c6={startPosition:new U,endPosition:new U},WS={distance:{startPosition:new U,endPosition:new U},angleAndHeight:{startPosition:new U,endPosition:new U}};function one(e,t){let i,n=v0(t),r=e._positions,o=e._previousPositions,a=r.length;if(1===a&&e._buttonDown[os.LEFT]){let o=r.values[0];U.clone(o,e._primaryPosition);let a=e._primaryPreviousPosition;i=e.getInputAction(_n.MOUSE_MOVE,n),u(i)&&(U.clone(a,c6.startPosition),U.clone(o,c6.endPosition),i(c6)),U.clone(o,a),t.preventDefault()}else if(2===a&&e._isPinching&&(i=e.getInputAction(_n.PINCH_MOVE,n),u(i))){let e=r.values[0],t=r.values[1],n=o.values[0],a=o.values[1],s=t.x-e.x,l=t.y-e.y,u=.25*Math.sqrt(s*s+l*l),c=a.x-n.x,h=a.y-n.y,d=.25*Math.sqrt(c*c+h*h),p=.125*(t.y+e.y),f=.125*(a.y+n.y),m=Math.atan2(l,s),_=Math.atan2(h,c);U.fromElements(0,d,WS.distance.startPosition),U.fromElements(0,u,WS.distance.endPosition),U.fromElements(_,f,WS.angleAndHeight.startPosition),U.fromElements(m,p,WS.angleAndHeight.endPosition),i(WS)}}function oMe(e,t){if(t.target.setPointerCapture(t.pointerId),"touch"===t.pointerType){let i=e._positions,n=t.pointerId;i.set(n,q_(e,t,new U)),vO(e,t),e._previousPositions.set(n,U.clone(i.get(n)))}else tne(e,t)}function ene(e,t){if("touch"===t.pointerType){let i=e._positions,n=t.pointerId;i.remove(n),vO(e,t),e._previousPositions.remove(n)}else nne(e,t)}function rMe(e,t){if("touch"===t.pointerType){let i=e._positions,n=t.pointerId,r=i.get(n);if(!u(r))return;q_(e,t,r),one(e,t);let o=e._previousPositions;U.clone(i.get(n),o.get(n))}else ine(e,t)}function Yf(e){this._inputEvents={},this._buttonDown={LEFT:!1,MIDDLE:!1,RIGHT:!1},this._isPinching=!1,this._isTouchHolding=!1,this._lastSeenTouchEvent=-Yf.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new U,this._primaryPosition=new U,this._primaryPreviousPosition=new U,this._positions=new bt,this._previousPositions=new bt,this._removalFunctions=[],this._touchHoldTimer=void 0,this._clickPixelTolerance=5,this._holdPixelTolerance=25,this._element=y(e,document),QRe(this)}Yf.prototype.setInputAction=function(e,t,i){let n=u6(t,i);this._inputEvents[n]=e},Yf.prototype.getInputAction=function(e,t){let i=u6(e,t);return this._inputEvents[i]},Yf.prototype.removeInputAction=function(e,t){let i=u6(e,t);delete this._inputEvents[i]},Yf.prototype.isDestroyed=function(){return!1},Yf.prototype.destroy=function(){return JRe(this),le(this)},Yf.mouseEmulationIgnoreMilliseconds=800,Yf.touchHoldDelayMilliseconds=1500;var Hu=Yf;function DO(e){e=y(e,!0),this.value=DO.toValue(e)}Object.defineProperties(DO.prototype,{componentDatatype:{get:function(){return X.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),DO.toValue=function(e,t){return u(t)?(t[0]=e,t):new Uint8Array([e])};var gn=DO,h6={};function sMe(e){let t=6.239996+.0172019696544*e;return.001657*Math.sin(t+.01671*Math.sin(t))}var aMe=32.184,cMe=2451545;function Cne(e,t){t=J.addSeconds(e,aMe,t);let i=J.totalDays(t)-cMe;return t=J.addSeconds(t,sMe(i),t)}var IO=new J(2451545,0,Yn.TAI),lMe=1e3,Gu=P.RADIANS_PER_DEGREE,Bl=P.RADIANS_PER_ARCSECOND,ia=14959787e4,rne=new $;function Ene(e,t,i,n,r,o,a){i<0&&(i=-i,r+=P.PI);let s=e*(1-t),l=n-r,c=r,d=fMe(o-n,t);uMe(t,0);_Me(l,i,c,rne);let p=s*(1+t),f=Math.cos(d),m=Math.sin(d),_=p/(1+t*f);return u(a)?(a.x=_*f,a.y=_*m,a.z=0):a=new h(_*f,_*m,0),$.multiplyByVector(rne,a,a)}function uMe(e,t){return e<=t?"Circular":e<1-t?"Elliptical":e<=1+t?"Parabolic":"Hyperbolic"}function fMe(e,t){return pMe(mMe(e,t),t)}var dMe=50,hMe=P.EPSILON8;function mMe(e,t){let i,n=Math.floor(e/P.TWO_PI),r=(e-=n*P.TWO_PI)+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),o=Number.MAX_VALUE;for(i=0;i<dMe&&Math.abs(o-r)>hMe;++i){o=r,r=o-(o-t*Math.sin(o)-e)/(1-t*Math.cos(o))}return o=r+n*P.TWO_PI,o}function pMe(e,t){let i=Math.floor(e/P.TWO_PI);e-=i*P.TWO_PI;let n=Math.cos(e)-t,r=Math.sin(e)*Math.sqrt(1-t*t),o=Math.atan2(r,n);return o=P.zeroToTwoPi(o),e<0&&(o-=P.TWO_PI),o+=i*P.TWO_PI,o}function _Me(e,t,i,n){let r=Math.cos(e),o=Math.sin(e),a=Math.cos(t),s=Math.sin(t),l=Math.cos(i),c=Math.sin(i);return u(n)?(n[0]=l*r-c*o*a,n[1]=c*r+l*o*a,n[2]=o*s,n[3]=-l*o-c*r*a,n[4]=-c*o+l*r*a,n[5]=r*s,n[6]=c*s,n[7]=-l*s,n[8]=a):n=new $(l*r-c*o*a,-l*o-c*r*a,c*s,c*r+l*o*a,-c*o+l*r*a,-l*s,o*s,r*s,a),n}var gMe=1.0000010178*ia,yMe=100.46645683*Gu,xMe=1295977422.83429*Bl,sne=16002,ane=21863,cne=32004,lne=10931,une=14529,fne=16368,dne=15318,hne=32794,bMe=64*1e-7*ia,TMe=1e-7*-152*ia,AMe=62*1e-7*ia,CMe=-8e-7*ia,EMe=32*1e-7*ia,SMe=1e-7*-41*ia,wMe=19*1e-7*ia,vMe=1e-7*-11*ia,DMe=1e-7*-150*ia,IMe=1e-7*-46*ia,PMe=68*1e-7*ia,OMe=54*1e-7*ia,RMe=14*1e-7*ia,MMe=24*1e-7*ia,LMe=1e-7*-28*ia,NMe=22*1e-7*ia,mne=10,pne=16002,_ne=21863,gne=10931,yne=1473,xne=32004,bne=4387,Tne=73,FMe=1e-7*-325,BMe=1e-7*-322,kMe=1e-7*-79,VMe=232*1e-7,UMe=1e-7*-52,zMe=97*1e-7,HMe=55*1e-7,GMe=1e-7*-41,WMe=1e-7*-105,jMe=1e-7*-137,qMe=258*1e-7,YMe=35*1e-7,XMe=1e-7*-116,KMe=1e-7*-88,ZMe=1e-7*-112,$Me=1e-7*-80,GT=new J(0,0,Yn.TAI);function QMe(e,t){Cne(e,GT);let i=(GT.dayNumber-IO.dayNumber+(GT.secondsOfDay-IO.secondsOfDay)/Xn.SECONDS_PER_DAY)/(10*Xn.DAYS_PER_JULIAN_CENTURY),n=.3595362*i,r=gMe+bMe*Math.cos(sne*n)+DMe*Math.sin(sne*n)+TMe*Math.cos(ane*n)+IMe*Math.sin(ane*n)+AMe*Math.cos(cne*n)+PMe*Math.sin(cne*n)+CMe*Math.cos(lne*n)+OMe*Math.sin(lne*n)+EMe*Math.cos(une*n)+RMe*Math.sin(une*n)+SMe*Math.cos(fne*n)+MMe*Math.sin(fne*n)+wMe*Math.cos(dne*n)+LMe*Math.sin(dne*n)+vMe*Math.cos(hne*n)+NMe*Math.sin(hne*n),o=yMe+xMe*i+FMe*Math.cos(mne*n)+WMe*Math.sin(mne*n)+BMe*Math.cos(pne*n)+jMe*Math.sin(pne*n)+kMe*Math.cos(_ne*n)+qMe*Math.sin(_ne*n)+VMe*Math.cos(gne*n)+YMe*Math.sin(gne*n)+UMe*Math.cos(yne*n)+XMe*Math.sin(yne*n)+zMe*Math.cos(xne*n)+KMe*Math.sin(xne*n)+HMe*Math.cos(bne*n)+ZMe*Math.sin(bne*n)+GMe*Math.cos(Tne*n)+$Me*Math.sin(Tne*n);return Ene(r,.0167086342-.0004203654*i,469.97289*Bl*i,102.93734808*Gu+11612.3529*Bl*i,174.87317577*Gu-8679.27034*Bl*i,o,t)}function Sne(e,t){Cne(e,GT);let i=(GT.dayNumber-IO.dayNumber+(GT.secondsOfDay-IO.secondsOfDay)/Xn.SECONDS_PER_DAY)/Xn.DAYS_PER_JULIAN_CENTURY,n=i*i,r=n*i,o=r*i,a=383397.7725+.004*i,s=.055545526-16e-9*i,l=5.15668983*Gu,u=-8e-5*i+.02966*n-42e-6*r-13e-8*o,c=83.35324312*Gu,h=14643420.2669*i-38.2702*n-.045047*r+21301e-8*o,d=125.04455501*Gu,p=-6967919.3631*i+6.3602*n+.007625*r-3586e-8*o,f=218.31664563*Gu,m=1732559343.4847*i-6.391*n+.006588*r-3169e-8*o,_=297.85019547*Gu+Bl*(1602961601.209*i-6.3706*n+.006593*r-3169e-8*o),g=134.96340251*Gu+Bl*(1717915923.2178*i+31.8792*n+.051635*r-2447e-7*o),y=357.52910918*Gu+Bl*(129596581.0481*i-.5532*n+136e-6*r-1149e-8*o),v=310.17137918*Gu-Bl*(6967051.436*i+6.2068*n+.007618*r-3219e-8*o),b=2*_,A=4*_,T=6*_,E=2*g,C=3*g,x=4*g,S=2*(93.27209062*Gu+Bl*(1739527262.8478*i-12.7512*n-.001037*r+417e-8*o));a+=3400.4*Math.cos(b)-635.6*Math.cos(b-g)-235.6*Math.cos(g)+218.1*Math.cos(b-y)+181*Math.cos(b+g),s+=.014216*Math.cos(b-g)+.008551*Math.cos(b-E)-.001383*Math.cos(g)+.001356*Math.cos(b+g)-.001147*Math.cos(A-C)-914e-6*Math.cos(A-E)+869e-6*Math.cos(b-y-g)-627e-6*Math.cos(b)-394e-6*Math.cos(A-x)+282e-6*Math.cos(b-y-E)-279e-6*Math.cos(_-g)-236e-6*Math.cos(E)+231e-6*Math.cos(A)+229e-6*Math.cos(T-x)-201e-6*Math.cos(E-S),u+=486.26*Math.cos(b-S)-40.13*Math.cos(b)+37.51*Math.cos(S)+25.73*Math.cos(E-S)+19.97*Math.cos(b-y-S),h+=-55609*Math.sin(b-g)-34711*Math.sin(b-E)-9792*Math.sin(g)+9385*Math.sin(A-C)+7505*Math.sin(A-E)+5318*Math.sin(b+g)+3484*Math.sin(A-x)-3417*Math.sin(b-y-g)-2530*Math.sin(T-x)-2376*Math.sin(b)-2075*Math.sin(b-C)-1883*Math.sin(E)-1736*Math.sin(T-5*g)+1626*Math.sin(y)-1370*Math.sin(T-C),p+=-5392*Math.sin(b-S)-540*Math.sin(y)-441*Math.sin(b)+423*Math.sin(S)-288*Math.sin(E-S),m+=-3332.9*Math.sin(b)+1197.4*Math.sin(b-g)-662.5*Math.sin(y)+396.3*Math.sin(g)-218*Math.sin(b-y);let w=2*v,I=3*v;u+=46.997*Math.cos(v)*i-.614*Math.cos(b-S+v)*i+.614*Math.cos(b-S-v)*i-.0297*Math.cos(w)*n-.0335*Math.cos(v)*n+.0012*Math.cos(b-S+w)*n-16e-5*Math.cos(v)*r+4e-5*Math.cos(I)*r+4e-5*Math.cos(w)*r;let P=2.116*Math.sin(v)*i-.111*Math.sin(b-S-v)*i-.0015*Math.sin(v)*n;return h+=P,m+=P,p+=-520.77*Math.sin(v)*i+13.66*Math.sin(b-S+v)*i+1.12*Math.sin(b-v)*i-1.06*Math.sin(S-v)*i+.66*Math.sin(w)*n+.371*Math.sin(v)*n-.035*Math.sin(b-S+w)*n-.015*Math.sin(b-S+v)*n+.0014*Math.sin(v)*r-.0011*Math.sin(I)*r-9e-4*Math.sin(w)*r,a*=lMe,Ene(a,s,l+u*Bl,c+h*Bl,d+p*Bl,f+m*Bl,t)}var Ane=.012300034,JMe=Ane/(Ane+1)*-1;function eLe(e,t){return t=Sne(e,t),h.multiplyByScalar(t,JMe,t)}var wne=new $(1.0000000000000002,5619723173785822e-31,4690511510146299e-34,-5154129427414611e-31,.9174820620691819,-.39777715593191376,-223970096136568e-30,.39777715593191376,.9174820620691819),jS=new h;h6.computeSunPositionInEarthInertialFrame=function(e,t){return u(e)||(e=J.now()),u(t)||(t=new h),jS=QMe(e,jS),t=h.negate(jS,t),eLe(e,jS),h.subtract(t,jS,t),$.multiplyByVector(wne,t,t),t},h6.computeMoonPositionInEarthInertialFrame=function(e,t){return u(e)||(e=J.now()),t=Sne(e,t),$.multiplyByVector(wne,t,t),t};var D0=h6;function tLe(e,t,i,n,r,o,a){let s,l=Mi.numberOfPoints(e,t,r),u=i.red,c=i.green,h=i.blue,d=i.alpha,p=n.red,f=n.green,m=n.blue,_=n.alpha;if(z.equals(i,n)){for(s=0;s<l;s++)o[a++]=z.floatToByte(u),o[a++]=z.floatToByte(c),o[a++]=z.floatToByte(h),o[a++]=z.floatToByte(d);return a}let g=(p-u)/l,y=(f-c)/l,v=(m-h)/l,b=(_-d)/l,A=a;for(s=0;s<l;s++)o[A++]=z.floatToByte(u+s*g),o[A++]=z.floatToByte(c+s*y),o[A++]=z.floatToByte(h+s*v),o[A++]=z.floatToByte(d+s*b);return A}function qS(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions,i=e.colors,n=y(e.colorsPerVertex,!1);this._positions=t,this._colors=i,this._colorsPerVertex=n,this._arcType=y(e.arcType,Yt.GEODESIC),this._granularity=y(e.granularity,P.RADIANS_PER_DEGREE),this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._workerName="createSimplePolylineGeometry";let r=1+t.length*h.packedLength;r+=u(i)?1+i.length*z.packedLength:1,this.packedLength=r+ie.packedLength+3}qS.pack=function(e,t,i){i=y(i,0);let n,r=e._positions,o=r.length;for(t[i++]=o,n=0;n<o;++n,i+=h.packedLength)h.pack(r[n],t,i);let a=e._colors;for(o=u(a)?a.length:0,t[i++]=o,n=0;n<o;++n,i+=z.packedLength)z.pack(a[n],t,i);return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,t[i++]=e._colorsPerVertex?1:0,t[i++]=e._arcType,t[i]=e._granularity,t},qS.unpack=function(e,t,i){t=y(t,0);let n,r=e[t++],o=new Array(r);for(n=0;n<r;++n,t+=h.packedLength)o[n]=h.unpack(e,t);r=e[t++];let a=r>0?new Array(r):void 0;for(n=0;n<r;++n,t+=z.packedLength)a[n]=z.unpack(e,t);let s=ie.unpack(e,t);t+=ie.packedLength;let l=1===e[t++],c=e[t++],d=e[t];return u(i)?(i._positions=o,i._colors=a,i._ellipsoid=s,i._colorsPerVertex=l,i._arcType=c,i._granularity=d,i):new qS({positions:o,colors:a,ellipsoid:s,colorsPerVertex:l,arcType:c,granularity:d})};var PO=new Array(2),OO=new Array(2),nLe={positions:PO,height:OO,ellipsoid:void 0,minDistance:void 0,granularity:void 0};qS.createGeometry=function(e){let t,i,n,r,o,a=e._positions,s=e._colors,l=e._colorsPerVertex,c=e._arcType,d=e._granularity,p=e._ellipsoid,f=P.chordLength(d,p.maximumRadius),m=u(s)&&!l,_=a.length,g=0;if(c===Yt.GEODESIC||c===Yt.RHUMB){let e,n,l;c===Yt.GEODESIC?(e=P.chordLength(d,p.maximumRadius),n=Mi.numberOfPoints,l=Mi.generateArc):(e=d,n=Mi.numberOfPointsRhumbLine,l=Mi.generateRhumbArc);let h=Mi.extractHeights(a,p),y=nLe;if(c===Yt.GEODESIC?y.minDistance=f:y.granularity=d,y.ellipsoid=p,m){let c=0;for(t=0;t<_-1;t++)c+=n(a[t],a[t+1],e)+1;i=new Float64Array(3*c),r=new Uint8Array(4*c),y.positions=PO,y.height=OO;let d=0;for(t=0;t<_-1;++t){PO[0]=a[t],PO[1]=a[t+1],OO[0]=h[t],OO[1]=h[t+1];let e=l(y);if(u(s)){let i=e.length/3;o=s[t];for(let e=0;e<i;++e)r[d++]=z.floatToByte(o.red),r[d++]=z.floatToByte(o.green),r[d++]=z.floatToByte(o.blue),r[d++]=z.floatToByte(o.alpha)}i.set(e,g),g+=e.length}}else if(y.positions=a,y.height=h,i=new Float64Array(l(y)),u(s)){for(r=new Uint8Array(i.length/3*4),t=0;t<_-1;++t){g=tLe(a[t],a[t+1],s[t],s[t+1],f,r,g)}let e=s[_-1];r[g++]=z.floatToByte(e.red),r[g++]=z.floatToByte(e.green),r[g++]=z.floatToByte(e.blue),r[g++]=z.floatToByte(e.alpha)}}else{n=m?2*_-2:_,i=new Float64Array(3*n),r=u(s)?new Uint8Array(4*n):void 0;let e=0,l=0;for(t=0;t<_;++t){let n=a[t];if(m&&t>0&&(h.pack(n,i,e),e+=3,o=s[t-1],r[l++]=z.floatToByte(o.red),r[l++]=z.floatToByte(o.green),r[l++]=z.floatToByte(o.blue),r[l++]=z.floatToByte(o.alpha)),m&&t===_-1)break;h.pack(n,i,e),e+=3,u(s)&&(o=s[t],r[l++]=z.floatToByte(o.red),r[l++]=z.floatToByte(o.green),r[l++]=z.floatToByte(o.blue),r[l++]=z.floatToByte(o.alpha))}}let y=new hn;y.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:i}),u(s)&&(y.color=new Se({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0})),n=i.length/3;let v=2*(n-1),b=ke.createTypedArray(n,v),A=0;for(t=0;t<n-1;++t)b[A++]=t,b[A++]=t+1;return new ct({attributes:y,indices:b,primitiveType:Ne.LINES,boundingSphere:se.fromPoints(a)})};var vne=qS;function WT(e){let t=y(e.radius,1),i={radii:new h(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,vertexFormat:e.vertexFormat};this._ellipsoidGeometry=new Ms(i),this._workerName="createSphereGeometry"}WT.packedLength=Ms.packedLength,WT.pack=function(e,t,i){return Ms.pack(e._ellipsoidGeometry,t,i)};var iLe=new Ms,Y_={radius:void 0,radii:new h,vertexFormat:new Pe,stackPartitions:void 0,slicePartitions:void 0};WT.unpack=function(e,t,i){let n=Ms.unpack(e,t,iLe);return Y_.vertexFormat=Pe.clone(n._vertexFormat,Y_.vertexFormat),Y_.stackPartitions=n._stackPartitions,Y_.slicePartitions=n._slicePartitions,u(i)?(h.clone(n._radii,Y_.radii),i._ellipsoidGeometry=new Ms(Y_),i):(Y_.radius=n._radii.x,new WT(Y_))},WT.createGeometry=function(e){return Ms.createGeometry(e._ellipsoidGeometry)};var Dne=WT;function jT(e){let t=y(e.radius,1),i={radii:new h(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,subdivisions:e.subdivisions};this._ellipsoidGeometry=new Fu(i),this._workerName="createSphereOutlineGeometry"}jT.packedLength=Fu.packedLength,jT.pack=function(e,t,i){return Fu.pack(e._ellipsoidGeometry,t,i)};var oLe=new Fu,I0={radius:void 0,radii:new h,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};jT.unpack=function(e,t,i){let n=Fu.unpack(e,t,oLe);return I0.stackPartitions=n._stackPartitions,I0.slicePartitions=n._slicePartitions,I0.subdivisions=n._subdivisions,u(i)?(h.clone(n._radii,I0.radii),i._ellipsoidGeometry=new Fu(I0),i):(I0.radius=n._radii.x,new jT(I0))},jT.createGeometry=function(e){return Fu.createGeometry(e._ellipsoidGeometry)};var X_=jT;function Ra(e,t,i){this.clock=y(e,0),this.cone=y(t,0),this.magnitude=y(i,1)}Ra.fromCartesian3=function(e,t){let i=e.x,n=e.y,r=e.z,o=i*i+n*n;return u(t)||(t=new Ra),t.clock=Math.atan2(n,i),t.cone=Math.atan2(Math.sqrt(o),r),t.magnitude=Math.sqrt(o+r*r),t},Ra.clone=function(e,t){if(u(e))return u(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new Ra(e.clock,e.cone,e.magnitude)},Ra.normalize=function(e,t){return u(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new Ra(e.clock,e.cone,1)},Ra.equals=function(e,t){return e===t||u(e)&&u(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude},Ra.equalsEpsilon=function(e,t,i){return i=y(i,0),e===t||u(e)&&u(t)&&Math.abs(e.clock-t.clock)<=i&&Math.abs(e.cone-t.cone)<=i&&Math.abs(e.magnitude-t.magnitude)<=i},Ra.prototype.equals=function(e){return Ra.equals(this,e)},Ra.prototype.clone=function(e){return Ra.clone(this,e)},Ra.prototype.equalsEpsilon=function(e,t){return Ra.equalsEpsilon(this,e,t)},Ra.prototype.toString=function(){return`(${this.clock}, ${this.cone}, ${this.magnitude})`};var RO=Ra;function qT(e){let t=(e=y(e,y.EMPTY_OBJECT)).points,i=e.times;this._times=i,this._points=t,this._pointType=eo.getPointType(t[0]),this._lastTimeIndex=0}Object.defineProperties(qT.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),qT.prototype.findTimeInterval=eo.prototype.findTimeInterval,qT.prototype.wrapTime=eo.prototype.wrapTime,qT.prototype.clampTime=eo.prototype.clampTime,qT.prototype.evaluate=function(e,t){let i=this.points;this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex);let n=this._lastTimeIndex,r=this._pointType;return r===Number?i[n]:(u(t)||(t=new r),r.clone(i[n],t))};var MO=qT;function rLe(e,t){let i=[],n=e.length,r=0;for(;r<n;){let o=Math.ceil((n-r)/t--);i.push(e.slice(r,r+o)),r+=o}return i}var LO=rLe,sLe={WEST:0,NORTH:1,EAST:2,SOUTH:3,NORTHWEST:4,NORTHEAST:5,SOUTHWEST:6,SOUTHEAST:7},pn=sLe;function K_(e){}Object.defineProperties(K_.prototype,{ellipsoid:{get:de.throwInstantiationError},rectangle:{get:de.throwInstantiationError},projection:{get:de.throwInstantiationError}}),K_.prototype.getNumberOfXTilesAtLevel=de.throwInstantiationError,K_.prototype.getNumberOfYTilesAtLevel=de.throwInstantiationError,K_.prototype.rectangleToNativeRectangle=de.throwInstantiationError,K_.prototype.tileXYToNativeRectangle=de.throwInstantiationError,K_.prototype.tileXYToRectangle=de.throwInstantiationError,K_.prototype.positionToTileXY=de.throwInstantiationError;var Ine=K_;function _6(e,t){return J.compare(e.start,t.start)}function gr(e){if(this._intervals=[],this._changedEvent=new pe,u(e)){let t=e.length;for(let i=0;i<t;i++)this.addInterval(e[i])}}Object.defineProperties(gr.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){let e=this._intervals;return 0===e.length?void 0:e[0].start}},isStartIncluded:{get:function(){let e=this._intervals;return 0!==e.length&&e[0].isStartIncluded}},stop:{get:function(){let e=this._intervals,t=e.length;return 0===t?void 0:e[t-1].stop}},isStopIncluded:{get:function(){let e=this._intervals,t=e.length;return 0!==t&&e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return 0===this._intervals.length}}}),gr.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof gr))return!1;let i=this._intervals,n=e._intervals,r=i.length;if(r!==n.length)return!1;for(let e=0;e<r;e++)if(!Cn.equals(i[e],n[e],t))return!1;return!0},gr.prototype.get=function(e){return this._intervals[e]},gr.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))},gr.prototype.findIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t]:void 0},gr.prototype.findDataForIntervalContainingDate=function(e){let t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0},gr.prototype.contains=function(e){return this.indexOf(e)>=0};var m6=new Cn;gr.prototype.indexOf=function(e){let t=this._intervals;m6.start=e,m6.stop=e;let i=Eo(t,m6,_6);return i>=0?t[i].isStartIncluded?i:i>0&&t[i-1].stop.equals(e)&&t[i-1].isStopIncluded?i-1:~i:(i=~i,i>0&&i-1<t.length&&Cn.contains(t[i-1],e)?i-1:~i)},gr.prototype.findInterval=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).start,i=e.stop,n=e.isStartIncluded,r=e.isStopIncluded,o=this._intervals;for(let e=0,a=o.length;e<a;e++){let a=o[e];if((!u(t)||a.start.equals(t))&&(!u(i)||a.stop.equals(i))&&(!u(n)||a.isStartIncluded===n)&&(!u(r)||a.isStopIncluded===r))return o[e]}},gr.prototype.addInterval=function(e,t){if(e.isEmpty)return;let i=this._intervals;if(0===i.length||J.greaterThan(e.start,i[i.length-1].stop))return i.push(e),void this._changedEvent.raiseEvent(this);let n,r=Eo(i,e,_6);for(r<0?r=~r:r>0&&e.isStartIncluded&&i[r-1].isStartIncluded&&i[r-1].start.equals(e.start)?--r:r<i.length&&!e.isStartIncluded&&i[r].isStartIncluded&&i[r].start.equals(e.start)&&++r,r>0&&(n=J.compare(i[r-1].stop,e.start),(n>0||0===n&&(i[r-1].isStopIncluded||e.isStartIncluded))&&((u(t)?t(i[r-1].data,e.data):i[r-1].data===e.data)?(e=J.greaterThan(e.stop,i[r-1].stop)?new Cn({start:i[r-1].start,stop:e.stop,isStartIncluded:i[r-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):new Cn({start:i[r-1].start,stop:i[r-1].stop,isStartIncluded:i[r-1].isStartIncluded,isStopIncluded:i[r-1].isStopIncluded||e.stop.equals(i[r-1].stop)&&e.isStopIncluded,data:e.data}),i.splice(r-1,1),--r):(n=J.compare(i[r-1].stop,e.stop),(n>0||0===n&&i[r-1].isStopIncluded&&!e.isStopIncluded)&&i.splice(r,0,new Cn({start:e.stop,stop:i[r-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:i[r-1].isStopIncluded,data:i[r-1].data})),i[r-1]=new Cn({start:i[r-1].start,stop:e.start,isStartIncluded:i[r-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:i[r-1].data}))));r<i.length&&(n=J.compare(e.stop,i[r].start),n>0||0===n&&(e.isStopIncluded||i[r].isStartIncluded));)if(u(t)?t(i[r].data,e.data):i[r].data===e.data)e=new Cn({start:e.start,stop:J.greaterThan(i[r].stop,e.stop)?i[r].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:J.greaterThan(i[r].stop,e.stop)?i[r].isStopIncluded:e.isStopIncluded,data:e.data}),i.splice(r,1);else{if(i[r]=new Cn({start:e.stop,stop:i[r].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:i[r].isStopIncluded,data:i[r].data}),!i[r].isEmpty)break;i.splice(r,1)}i.splice(r,0,e),this._changedEvent.raiseEvent(this)},gr.prototype.removeInterval=function(e){if(e.isEmpty)return!1;let t=this._intervals,i=Eo(t,e,_6);i<0&&(i=~i);let n=!1;for(i>0&&(J.greaterThan(t[i-1].stop,e.start)||t[i-1].stop.equals(e.start)&&t[i-1].isStopIncluded&&e.isStartIncluded)&&(n=!0,(J.greaterThan(t[i-1].stop,e.stop)||t[i-1].isStopIncluded&&!e.isStopIncluded&&t[i-1].stop.equals(e.stop))&&t.splice(i,0,new Cn({start:e.stop,stop:t[i-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[i-1].isStopIncluded,data:t[i-1].data})),t[i-1]=new Cn({start:t[i-1].start,stop:e.start,isStartIncluded:t[i-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:t[i-1].data})),i<t.length&&!e.isStartIncluded&&t[i].isStartIncluded&&e.start.equals(t[i].start)&&(n=!0,t.splice(i,0,new Cn({start:t[i].start,stop:t[i].start,isStartIncluded:!0,isStopIncluded:!0,data:t[i].data})),++i);i<t.length&&J.greaterThan(e.stop,t[i].stop);)n=!0,t.splice(i,1);return i<t.length&&e.stop.equals(t[i].stop)&&(n=!0,!e.isStopIncluded&&t[i].isStopIncluded?i+1<t.length&&t[i+1].start.equals(e.stop)&&t[i].data===t[i+1].data?(t.splice(i,1),t[i]=new Cn({start:t[i].start,stop:t[i].stop,isStartIncluded:!0,isStopIncluded:t[i].isStopIncluded,data:t[i].data})):t[i]=new Cn({start:e.stop,stop:e.stop,isStartIncluded:!0,isStopIncluded:!0,data:t[i].data}):t.splice(i,1)),i<t.length&&(J.greaterThan(e.stop,t[i].start)||e.stop.equals(t[i].start)&&e.isStopIncluded&&t[i].isStartIncluded)&&(n=!0,t[i]=new Cn({start:e.stop,stop:t[i].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[i].isStopIncluded,data:t[i].data})),n&&this._changedEvent.raiseEvent(this),n},gr.prototype.intersect=function(e,t,i){let n=new gr,r=0,o=0,a=this._intervals,s=e._intervals;for(;r<a.length&&o<s.length;){let e=a[r],l=s[o];if(J.lessThan(e.stop,l.start))++r;else if(J.lessThan(l.stop,e.start))++o;else{if(u(i)||u(t)&&t(e.data,l.data)||!u(t)&&l.data===e.data){let r=Cn.intersect(e,l,new Cn,i);r.isEmpty||n.addInterval(r,t)}J.lessThan(e.stop,l.stop)||e.stop.equals(l.stop)&&!e.isStopIncluded&&l.isStopIncluded?++r:++o}}return n},gr.fromJulianDateArray=function(e,t){u(t)||(t=new gr);let i,n=e.julianDates,r=n.length,o=e.dataCallback,a=y(e.isStartIncluded,!0),s=y(e.isStopIncluded,!0),l=y(e.leadingInterval,!1),c=y(e.trailingInterval,!1),h=0;l&&(++h,i=new Cn({start:ze.MINIMUM_VALUE,stop:n[0],isStartIncluded:!0,isStopIncluded:!a}),i.data=u(o)?o(i,t.length):t.length,t.addInterval(i));for(let e=0;e<r-1;++e){let l=n[e],c=n[e+1];i=new Cn({start:l,stop:c,isStartIncluded:t.length!==h||a,isStopIncluded:e===r-2&&s}),i.data=u(o)?o(i,t.length):t.length,t.addInterval(i),l=c}return c&&(i=new Cn({start:n[r-1],stop:ze.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0}),i.data=u(o)?o(i,t.length):t.length,t.addInterval(i)),t};var Ma=new o_,YS=[0,31,28,31,30,31,30,31,31,30,31,30,31];function p6(e,t,i){u(i)||(i=new J),J.toGregorianDate(e,Ma);let n=Ma.millisecond+t.millisecond,r=Ma.second+t.second,o=Ma.minute+t.minute,a=Ma.hour+t.hour,s=Ma.day+t.day,l=Ma.month+t.month,c=Ma.year+t.year;for(n>=1e3&&(r+=Math.floor(n/1e3),n%=1e3),r>=60&&(o+=Math.floor(r/60),r%=60),o>=60&&(a+=Math.floor(o/60),o%=60),a>=24&&(s+=Math.floor(a/24),a%=24),YS[2]=r_(c)?29:28;s>YS[l]||l>=13;)s>YS[l]&&(s-=YS[l],++l),l>=13&&(--l,c+=Math.floor(l/12),l%=12,++l),YS[2]=r_(c)?29:28;return Ma.millisecond=n,Ma.second=r,Ma.minute=o,Ma.hour=a,Ma.day=s,Ma.month=l,Ma.year=c,J.fromGregorianDate(Ma,i)}var aLe=new J,cLe=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function Pne(e,t){if(!u(e)||0===e.length)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,t.millisecond=0,"P"===e[0]){let i=e.match(cLe);if(!u(i))return!1;if(u(i[1])&&(t.year=Number(i[1].replace(",","."))),u(i[2])&&(t.month=Number(i[2].replace(",","."))),u(i[3])&&(t.day=7*Number(i[3].replace(",","."))),u(i[4])&&(t.day+=Number(i[4].replace(",","."))),u(i[5])&&(t.hour=Number(i[5].replace(",","."))),u(i[6])&&(t.minute=Number(i[6].replace(",","."))),u(i[7])){let e=Number(i[7].replace(",","."));t.second=Math.floor(e),t.millisecond=e%1*1e3}}else"Z"!==e[e.length-1]&&(e+="Z"),J.toGregorianDate(J.fromIso8601(e,aLe),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var XS=new o_;gr.fromIso8601=function(e,t){let i=e.iso8601.split("/"),n=J.fromIso8601(i[0]),r=J.fromIso8601(i[1]),o=[];if(Pne(i[2],XS)){let e=J.clone(n);for(o.push(e);J.compare(e,r)<0;)e=p6(e,XS),J.compare(r,e)<=0&&J.clone(r,e),o.push(e)}else o.push(n,r);return gr.fromJulianDateArray({julianDates:o,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},gr.fromIso8601DateArray=function(e,t){return gr.fromJulianDateArray({julianDates:e.iso8601Dates.map((function(e){return J.fromIso8601(e)})),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},gr.fromIso8601DurationArray=function(e,t){let i,n,r=e.epoch,o=e.iso8601Durations,a=y(e.relativeToPrevious,!1),s=[],l=o.length;for(let e=0;e<l;++e)(Pne(o[e],XS)||0===e)&&(i=a&&u(n)?p6(n,XS):p6(r,XS),s.push(i),n=i);return gr.fromJulianDateArray({julianDates:s,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};var Mr=gr,lLe=new h(1,1,1),uLe=h.ZERO,fLe=Le.IDENTITY;function One(e,t,i){this.translation=h.clone(y(e,uLe)),this.rotation=Le.clone(y(t,fLe)),this.scale=h.clone(y(i,lLe))}One.prototype.equals=function(e){return this===e||u(e)&&h.equals(this.translation,e.translation)&&Le.equals(this.rotation,e.rotation)&&h.equals(this.scale,e.scale)};var P0=One;function O0(e){e=y(e,y.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this._lastPlaybackRate=void 0,this.clock=e.clock,this.element=e.element,this.epoch=y(e.epoch,ze.MINIMUM_VALUE),this.tolerance=y(e.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}function dLe(e){return function(){e._seeking=!1,e._firstTickAfterSeek=!0}}Object.defineProperties(O0.prototype,{clock:{get:function(){return this._clock},set:function(e){let t=this._clock;t!==e&&(u(t)&&(this._clockSubscription(),this._clockSubscription=void 0),u(e)&&(this._clockSubscription=e.onTick.addEventListener(O0.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){let t=this._element;t!==e&&(u(t)&&t.removeEventListener("seeked",this._seekFunction,!1),u(e)&&(this._seeking=!1,this._seekFunction=dLe(this),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}}),O0.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,le(this)},O0.prototype.isDestroyed=function(){return!1},O0.prototype._trySetPlaybackRate=function(e){if(this._lastPlaybackRate===e.multiplier)return;let t=this._element;try{t.playbackRate=e.multiplier}catch{t.playbackRate=0}this._lastPlaybackRate=e.multiplier},O0.prototype._onTick=function(e){let t=this._element;if(!u(t)||t.readyState<2)return;let i=t.paused,n=e.shouldAnimate;if(n===i&&(n?t.play():t.pause()),this._seeking||this._firstTickAfterSeek)return void(this._firstTickAfterSeek=!1);this._trySetPlaybackRate(e);let r,o=e.currentTime,a=y(this.epoch,ze.MINIMUM_VALUE),s=J.secondsDifference(o,a),l=t.duration,c=t.currentTime;t.loop?(s%=l,s<0&&(s=l-s),r=s):r=s>l?l:s<0?0:s;let h=n?y(this.tolerance,1):.001;Math.abs(r-c)>h&&(this._seeking=!0,t.currentTime=r)};var Rne=O0;function hLe(e,t){this.rectangle=e,this.maxLevel=t}function Mne(e){this.ellipsoid=y(e.ellipsoid,ie.WGS84),this.tilingScheme=void 0,this.heightmapWidth=void 0,this.heightmapHeight=void 0,this.levelZeroMaximumGeometricError=void 0,this.rectangles=[]}function mLe(e,t){let i=t.getElementsByTagName("SRS")[0].textContent;if("EPSG:4326"!==i)throw new ue(`SRS ${i} is not supported`);e.tilingScheme=new Ui({ellipsoid:e.ellipsoid});let n=t.getElementsByTagName("TileFormat")[0];e.heightmapWidth=parseInt(n.getAttribute("width"),10),e.heightmapHeight=parseInt(n.getAttribute("height"),10),e.levelZeroMaximumGeometricError=Ur.getEstimatedLevelZeroGeometricErrorForAHeightmap(e.ellipsoid,Math.min(e.heightmapWidth,e.heightmapHeight),e.tilingScheme.getNumberOfXTilesAtLevel(0));let r=t.getElementsByTagName("DataExtent");for(let t=0;t<r.length;++t){let i=r[t],n=P.toRadians(parseFloat(i.getAttribute("minx"))),o=P.toRadians(parseFloat(i.getAttribute("miny"))),a=P.toRadians(parseFloat(i.getAttribute("maxx"))),s=P.toRadians(parseFloat(i.getAttribute("maxy"))),l=parseInt(i.getAttribute("maxlevel"),10);e.rectangles.push(new hLe(new ce(n,o,a,s),l))}}function pLe(e,t,i){let n=`An error occurred while accessing ${e.url}`;throw u(t)&&u(t.message)&&(n=`${n}: ${t.message}`),bo.reportError(void 0,i,u(i)?i._errorEvent:void 0,n),new ue(n)}async function _Le(e,t,i){try{mLe(e,await t.fetchXML())}catch(e){pLe(t,e,i)}}function Z_(e){e=y(e,y.EMPTY_OBJECT),this._errorEvent=new pe,this._terrainDataStructure={heightScale:.001,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:16777215};let t=e.credit;"string"==typeof t&&(t=new xt(t)),this._credit=t,this._tilingScheme=void 0,this._rectangles=[]}Mne.prototype.build=function(e){e._tilingScheme=this.tilingScheme,e._heightmapWidth=this.heightmapWidth,e._heightmapHeight=this.heightmapHeight,e._levelZeroMaximumGeometricError=this.levelZeroMaximumGeometricError,e._rectangles=this.rectangles},Object.defineProperties(Z_.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}}),Z_.fromUrl=async function(e,t){let i=new Mne(t=y(t,y.EMPTY_OBJECT)),n=ve.createIfNeeded(e);await _Le(i,n);let r=new Z_(t);return i.build(r),r._resource=n,r},Z_.prototype.requestTileGeometry=function(e,t,i,n){let r=this._tilingScheme.getNumberOfYTilesAtLevel(i),o=this._resource.getDerivedResource({url:`${i}/${e}/${r-t-1}.tif`,queryParameters:{cesium:!0},request:n}).fetchImage({preferImageBitmap:!0});if(!u(o))return;let a=this;return Promise.resolve(o).then((function(n){return new va({buffer:Qd(n),width:a._heightmapWidth,height:a._heightmapHeight,childTileMask:gLe(a,e,t,i),structure:a._terrainDataStructure})}))},Z_.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};var Lne=new ce;function gLe(e,t,i,n){let r=e._tilingScheme,o=e._rectangles,a=r.tileXYToRectangle(t,i,n),s=0;for(let e=0;e<o.length&&15!==s;++e){let l=o[e];if(l.maxLevel<=n)continue;let c=l.rectangle,h=ce.intersection(c,a,Lne);u(h)&&(NO(r,c,2*t,2*i,n+1)&&(s|=4),NO(r,c,2*t+1,2*i,n+1)&&(s|=8),NO(r,c,2*t,2*i+1,n+1)&&(s|=1),NO(r,c,2*t+1,2*i+1,n+1)&&(s|=2))}return s}function NO(e,t,i,n,r){let o=e.tileXYToRectangle(i,n,r);return u(ce.intersection(o,t,Lne))}Z_.prototype.getTileDataAvailable=function(e,t,i){},Z_.prototype.loadTileDataAvailability=function(e,t,i){};var Nne=Z_,yLe={VK_FORMAT_UNDEFINED:0,VK_FORMAT_R4G4_UNORM_PACK8:1,VK_FORMAT_R4G4B4A4_UNORM_PACK16:2,VK_FORMAT_B4G4R4A4_UNORM_PACK16:3,VK_FORMAT_R5G6B5_UNORM_PACK16:4,VK_FORMAT_B5G6R5_UNORM_PACK16:5,VK_FORMAT_R5G5B5A1_UNORM_PACK16:6,VK_FORMAT_B5G5R5A1_UNORM_PACK16:7,VK_FORMAT_A1R5G5B5_UNORM_PACK16:8,VK_FORMAT_R8_UNORM:9,VK_FORMAT_R8_SNORM:10,VK_FORMAT_R8_USCALED:11,VK_FORMAT_R8_SSCALED:12,VK_FORMAT_R8_UINT:13,VK_FORMAT_R8_SINT:14,VK_FORMAT_R8_SRGB:15,VK_FORMAT_R8G8_UNORM:16,VK_FORMAT_R8G8_SNORM:17,VK_FORMAT_R8G8_USCALED:18,VK_FORMAT_R8G8_SSCALED:19,VK_FORMAT_R8G8_UINT:20,VK_FORMAT_R8G8_SINT:21,VK_FORMAT_R8G8_SRGB:22,VK_FORMAT_R8G8B8_UNORM:23,VK_FORMAT_R8G8B8_SNORM:24,VK_FORMAT_R8G8B8_USCALED:25,VK_FORMAT_R8G8B8_SSCALED:26,VK_FORMAT_R8G8B8_UINT:27,VK_FORMAT_R8G8B8_SINT:28,VK_FORMAT_R8G8B8_SRGB:29,VK_FORMAT_B8G8R8_UNORM:30,VK_FORMAT_B8G8R8_SNORM:31,VK_FORMAT_B8G8R8_USCALED:32,VK_FORMAT_B8G8R8_SSCALED:33,VK_FORMAT_B8G8R8_UINT:34,VK_FORMAT_B8G8R8_SINT:35,VK_FORMAT_B8G8R8_SRGB:36,VK_FORMAT_R8G8B8A8_UNORM:37,VK_FORMAT_R8G8B8A8_SNORM:38,VK_FORMAT_R8G8B8A8_USCALED:39,VK_FORMAT_R8G8B8A8_SSCALED:40,VK_FORMAT_R8G8B8A8_UINT:41,VK_FORMAT_R8G8B8A8_SINT:42,VK_FORMAT_R8G8B8A8_SRGB:43,VK_FORMAT_B8G8R8A8_UNORM:44,VK_FORMAT_B8G8R8A8_SNORM:45,VK_FORMAT_B8G8R8A8_USCALED:46,VK_FORMAT_B8G8R8A8_SSCALED:47,VK_FORMAT_B8G8R8A8_UINT:48,VK_FORMAT_B8G8R8A8_SINT:49,VK_FORMAT_B8G8R8A8_SRGB:50,VK_FORMAT_A8B8G8R8_UNORM_PACK32:51,VK_FORMAT_A8B8G8R8_SNORM_PACK32:52,VK_FORMAT_A8B8G8R8_USCALED_PACK32:53,VK_FORMAT_A8B8G8R8_SSCALED_PACK32:54,VK_FORMAT_A8B8G8R8_UINT_PACK32:55,VK_FORMAT_A8B8G8R8_SINT_PACK32:56,VK_FORMAT_A8B8G8R8_SRGB_PACK32:57,VK_FORMAT_A2R10G10B10_UNORM_PACK32:58,VK_FORMAT_A2R10G10B10_SNORM_PACK32:59,VK_FORMAT_A2R10G10B10_USCALED_PACK32:60,VK_FORMAT_A2R10G10B10_SSCALED_PACK32:61,VK_FORMAT_A2R10G10B10_UINT_PACK32:62,VK_FORMAT_A2R10G10B10_SINT_PACK32:63,VK_FORMAT_A2B10G10R10_UNORM_PACK32:64,VK_FORMAT_A2B10G10R10_SNORM_PACK32:65,VK_FORMAT_A2B10G10R10_USCALED_PACK32:66,VK_FORMAT_A2B10G10R10_SSCALED_PACK32:67,VK_FORMAT_A2B10G10R10_UINT_PACK32:68,VK_FORMAT_A2B10G10R10_SINT_PACK32:69,VK_FORMAT_R16_UNORM:70,VK_FORMAT_R16_SNORM:71,VK_FORMAT_R16_USCALED:72,VK_FORMAT_R16_SSCALED:73,VK_FORMAT_R16_UINT:74,VK_FORMAT_R16_SINT:75,VK_FORMAT_R16_SFLOAT:76,VK_FORMAT_R16G16_UNORM:77,VK_FORMAT_R16G16_SNORM:78,VK_FORMAT_R16G16_USCALED:79,VK_FORMAT_R16G16_SSCALED:80,VK_FORMAT_R16G16_UINT:81,VK_FORMAT_R16G16_SINT:82,VK_FORMAT_R16G16_SFLOAT:83,VK_FORMAT_R16G16B16_UNORM:84,VK_FORMAT_R16G16B16_SNORM:85,VK_FORMAT_R16G16B16_USCALED:86,VK_FORMAT_R16G16B16_SSCALED:87,VK_FORMAT_R16G16B16_UINT:88,VK_FORMAT_R16G16B16_SINT:89,VK_FORMAT_R16G16B16_SFLOAT:90,VK_FORMAT_R16G16B16A16_UNORM:91,VK_FORMAT_R16G16B16A16_SNORM:92,VK_FORMAT_R16G16B16A16_USCALED:93,VK_FORMAT_R16G16B16A16_SSCALED:94,VK_FORMAT_R16G16B16A16_UINT:95,VK_FORMAT_R16G16B16A16_SINT:96,VK_FORMAT_R16G16B16A16_SFLOAT:97,VK_FORMAT_R32_UINT:98,VK_FORMAT_R32_SINT:99,VK_FORMAT_R32_SFLOAT:100,VK_FORMAT_R32G32_UINT:101,VK_FORMAT_R32G32_SINT:102,VK_FORMAT_R32G32_SFLOAT:103,VK_FORMAT_R32G32B32_UINT:104,VK_FORMAT_R32G32B32_SINT:105,VK_FORMAT_R32G32B32_SFLOAT:106,VK_FORMAT_R32G32B32A32_UINT:107,VK_FORMAT_R32G32B32A32_SINT:108,VK_FORMAT_R32G32B32A32_SFLOAT:109,VK_FORMAT_R64_UINT:110,VK_FORMAT_R64_SINT:111,VK_FORMAT_R64_SFLOAT:112,VK_FORMAT_R64G64_UINT:113,VK_FORMAT_R64G64_SINT:114,VK_FORMAT_R64G64_SFLOAT:115,VK_FORMAT_R64G64B64_UINT:116,VK_FORMAT_R64G64B64_SINT:117,VK_FORMAT_R64G64B64_SFLOAT:118,VK_FORMAT_R64G64B64A64_UINT:119,VK_FORMAT_R64G64B64A64_SINT:120,VK_FORMAT_R64G64B64A64_SFLOAT:121,VK_FORMAT_B10G11R11_UFLOAT_PACK32:122,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:123,VK_FORMAT_D16_UNORM:124,VK_FORMAT_X8_D24_UNORM_PACK32:125,VK_FORMAT_D32_SFLOAT:126,VK_FORMAT_S8_UINT:127,VK_FORMAT_D16_UNORM_S8_UINT:128,VK_FORMAT_D24_UNORM_S8_UINT:129,VK_FORMAT_D32_SFLOAT_S8_UINT:130,VK_FORMAT_BC1_RGB_UNORM_BLOCK:131,VK_FORMAT_BC1_RGB_SRGB_BLOCK:132,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:133,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:134,VK_FORMAT_BC2_UNORM_BLOCK:135,VK_FORMAT_BC2_SRGB_BLOCK:136,VK_FORMAT_BC3_UNORM_BLOCK:137,VK_FORMAT_BC3_SRGB_BLOCK:138,VK_FORMAT_BC4_UNORM_BLOCK:139,VK_FORMAT_BC4_SNORM_BLOCK:140,VK_FORMAT_BC5_UNORM_BLOCK:141,VK_FORMAT_BC5_SNORM_BLOCK:142,VK_FORMAT_BC6H_UFLOAT_BLOCK:143,VK_FORMAT_BC6H_SFLOAT_BLOCK:144,VK_FORMAT_BC7_UNORM_BLOCK:145,VK_FORMAT_BC7_SRGB_BLOCK:146,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:147,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:148,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:149,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:150,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:151,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:152,VK_FORMAT_EAC_R11_UNORM_BLOCK:153,VK_FORMAT_EAC_R11_SNORM_BLOCK:154,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:155,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:156,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:157,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:158,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:159,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:160,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:161,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:162,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:163,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:164,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:165,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:166,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:167,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:168,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:169,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:170,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:171,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:172,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:173,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:174,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:175,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:176,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:177,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:178,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:179,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:180,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:181,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:182,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:183,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:184,VK_FORMAT_G8B8G8R8_422_UNORM:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM:1000156006,VK_FORMAT_R10X6_UNORM_PACK16:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16:1000156016,VK_FORMAT_R12X4_UNORM_PACK16:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM:1000156033,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:1000054e3,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:1000054001,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:1000054002,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:1000054003,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:1000054004,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:1000054005,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:1000054006,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:1000054007,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:1000066e3,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:1000066001,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:1000066002,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:1000066003,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:1000066004,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:1000066005,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:1000066006,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:1000066007,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:1000066008,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:1000066009,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:1000066010,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:1000066011,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:1000066012,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:1000066013,VK_FORMAT_G8B8G8R8_422_UNORM_KHR:1000156e3,VK_FORMAT_B8G8R8G8_422_UNORM_KHR:1000156001,VK_FORMAT_G8_B8_R8_3PLANE_420_UNORM_KHR:1000156002,VK_FORMAT_G8_B8R8_2PLANE_420_UNORM_KHR:1000156003,VK_FORMAT_G8_B8_R8_3PLANE_422_UNORM_KHR:1000156004,VK_FORMAT_G8_B8R8_2PLANE_422_UNORM_KHR:1000156005,VK_FORMAT_G8_B8_R8_3PLANE_444_UNORM_KHR:1000156006,VK_FORMAT_R10X6_UNORM_PACK16_KHR:1000156007,VK_FORMAT_R10X6G10X6_UNORM_2PACK16_KHR:1000156008,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16_KHR:1000156009,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16_KHR:1000156010,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16_KHR:1000156011,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_420_UNORM_3PACK16_KHR:1000156012,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_420_UNORM_3PACK16_KHR:1000156013,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_422_UNORM_3PACK16_KHR:1000156014,VK_FORMAT_G10X6_B10X6R10X6_2PLANE_422_UNORM_3PACK16_KHR:1000156015,VK_FORMAT_G10X6_B10X6_R10X6_3PLANE_444_UNORM_3PACK16_KHR:1000156016,VK_FORMAT_R12X4_UNORM_PACK16_KHR:1000156017,VK_FORMAT_R12X4G12X4_UNORM_2PACK16_KHR:1000156018,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16_KHR:1000156019,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16_KHR:1000156020,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16_KHR:1000156021,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_420_UNORM_3PACK16_KHR:1000156022,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_420_UNORM_3PACK16_KHR:1000156023,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_422_UNORM_3PACK16_KHR:1000156024,VK_FORMAT_G12X4_B12X4R12X4_2PLANE_422_UNORM_3PACK16_KHR:1000156025,VK_FORMAT_G12X4_B12X4_R12X4_3PLANE_444_UNORM_3PACK16_KHR:1000156026,VK_FORMAT_G16B16G16R16_422_UNORM_KHR:1000156027,VK_FORMAT_B16G16R16G16_422_UNORM_KHR:1000156028,VK_FORMAT_G16_B16_R16_3PLANE_420_UNORM_KHR:1000156029,VK_FORMAT_G16_B16R16_2PLANE_420_UNORM_KHR:1000156030,VK_FORMAT_G16_B16_R16_3PLANE_422_UNORM_KHR:1000156031,VK_FORMAT_G16_B16R16_2PLANE_422_UNORM_KHR:1000156032,VK_FORMAT_G16_B16_R16_3PLANE_444_UNORM_KHR:1000156033},Fne=Object.freeze(yLe),Bne={};function xLe(e,t){return P.equalsEpsilon(e.latitude,t.latitude,P.EPSILON10)&&P.equalsEpsilon(e.longitude,t.longitude,P.EPSILON10)}var bLe=new fe,TLe=new fe;function ALe(e,t,i,n){let r=(t=go(t,h.equalsEpsilon)).length;if(r<2)return;let o=u(n),a=u(i),s=new Array(r),l=new Array(r),c=new Array(r),d=t[0];s[0]=d;let p=e.cartesianToCartographic(d,bLe);a&&(p.height=i[0]),l[0]=p.height,c[0]=o?n[0]:0;let f=l[0]===c[0],m=1;for(let u=1;u<r;++u){let r=t[u],h=e.cartesianToCartographic(r,TLe);a&&(h.height=i[u]),f=f&&0===h.height,xLe(p,h)?p.height<h.height&&(l[m-1]=h.height):(s[m]=r,l[m]=h.height,c[m]=o?n[u]:0,f=f&&l[m]===c[m],fe.clone(h,p),++m)}return f||m<2?void 0:(s.length=m,l.length=m,c.length=m,{positions:s,topHeights:l,bottomHeights:c})}var CLe=new Array(2),ELe=new Array(2),SLe={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};Bne.computePositions=function(e,t,i,n,r,o){let a=ALe(e,t,i,n);if(!u(a))return;t=a.positions,i=a.topHeights,n=a.bottomHeights;let s,l,c=t.length,h=c-2,d=P.chordLength(r,e.maximumRadius),p=SLe;if(p.minDistance=d,p.ellipsoid=e,o){let e,r=0;for(e=0;e<c-1;e++)r+=Mi.numberOfPoints(t[e],t[e+1],d)+1;s=new Float64Array(3*r),l=new Float64Array(3*r);let o=CLe,a=ELe;p.positions=o,p.height=a;let u=0;for(e=0;e<c-1;e++){o[0]=t[e],o[1]=t[e+1],a[0]=i[e],a[1]=i[e+1];let r=Mi.generateArc(p);s.set(r,u),a[0]=n[e],a[1]=n[e+1],l.set(Mi.generateArc(p),u),u+=r.length}}else p.positions=t,p.height=i,s=new Float64Array(Mi.generateArc(p)),p.height=n,l=new Float64Array(Mi.generateArc(p));return{bottomPositions:l,topPositions:s,numCorners:h}};var YT=Bne,g6=new h,FO=new h,wLe=new h,kne=new h,vLe=new h,DLe=new h,ILe=new h;function R0(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions,i=e.maximumHeights,n=e.minimumHeights,r=y(e.vertexFormat,Pe.DEFAULT),o=y(e.granularity,P.RADIANS_PER_DEGREE),a=y(e.ellipsoid,ie.WGS84);this._positions=t,this._minimumHeights=n,this._maximumHeights=i,this._vertexFormat=Pe.clone(r),this._granularity=o,this._ellipsoid=ie.clone(a),this._workerName="createWallGeometry";let s=1+t.length*h.packedLength+2;u(n)&&(s+=n.length),u(i)&&(s+=i.length),this.packedLength=s+ie.packedLength+Pe.packedLength+1}R0.pack=function(e,t,i){i=y(i,0);let n,r=e._positions,o=r.length;for(t[i++]=o,n=0;n<o;++n,i+=h.packedLength)h.pack(r[n],t,i);let a=e._minimumHeights;if(o=u(a)?a.length:0,t[i++]=o,u(a))for(n=0;n<o;++n)t[i++]=a[n];let s=e._maximumHeights;if(o=u(s)?s.length:0,t[i++]=o,u(s))for(n=0;n<o;++n)t[i++]=s[n];return ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,Pe.pack(e._vertexFormat,t,i),t[i+=Pe.packedLength]=e._granularity,t};var Vne=ie.clone(ie.UNIT_SPHERE),Une=new Pe,KS={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:Vne,vertexFormat:Une,granularity:void 0};R0.unpack=function(e,t,i){t=y(t,0);let n,r,o,a=e[t++],s=new Array(a);for(n=0;n<a;++n,t+=h.packedLength)s[n]=h.unpack(e,t);if(a=e[t++],a>0)for(r=new Array(a),n=0;n<a;++n)r[n]=e[t++];if(a=e[t++],a>0)for(o=new Array(a),n=0;n<a;++n)o[n]=e[t++];let l=ie.unpack(e,t,Vne);t+=ie.packedLength;let c=Pe.unpack(e,t,Une),d=e[t+=Pe.packedLength];return u(i)?(i._positions=s,i._minimumHeights=r,i._maximumHeights=o,i._ellipsoid=ie.clone(l,i._ellipsoid),i._vertexFormat=Pe.clone(c,i._vertexFormat),i._granularity=d,i):(KS.positions=s,KS.minimumHeights=r,KS.maximumHeights=o,KS.granularity=d,new R0(KS))},R0.fromConstantHeights=function(e){let t,i,n=(e=y(e,y.EMPTY_OBJECT)).positions,r=e.minimumHeight,o=e.maximumHeight,a=u(r),s=u(o);if(a||s){let e=n.length;t=a?new Array(e):void 0,i=s?new Array(e):void 0;for(let n=0;n<e;++n)a&&(t[n]=r),s&&(i[n]=o)}return new R0({positions:n,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},R0.createGeometry=function(e){let t=e._positions,i=e._minimumHeights,n=e._maximumHeights,r=e._vertexFormat,o=e._granularity,a=e._ellipsoid,s=YT.computePositions(a,t,n,i,o,!0);if(!u(s))return;let l=s.bottomPositions,c=s.topPositions,d=s.numCorners,p=c.length,f=2*p,m=r.position?new Float64Array(f):void 0,_=r.normal?new Float32Array(f):void 0,g=r.tangent?new Float32Array(f):void 0,y=r.bitangent?new Float32Array(f):void 0,v=r.st?new Float32Array(f/3*2):void 0,b=0,A=0,T=0,E=0,C=0,x=ILe,S=DLe,w=vLe,I=!0;p/=3;let D,O=0,L=1/(p-d-1);for(D=0;D<p;++D){let e=3*D,t=h.fromArray(c,e,g6),i=h.fromArray(l,e,FO);if(r.position&&(m[b++]=i.x,m[b++]=i.y,m[b++]=i.z,m[b++]=t.x,m[b++]=t.y,m[b++]=t.z),r.st&&(v[C++]=O,v[C++]=0,v[C++]=O,v[C++]=1),r.normal||r.tangent||r.bitangent){let i=h.clone(h.ZERO,kne),n=h.subtract(t,a.geodeticSurfaceNormal(t,FO),FO);if(D+1<p&&(i=h.fromArray(c,e+3,kne)),I){let e=h.subtract(i,t,wLe),r=h.subtract(n,t,g6);x=h.normalize(h.cross(r,e,x),x),I=!1}h.equalsEpsilon(t,i,P.EPSILON10)?I=!0:(O+=L,r.tangent&&(S=h.normalize(h.subtract(i,t,S),S)),r.bitangent&&(w=h.normalize(h.cross(x,S,w),w))),r.normal&&(_[A++]=x.x,_[A++]=x.y,_[A++]=x.z,_[A++]=x.x,_[A++]=x.y,_[A++]=x.z),r.tangent&&(g[E++]=S.x,g[E++]=S.y,g[E++]=S.z,g[E++]=S.x,g[E++]=S.y,g[E++]=S.z),r.bitangent&&(y[T++]=w.x,y[T++]=w.y,y[T++]=w.z,y[T++]=w.x,y[T++]=w.y,y[T++]=w.z)}}let R=new hn;r.position&&(R.position=new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:m})),r.normal&&(R.normal=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:_})),r.tangent&&(R.tangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:g})),r.bitangent&&(R.bitangent=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:y})),r.st&&(R.st=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:v}));let N=f/3;f-=6*(d+1);let M=ke.createTypedArray(N,f),F=0;for(D=0;D<N-2;D+=2){let e=D,t=D+2,i=h.fromArray(m,3*e,g6),n=h.fromArray(m,3*t,FO);if(h.equalsEpsilon(i,n,P.EPSILON10))continue;let r=D+1,o=D+3;M[F++]=r,M[F++]=e,M[F++]=o,M[F++]=o,M[F++]=e,M[F++]=t}return new ct({attributes:R,indices:M,primitiveType:Ne.TRIANGLES,boundingSphere:new se.fromVertices(m)})};var BO=R0,zne=new h,Hne=new h;function M0(e){let t=(e=y(e,y.EMPTY_OBJECT)).positions,i=e.maximumHeights,n=e.minimumHeights,r=y(e.granularity,P.RADIANS_PER_DEGREE),o=y(e.ellipsoid,ie.WGS84);this._positions=t,this._minimumHeights=n,this._maximumHeights=i,this._granularity=r,this._ellipsoid=ie.clone(o),this._workerName="createWallOutlineGeometry";let a=1+t.length*h.packedLength+2;u(n)&&(a+=n.length),u(i)&&(a+=i.length),this.packedLength=a+ie.packedLength+1}M0.pack=function(e,t,i){i=y(i,0);let n,r=e._positions,o=r.length;for(t[i++]=o,n=0;n<o;++n,i+=h.packedLength)h.pack(r[n],t,i);let a=e._minimumHeights;if(o=u(a)?a.length:0,t[i++]=o,u(a))for(n=0;n<o;++n)t[i++]=a[n];let s=e._maximumHeights;if(o=u(s)?s.length:0,t[i++]=o,u(s))for(n=0;n<o;++n)t[i++]=s[n];return ie.pack(e._ellipsoid,t,i),t[i+=ie.packedLength]=e._granularity,t};var Gne=ie.clone(ie.UNIT_SPHERE),ZS={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:Gne,granularity:void 0};M0.unpack=function(e,t,i){t=y(t,0);let n,r,o,a=e[t++],s=new Array(a);for(n=0;n<a;++n,t+=h.packedLength)s[n]=h.unpack(e,t);if(a=e[t++],a>0)for(r=new Array(a),n=0;n<a;++n)r[n]=e[t++];if(a=e[t++],a>0)for(o=new Array(a),n=0;n<a;++n)o[n]=e[t++];let l=ie.unpack(e,t,Gne),c=e[t+=ie.packedLength];return u(i)?(i._positions=s,i._minimumHeights=r,i._maximumHeights=o,i._ellipsoid=ie.clone(l,i._ellipsoid),i._granularity=c,i):(ZS.positions=s,ZS.minimumHeights=r,ZS.maximumHeights=o,ZS.granularity=c,new M0(ZS))},M0.fromConstantHeights=function(e){let t,i,n=(e=y(e,y.EMPTY_OBJECT)).positions,r=e.minimumHeight,o=e.maximumHeight,a=u(r),s=u(o);if(a||s){let e=n.length;t=a?new Array(e):void 0,i=s?new Array(e):void 0;for(let n=0;n<e;++n)a&&(t[n]=r),s&&(i[n]=o)}return new M0({positions:n,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid})},M0.createGeometry=function(e){let t=e._positions,i=e._minimumHeights,n=e._maximumHeights,r=e._granularity,o=e._ellipsoid,a=YT.computePositions(o,t,n,i,r,!1);if(!u(a))return;let s,l=a.bottomPositions,c=a.topPositions,d=c.length,p=2*d,f=new Float64Array(p),m=0;for(d/=3,s=0;s<d;++s){let e=3*s,t=h.fromArray(c,e,zne),i=h.fromArray(l,e,Hne);f[m++]=i.x,f[m++]=i.y,f[m++]=i.z,f[m++]=t.x,f[m++]=t.y,f[m++]=t.z}let _=new hn({position:new Se({componentDatatype:X.DOUBLE,componentsPerAttribute:3,values:f})}),g=p/3;p=2*g-4+g;let y=ke.createTypedArray(g,p),v=0;for(s=0;s<g-2;s+=2){let e=s,t=s+2,i=h.fromArray(f,3*e,zne),n=h.fromArray(f,3*t,Hne);if(h.equalsEpsilon(i,n,P.EPSILON10))continue;let r=s+1,o=s+3;y[v++]=r,y[v++]=e,y[v++]=r,y[v++]=o,y[v++]=e,y[v++]=t}return y[v++]=g-2,y[v++]=g-1,new ct({attributes:_,indices:y,primitiveType:Ne.LINES,boundingSphere:new se.fromVertices(f)})};var kO=M0;function PLe(e){switch(e){case ee.FLOAT:return"float";case ee.FLOAT_VEC2:return"vec2";case ee.FLOAT_VEC3:return"vec3";case ee.FLOAT_VEC4:return"vec4";case ee.FLOAT_MAT2:return"mat2";case ee.FLOAT_MAT3:return"mat3";case ee.FLOAT_MAT4:return"mat4";case ee.SAMPLER_2D:return"sampler2D";case ee.BOOL:return"bool"}}var Wne=PLe,y6={};function OLe(e){let t=ke.createTypedArray(e,2*e),i=e,n=0;for(let e=0;e<i;e+=3)t[n++]=e,t[n++]=e+1,t[n++]=e+1,t[n++]=e+2,t[n++]=e+2,t[n++]=e;return t}function RLe(e,t){let i=t.length,n=ke.createTypedArray(e,2*i),r=0;for(let e=0;e<i;e+=3){let i=t[e],o=t[e+1],a=t[e+2];n[r++]=i,n[r++]=o,n[r++]=o,n[r++]=a,n[r++]=a,n[r++]=i}return n}function MLe(e){let t=e-2,i=2+4*t,n=ke.createTypedArray(e,i),r=0;n[r++]=0,n[r++]=1;for(let e=0;e<t;e++)n[r++]=e+1,n[r++]=e+2,n[r++]=e+2,n[r++]=e;return n}function LLe(e,t){let i=t.length-2,n=2+4*i,r=ke.createTypedArray(e,n),o=0;r[o++]=t[0],r[o++]=t[1];for(let e=0;e<i;e++){let i=t[e],n=t[e+1],a=t[e+2];r[o++]=n,r[o++]=a,r[o++]=a,r[o++]=i}return r}function NLe(e){let t=e-2,i=2+4*t,n=ke.createTypedArray(e,i),r=0;n[r++]=0,n[r++]=1;for(let e=0;e<t;e++)n[r++]=e+1,n[r++]=e+2,n[r++]=e+2,n[r++]=0;return n}function FLe(e,t){let i=t.length-2,n=2+4*i,r=ke.createTypedArray(e,n),o=0,a=t[0];r[o++]=a,r[o++]=t[1];for(let e=0;e<i;e++){let i=t[e+1],n=t[e+2];r[o++]=i,r[o++]=n,r[o++]=n,r[o++]=a}return r}y6.createWireframeIndices=function(e,t,i){let n=u(i);return e===Ne.TRIANGLES?n?RLe(t,i):OLe(t):e===Ne.TRIANGLE_STRIP?n?LLe(t,i):MLe(t):e===Ne.TRIANGLE_FAN?n?FLe(t,i):NLe(t):void 0},y6.getWireframeIndicesCount=function(e,t){return e===Ne.TRIANGLES?2*t:e===Ne.TRIANGLE_STRIP||e===Ne.TRIANGLE_FAN?2+4*(t-2):t};var $S=y6;function BLe(e,t,i){return function(){i.apply(e,arguments),t.apply(e,arguments)}}var VO=BLe,kLe={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},Ym=Object.freeze(kLe),VLe={ADD:ee.FUNC_ADD,SUBTRACT:ee.FUNC_SUBTRACT,REVERSE_SUBTRACT:ee.FUNC_REVERSE_SUBTRACT,MIN:ee.MIN,MAX:ee.MAX},La=Object.freeze(VLe),ULe={ZERO:ee.ZERO,ONE:ee.ONE,SOURCE_COLOR:ee.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:ee.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:ee.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:ee.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:ee.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:ee.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:ee.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:ee.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:ee.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:ee.ONE_MINUS_CONSTANT_COLOR,CONSTANT_ALPHA:ee.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:ee.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:ee.SRC_ALPHA_SATURATE},To=Object.freeze(ULe),zLe={DISABLED:Object.freeze({enabled:!1}),ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:La.ADD,equationAlpha:La.ADD,functionSourceRgb:To.SOURCE_ALPHA,functionSourceAlpha:To.ONE,functionDestinationRgb:To.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:To.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object.freeze({enabled:!0,equationRgb:La.ADD,equationAlpha:La.ADD,functionSourceRgb:To.ONE,functionSourceAlpha:To.ONE,functionDestinationRgb:To.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:To.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object.freeze({enabled:!0,equationRgb:La.ADD,equationAlpha:La.ADD,functionSourceRgb:To.SOURCE_ALPHA,functionSourceAlpha:To.ONE,functionDestinationRgb:To.ONE,functionDestinationAlpha:To.ONE})},ln=Object.freeze(zLe),HLe={FRONT:ee.FRONT,BACK:ee.BACK,FRONT_AND_BACK:ee.FRONT_AND_BACK},gi=Object.freeze(HLe);function XT(e){e=y(e,y.EMPTY_OBJECT),this.material=e.material,this.translucent=y(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=y(e.closed,!1)}Object.defineProperties(XT.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),XT.prototype.getFragmentShaderSource=function(){let e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),u(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},XT.prototype.isTranslucent=function(){return u(this.material)&&this.material.isTranslucent()||!u(this.material)&&this.translucent},XT.prototype.getRenderState=function(){let e=this.isTranslucent(),t=Ge(this.renderState,!1);return e?(t.depthMask=!1,t.blending=ln.ALPHA_BLEND):t.depthMask=!0,t},XT.getDefaultRenderState=function(e,t,i){let n={depthTest:{enabled:!0}};return e&&(n.depthMask=!1,n.blending=ln.ALPHA_BLEND),t&&(n.cull={enabled:!0,face:gi.BACK}),u(i)&&(n=gt(i,n,!0)),n};var no=XT,GLe={SATELLITE:1,OCEANS:2,HILLSHADE:3},wh=Object.freeze(GLe),x6,jne="AAPK72121c3f05244af285ad75999db084bfDGkWA0QECX6QWOdaQmarXC21i1ogkvj8XCctaZExrW8Hw1AT58yG7twH3VFzZl13",KT={};KT.defaultAccessToken=jne,KT.defaultWorldImageryServer=new ve({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}),KT.defaultWorldHillshadeServer=new ve({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}),KT.defaultWorldOceanServer=new ve({url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"}),KT.getDefaultTokenCredit=function(e){if(e===jne){if(!u(x6)){x6=new xt('<b>             This application is using a default ArcGIS access token. Please assign <i>Cesium.ArcGisMapService.defaultAccessToken</i>             with an API key from your ArcGIS Developer account before using the ArcGIS tile services.             You can sign up for a free ArcGIS Developer account at <a href="https://developers.arcgis.com/">https://developers.arcgis.com/</a>.</b>',!0)}return x6}};var Wu=KT;function b6(e){e=y(e,y.EMPTY_OBJECT),this._pixelsToCheck=e.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;let t=ve.createIfNeeded(e.missingImageUrl),i=this;t.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}).then((function(t){u(t.blob)&&(i._missingImageByteLength=t.blob.size);let n=Qd(t);if(e.disableCheckIfAllPixelsAreTransparent){let i=!0,r=t.width,o=e.pixelsToCheck;for(let e=0,t=o.length;i&&e<t;++e){let t=o[e];n[4*t.x+t.y*r+3]>0&&(i=!1)}i&&(n=void 0)}i._missingImagePixels=n,i._isReady=!0})).catch((function(){i._missingImagePixels=void 0,i._isReady=!0}))}b6.prototype.isReady=function(){return this._isReady},b6.prototype.shouldDiscardImage=function(e){let t=this._pixelsToCheck,i=this._missingImagePixels;if(!u(i)||u(e.blob)&&e.blob.size!==this._missingImageByteLength)return!1;let n=Qd(e),r=e.width;for(let e=0,o=t.length;e<o;++e){let o=t[e],a=4*o.x+o.y*r;for(let e=0;e<4;++e){let t=a+e;if(n[t]!==i[t])return!1}}return!0};var UO=b6;function T6(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}T6.prototype.configureNameFromProperties=function(e){let t,i=10;for(let n in e)if(e.hasOwnProperty(n)&&e[n]){let e=n.toLowerCase();i>1&&"name"===e?(i=1,t=n):i>2&&"title"===e?(i=2,t=n):i>3&&/name/i.test(n)?(i=3,t=n):i>4&&/title/i.test(n)&&(i=4,t=n)}u(t)&&(this.name=e[t])},T6.prototype.configureDescriptionFromProperties=function(e){this.description=function e(t){let i='<table class="cesium-infoBox-defaultTable">';for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];u(r)&&(i+="object"==typeof r?`<tr><td>${n}</td><td>${e(r)}</td></tr>`:`<tr><td>${n}</td><td>${r}</td></tr>`)}return i+="</table>",i}(e)};var vh=T6;function ZT(){de.throwInstantiationError()}Object.defineProperties(ZT.prototype,{rectangle:{get:de.throwInstantiationError},tileWidth:{get:de.throwInstantiationError},tileHeight:{get:de.throwInstantiationError},maximumLevel:{get:de.throwInstantiationError},minimumLevel:{get:de.throwInstantiationError},tilingScheme:{get:de.throwInstantiationError},tileDiscardPolicy:{get:de.throwInstantiationError},errorEvent:{get:de.throwInstantiationError},credit:{get:de.throwInstantiationError},proxy:{get:de.throwInstantiationError},hasAlphaChannel:{get:de.throwInstantiationError}}),ZT.prototype.getTileCredits=function(e,t,i){de.throwInstantiationError()},ZT.prototype.requestImage=function(e,t,i,n){de.throwInstantiationError()},ZT.prototype.pickFeatures=function(e,t,i,n,r){de.throwInstantiationError()};var WLe=/\.ktx2$/i;ZT.loadImage=function(e,t){let i=ve.createIfNeeded(t);return WLe.test(i.url)?Ll(i):u(e)&&u(e.tileDiscardPolicy)?i.fetchImage({preferBlob:!0,preferImageBitmap:!0,flipY:!0}):i.fetchImage({preferImageBitmap:!0,flipY:!0})};var el=ZT;function qne(e){this.useTiles=y(e.usePreCachedTilesIfAvailable,!0);let t=e.ellipsoid;this.tilingScheme=y(e.tilingScheme,new Ui({ellipsoid:t})),this.rectangle=y(e.rectangle,this.tilingScheme.rectangle),this.ellipsoid=t;let i=e.credit;"string"==typeof i&&(i=new xt(i)),this.credit=i,this.tileCredits=void 0,this.tileDiscardPolicy=e.tileDiscardPolicy,this.tileWidth=y(e.tileWidth,256),this.tileHeight=y(e.tileHeight,256),this.maximumLevel=e.maximumLevel}function jLe(e,t){let i=e.tileInfo;if(u(i)){if(t.tileWidth=i.rows,t.tileHeight=i.cols,102100===i.spatialReference.wkid||102113===i.spatialReference.wkid)t.tilingScheme=new zr({ellipsoid:t.ellipsoid});else{if(4326!==e.tileInfo.spatialReference.wkid){let t=`Tile spatial reference WKID ${e.tileInfo.spatialReference.wkid} is not supported.`;throw new ue(t)}t.tilingScheme=new Ui({ellipsoid:t.ellipsoid})}if(t.maximumLevel=e.tileInfo.lods.length-1,u(e.fullExtent)){if(u(e.fullExtent.spatialReference)&&u(e.fullExtent.spatialReference.wkid))if(102100===e.fullExtent.spatialReference.wkid||102113===e.fullExtent.spatialReference.wkid){let i=new Oi,n=e.fullExtent,r=i.unproject(new h(Math.max(n.xmin,-t.tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(n.ymin,-t.tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),o=i.unproject(new h(Math.min(n.xmax,t.tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(n.ymax,t.tilingScheme.ellipsoid.maximumRadius*Math.PI),0));t.rectangle=new ce(r.longitude,r.latitude,o.longitude,o.latitude)}else{if(4326!==e.fullExtent.spatialReference.wkid){let t=`fullExtent.spatialReference WKID ${e.fullExtent.spatialReference.wkid} is not supported.`;throw new ue(t)}t.rectangle=ce.fromDegrees(e.fullExtent.xmin,e.fullExtent.ymin,e.fullExtent.xmax,e.fullExtent.ymax)}}else t.rectangle=t.tilingScheme.rectangle;t.useTiles=!0}else t.useTiles=!1;u(e.copyrightText)&&e.copyrightText.length>0&&(u(t.credit)?t.tileCredits=[new xt(e.copyrightText)]:t.credit=new xt(e.copyrightText))}function qLe(e,t){let i=`An error occurred while accessing ${e.url}`;throw u(t)&&u(t.message)&&(i+=`: ${t.message}`),new ue(i)}async function YLe(e,t){let i=e.getDerivedResource({queryParameters:{f:"json"}});try{jLe(await i.fetchJson(),t)}catch(t){qLe(e,t)}}function Dh(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tileWidth=y(e.tileWidth,256),this._tileHeight=y(e.tileHeight,256),this._maximumLevel=e.maximumLevel,this._tilingScheme=y(e.tilingScheme,new Ui({ellipsoid:e.ellipsoid})),this._useTiles=y(e.usePreCachedTilesIfAvailable,!0),this._rectangle=y(e.rectangle,this._tilingScheme.rectangle),this._layers=e.layers,this._credit=e.credit,this._tileCredits=void 0;let t=e.credit;"string"==typeof t&&(t=new xt(t)),this.enablePickFeatures=y(e.enablePickFeatures,!0),this._errorEvent=new pe}function Yne(e,t,i,n,r){let o;if(e._useTiles)o=e._resource.getDerivedResource({url:`tile/${n}/${i}/${t}`,request:r});else{let a=e._tilingScheme.tileXYToNativeRectangle(t,i,n),s={bbox:`${a.west},${a.south},${a.east},${a.north}`,size:`${e._tileWidth},${e._tileHeight}`,format:"png32",transparent:!0,f:"image"};e._tilingScheme.projection instanceof Ii?(s.bboxSR=4326,s.imageSR=4326):(s.bboxSR=3857,s.imageSR=3857),e.layers&&(s.layers=`show:${e.layers}`),o=e._resource.getDerivedResource({url:"export",request:r,queryParameters:s})}return o}qne.prototype.build=function(e){e._useTiles=this.useTiles,e._tilingScheme=this.tilingScheme,e._rectangle=this.rectangle,e._credit=this.credit,e._tileCredits=this.tileCredits,e._tileDiscardPolicy=this.tileDiscardPolicy,e._tileWidth=this.tileWidth,e._tileHeight=this.tileHeight,e._maximumLevel=this.maximumLevel,this.useTiles&&!u(this.tileDiscardPolicy)&&(e._tileDiscardPolicy=new UO({missingImageUrl:Yne(e,0,0,this.maximumLevel).url,pixelsToCheck:[new U(0,0),new U(200,20),new U(20,200),new U(80,110),new U(160,130)],disableCheckIfAllPixelsAreTransparent:!0}))},Dh.fromBasemapType=async function(e,t){let i,n,r;switch(t=y(t,y.EMPTY_OBJECT),e){case wh.SATELLITE:{i=y(t.token,Wu.defaultAccessToken),n=ve.createIfNeeded(Wu.defaultWorldImageryServer),n.appendForwardSlash();let e=Wu.getDefaultTokenCredit(i);u(e)&&(r=xt.clone(e))}break;case wh.OCEANS:{i=y(t.token,Wu.defaultAccessToken),n=ve.createIfNeeded(Wu.defaultWorldOceanServer),n.appendForwardSlash();let e=Wu.getDefaultTokenCredit(i);u(e)&&(r=xt.clone(e))}break;case wh.HILLSHADE:{i=y(t.token,Wu.defaultAccessToken),n=ve.createIfNeeded(Wu.defaultWorldHillshadeServer),n.appendForwardSlash();let e=Wu.getDefaultTokenCredit(i);u(e)&&(r=xt.clone(e))}}return Dh.fromUrl(n,{...t,token:i,credit:r,usePreCachedTilesIfAvailable:!0})},Object.defineProperties(Dh.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),Dh.fromUrl=async function(e,t){t=y(t,y.EMPTY_OBJECT);let i=ve.createIfNeeded(e);i.appendForwardSlash(),u(t.token)&&i.setQueryParameters({token:t.token});let n=new Dh(t);n._resource=i;let r=new qne(t);return y(t.usePreCachedTilesIfAvailable,!0)&&await YLe(i,r),r.build(n),n},Dh.prototype.getTileCredits=function(e,t,i){return this._tileCredits},Dh.prototype.requestImage=function(e,t,i,n){return el.loadImage(this,Yne(this,e,t,i,n))},Dh.prototype.pickFeatures=function(e,t,i,n,r){if(!this.enablePickFeatures)return;let o,a,s,l=this._tilingScheme.tileXYToNativeRectangle(e,t,i);if(this._tilingScheme.projection instanceof Ii)o=P.toDegrees(n),a=P.toDegrees(r),s="4326";else{let e=this._tilingScheme.projection.project(new fe(n,r,0));o=e.x,a=e.y,s="3857"}let c="visible";u(this._layers)&&(c+=`:${this._layers}`);let d={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:`${o},${a}`,mapExtent:`${l.west},${l.south},${l.east},${l.north}`,imageDisplay:`${this._tileWidth},${this._tileHeight},96`,sr:s,layers:c};return this._resource.getDerivedResource({url:"identify",queryParameters:d}).fetchJson().then((function(e){let t=[],i=e.results;if(!u(i))return t;for(let e=0;e<i.length;++e){let n=i[e],r=new vh;if(r.data=n,r.name=n.value,r.properties=n.attributes,r.configureDescriptionFromProperties(n.attributes),"esriGeometryPoint"===n.geometryType&&n.geometry){let e=n.geometry.spatialReference&&n.geometry.spatialReference.wkid?n.geometry.spatialReference.wkid:4326;if(4326===e||4283===e)r.position=fe.fromDegrees(n.geometry.x,n.geometry.y,n.geometry.z);else if(102100===e||900913===e||3857===e){let e=new Oi;r.position=e.unproject(new h(n.geometry.x,n.geometry.y,n.geometry.z))}}t.push(r)}return t}))},Dh._metadataCache={};var $_=Dh;function zO(e){e=y(e,y.EMPTY_OBJECT),this.color=e.color,this.depth=e.depth,this.stencil=e.stencil,this.renderState=e.renderState,this.framebuffer=e.framebuffer,this.owner=e.owner,this.pass=e.pass}zO.ALL=Object.freeze(new zO({color:new z(0,0,0,0),depth:1,stencil:0})),zO.prototype.execute=function(e,t){e.clear(this,t)};var ti=zO,sr={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_maximumSamples:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object.defineProperties(sr,{maximumCombinedTextureImageUnits:{get:function(){return sr._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return sr._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return sr._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return sr._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return sr._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return sr._maximumTextureSize}},maximumVaryingVectors:{get:function(){return sr._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return sr._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return sr._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return sr._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return sr._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return sr._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return sr._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return sr._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return sr._maximumViewportWidth}},maximumViewportHeight:{get:function(){return sr._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return sr._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return sr._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return sr._maximumColorAttachments}},maximumSamples:{get:function(){return sr._maximumSamples}},highpFloatSupported:{get:function(){return sr._highpFloatSupported}},highpIntSupported:{get:function(){return sr._highpIntSupported}}});var zt=sr;function A6(e,t,i){let n=e._gl;n.framebufferTexture2D(n.FRAMEBUFFER,t,i._target,i._texture,0)}function HO(e,t,i){let n=e._gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,t,n.RENDERBUFFER,i._getRenderbuffer())}function Xf(e){let t=(e=y(e,y.EMPTY_OBJECT)).context._gl;zt.maximumColorAttachments;this._gl=t,this._framebuffer=t.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=y(e.destroyAttachments,!0);let i,n,r,o,a;u(e.depthTexture)||u(e.depthRenderbuffer),u(e.depthStencilTexture)||u(e.depthStencilRenderbuffer);if(this._bind(),u(e.colorTextures)){let t=e.colorTextures;for(o=this._colorTextures.length=this._activeColorAttachments.length=t.length,r=0;r<o;++r)i=t[r],a=this._gl.COLOR_ATTACHMENT0+r,A6(this,a,i),this._activeColorAttachments[r]=a,this._colorTextures[r]=i}if(u(e.colorRenderbuffers)){let t=e.colorRenderbuffers;for(o=this._colorRenderbuffers.length=this._activeColorAttachments.length=t.length,r=0;r<o;++r)n=t[r],a=this._gl.COLOR_ATTACHMENT0+r,HO(this,a,n),this._activeColorAttachments[r]=a,this._colorRenderbuffers[r]=n}u(e.depthTexture)&&(i=e.depthTexture,A6(this,this._gl.DEPTH_ATTACHMENT,i),this._depthTexture=i),u(e.depthRenderbuffer)&&(n=e.depthRenderbuffer,HO(this,this._gl.DEPTH_ATTACHMENT,n),this._depthRenderbuffer=n),u(e.stencilRenderbuffer)&&(n=e.stencilRenderbuffer,HO(this,this._gl.STENCIL_ATTACHMENT,n),this._stencilRenderbuffer=n),u(e.depthStencilTexture)&&(i=e.depthStencilTexture,A6(this,this._gl.DEPTH_STENCIL_ATTACHMENT,i),this._depthStencilTexture=i),u(e.depthStencilRenderbuffer)&&(n=e.depthStencilRenderbuffer,HO(this,this._gl.DEPTH_STENCIL_ATTACHMENT,n),this._depthStencilRenderbuffer=n),this._unBind()}Object.defineProperties(Xf.prototype,{status:{get:function(){this._bind();let e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),Xf.prototype._bind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)},Xf.prototype._unBind=function(){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},Xf.prototype.bindDraw=function(){let e=this._gl;e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this._framebuffer)},Xf.prototype.bindRead=function(){let e=this._gl;e.bindFramebuffer(e.READ_FRAMEBUFFER,this._framebuffer)},Xf.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},Xf.prototype.getColorTexture=function(e){return this._colorTextures[e]},Xf.prototype.getColorRenderbuffer=function(e){return this._colorRenderbuffers[e]},Xf.prototype.isDestroyed=function(){return!1},Xf.prototype.destroy=function(){if(this.destroyAttachments){let e=0,t=this._colorTextures,i=t.length;for(;e<i;++e){let i=t[e];u(i)&&i.destroy()}let n=this._colorRenderbuffers;for(i=n.length,e=0;e<i;++e){let t=n[e];u(t)&&t.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),le(this)};var oa=Xf;function $T(e){let t=(e=y(e,y.EMPTY_OBJECT)).context,i=e.width,n=e.height;this._width=i,this._height=n;let r=e.colorRenderbuffers,o=e.colorTextures;if(u(r)!==u(o))throw new de("Both color renderbuffer and texture attachments must be provided.");let a=e.depthStencilRenderbuffer,s=e.depthStencilTexture;if(u(a)!==u(s))throw new de("Both depth-stencil renderbuffer and texture attachments must be provided.");this._renderFramebuffer=new oa({context:t,colorRenderbuffers:r,depthStencilRenderbuffer:a,destroyAttachments:e.destroyAttachments}),this._colorFramebuffer=new oa({context:t,colorTextures:o,depthStencilTexture:s,destroyAttachments:e.destroyAttachments})}$T.prototype.getRenderFramebuffer=function(){return this._renderFramebuffer},$T.prototype.getColorFramebuffer=function(){return this._colorFramebuffer},$T.prototype.blitFramebuffers=function(e,t){this._renderFramebuffer.bindRead(),this._colorFramebuffer.bindDraw();let i=e._gl,n=0;this._colorFramebuffer._colorTextures.length>0&&(n|=i.COLOR_BUFFER_BIT),u(this._colorFramebuffer.depthStencilTexture)&&(n|=i.DEPTH_BUFFER_BIT|(t?i.STENCIL_BUFFER_BIT:0)),i.blitFramebuffer(0,0,this._width,this._height,0,0,this._width,this._height,n,i.NEAREST),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null)},$T.prototype.isDestroyed=function(){return!1},$T.prototype.destroy=function(){return this._renderFramebuffer.destroy(),this._colorFramebuffer.destroy(),le(this)};var GO=$T,tl={RGBA4:ee.RGBA4,RGBA8:ee.RGBA8,RGBA16F:ee.RGBA16F,RGBA32F:ee.RGBA32F,RGB5_A1:ee.RGB5_A1,RGB565:ee.RGB565,DEPTH_COMPONENT16:ee.DEPTH_COMPONENT16,STENCIL_INDEX8:ee.STENCIL_INDEX8,DEPTH_STENCIL:ee.DEPTH_STENCIL,DEPTH24_STENCIL8:ee.DEPTH24_STENCIL8,validate:function(e){return e===tl.RGBA4||e===tl.RGBA8||e===tl.RGBA16F||e===tl.RGBA32F||e===tl.RGB5_A1||e===tl.RGB565||e===tl.DEPTH_COMPONENT16||e===tl.STENCIL_INDEX8||e===tl.DEPTH_STENCIL||e===tl.DEPTH24_STENCIL8},getColorFormat:function(e){return e===ee.FLOAT?tl.RGBA32F:e===ee.HALF_FLOAT_OES?tl.RGBA16F:tl.RGBA8}},nl=Object.freeze(tl);function QS(e){let t=(e=y(e,y.EMPTY_OBJECT)).context._gl,i=(zt.maximumRenderbufferSize,y(e.format,nl.RGBA4)),n=u(e.width)?e.width:t.drawingBufferWidth,r=u(e.height)?e.height:t.drawingBufferHeight,o=y(e.numSamples,1);this._gl=t,this._format=i,this._width=n,this._height=r,this._renderbuffer=this._gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderbuffer),o>1?t.renderbufferStorageMultisample(t.RENDERBUFFER,o,i,n,r):t.renderbufferStorage(t.RENDERBUFFER,i,n,r),t.bindRenderbuffer(t.RENDERBUFFER,null)}Object.defineProperties(QS.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),QS.prototype._getRenderbuffer=function(){return this._renderbuffer},QS.prototype.isDestroyed=function(){return!1},QS.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),le(this)};var ju=QS,WO={NEAREST:ee.NEAREST,LINEAR:ee.LINEAR,validate:function(e){return e===WO.NEAREST||e===WO.LINEAR}},wi=Object.freeze(WO),Q_={NEAREST:ee.NEAREST,LINEAR:ee.LINEAR,NEAREST_MIPMAP_NEAREST:ee.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:ee.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:ee.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:ee.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===Q_.NEAREST||e===Q_.LINEAR||e===Q_.NEAREST_MIPMAP_NEAREST||e===Q_.LINEAR_MIPMAP_NEAREST||e===Q_.NEAREST_MIPMAP_LINEAR||e===Q_.LINEAR_MIPMAP_LINEAR}},an=Object.freeze(Q_),jO={CLAMP_TO_EDGE:ee.CLAMP_TO_EDGE,REPEAT:ee.REPEAT,MIRRORED_REPEAT:ee.MIRRORED_REPEAT,validate:function(e){return e===jO.CLAMP_TO_EDGE||e===jO.REPEAT||e===jO.MIRRORED_REPEAT}},vn=Object.freeze(jO);function JS(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.wrapS,vn.CLAMP_TO_EDGE),i=y(e.wrapT,vn.CLAMP_TO_EDGE),n=y(e.minificationFilter,an.LINEAR),r=y(e.magnificationFilter,wi.LINEAR),o=u(e.maximumAnisotropy)?e.maximumAnisotropy:1;this._wrapS=t,this._wrapT=i,this._minificationFilter=n,this._magnificationFilter=r,this._maximumAnisotropy=o}Object.defineProperties(JS.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),JS.equals=function(e,t){return e===t||u(e)&&u(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy},JS.NEAREST=Object.freeze(new JS({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.NEAREST,magnificationFilter:wi.NEAREST}));var un=JS,qO={DONT_CARE:ee.DONT_CARE,FASTEST:ee.FASTEST,NICEST:ee.NICEST,validate:function(e){return e===qO.DONT_CARE||e===qO.FASTEST||e===qO.NICEST}},Xm=Object.freeze(qO);function Kf(e){let t=(e=y(e,y.EMPTY_OBJECT)).context,i=e.width,n=e.height,r=e.source;u(r)&&(u(i)||(i=y(r.videoWidth,r.width)),u(n)||(n=y(r.videoHeight,r.height)));let o=y(e.pixelFormat,rt.RGBA),a=y(e.pixelDatatype,Ye.UNSIGNED_BYTE),s=rt.toInternalFormat(o,a,t),l=rt.isCompressedFormat(s),c=e.preMultiplyAlpha||o===rt.RGB||o===rt.LUMINANCE,h=y(e.flipY,!0),d=y(e.skipColorSpaceConversion,!1),p=!0,f=t._gl,m=f.TEXTURE_2D,_=f.createTexture();f.activeTexture(f.TEXTURE0),f.bindTexture(m,_);let g,v=4;if(u(r)&&u(r.arrayBufferView)&&!l&&(v=rt.alignmentInBytes(o,a,i)),f.pixelStorei(f.UNPACK_ALIGNMENT,v),d?f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.NONE):f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.BROWSER_DEFAULT_WEBGL),u(r))if(u(r.arrayBufferView)){f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1);let e,c,d,p=r.arrayBufferView;if(l){if(f.compressedTexImage2D(m,0,s,i,n,0,p),u(r.mipLevels))for(c=i,d=n,e=0;e<r.mipLevels.length;++e)c=0|Math.floor(c/2),c<1&&(c=1),d=0|Math.floor(d/2),d<1&&(d=1),f.compressedTexImage2D(m,e+1,s,c,d,0,r.mipLevels[e])}else if(h&&(p=rt.flipY(p,o,a,i,n)),f.texImage2D(m,0,s,i,n,0,o,Ye.toWebGLConstant(a,t),p),u(r.mipLevels))for(c=i,d=n,e=0;e<r.mipLevels.length;++e)c=0|Math.floor(c/2),c<1&&(c=1),d=0|Math.floor(d/2),d<1&&(d=1),f.texImage2D(m,e+1,s,c,d,0,o,Ye.toWebGLConstant(a,t),r.mipLevels[e])}else u(r.framebuffer)?(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1),r.framebuffer!==t.defaultFramebuffer&&r.framebuffer._bind(),f.copyTexImage2D(m,0,s,r.xOffset,r.yOffset,i,n,0),r.framebuffer!==t.defaultFramebuffer&&r.framebuffer._unBind()):(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,h),f.texImage2D(m,0,s,o,Ye.toWebGLConstant(a,t),r));else f.texImage2D(m,0,s,i,n,0,o,Ye.toWebGLConstant(a,t),null),p=!1;f.bindTexture(m,null),g=l?rt.compressedTextureSizeInBytes(o,i,n):rt.textureSizeInBytes(o,a,i,n),this._id=jn(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=m,this._texture=_,this._internalFormat=s,this._pixelFormat=o,this._pixelDatatype=a,this._width=i,this._height=n,this._dimensions=new U(i,n),this._hasMipmap=!1,this._sizeInBytes=g,this._preMultiplyAlpha=c,this._flipY=h,this._initialized=p,this._sampler=void 0,this.sampler=u(e.sampler)?e.sampler:new un}Kf.create=function(e){return new Kf(e)},Kf.fromFramebuffer=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).context,i=t._gl,n=y(e.pixelFormat,rt.RGB),r=y(e.framebufferXOffset,0),o=y(e.framebufferYOffset,0),a=y(e.width,i.drawingBufferWidth),s=y(e.height,i.drawingBufferHeight),l=e.framebuffer;return new Kf({context:t,width:a,height:s,pixelFormat:n,source:{framebuffer:u(l)?l:t.defaultFramebuffer,xOffset:r,yOffset:o,width:a,height:s}})},Object.defineProperties(Kf.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,i=e.magnificationFilter,n=this._context,r=this._pixelFormat,o=this._pixelDatatype,a=t===an.NEAREST_MIPMAP_NEAREST||t===an.NEAREST_MIPMAP_LINEAR||t===an.LINEAR_MIPMAP_NEAREST||t===an.LINEAR_MIPMAP_LINEAR;(o===Ye.FLOAT&&!n.textureFloatLinear||o===Ye.HALF_FLOAT&&!n.textureHalfFloatLinear)&&(t=a?an.NEAREST_MIPMAP_NEAREST:an.NEAREST,i=wi.NEAREST),n.webgl2&&rt.isDepthFormat(r)&&(t=an.NEAREST,i=wi.NEAREST);let s=n._gl,l=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(l,this._texture),s.texParameteri(l,s.TEXTURE_MIN_FILTER,t),s.texParameteri(l,s.TEXTURE_MAG_FILTER,i),s.texParameteri(l,s.TEXTURE_WRAP_S,e.wrapS),s.texParameteri(l,s.TEXTURE_WRAP_T,e.wrapT),u(this._textureFilterAnisotropic)&&s.texParameteri(l,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),s.bindTexture(l,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),Kf.prototype.copyFrom=function(e){let t=y(e.xOffset,0),i=y(e.yOffset,0),n=e.source,r=this._context,o=r._gl,a=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(a,this._texture);let s=n.width,l=n.height,c=n.arrayBufferView,h=this._width,d=this._height,p=this._internalFormat,f=this._pixelFormat,m=this._pixelDatatype,_=this._preMultiplyAlpha,g=this._flipY,v=y(e.skipColorSpaceConversion,!1),b=4;u(c)&&(b=rt.alignmentInBytes(f,m,s)),o.pixelStorei(o.UNPACK_ALIGNMENT,b),v?o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.NONE):o.pixelStorei(o.UNPACK_COLORSPACE_CONVERSION_WEBGL,o.BROWSER_DEFAULT_WEBGL);let A=!1;if(!this._initialized){if(0===t&&0===i&&s===h&&l===d)u(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),g&&(c=rt.flipY(c,f,m,h,d)),o.texImage2D(a,0,p,h,d,0,f,Ye.toWebGLConstant(m,r),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,g),o.texImage2D(a,0,p,f,Ye.toWebGLConstant(m,r),n)),A=!0;else{o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1);let e=rt.createTypedArray(f,m,h,d);o.texImage2D(a,0,p,h,d,0,f,Ye.toWebGLConstant(m,r),e)}this._initialized=!0}A||(u(c)?(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),g&&(c=rt.flipY(c,f,m,s,l)),o.texSubImage2D(a,0,t,i,s,l,f,Ye.toWebGLConstant(m,r),c)):(o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,_),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,g),o.texSubImage2D(a,0,t,i,f,Ye.toWebGLConstant(m,r),n))),o.bindTexture(a,null)},Kf.prototype.copyFromFramebuffer=function(e,t,i,n,r,o){e=y(e,0),t=y(t,0),i=y(i,0),n=y(n,0),r=y(r,this._width),o=y(o,this._height);let a=this._context._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.copyTexSubImage2D(s,0,e,t,i,n,r,o),a.bindTexture(s,null),this._initialized=!0},Kf.prototype.generateMipmap=function(e){e=y(e,Xm.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,i=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(i,this._texture),t.generateMipmap(i),t.bindTexture(i,null)},Kf.prototype.isDestroyed=function(){return!1},Kf.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),le(this)};var Ot=Kf;function rs(e){e=y(e,y.EMPTY_OBJECT),this._numSamples=y(e.numSamples,1),this._colorAttachmentsLength=y(e.colorAttachmentsLength,1),this._color=y(e.color,!0),this._depth=y(e.depth,!1),this._depthStencil=y(e.depthStencil,!1),this._supportsDepthTexture=y(e.supportsDepthTexture,!1),this._createColorAttachments=y(e.createColorAttachments,!0),this._createDepthAttachments=y(e.createDepthAttachments,!0),this._pixelDatatype=e.pixelDatatype,this._pixelFormat=e.pixelFormat,this._width=void 0,this._height=void 0,this._framebuffer=void 0,this._multisampleFramebuffer=void 0,this._colorTextures=void 0,this._color&&(this._colorTextures=new Array(this._colorAttachmentsLength),this._colorRenderbuffers=new Array(this._colorAttachmentsLength)),this._colorRenderbuffer=void 0,this._depthStencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthRenderbuffer=void 0,this._depthTexture=void 0,this._attachmentsDirty=!1}Object.defineProperties(rs.prototype,{framebuffer:{get:function(){return this._numSamples>1?this._multisampleFramebuffer.getRenderFramebuffer():this._framebuffer}},numSamples:{get:function(){return this._numSamples}},status:{get:function(){return this.framebuffer.status}}}),rs.prototype.isDirty=function(e,t,i,n,r){i=y(i,1);let o=this._width!==e||this._height!==t,a=this._numSamples!==i,s=u(n)&&this._pixelDatatype!==n||u(r)&&this._pixelFormat!==r,l=u(1===i?this._framebuffer:this._multisampleFramebuffer);return this._attachmentsDirty||o||a||s||!l||this._color&&!u(this._colorTextures[0])},rs.prototype.update=function(e,t,i,n,r,o){if(n=e.msaa?y(n,1):1,r=y(r,this._color?y(this._pixelDatatype,Ye.UNSIGNED_BYTE):void 0),o=y(o,this._color?y(this._pixelFormat,rt.RGBA):void 0),this.isDirty(t,i,n,r,o)){if(this.destroy(),this._width=t,this._height=i,this._numSamples=n,this._pixelDatatype=r,this._pixelFormat=o,this._attachmentsDirty=!1,this._color&&this._createColorAttachments)for(let n=0;n<this._colorAttachmentsLength;++n)if(this._colorTextures[n]=new Ot({context:e,width:t,height:i,pixelFormat:o,pixelDatatype:r,sampler:un.NEAREST}),this._numSamples>1){let o=nl.getColorFormat(r);this._colorRenderbuffers[n]=new ju({context:e,width:t,height:i,format:o,numSamples:this._numSamples})}this._depthStencil&&this._createDepthAttachments&&(this._supportsDepthTexture&&e.depthTexture?(this._depthStencilTexture=new Ot({context:e,width:t,height:i,pixelFormat:rt.DEPTH_STENCIL,pixelDatatype:Ye.UNSIGNED_INT_24_8,sampler:un.NEAREST}),this._numSamples>1&&(this._depthStencilRenderbuffer=new ju({context:e,width:t,height:i,format:nl.DEPTH24_STENCIL8,numSamples:this._numSamples}))):this._depthStencilRenderbuffer=new ju({context:e,width:t,height:i,format:nl.DEPTH_STENCIL})),this._depth&&this._createDepthAttachments&&(this._supportsDepthTexture&&e.depthTexture?this._depthTexture=new Ot({context:e,width:t,height:i,pixelFormat:rt.DEPTH_COMPONENT,pixelDatatype:Ye.UNSIGNED_INT,sampler:un.NEAREST}):this._depthRenderbuffer=new ju({context:e,width:t,height:i,format:nl.DEPTH_COMPONENT16})),this._numSamples>1?this._multisampleFramebuffer=new GO({context:e,width:this._width,height:this._height,colorTextures:this._colorTextures,colorRenderbuffers:this._colorRenderbuffers,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}):this._framebuffer=new oa({context:e,colorTextures:this._colorTextures,depthTexture:this._depthTexture,depthRenderbuffer:this._depthRenderbuffer,depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1})}},rs.prototype.getColorTexture=function(e){return e=y(e,0),this._colorTextures[e]},rs.prototype.setColorTexture=function(e,t){t=y(t,0),this._attachmentsDirty=e!==this._colorTextures[t],this._colorTextures[t]=e},rs.prototype.getColorRenderbuffer=function(e){return e=y(e,0),this._colorRenderbuffers[e]},rs.prototype.setColorRenderbuffer=function(e,t){t=y(t,0),this._attachmentsDirty=e!==this._colorRenderbuffers[t],this._colorRenderbuffers[t]=e},rs.prototype.getDepthRenderbuffer=function(){return this._depthRenderbuffer},rs.prototype.setDepthRenderbuffer=function(e){this._attachmentsDirty=e!==this._depthRenderbuffer,this._depthRenderbuffer=e},rs.prototype.getDepthTexture=function(){return this._depthTexture},rs.prototype.setDepthTexture=function(e){this._attachmentsDirty=e!==this._depthTexture,this._depthTexture=e},rs.prototype.getDepthStencilRenderbuffer=function(){return this._depthStencilRenderbuffer},rs.prototype.setDepthStencilRenderbuffer=function(e){this._attachmentsDirty=e!==this._depthStencilRenderbuffer,this._depthStencilRenderbuffer=e},rs.prototype.getDepthStencilTexture=function(){return this._depthStencilTexture},rs.prototype.setDepthStencilTexture=function(e){this._attachmentsDirty=e!==this._depthStencilTexture,this._depthStencilTexture=e},rs.prototype.prepareTextures=function(e,t){this._numSamples>1&&this._multisampleFramebuffer.blitFramebuffers(e,t)},rs.prototype.clear=function(e,t,i){let n=t.framebuffer;t.framebuffer=this.framebuffer,t.execute(e,i),t.framebuffer=n},rs.prototype.destroyFramebuffer=function(){this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._multisampleFramebuffer=this._multisampleFramebuffer&&this._multisampleFramebuffer.destroy()},rs.prototype.destroy=function(){if(this._color){let e,t=this._colorTextures.length;for(e=0;e<t;++e){let t=this._colorTextures[e];this._createColorAttachments&&u(t)&&!t.isDestroyed()&&(this._colorTextures[e].destroy(),this._colorTextures[e]=void 0),u(t)&&t.isDestroyed()&&(this._colorTextures[e]=void 0);let i=this._colorRenderbuffers[e];this._createColorAttachments&&u(i)&&!i.isDestroyed()&&(this._colorRenderbuffers[e].destroy(),this._colorRenderbuffers[e]=void 0),u(i)&&i.isDestroyed()&&(this._colorRenderbuffers[e]=void 0)}}this._depthStencil&&(this._createDepthAttachments&&(this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()),u(this._depthStencilTexture)&&this._depthStencilTexture.isDestroyed()&&(this._depthStencilTexture=void 0),u(this._depthStencilRenderbuffer)&&this._depthStencilRenderbuffer.isDestroyed()&&(this._depthStencilRenderbuffer=void 0)),this._depth&&(this._createDepthAttachments&&(this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy()),u(this._depthTexture)&&this._depthTexture.isDestroyed()&&(this._depthTexture=void 0),u(this._depthRenderbuffer)&&this._depthRenderbuffer.isDestroyed()&&(this._depthRenderbuffer=void 0)),this.destroyFramebuffer()};var di=rs;function L0(){this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._ready=!1,this._name="czm_autoexposure",this._logDepthChanged=void 0,this._useLogDepth=void 0,this._framebuffers=void 0,this._previousLuminance=new di,this._commands=void 0,this._clearCommand=void 0,this._minMaxLuminance=new U,this.enabled=!0,this._enabled=!0,this.minimumLuminance=.1,this.maximumLuminance=10}function Xne(e){let t=e._framebuffers;if(!u(t))return;let i=t.length;for(let e=0;e<i;++e)t[e].destroy();e._framebuffers=void 0,e._previousLuminance.destroy(),e._previousLuminance=void 0}function XLe(e,t){Xne(e);let i=e._width,n=e._height,r=t.halfFloatingPointTexture?Ye.HALF_FLOAT:Ye.FLOAT,o=Math.ceil(Math.log(Math.max(i,n))/Math.log(3)),a=new Array(o);for(let e=0;e<o;++e)i=Math.max(Math.ceil(i/3),1),n=Math.max(Math.ceil(n/3),1),a[e]=new di,a[e].update(t,i,n,1,r);let s=a[o-1].getColorTexture(0);e._previousLuminance.update(t,s.width,s.height,1,r),e._framebuffers=a}function Kne(e){let t=e._commands;if(!u(t))return;let i=t.length;for(let e=0;e<i;++e)t[e].shaderProgram.destroy();e._commands=void 0}function KLe(e,t){let i;if(0===t)i={colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions}};else{let n=e._framebuffers[t-1].getColorTexture(0);i={colorTexture:function(){return n},colorTextureDimensions:function(){return n.dimensions}}}return i.minMaxLuminance=function(){return e._minMaxLuminance},i.previousLuminance=function(){return e._previousLuminance.getColorTexture(0)},i}function ZLe(e,t){let i="uniform sampler2D colorTexture; \nin vec2 v_textureCoordinates; \nfloat sampleTexture(vec2 offset) { \n";return i+=0===e?"    vec4 color = texture(colorTexture, v_textureCoordinates + offset); \n    return czm_luminance(color.rgb); \n":"    return texture(colorTexture, v_textureCoordinates + offset).r; \n",i+="}\n\n",i+="uniform vec2 colorTextureDimensions; \nuniform vec2 minMaxLuminance; \nuniform sampler2D previousLuminance; \nvoid main() { \n    float color = 0.0; \n    float xStep = 1.0 / colorTextureDimensions.x; \n    float yStep = 1.0 / colorTextureDimensions.y; \n    int count = 0; \n    for (int i = 0; i < 3; ++i) { \n        for (int j = 0; j < 3; ++j) { \n            vec2 offset; \n            offset.x = -xStep + float(i) * xStep; \n            offset.y = -yStep + float(j) * yStep; \n            if (offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0) { \n                continue; \n            } \n            color += sampleTexture(offset); \n            ++count; \n        } \n    } \n    if (count > 0) { \n        color /= float(count); \n    } \n",e===t-1&&(i+="    float previous = texture(previousLuminance, vec2(0.5)).r; \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n    color = previous + (color - previous) / (60.0 * 1.5); \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n"),i+="    out_FragColor = vec4(color); \n} \n",i}function $Le(e,t){Kne(e);let i=e._framebuffers,n=i.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=t.createViewportQuadCommand(ZLe(o,n),{framebuffer:i[o].framebuffer,uniformMap:KLe(e,o)});e._commands=r}Object.defineProperties(L0.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},outputTexture:{get:function(){let e=this._framebuffers;if(u(e))return e[e.length-1].getColorTexture(0)}}}),L0.prototype.clear=function(e){let t=this._framebuffers;if(!u(t))return;let i=this._clearCommand;u(i)||(i=this._clearCommand=new ti({color:new z(0,0,0,0),framebuffer:void 0}));let n=t.length;for(let r=0;r<n;++r)t[r].clear(e,i)},L0.prototype.update=function(e){let t=e.drawingBufferWidth,i=e.drawingBufferHeight;(t!==this._width||i!==this._height)&&(this._width=t,this._height=i,XLe(this,e),$Le(this,e),this._ready||(this._ready=!0)),this._minMaxLuminance.x=this.minimumLuminance,this._minMaxLuminance.y=this.maximumLuminance;let n=this._framebuffers,r=n[n.length-1];n[n.length-1]=this._previousLuminance,this._commands[this._commands.length-1].framebuffer=this._previousLuminance.framebuffer,this._previousLuminance=r},L0.prototype.execute=function(e,t){this._colorTexture=t;let i=this._commands;if(!u(i))return;let n=i.length;for(let t=0;t<n;++t)i[t].execute(e)},L0.prototype.isDestroyed=function(){return!1},L0.prototype.destroy=function(){return Xne(this),Kne(this),le(this)};var YO=L0,Km={X:0,Y:1,Z:2};Km.Y_UP_TO_Z_UP=L.fromRotationTranslation($.fromRotationX(P.PI_OVER_TWO)),Km.Z_UP_TO_Y_UP=L.fromRotationTranslation($.fromRotationX(-P.PI_OVER_TWO)),Km.X_UP_TO_Z_UP=L.fromRotationTranslation($.fromRotationY(-P.PI_OVER_TWO)),Km.Z_UP_TO_X_UP=L.fromRotationTranslation($.fromRotationY(P.PI_OVER_TWO)),Km.X_UP_TO_Y_UP=L.fromRotationTranslation($.fromRotationZ(P.PI_OVER_TWO)),Km.Y_UP_TO_X_UP=L.fromRotationTranslation($.fromRotationZ(-P.PI_OVER_TWO)),Km.fromName=function(e){return Km[e]};var wo=Object.freeze(Km),QT={};QT._deprecationWarning=is;var Zm=Uint32Array.BYTES_PER_ELEMENT;QT.parse=function(e,t){let i=y(t,0);t=i;let n=new Uint8Array(e),r=new DataView(e);t+=Zm;let o=r.getUint32(t,!0);if(1!==o)throw new ue(`Only Batched 3D Model version 1 is supported.  Version ${o} is not.`);t+=Zm;let a=r.getUint32(t,!0);t+=Zm;let s=r.getUint32(t,!0);t+=Zm;let l=r.getUint32(t,!0);t+=Zm;let u=r.getUint32(t,!0);t+=Zm;let c,h,d=r.getUint32(t,!0);t+=Zm,u>=570425344?(t-=2*Zm,c=s,u=l,d=0,s=0,l=0,QT._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")):d>=570425344&&(t-=Zm,c=u,u=s,d=l,s=0,l=0,QT._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/CesiumGS/3d-tiles/tree/main/specification/TileFormats/Batched3DModel.")),0===s?h={BATCH_LENGTH:y(c,0)}:(h=So(n,t,s),t+=s);let p,f,m=new Uint8Array(e,t,l);t+=l,u>0&&(p=So(n,t,u),t+=u,d>0&&(f=new Uint8Array(e,t,d),f=new Uint8Array(f),t+=d));let _,g=i+a-t;if(0===g)throw new ue("glTF byte length must be greater than 0.");return t%4==0?_=new Uint8Array(e,t,g):(QT._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),_=new Uint8Array(n.subarray(t,t+g))),{batchLength:c,featureTableJson:h,featureTableBinary:m,batchTableJson:p,batchTableBinary:f,gltf:_}};var XO=QT;function $m(e,t,i){if(this._attributes=t,this._numberOfInstances=i,0===t.length)return;let n=QLe(t),r=e.floatingPointTexture,o=n===Ye.FLOAT&&!r,a=JLe(t,o),s=eNe(a,t,o),l=Math.floor(zt.maximumTextureSize/s),u=Math.min(i,l),c=s*u,h=Math.ceil(i/u),d=1/c,p=.5*d,f=1/h,m=.5*f;this._textureDimensions=new U(c,h),this._textureStep=new oe(d,p,f,m),this._pixelDatatype=o?Ye.UNSIGNED_BYTE:n,this._packFloats=o,this._offsets=a,this._stride=s,this._texture=void 0;let _=4*c*h;this._batchValues=n!==Ye.FLOAT||o?new Uint8Array(_):new Float32Array(_),this._batchValuesDirty=!1}function QLe(e){let t=!1,i=e.length;for(let n=0;n<i;++n)if(e[n].componentDatatype!==X.UNSIGNED_BYTE){t=!0;break}return t?Ye.FLOAT:Ye.UNSIGNED_BYTE}function $ne(e,t){let i=e[t].componentsPerAttribute;return 2===i?U:3===i?h:4===i?oe:Number}function JLe(e,t){let i=new Array(e.length),n=0,r=e.length;for(let o=0;o<r;++o){let r=e[o].componentDatatype;i[o]=n,r!==X.UNSIGNED_BYTE&&t?n+=4:++n}return i}function eNe(e,t,i){let n=e.length,r=e[n-1];return t[n-1].componentDatatype!==X.UNSIGNED_BYTE&&i?r+4:r+1}Object.defineProperties($m.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var ew=new oe;function tNe(e,t,i){let n=oe.unpack(e,t,ew),r=oe.unpackFloat(n);n=oe.unpack(e,t+4,ew);let o=oe.unpackFloat(n);n=oe.unpack(e,t+8,ew);let a=oe.unpackFloat(n);n=oe.unpack(e,t+12,ew);let s=oe.unpackFloat(n);return oe.fromElements(r,o,a,s,i)}function nNe(e,t,i){let n=oe.packFloat(e.x,ew);oe.pack(n,t,i),n=oe.packFloat(e.y,n),oe.pack(n,t,i+4),n=oe.packFloat(e.z,n),oe.pack(n,t,i+8),n=oe.packFloat(e.w,n),oe.pack(n,t,i+12)}var Zne=new oe;$m.prototype.getBatchedAttribute=function(e,t,i){let n,r=this._attributes,o=this._offsets[t],a=4*this._stride*e+4*o;n=this._packFloats&&r[t].componentDatatype!==Ye.UNSIGNED_BYTE?tNe(this._batchValues,a,Zne):oe.unpack(this._batchValues,a,Zne);let s=$ne(r,t);return u(s.fromCartesian4)?s.fromCartesian4(n,i):u(s.clone)?s.clone(n,i):n.x};var iNe=[void 0,void 0,new U,new h,new oe],oNe=new oe;function rNe(e,t){let i=e._textureDimensions;e._texture=new Ot({context:t,pixelFormat:rt.RGBA,pixelDatatype:e._pixelDatatype,width:i.x,height:i.y,sampler:un.NEAREST,flipY:!1})}function sNe(e){let t=e._textureDimensions;e._texture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}function aNe(e){let t=e._stride;return 1===e._textureDimensions.y?`uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float(${t}); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n`:`uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float(${t}); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n`}function cNe(e){return 1===e?"float":`vec${e}`}function lNe(e){return 1===e?".x":2===e?".xy":3===e?".xyz":""}function uNe(e,t){let i=e._attributes[t],n=i.componentsPerAttribute,r=i.functionName,o=cNe(n),a=lNe(n),s=`${o} ${r}(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float(${e._offsets[t]}); \n`;return e._packFloats&&i.componentDatatype!==Ye.UNSIGNED_BYTE?s+="vec4 textureValue; \ntextureValue.x = czm_unpackFloat(texture(batchTexture, st)); \ntextureValue.y = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = czm_unpackFloat(texture(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":s+="    vec4 textureValue = texture(batchTexture, st); \n",s+=`    ${o} value = textureValue${a}; \n`,e._pixelDatatype!==Ye.UNSIGNED_BYTE||i.componentDatatype!==X.UNSIGNED_BYTE||i.normalize?e._pixelDatatype===Ye.FLOAT&&i.componentDatatype===X.UNSIGNED_BYTE&&i.normalize&&(s+="value /= 255.0; \n"):s+="value *= 255.0; \n",s+="    return value; \n} \n",s}$m.prototype.setBatchedAttribute=function(e,t,i){let n=this._attributes,r=iNe[n[t].componentsPerAttribute],o=this.getBatchedAttribute(e,t,r),a=$ne(this._attributes,t);if(u(a.equals)?a.equals(o,i):o===i)return;let s=oNe;s.x=u(i.x)?i.x:i,s.y=u(i.y)?i.y:0,s.z=u(i.z)?i.z:0,s.w=u(i.w)?i.w:0;let l=this._offsets[t],c=4*this._stride*e+4*l;this._packFloats&&n[t].componentDatatype!==Ye.UNSIGNED_BYTE?nNe(s,this._batchValues,c):oe.pack(s,this._batchValues,c),this._batchValuesDirty=!0},$m.prototype.update=function(e){u(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,u(this._texture)||rNe(this,e.context),sNe(this))},$m.prototype.getUniformMapCallback=function(){let e=this;return function(t){return 0===e._attributes.length?t:gt(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}},$m.prototype.getVertexShaderCallback=function(){let e=this._attributes;if(0===e.length)return function(e){return e};let t="uniform highp sampler2D batchTexture; \n";t+=`${aNe(this)}\n`;let i=e.length;for(let e=0;e<i;++e)t+=uNe(this,e);return function(e){let i=e.indexOf("void main"),n=e.substring(0,i),r=e.substring(i);return`${n}\n${t}\n${r}`}},$m.prototype.isDestroyed=function(){return!1},$m.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),le(this)};var JT=$m,fNe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},dNe={SCALAR:void 0,VEC2:U,VEC3:h,VEC4:oe,MAT2:Ji,MAT3:$,MAT4:L};function hNe(e){let t,i=e.componentType;t="string"==typeof i?X.fromName(i):i;let n=fNe[e.type],r=dNe[e.type];return{componentsPerAttribute:n,classType:r,createArrayBufferView:function(e,i,r){return X.createArrayBufferView(t,e,i,n*r)}}}var qu=hNe;function Qm(e){this._classes=void 0,this._classIds=void 0,this._classIndexes=void 0,this._parentCounts=void 0,this._parentIndexes=void 0,this._parentIds=void 0,this._byteLength=0,mNe(this,e.extension,e.binaryBody)}function mNe(e,t,i){let n,r,o,a,s=t.instancesLength,l=t.classes,c=t.classIds,h=t.parentCounts,d=t.parentIds,p=s,f=0;if(u(c.byteOffset)&&(c.componentType=y(c.componentType,X.UNSIGNED_SHORT),c.type=nn.SCALAR,o=qu(c),c=o.createArrayBufferView(i.buffer,i.byteOffset+c.byteOffset,s),f+=c.byteLength),u(h)){for(u(h.byteOffset)&&(h.componentType=y(h.componentType,X.UNSIGNED_SHORT),h.type=nn.SCALAR,o=qu(h),h=o.createArrayBufferView(i.buffer,i.byteOffset+h.byteOffset,s),f+=h.byteLength),a=new Uint16Array(s),p=0,n=0;n<s;++n)a[n]=p,p+=h[n];f+=a.byteLength}u(d)&&u(d.byteOffset)&&(d.componentType=y(d.componentType,X.UNSIGNED_SHORT),d.type=nn.SCALAR,o=qu(d),d=o.createArrayBufferView(i.buffer,i.byteOffset+d.byteOffset,p),f+=d.byteLength);let m=l.length;for(n=0;n<m;++n){let e=l[n].length,t=l[n].instances,r=pNe(e,t,i);f+=_Ne(r),l[n].instances=gt(r,t)}let _=new Array(m).fill(0),g=new Uint16Array(s);for(n=0;n<s;++n)r=c[n],g[n]=_[r],++_[r];f+=g.byteLength,e._classes=l,e._classIds=c,e._classIndexes=g,e._parentCounts=h,e._parentIndexes=a,e._parentIds=d,e._byteLength=f}function pNe(e,t,i){let n;for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],a=o.byteOffset;if(u(a)){let t=o.componentType,s=o.type;if(!u(t))throw new ue("componentType is required.");if(!u(s))throw new ue("type is required.");if(!u(i))throw new ue(`Property ${r} requires a batch table binary.`);let l=qu(o),c=l.componentsPerAttribute,h=l.classType,d=l.createArrayBufferView(i.buffer,i.byteOffset+a,e);u(n)||(n={}),n[r]={typedArray:d,componentCount:c,type:h}}}return n}function _Ne(e){let t=0;for(let i in e)e.hasOwnProperty(i)&&(t+=e[i].typedArray.byteLength);return t}Object.defineProperties(Qm.prototype,{byteLength:{get:function(){return this._byteLength}}});var gNe=[],yNe=[],xNe=0;function bNe(e,t,i){let n=e._classIds,r=e._parentCounts,o=e._parentIds,a=e._parentIndexes,s=n.length,l=gNe;l.length=Math.max(l.length,s);let c=++xNe,h=yNe;for(h.length=0,h.push(t);h.length>0;){if(l[t=h.pop()]===c)continue;l[t]=c;let n=i(e,t);if(u(n))return n;let s=r[t],d=a[t];for(let e=0;e<s;++e){let i=o[d+e];i!==t&&h.push(i)}}}function TNe(e,t,i){let n=!0;for(;n;){let r=i(e,t);if(u(r))return r;let o=e._parentIds[t];n=o!==t,t=o}}function tw(e,t,i){let n=e._parentCounts,r=e._parentIds;return u(r)?u(n)?bNe(e,t,i):TNe(e,t,i):i(e,t)}function ANe(e,t){let i=e.typedArray,n=e.componentCount;return 1===n?i[t]:e.type.unpack(i,t*n)}function CNe(e,t,i){let n=e.typedArray,r=e.componentCount;1===r?n[t]=i:e.type.pack(i,n,t*r)}Qm.prototype.hasProperty=function(e,t){let i=tw(this,e,(function(e,i){let n=e._classIds[i],r=e._classes[n].instances;if(u(r[t]))return!0}));return u(i)},Qm.prototype.propertyExists=function(e){let t=this._classes,i=t.length;for(let n=0;n<i;++n){let i=t[n].instances;if(u(i[e]))return!0}return!1},Qm.prototype.getPropertyIds=function(e,t){return(t=u(t)?t:[]).length=0,tw(this,e,(function(e,i){let n=e._classIds[i],r=e._classes[n].instances;for(let e in r)r.hasOwnProperty(e)&&-1===t.indexOf(e)&&t.push(e)})),t},Qm.prototype.getProperty=function(e,t){return tw(this,e,(function(e,i){let n=e._classIds[i],r=e._classes[n],o=e._classIndexes[i],a=r.instances[t];if(u(a))return u(a.typedArray)?ANe(a,o):Ge(a[o],!0)}))},Qm.prototype.setProperty=function(e,t,i){let n=tw(this,e,(function(e,n){let r=e._classIds[n],o=e._classes[r],a=e._classIndexes[n],s=o.instances[t];if(u(s))return u(s.typedArray)?CNe(s,a,i):s[a]=Ge(i,!0),!0}));return u(n)},Qm.prototype.isClass=function(e,t){let i=tw(this,e,(function(e,i){let n=e._classIds[i];if(e._classes[n].name===t)return!0}));return u(i)},Qm.prototype.getClassName=function(e){let t=this._classIds[e];return this._classes[t].name};var eA=Qm;function Na(e){this._id=jn();let t,i,n=e.featuresLength;if(this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[],n>0){let e=Math.min(n,zt.maximumTextureSize),r=Math.ceil(n/zt.maximumTextureSize),o=1/e,a=.5*o,s=1/r,l=.5*s;t=new U(e,r),i=new oe(o,a,s,l)}this._translucentFeaturesLength=0,this._featuresLength=n,this._textureDimensions=t,this._textureStep=i,this._owner=e.owner,this._statistics=e.statistics,this._colorChangedCallback=e.colorChangedCallback}function Qne(e){let t=e._textureDimensions;return t.x*t.y*4}function Jne(e){if(!u(e._batchValues)){let t=Qne(e),i=new Uint8Array(t).fill(255);e._batchValues=i}return e._batchValues}function eie(e){if(!u(e._showAlphaProperties)){let t=2*e._featuresLength,i=new Uint8Array(t).fill(255);e._showAlphaProperties=i}return e._showAlphaProperties}Object.defineProperties(Na.prototype,{translucentFeaturesLength:{get:function(){return this._translucentFeaturesLength}},byteLength:{get:function(){let e=0;return u(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),u(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}},textureDimensions:{get:function(){return this._textureDimensions}},textureStep:{get:function(){return this._textureStep}},batchTexture:{get:function(){return this._batchTexture}},defaultTexture:{get:function(){return this._defaultTexture}},pickTexture:{get:function(){return this._pickTexture}}}),Na.DEFAULT_COLOR_VALUE=z.WHITE,Na.DEFAULT_SHOW_VALUE=!0,Na.prototype.setShow=function(e,t){if(t&&!u(this._showAlphaProperties))return;let i=eie(this),n=2*e,r=t?255:0;if(i[n]!==r){i[n]=r,Jne(this)[4*e+3]=t?i[n+1]:0,this._batchValuesDirty=!0}},Na.prototype.setAllShow=function(e){let t=this._featuresLength;for(let i=0;i<t;++i)this.setShow(i,e)},Na.prototype.getShow=function(e){if(!u(this._showAlphaProperties))return!0;let t=2*e;return 255===this._showAlphaProperties[t]};var ENe=new Array(4);function tie(e,t,i){let n=e._textureDimensions;return new Ot({context:t,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,source:{width:n.x,height:n.y,arrayBufferView:i},flipY:!1,sampler:un.NEAREST})}function SNe(e,t){let i=e._featuresLength;if(!u(e._pickTexture)&&i>0){let n=e._pickIds,r=Qne(e),o=new Uint8Array(r),a=e._owner,s=e._statistics;for(let e=0;e<i;++e){let i=t.createPickId(a.getFeature(e));n.push(i);let r=i.color,s=4*e;o[s]=z.floatToByte(r.red),o[s+1]=z.floatToByte(r.green),o[s+2]=z.floatToByte(r.blue),o[s+3]=z.floatToByte(r.alpha)}e._pickTexture=tie(e,t,o),u(s)&&(s.batchTableByteLength+=e._pickTexture.sizeInBytes)}}function wNe(e){let t=e._textureDimensions;e._batchTexture.copyFrom({source:{width:t.x,height:t.y,arrayBufferView:e._batchValues}})}Na.prototype.setColor=function(e,t){if(z.equals(t,Na.DEFAULT_COLOR_VALUE)&&!u(this._batchValues))return;let i=t.toBytes(ENe),n=i[3],r=Jne(this),o=4*e,a=eie(this),s=2*e;if(r[o]!==i[0]||r[o+1]!==i[1]||r[o+2]!==i[2]||a[s+1]!==n){r[o]=i[0],r[o+1]=i[1],r[o+2]=i[2];let l=255!==a[s+1],c=0!==a[s];r[o+3]=c?n:0,a[s+1]=n;let h=255!==n;h&&!l?++this._translucentFeaturesLength:!h&&l&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,u(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}},Na.prototype.setAllColor=function(e){let t=this._featuresLength;for(let i=0;i<t;++i)this.setColor(i,e)},Na.prototype.getColor=function(e,t){if(!u(this._batchValues))return z.clone(Na.DEFAULT_COLOR_VALUE,t);let i=this._batchValues,n=4*e,r=this._showAlphaProperties,o=2*e;return z.fromBytes(i[n],i[n+1],i[n+2],r[o+1],t)},Na.prototype.getPickColor=function(e){return this._pickIds[e]},Na.prototype.update=function(e,t){let i=t.context;this._defaultTexture=i.defaultTexture;let n=t.passes;(n.pick||n.postProcess)&&SNe(this,i),this._batchValuesDirty&&(this._batchValuesDirty=!1,u(this._batchTexture)||(this._batchTexture=tie(this,i,this._batchValues),u(this._statistics)&&(this._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes)),wNe(this))},Na.prototype.isDestroyed=function(){return!1},Na.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();let e=this._pickIds,t=e.length;for(let i=0;i<t;++i)e[i].destroy();return le(this)};var il=Na,vNe={NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2},We=Object.freeze(vNe),DNe={CENTER:0,LEFT:1,RIGHT:-1},yi=Object.freeze(DNe),KO={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3,getMorphTime:function(e){return e===KO.SCENE3D?1:e===KO.MORPHING?void 0:0}},te=Object.freeze(KO),ra={},INe=new oe(0,0,0,1),Fa=new oe,PNe=new qe,C6=new U,E6=new U;ra.wgs84ToWindowCoordinates=function(e,t,i){return ra.wgs84WithEyeOffsetToWindowCoordinates(e,t,h.ZERO,i)};var nie=new oe,iie=new h;function nw(e,t,i,n){let r=i.viewMatrix,o=L.multiplyByVector(r,oe.fromElements(e.x,e.y,e.z,1,nie),nie),a=h.multiplyComponents(t,h.normalize(o,iie),iie);return o.x+=t.x+a.x,o.y+=t.y+a.y,o.z+=a.z,L.multiplyByVector(i.frustum.projectionMatrix,o,n)}var ONe=new fe(Math.PI,P.PI_OVER_TWO),RNe=new h,MNe=new h;ra.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,i,n){let r=e.frameState,o=ra.computeActualWgs84Position(r,t,INe);if(!u(o))return;let a=e.canvas,s=PNe;s.x=0,s.y=0,s.width=a.clientWidth,s.height=a.clientHeight;let l=e.camera,c=!1;if(r.mode===te.SCENE2D){let t=e.mapProjection,r=ONe,u=t.project(r,RNe),d=h.clone(l.position,MNe),p=l.frustum.clone(),f=L.computeViewportTransformation(s,0,1,new L),m=l.frustum.projectionMatrix,_=l.positionWC.y,g=h.fromElements(P.sign(_)*u.x-_,0,-l.positionWC.x),y=Rt.pointToGLWindowCoordinates(m,f,g);if(0===_||y.x<=0||y.x>=a.clientWidth)c=!0;else{if(y.x>.5*a.clientWidth){s.width=y.x,l.frustum.right=u.x-_,Fa=nw(o,i,l,Fa),ra.clipToGLWindowCoordinates(s,Fa,C6),s.x+=y.x,l.position.x=-l.position.x;let e=l.frustum.right;l.frustum.right=-l.frustum.left,l.frustum.left=-e,Fa=nw(o,i,l,Fa),ra.clipToGLWindowCoordinates(s,Fa,E6)}else{s.x+=y.x,s.width-=y.x,l.frustum.left=-u.x-_,Fa=nw(o,i,l,Fa),ra.clipToGLWindowCoordinates(s,Fa,C6),s.x=s.x-s.width,l.position.x=-l.position.x;let e=l.frustum.left;l.frustum.left=-l.frustum.right,l.frustum.right=-e,Fa=nw(o,i,l,Fa),ra.clipToGLWindowCoordinates(s,Fa,E6)}h.clone(d,l.position),l.frustum=p.clone(),((n=U.clone(C6,n)).x<0||n.x>a.clientWidth)&&(n.x=E6.x)}}if(r.mode!==te.SCENE2D||c){if((Fa=nw(o,i,l,Fa)).z<0&&!(l.frustum instanceof Qt)&&!(l.frustum instanceof Or))return;n=ra.clipToGLWindowCoordinates(s,Fa,n)}return n.y=a.clientHeight-n.y,n},ra.wgs84ToDrawingBufferCoordinates=function(e,t,i){if(i=ra.wgs84ToWindowCoordinates(e,t,i),u(i))return ra.transformWindowToDrawingBuffer(e,i,i)};var Jm=new h,LNe=new fe;ra.computeActualWgs84Position=function(e,t,i){let n=e.mode;if(n===te.SCENE3D)return h.clone(t,i);let r=e.mapProjection,o=r.ellipsoid.cartesianToCartographic(t,LNe);if(!u(o))return;if(r.project(o,Jm),n===te.COLUMBUS_VIEW)return h.fromElements(Jm.z,Jm.x,Jm.y,i);if(n===te.SCENE2D)return h.fromElements(0,Jm.x,Jm.y,i);let a=e.morphTime;return h.fromElements(P.lerp(Jm.z,t.x,a),P.lerp(Jm.x,t.y,a),P.lerp(Jm.y,t.z,a),i)};var oie=new h,rie=new h,sie=new L;ra.clipToGLWindowCoordinates=function(e,t,i){return h.divideByScalar(t,t.w,oie),L.computeViewportTransformation(e,0,1,sie),L.multiplyByPoint(sie,oie,rie),U.fromCartesian3(rie,i)},ra.transformWindowToDrawingBuffer=function(e,t,i){let n=e.canvas,r=e.drawingBufferWidth/n.clientWidth,o=e.drawingBufferHeight/n.clientHeight;return U.fromElements(t.x*r,t.y*o,i)};var NNe=new oe,aie=new oe;ra.drawingBufferToWgs84Coordinates=function(e,t,i,n){let r=e.context.uniformState,o=r.currentFrustum,a=o.x,s=o.y;if(e.frameState.useLogDepth){let e=i*r.log2FarDepthFromNearPlusOne;i=s*(1-a/(Math.pow(2,e)-1+a))/(s-a)}let l=e.view.passState.viewport,c=oe.clone(oe.UNIT_W,NNe);c.x=(t.x-l.x)/l.width*2-1,c.y=(t.y-l.y)/l.height*2-1,c.z=2*i-1,c.w=1;let d,p=e.camera.frustum;if(u(p.fovy)){d=L.multiplyByVector(r.inverseViewProjection,c,aie);let e=1/d.w;h.multiplyByScalar(d,e,d)}else{let e=p.offCenterFrustum;u(e)&&(p=e),d=aie,d.x=.5*(c.x*(p.right-p.left)+p.left+p.right),d.y=.5*(c.y*(p.top-p.bottom)+p.bottom+p.top),d.z=.5*(c.z*(a-s)-a-s),d.w=1,d=L.multiplyByVector(r.inverseView,d,d)}return h.fromCartesian4(d,n)};var $i=ra,FNe={CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1},On=Object.freeze(FNe);function xi(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).translucencyByDistance,n=e.pixelOffsetScaleByDistance,r=e.scaleByDistance,o=e.distanceDisplayCondition;u(i)&&(i=Pt.clone(i)),u(n)&&(n=Pt.clone(n)),u(r)&&(r=Pt.clone(r)),u(o)&&(o=wt.clone(o)),this._show=y(e.show,!0),this._position=h.clone(y(e.position,h.ZERO)),this._actualPosition=h.clone(this._position),this._pixelOffset=U.clone(y(e.pixelOffset,U.ZERO)),this._translate=new U(0,0),this._eyeOffset=h.clone(y(e.eyeOffset,h.ZERO)),this._heightReference=y(e.heightReference,We.NONE),this._verticalOrigin=y(e.verticalOrigin,On.CENTER),this._horizontalOrigin=y(e.horizontalOrigin,yi.CENTER),this._scale=y(e.scale,1),this._color=z.clone(y(e.color,z.WHITE)),this._rotation=y(e.rotation,0),this._alignedAxis=h.clone(y(e.alignedAxis,h.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=r,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=n,this._sizeInMeters=y(e.sizeInMeters,!1),this._distanceDisplayCondition=o,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=y(e.collection,t),this._pickId=void 0,this._pickPrimitive=y(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;let a=e.image,s=e.imageId;u(a)&&(u(s)||(s="string"==typeof a?a:u(a.src)?a.src:jn()),this._imageId=s,this._image=a),u(e.imageSubRegion)&&(this._imageId=s,this._imageSubRegion=e.imageSubRegion),u(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=te.SCENE3D,this._clusterShow=!0,this._outlineColor=z.clone(y(e.outlineColor,z.BLACK)),this._outlineWidth=y(e.outlineWidth,0),this._updateClamping()}var cie=xi.SHOW_INDEX=0,$O=xi.POSITION_INDEX=1,hie=xi.PIXEL_OFFSET_INDEX=2,BNe=xi.EYE_OFFSET_INDEX=3,kNe=xi.HORIZONTAL_ORIGIN_INDEX=4,VNe=xi.VERTICAL_ORIGIN_INDEX=5,UNe=xi.SCALE_INDEX=6,QO=xi.IMAGE_INDEX_INDEX=7,lie=xi.COLOR_INDEX=8,zNe=xi.ROTATION_INDEX=9,HNe=xi.ALIGNED_AXIS_INDEX=10,GNe=xi.SCALE_BY_DISTANCE_INDEX=11,WNe=xi.TRANSLUCENCY_BY_DISTANCE_INDEX=12,jNe=xi.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,qNe=xi.DISTANCE_DISPLAY_CONDITION=14,YNe=xi.DISABLE_DEPTH_DISTANCE=15;xi.TEXTURE_COORDINATE_BOUNDS=16;var uie=xi.SDF_INDEX=17;function vo(e,t){let i=e._billboardCollection;u(i)&&(i._updateBillboard(e,t),e._dirty=!0)}xi.NUMBER_OF_PROPERTIES=18,Object.defineProperties(xi.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,vo(this,cie))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),h.clone(e,this._actualPosition),this._updateClamping(),vo(this,$O))}},heightReference:{get:function(){return this._heightReference},set:function(e){e!==this._heightReference&&(this._heightReference=e,this._updateClamping(),vo(this,$O))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;U.equals(t,e)||(U.clone(e,t),vo(this,hie))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;Pt.equals(t,e)||(this._scaleByDistance=Pt.clone(e,t),vo(this,GNe))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;Pt.equals(t,e)||(this._translucencyByDistance=Pt.clone(e,t),vo(this,WNe))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;Pt.equals(t,e)||(this._pixelOffsetScaleByDistance=Pt.clone(e,t),vo(this,jNe))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;h.equals(t,e)||(h.clone(e,t),vo(this,BNe))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,vo(this,kNe))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,vo(this,VNe))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,vo(this,UNe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;z.equals(t,e)||(z.clone(e,t),vo(this,lie))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,vo(this,zNe))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){let t=this._alignedAxis;h.equals(t,e)||(h.clone(e,t),vo(this,HNe))}},width:{get:function(){return y(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,vo(this,QO))}},height:{get:function(){return y(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,vo(this,QO))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,vo(this,lie))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){wt.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=wt.clone(e,this._distanceDisplayCondition),vo(this,qNe))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,vo(this,YNe))}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,u(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){u(e)?"string"==typeof e?this.setImage(e,e):e instanceof ve?this.setImage(e.url,e):u(e.src)?this.setImage(e.src,e):this.setImage(jn(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,vo(this,QO))}},ready:{get:function(){return-1!==this._imageIndex}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=h.clone(e,this._actualClampedPosition),vo(this,$O)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,vo(this,cie))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;z.equals(t,e)||(z.clone(e,t),vo(this,uie))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,vo(this,uie))}}}),xi.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId},xi.prototype._updateClamping=function(){xi._updateClamping(this._billboardCollection,this)};var iw=new fe,fie=new h;xi._updateClamping=function(e,t){let i=e._scene;if(!u(i)||!u(i.globe))return;let n=i.globe,r=n.ellipsoid,o=n._surface,a=i.frameState.mode,s=a!==t._mode;if(t._mode=a,(t._heightReference===We.NONE||s)&&u(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference===We.NONE||!u(t._position))return;let l=r.cartesianToCartographic(t._position);if(!u(l))return void(t._actualClampedPosition=void 0);function c(e){if(t._heightReference===We.RELATIVE_TO_GROUND)if(t._mode===te.SCENE3D){let t=r.cartesianToCartographic(e,iw);t.height+=l.height,r.cartographicToCartesian(t,e)}else e.x+=l.height;t._clampedPosition=h.clone(e,t._clampedPosition)}u(t._removeCallbackFunc)&&t._removeCallbackFunc(),t._removeCallbackFunc=o.updateHeight(l,c),fe.clone(l,iw);let d=n.getHeight(l);u(d)&&(iw.height=d),r.cartographicToCartesian(iw,fie),c(fie)},xi.prototype._loadImage=function(){let e,t=this._billboardCollection._textureAtlas,i=this._imageId,n=this._image,r=this._imageSubRegion,o=this;function a(e){if(o._imageId!==i||o._image!==n||!qe.equals(o._imageSubRegion,r))return;let a=t.textureCoordinates[e];o._imageWidth=t.texture.width*a.width,o._imageHeight=t.texture.height*a.height,o._imageIndex=e,o._ready=!0,o._image=void 0,o._imageIndexPromise=void 0,vo(o,QO);let s=o._billboardCollection._scene;u(s)&&s.frameState.afterRender.push((()=>!0))}if(u(n)&&(e=t.addImage(i,n)),u(r)&&(e=t.addSubRegion(i,r)),this._imageIndexPromise=e,!u(e))return;let s=t.getImageIndex(i);!u(s)||u(r)?e.then(a).catch((function(e){console.error(`Error loading image for billboard: ${e}`),o._imageIndexPromise=void 0})):a(s)},xi.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,u(this._billboardCollection._textureAtlas)&&this._loadImage())},xi.prototype.setImageSubRegion=function(e,t){this._imageId===e&&qe.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=qe.clone(t),u(this._billboardCollection._textureAtlas)&&this._loadImage())},xi.prototype._setTranslate=function(e){let t=this._translate;U.equals(t,e)||(U.clone(e,t),vo(this,hie))},xi.prototype._getActualPosition=function(){return u(this._clampedPosition)?this._clampedPosition:this._actualPosition},xi.prototype._setActualPosition=function(e){u(this._clampedPosition)||h.clone(e,this._actualPosition),vo(this,$O)};var die=new oe;xi._computeActualPosition=function(e,t,i,n){return u(e._clampedPosition)?(i.mode!==e._mode&&e._updateClamping(),e._clampedPosition):i.mode===te.SCENE3D?t:(L.multiplyByPoint(n,t,die),$i.computeActualWgs84Position(i,die))};var mie=new h;xi._computeScreenSpacePosition=function(e,t,i,n,r,o){let a=L.multiplyByPoint(e,t,mie),s=$i.wgs84WithEyeOffsetToWindowCoordinates(r,a,i,o);if(u(s))return U.add(s,n,s),s};var ZO=new U(0,0);xi.prototype.computeScreenSpacePosition=function(e,t){let i=this._billboardCollection;u(t)||(t=new U),U.clone(this._pixelOffset,ZO),U.add(ZO,this._translate,ZO);let n=i.modelMatrix,r=this._position;if(u(this._clampedPosition)&&(r=this._clampedPosition,e.mode!==te.SCENE3D)){let t=e.mapProjection,i=t.ellipsoid,o=t.unproject(r,iw);r=i.cartographicToCartesian(o,mie),n=L.IDENTITY}return xi._computeScreenSpacePosition(n,r,this._eyeOffset,ZO,e,t)},xi.getScreenSpaceBoundingBox=function(e,t,i){let n=e.width,r=e.height,o=e.scale;n*=o,r*=o;let a=t.x;e.horizontalOrigin===yi.RIGHT?a-=n:e.horizontalOrigin===yi.CENTER&&(a-=.5*n);let s=t.y;return e.verticalOrigin===On.BOTTOM||e.verticalOrigin===On.BASELINE?s-=r:e.verticalOrigin===On.CENTER&&(s-=.5*r),u(i)||(i=new qe),i.x=a,i.y=s,i.width=n,i.height=r,i},xi.prototype.equals=function(e){return this===e||u(e)&&this._id===e._id&&h.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&qe.equals(this._imageSubRegion,e._imageSubRegion)&&z.equals(this._color,e._color)&&U.equals(this._pixelOffset,e._pixelOffset)&&U.equals(this._translate,e._translate)&&h.equals(this._eyeOffset,e._eyeOffset)&&Pt.equals(this._scaleByDistance,e._scaleByDistance)&&Pt.equals(this._translucencyByDistance,e._translucencyByDistance)&&Pt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&wt.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},xi.prototype._destroy=function(){u(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),u(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var mo=xi,JO={STREAM_DRAW:ee.STREAM_DRAW,STATIC_DRAW:ee.STATIC_DRAW,DYNAMIC_DRAW:ee.DYNAMIC_DRAW,validate:function(e){return e===JO.STREAM_DRAW||e===JO.STATIC_DRAW||e===JO.DYNAMIC_DRAW}},Be=Object.freeze(JO);function Yu(e){let t=(e=y(e,y.EMPTY_OBJECT)).context._gl,i=e.bufferTarget,n=e.typedArray,r=e.sizeInBytes,o=e.usage,a=u(n);a&&(r=n.byteLength);let s=t.createBuffer();t.bindBuffer(i,s),t.bufferData(i,a?n:r,o),t.bindBuffer(i,null),this._id=jn(),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=i,this._sizeInBytes=r,this._usage=o,this._buffer=s,this.vertexArrayDestroyable=!0}Yu.createVertexBuffer=function(e){return new Yu({context:e.context,bufferTarget:ee.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},Yu.createIndexBuffer=function(e){let t=e.context,i=e.indexDatatype,n=ke.getSizeInBytes(i),r=new Yu({context:t,bufferTarget:ee.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),o=r.sizeInBytes/n;return Object.defineProperties(r,{indexDatatype:{get:function(){return i}},bytesPerIndex:{get:function(){return n}},numberOfIndices:{get:function(){return o}}}),r},Object.defineProperties(Yu.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),Yu.prototype._getBuffer=function(){return this._buffer},Yu.prototype.copyFromArrayView=function(e,t){t=y(t,0);let i=this._gl,n=this._bufferTarget;i.bindBuffer(n,this._buffer),i.bufferSubData(n,t,e),i.bindBuffer(n,null)},Yu.prototype.copyFromBuffer=function(e,t,i,n){let r=ee.COPY_READ_BUFFER,o=ee.COPY_WRITE_BUFFER,a=this._gl;a.bindBuffer(o,this._buffer),a.bindBuffer(r,e._buffer),a.copyBufferSubData(r,o,t,i,n),a.bindBuffer(o,null),a.bindBuffer(r,null)},Yu.prototype.getBufferData=function(e,t,i,n){t=y(t,0),i=y(i,0);let r=this._gl,o=ee.COPY_READ_BUFFER;r.bindBuffer(o,this._buffer),r.getBufferSubData(o,t,e,i,n),r.bindBuffer(o,null)},Yu.prototype.isDestroyed=function(){return!1},Yu.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),le(this)};var ut=Yu,ar={CULL:1,OCCLUDE:2,EXECUTE_IN_CLOSEST_FRUSTUM:4,DEBUG_SHOW_BOUNDING_VOLUME:8,CAST_SHADOWS:16,RECEIVE_SHADOWS:32,PICK_ONLY:64,DEPTH_FOR_TRANSLUCENT_CLASSIFICATION:128};function ow(e){e=y(e,y.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._modelMatrix=e.modelMatrix,this._primitiveType=y(e.primitiveType,Ne.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=y(e.offset,0),this._instanceCount=y(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._owner=e.owner,this._debugOverlappingFrustums=0,this._pickId=e.pickId,this._flags=0,this.cull=y(e.cull,!0),this.occlude=y(e.occlude,!0),this.executeInClosestFrustum=y(e.executeInClosestFrustum,!1),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.castShadows=y(e.castShadows,!1),this.receiveShadows=y(e.receiveShadows,!1),this.pickOnly=y(e.pickOnly,!1),this.depthForTranslucentClassification=y(e.depthForTranslucentClassification,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}function Ba(e,t){return(e._flags&t)===t}function J_(e,t,i){i?e._flags|=t:e._flags&=~t}Object.defineProperties(ow.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return Ba(this,ar.CULL)},set:function(e){Ba(this,ar.CULL)!==e&&(J_(this,ar.CULL,e),this.dirty=!0)}},occlude:{get:function(){return Ba(this,ar.OCCLUDE)},set:function(e){Ba(this,ar.OCCLUDE)!==e&&(J_(this,ar.OCCLUDE,e),this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return Ba(this,ar.CAST_SHADOWS)},set:function(e){Ba(this,ar.CAST_SHADOWS)!==e&&(J_(this,ar.CAST_SHADOWS,e),this.dirty=!0)}},receiveShadows:{get:function(){return Ba(this,ar.RECEIVE_SHADOWS)},set:function(e){Ba(this,ar.RECEIVE_SHADOWS)!==e&&(J_(this,ar.RECEIVE_SHADOWS,e),this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return Ba(this,ar.EXECUTE_IN_CLOSEST_FRUSTUM)},set:function(e){Ba(this,ar.EXECUTE_IN_CLOSEST_FRUSTUM)!==e&&(J_(this,ar.EXECUTE_IN_CLOSEST_FRUSTUM,e),this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return Ba(this,ar.DEBUG_SHOW_BOUNDING_VOLUME)},set:function(e){Ba(this,ar.DEBUG_SHOW_BOUNDING_VOLUME)!==e&&(J_(this,ar.DEBUG_SHOW_BOUNDING_VOLUME,e),this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}},pickOnly:{get:function(){return Ba(this,ar.PICK_ONLY)},set:function(e){Ba(this,ar.PICK_ONLY)!==e&&(J_(this,ar.PICK_ONLY,e),this.dirty=!0)}},depthForTranslucentClassification:{get:function(){return Ba(this,ar.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)},set:function(e){Ba(this,ar.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION)!==e&&(J_(this,ar.DEPTH_FOR_TRANSLUCENT_CLASSIFICATION,e),this.dirty=!0)}}}),ow.shallowClone=function(e,t){if(u(e))return u(t)||(t=new ow),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._owner=e._owner,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._pickId=e._pickId,t._flags=e._flags,t.dirty=!0,t.lastDirtyTime=0,t},ow.prototype.execute=function(e,t){e.draw(this,t)};var et=ow,XNe={ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,VOXELS:9,OVERLAY:10,NUMBER_OF_PASSES:11},Ee=Object.freeze(XNe);function pie(e){if("object"!=typeof e||null===e)return e;let t,i=Object.keys(e);for(let n=0;n<i.length;n++)t=i[n],e.hasOwnProperty(t)&&"_applyFunctions"!==t&&(e[t]=pie(e[t]));return Object.freeze(e)}var _ie=pie;function Ph(e){let t=y(e,y.EMPTY_OBJECT),i=y(t.cull,y.EMPTY_OBJECT),n=y(t.polygonOffset,y.EMPTY_OBJECT),r=y(t.scissorTest,y.EMPTY_OBJECT),o=y(r.rectangle,y.EMPTY_OBJECT),a=y(t.depthRange,y.EMPTY_OBJECT),s=y(t.depthTest,y.EMPTY_OBJECT),l=y(t.colorMask,y.EMPTY_OBJECT),c=y(t.blending,y.EMPTY_OBJECT),h=y(c.color,y.EMPTY_OBJECT),d=y(t.stencilTest,y.EMPTY_OBJECT),p=y(d.frontOperation,y.EMPTY_OBJECT),f=y(d.backOperation,y.EMPTY_OBJECT),m=y(t.sampleCoverage,y.EMPTY_OBJECT),_=t.viewport;this.frontFace=y(t.frontFace,ts.COUNTER_CLOCKWISE),this.cull={enabled:y(i.enabled,!1),face:y(i.face,ee.BACK)},this.lineWidth=y(t.lineWidth,1),this.polygonOffset={enabled:y(n.enabled,!1),factor:y(n.factor,0),units:y(n.units,0)},this.scissorTest={enabled:y(r.enabled,!1),rectangle:qe.clone(o)},this.depthRange={near:y(a.near,0),far:y(a.far,1)},this.depthTest={enabled:y(s.enabled,!1),func:y(s.func,ee.LESS)},this.colorMask={red:y(l.red,!0),green:y(l.green,!0),blue:y(l.blue,!0),alpha:y(l.alpha,!0)},this.depthMask=y(t.depthMask,!0),this.stencilMask=y(t.stencilMask,-1),this.blending={enabled:y(c.enabled,!1),color:new z(y(h.red,0),y(h.green,0),y(h.blue,0),y(h.alpha,0)),equationRgb:y(c.equationRgb,ee.FUNC_ADD),equationAlpha:y(c.equationAlpha,ee.FUNC_ADD),functionSourceRgb:y(c.functionSourceRgb,ee.ONE),functionSourceAlpha:y(c.functionSourceAlpha,ee.ONE),functionDestinationRgb:y(c.functionDestinationRgb,ee.ZERO),functionDestinationAlpha:y(c.functionDestinationAlpha,ee.ZERO)},this.stencilTest={enabled:y(d.enabled,!1),frontFunction:y(d.frontFunction,ee.ALWAYS),backFunction:y(d.backFunction,ee.ALWAYS),reference:y(d.reference,0),mask:y(d.mask,-1),frontOperation:{fail:y(p.fail,ee.KEEP),zFail:y(p.zFail,ee.KEEP),zPass:y(p.zPass,ee.KEEP)},backOperation:{fail:y(f.fail,ee.KEEP),zFail:y(f.zFail,ee.KEEP),zPass:y(f.zPass,ee.KEEP)}},this.sampleCoverage={enabled:y(m.enabled,!1),value:y(m.value,1),invert:y(m.invert,!1)},this.viewport=u(_)?new qe(_.x,_.y,_.width,_.height):void 0,this.id=0,this._applyFunctions=[]}var KNe=0,Ih={};function N0(e,t,i){i?e.enable(t):e.disable(t)}function gie(e,t){e.frontFace(t.frontFace)}function yie(e,t){let i=t.cull,n=i.enabled;N0(e,e.CULL_FACE,n),n&&e.cullFace(i.face)}function xie(e,t){e.lineWidth(t.lineWidth)}function bie(e,t){let i=t.polygonOffset,n=i.enabled;N0(e,e.POLYGON_OFFSET_FILL,n),n&&e.polygonOffset(i.factor,i.units)}function Tie(e,t,i){let n=t.scissorTest,r=u(i.scissorTest)?i.scissorTest.enabled:n.enabled;if(N0(e,e.SCISSOR_TEST,r),r){let t=u(i.scissorTest)?i.scissorTest.rectangle:n.rectangle;e.scissor(t.x,t.y,t.width,t.height)}}function Aie(e,t){let i=t.depthRange;e.depthRange(i.near,i.far)}function Cie(e,t){let i=t.depthTest,n=i.enabled;N0(e,e.DEPTH_TEST,n),n&&e.depthFunc(i.func)}function Eie(e,t){let i=t.colorMask;e.colorMask(i.red,i.green,i.blue,i.alpha)}function Sie(e,t){e.depthMask(t.depthMask)}function wie(e,t){e.stencilMask(t.stencilMask)}function ZNe(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}function vie(e,t,i){let n=t.blending,r=u(i.blendingEnabled)?i.blendingEnabled:n.enabled;N0(e,e.BLEND,r),r&&(ZNe(e,n.color),e.blendEquationSeparate(n.equationRgb,n.equationAlpha),e.blendFuncSeparate(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha))}function Die(e,t){let i=t.stencilTest,n=i.enabled;if(N0(e,e.STENCIL_TEST,n),n){let t=i.frontFunction,n=i.backFunction,r=i.reference,o=i.mask;e.stencilFunc(t,r,o),e.stencilFuncSeparate(e.BACK,n,r,o),e.stencilFuncSeparate(e.FRONT,t,r,o);let a=i.frontOperation,s=a.fail,l=a.zFail,u=a.zPass;e.stencilOpSeparate(e.FRONT,s,l,u);let c=i.backOperation,h=c.fail,d=c.zFail,p=c.zPass;e.stencilOpSeparate(e.BACK,h,d,p)}}function Iie(e,t){let i=t.sampleCoverage,n=i.enabled;N0(e,e.SAMPLE_COVERAGE,n),n&&e.sampleCoverage(i.value,i.invert)}Ph.fromCache=function(e){let t=JSON.stringify(e),i=Ih[t];if(u(i))return++i.referenceCount,i.state;let n=new Ph(e),r=JSON.stringify(n);return i=Ih[r],u(i)||(n.id=KNe++,i={referenceCount:0,state:n},Ih[r]=i),++i.referenceCount,Ih[t]={referenceCount:1,state:i.state},i.state},Ph.removeFromCache=function(e){let t=new Ph(e),i=JSON.stringify(t),n=Ih[i],r=JSON.stringify(e),o=Ih[r];u(o)&&(--o.referenceCount,0===o.referenceCount&&(delete Ih[r],u(n)&&--n.referenceCount)),u(n)&&0===n.referenceCount&&delete Ih[i]},Ph.getCache=function(){return Ih},Ph.clearCache=function(){Ih={}};var $Ne=new qe;function Pie(e,t,i){let n=y(t.viewport,i.viewport);u(n)||(n=$Ne,n.width=i.context.drawingBufferWidth,n.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=n,e.viewport(n.x,n.y,n.width,n.height)}function QNe(e,t){let i=[];return e.frontFace!==t.frontFace&&i.push(gie),(e.cull.enabled!==t.cull.enabled||e.cull.face!==t.cull.face)&&i.push(yie),e.lineWidth!==t.lineWidth&&i.push(xie),(e.polygonOffset.enabled!==t.polygonOffset.enabled||e.polygonOffset.factor!==t.polygonOffset.factor||e.polygonOffset.units!==t.polygonOffset.units)&&i.push(bie),(e.depthRange.near!==t.depthRange.near||e.depthRange.far!==t.depthRange.far)&&i.push(Aie),(e.depthTest.enabled!==t.depthTest.enabled||e.depthTest.func!==t.depthTest.func)&&i.push(Cie),(e.colorMask.red!==t.colorMask.red||e.colorMask.green!==t.colorMask.green||e.colorMask.blue!==t.colorMask.blue||e.colorMask.alpha!==t.colorMask.alpha)&&i.push(Eie),e.depthMask!==t.depthMask&&i.push(Sie),e.stencilMask!==t.stencilMask&&i.push(wie),(e.stencilTest.enabled!==t.stencilTest.enabled||e.stencilTest.frontFunction!==t.stencilTest.frontFunction||e.stencilTest.backFunction!==t.stencilTest.backFunction||e.stencilTest.reference!==t.stencilTest.reference||e.stencilTest.mask!==t.stencilTest.mask||e.stencilTest.frontOperation.fail!==t.stencilTest.frontOperation.fail||e.stencilTest.frontOperation.zFail!==t.stencilTest.frontOperation.zFail||e.stencilTest.backOperation.fail!==t.stencilTest.backOperation.fail||e.stencilTest.backOperation.zFail!==t.stencilTest.backOperation.zFail||e.stencilTest.backOperation.zPass!==t.stencilTest.backOperation.zPass)&&i.push(Die),(e.sampleCoverage.enabled!==t.sampleCoverage.enabled||e.sampleCoverage.value!==t.sampleCoverage.value||e.sampleCoverage.invert!==t.sampleCoverage.invert)&&i.push(Iie),i}Ph.apply=function(e,t,i){gie(e,t),yie(e,t),xie(e,t),bie(e,t),Aie(e,t),Cie(e,t),Eie(e,t),Sie(e,t),wie(e,t),Die(e,t),Iie(e,t),Tie(e,t,i),vie(e,t,i),Pie(e,t,i)},Ph.partialApply=function(e,t,i,n,r,o){if(t!==i){let n=i._applyFunctions[t.id];u(n)||(n=QNe(t,i),i._applyFunctions[t.id]=n);let r=n.length;for(let t=0;t<r;++t)n[t](e,i)}((u(n.scissorTest)?n.scissorTest:t.scissorTest)!==(u(r.scissorTest)?r.scissorTest:i.scissorTest)||o)&&Tie(e,i,r);let a=u(n.blendingEnabled)?n.blendingEnabled:t.blending.enabled,s=u(r.blendingEnabled)?r.blendingEnabled:i.blending.enabled;(a!==s||s&&t.blending!==i.blending)&&vie(e,i,r),(t!==i||n!==r||n.context!==r.context)&&Pie(e,i,r)},Ph.getState=function(e){return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:qe.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:z.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:u(e.viewport)?qe.clone(e.viewport):void 0}};var Ue=Ph,JNe=new h;function Ht(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var Ls={};Ls[ee.FLOAT]="float",Ls[ee.FLOAT_VEC2]="vec2",Ls[ee.FLOAT_VEC3]="vec3",Ls[ee.FLOAT_VEC4]="vec4",Ls[ee.INT]="int",Ls[ee.INT_VEC2]="ivec2",Ls[ee.INT_VEC3]="ivec3",Ls[ee.INT_VEC4]="ivec4",Ls[ee.BOOL]="bool",Ls[ee.BOOL_VEC2]="bvec2",Ls[ee.BOOL_VEC3]="bvec3",Ls[ee.BOOL_VEC4]="bvec4",Ls[ee.FLOAT_MAT2]="mat2",Ls[ee.FLOAT_MAT3]="mat3",Ls[ee.FLOAT_MAT4]="mat4",Ls[ee.SAMPLER_2D]="sampler2D",Ls[ee.SAMPLER_CUBE]="samplerCube",Ht.prototype.getDeclaration=function(e){let t=`uniform ${Ls[this._datatype]} ${e}`,i=this._size;return t+=1===i?";":`[${i.toString()}];`,t};var e2e={czm_viewport:new Ht({size:1,datatype:ee.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new Ht({size:1,datatype:ee.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new Ht({size:1,datatype:ee.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.eyeHeight}}),czm_eyeHeight2D:new Ht({size:1,datatype:ee.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new Ht({size:1,datatype:ee.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new Ht({size:1,datatype:ee.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new Ht({size:1,datatype:ee.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_farDepthFromNearPlusOne:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.farDepthFromNearPlusOne}}),czm_log2FarDepthFromNearPlusOne:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.log2FarDepthFromNearPlusOne}}),czm_oneOverLog2FarDepthFromNearPlusOne:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.oneOverLog2FarDepthFromNearPlusOne}}),czm_sunPositionWC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_lightDirectionEC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.lightDirectionEC}}),czm_lightDirectionWC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.lightDirectionWC}}),czm_lightColor:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.lightColor}}),czm_lightColorHdr:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.lightColorHdr}}),czm_encodedCameraPositionMCHigh:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return L.getTranslation(e.inverseView,JNe)}}),czm_frameNumber:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new Ht({size:1,datatype:ee.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new Ht({size:1,datatype:ee.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new Ht({size:1,datatype:ee.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_specularEnvironmentMaps:new Ht({size:1,datatype:ee.SAMPLER_2D,getValue:function(e){return e.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new Ht({size:1,datatype:ee.FLOAT_VEC2,getValue:function(e){return e.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new Ht({size:9,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new Ht({size:1,datatype:ee.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_pixelRatio:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.pixelRatio}}),czm_fogDensity:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.fogDensity}}),czm_splitPosition:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.splitPosition}}),czm_geometricToleranceOverMeter:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new Ht({size:1,datatype:ee.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}}),czm_gamma:new Ht({size:1,datatype:ee.FLOAT,getValue:function(e){return e.gamma}}),czm_ellipsoidRadii:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.radii}}),czm_ellipsoidInverseRadii:new Ht({size:1,datatype:ee.FLOAT_VEC3,getValue:function(e){return e.ellipsoid.oneOverRadii}})},eg=e2e;function t2e(e,t,i,n){switch(t.type){case e.FLOAT:return new Oie(e,t,i,n);case e.FLOAT_VEC2:return new Rie(e,t,i,n);case e.FLOAT_VEC3:return new Mie(e,t,i,n);case e.FLOAT_VEC4:return new Lie(e,t,i,n);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new S6(e,t,i,n);case e.INT:case e.BOOL:return new Nie(e,t,i,n);case e.INT_VEC2:case e.BOOL_VEC2:return new Fie(e,t,i,n);case e.INT_VEC3:case e.BOOL_VEC3:return new Bie(e,t,i,n);case e.INT_VEC4:case e.BOOL_VEC4:return new kie(e,t,i,n);case e.FLOAT_MAT2:return new Vie(e,t,i,n);case e.FLOAT_MAT3:return new Uie(e,t,i,n);case e.FLOAT_MAT4:return new zie(e,t,i,n);default:throw new ue(`Unrecognized uniform type: ${t.type} for uniform "${i}".`)}}function Oie(e,t,i,n){this.name=i,this.value=void 0,this._value=0,this._gl=e,this._location=n}function Rie(e,t,i,n){this.name=i,this.value=void 0,this._value=new U,this._gl=e,this._location=n}function Mie(e,t,i,n){this.name=i,this.value=void 0,this._value=void 0,this._gl=e,this._location=n}function Lie(e,t,i,n){this.name=i,this.value=void 0,this._value=void 0,this._gl=e,this._location=n}function S6(e,t,i,n){this.name=i,this.value=void 0,this._gl=e,this._location=n,this.textureUnitIndex=void 0}function Nie(e,t,i,n){this.name=i,this.value=void 0,this._value=0,this._gl=e,this._location=n}function Fie(e,t,i,n){this.name=i,this.value=void 0,this._value=new U,this._gl=e,this._location=n}function Bie(e,t,i,n){this.name=i,this.value=void 0,this._value=new h,this._gl=e,this._location=n}function kie(e,t,i,n){this.name=i,this.value=void 0,this._value=new oe,this._gl=e,this._location=n}Oie.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},Rie.prototype.set=function(){let e=this.value;U.equals(e,this._value)||(U.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))},Mie.prototype.set=function(){let e=this.value;u(e.red)?z.equals(e,this._value)||(this._value=z.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):u(e.x)&&(h.equals(e,this._value)||(this._value=h.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))},Lie.prototype.set=function(){let e=this.value;u(e.red)?z.equals(e,this._value)||(this._value=z.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):u(e.x)&&(oe.equals(e,this._value)||(this._value=oe.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))},S6.prototype.set=function(){let e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);let t=this.value;e.bindTexture(t._target,t._texture)},S6.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1},Nie.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},Fie.prototype.set=function(){let e=this.value;U.equals(e,this._value)||(U.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))},Bie.prototype.set=function(){let e=this.value;h.equals(e,this._value)||(h.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))},kie.prototype.set=function(){let e=this.value;oe.equals(e,this._value)||(oe.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var n2e=new Float32Array(4);function Vie(e,t,i,n){this.name=i,this.value=void 0,this._value=new Ji,this._gl=e,this._location=n}Vie.prototype.set=function(){if(!Ji.equalsArray(this.value,this._value,0)){Ji.clone(this.value,this._value);let e=Ji.toArray(this.value,n2e);this._gl.uniformMatrix2fv(this._location,!1,e)}};var i2e=new Float32Array(9);function Uie(e,t,i,n){this.name=i,this.value=void 0,this._value=new $,this._gl=e,this._location=n}Uie.prototype.set=function(){if(!$.equalsArray(this.value,this._value,0)){$.clone(this.value,this._value);let e=$.toArray(this.value,i2e);this._gl.uniformMatrix3fv(this._location,!1,e)}};var o2e=new Float32Array(16);function zie(e,t,i,n){this.name=i,this.value=void 0,this._value=new L,this._gl=e,this._location=n}zie.prototype.set=function(){if(!L.equalsArray(this.value,this._value,0)){L.clone(this.value,this._value);let e=L.toArray(this.value,o2e);this._gl.uniformMatrix4fv(this._location,!1,e)}};var eR=t2e;function r2e(e,t,i,n){switch(t.type){case e.FLOAT:return new Hie(e,t,i,n);case e.FLOAT_VEC2:return new Gie(e,t,i,n);case e.FLOAT_VEC3:return new Wie(e,t,i,n);case e.FLOAT_VEC4:return new jie(e,t,i,n);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new w6(e,t,i,n);case e.INT:case e.BOOL:return new qie(e,t,i,n);case e.INT_VEC2:case e.BOOL_VEC2:return new Yie(e,t,i,n);case e.INT_VEC3:case e.BOOL_VEC3:return new Xie(e,t,i,n);case e.INT_VEC4:case e.BOOL_VEC4:return new Kie(e,t,i,n);case e.FLOAT_MAT2:return new Zie(e,t,i,n);case e.FLOAT_MAT3:return new $ie(e,t,i,n);case e.FLOAT_MAT4:return new Qie(e,t,i,n);default:throw new ue(`Unrecognized uniform type: ${t.type} for uniform "${i}".`)}}function Hie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=e,this._location=n[0]}function Gie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(2*r),this._gl=e,this._location=n[0]}function Wie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(3*r),this._gl=e,this._location=n[0]}function jie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(4*r),this._gl=e,this._location=n[0]}function w6(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=e,this._locations=n,this.textureUnitIndex=void 0}function qie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r),this._gl=e,this._location=n[0]}function Yie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(2*r),this._gl=e,this._location=n[0]}function Xie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(3*r),this._gl=e,this._location=n[0]}function Kie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(4*r),this._gl=e,this._location=n[0]}function Zie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(4*r),this._gl=e,this._location=n[0]}function $ie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(9*r),this._gl=e,this._location=n[0]}function Qie(e,t,i,n){let r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(16*r),this._gl=e,this._location=n[0]}Hie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1;for(let r=0;r<t;++r){let t=e[r];t!==i[r]&&(i[r]=t,n=!0)}n&&this._gl.uniform1fv(this._location,i)},Gie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];U.equalsArray(t,i,r)||(U.pack(t,i,r),n=!0),r+=2}n&&this._gl.uniform2fv(this._location,i)},Wie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];u(t.red)?(t.red!==i[r]||t.green!==i[r+1]||t.blue!==i[r+2])&&(i[r]=t.red,i[r+1]=t.green,i[r+2]=t.blue,n=!0):u(t.x)&&(h.equalsArray(t,i,r)||(h.pack(t,i,r),n=!0)),r+=3}n&&this._gl.uniform3fv(this._location,i)},jie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];u(t.red)?z.equalsArray(t,i,r)||(z.pack(t,i,r),n=!0):u(t.x)&&(oe.equalsArray(t,i,r)||(oe.pack(t,i,r),n=!0)),r+=4}n&&this._gl.uniform4fv(this._location,i)},w6.prototype.set=function(){let e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,i=this.value,n=i.length;for(let r=0;r<n;++r){let n=i[r];e.activeTexture(t+r),e.bindTexture(n._target,n._texture)}},w6.prototype._setSampler=function(e){this.textureUnitIndex=e;let t=this._locations,i=t.length;for(let n=0;n<i;++n){let i=e+n;this._gl.uniform1i(t[n],i)}return e+i},qie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1;for(let r=0;r<t;++r){let t=e[r];t!==i[r]&&(i[r]=t,n=!0)}n&&this._gl.uniform1iv(this._location,i)},Yie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];U.equalsArray(t,i,r)||(U.pack(t,i,r),n=!0),r+=2}n&&this._gl.uniform2iv(this._location,i)},Xie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];h.equalsArray(t,i,r)||(h.pack(t,i,r),n=!0),r+=3}n&&this._gl.uniform3iv(this._location,i)},Kie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];oe.equalsArray(t,i,r)||(oe.pack(t,i,r),n=!0),r+=4}n&&this._gl.uniform4iv(this._location,i)},Zie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];Ji.equalsArray(t,i,r)||(Ji.pack(t,i,r),n=!0),r+=4}n&&this._gl.uniformMatrix2fv(this._location,!1,i)},$ie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];$.equalsArray(t,i,r)||($.pack(t,i,r),n=!0),r+=9}n&&this._gl.uniformMatrix3fv(this._location,!1,i)},Qie.prototype.set=function(){let e=this.value,t=e.length,i=this._value,n=!1,r=0;for(let o=0;o<t;++o){let t=e[o];L.equalsArray(t,i,r)||(L.pack(t,i,r),n=!0),r+=16}n&&this._gl.uniformMatrix4fv(this._location,!1,i)};var tR=r2e,s2e=0;function ep(e){let t=e.vertexShaderText,i=e.fragmentShaderText;typeof spector<"u"&&(t=t.replace(/^#line/gm,"//#line"),i=i.replace(/^#line/gm,"//#line"));let n=a2e(t,i);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=n.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=n.fragmentShaderText,this.id=s2e++}function Jie(e){let t=[],i=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(u(i)){let e=i.length;for(let n=0;n<e;n++){let e=i[n].trim(),r=e.slice(e.lastIndexOf(" ")+1);t.push(r)}}return t}function a2e(e,t){let i={};if(!zt.highpFloatSupported||!zt.highpIntSupported){let n,r,o,a,s=Jie(e),l=Jie(t),u=s.length,c=l.length;for(n=0;n<u;n++)for(r=0;r<c;r++)if(s[n]===l[r]){o=s[n],a=`czm_mediump_${o}`;let e=new RegExp(`${o}\\b`,"g");t=t.replace(e,a),i[a]=o}}return{fragmentShaderText:t,duplicateUniformNames:i}}ep.fromCache=function(e){return(e=y(e,y.EMPTY_OBJECT)).context.shaderCache.getShaderProgram(e)},ep.replaceCache=function(e){return(e=y(e,y.EMPTY_OBJECT)).context.shaderCache.replaceShaderProgram(e)},Object.defineProperties(ep.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return nR(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return nR(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return nR(this),this._uniformsByName}}});var Oh="[Cesium WebGL] ";function c2e(e,t){let i=t._vertexShaderText,n=t._fragmentShaderText,r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,i),e.compileShader(r);let o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);let a=e.createProgram();e.attachShader(a,r),e.attachShader(a,o);let s,l=t._attributeLocations;if(u(l))for(let t in l)l.hasOwnProperty(t)&&e.bindAttribLocation(a,l[t],t);if(e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))return t._logShaderCompilation&&(s=e.getShaderInfoLog(r),u(s)&&s.length>0&&console.log(`${Oh}Vertex shader compile log: ${s}`),s=e.getShaderInfoLog(o),u(s)&&s.length>0&&console.log(`${Oh}Fragment shader compile log: ${s}`),s=e.getProgramInfoLog(a),u(s)&&s.length>0&&console.log(`${Oh}Shader program link log: ${s}`)),e.deleteShader(r),e.deleteShader(o),a;let c,h=t._debugShaders;throw e.getShaderParameter(o,e.COMPILE_STATUS)?e.getShaderParameter(r,e.COMPILE_STATUS)?(s=e.getProgramInfoLog(a),console.error(`${Oh}Shader program link log: ${s}`),d(r,"vertex"),d(o,"fragment"),c=`Program failed to link.  Link log: ${s}`):(s=e.getShaderInfoLog(r),console.error(`${Oh}Vertex shader compile log: ${s}`),console.error(`${Oh} Vertex shader source:\n${i}`),c=`Vertex shader failed to compile.  Compile log: ${s}`):(s=e.getShaderInfoLog(o),console.error(`${Oh}Fragment shader compile log: ${s}`),console.error(`${Oh} Fragment shader source:\n${n}`),c=`Fragment shader failed to compile.  Compile log: ${s}`),e.deleteShader(r),e.deleteShader(o),e.deleteProgram(a),new ue(c);function d(e,t){if(!u(h))return;let i=h.getTranslatedShaderSource(e);""!==i?console.error(`${Oh}Translated ${t} shaderSource:\n${i}`):console.error(`${Oh}${t} shader translation failed.`)}}function l2e(e,t,i){let n={};for(let r=0;r<i;++r){let i=e.getActiveAttrib(t,r),o=e.getAttribLocation(t,i.name);n[i.name]={name:i.name,type:i.type,index:o}}return n}function u2e(e,t){let i={},n=[],r=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<o;++a){let o=e.getActiveUniform(t,a),s="[0]",l=-1!==o.name.indexOf(s,o.name.length-s.length)?o.name.slice(0,o.name.length-3):o.name;if(0!==l.indexOf("gl_"))if(o.name.indexOf("[")<0){let a=e.getUniformLocation(t,l);if(null!==a){let t=eR(e,o,l,a);i[l]=t,n.push(t),t._setSampler&&r.push(t)}}else{let a,s,c,h,d=l.indexOf("[");if(d>=0){if(a=i[l.slice(0,d)],!u(a))continue;s=a._locations,s.length<=1&&(c=a.value,h=e.getUniformLocation(t,l),null!==h&&(s.push(h),c.push(e.getUniform(t,h))))}else{s=[];for(let i=0;i<o.size;++i)h=e.getUniformLocation(t,`${l}[${i}]`),null!==h&&s.push(h);a=tR(e,o,l,s),i[l]=a,n.push(a),a._setSampler&&r.push(a)}}}return{uniformsByName:i,uniforms:n,samplerUniforms:r}}function f2e(e,t){let i=[],n=[];for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],a=r,s=e._duplicateUniformNames[a];u(s)&&(o.name=s,a=s);let l=eg[a];u(l)?i.push({uniform:o,automaticUniform:l}):n.push(o)}return{automaticUniforms:i,manualUniforms:n}}function d2e(e,t,i){e.useProgram(t);let n=0,r=i.length;for(let e=0;e<r;++e)n=i[e]._setSampler(n);return e.useProgram(null),n}function nR(e){u(e._program)||eoe(e)}function eoe(e){let t=e._program,i=e._gl,n=c2e(i,e,e._debugShaders),r=i.getProgramParameter(n,i.ACTIVE_ATTRIBUTES),o=u2e(i,n),a=f2e(e,o.uniformsByName);e._program=n,e._numberOfVertexAttributes=r,e._vertexAttributes=l2e(i,n,r),e._uniformsByName=o.uniformsByName,e._uniforms=o.uniforms,e._automaticUniforms=a.automaticUniforms,e._manualUniforms=a.manualUniforms,e.maximumTextureUnitIndex=d2e(i,n,o.samplerUniforms),t&&e._gl.deleteProgram(t),typeof spector<"u"&&(e._program.__SPECTOR_rebuildProgram=function(t,i,n,r){let o=e._vertexShaderText,a=e._fragmentShaderText,s=/ ! = /g;e._vertexShaderText=t.replace(s," != "),e._fragmentShaderText=i.replace(s," != ");try{eoe(e),n(e._program)}catch(t){e._vertexShaderText=o,e._fragmentShaderText=a;let i=/(?:Compile|Link) error: ([^]*)/.exec(t.message);r(i?i[1]:t.message)}})}ep.prototype._bind=function(){nR(this),this._gl.useProgram(this._program)},ep.prototype._setUniforms=function(e,t,i){let n,r;if(u(e)){let t=this._manualUniforms;for(n=t.length,r=0;r<n;++r){let i=t[r];i.value=e[i.name]()}}let o=this._automaticUniforms;for(n=o.length,r=0;r<n;++r){let e=o[r];e.uniform.value=e.automaticUniform.getValue(t)}let a=this._uniforms;for(n=a.length,r=0;r<n;++r)a[r].set();if(i){let e=this._gl,t=this._program;e.validateProgram(t)}},ep.prototype.isDestroyed=function(){return!1},ep.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},ep.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),le(this)};var Kt=ep,iR="/**\n * A built-in GLSL floating-point constant for converting radians to degrees.\n *\n * @alias czm_degreesPerRadian\n * @glslConstant\n *\n * @see CesiumMath.DEGREES_PER_RADIAN\n *\n * @example\n * // GLSL declaration\n * const float czm_degreesPerRadian = ...;\n *\n * // Example\n * float deg = czm_degreesPerRadian * rad;\n */\nconst float czm_degreesPerRadian = 57.29577951308232;\n",oR="/**\n * A built-in GLSL vec2 constant for defining the depth range.\n * This is a workaround to a bug where IE11 does not implement gl_DepthRange.\n *\n * @alias czm_depthRange\n * @glslConstant\n *\n * @example\n * // GLSL declaration\n * float depthRangeNear = czm_depthRange.near;\n * float depthRangeFar = czm_depthRange.far;\n *\n */\nconst czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n",rR="/**\n * 0.1\n *\n * @name czm_epsilon1\n * @glslConstant\n */\nconst float czm_epsilon1 = 0.1;\n",sR="/**\n * 0.01\n *\n * @name czm_epsilon2\n * @glslConstant\n */\nconst float czm_epsilon2 = 0.01;\n",aR="/**\n * 0.001\n *\n * @name czm_epsilon3\n * @glslConstant\n */\nconst float czm_epsilon3 = 0.001;\n",cR="/**\n * 0.0001\n *\n * @name czm_epsilon4\n * @glslConstant\n */\nconst float czm_epsilon4 = 0.0001;\n",lR="/**\n * 0.00001\n *\n * @name czm_epsilon5\n * @glslConstant\n */\nconst float czm_epsilon5 = 0.00001;\n",uR="/**\n * 0.000001\n *\n * @name czm_epsilon6\n * @glslConstant\n */\nconst float czm_epsilon6 = 0.000001;\n",fR="/**\n * 0.0000001\n *\n * @name czm_epsilon7\n * @glslConstant\n */\nconst float czm_epsilon7 = 0.0000001;\n",dR="/**\n * DOC_TBA\n *\n * @name czm_infinity\n * @glslConstant\n */\nconst float czm_infinity = 5906376272000.0;  // Distance from the Sun to Pluto in meters.  TODO: What is best given lowp, mediump, and highp?\n",hR="/**\n * A built-in GLSL floating-point constant for <code>1/pi</code>.\n *\n * @alias czm_oneOverPi\n * @glslConstant\n *\n * @see CesiumMath.ONE_OVER_PI\n *\n * @example\n * // GLSL declaration\n * const float czm_oneOverPi = ...;\n *\n * // Example\n * float pi = 1.0 / czm_oneOverPi;\n */\nconst float czm_oneOverPi = 0.3183098861837907;\n",mR="/**\n * A built-in GLSL floating-point constant for <code>1/2pi</code>.\n *\n * @alias czm_oneOverTwoPi\n * @glslConstant\n *\n * @see CesiumMath.ONE_OVER_TWO_PI\n *\n * @example\n * // GLSL declaration\n * const float czm_oneOverTwoPi = ...;\n *\n * // Example\n * float pi = 2.0 * czm_oneOverTwoPi;\n */\nconst float czm_oneOverTwoPi = 0.15915494309189535;\n",pR="/**\n * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE}\n *\n * @name czm_passCesium3DTile\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passCesium3DTile = 4.0;\n",_R="/**\n * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE_CLASSIFICATION}\n *\n * @name czm_passCesium3DTileClassification\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passCesium3DTileClassification = 5.0;\n",gR="/**\n * The automatic GLSL constant for {@link Pass#CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW}\n *\n * @name czm_passCesium3DTileClassificationIgnoreShow\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passCesium3DTileClassificationIgnoreShow = 6.0;\n",yR="/**\n * The automatic GLSL constant for {@link Pass#CLASSIFICATION}\n *\n * @name czm_passClassification\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passClassification = 7.0;\n",xR="/**\n * The automatic GLSL constant for {@link Pass#COMPUTE}\n *\n * @name czm_passCompute\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passCompute = 1.0;\n",bR="/**\n * The automatic GLSL constant for {@link Pass#ENVIRONMENT}\n *\n * @name czm_passEnvironment\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passEnvironment = 0.0;\n",TR="/**\n * The automatic GLSL constant for {@link Pass#GLOBE}\n *\n * @name czm_passGlobe\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passGlobe = 2.0;\n",AR="/**\n * The automatic GLSL constant for {@link Pass#OPAQUE}\n *\n * @name czm_passOpaque\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passOpaque = 7.0;\n",CR="/**\n * The automatic GLSL constant for {@link Pass#OVERLAY}\n *\n * @name czm_passOverlay\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passOverlay = 10.0;\n",ER="/**\n * The automatic GLSL constant for {@link Pass#TERRAIN_CLASSIFICATION}\n *\n * @name czm_passTerrainClassification\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passTerrainClassification = 3.0;\n",SR="/**\n * The automatic GLSL constant for {@link Pass#TRANSLUCENT}\n *\n * @name czm_passTranslucent\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passTranslucent = 8.0;\n",wR="/**\n * The automatic GLSL constant for {@link Pass#VOXELS}\n *\n * @name czm_passVoxels\n * @glslConstant\n *\n * @see czm_pass\n */\nconst float czm_passVoxels = 9.0;\n",vR="/**\n * A built-in GLSL floating-point constant for <code>Math.PI</code>.\n *\n * @alias czm_pi\n * @glslConstant\n *\n * @see CesiumMath.PI\n *\n * @example\n * // GLSL declaration\n * const float czm_pi = ...;\n *\n * // Example\n * float twoPi = 2.0 * czm_pi;\n */\nconst float czm_pi = 3.141592653589793;\n",DR="/**\n * A built-in GLSL floating-point constant for <code>pi/4</code>.\n *\n * @alias czm_piOverFour\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_FOUR\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverFour = ...;\n *\n * // Example\n * float pi = 4.0 * czm_piOverFour;\n */\nconst float czm_piOverFour = 0.7853981633974483;\n",IR="/**\n * A built-in GLSL floating-point constant for <code>pi/6</code>.\n *\n * @alias czm_piOverSix\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_SIX\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverSix = ...;\n *\n * // Example\n * float pi = 6.0 * czm_piOverSix;\n */\nconst float czm_piOverSix = 0.5235987755982988;\n",PR="/**\n * A built-in GLSL floating-point constant for <code>pi/3</code>.\n *\n * @alias czm_piOverThree\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_THREE\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverThree = ...;\n *\n * // Example\n * float pi = 3.0 * czm_piOverThree;\n */\nconst float czm_piOverThree = 1.0471975511965976;\n",OR="/**\n * A built-in GLSL floating-point constant for <code>pi/2</code>.\n *\n * @alias czm_piOverTwo\n * @glslConstant\n *\n * @see CesiumMath.PI_OVER_TWO\n *\n * @example\n * // GLSL declaration\n * const float czm_piOverTwo = ...;\n *\n * // Example\n * float pi = 2.0 * czm_piOverTwo;\n */\nconst float czm_piOverTwo = 1.5707963267948966;\n",RR="/**\n * A built-in GLSL floating-point constant for converting degrees to radians.\n *\n * @alias czm_radiansPerDegree\n * @glslConstant\n *\n * @see CesiumMath.RADIANS_PER_DEGREE\n *\n * @example\n * // GLSL declaration\n * const float czm_radiansPerDegree = ...;\n *\n * // Example\n * float rad = czm_radiansPerDegree * deg;\n */\nconst float czm_radiansPerDegree = 0.017453292519943295;\n",MR="/**\n * The constant identifier for the 2D {@link SceneMode}\n *\n * @name czm_sceneMode2D\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneModeColumbusView\n * @see czm_sceneMode3D\n * @see czm_sceneModeMorphing\n */\nconst float czm_sceneMode2D = 2.0;\n",LR="/**\n * The constant identifier for the 3D {@link SceneMode}\n *\n * @name czm_sceneMode3D\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneMode2D\n * @see czm_sceneModeColumbusView\n * @see czm_sceneModeMorphing\n */\nconst float czm_sceneMode3D = 3.0;\n",NR="/**\n * The constant identifier for the Columbus View {@link SceneMode}\n *\n * @name czm_sceneModeColumbusView\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneMode2D\n * @see czm_sceneMode3D\n * @see czm_sceneModeMorphing\n */\nconst float czm_sceneModeColumbusView = 1.0;\n",FR="/**\n * The constant identifier for the Morphing {@link SceneMode}\n *\n * @name czm_sceneModeMorphing\n * @glslConstant\n * @see czm_sceneMode\n * @see czm_sceneMode2D\n * @see czm_sceneModeColumbusView\n * @see czm_sceneMode3D\n */\nconst float czm_sceneModeMorphing = 0.0;\n",BR="/**\n * A built-in GLSL floating-point constant for one solar radius.\n *\n * @alias czm_solarRadius\n * @glslConstant\n *\n * @see CesiumMath.SOLAR_RADIUS\n *\n * @example\n * // GLSL declaration\n * const float czm_solarRadius = ...;\n */\nconst float czm_solarRadius = 695500000.0;\n",kR="/**\n * A built-in GLSL floating-point constant for <code>3pi/2</code>.\n *\n * @alias czm_threePiOver2\n * @glslConstant\n *\n * @see CesiumMath.THREE_PI_OVER_TWO\n *\n * @example\n * // GLSL declaration\n * const float czm_threePiOver2 = ...;\n *\n * // Example\n * float pi = (2.0 / 3.0) * czm_threePiOver2;\n */\nconst float czm_threePiOver2 = 4.71238898038469;\n",VR="/**\n * A built-in GLSL floating-point constant for <code>2pi</code>.\n *\n * @alias czm_twoPi\n * @glslConstant\n *\n * @see CesiumMath.TWO_PI\n *\n * @example\n * // GLSL declaration\n * const float czm_twoPi = ...;\n *\n * // Example\n * float pi = czm_twoPi / 2.0;\n */\nconst float czm_twoPi = 6.283185307179586;\n",UR="/**\n * The maximum latitude, in radians, both North and South, supported by a Web Mercator\n * (EPSG:3857) projection.  Technically, the Mercator projection is defined\n * for any latitude up to (but not including) 90 degrees, but it makes sense\n * to cut it off sooner because it grows exponentially with increasing latitude.\n * The logic behind this particular cutoff value, which is the one used by\n * Google Maps, Bing Maps, and Esri, is that it makes the projection\n * square.  That is, the rectangle is equal in the X and Y directions.\n *\n * The constant value is computed as follows:\n *   czm_pi * 0.5 - (2.0 * atan(exp(-czm_pi)))\n *\n * @name czm_webMercatorMaxLatitude\n * @glslConstant\n */\nconst float czm_webMercatorMaxLatitude = 1.4844222297453324;\n",zR="/**\n * @name czm_depthRangeStruct\n * @glslStruct\n */\nstruct czm_depthRangeStruct\n{\n    float near;\n    float far;\n};\n",HR="/**\n * Holds material information that can be used for lighting. Returned by all czm_getMaterial functions.\n *\n * @name czm_material\n * @glslStruct\n *\n * @property {vec3} diffuse Incoming light that scatters evenly in all directions.\n * @property {float} specular Intensity of incoming light reflecting in a single direction.\n * @property {float} shininess The sharpness of the specular reflection.  Higher values create a smaller, more focused specular highlight.\n * @property {vec3} normal Surface's normal in eye coordinates. It is used for effects such as normal mapping. The default is the surface's unmodified normal.\n * @property {vec3} emission Light emitted by the material equally in all directions. The default is vec3(0.0), which emits no light.\n * @property {float} alpha Alpha of this material. 0.0 is completely transparent; 1.0 is completely opaque.\n */\nstruct czm_material\n{\n    vec3 diffuse;\n    float specular;\n    float shininess;\n    vec3 normal;\n    vec3 emission;\n    float alpha;\n};\n",GR="/**\n * Used as input to every material's czm_getMaterial function.\n *\n * @name czm_materialInput\n * @glslStruct\n *\n * @property {float} s 1D texture coordinates.\n * @property {vec2} st 2D texture coordinates.\n * @property {vec3} str 3D texture coordinates.\n * @property {vec3} normalEC Unperturbed surface normal in eye coordinates.\n * @property {mat3} tangentToEyeMatrix Matrix for converting a tangent space normal to eye space.\n * @property {vec3} positionToEyeEC Vector from the fragment to the eye in eye coordinates.  The magnitude is the distance in meters from the fragment to the eye.\n * @property {float} height The height of the terrain in meters above or below the WGS84 ellipsoid.  Only available for globe materials.\n * @property {float} slope The slope of the terrain in radians.  0 is flat; pi/2 is vertical.  Only available for globe materials.\n * @property {float} aspect The aspect of the terrain in radians.  0 is East, pi/2 is North, pi is West, 3pi/2 is South.  Only available for globe materials.\n */\nstruct czm_materialInput\n{\n    float s;\n    vec2 st;\n    vec3 str;\n    vec3 normalEC;\n    mat3 tangentToEyeMatrix;\n    vec3 positionToEyeEC;\n    float height;\n    float slope;\n    float aspect;\n};\n",WR="/**\n * Struct for representing a material for a {@link Model}. The model\n * rendering pipeline will pass this struct between material, custom shaders,\n * and lighting stages. This is not to be confused with {@link czm_material}\n * which is used by the older Fabric materials system, although they are similar.\n * <p>\n * All color values (diffuse, specular, emissive) are in linear color space.\n * </p>\n *\n * @name czm_modelMaterial\n * @glslStruct\n *\n * @property {vec3} diffuse Incoming light that scatters evenly in all directions.\n * @property {float} alpha Alpha of this material. 0.0 is completely transparent; 1.0 is completely opaque.\n * @property {vec3} specular Color of reflected light at normal incidence in PBR materials. This is sometimes referred to as f0 in the literature.\n * @property {float} roughness A number from 0.0 to 1.0 representing how rough the surface is. Values near 0.0 produce glossy surfaces, while values near 1.0 produce rough surfaces.\n * @property {vec3} normalEC Surface's normal in eye coordinates. It is used for effects such as normal mapping. The default is the surface's unmodified normal.\n * @property {float} occlusion Ambient occlusion recieved at this point on the material. 1.0 means fully lit, 0.0 means fully occluded.\n * @property {vec3} emissive Light emitted by the material equally in all directions. The default is vec3(0.0), which emits no light.\n */\nstruct czm_modelMaterial {\n    vec3 diffuse;\n    float alpha;\n    vec3 specular;\n    float roughness;\n    vec3 normalEC;\n    float occlusion;\n    vec3 emissive;\n};\n",jR="/**\n * Struct for representing the output of a custom vertex shader.\n * \n * @name czm_modelVertexOutput\n * @glslStruct\n *\n * @see {@link CustomShader}\n * @see {@link Model}\n *\n * @property {vec3} positionMC The position of the vertex in model coordinates\n * @property {float} pointSize A custom value for gl_PointSize. This is only used for point primitives. \n */\nstruct czm_modelVertexOutput {\n  vec3 positionMC;\n  float pointSize;\n};\n",qR="/**\n * Parameters for {@link czm_pbrLighting}\n *\n * @name czm_material\n * @glslStruct\n *\n * @property {vec3} diffuseColor the diffuse color of the material for the lambert term of the rendering equation\n * @property {float} roughness a value from 0.0 to 1.0 that indicates how rough the surface of the material is.\n * @property {vec3} f0 The reflectance of the material at normal incidence\n */\nstruct czm_pbrParameters\n{\n    vec3 diffuseColor;\n    float roughness;\n    vec3 f0;\n};\n",YR="/**\n * DOC_TBA\n *\n * @name czm_ray\n * @glslStruct\n */\nstruct czm_ray\n{\n    vec3 origin;\n    vec3 direction;\n};\n",XR="/**\n * DOC_TBA\n *\n * @name czm_raySegment\n * @glslStruct\n */\nstruct czm_raySegment\n{\n    float start;\n    float stop;\n};\n\n/**\n * DOC_TBA\n *\n * @name czm_emptyRaySegment\n * @glslConstant \n */\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\n\n/**\n * DOC_TBA\n *\n * @name czm_fullRaySegment\n * @glslConstant \n */\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n",KR="struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\n    vec3 texCoords;\n#else\n    vec2 texCoords;\n#endif\n\n    float depthBias;\n    float depth;\n    float nDotL;\n    vec2 texelStepSize;\n    float normalShadingSmooth;\n    float darkness;\n};\n",ZR="// See:\n//    https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\n\nvec3 czm_acesTonemapping(vec3 color) {\n    float g = 0.985;\n    float a = 0.065;\n    float b = 0.0001;\n    float c = 0.433;\n    float d = 0.238;\n\n    color = (color * (color + a) - b) / (color * (g * color + c) + d);\n\n    color = clamp(color, 0.0, 1.0);\n\n    return color;\n}\n",$R="/**\n * @private\n */\nfloat czm_alphaWeight(float a)\n{\n    float z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\n\n    // See Weighted Blended Order-Independent Transparency for examples of different weighting functions:\n    // http://jcgt.org/published/0002/02/09/\n    return pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));\n}\n",QR="/**\n * Procedural anti-aliasing by blurring two colors that meet at a sharp edge.\n *\n * @name czm_antialias\n * @glslFunction\n *\n * @param {vec4} color1 The color on one side of the edge.\n * @param {vec4} color2 The color on the other side of the edge.\n * @param {vec4} currentcolor The current color, either <code>color1</code> or <code>color2</code>.\n * @param {float} dist The distance to the edge in texture coordinates.\n * @param {float} [fuzzFactor=0.1] Controls the blurriness between the two colors.\n * @returns {vec4} The anti-aliased color.\n *\n * @example\n * // GLSL declarations\n * vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor);\n * vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist);\n *\n * // get the color for a material that has a sharp edge at the line y = 0.5 in texture space\n * float dist = abs(textureCoordinates.t - 0.5);\n * vec4 currentColor = mix(bottomColor, topColor, step(0.5, textureCoordinates.t));\n * vec4 color = czm_antialias(bottomColor, topColor, currentColor, dist, 0.1);\n */\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\n    float val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\n    float val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\n    val1 = val1 * (1.0 - val2);\n    val1 = val1 * val1 * (3.0 - (2.0 * val1));\n    val1 = pow(val1, 0.5); //makes the transition nicer\n    \n    vec4 midColor = (color1 + color2) * 0.5;\n    return mix(midColor, currentColor, val1);\n}\n\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\n    return czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n",JR="/**\n * Approximately computes spherical coordinates given a normal.\n * Uses approximate inverse trigonometry for speed and consistency,\n * since inverse trigonometry can differ from vendor-to-vendor and when compared with the CPU.\n *\n * @name czm_approximateSphericalCoordinates\n * @glslFunction\n *\n * @param {vec3} normal arbitrary-length normal.\n *\n * @returns {vec2} Approximate latitude and longitude spherical coordinates.\n */\nvec2 czm_approximateSphericalCoordinates(vec3 normal) {\n    // Project into plane with vertical for latitude\n    float latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);\n    float longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);\n    return vec2(latitudeApproximation, longitudeApproximation);\n}\n",eM="/**\n * Determines if the fragment is back facing\n *\n * @name czm_backFacing\n * @glslFunction \n * \n * @returns {bool} <code>true</code> if the fragment is back facing; otherwise, <code>false</code>.\n */\nbool czm_backFacing()\n{\n    // !gl_FrontFacing doesn't work as expected on Mac/Intel so use the more verbose form instead. See https://github.com/CesiumGS/cesium/pull/8494.\n    return gl_FrontFacing == false;\n}\n",tM="/**\n * Branchless ternary operator to be used when it's inexpensive to explicitly\n * evaluate both possibilities for a float expression.\n *\n * @name czm_branchFreeTernary\n * @glslFunction\n *\n * @param {bool} comparison A comparison statement\n * @param {float} a Value to return if the comparison is true.\n * @param {float} b Value to return if the comparison is false.\n *\n * @returns {float} equivalent of comparison ? a : b\n */\nfloat czm_branchFreeTernary(bool comparison, float a, float b) {\n    float useA = float(comparison);\n    return a * useA + b * (1.0 - useA);\n}\n\n/**\n * Branchless ternary operator to be used when it's inexpensive to explicitly\n * evaluate both possibilities for a vec2 expression.\n *\n * @name czm_branchFreeTernary\n * @glslFunction\n *\n * @param {bool} comparison A comparison statement\n * @param {vec2} a Value to return if the comparison is true.\n * @param {vec2} b Value to return if the comparison is false.\n *\n * @returns {vec2} equivalent of comparison ? a : b\n */\nvec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {\n    float useA = float(comparison);\n    return a * useA + b * (1.0 - useA);\n}\n\n/**\n * Branchless ternary operator to be used when it's inexpensive to explicitly\n * evaluate both possibilities for a vec3 expression.\n *\n * @name czm_branchFreeTernary\n * @glslFunction\n *\n * @param {bool} comparison A comparison statement\n * @param {vec3} a Value to return if the comparison is true.\n * @param {vec3} b Value to return if the comparison is false.\n *\n * @returns {vec3} equivalent of comparison ? a : b\n */\nvec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {\n    float useA = float(comparison);\n    return a * useA + b * (1.0 - useA);\n}\n\n/**\n * Branchless ternary operator to be used when it's inexpensive to explicitly\n * evaluate both possibilities for a vec4 expression.\n *\n * @name czm_branchFreeTernary\n * @glslFunction\n *\n * @param {bool} comparison A comparison statement\n * @param {vec3} a Value to return if the comparison is true.\n * @param {vec3} b Value to return if the comparison is false.\n *\n * @returns {vec3} equivalent of comparison ? a : b\n */\nvec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {\n    float useA = float(comparison);\n    return a * useA + b * (1.0 - useA);\n}\n",nM="\nvec4 czm_cascadeColor(vec4 weights)\n{\n    return vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\n           vec4(0.0, 1.0, 0.0, 1.0) * weights.y +\n           vec4(0.0, 0.0, 1.0, 1.0) * weights.z +\n           vec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n",iM="\nuniform vec4 shadowMap_cascadeDistances;\n\nfloat czm_cascadeDistance(vec4 weights)\n{\n    return dot(shadowMap_cascadeDistances, weights);\n}\n",oM="\nuniform mat4 shadowMap_cascadeMatrices[4];\n\nmat4 czm_cascadeMatrix(vec4 weights)\n{\n    return shadowMap_cascadeMatrices[0] * weights.x +\n           shadowMap_cascadeMatrices[1] * weights.y +\n           shadowMap_cascadeMatrices[2] * weights.z +\n           shadowMap_cascadeMatrices[3] * weights.w;\n}\n",rM="\nuniform vec4 shadowMap_cascadeSplits[2];\n\nvec4 czm_cascadeWeights(float depthEye)\n{\n    // One component is set to 1.0 and all others set to 0.0.\n    vec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\n    vec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\n    return near * far;\n}\n",sM="/**\n * DOC_TBA\n *\n * @name czm_columbusViewMorph\n * @glslFunction\n */\nvec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\n    // Just linear for now.\n    vec3 p = mix(position2D.xyz, position3D.xyz, time);\n    return vec4(p, 1.0);\n}\n",aM="/**\n * Returns a position in model coordinates relative to eye taking into\n * account the current scene mode: 3D, 2D, or Columbus view.\n * <p>\n * This uses standard position attributes, <code>position3DHigh</code>, \n * <code>position3DLow</code>, <code>position2DHigh</code>, and <code>position2DLow</code>, \n * and should be used when writing a vertex shader for an {@link Appearance}.\n * </p>\n *\n * @name czm_computePosition\n * @glslFunction\n *\n * @returns {vec4} The position relative to eye.\n *\n * @example\n * vec4 p = czm_computePosition();\n * v_positionEC = (czm_modelViewRelativeToEye * p).xyz;\n * gl_Position = czm_modelViewProjectionRelativeToEye * p;\n *\n * @see czm_translateRelativeToEye\n */\nvec4 czm_computePosition();\n",cM="/**\n * @private\n */\nvec2 cordic(float angle)\n{\n// Scale the vector by the appropriate factor for the 24 iterations to follow.\n    vec2 vector = vec2(6.0725293500888267e-1, 0.0);\n// Iteration 1\n    float sense = (angle < 0.0) ? -1.0 : 1.0;\n //   float factor = sense * 1.0;  // 2^-0\n    mat2 rotation = mat2(1.0, sense, -sense, 1.0);\n    vector = rotation * vector;\n    angle -= sense * 7.8539816339744828e-1;  // atan(2^-0)\n// Iteration 2\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    float factor = sense * 5.0e-1;  // 2^-1\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 4.6364760900080609e-1;  // atan(2^-1)\n// Iteration 3\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 2.5e-1;  // 2^-2\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 2.4497866312686414e-1;  // atan(2^-2)\n// Iteration 4\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.25e-1;  // 2^-3\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.2435499454676144e-1;  // atan(2^-3)\n// Iteration 5\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 6.25e-2;  // 2^-4\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 6.2418809995957350e-2;  // atan(2^-4)\n// Iteration 6\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.125e-2;  // 2^-5\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.1239833430268277e-2;  // atan(2^-5)\n// Iteration 7\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.5625e-2;  // 2^-6\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.5623728620476831e-2;  // atan(2^-6)\n// Iteration 8\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 7.8125e-3;  // 2^-7\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 7.8123410601011111e-3;  // atan(2^-7)\n// Iteration 9\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.90625e-3;  // 2^-8\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.9062301319669718e-3;  // atan(2^-8)\n// Iteration 10\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.953125e-3;  // 2^-9\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.9531225164788188e-3;  // atan(2^-9)\n// Iteration 11\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 9.765625e-4;  // 2^-10\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 9.7656218955931946e-4;  // atan(2^-10)\n// Iteration 12\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 4.8828125e-4;  // 2^-11\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 4.8828121119489829e-4;  // atan(2^-11)\n// Iteration 13\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 2.44140625e-4;  // 2^-12\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 2.4414062014936177e-4;  // atan(2^-12)\n// Iteration 14\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.220703125e-4;  // 2^-13\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.2207031189367021e-4;  // atan(2^-13)\n// Iteration 15\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 6.103515625e-5;  // 2^-14\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 6.1035156174208773e-5;  // atan(2^-14)\n// Iteration 16\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.0517578125e-5;  // 2^-15\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.0517578115526096e-5;  // atan(2^-15)\n// Iteration 17\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.52587890625e-5;  // 2^-16\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.5258789061315762e-5;  // atan(2^-16)\n// Iteration 18\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 7.62939453125e-6;  // 2^-17\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 7.6293945311019700e-6;  // atan(2^-17)\n// Iteration 19\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 3.814697265625e-6;  // 2^-18\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 3.8146972656064961e-6;  // atan(2^-18)\n// Iteration 20\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.9073486328125e-6;  // 2^-19\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 1.9073486328101870e-6;  // atan(2^-19)\n// Iteration 21\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 9.5367431640625e-7;  // 2^-20\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 9.5367431640596084e-7;  // atan(2^-20)\n// Iteration 22\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 4.76837158203125e-7;  // 2^-21\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 4.7683715820308884e-7;  // atan(2^-21)\n// Iteration 23\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 2.384185791015625e-7;  // 2^-22\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n    angle -= sense * 2.3841857910155797e-7;  // atan(2^-22)\n// Iteration 24\n    sense = (angle < 0.0) ? -1.0 : 1.0;\n    factor = sense * 1.1920928955078125e-7;  // 2^-23\n    rotation[0][1] = factor;\n    rotation[1][0] = -factor;\n    vector = rotation * vector;\n//    angle -= sense * 1.1920928955078068e-7;  // atan(2^-23)\n\n    return vector;\n}\n\n/**\n * Computes the cosine and sine of the provided angle using the CORDIC algorithm.\n *\n * @name czm_cosineAndSine\n * @glslFunction\n *\n * @param {float} angle The angle in radians.\n *\n * @returns {vec2} The resulting cosine of the angle (as the x coordinate) and sine of the angle (as the y coordinate).\n *\n * @example\n * vec2 v = czm_cosineAndSine(czm_piOverSix);\n * float cosine = v.x;\n * float sine = v.y;\n */\nvec2 czm_cosineAndSine(float angle)\n{\n    if (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n    {\n        if (angle < 0.0)\n        {\n            return -cordic(angle + czm_pi);\n        }\n        else\n        {\n            return -cordic(angle - czm_pi);\n        }\n    }\n    else\n    {\n        return cordic(angle);\n    }\n}\n",lM="/**\n * Decompresses texture coordinates that were packed into a single float.\n *\n * @name czm_decompressTextureCoordinates\n * @glslFunction\n *\n * @param {float} encoded The compressed texture coordinates.\n * @returns {vec2} The decompressed texture coordinates.\n */\n vec2 czm_decompressTextureCoordinates(float encoded)\n {\n    float temp = encoded / 4096.0;\n    float xZeroTo4095 = floor(temp);\n    float stx = xZeroTo4095 / 4095.0;\n    float sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\n    return vec2(stx, sty);\n }\n",uM="/**\n * Get default parameters for physically based rendering. These defaults\n * describe a rough dielectric (non-metal) surface (e.g. rough plastic).\n *\n * @return {czm_pbrParameters} Default parameters for {@link czm_pbrLighting}\n */\nczm_pbrParameters czm_defaultPbrMaterial()\n{\n    czm_pbrParameters results;\n    results.diffuseColor = vec3(1.0);\n    results.roughness = 1.0;\n\n    const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);\n    results.f0 = REFLECTANCE_DIELECTRIC;\n    return results;\n}\n",fM="// emulated noperspective\n#if (__VERSION__ == 300 || defined(GL_EXT_frag_depth)) && !defined(LOG_DEPTH)\nout float v_WindowZ;\n#endif\n\n/**\n * Emulates GL_DEPTH_CLAMP, which is not available in WebGL 1 or 2.\n * GL_DEPTH_CLAMP clamps geometry that is outside the near and far planes, \n * capping the shadow volume. More information here: \n * https://www.khronos.org/registry/OpenGL/extensions/ARB/ARB_depth_clamp.txt.\n *\n * When GL_EXT_frag_depth is available we emulate GL_DEPTH_CLAMP by ensuring \n * no geometry gets clipped by setting the clip space z value to 0.0 and then\n * sending the unaltered screen space z value (using emulated noperspective\n * interpolation) to the frag shader where it is clamped to [0,1] and then\n * written with gl_FragDepth (see czm_writeDepthClamp). This technique is based on:\n * https://stackoverflow.com/questions/5960757/how-to-emulate-gl-depth-clamp-nv.\n *\n * When GL_EXT_frag_depth is not available, which is the case on some mobile \n * devices, we must attempt to fix this only in the vertex shader. \n * The approach is to clamp the z value to the far plane, which closes the \n * shadow volume but also distorts the geometry, so there can still be artifacts\n * on frustum seams.\n *\n * @name czm_depthClamp\n * @glslFunction\n *\n * @param {vec4} coords The vertex in clip coordinates.\n * @returns {vec4} The modified vertex.\n *\n * @example\n * gl_Position = czm_depthClamp(czm_modelViewProjection * vec4(position, 1.0));\n *\n * @see czm_writeDepthClamp\n */\nvec4 czm_depthClamp(vec4 coords)\n{\n#ifndef LOG_DEPTH\n#if __VERSION__ == 300 || defined(GL_EXT_frag_depth)\n    v_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;\n    coords.z = 0.0;\n#else\n    coords.z = min(coords.z, coords.w);\n#endif\n#endif\n    return coords;\n}\n",dM="/**\n * Computes a 3x3 rotation matrix that transforms vectors from an ellipsoid's east-north-up coordinate system \n * to eye coordinates.  In east-north-up coordinates, x points east, y points north, and z points along the \n * surface normal.  East-north-up can be used as an ellipsoid's tangent space for operations such as bump mapping.\n * <br /><br />\n * The ellipsoid is assumed to be centered at the model coordinate's origin.\n *\n * @name czm_eastNorthUpToEyeCoordinates\n * @glslFunction\n *\n * @param {vec3} positionMC The position on the ellipsoid in model coordinates.\n * @param {vec3} normalEC The normalized ellipsoid surface normal, at <code>positionMC</code>, in eye coordinates.\n *\n * @returns {mat3} A 3x3 rotation matrix that transforms vectors from the east-north-up coordinate system to eye coordinates.\n *\n * @example\n * // Transform a vector defined in the east-north-up coordinate \n * // system, (0, 0, 1) which is the surface normal, to eye \n * // coordinates.\n * mat3 m = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n * vec3 normalEC = m * vec3(0.0, 0.0, 1.0);\n */\nmat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\n    vec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));  // normalized surface tangent in model coordinates\n    vec3 tangentEC = normalize(czm_normal3D * tangentMC);                // normalized surface tangent in eye coordinates\n    vec3 bitangentEC = normalize(cross(normalEC, tangentEC));            // normalized surface bitangent in eye coordinates\n\n    return mat3(\n        tangentEC.x,   tangentEC.y,   tangentEC.z,\n        bitangentEC.x, bitangentEC.y, bitangentEC.z,\n        normalEC.x,    normalEC.y,    normalEC.z);\n}\n",hM="/**\n * DOC_TBA\n *\n * @name czm_ellipsoidContainsPoint\n * @glslFunction\n *\n */\nbool czm_ellipsoidContainsPoint(vec3 ellipsoid_inverseRadii, vec3 point)\n{\n    vec3 scaled = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\n    return (dot(scaled, scaled) <= 1.0);\n}\n",mM="/**\n * DOC_TBA\n *\n * @name czm_ellipsoidWgs84TextureCoordinates\n * @glslFunction\n */\nvec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\n    return vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n",pM="/**\n * Compares <code>left</code> and <code>right</code> componentwise. Returns <code>true</code>\n * if they are within <code>epsilon</code> and <code>false</code> otherwise. The inputs\n * <code>left</code> and <code>right</code> can be <code>float</code>s, <code>vec2</code>s,\n * <code>vec3</code>s, or <code>vec4</code>s.\n *\n * @name czm_equalsEpsilon\n * @glslFunction\n *\n * @param {} left The first vector.\n * @param {} right The second vector.\n * @param {float} epsilon The epsilon to use for equality testing.\n * @returns {bool} <code>true</code> if the components are within <code>epsilon</code> and <code>false</code> otherwise.\n *\n * @example\n * // GLSL declarations\n * bool czm_equalsEpsilon(float left, float right, float epsilon);\n * bool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon);\n * bool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon);\n * bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon);\n */\nbool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\n    return all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\n\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\n    return all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\n\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\n    return all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\n\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\n    return (abs(left - right) <= epsilon);\n}\n",_M="/**\n * DOC_TBA\n *\n * @name czm_eyeOffset\n * @glslFunction\n *\n * @param {vec4} positionEC DOC_TBA.\n * @param {vec3} eyeOffset DOC_TBA.\n *\n * @returns {vec4} DOC_TBA.\n */\nvec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\n    // This equation is approximate in x and y.\n    vec4 p = positionEC;\n    vec4 zEyeOffset = normalize(p) * eyeOffset.z;\n    p.xy += eyeOffset.xy + zEyeOffset.xy;\n    p.z += zEyeOffset.z;\n    return p;\n}\n",gM="/**\n * Transforms a position from eye to window coordinates.  The transformation\n * from eye to clip coordinates is done using {@link czm_projection}.\n * The transform from normalized device coordinates to window coordinates is\n * done using {@link czm_viewportTransformation}, which assumes a depth range\n * of <code>near = 0</code> and <code>far = 1</code>.\n * <br /><br />\n * This transform is useful when there is a need to manipulate window coordinates\n * in a vertex shader as done by {@link BillboardCollection}.\n *\n * @name czm_eyeToWindowCoordinates\n * @glslFunction\n *\n * @param {vec4} position The position in eye coordinates to transform.\n *\n * @returns {vec4} The transformed position in window coordinates.\n *\n * @see czm_modelToWindowCoordinates\n * @see czm_projection\n * @see czm_viewportTransformation\n * @see BillboardCollection\n *\n * @example\n * vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n */\nvec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\n    vec4 q = czm_projection * positionEC;                        // clip coordinates\n    q.xyz /= q.w;                                                // normalized device coordinates\n    q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz; // window coordinates\n    return q;\n}\n",yM="/**\n * Approxiamtes atan over the range [0, 1]. Safe to flip output for negative input.\n *\n * Based on Michal Drobot's approximation from ShaderFastLibs, which in turn is based on\n * \"Efficient approximations for the arctangent function,\" Rajan, S. Sichun Wang Inkol, R. Joyal, A., May 2006.\n * Adapted from ShaderFastLibs under MIT License.\n *\n * Chosen for the following characteristics over range [0, 1]:\n * - basically no error at 0 and 1, important for getting around range limit (naive atan2 via atan requires infinite range atan)\n * - no visible artifacts from first-derivative discontinuities, unlike latitude via range-reduced sqrt asin approximations (at equator)\n *\n * The original code is x * (-0.1784 * abs(x) - 0.0663 * x * x + 1.0301);\n * Removed the abs() in here because it isn't needed, the input range is guaranteed as [0, 1] by how we're approximating atan2.\n *\n * @name czm_fastApproximateAtan\n * @glslFunction\n *\n * @param {float} x Value between 0 and 1 inclusive.\n *\n * @returns {float} Approximation of atan(x)\n */\nfloat czm_fastApproximateAtan(float x) {\n    return x * (-0.1784 * x - 0.0663 * x * x + 1.0301);\n}\n\n/**\n * Approximation of atan2.\n *\n * Range reduction math based on nvidia's cg reference implementation for atan2: http://developer.download.nvidia.com/cg/atan2.html\n * However, we replaced their atan curve with Michael Drobot's (see above).\n *\n * @name czm_fastApproximateAtan\n * @glslFunction\n *\n * @param {float} x Value between -1 and 1 inclusive.\n * @param {float} y Value between -1 and 1 inclusive.\n *\n * @returns {float} Approximation of atan2(x, y)\n */\nfloat czm_fastApproximateAtan(float x, float y) {\n    // atan approximations are usually only reliable over [-1, 1], or, in our case, [0, 1] due to modifications.\n    // So range-reduce using abs and by flipping whether x or y is on top.\n    float t = abs(x); // t used as swap and atan result.\n    float opposite = abs(y);\n    float adjacent = max(t, opposite);\n    opposite = min(t, opposite);\n\n    t = czm_fastApproximateAtan(opposite / adjacent);\n\n    // Undo range reduction\n    t = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);\n    t = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);\n    t = czm_branchFreeTernary(y < 0.0, -t, t);\n    return t;\n}\n",xM="/**\n * Gets the color with fog at a distance from the camera.\n *\n * @name czm_fog\n * @glslFunction\n *\n * @param {float} distanceToCamera The distance to the camera in meters.\n * @param {vec3} color The original color.\n * @param {vec3} fogColor The color of the fog.\n *\n * @returns {vec3} The color adjusted for fog at the distance from the camera.\n */\nvec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\n    float scalar = distanceToCamera * czm_fogDensity;\n    float fog = 1.0 - exp(-(scalar * scalar));\n    return mix(color, fogColor, fog);\n}\n\n/**\n * Gets the color with fog at a distance from the camera.\n *\n * @name czm_fog\n * @glslFunction\n *\n * @param {float} distanceToCamera The distance to the camera in meters.\n * @param {vec3} color The original color.\n * @param {vec3} fogColor The color of the fog.\n * @param {float} fogModifierConstant A constant to modify the appearance of fog.\n *\n * @returns {vec3} The color adjusted for fog at the distance from the camera.\n */\nvec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)\n{\n    float scalar = distanceToCamera * czm_fogDensity;\n    float fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));\n    return mix(color, fogColor, fog);\n}\n",bM="/**\n * Converts a color from RGB space to linear space.\n *\n * @name czm_gammaCorrect\n * @glslFunction\n *\n * @param {vec3} color The color in RGB space.\n * @returns {vec3} The color in linear space.\n */\nvec3 czm_gammaCorrect(vec3 color) {\n#ifdef HDR\n    color = pow(color, vec3(czm_gamma));\n#endif\n    return color;\n}\n\nvec4 czm_gammaCorrect(vec4 color) {\n#ifdef HDR\n    color.rgb = pow(color.rgb, vec3(czm_gamma));\n#endif\n    return color;\n}\n",TM="/**\n * DOC_TBA\n *\n * @name czm_geodeticSurfaceNormal\n * @glslFunction\n *\n * @param {vec3} positionOnEllipsoid DOC_TBA\n * @param {vec3} ellipsoidCenter DOC_TBA\n * @param {vec3} oneOverEllipsoidRadiiSquared DOC_TBA\n * \n * @returns {vec3} DOC_TBA.\n */\nvec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\n    return normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n",AM="/**\n * An czm_material with default values. Every material's czm_getMaterial\n * should use this default material as a base for the material it returns.\n * The default normal value is given by materialInput.normalEC.\n *\n * @name czm_getDefaultMaterial\n * @glslFunction\n *\n * @param {czm_materialInput} input The input used to construct the default material.\n *\n * @returns {czm_material} The default material.\n *\n * @see czm_materialInput\n * @see czm_material\n * @see czm_getMaterial\n */\nczm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\n    czm_material material;\n    material.diffuse = vec3(0.0);\n    material.specular = 0.0;\n    material.shininess = 1.0;\n    material.normal = materialInput.normalEC;\n    material.emission = vec3(0.0);\n    material.alpha = 1.0;\n    return material;\n}\n",CM="/**\n * Calculates the intensity of diffusely reflected light.\n *\n * @name czm_getLambertDiffuse\n * @glslFunction\n *\n * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.\n * @param {vec3} normalEC The surface normal in eye coordinates.\n *\n * @returns {float} The intensity of the diffuse reflection.\n *\n * @see czm_phong\n *\n * @example\n * float diffuseIntensity = czm_getLambertDiffuse(lightDirectionEC, normalEC);\n * float specularIntensity = czm_getSpecular(lightDirectionEC, toEyeEC, normalEC, 200);\n * vec3 color = (diffuseColor * diffuseIntensity) + (specularColor * specularIntensity);\n */\nfloat czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\n    return max(dot(lightDirectionEC, normalEC), 0.0);\n}\n",EM="/**\n * Calculates the specular intensity of reflected light.\n *\n * @name czm_getSpecular\n * @glslFunction\n *\n * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.\n * @param {vec3} toEyeEC Unit vector pointing to the eye position in eye coordinates.\n * @param {vec3} normalEC The surface normal in eye coordinates.\n * @param {float} shininess The sharpness of the specular reflection.  Higher values create a smaller, more focused specular highlight.\n *\n * @returns {float} The intensity of the specular highlight.\n *\n * @see czm_phong\n *\n * @example\n * float diffuseIntensity = czm_getLambertDiffuse(lightDirectionEC, normalEC);\n * float specularIntensity = czm_getSpecular(lightDirectionEC, toEyeEC, normalEC, 200);\n * vec3 color = (diffuseColor * diffuseIntensity) + (specularColor * specularIntensity);\n */\nfloat czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\n    vec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\n    float specular = max(dot(toReflectedLight, toEyeEC), 0.0);\n\n    // pow has undefined behavior if both parameters <= 0.\n    // Prevent this by making sure shininess is at least czm_epsilon2.\n    return pow(specular, max(shininess, czm_epsilon2));\n}\n",SM="/**\n * @private\n */\nvec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\n    float cosAngle = cos(angleInRadians);\n    float sinAngle = sin(angleInRadians);\n\n    // time dependent sampling directions\n    vec2 s0 = vec2(1.0/17.0, 0.0);\n    vec2 s1 = vec2(-1.0/29.0, 0.0);\n    vec2 s2 = vec2(1.0/101.0, 1.0/59.0);\n    vec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\n\n    // rotate sampling direction by specified angle\n    s0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\n    s1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\n    s2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\n    s3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\n\n    vec2 uv0 = (uv/103.0) + (time * s0);\n    vec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\n    vec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\n    vec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\n\n    uv0 = fract(uv0);\n    uv1 = fract(uv1);\n    uv2 = fract(uv2);\n    uv3 = fract(uv3);\n    vec4 noise = (texture(normalMap, uv0)) +\n                 (texture(normalMap, uv1)) +\n                 (texture(normalMap, uv2)) +\n                 (texture(normalMap, uv3));\n\n    // average and scale to between -1 and 1\n    return ((noise / 4.0) - 0.5) * 2.0;\n}\n",wM="/**\n * Converts an HSB color (hue, saturation, brightness) to RGB\n * HSB <-> RGB conversion with minimal branching: {@link http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl}\n *\n * @name czm_HSBToRGB\n * @glslFunction\n * \n * @param {vec3} hsb The color in HSB.\n *\n * @returns {vec3} The color in RGB.\n *\n * @example\n * vec3 hsb = czm_RGBToHSB(rgb);\n * hsb.z *= 0.1;\n * rgb = czm_HSBToRGB(hsb);\n */\n\nconst vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\nvec3 czm_HSBToRGB(vec3 hsb)\n{\n    vec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\n    return hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n",vM="/**\n * Converts an HSL color (hue, saturation, lightness) to RGB\n * HSL <-> RGB conversion: {@link http://www.chilliant.com/rgb2hsv.html}\n *\n * @name czm_HSLToRGB\n * @glslFunction\n * \n * @param {vec3} rgb The color in HSL.\n *\n * @returns {vec3} The color in RGB.\n *\n * @example\n * vec3 hsl = czm_RGBToHSL(rgb);\n * hsl.z *= 0.1;\n * rgb = czm_HSLToRGB(hsl);\n */\n\nvec3 hueToRGB(float hue)\n{\n    float r = abs(hue * 6.0 - 3.0) - 1.0;\n    float g = 2.0 - abs(hue * 6.0 - 2.0);\n    float b = 2.0 - abs(hue * 6.0 - 4.0);\n    return clamp(vec3(r, g, b), 0.0, 1.0);\n}\n\nvec3 czm_HSLToRGB(vec3 hsl)\n{\n    vec3 rgb = hueToRGB(hsl.x);\n    float c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\n    return (rgb - 0.5) * c + hsl.z;\n}\n",DM="/**\n * Adjusts the hue of a color.\n * \n * @name czm_hue\n * @glslFunction\n * \n * @param {vec3} rgb The color.\n * @param {float} adjustment The amount to adjust the hue of the color in radians.\n *\n * @returns {float} The color with the hue adjusted.\n *\n * @example\n * vec3 adjustHue = czm_hue(color, czm_pi); // The same as czm_hue(color, -czm_pi)\n */\nvec3 czm_hue(vec3 rgb, float adjustment)\n{\n    const mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n                            0.595716, -0.274453, -0.321263,\n                            0.211456, -0.522591,  0.311135);\n    const mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n                            1.0, -0.2721, -0.6474,\n                            1.0, -1.107,   1.7046);\n    \n    vec3 yiq = toYIQ * rgb;\n    float hue = atan(yiq.z, yiq.y) + adjustment;\n    float chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\n    \n    vec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\n    return toRGB * color;\n}\n",IM="/**\n * Converts a color in linear space to RGB space.\n *\n * @name czm_inverseGamma\n * @glslFunction\n *\n * @param {vec3} color The color in linear space.\n * @returns {vec3} The color in RGB space.\n */\nvec3 czm_inverseGamma(vec3 color) {\n    return pow(color, vec3(1.0 / czm_gamma));\n}\n",PM="/**\n * Determines if a time interval is empty.\n *\n * @name czm_isEmpty\n * @glslFunction \n * \n * @param {czm_raySegment} interval The interval to test.\n * \n * @returns {bool} <code>true</code> if the time interval is empty; otherwise, <code>false</code>.\n *\n * @example\n * bool b0 = czm_isEmpty(czm_emptyRaySegment);      // true\n * bool b1 = czm_isEmpty(czm_raySegment(0.0, 1.0)); // false\n * bool b2 = czm_isEmpty(czm_raySegment(1.0, 1.0)); // false, contains 1.0.\n */\nbool czm_isEmpty(czm_raySegment interval)\n{\n    return (interval.stop < 0.0);\n}\n",OM="/**\n * Determines if a time interval is empty.\n *\n * @name czm_isFull\n * @glslFunction \n * \n * @param {czm_raySegment} interval The interval to test.\n * \n * @returns {bool} <code>true</code> if the time interval is empty; otherwise, <code>false</code>.\n *\n * @example\n * bool b0 = czm_isEmpty(czm_emptyRaySegment);      // true\n * bool b1 = czm_isEmpty(czm_raySegment(0.0, 1.0)); // false\n * bool b2 = czm_isEmpty(czm_raySegment(1.0, 1.0)); // false, contains 1.0.\n */\nbool czm_isFull(czm_raySegment interval)\n{\n    return (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n",RM="/**\n * Computes the fraction of a Web Wercator rectangle at which a given geodetic latitude is located.\n *\n * @name czm_latitudeToWebMercatorFraction\n * @glslFunction\n *\n * @param {float} latitude The geodetic latitude, in radians.\n * @param {float} southMercatorY The Web Mercator coordinate of the southern boundary of the rectangle.\n * @param {float} oneOverMercatorHeight The total height of the rectangle in Web Mercator coordinates.\n *\n * @returns {float} The fraction of the rectangle at which the latitude occurs.  If the latitude is the southern\n *          boundary of the rectangle, the return value will be zero.  If it is the northern boundary, the return\n *          value will be 1.0.  Latitudes in between are mapped according to the Web Mercator projection.\n */ \nfloat czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\n    float sinLatitude = sin(latitude);\n    float mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\n    \n    return (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n",MM="/**\n * Converts a linear RGB color to an sRGB color.\n *\n * @param {vec3|vec4} linearIn The color in linear color space.\n * @returns {vec3|vec4} The color in sRGB color space. The vector type matches the input.\n */\nvec3 czm_linearToSrgb(vec3 linearIn) \n{\n    return pow(linearIn, vec3(1.0/2.2));\n}\n\nvec4 czm_linearToSrgb(vec4 linearIn) \n{\n    vec3 srgbOut = pow(linearIn.rgb, vec3(1.0/2.2));\n    return vec4(srgbOut, linearIn.a);\n}\n",LM="/**\n * Computes distance from an point in 2D to a line in 2D.\n *\n * @name czm_lineDistance\n * @glslFunction\n *\n * param {vec2} point1 A point along the line.\n * param {vec2} point2 A point along the line.\n * param {vec2} point A point that may or may not be on the line.\n * returns {float} The distance from the point to the line.\n */\nfloat czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {\n    return abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);\n}\n",NM="/**\n * Computes the luminance of a color. \n *\n * @name czm_luminance\n * @glslFunction\n *\n * @param {vec3} rgb The color.\n * \n * @returns {float} The luminance.\n *\n * @example\n * float light = czm_luminance(vec3(0.0)); // 0.0\n * float dark = czm_luminance(vec3(1.0));  // ~1.0 \n */\nfloat czm_luminance(vec3 rgb)\n{\n    // Algorithm from Chapter 10 of Graphics Shaders.\n    const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n    return dot(rgb, W);\n}\n",FM="/**\n * Computes the size of a pixel in meters at a distance from the eye.\n * <p>\n * Use this version when passing in a custom pixel ratio. For example, passing in 1.0 will return meters per native device pixel.\n * </p>\n * @name czm_metersPerPixel\n * @glslFunction\n *\n * @param {vec3} positionEC The position to get the meters per pixel in eye coordinates.\n * @param {float} pixelRatio The scaling factor from pixel space to coordinate space\n *\n * @returns {float} The meters per pixel at positionEC.\n */\nfloat czm_metersPerPixel(vec4 positionEC, float pixelRatio)\n{\n    float width = czm_viewport.z;\n    float height = czm_viewport.w;\n    float pixelWidth;\n    float pixelHeight;\n\n    float top = czm_frustumPlanes.x;\n    float bottom = czm_frustumPlanes.y;\n    float left = czm_frustumPlanes.z;\n    float right = czm_frustumPlanes.w;\n\n    if (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)\n    {\n        float frustumWidth = right - left;\n        float frustumHeight = top - bottom;\n        pixelWidth = frustumWidth / width;\n        pixelHeight = frustumHeight / height;\n    }\n    else\n    {\n        float distanceToPixel = -positionEC.z;\n        float inverseNear = 1.0 / czm_currentFrustum.x;\n        float tanTheta = top * inverseNear;\n        pixelHeight = 2.0 * distanceToPixel * tanTheta / height;\n        tanTheta = right * inverseNear;\n        pixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n    }\n\n    return max(pixelWidth, pixelHeight) * pixelRatio;\n}\n\n/**\n * Computes the size of a pixel in meters at a distance from the eye.\n * <p>\n * Use this version when scaling by pixel ratio.\n * </p>\n * @name czm_metersPerPixel\n * @glslFunction\n *\n * @param {vec3} positionEC The position to get the meters per pixel in eye coordinates.\n *\n * @returns {float} The meters per pixel at positionEC.\n */\nfloat czm_metersPerPixel(vec4 positionEC)\n{\n    return czm_metersPerPixel(positionEC, czm_pixelRatio);\n}\n",BM="/**\n * Transforms a position from model to window coordinates.  The transformation\n * from model to clip coordinates is done using {@link czm_modelViewProjection}.\n * The transform from normalized device coordinates to window coordinates is\n * done using {@link czm_viewportTransformation}, which assumes a depth range\n * of <code>near = 0</code> and <code>far = 1</code>.\n * <br /><br />\n * This transform is useful when there is a need to manipulate window coordinates\n * in a vertex shader as done by {@link BillboardCollection}.\n * <br /><br />\n * This function should not be confused with {@link czm_viewportOrthographic},\n * which is an orthographic projection matrix that transforms from window \n * coordinates to clip coordinates.\n *\n * @name czm_modelToWindowCoordinates\n * @glslFunction\n *\n * @param {vec4} position The position in model coordinates to transform.\n *\n * @returns {vec4} The transformed position in window coordinates.\n *\n * @see czm_eyeToWindowCoordinates\n * @see czm_modelViewProjection\n * @see czm_viewportTransformation\n * @see czm_viewportOrthographic\n * @see BillboardCollection\n *\n * @example\n * vec4 positionWC = czm_modelToWindowCoordinates(positionMC);\n */\nvec4 czm_modelToWindowCoordinates(vec4 position)\n{\n    vec4 q = czm_modelViewProjection * position;                // clip coordinates\n    q.xyz /= q.w;                                                // normalized device coordinates\n    q.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz; // window coordinates\n    return q;\n}\n",kM="/**\n * DOC_TBA\n *\n * @name czm_multiplyWithColorBalance\n * @glslFunction\n */\nvec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\n    // Algorithm from Chapter 10 of Graphics Shaders.\n    const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n    \n    vec3 target = left * right;\n    float leftLuminance = dot(left, W);\n    float rightLuminance = dot(right, W);\n    float targetLuminance = dot(target, W);\n    \n    return ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n",VM="/**\n * Computes a value that scales with distance.  The scaling is clamped at the near and\n * far distances, and does not extrapolate.  This function works with the\n * {@link NearFarScalar} JavaScript class.\n *\n * @name czm_nearFarScalar\n * @glslFunction\n *\n * @param {vec4} nearFarScalar A vector with 4 components: Near distance (x), Near value (y), Far distance (z), Far value (w).\n * @param {float} cameraDistSq The square of the current distance from the camera.\n *\n * @returns {float} The value at this distance.\n */\nfloat czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\n    float valueAtMin = nearFarScalar.y;\n    float valueAtMax = nearFarScalar.w;\n    float nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\n    float farDistanceSq = nearFarScalar.z * nearFarScalar.z;\n\n    float t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\n\n    t = pow(clamp(t, 0.0, 1.0), 0.2);\n\n    return mix(valueAtMin, valueAtMax, t);\n}\n",UM=" /**\n  * Decodes a unit-length vector in 'oct' encoding to a normalized 3-component Cartesian vector.\n  * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n  * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n  *\n  * @name czm_octDecode\n  * @param {vec2} encoded The oct-encoded, unit-length vector\n  * @param {float} range The maximum value of the SNORM range. The encoded vector is stored in log2(rangeMax+1) bits.\n  * @returns {vec3} The decoded and normalized vector\n  */\n  vec3 czm_octDecode(vec2 encoded, float range)\n  {\n      if (encoded.x == 0.0 && encoded.y == 0.0) {\n          return vec3(0.0, 0.0, 0.0);\n      }\n\n     encoded = encoded / range * 2.0 - 1.0;\n     vec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\n     if (v.z < 0.0)\n     {\n         v.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n     }\n\n     return normalize(v);\n  }\n\n/**\n * Decodes a unit-length vector in 'oct' encoding to a normalized 3-component Cartesian vector.\n * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n *\n * @name czm_octDecode\n * @param {vec2} encoded The oct-encoded, unit-length vector\n * @returns {vec3} The decoded and normalized vector\n */\n vec3 czm_octDecode(vec2 encoded)\n {\n    return czm_octDecode(encoded, 255.0);\n }\n\n /**\n * Decodes a unit-length vector in 'oct' encoding packed into a floating-point number to a normalized 3-component Cartesian vector.\n * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n *\n * @name czm_octDecode\n * @param {float} encoded The oct-encoded, unit-length vector\n * @returns {vec3} The decoded and normalized vector\n */\n vec3 czm_octDecode(float encoded)\n {\n    float temp = encoded / 256.0;\n    float x = floor(temp);\n    float y = (temp - x) * 256.0;\n    return czm_octDecode(vec2(x, y));\n }\n\n/**\n * Decodes three unit-length vectors in 'oct' encoding packed into two floating-point numbers to normalized 3-component Cartesian vectors.\n * The 'oct' encoding is described in \"A Survey of Efficient Representations of Independent Unit Vectors\",\n * Cigolle et al 2014: http://jcgt.org/published/0003/02/01/\n *\n * @name czm_octDecode\n * @param {vec2} encoded The packed oct-encoded, unit-length vectors.\n * @param {vec3} vector1 One decoded and normalized vector.\n * @param {vec3} vector2 One decoded and normalized vector.\n * @param {vec3} vector3 One decoded and normalized vector.\n */\n  void czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n {\n    float temp = encoded.x / 65536.0;\n    float x = floor(temp);\n    float encodedFloat1 = (temp - x) * 65536.0;\n\n    temp = encoded.y / 65536.0;\n    float y = floor(temp);\n    float encodedFloat2 = (temp - y) * 65536.0;\n\n    vector1 = czm_octDecode(encodedFloat1);\n    vector2 = czm_octDecode(encodedFloat2);\n    vector3 = czm_octDecode(vec2(x, y));\n }\n\n",zM="/**\n * Packs a depth value into a vec3 that can be represented by unsigned bytes.\n *\n * @name czm_packDepth\n * @glslFunction\n *\n * @param {float} depth The floating-point depth.\n * @returns {vec3} The packed depth.\n */\nvec4 czm_packDepth(float depth)\n{\n    // See Aras Pranckeviius' post Encoding Floats to RGBA\n    // http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\n    vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\n    enc = fract(enc);\n    enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n    return enc;\n}\n",HM="vec3 lambertianDiffuse(vec3 diffuseColor)\n{\n    return diffuseColor / czm_pi;\n}\n\nvec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)\n{\n    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n}\n\nfloat smithVisibilityG1(float NdotV, float roughness)\n{\n    // this is the k value for direct lighting.\n    // for image based lighting it will be roughness^2 / 2\n    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\nfloat smithVisibilityGGX(float roughness, float NdotL, float NdotV)\n{\n    return (\n        smithVisibilityG1(NdotL, roughness) *\n        smithVisibilityG1(NdotV, roughness)\n    );\n}\n\nfloat GGX(float roughness, float NdotH)\n{\n    float roughnessSquared = roughness * roughness;\n    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;\n    return roughnessSquared / (czm_pi * f * f);\n}\n\n/**\n * Compute the diffuse and specular contributions using physically based\n * rendering. This function only handles direct lighting.\n * <p>\n * This function only handles the lighting calculations. Metallic/roughness\n * and specular/glossy must be handled separately. See {@czm_pbrMetallicRoughnessMaterial}, {@czm_pbrSpecularGlossinessMaterial} and {@czm_defaultPbrMaterial}\n * </p>\n *\n * @name czm_pbrlighting\n * @glslFunction\n *\n * @param {vec3} positionEC The position of the fragment in eye coordinates\n * @param {vec3} normalEC The surface normal in eye coordinates\n * @param {vec3} lightDirectionEC Unit vector pointing to the light source in eye coordinates.\n * @param {vec3} lightColorHdr radiance of the light source. This is a HDR value.\n * @param {czm_pbrParameters} The computed PBR parameters.\n * @return {vec3} The computed HDR color\n *\n * @example\n * czm_pbrParameters pbrParameters = czm_pbrMetallicRoughnessMaterial(\n *  baseColor,\n *  metallic,\n *  roughness\n * );\n * vec3 color = czm_pbrlighting(\n *  positionEC,\n *  normalEC,\n *  lightDirectionEC,\n *  lightColorHdr,\n *  pbrParameters);\n */\nvec3 czm_pbrLighting(\n    vec3 positionEC,\n    vec3 normalEC,\n    vec3 lightDirectionEC,\n    vec3 lightColorHdr,\n    czm_pbrParameters pbrParameters\n)\n{\n    vec3 v = -normalize(positionEC);\n    vec3 l = normalize(lightDirectionEC);\n    vec3 h = normalize(v + l);\n    vec3 n = normalEC;\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = abs(dot(n, v)) + 0.001;\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    vec3 f0 = pbrParameters.f0;\n    float reflectance = max(max(f0.r, f0.g), f0.b);\n    vec3 f90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\n    vec3 F = fresnelSchlick2(f0, f90, VdotH);\n\n    float alpha = pbrParameters.roughness;\n    float G = smithVisibilityGGX(alpha, NdotL, NdotV);\n    float D = GGX(alpha, NdotH);\n    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\n\n    vec3 diffuseColor = pbrParameters.diffuseColor;\n    // F here represents the specular contribution\n    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\n\n    // Lo = (diffuse + specular) * Li * NdotL\n    return (diffuseContribution + specularContribution) * NdotL * lightColorHdr;\n}\n",GM="/**\n * Compute parameters for physically based rendering using the\n * metallic/roughness workflow. All inputs are linear; sRGB texture values must\n * be decoded beforehand\n *\n * @name czm_pbrMetallicRoughnessMaterial\n * @glslFunction\n *\n * @param {vec3} baseColor For dielectrics, this is the base color. For metals, this is the f0 value (reflectance at normal incidence)\n * @param {float} metallic 0.0 indicates dielectric. 1.0 indicates metal. Values in between are allowed (e.g. to model rust or dirt);\n * @param {float} roughness A value between 0.0 and 1.0\n * @return {czm_pbrParameters} parameters to pass into {@link czm_pbrLighting}\n */\nczm_pbrParameters czm_pbrMetallicRoughnessMaterial(\n    vec3 baseColor,\n    float metallic,\n    float roughness\n) \n{\n    czm_pbrParameters results;\n\n    // roughness is authored as perceptual roughness\n    // square it to get material roughness\n    roughness = clamp(roughness, 0.0, 1.0);\n    results.roughness = roughness * roughness;\n\n    // dielectrics use f0 = 0.04, metals use albedo as f0\n    metallic = clamp(metallic, 0.0, 1.0);\n    const vec3 REFLECTANCE_DIELECTRIC = vec3(0.04);\n    vec3 f0 = mix(REFLECTANCE_DIELECTRIC, baseColor, metallic);\n    results.f0 = f0;\n\n    // diffuse only applies to dielectrics.\n    results.diffuseColor = baseColor * (1.0 - f0) * (1.0 - metallic);\n\n    return results;\n}\n",WM="/**\n * Compute parameters for physically based rendering using the\n * specular/glossy workflow. All inputs are linear; sRGB texture values must\n * be decoded beforehand\n *\n * @name czm_pbrSpecularGlossinessMaterial\n * @glslFunction\n *\n * @param {vec3} diffuse The diffuse color for dielectrics (non-metals)\n * @param {vec3} specular The reflectance at normal incidence (f0)\n * @param {float} glossiness A number from 0.0 to 1.0 indicating how smooth the surface is.\n * @return {czm_pbrParameters} parameters to pass into {@link czm_pbrLighting}\n */\nczm_pbrParameters czm_pbrSpecularGlossinessMaterial(\n    vec3 diffuse,\n    vec3 specular,\n    float glossiness\n) \n{\n    czm_pbrParameters results;\n\n    // glossiness is the opposite of roughness, but easier for artists to use.\n    float roughness = 1.0 - glossiness;\n    results.roughness = roughness * roughness;\n\n    results.diffuseColor = diffuse * (1.0 - max(max(specular.r, specular.g), specular.b));\n    results.f0 = specular;\n\n    return results;\n}\n",jM="float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\n    return czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\n\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\n    return czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\n\n/**\n * Computes a color using the Phong lighting model.\n *\n * @name czm_phong\n * @glslFunction\n *\n * @param {vec3} toEye A normalized vector from the fragment to the eye in eye coordinates.\n * @param {czm_material} material The fragment's material.\n *\n * @returns {vec4} The computed color.\n *\n * @example\n * vec3 positionToEyeEC = // ...\n * czm_material material = // ...\n * vec3 lightDirectionEC = // ...\n * out_FragColor = czm_phong(normalize(positionToEyeEC), material, lightDirectionEC);\n *\n * @see czm_getMaterial\n */\nvec4 czm_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down)\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n    }\n\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n\nvec4 czm_private_phong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    float diffuse = czm_private_getLambertDiffuseOfMaterial(lightDirectionEC, material);\n    float specular = czm_private_getSpecularOfMaterial(lightDirectionEC, toEye, material);\n\n    vec3 ambient = vec3(0.0);\n    vec3 color = ambient + material.emission;\n    color += material.diffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n",qM="/**\n * Computes distance from a point to a plane.\n *\n * @name czm_planeDistance\n * @glslFunction\n *\n * param {vec4} plane A Plane in Hessian Normal Form. See Plane.js\n * param {vec3} point A point in the same space as the plane.\n * returns {float} The distance from the point to the plane.\n */\nfloat czm_planeDistance(vec4 plane, vec3 point) {\n    return (dot(plane.xyz, point) + plane.w);\n}\n\n/**\n * Computes distance from a point to a plane.\n *\n * @name czm_planeDistance\n * @glslFunction\n *\n * param {vec3} planeNormal Normal for a plane in Hessian Normal Form. See Plane.js\n * param {float} planeDistance Distance for a plane in Hessian Normal form. See Plane.js\n * param {vec3} point A point in the same space as the plane.\n * returns {float} The distance from the point to the plane.\n */\nfloat czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {\n    return (dot(planeNormal, point) + planeDistance);\n}\n",YM="/**\n * Computes the point along a ray at the given time.  <code>time</code> can be positive, negative, or zero.\n *\n * @name czm_pointAlongRay\n * @glslFunction\n *\n * @param {czm_ray} ray The ray to compute the point along.\n * @param {float} time The time along the ray.\n * \n * @returns {vec3} The point along the ray at the given time.\n * \n * @example\n * czm_ray ray = czm_ray(vec3(0.0), vec3(1.0, 0.0, 0.0)); // origin, direction\n * vec3 v = czm_pointAlongRay(ray, 2.0); // (2.0, 0.0, 0.0)\n */\nvec3 czm_pointAlongRay(czm_ray ray, float time)\n{\n    return ray.origin + (time * ray.direction);\n}\n",XM="/**\n * DOC_TBA\n *\n * @name czm_rayEllipsoidIntersectionInterval\n * @glslFunction\n */\nczm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, vec3 ellipsoid_center, vec3 ellipsoid_inverseRadii)\n{\n   // ray and ellipsoid center in eye coordinates.  radii in model coordinates.\n    vec3 q = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\n    vec3 w = ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\n\n    q = q - ellipsoid_inverseRadii * (czm_inverseModelView * vec4(ellipsoid_center, 1.0)).xyz;\n\n    float q2 = dot(q, q);\n    float qw = dot(q, w);\n\n    if (q2 > 1.0) // Outside ellipsoid.\n    {\n        if (qw >= 0.0) // Looking outward or tangent (0 intersections).\n        {\n            return czm_emptyRaySegment;\n        }\n        else // qw < 0.0.\n        {\n            float qw2 = qw * qw;\n            float difference = q2 - 1.0; // Positively valued.\n            float w2 = dot(w, w);\n            float product = w2 * difference;\n\n            if (qw2 < product) // Imaginary roots (0 intersections).\n            {\n                return czm_emptyRaySegment;\n            }\n            else if (qw2 > product) // Distinct roots (2 intersections).\n            {\n                float discriminant = qw * qw - product;\n                float temp = -qw + sqrt(discriminant); // Avoid cancellation.\n                float root0 = temp / w2;\n                float root1 = difference / temp;\n                if (root0 < root1)\n                {\n                    czm_raySegment i = czm_raySegment(root0, root1);\n                    return i;\n                }\n                else\n                {\n                    czm_raySegment i = czm_raySegment(root1, root0);\n                    return i;\n                }\n            }\n            else // qw2 == product.  Repeated roots (2 intersections).\n            {\n                float root = sqrt(difference / w2);\n                czm_raySegment i = czm_raySegment(root, root);\n                return i;\n            }\n        }\n    }\n    else if (q2 < 1.0) // Inside ellipsoid (2 intersections).\n    {\n        float difference = q2 - 1.0; // Negatively valued.\n        float w2 = dot(w, w);\n        float product = w2 * difference; // Negatively valued.\n        float discriminant = qw * qw - product;\n        float temp = -qw + sqrt(discriminant); // Positively valued.\n        czm_raySegment i = czm_raySegment(0.0, temp / w2);\n        return i;\n    }\n    else // q2 == 1.0. On ellipsoid.\n    {\n        if (qw < 0.0) // Looking inward.\n        {\n            float w2 = dot(w, w);\n            czm_raySegment i = czm_raySegment(0.0, -qw / w2);\n            return i;\n        }\n        else // qw >= 0.0.  Looking outward or tangent.\n        {\n            return czm_emptyRaySegment;\n        }\n    }\n}\n",KM="/**\n * Compute the intersection interval of a ray with a sphere.\n *\n * @name czm_raySphereIntersectionInterval\n * @glslFunction\n *\n * @param {czm_ray} ray The ray.\n * @param {vec3} center The center of the sphere.\n * @param {float} radius The radius of the sphere.\n * @return {czm_raySegment} The intersection interval of the ray with the sphere.\n */\nczm_raySegment czm_raySphereIntersectionInterval(czm_ray ray, vec3 center, float radius)\n{\n    vec3 o = ray.origin;\n    vec3 d = ray.direction;\n\n    vec3 oc = o - center;\n\n    float a = dot(d, d);\n    float b = 2.0 * dot(d, oc);\n    float c = dot(oc, oc) - (radius * radius);\n\n    float det = (b * b) - (4.0 * a * c);\n\n    if (det < 0.0) {\n        return czm_emptyRaySegment;\n    }\n\n    float sqrtDet = sqrt(det);\n\n    float t0 = (-b - sqrtDet) / (2.0 * a);\n    float t1 = (-b + sqrtDet) / (2.0 * a);\n\n    czm_raySegment result = czm_raySegment(t0, t1);\n    return result;\n}\n",ZM="float czm_readDepth(sampler2D depthTexture, vec2 texCoords)\n{\n    return czm_reverseLogDepth(texture(depthTexture, texCoords).r);\n}\n",$M="/**\n * Reads a value previously transformed with {@link czm_writeNonPerspective}\n * by dividing it by `w`, the value used in the perspective divide.\n * This function is intended to be called in a fragment shader to access a\n * `varying` that should not be subject to perspective interpolation.\n * For example, screen-space texture coordinates. The value should have been\n * previously written in the vertex shader with a call to\n * {@link czm_writeNonPerspective}.\n *\n * @name czm_readNonPerspective\n * @glslFunction\n *\n * @param {float|vec2|vec3|vec4} value The non-perspective value to be read.\n * @param {float} oneOverW One over the perspective divide value, `w`. Usually this is simply `gl_FragCoord.w`.\n * @returns {float|vec2|vec3|vec4} The usable value.\n */\nfloat czm_readNonPerspective(float value, float oneOverW) {\n    return value * oneOverW;\n}\n\nvec2 czm_readNonPerspective(vec2 value, float oneOverW) {\n    return value * oneOverW;\n}\n\nvec3 czm_readNonPerspective(vec3 value, float oneOverW) {\n    return value * oneOverW;\n}\n\nvec4 czm_readNonPerspective(vec4 value, float oneOverW) {\n    return value * oneOverW;\n}\n",QM="float czm_reverseLogDepth(float logZ)\n{\n#ifdef LOG_DEPTH\n    float near = czm_currentFrustum.x;\n    float far = czm_currentFrustum.y;\n    float log2Depth = logZ * czm_log2FarDepthFromNearPlusOne;\n    float depthFromNear = pow(2.0, log2Depth) - 1.0;\n    return far * (1.0 - near / (depthFromNear + near)) / (far - near);\n#endif\n    return logZ;\n}\n",JM="/**\n * Converts an RGB color to HSB (hue, saturation, brightness)\n * HSB <-> RGB conversion with minimal branching: {@link http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl}\n *\n * @name czm_RGBToHSB\n * @glslFunction\n * \n * @param {vec3} rgb The color in RGB.\n *\n * @returns {vec3} The color in HSB.\n *\n * @example\n * vec3 hsb = czm_RGBToHSB(rgb);\n * hsb.z *= 0.1;\n * rgb = czm_HSBToRGB(hsb);\n */\n\nconst vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\nvec3 czm_RGBToHSB(vec3 rgb)\n{\n    vec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\n    vec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\n\n    float d = q.x - min(q.w, q.y);\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n",eL="/**\n * Converts an RGB color to HSL (hue, saturation, lightness)\n * HSL <-> RGB conversion: {@link http://www.chilliant.com/rgb2hsv.html}\n *\n * @name czm_RGBToHSL\n * @glslFunction\n * \n * @param {vec3} rgb The color in RGB.\n *\n * @returns {vec3} The color in HSL.\n *\n * @example\n * vec3 hsl = czm_RGBToHSL(rgb);\n * hsl.z *= 0.1;\n * rgb = czm_HSLToRGB(hsl);\n */\n \nvec3 RGBtoHCV(vec3 rgb)\n{\n    // Based on work by Sam Hocevar and Emil Persson\n    vec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\n    vec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\n    float c = q.x - min(q.w, q.y);\n    float h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\n    return vec3(h, c, q.x);\n}\n\nvec3 czm_RGBToHSL(vec3 rgb)\n{\n    vec3 hcv = RGBtoHCV(rgb);\n    float l = hcv.z - hcv.y * 0.5;\n    float s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\n    return vec3(hcv.x, s, l);\n}\n",tL="/**\n * Converts an RGB color to CIE Yxy.\n * <p>The conversion is described in\n * {@link http://content.gpwiki.org/index.php/D3DBook:High-Dynamic_Range_Rendering#Luminance_Transform|Luminance Transform}\n * </p>\n * \n * @name czm_RGBToXYZ\n * @glslFunction\n * \n * @param {vec3} rgb The color in RGB.\n *\n * @returns {vec3} The color in CIE Yxy.\n *\n * @example\n * vec3 xyz = czm_RGBToXYZ(rgb);\n * xyz.x = max(xyz.x - luminanceThreshold, 0.0);\n * rgb = czm_XYZToRGB(xyz);\n */\nvec3 czm_RGBToXYZ(vec3 rgb)\n{\n    const mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n                              0.3576, 0.7152, 0.1192,\n                              0.1805, 0.0722, 0.9505);\n    vec3 xyz = RGB2XYZ * rgb;\n    vec3 Yxy;\n    Yxy.r = xyz.g;\n    float temp = dot(vec3(1.0), xyz);\n    Yxy.gb = xyz.rg / temp;\n    return Yxy;\n}\n",nL="/**\n * Round a floating point value. This function exists because round() doesn't\n * exist in GLSL 1.00. \n *\n * @param {float|vec2|vec3|vec4} value The value to round\n * @param {float|vec2|vec3|vec3} The rounded value. The type matches the input.\n */\nfloat czm_round(float value) {\n  return floor(value + 0.5);\n}\n\nvec2 czm_round(vec2 value) {\n  return floor(value + 0.5);\n}\n\nvec3 czm_round(vec3 value) {\n  return floor(value + 0.5);\n}\n\nvec4 czm_round(vec4 value) {\n  return floor(value + 0.5);\n}\n",iL="/**\n * Samples the 4 neighboring pixels and return the weighted average.\n *\n * @private\n */\nvec3 czm_sampleOctahedralProjectionWithFiltering(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod)\n{\n    direction /= dot(vec3(1.0), abs(direction));\n    vec2 rev = abs(direction.zx) - vec2(1.0);\n    vec2 neg = vec2(direction.x < 0.0 ? rev.x : -rev.x,\n                    direction.z < 0.0 ? rev.y : -rev.y);\n    vec2 uv = direction.y < 0.0 ? neg : direction.xz;\n    vec2 coord = 0.5 * uv + vec2(0.5);\n    vec2 pixel = 1.0 / textureSize;\n\n    if (lod > 0.0)\n    {\n        // Each subseqeuent mip level is half the size\n        float scale = 1.0 / pow(2.0, lod);\n        float offset = ((textureSize.y + 1.0) / textureSize.x);\n\n        coord.x *= offset;\n        coord *= scale;\n\n        coord.x += offset + pixel.x;\n        coord.y += (1.0 - (1.0 / pow(2.0, lod - 1.0))) + pixel.y * (lod - 1.0) * 2.0;\n    }\n    else\n    {\n        coord.x *= (textureSize.y / textureSize.x);\n    }\n\n    // Do bilinear filtering\n    #ifndef OES_texture_float_linear\n        vec3 color1 = texture(projectedMap, coord + vec2(0.0, pixel.y)).rgb;\n        vec3 color2 = texture(projectedMap, coord + vec2(pixel.x, 0.0)).rgb;\n        vec3 color3 = texture(projectedMap, coord + pixel).rgb;\n        vec3 color4 = texture(projectedMap, coord).rgb;\n\n        vec2 texturePosition = coord * textureSize;\n\n        float fu = fract(texturePosition.x);\n        float fv = fract(texturePosition.y);\n\n        vec3 average1 = mix(color4, color2, fu);\n        vec3 average2 = mix(color1, color3, fu);\n\n        vec3 color = mix(average1, average2, fv);\n    #else\n        vec3 color = texture(projectedMap, coord).rgb;\n    #endif\n\n    return color;\n}\n\n\n/**\n * Samples from a cube map that has been projected using an octahedral projection from the given direction.\n *\n * @name czm_sampleOctahedralProjection\n * @glslFunction\n *\n * @param {sampler2D} projectedMap The texture with the octahedral projected cube map.\n * @param {vec2} textureSize The width and height dimensions in pixels of the projected map.\n * @param {vec3} direction The normalized direction used to sample the cube map.\n * @param {float} lod The level of detail to sample.\n * @param {float} maxLod The maximum level of detail.\n * @returns {vec3} The color of the cube map at the direction.\n */\nvec3 czm_sampleOctahedralProjection(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod, float maxLod) {\n    float currentLod = floor(lod + 0.5);\n    float nextLod = min(currentLod + 1.0, maxLod);\n\n    vec3 colorCurrentLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, currentLod);\n    vec3 colorNextLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, nextLod);\n\n    return mix(colorNextLod, colorCurrentLod, nextLod - lod);\n}\n",oL="/**\n * Adjusts the saturation of a color.\n * \n * @name czm_saturation\n * @glslFunction\n * \n * @param {vec3} rgb The color.\n * @param {float} adjustment The amount to adjust the saturation of the color.\n *\n * @returns {float} The color with the saturation adjusted.\n *\n * @example\n * vec3 greyScale = czm_saturation(color, 0.0);\n * vec3 doubleSaturation = czm_saturation(color, 2.0);\n */\nvec3 czm_saturation(vec3 rgb, float adjustment)\n{\n    // Algorithm from Chapter 16 of OpenGL Shading Language\n    const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n    vec3 intensity = vec3(dot(rgb, W));\n    return mix(intensity, rgb, adjustment);\n}\n",rL="\nfloat czm_sampleShadowMap(highp samplerCube shadowMap, vec3 d)\n{\n    return czm_unpackDepth(czm_textureCube(shadowMap, d));\n}\n\nfloat czm_sampleShadowMap(highp sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\n    return texture(shadowMap, uv).r;\n#else\n    return czm_unpackDepth(texture(shadowMap, uv));\n#endif\n}\n\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\n    return step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\n    return step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n",sL="\nfloat czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\n    float strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\n    float strength = step(0.0, nDotL);\n#endif\n    visibility *= strength;\n#endif\n\n    visibility = max(visibility, darkness);\n    return visibility;\n}\n\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\n    float depthBias = shadowParameters.depthBias;\n    float depth = shadowParameters.depth;\n    float nDotL = shadowParameters.nDotL;\n    float normalShadingSmooth = shadowParameters.normalShadingSmooth;\n    float darkness = shadowParameters.darkness;\n    vec3 uvw = shadowParameters.texCoords;\n\n    depth -= depthBias;\n    float visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\n    return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\n    float depthBias = shadowParameters.depthBias;\n    float depth = shadowParameters.depth;\n    float nDotL = shadowParameters.nDotL;\n    float normalShadingSmooth = shadowParameters.normalShadingSmooth;\n    float darkness = shadowParameters.darkness;\n    vec2 uv = shadowParameters.texCoords;\n\n    depth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\n    vec2 texelStepSize = shadowParameters.texelStepSize;\n    float radius = 1.0;\n    float dx0 = -texelStepSize.x * radius;\n    float dy0 = -texelStepSize.y * radius;\n    float dx1 = texelStepSize.x * radius;\n    float dy1 = texelStepSize.y * radius;\n    float visibility = (\n        czm_shadowDepthCompare(shadowMap, uv, depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\n        czm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n    ) * (1.0 / 9.0);\n#else\n    float visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\n\n    return czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n",aL="/**\n * Returns 1.0 if the given value is positive or zero, and -1.0 if it is negative.  This is similar to the GLSL\n * built-in function <code>sign</code> except that returns 1.0 instead of 0.0 when the input value is 0.0.\n * \n * @name czm_signNotZero\n * @glslFunction\n *\n * @param {} value The value for which to determine the sign.\n * @returns {} 1.0 if the value is positive or zero, -1.0 if the value is negative.\n */\nfloat czm_signNotZero(float value)\n{\n    return value >= 0.0 ? 1.0 : -1.0;\n}\n\nvec2 czm_signNotZero(vec2 value)\n{\n    return vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\n\nvec3 czm_signNotZero(vec3 value)\n{\n    return vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\n\nvec4 czm_signNotZero(vec4 value)\n{\n    return vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n",cL="/**\n * Computes a color from the third order spherical harmonic coefficients and a normalized direction vector.\n * <p>\n * The order of the coefficients is [L00, L1_1, L10, L11, L2_2, L2_1, L20, L21, L22].\n * </p>\n *\n * @name czm_sphericalHarmonics\n * @glslFunction\n *\n * @param {vec3} normal The normalized direction.\n * @param {vec3[9]} coefficients The third order spherical harmonic coefficients.\n * @returns {vec3} The color at the direction.\n *\n * @see https://graphics.stanford.edu/papers/envmap/envmap.pdf\n */\nvec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])\n{\n    vec3 L00 = coefficients[0];\n    vec3 L1_1 = coefficients[1];\n    vec3 L10 = coefficients[2];\n    vec3 L11 = coefficients[3];\n    vec3 L2_2 = coefficients[4];\n    vec3 L2_1 = coefficients[5];\n    vec3 L20 = coefficients[6];\n    vec3 L21 = coefficients[7];\n    vec3 L22 = coefficients[8];\n\n    float x = normal.x;\n    float y = normal.y;\n    float z = normal.z;\n\n    return\n          L00\n        + L1_1 * y\n        + L10 * z\n        + L11 * x\n        + L2_2 * (y * x)\n        + L2_1 * (y * z)\n        + L20 * (3.0 * z * z - 1.0)\n        + L21 * (z * x)\n        + L22 * (x * x - y * y);\n}\n",lL="/**\n * Converts an sRGB color to a linear RGB color.\n *\n * @param {vec3|vec4} srgbIn The color in sRGB space\n * @returns {vec3|vec4} The color in linear color space. The vector type matches the input.\n */\nvec3 czm_srgbToLinear(vec3 srgbIn)\n{\n    return pow(srgbIn, vec3(2.2));\n}\n\nvec4 czm_srgbToLinear(vec4 srgbIn) \n{\n    vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));\n    return vec4(linearOut, srgbIn.a);\n}\n",uL="/**\n * Creates a matrix that transforms vectors from tangent space to eye space.\n *\n * @name czm_tangentToEyeSpaceMatrix\n * @glslFunction\n *\n * @param {vec3} normalEC The normal vector in eye coordinates.\n * @param {vec3} tangentEC The tangent vector in eye coordinates.\n * @param {vec3} bitangentEC The bitangent vector in eye coordinates.\n *\n * @returns {mat3} The matrix that transforms from tangent space to eye space.\n *\n * @example\n * mat3 tangentToEye = czm_tangentToEyeSpaceMatrix(normalEC, tangentEC, bitangentEC);\n * vec3 normal = tangentToEye * texture(normalMap, st).xyz;\n */\nmat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\n    vec3 normal = normalize(normalEC);\n    vec3 tangent = normalize(tangentEC);\n    vec3 bitangent = normalize(bitangentEC);\n    return mat3(tangent.x  , tangent.y  , tangent.z,\n                bitangent.x, bitangent.y, bitangent.z,\n                normal.x   , normal.y   , normal.z);\n}\n",fL="/**\n * A wrapper around the texture (WebGL2) / textureCube (WebGL1)\n * function to allow for WebGL 1 support.\n * \n * @name czm_textureCube\n * @glslFunction\n *\n * @param {samplerCube} sampler The sampler.\n * @param {vec3} p The coordinates to sample the texture at.\n */\nvec4 czm_textureCube(samplerCube sampler, vec3 p) {\n#if __VERSION__ == 300\n    return texture(sampler, p);\n#else  \n    return textureCube(sampler, p);\n#endif\n}",dL="/**\n * Transforms a plane.\n * \n * @name czm_transformPlane\n * @glslFunction\n *\n * @param {vec4} plane The plane in Hessian Normal Form.\n * @param {mat4} transform The inverse-transpose of a transformation matrix.\n */\nvec4 czm_transformPlane(vec4 plane, mat4 transform) {\n    vec4 transformedPlane = transform * plane;\n    // Convert the transformed plane to Hessian Normal Form\n    float normalMagnitude = length(transformedPlane.xyz);\n    return transformedPlane / normalMagnitude;\n}\n",hL="/**\n * Translates a position (or any <code>vec3</code>) that was encoded with {@link EncodedCartesian3},\n * and then provided to the shader as separate <code>high</code> and <code>low</code> bits to\n * be relative to the eye.  As shown in the example, the position can then be transformed in eye\n * or clip coordinates using {@link czm_modelViewRelativeToEye} or {@link czm_modelViewProjectionRelativeToEye},\n * respectively.\n * <p>\n * This technique, called GPU RTE, eliminates jittering artifacts when using large coordinates as\n * described in {@link http://help.agi.com/AGIComponents/html/BlogPrecisionsPrecisions.htm|Precisions, Precisions}.\n * </p>\n *\n * @name czm_translateRelativeToEye\n * @glslFunction\n *\n * @param {vec3} high The position's high bits.\n * @param {vec3} low The position's low bits.\n * @returns {vec3} The position translated to be relative to the camera's position.\n *\n * @example\n * in vec3 positionHigh;\n * in vec3 positionLow;\n *\n * void main()\n * {\n *   vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n *   gl_Position = czm_modelViewProjectionRelativeToEye * p;\n * }\n *\n * @see czm_modelViewRelativeToEye\n * @see czm_modelViewProjectionRelativeToEye\n * @see czm_computePosition\n * @see EncodedCartesian3\n */\nvec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\n    vec3 highDifference = high - czm_encodedCameraPositionMCHigh;\n    vec3 lowDifference = low - czm_encodedCameraPositionMCLow;\n\n    return vec4(highDifference + lowDifference, 1.0);\n}\n",mL="/**\n * @private\n */\nvec4 czm_translucentPhong(vec3 toEye, czm_material material, vec3 lightDirectionEC)\n{\n    // Diffuse from directional light sources at eye (for top-down and horizon views)\n    float diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\n\n    if (czm_sceneMode == czm_sceneMode3D) {\n        // (and horizon views in 3D)\n        diffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n    }\n\n    diffuse = clamp(diffuse, 0.0, 1.0);\n\n    float specular = czm_getSpecular(lightDirectionEC, toEye, material.normal, material.shininess);\n\n    // Temporary workaround for adding ambient.\n    vec3 materialDiffuse = material.diffuse * 0.5;\n\n    vec3 ambient = materialDiffuse;\n    vec3 color = ambient + material.emission;\n    color += materialDiffuse * diffuse * czm_lightColor;\n    color += material.specular * specular * czm_lightColor;\n\n    return vec4(color, material.alpha);\n}\n",pL="/**\n * Returns the transpose of the matrix.  The input <code>matrix</code> can be\n * a <code>mat2</code>, <code>mat3</code>, or <code>mat4</code>.\n *\n * @name czm_transpose\n * @glslFunction\n *\n * @param {} matrix The matrix to transpose.\n *\n * @returns {} The transposed matrix.\n *\n * @example\n * // GLSL declarations\n * mat2 czm_transpose(mat2 matrix);\n * mat3 czm_transpose(mat3 matrix);\n * mat4 czm_transpose(mat4 matrix);\n *\n * // Transpose a 3x3 rotation matrix to find its inverse.\n * mat3 eastNorthUpToEye = czm_eastNorthUpToEyeCoordinates(\n *     positionMC, normalEC);\n * mat3 eyeToEastNorthUp = czm_transpose(eastNorthUpToEye);\n */\nmat2 czm_transpose(mat2 matrix)\n{\n    return mat2(\n        matrix[0][0], matrix[1][0],\n        matrix[0][1], matrix[1][1]);\n}\n\nmat3 czm_transpose(mat3 matrix)\n{\n    return mat3(\n        matrix[0][0], matrix[1][0], matrix[2][0],\n        matrix[0][1], matrix[1][1], matrix[2][1],\n        matrix[0][2], matrix[1][2], matrix[2][2]);\n}\n\nmat4 czm_transpose(mat4 matrix)\n{\n    return mat4(\n        matrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\n        matrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\n        matrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\n        matrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n",_L="/**\n * Unpacks a vec4 depth value to a float in [0, 1) range.\n *\n * @name czm_unpackDepth\n * @glslFunction\n *\n * @param {vec4} packedDepth The packed depth.\n *\n * @returns {float} The floating-point depth in [0, 1) range.\n */\n float czm_unpackDepth(vec4 packedDepth)\n {\n    // See Aras Pranckeviius' post Encoding Floats to RGBA\n    // http://aras-p.info/blog/2009/07/30/encoding-floats-to-rgba-the-final/\n    return dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n }\n",gL="/**\n * Unpack an IEEE 754 single-precision float that is packed as a little-endian unsigned normalized vec4.\n *\n * @name czm_unpackFloat\n * @glslFunction\n *\n * @param {vec4} packedFloat The packed float.\n *\n * @returns {float} The floating-point depth in arbitrary range.\n */\nfloat czm_unpackFloat(vec4 packedFloat)\n{\n    // Convert to [0.0, 255.0] and round to integer\n    packedFloat = floor(packedFloat * 255.0 + 0.5);\n    float sign = 1.0 - step(128.0, packedFloat[3]) * 2.0;\n    float exponent = 2.0 * mod(packedFloat[3], 128.0) + step(128.0, packedFloat[2]) - 127.0;    \n    if (exponent == -127.0)\n    {\n        return 0.0;\n    }\n    float mantissa = mod(packedFloat[2], 128.0) * 65536.0 + packedFloat[1] * 256.0 + packedFloat[0] + float(0x800000);\n    float result = sign * exp2(exponent - 23.0) * mantissa;\n    return result;\n}\n",yL="/**\n * Unpack unsigned integers of 1-4 bytes. in WebGL 1, there is no uint type,\n * so the return value is an int.\n * <p>\n * There are also precision limitations in WebGL 1. highp int is still limited\n * to 24 bits. Above the value of 2^24 = 16777216, precision loss may occur.\n * </p>\n *\n * @param {float|vec2|vec3|vec4} packed The packed value. For vectors, the components are listed in little-endian order.\n *\n * @return {int} The unpacked value.\n */\n int czm_unpackUint(float packedValue) {\n   float rounded = czm_round(packedValue * 255.0);\n   return int(rounded);\n }\n\n int czm_unpackUint(vec2 packedValue) {\n   vec2 rounded = czm_round(packedValue * 255.0);\n   return int(dot(rounded, vec2(1.0, 256.0)));\n }\n\n int czm_unpackUint(vec3 packedValue) {\n   vec3 rounded = czm_round(packedValue * 255.0);\n   return int(dot(rounded, vec3(1.0, 256.0, 65536.0)));\n }\n\n int czm_unpackUint(vec4 packedValue) {\n   vec4 rounded = czm_round(packedValue * 255.0);\n   return int(dot(rounded, vec4(1.0, 256.0, 65536.0, 16777216.0)));\n }\n",xL="/**\n * Transform metadata values following the EXT_structural_metadata spec\n * by multiplying by scale and adding the offset. Operations are always\n * performed component-wise, even for matrices.\n * \n * @param {float|vec2|vec3|vec4|mat2|mat3|mat4} offset The offset to add\n * @param {float|vec2|vec3|vec4|mat2|mat3|mat4} scale The scale factor to multiply\n * @param {float|vec2|vec3|vec4|mat2|mat3|mat4} value The original value.\n *\n * @return {float|vec2|vec3|vec4|mat2|mat3|mat4} The transformed value of the same scalar/vector/matrix type as the input.\n */\nfloat czm_valueTransform(float offset, float scale, float value) {\n  return scale * value + offset;\n}\n\nvec2 czm_valueTransform(vec2 offset, vec2 scale, vec2 value) {\n  return scale * value + offset;\n}\n\nvec3 czm_valueTransform(vec3 offset, vec3 scale, vec3 value) {\n  return scale * value + offset;\n}\n\nvec4 czm_valueTransform(vec4 offset, vec4 scale, vec4 value) {\n  return scale * value + offset;\n}\n\nmat2 czm_valueTransform(mat2 offset, mat2 scale, mat2 value) {\n  return matrixCompMult(scale, value) + offset;\n}\n\nmat3 czm_valueTransform(mat3 offset, mat3 scale, mat3 value) {\n  return matrixCompMult(scale, value) + offset;\n}\n\nmat4 czm_valueTransform(mat4 offset, mat4 scale, mat4 value) {\n  return matrixCompMult(scale, value) + offset;\n}\n",bL="#ifdef LOG_DEPTH\n// 1.0 at the near plane, increasing linearly from there.\nout float v_depthFromNearPlusOne;\n#ifdef SHADOW_MAP\nout vec3 v_logPositionEC;\n#endif\n#endif\n\nvec4 czm_updatePositionDepth(vec4 coords) {\n#if defined(LOG_DEPTH)\n\n#ifdef SHADOW_MAP\n    vec3 logPositionEC = (czm_inverseProjection * coords).xyz;\n    v_logPositionEC = logPositionEC;\n#endif\n\n    // With the very high far/near ratios used with the logarithmic depth\n    // buffer, floating point rounding errors can cause linear depth values\n    // to end up on the wrong side of the far plane, even for vertices that\n    // are really nowhere near it. Since we always write a correct logarithmic\n    // depth value in the fragment shader anyway, we just need to make sure\n    // such errors don't cause the primitive to be clipped entirely before\n    // we even get to the fragment shader.\n    coords.z = clamp(coords.z / coords.w, -1.0, 1.0) * coords.w;\n#endif\n\n    return coords;\n}\n\n/**\n * Writes the logarithmic depth to gl_Position using the already computed gl_Position.\n *\n * @name czm_vertexLogDepth\n * @glslFunction\n */\nvoid czm_vertexLogDepth()\n{\n#ifdef LOG_DEPTH\n    v_depthFromNearPlusOne = (gl_Position.w - czm_currentFrustum.x) + 1.0;\n    gl_Position = czm_updatePositionDepth(gl_Position);\n#endif\n}\n\n/**\n * Writes the logarithmic depth to gl_Position using the provided clip coordinates.\n * <p>\n * An example use case for this function would be moving the vertex in window coordinates\n * before converting back to clip coordinates. Use the original vertex clip coordinates.\n * </p>\n * @name czm_vertexLogDepth\n * @glslFunction\n *\n * @param {vec4} clipCoords The vertex in clip coordinates.\n *\n * @example\n * czm_vertexLogDepth(czm_projection * vec4(positionEyeCoordinates, 1.0));\n */\nvoid czm_vertexLogDepth(vec4 clipCoords)\n{\n#ifdef LOG_DEPTH\n    v_depthFromNearPlusOne = (clipCoords.w - czm_currentFrustum.x) + 1.0;\n    czm_updatePositionDepth(clipCoords);\n#endif\n}\n",TL="vec4 czm_screenToEyeCoordinates(vec4 screenCoordinate)\n{\n    // Reconstruct NDC coordinates\n    float x = 2.0 * screenCoordinate.x - 1.0;\n    float y = 2.0 * screenCoordinate.y - 1.0;\n    float z = (screenCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\n    vec4 q = vec4(x, y, z, 1.0);\n\n    // Reverse the perspective division to obtain clip coordinates.\n    q /= screenCoordinate.w;\n\n    // Reverse the projection transformation to obtain eye coordinates.\n    if (!(czm_inverseProjection == mat4(0.0))) // IE and Edge sometimes do something weird with != between mat4s\n    {\n        q = czm_inverseProjection * q;\n    }\n    else\n    {\n        float top = czm_frustumPlanes.x;\n        float bottom = czm_frustumPlanes.y;\n        float left = czm_frustumPlanes.z;\n        float right = czm_frustumPlanes.w;\n\n        float near = czm_currentFrustum.x;\n        float far = czm_currentFrustum.y;\n\n        q.x = (q.x * (right - left) + left + right) * 0.5;\n        q.y = (q.y * (top - bottom) + bottom + top) * 0.5;\n        q.z = (q.z * (near - far) - near - far) * 0.5;\n        q.w = 1.0;\n    }\n\n    return q;\n}\n\n/**\n * Transforms a position from window to eye coordinates.\n * The transform from window to normalized device coordinates is done using components\n * of (@link czm_viewport} and {@link czm_viewportTransformation} instead of calculating\n * the inverse of <code>czm_viewportTransformation</code>. The transformation from\n * normalized device coordinates to clip coordinates is done using <code>fragmentCoordinate.w</code>,\n * which is expected to be the scalar used in the perspective divide. The transformation\n * from clip to eye coordinates is done using {@link czm_inverseProjection}.\n *\n * @name czm_windowToEyeCoordinates\n * @glslFunction\n *\n * @param {vec4} fragmentCoordinate The position in window coordinates to transform.\n *\n * @returns {vec4} The transformed position in eye coordinates.\n *\n * @see czm_modelToWindowCoordinates\n * @see czm_eyeToWindowCoordinates\n * @see czm_inverseProjection\n * @see czm_viewport\n * @see czm_viewportTransformation\n *\n * @example\n * vec4 positionEC = czm_windowToEyeCoordinates(gl_FragCoord);\n */\nvec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\n    vec2 screenCoordXY = (fragmentCoordinate.xy - czm_viewport.xy) / czm_viewport.zw;\n    return czm_screenToEyeCoordinates(vec4(screenCoordXY, fragmentCoordinate.zw));\n}\n\nvec4 czm_screenToEyeCoordinates(vec2 screenCoordinateXY, float depthOrLogDepth)\n{\n    // See reverseLogDepth.glsl. This is separate to re-use the pow.\n#if defined(LOG_DEPTH) || defined(LOG_DEPTH_READ_ONLY)\n    float near = czm_currentFrustum.x;\n    float far = czm_currentFrustum.y;\n    float log2Depth = depthOrLogDepth * czm_log2FarDepthFromNearPlusOne;\n    float depthFromNear = pow(2.0, log2Depth) - 1.0;\n    float depthFromCamera = depthFromNear + near;\n    vec4 screenCoord = vec4(screenCoordinateXY, far * (1.0 - near / depthFromCamera) / (far - near), 1.0);\n    vec4 eyeCoordinate = czm_screenToEyeCoordinates(screenCoord);\n    eyeCoordinate.w = 1.0 / depthFromCamera; // Better precision\n    return eyeCoordinate;\n#else\n    vec4 screenCoord = vec4(screenCoordinateXY, depthOrLogDepth, 1.0);\n    vec4 eyeCoordinate = czm_screenToEyeCoordinates(screenCoord);\n#endif\n    return eyeCoordinate;\n}\n\n/**\n * Transforms a position given as window x/y and a depth or a log depth from window to eye coordinates.\n * This function produces more accurate results for window positions with log depth than\n * conventionally unpacking the log depth using czm_reverseLogDepth and using the standard version\n * of czm_windowToEyeCoordinates.\n *\n * @name czm_windowToEyeCoordinates\n * @glslFunction\n *\n * @param {vec2} fragmentCoordinateXY The XY position in window coordinates to transform.\n * @param {float} depthOrLogDepth A depth or log depth for the fragment.\n *\n * @see czm_modelToWindowCoordinates\n * @see czm_eyeToWindowCoordinates\n * @see czm_inverseProjection\n * @see czm_viewport\n * @see czm_viewportTransformation\n *\n * @returns {vec4} The transformed position in eye coordinates.\n */\nvec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)\n{\n    vec2 screenCoordXY = (fragmentCoordinateXY.xy - czm_viewport.xy) / czm_viewport.zw;\n    return czm_screenToEyeCoordinates(screenCoordXY, depthOrLogDepth);\n}\n",AL="// emulated noperspective\n#if !defined(LOG_DEPTH)\nin float v_WindowZ;\n#endif\n\n/**\n * Emulates GL_DEPTH_CLAMP. Clamps a fragment to the near and far plane\n * by writing the fragment's depth. See czm_depthClamp for more details.\n *\n * @name czm_writeDepthClamp\n * @glslFunction\n *\n * @example\n * out_FragColor = color;\n * czm_writeDepthClamp();\n *\n * @see czm_depthClamp\n */\nvoid czm_writeDepthClamp()\n{\n#if (!defined(LOG_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))\n    gl_FragDepth = clamp(v_WindowZ * gl_FragCoord.w, 0.0, 1.0);\n#endif\n}\n",CL="#ifdef LOG_DEPTH\nin float v_depthFromNearPlusOne;\n\n#ifdef POLYGON_OFFSET\nuniform vec2 u_polygonOffset;\n#endif\n\n#endif\n\n/**\n * Writes the fragment depth to the logarithmic depth buffer.\n * <p>\n * Use this when the vertex shader does not call {@link czm_vertexlogDepth}, for example, when\n * ray-casting geometry using a full screen quad.\n * </p>\n * @name czm_writeLogDepth\n * @glslFunction\n *\n * @param {float} depth The depth coordinate, where 1.0 is on the near plane and\n *                      depth increases in eye-space units from there\n *\n * @example\n * czm_writeLogDepth((czm_projection * v_positionEyeCoordinates).w + 1.0);\n */\nvoid czm_writeLogDepth(float depth)\n{\n#if (defined(LOG_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))\n    // Discard the vertex if it's not between the near and far planes.\n    // We allow a bit of epsilon on the near plane comparison because a 1.0\n    // from the vertex shader (indicating the vertex should be _on_ the near\n    // plane) will not necessarily come here as exactly 1.0.\n    if (depth <= 0.9999999 || depth > czm_farDepthFromNearPlusOne) {\n        discard;\n    }\n\n#ifdef POLYGON_OFFSET\n    // Polygon offset: m * factor + r * units\n    float factor = u_polygonOffset[0];\n    float units = u_polygonOffset[1];\n\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    // This factor doesn't work in IE 10\n    if (factor != 0.0) {\n        // m = sqrt(dZdX^2 + dZdY^2);\n        float x = dFdx(depth);\n        float y = dFdy(depth);\n        float m = sqrt(x * x + y * y);\n\n        // Apply the factor before computing the log depth.\n        depth += m * factor;\n    }\n#endif\n\n#endif\n\n    gl_FragDepth = log2(depth) * czm_oneOverLog2FarDepthFromNearPlusOne;\n\n#ifdef POLYGON_OFFSET\n    // Apply the units after the log depth.\n    gl_FragDepth += czm_epsilon7 * units;\n#endif\n\n#endif\n}\n\n/**\n * Writes the fragment depth to the logarithmic depth buffer.\n * <p>\n * Use this when the vertex shader calls {@link czm_vertexlogDepth}.\n * </p>\n *\n * @name czm_writeLogDepth\n * @glslFunction\n */\nvoid czm_writeLogDepth() {\n#ifdef LOG_DEPTH\n    czm_writeLogDepth(v_depthFromNearPlusOne);\n#endif\n}\n",EL="/**\n * Transforms a value for non-perspective interpolation by multiplying\n * it by w, the value used in the perspective divide. This function is\n * intended to be called in a vertex shader to compute the value of a\n * `varying` that should not be subject to perspective interpolation.\n * For example, screen-space texture coordinates. The fragment shader\n * must call {@link czm_readNonPerspective} to retrieve the final\n * non-perspective value.\n *\n * @name czm_writeNonPerspective\n * @glslFunction\n *\n * @param {float|vec2|vec3|vec4} value The value to be interpolated without accounting for perspective.\n * @param {float} w The perspective divide value. Usually this is the computed `gl_Position.w`.\n * @returns {float|vec2|vec3|vec4} The transformed value, intended to be stored in a `varying` and read in the\n *          fragment shader with {@link czm_readNonPerspective}.\n */\nfloat czm_writeNonPerspective(float value, float w) {\n    return value * w;\n}\n\nvec2 czm_writeNonPerspective(vec2 value, float w) {\n    return value * w;\n}\n\nvec3 czm_writeNonPerspective(vec3 value, float w) {\n    return value * w;\n}\n\nvec4 czm_writeNonPerspective(vec4 value, float w) {\n    return value * w;\n}\n",SL="/**\n * Converts a CIE Yxy color to RGB.\n * <p>The conversion is described in\n * {@link http://content.gpwiki.org/index.php/D3DBook:High-Dynamic_Range_Rendering#Luminance_Transform|Luminance Transform}\n * </p>\n * \n * @name czm_XYZToRGB\n * @glslFunction\n * \n * @param {vec3} Yxy The color in CIE Yxy.\n *\n * @returns {vec3} The color in RGB.\n *\n * @example\n * vec3 xyz = czm_RGBToXYZ(rgb);\n * xyz.x = max(xyz.x - luminanceThreshold, 0.0);\n * rgb = czm_XYZToRGB(xyz);\n */\nvec3 czm_XYZToRGB(vec3 Yxy)\n{\n    const mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n                              -1.5371,  1.8760, -0.2040,\n                              -0.4985,  0.0416,  1.0572);\n    vec3 xyz;\n    xyz.r = Yxy.r * Yxy.g / Yxy.b;\n    xyz.g = Yxy.r;\n    xyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\n    \n    return XYZ2RGB * xyz;\n}\n",tA={czm_degreesPerRadian:iR,czm_depthRange:oR,czm_epsilon1:rR,czm_epsilon2:sR,czm_epsilon3:aR,czm_epsilon4:cR,czm_epsilon5:lR,czm_epsilon6:uR,czm_epsilon7:fR,czm_infinity:dR,czm_oneOverPi:hR,czm_oneOverTwoPi:mR,czm_passCesium3DTile:pR,czm_passCesium3DTileClassification:_R,czm_passCesium3DTileClassificationIgnoreShow:gR,czm_passClassification:yR,czm_passCompute:xR,czm_passEnvironment:bR,czm_passGlobe:TR,czm_passOpaque:AR,czm_passOverlay:CR,czm_passTerrainClassification:ER,czm_passTranslucent:SR,czm_passVoxels:wR,czm_pi:vR,czm_piOverFour:DR,czm_piOverSix:IR,czm_piOverThree:PR,czm_piOverTwo:OR,czm_radiansPerDegree:RR,czm_sceneMode2D:MR,czm_sceneMode3D:LR,czm_sceneModeColumbusView:NR,czm_sceneModeMorphing:FR,czm_solarRadius:BR,czm_threePiOver2:kR,czm_twoPi:VR,czm_webMercatorMaxLatitude:UR,czm_depthRangeStruct:zR,czm_material:HR,czm_materialInput:GR,czm_modelMaterial:WR,czm_modelVertexOutput:jR,czm_pbrParameters:qR,czm_ray:YR,czm_raySegment:XR,czm_shadowParameters:KR,czm_acesTonemapping:ZR,czm_alphaWeight:$R,czm_antialias:QR,czm_approximateSphericalCoordinates:JR,czm_backFacing:eM,czm_branchFreeTernary:tM,czm_cascadeColor:nM,czm_cascadeDistance:iM,czm_cascadeMatrix:oM,czm_cascadeWeights:rM,czm_columbusViewMorph:sM,czm_computePosition:aM,czm_cosineAndSine:cM,czm_decompressTextureCoordinates:lM,czm_defaultPbrMaterial:uM,czm_depthClamp:fM,czm_eastNorthUpToEyeCoordinates:dM,czm_ellipsoidContainsPoint:hM,czm_ellipsoidWgs84TextureCoordinates:mM,czm_equalsEpsilon:pM,czm_eyeOffset:_M,czm_eyeToWindowCoordinates:gM,czm_fastApproximateAtan:yM,czm_fog:xM,czm_gammaCorrect:bM,czm_geodeticSurfaceNormal:TM,czm_getDefaultMaterial:AM,czm_getLambertDiffuse:CM,czm_getSpecular:EM,czm_getWaterNoise:SM,czm_HSBToRGB:wM,czm_HSLToRGB:vM,czm_hue:DM,czm_inverseGamma:IM,czm_isEmpty:PM,czm_isFull:OM,czm_latitudeToWebMercatorFraction:RM,czm_linearToSrgb:MM,czm_lineDistance:LM,czm_luminance:NM,czm_metersPerPixel:FM,czm_modelToWindowCoordinates:BM,czm_multiplyWithColorBalance:kM,czm_nearFarScalar:VM,czm_octDecode:UM,czm_packDepth:zM,czm_pbrLighting:HM,czm_pbrMetallicRoughnessMaterial:GM,czm_pbrSpecularGlossinessMaterial:WM,czm_phong:jM,czm_planeDistance:qM,czm_pointAlongRay:YM,czm_rayEllipsoidIntersectionInterval:XM,czm_raySphereIntersectionInterval:KM,czm_readDepth:ZM,czm_readNonPerspective:$M,czm_reverseLogDepth:QM,czm_RGBToHSB:JM,czm_RGBToHSL:eL,czm_RGBToXYZ:tL,czm_round:nL,czm_sampleOctahedralProjection:iL,czm_saturation:oL,czm_shadowDepthCompare:rL,czm_shadowVisibility:sL,czm_signNotZero:aL,czm_sphericalHarmonics:cL,czm_srgbToLinear:lL,czm_tangentToEyeSpaceMatrix:uL,czm_textureCube:fL,czm_transformPlane:dL,czm_translateRelativeToEye:hL,czm_translucentPhong:mL,czm_transpose:pL,czm_unpackDepth:_L,czm_unpackFloat:gL,czm_unpackUint:yL,czm_valueTransform:xL,czm_vertexLogDepth:bL,czm_windowToEyeCoordinates:TL,czm_writeDepthClamp:AL,czm_writeLogDepth:CL,czm_writeNonPerspective:EL,czm_XYZToRGB:SL};function h2e(e,t){let i=e;return i=i.replaceAll("version 300 es",""),i=i.replaceAll(/(texture\()/g,"texture2D("),t?(i=i.replaceAll(/(in)\s+(vec\d|mat\d|float)/g,"varying $2"),/out_FragData_(\d+)/.test(i)&&(i=`#extension GL_EXT_draw_buffers : enable\n${i}`,i=i.replaceAll(/layout\s+\(location\s*=\s*\d+\)\s*out\s+vec4\s+out_FragData_\d+;/g,""),i=i.replaceAll(/out_FragData_(\d+)/g,"gl_FragData[$1]")),i=i.replaceAll(/layout\s+\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g,""),i=i.replaceAll(/out_FragColor/g,"gl_FragColor"),i=i.replaceAll(/out_FragColor\[(\d+)\]/g,"gl_FragColor[$1]"),/gl_FragDepth/.test(i)&&(i=`#extension GL_EXT_frag_depth : enable\n${i}`,i=i.replaceAll(/gl_FragDepth/g,"gl_FragDepthEXT")),i=`#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n${i}`):(i=i.replaceAll(/(in)\s+(vec\d|mat\d|float)/g,"attribute $2"),i=i.replaceAll(/(out)\s+(vec\d|mat\d|float)\s+([\w]+);/g,"varying $2 $3;")),i=`#version 100\n${i}`,i}var wL=h2e;function toe(e){return(e=e.replace(/\/\/.*/g,"")).replace(/\/\*\*[\s\S]*?\*\//gm,(function(e){let t=e.match(/\n/gm).length,i="";for(let e=0;e<t;++e)i+="\n";return i}))}function noe(e,t,i){let n;for(let t=0;t<i.length;++t)i[t].name===e&&(n=i[t]);return u(n)||(n={name:e,glslSource:t=toe(t),dependsOn:[],requiredBy:[],evaluated:!1},i.push(n)),n}function ioe(e,t){if(e.evaluated)return;e.evaluated=!0;let i=e.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);u(i)&&null!==i&&(i=i.filter((function(e,t){return i.indexOf(e)===t})),i.forEach((function(i){if(i!==e.name&&_s._czmBuiltinsAndUniforms.hasOwnProperty(i)){let n=noe(i,_s._czmBuiltinsAndUniforms[i],t);e.dependsOn.push(n),n.requiredBy.push(e),ioe(n,t)}})))}function m2e(e){let t=[],i=[];for(;e.length>0;){let n=e.pop();i.push(n),0===n.requiredBy.length&&t.push(n)}for(;t.length>0;){let i=t.shift();e.push(i);for(let e=0;e<i.dependsOn.length;++e){let n=i.dependsOn[e],r=n.requiredBy.indexOf(i);n.requiredBy.splice(r,1),0===n.requiredBy.length&&t.push(n)}}let n=[];for(let e=0;e<i.length;++e)0!==i[e].requiredBy.length&&n.push(i[e])}function p2e(e){let t=[],i=noe("main",e,t);ioe(i,t),m2e(t);let n="";for(let e=t.length-1;e>=0;--e)n=`${n+t[e].glslSource}\n`;return n.replace(i.glslSource,"")}function ooe(e,t,i){let n,r,o,a="",s=e.sources;if(u(s))for(n=0,r=s.length;n<r;++n)a+=`\n#line 0\n${s[n]}`;a=toe(a),a=a.replace(/#version\s+(.*?)\n/gm,(function(e,t){return o=t,"\n"}));let l=[];a=a.replace(/#extension.*\n/gm,(function(e){return l.push(e),"\n"})),a=a.replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");let c=e.pickColorQualifier;u(c)&&(a=_s.createPickFragmentShaderSource(a,c));let h="",d=l.length;for(n=0;n<d;n++)h+=l[n];t&&(h+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    precision highp int;\n#else\n    precision mediump float;\n    precision mediump int;\n    #define highp mediump\n#endif\n\n");let p=e.defines;if(u(p))for(n=0,r=p.length;n<r;++n){let e=p[n];0!==e.length&&(h+=`#define ${e}\n`)}i.textureFloatLinear&&(h+="#define OES_texture_float_linear\n\n"),i.floatingPointTexture&&(h+="#define OES_texture_float\n\n");let f="";e.includeBuiltIns&&(f=p2e(a)),h+="\n#line 0\n";let m=f+a;return i.webgl2&&t&&!/layout\s*\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g.test(m)&&!/czm_out_FragColor/g.test(m)&&/out_FragColor/g.test(m)&&(h+="layout(location = 0) out vec4 out_FragColor;\n\n"),h+=f,h+=a,h=i.webgl2?`#version 300 es\n${h}`:wL(h,t),h}function _s(e){let t=(e=y(e,y.EMPTY_OBJECT)).pickColorQualifier;this.defines=u(e.defines)?e.defines.slice(0):[],this.sources=u(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=y(e.includeBuiltIns,!0)}_s.prototype.clone=function(){return new _s({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},_s.replaceMain=function(e,t){return t=`void ${t}()`,e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)},_s.prototype.getCacheKey=function(){return`${this.defines.slice().sort().join(",")}:${this.pickColorQualifier}:${this.includeBuiltIns}:${this.sources.join("\n")}`},_s.prototype.createCombinedVertexShader=function(e){return ooe(this,!1,e)},_s.prototype.createCombinedFragmentShader=function(e){return ooe(this,!0,e)},_s._czmBuiltinsAndUniforms={};for(let e in tA)tA.hasOwnProperty(e)&&(_s._czmBuiltinsAndUniforms[e]=tA[e]);for(let e in eg)if(eg.hasOwnProperty(e)){let t=eg[e];"function"==typeof t.getDeclaration&&(_s._czmBuiltinsAndUniforms[e]=t.getDeclaration(e))}function _2e(e,t){let i=e.defines,n=i.length;for(let e=0;e<n;++e)if(i[e]===t)return!0;return!1}function roe(e,t){let i=e.sources,n=i.length;for(let e=0;e<n;++e)if(-1!==i[e].indexOf(t))return!0;return!1}function soe(e,t){let i=t.length;for(let n=0;n<i;++n){let i=t[n];if(roe(e,i))return i}}_s.createPickVertexShaderSource=function(e){return`${_s.replaceMain(e,"czm_old_main")}\nin vec4 pickColor; \nout vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}`},_s.createPickFragmentShaderSource=function(e,t){return`${_s.replaceMain(e,"czm_old_main")}\n${`${t} vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (out_FragColor.a == 0.0) { \n       discard; \n    } \n    out_FragColor = czm_pickColor; \n}`}`};var g2e=["v_normalEC","v_normal"];_s.findNormalVarying=function(e){return roe(e,"#ifdef HAS_NORMALS")?_2e(e,"HAS_NORMALS")?"v_normalEC":void 0:soe(e,g2e)};var y2e=["v_positionEC"];_s.findPositionVarying=function(e){return soe(e,y2e)};var He=_s;function x2e(e,t,i,n){let r=u(t.vertexBuffer),o=u(t.value),a=t.value?t.value.length:t.componentsPerAttribute,s={index:y(t.index,i),enabled:y(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:o?t.value.slice(0):void 0,componentsPerAttribute:a,componentDatatype:y(t.componentDatatype,X.FLOAT),normalize:y(t.normalize,!1),offsetInBytes:y(t.offsetInBytes,0),strideInBytes:y(t.strideInBytes,0),instanceDivisor:y(t.instanceDivisor,0)};if(r)s.vertexAttrib=function(e){let t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),this.instanceDivisor>0&&(n.glVertexAttribDivisor(t,this.instanceDivisor),n._vertexAttribDivisors[t]=this.instanceDivisor,n._previousDrawInstanced=!0)},s.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),this.instanceDivisor>0&&n.glVertexAttribDivisor(i,0)};else{switch(s.componentsPerAttribute){case 1:s.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:s.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:s.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:s.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}s.disableVertexAttribArray=function(e){}}e.push(s)}function coe(e,t,i){for(let i=0;i<t.length;++i){let n=t[i];n.enabled&&n.vertexAttrib(e)}u(i)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i._getBuffer())}function tp(e){let t,i,n=(e=y(e,y.EMPTY_OBJECT)).context,r=n._gl,o=e.attributes,a=e.indexBuffer,s=[],l=1,c=!1,h=!1,d=o.length;for(t=0;t<d;++t)x2e(s,o[t],t,n);for(d=s.length,t=0;t<d;++t){let e=s[t];if(u(e.vertexBuffer)&&0===e.instanceDivisor){let t=e.strideInBytes||e.componentsPerAttribute*X.getSizeInBytes(e.componentDatatype);l=e.vertexBuffer.sizeInBytes/t;break}}for(t=0;t<d;++t)s[t].instanceDivisor>0&&(c=!0),u(s[t].value)&&(h=!0);n.vertexArrayObject&&(i=n.glCreateVertexArray(),n.glBindVertexArray(i),coe(r,s,a),n.glBindVertexArray(null)),this._numberOfVertices=l,this._hasInstancedAttributes=c,this._hasConstantAttributes=h,this._context=n,this._gl=r,this._vao=i,this._attributes=s,this._indexBuffer=a}function aoe(e){return e.values.length/e.componentsPerAttribute}function b2e(e){return X.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}function T2e(e){let t,i,n,r=[];for(i in e)e.hasOwnProperty(i)&&u(e[i])&&u(e[i].values)&&(r.push(i),e[i].componentDatatype===X.DOUBLE&&(e[i].componentDatatype=X.FLOAT,e[i].values=X.createTypedArray(X.FLOAT,e[i].values)));let o,a=r.length;if(a>0)for(o=aoe(e[r[0]]),t=1;t<a;++t){let i=aoe(e[r[t]]);if(i!==o)throw new ue(`Each attribute list must have the same number of vertices.  Attribute ${r[t]} has a different number of vertices (${i.toString()}) than attribute ${r[0]} (${o.toString()}).`)}r.sort((function(t,i){return X.getSizeInBytes(e[i].componentDatatype)-X.getSizeInBytes(e[t].componentDatatype)}));let s=0,l={};for(t=0;t<a;++t)i=r[t],n=e[i],l[i]=s,s+=b2e(n);if(s>0){let u=X.getSizeInBytes(e[r[0]].componentDatatype),c=s%u;0!==c&&(s+=u-c);let h=new ArrayBuffer(o*s),d={};for(t=0;t<a;++t){i=r[t];let n=X.getSizeInBytes(e[i].componentDatatype);d[i]={pointer:X.createTypedArray(e[i].componentDatatype,h),index:l[i]/n,strideInComponentType:s/n}}for(t=0;t<o;++t)for(let o=0;o<a;++o){i=r[o],n=e[i];let a=n.values,s=d[i],l=s.pointer,u=n.componentsPerAttribute;for(let e=0;e<u;++e)l[s.index+e]=a[t*u+e];s.index+=s.strideInComponentType}return{buffer:h,offsetsInBytes:l,vertexSizeInBytes:s}}}function A2e(e){let t=e._context,i=e._hasInstancedAttributes;if(!i&&!t._previousDrawInstanced)return;t._previousDrawInstanced=i;let n,r=t._vertexAttribDivisors,o=e._attributes,a=zt.maximumVertexAttributes;if(i){let e=o.length;for(n=0;n<e;++n){let e=o[n];if(e.enabled){let i=e.instanceDivisor,n=e.index;i!==r[n]&&(t.glVertexAttribDivisor(n,i),r[n]=i)}}}else for(n=0;n<a;++n)r[n]>0&&(t.glVertexAttribDivisor(n,0),r[n]=0)}function C2e(e,t){let i=e._attributes,n=i.length;for(let e=0;e<n;++e){let n=i[e];n.enabled&&u(n.value)&&n.vertexAttrib(t)}}tp.fromGeometry=function(e){let t,i,n,r=(e=y(e,y.EMPTY_OBJECT)).context,o=y(e.geometry,y.EMPTY_OBJECT),a=y(e.bufferUsage,Be.DYNAMIC_DRAW),s=y(e.attributeLocations,y.EMPTY_OBJECT),l=y(e.interleave,!1),c=e.vertexArrayAttributes,h=u(c)?c:[],d=o.attributes;if(l){let e=T2e(d);if(u(e)){n=ut.createVertexBuffer({context:r,typedArray:e.buffer,usage:a});let o=e.offsetsInBytes,l=e.vertexSizeInBytes;for(t in d)d.hasOwnProperty(t)&&u(d[t])&&(i=d[t],u(i.values)?h.push({index:s[t],vertexBuffer:n,componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,offsetInBytes:o[t],strideInBytes:l}):h.push({index:s[t],value:i.value,componentDatatype:i.componentDatatype,normalize:i.normalize}))}}else for(t in d)if(d.hasOwnProperty(t)&&u(d[t])){i=d[t];let e=i.componentDatatype;e===X.DOUBLE&&(e=X.FLOAT),n=void 0,u(i.values)&&(n=ut.createVertexBuffer({context:r,typedArray:X.createTypedArray(e,i.values),usage:a})),h.push({index:s[t],vertexBuffer:n,value:i.value,componentDatatype:e,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize})}let p,f=o.indices;return u(f)&&(p=ct.computeNumberOfVertices(o)>=P.SIXTY_FOUR_KILOBYTES&&r.elementIndexUint?ut.createIndexBuffer({context:r,typedArray:new Uint32Array(f),usage:a,indexDatatype:ke.UNSIGNED_INT}):ut.createIndexBuffer({context:r,typedArray:new Uint16Array(f),usage:a,indexDatatype:ke.UNSIGNED_SHORT})),new tp({context:r,attributes:h,indexBuffer:p})},Object.defineProperties(tp.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),tp.prototype.getAttribute=function(e){return this._attributes[e]},tp.prototype._bind=function(){u(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&A2e(this),this._hasConstantAttributes&&C2e(this,this._gl)):coe(this._gl,this._attributes,this._indexBuffer)},tp.prototype._unBind=function(){if(u(this._vao))this._context.glBindVertexArray(null);else{let e=this._attributes,t=this._gl;for(let i=0;i<e.length;++i){let n=e[i];n.enabled&&n.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},tp.prototype.isDestroyed=function(){return!1},tp.prototype.destroy=function(){let e=this._attributes;for(let t=0;t<e.length;++t){let i=e[t].vertexBuffer;u(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy()}let t=this._indexBuffer;return u(t)&&!t.isDestroyed()&&t.vertexArrayDestroyable&&t.destroy(),u(this._vao)&&this._context.glDeleteVertexArray(this._vao),le(this)};var ni=tp;function gs(e,t,i,n){let r=gs._verifyAttributes(t);i=y(i,0);let o,a,s=[],l={},c=r.length;for(let e=0;e<c;++e){let t=r[e];t.vertexBuffer?s.push(t):(a=t.usage,o=l[a],u(o)||(o=l[a]=[]),o.push(t))}function h(e,t){return X.getSizeInBytes(t.componentDatatype)-X.getSizeInBytes(e.componentDatatype)}for(a in this._allBuffers=[],l)if(l.hasOwnProperty(a)){o=l[a],o.sort(h);let e=gs._vertexSizeInBytes(o),t={vertexSizeInBytes:e,vertexBuffer:void 0,usage:o[0].usage,needsCommit:!1,arrayBuffer:void 0,arrayViews:gs._createArrayViews(o,e)};this._allBuffers.push(t)}this._size=0,this._instanced=y(n,!1),this._precreated=s,this._context=e,this.writers=void 0,this.va=void 0,this.resize(i)}gs._verifyAttributes=function(e){let t=[];for(let i=0;i<e.length;++i){let n=e[i],r={index:y(n.index,i),enabled:y(n.enabled,!0),componentsPerAttribute:n.componentsPerAttribute,componentDatatype:y(n.componentDatatype,X.FLOAT),normalize:y(n.normalize,!1),vertexBuffer:n.vertexBuffer,usage:y(n.usage,Be.STATIC_DRAW)};t.push(r)}let i=new Array(t.length);for(let e=0;e<t.length;++e){i[t[e].index]=!0}return t},gs._vertexSizeInBytes=function(e){let t=0,i=e.length;for(let n=0;n<i;++n){let i=e[n];t+=i.componentsPerAttribute*X.getSizeInBytes(i.componentDatatype)}let n=i>0?X.getSizeInBytes(e[0].componentDatatype):0,r=n>0?t%n:0;return t+=0===r?0:n-r,t},gs._createArrayViews=function(e,t){let i=[],n=0,r=e.length;for(let o=0;o<r;++o){let r=e[o],a=r.componentDatatype;i.push({index:r.index,enabled:r.enabled,componentsPerAttribute:r.componentsPerAttribute,componentDatatype:a,normalize:r.normalize,offsetInBytes:n,vertexSizeInComponentType:t/X.getSizeInBytes(a),view:void 0}),n+=r.componentsPerAttribute*X.getSizeInBytes(a)}return i},gs.prototype.resize=function(e){this._size=e;let t=this._allBuffers;this.writers=[];for(let e=0,i=t.length;e<i;++e){let i=t[e];gs._resize(i,this._size),gs._appendWriters(this.writers,i)}v6(this)},gs._resize=function(e,t){if(e.vertexSizeInBytes>0){let i=new ArrayBuffer(t*e.vertexSizeInBytes);if(u(e.arrayBuffer)){let t=new Uint8Array(i),n=new Uint8Array(e.arrayBuffer),r=n.length;for(let e=0;e<r;++e)t[e]=n[e]}let n=e.arrayViews,r=n.length;for(let e=0;e<r;++e){let t=n[e];t.view=X.createArrayBufferView(t.componentDatatype,i,t.offsetInBytes)}e.arrayBuffer=i}};var E2e=[function(e,t,i){return function(n,r){t[n*i]=r,e.needsCommit=!0}},function(e,t,i){return function(n,r,o){let a=n*i;t[a]=r,t[a+1]=o,e.needsCommit=!0}},function(e,t,i){return function(n,r,o,a){let s=n*i;t[s]=r,t[s+1]=o,t[s+2]=a,e.needsCommit=!0}},function(e,t,i){return function(n,r,o,a,s){let l=n*i;t[l]=r,t[l+1]=o,t[l+2]=a,t[l+3]=s,e.needsCommit=!0}}];function S2e(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=!1;let i=t.vertexBuffer,n=e._size*t.vertexSizeInBytes,r=u(i);if(!r||i.sizeInBytes<n)return r&&i.destroy(),t.vertexBuffer=ut.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),t.vertexBuffer.vertexArrayDestroyable=!1,!0;t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}function w2e(e,t,i){if(e.needsCommit&&e.vertexSizeInBytes>0){let n=e.vertexSizeInBytes*t,r=e.vertexSizeInBytes*i;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,n,r),n)}}function v6(e){let t=e.va;if(!u(t))return;let i=t.length;for(let e=0;e<i;++e)t[e].va.destroy();e.va=void 0}gs._appendWriters=function(e,t){let i=t.arrayViews,n=i.length;for(let r=0;r<n;++r){let n=i[r];e[n.index]=E2e[n.componentsPerAttribute-1](t,n.view,n.vertexSizeInComponentType)}},gs.prototype.commit=function(e){let t,i,n,r=!1,o=this._allBuffers;for(i=0,n=o.length;i<n;++i)t=o[i],r=S2e(this,t)||r;if(r||!u(this.va)){v6(this);let r=this.va=[],a=P.SIXTY_FOUR_KILOBYTES-4,s=u(e)&&!this._instanced?Math.ceil(this._size/a):1;for(let l=0;l<s;++l){let u=[];for(i=0,n=o.length;i<n;++i){t=o[i];let e=l*(t.vertexSizeInBytes*a);gs._appendAttributes(u,t,e,this._instanced)}u=u.concat(this._precreated),r.push({va:new ni({context:this._context,attributes:u,indexBuffer:e}),indicesCount:1.5*(l!==s-1?a:this._size%a)})}}},gs._appendAttributes=function(e,t,i,n){let r=t.arrayViews,o=r.length;for(let a=0;a<o;++a){let o=r[a];e.push({index:o.index,enabled:o.enabled,componentsPerAttribute:o.componentsPerAttribute,componentDatatype:o.componentDatatype,normalize:o.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:i+o.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:n?1:0})}},gs.prototype.subCommit=function(e,t){let i=this._allBuffers;for(let n=0,r=i.length;n<r;++n)w2e(i[n],e,t)},gs.prototype.endSubCommits=function(){let e=this._allBuffers;for(let t=0,i=e.length;t<i;++t)e[t].needsCommit=!1},gs.prototype.isDestroyed=function(){return!1},gs.prototype.destroy=function(){let e=this._allBuffers;for(let t=0,i=e.length;t<i;++t){let i=e[t];i.vertexBuffer=i.vertexBuffer&&i.vertexBuffer.destroy()}return v6(this),le(this)};var tg=gs,vL='uniform sampler2D u_atlas;\n\n#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\n\nin vec2 v_textureCoordinates;\nin vec4 v_pickColor;\nin vec4 v_color;\n\n#ifdef SDF\nin vec4 v_outlineColor;\nin float v_outlineWidth;\n#endif\n\n#ifdef FRAGMENT_DEPTH_CHECK\nin vec4 v_textureCoordinateBounds;                  // the min and max x and y values for the texture coordinates\nin vec4 v_originTextureCoordinateAndTranslate;      // texture coordinate at the origin, billboard translate (used for label glyphs)\nin vec4 v_compressed;                               // x: eyeDepth, y: applyTranslate & enableDepthCheck, z: dimensions, w: imageSize\nin mat2 v_rotationMatrix;\n\nconst float SHIFT_LEFT12 = 4096.0;\nconst float SHIFT_LEFT1 = 2.0;\n\nconst float SHIFT_RIGHT12 = 1.0 / 4096.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\n\nfloat getGlobeDepth(vec2 adjustedST, vec2 depthLookupST, bool applyTranslate, vec2 dimensions, vec2 imageSize)\n{\n    vec2 lookupVector = imageSize * (depthLookupST - adjustedST);\n    lookupVector = v_rotationMatrix * lookupVector;\n    vec2 labelOffset = (dimensions - imageSize) * (depthLookupST - vec2(0.0, v_originTextureCoordinateAndTranslate.y)); // aligns label glyph with bounding rectangle.  Will be zero for billboards because dimensions and imageSize will be equal\n\n    vec2 translation = v_originTextureCoordinateAndTranslate.zw;\n\n    if (applyTranslate)\n    {\n        // this is only needed for labels where the horizontal origin is not LEFT\n        // it moves the label back to where the "origin" should be since all label glyphs are set to HorizontalOrigin.LEFT\n        translation += (dimensions * v_originTextureCoordinateAndTranslate.xy * vec2(1.0, 0.0));\n    }\n\n    vec2 st = ((lookupVector - translation + labelOffset) + gl_FragCoord.xy) / czm_viewport.zw;\n    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, st));\n\n    if (logDepthOrDepth == 0.0)\n    {\n        return 0.0; // not on the globe\n    }\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\n    return eyeCoordinate.z / eyeCoordinate.w;\n}\n#endif\n\n\n#ifdef SDF\n\n// Get the distance from the edge of a glyph at a given position sampling an SDF texture.\nfloat getDistance(vec2 position)\n{\n    return texture(u_atlas, position).r;\n}\n\n// Samples the sdf texture at the given position and produces a color based on the fill color and the outline.\nvec4 getSDFColor(vec2 position, float outlineWidth, vec4 outlineColor, float smoothing)\n{\n    float distance = getDistance(position);\n\n    if (outlineWidth > 0.0)\n    {\n        // Don\'t get the outline edge exceed the SDF_EDGE\n        float outlineEdge = clamp(SDF_EDGE - outlineWidth, 0.0, SDF_EDGE);\n        float outlineFactor = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);\n        vec4 sdfColor = mix(outlineColor, v_color, outlineFactor);\n        float alpha = smoothstep(outlineEdge - smoothing, outlineEdge + smoothing, distance);\n        return vec4(sdfColor.rgb, sdfColor.a * alpha);\n    }\n    else\n    {\n        float alpha = smoothstep(SDF_EDGE - smoothing, SDF_EDGE + smoothing, distance);\n        return vec4(v_color.rgb, v_color.a * alpha);\n    }\n}\n#endif\n\nvoid main()\n{\n    vec4 color = texture(u_atlas, v_textureCoordinates);\n\n#ifdef SDF\n    float outlineWidth = v_outlineWidth;\n    vec4 outlineColor = v_outlineColor;\n\n    // Get the current distance\n    float distance = getDistance(v_textureCoordinates);\n\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    float smoothing = fwidth(distance);\n    // Get an offset that is approximately half the distance to the neighbor pixels\n    // 0.354 is approximately half of 1/sqrt(2)\n    vec2 sampleOffset = 0.354 * vec2(dFdx(v_textureCoordinates) + dFdy(v_textureCoordinates));\n\n    // Sample the center point\n    vec4 center = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);\n\n    // Sample the 4 neighbors\n    vec4 color1 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);\n    vec4 color2 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, sampleOffset.y), outlineWidth, outlineColor, smoothing);\n    vec4 color3 = getSDFColor(v_textureCoordinates + vec2(-sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);\n    vec4 color4 = getSDFColor(v_textureCoordinates + vec2(sampleOffset.x, -sampleOffset.y), outlineWidth, outlineColor, smoothing);\n\n    // Equally weight the center sample and the 4 neighboring samples\n    color = (center + color1 + color2 + color3 + color4)/5.0;\n#else\n    // If no derivatives available (IE 10?), just do a single sample\n    float smoothing = 1.0/32.0;\n    color = getSDFColor(v_textureCoordinates, outlineWidth, outlineColor, smoothing);\n#endif\n\n    color = czm_gammaCorrect(color);\n#else\n    color = czm_gammaCorrect(color);\n    color *= czm_gammaCorrect(v_color);\n#endif\n\n// Fully transparent parts of the billboard are not pickable.\n#if !defined(OPAQUE) && !defined(TRANSLUCENT)\n    if (color.a < 0.005)   // matches 0/255 and 1/255\n    {\n        discard;\n    }\n#else\n// The billboard is rendered twice. The opaque pass discards translucent fragments\n// and the translucent pass discards opaque fragments.\n#ifdef OPAQUE\n    if (color.a < 0.995)   // matches < 254/255\n    {\n        discard;\n    }\n#else\n    if (color.a >= 0.995)  // matches 254/255 and 255/255\n    {\n        discard;\n    }\n#endif\n#endif\n\n#ifdef VECTOR_TILE\n    color *= u_highlightColor;\n#endif\n    out_FragColor = color;\n\n#ifdef LOG_DEPTH\n    czm_writeLogDepth();\n#endif\n\n#ifdef FRAGMENT_DEPTH_CHECK\n    float temp = v_compressed.y;\n\n    temp = temp * SHIFT_RIGHT1;\n\n    float temp2 = (temp - floor(temp)) * SHIFT_LEFT1;\n    bool enableDepthTest = temp2 != 0.0;\n    bool applyTranslate = floor(temp) != 0.0;\n\n    if (enableDepthTest) {\n        temp = v_compressed.z;\n        temp = temp * SHIFT_RIGHT12;\n\n        vec2 dimensions;\n        dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;\n        dimensions.x = floor(temp);\n\n        temp = v_compressed.w;\n        temp = temp * SHIFT_RIGHT12;\n\n        vec2 imageSize;\n        imageSize.y = (temp - floor(temp)) * SHIFT_LEFT12;\n        imageSize.x = floor(temp);\n\n        vec2 adjustedST = v_textureCoordinates - v_textureCoordinateBounds.xy;\n        adjustedST = adjustedST / vec2(v_textureCoordinateBounds.z - v_textureCoordinateBounds.x, v_textureCoordinateBounds.w - v_textureCoordinateBounds.y);\n\n        float epsilonEyeDepth = v_compressed.x + czm_epsilon1;\n        float globeDepth1 = getGlobeDepth(adjustedST, v_originTextureCoordinateAndTranslate.xy, applyTranslate, dimensions, imageSize);\n\n        // negative values go into the screen\n        if (globeDepth1 != 0.0 && globeDepth1 > epsilonEyeDepth)\n        {\n            float globeDepth2 = getGlobeDepth(adjustedST, vec2(0.0, 1.0), applyTranslate, dimensions, imageSize); // top left corner\n            if (globeDepth2 != 0.0 && globeDepth2 > epsilonEyeDepth)\n            {\n                float globeDepth3 = getGlobeDepth(adjustedST, vec2(1.0, 1.0), applyTranslate, dimensions, imageSize); // top right corner\n                if (globeDepth3 != 0.0 && globeDepth3 > epsilonEyeDepth)\n                {\n                    discard;\n                }\n            }\n        }\n    }\n#endif\n\n}\n',DL="#ifdef INSTANCED\nin vec2 direction;\n#endif\nin vec4 positionHighAndScale;\nin vec4 positionLowAndRotation;\nin vec4 compressedAttribute0;                       // pixel offset, translate, horizontal origin, vertical origin, show, direction, texture coordinates (texture offset)\nin vec4 compressedAttribute1;                       // aligned axis, translucency by distance, image width\nin vec4 compressedAttribute2;                       // label horizontal origin, image height, color, pick color, size in meters, valid aligned axis, 13 bits free\nin vec4 eyeOffset;                                  // eye offset in meters, 4 bytes free (texture range)\nin vec4 scaleByDistance;                            // near, nearScale, far, farScale\nin vec4 pixelOffsetScaleByDistance;                 // near, nearScale, far, farScale\nin vec4 compressedAttribute3;                       // distance display condition near, far, disableDepthTestDistance, dimensions\nin vec2 sdf;                                        // sdf outline color (rgb) and width (w)\n#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)\nin vec4 textureCoordinateBoundsOrLabelTranslate;    // the min and max x and y values for the texture coordinates\n#endif\n#ifdef VECTOR_TILE\nin float a_batchId;\n#endif\n\nout vec2 v_textureCoordinates;\n#ifdef FRAGMENT_DEPTH_CHECK\nout vec4 v_textureCoordinateBounds;\nout vec4 v_originTextureCoordinateAndTranslate;\nout vec4 v_compressed;                                 // x: eyeDepth, y: applyTranslate & enableDepthCheck, z: dimensions, w: imageSize\nout mat2 v_rotationMatrix;\n#endif\n\nout vec4 v_pickColor;\nout vec4 v_color;\n#ifdef SDF\nout vec4 v_outlineColor;\nout float v_outlineWidth;\n#endif\n\nconst float UPPER_BOUND = 32768.0;\n\nconst float SHIFT_LEFT16 = 65536.0;\nconst float SHIFT_LEFT12 = 4096.0;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_LEFT7 = 128.0;\nconst float SHIFT_LEFT5 = 32.0;\nconst float SHIFT_LEFT3 = 8.0;\nconst float SHIFT_LEFT2 = 4.0;\nconst float SHIFT_LEFT1 = 2.0;\n\nconst float SHIFT_RIGHT12 = 1.0 / 4096.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nconst float SHIFT_RIGHT7 = 1.0 / 128.0;\nconst float SHIFT_RIGHT5 = 1.0 / 32.0;\nconst float SHIFT_RIGHT3 = 1.0 / 8.0;\nconst float SHIFT_RIGHT2 = 1.0 / 4.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\n\nvec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)\n{\n    // Note the halfSize cannot be computed in JavaScript because it is sent via\n    // compressed vertex attributes that coerce it to an integer.\n    vec2 halfSize = imageSize * scale * 0.5;\n    halfSize *= ((direction * 2.0) - 1.0);\n\n    vec2 originTranslate = origin * abs(halfSize);\n\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\n    if (validAlignedAxis || rotation != 0.0)\n    {\n        float angle = rotation;\n        if (validAlignedAxis)\n        {\n            vec4 projectedAlignedAxis = czm_modelView3D * vec4(alignedAxis, 0.0);\n            angle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /\n                    (projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));\n        }\n\n        float cosTheta = cos(angle);\n        float sinTheta = sin(angle);\n        rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);\n        halfSize = rotationMatrix * halfSize;\n    }\n    else\n    {\n        rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n    mpp = czm_metersPerPixel(positionEC);\n    positionEC.xy += (originTranslate + halfSize) * czm_branchFreeTernary(sizeInMeters, 1.0, mpp);\n    positionEC.xy += (translate + pixelOffset) * mpp;\n\n    return positionEC;\n}\n\n#ifdef VERTEX_DEPTH_CHECK\nfloat getGlobeDepth(vec4 positionEC)\n{\n    vec4 posWC = czm_eyeToWindowCoordinates(positionEC);\n\n    float globeDepth = czm_unpackDepth(texture(czm_globeDepthTexture, posWC.xy / czm_viewport.zw));\n\n    if (globeDepth == 0.0)\n    {\n        return 0.0; // not on the globe\n    }\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(posWC.xy, globeDepth);\n    return eyeCoordinate.z / eyeCoordinate.w;\n}\n#endif\nvoid main()\n{\n    // Modifying this shader may also require modifications to Billboard._computeScreenSpacePosition\n\n    // unpack attributes\n    vec3 positionHigh = positionHighAndScale.xyz;\n    vec3 positionLow = positionLowAndRotation.xyz;\n    float scale = positionHighAndScale.w;\n\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\n    float rotation = positionLowAndRotation.w;\n#else\n    float rotation = 0.0;\n#endif\n\n    float compressed = compressedAttribute0.x;\n\n    vec2 pixelOffset;\n    pixelOffset.x = floor(compressed * SHIFT_RIGHT7);\n    compressed -= pixelOffset.x * SHIFT_LEFT7;\n    pixelOffset.x -= UPPER_BOUND;\n\n    vec2 origin;\n    origin.x = floor(compressed * SHIFT_RIGHT5);\n    compressed -= origin.x * SHIFT_LEFT5;\n\n    origin.y = floor(compressed * SHIFT_RIGHT3);\n    compressed -= origin.y * SHIFT_LEFT3;\n\n#ifdef FRAGMENT_DEPTH_CHECK\n    vec2 depthOrigin = origin.xy;\n#endif\n    origin -= vec2(1.0);\n\n    float show = floor(compressed * SHIFT_RIGHT2);\n    compressed -= show * SHIFT_LEFT2;\n\n#ifdef INSTANCED\n    vec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);\n    vec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);\n    vec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;\n#else\n    vec2 direction;\n    direction.x = floor(compressed * SHIFT_RIGHT1);\n    direction.y = compressed - direction.x * SHIFT_LEFT1;\n\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);\n#endif\n\n    float temp = compressedAttribute0.y  * SHIFT_RIGHT8;\n    pixelOffset.y = -(floor(temp) - UPPER_BOUND);\n\n    vec2 translate;\n    translate.y = (temp - floor(temp)) * SHIFT_LEFT16;\n\n    temp = compressedAttribute0.z * SHIFT_RIGHT8;\n    translate.x = floor(temp) - UPPER_BOUND;\n\n    translate.y += (temp - floor(temp)) * SHIFT_LEFT8;\n    translate.y -= UPPER_BOUND;\n\n    temp = compressedAttribute1.x * SHIFT_RIGHT8;\n    float temp2 = floor(compressedAttribute2.w * SHIFT_RIGHT2);\n\n    vec2 imageSize = vec2(floor(temp), temp2);\n\n#ifdef FRAGMENT_DEPTH_CHECK\n    float labelHorizontalOrigin = floor(compressedAttribute2.w - (temp2 * SHIFT_LEFT2));\n    float applyTranslate = 0.0;\n    if (labelHorizontalOrigin != 0.0) // is a billboard, so set apply translate to false\n    {\n        applyTranslate = 1.0;\n        labelHorizontalOrigin -= 2.0;\n        depthOrigin.x = labelHorizontalOrigin + 1.0;\n    }\n\n    depthOrigin = vec2(1.0) - (depthOrigin * 0.5);\n#endif\n\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    vec4 translucencyByDistance;\n    translucencyByDistance.x = compressedAttribute1.z;\n    translucencyByDistance.z = compressedAttribute1.w;\n\n    translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n\n    temp = compressedAttribute1.y * SHIFT_RIGHT8;\n    translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n\n#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)\n    temp = compressedAttribute3.w;\n    temp = temp * SHIFT_RIGHT12;\n\n    vec2 dimensions;\n    dimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;\n    dimensions.x = floor(temp);\n#endif\n\n#ifdef ALIGNED_AXIS\n    vec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));\n    temp = compressedAttribute2.z * SHIFT_RIGHT5;\n    bool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;\n#else\n    vec3 alignedAxis = vec3(0.0);\n    bool validAlignedAxis = false;\n#endif\n\n    vec4 pickColor;\n    vec4 color;\n\n    temp = compressedAttribute2.y;\n    temp = temp * SHIFT_RIGHT8;\n    pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    pickColor.r = floor(temp);\n\n    temp = compressedAttribute2.x;\n    temp = temp * SHIFT_RIGHT8;\n    color.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    color.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    color.r = floor(temp);\n\n    temp = compressedAttribute2.z * SHIFT_RIGHT8;\n    bool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;\n    temp = floor(temp) * SHIFT_RIGHT8;\n\n    pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\n    pickColor /= 255.0;\n\n    color.a = floor(temp);\n    color /= 255.0;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n\n#if defined(FRAGMENT_DEPTH_CHECK) || defined(VERTEX_DEPTH_CHECK)\n    float eyeDepth = positionEC.z;\n#endif\n\n    positionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);\n    positionEC.xyz *= show;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\n    float lengthSq;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        // 2D camera distance is a special case\n        // treat all billboards as flattened to the z=0.0 plane\n        lengthSq = czm_eyeHeight2D.y;\n    }\n    else\n    {\n        lengthSq = dot(positionEC.xyz, positionEC.xyz);\n    }\n#endif\n\n#ifdef EYE_DISTANCE_SCALING\n    float distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);\n    scale *= distanceScale;\n    translate *= distanceScale;\n    // push vertex behind near plane for clipping\n    if (scale == 0.0)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n    float translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\n    // push vertex behind near plane for clipping\n    if (translucency == 0.0)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n#ifdef EYE_DISTANCE_PIXEL_OFFSET\n    float pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);\n    pixelOffset *= pixelOffsetScale;\n#endif\n\n#ifdef DISTANCE_DISPLAY_CONDITION\n    float nearSq = compressedAttribute3.x;\n    float farSq = compressedAttribute3.y;\n    if (lengthSq < nearSq || lengthSq > farSq)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n    mat2 rotationMatrix;\n    float mpp;\n\n#ifdef DISABLE_DEPTH_DISTANCE\n    float disableDepthTestDistance = compressedAttribute3.z;\n#endif\n\n#ifdef VERTEX_DEPTH_CHECK\nif (lengthSq < disableDepthTestDistance) {\n    float depthsilon = 10.0;\n\n    vec2 labelTranslate = textureCoordinateBoundsOrLabelTranslate.xy;\n    vec4 pEC1 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\n    float globeDepth1 = getGlobeDepth(pEC1);\n\n    if (globeDepth1 != 0.0 && pEC1.z + depthsilon < globeDepth1)\n    {\n        vec4 pEC2 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0, 1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\n        float globeDepth2 = getGlobeDepth(pEC2);\n\n        if (globeDepth2 != 0.0 && pEC2.z + depthsilon < globeDepth2)\n        {\n            vec4 pEC3 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\n            float globeDepth3 = getGlobeDepth(pEC3);\n            if (globeDepth3 != 0.0 && pEC3.z + depthsilon < globeDepth3)\n            {\n                positionEC.xyz = vec3(0.0);\n            }\n        }\n    }\n}\n#endif\n\n    positionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\n    gl_Position = czm_projection * positionEC;\n    v_textureCoordinates = textureCoordinates;\n\n#ifdef LOG_DEPTH\n    czm_vertexLogDepth();\n#endif\n\n#ifdef DISABLE_DEPTH_DISTANCE\n    if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n    {\n        disableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n    }\n\n    if (disableDepthTestDistance != 0.0)\n    {\n        // Don't try to \"multiply both sides\" by w.  Greater/less-than comparisons won't work for negative values of w.\n        float zclip = gl_Position.z / gl_Position.w;\n        bool clipped = (zclip < -1.0 || zclip > 1.0);\n        if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n        {\n            // Position z on the near plane.\n            gl_Position.z = -gl_Position.w;\n#ifdef LOG_DEPTH\n            v_depthFromNearPlusOne = 1.0;\n#endif\n        }\n    }\n#endif\n\n#ifdef FRAGMENT_DEPTH_CHECK\n    if (sizeInMeters) {\n        translate /= mpp;\n        dimensions /= mpp;\n        imageSize /= mpp;\n    }\n\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\n    v_rotationMatrix = rotationMatrix;\n#else\n    v_rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);\n#endif\n\n    float enableDepthCheck = 0.0;\n    if (lengthSq < disableDepthTestDistance)\n    {\n        enableDepthCheck = 1.0;\n    }\n\n    float dw = floor(clamp(dimensions.x, 0.0, SHIFT_LEFT12));\n    float dh = floor(clamp(dimensions.y, 0.0, SHIFT_LEFT12));\n\n    float iw = floor(clamp(imageSize.x, 0.0, SHIFT_LEFT12));\n    float ih = floor(clamp(imageSize.y, 0.0, SHIFT_LEFT12));\n\n    v_compressed.x = eyeDepth;\n    v_compressed.y = applyTranslate * SHIFT_LEFT1 + enableDepthCheck;\n    v_compressed.z = dw * SHIFT_LEFT12 + dh;\n    v_compressed.w = iw * SHIFT_LEFT12 + ih;\n    v_originTextureCoordinateAndTranslate.xy = depthOrigin;\n    v_originTextureCoordinateAndTranslate.zw = translate;\n    v_textureCoordinateBounds = textureCoordinateBoundsOrLabelTranslate;\n\n#endif\n\n#ifdef SDF\n    vec4 outlineColor;\n    float outlineWidth;\n\n    temp = sdf.x;\n    temp = temp * SHIFT_RIGHT8;\n    outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    outlineColor.r = floor(temp);\n\n    temp = sdf.y;\n    temp = temp * SHIFT_RIGHT8;\n    float temp3 = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    outlineWidth = (temp - floor(temp)) * SHIFT_LEFT8;\n    outlineColor.a = floor(temp);\n    outlineColor /= 255.0;\n\n    v_outlineWidth = outlineWidth / 255.0;\n    v_outlineColor = outlineColor;\n    v_outlineColor.a *= translucency;\n#endif\n\n    v_pickColor = pickColor;\n\n    v_color = color;\n    v_color.a *= translucency;\n\n}\n",v2e={OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2},Ao=Object.freeze(v2e),D2e={FONT_SIZE:48,PADDING:10,RADIUS:8,CUTOFF:.25},Ns=Object.freeze(D2e);function np(e,t,i,n,r){this.bottomLeft=y(e,U.ZERO),this.topRight=y(t,U.ZERO),this.childNode1=i,this.childNode2=n,this.imageIndex=r}var I2e=new U(16,16);function ng(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.borderWidthInPixels,1),i=y(e.initialSize,I2e);this._context=e.context,this._pixelFormat=y(e.pixelFormat,rt.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=jn(),this._idHash={},this._indexHash={},this._initialSize=i,this._root=void 0}function P2e(e,t){let i=e._context,n=e.numberOfImages,r=e._borderWidthInPixels;if(n>0){let n=e._texture.width,o=e._texture.height,a=2*(n+t.width+r),s=2*(o+t.height+r),l=n/a,c=o/s,h=new np(new U(n+r,r),new U(a,o)),d=new np(new U,new U(a,o),e._root,h),p=new np(new U(r,o+r),new U(a,s)),f=new np(new U,new U(a,s),d,p);for(let t=0;t<e._textureCoordinates.length;t++){let i=e._textureCoordinates[t];u(i)&&(i.x*=l,i.y*=c,i.width*=l,i.height*=c)}let m=new Ot({context:e._context,width:a,height:s,pixelFormat:e._pixelFormat}),_=new oa({context:i,colorTextures:[e._texture],destroyAttachments:!1});_._bind(),m.copyFromFramebuffer(0,0,0,0,a,s),_._unBind(),_.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=m,e._root=f}else{let i=2*(t.width+2*r),n=2*(t.height+2*r);i<e._initialSize.x&&(i=e._initialSize.x),n<e._initialSize.y&&(n=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new Ot({context:e._context,width:i,height:n,pixelFormat:e._pixelFormat}),e._root=new np(new U(r,r),new U(i,n))}}function IL(e,t,i){if(u(t)){if(!u(t.childNode1)&&!u(t.childNode2)){if(u(t.imageIndex))return;let n=t.topRight.x-t.bottomLeft.x,r=t.topRight.y-t.bottomLeft.y,o=n-i.width,a=r-i.height;if(o<0||a<0)return;if(0===o&&0===a)return t;if(o>a){t.childNode1=new np(new U(t.bottomLeft.x,t.bottomLeft.y),new U(t.bottomLeft.x+i.width,t.topRight.y));let n=t.bottomLeft.x+i.width+e._borderWidthInPixels;n<t.topRight.x&&(t.childNode2=new np(new U(n,t.bottomLeft.y),new U(t.topRight.x,t.topRight.y)))}else{t.childNode1=new np(new U(t.bottomLeft.x,t.bottomLeft.y),new U(t.topRight.x,t.bottomLeft.y+i.height));let n=t.bottomLeft.y+i.height+e._borderWidthInPixels;n<t.topRight.y&&(t.childNode2=new np(new U(t.bottomLeft.x,n),new U(t.topRight.x,t.topRight.y)))}return IL(e,t.childNode1,i)}return IL(e,t.childNode1,i)||IL(e,t.childNode2,i)}}function loe(e,t,i){let n=IL(e,e._root,t);if(u(n)){n.imageIndex=i;let r=e._texture.width,o=e._texture.height,a=n.topRight.x-n.bottomLeft.x,s=n.topRight.y-n.bottomLeft.y,l=n.bottomLeft.x/r,u=n.bottomLeft.y/o,c=a/r,h=s/o;e._textureCoordinates[i]=new qe(l,u,c,h),e._texture.copyFrom({source:t,xOffset:n.bottomLeft.x,yOffset:n.bottomLeft.y})}else P2e(e,t),loe(e,t,i);e._guid=jn()}function uoe(e,t){if(!u(e)||e.isDestroyed())return-1;let i=e.numberOfImages;return loe(e,t,i),i}Object.defineProperties(ng.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return u(this._texture)||(this._texture=new Ot({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),ng.prototype.getImageIndex=function(e){return this._indexHash[e]},ng.prototype.addImageSync=function(e,t){let i=this._indexHash[e];return u(i)||(i=uoe(this,t),this._idHash[e]=Promise.resolve(i),this._indexHash[e]=i),i},ng.prototype.addImage=function(e,t){let i=this._idHash[e];if(u(i))return i;"function"==typeof t?t=t(e):("string"==typeof t||t instanceof ve)&&(t=ve.createIfNeeded(t).fetchImage());let n=this;return i=Promise.resolve(t).then((function(t){let i=uoe(n,t);return n._indexHash[e]=i,i})),this._idHash[e]=i,i},ng.prototype.addSubRegion=function(e,t){let i=this._idHash[e];if(!u(i))throw new ue(`image with id "${e}" not found in the atlas.`);let n=this;return Promise.resolve(i).then((function(i){if(-1===i)return-1;let r=n._texture.width,o=n._texture.height,a=n._textureCoordinates[i],s=a.x+t.x/r,l=a.y+t.y/o,u=t.width/r,c=t.height/o,h=n._textureCoordinates.push(new qe(s,l,u,c))-1;return n._indexHash[e]=h,n._guid=jn(),h}))},ng.prototype.isDestroyed=function(){return!1},ng.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),le(this)};var F0=ng,O2e=mo.SHOW_INDEX,sw=mo.POSITION_INDEX,foe=mo.PIXEL_OFFSET_INDEX,doe=mo.EYE_OFFSET_INDEX,R2e=mo.HORIZONTAL_ORIGIN_INDEX,M2e=mo.VERTICAL_ORIGIN_INDEX,L2e=mo.SCALE_INDEX,rw=mo.IMAGE_INDEX_INDEX,hoe=mo.COLOR_INDEX,N2e=mo.ROTATION_INDEX,F2e=mo.ALIGNED_AXIS_INDEX,moe=mo.SCALE_BY_DISTANCE_INDEX,poe=mo.TRANSLUCENCY_BY_DISTANCE_INDEX,_oe=mo.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,goe=mo.DISTANCE_DISPLAY_CONDITION,B2e=mo.DISABLE_DEPTH_DISTANCE,k2e=mo.TEXTURE_COORDINATE_BOUNDS,yoe=mo.SDF_INDEX,L6=mo.NUMBER_OF_PROPERTIES,po,V2e={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10,sdf:11},U2e={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11,sdf:12},D6;function Zu(e){e=y(e,y.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(L6),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new se,this._baseVolumeWC=new se,this._baseVolume2D=new se,this._boundingVolume=new se,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=y(e.show,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=L.clone(L.IDENTITY),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.debugShowTextureAtlas=y(e.debugShowTextureAtlas,!1),this.blendOption=y(e.blendOption,Ao.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=te.SCENE3D,this._buffersUsage=[Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW],this._highlightColor=z.clone(z.WHITE);let t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor}};let i=this._scene;u(i)&&u(i.terrainProviderChanged)&&(this._removeCallbackFunc=i.terrainProviderChanged.addEventListener((function(){let e=this._billboards,t=e.length;for(let i=0;i<t;++i)u(e[i])&&e[i]._updateClamping()}),this))}function xoe(e){let t=e.length;for(let i=0;i<t;++i)e[i]&&e[i]._destroy()}function N6(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;let t=[],i=e._billboards,n=i.length;for(let e=0,r=0;e<n;++e){let n=i[e];u(n)&&(n._index=r++,t.push(n))}e._billboards=t}}function z2e(e){let t=e.cache.billboardCollection_indexBufferBatched;if(u(t))return t;let i=new Uint16Array(98298);for(let e=0,t=0;e<98298;e+=6,t+=4)i[e]=t,i[e+1]=t+1,i[e+2]=t+2,i[e+3]=t+0,i[e+4]=t+2,i[e+5]=t+3;return t=ut.createIndexBuffer({context:e,typedArray:i,usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=t,t}function H2e(e){let t=e.cache.billboardCollection_indexBufferInstanced;return u(t)||(t=ut.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t),t}function G2e(e){let t=e.cache.billboardCollection_vertexBufferInstanced;return u(t)||(t=ut.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:Be.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t),t}function W2e(e,t,i,n,r,o){let a=[{index:po.positionHighAndScale,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[sw]},{index:po.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[sw]},{index:po.compressedAttribute0,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[foe]},{index:po.compressedAttribute1,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[poe]},{index:po.compressedAttribute2,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[hoe]},{index:po.eyeOffset,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[doe]},{index:po.scaleByDistance,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[moe]},{index:po.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[_oe]},{index:po.compressedAttribute3,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[goe]},{index:po.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[k2e]}];return n&&a.push({index:po.direction,componentsPerAttribute:2,componentDatatype:X.FLOAT,vertexBuffer:G2e(e)}),u(r)&&a.push({index:po.a_batchId,componentsPerAttribute:1,componentDatatype:X.FLOAT,bufferUsage:Be.STATIC_DRAW}),o&&a.push({index:po.sdf,componentsPerAttribute:2,componentDatatype:X.FLOAT,usage:i[yoe]}),new tg(e,a,n?t:4*t,n)}Object.defineProperties(Zu.prototype,{length:{get:function(){return N6(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}}),Zu.prototype.add=function(e){let t=new mo(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t},Zu.prototype.remove=function(e){return!!this.contains(e)&&(this._billboards[e._index]=void 0,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},Zu.prototype.removeAll=function(){xoe(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0},Zu.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]},Zu.prototype.contains=function(e){return u(e)&&e._billboardCollection===this},Zu.prototype.get=function(e){return N6(this),this._billboards[e]},Zu.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,i=this._propertiesChanged;for(let n=0;n<L6;++n){let r=0===i[n]?Be.STATIC_DRAW:Be.STREAM_DRAW;t=t||e[n]!==r,e[n]=r}return t};var I6=new Wn;function boe(e,t,i,n,r){let o,a=n[po.positionHighAndScale],s=n[po.positionLowAndRotation],l=r._getActualPosition();e._mode===te.SCENE3D&&(se.expand(e._baseVolume,l,e._baseVolume),e._boundingVolumeDirty=!0),Wn.fromCartesian(l,I6);let u=r.scale,c=r.rotation;0!==c&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,u);let h=I6.high,d=I6.low;e._instanced?(o=r._index,a(o,h.x,h.y,h.z,u),s(o,d.x,d.y,d.z,c)):(o=4*r._index,a(o+0,h.x,h.y,h.z,u),a(o+1,h.x,h.y,h.z,u),a(o+2,h.x,h.y,h.z,u),a(o+3,h.x,h.y,h.z,u),s(o+0,d.x,d.y,d.z,c),s(o+1,d.x,d.y,d.z,c),s(o+2,d.x,d.y,d.z,c),s(o+3,d.x,d.y,d.z,c))}var Ku=new U,Xu=32768,nA=65536,P6=4096,Rh=256,j2e=128,q2e=32,Y2e=8,Toe=4,X2e=1/256,Aoe=0,Coe=2,Eoe=3,Soe=1;function woe(e,t,i,n,r){let o,a=n[po.compressedAttribute0],s=r.pixelOffset,l=s.x,u=s.y,c=r._translate,h=c.x,d=c.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(l+h),Math.abs(-u+d));let p=r.horizontalOrigin,f=r._verticalOrigin,m=r.show&&r.clusterShow;0===r.color.alpha&&(m=!1),f===On.BASELINE&&(f=On.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&p===yi.CENTER,e._allVerticalCenter=e._allVerticalCenter&&f===On.CENTER;let _=0,g=0,y=0,v=0,b=r._imageIndex;if(-1!==b){let e=i[b];_=e.x,g=e.y,y=e.width,v=e.height}let A=_+y,T=g+v,E=Math.floor(P.clamp(l,-Xu,Xu)+Xu)*j2e;E+=(p+1)*q2e,E+=(f+1)*Y2e,E+=(m?1:0)*Toe;let C=Math.floor(P.clamp(u,-Xu,Xu)+Xu)*Rh,x=Math.floor(P.clamp(h,-Xu,Xu)+Xu)*Rh,S=(P.clamp(d,-Xu,Xu)+Xu)*X2e,w=Math.floor(S);C+=w,x+=Math.floor((S-w)*Rh),Ku.x=_,Ku.y=g;let I=Gn.compressTextureCoordinates(Ku);Ku.x=A;let D=Gn.compressTextureCoordinates(Ku);Ku.y=T;let O=Gn.compressTextureCoordinates(Ku);Ku.x=_;let L=Gn.compressTextureCoordinates(Ku);e._instanced?(o=r._index,a(o,E,C,x,I)):(o=4*r._index,a(o+0,E+Aoe,C,x,I),a(o+1,E+Coe,C,x,D),a(o+2,E+Eoe,C,x,O),a(o+3,E+Soe,C,x,L))}function voe(e,t,i,n,r){let o,a=n[po.compressedAttribute1],s=r.alignedAxis;h.equals(s,h.ZERO)||(e._shaderAlignedAxis=!0);let l=0,c=1,d=1,p=1,f=r.translucencyByDistance;u(f)&&(l=f.near,c=f.nearValue,d=f.far,p=f.farValue,(1!==c||1!==p)&&(e._shaderTranslucencyByDistance=!0));let m=0,_=r._imageIndex;-1!==_&&(m=i[_].width);let g=e._textureAtlas.texture.width,v=Math.round(y(r.width,g*m));e._maxSize=Math.max(e._maxSize,v);let b=P.clamp(v,0,nA),A=0;Math.abs(h.magnitudeSquared(s)-1)<P.EPSILON6&&(A=Gn.octEncodeFloat(s)),c=P.clamp(c,0,1),c=1===c?255:255*c|0,b=b*Rh+c,p=P.clamp(p,0,1),p=1===p?255:255*p|0,A=A*Rh+p,e._instanced?(o=r._index,a(o,b,A,l,d)):(o=4*r._index,a(o+0,b,A,l,d),a(o+1,b,A,l,d),a(o+2,b,A,l,d),a(o+3,b,A,l,d))}function R6(e,t,i,n,r){let o,a=n[po.compressedAttribute2],s=r.color,l=u(e._batchTable)?z.WHITE:r.getPickId(t.context).color,c=r.sizeInMeters?1:0,d=Math.abs(h.magnitudeSquared(r.alignedAxis)-1)<P.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&1===c;let p=0,f=r._imageIndex;-1!==f&&(p=i[f].height);let m=e._textureAtlas.texture.dimensions,_=Math.round(y(r.height,m.y*p));e._maxSize=Math.max(e._maxSize,_);let g=y(r._labelHorizontalOrigin,-2);g+=2;let v=_*Toe+g,b=z.floatToByte(s.red),A=z.floatToByte(s.green),T=z.floatToByte(s.blue),E=b*nA+A*Rh+T;b=z.floatToByte(l.red),A=z.floatToByte(l.green),T=z.floatToByte(l.blue);let C=b*nA+A*Rh+T,x=z.floatToByte(s.alpha)*nA+z.floatToByte(l.alpha)*Rh;x+=2*c+d,e._instanced?(o=r._index,a(o,E,C,x,v)):(o=4*r._index,a(o+0,E,C,x,v),a(o+1,E,C,x,v),a(o+2,E,C,x,v),a(o+3,E,C,x,v))}function M6(e,t,i,n,r){let o,a=n[po.eyeOffset],s=r.eyeOffset,l=s.z;if(r._heightReference!==We.NONE&&(l*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(s.x),Math.abs(s.y),Math.abs(l)),e._instanced){let e=0,t=0,n=r._imageIndex;if(-1!==n){let r=i[n];e=r.width,t=r.height}Ku.x=e,Ku.y=t;let u=Gn.compressTextureCoordinates(Ku);o=r._index,a(o,s.x,s.y,l,u)}else o=4*r._index,a(o+0,s.x,s.y,l,0),a(o+1,s.x,s.y,l,0),a(o+2,s.x,s.y,l,0),a(o+3,s.x,s.y,l,0)}function Doe(e,t,i,n,r){let o,a=n[po.scaleByDistance],s=0,l=1,c=1,h=1,d=r.scaleByDistance;u(d)&&(s=d.near,l=d.nearValue,c=d.far,h=d.farValue,(1!==l||1!==h)&&(e._shaderScaleByDistance=!0)),e._instanced?(o=r._index,a(o,s,l,c,h)):(o=4*r._index,a(o+0,s,l,c,h),a(o+1,s,l,c,h),a(o+2,s,l,c,h),a(o+3,s,l,c,h))}function Ioe(e,t,i,n,r){let o,a=n[po.pixelOffsetScaleByDistance],s=0,l=1,c=1,h=1,d=r.pixelOffsetScaleByDistance;u(d)&&(s=d.near,l=d.nearValue,c=d.far,h=d.farValue,(1!==l||1!==h)&&(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?(o=r._index,a(o,s,l,c,h)):(o=4*r._index,a(o+0,s,l,c,h),a(o+1,s,l,c,h),a(o+2,s,l,c,h),a(o+3,s,l,c,h))}function Poe(e,t,i,n,r){let o,a=n[po.compressedAttribute3],s=0,l=Number.MAX_VALUE,c=r.distanceDisplayCondition;u(c)&&(s=c.near,l=c.far,s*=s,l*=l,e._shaderDistanceDisplayCondition=!0);let h,d,p=r.disableDepthTestDistance,f=r.heightReference===We.CLAMP_TO_GROUND&&t.context.depthTexture;if(u(p)||(p=f?5e3:0),p*=p,(f||p>0)&&(e._shaderDisableDepthDistance=!0,p===Number.POSITIVE_INFINITY&&(p=-1)),u(r._labelDimensions))d=r._labelDimensions.x,h=r._labelDimensions.y;else{let t=0,n=0,o=r._imageIndex;if(-1!==o){let e=i[o];t=e.height,n=e.width}h=Math.round(y(r.height,e._textureAtlas.texture.dimensions.y*t));let a=e._textureAtlas.texture.width;d=Math.round(y(r.width,a*n))}let m=Math.floor(P.clamp(d,0,P6)),_=Math.floor(P.clamp(h,0,P6)),g=m*P6+_;e._instanced?(o=r._index,a(o,s,l,p,g)):(o=4*r._index,a(o+0,s,l,p,g),a(o+1,s,l,p,g),a(o+2,s,l,p,g),a(o+3,s,l,p,g))}function Ooe(e,t,i,n,r){if(r.heightReference===We.CLAMP_TO_GROUND){let i=e._scene,n=t.context,r=t.globeTranslucencyState.translucent,o=u(i.globe)&&i.globe.depthTestAgainstTerrain;e._shaderClampToGround=n.depthTexture&&!r&&o}let o,a=n[po.textureCoordinateBoundsOrLabelTranslate];if(zt.maximumVertexTextureImageUnits>0){let t=0,i=0;return u(r._labelTranslate)&&(t=r._labelTranslate.x,i=r._labelTranslate.y),void(e._instanced?(o=r._index,a(o,t,i,0,0)):(o=4*r._index,a(o+0,t,i,0,0),a(o+1,t,i,0,0),a(o+2,t,i,0,0),a(o+3,t,i,0,0)))}let s=0,l=0,c=0,h=0,d=r._imageIndex;if(-1!==d){let e=i[d];s=e.x,l=e.y,c=e.width,h=e.height}let p=s+c,f=l+h;e._instanced?(o=r._index,a(o,s,l,p,f)):(o=4*r._index,a(o+0,s,l,p,f),a(o+1,s,l,p,f),a(o+2,s,l,p,f),a(o+3,s,l,p,f))}function K2e(e,t,i,n,r){if(!u(e._batchTable))return;let o,a=n[po.a_batchId],s=r._batchIndex;e._instanced?(o=r._index,a(o,s)):(o=4*r._index,a(o+0,s),a(o+1,s),a(o+2,s),a(o+3,s))}function Roe(e,t,i,n,r){if(!e._sdf)return;let o,a=n[po.sdf],s=r.outlineColor,l=r.outlineWidth,u=z.floatToByte(s.red),c=z.floatToByte(s.green),h=z.floatToByte(s.blue),d=u*nA+c*Rh+h,p=l/Ns.RADIUS,f=z.floatToByte(s.alpha)*nA+z.floatToByte(p)*Rh;e._instanced?(o=r._index,a(o,d,f)):(o=4*r._index,a(o+0,d+Aoe,f),a(o+1,d+Coe,f),a(o+2,d+Eoe,f),a(o+3,d+Soe,f))}function Z2e(e,t,i,n,r){boe(e,t,i,n,r),woe(e,t,i,n,r),voe(e,t,i,n,r),R6(e,t,i,n,r),M6(e,t,i,n,r),Doe(e,t,i,n,r),Ioe(e,t,i,n,r),Poe(e,t,i,n,r),Ooe(e,t,i,n,r),K2e(e,t,i,n,r),Roe(e,t,i,n,r)}function O6(e,t,i,n,r,o){let a;n.mode===te.SCENE3D?(a=e._baseVolume,e._boundingVolumeDirty=!0):a=e._baseVolume2D;let s=[];for(let e=0;e<i;++e){let i=t[e],l=i.position,c=mo._computeActualPosition(i,l,n,r);u(c)&&(i._setActualPosition(c),o?s.push(c):se.expand(a,c,a))}o&&se.fromPoints(s,a)}function $2e(e,t){let i=t.mode,n=e._billboards,r=e._billboardsToUpdate,o=e._modelMatrix;e._createVertexArray||e._mode!==i||i!==te.SCENE3D&&!L.equals(o,e.modelMatrix)?(e._mode=i,L.clone(e.modelMatrix,o),e._createVertexArray=!0,(i===te.SCENE3D||i===te.SCENE2D||i===te.COLUMBUS_VIEW)&&O6(e,n,n.length,t,o,!0)):i===te.MORPHING?O6(e,n,n.length,t,o,!0):(i===te.SCENE2D||i===te.COLUMBUS_VIEW)&&O6(e,r,e._billboardsToUpdateIndex,t,o,!1)}function Q2e(e,t,i){let n=1;(!e._allSizedInMeters||0!==e._maxPixelOffset)&&(n=t.camera.getPixelSize(i,t.context.drawingBufferWidth,t.context.drawingBufferHeight));let r=n*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(r*=.5);let o=n*e._maxPixelOffset+e._maxEyeOffset;i.radius+=r+o}function J2e(e,t){let i=t.createViewportQuadCommand("uniform sampler2D billboard_texture; \nin vec2 v_textureCoordinates; \nvoid main() \n{ \n    out_FragColor = texture(billboard_texture, v_textureCoordinates); \n} \n",{uniformMap:{billboard_texture:function(){return e._textureAtlas.texture}}});return i.pass=Ee.OVERLAY,i}var eFe=[];Zu.prototype.update=function(e){if(N6(this),!this.show)return;let t=this._billboards,i=t.length,n=e.context;this._instanced=n.instancedArrays,po=this._instanced?U2e:V2e,D6=this._instanced?H2e:z2e;let r=this._textureAtlas;if(!u(r)){r=this._textureAtlas=new F0({context:n});for(let e=0;e<i;++e)t[e]._loadImage()}let o=r.textureCoordinates;if(0===o.length)return;$2e(this,e),t=this._billboards,i=t.length;let a=this._billboardsToUpdate,s=this._billboardsToUpdateIndex,l=this._propertiesChanged,c=r.guid,h=this._createVertexArray||this._textureAtlasGUID!==c;this._textureAtlasGUID=c;let d,p=e.passes,f=p.pick;if(h||!f&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let e=0;e<L6;++e)l[e]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=W2e(n,i,this._buffersUsage,this._instanced,this._batchTable,this._sdf),d=this._vaf.writers;for(let t=0;t<i;++t){let i=this._billboards[t];i._dirty=!1,Z2e(this,e,o,d,i)}this._vaf.commit(D6(n))}this._billboardsToUpdateIndex=0}else if(s>0){let t=eFe;t.length=0,(l[sw]||l[N2e]||l[L2e])&&t.push(boe),(l[rw]||l[foe]||l[R2e]||l[M2e]||l[O2e])&&(t.push(woe),this._instanced&&t.push(M6)),(l[rw]||l[F2e]||l[poe])&&(t.push(voe),t.push(R6)),(l[rw]||l[hoe])&&t.push(R6),l[doe]&&t.push(M6),l[moe]&&t.push(Doe),l[_oe]&&t.push(Ioe),(l[goe]||l[B2e]||l[rw]||l[sw])&&t.push(Poe),(l[rw]||l[sw])&&t.push(Ooe),l[yoe]&&t.push(Roe);let r=t.length;if(d=this._vaf.writers,s/i>.1){for(let i=0;i<s;++i){let n=a[i];n._dirty=!1;for(let i=0;i<r;++i)t[i](this,e,o,d,n)}this._vaf.commit(D6(n))}else{for(let i=0;i<s;++i){let n=a[i];n._dirty=!1;for(let i=0;i<r;++i)t[i](this,e,o,d,n);this._instanced?this._vaf.subCommit(n._index,1):this._vaf.subCommit(4*n._index,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(s>1.5*i&&(a.length=i),!u(this._vaf)||!u(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,se.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let m,_=L.IDENTITY;e.mode===te.SCENE3D?(_=this.modelMatrix,m=se.clone(this._baseVolumeWC,this._boundingVolume)):m=se.clone(this._baseVolume2D,this._boundingVolume),Q2e(this,e,m);let g=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,g){this._blendOption===Ao.OPAQUE||this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ue.fromCache({depthTest:{enabled:!0,func:ee.LESS},depthMask:!0}):this._rsOpaque=void 0;let e=this._blendOption===Ao.TRANSLUCENT;this._blendOption===Ao.TRANSLUCENT||this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ue.fromCache({depthTest:{enabled:!0,func:e?ee.LEQUAL:ee.LESS},depthMask:e,blending:ln.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance;let y,v,b,A,T,E=zt.maximumVertexTextureImageUnits>0;if(g||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround||this._sdf!==this._compiledSDF){y=DL,v=vL,T=[],u(this._batchTable)&&(T.push("VECTOR_TILE"),y=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(y),v=this._batchTable.getFragmentShaderCallback(!1,void 0)(v)),b=new He({defines:T,sources:[y]}),this._instanced&&b.defines.push("INSTANCED"),this._shaderRotation&&b.defines.push("ROTATION"),this._shaderAlignedAxis&&b.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&b.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&b.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&b.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&b.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&b.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(E?b.defines.push("VERTEX_DEPTH_CHECK"):b.defines.push("FRAGMENT_DEPTH_CHECK"));let e=1-Ns.CUTOFF;this._sdf&&b.defines.push("SDF");let t=u(this._batchTable)?"VECTOR_TILE":"";this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT&&(A=new He({defines:["OPAQUE",t],sources:[v]}),this._shaderClampToGround&&(E?A.defines.push("VERTEX_DEPTH_CHECK"):A.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(A.defines.push("SDF"),A.defines.push(`SDF_EDGE ${e}`)),this._sp=Kt.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:b,fragmentShaderSource:A,attributeLocations:po}),A=new He({defines:["TRANSLUCENT",t],sources:[v]}),this._shaderClampToGround&&(E?A.defines.push("VERTEX_DEPTH_CHECK"):A.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(A.defines.push("SDF"),A.defines.push(`SDF_EDGE ${e}`)),this._spTranslucent=Kt.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:b,fragmentShaderSource:A,attributeLocations:po})),this._blendOption===Ao.OPAQUE&&(A=new He({defines:[t],sources:[v]}),this._shaderClampToGround&&(E?A.defines.push("VERTEX_DEPTH_CHECK"):A.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(A.defines.push("SDF"),A.defines.push(`SDF_EDGE ${e}`)),this._sp=Kt.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:b,fragmentShaderSource:A,attributeLocations:po})),this._blendOption===Ao.TRANSLUCENT&&(A=new He({defines:[t],sources:[v]}),this._shaderClampToGround&&(E?A.defines.push("VERTEX_DEPTH_CHECK"):A.defines.push("FRAGMENT_DEPTH_CHECK")),this._sdf&&(A.defines.push("SDF"),A.defines.push(`SDF_EDGE ${e}`)),this._spTranslucent=Kt.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:b,fragmentShaderSource:A,attributeLocations:po})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround,this._compiledSDF=this._sdf}let C=e.commandList;if(p.render||p.pick){let t,n=this._colorCommands,r=this._blendOption===Ao.OPAQUE,o=this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT,a=this._vaf.va,s=a.length,l=this._uniforms;u(this._batchTable)?(l=this._batchTable.getUniformMapCallback()(l),t=this._batchTable.getPickId()):t="v_pickColor",n.length=s;let c=o?2*s:s;for(let e=0;e<c;++e){let s=n[e];u(s)||(s=n[e]=new et);let c=r||o&&e%2==0;s.pass=c||!o?Ee.OPAQUE:Ee.TRANSLUCENT,s.owner=this;let h=o?Math.floor(e/2):e;s.boundingVolume=m,s.modelMatrix=_,s.count=a[h].indicesCount,s.shaderProgram=c?this._sp:this._spTranslucent,s.uniformMap=l,s.vertexArray=a[h].va,s.renderState=c?this._rsOpaque:this._rsTranslucent,s.debugShowBoundingVolume=this.debugShowBoundingVolume,s.pickId=t,this._instanced&&(s.count=6,s.instanceCount=i),C.push(s)}this.debugShowTextureAtlas&&(u(this.debugCommand)||(this.debugCommand=J2e(this,e.context)),C.push(this.debugCommand))}},Zu.prototype.isDestroyed=function(){return!1},Zu.prototype.destroy=function(){return u(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),xoe(this._billboards),le(this)};var $u=Zu,tFe={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",AERIAL_WITH_LABELS_ON_DEMAND:"AerialWithLabelsOnDemand",ROAD:"Road",ROAD_ON_DEMAND:"RoadOnDemand",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"},aw=Object.freeze(tFe),PL;function cw(e){}cw.prototype.isReady=function(){return!0},cw.prototype.shouldDiscardImage=function(e){return cw.EMPTY_IMAGE===e},Object.defineProperties(cw,{EMPTY_IMAGE:{get:function(){return u(PL)||((PL=new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="),PL}}});var lw=cw;function Moe(e){this.tileWidth=void 0,this.tileHeight=void 0,this.maximumLevel=void 0,this.imageUrlSubdomains=void 0,this.imageUrlTemplate=void 0,this.attributionList=void 0}function nFe(e,t){if(1!==e.resourceSets.length)throw new ue("metadata does not specify one resource in resourceSets");let i=e.resourceSets[0].resources[0];t.tileWidth=i.imageWidth,t.tileHeight=i.imageHeight,t.maximumLevel=i.zoomMax-1,t.imageUrlSubdomains=i.imageUrlSubdomains,t.imageUrlTemplate=i.imageUrl,t.attributionList=i.imageryProviders}function iFe(e,t,i){let n=`An error occurred while accessing ${e.url}`;throw u(t)&&u(t.message)&&(n+=`: ${t.message}`),bo.reportError(void 0,i,u(i)?i._errorEvent:void 0,n,void 0,void 0,void 0,t),new ue(n)}async function oFe(e,t,i){let n=e.url,r=ss._metadataCache[n];u(r)||(r=e.fetchJsonp("jsonp"),ss._metadataCache[n]=r);try{return nFe(await r,t)}catch(t){iFe(e,t,i)}}function ss(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=1,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._mapStyle=y(e.mapStyle,aw.AERIAL),this._mapLayer=e.mapLayer,this._culture=y(e.culture,""),this._key=e.key,this._tileDiscardPolicy=e.tileDiscardPolicy,u(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new lw),this._proxy=e.proxy,this._credit=new xt(`<a href="https://www.microsoft.com/en-us/maps/product/enduserterms"><img src="${ss.logoUrl}" title="Bing Imagery"/></a>`),this._tilingScheme=new zr({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._attributionList=void 0,this._errorEvent=new pe}Moe.prototype.build=function(e){e._tileWidth=this.tileWidth,e._tileHeight=this.tileHeight,e._maximumLevel=this.maximumLevel,e._imageUrlSubdomains=this.imageUrlSubdomains,e._imageUrlTemplate=this.imageUrlTemplate;let t=e._attributionList=this.attributionList;t||(t=[]),e._attributionList=t;for(let e=0,i=t.length;e<i;++e){let i=t[e];if(i.credit instanceof xt)break;i.credit=new xt(i.attribution);let n=i.coverageAreas;for(let e=0,t=i.coverageAreas.length;e<t;++e){let t=n[e],i=t.bbox;t.bbox=new ce(P.toRadians(i[1]),P.toRadians(i[0]),P.toRadians(i[3]),P.toRadians(i[2]))}}},Object.defineProperties(ss.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},mapLayer:{get:function(){return this._mapLayer}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return u(this.mapLayer)}}}),ss.fromUrl=async function(e,t){let i=(t=y(t,y.EMPTY_OBJECT)).tileProtocol;u(i)?i.length>0&&":"===i[i.length-1]&&(i=i.substr(0,i.length-1)):i="http:"===document.location.protocol?"http":"https";let n=y(t.mapStyle,aw.AERIAL),r=ve.createIfNeeded(e);r.appendForwardSlash();let o={incl:"ImageryProviders",key:t.key,uriScheme:i};u(t.mapLayer)&&(o.mapLayer=t.mapLayer);let a=r.getDerivedResource({url:`REST/v1/Imagery/Metadata/${n}`,queryParameters:o}),s=new ss(t);s._resource=r;let l=new Moe(t);return await oFe(a,l),l.build(s),s};var rFe=new ce;function sFe(e,t,i,n,r){let o=e._imageUrlTemplate,a=e._imageUrlSubdomains,s=(t+i+n)%a.length;return e._resource.getDerivedResource({url:o,request:r,templateValues:{quadkey:ss.tileXYToQuadKey(t,i,n),subdomain:a[s],culture:e._culture},queryParameters:{n:"z"}})}ss.prototype.getTileCredits=function(e,t,i){let n=this._tilingScheme.tileXYToRectangle(e,t,i,rFe);return cFe(this._attributionList,i,n)},ss.prototype.requestImage=function(e,t,i,n){let r=el.loadImage(this,sFe(this,e,t,i,n));if(u(r))return r.catch((function(e){return u(e.blob)&&0===e.blob.size?lw.EMPTY_IMAGE:Promise.reject(e)}))},ss.prototype.pickFeatures=function(e,t,i,n,r){},ss.tileXYToQuadKey=function(e,t,i){let n="";for(let r=i;r>=0;--r){let i=1<<r,o=0;e&i&&(o|=1),t&i&&(o|=2),n+=o}return n},ss.quadKeyToTileXY=function(e){let t=0,i=0,n=e.length-1;for(let r=n;r>=0;--r){let o=1<<r,a=+e[n-r];1&a&&(t|=o),2&a&&(i|=o)}return{x:t,y:i,level:n}},ss._logoUrl=void 0,Object.defineProperties(ss,{logoUrl:{get:function(){return u(ss._logoUrl)||(ss._logoUrl=$t("Assets/Images/bing_maps_credit.png")),ss._logoUrl},set:function(e){ss._logoUrl=e}}});var aFe=new ce;function cFe(e,t,i){++t;let n=[];for(let r=0,o=e.length;r<o;++r){let o=e[r],a=o.coverageAreas,s=!1;for(let e=0,n=o.coverageAreas.length;!s&&e<n;++e){let n=a[e];if(t>=n.zoomMin&&t<=n.zoomMax){let e=ce.intersection(i,n.bbox,aFe);u(e)&&(s=!0)}}s&&n.push(o.credit)}return n}ss._metadataCache={};var OL=ss,Zf={parseAllBoundingVolumeSemantics:function(e){return{tile:{boundingVolume:Zf.parseBoundingVolumeSemantic("TILE",e),minimumHeight:Zf._parseMinimumHeight("TILE",e),maximumHeight:Zf._parseMaximumHeight("TILE",e)},content:{boundingVolume:Zf.parseBoundingVolumeSemantic("CONTENT",e),minimumHeight:Zf._parseMinimumHeight("CONTENT",e),maximumHeight:Zf._parseMaximumHeight("CONTENT",e)}}},parseBoundingVolumeSemantic:function(e,t){let i=`${e}_BOUNDING_BOX`,n=t.getPropertyBySemantic(i);if(u(n))return{box:n};let r=`${e}_BOUNDING_REGION`,o=t.getPropertyBySemantic(r);if(u(o))return{region:o};let a=`${e}_BOUNDING_SPHERE`,s=t.getPropertyBySemantic(a);return u(s)?{sphere:s}:void 0},_parseMinimumHeight:function(e,t){let i=`${e}_MINIMUM_HEIGHT`;return t.getPropertyBySemantic(i)},_parseMaximumHeight:function(e,t){let i=`${e}_MAXIMUM_HEIGHT`;return t.getPropertyBySemantic(i)}},iA=Zf,lFe=new h(1,1,1);function F6(e){e=y(e,lFe),this._dimensions=h.clone(e)}Object.defineProperties(F6.prototype,{dimensions:{get:function(){return this._dimensions},set:function(e){h.clone(e,this._dimensions)}}});var uFe=new h;F6.prototype.emit=function(e){let t=this._dimensions,i=h.multiplyByScalar(t,.5,uFe),n=P.randomBetween(-i.x,i.x),r=P.randomBetween(-i.y,i.y),o=P.randomBetween(-i.z,i.z);e.position=h.fromElements(n,r,o,e.position),e.velocity=h.normalize(e.position,e.velocity)};var Loe=F6,RL="in vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\n\nfloat vdcRadicalInverse(int i)\n{\n    float r;\n    float base = 2.0;\n    float value = 0.0;\n    float invBase = 1.0 / base;\n    float invBi = invBase;\n    for (int x = 0; x < 100; x++)\n    {\n        if (i <= 0)\n        {\n            break;\n        }\n        r = mod(float(i), base);\n        value += r * invBi;\n        invBi *= invBase;\n        i = int(float(i) * invBase);\n    }\n    return value;\n}\n\nvec2 hammersley2D(int i, int N)\n{\n    return vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\n\nvec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)\n{\n    float a = roughness * roughness;\n    float phi = 2.0 * M_PI * xi.x;\n    float cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\n    vec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n    vec3 tangentX = normalize(cross(upVector, N));\n    vec3 tangentY = cross(N, tangentX);\n    return tangentX * H.x + tangentY * H.y + N * H.z;\n}\n\nfloat G1_Smith(float NdotV, float k)\n{\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\nfloat G_Smith(float roughness, float NdotV, float NdotL)\n{\n    float k = roughness * roughness / 2.0;\n    return G1_Smith(NdotV, k) * G1_Smith(NdotL, k);\n}\n\nvec2 integrateBrdf(float roughness, float NdotV)\n{\n    vec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\n    float A = 0.0;\n    float B = 0.0;\n    const int NumSamples = 1024;\n    for (int i = 0; i < NumSamples; i++)\n    {\n        vec2 xi = hammersley2D(i, NumSamples);\n        vec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));\n        vec3 L = 2.0 * dot(V, H) * H - V;\n        float NdotL = clamp(L.z, 0.0, 1.0);\n        float NdotH = clamp(H.z, 0.0, 1.0);\n        float VdotH = clamp(dot(V, H), 0.0, 1.0);\n        if (NdotL > 0.0)\n        {\n            float G = G_Smith(roughness, NdotV, NdotL);\n            float G_Vis = G * VdotH / (NdotH * NdotV);\n            float Fc = pow(1.0 - VdotH, 5.0);\n            A += (1.0 - Fc) * G_Vis;\n            B += Fc * G_Vis;\n        }\n    }\n    return vec2(A, B) / float(NumSamples);\n}\n\nvoid main()\n{\n    out_FragColor = vec4(integrateBrdf(v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n";function uw(){this._colorTexture=void 0,this._drawCommand=void 0}function fFe(e,t,i){let n=t.createViewportQuadCommand(RL,{framebuffer:i,renderState:Ue.fromCache({viewport:new qe(0,0,256,256)})});e._drawCommand=n}Object.defineProperties(uw.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),uw.prototype.update=function(e){if(!u(this._colorTexture)){let t=e.context,i=new Ot({context:t,width:256,height:256,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,sampler:un.NEAREST});this._colorTexture=i;let n=new oa({context:t,colorTextures:[i],destroyAttachments:!1});fFe(this,t,n),this._drawCommand.execute(t),n.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},uw.prototype.isDestroyed=function(){return!1},uw.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),le(this)};var ML=uw;function ig(){}Object.defineProperties(ig.prototype,{cacheKey:{get:function(){de.throwInstantiationError()}}}),ig.prototype.load=function(){de.throwInstantiationError()},ig.prototype.unload=function(){},ig.prototype.process=function(e){return!1},ig.prototype.getError=function(e,t){u(t)&&u(t.message)&&(e+=`\n${t.message}`);let i=new ue(e);return u(t)&&(i.stack=`Original stack:\n${t.stack}\nHandler stack:\n${i.stack}`),i},ig.prototype.isDestroyed=function(){return!1},ig.prototype.destroy=function(){return this.unload(),le(this)};var io=ig,dFe={UNLOADED:0,LOADING:1,LOADED:2,PROCESSING:3,READY:4,FAILED:5},St=Object.freeze(dFe);function ip(e){let t=(e=y(e,y.EMPTY_OBJECT)).typedArray,i=e.resource,n=e.cacheKey;this._typedArray=t,this._resource=i,this._cacheKey=n,this._state=St.UNLOADED,this._promise=void 0}async function hFe(e){let t=e._resource;e._state=St.LOADING;try{let i=await ip._fetchArrayBuffer(t);return e.isDestroyed()?void 0:(e._typedArray=new Uint8Array(i),e._state=St.READY,e)}catch(i){if(e.isDestroyed())return;e._state=St.FAILED;let n=`Failed to load external buffer: ${t.url}`;throw e.getError(n,i)}}u(Object.create)&&(ip.prototype=Object.create(io.prototype),ip.prototype.constructor=ip),Object.defineProperties(ip.prototype,{cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),ip.prototype.load=async function(){return u(this._promise)?this._promise:u(this._typedArray)?(this._promise=Promise.resolve(this),this._promise):(this._promise=hFe(this),this._promise)},ip._fetchArrayBuffer=function(e){return e.fetchArrayBuffer()},ip.prototype.unload=function(){this._typedArray=void 0};var oA=ip;function rA(e,t){this._distance=t,this._normal=new Noe(e,this),this.onChangeCallback=void 0,this.index=-1}function Noe(e,t){this._clippingPlane=t,this._cartesian3=h.clone(e)}Object.defineProperties(rA.prototype,{distance:{get:function(){return this._distance},set:function(e){u(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){u(this.onChangeCallback)&&!h.equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),h.clone(e,this._normal._cartesian3)}}}),rA.fromPlane=function(e,t){return u(t)?(t.normal=e.normal,t.distance=e.distance):t=new rA(e.normal,e.distance),t},rA.clone=function(e,t){return u(t)?(t.normal=e.normal,t.distance=e.distance,t):new rA(e.normal,e.distance)},Object.defineProperties(Noe.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){u(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){u(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){u(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}});var sA=rA;function ka(e){e=y(e,y.EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=y(e.enabled,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this.edgeColor=z.clone(y(e.edgeColor,z.WHITE)),this.edgeWidth=y(e.edgeWidth,0),this.planeAdded=new pe,this.planeRemoved=new pe,this._owner=void 0;let t=y(e.unionClippingRegions,!1);this._unionClippingRegions=t,this._testIntersection=t?Uoe:zoe,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;let i=e.planes;if(u(i)){let e=i.length;for(let t=0;t<e;++t)this.add(i[t])}}function Uoe(e){return e===Zt.OUTSIDE}function zoe(e){return e===Zt.INSIDE}function Foe(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||-1!==e._dirtyIndex&&e._dirtyIndex!==t,e._dirtyIndex=t}function Hoe(e,t){let i=e.length;for(let n=0;n<i;++n)if(tn.equals(e[n],t))return n;return-1}Object.defineProperties(ka.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?Uoe:zoe)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}}),ka.prototype.add=function(e){let t=this._planes.length,i=this;e.onChangeCallback=function(e){Foe(i,e)},e.index=t,Foe(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)},ka.prototype.get=function(e){return this._planes[e]},ka.prototype.contains=function(e){return-1!==Hoe(this._planes,e)},ka.prototype.remove=function(e){let t=this._planes,i=Hoe(t,e);if(-1===i)return!1;e instanceof sA&&(e.onChangeCallback=void 0,e.index=-1);let n=t.length-1;for(let e=i;e<n;++e){let i=t[e+1];t[e]=i,i instanceof sA&&(i.index=e)}return this._multipleDirtyPlanes=!0,t.length=n,this.planeRemoved.raiseEvent(e,i),!0},ka.prototype.removeAll=function(){let e=this._planes,t=e.length;for(let i=0;i<t;++i){let t=e[i];t instanceof sA&&(t.onChangeCallback=void 0,t.index=-1),this.planeRemoved.raiseEvent(t,i)}this._multipleDirtyPlanes=!0,this._planes=[]};var mFe=new oe,pFe=new oe;function Boe(e,t,i){let n=e._uint8View,r=e._planes,o=0;for(let e=t;e<i;++e){let t=r[e],i=Gn.octEncodeToCartesian4(t.normal,pFe);n[o]=i.x,n[o+1]=i.y,n[o+2]=i.z,n[o+3]=i.w;let a=oe.packFloat(t.distance,mFe);n[o+4]=a.x,n[o+5]=a.y,n[o+6]=a.z,n[o+7]=a.w,o+=8}}function koe(e,t,i){let n=e._float32View,r=e._planes,o=0;for(let e=t;e<i;++e){let t=r[e],i=t.normal;n[o]=i.x,n[o+1]=i.y,n[o+2]=i.z,n[o+3]=t.distance,o+=4}}function Goe(e,t){let i=zt.maximumTextureSize;return t.x=Math.min(e,i),t.y=Math.ceil(e/t.x),t}var _Fe=new U;ka.prototype.update=function(e){let t=this._clippingPlanesTexture,i=e.context,n=ka.useFloatTexture(i),r=n?this.length:2*this.length;if(u(t)){let e=t.width*t.height;(e<r||r<.25*e)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(0===this.length)return;if(!u(t)){let e=Goe(r,_Fe);e.y*=2,n?(t=new Ot({context:i,width:e.x,height:e.y,pixelFormat:rt.RGBA,pixelDatatype:Ye.FLOAT,sampler:un.NEAREST,flipY:!1}),this._float32View=new Float32Array(e.x*e.y*4)):(t=new Ot({context:i,width:e.x,height:e.y,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,sampler:un.NEAREST,flipY:!1}),this._uint8View=new Uint8Array(e.x*e.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}let o=this._dirtyIndex;if(this._multipleDirtyPlanes||-1!==o){if(this._multipleDirtyPlanes)n?(koe(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._float32View}})):(Boe(this,0,this._planes.length),t.copyFrom({source:{width:t.width,height:t.height,arrayBufferView:this._uint8View}}));else{let e=0,i=0;n?(i=Math.floor(o/t.width),e=Math.floor(o-i*t.width),koe(this,o,o+1),t.copyFrom({source:{width:1,height:1,arrayBufferView:this._float32View},xOffset:e,yOffset:i})):(i=Math.floor(2*o/t.width),e=Math.floor(2*o-i*t.width),Boe(this,o,o+1),t.copyFrom({source:{width:2,height:1,arrayBufferView:this._uint8View},xOffset:e,yOffset:i}))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}};var gFe=new L,Voe=new tn(h.UNIT_X,0);ka.prototype.computeIntersectionWithBoundingVolume=function(e,t){let i=this._planes,n=i.length,r=this.modelMatrix;u(t)&&(r=L.multiply(t,r,gFe));let o=Zt.INSIDE;!this.unionClippingRegions&&n>0&&(o=Zt.OUTSIDE);for(let t=0;t<n;++t){let n=i[t];tn.transform(n,r,Voe);let a=e.intersectPlane(Voe);if(a===Zt.INTERSECTING)o=a;else if(this._testIntersection(a))return a}return o},ka.setOwner=function(e,t,i){e!==t[i]&&(t[i]=t[i]&&t[i].destroy(),u(e)&&(e._owner=t,t[i]=e))},ka.useFloatTexture=function(e){return e.floatingPointTexture},ka.getTextureResolution=function(e,t,i){let n=e.texture;if(u(n))return i.x=n.width,i.y=n.height,i;let r=Goe(ka.useFloatTexture(t)?e.length:2*e.length,i);return r.y*=2,r},ka.prototype.isDestroyed=function(){return!1},ka.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),le(this)};var ys=ka,yFe=new U;function xFe(e,t){let i=e.unionClippingRegions,n=e.length,r=ys.useFloatTexture(t),o=ys.getTextureResolution(e,t,yFe),a=o.x,s=o.y,l=r?AFe(a,s):CFe(a,s);return l+="\n",l+=i?bFe(n):TFe(n),l}function bFe(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)\n{\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float clipAmount;\n    float pixelWidth = czm_metersPerPixel(position);\n    bool breakAndDiscard = false;\n    for (int i = 0; i < ${e}; ++i)\n    {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));\n        if (amount <= 0.0)\n        {\n           breakAndDiscard = true;\n           break;\n        }\n    }\n    if (breakAndDiscard) {\n        discard;\n    }\n    return clipAmount;\n}\n`}function TFe(e){return`float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)\n{\n    bool clipped = true;\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float clipAmount = 0.0;\n    float pixelWidth = czm_metersPerPixel(position);\n    for (int i = 0; i < ${e}; ++i)\n    {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        clipAmount = max(amount, clipAmount);\n        clipped = clipped && (amount <= 0.0);\n    }\n    if (clipped)\n    {\n        discard;\n    }\n    return clipAmount;\n}\n`}function AFe(e,t){let i=1/t,n=`${1/e}`;-1===n.indexOf(".")&&(n+=".0");let r=`${i}`;return-1===r.indexOf(".")&&(r+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)\n{\n    int pixY = clippingPlaneNumber / ${e};\n    int pixX = clippingPlaneNumber - (pixY * ${e});\n    float u = (float(pixX) + 0.5) * ${n};\n    float v = (float(pixY) + 0.5) * ${r};\n    vec4 plane = texture(packedClippingPlanes, vec2(u, v));\n    return czm_transformPlane(plane, transform);\n}\n`}function CFe(e,t){let i=1/t,n=`${1/e}`;-1===n.indexOf(".")&&(n+=".0");let r=`${i}`;return-1===r.indexOf(".")&&(r+=".0"),`vec4 getClippingPlane(highp sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)\n{\n    int clippingPlaneStartIndex = clippingPlaneNumber * 2;\n    int pixY = clippingPlaneStartIndex / ${e};\n    int pixX = clippingPlaneStartIndex - (pixY * ${e});\n    float u = (float(pixX) + 0.5) * ${n};\n    float v = (float(pixY) + 0.5) * ${r};\n    vec4 oct32 = texture(packedClippingPlanes, vec2(u, v)) * 255.0;\n    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);\n    vec4 plane;\n    plane.xyz = czm_octDecode(oct, 65535.0);\n    plane.w = czm_unpackFloat(texture(packedClippingPlanes, vec2(u + ${n}, v)));\n    return czm_transformPlane(plane, transform);\n}\n`}var og=xFe,B0={VERTEX:0,FRAGMENT:1,BOTH:2,includesVertexShader:function(e){return e===B0.VERTEX||e===B0.BOTH},includesFragmentShader:function(e){return e===B0.FRAGMENT||e===B0.BOTH}},Ce=Object.freeze(B0);function B6(e){this.name=e,this.fields=[]}B6.prototype.addField=function(e,t){let i=`    ${e} ${t};`;this.fields.push(i)},B6.prototype.generateGlslLines=function(){let e=this.fields;return 0===e.length&&(e=["    float _empty;"]),[].concat(`struct ${this.name}`,"{",e,"};")};var LL=B6;function k6(e){this.signature=e,this.body=[]}k6.prototype.addLines=function(e){let t=this.body;if(Array.isArray(e)){let i=e.length;for(let n=0;n<i;n++)t.push(`    ${e[n]}`)}else t.push(`    ${e}`)},k6.prototype.generateGlslLines=function(){return[].concat(this.signature,"{",this.body,"}")};var NL=k6;function gc(){this._positionAttributeLine=void 0,this._nextAttributeLocation=1,this._attributeLocations={},this._attributeLines=[],this._structs={},this._functions={},this._vertexShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]},this._fragmentShaderParts={defineLines:[],uniformLines:[],shaderLines:[],varyingLines:[],structIds:[],functionIds:[]}}function EFe(e){let t,i,n,r,o=[],a=[],s=e._vertexShaderParts.structIds;for(t=0;t<s.length;t++)i=s[t],n=e._structs[i],r=n.generateGlslLines(),o.push.apply(o,r);for(s=e._fragmentShaderParts.structIds,t=0;t<s.length;t++)i=s[t],n=e._structs[i],r=n.generateGlslLines(),a.push.apply(a,r);return{vertexLines:o,fragmentLines:a}}function SFe(e){switch(e){case"mat2":return 2;case"mat3":return 3;case"mat4":return 4;default:return 1}}function wFe(e){let t,i,n,r,o=[],a=[],s=e._vertexShaderParts.functionIds;for(t=0;t<s.length;t++)i=s[t],n=e._functions[i],r=n.generateGlslLines(),o.push.apply(o,r);for(s=e._fragmentShaderParts.functionIds,t=0;t<s.length;t++)i=s[t],n=e._functions[i],r=n.generateGlslLines(),a.push.apply(a,r);return{vertexLines:o,fragmentLines:a}}Object.defineProperties(gc.prototype,{attributeLocations:{get:function(){return this._attributeLocations}}}),gc.prototype.addDefine=function(e,t,i){i=y(i,Ce.BOTH);let n=e;u(t)&&(n+=` ${t.toString()}`),Ce.includesVertexShader(i)&&this._vertexShaderParts.defineLines.push(n),Ce.includesFragmentShader(i)&&this._fragmentShaderParts.defineLines.push(n)},gc.prototype.addStruct=function(e,t,i){this._structs[e]=new LL(t),Ce.includesVertexShader(i)&&this._vertexShaderParts.structIds.push(e),Ce.includesFragmentShader(i)&&this._fragmentShaderParts.structIds.push(e)},gc.prototype.addStructField=function(e,t,i){this._structs[e].addField(t,i)},gc.prototype.addFunction=function(e,t,i){this._functions[e]=new NL(t),Ce.includesVertexShader(i)&&this._vertexShaderParts.functionIds.push(e),Ce.includesFragmentShader(i)&&this._fragmentShaderParts.functionIds.push(e)},gc.prototype.addFunctionLines=function(e,t){this._functions[e].addLines(t)},gc.prototype.addUniform=function(e,t,i){i=y(i,Ce.BOTH);let n=`uniform ${e} ${t};`;Ce.includesVertexShader(i)&&this._vertexShaderParts.uniformLines.push(n),Ce.includesFragmentShader(i)&&this._fragmentShaderParts.uniformLines.push(n)},gc.prototype.setPositionAttribute=function(e,t){return this._positionAttributeLine=`in ${e} ${t};`,this._attributeLocations[t]=0,0},gc.prototype.addAttribute=function(e,t){let i=`in ${e} ${t};`;this._attributeLines.push(i);let n=this._nextAttributeLocation;return this._attributeLocations[t]=n,this._nextAttributeLocation+=SFe(e),n},gc.prototype.addVarying=function(e,t){let i=`${e} ${t};`;this._vertexShaderParts.varyingLines.push(`out ${i}`),this._fragmentShaderParts.varyingLines.push(`in ${i}`)},gc.prototype.addVertexLines=function(e){let t=this._vertexShaderParts.shaderLines;Array.isArray(e)?t.push.apply(t,e):t.push(e)},gc.prototype.addFragmentLines=function(e){let t=this._fragmentShaderParts.shaderLines;Array.isArray(e)?t.push.apply(t,e):t.push(e)},gc.prototype.buildShaderProgram=function(e){let t=u(this._positionAttributeLine)?[this._positionAttributeLine]:[],i=EFe(this),n=wFe(this),r=t.concat(this._attributeLines,this._vertexShaderParts.uniformLines,this._vertexShaderParts.varyingLines,i.vertexLines,n.vertexLines,this._vertexShaderParts.shaderLines).join("\n"),o=new He({defines:this._vertexShaderParts.defineLines,sources:[r]}),a=this._fragmentShaderParts.uniformLines.concat(this._fragmentShaderParts.varyingLines,i.fragmentLines,n.fragmentLines,this._fragmentShaderParts.shaderLines).join("\n"),s=new He({defines:this._fragmentShaderParts.defineLines,sources:[a]});return Kt.fromCache({context:e,vertexShaderSource:o,fragmentShaderSource:s,attributeLocations:this._attributeLocations})},gc.prototype.clone=function(){return Ge(this,!0)};var aA=gc,FL="// See Intersection.glsl for the definition of intersectScene\n// See IntersectionUtils.glsl for the definition of nextIntersection\n// See convertUvToBox.glsl, convertUvToCylinder.glsl, or convertUvToEllipsoid.glsl\n// for the definition of convertUvToShapeUvSpace. The appropriate function is \n// selected based on the VoxelPrimitive shape type, and added to the shader in\n// Scene/VoxelRenderResources.js.\n// See Octree.glsl for the definitions of TraversalData, SampleData,\n// traverseOctreeFromBeginning, and traverseOctreeFromExisting\n// See Megatexture.glsl for the definition of accumulatePropertiesFromMegatexture\n\n#define STEP_COUNT_MAX 1000 // Harcoded value because GLSL doesn't like variable length loops\n#define ALPHA_ACCUM_MAX 0.98 // Must be > 0.0 and <= 1.0\n\nuniform mat3 u_transformDirectionViewToLocal;\nuniform vec3 u_cameraPositionUv;\nuniform float u_stepSize;\n\n#if defined(PICKING)\n    uniform vec4 u_pickColor;\n#endif\n\n#if defined(JITTER)\nfloat hash(vec2 p)\n{\n    vec3 p3 = fract(vec3(p.xyx) * 50.0); // magic number = hashscale\n    p3 += dot(p3, p3.yzx + 19.19);\n    return fract((p3.x + p3.y) * p3.z);\n}\n#endif\n\nvec4 getStepSize(in SampleData sampleData, in Ray viewRay, in RayShapeIntersection shapeIntersection) {\n#if defined(SHAPE_BOX)\n    Box voxelBox = constructVoxelBox(sampleData.tileCoords, sampleData.tileUv);\n    RayShapeIntersection voxelIntersection = intersectBox(viewRay, voxelBox);\n    vec4 entry = shapeIntersection.entry.w >= voxelIntersection.entry.w ? shapeIntersection.entry : voxelIntersection.entry;\n    float exit = min(voxelIntersection.exit.w, shapeIntersection.exit.w);\n    float dt = (exit - entry.w) * RAY_SCALE;\n    return vec4(normalize(entry.xyz), dt);\n#else\n    float dimAtLevel = pow(2.0, float(sampleData.tileCoords.w));\n    return vec4(viewRay.dir, u_stepSize / dimAtLevel);\n#endif\n}\n\nvoid main()\n{\n    vec4 fragCoord = gl_FragCoord;\n    vec2 screenCoord = (fragCoord.xy - czm_viewport.xy) / czm_viewport.zw; // [0,1]\n    vec3 eyeDirection = normalize(czm_windowToEyeCoordinates(fragCoord).xyz);\n    vec3 viewDirWorld = normalize(czm_inverseViewRotation * eyeDirection); // normalize again just in case\n    vec3 viewDirUv = normalize(u_transformDirectionViewToLocal * eyeDirection); // normalize again just in case\n    vec3 viewPosUv = u_cameraPositionUv;\n    #if defined(SHAPE_BOX)\n        vec3 dInv = 1.0 / viewDirUv;\n        Ray viewRayUv = Ray(viewPosUv, viewDirUv, dInv);\n    #else\n        Ray viewRayUv = Ray(viewPosUv, viewDirUv);\n    #endif\n\n    Intersections ix;\n    RayShapeIntersection shapeIntersection = intersectScene(screenCoord, viewRayUv, ix);\n\n    // Exit early if the scene was completely missed.\n    if (shapeIntersection.entry.w == NO_HIT) {\n        discard;\n    }\n\n    float currT = shapeIntersection.entry.w * RAY_SCALE;\n    float endT = shapeIntersection.exit.w;\n    vec3 positionUv = viewPosUv + currT * viewDirUv;\n    vec3 positionUvShapeSpace = convertUvToShapeUvSpace(positionUv);\n\n    // Traverse the tree from the start position\n    TraversalData traversalData;\n    SampleData sampleDatas[SAMPLE_COUNT];\n    traverseOctreeFromBeginning(positionUvShapeSpace, traversalData, sampleDatas);\n    vec4 step = getStepSize(sampleDatas[0], viewRayUv, shapeIntersection);\n\n    #if defined(JITTER)\n        float noise = hash(screenCoord); // [0,1]\n        currT += noise * step.w;\n        positionUv += noise * step.w * viewDirUv;\n    #endif\n\n    FragmentInput fragmentInput;\n    #if defined(STATISTICS)\n        setStatistics(fragmentInput.metadata.statistics);\n    #endif\n\n    vec4 colorAccum =vec4(0.0);\n\n    for (int stepCount = 0; stepCount < STEP_COUNT_MAX; ++stepCount) {\n        // Read properties from the megatexture based on the traversal state\n        Properties properties = accumulatePropertiesFromMegatexture(sampleDatas);\n\n        // Prepare the custom shader inputs\n        copyPropertiesToMetadata(properties, fragmentInput.metadata);\n        fragmentInput.voxel.positionUv = positionUv;\n        fragmentInput.voxel.positionShapeUv = positionUvShapeSpace;\n        fragmentInput.voxel.positionUvLocal = sampleDatas[0].tileUv;\n        fragmentInput.voxel.viewDirUv = viewDirUv;\n        fragmentInput.voxel.viewDirWorld = viewDirWorld;\n        fragmentInput.voxel.surfaceNormal = step.xyz;\n        fragmentInput.voxel.travelDistance = step.w;\n\n        // Run the custom shader\n        czm_modelMaterial materialOutput;\n        fragmentMain(fragmentInput, materialOutput);\n\n        // Sanitize the custom shader output\n        vec4 color = vec4(materialOutput.diffuse, materialOutput.alpha);\n        color.rgb = max(color.rgb, vec3(0.0));\n        color.a = clamp(color.a, 0.0, 1.0);\n\n        // Pre-multiplied alpha blend\n        colorAccum += (1.0 - colorAccum.a) * vec4(color.rgb * color.a, color.a);\n\n        // Stop traversing if the alpha has been fully saturated\n        if (colorAccum.a > ALPHA_ACCUM_MAX) {\n            colorAccum.a = ALPHA_ACCUM_MAX;\n            break;\n        }\n\n        if (step.w == 0.0) {\n            // Shape is infinitely thin. The ray may have hit the edge of a\n            // foreground voxel. Step ahead slightly to check for more voxels\n            step.w == 0.00001;\n        }\n\n        // Keep raymarching\n        currT += step.w;\n        positionUv += step.w * viewDirUv;\n\n        // Check if there's more intersections.\n        if (currT > endT) {\n            #if (INTERSECTION_COUNT == 1)\n                break;\n            #else\n                shapeIntersection = nextIntersection(ix);\n                if (shapeIntersection.entry.w == NO_HIT) {\n                    break;\n                } else {\n                    // Found another intersection. Resume raymarching there\n                    currT = shapeIntersection.entry.w * RAY_SCALE;\n                    endT = shapeIntersection.exit.w;\n                    positionUv = viewPosUv + currT * viewDirUv;\n                }\n            #endif\n        }\n\n        // Traverse the tree from the current ray position.\n        // This is similar to traverseOctreeFromBeginning but is faster when the ray is in the same tile as the previous step.\n        positionUvShapeSpace = convertUvToShapeUvSpace(positionUv);\n        traverseOctreeFromExisting(positionUvShapeSpace, traversalData, sampleDatas);\n        step = getStepSize(sampleDatas[0], viewRayUv, shapeIntersection);\n    }\n\n    // Convert the alpha from [0,ALPHA_ACCUM_MAX] to [0,1]\n    colorAccum.a /= ALPHA_ACCUM_MAX;\n\n    #if defined(PICKING)\n        // If alpha is 0.0 there is nothing to pick\n        if (colorAccum.a == 0.0) {\n            discard;\n        }\n        out_FragColor = u_pickColor;\n    #else\n        out_FragColor = colorAccum;\n    #endif\n}\n",BL="in vec2 position;\n\nuniform vec4 u_ndcSpaceAxisAlignedBoundingBox;\n\nvoid main() {\n    vec2 aabbMin = u_ndcSpaceAxisAlignedBoundingBox.xy;\n    vec2 aabbMax = u_ndcSpaceAxisAlignedBoundingBox.zw;\n    vec2 translation = 0.5 * (aabbMax + aabbMin);\n    vec2 scale = 0.5 * (aabbMax - aabbMin);\n    gl_Position = vec4(position * scale + translation, 0.0, 1.0);\n}\n",kL="/* Intersection defines\n#define INTERSECTION_COUNT ###\n*/\n\n#define NO_HIT (-czm_infinity)\n#define INF_HIT (czm_infinity * 0.5)\n#define RAY_SHIFT (0.000003163)\n#define RAY_SCALE (1.003163)\n\nstruct Ray {\n    vec3 pos;\n    vec3 dir;\n#if defined(SHAPE_BOX)\n    vec3 dInv;\n#endif\n};\n\nstruct RayShapeIntersection {\n    vec4 entry;\n    vec4 exit;\n};\n\nstruct Intersections {\n    // Don't access these member variables directly - call the functions instead.\n\n    // Store an array of ray-surface intersections. Each intersection is composed of:\n    //  .xyz for the surface normal at the intersection point\n    //  .w for the T value\n    // The scale of the normal encodes the shape intersection type:\n    //  length(intersection.xyz) = 1: positive shape entry\n    //  length(intersection.xyz) = 2: positive shape exit\n    //  length(intersection.xyz) = 3: negative shape entry\n    //  length(intersection.xyz) = 4: negative shape exit\n    // INTERSECTION_COUNT is the number of ray-*shape* (volume) intersections,\n    // so we need twice as many to track ray-*surface* intersections\n    vec4 intersections[INTERSECTION_COUNT * 2];\n\n    #if (INTERSECTION_COUNT > 1)\n        // Maintain state for future nextIntersection calls\n        int index;\n        int surroundCount;\n        bool surroundIsPositive;\n    #endif\n};\n\nRayShapeIntersection getFirstIntersection(in Intersections ix) \n{\n    return RayShapeIntersection(ix.intersections[0], ix.intersections[1]);\n}\n\nvec4 encodeIntersectionType(vec4 intersection, int index, bool entry)\n{\n    float scale = float(index > 0) * 2.0 + float(!entry) + 1.0;\n    return vec4(intersection.xyz * scale, intersection.w);\n}\n\n// Use defines instead of real functions because WebGL1 cannot access array with non-constant index.\n#define setIntersection(/*inout Intersections*/ ix, /*int*/ index, /*float*/ t, /*bool*/ positive, /*bool*/ enter) (ix).intersections[(index)] = vec4(0.0, float(!positive) * 2.0 + float(!enter) + 1.0, 0.0, (t))\n#define setIntersectionPair(/*inout Intersections*/ ix, /*int*/ index, /*vec2*/ entryExit) (ix).intersections[(index) * 2 + 0] = vec4(0.0, float((index) > 0) * 2.0 + 1.0, 0.0, (entryExit).x); (ix).intersections[(index) * 2 + 1] = vec4(0.0, float((index) > 0) * 2.0 + 2.0, 0.0, (entryExit).y)\n#define setSurfaceIntersection(/*inout Intersections*/ ix, /*int*/ index, /*vec4*/ intersection) (ix).intersections[(index)] = intersection;\n#define setShapeIntersection(/*inout Intersections*/ ix, /*int*/ index, /*RayShapeIntersection*/ intersection) (ix).intersections[(index) * 2 + 0] = encodeIntersectionType((intersection).entry, (index), true); (ix).intersections[(index) * 2 + 1] = encodeIntersectionType((intersection).exit, (index), false)\n\n#if (INTERSECTION_COUNT > 1)\nvoid initializeIntersections(inout Intersections ix) {\n    // Sort the intersections from min T to max T with bubble sort.\n    // Note: If this sorting function changes, some of the intersection test may\n    // need to be updated. Search for \"bubble sort\" to find those areas.\n    const int sortPasses = INTERSECTION_COUNT * 2 - 1;\n    for (int n = sortPasses; n > 0; --n) {\n        for (int i = 0; i < sortPasses; ++i) {\n            // The loop should be: for (i = 0; i < n; ++i) {...} but WebGL1 cannot\n            // loop with non-constant condition, so it has to break early instead\n            if (i >= n) { break; }\n\n            vec4 intersect0 = ix.intersections[i + 0];\n            vec4 intersect1 = ix.intersections[i + 1];\n\n            bool inOrder = intersect0.w <= intersect1.w;\n\n            ix.intersections[i + 0] = inOrder ? intersect0 : intersect1;\n            ix.intersections[i + 1] = inOrder ? intersect1 : intersect0;\n        }\n    }\n\n    // Prepare initial state for nextIntersection\n    ix.index = 0;\n    ix.surroundCount = 0;\n    ix.surroundIsPositive = false;\n}\n#endif\n\n#if (INTERSECTION_COUNT > 1)\nRayShapeIntersection nextIntersection(inout Intersections ix) {\n    vec4 surfaceIntersection = vec4(0.0, 0.0, 0.0, NO_HIT);\n    RayShapeIntersection shapeIntersection = RayShapeIntersection(surfaceIntersection, surfaceIntersection);\n\n    const int passCount = INTERSECTION_COUNT * 2;\n\n    if (ix.index == passCount) {\n        return shapeIntersection;\n    }\n\n    for (int i = 0; i < passCount; ++i) {\n        // The loop should be: for (i = ix.index; i < passCount; ++i) {...} but WebGL1 cannot\n        // loop with non-constant condition, so it has to continue instead.\n        if (i < ix.index) {\n            continue;\n        }\n\n        ix.index = i + 1;\n\n        surfaceIntersection = ix.intersections[i];\n        int intersectionType = int(length(surfaceIntersection.xyz) - 0.5);\n        bool currShapeIsPositive = intersectionType < 2;\n        bool enter = intMod(intersectionType, 2) == 0;\n\n        ix.surroundCount += enter ? +1 : -1;\n        ix.surroundIsPositive = currShapeIsPositive ? enter : ix.surroundIsPositive;\n\n        // entering positive or exiting negative\n        if (ix.surroundCount == 1 && ix.surroundIsPositive && enter == currShapeIsPositive) {\n            shapeIntersection.entry = surfaceIntersection;\n        }\n\n        // exiting positive or entering negative after being inside positive\n        bool exitPositive = !enter && currShapeIsPositive && ix.surroundCount == 0;\n        bool enterNegativeFromPositive = enter && !currShapeIsPositive && ix.surroundCount == 2 && ix.surroundIsPositive;\n        if (exitPositive || enterNegativeFromPositive) {\n            shapeIntersection.exit = surfaceIntersection;\n\n            // entry and exit have been found, so the loop can stop\n            if (exitPositive) {\n                // After exiting positive shape there is nothing left to intersect, so jump to the end index.\n                ix.index = passCount;\n            }\n            break;\n        }\n    }\n\n    return shapeIntersection;\n}\n#endif\n\n// NOTE: initializeIntersections, nextIntersection aren't even declared unless INTERSECTION_COUNT > 1\n",VL="// See IntersectionUtils.glsl for the definitions of Ray, Intersections,\n// setIntersectionPair, INF_HIT, NO_HIT\n\n/* intersectDepth defines (set in Scene/VoxelRenderResources.js)\n#define DEPTH_INTERSECTION_INDEX ###\n*/\n\nuniform mat4 u_transformPositionViewToUv;\n\nvoid intersectDepth(in vec2 screenCoord, in Ray ray, inout Intersections ix) {\n    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, screenCoord));\n    if (logDepthOrDepth != 0.0) {\n        // Calculate how far the ray must travel before it hits the depth buffer.\n        vec4 eyeCoordinateDepth = czm_screenToEyeCoordinates(screenCoord, logDepthOrDepth);\n        eyeCoordinateDepth /= eyeCoordinateDepth.w;\n        vec3 depthPositionUv = vec3(u_transformPositionViewToUv * eyeCoordinateDepth);\n        float t = dot(depthPositionUv - ray.pos, ray.dir);\n        setIntersectionPair(ix, DEPTH_INTERSECTION_INDEX, vec2(t, +INF_HIT));\n    } else {\n        // There's no depth at this location.\n        setIntersectionPair(ix, DEPTH_INTERSECTION_INDEX, vec2(NO_HIT));\n    }\n}\n",UL="// See IntersectionUtils.glsl for the definitions of Ray, Intersections, INF_HIT,\n// NO_HIT, setIntersectionPair\n\n/* Clipping plane defines (set in Scene/VoxelRenderResources.js)\n#define CLIPPING_PLANES_UNION\n#define CLIPPING_PLANES_COUNT\n#define CLIPPING_PLANES_INTERSECTION_INDEX\n*/\n\nuniform sampler2D u_clippingPlanesTexture;\nuniform mat4 u_clippingPlanesMatrix;\n\n// Plane is in Hessian Normal Form\nvec4 intersectPlane(in Ray ray, in vec4 plane) {\n    vec3 n = plane.xyz; // normal\n    float w = plane.w; // -dot(pointOnPlane, normal)\n\n    float a = dot(ray.pos, n);\n    float b = dot(ray.dir, n);\n    float t = -(w + a) / b;\n\n    return vec4(n, t);\n}\n\nvoid intersectClippingPlanes(in Ray ray, inout Intersections ix) {\n    vec4 backSide = vec4(-ray.dir, -INF_HIT);\n    vec4 farSide = vec4(ray.dir, +INF_HIT);\n    RayShapeIntersection clippingVolume;\n\n    #if (CLIPPING_PLANES_COUNT == 1)\n        // Union and intersection are the same when there's one clipping plane, and the code\n        // is more simplified.\n        vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, 0, u_clippingPlanesMatrix);\n        vec4 intersection = intersectPlane(ray, planeUv);\n        bool reflects = dot(ray.dir, intersection.xyz) < 0.0;\n        clippingVolume.entry = reflects ? backSide : intersection;\n        clippingVolume.exit = reflects ? intersection : farSide;\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX, clippingVolume);\n    #elif defined(CLIPPING_PLANES_UNION)\n        vec4 firstTransmission = vec4(ray.dir, +INF_HIT);\n        vec4 lastReflection = vec4(-ray.dir, -INF_HIT);\n        for (int i = 0; i < CLIPPING_PLANES_COUNT; i++) {\n            vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, i, u_clippingPlanesMatrix);\n            vec4 intersection = intersectPlane(ray, planeUv);\n            if (dot(ray.dir, planeUv.xyz) > 0.0) {\n                firstTransmission = intersection.w <= firstTransmission.w ? intersection : firstTransmission;\n            } else {\n                lastReflection = intersection.w >= lastReflection.w ? intersection : lastReflection;\n            }\n        }\n        clippingVolume.entry = backSide;\n        clippingVolume.exit = lastReflection;\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX + 0, clippingVolume);\n        clippingVolume.entry = firstTransmission;\n        clippingVolume.exit = farSide;\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX + 1, clippingVolume);\n    #else // intersection\n        vec4 lastTransmission = vec4(ray.dir, -INF_HIT);\n        vec4 firstReflection = vec4(-ray.dir, +INF_HIT);\n        for (int i = 0; i < CLIPPING_PLANES_COUNT; i++) {\n            vec4 planeUv = getClippingPlane(u_clippingPlanesTexture, i, u_clippingPlanesMatrix);\n            vec4 intersection = intersectPlane(ray, planeUv);\n            if (dot(ray.dir, planeUv.xyz) > 0.0) {\n                lastTransmission = intersection.w > lastTransmission.w ? intersection : lastTransmission;\n            } else {\n                firstReflection = intersection.w < firstReflection.w ? intersection: firstReflection;\n            }\n        }\n        if (lastTransmission.w < firstReflection.w) {\n            clippingVolume.entry = lastTransmission;\n            clippingVolume.exit = firstReflection;\n        } else {\n            clippingVolume.entry = vec4(-ray.dir, NO_HIT);\n            clippingVolume.exit = vec4(ray.dir, NO_HIT);\n        }\n        setShapeIntersection(ix, CLIPPING_PLANES_INTERSECTION_INDEX, clippingVolume);\n    #endif\n}\n",zL="// See IntersectionUtils.glsl for the definitions of Ray and NO_HIT\n// See convertUvToBox.glsl for the definition of convertShapeUvToUvSpace\n\n/* Box defines (set in Scene/VoxelBoxShape.js)\n#define BOX_INTERSECTION_INDEX ### // always 0\n*/\n\nuniform vec3 u_renderMinBounds;\nuniform vec3 u_renderMaxBounds;\n\nstruct Box {\n    vec3 p0;\n    vec3 p1;\n};\n\nBox constructVoxelBox(in ivec4 octreeCoords, in vec3 tileUv)\n{\n    // Find the min/max cornerpoints of the voxel in tile coordinates\n    vec3 tileOrigin = vec3(octreeCoords.xyz);\n    vec3 numSamples = vec3(u_dimensions);\n    vec3 voxelSize = 1.0 / numSamples;\n    vec3 coordP0 = floor(tileUv * numSamples) * voxelSize + tileOrigin;\n    vec3 coordP1 = coordP0 + voxelSize;\n\n    // Transform to the UV coordinates of the scaled tileset\n    float tileSize = 1.0 / pow(2.0, float(octreeCoords.w));\n    vec3 p0 = convertShapeUvToUvSpace(coordP0 * tileSize);\n    vec3 p1 = convertShapeUvToUvSpace(coordP1 * tileSize);\n\n    return Box(p0, p1);\n}\n\nvec3 getBoxNormal(in Box box, in Ray ray, in float t)\n{\n    vec3 hitPoint = ray.pos + t * ray.dir;\n    vec3 lower = step(hitPoint, box.p0);\n    vec3 upper = step(box.p1, hitPoint);\n    return normalize(upper - lower);\n}\n\n// Find the distances along a ray at which the ray intersects an axis-aligned box\n// See https://tavianator.com/2011/ray_box.html\nRayShapeIntersection intersectBox(in Ray ray, in Box box)\n{\n    // Consider the box as the intersection of the space between 3 pairs of parallel planes\n    // Compute the distance along the ray to each plane\n    vec3 t0 = (box.p0 - ray.pos) * ray.dInv;\n    vec3 t1 = (box.p1 - ray.pos) * ray.dInv;\n\n    // Identify candidate entries/exits based on distance from ray.pos\n    vec3 entries = min(t0, t1);\n    vec3 exits = max(t0, t1);\n\n    // The actual box intersection points are the furthest entry and the closest exit\n    float entryT = max(max(entries.x, entries.y), entries.z);\n    float exitT = min(min(exits.x, exits.y), exits.z);\n\n    vec3 entryNormal = getBoxNormal(box, ray, entryT - RAY_SHIFT);\n    vec3 exitNormal = getBoxNormal(box, ray, exitT + RAY_SHIFT);\n\n    if (entryT > exitT) {\n        entryT = NO_HIT;\n        exitT = NO_HIT;\n    }\n\n    return RayShapeIntersection(vec4(entryNormal, entryT), vec4(exitNormal, exitT));\n}\n\nvoid intersectShape(in Ray ray, inout Intersections ix)\n{\n    RayShapeIntersection intersection = intersectBox(ray, Box(u_renderMinBounds, u_renderMaxBounds));\n    setShapeIntersection(ix, BOX_INTERSECTION_INDEX, intersection);\n}\n",HL="// See IntersectionUtils.glsl for the definitions of Ray, setIntersection,\n// setIntersectionPair\n\n/* Cylinder defines (set in Scene/VoxelCylinderShape.js)\n#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN\n#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MAX\n#define CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT\n#define CYLINDER_HAS_RENDER_BOUNDS_HEIGHT\n#define CYLINDER_HAS_RENDER_BOUNDS_HEIGHT_FLAT\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_HALF\n#define CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO\n\n#define CYLINDER_HAS_SHAPE_BOUNDS_RADIUS\n#define CYLINDER_HAS_SHAPE_BOUNDS_RADIUS_FLAT\n#define CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT\n#define CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT_FLAT\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_RANGE_EQUAL_ZERO\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED\n\n#define CYLINDER_INTERSECTION_INDEX_RADIUS_MAX\n#define CYLINDER_INTERSECTION_INDEX_RADIUS_MIN\n#define CYLINDER_INTERSECTION_INDEX_ANGLE\n*/\n\n// Cylinder uniforms\n#if defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MAX) || defined(CYLINDER_HAS_RENDER_BOUNDS_HEIGHT)\n    uniform vec3 u_cylinderUvToRenderBoundsScale;\n    uniform vec3 u_cylinderUvToRenderBoundsTranslate;\n#endif\n#if defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN) && !defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT)\n    uniform float u_cylinderUvToRenderRadiusMin;\n#endif\n#if defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE)\n    uniform vec2 u_cylinderRenderAngleMinMax;\n#endif\n\nvec4 intersectHalfPlane(Ray ray, float angle) {\n    vec2 o = ray.pos.xy;\n    vec2 d = ray.dir.xy;\n    vec2 planeDirection = vec2(cos(angle), sin(angle));\n    vec2 planeNormal = vec2(planeDirection.y, -planeDirection.x);\n\n    float a = dot(o, planeNormal);\n    float b = dot(d, planeNormal);\n    float t = -a / b;\n\n    vec2 p = o + t * d;\n    bool outside = dot(p, planeDirection) < 0.0;\n    if (outside) return vec4(-INF_HIT, +INF_HIT, NO_HIT, NO_HIT);\n\n    return vec4(-INF_HIT, t, t, +INF_HIT);\n}\n\n#define POSITIVE_HIT vec2(t, +INF_HIT);\n#define NEGATIVE_HIT vec2(-INF_HIT, t);\n\nvec2 intersectHalfSpace(Ray ray, float angle)\n{\n    vec2 o = ray.pos.xy;\n    vec2 d = ray.dir.xy;\n    vec2 n = vec2(sin(angle), -cos(angle));\n\n    float a = dot(o, n);\n    float b = dot(d, n);\n    float t = -a / b;\n    float s = sign(a);\n\n    // Half space cuts right through the camera, pick the side to intersect\n    if (a == 0.0) {\n        if (b >= 0.0) {\n            return POSITIVE_HIT;\n        } else {\n            return NEGATIVE_HIT;\n        }\n    }\n\n    if (t >= 0.0 != s >= 0.0) {\n        return POSITIVE_HIT;\n    } else {\n        return NEGATIVE_HIT;\n    }\n}\n\nvec2 intersectRegularWedge(Ray ray, float minAngle, float maxAngle)\n{\n    vec2 o = ray.pos.xy;\n    vec2 d = ray.dir.xy;\n    vec2 n1 = vec2(sin(minAngle), -cos(minAngle));\n    vec2 n2 = vec2(-sin(maxAngle), cos(maxAngle));\n\n    float a1 = dot(o, n1);\n    float a2 = dot(o, n2);\n    float b1 = dot(d, n1);\n    float b2 = dot(d, n2);\n\n    float t1 = -a1 / b1;\n    float t2 = -a2 / b2;\n    float s1 = sign(a1);\n    float s2 = sign(a2);\n\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n    float smin = tmin == t1 ? s1 : s2;\n    float smax = tmin == t1 ? s2 : s1;\n\n    bool e = tmin >= 0.0;\n    bool f = tmax >= 0.0;\n    bool g = smin >= 0.0;\n    bool h = smax >= 0.0;\n\n    if (e != g && f == h) return vec2(tmin, tmax);\n    else if (e == g && f == h) return vec2(-INF_HIT, tmin);\n    else if (e != g && f != h) return vec2(tmax, +INF_HIT);\n    else return vec2(NO_HIT);\n}\n\nvec4 intersectFlippedWedge(Ray ray, float minAngle, float maxAngle)\n{\n    vec2 planeIntersectMin = intersectHalfSpace(ray, minAngle);\n    vec2 planeIntersectMax = intersectHalfSpace(ray, maxAngle + czm_pi);\n    return vec4(planeIntersectMin, planeIntersectMax);\n}\n\nvec2 intersectUnitCylinder(Ray ray)\n{\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n\n    float a = dot(d.xy, d.xy);\n    float b = dot(o.xy, d.xy);\n    float c = dot(o.xy, o.xy) - 1.0;\n    float det = b * b - a * c;\n\n    if (det < 0.0) {\n        return vec2(NO_HIT);\n    }\n\n    det = sqrt(det);\n    float ta = (-b - det) / a;\n    float tb = (-b + det) / a;\n    float t1 = min(ta, tb);\n    float t2 = max(ta, tb);\n\n    float z1 = o.z + t1 * d.z;\n    float z2 = o.z + t2 * d.z;\n\n    if (abs(z1) >= 1.0)\n    {\n        float tCap = (sign(z1) - o.z) / d.z;\n        t1 = abs(b + a * tCap) < det ? tCap : NO_HIT;\n    }\n\n    if (abs(z2) >= 1.0)\n    {\n        float tCap = (sign(z2) - o.z) / d.z;\n        t2 = abs(b + a * tCap) < det ? tCap : NO_HIT;\n    }\n\n    return vec2(t1, t2);\n}\n\nvec2 intersectUnitCircle(Ray ray) {\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n\n    float t = -o.z / d.z;\n    vec2 zPlanePos = o.xy + d.xy * t;\n    float distSqr = dot(zPlanePos, zPlanePos);\n\n    if (distSqr > 1.0) {\n        return vec2(NO_HIT);\n    }\n\n    return vec2(t, t);\n}\n\nvec2 intersectInfiniteUnitCylinder(Ray ray)\n{\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n\n    float a = dot(d.xy, d.xy);\n    float b = dot(o.xy, d.xy);\n    float c = dot(o.xy, o.xy) - 1.0;\n    float det = b * b - a * c;\n\n    if (det < 0.0) {\n        return vec2(NO_HIT);\n    }\n\n    det = sqrt(det);\n    float t1 = (-b - det) / a;\n    float t2 = (-b + det) / a;\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n\n    return vec2(tmin, tmax);\n}\n\nvoid intersectShape(Ray ray, inout Intersections ix)\n{\n    #if defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MAX) || defined(CYLINDER_HAS_RENDER_BOUNDS_HEIGHT)\n        ray.pos = ray.pos * u_cylinderUvToRenderBoundsScale + u_cylinderUvToRenderBoundsTranslate;\n        ray.dir *= u_cylinderUvToRenderBoundsScale;\n    #else\n        // Position is converted from [0,1] to [-1,+1] because shape intersections assume unit space is [-1,+1].\n        // Direction is scaled as well to be in sync with position.\n        ray.pos = ray.pos * 2.0 - 1.0;\n        ray.dir *= 2.0;\n    #endif\n\n    #if defined(CYLINDER_HAS_RENDER_BOUNDS_HEIGHT_FLAT)\n        vec2 outerIntersect = intersectUnitCircle(ray);\n    #else\n        vec2 outerIntersect = intersectUnitCylinder(ray);\n    #endif\n\n    setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_RADIUS_MAX, outerIntersect);\n\n    if (outerIntersect.x == NO_HIT) {\n        return;\n    }\n\n    #if defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT)\n        // When the cylinder is perfectly thin it's necessary to sandwich the\n        // inner cylinder intersection inside the outer cylinder intersection.\n\n        // Without this special case,\n        // [outerMin, outerMax, innerMin, innerMax] will bubble sort to\n        // [outerMin, innerMin, outerMax, innerMax] which will cause the back\n        // side of the cylinder to be invisible because it will think the ray\n        // is still inside the inner (negative) cylinder after exiting the\n        // outer (positive) cylinder.\n\n        // With this special case,\n        // [outerMin, innerMin, innerMax, outerMax] will bubble sort to\n        // [outerMin, innerMin, innerMax, outerMax] which will work correctly.\n\n        // Note: If initializeIntersections() changes its sorting function\n        // from bubble sort to something else, this code may need to change.\n        vec2 innerIntersect = intersectInfiniteUnitCylinder(ray);\n        setIntersection(ix, 0, outerIntersect.x, true, true);   // positive, enter\n        setIntersection(ix, 1, innerIntersect.x, false, true);  // negative, enter\n        setIntersection(ix, 2, innerIntersect.y, false, false); // negative, exit\n        setIntersection(ix, 3, outerIntersect.y, true, false);  // positive, exit\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN)\n        Ray innerRay = Ray(ray.pos * u_cylinderUvToRenderRadiusMin, ray.dir * u_cylinderUvToRenderRadiusMin);\n        vec2 innerIntersect = intersectInfiniteUnitCylinder(innerRay);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_RADIUS_MIN, innerIntersect);\n    #endif\n\n    #if defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF)\n        vec2 wedgeIntersect = intersectRegularWedge(ray, u_cylinderRenderAngleMinMax.x, u_cylinderRenderAngleMinMax.y);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_ANGLE, wedgeIntersect);\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF)\n        vec4 wedgeIntersect = intersectFlippedWedge(ray, u_cylinderRenderAngleMinMax.x, u_cylinderRenderAngleMinMax.y);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 0, wedgeIntersect.xy);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 1, wedgeIntersect.zw);\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_HALF)\n        vec2 wedgeIntersect = intersectHalfSpace(ray, u_cylinderRenderAngleMinMax.x);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_ANGLE, wedgeIntersect);\n    #elif defined(CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO)\n        vec4 wedgeIntersect = intersectHalfPlane(ray, u_cylinderRenderAngleMinMax.x);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 0, wedgeIntersect.xy);\n        setIntersectionPair(ix, CYLINDER_INTERSECTION_INDEX_ANGLE + 1, wedgeIntersect.zw);\n    #endif\n}\n",GL="// See IntersectionUtils.glsl for the definitions of Ray, Intersections,\n// setIntersection, setIntersectionPair, INF_HIT, NO_HIT\n\n/* Ellipsoid defines (set in Scene/VoxelEllipsoidShape.js)\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF\n#define ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MAX\n#define ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MIN\n#define ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_FLAT\n#define ELLIPSOID_INTERSECTION_INDEX_LONGITUDE\n#define ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX\n#define ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN\n#define ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX\n#define ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN\n*/\n\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE)\n    uniform vec2 u_ellipsoidRenderLongitudeMinMax;\n#endif\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF)\n    uniform vec2 u_ellipsoidRenderLatitudeCosSqrHalfMinMax;\n#endif\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MAX)\n    uniform float u_ellipsoidInverseOuterScaleUv;\n#endif\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MIN)\n    uniform float u_ellipsoidInverseInnerScaleUv;\n#endif\n\nvec2 intersectZPlane(Ray ray)\n{\n    float o = ray.pos.z;\n    float d = ray.dir.z;\n    float t = -o / d;\n    float s = sign(o);\n\n    if (t >= 0.0 != s >= 0.0) return vec2(t, +INF_HIT);\n    else return vec2(-INF_HIT, t);\n}\n\nvec4 intersectHalfPlane(Ray ray, float angle) {\n    vec2 o = ray.pos.xy;\n    vec2 d = ray.dir.xy;\n    vec2 planeDirection = vec2(cos(angle), sin(angle));\n    vec2 planeNormal = vec2(planeDirection.y, -planeDirection.x);\n\n    float a = dot(o, planeNormal);\n    float b = dot(d, planeNormal);\n    float t = -a / b;\n\n    vec2 p = o + t * d;\n    bool outside = dot(p, planeDirection) < 0.0;\n    if (outside) return vec4(-INF_HIT, +INF_HIT, NO_HIT, NO_HIT);\n\n    return vec4(-INF_HIT, t, t, +INF_HIT);\n}\n\nvec2 intersectHalfSpace(Ray ray, float angle)\n{\n    vec2 o = ray.pos.xy;\n    vec2 d = ray.dir.xy;\n    vec2 n = vec2(sin(angle), -cos(angle));\n\n    float a = dot(o, n);\n    float b = dot(d, n);\n    float t = -a / b;\n    float s = sign(a);\n\n    if (t >= 0.0 != s >= 0.0) return vec2(t, +INF_HIT);\n    else return vec2(-INF_HIT, t);\n}\n\nvec2 intersectRegularWedge(Ray ray, float minAngle, float maxAngle)\n{\n    vec2 o = ray.pos.xy;\n    vec2 d = ray.dir.xy;\n    vec2 n1 = vec2(sin(minAngle), -cos(minAngle));\n    vec2 n2 = vec2(-sin(maxAngle), cos(maxAngle));\n\n    float a1 = dot(o, n1);\n    float a2 = dot(o, n2);\n    float b1 = dot(d, n1);\n    float b2 = dot(d, n2);\n\n    float t1 = -a1 / b1;\n    float t2 = -a2 / b2;\n    float s1 = sign(a1);\n    float s2 = sign(a2);\n\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n    float smin = tmin == t1 ? s1 : s2;\n    float smax = tmin == t1 ? s2 : s1;\n\n    bool e = tmin >= 0.0;\n    bool f = tmax >= 0.0;\n    bool g = smin >= 0.0;\n    bool h = smax >= 0.0;\n\n    if (e != g && f == h) return vec2(tmin, tmax);\n    else if (e == g && f == h) return vec2(-INF_HIT, tmin);\n    else if (e != g && f != h) return vec2(tmax, +INF_HIT);\n    else return vec2(NO_HIT);\n}\n\nvec4 intersectFlippedWedge(Ray ray, float minAngle, float maxAngle)\n{\n    vec2 planeIntersectMin = intersectHalfSpace(ray, minAngle);\n    vec2 planeIntersectMax = intersectHalfSpace(ray, maxAngle + czm_pi);\n    return vec4(planeIntersectMin, planeIntersectMax);\n}\n\nvec2 intersectUnitSphere(Ray ray)\n{\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n\n    float b = dot(d, o);\n    float c = dot(o, o) - 1.0;\n    float det = b * b - c;\n\n    if (det < 0.0) {\n        return vec2(NO_HIT);\n    }\n\n    det = sqrt(det);\n    float t1 = -b - det;\n    float t2 = -b + det;\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n\n    return vec2(tmin, tmax);\n}\n\nvec2 intersectUnitSphereUnnormalizedDirection(Ray ray)\n{\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n\n    float a = dot(d, d);\n    float b = dot(d, o);\n    float c = dot(o, o) - 1.0;\n    float det = b * b - a * c;\n\n    if (det < 0.0) {\n        return vec2(NO_HIT);\n    }\n\n    det = sqrt(det);\n    float t1 = (-b - det) / a;\n    float t2 = (-b + det) / a;\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n\n    return vec2(tmin, tmax);\n}\n\nvec2 intersectDoubleEndedCone(Ray ray, float cosSqrHalfAngle)\n{\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n    float a = d.z * d.z - dot(d, d) * cosSqrHalfAngle;\n    float b = d.z * o.z - dot(o, d) * cosSqrHalfAngle;\n    float c = o.z * o.z - dot(o, o) * cosSqrHalfAngle;\n    float det = b * b - a * c;\n\n    if (det < 0.0) {\n        return vec2(NO_HIT);\n    }\n\n    det = sqrt(det);\n    float t1 = (-b - det) / a;\n    float t2 = (-b + det) / a;\n    float tmin = min(t1, t2);\n    float tmax = max(t1, t2);\n    return vec2(tmin, tmax);\n}\n\nvec4 intersectFlippedCone(Ray ray, float cosSqrHalfAngle) {\n    vec2 intersect = intersectDoubleEndedCone(ray, cosSqrHalfAngle);\n\n    if (intersect.x == NO_HIT) {\n        return vec4(-INF_HIT, +INF_HIT, NO_HIT, NO_HIT);\n    }\n\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n    float tmin = intersect.x;\n    float tmax = intersect.y;\n    float zmin = o.z + tmin * d.z;\n    float zmax = o.z + tmax * d.z;\n\n    // One interval\n    if (zmin < 0.0 && zmax < 0.0) return vec4(-INF_HIT, +INF_HIT, NO_HIT, NO_HIT);\n    else if (zmin < 0.0) return vec4(-INF_HIT, tmax, NO_HIT, NO_HIT);\n    else if (zmax < 0.0) return vec4(tmin, +INF_HIT, NO_HIT, NO_HIT);\n    // Two intervals\n    else return vec4(-INF_HIT, tmin, tmax, +INF_HIT);\n}\n\nvec2 intersectRegularCone(Ray ray, float cosSqrHalfAngle) {\n    vec2 intersect = intersectDoubleEndedCone(ray, cosSqrHalfAngle);\n\n    if (intersect.x == NO_HIT) {\n        return vec2(NO_HIT);\n    }\n\n    vec3 o = ray.pos;\n    vec3 d = ray.dir;\n    float tmin = intersect.x;\n    float tmax = intersect.y;\n    float zmin = o.z + tmin * d.z;\n    float zmax = o.z + tmax * d.z;\n\n    if (zmin < 0.0 && zmax < 0.0) return vec2(NO_HIT);\n    else if (zmin < 0.0) return vec2(tmax, +INF_HIT);\n    else if (zmax < 0.0) return vec2(-INF_HIT, tmin);\n    else return vec2(tmin, tmax);\n}\n\nvoid intersectShape(in Ray ray, inout Intersections ix) {\n    // Position is converted from [0,1] to [-1,+1] because shape intersections assume unit space is [-1,+1].\n    // Direction is scaled as well to be in sync with position.\n    ray.pos = ray.pos * 2.0 - 1.0;\n    ray.dir *= 2.0;\n\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MAX)\n        Ray outerRay = Ray(ray.pos * u_ellipsoidInverseOuterScaleUv, ray.dir * u_ellipsoidInverseOuterScaleUv);\n    #else\n        Ray outerRay = ray;\n    #endif\n\n    // Outer ellipsoid\n    vec2 outerIntersect = intersectUnitSphereUnnormalizedDirection(outerRay);\n    setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX, outerIntersect);\n\n    // Exit early if the outer ellipsoid was missed.\n    if (outerIntersect.x == NO_HIT) {\n        return;\n    }\n\n    // Inner ellipsoid\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_FLAT)\n        // When the ellipsoid is perfectly thin it's necessary to sandwich the\n        // inner ellipsoid intersection inside the outer ellipsoid intersection.\n\n        // Without this special case,\n        // [outerMin, outerMax, innerMin, innerMax] will bubble sort to\n        // [outerMin, innerMin, outerMax, innerMax] which will cause the back\n        // side of the ellipsoid to be invisible because it will think the ray\n        // is still inside the inner (negative) ellipsoid after exiting the\n        // outer (positive) ellipsoid.\n\n        // With this special case,\n        // [outerMin, innerMin, innerMax, outerMax] will bubble sort to\n        // [outerMin, innerMin, innerMax, outerMax] which will work correctly.\n\n        // Note: If initializeIntersections() changes its sorting function\n        // from bubble sort to something else, this code may need to change.\n        setIntersection(ix, 0, outerIntersect.x, true, true);   // positive, enter\n        setIntersection(ix, 1, outerIntersect.x, false, true);  // negative, enter\n        setIntersection(ix, 2, outerIntersect.y, false, false); // negative, exit\n        setIntersection(ix, 3, outerIntersect.y, true, false);  // positive, exit\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MIN)\n        Ray innerRay = Ray(ray.pos * u_ellipsoidInverseInnerScaleUv, ray.dir * u_ellipsoidInverseInnerScaleUv);\n        vec2 innerIntersect = intersectUnitSphereUnnormalizedDirection(innerRay);\n\n        if (innerIntersect == vec2(NO_HIT)) {\n            setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN, innerIntersect);\n        } else {\n            // When the ellipsoid is very large and thin it's possible for floating\n            // point math to cause the ray to intersect the inner ellipsoid before\n            // the outer ellipsoid. To prevent this from happening, clamp innerIntersect\n            // to outerIntersect and sandwhich the intersections like described above.\n            //\n            // In theory a similar fix is needed for cylinders, however it's more\n            // complicated to implement because the inner shape is allowed to be\n            // intersected first.\n            innerIntersect.x = max(innerIntersect.x, outerIntersect.x);\n            innerIntersect.y = min(innerIntersect.y, outerIntersect.y);\n            setIntersection(ix, 0, outerIntersect.x, true, true);   // positive, enter\n            setIntersection(ix, 1, innerIntersect.x, false, true);  // negative, enter\n            setIntersection(ix, 2, innerIntersect.y, false, false); // negative, exit\n            setIntersection(ix, 3, outerIntersect.y, true, false);  // positive, exit\n        }\n    #endif\n\n    // Flip the ray because the intersection function expects a cone growing towards +Z.\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF)\n        Ray flippedRay = outerRay;\n        flippedRay.dir.z *= -1.0;\n        flippedRay.pos.z *= -1.0;\n    #endif\n\n    // Bottom cone\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF)\n        vec2 bottomConeIntersection = intersectRegularCone(flippedRay, u_ellipsoidRenderLatitudeCosSqrHalfMinMax.x);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN, bottomConeIntersection);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF)\n        vec2 bottomConeIntersection = intersectZPlane(flippedRay);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN, bottomConeIntersection);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF)\n        vec4 bottomConeIntersection = intersectFlippedCone(ray, u_ellipsoidRenderLatitudeCosSqrHalfMinMax.x);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN + 0, bottomConeIntersection.xy);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN + 1, bottomConeIntersection.zw);\n    #endif\n\n    // Top cone\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF)\n        vec4 topConeIntersection = intersectFlippedCone(flippedRay, u_ellipsoidRenderLatitudeCosSqrHalfMinMax.y);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX + 0, topConeIntersection.xy);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX + 1, topConeIntersection.zw);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF)\n        vec2 topConeIntersection = intersectZPlane(ray);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX, topConeIntersection);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF)\n        vec2 topConeIntersection = intersectRegularCone(ray, u_ellipsoidRenderLatitudeCosSqrHalfMinMax.y);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX, topConeIntersection);\n    #endif\n\n    // Wedge\n    #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO)\n        vec4 wedgeIntersect = intersectHalfPlane(ray, u_ellipsoidRenderLongitudeMinMax.x);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 0, wedgeIntersect.xy);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 1, wedgeIntersect.zw);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF)\n        vec2 wedgeIntersect = intersectRegularWedge(ray, u_ellipsoidRenderLongitudeMinMax.x, u_ellipsoidRenderLongitudeMinMax.y);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE, wedgeIntersect);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_HALF)\n        vec2 wedgeIntersect = intersectHalfSpace(ray, u_ellipsoidRenderLongitudeMinMax.x);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE, wedgeIntersect);\n    #elif defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF)\n        vec4 wedgeIntersect = intersectFlippedWedge(ray, u_ellipsoidRenderLongitudeMinMax.x, u_ellipsoidRenderLongitudeMinMax.y);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 0, wedgeIntersect.xy);\n        setIntersectionPair(ix, ELLIPSOID_INTERSECTION_INDEX_LONGITUDE + 1, wedgeIntersect.zw);\n    #endif\n}\n",cA="// Main intersection function for Voxel scenes.\n// See IntersectBox.glsl, IntersectCylinder.glsl, or IntersectEllipsoid.glsl\n// for the definition of intersectShape. The appropriate function is selected\n// based on the VoxelPrimitive shape type, and added to the shader in\n// Scene/VoxelRenderResources.js.\n// See also IntersectClippingPlane.glsl and IntersectDepth.glsl.\n// See IntersectionUtils.glsl for the definitions of Ray, NO_HIT,\n// getFirstIntersection, initializeIntersections, nextIntersection.\n\n/* Intersection defines (set in Scene/VoxelRenderResources.js)\n#define INTERSECTION_COUNT ###\n*/\n\nRayShapeIntersection intersectScene(in vec2 screenCoord, in Ray ray, out Intersections ix) {\n    // Do a ray-shape intersection to find the exact starting and ending points.\n    intersectShape(ray, ix);\n\n    // Exit early if the positive shape was completely missed or behind the ray.\n    RayShapeIntersection intersection = getFirstIntersection(ix);\n    if (intersection.entry.w == NO_HIT) {\n        // Positive shape was completely missed - so exit early.\n        return intersection;\n    }\n\n    // Clipping planes\n    #if defined(CLIPPING_PLANES)\n        intersectClippingPlanes(ray, ix);\n    #endif\n\n    // Depth\n    #if defined(DEPTH_TEST)\n        intersectDepth(screenCoord, ray, ix);\n    #endif\n\n    // Find the first intersection that's in front of the ray\n    #if (INTERSECTION_COUNT > 1)\n        initializeIntersections(ix);\n        for (int i = 0; i < INTERSECTION_COUNT; ++i) {\n            intersection = nextIntersection(ix);\n            if (intersection.exit.w > 0.0) {\n                // Set start to 0.0 when ray is inside the shape.\n                intersection.entry.w = max(intersection.entry.w, 0.0);\n                break;\n            }\n        }\n    #else\n        // Set start to 0.0 when ray is inside the shape.\n        intersection.entry.w = max(intersection.entry.w, 0.0);\n    #endif\n\n    return intersection;\n}\n",WL="/* Box defines (set in Scene/VoxelBoxShape.js)\n#define BOX_HAS_SHAPE_BOUNDS\n*/\n\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    uniform vec3 u_boxUvToShapeUvScale;\n    uniform vec3 u_boxUvToShapeUvTranslate;\n#endif\n\nvec3 convertUvToShapeUvSpace(in vec3 positionUv) {\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    return positionUv * u_boxUvToShapeUvScale + u_boxUvToShapeUvTranslate;\n#else\n    return positionUv;\n#endif\n}\n\nvec3 convertShapeUvToUvSpace(in vec3 shapeUv) {\n#if defined(BOX_HAS_SHAPE_BOUNDS)\n    return (shapeUv - u_boxUvToShapeUvTranslate) / u_boxUvToShapeUvScale;\n#else\n    return shapeUv;\n#endif\n}\n",jL="/* Cylinder defines (set in Scene/VoxelCylinderShape.js)\n#define CYLINDER_HAS_SHAPE_BOUNDS_RADIUS\n#define CYLINDER_HAS_SHAPE_BOUNDS_RADIUS_FLAT\n#define CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT\n#define CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT_FLAT\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_RANGE_EQUAL_ZERO\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY\n#define CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED\n*/\n\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)\n    uniform vec2 u_cylinderUvToShapeUvRadius; // x = scale, y = offset\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)\n    uniform vec2 u_cylinderUvToShapeUvHeight; // x = scale, y = offset\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)\n    uniform vec2 u_cylinderUvToShapeUvAngle; // x = scale, y = offset\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY)\n    uniform vec2 u_cylinderShapeUvAngleMinMax;\n#endif\n#if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY) || defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED)\n    uniform float u_cylinderShapeUvAngleRangeZeroMid;\n#endif\n\nvec3 convertUvToShapeUvSpace(in vec3 positionUv) {\n    vec3 positionLocal = positionUv * 2.0 - 1.0; // [-1,+1]\n\n    // Compute radius\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS_FLAT)\n        float radius = 1.0;\n    #else\n        float radius = length(positionLocal.xy); // [0,1]\n        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_RADIUS)\n            radius = radius * u_cylinderUvToShapeUvRadius.x + u_cylinderUvToShapeUvRadius.y; // x = scale, y = offset\n        #endif\n    #endif\n\n    // Compute height\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT_FLAT)\n        float height = 1.0;\n    #else\n        float height = positionUv.z; // [0,1]\n        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT)\n            height = height * u_cylinderUvToShapeUvHeight.x + u_cylinderUvToShapeUvHeight.y; // x = scale, y = offset\n        #endif\n    #endif\n\n    // Compute angle\n    #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_RANGE_EQUAL_ZERO)\n        float angle = 1.0;\n    #else\n        float angle = (atan(positionLocal.y, positionLocal.x) + czm_pi) / czm_twoPi; // [0,1]\n        #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE)\n            #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED)\n                // Comparing against u_cylinderShapeUvAngleMinMax has precision problems. u_cylinderShapeUvAngleRangeZeroMid is more conservative.\n                angle += float(angle < u_cylinderShapeUvAngleRangeZeroMid);\n            #endif\n\n            // Avoid flickering from reading voxels from both sides of the -pi/+pi discontinuity.\n            #if defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY)\n                angle = angle > u_cylinderShapeUvAngleRangeZeroMid ? u_cylinderShapeUvAngleMinMax.x : angle;\n            #elif defined(CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY)\n                angle = angle < u_cylinderShapeUvAngleRangeZeroMid ? u_cylinderShapeUvAngleMinMax.y : angle;\n            #endif\n\n            angle = angle * u_cylinderUvToShapeUvAngle.x + u_cylinderUvToShapeUvAngle.y; // x = scale, y = offset\n        #endif\n    #endif\n\n    return vec3(radius, height, angle);\n}\n",qL='/* Ellipsoid defines (set in Scene/VoxelEllipsoidShape.js)\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY\n#define ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE_RANGE_EQUAL_ZERO\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_MIN\n#define ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_FLAT\n#define ELLIPSOID_IS_SPHERE\n*/\n\nuniform vec3 u_ellipsoidRadiiUv; // [0,1]\n#if !defined(ELLIPSOID_IS_SPHERE)\n    uniform vec3 u_ellipsoidInverseRadiiSquaredUv;\n#endif\n#if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY) || defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY) || defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED)\n    uniform vec3 u_ellipsoidShapeUvLongitudeMinMaxMid;\n#endif\n#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)\n    uniform vec2 u_ellipsoidUvToShapeUvLongitude; // x = scale, y = offset\n#endif\n#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)\n    uniform vec2 u_ellipsoidUvToShapeUvLatitude; // x = scale, y = offset\n#endif\n#if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_MIN) && !defined(ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_FLAT)\n    uniform float u_ellipsoidInverseHeightDifferenceUv;\n    uniform vec2 u_ellipseInnerRadiiUv; // [0,1]\n#endif\n\n// robust iterative solution without trig functions\n// https://github.com/0xfaded/ellipse_demo/issues/1\n// https://stackoverflow.com/questions/22959698/distance-from-given-point-to-given-ellipse\n// Pro: Good when radii.x ~= radii.y\n// Con: Breaks at pos.x ~= 0.0, especially inside the ellipse\n// Con: Inaccurate with exterior points and thin ellipses\nfloat ellipseDistanceIterative (vec2 pos, vec2 radii) {\n    vec2 p = abs(pos);\n    vec2 invRadii = 1.0 / radii;\n    vec2 a = vec2(1.0, -1.0) * (radii.x * radii.x - radii.y * radii.y) * invRadii;\n    vec2 t = vec2(0.70710678118); // sqrt(2) / 2\n    vec2 v = radii * t;\n\n    const int iterations = 3;\n    for (int i = 0; i < iterations; ++i) {\n        vec2 e = a * pow(t, vec2(3.0));\n        vec2 q = normalize(p - e) * length(v - e);\n        t = normalize((q + e) * invRadii);\n        v = radii * t;\n    }\n    return length(v * sign(pos) - pos) * sign(p.y - v.y);\n}\n\nvec3 convertUvToShapeUvSpace(in vec3 positionUv) {\n    // Compute position and normal.\n    // Convert positionUv [0,1] to local space [-1,+1] to "normalized" cartesian space [-a,+a] where a = (radii + height) / (max(radii) + height).\n    // A point on the largest ellipsoid axis would be [-1,+1] and everything else would be smaller.\n    vec3 positionLocal = positionUv * 2.0 - 1.0;\n    #if defined(ELLIPSOID_IS_SPHERE)\n        vec3 posEllipsoid = positionLocal * u_ellipsoidRadiiUv.x;\n        vec3 normal = normalize(posEllipsoid);\n    #else\n        vec3 posEllipsoid = positionLocal * u_ellipsoidRadiiUv;\n        vec3 normal = normalize(posEllipsoid * u_ellipsoidInverseRadiiSquaredUv); // geodetic surface normal\n    #endif\n\n    // Compute longitude\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO)\n        float longitude = 1.0;\n    #else\n        float longitude = (atan(normal.y, normal.x) + czm_pi) / czm_twoPi;\n\n        // Correct the angle when max < min\n        // Technically this should compare against min longitude - but it has precision problems so compare against the middle of empty space.\n        #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED)\n            longitude += float(longitude < u_ellipsoidShapeUvLongitudeMinMaxMid.z);\n        #endif\n\n        // Avoid flickering from reading voxels from both sides of the -pi/+pi discontinuity.\n        #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY)\n            longitude = longitude > u_ellipsoidShapeUvLongitudeMinMaxMid.z ? u_ellipsoidShapeUvLongitudeMinMaxMid.x : longitude;\n        #endif\n        #if defined(ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY)\n            longitude = longitude < u_ellipsoidShapeUvLongitudeMinMaxMid.z ? u_ellipsoidShapeUvLongitudeMinMaxMid.y : longitude;\n        #endif\n\n        #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE)\n            longitude = longitude * u_ellipsoidUvToShapeUvLongitude.x + u_ellipsoidUvToShapeUvLongitude.y;\n        #endif\n    #endif\n\n    // Compute latitude\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE_RANGE_EQUAL_ZERO)\n        float latitude = 1.0;\n    #else\n        float latitude = (asin(normal.z) + czm_piOverTwo) / czm_pi;\n        #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE)\n            latitude = latitude * u_ellipsoidUvToShapeUvLatitude.x + u_ellipsoidUvToShapeUvLatitude.y;\n        #endif\n    #endif\n\n    // Compute height\n    #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_FLAT)\n        // TODO: This breaks down when minBounds == maxBounds. To fix it, this\n        // function would have to know if ray is intersecting the front or back of the shape\n        // and set the shape space position to 1 (front) or 0 (back) accordingly.\n        float height = 1.0;\n    #else\n        #if defined(ELLIPSOID_IS_SPHERE)\n            #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_MIN)\n                float height = (length(posEllipsoid) - u_ellipseInnerRadiiUv.x) * u_ellipsoidInverseHeightDifferenceUv;\n            #else\n                float height = length(posEllipsoid);\n            #endif\n        #else\n            #if defined(ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_MIN)\n                // Convert the 3D position to a 2D position relative to the ellipse (radii.x, radii.z) (assuming radii.x == radii.y which is true for WGS84).\n                // This is an optimization so that math can be done with ellipses instead of ellipsoids.\n                vec2 posEllipse = vec2(length(posEllipsoid.xy), posEllipsoid.z);\n                float height = ellipseDistanceIterative(posEllipse, u_ellipseInnerRadiiUv) * u_ellipsoidInverseHeightDifferenceUv;\n            #else\n                // TODO: this is probably not correct\n                float height = length(posEllipsoid);\n            #endif\n        #endif\n    #endif\n\n    return vec3(longitude, latitude, height);\n}\n',YL="// These octree flags must be in sync with GpuOctreeFlag in VoxelTraversal.js\n#define OCTREE_FLAG_INTERNAL 0\n#define OCTREE_FLAG_LEAF 1\n#define OCTREE_FLAG_PACKED_LEAF_FROM_PARENT 2\n\n#define OCTREE_MAX_LEVELS 32 // Harcoded value because GLSL doesn't like variable length loops\n\nuniform sampler2D u_octreeInternalNodeTexture;\nuniform vec2 u_octreeInternalNodeTexelSizeUv;\nuniform int u_octreeInternalNodeTilesPerRow;\n#if (SAMPLE_COUNT > 1)\nuniform sampler2D u_octreeLeafNodeTexture;\nuniform vec2 u_octreeLeafNodeTexelSizeUv;\nuniform int u_octreeLeafNodeTilesPerRow;\n#endif\n\nstruct OctreeNodeData {\n    int data;\n    int flag;\n};\n\nstruct TraversalData {\n    ivec4 octreeCoords;\n    int parentOctreeIndex;\n};\n\nstruct SampleData {\n    int megatextureIndex;\n    ivec4 tileCoords;\n    vec3 tileUv;\n    #if (SAMPLE_COUNT > 1)\n        float weight;\n    #endif\n};\n\n// Integer mod: For WebGL1 only\nint intMod(in int a, in int b) {\n    return a - (b * (a / b));\n}\nint normU8_toInt(in float value) {\n    return int(value * 255.0);\n}\nint normU8x2_toInt(in vec2 value) {\n    return int(value.x * 255.0) + 256 * int(value.y * 255.0);\n}\nfloat normU8x2_toFloat(in vec2 value) {\n    return float(normU8x2_toInt(value)) / 65535.0;\n}\n\nOctreeNodeData getOctreeNodeData(in vec2 octreeUv) {\n    vec4 texData = texture(u_octreeInternalNodeTexture, octreeUv);\n\n    OctreeNodeData data;\n    data.data = normU8x2_toInt(texData.xy);\n    data.flag = normU8x2_toInt(texData.zw);\n    return data;\n}\n\nOctreeNodeData getOctreeChildData(in int parentOctreeIndex, in ivec3 childCoord) {\n    int childIndex = childCoord.z * 4 + childCoord.y * 2 + childCoord.x;\n    int octreeCoordX = intMod(parentOctreeIndex, u_octreeInternalNodeTilesPerRow) * 9 + 1 + childIndex;\n    int octreeCoordY = parentOctreeIndex / u_octreeInternalNodeTilesPerRow;\n    vec2 octreeUv = u_octreeInternalNodeTexelSizeUv * vec2(float(octreeCoordX) + 0.5, float(octreeCoordY) + 0.5);\n    return getOctreeNodeData(octreeUv);\n}\n\nint getOctreeParentIndex(in int octreeIndex) {\n    int octreeCoordX = intMod(octreeIndex, u_octreeInternalNodeTilesPerRow) * 9;\n    int octreeCoordY = octreeIndex / u_octreeInternalNodeTilesPerRow;\n    vec2 octreeUv = u_octreeInternalNodeTexelSizeUv * vec2(float(octreeCoordX) + 0.5, float(octreeCoordY) + 0.5);\n    vec4 parentData = texture(u_octreeInternalNodeTexture, octreeUv);\n    int parentOctreeIndex = normU8x2_toInt(parentData.xy);\n    return parentOctreeIndex;\n}\n\n/**\n* Convert a position in the uv-space of the tileset bounding shape\n* into the uv-space of a tile within the tileset\n*/\nvec3 getTileUv(in vec3 shapePosition, in ivec4 octreeCoords) {\n\t// PERFORMANCE_IDEA: use bit-shifting (only in WebGL2)\n    float dimAtLevel = pow(2.0, float(octreeCoords.w));\n    return shapePosition * dimAtLevel - vec3(octreeCoords.xyz);\n}\n\nvoid getOctreeLeafSampleData(in OctreeNodeData data, in ivec4 octreeCoords, out SampleData sampleData) {\n    sampleData.megatextureIndex = data.data;\n    sampleData.tileCoords = (data.flag == OCTREE_FLAG_PACKED_LEAF_FROM_PARENT)\n        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)\n        : octreeCoords;\n}\n\n#if (SAMPLE_COUNT > 1)\nvoid getOctreeLeafSampleDatas(in OctreeNodeData data, in ivec4 octreeCoords, out SampleData sampleDatas[SAMPLE_COUNT]) {\n    int leafIndex = data.data;\n    int leafNodeTexelCount = 2;\n    // Adding 0.5 moves to the center of the texel\n    float leafCoordXStart = float(intMod(leafIndex, u_octreeLeafNodeTilesPerRow) * leafNodeTexelCount) + 0.5;\n    float leafCoordY = float(leafIndex / u_octreeLeafNodeTilesPerRow) + 0.5;\n\n    // Get an interpolation weight and a flag to determine whether to read the parent texture\n    vec2 leafUv0 = u_octreeLeafNodeTexelSizeUv * vec2(leafCoordXStart + 0.0, leafCoordY);\n    vec4 leafData0 = texture(u_octreeLeafNodeTexture, leafUv0);\n    float lerp = normU8x2_toFloat(leafData0.xy);\n    sampleDatas[0].weight = 1.0 - lerp;\n    sampleDatas[1].weight = lerp;\n    // TODO: this looks wrong? Should be comparing to OCTREE_FLAG_PACKED_LEAF_FROM_PARENT\n    sampleDatas[0].tileCoords = (normU8_toInt(leafData0.z) == 1)\n        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)\n        : octreeCoords;\n    sampleDatas[1].tileCoords = (normU8_toInt(leafData0.w) == 1)\n        ? ivec4(octreeCoords.xyz / 2, octreeCoords.w - 1)\n        : octreeCoords;\n\n    // Get megatexture indices for both samples\n    vec2 leafUv1 = u_octreeLeafNodeTexelSizeUv * vec2(leafCoordXStart + 1.0, leafCoordY);\n    vec4 leafData1 = texture(u_octreeLeafNodeTexture, leafUv1);\n    sampleDatas[0].megatextureIndex = normU8x2_toInt(leafData1.xy);\n    sampleDatas[1].megatextureIndex = normU8x2_toInt(leafData1.zw);\n}\n#endif\n\nOctreeNodeData traverseOctreeDownwards(in vec3 shapePosition, inout TraversalData traversalData) {\n    float sizeAtLevel = 1.0 / pow(2.0, float(traversalData.octreeCoords.w));\n    vec3 start = vec3(traversalData.octreeCoords.xyz) * sizeAtLevel;\n    vec3 end = start + vec3(sizeAtLevel);\n    OctreeNodeData childData;\n\n    for (int i = 0; i < OCTREE_MAX_LEVELS; ++i) {\n        // Find out which octree child contains the position\n        // 0 if before center, 1 if after\n        vec3 center = 0.5 * (start + end);\n        vec3 childCoord = step(center, shapePosition);\n\n        // Get octree coords for the next level down\n        ivec4 octreeCoords = traversalData.octreeCoords;\n        traversalData.octreeCoords = ivec4(octreeCoords.xyz * 2 + ivec3(childCoord), octreeCoords.w + 1);\n\n        childData = getOctreeChildData(traversalData.parentOctreeIndex, ivec3(childCoord));\n\n        if (childData.flag != OCTREE_FLAG_INTERNAL) {\n            // leaf tile - stop traversing\n            break;\n        }\n\n        // interior tile - keep going deeper\n        start = mix(start, center, childCoord);\n        end = mix(center, end, childCoord);\n        traversalData.parentOctreeIndex = childData.data;\n    }\n\n    return childData;\n}\n\n/**\n* Transform a given position to an octree tile coordinate and a position within that tile,\n* and find the corresponding megatexture index and texture coordinates\n*/\nvoid traverseOctreeFromBeginning(in vec3 shapePosition, out TraversalData traversalData, out SampleData sampleDatas[SAMPLE_COUNT]) {\n    traversalData.octreeCoords = ivec4(0);\n    traversalData.parentOctreeIndex = 0;\n\n    OctreeNodeData nodeData = getOctreeNodeData(vec2(0.0));\n    if (nodeData.flag != OCTREE_FLAG_LEAF) {\n        nodeData = traverseOctreeDownwards(shapePosition, traversalData);\n    }\n\n    #if (SAMPLE_COUNT == 1)\n        getOctreeLeafSampleData(nodeData, traversalData.octreeCoords, sampleDatas[0]);\n        sampleDatas[0].tileUv = getTileUv(shapePosition, sampleDatas[0].tileCoords);\n    #else\n        getOctreeLeafSampleDatas(nodeData, traversalData.octreeCoords, sampleDatas);\n        sampleDatas[0].tileUv = getTileUv(shapePosition, sampleDatas[0].tileCoords);\n        sampleDatas[1].tileUv = getTileUv(shapePosition, sampleDatas[1].tileCoords);\n    #endif\n}\n\nbool inRange(in vec3 v, in vec3 minVal, in vec3 maxVal) {\n    return clamp(v, minVal, maxVal) == v;\n}\n\nbool insideTile(in vec3 shapePosition, in ivec4 octreeCoords) {\n    vec3 tileUv = getTileUv(shapePosition, octreeCoords);\n\tbool inside = inRange(tileUv, vec3(0.0), vec3(1.0));\n\t// Assume (!) the position is always inside the root tile.\n\treturn inside || octreeCoords.w == 0;\n}\n\nvoid traverseOctreeFromExisting(in vec3 shapePosition, inout TraversalData traversalData, inout SampleData sampleDatas[SAMPLE_COUNT]) {\n    if (insideTile(shapePosition, traversalData.octreeCoords)) {\n        for (int i = 0; i < SAMPLE_COUNT; i++) {\n            sampleDatas[0].tileUv = getTileUv(shapePosition, sampleDatas[0].tileCoords);\n        }\n        return;\n    }\n\n    // Go up tree until we find a parent tile containing shapePosition\n    for (int i = 0; i < OCTREE_MAX_LEVELS; ++i) {\n        traversalData.octreeCoords.xyz /= 2;\n        traversalData.octreeCoords.w -= 1;\n\n        if (insideTile(shapePosition, traversalData.octreeCoords)) {\n            break;\n        }\n\n        traversalData.parentOctreeIndex = getOctreeParentIndex(traversalData.parentOctreeIndex);\n    }\n\n    // Go down tree\n    OctreeNodeData nodeData = traverseOctreeDownwards(shapePosition, traversalData);\n\n    #if (SAMPLE_COUNT == 1)\n        getOctreeLeafSampleData(nodeData, traversalData.octreeCoords, sampleDatas[0]);\n        sampleDatas[0].tileUv = getTileUv(shapePosition, sampleDatas[0].tileCoords);\n    #else\n        getOctreeLeafSampleDatas(nodeData, traversalData.octreeCoords, sampleDatas);\n        sampleDatas[0].tileUv = getTileUv(shapePosition, sampleDatas[0].tileCoords);\n        sampleDatas[1].tileUv = getTileUv(shapePosition, sampleDatas[1].tileCoords);\n    #endif\n}\n",XL="// See Octree.glsl for the definitions of SampleData and intMod\n\n/* Megatexture defines (set in Scene/VoxelRenderResources.js)\n#define SAMPLE_COUNT ###\n#define NEAREST_SAMPLING\n#define PADDING\n*/\n\nuniform ivec2 u_megatextureSliceDimensions; // number of slices per tile, in two dimensions\nuniform ivec2 u_megatextureTileDimensions; // number of tiles per megatexture, in two dimensions\nuniform vec2 u_megatextureVoxelSizeUv;\nuniform vec2 u_megatextureSliceSizeUv;\nuniform vec2 u_megatextureTileSizeUv;\n\nuniform ivec3 u_dimensions; // does not include padding\n#if defined(PADDING)\n    uniform ivec3 u_paddingBefore;\n    uniform ivec3 u_paddingAfter;\n#endif\n\n// Integer min, max, clamp: For WebGL1 only\nint intMin(int a, int b) {\n    return a <= b ? a : b;\n}\nint intMax(int a, int b) {\n    return a >= b ? a : b;\n}\nint intClamp(int v, int minVal, int maxVal) {\n    return intMin(intMax(v, minVal), maxVal);\n}\n\nvec2 index1DTo2DTexcoord(int index, ivec2 dimensions, vec2 uvScale)\n{\n    int indexX = intMod(index, dimensions.x);\n    int indexY = index / dimensions.x;\n    return vec2(indexX, indexY) * uvScale;\n}\n\n/*\n    How is 3D data stored in a 2D megatexture?\n\n    In this example there is only one loaded tile and it has 2x2x2 voxels (8 voxels total).\n    The data is sliced by Z. The data at Z = 0 is placed in texels (0,0), (0,1), (1,0), (1,1) and\n    the data at Z = 1 is placed in texels (2,0), (2,1), (3,0), (3,1).\n    Note that there could be empty space in the megatexture because it's a power of two.\n\n      0   1   2   3\n    +---+---+---+---+\n    |   |   |   |   | 3\n    +---+---+---+---+\n    |   |   |   |   | 2\n    +-------+-------+\n    |010|110|011|111| 1\n    |--- ---|--- ---|\n    |000|100|001|101| 0\n    +-------+-------+\n\n    When doing linear interpolation the megatexture needs to be sampled twice: once for\n    the Z slice above the voxel coordinate and once for the slice below. The two slices\n    are interpolated with fract(coord.z - 0.5). For example, a Z coordinate of 1.0 is\n    halfway between two Z slices so the interpolation factor is 0.5. Below is a side view\n    of the 3D voxel grid with voxel coordinates on the left side.\n\n    2 +---+\n      |001|\n    1 +-z-+\n      |000|\n    0 +---+\n\n    When doing nearest neighbor the megatexture only needs to be sampled once at the closest Z slice.\n*/\n\nProperties getPropertiesFromMegatexture(in SampleData sampleData) {\n    vec3 tileUv = clamp(sampleData.tileUv, vec3(0.0), vec3(1.0)); // TODO is the clamp necessary?\n    int tileIndex = sampleData.megatextureIndex;\n    vec3 voxelCoord = tileUv * vec3(u_dimensions);\n    ivec3 voxelDimensions = u_dimensions;\n\n    #if defined(PADDING)\n        voxelDimensions += u_paddingBefore + u_paddingAfter;\n        voxelCoord += vec3(u_paddingBefore);\n    #endif\n\n    #if defined(NEAREST_SAMPLING)\n        // Round to the center of the nearest voxel\n        voxelCoord = floor(voxelCoord) + vec3(0.5);\n    #endif\n\n    // Tile location\n    vec2 tileUvOffset = index1DTo2DTexcoord(tileIndex, u_megatextureTileDimensions, u_megatextureTileSizeUv);\n\n    // Slice location\n    float slice = voxelCoord.z - 0.5;\n    int sliceIndex = int(floor(slice));\n    int sliceIndex0 = intClamp(sliceIndex, 0, voxelDimensions.z - 1);\n    vec2 sliceUvOffset0 = index1DTo2DTexcoord(sliceIndex0, u_megatextureSliceDimensions, u_megatextureSliceSizeUv);\n\n    // Voxel location\n    vec2 voxelUvOffset = clamp(voxelCoord.xy, vec2(0.5), vec2(voxelDimensions.xy) - vec2(0.5)) * u_megatextureVoxelSizeUv;\n\n    // Final location in the megatexture\n    vec2 uv0 = tileUvOffset + sliceUvOffset0 + voxelUvOffset;\n\n    #if defined(NEAREST_SAMPLING)\n        return getPropertiesFromMegatextureAtUv(uv0);\n    #else\n        float sliceLerp = fract(slice);\n        int sliceIndex1 = intMin(sliceIndex + 1, voxelDimensions.z - 1);\n        vec2 sliceUvOffset1 = index1DTo2DTexcoord(sliceIndex1, u_megatextureSliceDimensions, u_megatextureSliceSizeUv);\n        vec2 uv1 = tileUvOffset + sliceUvOffset1 + voxelUvOffset;\n        Properties properties0 = getPropertiesFromMegatextureAtUv(uv0);\n        Properties properties1 = getPropertiesFromMegatextureAtUv(uv1);\n        return mixProperties(properties0, properties1, sliceLerp);\n    #endif\n}\n\n// Convert an array of sample datas to a final weighted properties.\nProperties accumulatePropertiesFromMegatexture(in SampleData sampleDatas[SAMPLE_COUNT]) {\n    #if (SAMPLE_COUNT == 1)\n        return getPropertiesFromMegatexture(sampleDatas[0]);\n    #else\n        // When more than one sample is taken the accumulator needs to start at 0\n        Properties properties = clearProperties();\n        for (int i = 0; i < SAMPLE_COUNT; ++i) {\n            float weight = sampleDatas[i].weight;\n\n            // Avoid reading the megatexture when the weight is 0 as it can be costly.\n            if (weight > 0.0) {\n                Properties tempProperties = getPropertiesFromMegatexture(sampleDatas[i]);\n                tempProperties = scaleProperties(tempProperties, weight);\n                properties = sumProperties(properties, tempProperties);\n            }\n        }\n        return properties;\n    #endif\n}\n";function vFe(e){let t=new aA;this.shaderBuilder=t;let i=e._customShader,n=gt(e._uniformMap,i.uniformMap);e._uniformMap=n;let r=i.uniforms;for(let e in r)if(r.hasOwnProperty(e)){let i=r[e];t.addUniform(i.type,e,Ce.FRAGMENT)}t.addUniform("sampler2D","u_megatextureTextures[METADATA_COUNT]",Ce.FRAGMENT),this.uniformMap=n;let o=e._clippingPlanes,a=u(o)&&o.enabled?o.length:0;this.clippingPlanes=o,this.clippingPlanesLength=a,t.addVertexLines([BL]),t.addFragmentLines([i.fragmentShaderText,"#line 0",YL,kL,XL]),a>0&&(t.addDefine("CLIPPING_PLANES",void 0,Ce.FRAGMENT),t.addDefine("CLIPPING_PLANES_COUNT",a,Ce.FRAGMENT),o.unionClippingRegions&&t.addDefine("CLIPPING_PLANES_UNION",void 0,Ce.FRAGMENT),t.addFragmentLines([UL])),e._depthTest&&(t.addDefine("DEPTH_TEST",void 0,Ce.FRAGMENT),t.addFragmentLines([VL]));let s=e._provider.shape;"BOX"===s?(t.addDefine("SHAPE_BOX",void 0,Ce.FRAGMENT),t.addFragmentLines([WL,zL,cA])):"CYLINDER"===s?t.addFragmentLines([HL,cA,jL]):"ELLIPSOID"===s&&t.addFragmentLines([GL,cA,qL]),t.addFragmentLines([FL]);let l=e._shape,c=l.shaderDefines;for(let e in c)if(c.hasOwnProperty(e)){let i=c[e];u(i)&&(i=!0===i?void 0:i,t.addDefine(e,i,Ce.FRAGMENT))}let d=l.shaderMaximumIntersectionsLength;a>0&&(t.addDefine("CLIPPING_PLANES_INTERSECTION_INDEX",d,Ce.FRAGMENT),1===a?d+=1:o.unionClippingRegions?d+=2:d+=1),e._depthTest&&(t.addDefine("DEPTH_INTERSECTION_INDEX",d,Ce.FRAGMENT),d+=1),t.addDefine("INTERSECTION_COUNT",d,Ce.FRAGMENT),(!h.equals(e.paddingBefore,h.ZERO)||!h.equals(e.paddingAfter,h.ZERO))&&t.addDefine("PADDING",void 0,Ce.FRAGMENT),e._useLogDepth&&t.addDefine("LOG_DEPTH_READ_ONLY",void 0,Ce.FRAGMENT),e._jitter&&t.addDefine("JITTER",void 0,Ce.FRAGMENT),e._nearestSampling&&t.addDefine("NEAREST_SAMPLING",void 0,Ce.FRAGMENT);let p=e._traversal;t.addDefine("SAMPLE_COUNT",`${p._sampleCount}`,Ce.FRAGMENT)}var KL=vFe,Do={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4",BOOLEAN:"BOOLEAN",STRING:"STRING",ENUM:"ENUM",isVectorType:function(e){switch(e){case Do.VEC2:case Do.VEC3:case Do.VEC4:return!0;default:return!1}},isMatrixType:function(e){switch(e){case Do.MAT2:case Do.MAT3:case Do.MAT4:return!0;default:return!1}},getComponentCount:function(e){switch(e){case Do.SCALAR:case Do.STRING:case Do.ENUM:case Do.BOOLEAN:return 1;case Do.VEC2:return 2;case Do.VEC3:return 3;case Do.VEC4:case Do.MAT2:return 4;case Do.MAT3:return 9;case Do.MAT4:return 16}},getMathType:function(e){switch(e){case Do.VEC2:return U;case Do.VEC3:return h;case Do.VEC4:return oe;case Do.MAT2:return Ji;case Do.MAT3:return $;case Do.MAT4:return L;default:return}}},Gt=Object.freeze(Do);function DFe(e,t){let{shaderBuilder:i}=e,{names:n,types:r,componentTypes:o,minimumValues:a,maximumValues:s}=t._provider,l=r.length,c=u(a)&&u(s);i.addDefine("METADATA_COUNT",l,Ce.FRAGMENT),c&&i.addDefine("STATISTICS",void 0,Ce.FRAGMENT);for(let e=0;e<l;e++){let t=n[e],o=r[e],a=`PropertyStatistics_${t}`,s=`PropertyStatistics_${t}`;i.addStruct(a,s,Ce.FRAGMENT);let l=ZL(o);i.addStructField(a,l,"min"),i.addStructField(a,l,"max")}let h="Statistics",d="Statistics",p="statistics";i.addStruct(h,d,Ce.FRAGMENT);for(let e=0;e<l;e++){let t=n[e],r=`PropertyStatistics_${t}`,o=t;i.addStructField(h,r,o)}let f="Metadata",m="Metadata",_="metadata";i.addStruct(f,m,Ce.FRAGMENT),i.addStructField(f,d,p);for(let e=0;e<l;e++){let t=n[e],o=ZL(r[e]);i.addStructField(f,o,t)}for(let e=0;e<l;e++){let t=n[e],o=PFe(r[e]),a=`VoxelProperty_${t}`,s=`VoxelProperty_${t}`;i.addStruct(a,s,Ce.FRAGMENT),i.addStructField(a,o,"partialDerivativeLocal"),i.addStructField(a,o,"partialDerivativeWorld"),i.addStructField(a,o,"partialDerivativeView"),i.addStructField(a,o,"partialDerivativeValid")}let g="Voxel",y="Voxel";i.addStruct(g,y,Ce.FRAGMENT);for(let e=0;e<l;e++){let t=n[e],r=`VoxelProperty_${t}`;i.addStructField(g,r,t)}i.addStructField(g,"vec3","positionEC"),i.addStructField(g,"vec3","positionUv"),i.addStructField(g,"vec3","positionShapeUv"),i.addStructField(g,"vec3","positionUvLocal"),i.addStructField(g,"vec3","viewDirUv"),i.addStructField(g,"vec3","viewDirWorld"),i.addStructField(g,"vec3","surfaceNormal"),i.addStructField(g,"float","travelDistance");let v="FragmentInput";i.addStruct(v,"FragmentInput",Ce.FRAGMENT),i.addStructField(v,m,_),i.addStructField(v,y,"voxel");let b="Properties",A="Properties",T="properties";i.addStruct(b,A,Ce.FRAGMENT);for(let e=0;e<l;e++){let t=n[e],o=ZL(r[e]);i.addStructField(b,o,t)}{let e="clearProperties";i.addFunction(e,`${A} clearProperties()`,Ce.FRAGMENT),i.addFunctionLines(e,[`${A} ${T};`]);for(let t=0;t<l;t++){let a=n[t],s=ZL(r[t],o[t]);i.addFunctionLines(e,[`${T}.${a} = ${s}(0.0);`])}i.addFunctionLines(e,[`return ${T};`])}{let e="sumProperties";i.addFunction(e,`${A} sumProperties(${A} propertiesA, ${A} propertiesB)`,Ce.FRAGMENT),i.addFunctionLines(e,[`${A} ${T};`]);for(let t=0;t<l;t++){let r=n[t];i.addFunctionLines(e,[`${T}.${r} = propertiesA.${r} + propertiesB.${r};`])}i.addFunctionLines(e,[`return ${T};`])}{let e="scaleProperties";i.addFunction(e,`${A} scaleProperties(${A} ${T}, float scale)`,Ce.FRAGMENT),i.addFunctionLines(e,[`${A} scaledProperties = ${T};`]);for(let t=0;t<l;t++){let r=n[t];i.addFunctionLines(e,[`scaledProperties.${r} *= scale;`])}i.addFunctionLines(e,["return scaledProperties;"])}{let e="mixProperties";i.addFunction(e,`${A} mixProperties(${A} propertiesA, ${A} propertiesB, float mixFactor)`,Ce.FRAGMENT),i.addFunctionLines(e,[`${A} ${T};`]);for(let t=0;t<l;t++){let r=n[t];i.addFunctionLines(e,[`${T}.${r} = mix(propertiesA.${r}, propertiesB.${r}, mixFactor);`])}i.addFunctionLines(e,[`return ${T};`])}{let e="copyPropertiesToMetadata";i.addFunction(e,`void copyPropertiesToMetadata(in ${A} ${T}, inout ${m} ${_})`,Ce.FRAGMENT);for(let t=0;t<l;t++){let r=n[t];i.addFunctionLines(e,[`${_}.${r} = ${T}.${r};`])}}if(c){let e="setStatistics";i.addFunction(e,`void setStatistics(inout ${d} ${p})`,Ce.FRAGMENT);for(let t=0;t<l;t++){let o=n[t],l=r[t],u=Gt.getComponentCount(l);for(let n=0;n<u;n++){let r=OFe(l,n),u=a[t][n],c=s[t][n];i.addFunctionLines(e,[`${p}.${o}.min${r} = ${Woe(u)};`,`${p}.${o}.max${r} = ${Woe(c)};`])}}}{let e="getPropertiesFromMegatextureAtUv";i.addFunction(e,`${A} getPropertiesFromMegatextureAtUv(vec2 texcoord)`,Ce.FRAGMENT),i.addFunctionLines(e,[`${A} ${T};`]);for(let t=0;t<l;t++){let a=n[t],s=IFe(r[t],o[t]);i.addFunctionLines(e,[`properties.${a} = texture(u_megatextureTextures[${t}], texcoord)${s};`])}i.addFunctionLines(e,[`return ${T};`])}}function ZL(e){return e===Gt.SCALAR?"float":e===Gt.VEC2?"vec2":e===Gt.VEC3?"vec3":e===Gt.VEC4?"vec4":void 0}function IFe(e){return e===Gt.SCALAR?".r":e===Gt.VEC2?".ra":e===Gt.VEC3?".rgb":e===Gt.VEC4?"":void 0}function PFe(e){return e===Gt.SCALAR?"vec3":e===Gt.VEC2?"mat2":e===Gt.VEC3?"mat3":e===Gt.VEC4?"mat4":void 0}function Woe(e){let t=e.toString();return-1===t.indexOf(".")&&(t=`${e}.0`),t}function OFe(e,t){return e===Gt.SCALAR?"":`[${t}]`}var $L=DFe;function RFe(e,t){let i=new KL(e);$L(i,e);let{shaderBuilder:n,clippingPlanes:r,clippingPlanesLength:o}=i;if(o>0){let e="getClippingPlane",i=og(r,t),o=0,a=i.indexOf(")")+1,s=i.indexOf("{",a)+1,l=i.indexOf("}",s),u=i.slice(o,a),c=i.slice(s,l);n.addFunction(e,u,Ce.FRAGMENT),n.addFunctionLines(e,[c])}let a=n.clone();a.addDefine("PICKING",void 0,Ce.FRAGMENT);let s=n.buildShaderProgram(t),l=a.buildShaderProgram(t),c=Ue.fromCache({cull:{enabled:!0,face:gi.BACK},depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND}),h=t.getViewportQuadVertexArray(),d=e._depthTest,p=new et({vertexArray:h,primitiveType:Ne.TRIANGLES,renderState:c,shaderProgram:s,uniformMap:i.uniformMap,modelMatrix:e._compoundModelMatrix,pass:Ee.VOXELS,executeInClosestFrustum:!0,owner:this,cull:d,occlude:d}),f=et.shallowClone(p,new et);if(f.shaderProgram=l,f.pickOnly=!0,u(e._drawCommand)){let t=e._drawCommand;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}if(u(e._drawCommandPick)){let t=e._drawCommandPick;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}e._drawCommand=p,e._drawCommandPick=f}var QL=RFe,Xoe={};function MFe(e,t,i){let n,r,o;if(e instanceof Ei){let a=Math.tan(.5*e.fovy);return n=e.near,r=e.near*a,o=e.aspectRatio*r,Math.max(t*n/o,i*n/r)}return e instanceof $c?(n=e.near,r=e.top,o=e.right,Math.max(t*n/o,i*n/r)):Math.max(t,i)}var LFe=new h,joe=new h;function Koe(e,t,i,n){if(u(n)&&i(.5)>n){let n=i(0),r=i(1),o=i(.5),a=o-n,s=o-r;return function(o){let l=i(o);if(o<=.5){let t=(l-n)/a;return P.lerp(e,-P.PI_OVER_TWO,t)}let u=(l-r)/s;return P.lerp(-P.PI_OVER_TWO,t,1-u)}}return function(i){return P.lerp(e,t,i)}}function U6(e,t,i,n,r){let o=r,a=Math.max(i,n);if(!u(o)){let i=e.position,n=t,r=e.up,a=e.right,s=e.frustum,l=h.subtract(i,n,LFe),u=h.magnitude(h.multiplyByScalar(r,h.dot(l,r),joe)),c=h.magnitude(h.multiplyByScalar(a,h.dot(l,a),joe));o=Math.min(.2*MFe(s,u,c),1e9)}if(a<o){let e=-Math.pow(1e6*(o-i),.125),t=Math.pow(1e6*(o-n),1/8);return function(i){let n=i*(t-e)+e;return-Math.pow(n,8)/1e6+o}}return function(e){return P.lerp(i,n,e)}}function fw(e,t){return P.equalsEpsilon(e,P.TWO_PI,P.EPSILON11)&&(e=0),t>e+Math.PI?e+=P.TWO_PI:t<e-Math.PI&&(e-=P.TWO_PI),e}var Zoe=new h;function NFe(e,t,i,n,r,o,a,s){let l=e.camera,u=h.clone(l.position,Zoe),c=l.pitch,d=fw(l.heading,n),p=fw(l.roll,o),f=U6(l,i,u.z,i.z,a),m=Koe(c,r,f,s);return function(e){let r=e.time/t;l.setView({orientation:{heading:P.lerp(d,n,r),pitch:m(r),roll:P.lerp(p,o,r)}}),U.lerp(u,i,r,l.position),l.position.z=f(r)}}function FFe(e,t){e.longitude<t.longitude?e.longitude+=P.TWO_PI:t.longitude+=P.TWO_PI}function BFe(e,t){let i=e.longitude-t.longitude;i<-P.PI?e.longitude+=P.TWO_PI:i>P.PI&&(t.longitude+=P.TWO_PI)}var kFe=new fe,VFe=new fe;function UFe(e,t,i,n,r,o,a,s,l,c){let d=e.camera,p=e.mapProjection.ellipsoid,f=fe.clone(d.positionCartographic,kFe),m=d.pitch,_=fw(d.heading,n),g=fw(d.roll,o),y=p.cartesianToCartographic(i,VFe);f.longitude=P.zeroToTwoPi(f.longitude),y.longitude=P.zeroToTwoPi(y.longitude);let v=!1;if(u(s)){let e=P.zeroToTwoPi(s),t=Math.min(f.longitude,y.longitude),i=Math.max(f.longitude,y.longitude),n=e>=t&&e<=i;if(u(l)){let e=Math.abs(f.longitude-y.longitude),t=P.TWO_PI-e;(n?e:t)<(n?t:e)*l&&!n&&(v=!0)}else n||(v=!0)}v?FFe(f,y):BFe(f,y);let b=U6(d,i,f.height,y.height,a),A=Koe(m,r,b,c);return function(){let e=f.longitude,i=y.longitude,r=f.latitude,a=y.latitude;return function(s){let l=s.time/t,u=h.fromRadians(P.lerp(e,i,l),P.lerp(r,a,l),b(l),p);d.setView({destination:u,orientation:{heading:P.lerp(_,n,l),pitch:A(l),roll:P.lerp(g,o,l)}})}}()}function zFe(e,t,i,n,r,o,a){let s=e.camera,l=h.clone(s.position,Zoe),u=fw(s.heading,n),c=s.frustum.right-s.frustum.left,d=U6(s,i,c,i.z,a);return function(e){let r=e.time/t;s.setView({orientation:{heading:P.lerp(u,n,r)}}),U.lerp(l,i,r,s.position);let o=d(r),a=s.frustum,c=a.top/a.right,h=.5*(o-(a.right-a.left));a.right+=h,a.left-=h,a.top=c*a.right,a.bottom=-a.top}}var qoe=new fe,HFe=new h;function V6(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function Yoe(e,t){return function(){"function"==typeof t&&t(),e.enableInputs=!0}}Xoe.createTween=function(e,t){let i=(t=y(t,y.EMPTY_OBJECT)).destination,n=e.mode;if(n===te.MORPHING)return V6();let r=y(t.convert,!0),o=e.mapProjection,a=o.ellipsoid,s=t.maximumHeight,l=t.flyOverLongitude,c=t.flyOverLongitudeWeight,d=t.pitchAdjustHeight,p=t.easingFunction;r&&n!==te.SCENE3D&&(a.cartesianToCartographic(i,qoe),i=o.project(qoe,HFe));let f=e.camera,m=t.endTransform;u(m)&&f._setTransform(m);let _=t.duration;u(_)||(_=Math.ceil(h.distance(f.position,i)/1e6)+2,_=Math.min(_,3));let g=y(t.heading,0),v=y(t.pitch,-P.PI_OVER_TWO),b=y(t.roll,0),A=e.screenSpaceCameraController;A.enableInputs=!1;let T=Yoe(A,t.complete),E=Yoe(A,t.cancel),C=f.frustum,x=e.mode===te.SCENE2D;if(x=x&&U.equalsEpsilon(f.position,i,P.EPSILON6),x=x&&P.equalsEpsilon(Math.max(C.right-C.left,C.top-C.bottom),i.z,P.EPSILON6),x=x||e.mode!==te.SCENE2D&&h.equalsEpsilon(i,f.position,P.EPSILON10),x=x&&P.equalsEpsilon(P.negativePiToPi(g),P.negativePiToPi(f.heading),P.EPSILON10)&&P.equalsEpsilon(P.negativePiToPi(v),P.negativePiToPi(f.pitch),P.EPSILON10)&&P.equalsEpsilon(P.negativePiToPi(b),P.negativePiToPi(f.roll),P.EPSILON10),x)return V6(T,E);let S=new Array(4);if(S[te.SCENE2D]=zFe,S[te.SCENE3D]=UFe,S[te.COLUMBUS_VIEW]=NFe,_<=0)return V6((function(){S[n](e,1,i,g,v,b,s,l,c,d)({time:1}),"function"==typeof T&&T()}),E);let w=S[n](e,_,i,g,v,b,s,l,c,d);if(!u(p)){let e=f.positionCartographic.height;p=e>(n===te.SCENE3D?a.cartesianToCartographic(i).height:i.z)&&e>11500?Ir.CUBIC_OUT:Ir.QUINTIC_IN_OUT}return{duration:_,easingFunction:p,startObject:{time:0},stopObject:{time:_},update:w,complete:T,cancel:E}};var JL=Xoe,GFe={ROTATE:0,INFINITE_SCROLL:1},kl=Object.freeze(GFe);function Xt(e){this._scene=e,this._transform=L.clone(L.IDENTITY),this._invTransform=L.clone(L.IDENTITY),this._actualTransform=L.clone(L.IDENTITY),this._actualInvTransform=L.clone(L.IDENTITY),this._transformChanged=!1,this.position=new h,this._position=new h,this._positionWC=new h,this._positionCartographic=new fe,this._oldPositionWC=void 0,this.positionWCDeltaMagnitude=0,this.positionWCDeltaMagnitudeLastFrame=0,this.timeSinceMoved=0,this._lastMovedTimestamp=0,this.direction=new h,this._direction=new h,this._directionWC=new h,this.up=new h,this._up=new h,this._upWC=new h,this.right=new h,this._right=new h,this._rightWC=new h,this.frustum=new Ei,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=P.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new pe,this._moveEnd=new pe,this._changed=new pe,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this._changedHeading=void 0,this.percentageChanged=.5,this._viewMatrix=new L,this._invViewMatrix=new L,ore(this),this._mode=te.SCENE3D,this._modeChanged=!0;let t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new fe(Math.PI,P.PI_OVER_TWO)),this._max2Dfrustum=void 0,_re(this,Xt.DEFAULT_VIEW_RECTANGLE,this.position,!0);let i=h.magnitude(this.position);i+=i*Xt.DEFAULT_VIEW_FACTOR,h.normalize(this.position,this.position),h.multiplyByScalar(this.position,i,this.position)}function ore(e){L.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),L.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),L.inverseTransformation(e._viewMatrix,e._invViewMatrix)}function WFe(e){if(u(e._oldPositionWC)){e.positionWCDeltaMagnitudeLastFrame=e.positionWCDeltaMagnitude;let t=h.subtract(e.positionWC,e._oldPositionWC,e._oldPositionWC);e.positionWCDeltaMagnitude=h.magnitude(t),e._oldPositionWC=h.clone(e.positionWC,e._oldPositionWC),e.positionWCDeltaMagnitude>0?(e.timeSinceMoved=0,e._lastMovedTimestamp=_i()):e.timeSinceMoved=Math.max(_i()-e._lastMovedTimestamp,0)/1e3}else e._oldPositionWC=h.clone(e.positionWC,e._oldPositionWC)}function jFe(e){Rt.basisTo2D(e._projection,e._transform,e._actualTransform)}Xt.TRANSFORM_2D=new L(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),Xt.TRANSFORM_2D_INVERSE=L.inverseTransformation(Xt.TRANSFORM_2D,new L),Xt.DEFAULT_VIEW_RECTANGLE=ce.fromDegrees(-95,-20,-70,90),Xt.DEFAULT_VIEW_FACTOR=.5,Xt.DEFAULT_OFFSET=new qf(0,-P.PI_OVER_FOUR,0),Xt.prototype.canPreloadFlight=function(){return u(this._currentFlight)&&this._mode!==te.SCENE2D},Xt.prototype._updateCameraChanged=function(){let e=this;if(WFe(e),0===e._changed.numberOfListeners)return;let t=e.percentageChanged,i=e.heading;u(e._changedHeading)||(e._changedHeading=i);let n=Math.abs(e._changedHeading-i)%P.TWO_PI;n=n>P.PI?P.TWO_PI-n:n;let r=n/Math.PI;if(r>t&&(e._changed.raiseEvent(r),e._changedHeading=i),e._mode===te.SCENE2D){if(!u(e._changedFrustum))return e._changedPosition=h.clone(e.position,e._changedPosition),void(e._changedFrustum=e.frustum.clone());let i,n=e.position,r=e._changedPosition,o=e.frustum,a=e._changedFrustum,s=n.x+o.left,l=n.x+o.right,c=r.x+a.left,d=r.x+a.right,p=n.y+o.bottom,f=n.y+o.top,m=r.y+a.bottom,_=r.y+a.top,g=Math.max(s,c),y=Math.min(l,d),v=Math.max(p,m),b=Math.min(f,_);if(g>=y||v>=f)i=1;else{let e=a;s<c&&l>d&&p<m&&f>_&&(e=o),i=1-(y-g)*(b-v)/((e.right-e.left)*(e.top-e.bottom))}return void(i>t&&(e._changed.raiseEvent(i),e._changedPosition=h.clone(e.position,e._changedPosition),e._changedFrustum=e.frustum.clone(e._changedFrustum)))}if(!u(e._changedDirection))return e._changedPosition=h.clone(e.positionWC,e._changedPosition),void(e._changedDirection=h.clone(e.directionWC,e._changedDirection));let o,a=P.acosClamped(h.dot(e.directionWC,e._changedDirection));o=u(e.frustum.fovy)?a/(.5*e.frustum.fovy):a;let s=h.distance(e.positionWC,e._changedPosition)/e.positionCartographic.height;(o>t||s>t)&&(e._changed.raiseEvent(Math.max(o,s)),e._changedPosition=h.clone(e.positionWC,e._changedPosition),e._changedDirection=h.clone(e.directionWC,e._changedDirection))};var qFe=new fe,YFe=new h,eN=new h,XFe=new oe,KFe=new oe,ZFe=new oe,$Fe=new oe,QFe=new oe;function JFe(e){let t=e._projection,i=t.ellipsoid,n=L.getColumn(e._transform,3,XFe),r=i.cartesianToCartographic(n,qFe),o=t.project(r,YFe),a=KFe;a.x=o.z,a.y=o.x,a.z=o.y,a.w=1;let s=oe.clone(oe.UNIT_X,QFe),l=oe.add(L.getColumn(e._transform,0,eN),n,eN);i.cartesianToCartographic(l,r),t.project(r,o);let u=ZFe;u.x=o.z,u.y=o.x,u.z=o.y,u.w=0,h.subtract(u,a,u),u.x=0;let c=$Fe;if(h.magnitudeSquared(u)>P.EPSILON10)h.cross(s,u,c);else{let s=oe.add(L.getColumn(e._transform,1,eN),n,eN);i.cartesianToCartographic(s,r),t.project(r,o),c.x=o.z,c.y=o.x,c.z=o.y,c.w=0,h.subtract(c,a,c),c.x=0,h.magnitudeSquared(c)<P.EPSILON10&&(oe.clone(oe.UNIT_Y,u),oe.clone(oe.UNIT_Z,c))}h.cross(c,s,u),h.normalize(u,u),h.cross(s,u,c),h.normalize(c,c),L.setColumn(e._actualTransform,0,u,e._actualTransform),L.setColumn(e._actualTransform,1,c,e._actualTransform),L.setColumn(e._actualTransform,2,s,e._actualTransform),L.setColumn(e._actualTransform,3,a,e._actualTransform)}var z6=new h;function Ua(e){let t=e._mode,i=!1,n=0;t===te.SCENE2D&&(n=e.frustum.right-e.frustum.left,i=n!==e._positionCartographic.height);let r=e._position,o=!h.equals(r,e.position)||i;o&&(r=h.clone(e.position,e._position));let a=e._direction,s=!h.equals(a,e.direction);s&&(h.normalize(e.direction,e.direction),a=h.clone(e.direction,e._direction));let l=e._up,u=!h.equals(l,e.up);u&&(h.normalize(e.up,e.up),l=h.clone(e.up,e._up));let c=e._right,d=!h.equals(c,e.right);d&&(h.normalize(e.right,e.right),c=h.clone(e.right,e._right));let p=e._transformChanged||e._modeChanged;e._transformChanged=!1,p&&(L.inverseTransformation(e._transform,e._invTransform),e._mode===te.COLUMBUS_VIEW||e._mode===te.SCENE2D?L.equals(L.IDENTITY,e._transform)?L.clone(Xt.TRANSFORM_2D,e._actualTransform):e._mode===te.COLUMBUS_VIEW?jFe(e):JFe(e):L.clone(e._transform,e._actualTransform),L.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);let f=e._actualTransform;if(o||p)if(e._positionWC=L.multiplyByPoint(f,r,e._positionWC),t===te.SCENE3D||t===te.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{let i=z6;i.x=e._positionWC.y,i.y=e._positionWC.z,i.z=e._positionWC.x,t===te.SCENE2D&&(i.z=n),e._projection.unproject(i,e._positionCartographic)}if(s||u||d){let t=h.dot(a,h.cross(l,c,z6));if(Math.abs(1-t)>P.EPSILON2){let t=1/h.magnitudeSquared(l),i=h.dot(l,a)*t,n=h.multiplyByScalar(a,i,z6);l=h.normalize(h.subtract(l,n,e._up),e._up),h.clone(l,e.up),c=h.cross(a,l,e._right),h.clone(c,e.right)}}(s||p)&&(e._directionWC=L.multiplyByPointAsVector(f,a,e._directionWC),h.normalize(e._directionWC,e._directionWC)),(u||p)&&(e._upWC=L.multiplyByPointAsVector(f,l,e._upWC),h.normalize(e._upWC,e._upWC)),(d||p)&&(e._rightWC=L.multiplyByPointAsVector(f,c,e._rightWC),h.normalize(e._rightWC,e._rightWC)),(o||s||u||d||p)&&ore(e)}function rre(e,t){let i;return i=P.equalsEpsilon(Math.abs(e.z),1,P.EPSILON3)?Math.atan2(t.y,t.x)-P.PI_OVER_TWO:Math.atan2(e.y,e.x)-P.PI_OVER_TWO,P.TWO_PI-P.zeroToTwoPi(i)}function sre(e){return P.PI_OVER_TWO-P.acosClamped(e.z)}function are(e,t,i){let n=0;return P.equalsEpsilon(Math.abs(e.z),1,P.EPSILON3)||(n=Math.atan2(-i.z,t.z),n=P.zeroToTwoPi(n+P.TWO_PI)),n}var iN=new L,oN=new L;Object.defineProperties(Xt.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return Ua(this),this._invTransform}},viewMatrix:{get:function(){return Ua(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return Ua(this),this._invViewMatrix}},positionCartographic:{get:function(){return Ua(this),this._positionCartographic}},positionWC:{get:function(){return Ua(this),this._positionWC}},directionWC:{get:function(){return Ua(this),this._directionWC}},upWC:{get:function(){return Ua(this),this._upWC}},rightWC:{get:function(){return Ua(this),this._rightWC}},heading:{get:function(){if(this._mode!==te.MORPHING){let e=this._projection.ellipsoid,t=L.clone(this._transform,iN),i=Rt.eastNorthUpToFixedFrame(this.positionWC,e,oN);this._setTransform(i);let n=rre(this.direction,this.up);return this._setTransform(t),n}}},pitch:{get:function(){if(this._mode!==te.MORPHING){let e=this._projection.ellipsoid,t=L.clone(this._transform,iN),i=Rt.eastNorthUpToFixedFrame(this.positionWC,e,oN);this._setTransform(i);let n=sre(this.direction);return this._setTransform(t),n}}},roll:{get:function(){if(this._mode!==te.MORPHING){let e=this._projection.ellipsoid,t=L.clone(this._transform,iN),i=Rt.eastNorthUpToFixedFrame(this.positionWC,e,oN);this._setTransform(i);let n=are(this.direction,this.up,this.right);return this._setTransform(t),n}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),Xt.prototype.update=function(e){let t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==te.MORPHING,t=this._mode===te.SCENE2D),t){let e=this._max2Dfrustum=this.frustum.clone(),t=2,i=e.top/e.right;e.right=this._maxCoord.x*t,e.left=-e.right,e.top=i*e.right,e.bottom=-e.top}this._mode===te.SCENE2D&&fre(this,this.position)};var eBe=new h,tBe=new h,nBe=new h;Xt.prototype._setTransform=function(e){let t=h.clone(this.positionWC,eBe),i=h.clone(this.upWC,tBe),n=h.clone(this.directionWC,nBe);L.clone(e,this._transform),this._transformChanged=!0,Ua(this);let r=this._actualInvTransform;L.multiplyByPoint(r,t,this.position),L.multiplyByPointAsVector(r,n,this.direction),L.multiplyByPointAsVector(r,i,this.up),h.cross(this.direction,this.up,this.right),Ua(this)};var iBe=new U,oBe=new Tn,rBe=new h,sBe=new h;function cre(e){if(!L.equals(L.IDENTITY,e.transform))return h.magnitude(e.position);let t,i,n,r=e._scene,o=r.globe,a=iBe;if(a.x=r.drawingBufferWidth/2,a.y=r.drawingBufferHeight/2,u(o)){let i=e.getPickRay(a,oBe);t=o.pickWorldCoordinates(i,r,!0,rBe)}if(r.pickPositionSupported&&(i=r.pickPositionWorldCoordinates(a,sBe)),u(t)||u(i)){let r=u(i)?h.distance(i,e.positionWC):Number.POSITIVE_INFINITY,o=u(t)?h.distance(t,e.positionWC):Number.POSITIVE_INFINITY;n=Math.min(r,o)}else n=Math.max(e.positionCartographic.height,0);return n}Xt.prototype._adjustOrthographicFrustum=function(e){this.frustum instanceof Qt&&(!e&&this._positionCartographic.height<15e4||(this.frustum.width=cre(this)))};var rN=new h,q6=new L,aBe=new L,Y6=new Le,X6=new $,lre=new fe;function cBe(e,t,i){let n=L.clone(e.transform,q6),r=Rt.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,aBe);e._setTransform(r),h.clone(h.ZERO,e.position),i.heading=i.heading-P.PI_OVER_TWO;let o=Le.fromHeadingPitchRoll(i,Y6),a=$.fromQuaternion(o,X6);$.getColumn(a,0,e.direction),$.getColumn(a,2,e.up),h.cross(e.direction,e.up,e.right),e._setTransform(n),e._adjustOrthographicFrustum(!0)}function lBe(e,t,i,n){let r=L.clone(e.transform,q6);if(e._setTransform(L.IDENTITY),!h.equals(t,e.positionWC)){if(n){let i=e._projection,n=i.ellipsoid.cartesianToCartographic(t,lre);t=i.project(n,rN)}h.clone(t,e.position)}i.heading=i.heading-P.PI_OVER_TWO;let o=Le.fromHeadingPitchRoll(i,Y6),a=$.fromQuaternion(o,X6);$.getColumn(a,0,e.direction),$.getColumn(a,2,e.up),h.cross(e.direction,e.up,e.right),e._setTransform(r),e._adjustOrthographicFrustum(!0)}function uBe(e,t,i,n){let r=L.clone(e.transform,q6);if(e._setTransform(L.IDENTITY),!h.equals(t,e.positionWC)){if(n){let i=e._projection,n=i.ellipsoid.cartesianToCartographic(t,lre);t=i.project(n,rN)}U.clone(t,e.position);let i=.5*-t.z,r=-i,o=e.frustum;if(r>i){let e=o.top/o.right;o.right=r,o.left=i,o.top=o.right*e,o.bottom=-o.top}}if(e._scene.mapMode2D===kl.ROTATE){i.heading=i.heading-P.PI_OVER_TWO,i.pitch=-P.PI_OVER_TWO,i.roll=0;let t=Le.fromHeadingPitchRoll(i,Y6),n=$.fromQuaternion(t,X6);$.getColumn(n,2,e.up),h.cross(e.direction,e.up,e.right)}e._setTransform(r)}var fBe=new h,dBe=new h,hBe=new h;function ure(e,t,i,n){let r=h.clone(i.direction,fBe),o=h.clone(i.up,dBe);if(e._scene.mode===te.SCENE3D){let i=e._projection.ellipsoid,n=Rt.eastNorthUpToFixedFrame(t,i,iN),a=L.inverseTransformation(n,oN);L.multiplyByPointAsVector(a,r,r),L.multiplyByPointAsVector(a,o,o)}let a=h.cross(r,o,hBe);return n.heading=rre(r,o),n.pitch=sre(r),n.roll=are(r,o,a),n}var j6={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},lA=new oc;Xt.prototype.setView=function(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.orientation,y.EMPTY_OBJECT),i=this._mode;if(i===te.MORPHING)return;u(e.endTransform)&&this._setTransform(e.endTransform);let n=y(e.convert,!0),r=y(e.destination,h.clone(this.positionWC,rN));u(r)&&u(r.west)&&(r=this.getRectangleCameraCoordinates(r,rN),n=!1),u(t.direction)&&(t=ure(this,r,t,j6.orientation)),lA.heading=y(t.heading,0),lA.pitch=y(t.pitch,-P.PI_OVER_TWO),lA.roll=y(t.roll,0),i===te.SCENE3D?cBe(this,r,lA):i===te.SCENE2D?uBe(this,r,lA,n):lBe(this,r,lA,n)};var mBe=new h;function fre(e,t){let i,n,r=e._scene.mapMode2D===kl.ROTATE,o=e._maxCoord.x,a=e._maxCoord.y;r?(n=o,i=-n):(n=t.x-2*o,i=t.x+2*o),t.x>o&&(t.x=n),t.x<-o&&(t.x=i),t.y>a&&(t.y=a),t.y<-a&&(t.y=-a)}Xt.prototype.flyHome=function(e){let t=this._mode;if(t===te.MORPHING&&this._scene.completeMorph(),t===te.SCENE2D)this.flyTo({destination:Xt.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:L.IDENTITY});else if(t===te.SCENE3D){let t=this.getRectangleCameraCoordinates(Xt.DEFAULT_VIEW_RECTANGLE),i=h.magnitude(t);i+=i*Xt.DEFAULT_VIEW_FACTOR,h.normalize(t,t),h.multiplyByScalar(t,i,t),this.flyTo({destination:t,duration:e,endTransform:L.IDENTITY})}else if(t===te.COLUMBUS_VIEW){let t=this._projection.ellipsoid.maximumRadius,i=new h(0,-1,1);i=h.multiplyByScalar(h.normalize(i,i),5*t,i),this.flyTo({destination:i,duration:e,orientation:{heading:0,pitch:-Math.acos(h.normalize(i,mBe).z),roll:0},endTransform:L.IDENTITY,convert:!1})}},Xt.prototype.worldToCameraCoordinates=function(e,t){return u(t)||(t=new oe),Ua(this),L.multiplyByVector(this._actualInvTransform,e,t)},Xt.prototype.worldToCameraCoordinatesPoint=function(e,t){return u(t)||(t=new h),Ua(this),L.multiplyByPoint(this._actualInvTransform,e,t)},Xt.prototype.worldToCameraCoordinatesVector=function(e,t){return u(t)||(t=new h),Ua(this),L.multiplyByPointAsVector(this._actualInvTransform,e,t)},Xt.prototype.cameraToWorldCoordinates=function(e,t){return u(t)||(t=new oe),Ua(this),L.multiplyByVector(this._actualTransform,e,t)},Xt.prototype.cameraToWorldCoordinatesPoint=function(e,t){return u(t)||(t=new h),Ua(this),L.multiplyByPoint(this._actualTransform,e,t)},Xt.prototype.cameraToWorldCoordinatesVector=function(e,t){return u(t)||(t=new h),Ua(this),L.multiplyByPointAsVector(this._actualTransform,e,t)};var $oe=new h;Xt.prototype.move=function(e,t){let i=this.position;h.multiplyByScalar(e,t,$oe),h.add(i,$oe,i),this._mode===te.SCENE2D&&fre(this,i),this._adjustOrthographicFrustum(!0)},Xt.prototype.moveForward=function(e){e=y(e,this.defaultMoveAmount),this._mode===te.SCENE2D?sN(this,e):this.move(this.direction,e)},Xt.prototype.moveBackward=function(e){e=y(e,this.defaultMoveAmount),this._mode===te.SCENE2D?sN(this,-e):this.move(this.direction,-e)},Xt.prototype.moveUp=function(e){e=y(e,this.defaultMoveAmount),this.move(this.up,e)},Xt.prototype.moveDown=function(e){e=y(e,this.defaultMoveAmount),this.move(this.up,-e)},Xt.prototype.moveRight=function(e){e=y(e,this.defaultMoveAmount),this.move(this.right,e)},Xt.prototype.moveLeft=function(e){e=y(e,this.defaultMoveAmount),this.move(this.right,-e)},Xt.prototype.lookLeft=function(e){e=y(e,this.defaultLookAmount),this._mode!==te.SCENE2D&&this.look(this.up,-e)},Xt.prototype.lookRight=function(e){e=y(e,this.defaultLookAmount),this._mode!==te.SCENE2D&&this.look(this.up,e)},Xt.prototype.lookUp=function(e){e=y(e,this.defaultLookAmount),this._mode!==te.SCENE2D&&this.look(this.right,-e)},Xt.prototype.lookDown=function(e){e=y(e,this.defaultLookAmount),this._mode!==te.SCENE2D&&this.look(this.right,e)};var pBe=new Le,_Be=new $;Xt.prototype.look=function(e,t){let i=y(t,this.defaultLookAmount),n=Le.fromAxisAngle(e,-i,pBe),r=$.fromQuaternion(n,_Be),o=this.direction,a=this.up,s=this.right;$.multiplyByVector(r,o,o),$.multiplyByVector(r,a,a),$.multiplyByVector(r,s,s)},Xt.prototype.twistLeft=function(e){e=y(e,this.defaultLookAmount),this.look(this.direction,e)},Xt.prototype.twistRight=function(e){e=y(e,this.defaultLookAmount),this.look(this.direction,-e)};var gBe=new Le,yBe=new $;Xt.prototype.rotate=function(e,t){let i=y(t,this.defaultRotateAmount),n=Le.fromAxisAngle(e,-i,gBe),r=$.fromQuaternion(n,yBe);$.multiplyByVector(r,this.position,this.position),$.multiplyByVector(r,this.direction,this.direction),$.multiplyByVector(r,this.up,this.up),h.cross(this.direction,this.up,this.right),h.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},Xt.prototype.rotateDown=function(e){dre(this,e=y(e,this.defaultRotateAmount))},Xt.prototype.rotateUp=function(e){dre(this,-(e=y(e,this.defaultRotateAmount)))};var xBe=new h,bBe=new h,TBe=new h,Qoe=new h;function dre(e,t){let i=e.position;if(u(e.constrainedAxis)&&!h.equalsEpsilon(e.position,h.ZERO,P.EPSILON2)){let n=h.normalize(i,xBe),r=h.equalsEpsilon(n,e.constrainedAxis,P.EPSILON2),o=h.equalsEpsilon(n,h.negate(e.constrainedAxis,Qoe),P.EPSILON2);if(r||o)(r&&t<0||o&&t>0)&&e.rotate(e.right,t);else{let i=h.normalize(e.constrainedAxis,bBe),r=h.dot(n,i),o=P.acosClamped(r);t>0&&t>o&&(t=o-P.EPSILON4),r=h.dot(n,h.negate(i,Qoe)),o=P.acosClamped(r),t<0&&-t>o&&(t=-o+P.EPSILON4);let a=h.cross(i,n,TBe);e.rotate(a,t)}}else e.rotate(e.right,t)}function hre(e,t){u(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function sN(e,t){let i,n=e.frustum;if(t*=.5,Math.abs(n.top)+Math.abs(n.bottom)>Math.abs(n.left)+Math.abs(n.right)){let r=n.top-t,o=n.bottom+t,a=e._maxCoord.y;e._scene.mapMode2D===kl.ROTATE&&(a*=e.maximumZoomFactor),o>a&&(o=a,r=-a),r<=o&&(r=1,o=-1),i=n.right/n.top,n.top=r,n.bottom=o,n.right=n.top*i,n.left=-n.right}else{let r=n.right-t,o=n.left+t,a=e._maxCoord.x;e._scene.mapMode2D===kl.ROTATE&&(a*=e.maximumZoomFactor),r>a&&(r=a,o=-a),r<=o&&(r=1,o=-1),i=n.top/n.right,n.right=r,n.left=o,n.top=n.right*i,n.bottom=-n.top}}function mre(e,t){e.move(e.direction,t)}Xt.prototype.rotateRight=function(e){hre(this,-(e=y(e,this.defaultRotateAmount)))},Xt.prototype.rotateLeft=function(e){hre(this,e=y(e,this.defaultRotateAmount))},Xt.prototype.zoomIn=function(e){e=y(e,this.defaultZoomAmount),this._mode===te.SCENE2D?sN(this,e):mre(this,e)},Xt.prototype.zoomOut=function(e){e=y(e,this.defaultZoomAmount),this._mode===te.SCENE2D?sN(this,-e):mre(this,-e)},Xt.prototype.getMagnitude=function(){return this._mode===te.SCENE3D?h.magnitude(this.position):this._mode===te.COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===te.SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var ABe=new L;Xt.prototype.lookAt=function(e,t){let i=Rt.eastNorthUpToFixedFrame(e,ie.WGS84,ABe);this.lookAtTransform(i,t)};var CBe=new h,EBe=new Le,SBe=new Le,wBe=new $;function pre(e,t,i){t=P.clamp(t,-P.PI_OVER_TWO,P.PI_OVER_TWO),e=P.zeroToTwoPi(e)-P.PI_OVER_TWO;let n=Le.fromAxisAngle(h.UNIT_Y,-t,EBe),r=Le.fromAxisAngle(h.UNIT_Z,-e,SBe),o=Le.multiply(r,n,r),a=$.fromQuaternion(o,wBe),s=h.clone(h.UNIT_X,CBe);return $.multiplyByVector(a,s,s),h.negate(s,s),h.multiplyByScalar(s,i,s),s}Xt.prototype.lookAtTransform=function(e,t){if(this._setTransform(e),!u(t))return;let i;if(i=u(t.heading)?pre(t.heading,t.pitch,t.range):t,this._mode===te.SCENE2D){U.clone(U.ZERO,this.position),h.negate(i,this.up),this.up.z=0,h.magnitudeSquared(this.up)<P.EPSILON10&&h.clone(h.UNIT_Y,this.up),h.normalize(this.up,this.up),this._setTransform(L.IDENTITY),h.negate(h.UNIT_Z,this.direction),h.cross(this.direction,this.up,this.right),h.normalize(this.right,this.right);let t=this.frustum,n=t.top/t.right;return t.right=.5*h.magnitude(i),t.left=-t.right,t.top=n*t.right,t.bottom=-t.top,void this._setTransform(e)}h.clone(i,this.position),h.negate(this.position,this.direction),h.normalize(this.direction,this.direction),h.cross(this.direction,h.UNIT_Z,this.right),h.magnitudeSquared(this.right)<P.EPSILON10&&h.clone(h.UNIT_X,this.right),h.normalize(this.right,this.right),h.cross(this.right,this.direction,this.up),h.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)};var dw=new fe,vBe=new fe,DBe=new h,IBe=new h,PBe=new h,OBe=new h,RBe=new h,MBe=new h,LBe=new h,H6=new h,NBe={direction:new h,right:new h,up:new h},Joe;function Va(e,t,i,n){return Math.abs(h.dot(t,i))/n-h.dot(e,i)}function _re(e,t,i,n){let r=e._projection.ellipsoid,o=n?e:NBe,a=t.north,s=t.south,l=t.east,c=t.west;c>l&&(l+=P.TWO_PI);let d,p=.5*(c+l);if(s<-P.PI_OVER_TWO+P.RADIANS_PER_DEGREE&&a>P.PI_OVER_TWO-P.RADIANS_PER_DEGREE)d=0;else{let e=dw;e.longitude=p,e.latitude=a,e.height=0;let t=vBe;t.longitude=p,t.latitude=s,t.height=0;let i=Joe;(!u(i)||i.ellipsoid!==r)&&(Joe=i=new Hf(void 0,void 0,r)),i.setEndPoints(e,t),d=i.interpolateUsingFraction(.5,dw).latitude}let f=dw;f.longitude=p,f.latitude=d,f.height=0;let m=r.cartographicToCartesian(f,LBe),_=dw;_.longitude=l,_.latitude=a;let g=r.cartographicToCartesian(_,DBe);_.longitude=c;let y=r.cartographicToCartesian(_,PBe);_.longitude=p;let v=r.cartographicToCartesian(_,RBe);_.latitude=s;let b=r.cartographicToCartesian(_,MBe);_.longitude=l;let A=r.cartographicToCartesian(_,OBe);_.longitude=c;let T=r.cartographicToCartesian(_,IBe);h.subtract(y,m,y),h.subtract(A,m,A),h.subtract(g,m,g),h.subtract(T,m,T),h.subtract(v,m,v),h.subtract(b,m,b);let E=r.geodeticSurfaceNormal(m,o.direction);h.negate(E,E);let C=h.cross(E,h.UNIT_Z,o.right);h.normalize(C,C);let x,S=h.cross(C,E,o.up);if(e.frustum instanceof Qt){let t,i,n=Math.max(h.distance(g,y),h.distance(A,T)),r=Math.max(h.distance(g,A),h.distance(y,T)),o=e.frustum._offCenterFrustum,a=o.right/o.top,s=r*a;n>s?(t=n,i=t/a):(i=r,t=s),x=Math.max(t,i)}else{let t=Math.tan(.5*e.frustum.fovy),i=e.frustum.aspectRatio*t;if(x=Math.max(Va(E,S,y,t),Va(E,S,A,t),Va(E,S,g,t),Va(E,S,T,t),Va(E,S,v,t),Va(E,S,b,t),Va(E,C,y,i),Va(E,C,A,i),Va(E,C,g,i),Va(E,C,T,i),Va(E,C,v,i),Va(E,C,b,i)),s<0&&a>0){let e=dw;e.longitude=c,e.latitude=0,e.height=0;let n=r.cartographicToCartesian(e,H6);h.subtract(n,m,n),x=Math.max(x,Va(E,S,n,t),Va(E,C,n,i)),e.longitude=l,n=r.cartographicToCartesian(e,H6),h.subtract(n,m,n),x=Math.max(x,Va(E,S,n,t),Va(E,C,n,i))}}return h.add(m,h.multiplyByScalar(E,-x,H6),i)}var FBe=new fe,BBe=new h,kBe=new h;function VBe(e,t,i){let n=e._projection;t.west>t.east&&(t=ce.MAX_VALUE);let r=e._actualTransform,o=e._actualInvTransform,a=FBe;a.longitude=t.east,a.latitude=t.north;let s=n.project(a,BBe);L.multiplyByPoint(r,s,s),L.multiplyByPoint(o,s,s),a.longitude=t.west,a.latitude=t.south;let l=n.project(a,kBe);if(L.multiplyByPoint(r,l,l),L.multiplyByPoint(o,l,l),i.x=.5*(s.x-l.x)+l.x,i.y=.5*(s.y-l.y)+l.y,u(e.frustum.fovy)){let t=Math.tan(.5*e.frustum.fovy),n=e.frustum.aspectRatio*t;i.z=.5*Math.max((s.x-l.x)/n,(s.y-l.y)/t)}else{let e=s.x-l.x,t=s.y-l.y;i.z=Math.max(e,t)}return i}var UBe=new fe,zBe=new h,HBe=new h;function GBe(e,t,i){let n=e._projection,r=t.east;t.west>t.east&&(e._scene.mapMode2D===kl.INFINITE_SCROLL?r+=P.TWO_PI:r=(t=ce.MAX_VALUE).east);let o=UBe;o.longitude=r,o.latitude=t.north;let a=n.project(o,zBe);o.longitude=t.west,o.latitude=t.south;let s,l,u=n.project(o,HBe),c=.5*Math.abs(a.x-u.x),h=.5*Math.abs(a.y-u.y),d=e.frustum.right/e.frustum.top,p=h*d;return c>p?(s=c,l=s/d):(l=h,s=p),h=Math.max(2*s,2*l),i.x=.5*(a.x-u.x)+u.x,i.y=.5*(a.y-u.y)+u.y,o=n.unproject(i,o),o.height=h,i=n.project(o,i)}Xt.prototype.getRectangleCameraCoordinates=function(e,t){let i=this._mode;return u(t)||(t=new h),i===te.SCENE3D?_re(this,e,t):i===te.COLUMBUS_VIEW?VBe(this,e,t):i===te.SCENE2D?GBe(this,e,t):void 0};var WBe=new Tn;function jBe(e,t,i,n){i=y(i,ie.WGS84);let r=e.getPickRay(t,WBe),o=Ai.rayEllipsoid(r,i);if(!o)return;let a=o.start>0?o.start:o.stop;return Tn.getPoint(r,a,n)}var qBe=new Tn;function YBe(e,t,i,n){let r=e.getPickRay(t,qBe).origin;r=h.fromElements(r.y,r.z,0,r);let o=i.unproject(r);if(!(o.latitude<-P.PI_OVER_TWO||o.latitude>P.PI_OVER_TWO))return i.ellipsoid.cartographicToCartesian(o,n)}var XBe=new Tn;function KBe(e,t,i,n){let r=e.getPickRay(t,XBe),o=-r.origin.x/r.direction.x;Tn.getPoint(r,o,n);let a=i.unproject(new h(n.y,n.z,0));if(!(a.latitude<-P.PI_OVER_TWO||a.latitude>P.PI_OVER_TWO||a.longitude<-Math.PI||a.longitude>Math.PI))return i.ellipsoid.cartographicToCartesian(a,n)}Xt.prototype.pickEllipsoid=function(e,t,i){let n=this._scene.canvas;if(0!==n.clientWidth&&0!==n.clientHeight){if(u(i)||(i=new h),t=y(t,ie.WGS84),this._mode===te.SCENE3D)i=jBe(this,e,t,i);else if(this._mode===te.SCENE2D)i=YBe(this,e,this._projection,i);else{if(this._mode!==te.COLUMBUS_VIEW)return;i=KBe(this,e,this._projection,i)}return i}};var ZBe=new h,$Be=new h,QBe=new h;function JBe(e,t,i){let n=e._scene.canvas,r=n.clientWidth,o=n.clientHeight,a=Math.tan(.5*e.frustum.fovy),s=e.frustum.aspectRatio*a,l=e.frustum.near,u=2/r*t.x-1,c=2/o*(o-t.y)-1,d=e.positionWC;h.clone(d,i.origin);let p=h.multiplyByScalar(e.directionWC,l,ZBe);h.add(d,p,p);let f=h.multiplyByScalar(e.rightWC,u*l*s,$Be),m=h.multiplyByScalar(e.upWC,c*l*a,QBe),_=h.add(p,f,i.direction);return h.add(_,m,_),h.subtract(_,d,_),h.normalize(_,_),i}var tN=new h;function e3e(e,t,i){let n=e._scene.canvas,r=n.clientWidth,o=n.clientHeight,a=e.frustum,s=a.offCenterFrustum;u(s)&&(a=s);let l=2/r*t.x-1;l*=.5*(a.right-a.left);let c=2/o*(o-t.y)-1;c*=.5*(a.top-a.bottom);let d=i.origin;return h.clone(e.position,d),h.multiplyByScalar(e.right,l,tN),h.add(tN,d,d),h.multiplyByScalar(e.up,c,tN),h.add(tN,d,d),h.clone(e.directionWC,i.direction),(e._mode===te.COLUMBUS_VIEW||e._mode===te.SCENE2D)&&h.fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin),i}Xt.prototype.getPickRay=function(e,t){u(t)||(t=new Tn);let i=this._scene.canvas;if(i.clientWidth<=0||i.clientHeight<=0)return;let n=this.frustum;return u(n.aspectRatio)&&u(n.fov)&&u(n.near)?JBe(this,e,t):e3e(this,e,t)};var t3e=new h,n3e=new h;Xt.prototype.distanceToBoundingSphere=function(e){let t=h.subtract(this.positionWC,e.center,t3e),i=h.multiplyByScalar(this.directionWC,h.dot(t,this.directionWC),n3e);return Math.max(0,h.magnitude(i)-e.radius)};var i3e=new U;function o3e(e,t,i,n,r,o){let a=h.clone(t);return i.y>n?a.y-=i.y-n:i.y<-n&&(a.y+=-n-i.y),i.z>r?a.z-=i.z-r:i.z<-r&&(a.z+=-r-i.z),{easingFunction:Ir.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:o,update:function(i){let n=h.lerp(t,a,i.time,new h);e.worldToCameraCoordinatesPoint(n,e.position)}}}Xt.prototype.getPixelSize=function(e,t,i){let n=this.distanceToBoundingSphere(e),r=this.frustum.getPixelDimensions(t,i,n,this._scene.pixelRatio,i3e);return Math.max(r.x,r.y)};var r3e=new h,ere=new h,s3e=new h,a3e=new h;function c3e(e,t){let i=e.position,n=e.direction,r=e.worldToCameraCoordinatesVector(h.UNIT_X,r3e),o=-h.dot(r,i)/h.dot(r,n),a=h.add(i,h.multiplyByScalar(n,o,ere),ere);e.cameraToWorldCoordinatesPoint(a,a),i=e.cameraToWorldCoordinatesPoint(e.position,s3e);let s=Math.tan(.5*e.frustum.fovy),l=e.frustum.aspectRatio*s,u=h.magnitude(h.subtract(i,a,a3e)),c=l*u,d=s*u,p=e._maxCoord.x,f=e._maxCoord.y,m=Math.max(c-p,p),_=Math.max(d-f,f);if(i.z<-m||i.z>m||i.y<-_||i.y>_){let n=a.y<-m||a.y>m,r=a.z<-_||a.z>_;if(n||r)return o3e(e,i,a,m,_,t)}}Xt.prototype.createCorrectPositionTween=function(e){if(this._mode===te.COLUMBUS_VIEW)return c3e(this,e)};var l3e=new h,xs={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};function u3e(e,t){let i=e.frustum,n=Math.tan(.5*i.fovy),r=i.aspectRatio*n;return Math.max(t/r,t/n)}function f3e(e,t){let i=e.frustum,n=i.offCenterFrustum;u(n)&&(i=n);let r,o,a=i.right/i.top,s=t*a;return t>s?(r=t,o=r/a):(o=t,r=s),1.5*Math.max(r,o)}Xt.prototype.cancelFlight=function(){u(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},Xt.prototype.completeFlight=function(){if(u(this._currentFlight)){this._currentFlight.cancelTween();let e={destination:void 0,orientation:{heading:void 0,pitch:void 0,roll:void 0}};e.destination=xs.destination,e.orientation.heading=xs.heading,e.orientation.pitch=xs.pitch,e.orientation.roll=xs.roll,this.setView(e),u(this._currentFlight.complete)&&this._currentFlight.complete(),this._currentFlight=void 0}},Xt.prototype.flyTo=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).destination;if(this._mode===te.MORPHING)return;this.cancelFlight();let i=t instanceof ce;i&&(t=this.getRectangleCameraCoordinates(t,l3e));let n=y(e.orientation,y.EMPTY_OBJECT);if(u(n.direction)&&(n=ure(this,t,n,j6.orientation)),u(e.duration)&&e.duration<=0){let t=j6;return t.destination=e.destination,t.orientation.heading=n.heading,t.orientation.pitch=n.pitch,t.orientation.roll=n.roll,t.convert=e.convert,t.endTransform=e.endTransform,this.setView(t),void("function"==typeof e.complete&&e.complete())}let r,o=this;xs.destination=t,xs.heading=n.heading,xs.pitch=n.pitch,xs.roll=n.roll,xs.duration=e.duration,xs.complete=function(){r===o._currentFlight&&(o._currentFlight=void 0),u(e.complete)&&e.complete()},xs.cancel=e.cancel,xs.endTransform=e.endTransform,xs.convert=!i&&e.convert,xs.maximumHeight=e.maximumHeight,xs.pitchAdjustHeight=e.pitchAdjustHeight,xs.flyOverLongitude=e.flyOverLongitude,xs.flyOverLongitudeWeight=e.flyOverLongitudeWeight,xs.easingFunction=e.easingFunction;let a=this._scene,s=JL.createTween(a,xs);if(0===s.duration)return void("function"==typeof s.complete&&s.complete());r=a.tweens.add(s),this._currentFlight=r;let l=this._scene.preloadFlightCamera;this._mode!==te.SCENE2D&&(u(l)||(l=Xt.clone(this)),l.setView({destination:t,orientation:n}),this._scene.preloadFlightCullingVolume=l.frustum.computeCullingVolume(l.positionWC,l.directionWC,l.upWC))};var d3e=100;function gre(e,t,i){i=qf.clone(u(i)?i:Xt.DEFAULT_OFFSET);let n=e._scene.screenSpaceCameraController.minimumZoomDistance,r=e._scene.screenSpaceCameraController.maximumZoomDistance,o=i.range;if(!u(o)||0===o){let o=t.radius;0===o?i.range=d3e:e.frustum instanceof Qt||e._mode===te.SCENE2D?i.range=f3e(e,o):i.range=u3e(e,o),i.range=P.clamp(i.range,n,r)}return i}Xt.prototype.viewBoundingSphere=function(e,t){t=gre(this,e,t),this.lookAt(e.center,t)};var h3e=new L,m3e=new h,p3e=new h,_3e=new h,g3e=new h,y3e=new oe,x3e=new Le,b3e=new $;Xt.prototype.flyToBoundingSphere=function(e,t){t=y(t,y.EMPTY_OBJECT);let i=this._mode===te.SCENE2D||this._mode===te.COLUMBUS_VIEW;this._setTransform(L.IDENTITY);let n,r=gre(this,e,t.offset);n=i?h.multiplyByScalar(h.UNIT_Z,r.range,m3e):pre(r.heading,r.pitch,r.range);let o,a,s=Rt.eastNorthUpToFixedFrame(e.center,ie.WGS84,h3e);if(L.multiplyByPoint(s,n,n),!i){if(o=h.subtract(e.center,n,p3e),h.normalize(o,o),a=L.multiplyByPointAsVector(s,h.UNIT_Z,_3e),1-Math.abs(h.dot(o,a))<P.EPSILON6){let e=Le.fromAxisAngle(o,r.heading,x3e),t=$.fromQuaternion(e,b3e);h.fromCartesian4(L.getColumn(s,1,y3e),a),$.multiplyByVector(t,a,a)}let t=h.cross(o,a,g3e);h.cross(t,o,a),h.normalize(a,a)}this.flyTo({destination:n,orientation:{direction:o,up:a},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var tre=new h,nre=new h,G6=new h,ire=new h,hw=[new h,new h,new h,new h];function T3e(e,t){let i,n,r=t.radii,o=e.positionWC,a=h.multiplyComponents(t.oneOverRadii,o,tre),s=h.magnitude(a),l=h.normalize(a,nre);h.equalsEpsilon(l,h.UNIT_Z,P.EPSILON10)?(i=new h(0,1,0),n=new h(0,0,1)):(i=h.normalize(h.cross(h.UNIT_Z,l,G6),G6),n=h.normalize(h.cross(l,i,ire),ire));let u=Math.sqrt(h.magnitudeSquared(a)-1),c=h.multiplyByScalar(l,1/s,tre),d=u/s,p=h.multiplyByScalar(i,d,nre),f=h.multiplyByScalar(n,d,G6),m=h.add(c,f,hw[0]);h.subtract(m,p,m),h.multiplyComponents(r,m,m);let _=h.subtract(c,f,hw[1]);h.subtract(_,p,_),h.multiplyComponents(r,_,_);let g=h.subtract(c,f,hw[2]);h.add(g,p,g),h.multiplyComponents(r,g,g);let y=h.add(c,f,hw[3]);return h.add(y,p,y),h.multiplyComponents(r,y,y),hw}var W6=new U,A3e=new h,rg=[new fe,new fe,new fe,new fe];function nN(e,t,i,n,r,o){W6.x=e,W6.y=t;let a=n.pickEllipsoid(W6,r,A3e);return u(a)?(rg[i]=r.cartesianToCartographic(a,rg[i]),1):(rg[i]=r.cartesianToCartographic(o[i],rg[i]),0)}Xt.prototype.computeViewRectangle=function(e,t){e=y(e,ie.WGS84);let i=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),n=new se(h.ZERO,e.maximumRadius);if(i.computeVisibility(n)===Zt.OUTSIDE)return;let r=this._scene.canvas,o=r.clientWidth,a=r.clientHeight,s=0,l=T3e(this,e);if(s+=nN(0,0,0,this,e,l),s+=nN(0,a,1,this,e,l),s+=nN(o,a,2,this,e,l),s+=nN(o,0,3,this,e,l),s<2)return ce.MAX_VALUE;t=ce.fromCartographicArray(rg,t);let u=0,c=rg[3].longitude;for(let e=0;e<4;++e){let t=rg[e].longitude,i=Math.abs(t-c);i>P.PI?u+=P.TWO_PI-i:u+=i,c=t}return P.equalsEpsilon(Math.abs(u),P.TWO_PI,P.EPSILON9)&&(t.west=-P.PI,t.east=P.PI,rg[0].latitude>=0?t.north=P.PI_OVER_TWO:t.south=-P.PI_OVER_TWO),t},Xt.prototype.switchToPerspectiveFrustum=function(){if(this._mode===te.SCENE2D||this.frustum instanceof Ei)return;let e=this._scene;this.frustum=new Ei,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=P.toRadians(60)},Xt.prototype.switchToOrthographicFrustum=function(){if(this._mode===te.SCENE2D||this.frustum instanceof Qt)return;let e=cre(this),t=this._scene;this.frustum=new Qt,this.frustum.aspectRatio=t.drawingBufferWidth/t.drawingBufferHeight,this.frustum.width=e},Xt.clone=function(e,t){return u(t)||(t=new Xt(e._scene)),h.clone(e.position,t.position),h.clone(e.direction,t.direction),h.clone(e.up,t.up),h.clone(e.right,t.right),L.clone(e._transform,t.transform),t._transformChanged=!0,t.frustum=e.frustum.clone(),t};var oo=Xt,C3e={LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4},Li=Object.freeze(C3e);function za(e,t){let i=e;return u(t)&&(i+=`+${t}`),i}function E3e(e,t){U.clone(e.distance.startPosition,t.distance.startPosition),U.clone(e.distance.endPosition,t.distance.endPosition),U.clone(e.angleAndHeight.startPosition,t.angleAndHeight.startPosition),U.clone(e.angleAndHeight.endPosition,t.angleAndHeight.endPosition)}function yre(e,t,i){let n=za(Li.PINCH,t),r=e._update,o=e._isDown,a=e._eventStartPosition,s=e._pressTime,l=e._releaseTime;r[n]=!0,o[n]=!1,a[n]=new U;let c=e._movement[n];u(c)||(c=e._movement[n]={}),c.distance={startPosition:new U,endPosition:new U},c.angleAndHeight={startPosition:new U,endPosition:new U},c.prevAngle=0,e._eventHandler.setInputAction((function(t){e._buttonsDown++,o[n]=!0,s[n]=new Date,U.lerp(t.position1,t.position2,.5,a[n])}),_n.PINCH_START,t),e._eventHandler.setInputAction((function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),o[n]=!1,l[n]=new Date}),_n.PINCH_END,t),e._eventHandler.setInputAction((function(e){if(o[n]){r[n]?(E3e(e,c),r[n]=!1,c.prevAngle=c.angleAndHeight.startPosition.x):(U.clone(e.distance.endPosition,c.distance.endPosition),U.clone(e.angleAndHeight.endPosition,c.angleAndHeight.endPosition));let t=c.angleAndHeight.endPosition.x,o=c.prevAngle,a=2*Math.PI;for(;t>=o+Math.PI;)t-=a;for(;t<o-Math.PI;)t+=a;c.angleAndHeight.endPosition.x=-t*i.clientWidth/12,c.angleAndHeight.startPosition.x=-o*i.clientWidth/12}}),_n.PINCH_MOVE,t)}function xre(e,t){let i=za(Li.WHEEL,t),n=e._pressTime,r=e._releaseTime,o=e._update;o[i]=!0;let a=e._movement[i];u(a)||(a=e._movement[i]={});let s=e._lastMovement[i];u(s)||(s=e._lastMovement[i]={startPosition:new U,endPosition:new U,valid:!1}),a.startPosition=new U,U.clone(U.ZERO,a.startPosition),a.endPosition=new U,e._eventHandler.setInputAction((function(e){let t=7.5*P.toRadians(e);n[i]=r[i]=new Date,a.endPosition.x=0,a.endPosition.y=t,U.clone(a.endPosition,s.endPosition),s.valid=!0,o[i]=!1}),_n.WHEEL,t)}function uA(e,t,i){let n=za(i,t),r=e._isDown,o=e._eventStartPosition,a=e._pressTime,s=e._releaseTime;r[n]=!1,o[n]=new U;let l,c,h=e._lastMovement[n];u(h)||(h=e._lastMovement[n]={startPosition:new U,endPosition:new U,valid:!1}),i===Li.LEFT_DRAG?(l=_n.LEFT_DOWN,c=_n.LEFT_UP):i===Li.RIGHT_DRAG?(l=_n.RIGHT_DOWN,c=_n.RIGHT_UP):i===Li.MIDDLE_DRAG&&(l=_n.MIDDLE_DOWN,c=_n.MIDDLE_UP),e._eventHandler.setInputAction((function(t){e._buttonsDown++,h.valid=!1,r[n]=!0,a[n]=new Date,U.clone(t.position,o[n])}),l,t),e._eventHandler.setInputAction((function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),r[n]=!1,s[n]=new Date}),c,t)}function bre(e,t){U.clone(e.startPosition,t.startPosition),U.clone(e.endPosition,t.endPosition)}function Tre(e,t){let i=e._update,n=e._movement,r=e._lastMovement,o=e._isDown;for(let n in Li)if(Li.hasOwnProperty(n)){let r=Li[n];if(u(r)){let n=za(r,t);i[n]=!0,u(e._lastMovement[n])||(e._lastMovement[n]={startPosition:new U,endPosition:new U,valid:!1}),u(e._movement[n])||(e._movement[n]={startPosition:new U,endPosition:new U})}}e._eventHandler.setInputAction((function(a){for(let e in Li)if(Li.hasOwnProperty(e)){let s=Li[e];if(u(s)){let e=za(s,t);o[e]&&(i[e]?(bre(n[e],r[e]),r[e].valid=!0,bre(a,n[e]),i[e]=!1):U.clone(a.endPosition,n[e].endPosition))}}U.clone(a.endPosition,e._currentMousePosition)}),_n.MOUSE_MOVE,t)}function Qu(e){this._eventHandler=new Hu(e),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new U,xre(this,void 0),yre(this,void 0,e),uA(this,void 0,Li.LEFT_DRAG),uA(this,void 0,Li.RIGHT_DRAG),uA(this,void 0,Li.MIDDLE_DRAG),Tre(this,void 0);for(let t in na)if(na.hasOwnProperty(t)){let i=na[t];u(i)&&(xre(this,i),yre(this,i,e),uA(this,i,Li.LEFT_DRAG),uA(this,i,Li.RIGHT_DRAG),uA(this,i,Li.MIDDLE_DRAG),Tre(this,i))}}Object.defineProperties(Qu.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){let e=!(this._update[za(Li.WHEEL)]&&this._update[za(Li.WHEEL,na.SHIFT)]&&this._update[za(Li.WHEEL,na.CTRL)]&&this._update[za(Li.WHEEL,na.ALT)]);return this._buttonsDown>0||e}}}),Qu.prototype.isMoving=function(e,t){let i=za(e,t);return!this._update[i]},Qu.prototype.getMovement=function(e,t){let i=za(e,t);return this._movement[i]},Qu.prototype.getLastMovement=function(e,t){let i=za(e,t),n=this._lastMovement[i];if(n.valid)return n},Qu.prototype.isButtonDown=function(e,t){let i=za(e,t);return this._isDown[i]},Qu.prototype.getStartMousePosition=function(e,t){if(e===Li.WHEEL)return this._currentMousePosition;let i=za(e,t);return this._eventStartPosition[i]},Qu.prototype.getButtonPressTime=function(e,t){let i=za(e,t);return this._pressTime[i]},Qu.prototype.getButtonReleaseTime=function(e,t){let i=za(e,t);return this._releaseTime[i]},Qu.prototype.reset=function(){for(let e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},Qu.prototype.isDestroyed=function(){return!1},Qu.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),le(this)};var aN=Qu;function Are(e){e=y(e,y.EMPTY_OBJECT),this._metadata=e.metadata}Object.defineProperties(Are.prototype,{metadata:{get:function(){return this._metadata}}});var fA=Are;function $f(e,t,i,n){this._tileset=e,this._tile=t,this._resource=i,u(n)||(n=[]),this._contents=n,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties($f.prototype,{featurePropertiesDirty:{get:function(){let e=this._contents,t=e.length;for(let i=0;i<t;++i)if(e[i].featurePropertiesDirty)return!0;return!1},set:function(e){let t=this._contents,i=t.length;for(let n=0;n<i;++n)t[n].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e;let t=this._contents,i=t.length;for(let n=0;n<i;++n)t[n].metadata=e}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(e){this._group=e;let t=this._contents,i=t.length;for(let n=0;n<i;++n)t[n].group=e}}});var mw=Uint32Array.BYTES_PER_ELEMENT;$f.fromTileType=async function(e,t,i,n,r,o){r=y(r,0);let a=new Uint8Array(n),s=new DataView(n);r+=mw;let l=s.getUint32(r,!0);if(1!==l)throw new ue(`Only Composite Tile version 1 is supported. Version ${l} is not.`);r+=mw,r+=mw;let c=s.getUint32(r,!0);r+=mw;let h=i.queryParameters.compositeIndex;h=u(h)?`${h}_`:"";let d=[];d.length=c;for(let l=0;l<c;++l){let c=bh(a,r),p=s.getUint32(r+2*mw,!0),f=o[c],m=`${h}${l}`,_=i.getDerivedResource({queryParameters:{compositeIndex:m}});if(!u(f))throw new ue(`Unknown tile content type, ${c}, inside Composite tile`);d[l]=Promise.resolve(f(e,t,_,n,r)),r+=p}return new $f(e,t,i,await Promise.all(d))},$f.prototype.hasProperty=function(e,t){return!1},$f.prototype.getFeature=function(e){},$f.prototype.applyDebugSettings=function(e,t){let i=this._contents,n=i.length;for(let r=0;r<n;++r)i[r].applyDebugSettings(e,t)},$f.prototype.applyStyle=function(e){let t=this._contents,i=t.length;for(let n=0;n<i;++n)t[n].applyStyle(e)},$f.prototype.update=function(e,t){let i=this._contents,n=i.length,r=!0;for(let o=0;o<n;++o)i[o].update(e,t),r=r&&i[o].ready;!this._ready&&r&&(this._ready=!0)},$f.prototype.isDestroyed=function(){return!1},$f.prototype.destroy=function(){let e=this._contents,t=e.length;for(let i=0;i<t;++i)e[i].destroy();return le(this)};var cN=$f,S3e={HIGHLIGHT:0,REPLACE:1,MIX:2},Vl=Object.freeze(S3e),w3e={NEVER:ee.NEVER,LESS:ee.LESS,EQUAL:ee.EQUAL,LESS_OR_EQUAL:ee.LEQUAL,GREATER:ee.GREATER,NOT_EQUAL:ee.NOTEQUAL,GREATER_OR_EQUAL:ee.GEQUAL,ALWAYS:ee.ALWAYS},Un=Object.freeze(w3e),v3e={ZERO:ee.ZERO,KEEP:ee.KEEP,REPLACE:ee.REPLACE,INCREMENT:ee.INCR,DECREMENT:ee.DECR,INVERT:ee.INVERT,INCREMENT_WRAP:ee.INCR_WRAP,DECREMENT_WRAP:ee.DECR_WRAP},ft=Object.freeze(v3e),lN={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15,setCesium3DTileBit:function(){return{enabled:!0,frontFunction:Un.ALWAYS,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.REPLACE},backFunction:Un.ALWAYS,backOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.REPLACE},reference:lN.CESIUM_3D_TILE_MASK,mask:lN.CESIUM_3D_TILE_MASK}}},Lt=Object.freeze(lN),K6=il.DEFAULT_COLOR_VALUE,Z6=il.DEFAULT_SHOW_VALUE;function ro(e,t,i,n,r){let o;this.featuresLength=t,u(i)&&(o=i.extensions),this._extensions=y(o,{});let a=D3e(i);this._properties=a,this._batchTableHierarchy=I3e(this,i,n);let s=Ere(t,a,n);this._binaryPropertiesByteLength=P3e(s),this._batchTableBinaryProperties=s,this._content=e,this._batchTexture=new il({featuresLength:t,colorChangedCallback:r,owner:e,statistics:e.tileset.statistics})}function D3e(e){let t={};if(!u(e))return t;for(let i in e)e.hasOwnProperty(i)&&"HIERARCHY"!==i&&"extensions"!==i&&"extras"!==i&&(t[i]=Ge(e[i],!0));return t}function I3e(e,t,i){if(!u(t))return;let n=e._extensions["3DTILES_batch_table_hierarchy"],r=t.HIERARCHY;return u(r)&&(ro._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),e._extensions["3DTILES_batch_table_hierarchy"]=r,n=r),u(n)?new eA({extension:n,binaryBody:i}):void 0}function Ere(e,t,i){let n;for(let r in t)if(t.hasOwnProperty(r)){let o=t[r],a=o.byteOffset;if(u(a)){let t=o.componentType,s=o.type;if(!u(t))throw new ue("componentType is required.");if(!u(s))throw new ue("type is required.");if(!u(i))throw new ue(`Property ${r} requires a batch table binary.`);let l=qu(o),c=l.componentsPerAttribute,h=l.classType,d=l.createArrayBufferView(i.buffer,i.byteOffset+a,e);u(n)||(n={}),n[r]={typedArray:d,componentCount:c,type:h}}}return n}function P3e(e){if(!u(e))return 0;let t=0;for(let i in e)e.hasOwnProperty(i)&&(t+=e[i].typedArray.byteLength);return t}ro._deprecationWarning=is,Object.defineProperties(ro.prototype,{batchTableByteLength:{get:function(){let e=this._binaryPropertiesByteLength;return u(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e+=this._batchTexture.byteLength,e}}}),ro.getBinaryProperties=function(e,t,i){return Ere(e,t,i)},ro.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)},ro.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)},ro.prototype.getShow=function(e){return this._batchTexture.getShow(e)},ro.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)},ro.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)},ro.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)},ro.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)};var O3e=new z;function R3e(e,t){let i=e.typedArray,n=e.componentCount;return 1===n?i[t]:e.type.unpack(i,t*n)}function M3e(e,t,i){let n=e.typedArray,r=e.componentCount;1===r?n[t]=i:e.type.pack(i,n,t*r)}function L3e(e){return 1===e._batchTexture.textureDimensions.y?"uniform vec4 tile_textureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    return vec2(centerX + (batchId * stepX), 0.5); \n} \n":"uniform vec4 tile_textureStep; \nuniform vec2 tile_textureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    float stepY = tile_textureStep.z; \n    float centerY = tile_textureStep.w; \n    float xId = mod(batchId, tile_textureDimensions.x); \n    float yId = floor(batchId / tile_textureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n"}function Cre(e,t){return e=He.replaceMain(e,"tile_main"),t?`${e}uniform float tile_colorBlend; \nvoid tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n    tile_featureColor = czm_gammaCorrect(tile_featureColor); \n    out_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n} \n`:`${e}void tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n} \n`}function N3e(e,t){let i,n=`texture(${t}`,r=0,o=e.indexOf(n,r);for(;o>-1;){let t=0;for(let n=o;n<e.length;++n){let r=e.charAt(n);if("("===r)++t;else if(")"===r&&(--t,0===t)){i=n+1;break}}let a=`tile_diffuse_final(${e.slice(o,i)}, tile_diffuse)`;e=e.slice(0,o)+a+e.slice(i),r=o+a.length,o=e.indexOf(n,r)}return e}function Sre(e,t,i){if(!u(t))return Cre(e,i);let n=new RegExp(`(uniform|attribute|in)\\s+(vec[34]|sampler2D)\\s+${t};`),r=e.match(n);if(!u(r))return Cre(e,i);let o=r[0],a=r[2];e=(e=He.replaceMain(e,"tile_main")).replace(o,"");let s;if("vec3"===a||"vec4"===a){let i="vec3"===a?`vec4(${t}, 1.0)`:t,r="vec3"===a?"tile_diffuse.xyz":"tile_diffuse";n=new RegExp(t,"g"),e=e.replace(n,r),s=`    vec4 source = ${i}; \n    tile_diffuse = tile_diffuse_final(source, tile_featureColor); \n    tile_main(); \n`}else"sampler2D"===a&&(e=N3e(e,t),s="    tile_diffuse = tile_featureColor; \n    tile_main(); \n");return e=`uniform float tile_colorBlend; \nvec4 tile_diffuse = vec4(1.0); \nbool isWhite(vec3 color) \n{ \n    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); \n} \nvec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) \n{ \n    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); \n    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; \n    return vec4(diffuse.rgb, sourceDiffuse.a); \n} \n${o}\n${e}\nvoid tile_color(vec4 tile_featureColor) \n{ \n${s}`,i&&(e+="    tile_featureColor = czm_gammaCorrect(tile_featureColor); \n    out_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    out_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n"),e+="} \n"}function F3e(e){let t=e._content.tileset,i=t.colorBlendMode,n=t.colorBlendAmount;return i===Vl.HIGHLIGHT?0:i===Vl.REPLACE?1:i===Vl.MIX?P.clamp(n,P.EPSILON4,1):void 0}ro.prototype.applyStyle=function(e){if(!u(e))return this.setAllColor(K6),void this.setAllShow(Z6);let t=this._content,i=this.featuresLength;for(let n=0;n<i;++n){let i=t.getFeature(n),r=u(e.color)?y(e.color.evaluateColor(i,O3e),K6):K6,o=u(e.show)?y(e.show.evaluate(i),Z6):Z6;this.setColor(n,r),this.setShow(n,o)}},ro.prototype.isClass=function(e,t){let i=this._batchTableHierarchy;return!!u(i)&&i.isClass(e,t)},ro.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t},ro.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(u(t))return t.getClassName(e)},ro.prototype.hasProperty=function(e,t){return u(this._properties[t])||u(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)},ro.prototype.hasPropertyBySemantic=function(){return!1},ro.prototype.getPropertyIds=function(e,t){(t=u(t)?t:[]).length=0;let i=Object.keys(this._properties);return t.push.apply(t,i),u(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,i)),t},ro.prototype.getPropertyBySemantic=function(e,t){},ro.prototype.getProperty=function(e,t){if(u(this._batchTableBinaryProperties)){let i=this._batchTableBinaryProperties[t];if(u(i))return R3e(i,e)}let i=this._properties[t];if(u(i))return Ge(i[e],!0);if(u(this._batchTableHierarchy)){let i=this._batchTableHierarchy.getProperty(e,t);if(u(i))return i}},ro.prototype.setProperty=function(e,t,i){let n=this.featuresLength;if(u(this._batchTableBinaryProperties)){let n=this._batchTableBinaryProperties[t];if(u(n))return void M3e(n,e,i)}if(u(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,i))return;let r=this._properties[t];u(r)||(this._properties[t]=new Array(n),r=this._properties[t]),r[e]=Ge(i,!0)},ro.prototype.getVertexShaderCallback=function(e,t,i){if(0===this.featuresLength)return;let n=this;return function(r){let o,a=Sre(r,i,!1);return zt.maximumVertexTextureImageUnits>0?(o="",e&&(o+="uniform bool tile_translucentCommand; \n"),o+=`uniform sampler2D tile_batchTexture; \nout vec4 tile_featureColor; \nout vec2 tile_featureSt; \nvoid main() \n{ \n    vec2 st = computeSt(${t}); \n    vec4 featureProperties = texture(tile_batchTexture, st); \n    tile_color(featureProperties); \n    float show = ceil(featureProperties.a); \n    gl_Position *= show; \n`,e&&(o+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n"),o+="    tile_featureColor = featureProperties; \n    tile_featureSt = st; \n}"):o=`out vec2 tile_featureSt; \nvoid main() \n{ \n    tile_color(vec4(1.0)); \n    tile_featureSt = computeSt(${t}); \n}`,`${a}\n${L3e(n)}${o}`}},ro.prototype.getFragmentShaderCallback=function(e,t,i){if(0!==this.featuresLength)return function(n){return n=Sre(n,t,!0),zt.maximumVertexTextureImageUnits>0?(n+="uniform sampler2D tile_pickTexture; \nin vec2 tile_featureSt; \nin vec4 tile_featureColor; \nvoid main() \n{ \n    tile_color(tile_featureColor); \n",i&&(n+="    out_FragColor.rgb *= out_FragColor.a; \n"),n+="}"):(e&&(n+="uniform bool tile_translucentCommand; \n"),n+="uniform sampler2D tile_pickTexture; \nuniform sampler2D tile_batchTexture; \nin vec2 tile_featureSt; \nvoid main() \n{ \n    vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n",e&&(n+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            discard; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            discard; \n        } \n    } \n"),n+="    tile_color(featureProperties); \n",i&&(n+="    out_FragColor.rgb *= out_FragColor.a; \n"),n+="} \n"),n}},ro.prototype.getClassificationFragmentShaderCallback=function(){if(0!==this.featuresLength)return function(e){return e=He.replaceMain(e,"tile_main"),zt.maximumVertexTextureImageUnits>0?e+="uniform sampler2D tile_pickTexture;\nin vec2 tile_featureSt; \nin vec4 tile_featureColor; \nvoid main() \n{ \n    tile_main(); \n    out_FragColor = tile_featureColor; \n    out_FragColor.rgb *= out_FragColor.a; \n}":e+="uniform sampler2D tile_batchTexture; \nuniform sampler2D tile_pickTexture;\nin vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    vec4 featureProperties = texture(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n    out_FragColor = featureProperties; \n    out_FragColor.rgb *= out_FragColor.a; \n} \n",e}},ro.prototype.getUniformMapCallback=function(){if(0===this.featuresLength)return;let e=this;return function(t){return gt(t,{tile_batchTexture:function(){return y(e._batchTexture.batchTexture,e._batchTexture.defaultTexture)},tile_textureDimensions:function(){return e._batchTexture.textureDimensions},tile_textureStep:function(){return e._batchTexture.textureStep},tile_colorBlend:function(){return F3e(e)},tile_pickTexture:function(){return e._batchTexture.pickTexture}})}},ro.prototype.getPickId=function(){return"texture(tile_pickTexture, tile_featureSt)"};var sg={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};function B3e(e){let t=e._batchTexture.translucentFeaturesLength;return 0===t?sg.ALL_OPAQUE:t===e.featuresLength?sg.ALL_TRANSLUCENT:sg.OPAQUE_AND_TRANSLUCENT}function k3e(e){let t=et.shallowClone(e),i=t.pass===Ee.TRANSLUCENT;return t.uniformMap=u(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return i},t}function V3e(e){let t=et.shallowClone(e);return t.pass=Ee.TRANSLUCENT,t.renderState=j3e(e.renderState),t}function U3e(e){let t=et.shallowClone(e);return t.renderState=q3e(e.renderState),t}function z3e(e,t){let i=e.shaderCache.getDerivedShaderProgram(t,"zBackfaceLogDepth");if(!u(i)){let n=t.fragmentShaderSource.clone();n.defines=u(n.defines)?n.defines.slice(0):[],n.defines.push("POLYGON_OFFSET"),i=e.shaderCache.createDerivedShaderProgram(t,"zBackfaceLogDepth",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:n,attributeLocations:t._attributeLocations})}return i}function H3e(e,t){let i=et.shallowClone(t),n=Ge(i.renderState,!0);n.cull.enabled=!0,n.cull.face=gi.FRONT,n.colorMask={red:!1,green:!1,blue:!1,alpha:!1},n.polygonOffset={enabled:!0,factor:5,units:5},n.stencilTest=Lt.setCesium3DTileBit(),n.stencilMask=Lt.CESIUM_3D_TILE_MASK,i.renderState=Ue.fromCache(n),i.castShadows=!1,i.receiveShadows=!1,i.uniformMap=Ge(t.uniformMap);let r=new U(5,5);return i.uniformMap.u_polygonOffset=function(){return r},i.shaderProgram=z3e(e,t.shaderProgram),i}function G3e(e,t){let i=et.shallowClone(e),n=Ge(i.renderState,!0);return n.stencilTest.enabled=!0,n.stencilTest.mask=Lt.SKIP_LOD_MASK,n.stencilTest.reference=Lt.CESIUM_3D_TILE_MASK|t<<Lt.SKIP_LOD_BIT_SHIFT,n.stencilTest.frontFunction=Un.GREATER_OR_EQUAL,n.stencilTest.frontOperation.zPass=ft.REPLACE,n.stencilTest.backFunction=Un.GREATER_OR_EQUAL,n.stencilTest.backOperation.zPass=ft.REPLACE,n.stencilMask=Lt.CESIUM_3D_TILE_MASK|Lt.SKIP_LOD_MASK,i.renderState=Ue.fromCache(n),i}function W3e(e){return(e.renderState.stencilTest.reference&Lt.SKIP_LOD_MASK)>>>Lt.SKIP_LOD_BIT_SHIFT}function j3e(e){let t=Ge(e,!0);return t.cull.enabled=!1,t.depthTest.enabled=!0,t.depthMask=!1,t.blending=ln.ALPHA_BLEND,t.stencilTest=Lt.setCesium3DTileBit(),t.stencilMask=Lt.CESIUM_3D_TILE_MASK,Ue.fromCache(t)}function q3e(e){let t=Ge(e,!0);return t.stencilTest=Lt.setCesium3DTileBit(),t.stencilMask=Lt.CESIUM_3D_TILE_MASK,Ue.fromCache(t)}ro.prototype.addDerivedCommands=function(e,t){let i=e.commandList,n=i.length,r=this._content._tile,o=r._finalResolution,a=r.tileset,s=a.isSkippingLevelOfDetail&&a.hasMixedContent&&e.context.stencilBuffer,l=B3e(this);for(let c=t;c<n;++c){let t=i[c];if(t.pass===Ee.COMPUTE)continue;let n=t.derivedCommands.tileset;(!u(n)||t.dirty)&&(n={},t.derivedCommands.tileset=n,n.originalCommand=k3e(t),t.dirty=!1);let h=n.originalCommand;l!==sg.ALL_OPAQUE&&t.pass!==Ee.TRANSLUCENT&&(u(n.translucent)||(n.translucent=V3e(h))),l!==sg.ALL_TRANSLUCENT&&t.pass!==Ee.TRANSLUCENT&&(u(n.opaque)||(n.opaque=U3e(h)),s&&(o||(u(n.zback)||(n.zback=H3e(e.context,h)),a._backfaceCommands.push(n.zback)),(!u(n.stencil)||r._selectionDepth!==W3e(n.stencil))&&(t.renderState.depthMask?n.stencil=G3e(h,r._selectionDepth):n.stencil=n.opaque)));let d=s?n.stencil:n.opaque,p=n.translucent;t.pass!==Ee.TRANSLUCENT?(l===sg.ALL_OPAQUE&&(i[c]=d),l===sg.ALL_TRANSLUCENT&&(i[c]=p),l===sg.OPAQUE_AND_TRANSLUCENT&&(i[c]=d,i.push(p))):i[c]=h}},ro.prototype.update=function(e,t){this._batchTexture.update(e,t)},ro.prototype.isDestroyed=function(){return!1},ro.prototype.destroy=function(){return this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),le(this)};var ag=ro,wre={TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2,NUMBER_OF_CLASSIFICATION_TYPES:3},zn=Object.freeze(wre);function Y3e(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds}var op=Y3e,k0="#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\n\nvoid main(void)\n{\n#ifdef VECTOR_TILE\n    out_FragColor = czm_gammaCorrect(u_highlightColor);\n#else\n    out_FragColor = vec4(1.0);\n#endif\n    czm_writeDepthClamp();\n}\n",pw="in vec3 position;\nin float a_batchId;\n\nuniform mat4 u_modifiedModelViewProjection;\n\nvoid main()\n{\n    gl_Position = czm_depthClamp(u_modifiedModelViewProjection * vec4(position, 1.0));\n}\n";function Ju(e,t){this._content=e,this._batchId=t,this._color=void 0}Object.defineProperties(Ju.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){return u(this._color)||(this._color=new z),this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},polylinePositions:{get:function(){if(u(this._content.getPolylinePositions))return this._content.getPolylinePositions(this._batchId)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},featureId:{get:function(){return this._batchId}},pickId:{get:function(){return this._content.batchTable.getPickColor(this._batchId)}}}),Ju.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},Ju.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)},Ju.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},Ju.getPropertyInherited=function(e,t,i){let n=e.batchTable;if(u(n)){if(n.hasPropertyBySemantic(t,i))return n.getPropertyBySemantic(t,i);if(n.hasProperty(t,i))return n.getProperty(t,i)}let r=e.metadata;if(u(r)){if(r.hasPropertyBySemantic(i))return r.getPropertyBySemantic(i);if(r.hasProperty(i))return r.getProperty(i)}let o,a=e.tile,s=a.metadata;if(u(s)){if(s.hasPropertyBySemantic(i))return s.getPropertyBySemantic(i);if(s.hasProperty(i))return s.getProperty(i)}if(u(a.implicitSubtree)&&(o=a.implicitSubtree.metadata),u(o)){if(o.hasPropertyBySemantic(i))return o.getPropertyBySemantic(i);if(o.hasProperty(i))return o.getProperty(i)}let l=u(e.group)?e.group.metadata:void 0;if(u(l)){if(l.hasPropertyBySemantic(i))return l.getPropertyBySemantic(i);if(l.hasProperty(i))return l.getProperty(i)}let c=e.tileset.metadata;if(u(c)){if(c.hasPropertyBySemantic(i))return c.getPropertyBySemantic(i);if(c.hasProperty(i))return c.getProperty(i)}},Ju.prototype.getPropertyInherited=function(e){return Ju.getPropertyInherited(this._content,this._batchId,e)},Ju.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},Ju.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},Ju.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},Ju.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var Fs=Ju,X3e={NEVER:ee.NEVER,LESS:ee.LESS,EQUAL:ee.EQUAL,LESS_OR_EQUAL:ee.LEQUAL,GREATER:ee.GREATER,NOT_EQUAL:ee.NOTEQUAL,GREATER_OR_EQUAL:ee.GEQUAL,ALWAYS:ee.ALWAYS},yc=Object.freeze(X3e),$6=class{add(e,t,i){if("string"!=typeof arguments[0])for(let e in arguments[0])this.add(e,arguments[0][e],arguments[1]);else(Array.isArray(e)?e:[e]).forEach((function(e){this[e]=this[e]||[],t&&this[e][i?"unshift":"push"](t)}),this)}run(e,t){this[e]=this[e]||[],this[e].forEach((function(e){e.call(t&&t.context?t.context:t,t)}))}},Q6=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach((e=>{if("object"!=typeof e||!e.name||!e.init)throw new Error("Invalid JSEP plugin format");this.registered[e.name]||(e.init(this.jsep),this.registered[e.name]=e)}))}},ol=class e{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+e.version}static addUnaryOp(t){return e.max_unop_len=Math.max(t.length,e.max_unop_len),e.unary_ops[t]=1,e}static addBinaryOp(t,i,n){return e.max_binop_len=Math.max(t.length,e.max_binop_len),e.binary_ops[t]=i,n?e.right_associative.add(t):e.right_associative.delete(t),e}static addIdentifierChar(t){return e.additional_identifier_chars.add(t),e}static addLiteral(t,i){return e.literals[t]=i,e}static removeUnaryOp(t){return delete e.unary_ops[t],t.length===e.max_unop_len&&(e.max_unop_len=e.getMaxKeyLen(e.unary_ops)),e}static removeAllUnaryOps(){return e.unary_ops={},e.max_unop_len=0,e}static removeIdentifierChar(t){return e.additional_identifier_chars.delete(t),e}static removeBinaryOp(t){return delete e.binary_ops[t],t.length===e.max_binop_len&&(e.max_binop_len=e.getMaxKeyLen(e.binary_ops)),e.right_associative.delete(t),e}static removeAllBinaryOps(){return e.binary_ops={},e.max_binop_len=0,e}static removeLiteral(t){return delete e.literals[t],e}static removeAllLiterals(){return e.literals={},e}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(t){return new e(t).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map((e=>e.length)))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(t){return e.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!e.binary_ops[String.fromCharCode(t)]||e.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return e.isIdentifierStart(t)||e.isDecimalDigit(t)}throwError(e){let t=new Error(e+" at character "+this.index);throw t.index=this.index,t.description=e,t}runHook(t,i){if(e.hooks[t]){let n={context:this,node:i};return e.hooks.run(t,n),n.node}return i}searchHook(t){if(e.hooks[t]){let i={context:this};return e.hooks[t].find((function(e){return e.call(i.context,i),i.node})),i.node}}gobbleSpaces(){let t=this.code;for(;t===e.SPACE_CODE||t===e.TAB_CODE||t===e.LF_CODE||t===e.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let t=this.gobbleExpressions(),i=1===t.length?t[0]:{type:e.COMPOUND,body:t};return this.runHook("after-all",i)}gobbleExpressions(t){let i,n,r=[];for(;this.index<this.expr.length;)if(i=this.code,i===e.SEMCOL_CODE||i===e.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())r.push(n);else if(this.index<this.expr.length){if(i===t)break;this.throwError('Unexpected "'+this.char+'"')}return r}gobbleExpression(){let e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,e.max_binop_len),i=t.length;for(;i>0;){if(e.binary_ops.hasOwnProperty(t)&&(!e.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!e.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=i,t;t=t.substr(0,--i)}return!1}gobbleBinaryExpression(){let t,i,n,r,o,a,s,l,u;if(a=this.gobbleToken(),!a||(i=this.gobbleBinaryOp(),!i))return a;for(o={value:i,prec:e.binaryPrecedence(i),right_a:e.right_associative.has(i)},s=this.gobbleToken(),s||this.throwError("Expected expression after "+i),r=[a,o,s];i=this.gobbleBinaryOp();){if(n=e.binaryPrecedence(i),0===n){this.index-=i.length;break}o={value:i,prec:n,right_a:e.right_associative.has(i)},u=i;let l=e=>o.right_a&&e.right_a?n>e.prec:n<=e.prec;for(;r.length>2&&l(r[r.length-2]);)s=r.pop(),i=r.pop().value,a=r.pop(),t={type:e.BINARY_EXP,operator:i,left:a,right:s},r.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+u),r.push(o,t)}for(l=r.length-1,t=r[l];l>1;)t={type:e.BINARY_EXP,operator:r[l-1].value,left:r[l-2],right:t},l-=2;return t}gobbleToken(){let t,i,n,r;if(this.gobbleSpaces(),r=this.searchHook("gobble-token"),r)return this.runHook("after-token",r);if(t=this.code,e.isDecimalDigit(t)||t===e.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===e.SQUOTE_CODE||t===e.DQUOTE_CODE)r=this.gobbleStringLiteral();else if(t===e.OBRACK_CODE)r=this.gobbleArray();else{for(i=this.expr.substr(this.index,e.max_unop_len),n=i.length;n>0;){if(e.unary_ops.hasOwnProperty(i)&&(!e.isIdentifierStart(this.code)||this.index+i.length<this.expr.length&&!e.isIdentifierPart(this.expr.charCodeAt(this.index+i.length)))){this.index+=n;let t=this.gobbleToken();return t||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:e.UNARY_EXP,operator:i,argument:t,prefix:!0})}i=i.substr(0,--n)}e.isIdentifierStart(t)?(r=this.gobbleIdentifier(),e.literals.hasOwnProperty(r.name)?r={type:e.LITERAL,value:e.literals[r.name],raw:r.name}:r.name===e.this_str&&(r={type:e.THIS_EXP})):t===e.OPAREN_CODE&&(r=this.gobbleGroup())}return r?(r=this.gobbleTokenProperty(r),this.runHook("after-token",r)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let i=this.code;for(;i===e.PERIOD_CODE||i===e.OBRACK_CODE||i===e.OPAREN_CODE||i===e.QUMARK_CODE;){let n;if(i===e.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==e.PERIOD_CODE)break;n=!0,this.index+=2,this.gobbleSpaces(),i=this.code}this.index++,i===e.OBRACK_CODE?(t={type:e.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},this.gobbleSpaces(),i=this.code,i!==e.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):i===e.OPAREN_CODE?t={type:e.CALL_EXP,arguments:this.gobbleArguments(e.CPAREN_CODE),callee:t}:(i===e.PERIOD_CODE||n)&&(n&&this.index--,this.gobbleSpaces(),t={type:e.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),n&&(t.optional=!0),this.gobbleSpaces(),i=this.code}return t}gobbleNumericLiteral(){let t,i,n="";for(;e.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);if(this.code===e.PERIOD_CODE)for(n+=this.expr.charAt(this.index++);e.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);if(t=this.char,"e"===t||"E"===t){for(n+=this.expr.charAt(this.index++),t=this.char,("+"===t||"-"===t)&&(n+=this.expr.charAt(this.index++));e.isDecimalDigit(this.code);)n+=this.expr.charAt(this.index++);e.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+n+this.char+")")}return i=this.code,e.isIdentifierStart(i)?this.throwError("Variable names cannot start with a number ("+n+this.char+")"):(i===e.PERIOD_CODE||1===n.length&&n.charCodeAt(0)===e.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:e.LITERAL,value:parseFloat(n),raw:n}}gobbleStringLiteral(){let t="",i=this.index,n=this.expr.charAt(this.index++),r=!1;for(;this.index<this.expr.length;){let e=this.expr.charAt(this.index++);if(e===n){r=!0;break}if("\\"===e)switch(e=this.expr.charAt(this.index++),e){case"n":t+="\n";break;case"r":t+="\r";break;case"t":t+="\t";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=e}else t+=e}return r||this.throwError('Unclosed quote after "'+t+'"'),{type:e.LITERAL,value:t,raw:this.expr.substring(i,this.index)}}gobbleIdentifier(){let t=this.code,i=this.index;for(e.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,e.isIdentifierPart(t));)this.index++;return{type:e.IDENTIFIER,name:this.expr.slice(i,this.index)}}gobbleArguments(t){let i=[],n=!1,r=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let o=this.code;if(o===t){n=!0,this.index++,t===e.CPAREN_CODE&&r&&r>=i.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}if(o===e.COMMA_CODE){if(this.index++,r++,r!==i.length)if(t===e.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===e.CBRACK_CODE)for(let e=i.length;e<r;e++)i.push(null)}else if(i.length!==r&&0!==r)this.throwError("Expected comma");else{let t=this.gobbleExpression();(!t||t.type===e.COMPOUND)&&this.throwError("Expected comma"),i.push(t)}}return n||this.throwError("Expected "+String.fromCharCode(t)),i}gobbleGroup(){this.index++;let t=this.gobbleExpressions(e.CPAREN_CODE);if(this.code===e.CPAREN_CODE)return this.index++,1===t.length?t[0]:!!t.length&&{type:e.SEQUENCE_EXP,expressions:t};this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:e.ARRAY_EXP,elements:this.gobbleArguments(e.CBRACK_CODE)}}},K3e=new $6;Object.assign(ol,{hooks:K3e,plugins:new Q6(ol),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),ol.max_unop_len=ol.getMaxKeyLen(ol.unary_ops),ol.max_binop_len=ol.getMaxKeyLen(ol.binary_ops);var cg=e=>new ol(e).parse(),Z3e=Object.getOwnPropertyNames(ol);Z3e.forEach((e=>{void 0===cg[e]&&"prototype"!==e&&(cg[e]=ol[e])})),cg.Jsep=ol;var $3e="ConditionalExpression",Q3e={name:"ternary",init(e){e.hooks.add("after-expression",(function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let i=t.node,n=this.gobbleExpression();if(n||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let r=this.gobbleExpression();if(r||this.throwError("Expected expression"),t.node={type:$3e,test:i,consequent:n,alternate:r},i.operator&&e.binary_ops[i.operator]<=.9){let n=i;for(;n.right.operator&&e.binary_ops[n.right.operator]<=.9;)n=n.right;t.node.test=n.right,n.right=t.node,t.node=i}}else this.throwError("Expected :")}}))}};cg.plugins.register(Q3e);var J3e={VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18},dt=Object.freeze(J3e);function Qf(e,t){let i;this._expression=e,e=mke(hke(e=dke(e,t))),cg.addBinaryOp("=~",0),cg.addBinaryOp("!~",0);try{i=cg(e)}catch(e){throw new ue(e)}this._runtimeAst=bi(this,i)}Object.defineProperties(Qf.prototype,{expression:{get:function(){return this._expression}}});var Dn={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new U],cartesian3Array:[new h],cartesian4Array:[new oe],reset:function(){this.arrayIndex=0,this.cartesian2Index=0,this.cartesian3Index=0,this.cartesian4Index=0},getArray:function(){this.arrayIndex>=this.arrayArray.length&&this.arrayArray.push([]);let e=this.arrayArray[this.arrayIndex++];return e.length=0,e},getCartesian2:function(){return this.cartesian2Index>=this.cartesian2Array.length&&this.cartesian2Array.push(new U),this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){return this.cartesian3Index>=this.cartesian3Array.length&&this.cartesian3Array.push(new h),this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){return this.cartesian4Index>=this.cartesian4Array.length&&this.cartesian4Array.push(new oe),this.cartesian4Array[this.cartesian4Index++]}};Qf.prototype.evaluate=function(e,t){Dn.reset();let i=this._runtimeAst.evaluate(e);return t instanceof z&&i instanceof oe?z.fromCartesian4(i,t):i instanceof U||i instanceof h||i instanceof oe?i.clone(t):i},Qf.prototype.evaluateColor=function(e,t){Dn.reset();let i=this._runtimeAst.evaluate(e);return z.fromCartesian4(i,t)},Qf.prototype.getShaderFunction=function(e,t,i,n){let r=this.getShaderExpression(t,i);return r=`${n} ${e}\n{\n    return ${r};\n}\n`,r},Qf.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)},Qf.prototype.getVariables=function(){let e=[];return this._runtimeAst.getVariables(e),e=e.filter((function(e,t,i){return i.indexOf(e)===t})),e};var eke=["!","-","+"],vre=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"],dN=/\${(.*?)}/g,tke=/\\/g,nke="@#%",ike=/@#%/g,hN=new z,mN={abs:bs(Math.abs),sqrt:bs(Math.sqrt),cos:bs(Math.cos),sin:bs(Math.sin),tan:bs(Math.tan),acos:bs(Math.acos),asin:bs(Math.asin),atan:bs(Math.atan),radians:bs(P.toRadians),degrees:bs(P.toDegrees),sign:bs(P.sign),floor:bs(Math.floor),ceil:bs(Math.ceil),round:bs(Math.round),exp:bs(Math.exp),exp2:bs(rke),log:bs(Math.log),log2:bs(ske),fract:bs(oke),length:ake,normalize:cke},pN={atan2:uN(Math.atan2,!1),pow:uN(Math.pow,!1),min:uN(Math.min,!0),max:uN(Math.max,!0),distance:lke,dot:uke,cross:fke},t9={clamp:Dre(P.clamp,!0),mix:Dre(P.lerp,!0)};function oke(e){return e-Math.floor(e)}function rke(e){return Math.pow(2,e)}function ske(e){return P.log2(e)}function bs(e){return function(t,i){if("number"==typeof i)return e(i);if(i instanceof U)return U.fromElements(e(i.x),e(i.y),Dn.getCartesian2());if(i instanceof h)return h.fromElements(e(i.x),e(i.y),e(i.z),Dn.getCartesian3());if(i instanceof oe)return oe.fromElements(e(i.x),e(i.y),e(i.z),e(i.w),Dn.getCartesian4());throw new ue(`Function "${t}" requires a vector or number argument. Argument is ${i}.`)}}function uN(e,t){return function(i,n,r){if(t&&"number"==typeof r){if("number"==typeof n)return e(n,r);if(n instanceof U)return U.fromElements(e(n.x,r),e(n.y,r),Dn.getCartesian2());if(n instanceof h)return h.fromElements(e(n.x,r),e(n.y,r),e(n.z,r),Dn.getCartesian3());if(n instanceof oe)return oe.fromElements(e(n.x,r),e(n.y,r),e(n.z,r),e(n.w,r),Dn.getCartesian4())}if("number"==typeof n&&"number"==typeof r)return e(n,r);if(n instanceof U&&r instanceof U)return U.fromElements(e(n.x,r.x),e(n.y,r.y),Dn.getCartesian2());if(n instanceof h&&r instanceof h)return h.fromElements(e(n.x,r.x),e(n.y,r.y),e(n.z,r.z),Dn.getCartesian3());if(n instanceof oe&&r instanceof oe)return oe.fromElements(e(n.x,r.x),e(n.y,r.y),e(n.z,r.z),e(n.w,r.w),Dn.getCartesian4());throw new ue(`Function "${i}" requires vector or number arguments of matching types. Arguments are ${n} and ${r}.`)}}function Dre(e,t){return function(i,n,r,o){if(t&&"number"==typeof o){if("number"==typeof n&&"number"==typeof r)return e(n,r,o);if(n instanceof U&&r instanceof U)return U.fromElements(e(n.x,r.x,o),e(n.y,r.y,o),Dn.getCartesian2());if(n instanceof h&&r instanceof h)return h.fromElements(e(n.x,r.x,o),e(n.y,r.y,o),e(n.z,r.z,o),Dn.getCartesian3());if(n instanceof oe&&r instanceof oe)return oe.fromElements(e(n.x,r.x,o),e(n.y,r.y,o),e(n.z,r.z,o),e(n.w,r.w,o),Dn.getCartesian4())}if("number"==typeof n&&"number"==typeof r&&"number"==typeof o)return e(n,r,o);if(n instanceof U&&r instanceof U&&o instanceof U)return U.fromElements(e(n.x,r.x,o.x),e(n.y,r.y,o.y),Dn.getCartesian2());if(n instanceof h&&r instanceof h&&o instanceof h)return h.fromElements(e(n.x,r.x,o.x),e(n.y,r.y,o.y),e(n.z,r.z,o.z),Dn.getCartesian3());if(n instanceof oe&&r instanceof oe&&o instanceof oe)return oe.fromElements(e(n.x,r.x,o.x),e(n.y,r.y,o.y),e(n.z,r.z,o.z),e(n.w,r.w,o.w),Dn.getCartesian4());throw new ue(`Function "${i}" requires vector or number arguments of matching types. Arguments are ${n}, ${r}, and ${o}.`)}}function ake(e,t){if("number"==typeof t)return Math.abs(t);if(t instanceof U)return U.magnitude(t);if(t instanceof h)return h.magnitude(t);if(t instanceof oe)return oe.magnitude(t);throw new ue(`Function "${e}" requires a vector or number argument. Argument is ${t}.`)}function cke(e,t){if("number"==typeof t)return 1;if(t instanceof U)return U.normalize(t,Dn.getCartesian2());if(t instanceof h)return h.normalize(t,Dn.getCartesian3());if(t instanceof oe)return oe.normalize(t,Dn.getCartesian4());throw new ue(`Function "${e}" requires a vector or number argument. Argument is ${t}.`)}function lke(e,t,i){if("number"==typeof t&&"number"==typeof i)return Math.abs(t-i);if(t instanceof U&&i instanceof U)return U.distance(t,i);if(t instanceof h&&i instanceof h)return h.distance(t,i);if(t instanceof oe&&i instanceof oe)return oe.distance(t,i);throw new ue(`Function "${e}" requires vector or number arguments of matching types. Arguments are ${t} and ${i}.`)}function uke(e,t,i){if("number"==typeof t&&"number"==typeof i)return t*i;if(t instanceof U&&i instanceof U)return U.dot(t,i);if(t instanceof h&&i instanceof h)return h.dot(t,i);if(t instanceof oe&&i instanceof oe)return oe.dot(t,i);throw new ue(`Function "${e}" requires vector or number arguments of matching types. Arguments are ${t} and ${i}.`)}function fke(e,t,i){if(t instanceof h&&i instanceof h)return h.cross(t,i,Dn.getCartesian3());throw new ue(`Function "${e}" requires vec3 arguments. Arguments are ${t} and ${i}.`)}function _t(e,t,i,n,r){this._type=e,this._value=t,this._left=i,this._right=n,this._test=r,this.evaluate=void 0,Eke(this)}function dke(e,t){if(!u(t))return e;for(let i in t)if(t.hasOwnProperty(i)){let n=new RegExp(`\\$\\{${i}\\}`,"g"),r=`(${t[i]})`;u(r)&&(e=e.replace(n,r))}return e}function hke(e){return e.replace(tke,nke)}function e9(e){return e.replace(ike,"\\")}function mke(e){let t=e,i="",n=t.indexOf("${");for(;n>=0;){let e,r=t.indexOf("'"),o=t.indexOf('"');if(r>=0&&r<n)e=t.indexOf("'",r+1),i+=t.substr(0,e+1),t=t.substr(e+1),n=t.indexOf("${");else if(o>=0&&o<n)e=t.indexOf('"',o+1),i+=t.substr(0,e+1),t=t.substr(e+1),n=t.indexOf("${");else{i+=t.substr(0,n);let e=t.indexOf("}");if(e<0)throw new ue("Unmatched {.");i+=`czm_${t.substr(n+2,e-(n+2))}`,t=t.substr(e+1),n=t.indexOf("${")}}return i+=t,i}function pke(e){let t=typeof e.value;return null===e.value?new _t(dt.LITERAL_NULL,null):"boolean"===t?new _t(dt.LITERAL_BOOLEAN,e.value):"number"===t?new _t(dt.LITERAL_NUMBER,e.value):"string"===t?e.value.indexOf("${")>=0?new _t(dt.VARIABLE_IN_STRING,e.value):new _t(dt.LITERAL_STRING,e9(e.value)):void 0}function _ke(e,t){let i,n,r,o,a=t.arguments,s=a.length;if("MemberExpression"===t.callee.type){i=t.callee.property.name;let l=t.callee.object;if("test"===i||"exec"===i){if(!u(l.callee)||"regExp"!==l.callee.name)throw new ue(`${i} is not a function.`);return 0===s?"test"===i?new _t(dt.LITERAL_BOOLEAN,!1):new _t(dt.LITERAL_NULL,null):(r=bi(e,l),o=bi(e,a[0]),new _t(dt.FUNCTION_CALL,i,r,o))}if("toString"===i)return n=bi(e,l),new _t(dt.FUNCTION_CALL,i,n);throw new ue(`Unexpected function call "${i}".`)}if(i=t.callee.name,"color"===i){if(0===s)return new _t(dt.LITERAL_COLOR,i);if(n=bi(e,a[0]),u(a[1])){let t=bi(e,a[1]);return new _t(dt.LITERAL_COLOR,i,[n,t])}return new _t(dt.LITERAL_COLOR,i,[n])}if("rgb"===i||"hsl"===i){if(s<3)throw new ue(`${i} requires three arguments.`);return n=[bi(e,a[0]),bi(e,a[1]),bi(e,a[2])],new _t(dt.LITERAL_COLOR,i,n)}if("rgba"===i||"hsla"===i){if(s<4)throw new ue(`${i} requires four arguments.`);return n=[bi(e,a[0]),bi(e,a[1]),bi(e,a[2]),bi(e,a[3])],new _t(dt.LITERAL_COLOR,i,n)}if("vec2"===i||"vec3"===i||"vec4"===i){n=new Array(s);for(let t=0;t<s;++t)n[t]=bi(e,a[t]);return new _t(dt.LITERAL_VECTOR,i,n)}if("isNaN"===i||"isFinite"===i)return 0===s?new _t(dt.LITERAL_BOOLEAN,"isNaN"===i):(n=bi(e,a[0]),new _t(dt.UNARY,i,n));if("isExactClass"===i||"isClass"===i){if(s<1||s>1)throw new ue(`${i} requires exactly one argument.`);return n=bi(e,a[0]),new _t(dt.UNARY,i,n)}if("getExactClassName"===i){if(s>0)throw new ue(`${i} does not take any argument.`);return new _t(dt.UNARY,i)}if(u(mN[i])){if(1!==s)throw new ue(`${i} requires exactly one argument.`);return n=bi(e,a[0]),new _t(dt.UNARY,i,n)}if(u(pN[i])){if(2!==s)throw new ue(`${i} requires exactly two arguments.`);return r=bi(e,a[0]),o=bi(e,a[1]),new _t(dt.BINARY,i,r,o)}if(u(t9[i])){if(3!==s)throw new ue(`${i} requires exactly three arguments.`);r=bi(e,a[0]),o=bi(e,a[1]);let t=bi(e,a[2]);return new _t(dt.TERNARY,i,r,o,t)}if("Boolean"===i)return 0===s?new _t(dt.LITERAL_BOOLEAN,!1):(n=bi(e,a[0]),new _t(dt.UNARY,i,n));if("Number"===i)return 0===s?new _t(dt.LITERAL_NUMBER,0):(n=bi(e,a[0]),new _t(dt.UNARY,i,n));if("String"===i)return 0===s?new _t(dt.LITERAL_STRING,""):(n=bi(e,a[0]),new _t(dt.UNARY,i,n));if("regExp"===i)return gke(e,t);throw new ue(`Unexpected function call "${i}".`)}function gke(e,t){let i=t.arguments;if(0===i.length)return new _t(dt.LITERAL_REGEX,new RegExp);let n,r=bi(e,i[0]);if(i.length>1){let t=bi(e,i[1]);if(J6(r)&&J6(t)){try{n=new RegExp(e9(String(r._value)),t._value)}catch(e){throw new ue(e)}return new _t(dt.LITERAL_REGEX,n)}return new _t(dt.REGEX,r,t)}if(J6(r)){try{n=new RegExp(e9(String(r._value)))}catch(e){throw new ue(e)}return new _t(dt.LITERAL_REGEX,n)}return new _t(dt.REGEX,r)}function yke(e){if(Ake(e.name)){let t=Cke(e.name);return"tiles3d_"===t.substr(0,8)?new _t(dt.BUILTIN_VARIABLE,t):new _t(dt.VARIABLE,t)}if("NaN"===e.name)return new _t(dt.LITERAL_NUMBER,NaN);if("Infinity"===e.name)return new _t(dt.LITERAL_NUMBER,1/0);if("undefined"===e.name)return new _t(dt.LITERAL_UNDEFINED,void 0);throw new ue(`${e.name} is not defined.`)}function xke(e){let t=e.property.name;return"PI"===t?new _t(dt.LITERAL_NUMBER,Math.PI):"E"===t?new _t(dt.LITERAL_NUMBER,Math.E):void 0}function bke(e){if("POSITIVE_INFINITY"===e.property.name)return new _t(dt.LITERAL_NUMBER,Number.POSITIVE_INFINITY)}function Tke(e,t){if("Math"===t.object.name)return xke(t);if("Number"===t.object.name)return bke(t);let i,n=bi(e,t.object);return t.computed?(i=bi(e,t.property),new _t(dt.MEMBER,"brackets",n,i)):(i=new _t(dt.LITERAL_STRING,t.property.name),new _t(dt.MEMBER,"dot",n,i))}function J6(e){return e._type>=dt.LITERAL_NULL}function Ake(e){return"czm_"===e.substr(0,4)}function Cke(e){return e.substr(4)}function bi(e,t){let i,n,r,o;if("Literal"===t.type)i=pke(t);else if("CallExpression"===t.type)i=_ke(e,t);else if("Identifier"===t.type)i=yke(t);else if("UnaryExpression"===t.type){n=t.operator;let r=bi(e,t.argument);if(!(eke.indexOf(n)>-1))throw new ue(`Unexpected operator "${n}".`);i=new _t(dt.UNARY,n,r)}else if("BinaryExpression"===t.type){if(n=t.operator,r=bi(e,t.left),o=bi(e,t.right),!(vre.indexOf(n)>-1))throw new ue(`Unexpected operator "${n}".`);i=new _t(dt.BINARY,n,r,o)}else if("LogicalExpression"===t.type)n=t.operator,r=bi(e,t.left),o=bi(e,t.right),vre.indexOf(n)>-1&&(i=new _t(dt.BINARY,n,r,o));else if("ConditionalExpression"===t.type){let n=bi(e,t.test);r=bi(e,t.consequent),o=bi(e,t.alternate),i=new _t(dt.CONDITIONAL,"?",r,o,n)}else if("MemberExpression"===t.type)i=Tke(e,t);else{if("ArrayExpression"!==t.type)throw"Compound"===t.type?new ue("Provide exactly one expression."):new ue("Cannot parse expression.");{let n=[];for(let i=0;i<t.elements.length;i++)n[i]=bi(e,t.elements[i]);i=new _t(dt.ARRAY,n)}}return i}function Eke(e){e._type===dt.CONDITIONAL?e.evaluate=e._evaluateConditional:e._type===dt.FUNCTION_CALL?"test"===e._value?e.evaluate=e._evaluateRegExpTest:"exec"===e._value?e.evaluate=e._evaluateRegExpExec:"toString"===e._value&&(e.evaluate=e._evaluateToString):e._type===dt.UNARY?"!"===e._value?e.evaluate=e._evaluateNot:"-"===e._value?e.evaluate=e._evaluateNegative:"+"===e._value?e.evaluate=e._evaluatePositive:"isNaN"===e._value?e.evaluate=e._evaluateNaN:"isFinite"===e._value?e.evaluate=e._evaluateIsFinite:"isExactClass"===e._value?e.evaluate=e._evaluateIsExactClass:"isClass"===e._value?e.evaluate=e._evaluateIsClass:"getExactClassName"===e._value?e.evaluate=e._evaluateGetExactClassName:"Boolean"===e._value?e.evaluate=e._evaluateBooleanConversion:"Number"===e._value?e.evaluate=e._evaluateNumberConversion:"String"===e._value?e.evaluate=e._evaluateStringConversion:u(mN[e._value])&&(e.evaluate=wke(e._value)):e._type===dt.BINARY?"+"===e._value?e.evaluate=e._evaluatePlus:"-"===e._value?e.evaluate=e._evaluateMinus:"*"===e._value?e.evaluate=e._evaluateTimes:"/"===e._value?e.evaluate=e._evaluateDivide:"%"===e._value?e.evaluate=e._evaluateMod:"==="===e._value?e.evaluate=e._evaluateEqualsStrict:"!=="===e._value?e.evaluate=e._evaluateNotEqualsStrict:"<"===e._value?e.evaluate=e._evaluateLessThan:"<="===e._value?e.evaluate=e._evaluateLessThanOrEquals:">"===e._value?e.evaluate=e._evaluateGreaterThan:">="===e._value?e.evaluate=e._evaluateGreaterThanOrEquals:"&&"===e._value?e.evaluate=e._evaluateAnd:"||"===e._value?e.evaluate=e._evaluateOr:"=~"===e._value?e.evaluate=e._evaluateRegExpMatch:"!~"===e._value?e.evaluate=e._evaluateRegExpNotMatch:u(pN[e._value])&&(e.evaluate=vke(e._value)):e._type===dt.TERNARY?e.evaluate=Dke(e._value):e._type===dt.MEMBER?"brackets"===e._value?e.evaluate=e._evaluateMemberBrackets:e.evaluate=e._evaluateMemberDot:e._type===dt.ARRAY?e.evaluate=e._evaluateArray:e._type===dt.VARIABLE?e.evaluate=e._evaluateVariable:e._type===dt.VARIABLE_IN_STRING?e.evaluate=e._evaluateVariableString:e._type===dt.LITERAL_COLOR?e.evaluate=e._evaluateLiteralColor:e._type===dt.LITERAL_VECTOR?e.evaluate=e._evaluateLiteralVector:e._type===dt.LITERAL_STRING?e.evaluate=e._evaluateLiteralString:e._type===dt.REGEX?e.evaluate=e._evaluateRegExp:e._type===dt.BUILTIN_VARIABLE?"tiles3d_tileset_time"===e._value&&(e.evaluate=Ske):e.evaluate=e._evaluateLiteral}function Ske(e){return u(e)?e.content.tileset.timeSinceLoad:0}function wke(e){let t=mN[e];return function(i){let n=this._left.evaluate(i);return t(e,n)}}function vke(e){let t=pN[e];return function(i){let n=this._left.evaluate(i),r=this._right.evaluate(i);return t(e,n,r)}}function Dke(e){let t=t9[e];return function(i){let n=this._left.evaluate(i),r=this._right.evaluate(i),o=this._test.evaluate(i);return t(e,n,r,o)}}function _N(e,t){if(u(e))return e.getPropertyInherited(t)}function V0(e){return"feature"===e._value}function Ire(e){let t=e._left,i=t.length;for(let e=0;e<i;++e)if(t[e]._type!==dt.LITERAL_NUMBER)return;let n=t[0]._value,r=t[1]._value,o=t[2]._value,a=4===i?t[3]._value:1;return z.fromHsl(n,r,o,a,hN)}function Pre(e){let t=e._left,i=t.length;for(let e=0;e<i;++e)if(t[e]._type!==dt.LITERAL_NUMBER)return;let n=hN;return n.red=t[0]._value/255,n.green=t[1]._value/255,n.blue=t[2]._value/255,n.alpha=4===i?t[3]._value:1,n}function lg(e){return e%1==0?e.toFixed(1):e.toString()}function Ike(e){return`vec3(${lg(e.red)}, ${lg(e.green)}, ${lg(e.blue)})`}function fN(e){return`vec4(${lg(e.red)}, ${lg(e.green)}, ${lg(e.blue)}, ${lg(e.alpha)})`}function Ore(e,t,i,n){let r=e.length,o=new Array(r);for(let a=0;a<r;++a)o[a]=e[a].getShaderExpression(t,i,n);return o}function Rre(e,t){return u(t[e])?t[e]:Qf.NULL_SENTINEL}_t.prototype._evaluateLiteral=function(){return this._value},_t.prototype._evaluateLiteralColor=function(e){let t=hN,i=this._left;if("color"===this._value)u(i)?i.length>1?(z.fromCssColorString(i[0].evaluate(e),t),t.alpha=i[1].evaluate(e)):z.fromCssColorString(i[0].evaluate(e),t):z.fromBytes(255,255,255,255,t);else if("rgb"===this._value)z.fromBytes(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),255,t);else if("rgba"===this._value){let n=255*i[3].evaluate(e);z.fromBytes(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),n,t)}else"hsl"===this._value?z.fromHsl(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),1,t):"hsla"===this._value&&z.fromHsl(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),i[3].evaluate(e),t);return oe.fromColor(t,Dn.getCartesian4())},_t.prototype._evaluateLiteralVector=function(e){let t=Dn.getArray(),i=this._value,n=this._left,r=n.length;for(let o=0;o<r;++o){let r=n[o].evaluate(e);if("number"==typeof r)t.push(r);else if(r instanceof U)t.push(r.x,r.y);else if(r instanceof h)t.push(r.x,r.y,r.z);else{if(!(r instanceof oe))throw new ue(`${i} argument must be a vector or number. Argument is ${r}.`);t.push(r.x,r.y,r.z,r.w)}}let o=t.length,a=parseInt(i.charAt(3));if(0===o)throw new ue(`Invalid ${i} constructor. No valid arguments.`);if(o<a&&o>1)throw new ue(`Invalid ${i} constructor. Not enough arguments.`);if(o>a&&r>1)throw new ue(`Invalid ${i} constructor. Too many arguments.`);if(1===o){let e=t[0];t.push(e,e,e)}return"vec2"===i?U.fromArray(t,0,Dn.getCartesian2()):"vec3"===i?h.fromArray(t,0,Dn.getCartesian3()):"vec4"===i?oe.fromArray(t,0,Dn.getCartesian4()):void 0},_t.prototype._evaluateLiteralString=function(){return this._value},_t.prototype._evaluateVariableString=function(e){let t=this._value,i=dN.exec(t);for(;null!==i;){let n=i[0],r=_N(e,i[1]);u(r)||(r=""),t=t.replace(n,r),i=dN.exec(t)}return t},_t.prototype._evaluateVariable=function(e){return _N(e,this._value)},_t.prototype._evaluateMemberDot=function(e){if(V0(this._left))return _N(e,this._right.evaluate(e));let t=this._left.evaluate(e);if(!u(t))return;let i=this._right.evaluate(e);if(t instanceof U||t instanceof h||t instanceof oe){if("r"===i)return t.x;if("g"===i)return t.y;if("b"===i)return t.z;if("a"===i)return t.w}return t[i]},_t.prototype._evaluateMemberBrackets=function(e){if(V0(this._left))return _N(e,this._right.evaluate(e));let t=this._left.evaluate(e);if(!u(t))return;let i=this._right.evaluate(e);if(t instanceof U||t instanceof h||t instanceof oe){if(0===i||"r"===i)return t.x;if(1===i||"g"===i)return t.y;if(2===i||"b"===i)return t.z;if(3===i||"a"===i)return t.w}return t[i]},_t.prototype._evaluateArray=function(e){let t=[];for(let i=0;i<this._value.length;i++)t[i]=this._value[i].evaluate(e);return t},_t.prototype._evaluateNot=function(e){let t=this._left.evaluate(e);if("boolean"!=typeof t)throw new ue(`Operator "!" requires a boolean argument. Argument is ${t}.`);return!t},_t.prototype._evaluateNegative=function(e){let t=this._left.evaluate(e);if(t instanceof U)return U.negate(t,Dn.getCartesian2());if(t instanceof h)return h.negate(t,Dn.getCartesian3());if(t instanceof oe)return oe.negate(t,Dn.getCartesian4());if("number"==typeof t)return-t;throw new ue(`Operator "-" requires a vector or number argument. Argument is ${t}.`)},_t.prototype._evaluatePositive=function(e){let t=this._left.evaluate(e);if(!(t instanceof U||t instanceof h||t instanceof oe||"number"==typeof t))throw new ue(`Operator "+" requires a vector or number argument. Argument is ${t}.`);return t},_t.prototype._evaluateLessThan=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new ue(`Operator "<" requires number arguments. Arguments are ${t} and ${i}.`);return t<i},_t.prototype._evaluateLessThanOrEquals=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new ue(`Operator "<=" requires number arguments. Arguments are ${t} and ${i}.`);return t<=i},_t.prototype._evaluateGreaterThan=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new ue(`Operator ">" requires number arguments. Arguments are ${t} and ${i}.`);return t>i},_t.prototype._evaluateGreaterThanOrEquals=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new ue(`Operator ">=" requires number arguments. Arguments are ${t} and ${i}.`);return t>=i},_t.prototype._evaluateOr=function(e){let t=this._left.evaluate(e);if("boolean"!=typeof t)throw new ue(`Operator "||" requires boolean arguments. First argument is ${t}.`);if(t)return!0;let i=this._right.evaluate(e);if("boolean"!=typeof i)throw new ue(`Operator "||" requires boolean arguments. Second argument is ${i}.`);return t||i},_t.prototype._evaluateAnd=function(e){let t=this._left.evaluate(e);if("boolean"!=typeof t)throw new ue(`Operator "&&" requires boolean arguments. First argument is ${t}.`);if(!t)return!1;let i=this._right.evaluate(e);if("boolean"!=typeof i)throw new ue(`Operator "&&" requires boolean arguments. Second argument is ${i}.`);return t&&i},_t.prototype._evaluatePlus=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof U&&t instanceof U)return U.add(t,i,Dn.getCartesian2());if(i instanceof h&&t instanceof h)return h.add(t,i,Dn.getCartesian3());if(i instanceof oe&&t instanceof oe)return oe.add(t,i,Dn.getCartesian4());if("string"==typeof t||"string"==typeof i)return t+i;if("number"==typeof t&&"number"==typeof i)return t+i;throw new ue(`Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateMinus=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof U&&t instanceof U)return U.subtract(t,i,Dn.getCartesian2());if(i instanceof h&&t instanceof h)return h.subtract(t,i,Dn.getCartesian3());if(i instanceof oe&&t instanceof oe)return oe.subtract(t,i,Dn.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t-i;throw new ue(`Operator "-" requires vector or number arguments of matching types. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateTimes=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof U&&t instanceof U)return U.multiplyComponents(t,i,Dn.getCartesian2());if(i instanceof U&&"number"==typeof t)return U.multiplyByScalar(i,t,Dn.getCartesian2());if(t instanceof U&&"number"==typeof i)return U.multiplyByScalar(t,i,Dn.getCartesian2());if(i instanceof h&&t instanceof h)return h.multiplyComponents(t,i,Dn.getCartesian3());if(i instanceof h&&"number"==typeof t)return h.multiplyByScalar(i,t,Dn.getCartesian3());if(t instanceof h&&"number"==typeof i)return h.multiplyByScalar(t,i,Dn.getCartesian3());if(i instanceof oe&&t instanceof oe)return oe.multiplyComponents(t,i,Dn.getCartesian4());if(i instanceof oe&&"number"==typeof t)return oe.multiplyByScalar(i,t,Dn.getCartesian4());if(t instanceof oe&&"number"==typeof i)return oe.multiplyByScalar(t,i,Dn.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t*i;throw new ue(`Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateDivide=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof U&&t instanceof U)return U.divideComponents(t,i,Dn.getCartesian2());if(t instanceof U&&"number"==typeof i)return U.divideByScalar(t,i,Dn.getCartesian2());if(i instanceof h&&t instanceof h)return h.divideComponents(t,i,Dn.getCartesian3());if(t instanceof h&&"number"==typeof i)return h.divideByScalar(t,i,Dn.getCartesian3());if(i instanceof oe&&t instanceof oe)return oe.divideComponents(t,i,Dn.getCartesian4());if(t instanceof oe&&"number"==typeof i)return oe.divideByScalar(t,i,Dn.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t/i;throw new ue(`Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateMod=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof U&&t instanceof U)return U.fromElements(t.x%i.x,t.y%i.y,Dn.getCartesian2());if(i instanceof h&&t instanceof h)return h.fromElements(t.x%i.x,t.y%i.y,t.z%i.z,Dn.getCartesian3());if(i instanceof oe&&t instanceof oe)return oe.fromElements(t.x%i.x,t.y%i.y,t.z%i.z,t.w%i.w,Dn.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t%i;throw new ue(`Operator "%" requires vector or number arguments of matching types. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateEqualsStrict=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);return i instanceof U&&t instanceof U||i instanceof h&&t instanceof h||i instanceof oe&&t instanceof oe?t.equals(i):t===i},_t.prototype._evaluateNotEqualsStrict=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);return i instanceof U&&t instanceof U||i instanceof h&&t instanceof h||i instanceof oe&&t instanceof oe?!t.equals(i):t!==i},_t.prototype._evaluateConditional=function(e){let t=this._test.evaluate(e);if("boolean"!=typeof t)throw new ue(`Conditional argument of conditional expression must be a boolean. Argument is ${t}.`);return t?this._left.evaluate(e):this._right.evaluate(e)},_t.prototype._evaluateNaN=function(e){return isNaN(this._left.evaluate(e))},_t.prototype._evaluateIsFinite=function(e){return isFinite(this._left.evaluate(e))},_t.prototype._evaluateIsExactClass=function(e){return!!u(e)&&e.isExactClass(this._left.evaluate(e))},_t.prototype._evaluateIsClass=function(e){return!!u(e)&&e.isClass(this._left.evaluate(e))},_t.prototype._evaluateGetExactClassName=function(e){if(u(e))return e.getExactClassName()},_t.prototype._evaluateBooleanConversion=function(e){return!!this._left.evaluate(e)},_t.prototype._evaluateNumberConversion=function(e){return Number(this._left.evaluate(e))},_t.prototype._evaluateStringConversion=function(e){return String(this._left.evaluate(e))},_t.prototype._evaluateRegExp=function(e){let t,i=this._value.evaluate(e),n="";u(this._left)&&(n=this._left.evaluate(e));try{t=new RegExp(i,n)}catch(e){throw new ue(e)}return t},_t.prototype._evaluateRegExpTest=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(!(t instanceof RegExp&&"string"==typeof i))throw new ue(`RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${t} and ${i}.`);return t.test(i)},_t.prototype._evaluateRegExpMatch=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(t instanceof RegExp&&"string"==typeof i)return t.test(i);if(i instanceof RegExp&&"string"==typeof t)return i.test(t);throw new ue(`Operator "=~" requires one RegExp argument and one string argument. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateRegExpNotMatch=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(t instanceof RegExp&&"string"==typeof i)return!t.test(i);if(i instanceof RegExp&&"string"==typeof t)return!i.test(t);throw new ue(`Operator "!~" requires one RegExp argument and one string argument. Arguments are ${t} and ${i}.`)},_t.prototype._evaluateRegExpExec=function(e){let t=this._left.evaluate(e),i=this._right.evaluate(e);if(!(t instanceof RegExp&&"string"==typeof i))throw new ue(`RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are ${t} and ${i}.`);let n=t.exec(i);return u(n)?n[1]:null},_t.prototype._evaluateToString=function(e){let t=this._left.evaluate(e);if(t instanceof RegExp||t instanceof U||t instanceof h||t instanceof oe)return String(t);throw new ue(`Unexpected function call "${this._value}".`)},Qf.NULL_SENTINEL="czm_infinity",_t.prototype.getShaderExpression=function(e,t,i){let n,r,o,a,s,l,c,h=this._type,d=this._value;switch(u(this._left)&&(r=Array.isArray(this._left)?Ore(this._left,e,t,this):this._left.getShaderExpression(e,t,this)),u(this._right)&&(o=this._right.getShaderExpression(e,t,this)),u(this._test)&&(a=this._test.getShaderExpression(e,t,this)),Array.isArray(this._value)&&(d=Ore(this._value,e,t,this)),h){case dt.VARIABLE:return V0(this)?void 0:Rre(d,e);case dt.UNARY:if("Boolean"===d)return`bool(${r})`;if("Number"===d)return`float(${r})`;if("round"===d)return`floor(${r} + 0.5)`;if(u(mN[d]))return`${d}(${r})`;if("isNaN"===d)return`(${r} != ${r})`;if("isFinite"===d)return`(abs(${r}) < czm_infinity)`;if("String"===d||"isExactClass"===d||"isClass"===d||"getExactClassName"===d)throw new ue(`Error generating style shader: "${d}" is not supported.`);return d+r;case dt.BINARY:return"%"===d?`mod(${r}, ${o})`:"==="===d?`(${r} == ${o})`:"!=="===d?`(${r} != ${o})`:"atan2"===d?`atan(${r}, ${o})`:u(pN[d])?`${d}(${r}, ${o})`:`(${r} ${d} ${o})`;case dt.TERNARY:if(u(t9[d]))return`${d}(${r}, ${o}, ${a})`;break;case dt.CONDITIONAL:return`(${a} ? ${r} : ${o})`;case dt.MEMBER:return V0(this._left)?Rre(o,e):"r"===o||"x"===o||"0.0"===o?`${r}[0]`:"g"===o||"y"===o||"1.0"===o?`${r}[1]`:"b"===o||"z"===o||"2.0"===o?`${r}[2]`:"a"===o||"w"===o||"3.0"===o?`${r}[3]`:`${r}[int(${o})]`;case dt.FUNCTION_CALL:throw new ue(`Error generating style shader: "${d}" is not supported.`);case dt.ARRAY:if(4===d.length)return`vec4(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]})`;if(3===d.length)return`vec3(${d[0]}, ${d[1]}, ${d[2]})`;if(2===d.length)return`vec2(${d[0]}, ${d[1]})`;throw new ue("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case dt.REGEX:throw new ue("Error generating style shader: Regular expressions are not supported.");case dt.VARIABLE_IN_STRING:throw new ue("Error generating style shader: Converting a variable to a string is not supported.");case dt.LITERAL_NULL:return Qf.NULL_SENTINEL;case dt.LITERAL_BOOLEAN:return d?"true":"false";case dt.LITERAL_NUMBER:return lg(d);case dt.LITERAL_STRING:if(u(i)&&i._type===dt.MEMBER&&("r"===d||"g"===d||"b"===d||"a"===d||"x"===d||"y"===d||"z"===d||"w"===d||V0(i._left)))return d;if(n=z.fromCssColorString(d,hN),u(n))return Ike(n);throw new ue("Error generating style shader: String literals are not supported.");case dt.LITERAL_COLOR:if(s=r,"color"===d){if(!u(s))return"vec4(1.0)";if(s.length>1){let e=s[0],i=s[1];return"1.0"!==i&&(t.translucent=!0),`vec4(${e}, ${i})`}return`vec4(${s[0]}, 1.0)`}if("rgb"===d)return n=Pre(this),u(n)?fN(n):`vec4(${s[0]} / 255.0, ${s[1]} / 255.0, ${s[2]} / 255.0, 1.0)`;if("rgba"===d)return"1.0"!==s[3]&&(t.translucent=!0),n=Pre(this),u(n)?fN(n):`vec4(${s[0]} / 255.0, ${s[1]} / 255.0, ${s[2]} / 255.0, ${s[3]})`;if("hsl"===d)return n=Ire(this),u(n)?fN(n):`vec4(czm_HSLToRGB(vec3(${s[0]}, ${s[1]}, ${s[2]})), 1.0)`;if("hsla"===d)return n=Ire(this),u(n)?(1!==n.alpha&&(t.translucent=!0),fN(n)):("1.0"!==s[3]&&(t.translucent=!0),`vec4(czm_HSLToRGB(vec3(${s[0]}, ${s[1]}, ${s[2]})), ${s[3]})`);break;case dt.LITERAL_VECTOR:l=r.length,c=`${d}(`;for(let e=0;e<l;++e)c+=r[e],e<l-1&&(c+=", ");return c+=")",c;case dt.LITERAL_REGEX:throw new ue("Error generating style shader: Regular expressions are not supported.");case dt.LITERAL_UNDEFINED:return Qf.NULL_SENTINEL;case dt.BUILTIN_VARIABLE:if("tiles3d_tileset_time"===d)return d}},_t.prototype.getVariables=function(e,t){let i,n,r,o,a=this._type,s=this._value;if(u(this._left))if(Array.isArray(this._left))for(i=this._left,n=i.length,r=0;r<n;++r)i[r].getVariables(e,this);else this._left.getVariables(e,this);if(u(this._right)&&this._right.getVariables(e,this),u(this._test)&&this._test.getVariables(e,this),Array.isArray(this._value))for(i=this._value,n=i.length,r=0;r<n;++r)i[r].getVariables(e,this);switch(a){case dt.VARIABLE:V0(this)||e.push(s);break;case dt.VARIABLE_IN_STRING:for(o=dN.exec(s);null!==o;)e.push(o[1]),o=dN.exec(s);break;case dt.LITERAL_STRING:u(t)&&t._type===dt.MEMBER&&V0(t._left)&&e.push(s)}};var Jf=Qf;function rp(e){e=y(e,y.EMPTY_OBJECT),this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=y(e.center,h.ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=z.clone(z.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=y(e.classificationType,zn.BOTH),this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._uniformMap=e._uniformMap,this._pickId=e._pickId,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};let t=this._batchIds.length;for(let e=0;e<t;++e){let t=this._batchIds[e];this._batchIdLookUp[t]=e}}Object.defineProperties(rp.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});var Pke={position:0,a_batchId:1};function Oke(e,t){if(u(e._va))return;let i=ut.createVertexBuffer({context:t,typedArray:e._positions,usage:Be.STATIC_DRAW}),n=ut.createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:Be.STATIC_DRAW}),r=ut.createIndexBuffer({context:t,typedArray:e._indices,usage:Be.DYNAMIC_DRAW,indexDatatype:2===e._indices.BYTES_PER_ELEMENT?ke.UNSIGNED_SHORT:ke.UNSIGNED_INT}),o=[{index:0,vertexBuffer:i,componentDatatype:X.fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:n,componentDatatype:X.fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new ni({context:t,attributes:o,indexBuffer:r}),t.webgl2&&(e._vaSwap=new ni({context:t,attributes:o,indexBuffer:ut.createIndexBuffer({context:t,sizeInBytes:r.sizeInBytes,usage:Be.DYNAMIC_DRAW,indexDatatype:r.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0}function Rke(e,t){if(u(e._sp))return;let i=e._batchTable,n=y(e._attributeLocations,Pke),r=e._pickId,o=e._vertexShaderSource,a=e._fragmentShaderSource;if(u(o))return e._sp=Kt.fromCache({context:t,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:n}),e._spStencil=e._sp,a=He.replaceMain(a,"czm_non_pick_main"),a=`${a}void main() \n{ \n    czm_non_pick_main(); \n    out_FragColor = ${r}; \n} \n`,void(e._spPick=Kt.fromCache({context:t,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:n}));let s=i.getVertexShaderCallback(!1,"a_batchId",void 0)(pw),l=i.getFragmentShaderCallback(!1,void 0,!0)(k0);r=i.getPickId();let c=new He({sources:[s]}),h=new He({defines:["VECTOR_TILE"],sources:[l]});e._sp=Kt.fromCache({context:t,vertexShaderSource:c,fragmentShaderSource:h,attributeLocations:n}),c=new He({sources:[pw]}),h=new He({defines:["VECTOR_TILE"],sources:[k0]}),e._spStencil=Kt.fromCache({context:t,vertexShaderSource:c,fragmentShaderSource:h,attributeLocations:n}),l=He.replaceMain(l,"czm_non_pick_main"),l=`${l}\nvoid main() \n{ \n    czm_non_pick_main(); \n    out_FragColor = ${r}; \n} \n`;let d=new He({sources:[s]}),p=new He({defines:["VECTOR_TILE"],sources:[l]});e._spPick=Kt.fromCache({context:t,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:n})}function Mre(e){let t=e?Un.EQUAL:Un.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:ft.KEEP,zFail:ft.DECREMENT_WRAP,zPass:ft.KEEP},backFunction:t,backOperation:{fail:ft.KEEP,zFail:ft.INCREMENT_WRAP,zPass:ft.KEEP},reference:Lt.CESIUM_3D_TILE_MASK,mask:Lt.CESIUM_3D_TILE_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:yc.LESS_OR_EQUAL},depthMask:!1}}var Mke={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Lt.CLASSIFICATION_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND},Lke={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Lt.CLASSIFICATION_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function Nke(e){u(e._rsStencilDepthPass)||(e._rsStencilDepthPass=Ue.fromCache(Mre(!1)),e._rsStencilDepthPass3DTiles=Ue.fromCache(Mre(!0)),e._rsColorPass=Ue.fromCache(Mke),e._rsPickPass=Ue.fromCache(Lke))}var U0=new L,Lre=new h;function Fke(e,t){if(u(e._uniformMap))return;let i={u_modifiedModelViewProjection:function(){let i=t.uniformState.view,n=t.uniformState.projection;return L.clone(i,U0),L.multiplyByPoint(U0,e._center,Lre),L.setTranslation(U0,Lre,U0),L.multiply(n,U0,U0),U0},u_highlightColor:function(){return e._highlightColor}};e._uniformMap=e._batchTable.getUniformMapCallback()(i)}function n9(e,t,i,n,r,o,a){let s=e.constructor.BYTES_PER_ELEMENT,l=o.length;for(let u=0;u<l;++u){let l=a[o[u]],c=n[l],h=r[l],d=new e.constructor(e.buffer,s*c,h);t.set(d,i),n[l]=i,i+=h}return i}function Bke(e,t){let i=e._indices,n=e._indexOffsets,r=e._indexCounts,o=e._batchIdLookUp,a=new i.constructor(i.length),s=t.pop(),l=[s],u=n9(i,a,0,n,r,s.batchIds,o);for(s.offset=0,s.count=u;t.length>0;){let e=t.pop();if(z.equals(e.color,s.color))u=n9(i,a,u,n,r,e.batchIds,o),s.batchIds=s.batchIds.concat(e.batchIds),s.count=u-s.offset;else{let t=u;u=n9(i,a,u,n,r,e.batchIds,o),e.offset=t,e.count=u-t,l.push(e),s=e}}e._va.indexBuffer.copyFromArrayView(a),e._indices=a,e._batchedIndices=l}function i9(e,t,i,n,r,o,a){let s=e.bytesPerIndex,l=o.length;for(let u=0;u<l;++u){let l=a[o[u]],c=n[l],h=r[l];t.copyFromBuffer(e,c*s,i*s,h*s),n[l]=i,i+=h}return i}function kke(e,t){let i=e._indexOffsets,n=e._indexCounts,r=e._batchIdLookUp,o=t.pop(),a=[o],s=e._va.indexBuffer,l=e._vaSwap.indexBuffer,u=i9(s,l,0,i,n,o.batchIds,r);for(o.offset=0,o.count=u;t.length>0;){let e=t.pop();if(z.equals(e.color,o.color))u=i9(s,l,u,i,n,e.batchIds,r),o.batchIds=o.batchIds.concat(e.batchIds),o.count=u-o.offset;else{let t=u;u=i9(s,l,u,i,n,e.batchIds,r),e.offset=t,e.count=u-t,a.push(e),o=e}}let c=e._va;e._va=e._vaSwap,e._vaSwap=c,e._batchedIndices=a}function Vke(e,t){return t.color.toRgba()-e.color.toRgba()}function Uke(e,t){if(!e._batchDirty)return!1;let i=e._batchedIndices,n=i.length,r=!1,o={};for(let e=0;e<n;++e){let t=i[e].color.toRgba();if(u(o[t])){r=!0;break}o[t]=!0}return r?r&&!e.forceRebatch&&e._framesSinceLastRebatch<120?void++e._framesSinceLastRebatch:(i.sort(Vke),t.webgl2?kke(e,i):Bke(e,i),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0,!0):(e._batchDirty=!1,!1)}function zke(e,t){let i=Uke(e,t),n=e._commands,r=e._batchedIndices,o=r.length,a=2*o;if(u(n)&&!i&&n.length===a)return;n.length=a;let s=e._va,l=e._sp,c=y(e._modelMatrix,L.IDENTITY),h=e._uniformMap,d=e._boundingVolume;for(let t=0;t<o;++t){let i=r[t].offset,o=r[t].count,a=n[2*t];u(a)||(a=n[2*t]=new et({owner:e})),a.vertexArray=s,a.modelMatrix=c,a.offset=i,a.count=o,a.renderState=e._rsStencilDepthPass,a.shaderProgram=l,a.uniformMap=h,a.boundingVolume=d,a.cull=!1,a.pass=Ee.TERRAIN_CLASSIFICATION;let p=et.shallowClone(a,a.derivedCommands.tileset);p.renderState=e._rsStencilDepthPass3DTiles,p.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=p;let f=n[2*t+1];u(f)||(f=n[2*t+1]=new et({owner:e})),f.vertexArray=s,f.modelMatrix=c,f.offset=i,f.count=o,f.renderState=e._rsColorPass,f.shaderProgram=l,f.uniformMap=h,f.boundingVolume=d,f.cull=!1,f.pass=Ee.TERRAIN_CLASSIFICATION;let m=et.shallowClone(f,f.derivedCommands.tileset);m.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,f.derivedCommands.tileset=m}e._commandsDirty=!0}function Hke(e,t){if(e.classificationType===zn.TERRAIN||!t.invertClassification||u(e._commandsIgnoreShow)&&!e._commandsDirty)return;let i=e._commands,n=e._commandsIgnoreShow,r=e._spStencil,o=i.length,a=n.length=o/2,s=0;for(let e=0;e<a;++e){let t=n[e]=et.shallowClone(i[s],n[e]);t.shaderProgram=r,t.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,s+=2}e._commandsDirty=!1}function Gke(e){if(!e._pickCommandsDirty)return;let t=e._indexOffsets.length,i=e._pickCommands;i.length=2*t;let n=e._va,r=e._spStencil,o=e._spPick,a=y(e._modelMatrix,L.IDENTITY),s=e._uniformMap;for(let l=0;l<t;++l){let t=e._indexOffsets[l],c=e._indexCounts[l],h=u(e._boundingVolumes)?e._boundingVolumes[l]:e.boundingVolume,d=i[2*l];u(d)||(d=i[2*l]=new et({owner:e,pickOnly:!0})),d.vertexArray=n,d.modelMatrix=a,d.offset=t,d.count=c,d.renderState=e._rsStencilDepthPass,d.shaderProgram=r,d.uniformMap=s,d.boundingVolume=h,d.pass=Ee.TERRAIN_CLASSIFICATION;let p=et.shallowClone(d,d.derivedCommands.tileset);p.renderState=e._rsStencilDepthPass3DTiles,p.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,d.derivedCommands.tileset=p;let f=i[2*l+1];u(f)||(f=i[2*l+1]=new et({owner:e,pickOnly:!0})),f.vertexArray=n,f.modelMatrix=a,f.offset=t,f.count=c,f.renderState=e._rsPickPass,f.shaderProgram=o,f.uniformMap=s,f.boundingVolume=h,f.pass=Ee.TERRAIN_CLASSIFICATION;let m=et.shallowClone(f,f.derivedCommands.tileset);m.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,f.derivedCommands.tileset=m}e._pickCommandsDirty=!1}function Wke(e,t){e._updatingAllCommands=!0;let i,n=e._batchIds,r=n.length;for(i=0;i<r;++i){let e=t[n[i]];e.show=!0,e.color=z.WHITE}let o=e._batchedIndices;for(r=o.length,i=0;i<r;++i)o[i].color=z.clone(z.WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}rp.prototype.createFeatures=function(e,t){let i=this._batchIds,n=i.length;for(let r=0;r<n;++r){let n=i[r];t[n]=new Fs(e,n)}},rp.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var jke=new z,qke=z.WHITE,Yke=!0,Xke=/\$/;function Nre(e,t,i,n){let r,o,a=e.classificationType,s=a!==zn.CESIUM_3D_TILE,l=a!==zn.TERRAIN,c=t.commandList,h=i.length;for(o=0;o<h;++o)s&&(r=i[o],r.pass=Ee.TERRAIN_CLASSIFICATION,c.push(r)),l&&(r=i[o].derivedCommands.tileset,r.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,c.push(r));if(t.invertClassification&&u(n))for(h=n.length,o=0;o<h;++o)c.push(n[o])}function Kke(e,t){let i=e.commandList,n=t.length;for(let e=0;e<n;e+=2){let n=t[e+1];n.pass=Ee.OPAQUE,i.push(n)}}function Zke(e){let t,i,n=e.debugWireframe===e._debugWireframe;if(n=n&&!(e.debugWireframe&&e._wireframeDirty),n)return;u(e._rsWireframe)||(e._rsWireframe=Ue.fromCache({})),e.debugWireframe?(t=e._rsWireframe,i=Ne.LINES):(t=e._rsColorPass,i=Ne.TRIANGLES);let r=e._commands,o=r.length;for(let e=0;e<o;e+=2){let n=r[e+1];n.renderState=t,n.primitiveType=i}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}rp.prototype.applyStyle=function(e,t){if(!u(e))return void Wke(this,t);let i=e.color,n=i instanceof Jf&&!Xke.test(i.expression);this._updatingAllCommands=n;let r,o=this._batchIds,a=o.length;for(r=0;r<a;++r){let i=t[o[r]];i.color=u(e.color)?e.color.evaluateColor(i,jke):qke,i.show=u(e.show)?e.show.evaluate(i):Yke}if(n){let e=this._batchedIndices;for(a=e.length,r=0;r<a;++r)e[r].color=z.clone(z.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}},rp.prototype.updateCommands=function(e,t){if(this._updatingAllCommands)return;let i=this._batchIdLookUp,n=i[e];if(!u(n))return;let r,o=this._indexOffsets,a=this._indexCounts,s=o[n],l=a[n],c=this._batchedIndices,h=c.length;for(r=0;r<h;++r){let e=c[r].offset,t=c[r].count;if(s>=e&&s<e+t)break}c.push(new op({color:z.clone(t),offset:s,count:l,batchIds:[e]}));let d=[],p=[],f=c[r].batchIds,m=f.length;for(let t=0;t<m;++t){let n=f[t];n!==e&&(o[i[n]]<s?d.push(n):p.push(n))}0!==p.length&&c.push(new op({color:z.clone(c[r].color),offset:s+l,count:c[r].offset+c[r].count-(s+l),batchIds:p})),0!==d.length?(c[r].count=s-c[r].offset,c[r].batchIds=d):c.splice(r,1),this._batchDirty=!0},rp.prototype.update=function(e){let t=e.context;Oke(this,t),Rke(this,t),Nke(this),Fke(this,t);let i=e.passes;i.render&&(zke(this,t),Hke(this,e),Zke(this),this._debugWireframe?Kke(e,this._commands):Nre(this,e,this._commands,this._commandsIgnoreShow)),i.pick&&(Gke(this),Nre(this,e,this._pickCommands))},rp.prototype.isDestroyed=function(){return!1},rp.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),le(this)};var dA=rp;function Ul(e){this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,u(this._center)||(u(this._boundingVolume)?this._center=h.clone(this._boundingVolume.center):this._center=h.clone(h.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=zn.BOTH}function $ke(e){let t=new Float64Array(L.packedLength+h.packedLength),i=0;return h.pack(e._center,t,i),i+=h.packedLength,L.pack(e._modelMatrix,t,i),t}function Qke(e,t){let i=0,n=t[i++],r=t[i++],o=e._boundingVolumes=new Array(r);for(let e=0;e<r;++e)o[e]=se.unpack(t,i),i+=se.packedLength;let a=t[i++],s=e._batchedIndices=new Array(a);for(let e=0;e<a;++e){let n=z.unpack(t,i);i+=z.packedLength;let r=t[i++],o=t[i++],a=t[i++],l=new Array(a);for(let e=0;e<a;++e)l[e]=t[i++];s[e]=new op({color:n,offset:r,count:o,batchIds:l})}return n}Object.defineProperties(Ul.prototype,{trianglesLength:{get:function(){return u(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return u(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}}),Ul.packedBoxLength=L.packedLength+h.packedLength,Ul.packedCylinderLength=L.packedLength+2,Ul.packedEllipsoidLength=L.packedLength+h.packedLength,Ul.packedSphereLength=h.packedLength+1;var Jke=new pi("createVectorTileGeometries",5),eVe=new z;function tVe(e){if(!u(e._primitive)&&!u(e._verticesPromise)){let t=e._boxes,i=e._boxBatchIds,n=e._cylinders,r=e._cylinderBatchIds,o=e._ellipsoids,a=e._ellipsoidBatchIds,s=e._spheres,l=e._sphereBatchIds,c=e._batchTableColors,h=e._packedBuffer;if(!u(c)){let d=0;u(e._boxes)&&(t=e._boxes=t.slice(),i=e._boxBatchIds=i.slice(),d+=i.length),u(e._cylinders)&&(n=e._cylinders=n.slice(),r=e._cylinderBatchIds=r.slice(),d+=r.length),u(e._ellipsoids)&&(o=e._ellipsoids=o.slice(),a=e._ellipsoidBatchIds=a.slice(),d+=a.length),u(e._spheres)&&(s=e._sphere=s.slice(),l=e._sphereBatchIds=l.slice(),d+=l.length),c=e._batchTableColors=new Uint32Array(d);let p=e._batchTable;for(let e=0;e<d;++e){let t=p.getColor(e,eVe);c[e]=t.toRgba()}h=e._packedBuffer=$ke(e)}let d=[];u(t)&&d.push(t.buffer,i.buffer),u(n)&&d.push(n.buffer,r.buffer),u(o)&&d.push(o.buffer,a.buffer),u(s)&&d.push(s.buffer,l.buffer),d.push(c.buffer,h.buffer);let p={boxes:u(t)?t.buffer:void 0,boxBatchIds:u(t)?i.buffer:void 0,cylinders:u(n)?n.buffer:void 0,cylinderBatchIds:u(n)?r.buffer:void 0,ellipsoids:u(o)?o.buffer:void 0,ellipsoidBatchIds:u(o)?a.buffer:void 0,spheres:u(s)?s.buffer:void 0,sphereBatchIds:u(s)?l.buffer:void 0,batchTableColors:c.buffer,packedBuffer:h.buffer},f=e._verticesPromise=Jke.scheduleTask(p,d);return u(f)?f.then((function(t){if(e.isDestroyed())return;let i=new Float64Array(t.packedBuffer);2===Qke(e,i)?e._indices=new Uint16Array(t.indices):e._indices=new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._positions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds),e._batchIds=new Uint16Array(t.batchIds),nVe(e),e._ready=!0})).catch((t=>{e.isDestroyed()||(e._error=t)})):void 0}}function nVe(e){u(e._primitive)||(e._primitive=new dA({batchTable:e._batchTable,positions:e._positions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center,pickObject:y(e._pickObject,e)}),e._boxes=void 0,e._boxBatchIds=void 0,e._cylinders=void 0,e._cylinderBatchIds=void 0,e._ellipsoids=void 0,e._ellipsoidBatchIds=void 0,e._spheres=void 0,e._sphereBatchIds=void 0,e._center=void 0,e._modelMatrix=void 0,e._batchTable=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._indices=void 0,e._indexOffsets=void 0,e._indexCounts=void 0,e._positions=void 0,e._vertexBatchIds=void 0,e._batchIds=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._verticesPromise=void 0)}Ul.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},Ul.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},Ul.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},Ul.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},Ul.prototype.update=function(e){if(this._ready)this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e);else if(u(this._promise)||(this._promise=tVe(this)),u(this._error)){let e=this._error;throw this._error=void 0,e}},Ul.prototype.isDestroyed=function(){return!1},Ul.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),le(this)};var ug=Ul;function sp(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._geometries=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._ready=!1,rVe(this,n,r)}function iVe(e){return function(t,i){u(e._geometries)&&e._geometries.updateCommands(t,i)}}function oVe(e,t){let i,n,r,o,a,s=y(e.BOXES_LENGTH,0),l=y(e.CYLINDERS_LENGTH,0),c=y(e.ELLIPSOIDS_LENGTH,0),h=y(e.SPHERES_LENGTH,0);if(s>0&&u(e.BOX_BATCH_IDS)){let n=t.byteOffset+e.BOX_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,n,s)}if(l>0&&u(e.CYLINDER_BATCH_IDS)){let i=t.byteOffset+e.CYLINDER_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,i,l)}if(c>0&&u(e.ELLIPSOID_BATCH_IDS)){let i=t.byteOffset+e.ELLIPSOID_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,i,c)}if(h>0&&u(e.SPHERE_BATCH_IDS)){let i=t.byteOffset+e.SPHERE_BATCH_IDS.byteOffset;o=new Uint16Array(t.buffer,i,h)}let d=u(i)||u(n)||u(r)||u(o),p=s>0&&!u(i)||l>0&&!u(n)||c>0&&!u(r)||h>0&&!u(o);if(d&&p)throw new ue("If one group of batch ids is defined, then all batch ids must be defined");if(!(u(i)||u(n)||u(r)||u(o))){let e=0;if(!u(i)&&s>0)for(i=new Uint16Array(s),a=0;a<s;++a)i[a]=e++;if(!u(n)&&l>0)for(n=new Uint16Array(l),a=0;a<l;++a)n[a]=e++;if(!u(r)&&c>0)for(r=new Uint16Array(c),a=0;a<c;++a)r[a]=e++;if(!u(o)&&h>0)for(o=new Uint16Array(h),a=0;a<h;++a)o[a]=e++}return{boxes:i,cylinders:n,ellipsoids:r,spheres:o}}Object.defineProperties(sp.prototype,{featuresLength:{get:function(){return u(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return u(this._geometries)?this._geometries.trianglesLength:0}},geometryByteLength:{get:function(){return u(this._geometries)?this._geometries.geometryByteLength:0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return u(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});var z0=Uint32Array.BYTES_PER_ELEMENT;function rVe(e,t,i){i=y(i,0);let n=new Uint8Array(t),r=new DataView(t);i+=z0;let o=r.getUint32(i,!0);if(1!==o)throw new ue(`Only Geometry tile version 1 is supported.  Version ${o} is not.`);i+=z0;let a=r.getUint32(i,!0);if(i+=z0,0===a)return void(e._ready=!0);let s=r.getUint32(i,!0);if(i+=z0,0===s)throw new ue("Feature table must have a byte length greater than zero");let l=r.getUint32(i,!0);i+=z0;let c=r.getUint32(i,!0);i+=z0;let d=r.getUint32(i,!0),p=So(n,i+=z0,s);i+=s;let f,m,_=new Uint8Array(t,i,l);i+=l,c>0&&(f=So(n,i,c),i+=c,d>0&&(m=new Uint8Array(t,i,d),m=new Uint8Array(m)));let g=y(p.BOXES_LENGTH,0),v=y(p.CYLINDERS_LENGTH,0),b=y(p.ELLIPSOIDS_LENGTH,0),A=y(p.SPHERES_LENGTH,0),T=g+v+b+A,E=new ag(e,T,f,m,iVe(e));if(e._batchTable=E,0===T)return;let C,x=e.tile.computedTransform;u(p.RTC_CENTER)&&(C=h.unpack(p.RTC_CENTER),L.multiplyByPoint(x,C,C));let S=oVe(p,_);if(g>0||v>0||b>0||A>0){let t,i,n,r;if(g>0){let e=_.byteOffset+p.BOXES.byteOffset;t=new Float32Array(_.buffer,e,ug.packedBoxLength*g)}if(v>0){let e=_.byteOffset+p.CYLINDERS.byteOffset;i=new Float32Array(_.buffer,e,ug.packedCylinderLength*v)}if(b>0){let e=_.byteOffset+p.ELLIPSOIDS.byteOffset;n=new Float32Array(_.buffer,e,ug.packedEllipsoidLength*b)}if(A>0){let e=_.byteOffset+p.SPHERES.byteOffset;r=new Float32Array(_.buffer,e,ug.packedSphereLength*A)}return e._geometries=new ug({boxes:t,boxBatchIds:S.boxes,cylinders:i,cylinderBatchIds:S.cylinders,ellipsoids:n,ellipsoidBatchIds:S.ellipsoids,spheres:r,sphereBatchIds:S.spheres,center:C,modelMatrix:x,batchTable:E,boundingVolume:e.tile.boundingVolume.boundingVolume}),e}return Promise.resolve(e)}function Fre(e){let t=e.featuresLength;if(!u(e._features)&&t>0){let i=new Array(t);u(e._geometries)&&e._geometries.createFeatures(e,i),e._features=i}}sp.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},sp.prototype.getFeature=function(e){return Fre(this),this._features[e]},sp.prototype.applyDebugSettings=function(e,t){u(this._geometries)&&this._geometries.applyDebugSettings(e,t)},sp.prototype.applyStyle=function(e){Fre(this),u(this._geometries)&&this._geometries.applyStyle(e,this._features)},sp.prototype.update=function(e,t){u(this._geometries)&&(this._geometries.classificationType=this._tileset.classificationType,this._geometries.debugWireframe=this._tileset.debugWireframe,this._geometries.update(t)),u(this._batchTable)&&this._geometries.ready&&(this._batchTable.update(e,t),this._ready=!0)},sp.prototype.isDestroyed=function(){return!1},sp.prototype.destroy=function(){return this._geometries=this._geometries&&this._geometries.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),le(this)};var gN=sp;function sVe(e,t){return u(e)&&u(e.extensions)&&u(e.extensions[t])}var ii=sVe;function o9(e){let t=e.lengthBits,i=e.availableCount,n=e.constant,r=e.bitstream;if(u(n))i=t;else{let n=Math.ceil(t/8);if(r.length!==n)throw new ue(`Availability bitstream must be exactly ${n} bytes long to store ${t} bits. Actual bitstream was ${r.length} bytes long.`);let o=y(e.computeAvailableCountEnabled,!1);!u(i)&&o&&(i=aVe(r,t))}this._lengthBits=t,this._availableCount=i,this._constant=n,this._bitstream=r}function aVe(e,t){let i=0;for(let n=0;n<t;n++){let t=n%8;i+=e[n>>3]>>t&1}return i}Object.defineProperties(o9.prototype,{lengthBits:{get:function(){return this._lengthBits}},availableCount:{get:function(){return this._availableCount}}}),o9.prototype.getBit=function(e){if(u(this._constant))return this._constant;let t=e>>3,i=e%8;return 1==(this._bitstream[t]>>i&1)};var _w=o9;function ap(e){let t=(e=y(e,y.EMPTY_OBJECT)).metadataTable,i=e.class,n=e.entityId,r=e.propertyTableJson;this._class=i,this._metadataTable=t,this._entityId=n,this._extensions=r.extensions,this._extras=r.extras}Object.defineProperties(ap.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),ap.prototype.hasProperty=function(e){return this._metadataTable.hasProperty(e)},ap.prototype.hasPropertyBySemantic=function(e){return this._metadataTable.hasPropertyBySemantic(e)},ap.prototype.getPropertyIds=function(e){return this._metadataTable.getPropertyIds(e)},ap.prototype.getProperty=function(e){return this._metadataTable.getProperty(this._entityId,e)},ap.prototype.setProperty=function(e,t){return this._metadataTable.setProperty(this._entityId,e,t)},ap.prototype.getPropertyBySemantic=function(e){return this._metadataTable.getPropertyBySemantic(this._entityId,e)},ap.prototype.setPropertyBySemantic=function(e,t){return this._metadataTable.setPropertyBySemantic(this._entityId,e,t)};var gw=ap,yN={QUADTREE:"QUADTREE",OCTREE:"OCTREE",getBranchingFactor:function(e){switch(e){case yN.OCTREE:return 8;case yN.QUADTREE:return 4}}},Gr=Object.freeze(yN);function Bs(){}Object.defineProperties(Bs.prototype,{class:{get:function(){de.throwInstantiationError()}}}),Bs.prototype.hasProperty=function(e){de.throwInstantiationError()},Bs.prototype.hasPropertyBySemantic=function(e){de.throwInstantiationError()},Bs.prototype.getPropertyIds=function(e){de.throwInstantiationError()},Bs.prototype.getProperty=function(e){de.throwInstantiationError()},Bs.prototype.setProperty=function(e,t){de.throwInstantiationError()},Bs.prototype.getPropertyBySemantic=function(e){de.throwInstantiationError()},Bs.prototype.setPropertyBySemantic=function(e,t){de.throwInstantiationError()},Bs.hasProperty=function(e,t,i){if(u(t[e]))return!0;let n=i.properties;if(!u(n))return!1;let r=n[e];return!(!u(r)||!u(r.default))},Bs.hasPropertyBySemantic=function(e,t,i){let n=i.propertiesBySemantic;if(!u(n))return!1;let r=n[e];return u(r)},Bs.getPropertyIds=function(e,t,i){(i=u(i)?i:[]).length=0;for(let t in e)e.hasOwnProperty(t)&&u(e[t])&&i.push(t);let n=t.properties;if(u(n))for(let t in n)n.hasOwnProperty(t)&&!u(e[t])&&u(n[t].default)&&i.push(t);return i},Bs.getProperty=function(e,t,i){let n=i.properties[e],r=t[e];Array.isArray(r)&&(r=r.slice());return r=n.handleNoData(r),!u(r)&&u(n.default)?(r=Ge(n.default,!0),n.unpackVectorAndMatrixTypes(r,true)):u(r)?(r=n.normalize(r),r=n.applyValueTransform(r),n.unpackVectorAndMatrixTypes(r,true)):void 0},Bs.setProperty=function(e,t,i,n){if(!u(i[e]))return!1;Array.isArray(t)&&(t=t.slice());let r,o=n.properties;u(o)&&(r=o[e]);return u(r)&&(t=r.packVectorAndMatrixTypes(t,!0),t=r.unapplyValueTransform(t),t=r.unnormalize(t)),i[e]=t,!0},Bs.getPropertyBySemantic=function(e,t,i){let n=i.propertiesBySemantic;if(!u(n))return;let r=n[e];return u(r)?Bs.getProperty(r.id,t,i):void 0},Bs.setPropertyBySemantic=function(e,t,i,n){let r=n.propertiesBySemantic;if(!u(r))return!1;let o=n.propertiesBySemantic[e];return!!u(o)&&Bs.setProperty(o.id,t,i,n)};var Bn=Bs;function cp(e){let t=(e=y(e,y.EMPTY_OBJECT)).subtreeMetadata,i=e.class,n=u(t.properties)?t.properties:{};this._class=i,this._properties=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(cp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),cp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)},cp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)},cp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)},cp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)},cp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)},cp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)},cp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var xN=cp,vt={INT8:"INT8",UINT8:"UINT8",INT16:"INT16",UINT16:"UINT16",INT32:"INT32",UINT32:"UINT32",INT64:"INT64",UINT64:"UINT64",FLOAT32:"FLOAT32",FLOAT64:"FLOAT64",getMinimum:function(e){switch(e){case vt.INT8:return-128;case vt.UINT8:return 0;case vt.INT16:return-32768;case vt.UINT16:return 0;case vt.INT32:return-2147483648;case vt.UINT32:return 0;case vt.INT64:return Bt.supportsBigInt()?BigInt("-9223372036854775808"):-Math.pow(2,63);case vt.UINT64:return Bt.supportsBigInt()?BigInt(0):0;case vt.FLOAT32:return-34028234663852886e22;case vt.FLOAT64:return-Number.MAX_VALUE}},getMaximum:function(e){switch(e){case vt.INT8:return 127;case vt.UINT8:return 255;case vt.INT16:return 32767;case vt.UINT16:return 65535;case vt.INT32:return 2147483647;case vt.UINT32:return 4294967295;case vt.INT64:return Bt.supportsBigInt()?BigInt("9223372036854775807"):Math.pow(2,63)-1;case vt.UINT64:return Bt.supportsBigInt()?BigInt("18446744073709551615"):Math.pow(2,64)-1;case vt.FLOAT32:return 34028234663852886e22;case vt.FLOAT64:return Number.MAX_VALUE}},isIntegerType:function(e){switch(e){case vt.INT8:case vt.UINT8:case vt.INT16:case vt.UINT16:case vt.INT32:case vt.UINT32:case vt.INT64:case vt.UINT64:return!0;default:return!1}},isUnsignedIntegerType:function(e){switch(e){case vt.UINT8:case vt.UINT16:case vt.UINT32:case vt.UINT64:return!0;default:return!1}},isVectorCompatible:function(e){switch(e){case vt.INT8:case vt.UINT8:case vt.INT16:case vt.UINT16:case vt.INT32:case vt.UINT32:case vt.FLOAT32:case vt.FLOAT64:return!0;default:return!1}},normalize:function(e,t){return Math.max(Number(e)/Number(vt.getMaximum(t)),-1)},unnormalize:function(e,t){let i=vt.getMaximum(t),n=vt.isUnsignedIntegerType(t)?0:-i;return e=P.sign(e)*Math.round(Math.abs(e)*Number(i)),(t===vt.INT64||t===vt.UINT64)&&Bt.supportsBigInt()&&(e=BigInt(e)),e>i?i:e<n?n:e},applyValueTransform:function(e,t,i){return i*e+t},unapplyValueTransform:function(e,t,i){return 0===i?0:(e-t)/i},getSizeInBytes:function(e){switch(e){case vt.INT8:case vt.UINT8:return 1;case vt.INT16:case vt.UINT16:return 2;case vt.INT32:case vt.UINT32:return 4;case vt.INT64:case vt.UINT64:return 8;case vt.FLOAT32:return 4;case vt.FLOAT64:return 8}},fromComponentDatatype:function(e){switch(e){case X.BYTE:return vt.INT8;case X.UNSIGNED_BYTE:return vt.UINT8;case X.SHORT:return vt.INT16;case X.UNSIGNED_SHORT:return vt.UINT16;case X.INT:return vt.INT32;case X.UNSIGNED_INT:return vt.UINT32;case X.FLOAT:return vt.FLOAT32;case X.DOUBLE:return vt.FLOAT64}},toComponentDatatype:function(e){switch(e){case vt.INT8:return X.BYTE;case vt.UINT8:return X.UNSIGNED_BYTE;case vt.INT16:return X.SHORT;case vt.UINT16:return X.UNSIGNED_SHORT;case vt.INT32:return X.INT;case vt.UINT32:return X.UNSIGNED_INT;case vt.FLOAT32:return X.FLOAT;case vt.FLOAT64:return X.DOUBLE}}},Jt=Object.freeze(vt);function sa(e){let t=(e=y(e,y.EMPTY_OBJECT)).id,i=e.type,n=e.componentType,r=e.enumType,o=u(n)&&Jt.isIntegerType(n)&&y(e.normalized,!1);this._id=t,this._name=e.name,this._description=e.description,this._semantic=e.semantic,this._isLegacyExtension=e.isLegacyExtension,this._type=i,this._componentType=n,this._enumType=r,this._valueType=u(r)?r.valueType:n,this._isArray=y(e.isArray,!1),this._isVariableLengthArray=y(e.isVariableLengthArray,!1),this._arrayLength=e.arrayLength,this._min=Ge(e.min,!0),this._max=Ge(e.max,!0),this._normalized=o;let a=Ge(e.offset,!0),s=Ge(e.scale,!0),l=u(a)||u(s);u(a)||(a=this.expandConstant(0,true)),u(s)||(s=this.expandConstant(1,true)),this._offset=a,this._scale=s,this._hasValueTransform=l,this._noData=Ge(e.noData,!0),this._default=Ge(e.default,!0),this._required=y(e.required,!0),this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}function cVe(e){if("ARRAY"===e.type)return!0;let t=e.type;return t!==Gt.SCALAR&&!Gt.isMatrixType(t)&&!Gt.isVectorType(t)&&(!!u(Jt[t])||!(u(e.noData)||u(e.scale)||u(e.offset)||u(e.required)||u(e.count)||u(e.array)||u(e.optional))&&void 0)}function lVe(e,t){let i,n,r,o,a=e.type,s=e.componentType,l="ARRAY"===a;return l?(i=!0,n=e.componentCount,r=!u(n)):e.array?(i=!0,n=e.count,r=!u(e.count)):(i=!1,n=void 0,r=!1),u(e.enumType)&&(o=t[e.enumType]),a===Gt.ENUM?{type:a,componentType:void 0,enumType:o,valueType:o.valueType,isArray:i,isVariableLengthArray:r,arrayLength:n}:l&&s===Gt.ENUM?{type:s,componentType:void 0,enumType:o,valueType:o.valueType,isArray:i,isVariableLengthArray:r,arrayLength:n}:a===Gt.SCALAR||Gt.isMatrixType(a)||Gt.isVectorType(a)?{type:a,componentType:s,enumType:void 0,valueType:s,isArray:i,isVariableLengthArray:r,arrayLength:n}:a===Gt.BOOLEAN||a===Gt.STRING?{type:a,componentType:void 0,enumType:void 0,valueType:void 0,isArray:i,isVariableLengthArray:r,arrayLength:n}:!l||s!==Gt.BOOLEAN&&s!==Gt.STRING?u(s)&&u(Jt[s])?{type:Gt.SCALAR,componentType:s,enumType:void 0,valueType:s,isArray:i,isVariableLengthArray:r,arrayLength:n}:u(Jt[a])?{type:Gt.SCALAR,componentType:a,enumType:void 0,valueType:a,isArray:i,isVariableLengthArray:r,arrayLength:n}:void 0:{type:s,componentType:void 0,enumType:void 0,valueType:void 0,isArray:i,isVariableLengthArray:r,arrayLength:n}}function Ure(e,t){if(!Array.isArray(e))return e===t;if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ure(e[i],t[i]))return!1;return!0}function uVe(e,t){if(!Array.isArray(t))return`value ${t} must be an array`;let i=t.length;if(!e._isVariableLengthArray&&i!==e._arrayLength)return"Array length does not match property.arrayLength";for(let n=0;n<i;n++){let i=zre(e,t[n]);if(u(i))return i}}function zre(e,t){let i=e._type,n=e._componentType,r=e._enumType,o=e._normalized;return Gt.isVectorType(i)?fVe(t,i,n):Gt.isMatrixType(i)?dVe(t,i,n):i===Gt.STRING?hVe(t):i===Gt.BOOLEAN?mVe(t):i===Gt.ENUM?pVe(t,r):_Ve(t,n,o)}function fVe(e,t,i){return Jt.isVectorCompatible(i)?t!==Gt.VEC2||e instanceof U?t!==Gt.VEC3||e instanceof h?t!==Gt.VEC4||e instanceof oe?void 0:`vector value ${e} must be a Cartesian4`:`vector value ${e} must be a Cartesian3`:`vector value ${e} must be a Cartesian2`:`componentType ${i} is incompatible with vector type ${t}`}function dVe(e,t,i){return Jt.isVectorCompatible(i)?t!==Gt.MAT2||e instanceof Ji?t!==Gt.MAT3||e instanceof $?t!==Gt.MAT4||e instanceof L?void 0:`matrix value ${e} must be a Matrix4`:`matrix value ${e} must be a Matrix3`:`matrix value ${e} must be a Matrix2`:`componentType ${i} is incompatible with matrix type ${t}`}function hVe(e){if("string"!=typeof e)return bN(e,Gt.STRING)}function mVe(e){if("boolean"!=typeof e)return bN(e,Gt.BOOLEAN)}function pVe(e,t){let i=typeof e;if(u(t))return"string"===i&&u(t.valuesByName[e])?void 0:`value ${e} is not a valid enum name for ${t.id}`}function _Ve(e,t,i){let n=typeof e;switch(t){case Jt.INT8:case Jt.UINT8:case Jt.INT16:case Jt.UINT16:case Jt.INT32:case Jt.UINT32:case Jt.FLOAT32:case Jt.FLOAT64:return"number"!==n?bN(e,t):isFinite(e)?kre(e,t,i):Vre(e,t);case Jt.INT64:case Jt.UINT64:return"number"!==n&&"bigint"!==n?bN(e,t):"number"!==n||isFinite(e)?kre(e,t,i):Vre(e,t)}}function bN(e,t){return`value ${e} does not match type ${t}`}function Bre(e,t,i){let n=`value ${e} is out of range for type ${t}`;return i&&(n+=" (normalized)"),n}function kre(e,t,i){if(i){return e<(Jt.isUnsignedIntegerType(t)?0:-1)||e>1?Bre(e,t,i):void 0}if(e<Jt.getMinimum(t)||e>Jt.getMaximum(t))return Bre(e,t,i)}function Vre(e,t){return`value ${e} of type ${t} must be finite`}function r9(e,t,i){if(!Array.isArray(e))return i(e,t);for(let n=0;n<e.length;n++)e[n]=r9(e[n],t,i);return e}sa.fromJson=function(e){let t,i=(e=y(e,y.EMPTY_OBJECT)).id,n=e.property,r=cVe(n),o=lVe(n,e.enums);return t=!!u(r)&&(r?!u(n.optional)||!n.optional:y(n.required,!1)),new sa({id:i,type:o.type,componentType:o.componentType,enumType:o.enumType,isArray:o.isArray,isVariableLengthArray:o.isVariableLengthArray,arrayLength:o.arrayLength,normalized:n.normalized,min:n.min,max:n.max,offset:n.offset,scale:n.scale,noData:n.noData,default:n.default,required:t,name:n.name,description:n.description,semantic:n.semantic,extras:n.extras,extensions:n.extensions,isLegacyExtension:r})},Object.defineProperties(sa.prototype,{id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},type:{get:function(){return this._type}},enumType:{get:function(){return this._enumType}},componentType:{get:function(){return this._componentType}},valueType:{get:function(){return this._valueType}},isArray:{get:function(){return this._isArray}},isVariableLengthArray:{get:function(){return this._isVariableLengthArray}},arrayLength:{get:function(){return this._arrayLength}},normalized:{get:function(){return this._normalized}},max:{get:function(){return this._max}},min:{get:function(){return this._min}},noData:{get:function(){return this._noData}},default:{get:function(){return this._default}},required:{get:function(){return this._required}},semantic:{get:function(){return this._semantic}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),sa.prototype.normalize=function(e){return this._normalized?r9(e,this._valueType,Jt.normalize):e},sa.prototype.unnormalize=function(e){return this._normalized?r9(e,this._valueType,Jt.unnormalize):e},sa.prototype.applyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:sa.valueTransformInPlace(e,this._offset,this._scale,Jt.applyValueTransform)},sa.prototype.unapplyValueTransform=function(e){return!this._hasValueTransform||this._isVariableLengthArray?e:sa.valueTransformInPlace(e,this._offset,this._scale,Jt.unapplyValueTransform)},sa.prototype.expandConstant=function(e,t){t=y(t,!1);let i=this._isArray,n=this._arrayLength,r=Gt.getComponentCount(this._type),o=i&&r>1;if(!i&&1===r)return e;if(!i)return new Array(r).fill(e);if(!o)return new Array(n).fill(e);if(!t)return new Array(this._arrayLength*r).fill(e);let a=new Array(r).fill(e);return new Array(this._arrayLength).fill(a)},sa.prototype.handleNoData=function(e){let t=this._noData;return u(t)&&Ure(e,t)?void 0:e},sa.prototype.unpackVectorAndMatrixTypes=function(e,t){t=y(t,!1);let i=Gt.getMathType(this._type),n=this._isArray,r=Gt.getComponentCount(this._type),o=n&&r>1;return u(i)?t&&o?e.map((function(e){return i.unpack(e)})):n?i.unpackArray(e):i.unpack(e):e},sa.prototype.packVectorAndMatrixTypes=function(e,t){t=y(t,!1);let i=Gt.getMathType(this._type),n=this._isArray,r=Gt.getComponentCount(this._type),o=n&&r>1;return u(i)?t&&o?e.map((function(e){return i.pack(e,[])})):n?i.packArray(e,[]):i.pack(e,[]):e},sa.prototype.validate=function(e){if(u(e)||!u(this._default))return this._required&&!u(e)?"required property must have a value":this._isArray?uVe(this,e):zre(this,e)},sa.valueTransformInPlace=function(e,t,i,n){if(!Array.isArray(e))return n(e,t,i);for(let r=0;r<e.length;r++)e[r]=sa.valueTransformInPlace(e[r],t[r],i[r],n);return e};var H0=sa;function yw(e){let t,i=(e=y(e,y.EMPTY_OBJECT)).count,n=e.property,r=e.classProperty,o=e.bufferViews,a=r.type,s=r.isArray,l=r.isVariableLengthArray,c=r.valueType,h=r.enumType,d=a===Gt.STRING,p=a===Gt.BOOLEAN,f=0;if(l){let e=y(n.arrayOffsetType,n.offsetType);e=y(Jt[e],Jt.UINT32),t=new s9(o[y(n.arrayOffsets,n.arrayOffsetBufferView)],e,i+1),f+=t.typedArray.byteLength}let m,_=Gt.getComponentCount(a);m=l?t.get(i)-t.get(0):s?i*r.arrayLength:i;let g,v,b=_*m;if(d){let e=y(n.stringOffsetType,n.offsetType);e=y(Jt[e],Jt.UINT32),g=new s9(o[y(n.stringOffsets,n.stringOffsetBufferView)],e,b+1),f+=g.typedArray.byteLength}(d||p)&&(c=Jt.UINT8),v=d?g.get(b)-g.get(0):p?Math.ceil(b/8):b;let A=new s9(o[y(n.values,n.bufferView)],c,v);f+=A.typedArray.byteLength;let T=n.offset,E=n.scale,C=r.hasValueTransform||u(T)||u(E);T=y(T,r.offset),E=y(E,r.scale),T=Hre(T),E=Hre(E);let x,S,w=this;d?x=function(e){return xVe(e,w._values,w._stringOffsets)}:p?(x=function(e){return bVe(e,w._values)},S=function(e,t){TVe(e,w._values,t)}):u(h)?(x=function(e){let t=w._values.get(e);return h.namesByValue[t]},S=function(e,t){let i=h.valuesByName[t];w._values.set(e,i)}):(x=function(e){return w._values.get(e)},S=function(e,t){w._values.set(e,t)}),this._arrayOffsets=t,this._stringOffsets=g,this._values=A,this._classProperty=r,this._count=i,this._vectorComponentCount=_,this._min=n.min,this._max=n.max,this._offset=T,this._scale=E,this._hasValueTransform=C,this._getValue=x,this._setValue=S,this._unpackedValues=void 0,this._extras=n.extras,this._extensions=n.extensions,this._byteLength=f}function Hre(e){if(!Array.isArray(e))return e;let t=[];for(let i=0;i<e.length;i++){let n=e[i];Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}function gVe(e,t){Wre(e)&&jre(e);let i=e._classProperty,n=i.isArray,r=i.type,o=Gt.getComponentCount(r);if(u(e._unpackedValues)){let i=e._unpackedValues[t];return n?Ge(i,!0):i}return n||1!==o?Gre(e,i,t):e._getValue(t)}function Gre(e,t,i){let n,r;if(t.isVariableLengthArray){n=e._arrayOffsets.get(i),r=e._arrayOffsets.get(i+1)-n;let o=Gt.getComponentCount(t.type);n*=o,r*=o}else{let o=y(t.arrayLength,1)*e._vectorComponentCount;n=i*o,r=o}let o=new Array(r);for(let t=0;t<r;t++)o[t]=e._getValue(n+t);return o}function yVe(e,t,i){vVe(e,t,i)&&jre(e);let n,r,o=e._classProperty,a=o.isArray,s=o.type,l=Gt.getComponentCount(s);if(u(e._unpackedValues))return o.isArray&&(i=Ge(i,!0)),void(e._unpackedValues[t]=i);if(a||1!==l){if(o.isVariableLengthArray)n=e._arrayOffsets.get(t),r=e._arrayOffsets.get(t+1)-n;else{let i=y(o.arrayLength,1)*e._vectorComponentCount;n=t*i,r=i}for(let t=0;t<r;++t)e._setValue(n+t,i[t])}else e._setValue(t,i)}function xVe(e,t,i){let n=i.get(e),r=i.get(e+1)-n;return Il(t.typedArray,n,r)}function bVe(e,t){let i=e>>3,n=e%8;return 1==(t.typedArray[i]>>n&1)}function TVe(e,t,i){let n=e>>3,r=e%8;i?t.typedArray[n]|=1<<r:t.typedArray[n]&=~(1<<r)}function AVe(e,t){let i=t.dataView,n=8*e,r=0,o=(128&i.getUint8(n+7))>0,a=!0;for(let e=0;e<8;++e){let t=i.getUint8(n+e);o&&(a?0!==t&&(t=255&~(t-1),a=!1):t=255&~t),r+=t*Math.pow(256,e)}return o&&(r=-r),r}function CVe(e,t){let i=t.dataView,n=8*e,r=BigInt(0),o=(128&i.getUint8(n+7))>0,a=!0;for(let e=0;e<8;++e){let t=i.getUint8(n+e);o&&(a?0!==t&&(t=255&~(t-1),a=!1):t=255&~t),r+=BigInt(t)*(BigInt(1)<<BigInt(8*e))}return o&&(r=-r),r}function EVe(e,t){let i=t.dataView,n=8*e;return i.getUint32(n,!0)+4294967296*i.getUint32(n+4,!0)}function SVe(e,t){let i=t.dataView,n=8*e,r=BigInt(i.getUint32(n,!0)),o=BigInt(i.getUint32(n+4,!0));return r+BigInt(4294967296)*o}function wVe(e){switch(e){case Jt.INT8:return X.BYTE;case Jt.UINT8:return X.UNSIGNED_BYTE;case Jt.INT16:return X.SHORT;case Jt.UINT16:return X.UNSIGNED_SHORT;case Jt.INT32:return X.INT;case Jt.UINT32:return X.UNSIGNED_INT;case Jt.FLOAT32:return X.FLOAT;case Jt.FLOAT64:return X.DOUBLE}}function Wre(e){if(u(e._unpackedValues))return!1;let t=e._classProperty,i=t.type,n=t.valueType;return i===Gt.STRING||n===Jt.INT64&&!Bt.supportsBigInt64Array()||n===Jt.UINT64&&!Bt.supportsBigUint64Array()}function vVe(e,t,i){if(Wre(e))return!0;let n=e._arrayOffsets;if(u(n)){if(n.get(t+1)-n.get(t)!==i.length)return!0}return!1}function jre(e){e._unpackedValues=DVe(e),e._arrayOffsets=void 0,e._stringOffsets=void 0,e._values=void 0}function DVe(e){let t=e._count,i=new Array(t),n=e._classProperty,r=n.isArray,o=n.type,a=Gt.getComponentCount(o);if(!r&&1===a){for(let n=0;n<t;++n)i[n]=e._getValue(n);return i}for(let r=0;r<t;r++)i[r]=Gre(e,n,r);return i}function IVe(e,t){let i=e._classProperty.isVariableLengthArray;return!e._hasValueTransform||i?t:H0.valueTransformInPlace(t,e._offset,e._scale,Jt.applyValueTransform)}function PVe(e,t){let i=e._classProperty.isVariableLengthArray;return!e._hasValueTransform||i?t:H0.valueTransformInPlace(t,e._offset,e._scale,Jt.unapplyValueTransform)}function s9(e,t,i){let n,r,o,a=this;if(t===Jt.INT64)Bt.supportsBigInt()?Bt.supportsBigInt64Array()?(n=new BigInt64Array(e.buffer,e.byteOffset,i),o=function(e,t){a.typedArray[e]=BigInt(t)}):(n=new Uint8Array(e.buffer,e.byteOffset,8*i),r=function(e){return CVe(e,a)}):(It("INT64 type is not fully supported on this platform. Values greater than 2^53 - 1 or less than -(2^53 - 1) may lose precision when read."),n=new Uint8Array(e.buffer,e.byteOffset,8*i),r=function(e){return AVe(e,a)});else if(t===Jt.UINT64)Bt.supportsBigInt()?Bt.supportsBigUint64Array()?(n=new BigUint64Array(e.buffer,e.byteOffset,i),o=function(e,t){a.typedArray[e]=BigInt(t)}):(n=new Uint8Array(e.buffer,e.byteOffset,8*i),r=function(e){return SVe(e,a)}):(It("UINT64 type is not fully supported on this platform. Values greater than 2^53 - 1 may lose precision when read."),n=new Uint8Array(e.buffer,e.byteOffset,8*i),r=function(e){return EVe(e,a)});else{let r=wVe(t);n=X.createArrayBufferView(r,e.buffer,e.byteOffset,i),o=function(e,t){a.typedArray[e]=t}}u(r)||(r=function(e){return a.typedArray[e]}),this.typedArray=n,this.dataView=new DataView(n.buffer,n.byteOffset),this.get=r,this.set=o,this._componentType=t}Object.defineProperties(yw.prototype,{hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){return this._byteLength}}}),yw.prototype.get=function(e){let t=gVe(this,e);return t=this._classProperty.handleNoData(t),u(t)?(t=this._classProperty.normalize(t),t=IVe(this,t),this._classProperty.unpackVectorAndMatrixTypes(t)):(t=this._classProperty.default,this._classProperty.unpackVectorAndMatrixTypes(t))},yw.prototype.set=function(e,t){let i=this._classProperty;t=PVe(this,t=i.packVectorAndMatrixTypes(t)),yVe(this,e,t=i.unnormalize(t))},yw.prototype.getTypedArray=function(){if(u(this._values))return this._values.typedArray};var TN=yw;function ed(e){let t=(e=y(e,y.EMPTY_OBJECT)).count,i=e.class,n=0,r={};if(u(e.properties))for(let o in e.properties)if(e.properties.hasOwnProperty(o)){let a=new TN({count:t,property:e.properties[o],classProperty:i.properties[o],bufferViews:e.bufferViews});r[o]=a,n+=a.byteLength}this._count=t,this._class=i,this._properties=r,this._byteLength=n}function OVe(e,t){let i=e.properties;if(!u(i))return;let n=i[t];if(u(n)&&u(n.default)){let e=n.default;return n.isArray&&(e=Ge(e,!0)),e=n.normalize(e),n.unpackVectorAndMatrixTypes(e)}}Object.defineProperties(ed.prototype,{count:{get:function(){return this._count}},class:{get:function(){return this._class}},byteLength:{get:function(){return this._byteLength}}}),ed.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)},ed.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)},ed.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)},ed.prototype.getProperty=function(e,t){let i,n=this._properties[t];return i=u(n)?n.get(e):OVe(this._class,t),i},ed.prototype.setProperty=function(e,t,i){let n=this._properties[t];return!!u(n)&&(n.set(e,i),!0)},ed.prototype.getPropertyBySemantic=function(e,t){let i,n=this._class.propertiesBySemantic;if(u(n)&&(i=n[t]),u(i))return this.getProperty(e,i.id)},ed.prototype.setPropertyBySemantic=function(e,t,i){let n,r=this._class.propertiesBySemantic;return u(r)&&(n=r[t]),!!u(n)&&this.setProperty(e,n.id,i)},ed.prototype.getPropertyTypedArray=function(e){let t=this._properties[e];if(u(t))return t.getTypedArray()},ed.prototype.getPropertyTypedArrayBySemantic=function(e){let t,i=this._class.propertiesBySemantic;if(u(i)&&(t=i[e]),u(t))return this.getPropertyTypedArray(t.id)};var zl=ed,Aon=function(){var e,t=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if("object"!=typeof WebAssembly)return{supported:!1};function i(e){if(!e)throw new Error("Assertion failed")}function n(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function r(t,i,r,o,a){var s=e.exports.sbrk,l=s(i),u=s(o*a),c=new Uint8Array(e.exports.memory.buffer);c.set(n(r),u);var h=t(l,i,u,o,a),d=new Uint8Array(h);return d.set(c.subarray(l,l+h)),s(l-s(0)),d}function o(e){for(var t=0,i=0;i<e.length;++i){var n=e[i];t=t<n?n:t}return t}function a(e,t){if(i(2==t||4==t),4==t)return new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4);var n=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);return new Uint32Array(n)}function s(t,i,r,o,a,s,l){var u=e.exports.sbrk,c=u(r*o),h=u(r*s),d=new Uint8Array(e.exports.memory.buffer);d.set(n(i),h),t(c,r,o,a,h,l);var p=new Uint8Array(r*o);return p.set(d.subarray(c,c+r*o)),u(c-u(0)),p}return{ready:WebAssembly.instantiate(function(e){for(var i=new Uint8Array(e.length),n=0;n<e.length;++n){var r=e.charCodeAt(n);i[n]=r>96?r-97:r>64?r-39:r+4}var o=0;for(n=0;n<e.length;++n)i[o++]=i[n]<60?t[i[n]]:64*(i[n]-60)+i[++n];return i.buffer.slice(0,o)}("b9H79TebbbeJq9Geueu9Geub9Gbb9Gvuuuuueu9Gduueu9Gluuuueu9Gvuuuuub9Gouuuuuub9Gluuuub9GiuuueuiLQdilevlevlooroowwvbDDbelve9Weiiviebeoweuec:G;kekr;qiHo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWVbe8F9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWV9c9V919U9KbdE9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949wWV79P9V9UbiY9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWVbl8E9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWV9c9V919U9Kbv8A9TW79O9V9Wt9FW9U9J9V9KW69U9KW949wWV79P9V9UboE9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JWbra9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JW9c9V919U9KbwL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9p9JtbDK9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9r919HtbqL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWVT949WbkE9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OWbPa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OW9ttV9P9Wbsa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9Wbzl79IV9RbHDwebcekdXCq:fSQdbk:fxeYu8Jjjjjbcjo9Rgv8Kjjjjbcbhodnalcefae0mbabcbRb:q:kjjbc:GeV86bbavcjdfcbcjdz:tjjjb8AdnaiTmbavcjdfadalzMjjjb8Akabaefhrabcefhwavalfcbcbcjdal9RalcFe0Ez:tjjjb8AavavcjdfalzMjjjbhDcj;abal9UhodndndndndnalTmbaoc;WFbGgecjdaecjd6Ehqcbhkdninakai9pmiaDcjlfcbcjdz:tjjjb8Aaqaiak9Rakaqfai6Egxcsfgecl4cifcd4hmadakal2fhPdndndndndnaec9WGgsTmbcbhzcehHaPhOawhAxekdnaxTmbcbhAcehHaPhCinaDaAfRbbhXaDcjlfheaChoaxhQinaeaoRbbgLaX9RgXcetaXcKtcK91cr4786bbaoalfhoaecefheaLhXaQcufgQmbkaraw9Ram6miawcbamz:tjjjbgeTmiaCcefhCaeamfhwaAcefgAal6hHaAal9hmbxvkkaraw9Ram6mvawcbamz:tjjjb8AceheinawgXamfhwalaegoSmldnaraw9Ram6mbaocefheawcbamz:tjjjb8AaXmekkcbhwaoal6mvxikindnaxTmbaDazfRbbhXaDcjlfheaOhoaxhQinaeaoRbbgLaX9RgXcetaXcKtcK91cr4786bbaoalfhoaecefheaLhXaQcufgQmbkkaraA9Ram6mearaAcbamz:tjjjbgKamfgw9RcK6mdcbhYaDcjlfhAinaDcjlfaYfh8AcwhCczhLcehQindndnaQce9hmbcuhoa8ARbbmecbhodninaogecsSmeaecefhoaAaefcefRbbTmbkkcucbaecs6EhoxekaQcetc;:FFFeGhocuaQtcu7cFeGhXcbheinaoaXaAaefRbb9nfhoaecefgecz9hmbkkaoaLaoaL6geEhLaQaCaeEhCaQcetgQcw6mbkdndndndnaCcufPdiebkaKaYco4fgeaeRbbcdciaCclSEaYci4coGtV86bbaCcw9hmeawa8A8Pbb83bbawcwfa8Acwf8Pbb83bbawczfhwxdkaKaYco4fgeaeRbbceaYci4coGtV86bbkdncwaC9TgEmbinawcb86bbawcefhwxbkkcuaCtcu7h8Acbh3aAh5ina5heaEhQcbhoinaeRbbgLa8AcFeGgXaLaX6EaoaCtVhoaecefheaQcufgQmbkawao86bba5aEfh5awcefhwa3aEfg3cz6mbkcbheindnaAaefRbbgoaX6mbawao86bbawcefhwkaecefgecz9hmbkkdnaYczfgYas9pmbaAczfhAaraw9RcL0mekkaYas6meawTmeaOcefhOazcefgzal6hHawhAazalSmixbkkcbhwaHceGTmexikcbhwaHceGmdkaDaPaxcufal2falzMjjjb8AaxakfhkawmbkcbhoxokcbhoxvkaiTmekcbhoaraw9Ralcaalca0E6mialc8F9nmexdkcbhoaecufca6mdkawcbcaal9Rgez:tjjjbaefhwkawaDcjdfalzMjjjbalfab9Rhokavcjof8Kjjjjbaok9heeuaecaaeca0Eabcj;abae9Uc;WFbGgdcjdadcjd6Egdfcufad9Uae2adcl4cifcd4adV2fcefkmbcbabBd:q:kjjbk;use3u8Jjjjjbc;ae9Rgl8Kjjjjbcbhvdnaici9UgocHfae0mbabcbydN:kjjbgrc;GeV86bbalc;abfcFecjez:tjjjb8AalcUfgw9cu83ibalc8WfgD9cu83ibalcyfgq9cu83ibalcafgk9cu83ibalcKfgx9cu83ibalczfgm9cu83ibal9cu83iwal9cu83ibabaefc9WfhPabcefgsaofhednaiTmbcmcsarcb9kgzEhHcbhOcbhAcbhCcbhXcbhQindnaeaP9nmbcbhvxikaQcufhvadaCcdtfgoydbhLaocwfydbhKaoclfydbhYcbh8Adndninalc;abfavcsGcitfgoydlhEdndndnaoydbgoaL9hmbaEaYSmekdnaoaY9hmbaEaK9hmba8Acefh8AxekaoaK9hmeaEaL9hmea8Acdfh8Aka8Ac870mdaXcufhvada8AciGcx2goc:y1jjbfydbaCfcdtfydbhEadaocN1jjbfydbaCfcdtfydbhKadaoc:q1jjbfydbaCfcdtfydbhLcbhodnindnalavcsGcdtfydbaE9hmbaohYxdkcuhYavcufhvaocefgocz9hmbkkaEaOSgvaYcb9kaYaH9iGgoce7Gh3dndndndndnaYcbcsavEaoEgvcs9hmbarce9imbaEaEaAaEcefaASgvEgAcefSmecmcsavEhvkasava8Acdtc;WeGV86bbavcs9hmeaEaA9Rgvcetavc8F917hvinaeavcFb0crtavcFbGV86bbaecefheavcje6hoavcr4hvaoTmbkaEhAxdkcPhvasa8AcdtcPV86bbaEhAkavTmbavaH9imekalaXcdtfaEBdbaXcefcsGhXkaOa3fhOalc;abfaQcitfgvaKBdlavaEBdbalc;abfaQcefcsGgvcitfgoaEBdlaoaLBdbavcefhoxikavcufhva8Aclfg8Ac;ab9hmbkkdnadceaKaOScetaYaOSEcx2gvc:q1jjbfydbaCfcdtfydbgLTadavcN1jjbfydbaCfcdtfydbg8AceSGadavc:y1jjbfydbaCfcdtfydbgYcdSGaOcb9hGazGg5ce9hmbaw9cu83ibaD9cu83ibaq9cu83ibak9cu83ibax9cu83ibam9cu83ibal9cu83iwal9cu83ibcbhOkcbhEaXcufgvhodnindnalaocsGcdtfydba8A9hmbaEhKxdkcuhKaocufhoaEcefgEcz9hmbkkcbhodnindnalavcsGcdtfydbaY9hmbaohExdkcuhEavcufhvaocefgocz9hmbkkaOaLaOSg8Efh3dndnaKcm0mbaKcefhKxekcbcsa8Aa3SgvEhKa3avfh3kdndnaEcm0mbaEcefhExekcbcsaYa3SgvEhEa3avfh3kc9:cua8EEh8FaEaKcltVhocbhvdndndninavcj1jjbfRbbaocFeGSmeavcefgvcz9hmbxdkkaLaO9havcm0Va5Vmbasavc;WeV86bbxekasa8F86bbaeao86bbaecefhekdna8EmbaLaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombkaLhAkdnaKcs9hmba8AaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka8AhAkdnaEcs9hmbaYaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombkaYhAkalaXcdtfaLBdbaXcefcsGhvdndnaKPzbeeeeeeeeeeeeeebekalavcdtfa8ABdbaXcdfcsGhvkdndnaEPzbeeeeeeeeeeeeeebekalavcdtfaYBdbavcefcsGhvkalc;abfaQcitfgoaLBdlaoa8ABdbalc;abfaQcefcsGcitfgoa8ABdlaoaYBdbalc;abfaQcdfcsGcitfgoaYBdlaoaLBdbaQcifhoavhXa3hOkascefhsaocsGhQaCcifgCai6mbkkcbhvaeaP0mbcbhvinaeavfavcj1jjbfRbb86bbavcefgvcz9hmbkaeab9Ravfhvkalc;aef8KjjjjbavkZeeucbhddninadcefgdc8F0meceadtae6mbkkadcrfcFeGcr9Uci2cdfabci9U2cHfkmbcbabBdN:kjjbk:ydewu8Jjjjjbcz9Rhlcbhvdnaicvfae0mbcbhvabcbRbN:kjjbc;qeV86bbal9cb83iwabcefhoabaefc98fhrdnaiTmbcbhwcbhDindnaoar6mbcbskadaDcdtfydbgqalcwfawaqav9Rgvavc8F91gv7av9Rc507gwcdtfgkydb9Rgvc8E91c9:Gavcdt7awVhvinaoavcFb0gecrtavcFbGV86bbavcr4hvaocefhoaembkakaqBdbaqhvaDcefgDai9hmbkkcbhvaoar0mbaocbBbbaoab9RclfhvkavkBeeucbhddninadcefgdc8F0meceadtae6mbkkadcwfcFeGcr9Uab2cvfk:dvli99dui99ludnaeTmbcuadcetcuftcu7:Yhvdndncuaicuftcu7:YgoJbbbZMgr:lJbbb9p9DTmbar:Ohwxekcjjjj94hwkcbhicbhDinalclfIdbgrJbbbbJbbjZalIdbgq:lar:lMalcwfIdbgk:lMgr:varJbbbb9BEgrNhxaqarNhralcxfIdbhqdndnakJbbbb9GTmbaxhkxekJbbjZar:l:tgkak:maxJbbbb9GEhkJbbjZax:l:tgxax:marJbbbb9GEhrkdndnaqJbbj:;aqJbbj:;9GEgxJbbjZaxJbbjZ9FEavNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohmxekcjjjj94hmkdndnakJbbj:;akJbbj:;9GEgqJbbjZaqJbbjZ9FEaoNJbbbZJbbb:;akJbbbb9GEMgq:lJbbb9p9DTmbaq:OhPxekcjjjj94hPkdndnarJbbj:;arJbbj:;9GEgqJbbjZaqJbbjZ9FEaoNJbbbZJbbb:;arJbbbb9GEMgr:lJbbb9p9DTmbar:Ohsxekcjjjj94hskdndnadcl9hmbabaDfgzas86bbazcifam86bbazcdfaw86bbazcefaP86bbxekabaifgzas87ebazcofam87ebazclfaw87ebazcdfaP87ebkalczfhlaicwfhiaDclfhDaecufgembkkk;klld99eud99eudnaeTmbdndncuaicuftcu7:YgvJbbbZMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikaic;8FiGhrinabcofcicdalclfIdb:lalIdb:l9EgialcwfIdb:lalaicdtfIdb:l9EEgialcxfIdb:lalaicdtfIdb:l9EEgiarV87ebdndnalaicefciGcdtfIdbJ;Zl:1ZNJbbj:;JbbjZalaicdtfIdbJbbbb9DEgoNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabaq87ebdndnaoalaicdfciGcdtfIdbJ;Zl:1ZNNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabcdfaq87ebdndnaoalaicufciGcdtfIdbJ;Zl:1ZNNgoJbbj:;aoJbbj:;9GEgwJbbjZawJbbjZ9FEavNJbbbZJbbb:;aoJbbbb9GEMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikabclfai87ebabcwfhbalczfhlaecufgembkkk:Hvdxue998Jjjjjbcjd9Rgo8Kjjjjbadcd4hrdndndndnavcd9hmbadcl6mearcearce0EhwaohDinaDc:CuBdbaDclfhDawcufgwmbkaeTmiadcl6mdarcearce0EhqarcdthkalhxcbhminaohDaxhwaqhPinaDaDydbgsawydbgzcL4cFeGc:cufcbazEgzasaz9kEBdbawclfhwaDclfhDaPcufgPmbkaxakfhxamcefgmae9hmbkkaeTmdxekaeTmekavcb9hadcl6gqVhHarcearce0Ehkarcdthrceai9Rhmcbhdindndndnavce9hmbaqmdc:CuhwalhDakhPinawaDydbgscL4cFeGc:cufcbasEgsawas9kEhwaDclfhDaPcufgPmbxdkkc:CuhwaHmbaohDalhPakhsinaDaPydbgzcL4cFeGgxc8Aaxc8A9kEc:cufcbazEBdbaPclfhPaDclfhDascufgsmbkkaqmbcbhDakhsinawhPdnavceSmbaoaDfydbhPkdndnalaDfIdbgOcjjj;8iamaPfgPcLt9R::NJbbbZJbbb:;aOJbbbb9GEMgO:lJbbb9p9DTmbaO:Ohzxekcjjjj94hzkabaDfazcFFFrGaPcKtVBdbaDclfhDascufgsmbkkabarfhbalarfhladcefgdae9hmbkkaocjdf8Kjjjjbk;TkdCui998Jjjjjbc:qd9Rgv8Kjjjjbavc:Oefcbc;Kbz:tjjjb8AcbhodnadTmbcbhoaiTmbdnabae9hmbavcuadcdtgoadcFFFFi0Ecbyd1:kjjbHjjjjbbgeBd:OeavceBd1daeabaozMjjjb8Akavc:yefcwfcbBdbav9cb83i:yeavc:yefaeadaiavc:Oefz:njjjbcuaicdtgraicFFFFi0Egwcbyd1:kjjbHjjjjbbhoavc:Oefavyd1dgDcdtfaoBdbavaDcefgqBd1daoavyd:yegkarzMjjjbhxavc:Oefaqcdtfadci9Ugmcbyd1:kjjbHjjjjbbgoBdbavaDcdfgrBd1daocbamz:tjjjbhPavc:Oefarcdtfawcbyd1:kjjbHjjjjbbgsBdbavaDcifgqBd1daxhoashrinaralIdbalaoydbgwcwawcw6Ecdtfc;ebfIdbMUdbaoclfhoarclfhraicufgimbkavc:OefaqcdtfcuamcdtadcFFFF970Ecbyd1:kjjbHjjjjbbgqBdbavaDclfBd1ddnadci6mbamceamce0EhiaehoaqhrinarasaoydbcdtfIdbasaoclfydbcdtfIdbMasaocwfydbcdtfIdbMUdbaocxfhoarclfhraicufgimbkkavc;mbfhzavhoavyd:CehHavyd:GehOcbhwcbhrcbhAcehCinaohXcihQaearci2gLcdtfgocwfydbhKaoydbhdabaAcx2fgiclfaoclfydbgDBdbaiadBdbaicwfaKBdbaParfce86bbazaKBdwazaDBdlazadBdbaqarcdtfcbBdbdnawTmbcihQaXhiindnaiydbgoadSmbaoaDSmbaoaKSmbazaQcdtfaoBdbaQcefhQkaiclfhiawcufgwmbkkaAcefhAaxadcdtfgoaoydbcufBdbaxaDcdtfgoaoydbcufBdbaxaKcdtfgoaoydbcufBdbcbhwinaOaHaeawaLfcdtfydbcdtgifydbcdtfgKhoakaifgDydbgdhidnadTmbdninaoydbarSmeaoclfhoaicufgiTmdxbkkaoadcdtaKfc98fydbBdbaDaDydbcufBdbkawcefgwci9hmbkdndndnaQTmbcuhrJbbbbhYcbhoinasazaocdtfydbcdtgifgwIdbh8AawalcbaocefgDaocs0EcdtfIdbalaxaifydbgocwaocw6Ecdtfc;ebfIdbMgEUdbdnakaifydbgwTmbaEa8A:thEaOaHaifydbcdtfhoawcdthiinaqaoydbgwcdtfgdaEadIdbMg8AUdba8AaYaYa8A9DgdEhYawaradEhraoclfhoaic98fgimbkkaDhoaDaQ9hmbkarcu9hmekaCam9pmeindnaPaCfRbbmbaChrxdkamaCcefgC9hmbxdkkaQczaQcz6EhwazhoaXhzarcu9hmekkavyd1dhokaocdtavc:Oeffc98fhrdninaoTmearydbcbyd:e:kjjbH:bjjjbbarc98fhraocufhoxbkkavc:qdf8Kjjjjbk;UlevucuaicdtgvaicFFFFi0Egocbyd1:kjjbHjjjjbbhralalyd9GgwcdtfarBdbalawcefBd9GabarBdbaocbyd1:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdlcuadcdtadcFFFFi0Ecbyd1:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdwabydbcbavz:tjjjb8Aadci9UhwdnadTmbabydbhoaehladhrinaoalydbcdtfgvavydbcefBdbalclfhlarcufgrmbkkdnaiTmbabydbhlabydlhrcbhvaihoinaravBdbarclfhralydbavfhvalclfhlaocufgombkkdnadci6mbawceawce0EhDabydlhrabydwhvcbhlinaecwfydbhoaeclfydbhdaraeydbcdtfgwawydbgwcefBdbavawcdtfalBdbaradcdtfgdadydbgdcefBdbavadcdtfalBdbaraocdtfgoaoydbgocefBdbavaocdtfalBdbaecxfheaDalcefgl9hmbkkdnaiTmbabydlheabydbhlinaeaeydbalydb9RBdbalclfhlaeclfheaicufgimbkkkQbabaeadaic:01jjbz:mjjjbkQbabaeadaic:C:jjjbz:mjjjbk9DeeuabcFeaicdtz:tjjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk9teiucbcbyd:m:kjjbgeabcifc98GfgbBd:m:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd:m:kjjbgeabcrfc94GfgbBd:m:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd:m:kjjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd:m:kjjbfgdBd:m:kjjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akkk:Eddbcjwk:edb4:h9w9N94:P:gW:j9O:ye9Pbbbbbbebbbdbbbebbbdbbbbbbbdbbbbbbbebbbbbbb:l29hZ;69:9kZ;N;76Z;rg97Z;z;o9xZ8J;B85Z;:;u9yZ;b;k9HZ:2;Z9DZ9e:l9mZ59A8KZ:r;T3Z:A:zYZ79OHZ;j4::8::Y:D9V8:bbbb9s:49:Z8R:hBZ9M9M;M8:L;z;o8:;8:PG89q;x:J878R:hQ8::M:B;e87bbbbbbjZbbjZbbjZ:E;V;N8::Y:DsZ9i;H;68:xd;R8:;h0838:;W:NoZbbbb:WV9O8:uf888:9i;H;68:9c9G;L89;n;m9m89;D8Ko8:bbbbf:8tZ9m836ZS:2AZL;zPZZ818EZ9e:lxZ;U98F8:819E;68:bc:eqkxebbbdbbbaWbb"),{}).then((function(t){(e=t.instance).exports.__wasm_call_ctors(),e.exports.meshopt_encodeVertexVersion(0),e.exports.meshopt_encodeIndexVersion(1)})),supported:!0,reorderMesh:function(t,i,r){var a=i?r?e.exports.meshopt_optimizeVertexCacheStrip:e.exports.meshopt_optimizeVertexCache:void 0;return function(t,i,r){var o=e.exports.sbrk,a=o(4*t.length),s=o(4*i),l=new Uint8Array(e.exports.memory.buffer),u=n(t);l.set(u,a),r&&r(a,a,t.length,i);var c=e.exports.meshopt_optimizeVertexFetchRemap(s,a,t.length,i);l=new Uint8Array(e.exports.memory.buffer);var h=new Uint32Array(i);new Uint8Array(h.buffer).set(l.subarray(s,s+4*i)),u.set(l.subarray(a,a+4*t.length)),o(a-o(0));for(var d=0;d<t.length;++d)t[d]=h[t[d]];return[h,c]}(t,o(t)+1,a)},encodeVertexBuffer:function(t,n,o){i(o>0&&o<=256),i(o%4==0);var a=e.exports.meshopt_encodeVertexBufferBound(n,o);return r(e.exports.meshopt_encodeVertexBuffer,a,t,n,o)},encodeIndexBuffer:function(t,n,s){i(2==s||4==s),i(n%3==0);var l=a(t,s),u=e.exports.meshopt_encodeIndexBufferBound(n,o(l)+1);return r(e.exports.meshopt_encodeIndexBuffer,u,l,n,4)},encodeIndexSequence:function(t,n,s){i(2==s||4==s);var l=a(t,s),u=e.exports.meshopt_encodeIndexSequenceBound(n,o(l)+1);return r(e.exports.meshopt_encodeIndexSequence,u,l,n,4)},encodeGltfBuffer:function(e,t,n,r){var o={ATTRIBUTES:this.encodeVertexBuffer,TRIANGLES:this.encodeIndexBuffer,INDICES:this.encodeIndexSequence};return i(o[r]),o[r](e,t,n)},encodeFilterOct:function(t,n,r,o){return i(4==r||8==r),i(o>=1&&o<=16),s(e.exports.meshopt_encodeFilterOct,t,n,r,o,16)},encodeFilterQuat:function(t,n,r,o){return i(8==r),i(o>=4&&o<=16),s(e.exports.meshopt_encodeFilterQuat,t,n,r,o,16)},encodeFilterExp:function(t,n,r,o,a){i(r>0&&r%4==0),i(o>=1&&o<=24);return s(e.exports.meshopt_encodeFilterExp,t,n,r,o,r,a?{Separate:0,SharedVector:1,SharedComponent:2}[a]:1)}}}(),qre=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if("object"!=typeof WebAssembly)return{supported:!1};var i,n=WebAssembly.validate(e)?"b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q;Aekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq;a9tqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk;d8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhoaicefhldnadTmbaoc;WFbGgocjdaocjd6EhwcbhDinaDae9pmeawaeaD9RaDawfae6Egqcsfgoc9WGgkci2hxakcethmaocl4cifcd4hPabaDad2fhscbhzdnincehHalhOcbhAdninaraO9RaP6miavcj;cbfaAak2fhCaOaPfhlcbhidnakc;ab6mbaral9Rc;Gb6mbcbhoinaCaofhidndndndndnaOaoco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklbalczfhlkdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklzalczfhlkdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaialpbbbpklaalczfhlkdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaialpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalclfaYpQbfaXc:q:yjjbfRbbfhlxdkaialpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WalcwfaYpQbfaXc:q:yjjbfRbbfhlxekaialpbbbpkl8Walczfhlkaoc;abfhiaocjefak0meaihoaral9Rc;Fb0mbkkdndnaiak9pmbaici4hoinaral9RcK6mdaCaifhXdndndndndnaOaico4fRbbaocoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpklbxikaXalpbblalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalclfaYpQbfaKc:q:yjjbfRbbfhlxdkaXalpbbwalpbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbalcwfaYpQbfaKc:q:yjjbfRbbfhlxekaXalpbbbpklbalczfhlkaocdfhoaiczfgiak6mbkkalTmbaAci6hHalhOaAcefgAclSmdxekkcbhlaHceGmdkdnakTmbavcjdfazfhiavazfpbdbhYcbhXinaiavcj;cbfaXfgopblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLaoakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEaoamfpblbg3cep9Ta3aQp9op9Hp9rg3aoaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfgoaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaoadfgoaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaoadfgoaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaoadfgoaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaoadfhiaXczfgXak6mbkkazclfgzad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfhDc9:hoalmexikkc9:hoxekcbc99aral9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk;tzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhrcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgDc;Ve0mbavc;abfalaDcu7gPcl4fcsGcitfgsydlhzasydbhHdnaDcsGgDak9pmbavaiaPfcsGcdtfydbaxaDEhsaDThDdndnadcd9hmbabarcetfgPaH87ebaPcdfaz87ebaPclfas87ebxekabarcdtfgPaHBdbaPclfazBdbaPcwfasBdbkaxaDfhxavc;abfalcitfgPasBdbaPazBdlavaicdtfasBdbavc;abfalcefcsGglcitfgPaHBdbaPasBdlaiaDfhialcefhlxdkdndnaDcsSmbamaDfaDc987fcefhmxekaocefhDao8SbbgscFeGhPdndnascu9mmbaDhoxekaocvfhoaPcFbGhPcrhsdninaD8SbbgOcFbGastaPVhPaOcu9kmeaDcefhDascrfgsc8J9hmbxdkkaDcefhokaPce4cbaPceG9R7amfhmkdndnadcd9hmbabarcetfgDaH87ebaDcdfaz87ebaDclfam87ebxekabarcdtfgDaHBdbaDclfazBdbaDcwfamBdbkavc;abfalcitfgDamBdbaDazBdlavaicdtfamBdbavc;abfalcefcsGglcitfgDaHBdbaDamBdlaicefhialcefhlxekdnaDcpe0mbaxcefgOavaiaqaDcsGfRbbgscl49RcsGcdtfydbascz6gPEhDavaias9RcsGcdtfydbaOaPfgzascsGgOEhsaOThOdndnadcd9hmbabarcetfgHax87ebaHcdfaD87ebaHclfas87ebxekabarcdtfgHaxBdbaHclfaDBdbaHcwfasBdbkavaicdtfaxBdbavc;abfalcitfgHaDBdbaHaxBdlavaicefgicsGcdtfaDBdbavc;abfalcefcsGcitfgHasBdbaHaDBdlavaiaPfcsGgicdtfasBdbavc;abfalcdfcsGglcitfgDaxBdbaDasBdlalcefhlaiaOfhiazaOfhxxekaxcbaoRbbgHEgAaDc;:eSgDfhzaHcsGhCaHcl4hXdndnaHcs0mbazcefhOxekazhOavaiaX9RcsGcdtfydbhzkdndnaCmbaOcefhxxekaOhxavaiaH9RcsGcdtfydbhOkdndnaDTmbaocefhDxekaocdfhDao8SbegPcFeGhsdnaPcu9kmbaocofhAascFbGhscrhodninaD8SbbgPcFbGaotasVhsaPcu9kmeaDcefhDaocrfgoc8J9hmbkaAhDxekaDcefhDkasce4cbasceG9R7amfgmhAkdndnaXcsSmbaDhsxekaDcefhsaD8SbbgocFeGhPdnaocu9kmbaDcvfhzaPcFbGhPcrhodninas8SbbgDcFbGaotaPVhPaDcu9kmeascefhsaocrfgoc8J9hmbkazhsxekascefhskaPce4cbaPceG9R7amfgmhzkdndnaCcsSmbashoxekascefhoas8SbbgDcFeGhPdnaDcu9kmbascvfhOaPcFbGhPcrhDdninao8SbbgscFbGaDtaPVhPascu9kmeaocefhoaDcrfgDc8J9hmbkaOhoxekaocefhokaPce4cbaPceG9R7amfgmhOkdndnadcd9hmbabarcetfgDaA87ebaDcdfaz87ebaDclfaO87ebxekabarcdtfgDaABdbaDclfazBdbaDcwfaOBdbkavc;abfalcitfgDazBdbaDaABdlavaicdtfaABdbavc;abfalcefcsGcitfgDaOBdbaDazBdlavaicefgicsGcdtfazBdbavc;abfalcdfcsGcitfgDaABdbaDaOBdlavaiaHcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiarcifgrae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalae9pmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oawaopmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalae9pmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eaDaopmbediwDqkzHOAKY8AEgoczp:Sep;6egrp;Geaoczp:Reczp:Sep;6egwp;Gep;Kep;Legopxb;:FSb;:FSb;:FSb;:FSawaopxbbbbbbbbbbbbbbbbp:2egqawpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegwawp;Meaoaop;Mearaqaramp9op9rp;Kegoaop;Mep;Kep;Kep;Jep;Negrp;Mepxbbn0bbn0bbn0bbn0gqp;Keczp:Reawarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9op9qgwaoarp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogopmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oawaopmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalae9pmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaqakp;Mearp;Keczp:ReaDakp;Mearp;Keamp9op9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepkbbadczfhdaeclfgeav6mbkkdnaval9pmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjZbbjZbbjZbbjZp:UepxbbjFbbjFbbjFbbjFp9op;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz9Tbb":"b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q;iekr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq:78Yqdbk:qzezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9UhlaicefhodnadTmbalc;WFbGglcjdalcjd6EhDcbhqinaqae9pmeaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxdndndndnalc9WGgmTmbcbhPcehsawcjdfhzaohHinaraH9Rax6midnaraHaxfgo9RcK6mbczhlinalgic9Wfglawcj;cbffhOdndndndndnaHalco4fRbbalci4coG4ciGPlbedibkaO9cb83ibaOcwf9cb83ibxikaOaoRblaoRbbgAco4glalciSgCE86bbawcj;cbfaifglcGfaoclfaCfgORbbaAcl4ciGgCaCciSgCE86bbalcVfaOaCfgORbbaAcd4ciGgCaCciSgCE86bbalc7faOaCfgORbbaAciGgAaAciSgAE86bbalctfaOaAfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkaOaoRbwaoRbbgAcl4glalcsSgCE86bbawcj;cbfaifglcGfaocwfaCfgORbbaAcsGgAaAcsSgAE86bbalcVfaOaAfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekaOao8Pbb83bbaOcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaiczfhlarao9RcL0mekkaiam6miaoTmidnakTmbawaPfRbbhOawcj;cbfhlazhiakhHinaialRbbgAce4cbaAceG9R7aOfgO86bbaiadfhialcefhlaHcufgHmbkkazcefhzaPcefgPad6hsaohHaPad9hmexvkkcbhoasceGmdxikaoaxad2fhPdnakTmbcbhmcehsawcjdfhCinarao9Rax6miaoTmdaoaxfhoawamfRbbhOawcj;cbfhlaChiakhHinaialRbbgAce4cbaAceG9R7aOfgO86bbaiadfhialcefhlaHcufgHmbkaCcefhCamcefgmad6hsamad9hmbkaPhoxikcbhlcehsinarao9Rax6mdaoTmeaoaxfhoalcefglad6hsadal9hmbkaPhoxdkcbhoasceGTmekc9:hoxikabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekcbc99arao9Radcaadca0ESEhokavcj;ebf8Kjjjjbaok;xzeHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgDce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhqaicefgwarfhodnaeTmbcmcsaDceSEhkcbhxcbhmcbhrcbhicbhlindnaoaq9nmbc9:hoxikdndnawRbbgDc;Ve0mbavc;abfalaDcu7gPcl4fcsGcitfgsydlhzasydbhHdnaDcsGgDak9pmbavaiaPfcsGcdtfydbaxaDEhsaDThDdndnadcd9hmbabarcetfgPaH87ebaPcdfaz87ebaPclfas87ebxekabarcdtfgPaHBdbaPclfazBdbaPcwfasBdbkaxaDfhxavc;abfalcitfgPasBdbaPazBdlavaicdtfasBdbavc;abfalcefcsGglcitfgPaHBdbaPasBdlaiaDfhialcefhlxdkdndnaDcsSmbamaDfaDc987fcefhmxekaocefhDao8SbbgscFeGhPdndnascu9mmbaDhoxekaocvfhoaPcFbGhPcrhsdninaD8SbbgOcFbGastaPVhPaOcu9kmeaDcefhDascrfgsc8J9hmbxdkkaDcefhokaPce4cbaPceG9R7amfhmkdndnadcd9hmbabarcetfgDaH87ebaDcdfaz87ebaDclfam87ebxekabarcdtfgDaHBdbaDclfazBdbaDcwfamBdbkavc;abfalcitfgDamBdbaDazBdlavaicdtfamBdbavc;abfalcefcsGglcitfgDaHBdbaDamBdlaicefhialcefhlxekdnaDcpe0mbaxcefgOavaiaqaDcsGfRbbgscl49RcsGcdtfydbascz6gPEhDavaias9RcsGcdtfydbaOaPfgzascsGgOEhsaOThOdndnadcd9hmbabarcetfgHax87ebaHcdfaD87ebaHclfas87ebxekabarcdtfgHaxBdbaHclfaDBdbaHcwfasBdbkavaicdtfaxBdbavc;abfalcitfgHaDBdbaHaxBdlavaicefgicsGcdtfaDBdbavc;abfalcefcsGcitfgHasBdbaHaDBdlavaiaPfcsGgicdtfasBdbavc;abfalcdfcsGglcitfgDaxBdbaDasBdlalcefhlaiaOfhiazaOfhxxekaxcbaoRbbgHEgAaDc;:eSgDfhzaHcsGhCaHcl4hXdndnaHcs0mbazcefhOxekazhOavaiaX9RcsGcdtfydbhzkdndnaCmbaOcefhxxekaOhxavaiaH9RcsGcdtfydbhOkdndnaDTmbaocefhDxekaocdfhDao8SbegPcFeGhsdnaPcu9kmbaocofhAascFbGhscrhodninaD8SbbgPcFbGaotasVhsaPcu9kmeaDcefhDaocrfgoc8J9hmbkaAhDxekaDcefhDkasce4cbasceG9R7amfgmhAkdndnaXcsSmbaDhsxekaDcefhsaD8SbbgocFeGhPdnaocu9kmbaDcvfhzaPcFbGhPcrhodninas8SbbgDcFbGaotaPVhPaDcu9kmeascefhsaocrfgoc8J9hmbkazhsxekascefhskaPce4cbaPceG9R7amfgmhzkdndnaCcsSmbashoxekascefhoas8SbbgDcFeGhPdnaDcu9kmbascvfhOaPcFbGhPcrhDdninao8SbbgscFbGaDtaPVhPascu9kmeaocefhoaDcrfgDc8J9hmbkaOhoxekaocefhokaPce4cbaPceG9R7amfgmhOkdndnadcd9hmbabarcetfgDaA87ebaDcdfaz87ebaDclfaO87ebxekabarcdtfgDaABdbaDclfazBdbaDcwfaOBdbkavc;abfalcitfgDazBdbaDaABdlavaicdtfaABdbavc;abfalcefcsGcitfgDaOBdbaDazBdlavaicefgicsGcdtfazBdbavc;abfalcdfcsGcitfgDaABdbaDaOBdlavaiaHcz6aXcsSVfgicsGcdtfaOBdbaiaCTaCcsSVfhialcifhlkawcefhwalcsGhlaicsGhiarcifgrae6mbkkcbc99aoaqSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;siliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabavcefciGaiVcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:Ohkxekcjjjj94hkkabavcdfciGaiVcetfak87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:Ohqxekcjjjj94hqkabavcufciGaiVcetfaq87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohqxekcjjjj94hqkabavciGaiVcetfaq87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj;8ifcjjj98G::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklz9Kbb",r=WebAssembly.instantiate(o(n),{}).then((function(e){(i=e.instance).exports.__wasm_call_ctors()}));function o(e){for(var i=new Uint8Array(e.length),n=0;n<e.length;++n){var r=e.charCodeAt(n);i[n]=r>96?r-97:r>64?r-39:r+4}var o=0;for(n=0;n<e.length;++n)i[o++]=i[n]<60?t[i[n]]:64*(i[n]-60)+i[++n];return i.buffer.slice(0,o)}function a(e,t,n,r,o,a){var s=i.exports.sbrk,l=n+3&-4,u=s(l*r),c=s(o.length),h=new Uint8Array(i.exports.memory.buffer);h.set(o,c);var d=e(u,n,r,c,o.length);if(0==d&&a&&a(u,l,r),t.set(h.subarray(u,u+n*r)),s(u-s(0)),0!=d)throw new Error("Malformed buffer data: "+d)}var s={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},l={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"},u=[],c=0;function h(e){var t={object:new Worker(e),pending:0,requests:{}};return t.object.onmessage=function(e){var i=e.data;t.pending-=i.count,t.requests[i.id][i.action](i.value),delete t.requests[i.id]},t}function d(e){for(var t="var instance; var ready = WebAssembly.instantiate(new Uint8Array(["+new Uint8Array(o(n))+"]), {}).then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });self.onmessage = workerProcess;"+a.toString()+p.toString(),i=new Blob([t],{type:"text/javascript"}),r=URL.createObjectURL(i),s=0;s<e;++s)u[s]=h(r);URL.revokeObjectURL(r)}function p(e){r.then((function(){var t=e.data;try{var n=new Uint8Array(t.count*t.size);a(i.exports[t.mode],n,t.count,t.size,t.source,i.exports[t.filter]),self.postMessage({id:t.id,count:t.count,action:"resolve",value:n},[n.buffer])}catch(e){self.postMessage({id:t.id,count:t.count,action:"reject",value:e})}}))}return{ready:r,supported:!0,useWorkers:function(e){d(e)},decodeVertexBuffer:function(e,t,n,r,o){a(i.exports.meshopt_decodeVertexBuffer,e,t,n,r,i.exports[s[o]])},decodeIndexBuffer:function(e,t,n,r){a(i.exports.meshopt_decodeIndexBuffer,e,t,n,r)},decodeIndexSequence:function(e,t,n,r){a(i.exports.meshopt_decodeIndexSequence,e,t,n,r)},decodeGltfBuffer:function(e,t,n,r,o,u){a(i.exports[l[o]],e,t,n,r,i.exports[s[u]])},decodeGltfBufferAsync:function(e,t,n,o,h){return u.length>0?function(e,t,i,n,r){for(var o=u[0],a=1;a<u.length;++a)u[a].pending<o.pending&&(o=u[a]);return new Promise((function(a,s){var l=new Uint8Array(i),u=c++;o.pending+=e,o.requests[u]={resolve:a,reject:s},o.object.postMessage({id:u,count:e,size:t,source:l,mode:n,filter:r},[l.buffer])}))}(e,t,n,l[o],s[h]):r.then((function(){var r=new Uint8Array(e*t);return a(i.exports[l[o]],r,e,t,n,i.exports[s[h]]),r}))}}}(),Son=function(){var e=new Uint8Array([32,0,65,2,1,106,34,33,3,128,11,4,13,64,6,253,10,7,15,116,127,5,8,12,40,16,19,54,20,9,27,255,113,17,42,67,24,23,146,148,18,14,22,45,70,69,56,114,101,21,25,63,75,136,108,28,118,29,73,115]);if("object"!=typeof WebAssembly)return{supported:!1};var t,i=WebAssembly.instantiate(function(t){for(var i=new Uint8Array(t.length),n=0;n<t.length;++n){var r=t.charCodeAt(n);i[n]=r>96?r-97:r>64?r-39:r+4}var o=0;for(n=0;n<t.length;++n)i[o++]=i[n]<60?e[i[n]]:64*(i[n]-60)+i[++n];return i.buffer.slice(0,o)}("b9H79TebbbecD9Geueu9Geub9Gbb9Gquuuuuuu99uueu9Gvuuuuub9Gluuuue999Giuuue999Gluuuueu9Giuuueuimxdilvorbwwbewlve9Weiiviebeoweuecj;jekr7oo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bbz9TW79O9V9Wt9F79P9T9W29P9M95beX9TW79O9V9Wt9F79P9T9W29P9M959t9J9H2Wbla9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9Wbvl79IV9RboDwebcekdDqq:XJxdbkp8WiKuP99Hu8Jjjjjbcj;bb9Rgq8KjjjjbaqcKfcbc;Kbz1jjjb8AaqcualcdtgkalcFFFFi0Egxcbyd;S1jjbHjjjjbbgmBdKaqceBd94aqamBdwaqaxcbyd;S1jjbHjjjjbbgPBd3aqcdBd94aqaPBdxaqcuadcitadcFFFFe0Ecbyd;S1jjbHjjjjbbgsBdaaqciBd94aqasBdzaqcwfaeadalcbz:cjjjbaqaxcbyd;S1jjbHjjjjbbgzBd8KaqclBd94aqaxcbyd;S1jjbHjjjjbbgHBdyaqcvBd94alcd4alfhOcehAinaAgCcethAaCaO6mbkcbhXaqcuaCcdtgAaCcFFFFi0Ecbyd;S1jjbHjjjjbbgOBd8SaqcoBd94aOcFeaAz1jjjbhQdnalTmbavcd4hLaCcufhKinaiaXaL2cdtfgYydlgCcH4aC7c:F:b:DD2aYydbgCcH4aC7c;D;O:B8J27aYydwgCcH4aC7c:3F;N8N27hOcbhCdndninaQaOaKGgOcdtfg8AydbgAcuSmeaiaAaL2cdtfaYcxz:ljjjbTmdaCcefgCaOfhOaCaK9nmbxdkka8AaXBdbaXhAkazaXcdtfaABdbaXcefgXal9hmbkcbhCaHhAinaAaCBdbaAclfhAalaCcefgC9hmbkcbhCazhAaHhOindnaCaAydbgKSmbaOaHaKcdtfgKydbBdbaKaCBdbkaAclfhAaOclfhOalaCcefgC9hmbkkcbhOaqalcbyd;S1jjbHjjjjbbgYBd8WaqcrBd94aqaxcbyd;S1jjbHjjjjbbgCBd80aqcwBd94aqaxcbyd;S1jjbHjjjjbbgABdUaqcDBd94aCcFeakz1jjjbhEaAcFeakz1jjjbh3dnalTmbascwfh5indnamaOcdtgCfydbg8ETmbasaPaCfydbcitfh8Fa3aCfhaaEaCfhXcbhLindndna8FaLcitfydbgQaO9hmbaXaOBdbaaaOBdbxekdnamaQcdtgkfydbghTmbasaPakfydbcitgCfydbaOSmeahcufh8Aa5aCfhAcbhCina8AaCSmeaCcefhCaAydbhKaAcwfhAaKaO9hmbkaCah6meka3akfgCaOaQaCydbcuSEBdbaXaQaOaXydbcuSEBdbkaLcefgLa8E9hmbkkaOcefgOal9hmbkazhAaHhOa3hKaEhLcbhCindndnaCaAydbg8A9hmbdnaCaOydbg8A9hmbaLydbh8AdnaKydbgQcu9hmba8Acu9hmbaYaCfcb86bbxikaYaCfhXdnaCaQSmbaCa8ASmbaXce86bbxikaXcl86bbxdkdnaCaHa8AcdtgQfydb9hmbdnaKydbgXcuSmbaCaXSmbaLydbgkcuSmbaCakSmba3aQfydbg8EcuSmba8Ea8ASmbaEaQfydbgQcuSmbaQa8ASmbdnazaXcdtfydbazaQcdtfydb9hmbazakcdtfydbaza8Ecdtfydb9hmbaYaCfcd86bbxlkaYaCfcl86bbxikaYaCfcl86bbxdkaYaCfcl86bbxekaYaCfaYa8AfRbb86bbkaAclfhAaOclfhOaKclfhKaLclfhLalaCcefgC9hmbkawceGTmbaYhCalhAindnaCRbbce9hmbaCcl86bbkaCcefhCaAcufgAmbkkcbhLcualcx2alc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbhmaqcKfaqyd94gCcdtfamBdbaqaCcefgABd94amaialavz:djjjb8AaqcKfaAcdtfcualc8S2gAalc;D;O;f8U0Ecbyd;S1jjbHjjjjbbgOBdbaqaCcdfBd94aOcbaAz1jjjbhsdnadTmbaehAindnamaAclfydbg8Acx2fgCIdbamaAydbgQcx2fgOIdbgg:tg8JamaAcwfydbgXcx2fgKIdlaOIdlg8K:tg8LNaKIdbag:tg8MaCIdla8K:tg8NN:tgyayNa8NaKIdwaOIdwg8P:tgINa8LaCIdwa8P:tg8NN:tg8La8LNa8Na8MNaIa8JN:tg8Ja8JNMM:rg8MJbbbb9ETmbaya8M:vhya8Ja8M:vh8Ja8La8M:vh8LkasazaQcdtfydbc8S2fgCa8La8M:rg8Ma8LNNg8NaCIdbMUdbaCa8Ja8Ma8JNg8RNgIaCIdlMUdlaCaya8MayNg8SNgRaCIdwMUdwaCa8Ra8LNg8RaCIdxMUdxaCa8Sa8LNg8UaCIdzMUdzaCa8Sa8JNg8SaCIdCMUdCaCa8La8Maya8PNa8LagNa8Ka8JNMM:mg8KNggNg8LaCIdKMUdKaCa8JagNg8JaCId3MUd3aCayagNgyaCIdaMUdaaCaga8KNggaCId8KMUd8KaCa8MaCIdyMUdyasaza8Acdtfydbc8S2fgCa8NaCIdbMUdbaCaIaCIdlMUdlaCaRaCIdwMUdwaCa8RaCIdxMUdxaCa8UaCIdzMUdzaCa8SaCIdCMUdCaCa8LaCIdKMUdKaCa8JaCId3MUd3aCayaCIdaMUdaaCagaCId8KMUd8KaCa8MaCIdyMUdyasazaXcdtfydbc8S2fgCa8NaCIdbMUdbaCaIaCIdlMUdlaCaRaCIdwMUdwaCa8RaCIdxMUdxaCa8UaCIdzMUdzaCa8SaCIdCMUdCaCa8LaCIdKMUdKaCa8JaCId3MUd3aCayaCIdaMUdaaCagaCId8KMUd8KaCa8MaCIdyMUdyaAcxfhAaLcifgLad6mbkcbh8AaehXincbhAinaYaeaAc:81jjbfydbgQa8AfcdtfydbgOfRbbhCdndnaYaXaAfydbgKfRbbgLc99fcFeGcpe0mbaCceSmbaCcd9hmekdnaLcufcFeGce0mbaEaKcdtfydbaO9hmekdnaCcufcFeGce0mba3aOcdtfydbaK9hmekdnaLcv2aCfc:G1jjbfRbbTmbazaOcdtfydbazaKcdtfydb0mekJbbacJbbjZaCceSEh8MaLceShkamaeaQcdtc:81jjbfydba8Afcdtfydbcx2fhCdnamaOcx2fgLIdwamaKcx2fgQIdwg8K:tg8La8LNaLIdbaQIdbg8P:tg8Ja8JNaLIdlaQIdlg8N:tgyayNMM:rggJbbbb9ETmba8Lag:vh8Layag:vhya8Jag:vh8JkJbbaca8MakEh8SdnaCIdwa8K:tg8Ma8La8Ma8LNaCIdba8P:tgRa8JNayaCIdla8N:tg8RNMMgIN:tg8Ma8MNaRa8JaIN:tg8La8LNa8RayaIN:tg8Ja8JNMM:rgyJbbbb9ETmba8May:vh8Ma8Jay:vh8Ja8Lay:vh8LkasazaKcdtfydbc8S2fgCa8La8SagNgya8LNNgIaCIdbMUdbaCa8Jaya8JNg8SNgRaCIdlMUdlaCa8Maya8MNggNg8RaCIdwMUdwaCa8Sa8LNg8SaCIdxMUdxaCaga8LNg8UaCIdzMUdzaCaga8JNg8VaCIdCMUdCaCa8Laya8Ma8KNa8La8PNa8Na8JNMM:mg8KNggNg8LaCIdKMUdKaCa8JagNg8JaCId3MUd3aCa8MagNg8MaCIdaMUdaaCaga8KNggaCId8KMUd8KaCayaCIdyMUdyasazaOcdtfydbc8S2fgCaIaCIdbMUdbaCaRaCIdlMUdlaCa8RaCIdwMUdwaCa8SaCIdxMUdxaCa8UaCIdzMUdzaCa8VaCIdCMUdCaCa8LaCIdKMUdKaCa8JaCId3MUd3aCa8MaCIdaMUdaaCagaCId8KMUd8KaCayaCIdyMUdykaAclfgAcx9hmbkaXcxfhXa8Acifg8Aad6mbkkdnabaeSmbabaeadcdtz:hjjjb8Akcuadcx2adc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbhaaqcKfaqyd94gCcdtfaaBdbaqaCcefgABd94aqcKfaAcdtfcuadcdtadcFFFFi0Ecbyd;S1jjbHjjjjbbg5BdbaqaCcdfgABd94aqcKfaAcdtfaxcbyd;S1jjbHjjjjbbgiBdbaqaCcifgABd94aqcKfaAcdtfalcbyd;S1jjbHjjjjbbg8WBdbaqaCclfBd94JbbbbhRdnadao9nmbararNh8Saacwfh8Xaqydwh8Yaqydxh8Zaqydzh80JbbbbhRinaqcwfabadgPalazz:cjjjbcbhhabhXcbhkincbhCindnazaXaCfydbgOcdtgefydbgLazabaCc:81jjbfydbakfcdtfydbgAcdtfydbg8ASmbaYaAfRbbgQcv2aYaOfRbbgKfc;q1jjbfRbbg8FaKcv2aQfg8Ec;q1jjbfRbbgdVcFeGTmbdna8Ec:G1jjbfRbbTmba8AaL0mekdnaKaQ9hmbaKcufcFeGce0mbaEaefydbaA9hmekaaahcx2fgKaAaOadcFeGgLEBdlaKaOaAaLEBdbaKaLa8FGcb9hBdwahcefhhkaCclfgCcx9hmbkaXcxfhXakcifgkaP6mbkdndnahTmbaahAahh8AinaAcwfgQJbbbbJbbjZasazaAydbgOcdtfydbc8S2fgCIdyg8L:va8LJbbbb9BEaCIdwamaAclfgeydbgKcx2fgLIdwg8LNaCIdzaLIdbg8JNaCIdaMg8Ma8MMMa8LNaCIdlaLIdlg8MNaCIdCa8LNaCId3Mg8La8LMMa8MNaCIdba8JNaCIdxa8MNaCIdKMg8La8LMMa8JNaCId8KMMM:lNgyJbbbbJbbjZasazaKaOaQydbgLEgQcdtfydbc8S2fgCIdyg8L:va8LJbbbb9BEaCIdwamaOaKaLEgXcx2fgLIdwg8LNaCIdzaLIdbg8JNaCIdaMg8Ma8MMMa8LNaCIdlaLIdlg8MNaCIdCa8LNaCId3Mg8La8LMMa8MNaCIdba8JNaCIdxa8MNaCIdKMg8La8LMMa8JNaCId8KMMM:lNg8Laya8L9FgCEUdbaeaKaXaCEBdbaAaOaQaCEBdbaAcxfhAa8Acufg8Ambkaqcjefcbcj;abz1jjjb8Aa8XhCahhAinaqcjefaCydbcO4c;8ZGfgOaOydbcefBdbaCcxfhCaAcufgAmbkcbhCcbhAinaqcjefaCfgOydbhKaOaABdbaKaAfhAaCclfgCcj;ab9hmbkcbhCa8XhAinaqcjefaAydbcO4c;8ZGfgOaOydbgOcefBdba5aOcdtfaCBdbaAcxfhAahaCcefgC9hmbkaPao9RgOci9Uh81dnalTmbcbhCaihAinaAaCBdbaAclfhAalaCcefgC9hmbkkcbhBa8Wcbalz1jjjbh83aOcO9UhUa81ce4h85cbh86cbhkdninaaa5akcdtfydbcx2fgXIdwg8Ja8S9Emea86a819pmeJFFuuh8Ldna85ah9pmbaaa5a85cdtfydbcx2fIdwJbb;aZNh8Lkdna8Ja8L9ETmba86aU0mdkdna83azaXydlg87cdtg88fydbgOfg89Rbba83azaXydbgecdtg8:fydbgZfgnRbbVmbdna8YaZcdtgCfydbgKTmba80a8ZaCfydbcitfhCamaOcx2fg8Ecwfhda8EclfhxamaZcx2fg8Fcwfhva8FclfhwcbhAcehQdnindnaiaCydbcdtfydbgLaOSmbaiaCclfydbcdtfydbg8AaOSmbama8Acx2fg8AIdbamaLcx2fgLIdbg8M:tg8LawIdbaLIdlgy:tggNa8FIdba8M:tg8Ka8AIdlay:tg8JN:ta8LaxIdbay:tg8PNa8EIdba8M:tg8Na8JN:tNa8JavIdbaLIdwgy:tgINaga8AIdway:tg8MN:ta8JadIdbay:tgyNa8Pa8MN:tNa8Ma8KNaIa8LN:ta8Ma8NNaya8LN:tNMMJbbbb9DmdkaCcwfhCaAcefgAaK6hQaKaA9hmbkkaQceGTmba85cefh85xekaXcwfhKasaOc8S2fgCasaZc8S2fgAIdbaCIdbMUdbaCaAIdlaCIdlMUdlaCaAIdwaCIdwMUdwaCaAIdxaCIdxMUdxaCaAIdzaCIdzMUdzaCaAIdCaCIdCMUdCaCaAIdKaCIdKMUdKaCaAId3aCId3MUd3aCaAIdaaCIdaMUdaaCaAId8KaCId8KMUd8KaCaAIdyaCIdyMUdydndndndnaYaefgARbbc9:fPdebdkaehCinaiaCcdtgCfaOBdbaHaCfydbgCae9hmbxikkaHa88fydbhCaHa8:fydbheaia8:fa87BdbaCh87kaiaecdtfa87Bdbkance86bba89ce86bbaKIdbg8LaRaRa8L9DEhRaBcefhBcecdaARbbceSEa86fh86kakcefgkah9hmbkkaBTmbdnalTmbcbhAaEhCindnaCydbgOcuSmbdnaAaiaOcdtgKfydbgO9hmbaEaKfydbhOkaCaOBdbkaCclfhCalaAcefgA9hmbkcbhAa3hCindnaCydbgOcuSmbdnaAaiaOcdtgKfydbgO9hmba3aKfydbhOkaCaOBdbkaCclfhCalaAcefgA9hmbkkcbhdabhCcbhLindnaiaCydbcdtfydbgAaiaCclfydbcdtfydbgOSmbaAaiaCcwfydbcdtfydbgKSmbaOaKSmbabadcdtfg8AaABdba8AclfaOBdba8AcwfaKBdbadcifhdkaCcxfhCaLcifgLaP9pmdxbkkaPhdxdkadao0mbkkdnaDTmbaDaR:rUdbkaqyd94gCcdtaqcKffc98fhzdninaCTmeazydbcbyd;W1jjbH:bjjjbbazc98fhzaCcufhCxbkkaqcj;bbf8Kjjjjbadk;pleouabydbcbaicdtz1jjjb8Aadci9UhvdnadTmbabydbhodnalTmbaehradhwinaoalarydbcdtfydbcdtfgDaDydbcefBdbarclfhrawcufgwmbxdkkaehradhwinaoarydbcdtfgDaDydbcefBdbarclfhrawcufgwmbkkdnaiTmbabydbhrabydlhwcbhDaihoinawaDBdbawclfhwarydbaDfhDarclfhraocufgombkkdnadci6mbavceavce0EhqabydlhvabydwhrinaecwfydbhwaeclfydbhDaeydbhodnalTmbalawcdtfydbhwalaDcdtfydbhDalaocdtfydbhokaravaocdtfgdydbcitfaDBdbaradydbcitfawBdladadydbcefBdbaravaDcdtfgdydbcitfawBdbaradydbcitfaoBdladadydbcefBdbaravawcdtfgwydbcitfaoBdbarawydbcitfaDBdlawawydbcefBdbaecxfheaqcufgqmbkkdnaiTmbabydlhrabydbhwinararydbawydb9RBdbawclfhwarclfhraicufgimbkkk:3ldouv998Jjjjjbca9Rglczfcwfcbyd11jjbBdbalcb8Pdj1jjb83izalcwfcbydN1jjbBdbalcb8Pd:m1jjb83ibdnadTmbaicd4hvdnabTmbavcdthocbhraehwinabarcx2fgiaearav2cdtfgDIdbUdbaiaDIdlUdlaiaDIdwUdwcbhiinalczfaifgDawaifIdbgqaDIdbgkakaq9EEUdbalaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkawaofhwarcefgrad9hmbxdkkavcdthrcbhwincbhiinalczfaifgDaeaifIdbgqaDIdbgkakaq9EEUdbalaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkaearfheawcefgwad9hmbkkalIdbalIdzgk:tJbbbb:xgqalIdlalIdCgx:tgmamaq9DEgqalIdwalIdKgm:tgPaPaq9DEhPdnabTmbadTmbJbbbbJbbjZaP:vaPJbbbb9BEhqinabaqabIdbak:tNUdbabclfgiaqaiIdbax:tNUdbabcwfgiaqaiIdbam:tNUdbabcxfhbadcufgdmbkkaPk:Qdidui99ducbhi8Jjjjjbca9Rglczfcwfcbyd11jjbBdbalcb8Pdj1jjb83izalcwfcbydN1jjbBdbalcb8Pd:m1jjb83ibdndnaembJbbjFhvJbbjFhoJbbjFhrxekadcd4cdthwincbhdinalczfadfgDabadfIdbgoaDIdbgrarao9EEUdbaladfgDaoaDIdbgrarao9DEUdbadclfgdcx9hmbkabawfhbaicefgiae9hmbkalIdwalIdK:thralIdlalIdC:thoalIdbalIdz:thvkavJbbbb:xgvaoaoav9DEgoararao9DEk9DeeuabcFeaicdtz1jjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk9teiucbcbyd;01jjbgeabcifc98GfgbBd;01jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd;01jjbgeabcrfc94GfgbBd;01jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd;01jjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd;01jjbfgdBd;01jjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akk6eiucbhidnadTmbdninabRbbglaeRbbgv9hmeaecefheabcefhbadcufgdmbxdkkalav9Rhikaikk:cedbcjwk9PFFuuFFuuFFuuFFuFFFuFFFuFbbbbbbbbeeebeebebbeeebebbbbbebebbbbbebbbdbbbbbbbbbbbbbbbeeeeebebbbbbebbbbbeebbbbbbc;Swkxebbbdbbbj9Kbb"),{}).then((function(e){(t=e.instance).exports.__wasm_call_ctors()}));function n(e){if(!e)throw new Error("Assertion failed")}function r(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var o={LockBorder:1};return{ready:i,supported:!0,compactMesh:function(e){return n(e instanceof Uint32Array||e instanceof Int32Array||e instanceof Uint16Array||e instanceof Int16Array),n(e.length%3==0),function(e,i){var n=t.exports.sbrk,o=n(4*e.length),a=n(4*i),s=new Uint8Array(t.exports.memory.buffer),l=r(e);s.set(l,o);var u=t.exports.meshopt_optimizeVertexFetchRemap(a,o,e.length,i);s=new Uint8Array(t.exports.memory.buffer);var c=new Uint32Array(i);new Uint8Array(c.buffer).set(s.subarray(a,a+4*i)),l.set(s.subarray(o,o+4*e.length)),n(o-n(0));for(var h=0;h<e.length;++h)e[h]=c[e[h]];return[c,u]}(4==e.BYTES_PER_ELEMENT?e:new Uint32Array(e),function(e){for(var t=0,i=0;i<e.length;++i){var n=e[i];t=t<n?n:t}return t}(e)+1)},simplify:function(e,i,a,s,l,u){n(e instanceof Uint32Array||e instanceof Int32Array||e instanceof Uint16Array||e instanceof Int16Array),n(e.length%3==0),n(i instanceof Float32Array),n(i.length%a==0),n(a>=3),n(s%3==0),n(l>=0&&l<=1);for(var c=0,h=0;h<(u?u.length:0);++h)c|=o[u[h]];var d=4==e.BYTES_PER_ELEMENT?e:new Uint32Array(e),p=function(e,i,n,o,a,s,l,u,c){var h=t.exports.sbrk,d=h(4),p=h(4*n),f=h(a*s),m=h(4*n),_=new Uint8Array(t.exports.memory.buffer);_.set(r(o),f),_.set(r(i),m);var g=e(p,m,n,f,a,s,l,u,c,d);_=new Uint8Array(t.exports.memory.buffer);var y=new Uint32Array(g);r(y).set(_.subarray(p,p+4*g));var v=new Float32Array(1);return r(v).set(_.subarray(d,d+4)),h(d-h(0)),[y,v[0]]}(t.exports.meshopt_simplify,d,e.length,i,i.length/a,4*a,s,l,c);return p[0]=e instanceof Uint32Array?p[0]:new e.constructor(p[0]),p},getScale:function(e,i){return n(e instanceof Float32Array),n(e.length%i==0),function(e,i,n,o){var a=t.exports.sbrk,s=a(n*o);new Uint8Array(t.exports.memory.buffer).set(r(i),s);var l=e(s,n,o);return a(s-a(0)),l}(t.exports.meshopt_simplifyScale,e,e.length/i,4*i)}}}();function G0(e){let t,i,n,r,o=(e=y(e,y.EMPTY_OBJECT)).resourceCache,a=e.gltf,s=e.bufferViewId,l=e.gltfResource,u=e.baseResource,c=e.cacheKey,h=a.bufferViews[s],d=h.buffer,p=h.byteOffset,f=h.byteLength,m=!1;if(ii(h,"EXT_meshopt_compression")){let e=h.extensions.EXT_meshopt_compression;d=e.buffer,p=y(e.byteOffset,0),f=e.byteLength,m=!0,t=e.byteStride,i=e.count,n=e.mode,r=y(e.filter,"NONE")}let _=a.buffers[d];this._hasMeshopt=m,this._meshoptByteStride=t,this._meshoptCount=i,this._meshoptMode=n,this._meshoptFilter=r,this._resourceCache=o,this._gltfResource=l,this._baseResource=u,this._buffer=_,this._bufferId=d,this._byteOffset=p,this._byteLength=f,this._cacheKey=c,this._bufferLoader=void 0,this._typedArray=void 0,this._state=St.UNLOADED,this._promise=void 0}async function RVe(e){try{let t=MVe(e);if(e._bufferLoader=t,await t.load(),e.isDestroyed())return;let i=t.typedArray,n=new Uint8Array(i.buffer,i.byteOffset+e._byteOffset,e._byteLength);if(e.unload(),e._typedArray=n,e._hasMeshopt){let t=e._meshoptCount,i=e._meshoptByteStride,n=new Uint8Array(t*i);qre.decodeGltfBuffer(n,t,i,e._typedArray,e._meshoptMode,e._meshoptFilter),e._typedArray=n}return e._state=St.READY,e}catch(t){if(e.isDestroyed())return;e.unload(),e._state=St.FAILED;let i="Failed to load buffer view";throw e.getError(i,t)}}function MVe(e){let t=e._resourceCache,i=e._buffer;if(u(i.uri)){let n=e._baseResource.getDerivedResource({url:i.uri});return t.getExternalBufferLoader({resource:n})}return t.getEmbeddedBufferLoader({parentResource:e._gltfResource,bufferId:e._bufferId})}u(Object.create)&&(G0.prototype=Object.create(io.prototype),G0.prototype.constructor=G0),Object.defineProperties(G0.prototype,{cacheKey:{get:function(){return this._cacheKey}},typedArray:{get:function(){return this._typedArray}}}),G0.prototype.load=async function(){return u(this._promise)||(this._state=St.LOADING,this._promise=RVe(this)),this._promise},G0.prototype.unload=function(){u(this._bufferLoader)&&!this._bufferLoader.isDestroyed()&&this._resourceCache.unload(this._bufferLoader),this._bufferLoader=void 0,this._typedArray=void 0};var xw=G0;function yr(){}yr._maxDecodingConcurrency=Math.max(Bt.hardwareConcurrency-1,1),yr._decoderTaskProcessor=void 0,yr._taskProcessorReady=!1,yr._error=void 0,yr._getDecoderTaskProcessor=function(){if(!u(yr._decoderTaskProcessor)){let e=new pi("decodeDraco",yr._maxDecodingConcurrency);e.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}).then((function(e){e?yr._taskProcessorReady=!0:yr._error=new ue("Draco decoder could not be initialized.")})).catch((e=>{yr._error=e})),yr._decoderTaskProcessor=e}return yr._decoderTaskProcessor},yr.decodePointCloud=function(e){let t=yr._getDecoderTaskProcessor();if(u(yr._error))throw yr._error;if(yr._taskProcessorReady)return t.scheduleTask(e,[e.buffer.buffer])},yr.decodeBufferView=function(e){let t=yr._getDecoderTaskProcessor();if(u(yr._error))throw yr._error;if(yr._taskProcessorReady)return t.scheduleTask(e,[e.array.buffer])};var fg=yr;function dg(e){let t=(e=y(e,y.EMPTY_OBJECT)).resourceCache,i=e.gltf,n=e.draco,r=e.gltfResource,o=e.baseResource,a=e.cacheKey;this._resourceCache=t,this._gltfResource=r,this._baseResource=o,this._gltf=i,this._draco=n,this._cacheKey=a,this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodePromise=void 0,this._decodedData=void 0,this._state=St.UNLOADED,this._promise=void 0,this._dracoError=void 0}async function LVe(e){let t=e._resourceCache;try{let i=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._draco.bufferView,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoader=i,await i.load(),e.isDestroyed()?void 0:(e._bufferViewTypedArray=i.typedArray,e._state=St.PROCESSING,e)}catch(t){if(e.isDestroyed())return;Yre(e,t)}}function Yre(e,t){e.unload(),e._state=St.FAILED;throw e.getError("Failed to load Draco",t)}async function NVe(e,t){try{let i=await t;return e.isDestroyed()?void 0:(e.unload(),e._decodedData={indices:i.indexArray,vertexAttributes:i.attributeData},e._state=St.READY,e._baseResource)}catch(t){if(e.isDestroyed())return;e._dracoError=t}}u(Object.create)&&(dg.prototype=Object.create(io.prototype),dg.prototype.constructor=dg),Object.defineProperties(dg.prototype,{cacheKey:{get:function(){return this._cacheKey}},decodedData:{get:function(){return this._decodedData}}}),dg.prototype.load=async function(){return u(this._promise)||(this._state=St.LOADING,this._promise=LVe(this)),this._promise},dg.prototype.process=function(e){if(this._state===St.READY)return!0;if(this._state!==St.PROCESSING||(u(this._dracoError)&&Yre(this,this._dracoError),!u(this._bufferViewTypedArray))||u(this._decodePromise))return!1;let t=this._draco,i=this._gltf.bufferViews[t.bufferView],n=t.attributes,r={array:new Uint8Array(this._bufferViewTypedArray),bufferView:i,compressedAttributes:n,dequantizeInShader:!0},o=fg.decodeBufferView(r);if(!u(o))return!1;this._decodePromise=NVe(this,o)},dg.prototype.unload=function(){u(this._bufferViewLoader)&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._bufferViewTypedArray=void 0,this._decodedData=void 0,this._gltf=void 0};var bw=dg;function lp(e){let t=(e=y(e,y.EMPTY_OBJECT)).resourceCache,i=e.gltf,n=e.imageId,r=e.gltfResource,o=e.baseResource,a=e.cacheKey,s=i.images[n],l=s.bufferView,u=s.uri;this._resourceCache=t,this._gltfResource=r,this._baseResource=o,this._gltf=i,this._bufferViewId=l,this._uri=u,this._cacheKey=a,this._bufferViewLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._state=St.UNLOADED,this._promise=void 0}function Xre(e){let t;return Array.isArray(e)&&(t=e.slice(1,e.length).map((function(e){return e.bufferView})),e=e[0]),{image:e,mipLevels:t}}async function FVe(e){e._state=St.LOADING;let t=e._resourceCache;try{let i=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=i,await i.load(),e.isDestroyed())return;let n=i.typedArray,r=await VVe(n);if(e.isDestroyed())return;let o=Xre(r);return e.unload(),e._image=o.image,e._mipLevels=o.mipLevels,e._state=St.READY,e}catch(t){return e.isDestroyed()?void 0:Kre(e,t,"Failed to load embedded image")}}async function BVe(e){e._state=St.LOADING;let t=e._baseResource,i=e._uri,n=t.getDerivedResource({url:i});try{let t=await zVe(n);if(e.isDestroyed())return;let i=Xre(t);return e.unload(),e._image=i.image,e._mipLevels=i.mipLevels,e._state=St.READY,e}catch(t){return e.isDestroyed()?void 0:Kre(e,t,`Failed to load image: ${i}`)}}function Kre(e,t,i){return e.unload(),e._state=St.FAILED,Promise.reject(e.getError(i,t))}function kVe(e){let t=e.subarray(0,2),i=e.subarray(0,4),n=e.subarray(8,12);if(255===t[0]&&216===t[1])return"image/jpeg";if(137===t[0]&&80===t[1])return"image/png";if(171===t[0]&&75===t[1])return"image/ktx2";if(82===i[0]&&73===i[1]&&70===i[2]&&70===i[3]&&87===n[0]&&69===n[1]&&66===n[2]&&80===n[3])return"image/webp";throw new ue("Image format is not recognized")}async function VVe(e){let t=kVe(e);if("image/ktx2"===t){let t=new Uint8Array(e);return Ll(t)}return lp._loadImageFromTypedArray({uint8Array:e,format:t,flipY:!1,skipColorSpaceConversion:!0})}u(Object.create)&&(lp.prototype=Object.create(io.prototype),lp.prototype.constructor=lp),Object.defineProperties(lp.prototype,{cacheKey:{get:function(){return this._cacheKey}},image:{get:function(){return this._image}},mipLevels:{get:function(){return this._mipLevels}}}),lp.prototype.load=function(){return u(this._promise)?this._promise:u(this._bufferViewId)?(this._promise=FVe(this),this._promise):(this._promise=BVe(this),this._promise)};var UVe=/(^data:image\/ktx2)|(\.ktx2$)/i;function zVe(e){let t=e.getUrlComponent(!1,!0);return UVe.test(t)?Ll(e):e.fetchImage({skipColorSpaceConversion:!0,preferImageBitmap:!0})}lp.prototype.unload=function(){u(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&this._resourceCache.unload(this._bufferViewLoader),this._bufferViewLoader=void 0,this._uri=void 0,this._image=void 0,this._mipLevels=void 0,this._gltf=void 0},lp._loadImageFromTypedArray=ST;var Tw=lp,HVe={TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3},Ha=Object.freeze(HVe);function hg(e){let t=(e=y(e,y.EMPTY_OBJECT)).resourceCache,i=e.gltf,n=e.accessorId,r=e.gltfResource,o=e.baseResource,a=e.draco,s=e.cacheKey,l=y(e.asynchronous,!0),u=y(e.loadBuffer,!1),c=y(e.loadTypedArray,!1),h=i.accessors[n].componentType;this._resourceCache=t,this._gltfResource=r,this._baseResource=o,this._gltf=i,this._accessorId=n,this._indexDatatype=h,this._draco=a,this._cacheKey=s,this._asynchronous=l,this._loadBuffer=u,this._loadTypedArray=c,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=St.UNLOADED,this._promise=void 0}u(Object.create)&&(hg.prototype=Object.create(io.prototype),hg.prototype.constructor=hg),Object.defineProperties(hg.prototype,{cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},indexDatatype:{get:function(){return this._indexDatatype}}});var GVe=new c9;async function WVe(e){e._state=St.LOADING;let t=e._resourceCache;try{let i=t.getDracoLoader({gltf:e._gltf,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._dracoLoader=i,await i.load(),e.isDestroyed()?void 0:(e._state=St.LOADED,e)}catch(t){if(e.isDestroyed())return;a9(e,t)}}async function jVe(e){let t=e._gltf,i=e._accessorId,n=t.accessors[i].bufferView;e._state=St.LOADING;let r=e._resourceCache;try{let i=r.getBufferViewLoader({gltf:t,bufferViewId:n,gltfResource:e._gltfResource,baseResource:e._baseResource});if(e._bufferViewLoader=i,await i.load(),e.isDestroyed())return;let o=i.typedArray;return e._typedArray=qVe(e,o),e._state=St.PROCESSING,e}catch(t){if(e.isDestroyed())return;a9(e,t)}}function qVe(e,t){let i,n=e._gltf,r=e._accessorId,o=n.accessors[r],a=o.count,s=o.componentType,l=ke.getSizeInBytes(s),u=t.buffer,c=t.byteOffset+o.byteOffset;if(c%l!=0){let e=new Uint8Array(u,c,a*l);u=new Uint8Array(e).buffer,c=0,is("index-buffer-unaligned",`The index array is not aligned to a ${l}-byte boundary.`)}return s===ke.UNSIGNED_BYTE?i=new Uint8Array(u,c,a):s===ke.UNSIGNED_SHORT?i=new Uint16Array(u,c,a):s===ke.UNSIGNED_INT&&(i=new Uint32Array(u,c,a)),i}function a9(e,t){e.unload(),e._state=St.FAILED;throw e.getError("Failed to load index buffer",t)}function c9(){this.typedArray=void 0,this.indexDatatype=void 0,this.context=void 0,this.buffer=void 0}function Zre(e,t,i){let n=ut.createIndexBuffer({typedArray:e,context:i,usage:Be.STATIC_DRAW,indexDatatype:t});return n.vertexArrayDestroyable=!1,n}hg.prototype.load=async function(){return u(this._promise)?this._promise:u(this._draco)?(this._promise=WVe(this),this._promise):(this._promise=jVe(this),this._promise)},c9.prototype.set=function(e,t,i){this.typedArray=e,this.indexDatatype=t,this.context=i},c9.prototype.execute=function(){this.buffer=Zre(this.typedArray,this.indexDatatype,this.context)},hg.prototype.process=function(e){if(this._state===St.READY)return!0;if(this._state!==St.LOADED&&this._state!==St.PROCESSING)return!1;let t,i=this._typedArray,n=this._indexDatatype;if(u(this._dracoLoader))try{this._dracoLoader.process(e)&&(i=this._dracoLoader.decodedData.indices.typedArray,this._typedArray=i,n=X.fromTypedArray(i),this._indexDatatype=n)}catch(e){a9(this,e)}if(!u(i))return!1;if(this._loadBuffer&&this._asynchronous){let r=GVe;if(r.set(i,n,e.context),!e.jobScheduler.execute(r,Ha.BUFFER))return!1;t=r.buffer}else this._loadBuffer&&(t=Zre(i,n,e.context));return this.unload(),this._buffer=t,this._typedArray=this._loadTypedArray?i:void 0,this._state=St.READY,this._resourceCache.statistics.addGeometryLoader(this),!0},hg.prototype.unload=function(){u(this._buffer)&&this._buffer.destroy();let e=this._resourceCache;u(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&e.unload(this._bufferViewLoader),u(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0};var Aw=hg;function YVe(e,t,i){if(i=y(i,!1)){let i=e.indexOf(t);if(i>-1)return i}return e.push(t),e.length-1}var Ts=YVe;function XVe(e,t){return u(e.extensionsUsed)&&e.extensionsUsed.indexOf(t)>=0}var cr=XVe;function Wt(){}Wt.objectLegacy=function(e,t){if(u(e))for(let i in e)if(Object.prototype.hasOwnProperty.call(e,i)){let n=t(e[i],i);if(u(n))return n}},Wt.object=function(e,t){if(u(e)){let i=e.length;for(let n=0;n<i;n++){let i=t(e[n],n);if(u(i))return i}}},Wt.topLevel=function(e,t,i){let n=e[t];return u(n)&&!Array.isArray(n)?Wt.objectLegacy(n,i):Wt.object(n,i)},Wt.accessor=function(e,t){return Wt.topLevel(e,"accessors",t)},Wt.accessorWithSemantic=function(e,t,i){let n={};return Wt.mesh(e,(function(e){return Wt.meshPrimitive(e,(function(e){let r=Wt.meshPrimitiveAttribute(e,(function(e,r){if(0===r.indexOf(t)&&!u(n[e])){n[e]=!0;let t=i(e);if(u(t))return t}}));return u(r)?r:Wt.meshPrimitiveTarget(e,(function(e){return Wt.meshPrimitiveTargetAttribute(e,(function(e,r){if(0===r.indexOf(t)&&!u(n[e])){n[e]=!0;let t=i(e);if(u(t))return t}}))}))}))}))},Wt.accessorContainingVertexAttributeData=function(e,t){let i={};return Wt.mesh(e,(function(e){return Wt.meshPrimitive(e,(function(e){let n=Wt.meshPrimitiveAttribute(e,(function(e){if(!u(i[e])){i[e]=!0;let n=t(e);if(u(n))return n}}));return u(n)?n:Wt.meshPrimitiveTarget(e,(function(e){return Wt.meshPrimitiveTargetAttribute(e,(function(e){if(!u(i[e])){i[e]=!0;let n=t(e);if(u(n))return n}}))}))}))}))},Wt.accessorContainingIndexData=function(e,t){let i={};return Wt.mesh(e,(function(e){return Wt.meshPrimitive(e,(function(e){let n=e.indices;if(u(n)&&!u(i[n])){i[n]=!0;let e=t(n);if(u(e))return e}}))}))},Wt.animation=function(e,t){return Wt.topLevel(e,"animations",t)},Wt.animationChannel=function(e,t){let i=e.channels;return Wt.object(i,t)},Wt.animationSampler=function(e,t){let i=e.samplers;return Wt.object(i,t)},Wt.buffer=function(e,t){return Wt.topLevel(e,"buffers",t)},Wt.bufferView=function(e,t){return Wt.topLevel(e,"bufferViews",t)},Wt.camera=function(e,t){return Wt.topLevel(e,"cameras",t)},Wt.image=function(e,t){return Wt.topLevel(e,"images",t)},Wt.material=function(e,t){return Wt.topLevel(e,"materials",t)},Wt.materialValue=function(e,t){let i=e.values;u(e.extensions)&&u(e.extensions.KHR_techniques_webgl)&&(i=e.extensions.KHR_techniques_webgl.values);for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)){let n=t(i[e],e);if(u(n))return n}},Wt.mesh=function(e,t){return Wt.topLevel(e,"meshes",t)},Wt.meshPrimitive=function(e,t){let i=e.primitives;if(u(i)){let e=i.length;for(let n=0;n<e;n++){let e=t(i[n],n);if(u(e))return e}}},Wt.meshPrimitiveAttribute=function(e,t){let i=e.attributes;for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)){let n=t(i[e],e);if(u(n))return n}},Wt.meshPrimitiveTarget=function(e,t){let i=e.targets;if(u(i)){let e=i.length;for(let n=0;n<e;++n){let e=t(i[n],n);if(u(e))return e}}},Wt.meshPrimitiveTargetAttribute=function(e,t){for(let i in e)if(Object.prototype.hasOwnProperty.call(e,i)){let n=t(e[i],i);if(u(n))return n}},Wt.node=function(e,t){return Wt.topLevel(e,"nodes",t)},Wt.nodeInTree=function(e,t,i){let n=e.nodes;if(u(n)){let r=t.length;for(let o=0;o<r;o++){let r=t[o],a=n[r];if(u(a)){let t=i(a,r);if(u(t))return t;let n=a.children;if(u(n)&&(t=Wt.nodeInTree(e,n,i),u(t)))return t}}}},Wt.nodeInScene=function(e,t,i){let n=t.nodes;if(u(n))return Wt.nodeInTree(e,n,i)},Wt.program=function(e,t){return cr(e,"KHR_techniques_webgl")?Wt.object(e.extensions.KHR_techniques_webgl.programs,t):Wt.topLevel(e,"programs",t)},Wt.sampler=function(e,t){return Wt.topLevel(e,"samplers",t)},Wt.scene=function(e,t){return Wt.topLevel(e,"scenes",t)},Wt.shader=function(e,t){return cr(e,"KHR_techniques_webgl")?Wt.object(e.extensions.KHR_techniques_webgl.shaders,t):Wt.topLevel(e,"shaders",t)},Wt.skin=function(e,t){return Wt.topLevel(e,"skins",t)},Wt.skinJoint=function(e,t){let i=e.joints;if(u(i)){let e=i.length;for(let n=0;n<e;n++){let e=t(i[n]);if(u(e))return e}}},Wt.techniqueAttribute=function(e,t){let i=e.attributes;for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)){let n=t(i[e],e);if(u(n))return n}},Wt.techniqueUniform=function(e,t){let i=e.uniforms;for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)){let n=t(i[e],e);if(u(n))return n}},Wt.techniqueParameter=function(e,t){let i=e.parameters;for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)){let n=t(i[e],e);if(u(n))return n}},Wt.technique=function(e,t){return cr(e,"KHR_techniques_webgl")?Wt.object(e.extensions.KHR_techniques_webgl.techniques,t):Wt.topLevel(e,"techniques",t)},Wt.texture=function(e,t){return Wt.topLevel(e,"textures",t)};var Ie=Wt;function KVe(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}}var ef=KVe;function ZVe(e,t){let i=t.bufferView;if(u(i)){let t=e.bufferViews[i];if(u(t.byteStride)&&t.byteStride>0)return t.byteStride}return X.getSizeInBytes(t.componentType)*ef(t.type)}var Hl=ZVe;function $Ve(e){Ie.accessor(e,(function(e){u(e.bufferView)&&(e.byteOffset=y(e.byteOffset,0))})),Ie.bufferView(e,(function(e){u(e.buffer)&&(e.byteOffset=y(e.byteOffset,0))})),Ie.mesh(e,(function(t){Ie.meshPrimitive(t,(function(t){if(t.mode=y(t.mode,ee.TRIANGLES),!u(t.material)){u(e.materials)||(e.materials=[]);let i={name:"default"};t.material=Ts(e.materials,i)}}))})),Ie.accessorContainingVertexAttributeData(e,(function(t){let i=e.accessors[t],n=i.bufferView;if(i.normalized=y(i.normalized,!1),u(n)){let t=e.bufferViews[n];t.byteStride=Hl(e,i),t.target=ee.ARRAY_BUFFER}})),Ie.accessorContainingIndexData(e,(function(t){let i=e.accessors[t].bufferView;if(u(i)){e.bufferViews[i].target=ee.ELEMENT_ARRAY_BUFFER}})),Ie.material(e,(function(e){let t=y(e.extensions,y.EMPTY_OBJECT),i=t.KHR_materials_common;if(u(i)){let e=i.technique,t=u(i.values)?i.values:{};return i.values=t,t.ambient=u(t.ambient)?t.ambient:[0,0,0,1],t.emission=u(t.emission)?t.emission:[0,0,0,1],t.transparency=y(t.transparency,1),"CONSTANT"!==e&&(t.diffuse=u(t.diffuse)?t.diffuse:[0,0,0,1],"LAMBERT"!==e&&(t.specular=u(t.specular)?t.specular:[0,0,0,1],t.shininess=y(t.shininess,0))),i.transparent=y(i.transparent,!1),void(i.doubleSided=y(i.doubleSided,!1))}e.emissiveFactor=y(e.emissiveFactor,[0,0,0]),e.alphaMode=y(e.alphaMode,"OPAQUE"),e.doubleSided=y(e.doubleSided,!1),"MASK"===e.alphaMode&&(e.alphaCutoff=y(e.alphaCutoff,.5));let n=t.KHR_techniques_webgl;u(n)&&Ie.materialValue(e,(function(e){u(e.index)&&W0(e)})),W0(e.emissiveTexture),W0(e.normalTexture),W0(e.occlusionTexture);let r=e.pbrMetallicRoughness;u(r)&&(r.baseColorFactor=y(r.baseColorFactor,[1,1,1,1]),r.metallicFactor=y(r.metallicFactor,1),r.roughnessFactor=y(r.roughnessFactor,1),W0(r.baseColorTexture),W0(r.metallicRoughnessTexture));let o=t.KHR_materials_pbrSpecularGlossiness;u(o)&&(o.diffuseFactor=y(o.diffuseFactor,[1,1,1,1]),o.specularFactor=y(o.specularFactor,[1,1,1]),o.glossinessFactor=y(o.glossinessFactor,1),W0(o.specularGlossinessTexture))})),Ie.animation(e,(function(e){Ie.animationSampler(e,(function(e){e.interpolation=y(e.interpolation,"LINEAR")}))}));let t=QVe(e);return Ie.node(e,(function(e,i){u(t[i])||u(e.translation)||u(e.rotation)||u(e.scale)?(e.translation=y(e.translation,[0,0,0]),e.rotation=y(e.rotation,[0,0,0,1]),e.scale=y(e.scale,[1,1,1])):e.matrix=y(e.matrix,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])})),Ie.sampler(e,(function(e){e.wrapS=y(e.wrapS,ee.REPEAT),e.wrapT=y(e.wrapT,ee.REPEAT)})),u(e.scenes)&&!u(e.scene)&&(e.scene=0),e}function QVe(e){let t={};return Ie.animation(e,(function(e){Ie.animationChannel(e,(function(e){let i=e.target,n=i.node,r=i.path;("translation"===r||"rotation"===r||"scale"===r)&&(t[n]=!0)}))})),t}function W0(e){u(e)&&(e.texCoord=y(e.texCoord,0))}var AN=$Ve;function JVe(e){return Ie.shader(e,(function(e){CN(e)})),Ie.buffer(e,(function(e){CN(e)})),Ie.image(e,(function(e){CN(e)})),CN(e),e}function CN(e){e.extras=u(e.extras)?e.extras:{},e.extras._pipeline=u(e.extras._pipeline)?e.extras._pipeline:{}}var j0=JVe;function eUe(e,t){let i=e.extensionsRequired;if(u(i)){let n=i.indexOf(t);n>=0&&i.splice(n,1),0===i.length&&delete e.extensionsRequired}}var EN=eUe;function tUe(e,t){let i=e.extensionsUsed;if(u(i)){let n=i.indexOf(t);n>=0&&i.splice(n,1),EN(e,t),0===i.length&&delete e.extensionsUsed}}var hA=tUe,nUe=4;function iUe(e){if("glTF"!==bh(e))throw new ue("File is not valid binary glTF");let t=$re(e,0,5),i=t[1];if(1!==i&&2!==i)throw new ue("Binary glTF version is not 1 or 2");return 1===i?oUe(e,t):rUe(e,t)}function $re(e,t,i){let n=new DataView(e.buffer),r=new Array(i);for(let o=0;o<i;++o)r[o]=n.getUint32(e.byteOffset+t+o*nUe,!0);return r}function oUe(e,t){let i=t[2],n=t[3];if(0!==t[4])throw new ue("Binary glTF scene format is not JSON");let r=20+n,o=Il(e,20,n),a=JSON.parse(o);j0(a);let s=e.subarray(r,i),l=a.buffers;if(u(l)&&Object.keys(l).length>0){let e=y(l.binary_glTF,l.KHR_binary_glTF);u(e)&&(e.extras._pipeline.source=s,delete e.uri)}return hA(a,"KHR_binary_glTF"),a}function rUe(e,t){let i,n,r=t[2],o=12;for(;o<r;){let t=$re(e,o,2),r=t[0],a=t[1];o+=8;let s=e.subarray(o,o+r);if(o+=r,1313821514===a){let e=Il(s);i=JSON.parse(e),j0(i)}else 5130562===a&&(n=s)}if(u(i)&&u(n)){let e=i.buffers;if(u(e)&&e.length>0){e[0].extras._pipeline.source=n}}return i}var SN=iUe;function sUe(e){return Ie.shader(e,(function(e){wN(e)})),Ie.buffer(e,(function(e){wN(e)})),Ie.image(e,(function(e){wN(e)})),wN(e),e}function wN(e){u(e.extras)&&(u(e.extras._pipeline)&&delete e.extras._pipeline,0===Object.keys(e.extras).length&&delete e.extras)}var vN=sUe;function aUe(e,t){let i=e.extensionsUsed;u(i)||(i=[],e.extensionsUsed=i),Ts(i,t,!0)}var td=aUe;function cUe(e){switch(e){case X.BYTE:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getInt8(t+o*n)};case X.UNSIGNED_BYTE:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getUint8(t+o*n)};case X.SHORT:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getInt16(t+o*n,!0)};case X.UNSIGNED_SHORT:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getUint16(t+o*n,!0)};case X.INT:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getInt32(t+o*n,!0)};case X.UNSIGNED_INT:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getUint32(t+o*n,!0)};case X.FLOAT:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getFloat32(t+o*n,!0)};case X.DOUBLE:return function(e,t,i,n,r){for(let o=0;o<i;++o)r[o]=e.getFloat64(t+o*n,!0)}}}var mg=cUe;function lUe(e,t){let i=e.bufferViews,n=e.buffers,r=t.bufferView,o=ef(t.type);if(!u(t.bufferView))return{min:new Array(o).fill(0),max:new Array(o).fill(0)};let a=new Array(o).fill(Number.POSITIVE_INFINITY),s=new Array(o).fill(Number.NEGATIVE_INFINITY),l=i[r],c=n[l.buffer].extras._pipeline.source,h=t.count,d=Hl(e,t),p=t.byteOffset+l.byteOffset+c.byteOffset,f=t.componentType,m=X.getSizeInBytes(f),_=new DataView(c.buffer),g=new Array(o),y=mg(f);for(let e=0;e<h;e++){y(_,p,o,m,g);for(let e=0;e<o;e++){let t=g[e];a[e]=Math.min(a[e],t),s[e]=Math.max(s[e],t)}p+=d}return{min:a,max:s}}var mA=lUe,uUe=[ee.FUNC_ADD,ee.FUNC_ADD],fUe=[ee.ONE,ee.ZERO,ee.ONE,ee.ZERO];function Qre(e,t){let i=e.enable;return!!u(i)&&i.indexOf(t)>-1}var dUe=[ee.ZERO,ee.ONE,ee.SRC_COLOR,ee.ONE_MINUS_SRC_COLOR,ee.SRC_ALPHA,ee.ONE_MINUS_SRC_ALPHA,ee.DST_ALPHA,ee.ONE_MINUS_DST_ALPHA,ee.DST_COLOR,ee.ONE_MINUS_DST_COLOR];function hUe(e,t){if(!u(e))return t;for(let i=0;i<4;i++)if(-1===dUe.indexOf(e[i]))return t;return e}function mUe(e){let t={},i={},n=e.techniques;return u(n)&&(Ie.technique(e,(function(e,n){let r=e.states;if(u(r)){let o=i[n]={};if(Qre(r,ee.BLEND)){o.alphaMode="BLEND";let e=r.functions;u(e)&&(u(e.blendEquationSeparate)||u(e.blendFuncSeparate))&&(t[n]={blendEquation:y(e.blendEquationSeparate,uUe),blendFactors:hUe(e.blendFuncSeparate,fUe)})}Qre(r,ee.CULL_FACE)||(o.doubleSided=!0),delete e.states}})),Object.keys(t).length>0&&(u(e.extensions)||(e.extensions={}),td(e,"KHR_blend")),Ie.material(e,(function(e){if(u(e.technique)){let n=i[e.technique];Ie.objectLegacy(n,(function(t,i){e[i]=t}));let r=t[e.technique];u(r)&&(u(e.extensions)||(e.extensions={}),e.extensions.KHR_blend=r)}}))),e}var DN=mUe;function pUe(e,t){let i=e.extensionsRequired;u(i)||(i=[],e.extensionsRequired=i),Ts(i,t,!0),td(e,t)}var IN=pUe;function _Ue(e){let t=e.techniques,i={},n={},r={};if(u(t)){let t={programs:[],shaders:[],techniques:[]},o=e.glExtensionsUsed;delete e.glExtensionsUsed,Ie.technique(e,(function(a,s){let l,c={name:a.name,program:void 0,attributes:{},uniforms:{}};if(Ie.techniqueAttribute(a,(function(e,t){l=a.parameters[e],c.attributes[t]={semantic:l.semantic}})),Ie.techniqueUniform(a,(function(e,t){l=a.parameters[e],c.uniforms[t]={count:l.count,node:l.node,type:l.type,semantic:l.semantic,value:l.value},u(i[s])||(i[s]={}),i[s][e]=t})),u(r[a.program]))c.program=r[a.program];else{let i=e.programs[a.program],n={name:i.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:o},s=e.shaders[i.fragmentShader];n.fragmentShader=Ts(t.shaders,s,!0);let l=e.shaders[i.vertexShader];n.vertexShader=Ts(t.shaders,l,!0),c.program=Ts(t.programs,n),r[a.program]=c.program}n[s]=Ts(t.techniques,c)})),t.techniques.length>0&&(u(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=t,td(e,"KHR_techniques_webgl"),IN(e,"KHR_techniques_webgl"))}return Ie.material(e,(function(e){if(u(e.technique)){let t={technique:n[e.technique]};Ie.objectLegacy(e.values,(function(n,r){u(t.values)||(t.values={});let o=i[e.technique][r];u(o)&&(t.values[o]=n)})),u(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=t}delete e.technique,delete e.values})),delete e.techniques,delete e.programs,delete e.shaders,e}var PN=_Ue;function gUe(e,t){El.typeOf.object("material",e),El.defined("handler",t);let i=e.pbrMetallicRoughness;if(u(i)){if(u(i.baseColorTexture)){let e=i.baseColorTexture,n=t(e.index,e);if(u(n))return n}if(u(i.metallicRoughnessTexture)){let e=i.metallicRoughnessTexture,n=t(e.index,e);if(u(n))return n}}if(u(e.extensions)){let i=e.extensions.KHR_materials_pbrSpecularGlossiness;if(u(i)){if(u(i.diffuseTexture)){let e=i.diffuseTexture,n=t(e.index,e);if(u(n))return n}if(u(i.specularGlossinessTexture)){let e=i.specularGlossinessTexture,n=t(e.index,e);if(u(n))return n}}let n=e.extensions.KHR_materials_common;if(u(n)&&u(n.values)){let e=n.values.diffuse,i=n.values.ambient,r=n.values.emission,o=n.values.specular;if(u(e)&&u(e.index)){let i=t(e.index,e);if(u(i))return i}if(u(i)&&u(i.index)){let e=t(i.index,i);if(u(e))return e}if(u(r)&&u(r.index)){let e=t(r.index,r);if(u(e))return e}if(u(o)&&u(o.index)){let e=t(o.index,o);if(u(e))return e}}}let n=Ie.materialValue(e,(function(e){if(u(e.index)){let i=t(e.index,e);if(u(i))return i}}));if(u(n))return n;if(u(e.emissiveTexture)){let i=e.emissiveTexture,n=t(i.index,i);if(u(n))return n}if(u(e.normalTexture)){let i=e.normalTexture,n=t(i.index,i);if(u(n))return n}if(u(e.occlusionTexture)){let i=e.occlusionTexture,n=t(i.index,i);if(u(n))return n}}var Cw=gUe,Jre=["mesh","node","material","accessor","bufferView","buffer","texture","sampler","image"];function yUe(e,t){return t=y(t,Jre),Jre.forEach((function(i){t.indexOf(i)>-1&&bUe(e,i)})),e}var xUe={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",image:"images",node:"nodes",material:"materials",mesh:"meshes",sampler:"samplers",texture:"textures"};function bUe(e,t){let i=e[xUe[t]];if(u(i)){let n=0,r=Lh[t](e),o=i.length;for(let i=0;i<o;++i)r[i]||(Mh[t](e,i-n),n++)}}function Mh(){}function Lh(){}function ese(e,t,i){let n=e.nodes[t];return!(u(n.mesh)||u(n.camera)||u(n.skin)||u(n.weights)||u(n.extras)||u(n.extensions)&&0!==Object.keys(n.extensions).length||u(i[t]))&&(!u(n.children)||0===n.children.filter((function(t){return!ese(e,t,i)})).length)}Mh.accessor=function(e,t){e.accessors.splice(t,1),Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){Ie.meshPrimitiveAttribute(e,(function(i,n){i>t&&e.attributes[n]--})),Ie.meshPrimitiveTarget(e,(function(e){Ie.meshPrimitiveTargetAttribute(e,(function(i,n){i>t&&e[n]--}))}));let i=e.indices;u(i)&&i>t&&e.indices--;let n=e.extensions;u(n)&&u(n.CESIUM_primitive_outline)&&n.CESIUM_primitive_outline.indices>t&&--n.CESIUM_primitive_outline.indices}))})),Ie.skin(e,(function(e){u(e.inverseBindMatrices)&&e.inverseBindMatrices>t&&e.inverseBindMatrices--})),Ie.animation(e,(function(e){Ie.animationSampler(e,(function(e){u(e.input)&&e.input>t&&e.input--,u(e.output)&&e.output>t&&e.output--}))}))},Mh.buffer=function(e,t){e.buffers.splice(t,1),Ie.bufferView(e,(function(e){u(e.buffer)&&e.buffer>t&&e.buffer--,u(e.extensions)&&u(e.extensions.EXT_meshopt_compression)&&e.extensions.EXT_meshopt_compression.buffer--}))},Mh.bufferView=function(e,t){if(e.bufferViews.splice(t,1),Ie.accessor(e,(function(e){u(e.bufferView)&&e.bufferView>t&&e.bufferView--})),Ie.shader(e,(function(e){u(e.bufferView)&&e.bufferView>t&&e.bufferView--})),Ie.image(e,(function(e){u(e.bufferView)&&e.bufferView>t&&e.bufferView--})),cr(e,"KHR_draco_mesh_compression")&&Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){u(e.extensions)&&u(e.extensions.KHR_draco_mesh_compression)&&e.extensions.KHR_draco_mesh_compression.bufferView>t&&e.extensions.KHR_draco_mesh_compression.bufferView--}))})),cr(e,"EXT_feature_metadata")){let i=e.extensions.EXT_feature_metadata.featureTables;for(let e in i)if(i.hasOwnProperty(e)){let n=i[e].properties;if(u(n))for(let e in n)if(n.hasOwnProperty(e)){let i=n[e];u(i.bufferView)&&i.bufferView>t&&i.bufferView--,u(i.arrayOffsetBufferView)&&i.arrayOffsetBufferView>t&&i.arrayOffsetBufferView--,u(i.stringOffsetBufferView)&&i.stringOffsetBufferView>t&&i.stringOffsetBufferView--}}}if(cr(e,"EXT_structural_metadata")){let i=e.extensions.EXT_structural_metadata.propertyTables;if(u(i)){let e=i.length;for(let n=0;n<e;++n){let e=i[n].properties;for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];u(n.values)&&n.values>t&&n.values--,u(n.arrayOffsets)&&n.arrayOffsets>t&&n.arrayOffsets--,u(n.stringOffsets)&&n.stringOffsets>t&&n.stringOffsets--}}}}},Mh.image=function(e,t){e.images.splice(t,1),Ie.texture(e,(function(e){u(e.source)&&e.source>t&&--e.source;let i=e.extensions;u(i)&&u(i.EXT_texture_webp)&&i.EXT_texture_webp.source>t?--e.extensions.EXT_texture_webp.source:u(i)&&u(i.KHR_texture_basisu)&&i.KHR_texture_basisu.source>t&&--e.extensions.KHR_texture_basisu.source}))},Mh.mesh=function(e,t){e.meshes.splice(t,1),Ie.node(e,(function(e){u(e.mesh)&&(e.mesh>t?e.mesh--:e.mesh===t&&delete e.mesh)}))},Mh.node=function(e,t){e.nodes.splice(t,1),Ie.skin(e,(function(e){u(e.skeleton)&&e.skeleton>t&&e.skeleton--,e.joints=e.joints.map((function(e){return e>t?e-1:e}))})),Ie.animation(e,(function(e){Ie.animationChannel(e,(function(e){u(e.target)&&u(e.target.node)&&e.target.node>t&&e.target.node--}))})),Ie.technique(e,(function(e){Ie.techniqueUniform(e,(function(e){u(e.node)&&e.node>t&&e.node--}))})),Ie.node(e,(function(e){u(e.children)&&(e.children=e.children.filter((function(e){return e!==t})).map((function(e){return e>t?e-1:e})))})),Ie.scene(e,(function(e){e.nodes=e.nodes.filter((function(e){return e!==t})).map((function(e){return e>t?e-1:e}))}))},Mh.material=function(e,t){e.materials.splice(t,1),Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){u(e.material)&&e.material>t&&e.material--}))}))},Mh.sampler=function(e,t){e.samplers.splice(t,1),Ie.texture(e,(function(e){u(e.sampler)&&e.sampler>t&&--e.sampler}))},Mh.texture=function(e,t){if(e.textures.splice(t,1),Ie.material(e,(function(e){Cw(e,(function(e,i){i.index>t&&--i.index}))})),cr(e,"EXT_feature_metadata")){Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){let i=e.extensions;if(u(i)&&u(i.EXT_feature_metadata)){let e=i.EXT_feature_metadata.featureIdTextures;if(u(e)){let i=e.length;for(let n=0;n<i;++n){let i=e[n].featureIds.texture;i.index>t&&--i.index}}}}))}));let i=e.extensions.EXT_feature_metadata.featureTextures;for(let e in i)if(i.hasOwnProperty(e)){let n=i[e].properties;if(u(n))for(let e in n)if(n.hasOwnProperty(e)){let i=n[e].texture;i.index>t&&--i.index}}}if(cr(e,"EXT_mesh_features")&&Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){let i=e.extensions;if(u(i)&&u(i.EXT_mesh_features)){let e=i.EXT_mesh_features.featureIds;if(u(e)){let i=e.length;for(let n=0;n<i;++n){let i=e[n];u(i.texture)&&i.texture.index>t&&--i.texture.index}}}}))})),cr(e,"EXT_structural_metadata")){let i=e.extensions.EXT_structural_metadata.propertyTextures;if(u(i)){let e=i.length;for(let n=0;n<e;++n){let e=i[n].properties;for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];n.index>t&&--n.index}}}}},Lh.accessor=function(e){let t={};return Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){Ie.meshPrimitiveAttribute(e,(function(e){t[e]=!0})),Ie.meshPrimitiveTarget(e,(function(e){Ie.meshPrimitiveTargetAttribute(e,(function(e){t[e]=!0}))}));let i=e.indices;u(i)&&(t[i]=!0)}))})),Ie.skin(e,(function(e){u(e.inverseBindMatrices)&&(t[e.inverseBindMatrices]=!0)})),Ie.animation(e,(function(e){Ie.animationSampler(e,(function(e){u(e.input)&&(t[e.input]=!0),u(e.output)&&(t[e.output]=!0)}))})),cr(e,"EXT_mesh_gpu_instancing")&&Ie.node(e,(function(e){u(e.extensions)&&u(e.extensions.EXT_mesh_gpu_instancing)&&Object.keys(e.extensions.EXT_mesh_gpu_instancing.attributes).forEach((function(i){let n=e.extensions.EXT_mesh_gpu_instancing.attributes[i];t[n]=!0}))})),cr(e,"CESIUM_primitive_outline")&&Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){let i=e.extensions;if(u(i)&&u(i.CESIUM_primitive_outline)){let e=i.CESIUM_primitive_outline.indices;u(e)&&(t[e]=!0)}}))})),t},Lh.buffer=function(e){let t={};return Ie.bufferView(e,(function(e){u(e.buffer)&&(t[e.buffer]=!0),u(e.extensions)&&u(e.extensions.EXT_meshopt_compression)&&(t[e.extensions.EXT_meshopt_compression.buffer]=!0)})),t},Lh.bufferView=function(e){let t={};if(Ie.accessor(e,(function(e){u(e.bufferView)&&(t[e.bufferView]=!0)})),Ie.shader(e,(function(e){u(e.bufferView)&&(t[e.bufferView]=!0)})),Ie.image(e,(function(e){u(e.bufferView)&&(t[e.bufferView]=!0)})),cr(e,"KHR_draco_mesh_compression")&&Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){u(e.extensions)&&u(e.extensions.KHR_draco_mesh_compression)&&(t[e.extensions.KHR_draco_mesh_compression.bufferView]=!0)}))})),cr(e,"EXT_feature_metadata")){let i=e.extensions.EXT_feature_metadata.featureTables;for(let e in i)if(i.hasOwnProperty(e)){let n=i[e].properties;if(u(n))for(let e in n)if(n.hasOwnProperty(e)){let i=n[e];u(i.bufferView)&&(t[i.bufferView]=!0),u(i.arrayOffsetBufferView)&&(t[i.arrayOffsetBufferView]=!0),u(i.stringOffsetBufferView)&&(t[i.stringOffsetBufferView]=!0)}}}if(cr(e,"EXT_structural_metadata")){let i=e.extensions.EXT_structural_metadata.propertyTables;if(u(i)){let e=i.length;for(let n=0;n<e;++n){let e=i[n].properties;for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];u(n.values)&&(t[n.values]=!0),u(n.arrayOffsets)&&(t[n.arrayOffsets]=!0),u(n.stringOffsets)&&(t[n.stringOffsets]=!0)}}}}return t},Lh.image=function(e){let t={};return Ie.texture(e,(function(e){u(e.source)&&(t[e.source]=!0),u(e.extensions)&&u(e.extensions.EXT_texture_webp)?t[e.extensions.EXT_texture_webp.source]=!0:u(e.extensions)&&u(e.extensions.KHR_texture_basisu)&&(t[e.extensions.KHR_texture_basisu.source]=!0)})),t},Lh.mesh=function(e){let t={};return Ie.node(e,(function(i){if(u(i.mesh&&u(e.meshes))){let n=e.meshes[i.mesh];u(n)&&u(n.primitives)&&n.primitives.length>0&&(t[i.mesh]=!0)}})),t},Lh.node=function(e){let t={};return Ie.skin(e,(function(e){u(e.skeleton)&&(t[e.skeleton]=!0),Ie.skinJoint(e,(function(e){t[e]=!0}))})),Ie.animation(e,(function(e){Ie.animationChannel(e,(function(e){u(e.target)&&u(e.target.node)&&(t[e.target.node]=!0)}))})),Ie.technique(e,(function(e){Ie.techniqueUniform(e,(function(e){u(e.node)&&(t[e.node]=!0)}))})),Ie.node(e,(function(i,n){ese(e,n,t)||(t[n]=!0)})),t},Lh.material=function(e){let t={};return Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){u(e.material)&&(t[e.material]=!0)}))})),t},Lh.texture=function(e){let t={};if(Ie.material(e,(function(e){Cw(e,(function(e){t[e]=!0}))})),cr(e,"EXT_feature_metadata")){Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){let i=e.extensions;if(u(i)&&u(i.EXT_feature_metadata)){let e=i.EXT_feature_metadata.featureIdTextures;if(u(e)){let i=e.length;for(let n=0;n<i;++n){let i=e[n].featureIds.texture;t[i.index]=!0}}}}))}));let i=e.extensions.EXT_feature_metadata.featureTextures;for(let e in i)if(i.hasOwnProperty(e)){let n=i[e].properties;if(u(n))for(let e in n)if(n.hasOwnProperty(e)){let i=n[e].texture;t[i.index]=!0}}}if(cr(e,"EXT_mesh_features")&&Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){let i=e.extensions;if(u(i)&&u(i.EXT_mesh_features)){let e=i.EXT_mesh_features.featureIds;if(u(e)){let i=e.length;for(let n=0;n<i;++n){let i=e[n];u(i.texture)&&(t[i.texture.index]=!0)}}}}))})),cr(e,"EXT_structural_metadata")){let i=e.extensions.EXT_structural_metadata.propertyTextures;if(u(i)){let e=i.length;for(let n=0;n<e;++n){let e=i[n].properties;for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];t[n.index]=!0}}}}return t},Lh.sampler=function(e){let t={};return Ie.texture(e,(function(e){u(e.sampler)&&(t[e.sampler]=!0)})),t};var ON=yUe;function TUe(e,t){let i={byteLength:t.length,extras:{_pipeline:{source:t}}},n={buffer:Ts(e.buffers,i),byteOffset:0,byteLength:t.length};return Ts(e.bufferViews,n)}var RN=TUe;function AUe(e,t){let i=Hl(e,t),n=X.getSizeInBytes(t.componentType),r=ef(t.type),o=t.count,a=new Array(r*o);if(!u(t.bufferView))return a.fill(0);let s=e.bufferViews[t.bufferView],l=e.buffers[s.buffer].extras._pipeline.source,c=t.byteOffset+s.byteOffset+l.byteOffset,h=new DataView(l.buffer),d=new Array(r),p=mg(t.componentType);for(let e=0;e<o;++e){p(h,c,r,n,d);for(let t=0;t<r;++t)a[e*r+t]=d[t];c+=i}return a}var MN=AUe;function CUe(e){let t;return Ie.accessorWithSemantic(e,"JOINTS_0",(function(i){let n=e.accessors[i];t=n.componentType,t===ee.BYTE?LN(e,n,X.UNSIGNED_BYTE):t!==ee.UNSIGNED_BYTE&&t!==ee.UNSIGNED_SHORT&&LN(e,n,X.UNSIGNED_SHORT)})),Ie.accessorWithSemantic(e,"WEIGHTS_0",(function(i){let n=e.accessors[i];t=n.componentType,t===ee.BYTE?LN(e,n,X.UNSIGNED_BYTE):t===ee.SHORT&&LN(e,n,X.UNSIGNED_SHORT)})),e}function LN(e,t,i){let n=X.createTypedArray(i,MN(e,t)),r=new Uint8Array(n.buffer);t.bufferView=RN(e,r),t.componentType=i,t.byteOffset=0}var NN=CUe;function EUe(e,t){return hA(e,t),"CESIUM_RTC"===t&&SUe(e),l9(e,t)}function SUe(e){Ie.technique(e,(function(e){Ie.techniqueUniform(e,(function(e){"CESIUM_RTC_MODELVIEW"===e.semantic&&(e.semantic="MODELVIEW")}))}))}function l9(e,t){if(Array.isArray(e)){let i=e.length;for(let n=0;n<i;++n)l9(e[n],t)}else if(null!==e&&"object"==typeof e&&e.constructor===Object){let i,n=e.extensions;u(n)&&(i=n[t],u(i)&&(delete n[t],0===Object.keys(n).length&&delete e.extensions));for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&l9(e[i],t);return i}}var pA=EUe,FN={.8:OUe,"1.0":QUe,"2.0":void 0};function wUe(e,t){let i=(t=y(t,y.EMPTY_OBJECT)).targetVersion,n=e.version;e.asset=y(e.asset,{version:"1.0"}),e.asset.version=y(e.asset.version,"1.0"),n=y(n,e.asset.version).toString(),Object.prototype.hasOwnProperty.call(FN,n)||(u(n)&&(n=n.substring(0,3)),Object.prototype.hasOwnProperty.call(FN,n)||(n="1.0"));let r=FN[n];for(;u(r)&&n!==i;)r(e,t),n=e.asset.version,r=FN[n];return t.keepLegacyExtensions||(tze(e,t),nze(e)),e}function nse(e){let t=e.materials;for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let i=t[e],n=i.instanceTechnique;u(n)&&(i.technique=n.technique,i.values=n.values,delete i.instanceTechnique)}}function vUe(e){let t=e.meshes;for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let i=t[e].primitives;if(u(i)){let e=i.length;for(let t=0;t<e;++t){let e=i[t],n=y(e.primitive,ee.TRIANGLES);e.mode=y(e.mode,n),delete e.primitive}}}}function DUe(e){let t=e.nodes,i=new h,n=new Le;for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let r=t[e];if(u(r.rotation)){let e=r.rotation;h.fromArray(e,0,i),Le.fromAxisAngle(i,e[3],n),r.rotation=[n.x,n.y,n.z,n.w]}let o=r.instanceSkin;u(o)&&(r.skeletons=o.skeletons,r.skin=o.skin,r.meshes=o.meshes,delete r.instanceSkin)}}function IUe(e){let t=e.animations,i=e.accessors,n=e.bufferViews,r=e.buffers,o={},a=new h,s=new Le;for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let l=t[e],c=l.channels,d=l.parameters,p=l.samplers;if(u(c)){let e=c.length;for(let t=0;t<e;++t){let e=c[t];if("rotation"===e.target.path){let t=d[p[e.sampler].output];if(u(o[t]))continue;o[t]=!0;let l=i[t],c=n[l.bufferView],f=r[c.buffer].extras._pipeline.source,m=f.byteOffset+c.byteOffset+l.byteOffset,_=l.componentType,g=l.count,y=ef(l.type),v=l.count*y,b=X.createArrayBufferView(_,f.buffer,m,v);for(let e=0;e<g;e++){let t=e*y;h.unpack(b,t,a);let i=b[t+3];Le.fromAxisAngle(a,i,s),Le.pack(s,b,t)}}}}}}function PUe(e){let t=e.techniques;for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let i=t[e],n=i.passes;if(u(n)){let e=y(i.pass,"defaultPass");if(Object.prototype.hasOwnProperty.call(n,e)){let t=n[e],r=t.instanceProgram;i.attributes=y(i.attributes,r.attributes),i.program=y(i.program,r.program),i.uniforms=y(i.uniforms,r.uniforms),i.states=y(i.states,t.states)}delete i.passes,delete i.pass}}}function OUe(e){u(e.asset)||(e.asset={});let t=e.asset;if(t.version="1.0","string"==typeof t.profile){let e=t.profile.split(" ");t.profile={api:e[0],version:e[1]}}else t.profile={};if(u(e.version)&&delete e.version,nse(e),vUe(e),DUe(e),IUe(e),PUe(e),u(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,delete e.allExtensions),u(e.lights)){let t=y(e.extensions,{});e.extensions=t;let i=y(t.KHR_materials_common,{});t.KHR_materials_common=i,i.lights=e.lights,delete e.lights,td(e,"KHR_materials_common")}}function RUe(e){let t=e.animations;for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let i=t[e],n=i.parameters;if(u(n)){let e=i.samplers;for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let i=e[t];i.input=n[i.input],i.output=n[i.output]}delete i.parameters}}}function tse(e,t){let i=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let r=e[n];t[n]=i.length,i.push(r),u(r.name)||(r.name=n)}return i}function MUe(e){let t,i,n={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}},r={},o=e.nodes;for(let e in o)Object.prototype.hasOwnProperty.call(o,e)&&(i=o[e].jointName,u(i)&&(r[i]=e));for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&u(n[t])){let i={},r=e[t];e[t]=tse(r,i),n[t]=i}for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(r[i]=n.nodes[r[i]]);u(e.scene)&&(e.scene=n.scenes[e.scene]),Ie.bufferView(e,(function(e){u(e.buffer)&&(e.buffer=n.buffers[e.buffer])})),Ie.accessor(e,(function(e){u(e.bufferView)&&(e.bufferView=n.bufferViews[e.bufferView])})),Ie.shader(e,(function(e){let t=e.extensions;if(u(t)){let i=t.KHR_binary_glTF;u(i)&&(e.bufferView=n.bufferViews[i.bufferView],delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}})),Ie.program(e,(function(e){u(e.vertexShader)&&(e.vertexShader=n.shaders[e.vertexShader]),u(e.fragmentShader)&&(e.fragmentShader=n.shaders[e.fragmentShader])})),Ie.technique(e,(function(e){u(e.program)&&(e.program=n.programs[e.program]),Ie.techniqueParameter(e,(function(e){u(e.node)&&(e.node=n.nodes[e.node]);let t=e.value;"string"==typeof t&&(e.value={index:n.textures[t]})}))})),Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){u(e.indices)&&(e.indices=n.accessors[e.indices]),Ie.meshPrimitiveAttribute(e,(function(t,i){e.attributes[i]=n.accessors[t]})),u(e.material)&&(e.material=n.materials[e.material])}))})),Ie.node(e,(function(i){let r=i.children;if(u(r)){let e=r.length;for(t=0;t<e;++t)r[t]=n.nodes[r[t]]}if(u(i.meshes)){let o=i.meshes,a=o.length;if(a>0)for(i.mesh=n.meshes[o[0]],t=1;t<a;++t){let a={mesh:n.meshes[o[t]]},s=Ts(e.nodes,a);u(r)||(r=[],i.children=r),r.push(s)}delete i.meshes}if(u(i.camera)&&(i.camera=n.cameras[i.camera]),u(i.skin)&&(i.skin=n.skins[i.skin]),u(i.skeletons)){let t=i.skeletons;if(t.length>0&&u(i.skin)){e.skins[i.skin].skeleton=n.nodes[t[0]]}delete i.skeletons}u(i.jointName)&&delete i.jointName})),Ie.skin(e,(function(e){u(e.inverseBindMatrices)&&(e.inverseBindMatrices=n.accessors[e.inverseBindMatrices]);let i=e.jointNames;if(u(i)){let n=[],o=i.length;for(t=0;t<o;++t)n[t]=r[i[t]];e.joints=n,delete e.jointNames}})),Ie.scene(e,(function(e){let i=e.nodes;if(u(i)){let e=i.length;for(t=0;t<e;++t)i[t]=n.nodes[i[t]]}})),Ie.animation(e,(function(e){let t={};e.samplers=tse(e.samplers,t),Ie.animationSampler(e,(function(e){e.input=n.accessors[e.input],e.output=n.accessors[e.output]})),Ie.animationChannel(e,(function(e){e.sampler=t[e.sampler];let i=e.target;u(i)&&(i.node=n.nodes[i.id],delete i.id)}))})),Ie.material(e,(function(e){u(e.technique)&&(e.technique=n.techniques[e.technique]),Ie.materialValue(e,(function(t,i){"string"==typeof t&&(e.values[i]={index:n.textures[t]})}));let t=e.extensions;if(u(t)){let e=t.KHR_materials_common;u(e)&&u(e.values)&&Ie.materialValue(e,(function(t,i){"string"==typeof t&&(e.values[i]={index:n.textures[t]})}))}})),Ie.image(e,(function(e){let t=e.extensions;if(u(t)){let i=t.KHR_binary_glTF;u(i)&&(e.bufferView=n.bufferViews[i.bufferView],e.mimeType=i.mimeType,delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}})),Ie.texture(e,(function(e){u(e.sampler)&&(e.sampler=n.samplers[e.sampler]),u(e.source)&&(e.source=n.images[e.source])}))}function LUe(e){Ie.animation(e,(function(e){Ie.animationSampler(e,(function(e){delete e.name}))}))}function NUe(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t)){let i=e[t];Array.isArray(i)&&0===i.length&&delete e[t]}Ie.node(e,(function(e){u(e.children)&&0===e.children.length&&delete e.children}))}function FUe(e){let t=e.asset;delete t.profile,delete t.premultipliedAlpha}var BUe={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};function kUe(e){let t=e.extensionsUsed;if(e.extensionsRequired=y(e.extensionsRequired,[]),u(t)){let i=t.length;for(let n=0;n<i;++n){let i=t[n];u(BUe[i])&&e.extensionsRequired.push(i)}}}function VUe(e){Ie.buffer(e,(function(e){delete e.type}))}function UUe(e){Ie.texture(e,(function(e){delete e.format,delete e.internalFormat,delete e.target,delete e.type}))}function zUe(e){Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){Ie.meshPrimitiveAttribute(e,(function(t,i){"TEXCOORD"===i?e.attributes.TEXCOORD_0=t:"COLOR"===i&&(e.attributes.COLOR_0=t)})),delete e.attributes.TEXCOORD,delete e.attributes.COLOR}))})),Ie.technique(e,(function(e){Ie.techniqueParameter(e,(function(e){let t=e.semantic;u(t)&&("TEXCOORD"===t?e.semantic="TEXCOORD_0":"COLOR"===t&&(e.semantic="COLOR_0"))}))}))}var HUe={POSITION:!0,NORMAL:!0,TANGENT:!0},GUe={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function WUe(e){let t={};Ie.mesh(e,(function(e){Ie.meshPrimitive(e,(function(e){Ie.meshPrimitiveAttribute(e,(function(e,i){if("_"!==i.charAt(0)){let e=i.search(/_[0-9]+/g),n=i,r="_0";e>=0&&(n=i.substring(0,e),r=i.substring(e));let o,a=GUe[n];u(a)?(o=a+r,t[i]=o):u(HUe[n])||(o=`_${i}`,t[i]=o)}}));for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)){let n=t[i],r=e.attributes[i];u(r)&&(delete e.attributes[i],e.attributes[n]=r)}}))})),Ie.technique(e,(function(e){Ie.techniqueParameter(e,(function(e){let i=t[e.semantic];u(i)&&(e.semantic=i)}))}))}function jUe(e){Ie.camera(e,(function(e){let t=e.perspective;if(u(t)){let e=t.aspectRatio;u(e)&&0===e&&delete t.aspectRatio;let i=t.yfov;u(i)&&0===i&&(t.yfov=1)}}))}function u9(e,t){return u(t.byteStride)&&0!==t.byteStride?t.byteStride:Hl(e,t)}function qUe(e){Ie.buffer(e,(function(e){u(e.byteLength)||(e.byteLength=e.extras._pipeline.source.length)})),Ie.accessor(e,(function(t){let i=t.bufferView;if(u(i)){let n=e.bufferViews[i],r=u9(e,t),o=t.byteOffset+t.count*r;n.byteLength=Math.max(y(n.byteLength,0),o)}}))}function YUe(e){let t,i,n,r=e.bufferViews,o={};Ie.accessorContainingVertexAttributeData(e,(function(t){let i=e.accessors[t];u(i.bufferView)&&(o[i.bufferView]=!0)}));let a={};Ie.accessor(e,(function(e){u(e.bufferView)&&(a[e.bufferView]=y(a[e.bufferView],[]),a[e.bufferView].push(e))}));for(let s in a)if(Object.prototype.hasOwnProperty.call(a,s)){n=r[s];let l=a[s];l.sort((function(e,t){return e.byteOffset-t.byteOffset}));let u=0,c=0,h=l.length;for(t=0;t<h;++t){let a=l[t],d=u9(e,a),p=a.byteOffset,f=a.count*d;delete a.byteStride;let m=t<h-1;if(d!==(m?u9(e,l[t+1]):void 0)){let e=Ge(n,!0);o[s]&&(e.byteStride=d),e.byteOffset+=u,e.byteLength=p+f-u;let h=Ts(r,e);for(i=c;i<=t;++i)a=l[i],a.bufferView=h,a.byteOffset=a.byteOffset-u;u=m?l[t+1].byteOffset:void 0,c=t+1}}}ON(e,["accessor","bufferView","buffer"])}function XUe(e){Ie.accessorWithSemantic(e,"POSITION",(function(t){let i=e.accessors[t];if(!u(i.min)||!u(i.max)){let t=mA(e,i);i.min=t.min,i.max=t.max}}))}function ise(e){return(!u(e.children)||0===e.children.length)&&(!u(e.meshes)||0===e.meshes.length)&&!u(e.camera)&&!u(e.skin)&&!u(e.skeletons)&&!u(e.jointName)&&(!u(e.translation)||h.fromArray(e.translation).equals(h.ZERO))&&(!u(e.scale)||h.fromArray(e.scale).equals(new h(1,1,1)))&&(!u(e.rotation)||oe.fromArray(e.rotation).equals(new oe(0,0,0,1)))&&(!u(e.matrix)||L.fromColumnMajorArray(e.matrix).equals(L.IDENTITY))&&!u(e.extensions)&&!u(e.extras)}function ose(e,t){Ie.scene(e,(function(e){let i=e.nodes;if(u(i)){for(let e=i.length;e>=0;--e)if(i[e]===t)return void i.splice(e,1)}})),Ie.node(e,(function(i,n){if(u(i.children)){let r=i.children.indexOf(t);r>-1&&(i.children.splice(r,1),ise(i)&&ose(e,n))}})),delete e.nodes[t]}function KUe(e){return Ie.node(e,(function(t,i){ise(t)&&ose(e,i)})),e}function ZUe(e){Ie.animation(e,(function(t){Ie.animationSampler(t,(function(t){let i=e.accessors[t.input];if(!u(i.min)||!u(i.max)){let t=mA(e,i);i.min=t.min,i.max=t.max}}))}))}function $Ue(e){Ie.accessor(e,(function(t){if(u(t.min)||u(t.max)){let i=mA(e,t);u(t.min)&&(t.min=i.min),u(t.max)&&(t.max=i.max)}}))}function QUe(e){e.asset=y(e.asset,{}),e.asset.version="2.0",nse(e),RUe(e),KUe(e),MUe(e),LUe(e),FUe(e),kUe(e),qUe(e),YUe(e),XUe(e),ZUe(e),$Ue(e),VUe(e),UUe(e),zUe(e),WUe(e),NN(e),jUe(e),DN(e),PN(e),NUe(e)}var JUe=["u_tex","u_diffuse","u_emission","u_diffuse_tex"],eze=["u_diffuse","u_diffuse_mat"];function f9(e){e.pbrMetallicRoughness=u(e.pbrMetallicRoughness)?e.pbrMetallicRoughness:{},e.pbrMetallicRoughness.roughnessFactor=1,e.pbrMetallicRoughness.metallicFactor=0}function BN(e){return u(e.index)}function kN(e){return Array.isArray(e)&&4===e.length}function rse(e){let t=new Array(4);t[3]=e[3];for(let i=0;i<3;i++){let n=e[i];t[i]=n<=.04045?.07739938080495357*e[i]:Math.pow(.9478672985781991*(n+.055),2.4)}return t}function tze(e,t){t=y(t,y.EMPTY_OBJECT);let i=y(t.baseColorTextureNames,JUe),n=y(t.baseColorFactorNames,eze);Ie.material(e,(function(e){Ie.materialValue(e,(function(t,r){-1!==i.indexOf(r)&&BN(t)?(f9(e),e.pbrMetallicRoughness.baseColorTexture=t):-1!==n.indexOf(r)&&kN(t)&&(f9(e),e.pbrMetallicRoughness.baseColorFactor=rse(t))}))})),pA(e,"KHR_techniques_webgl"),pA(e,"KHR_blend")}function nze(e){Ie.material(e,(function(t){let i=y(t.extensions,y.EMPTY_OBJECT).KHR_materials_common;if(u(i)){"CONSTANT"===i.technique&&(td(e,"KHR_materials_unlit"),t.extensions=u(t.extensions)?t.extensions:{},t.extensions.KHR_materials_unlit={});let n=u(i.values)?i.values:{},r=n.ambient,o=n.diffuse,a=n.emission,s=n.transparency,l=i.doubleSided,c=i.transparent;f9(t),u(r)&&(kN(r)?t.emissiveFactor=r.slice(0,3):BN(r)&&(t.emissiveTexture=r)),u(o)&&(kN(o)?t.pbrMetallicRoughness.baseColorFactor=rse(o):BN(o)&&(t.pbrMetallicRoughness.baseColorTexture=o)),u(l)&&(t.doubleSided=l),u(a)&&(kN(a)?t.emissiveFactor=a.slice(0,3):BN(a)&&(t.emissiveTexture=a)),u(s)&&(u(t.pbrMetallicRoughness.baseColorFactor)?t.pbrMetallicRoughness.baseColorFactor[3]*=s:t.pbrMetallicRoughness.baseColorFactor=[1,1,1,s]),u(c)&&(t.alphaMode=c?"BLEND":"OPAQUE")}})),pA(e,"KHR_materials_common")}var VN=wUe,Jn={POSITION:"POSITION",NORMAL:"NORMAL",TANGENT:"TANGENT",TEXCOORD:"TEXCOORD",COLOR:"COLOR",JOINTS:"JOINTS",WEIGHTS:"WEIGHTS",FEATURE_ID:"_FEATURE_ID"};function ize(e){switch(e){case Jn.POSITION:return"positionMC";case Jn.NORMAL:return"normalMC";case Jn.TANGENT:return"tangentMC";case Jn.TEXCOORD:return"texCoord";case Jn.COLOR:return"color";case Jn.JOINTS:return"joints";case Jn.WEIGHTS:return"weights";case Jn.FEATURE_ID:return"featureId"}}Jn.hasSetIndex=function(e){switch(e){case Jn.POSITION:case Jn.NORMAL:case Jn.TANGENT:return!1;case Jn.TEXCOORD:case Jn.COLOR:case Jn.JOINTS:case Jn.WEIGHTS:case Jn.FEATURE_ID:return!0}},Jn.fromGltfSemantic=function(e){let t=e,i=/^(\w+)_\d+$/.exec(e);switch(null!==i&&(t=i[1]),t){case"POSITION":return Jn.POSITION;case"NORMAL":return Jn.NORMAL;case"TANGENT":return Jn.TANGENT;case"TEXCOORD":return Jn.TEXCOORD;case"COLOR":return Jn.COLOR;case"JOINTS":return Jn.JOINTS;case"WEIGHTS":return Jn.WEIGHTS;case"_FEATURE_ID":return Jn.FEATURE_ID}},Jn.fromPntsSemantic=function(e){switch(e){case"POSITION":case"POSITION_QUANTIZED":return Jn.POSITION;case"RGBA":case"RGB":case"RGB565":return Jn.COLOR;case"NORMAL":case"NORMAL_OCT16P":return Jn.NORMAL;case"BATCH_ID":return Jn.FEATURE_ID}},Jn.getGlslType=function(e){switch(e){case Jn.POSITION:case Jn.NORMAL:case Jn.TANGENT:return"vec3";case Jn.TEXCOORD:return"vec2";case Jn.COLOR:return"vec4";case Jn.JOINTS:return"ivec4";case Jn.WEIGHTS:return"vec4";case Jn.FEATURE_ID:return"int"}},Jn.getVariableName=function(e,t){let i=ize(e);return u(t)&&(i+=`_${t}`),i};var Tt=Object.freeze(Jn);function Ga(){}Ga.getError=function(e,t,i){let n=`Failed to load ${e}: ${t}`;u(i)&&u(i.message)&&(n+=`\n${i.message}`);let r=new ue(n);return u(i)&&(r.stack=`Original stack:\n${i.stack}\nHandler stack:\n${r.stack}`),r},Ga.getNodeTransform=function(e){return u(e.matrix)?e.matrix:L.fromTranslationQuaternionRotationScale(u(e.translation)?e.translation:h.ZERO,u(e.rotation)?e.rotation:Le.IDENTITY,u(e.scale)?e.scale:h.ONE)},Ga.getAttributeBySemantic=function(e,t,i){let n=e.attributes,r=n.length;for(let e=0;e<r;++e){let r=n[e],o=!u(i)||r.setIndex===i;if(r.semantic===t&&o)return r}},Ga.getAttributeByName=function(e,t){let i=e.attributes,n=i.length;for(let e=0;e<n;++e){let n=i[e];if(n.name===t)return n}},Ga.getFeatureIdsByLabel=function(e,t){for(let i=0;i<e.length;i++){let n=e[i];if(n.positionalLabel===t||n.label===t)return n}},Ga.hasQuantizedAttributes=function(e){if(!u(e))return!1;for(let t=0;t<e.length;t++){let i=e[t];if(u(i.quantization))return!0}return!1},Ga.getAttributeInfo=function(e){let t,i=e.semantic,n=e.setIndex,r=!1;u(i)?(t=Tt.getVariableName(i,n),r=!0):(t=e.name,t=t.replace(/^_/,""),t=t.toLowerCase());let o=/^color_\d+$/.test(t),a=e.type,s=nn.getGlslType(a);o&&(s="vec4");let l,c=u(e.quantization);return c&&(l=o?"vec4":nn.getGlslType(e.quantization.type)),{attribute:e,isQuantized:c,variableName:t,hasSemantic:r,glslType:s,quantizedGlslType:l}};var oze=new h,rze=new h;Ga.getPositionMinMax=function(e,t,i){let n=Ga.getAttributeBySemantic(e,"POSITION"),r=n.max,o=n.min;return u(i)&&u(t)&&(o=h.add(o,t,rze),r=h.add(r,i,oze)),{min:o,max:r}},Ga.getAxisCorrectionMatrix=function(e,t,i){return i=L.clone(L.IDENTITY,i),e===wo.Y?i=L.clone(wo.Y_UP_TO_Z_UP,i):e===wo.X&&(i=L.clone(wo.X_UP_TO_Z_UP,i)),t===wo.Z&&(i=L.multiplyTransformation(i,wo.Z_UP_TO_X_UP,i)),i};var sze=new $;Ga.getCullFace=function(e,t){if(!Ne.isTriangles(t))return gi.BACK;let i=L.getMatrix3(e,sze);return $.determinant(i)<0?gi.FRONT:gi.BACK},Ga.sanitizeGlslIdentifier=function(e){let t=e.replaceAll(/[^A-Za-z0-9]+/g,"_");return t=t.replace(/^gl_/,""),/^\d/.test(t)&&(t=`_${t}`),t},Ga.supportedExtensions={AGI_articulations:!0,CESIUM_primitive_outline:!0,CESIUM_RTC:!0,EXT_feature_metadata:!0,EXT_instance_features:!0,EXT_mesh_features:!0,EXT_mesh_gpu_instancing:!0,EXT_meshopt_compression:!0,EXT_structural_metadata:!0,EXT_texture_webp:!0,KHR_blend:!0,KHR_draco_mesh_compression:!0,KHR_techniques_webgl:!0,KHR_materials_common:!0,KHR_materials_pbrSpecularGlossiness:!0,KHR_materials_unlit:!0,KHR_mesh_quantization:!0,KHR_texture_basisu:!0,KHR_texture_transform:!0,WEB3D_quantized_attributes:!0},Ga.checkSupportedExtensions=function(e){let t=e.length;for(let i=0;i<t;i++){let t=e[i];if(!Ga.supportedExtensions[t])throw new ue(`Unsupported glTF Extension: ${t}`)}};var en=Ga;function pg(e){let t=(e=y(e,y.EMPTY_OBJECT)).resourceCache,i=e.gltfResource,n=e.baseResource,r=e.typedArray,o=e.gltfJson,a=e.cacheKey;this._resourceCache=t,this._gltfResource=i,this._baseResource=n,this._typedArray=r,this._gltfJson=o,this._cacheKey=a,this._gltf=void 0,this._bufferLoaders=[],this._state=St.UNLOADED,this._promise=void 0}async function aze(e){let t;try{let i=await e._fetchGltf();if(e.isDestroyed())return;t=new Uint8Array(i)}catch(t){if(e.isDestroyed())return;d9(e,t)}return ase(e,t)}function d9(e,t){e.unload(),e._state=St.FAILED;let i=`Failed to load glTF: ${e._gltfResource.url}`;throw e.getError(i,t)}async function cze(e,t){if(u(t.asset)&&"2.0"===t.asset.version&&!cr(t,"KHR_techniques_webgl")&&!cr(t,"KHR_materials_common"))return Promise.resolve();let i=[];Ie.buffer(t,(function(t){if(!u(t.extras._pipeline.source)&&u(t.uri)){let n=e._baseResource.getDerivedResource({url:t.uri}),r=e._resourceCache.getExternalBufferLoader({resource:n});e._bufferLoaders.push(r),i.push(r.load().then((function(){r.isDestroyed()||(t.extras._pipeline.source=r.typedArray)})))}})),await Promise.all(i),VN(t)}function lze(e){let t=[];return Ie.buffer(e,(function(e){let i=e.uri;!u(e.extras._pipeline.source)&&u(i)&&t_(i)&&(delete e.uri,t.push(ve.fetchArrayBuffer(i).then((function(t){e.extras._pipeline.source=new Uint8Array(t)}))))})),Promise.all(t)}function uze(e,t){let i=[];return Ie.buffer(t,(function(t,n){let r=t.extras._pipeline.source;if(u(r)&&!u(t.uri)){let t=e._resourceCache.getEmbeddedBufferLoader({parentResource:e._gltfResource,bufferId:n,typedArray:r});e._bufferLoaders.push(t),i.push(t.load())}})),Promise.all(i)}async function sse(e,t){try{j0(t),await lze(t),await cze(e,t),AN(t),await uze(e,t),vN(t);let i=t.asset.version;if("1.0"!==i&&"2.0"!==i)throw new ue(`Unsupported glTF version: ${i}`);let n=t.extensionsRequired;return u(n)&&en.checkSupportedExtensions(n),e._gltf=t,e._state=St.READY,e}catch(t){if(e.isDestroyed())return;d9(e,t)}}async function ase(e,t){let i;try{i="glTF"===bh(t)?SN(t):So(t)}catch(t){if(e.isDestroyed())return;d9(e,t)}return sse(e,i)}u(Object.create)&&(pg.prototype=Object.create(io.prototype),pg.prototype.constructor=pg),Object.defineProperties(pg.prototype,{cacheKey:{get:function(){return this._cacheKey}},gltf:{get:function(){return this._gltf}}}),pg.prototype.load=async function(){return u(this._promise)?this._promise:(this._state=St.LOADING,u(this._gltfJson)?(this._promise=sse(this,this._gltfJson),this._promise):u(this._typedArray)?(this._promise=ase(this,this._typedArray),this._promise):(this._promise=aze(this),this._promise))},pg.prototype.unload=function(){let e=this._bufferLoaders,t=e.length;for(let i=0;i<t;++i)e[i]=!e[i].isDestroyed()&&this._resourceCache.unload(e[i]);this._bufferLoaders.length=0,this._gltf=void 0},pg.prototype._fetchGltf=function(){return this._gltfResource.fetchArrayBuffer()};var Ew=pg,Vo={};function fze(){this.octEncoded=!1,this.octEncodedZXY=!1,this.normalizationRange=void 0,this.quantizedVolumeOffset=void 0,this.quantizedVolumeDimensions=void 0,this.quantizedVolumeStepSize=void 0,this.componentDatatype=void 0,this.type=void 0}function dze(){this.name=void 0,this.semantic=void 0,this.setIndex=void 0,this.componentDatatype=void 0,this.type=void 0,this.normalized=!1,this.count=void 0,this.min=void 0,this.max=void 0,this.constant=void 0,this.quantization=void 0,this.typedArray=void 0,this.buffer=void 0,this.byteOffset=0,this.byteStride=void 0}function hze(){this.indexDatatype=void 0,this.count=void 0,this.buffer=void 0,this.typedArray=void 0}function mze(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.setIndex=void 0,this.label=void 0,this.positionalLabel=void 0}function pze(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.offset=0,this.repeat=void 0,this.label=void 0,this.positionalLabel=void 0}function _ze(){this.featureCount=void 0,this.nullFeatureId=void 0,this.propertyTableId=void 0,this.textureReader=void 0,this.label=void 0,this.positionalLabel=void 0}function gze(){this.attributes=[]}function yze(){this.attributes=[],this.morphTargets=[],this.indices=void 0,this.material=void 0,this.primitiveType=void 0,this.featureIds=[],this.propertyTextureIds=[],this.propertyAttributeIds=[],this.outlineCoordinates=void 0}function xze(){this.attributes=[],this.featureIds=[],this.transformInWorldSpace=!1}function bze(){this.index=void 0,this.joints=[],this.inverseBindMatrices=[]}function Tze(){this.name=void 0,this.index=void 0,this.children=[],this.primitives=[],this.instances=void 0,this.skin=void 0,this.matrix=void 0,this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.morphWeights=[],this.articulationName=void 0}function Aze(){this.nodes=[]}var Cze={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};function Eze(){this.input=[],this.interpolation=void 0,this.output=[]}function Sze(){this.node=void 0,this.path=void 0}function wze(){this.sampler=void 0,this.target=void 0}function vze(){this.name=void 0,this.samplers=[],this.channels=[]}function Dze(){this.name=void 0,this.type=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.initialValue=void 0}function Ize(){this.name=void 0,this.stages=[]}function cse(){this.credits=[]}function Pze(){this.asset=new cse,this.scene=void 0,this.nodes=[],this.skins=[],this.animations=[],this.articulations=[],this.structuralMetadata=void 0,this.upAxis=void 0,this.forwardAxis=void 0,this.transform=L.clone(L.IDENTITY)}function Oze(){this.texture=void 0,this.index=void 0,this.texCoord=0,this.transform=$.clone($.IDENTITY),this.channels=void 0}function _g(){this.baseColorTexture=void 0,this.metallicRoughnessTexture=void 0,this.baseColorFactor=oe.clone(_g.DEFAULT_BASE_COLOR_FACTOR),this.metallicFactor=_g.DEFAULT_METALLIC_FACTOR,this.roughnessFactor=_g.DEFAULT_ROUGHNESS_FACTOR}function q0(){this.diffuseTexture=void 0,this.specularGlossinessTexture=void 0,this.diffuseFactor=oe.clone(q0.DEFAULT_DIFFUSE_FACTOR),this.specularFactor=h.clone(q0.DEFAULT_SPECULAR_FACTOR),this.glossinessFactor=q0.DEFAULT_GLOSSINESS_FACTOR}function h9(){this.metallicRoughness=new _g,this.specularGlossiness=void 0,this.emissiveTexture=void 0,this.normalTexture=void 0,this.occlusionTexture=void 0,this.emissiveFactor=h.clone(h9.DEFAULT_EMISSIVE_FACTOR),this.alphaMode=Ym.OPAQUE,this.alphaCutoff=.5,this.doubleSided=!1,this.unlit=!1}_g.DEFAULT_BASE_COLOR_FACTOR=oe.ONE,_g.DEFAULT_METALLIC_FACTOR=1,_g.DEFAULT_ROUGHNESS_FACTOR=1,q0.DEFAULT_DIFFUSE_FACTOR=oe.ONE,q0.DEFAULT_SPECULAR_FACTOR=h.ONE,q0.DEFAULT_GLOSSINESS_FACTOR=1,h9.DEFAULT_EMISSIVE_FACTOR=h.ZERO,Vo.Quantization=fze,Vo.Attribute=dze,Vo.Indices=hze,Vo.FeatureIdAttribute=mze,Vo.FeatureIdTexture=_ze,Vo.FeatureIdImplicitRange=pze,Vo.MorphTarget=gze,Vo.Primitive=yze,Vo.Instances=xze,Vo.Skin=bze,Vo.Node=Tze,Vo.Scene=Aze,Vo.AnimatedPropertyType=Object.freeze(Cze),Vo.AnimationSampler=Eze,Vo.AnimationTarget=Sze,Vo.AnimationChannel=wze,Vo.Animation=vze,Vo.ArticulationStage=Dze,Vo.Articulation=Ize,Vo.Asset=cse,Vo.Components=Pze,Vo.TextureReader=Oze,Vo.MetallicRoughness=_g,Vo.SpecularGlossiness=q0,Vo.Material=h9;var Mt=Vo,UN={getImageIdFromTexture:function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.textureId,n=e.supportedImageFormats,r=t.textures[i],o=r.extensions;if(u(o)){if(n.webp&&u(o.EXT_texture_webp))return o.EXT_texture_webp.source;if(n.basis&&u(o.KHR_texture_basisu))return o.KHR_texture_basisu.source}return r.source},createSampler:function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.textureInfo,n=y(e.compressedTextureNoMipmap,!1),r=vn.REPEAT,o=vn.REPEAT,a=an.LINEAR,s=wi.LINEAR,l=i.index,c=t.textures[l].sampler;if(u(c)){let e=t.samplers[c];r=y(e.wrapS,r),o=y(e.wrapT,o),a=y(e.minFilter,a),s=y(e.magFilter,s)}return n&&a!==an.LINEAR&&a!==an.NEAREST&&(a=a===an.NEAREST_MIPMAP_NEAREST||a===an.NEAREST_MIPMAP_LINEAR?an.NEAREST:an.LINEAR),new un({wrapS:r,wrapT:o,minificationFilter:a,magnificationFilter:s})}},Rze=new U(1,1);UN.createModelTextureReader=function(e){let t,i=(e=y(e,y.EMPTY_OBJECT)).textureInfo,n=e.channels,r=e.texture,o=y(i.texCoord,0),a=y(i.extensions,y.EMPTY_OBJECT).KHR_texture_transform;if(u(a)){o=y(a.texCoord,o);let e=u(a.offset)?U.unpack(a.offset):U.ZERO,i=y(a.rotation,0),n=u(a.scale)?U.unpack(a.scale):Rze;i=-i,t=new $(Math.cos(i)*n.x,-Math.sin(i)*n.y,e.x,Math.sin(i)*n.x,Math.cos(i)*n.y,e.y,0,0,1)}let s=new Mt.TextureReader;return s.index=i.index,s.texture=r,s.texCoord=o,s.transform=t,s.channels=n,s};var Gl=UN;function gg(e){let t=(e=y(e,y.EMPTY_OBJECT)).resourceCache,i=e.gltf,n=e.textureInfo,r=e.gltfResource,o=e.baseResource,a=e.supportedImageFormats,s=e.cacheKey,l=y(e.asynchronous,!0),u=n.index,c=Gl.getImageIdFromTexture({gltf:i,textureId:u,supportedImageFormats:a});this._resourceCache=t,this._gltf=i,this._textureInfo=n,this._imageId=c,this._gltfResource=r,this._baseResource=o,this._cacheKey=s,this._asynchronous=l,this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._state=St.UNLOADED,this._promise=void 0}u(Object.create)&&(gg.prototype=Object.create(io.prototype),gg.prototype.constructor=gg),Object.defineProperties(gg.prototype,{cacheKey:{get:function(){return this._cacheKey}},texture:{get:function(){return this._texture}}});var Mze=new m9;async function Lze(e){let t=e._resourceCache;try{let i=t.getImageLoader({gltf:e._gltf,imageId:e._imageId,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._imageLoader=i,await i.load(),e.isDestroyed()?void 0:(e._image=i.image,e._mipLevels=i.mipLevels,e._state=St.LOADED,e)}catch(t){if(e.isDestroyed())return;e.unload(),e._state=St.FAILED;let i="Failed to load texture";throw e.getError(i,t)}}function m9(){this.gltf=void 0,this.textureInfo=void 0,this.image=void 0,this.context=void 0,this.texture=void 0}function lse(e,t,i,n,r){let o=i.internalFormat,a=!1;rt.isCompressedFormat(o)&&!u(n)&&(a=!0);let s,l=Gl.createSampler({gltf:e,textureInfo:t,compressedTextureNoMipmap:a}),c=l.minificationFilter,h=l.wrapS,d=l.wrapT,p=c===an.NEAREST_MIPMAP_NEAREST||c===an.NEAREST_MIPMAP_LINEAR||c===an.LINEAR_MIPMAP_NEAREST||c===an.LINEAR_MIPMAP_LINEAR,f=!u(o)&&p,m=f||h===vn.REPEAT||h===vn.MIRRORED_REPEAT||d===vn.REPEAT||d===vn.MIRRORED_REPEAT,_=!P.isPowerOfTwo(i.width)||!P.isPowerOfTwo(i.height),g=m&&_;return u(o)?(!r.webgl2&&rt.isCompressedFormat(o)&&_&&m&&console.warn("Compressed texture uses REPEAT or MIRRORED_REPEAT texture wrap mode and dimensions are not powers of two. The texture may be rendered incorrectly."),s=Ot.create({context:r,source:{arrayBufferView:i.bufferView,mipLevels:n},width:i.width,height:i.height,pixelFormat:i.internalFormat,sampler:l})):(g&&(i=S0(i)),s=Ot.create({context:r,source:i,sampler:l,flipY:!1,skipColorSpaceConversion:!0})),f&&s.generateMipmap(),s}gg.prototype.load=async function(){return u(this._promise)||(this._state=St.LOADING,this._promise=Lze(this)),this._promise},m9.prototype.set=function(e,t,i,n,r){this.gltf=e,this.textureInfo=t,this.image=i,this.mipLevels=n,this.context=r},m9.prototype.execute=function(){this.texture=lse(this.gltf,this.textureInfo,this.image,this.mipLevels,this.context)},gg.prototype.process=function(e){if(this._state===St.READY)return!0;if(this._state!==St.LOADED&&this._state!==St.PROCESSING||u(this._texture)||!u(this._image))return!1;let t;if(this._state=St.PROCESSING,this._asynchronous){let i=Mze;if(i.set(this._gltf,this._textureInfo,this._image,this._mipLevels,e.context),!e.jobScheduler.execute(i,Ha.TEXTURE))return;t=i.texture}else t=lse(this._gltf,this._textureInfo,this._image,this._mipLevels,e.context);return this.unload(),this._texture=t,this._state=St.READY,this._resourceCache.statistics.addTextureLoader(this),!0},gg.prototype.unload=function(){u(this._texture)&&this._texture.destroy(),u(this._imageLoader)&&!this._imageLoader.isDestroyed()&&this._resourceCache.unload(this._imageLoader),this._imageLoader=void 0,this._image=void 0,this._mipLevels=void 0,this._texture=void 0,this._gltf=void 0};var Sw=gg;function yg(e){let t=(e=y(e,y.EMPTY_OBJECT)).resourceCache,i=e.gltf,n=e.gltfResource,r=e.baseResource,o=e.bufferViewId,a=e.draco,s=e.attributeSemantic,l=e.accessorId,u=e.cacheKey,c=y(e.asynchronous,!0),h=y(e.loadBuffer,!1),d=y(e.loadTypedArray,!1);this._resourceCache=t,this._gltfResource=n,this._baseResource=r,this._gltf=i,this._bufferViewId=o,this._draco=a,this._attributeSemantic=s,this._accessorId=l,this._cacheKey=u,this._asynchronous=c,this._loadBuffer=h,this._loadTypedArray=d,this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._quantization=void 0,this._typedArray=void 0,this._buffer=void 0,this._state=St.UNLOADED,this._promise=void 0}function Nze(e,t){return u(e)&&u(e.attributes)&&u(e.attributes[t])}function Fze(e,t,i,n){let r=(1<<e.quantizationBits)-1,o=1/r,a=new Mt.Quantization;if(a.componentDatatype=t,a.octEncoded=e.octEncoded,a.octEncodedZXY=!0,a.type=n,a.octEncoded)a.type=nn.VEC2,a.normalizationRange=r;else{let t=nn.getMathType(n);if(t===Number){let t=e.range;a.quantizedVolumeOffset=e.minValues[0],a.quantizedVolumeDimensions=t,a.normalizationRange=r,a.quantizedVolumeStepSize=t*o}else{a.quantizedVolumeOffset=t.unpack(e.minValues),a.normalizationRange=t.unpack(new Array(i).fill(r));let n=new Array(i).fill(e.range);a.quantizedVolumeDimensions=t.unpack(n);let s=n.map((function(e){return e*o}));a.quantizedVolumeStepSize=t.unpack(s)}}return a}async function Bze(e){e._state=St.LOADING;let t=e._resourceCache;try{let i=t.getDracoLoader({gltf:e._gltf,draco:e._draco,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._dracoLoader=i,await i.load(),e.isDestroyed()?void 0:(e._state=St.LOADED,e)}catch{if(e.isDestroyed())return;p9(e)}}function kze(e){e._state=St.PROCESSING;let t=e._dracoLoader.decodedData.vertexAttributes[e._attributeSemantic],i=e._accessorId,n=e._gltf.accessors[i].type,r=t.array,o=t.data.quantization;u(o)&&(e._quantization=Fze(o,t.data.componentDatatype,t.data.componentsPerAttribute,n)),e._typedArray=new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}async function Vze(e){e._state=St.LOADING;let t=e._resourceCache;try{let i=t.getBufferViewLoader({gltf:e._gltf,bufferViewId:e._bufferViewId,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoader=i,await i.load(),e.isDestroyed()?void 0:(e._typedArray=i.typedArray,e._state=St.PROCESSING,e)}catch(t){if(e.isDestroyed())return;p9(e,t)}}function p9(e,t){e.unload(),e._state=St.FAILED;throw e.getError("Failed to load vertex buffer",t)}function _9(){this.typedArray=void 0,this.context=void 0,this.buffer=void 0}function use(e,t){let i=ut.createVertexBuffer({typedArray:e,context:t,usage:Be.STATIC_DRAW});return i.vertexArrayDestroyable=!1,i}u(Object.create)&&(yg.prototype=Object.create(io.prototype),yg.prototype.constructor=yg),Object.defineProperties(yg.prototype,{cacheKey:{get:function(){return this._cacheKey}},buffer:{get:function(){return this._buffer}},typedArray:{get:function(){return this._typedArray}},quantization:{get:function(){return this._quantization}}}),yg.prototype.load=async function(){return u(this._promise)?this._promise:Nze(this._draco,this._attributeSemantic)?(this._promise=Bze(this),this._promise):(this._promise=Vze(this),this._promise)},_9.prototype.set=function(e,t){this.typedArray=e,this.context=t},_9.prototype.execute=function(){this.buffer=use(this.typedArray,this.context)};var Uze=new _9;yg.prototype.process=function(e){if(this._state===St.READY)return!0;if(this._state!==St.LOADED&&this._state!==St.PROCESSING)return!1;if(u(this._dracoLoader)){try{if(!this._dracoLoader.process(e))return!1}catch(e){p9(this,e)}kze(this)}let t,i=this._typedArray;if(this._loadBuffer&&this._asynchronous){let n=Uze;if(n.set(i,e.context),!e.jobScheduler.execute(n,Ha.BUFFER))return!1;t=n.buffer}else this._loadBuffer&&(t=use(i,e.context));return this.unload(),this._buffer=t,this._typedArray=this._loadTypedArray?i:void 0,this._state=St.READY,this._resourceCache.statistics.addGeometryLoader(this),!0},yg.prototype.unload=function(){u(this._buffer)&&this._buffer.destroy();let e=this._resourceCache;u(this._bufferViewLoader)&&!this._bufferViewLoader.isDestroyed()&&e.unload(this._bufferViewLoader),u(this._dracoLoader)&&e.unload(this._dracoLoader),this._bufferViewLoader=void 0,this._dracoLoader=void 0,this._typedArray=void 0,this._buffer=void 0,this._gltf=void 0};var ww=yg;function vw(e){let t=(e=y(e,y.EMPTY_OBJECT)).id,i=y(e.properties,{}),n={};for(let e in i)if(i.hasOwnProperty(e)){let t=i[e];u(t.semantic)&&(n[t.semantic]=t)}this._id=t,this._name=e.name,this._description=e.description,this._properties=i,this._propertiesBySemantic=n,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}vw.fromJson=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).id,i=e.class,n={};for(let t in i.properties)if(i.properties.hasOwnProperty(t)){let r=H0.fromJson({id:t,property:i.properties[t],enums:e.enums});n[t]=r}return new vw({id:t,name:i.name,description:i.description,properties:n,extras:i.extras,extensions:i.extensions})},Object.defineProperties(vw.prototype,{properties:{get:function(){return this._properties}},propertiesBySemantic:{get:function(){return this._propertiesBySemantic}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),vw.BATCH_TABLE_CLASS_NAME="_batchTable";var Nh=vw;function zN(e){let t=(e=y(e,y.EMPTY_OBJECT)).value,i=e.name;this._value=t,this._name=i,this._description=e.description,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}zN.fromJson=function(e){return new zN({value:e.value,name:e.name,description:e.description,extras:e.extras,extensions:e.extensions})},Object.defineProperties(zN.prototype,{value:{get:function(){return this._value}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var HN=zN;function GN(e){let t=(e=y(e,y.EMPTY_OBJECT)).id,i=e.values,n={},r={},o=i.length;for(let e=0;e<o;++e){let t=i[e];n[t.value]=t.name,r[t.name]=t.value}let a=y(e.valueType,Jt.UINT16);this._values=i,this._namesByValue=n,this._valuesByName=r,this._valueType=a,this._id=t,this._name=e.name,this._description=e.description,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}GN.fromJson=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).id,i=e.enum;return new GN({id:t,values:i.values.map((function(e){return HN.fromJson(e)})),valueType:Jt[i.valueType],name:i.name,description:i.description,extras:i.extras,extensions:i.extensions})},Object.defineProperties(GN.prototype,{values:{get:function(){return this._values}},namesByValue:{get:function(){return this._namesByValue}},valuesByName:{get:function(){return this._valuesByName}},valueType:{get:function(){return this._valueType}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var WN=GN;function jN(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.classes,{}),i=y(e.enums,{});this._classes=t,this._enums=i,this._id=e.id,this._name=e.name,this._description=e.description,this._version=e.version,this._extras=Ge(e.extras,!0),this._extensions=Ge(e.extensions,!0)}jN.fromJson=function(e){let t={};if(u(e.enums))for(let i in e.enums)e.enums.hasOwnProperty(i)&&(t[i]=WN.fromJson({id:i,enum:e.enums[i]}));let i={};if(u(e.classes))for(let n in e.classes)e.classes.hasOwnProperty(n)&&(i[n]=Nh.fromJson({id:n,class:e.classes[n],enums:t}));return new jN({id:e.id,name:e.name,description:e.description,version:e.version,classes:i,enums:t,extras:e.extras,extensions:e.extensions})},Object.defineProperties(jN.prototype,{classes:{get:function(){return this._classes}},enums:{get:function(){return this._enums}},id:{get:function(){return this._id}},name:{get:function(){return this._name}},description:{get:function(){return this._description}},version:{get:function(){return this._version}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var Fh=jN;function Y0(e){let t=(e=y(e,y.EMPTY_OBJECT)).schema,i=e.resource,n=e.cacheKey;this._schema=u(t)?Fh.fromJson(t):void 0,this._resource=i,this._cacheKey=n,this._state=St.UNLOADED,this._promise=void 0}async function zze(e){let t=e._resource;e._state=St.LOADING;try{let i=await t.fetchJson();return e.isDestroyed()?void 0:(e._schema=Fh.fromJson(i),e._state=St.READY,e)}catch(i){if(e.isDestroyed())return;e._state=St.FAILED;let n=`Failed to load schema: ${t.url}`;throw e.getError(n,i)}}u(Object.create)&&(Y0.prototype=Object.create(io.prototype),Y0.prototype.constructor=Y0),Object.defineProperties(Y0.prototype,{cacheKey:{get:function(){return this._cacheKey}},schema:{get:function(){return this._schema}}}),Y0.prototype.load=async function(){return u(this._promise)?this._promise:u(this._schema)?(this._promise=Promise.resolve(this),this._promise):(this._promise=zze(this),this._promise)},Y0.prototype.unload=function(){this._schema=void 0};var Dw=Y0,nd={};function Iw(e){return Sm(e.url)}function qN(e){let t=e.byteOffset,i=e.byteLength;if(ii(e,"EXT_meshopt_compression")){let n=e.extensions.EXT_meshopt_compression;t=y(n.byteOffset,0),i=n.byteLength}return`${t}-${t+i}`}function Hze(e,t){return`${t.byteOffset+e.byteOffset}-${e.componentType}-${e.type}-${e.count}`}function fse(e){return Iw(e)}function dse(e,t){return`${Iw(e)}-buffer-id-${t}`}function Pw(e,t,i,n){if(u(e.uri)){return fse(n.getDerivedResource({url:e.uri}))}return dse(i,t)}function g9(e,t,i,n){let r=t.bufferView,o=e.bufferViews[r],a=o.buffer;return`${Pw(e.buffers[a],a,i,n)}-range-${qN(o)}`}function hse(e,t,i,n){let r=e.images[t],o=r.bufferView,a=r.uri;if(u(a)){return Iw(n.getDerivedResource({url:a}))}let s=e.bufferViews[o],l=s.buffer;return`${Pw(e.buffers[l],l,i,n)}-range-${qN(s)}`}function Gze(e,t){let i=Gl.createSampler({gltf:e,textureInfo:t});return`${i.wrapS}-${i.wrapT}-${i.minificationFilter}-${i.magnificationFilter}`}nd.getSchemaCacheKey=function(e){let t=e.schema,i=e.resource;return u(t)?`embedded-schema:${JSON.stringify(t)}`:`external-schema:${Iw(i)}`},nd.getExternalBufferCacheKey=function(e){return`external-buffer:${fse((e=y(e,y.EMPTY_OBJECT)).resource)}`},nd.getEmbeddedBufferCacheKey=function(e){return`embedded-buffer:${dse((e=y(e,y.EMPTY_OBJECT)).parentResource,e.bufferId)}`},nd.getGltfCacheKey=function(e){return`gltf:${Iw((e=y(e,y.EMPTY_OBJECT)).gltfResource)}`},nd.getBufferViewCacheKey=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.bufferViewId,n=e.gltfResource,r=e.baseResource,o=t.bufferViews[i],a=o.buffer,s=t.buffers[a];return ii(o,"EXT_meshopt_compression")&&(a=o.extensions.EXT_meshopt_compression.buffer),`buffer-view:${Pw(s,a,n,r)}-range-${qN(o)}`},nd.getDracoCacheKey=function(e){return`draco:${g9((e=y(e,y.EMPTY_OBJECT)).gltf,e.draco,e.gltfResource,e.baseResource)}`},nd.getVertexBufferCacheKey=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.gltfResource,n=e.baseResource,r=e.frameState,o=e.bufferViewId,a=e.draco,s=e.attributeSemantic,l=y(e.dequantize,!1),c=y(e.loadBuffer,!1),h=y(e.loadTypedArray,!1),d="";if(l&&(d+="-dequantize"),c&&(d+="-buffer",d+=`-context-${r.context.id}`),h&&(d+="-typed-array"),u(a))return`vertex-buffer:${g9(t,a,i,n)}-draco-${s}${d}`;let p=t.bufferViews[o],f=p.buffer;return`vertex-buffer:${Pw(t.buffers[f],f,i,n)}-range-${qN(p)}${d}`},nd.getIndexBufferCacheKey=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.accessorId,n=e.gltfResource,r=e.baseResource,o=e.frameState,a=e.draco,s=y(e.loadBuffer,!1),l=y(e.loadTypedArray,!1),c="";if(s&&(c+="-buffer",c+=`-context-${o.context.id}`),l&&(c+="-typed-array"),u(a))return`index-buffer:${g9(t,a,n,r)}-draco${c}`;let h=t.accessors[i],d=h.bufferView,p=t.bufferViews[d],f=p.buffer;return`index-buffer:${Pw(t.buffers[f],f,n,r)}-accessor-${Hze(h,p)}${c}`},nd.getImageCacheKey=function(e){return`image:${hse((e=y(e,y.EMPTY_OBJECT)).gltf,e.imageId,e.gltfResource,e.baseResource)}`},nd.getTextureCacheKey=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.textureInfo,n=e.gltfResource,r=e.baseResource,o=e.supportedImageFormats,a=e.frameState,s=i.index;return`texture:${hse(t,Gl.getImageIdFromTexture({gltf:t,textureId:s,supportedImageFormats:o}),n,r)}-sampler-${Gze(t,i)}-context-${a.context.id}`};var Wl=nd;function Ow(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}}Ow.prototype.clear=function(){this.geometryByteLength=0,this.texturesByteLength=0,this._geometrySizes={},this._textureSizes={}},Ow.prototype.addGeometryLoader=function(e){let t=e.cacheKey;if(this._geometrySizes.hasOwnProperty(t))return;this._geometrySizes[t]=0;let i=e.buffer,n=e.typedArray,r=0;u(i)&&(r+=i.sizeInBytes),u(n)&&(r+=n.byteLength),this.geometryByteLength+=r,this._geometrySizes[t]=r},Ow.prototype.addTextureLoader=function(e){let t=e.cacheKey;if(this._textureSizes.hasOwnProperty(t))return;this._textureSizes[t]=0;let i=e.texture.sizeInBytes;this.texturesByteLength+=e.texture.sizeInBytes,this._textureSizes[t]=i},Ow.prototype.removeLoader=function(e){let t=e.cacheKey,i=this._geometrySizes[t];delete this._geometrySizes[t],u(i)&&(this.geometryByteLength-=i);let n=this._textureSizes[t];delete this._textureSizes[t],u(n)&&(this.texturesByteLength-=n)};var YN=Ow;function Ln(){}function Wze(e){this.referenceCount=1,this.resourceLoader=e,this._statisticsPromise=void 0}Ln.cacheEntries={},Ln.statistics=new YN,Ln.get=function(e){let t=Ln.cacheEntries[e];if(u(t))return++t.referenceCount,t.resourceLoader},Ln.add=function(e){let t=e.cacheKey;return Ln.cacheEntries[t]=new Wze(e),e},Ln.unload=function(e){let t=e.cacheKey,i=Ln.cacheEntries[t];--i.referenceCount,0===i.referenceCount&&(Ln.statistics.removeLoader(e),e.destroy(),delete Ln.cacheEntries[t])},Ln.getSchemaLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).schema,i=e.resource,n=Wl.getSchemaCacheKey({schema:t,resource:i}),r=Ln.get(n);return u(r)?r:(r=new Dw({schema:t,resource:i,cacheKey:n}),Ln.add(r))},Ln.getEmbeddedBufferLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).parentResource,i=e.bufferId,n=e.typedArray,r=Wl.getEmbeddedBufferCacheKey({parentResource:t,bufferId:i}),o=Ln.get(r);return u(o)?o:(o=new oA({typedArray:n,cacheKey:r}),Ln.add(o))},Ln.getExternalBufferLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).resource,i=Wl.getExternalBufferCacheKey({resource:t}),n=Ln.get(i);return u(n)?n:(n=new oA({resource:t,cacheKey:i}),Ln.add(n))},Ln.getGltfJsonLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltfResource,i=e.baseResource,n=e.typedArray,r=e.gltfJson,o=Wl.getGltfCacheKey({gltfResource:t}),a=Ln.get(o);return u(a)?a:(a=new Ew({resourceCache:Ln,gltfResource:t,baseResource:i,typedArray:n,gltfJson:r,cacheKey:o}),Ln.add(a))},Ln.getBufferViewLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.bufferViewId,n=e.gltfResource,r=e.baseResource,o=Wl.getBufferViewCacheKey({gltf:t,bufferViewId:i,gltfResource:n,baseResource:r}),a=Ln.get(o);return u(a)?a:(a=new xw({resourceCache:Ln,gltf:t,bufferViewId:i,gltfResource:n,baseResource:r,cacheKey:o}),Ln.add(a))},Ln.getDracoLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.draco,n=e.gltfResource,r=e.baseResource,o=Wl.getDracoCacheKey({gltf:t,draco:i,gltfResource:n,baseResource:r}),a=Ln.get(o);return u(a)?a:(a=new bw({resourceCache:Ln,gltf:t,draco:i,gltfResource:n,baseResource:r,cacheKey:o}),Ln.add(a))},Ln.getVertexBufferLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.gltfResource,n=e.baseResource,r=e.frameState,o=e.bufferViewId,a=e.draco,s=e.attributeSemantic,l=e.accessorId,c=y(e.asynchronous,!0),h=y(e.dequantize,!1),d=y(e.loadBuffer,!1),p=y(e.loadTypedArray,!1),f=Wl.getVertexBufferCacheKey({gltf:t,gltfResource:i,baseResource:n,frameState:r,bufferViewId:o,draco:a,attributeSemantic:s,dequantize:h,loadBuffer:d,loadTypedArray:p}),m=Ln.get(f);return u(m)?m:(m=new ww({resourceCache:Ln,gltf:t,gltfResource:i,baseResource:n,bufferViewId:o,draco:a,attributeSemantic:s,accessorId:l,cacheKey:f,asynchronous:c,dequantize:h,loadBuffer:d,loadTypedArray:p}),Ln.add(m))},Ln.getIndexBufferLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.accessorId,n=e.gltfResource,r=e.baseResource,o=e.frameState,a=e.draco,s=y(e.asynchronous,!0),l=y(e.loadBuffer,!1),c=y(e.loadTypedArray,!1),h=Wl.getIndexBufferCacheKey({gltf:t,accessorId:i,gltfResource:n,baseResource:r,frameState:o,draco:a,loadBuffer:l,loadTypedArray:c}),d=Ln.get(h);return u(d)?d:(d=new Aw({resourceCache:Ln,gltf:t,accessorId:i,gltfResource:n,baseResource:r,draco:a,cacheKey:h,asynchronous:s,loadBuffer:l,loadTypedArray:c}),Ln.add(d))},Ln.getImageLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.imageId,n=e.gltfResource,r=e.baseResource,o=Wl.getImageCacheKey({gltf:t,imageId:i,gltfResource:n,baseResource:r}),a=Ln.get(o);return u(a)?a:(a=new Tw({resourceCache:Ln,gltf:t,imageId:i,gltfResource:n,baseResource:r,cacheKey:o}),Ln.add(a))},Ln.getTextureLoader=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.textureInfo,n=e.gltfResource,r=e.baseResource,o=e.supportedImageFormats,a=e.frameState,s=y(e.asynchronous,!0),l=Wl.getTextureCacheKey({gltf:t,textureInfo:i,gltfResource:n,baseResource:r,supportedImageFormats:o,frameState:a}),c=Ln.get(l);return u(c)?c:(c=new Sw({resourceCache:Ln,gltf:t,textureInfo:i,gltfResource:n,baseResource:r,supportedImageFormats:o,cacheKey:l,asynchronous:s}),Ln.add(c))},Ln.clearForSpecs=function(){let e,t=[ww,Aw,bw,Sw,Tw,xw,oA,Dw,Ew],i=Ln.cacheEntries,n=[];for(e in i)i.hasOwnProperty(e)&&n.push(i[e]);n.sort((function(e,i){return t.indexOf(e.resourceLoader.constructor)-t.indexOf(i.resourceLoader.constructor)}));let r=n.length;for(let t=0;t<r;++t){let r=n[t];e=r.resourceLoader.cacheKey,u(i[e])&&(r.resourceLoader.destroy(),delete i[e])}Ln.statistics.clear()};var Gi=Ln;function ks(e,t,i){this._resource=e,this._subtreeJson=void 0,this._bufferLoader=void 0,this._tileAvailability=void 0,this._contentAvailabilityBitstreams=[],this._childSubtreeAvailability=void 0,this._implicitCoordinates=i,this._subtreeLevels=t.subtreeLevels,this._subdivisionScheme=t.subdivisionScheme,this._branchingFactor=t.branchingFactor,this._metadata=void 0,this._tileMetadataTable=void 0,this._tilePropertyTableJson=void 0,this._contentMetadataTables=[],this._contentPropertyTableJsons=[],this._tileJumpBuffer=void 0,this._contentJumpBuffers=[],this._ready=!1}function jze(e){let t=new DataView(e.buffer,e.byteOffset),i=8,n=t.getUint32(i,!0);i+=8;let r=t.getUint32(i,!0);i+=8;let o=So(e,i,n);return i+=n,{json:o,binary:e.subarray(i,i+r)}}function qze(e){e=u(e)?e:[];for(let t=0;t<e.length;t++){let i=e[t];i.isExternal=u(i.uri),i.isActive=!1}return e}function Yze(e,t){e=u(e)?e:[];for(let i=0;i<e.length;i++){let n=e[i],r=t[n.buffer];n.bufferHeader=r,n.isActive=!1}return e}function Xze(e,t){let i,n=e.tileAvailability;u(n.bitstream)?i=t[n.bitstream]:u(n.bufferView)&&(i=t[n.bufferView]),u(i)&&(i.isActive=!0,i.bufferHeader.isActive=!0);let r=e.contentAvailabilityHeaders;for(let e=0;e<r.length;e++)i=void 0,u(r[e].bitstream)?i=t[r[e].bitstream]:u(r[e].bufferView)&&(i=t[r[e].bufferView]),u(i)&&(i.isActive=!0,i.bufferHeader.isActive=!0);i=void 0;let o=e.childSubtreeAvailability;u(o.bitstream)?i=t[o.bitstream]:u(o.bufferView)&&(i=t[o.bufferView]),u(i)&&(i.isActive=!0,i.bufferHeader.isActive=!0)}function mse(e,t){let i,n=e.properties;for(let e in n)if(n.hasOwnProperty(e)){let r=n[e];i=t[y(r.values,r.bufferView)],i.isActive=!0,i.bufferHeader.isActive=!0;let o=y(r.stringOffsets,r.stringOffsetBufferView);u(o)&&(i=t[o],i.isActive=!0,i.bufferHeader.isActive=!0);let a=y(r.arrayOffsets,r.arrayOffsetBufferView);u(a)&&(i=t[a],i.isActive=!0,i.bufferHeader.isActive=!0)}}function Kze(e,t,i){let n=[];for(let r=0;r<t.length;r++){let o=t[r];if(o.isActive)if(o.isExternal){let t=Zze(e,o);n.push(t)}else n.push(Promise.resolve(i));else n.push(Promise.resolve(void 0))}return Promise.all(n).then((function(e){let t={};for(let i=0;i<e.length;i++){let n=e[i];u(n)&&(t[i]=n)}return t}))}async function Zze(e,t){let i=e._resource.getDerivedResource({url:t.uri}),n=Gi.getExternalBufferLoader({resource:i});e._bufferLoader=n;try{await n.load()}catch(e){if(n.isDestroyed())return;throw e}return n.typedArray}function $ze(e,t){let i={};for(let n=0;n<e.length;n++){let r=e[n];if(!r.isActive)continue;let o=r.byteOffset,a=o+r.byteLength,s=t[r.buffer].subarray(o,a);i[n]=s}return i}function Qze(e,t,i,n){let r=i.branchingFactor,o=i.subtreeLevels,a=(Math.pow(r,o)-1)/(r-1),s=Math.pow(r,o),l=ii(t,"3DTILES_metadata"),c=u(e._tilePropertyTableJson),h=l||c;e._tileAvailability=y9(t.tileAvailability,n,a,h);let d=e._contentPropertyTableJsons.length>0;h=h||d;for(let i=0;i<t.contentAvailabilityHeaders.length;i++){let r=y9(t.contentAvailabilityHeaders[i],n,a,h);e._contentAvailabilityBitstreams.push(r)}e._childSubtreeAvailability=y9(t.childSubtreeAvailability,n,s)}function y9(e,t,i,n){if(u(e.constant))return new _w({constant:!!e.constant,lengthBits:i,availableCount:e.availableCount});let r;return u(e.bitstream)?r=t[e.bitstream]:u(e.bufferView)&&(r=t[e.bufferView]),new _w({bitstream:r,lengthBits:i,availableCount:e.availableCount,computeAvailableCountEnabled:n})}function Jze(e,t,i){let n=e._tilePropertyTableJson,r=e._tileAvailability.availableCount,o=t.metadataSchema,a=n.class,s=o.classes[a];e._tileMetadataTable=new zl({class:s,count:r,properties:n.properties,bufferViews:i})}function e4e(e,t,i){let n=e._contentPropertyTableJsons,r=e._contentAvailabilityBitstreams,o=t.metadataSchema,a=e._contentMetadataTables;for(let e=0;e<n.length;e++){let t=n[e],s=r[e].availableCount,l=t.class,u=o.classes[l],c=new zl({class:u,count:s,properties:t.properties,bufferViews:i});a.push(c)}}function pse(e){let t,i=0,n=e.lengthBits,r=e.availableCount;t=r<256?new Uint8Array(n):r<65536?new Uint16Array(n):new Uint32Array(n);for(let n=0;n<e.lengthBits;n++)e.getBit(n)&&(t[n]=i,i++);return t}function t4e(e){let t=pse(e._tileAvailability);e._tileJumpBuffer=t}function n4e(e){let t=e._contentJumpBuffers,i=e._contentAvailabilityBitstreams;for(let e=0;e<i.length;e++){let n=pse(i[e]);t.push(n)}}function i4e(e,t){if(!u(e._tileMetadataTable))return;let i=e.getTileIndex(t);return e._tileAvailability.getBit(i)?e._tileJumpBuffer[i]:void 0}function o4e(e,t,i){let n=e._contentMetadataTables;if(!u(n))return;let r=n[i];if(!u(r))return;let o=e._contentAvailabilityBitstreams[i],a=e.getTileIndex(t);return o.getBit(a)?e._contentJumpBuffers[i][a]:void 0}Object.defineProperties(ks.prototype,{ready:{get:function(){return this._ready}},metadata:{get:function(){return this._metadata}},tileMetadataTable:{get:function(){return this._tileMetadataTable}},tilePropertyTableJson:{get:function(){return this._tilePropertyTableJson}},contentMetadataTables:{get:function(){return this._contentMetadataTables}},contentPropertyTableJsons:{get:function(){return this._contentPropertyTableJsons}},implicitCoordinates:{get:function(){return this._implicitCoordinates}}}),ks.prototype.tileIsAvailableAtIndex=function(e){return this._tileAvailability.getBit(e)},ks.prototype.tileIsAvailableAtCoordinates=function(e){let t=this.getTileIndex(e);return this.tileIsAvailableAtIndex(t)},ks.prototype.contentIsAvailableAtIndex=function(e,t){return t=y(t,0),this._contentAvailabilityBitstreams[t].getBit(e)},ks.prototype.contentIsAvailableAtCoordinates=function(e,t){let i=this.getTileIndex(e);return this.contentIsAvailableAtIndex(i,t)},ks.prototype.childSubtreeIsAvailableAtIndex=function(e){return this._childSubtreeAvailability.getBit(e)},ks.prototype.childSubtreeIsAvailableAtCoordinates=function(e){let t=this.getChildSubtreeIndex(e);return this.childSubtreeIsAvailableAtIndex(t)},ks.prototype.getLevelOffset=function(e){let t=this._branchingFactor;return(Math.pow(t,e)-1)/(t-1)},ks.prototype.getParentMortonIndex=function(e){let t=2;return this._subdivisionScheme===Gr.OCTREE&&(t=3),e>>t},ks.fromSubtreeJson=async function(e,t,i,n,r){let o,a=new ks(e,n,r);o=u(t)?{json:t,binary:void 0}:jze(i);let s,l=o.json;if(a._subtreeJson=l,ii(l,"3DTILES_metadata"))s=l.extensions["3DTILES_metadata"];else if(u(l.tileMetadata)){let e=l.tileMetadata;s=l.propertyTables[e]}let c=[];if(u(l.contentMetadata)){let e=l.contentMetadata.length;for(let t=0;t<e;t++){let e=l.contentMetadata[t];c.push(l.propertyTables[e])}}let h,d=n.metadataSchema,p=l.subtreeMetadata;if(u(p)){let e=p.class,t=d.classes[e];h=new xN({subtreeMetadata:p,class:t})}a._metadata=h,a._tilePropertyTableJson=s,a._contentPropertyTableJsons=c;l.contentAvailabilityHeaders=[],ii(l,"3DTILES_multiple_contents")?l.contentAvailabilityHeaders=l.extensions["3DTILES_multiple_contents"].contentAvailability:Array.isArray(l.contentAvailability)?l.contentAvailabilityHeaders=l.contentAvailability:l.contentAvailabilityHeaders.push(y(l.contentAvailability,{constant:0}));let f=qze(l.buffers),m=Yze(l.bufferViews,f);Xze(l,m),u(s)&&mse(s,m);for(let e=0;e<c.length;e++){mse(c[e],m)}let _=$ze(m,await Kze(a,f,o.binary));return Qze(a,l,n,_),u(s)&&(Jze(a,n,_),t4e(a)),e4e(a,n,_),n4e(a),a._ready=!0,a},ks.prototype.getTileIndex=function(e){let t=e.level-this._implicitCoordinates.level;if(t<0||this._subtreeLevels<=t)throw new ue("level is out of bounds for this subtree");return e.getSubtreeCoordinates().getOffsetCoordinates(e).tileIndex},ks.prototype.getChildSubtreeIndex=function(e){if(e.level-this._implicitCoordinates.level!==this._implicitCoordinates.subtreeLevels)throw new ue("level is out of bounds for this subtree");return e.getParentSubtreeCoordinates().getOffsetCoordinates(e).mortonIndex},ks.prototype.getTileMetadataView=function(e){let t=i4e(this,e);if(!u(t))return;let i=this._tileMetadataTable;return new gw({class:i.class,metadataTable:i,entityId:t,propertyTableJson:this._tilePropertyTableJson})},ks.prototype.getContentMetadataView=function(e,t){let i=o4e(this,e,t);if(!u(i))return;let n=this._contentMetadataTables[t],r=this._contentPropertyTableJsons[t];return new gw({class:n.class,metadataTable:n,entityId:i,contentIndex:t,propertyTableJson:r})},ks.prototype.isDestroyed=function(){return!1},ks.prototype.destroy=function(){return u(this._bufferLoader)&&Gi.unload(this._bufferLoader),le(this)};var _A=ks,r4e={ID:"ID",NAME:"NAME",DESCRIPTION:"DESCRIPTION",TILESET_TILE_COUNT:"TILESET_TILE_COUNT",TILE_BOUNDING_BOX:"TILE_BOUNDING_BOX",TILE_BOUNDING_REGION:"TILE_BOUNDING_REGION",TILE_BOUNDING_SPHERE:"TILE_BOUNDING_SPHERE",TILE_MINIMUM_HEIGHT:"TILE_MINIMUM_HEIGHT",TILE_MAXIMUM_HEIGHT:"TILE_MAXIMUM_HEIGHT",TILE_HORIZON_OCCLUSION_POINT:"TILE_HORIZON_OCCLUSION_POINT",TILE_GEOMETRIC_ERROR:"TILE_GEOMETRIC_ERROR",CONTENT_BOUNDING_BOX:"CONTENT_BOUNDING_BOX",CONTENT_BOUNDING_REGION:"CONTENT_BOUNDING_REGION",CONTENT_BOUNDING_SPHERE:"CONTENT_BOUNDING_SPHERE",CONTENT_MINIMUM_HEIGHT:"CONTENT_MINIMUM_HEIGHT",CONTENT_MAXIMUM_HEIGHT:"CONTENT_MAXIMUM_HEIGHT",CONTENT_HORIZON_OCCLUSION_POINT:"CONTENT_HORIZON_OCCLUSION_POINT"},gA=Object.freeze(r4e);function rl(e,t,i){let n=t.implicitTileset,r=t.implicitCoordinates;this._implicitTileset=n,this._implicitCoordinates=r,this._implicitSubtree=void 0,this._tileset=e,this._tile=t,this._resource=i,this._metadata=void 0,this.featurePropertiesDirty=!1,this._group=void 0;let o=r.getTemplateValues(),a=n.subtreeUriTemplate.getDerivedResource({templateValues:o});this._url=a.getUrlComponent(!0),this._ready=!1}function s4e(e,t){let i=e._tile,n=c4e(e,t,i,e._implicitCoordinates.childIndex),r=e._tileset.statistics;i.children.push(n.rootTile),r.numberOfTilesTotal++;let o=a4e(e,t,n.bottomRow);for(let t=0;t<o.length;t++){let i=o[t],n=i.tile,a=g4e(e,n,i.childIndex);n.children.push(a),r.numberOfTilesTotal++}}function a4e(e,t,i){let n=[],r=e._implicitTileset.branchingFactor;for(let e=0;e<i.length;e++){let o=i[e];if(u(o))for(let i=0;i<r;i++){let a=e*r+i;t.childSubtreeIsAvailableAtIndex(a)&&n.push({tile:o,childIndex:i})}}return n}function c4e(e,t,i,n){let r=_se(e,t,i,n,0,!0),o=e._tileset.statistics,a=[r],s=[],l=e._implicitTileset;for(let i=1;i<l.subtreeLevels;i++){let n=t.getLevelOffset(i),r=l.branchingFactor*a.length;for(let i=0;i<r;i++){let r=n+i;if(!t.tileIsAvailableAtIndex(r)){s.push(void 0);continue}let u=a[t.getParentMortonIndex(i)],c=_se(e,t,u,i%l.branchingFactor,r);u.children.push(c),o.numberOfTilesTotal++,s.push(c)}a=s,s=[]}return{rootTile:r,bottomRow:a}}function gse(e,t,i){let n=gA.TILE_GEOMETRIC_ERROR;return u(e)&&e.hasPropertyBySemantic(n)?e.getPropertyBySemantic(n):t.geometricError/Math.pow(2,i.level)}function _se(e,t,i,n,r,o){let a,s,l,c,h=e._implicitTileset;if(a=y(o,!1)?i.implicitCoordinates:i.implicitCoordinates.getChildCoordinates(n),u(t.tilePropertyTableJson)){s=t.getTileMetadataView(a);let e=iA.parseAllBoundingVolumeSemantics(s);l=e.tile,c=e.content}let d=t.contentPropertyTableJsons.length,p=!1;for(let e=0;e<d;e++)if(t.contentIsAvailableAtCoordinates(a,e)){p=!0;break}let f=f4e(h,a,n,o,i,l),m=[];for(let e=0;e<h.contentCount;e++){if(!t.contentIsAvailableAtIndex(r,e))continue;let i={uri:h.contentUriTemplates[e].getDerivedResource({templateValues:a.getTemplateValues()}).url},n=d4e(f,c);u(n)&&(i.boundingVolume=n),m.push(gt(i,h.contentHeaders[e]))}let _={boundingVolume:f,geometricError:gse(s,h,a),refine:h.refine,contents:m},g=Ge(h.tileHeader,true);delete g.boundingVolume,delete g.transform,delete g.metadata;let v=gt(_,g,true),b=Ase(e,h.baseResource,v,i);return b.implicitCoordinates=a,b.implicitSubtree=t,b.metadata=s,b.hasImplicitContentMetadata=p,b}function XN(e,t){return u(e)&&u(t)&&(u(t.minimumHeight)||u(t.maximumHeight))&&(ii(e,"3DTILES_bounding_volume_S2")||u(e.region))}function b9(e,t){u(t)&&(ii(e,"3DTILES_bounding_volume_S2")?u4e(e.extensions["3DTILES_bounding_volume_S2"],t.minimumHeight,t.maximumHeight):u(e.region)&&l4e(e.region,t.minimumHeight,t.maximumHeight))}function l4e(e,t,i){u(t)&&(e[4]=t),u(i)&&(e[5]=i)}function u4e(e,t,i){u(t)&&(e.minimumHeight=t),u(i)&&(e.maximumHeight=i)}function f4e(e,t,i,n,r,o){let a;return a=!u(o)||!u(o.boundingVolume)||!XN(o.boundingVolume,o)&&XN(e.boundingVolume,o)?yse(e,t,i,y(n,!1),r):o.boundingVolume,b9(a,o),a}function d4e(e,t){let i;return u(t)&&(i=t.boundingVolume),XN(i,t)?b9(i,t):XN(e,t)&&(i=Ge(e,!0),b9(i,t)),i}function yse(e,t,i,n,r){let o=e.boundingVolume;return ii(o,"3DTILES_bounding_volume_S2")?xse(n,r,i,t.level,t.x,t.y,t.z):u(o.region)?{region:Tse(o.region,t.level,t.x,t.y,t.z)}:{box:bse(o.box,t.level,t.x,t.y,t.z)}}function xse(e,t,i,n,r,o,a){let s=t._boundingVolume;if(e)return{extensions:{"3DTILES_bounding_volume_S2":{token:W_.getTokenFromId(s.s2Cell._cellId),minimumHeight:s.minimumHeight,maximumHeight:s.maximumHeight}}};let l,c,h=Number(t._boundingVolume.s2Cell._cellId>>BigInt(61)),d=h%2==0?MS.encode2D(n,r,o):MS.encode2D(n,o,r),p=W_.fromFacePositionLevel(h,BigInt(d),n);if(u(a)){let e=(s.maximumHeight+s.minimumHeight)/2;l=i<4?s.minimumHeight:e,c=i<4?e:s.maximumHeight}else l=s.minimumHeight,c=s.maximumHeight;return{extensions:{"3DTILES_bounding_volume_S2":{token:W_.getTokenFromId(p._cellId),minimumHeight:l,maximumHeight:c}}}}Object.defineProperties(rl.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._url}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),rl.fromSubtreeJson=async function(e,t,i,n,r,o){let a;o=y(o,0),u(r)&&(a=new Uint8Array(r,o));let s=t.implicitTileset,l=t.implicitCoordinates,c=await _A.fromSubtreeJson(i,n,a,s,l),h=new rl(e,t,i);return h._implicitSubtree=c,s4e(h,c),h._ready=!0,h};var h4e=new h,m4e=new h,x9=new h,p4e=new $;function bse(e,t,i,n,r){if(0===t)return e;let o=h.unpack(e,0,m4e),a=$.unpack(e,3,p4e),s=Math.pow(2,-t),l=(2*i+1)*s-1,c=(2*n+1)*s-1,d=0,p=h.fromElements(s,s,1,h4e);u(r)&&(d=(2*r+1)*s-1,p.z=s);let f=h.fromElements(l,c,d,x9);f=$.multiplyByVector(a,f,x9),f=h.add(f,o,x9);let m=$.clone(a);m=$.multiplyByScale(m,p,m);let _=new Array(12);return h.pack(f,_),$.pack(m,_,3),_}var _4e=new ce;function Tse(e,t,i,n,r){if(0===t)return e.slice();let o=ce.unpack(e,0,_4e),a=e[4],s=e[5],l=Math.pow(2,-t),c=l*o.width,h=P.negativePiToPi(o.west+i*c),d=P.negativePiToPi(h+c),p=l*o.height,f=P.negativePiToPi(o.south+n*p),m=P.negativePiToPi(f+p),_=a,g=s;if(u(r)){let e=l*(s-a);_+=r*e,g=_+e}return[h,f,d,m,_,g]}function g4e(e,t,i){let n=e._implicitTileset,r=t.implicitCoordinates.getChildCoordinates(i),o=yse(n,r,i,!1,t),a=gse(void 0,n,r),s=n.subtreeUriTemplate.getDerivedResource({templateValues:r.getTemplateValues()}).url,l={boundingVolume:o,geometricError:a,refine:n.refine,contents:[{uri:s}]},u=Ase(e,n.baseResource,l,t);return u.implicitTileset=n,u.implicitCoordinates=r,u}function Ase(e,t,i,n){return new(0,e._tile.constructor)(e._tileset,t,i,n)}rl.prototype.hasProperty=function(e,t){return!1},rl.prototype.getFeature=function(e){},rl.prototype.applyDebugSettings=function(e,t){},rl.prototype.applyStyle=function(e){},rl.prototype.update=function(e,t){},rl.prototype.isDestroyed=function(){return!1},rl.prototype.destroy=function(){return this._implicitSubtree=this._implicitSubtree&&this._implicitSubtree.destroy(),le(this)},rl._deriveBoundingBox=bse,rl._deriveBoundingRegion=Tse,rl._deriveBoundingVolumeS2=xse;var Rw=rl,y4e={NONE:0,REPEAT:1,MIRRORED_REPEAT:2},jl=Object.freeze(y4e),Mw={HIGHLIGHT:0,REPLACE:1,MIX:2,getColorBlend:function(e,t){return e===Mw.HIGHLIGHT?0:e===Mw.REPLACE?1:e===Mw.MIX?P.clamp(t,P.EPSILON4,1):void 0}},xc=Object.freeze(Mw),Cse={};function Lw(e){this._count=e.count,this._properties=Ge(e.properties,!0)}Lw.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,Cse)},Lw.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,Cse,e)},Lw.prototype.getProperty=function(e,t){let i=this._properties[t];if(u(i))return Ge(i[e],!0)},Lw.prototype.setProperty=function(e,t,i){let n=this._properties[t];u(n)||(n=new Array(this._count),this._properties[t]=n),n[e]=Ge(i,!0)};var xg=Lw;function Wa(e){e=y(e,y.EMPTY_OBJECT),this._name=e.name,this._id=e.id,this._count=e.count,this._extras=e.extras,this._extensions=e.extensions,this._metadataTable=e.metadataTable,this._jsonMetadataTable=e.jsonMetadataTable,this._batchTableHierarchy=e.batchTableHierarchy}Object.defineProperties(Wa.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},count:{get:function(){return this._count}},class:{get:function(){if(u(this._metadataTable))return this._metadataTable.class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},byteLength:{get:function(){let e=0;return u(this._metadataTable)&&(e+=this._metadataTable.byteLength),u(this._batchTableHierarchy)&&(e+=this._batchTableHierarchy.byteLength),e}}}),Wa.prototype.hasProperty=function(e,t){return!!(u(this._metadataTable)&&this._metadataTable.hasProperty(t)||u(this._batchTableHierarchy)&&this._batchTableHierarchy.hasProperty(e,t)||u(this._jsonMetadataTable)&&this._jsonMetadataTable.hasProperty(t))},Wa.prototype.hasPropertyBySemantic=function(e,t){return!!u(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(t)},Wa.prototype.propertyExists=function(e){return!!(u(this._metadataTable)&&this._metadataTable.hasProperty(e)||u(this._batchTableHierarchy)&&this._batchTableHierarchy.propertyExists(e)||u(this._jsonMetadataTable)&&this._jsonMetadataTable.hasProperty(e))},Wa.prototype.propertyExistsBySemantic=function(e){return!!u(this._metadataTable)&&this._metadataTable.hasPropertyBySemantic(e)};var T9=[];Wa.prototype.getPropertyIds=function(e,t){return(t=u(t)?t:[]).length=0,u(this._metadataTable)&&t.push.apply(t,this._metadataTable.getPropertyIds(T9)),u(this._batchTableHierarchy)&&t.push.apply(t,this._batchTableHierarchy.getPropertyIds(e,T9)),u(this._jsonMetadataTable)&&t.push.apply(t,this._jsonMetadataTable.getPropertyIds(T9)),t},Wa.prototype.getProperty=function(e,t){let i;if(u(this._metadataTable)&&(i=this._metadataTable.getProperty(e,t),u(i))||u(this._batchTableHierarchy)&&(i=this._batchTableHierarchy.getProperty(e,t),u(i))||u(this._jsonMetadataTable)&&(i=this._jsonMetadataTable.getProperty(e,t),u(i)))return i},Wa.prototype.setProperty=function(e,t,i){u(this._metadataTable)&&this._metadataTable.setProperty(e,t,i)||u(this._batchTableHierarchy)&&this._batchTableHierarchy.setProperty(e,t,i)||(u(this._jsonMetadataTable)||(this._jsonMetadataTable=new xg({count:this._count,properties:{}})),this._jsonMetadataTable.setProperty(e,t,i))},Wa.prototype.getPropertyBySemantic=function(e,t){if(u(this._metadataTable))return this._metadataTable.getPropertyBySemantic(e,t)},Wa.prototype.setPropertyBySemantic=function(e,t,i){return!!u(this._metadataTable)&&this._metadataTable.setPropertyBySemantic(e,t,i)},Wa.prototype.getPropertyTypedArray=function(e){if(u(this._metadataTable))return this._metadataTable.getPropertyTypedArray(e)},Wa.prototype.getPropertyTypedArrayBySemantic=function(e){if(u(this._metadataTable))return this._metadataTable.getPropertyTypedArrayBySemantic(e)},Wa.prototype.isClass=function(e,t){let i=this._batchTableHierarchy;return!!u(i)&&i.isClass(e,t)},Wa.prototype.isExactClass=function(e,t){return this.getExactClassName(e)===t},Wa.prototype.getExactClassName=function(e){let t=this._batchTableHierarchy;if(u(t))return t.getClassName(e)};var sl=Wa;function Nw(e){let t=(e=y(e,y.EMPTY_OBJECT)).property,i=e.classProperty,n=e.textures,r=u(t.channels)?t.channels:[0],o=t,a=Gl.createModelTextureReader({textureInfo:o,channels:T4e(r),texture:n[o.index]});this._min=t.min,this._max=t.max;let s=t.offset,l=t.scale,c=i.hasValueTransform||u(s)||u(l);s=y(s,i.offset),l=y(l,i.scale),s=i.unpackVectorAndMatrixTypes(s),l=i.unpackVectorAndMatrixTypes(l),this._offset=s,this._scale=l,this._hasValueTransform=c,this._textureReader=a,this._classProperty=i,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(Nw.prototype,{textureReader:{get:function(){return this._textureReader}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),Nw.prototype.isGpuCompatible=function(){let e=this._classProperty,t=e.type,i=e.componentType;return e.isArray?!e.isVariableLengthArray&&e.arrayLength<=4&&t===Gt.SCALAR&&i===Jt.UINT8:!(!Gt.isVectorType(t)&&t!==Gt.SCALAR)&&i===Jt.UINT8};var x4e=[void 0,"float","vec2","vec3","vec4"],b4e=[void 0,"int","ivec2","ivec3","ivec4"];function T4e(e){return e.map((function(e){return"rgba".charAt(e)})).join("")}Nw.prototype.getGlslType=function(){let e=this._classProperty,t=Gt.getComponentCount(e.type);return e.isArray&&(t=e.arrayLength),e.normalized?x4e[t]:b4e[t]},Nw.prototype.unpackInShader=function(e){return this._classProperty.normalized?e:`${this.getGlslType()}(255.0 * ${e})`};var KN=Nw;function A9(e){let t=(e=y(e,y.EMPTY_OBJECT)).propertyTexture,i=e.class,n=e.textures,r=t.extensions,o=t.extras,a={};if(u(t.properties))for(let e in t.properties)t.properties.hasOwnProperty(e)&&(a[e]=new KN({property:t.properties[e],classProperty:i.properties[e],textures:n}));this._name=e.name,this._id=e.id,this._class=i,this._properties=a,this._extras=o,this._extensions=r}Object.defineProperties(A9.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),A9.prototype.getProperty=function(e){return this._properties[e]};var yA=A9;function Ese(e){let t=(e=y(e,y.EMPTY_OBJECT)).property,i=e.classProperty;this._attribute=t.attribute,this._classProperty=i,this._min=t.min,this._max=t.max;let n=t.offset,r=t.scale,o=i.hasValueTransform||u(n)||u(r);n=y(n,i.offset),r=y(r,i.scale),n=i.unpackVectorAndMatrixTypes(n),r=i.unpackVectorAndMatrixTypes(r),this._offset=n,this._scale=r,this._hasValueTransform=o,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(Ese.prototype,{attribute:{get:function(){return this._attribute}},hasValueTransform:{get:function(){return this._hasValueTransform}},offset:{get:function(){return this._offset}},scale:{get:function(){return this._scale}},classProperty:{get:function(){return this._classProperty}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var ZN=Ese;function C9(e){let t=(e=y(e,y.EMPTY_OBJECT)).propertyAttribute,i=e.class,n={};if(u(t.properties))for(let e in t.properties)t.properties.hasOwnProperty(e)&&(n[e]=new ZN({property:t.properties[e],classProperty:i.properties[e]}));this._name=e.name,this._id=e.id,this._class=i,this._properties=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(C9.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},class:{get:function(){return this._class}},properties:{get:function(){return this._properties}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),C9.prototype.getProperty=function(e){return this._properties[e]};var xA=C9;function Fw(e){e=y(e,y.EMPTY_OBJECT),this._schema=e.schema;let t=e.propertyTables;this._propertyTableCount=u(t)?t.length:0,this._propertyTables=t,this._propertyTextures=e.propertyTextures,this._propertyAttributes=e.propertyAttributes,this._statistics=e.statistics,this._extras=e.extras,this._extensions=e.extensions}Object.defineProperties(Fw.prototype,{schema:{get:function(){return this._schema}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}},propertyTableCount:{get:function(){return this._propertyTableCount}},propertyTables:{get:function(){return this._propertyTables}},propertyTextures:{get:function(){return this._propertyTextures}},propertyAttributes:{get:function(){return this._propertyAttributes}},propertyTablesByteLength:{get:function(){if(!u(this._propertyTables))return 0;let e=0,t=this._propertyTables.length;for(let i=0;i<t;i++)e+=this._propertyTables[i].byteLength;return e}}}),Fw.prototype.getPropertyTable=function(e){return this._propertyTables[e]},Fw.prototype.getPropertyTexture=function(e){return this._propertyTextures[e]},Fw.prototype.getPropertyAttribute=function(e){return this._propertyAttributes[e]};var ja=Fw;function A4e(e){let t=(e=y(e,y.EMPTY_OBJECT)).extension,i=e.schema,n=[];if(u(t.propertyTables))for(let r=0;r<t.propertyTables.length;r++){let o=t.propertyTables[r],a=i.classes[o.class],s=new zl({count:o.count,properties:o.properties,class:a,bufferViews:e.bufferViews});n.push(new sl({id:r,name:o.name,count:o.count,metadataTable:s,extras:o.extras,extensions:o.extensions}))}let r=[];if(u(t.propertyTextures))for(let n=0;n<t.propertyTextures.length;n++){let o=t.propertyTextures[n];r.push(new yA({id:n,name:o.name,propertyTexture:o,class:i.classes[o.class],textures:e.textures}))}let o=[];if(u(t.propertyAttributes))for(let e=0;e<t.propertyAttributes.length;e++){let n=t.propertyAttributes[e];o.push(new xA({id:e,name:n.name,class:i.classes[n.class],propertyAttribute:n}))}return new ja({schema:i,propertyTables:n,propertyTextures:r,propertyAttributes:o,statistics:t.statistics,extras:t.extras,extensions:t.extensions})}var $N=A4e;function C4e(e){let t,i,n=(e=y(e,y.EMPTY_OBJECT)).extension,r=e.schema,o=[];if(u(n.featureTables))for(i=Object.keys(n.featureTables).sort(),t=0;t<i.length;t++){let a=i[t],s=n.featureTables[a],l=r.classes[s.class],u=new zl({count:s.count,properties:s.properties,class:l,bufferViews:e.bufferViews});o.push(new sl({id:a,count:s.count,metadataTable:u,extras:s.extras,extensions:s.extensions}))}let a=[];if(u(n.featureTextures))for(i=Object.keys(n.featureTextures).sort(),t=0;t<i.length;t++){let o=i[t],s=n.featureTextures[o];a.push(new yA({id:o,propertyTexture:E4e(s),class:r.classes[s.class],textures:e.textures}))}return new ja({schema:r,propertyTables:o,propertyTextures:a,statistics:n.statistics,extras:n.extras,extensions:n.extensions})}function E4e(e){let t={class:e.class,properties:{}},i=e.properties;for(let e in i)if(i.hasOwnProperty(e)){let n=i[e],r={channels:S4e(n.channels),extras:n.extras,extensions:n.extensions};t.properties[e]=gt(n.texture,r,!0)}return t}function S4e(e){let t=e.length,i=new Array(t);for(let n=0;n<t;n++)i[n]="rgba".indexOf(e[n]);return i}var QN=C4e;function bg(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltf,i=e.extension,n=e.extensionLegacy,r=e.gltfResource,o=e.baseResource,a=e.supportedImageFormats,s=e.frameState,l=e.cacheKey,u=y(e.asynchronous,!0);this._gltfResource=r,this._baseResource=o,this._gltf=t,this._extension=i,this._extensionLegacy=n,this._supportedImageFormats=a,this._frameState=s,this._cacheKey=l,this._asynchronous=u,this._bufferViewLoaders=[],this._bufferViewIds=[],this._textureLoaders=[],this._textureIds=[],this._schemaLoader=void 0,this._structuralMetadata=void 0,this._state=St.UNLOADED,this._promise=void 0}async function w4e(e){try{let t=O4e(e),i=F4e(e),n=B4e(e);return await Promise.all([t,i,n]),e.isDestroyed()?void 0:(e._gltf=void 0,e._state=St.LOADED,e)}catch(t){if(e.isDestroyed())return;e.unload(),e._state=St.FAILED;let i="Failed to load structural metadata";throw e.getError(i,t)}}function v4e(e,t){for(let i in e)if(e.hasOwnProperty(i)){let n=e[i],r=n.values,o=n.arrayOffsets,a=n.stringOffsets;u(r)&&(t[r]=!0),u(o)&&(t[o]=!0),u(a)&&(t[a]=!0)}}function D4e(e,t){for(let i in e)if(e.hasOwnProperty(i)){let n=e[i],r=n.bufferView,o=n.arrayOffsetBufferView,a=n.stringOffsetBufferView;u(r)&&(t[r]=!0),u(o)&&(t[o]=!0),u(a)&&(t[a]=!0)}}function I4e(e){let t=e.propertyTables,i={};if(u(t))for(let e=0;e<t.length;e++){v4e(t[e].properties,i)}return i}function P4e(e){let t=e.featureTables,i={};if(u(t))for(let e in t)if(t.hasOwnProperty(e)){let n=t[e].properties;u(n)&&D4e(n,i)}return i}async function O4e(e){let t;t=u(e._extension)?I4e(e._extension):P4e(e._extensionLegacy);let i=[];for(let n in t)if(t.hasOwnProperty(n)){let t=Gi.getBufferViewLoader({gltf:e._gltf,bufferViewId:parseInt(n),gltfResource:e._gltfResource,baseResource:e._baseResource});e._bufferViewLoaders.push(t),e._bufferViewIds.push(n),i.push(t.load())}return Promise.all(i)}function R4e(e){let t={},i=e.propertyTextures;if(u(i))for(let e=0;e<i.length;e++){let n=i[e].properties;u(n)&&M4e(n,t)}return t}function M4e(e,t){for(let i in e)if(e.hasOwnProperty(i)){let n=e[i];t[n.index]=n}}function L4e(e){let t={},i=e.featureTextures;if(u(i))for(let e in i)if(i.hasOwnProperty(e)){let n=i[e].properties;u(n)&&N4e(n,t)}return t}function N4e(e,t){for(let i in e)if(e.hasOwnProperty(i)){let n=e[i].texture;t[n.index]=n}}function F4e(e){let t;t=u(e._extension)?R4e(e._extension):L4e(e._extensionLegacy);let i=e._gltf,n=e._gltfResource,r=e._baseResource,o=e._supportedImageFormats,a=e._frameState,s=e._asynchronous,l=[];for(let u in t)if(t.hasOwnProperty(u)){let c=Gi.getTextureLoader({gltf:i,textureInfo:t[u],gltfResource:n,baseResource:r,supportedImageFormats:o,frameState:a,asynchronous:s});e._textureLoaders.push(c),e._textureIds.push(u),l.push(c.load())}return Promise.all(l)}async function B4e(e){let t,i=y(e._extension,e._extensionLegacy);if(u(i.schemaUri)){let n=e._baseResource.getDerivedResource({url:i.schemaUri});t=Gi.getSchemaLoader({resource:n})}else t=Gi.getSchemaLoader({schema:i.schema});if(e._schemaLoader=t,await t.load(),!t.isDestroyed())return t.schema}function Sse(e){let t=e._bufferViewLoaders,i=t.length;for(let e=0;e<i;++e)Gi.unload(t[e]);e._bufferViewLoaders.length=0,e._bufferViewIds.length=0}function k4e(e){let t=e._textureLoaders,i=t.length;for(let e=0;e<i;++e)Gi.unload(t[e]);e._textureLoaders.length=0,e._textureIds.length=0}u(Object.create)&&(bg.prototype=Object.create(io.prototype),bg.prototype.constructor=bg),Object.defineProperties(bg.prototype,{cacheKey:{get:function(){return this._cacheKey}},structuralMetadata:{get:function(){return this._structuralMetadata}}}),bg.prototype.load=function(){return u(this._promise)||(this._state=St.LOADING,this._promise=w4e(this)),this._promise},bg.prototype.process=function(e){if(this._state===St.READY)return!0;if(this._state!==St.LOADED)return!1;let t=this._textureLoaders,i=t.length,n=!0;for(let r=0;r<i;++r){let i=t[r].process(e);n=n&&i}if(!n)return!1;let r=this._schemaLoader.schema,o={};for(let e=0;e<this._bufferViewIds.length;++e){let t=this._bufferViewIds[e],i=this._bufferViewLoaders[e];if(!i.isDestroyed()){let e=new Uint8Array(i.typedArray);o[t]=e}}let a={};for(let e=0;e<this._textureIds.length;++e){let i=this._textureIds[e],n=t[e];n.isDestroyed()||(a[i]=n.texture)}return u(this._extension)?this._structuralMetadata=$N({extension:this._extension,schema:r,bufferViews:o,textures:a}):this._structuralMetadata=QN({extension:this._extensionLegacy,schema:r,bufferViews:o,textures:a}),Sse(this),this._state=St.READY,!0},bg.prototype.unload=function(){Sse(this),k4e(this),u(this._schemaLoader)&&Gi.unload(this._schemaLoader),this._schemaLoader=void 0,this._structuralMetadata=void 0};var JN=bg,bA={TRANSLATION:"TRANSLATION",ROTATION:"ROTATION",SCALE:"SCALE",FEATURE_ID:"_FEATURE_ID",fromGltfSemantic:function(e){let t=e,i=/^(\w+)_\d+$/.exec(e);switch(null!==i&&(t=i[1]),t){case"TRANSLATION":return bA.TRANSLATION;case"ROTATION":return bA.ROTATION;case"SCALE":return bA.SCALE;case"_FEATURE_ID":return bA.FEATURE_ID}}},Wr=Object.freeze(bA),V4e=65534,U4e=255;function e2(e){let t=(e=y(e,y.EMPTY_OBJECT)).triangleIndices,i=e.outlineIndices,n=e.originalVertexCount;this._triangleIndices=t,this._originalVertexCount=n,this._edges=new Dse(i,n),this._outlineCoordinatesTypedArray=void 0,this._extraVertices=[],z4e(this)}function z4e(e){let t=e._triangleIndices,i=e._edges,n=[],r=e._extraVertices,o=e._originalVertexCount,a={};for(let e=0;e<t.length;e+=3){let s=t[e],l=t[e+1],c=t[e+2],h=!1,d=h||i.hasEdge(s,l),p=h||i.hasEdge(l,c),f=h||i.hasEdge(c,s),m=wse(n,s,l,c,d,p,f);for(;u(m);){let i=a[m];if(!u(i)){i=o+r.length;let e=m;for(;e>=o;)e=r[e-o];r.push(e),a[m]=i}i>V4e&&(t instanceof Uint16Array||t instanceof Uint8Array)?t=new Uint32Array(t):i>U4e&&t instanceof Uint8Array&&(t=new Uint16Array(t)),m===s?(s=i,t[e]=i):m===l?(l=i,t[e+1]=i):(c=i,t[e+2]=i),m=wse(n,s,l,c,d,p,f)}}e._triangleIndices=t,e._outlineCoordinatesTypedArray=new Float32Array(n)}function wse(e,t,i,n,r,o,a){let s=a?1:0,l=r?1:0,u=E9(e,t,s,l,0);if(0===u)return t;let c=r?1:0,h=o?1:0,d=E9(e,i,0,c,h);if(0===d)return i;let p=a?1:0,f=o?1:0,m=E9(e,n,p,0,f);if(0===m)return n;let _,g,y,v=u&d&m;if(1&v)_=0,g=1,y=2;else if(2&v)_=0,y=1,g=2;else if(4&v)g=0,_=1,y=2;else if(8&v)g=0,y=1,_=2;else if(16&v)y=0,_=1,g=2;else{if(!(32&v)){let e=S9(u),r=S9(d),o=S9(m);return e<r&&e<o?t:r<o?i:n}y=0,g=1,_=2}let b=3*t;e[b+_]=s,e[b+g]=l,e[b+y]=0;let A=3*i;e[A+_]=0,e[A+g]=c,e[A+y]=h;let T=3*n;e[T+_]=p,e[T+g]=0,e[T+y]=f}function E9(e,t,i,n,r){let o=3*t,a=e[o],s=e[o+1],l=e[o+2];return u(a)?(a===i&&s===n&&l===r)<<0|(a===i&&s===r&&l===n)<<1|(a===n&&s===i&&l===r)<<2|(a===n&&s===r&&l===i)<<3|(a===r&&s===i&&l===n)<<4|(a===r&&s===n&&l===i)<<5:63}function S9(e){return(1&e)+(e>>1&1)+(e>>2&1)+(e>>3&1)+(e>>4&1)+(e>>5&1)}function vse(e){let t=new Uint8Array(e);return t[e-1]=192,8===e?t[e-1]=96:4===e?t[e-1]=48:2===e?t[e-1]=24:1===e&&(t[e-1]=12),t}function Dse(e,t){this._originalVertexCount=t,this._edges=new Set;for(let t=0;t<e.length;t+=2){let i=e[t],n=e[t+1],r=Math.min(i,n),o=Math.max(i,n),a=r*this._originalVertexCount+o;this._edges.add(a)}}Object.defineProperties(e2.prototype,{updatedTriangleIndices:{get:function(){return this._triangleIndices}},outlineCoordinates:{get:function(){return this._outlineCoordinatesTypedArray}}}),e2.prototype.updateAttribute=function(e){let t=this._extraVertices,i=e.length,n=i/this._originalVertexCount,r=t.length,o=new(0,e.constructor)(e.length+r*n);o.set(e);for(let e=0;e<r;e++){let r=t[e]*n,a=i+e*n;for(let e=0;e<n;e++)o[a+e]=o[r+e]}return o},e2.createTexture=function(e){let t=e.cache.modelOutliningCache;if(u(t)||(t=e.cache.modelOutliningCache={}),u(t.outlineTexture))return t.outlineTexture;let i=Math.min(4096,zt.maximumTextureSize),n=i,r=vse(n),o=[];for(;n>1;)n>>=1,o.push(vse(n));let a=new Ot({context:e,source:{arrayBufferView:r,mipLevels:o},width:i,height:1,pixelFormat:rt.LUMINANCE,sampler:new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.LINEAR_MIPMAP_LINEAR,magnificationFilter:wi.LINEAR})});return t.outlineTexture=a,a},Dse.prototype.hasEdge=function(e,t){let i=Math.min(e,t),n=Math.max(e,t),r=i*this._originalVertexCount+n;return this._edges.has(r)};var TA=e2;function Ise(e){this.attribute=e,this.loadBuffer=!1,this.loadTypedArray=!1}function H4e(e){this.indices=e,this.loadBuffer=!1,this.loadTypedArray=!1}function t2(e){this.primitive=e,this.attributePlans=[],this.indicesPlan=void 0,this.needsOutlines=!1,this.outlineIndices=void 0}function G4e(e){let t=e.primitive,i=t.indices,n=t.attributes[0].count,r=new TA({triangleIndices:i.typedArray,outlineIndices:e.outlineIndices,originalVertexCount:n});i.typedArray=r.updatedTriangleIndices,i.indexDatatype=ke.fromTypedArray(i.typedArray);let o=new Ise(W4e(r.outlineCoordinates));o.loadBuffer=!0,o.loadTypedArray=!1,e.attributePlans.push(o),t.outlineCoordinates=o.attribute;let a=e.attributePlans,s=e.attributePlans.length;for(let e=0;e<s;e++){let t=a[e].attribute;t.typedArray=r.updateAttribute(t.typedArray)}}function W4e(e){let t=new Mt.Attribute;return t.name="_OUTLINE_COORDINATES",t.typedArray=e,t.componentDatatype=X.FLOAT,t.type=nn.VEC3,t.normalized=!1,t.count=e.length/3,t}function j4e(e,t){q4e(e.attributePlans,t),u(e.indicesPlan)&&Y4e(e.indicesPlan,t)}function q4e(e,t){let i=e.length;for(let n=0;n<i;n++){let i=e[n],r=i.attribute,o=r.typedArray;if(i.loadBuffer){let e=ut.createVertexBuffer({typedArray:o,context:t,usage:Be.STATIC_DRAW});e.vertexArrayDestroyable=!1,r.buffer=e}i.loadTypedArray||(r.typedArray=void 0)}}function Y4e(e,t){let i=e.indices;if(e.loadBuffer){let e=ut.createIndexBuffer({typedArray:i.typedArray,context:t,usage:Be.STATIC_DRAW,indexDatatype:i.indexDatatype});i.buffer=e,e.vertexArrayDestroyable=!1}e.loadTypedArray||(i.typedArray=void 0)}t2.prototype.postProcess=function(e){this.needsOutlines&&(G4e(this),j4e(this,e))},t2.AttributeLoadPlan=Ise,t2.IndicesLoadPlan=H4e;var AA=t2;function X4e(e){e=y(e,y.EMPTY_OBJECT),this.webp=y(e.webp,!1),this.basis=y(e.basis,!1)}var n2=X4e,K4e=Mt.Attribute,Z4e=Mt.Indices,Pse=Mt.FeatureIdAttribute,Ose=Mt.FeatureIdTexture,Rse=Mt.FeatureIdImplicitRange,$4e=Mt.MorphTarget,Q4e=Mt.Primitive,J4e=Mt.Instances,e8e=Mt.Skin,t8e=Mt.Node,n8e=Mt.AnimatedPropertyType,i8e=Mt.AnimationSampler,o8e=Mt.AnimationTarget,r8e=Mt.AnimationChannel,s8e=Mt.Animation,a8e=Mt.ArticulationStage,c8e=Mt.Articulation,l8e=Mt.Asset,u8e=Mt.Scene,f8e=Mt.Components,d8e=Mt.MetallicRoughness,h8e=Mt.SpecularGlossiness,m8e=Mt.Material,Co={NOT_LOADED:0,LOADING:1,LOADED:2,PROCESSING:3,POST_PROCESSING:4,PROCESSED:5,READY:6,FAILED:7,UNLOADED:8};function id(e){let t=(e=y(e,y.EMPTY_OBJECT)).gltfResource,i=e.baseResource,n=e.typedArray,r=y(e.releaseGltfJson,!1),o=y(e.asynchronous,!0),a=y(e.incrementallyLoadTextures,!0),s=y(e.upAxis,wo.Y),l=y(e.forwardAxis,wo.Z),c=y(e.loadAttributesAsTypedArray,!1),h=y(e.loadAttributesFor2D,!1),d=y(e.loadIndicesForWireframe,!1),p=y(e.loadPrimitiveOutline,!0),f=y(e.loadForClassification,!1),m=y(e.renameBatchIdSemantic,!1);i=u(i)?i:t.clone(),this._gltfJson=e.gltfJson,this._gltfResource=t,this._baseResource=i,this._typedArray=n,this._releaseGltfJson=r,this._asynchronous=o,this._incrementallyLoadTextures=a,this._upAxis=s,this._forwardAxis=l,this._loadAttributesAsTypedArray=c,this._loadAttributesFor2D=h,this._loadIndicesForWireframe=d,this._loadPrimitiveOutline=p,this._loadForClassification=f,this._renameBatchIdSemantic=m,this._sortedPropertyTableIds=void 0,this._sortedFeatureTextureIds=void 0,this._gltfJsonLoader=void 0,this._state=Co.NOT_LOADED,this._textureState=Co.NOT_LOADED,this._promise=void 0,this._processError=void 0,this._textureErrors=[],this._primitiveLoadPlans=[],this._loaderPromises=[],this._textureLoaders=[],this._texturesPromises=[],this._textureCallbacks=[],this._bufferViewLoaders=[],this._geometryLoaders=[],this._geometryCallbacks=[],this._structuralMetadataLoader=void 0,this._loadResourcesPromise=void 0,this._resourcesLoaded=!1,this._texturesLoaded=!1,this._postProcessBuffers=[],this._components=void 0}async function p8e(e){e._state=Co.LOADING,e._textureState=Co.LOADING;try{let t=Gi.getGltfJsonLoader({gltfResource:e._gltfResource,baseResource:e._baseResource,typedArray:e._typedArray,gltfJson:e._gltfJson});return e._gltfJsonLoader=t,await t.load(),e.isDestroyed()||e.isUnloaded()||t.isDestroyed()?void 0:(e._state=Co.LOADED,e._textureState=Co.LOADED,e)}catch(t){if(e.isDestroyed())return;e._state=Co.FAILED,e._textureState=Co.FAILED,i2(e,t)}}async function _8e(e,t){Bt.supportsWebP.initialized||await Bt.supportsWebP.initialize();let i=new n2({webp:Bt.supportsWebP(),basis:t.context.supportsBasis}),n=hHe(e,e.gltfJson,i,t);return e._state=Co.PROCESSING,e._textureState=Co.PROCESSING,u(e._gltfJsonLoader)&&e._releaseGltfJson&&(Gi.unload(e._gltfJsonLoader),e._gltfJsonLoader=void 0),n}function i2(e,t){e.unload();throw e.getError("Failed to load glTF",t)}function g8e(e,t){let i,n=!0,r=e._geometryLoaders,o=r.length;for(i=0;i<o;++i){let o=r[i].process(t);o&&u(e._geometryCallbacks[i])&&(e._geometryCallbacks[i](),e._geometryCallbacks[i]=void 0),n=n&&o}let a=e._structuralMetadataLoader;if(u(a)){let i=a.process(t);i&&(e._components.structuralMetadata=a.structuralMetadata),n=n&&i}n&&(e._state=Co.POST_PROCESSING)}function y8e(e,t){let i=e._primitiveLoadPlans,n=i.length;for(let r=0;r<n;r++){let n=i[r];n.postProcess(t),n.needsOutlines&&x8e(e,n)}}function x8e(e,t){let i=e._postProcessBuffers,n=t.primitive,r=n.outlineCoordinates;u(r)&&i.push(r.buffer);let o=n.attributes,a=o.length;for(let e=0;e<a;e++){let t=o[e];u(t.buffer)&&i.push(t.buffer)}let s=n.indices;u(s)&&u(s.buffer)&&i.push(s.buffer)}function b8e(e,t,i,n,r,o,a,s){let l=t.accessors[i].bufferView;return Gi.getVertexBufferLoader({gltf:t,gltfResource:e._gltfResource,baseResource:e._baseResource,frameState:s,bufferViewId:l,draco:r,attributeSemantic:n,accessorId:i,asynchronous:e._asynchronous,loadBuffer:o,loadTypedArray:a})}function T8e(e,t,i,n,r,o,a){return Gi.getIndexBufferLoader({gltf:t,accessorId:i,gltfResource:e._gltfResource,baseResource:e._baseResource,frameState:a,draco:n,asynchronous:e._asynchronous,loadBuffer:r,loadTypedArray:o})}function A8e(e,t,i){let n=Gi.getBufferViewLoader({gltf:t,bufferViewId:i,gltfResource:e._gltfResource,baseResource:e._baseResource});return e._bufferViewLoaders.push(n),n}function Mse(e,t,i){let n=t.byteOffset,r=Hl(e,t),o=t.count,a=ef(t.type),s=t.componentType,l=X.getSizeInBytes(s),u=o*a;if(r===l*a)return i=new Uint8Array(i),X.createArrayBufferView(s,i.buffer,i.byteOffset+n,u);let c=X.createTypedArray(s,u),h=new DataView(i.buffer),d=new Array(a),p=mg(t.componentType);n=i.byteOffset+n;for(let e=0;e<o;++e){p(h,n,a,l,d);for(let t=0;t<a;++t)c[e*a+t]=d[t];n+=r}return c}function C8e(e,t){let i=e.type;if(i===nn.SCALAR)return t.fill(0);let n=nn.getMathType(i);return t.fill(n.clone(n.ZERO))}function E8e(e,t,i,n){let r=e.type,o=e.count;if(r===nn.SCALAR)for(let e=0;e<o;e++)i[e]=t[e];else if(r===nn.VEC4&&n)for(let e=0;e<o;e++)i[e]=Le.unpack(t,4*e);else{let e=nn.getMathType(r),n=nn.getNumberOfComponents(r);for(let r=0;r<o;r++)i[r]=e.unpack(t,r*n)}return i}async function S8e(e,t,i,n,r,o){if(await t.load(),e.isDestroyed())return;E8e(n,Mse(i,n,t.typedArray),o,r=y(r,!1))}function o2(e,t,i,n){let r=t.accessors[i],o=r.count,a=new Array(o),s=r.bufferView;if(u(s)){let i=S8e(e,A8e(e,t,s),t,r,n,a);return e._loaderPromises.push(i),a}return C8e(r,a)}function tf(e,t){if(u(t))return e===Number?t[0]:e.unpack(t)}function w8e(e){return e===Number?0:new e}function v8e(e){switch(e){case X.BYTE:return 127;case X.UNSIGNED_BYTE:return 255;case X.SHORT:return 32767;case X.UNSIGNED_SHORT:return 65535;default:return 1}}u(Object.create)&&(id.prototype=Object.create(io.prototype),id.prototype.constructor=id),Object.defineProperties(id.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}},gltfJson:{get:function(){return u(this._gltfJsonLoader)?this._gltfJsonLoader.gltf:this._gltfJson}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},texturesLoaded:{get:function(){return this._texturesLoaded}}}),id.prototype.load=async function(){return u(this._promise)||(this._promise=p8e(this)),this._promise},id.prototype._process=function(e){return this._state===Co.READY||(this._state===Co.PROCESSING&&g8e(this,e),this._resourcesLoaded&&this._state===Co.POST_PROCESSING&&(y8e(this,e.context),this._state=Co.PROCESSED),!(!this._resourcesLoaded||this._state!==Co.PROCESSED)&&(zse(this),this._typedArray=void 0,this._state=Co.READY,!0))},id.prototype._processTextures=function(e){if(this._textureState===Co.READY)return!0;if(this._textureState!==Co.PROCESSING)return!1;let t,i=!0,n=this._textureLoaders,r=n.length;for(t=0;t<r;++t){let r=n[t].process(e);r&&u(this._textureCallbacks[t])&&(this._textureCallbacks[t](),this._textureCallbacks[t]=void 0),i=i&&r}return!!i&&(this._textureState=Co.READY,this._texturesLoaded=!0,!0)},id.prototype.process=function(e){if(this._state===Co.LOADED&&!u(this._loadResourcesPromise)&&(this._loadResourcesPromise=_8e(this,e).then((()=>{this._resourcesLoaded=!0})).catch((e=>{this._processError=e}))),u(this._processError)){this._state=Co.FAILED;let e=this._processError;this._processError=void 0,i2(this,e)}let t=this._textureErrors.pop();if(u(t)){let e=this.getError("Failed to load glTF texture",t);throw e.name="TextureError",e}if(this._state===Co.FAILED)return!1;let i=!1;try{i=this._process(e)}catch(e){this._state=Co.FAILED,i2(this,e)}let n=!1;try{n=this._processTextures(e)}catch(e){this._textureState=Co.FAILED,i2(this,e)}return this._incrementallyLoadTextures?i:i&&n};var D8e={VEC2:new U(-1,-1),VEC3:new h(-1,-1,-1),VEC4:new oe(-1,-1,-1,-1)};function I8e(e,t){let i=v8e(e.componentDatatype),n=D8e[e.type],r=e.min;u(r)&&(r=t.divideByScalar(r,i,r),r=t.maximumByComponent(r,n,r));let o=e.max;u(o)&&(o=t.divideByScalar(o,i,o),o=t.maximumByComponent(o,n,o)),e.min=r,e.max=o}function P8e(e,t,i){let n=e.decodeMatrix,r=tf(i,e.decodedMin),o=tf(i,e.decodedMax);u(r)&&u(o)&&(t.min=r,t.max=o);let a=new Mt.Quantization;a.componentDatatype=t.componentDatatype,a.type=t.type,4===n.length?(a.quantizedVolumeOffset=n[2],a.quantizedVolumeStepSize=n[0]):9===n.length?(a.quantizedVolumeOffset=new U(n[6],n[7]),a.quantizedVolumeStepSize=new U(n[0],n[4])):16===n.length?(a.quantizedVolumeOffset=new h(n[12],n[13],n[14]),a.quantizedVolumeStepSize=new h(n[0],n[5],n[10])):25===n.length&&(a.quantizedVolumeOffset=new oe(n[20],n[21],n[22],n[23]),a.quantizedVolumeStepSize=new oe(n[0],n[6],n[12],n[18])),t.quantization=a}function O8e(e,t,i,n,r){let o=e.accessors[t],a=nn.getMathType(o.type),s=y(o.normalized,!1),l=new K4e;l.name=i,l.semantic=n,l.setIndex=r,l.constant=w8e(a),l.componentDatatype=o.componentType,l.normalized=s,l.count=o.count,l.type=o.type,l.min=tf(a,o.min),l.max=tf(a,o.max),l.byteOffset=o.byteOffset,l.byteStride=Hl(e,o),ii(o,"WEB3D_quantized_attributes")&&P8e(o.extensions.WEB3D_quantized_attributes,l,a);let u=l.semantic===Tt.POSITION||l.semantic===Tt.NORMAL||l.semantic===Tt.TANGENT||l.semantic===Tt.TEXCOORD;return e.extensionsRequired?.includes("KHR_mesh_quantization")&&s&&u&&I8e(l,a),l}function Lse(e){let t=/^\w+_(\d+)$/.exec(e);if(null!==t)return parseInt(t[1])}var R8e={gltfSemantic:void 0,renamedSemantic:void 0,modelSemantic:void 0};function w9(e,t,i){let n=i;e._renameBatchIdSemantic&&("_BATCHID"===i||"BATCHID"===i)&&(n="_FEATURE_ID_0");let r=t.fromGltfSemantic(n),o=R8e;return o.gltfSemantic=i,o.renamedSemantic=n,o.modelSemantic=r,o}function M8e(e){let t=e===Tt.POSITION,i=e===Tt.FEATURE_ID,n=e===Tt.TEXCOORD;return t||i||n}function L8e(e,t,i,n){if(e.byteOffset=0,e.byteStride=void 0,e.quantization=t.quantization,i&&(e.buffer=t.buffer),n){let i=u(t.quantization)?t.quantization.componentDatatype:e.componentDatatype;e.typedArray=X.createArrayBufferView(i,t.typedArray.buffer)}}function N8e(e,t,i,n,r,o){if(r&&(i.buffer=n.buffer),o){let o=n.typedArray;i.typedArray=Mse(e,t,o),r||(i.byteOffset=0,i.byteStride=void 0)}}function Nse(e,t,i,n,r,o,a,s){let l=t.accessors[i],c=l.bufferView,h=n.gltfSemantic,d=n.renamedSemantic,p=n.modelSemantic,f=u(p)?Lse(d):void 0,m=O8e(t,i,h,p,f);if(!u(r)&&!u(c))return m;let _=b8e(e,t,i,h,r,o,a,s),g=e._geometryLoaders.length;e._geometryLoaders.push(_);let y=_.load();return e._loaderPromises.push(y),e._geometryCallbacks[g]=()=>{u(r)&&u(r.attributes)&&u(r.attributes[h])?L8e(m,_,o,a):N8e(t,l,m,_,o,a)},m}function Fse(e,t,i,n,r,o,a,s){let l=n.modelSemantic,u=l===Tt.POSITION,c=l===Tt.FEATURE_ID,h=u&&!o&&e._loadAttributesFor2D&&!s.scene3DOnly,d=e._loadForClassification&&c,p=e._loadAttributesAsTypedArray,f=!p,m=p||h||d,_=Nse(e,t,i,n,r,!a&&f,!!a||m,s),g=new AA.AttributeLoadPlan(_);return g.loadBuffer=f,g.loadTypedArray=m,g}function F8e(e,t,i,n,r,o){let a=u(n.ROTATION),s=u(n.TRANSLATION)&&u(t.accessors[n.TRANSLATION].min)&&u(t.accessors[n.TRANSLATION].max),l=w9(e,Wr,r),c=l.modelSemantic,h=c===Wr.TRANSLATION||c===Wr.ROTATION||c===Wr.SCALE,d=c===Wr.TRANSLATION,p=e._loadAttributesAsTypedArray||a&&h||!o.context.instancedArrays,f=!p,m=e._loadAttributesFor2D&&!o.scene3DOnly;return Nse(e,t,i,l,void 0,f,p||d&&(!s||m),o)}function B8e(e,t,i,n,r,o,a){let s=t.accessors[i],l=s.bufferView;if(!u(n)&&!u(l))return;let c=new Z4e;c.count=s.count;let h=e._loadAttributesAsTypedArray,d=e._loadIndicesForWireframe&&!a.context.webgl2,p=e._loadForClassification&&r,f=!h,m=h||d||p,_=T8e(e,t,i,n,!o&&f,!!o||m,a),g=e._geometryLoaders.length;e._geometryLoaders.push(_);let y=_.load();e._loaderPromises.push(y),e._geometryCallbacks[g]=()=>{c.indexDatatype=_.indexDatatype,c.buffer=_.buffer,c.typedArray=_.typedArray};let v=new AA.IndicesLoadPlan(c);return v.loadBuffer=f,v.loadTypedArray=m,v}function up(e,t,i,n,r,o){let a=Gl.getImageIdFromTexture({gltf:t,textureId:i.index,supportedImageFormats:n});if(!u(a))return;let s=Gi.getTextureLoader({gltf:t,textureInfo:i,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:n,frameState:r,asynchronous:e._asynchronous}),l=Gl.createModelTextureReader({textureInfo:i}),c=e._textureLoaders.length;e._textureLoaders.push(s);let h=s.load().catch((t=>{if(!e.isDestroyed()){if(!e._incrementallyLoadTextures)throw t;e._textureState=Co.FAILED,e._textureErrors.push(t)}}));return e._texturesPromises.push(h),e._textureCallbacks[c]=()=>{l.texture=s.texture,u(o)&&(l.texture.sampler=o)},l}function k8e(e,t,i,n,r){let o=new m8e,a=y(i.extensions,y.EMPTY_OBJECT),s=a.KHR_materials_pbrSpecularGlossiness,l=i.pbrMetallicRoughness;if(o.unlit=u(a.KHR_materials_unlit),u(s)){let i=new h8e;o.specularGlossiness=i,u(s.diffuseTexture)&&(i.diffuseTexture=up(e,t,s.diffuseTexture,n,r)),u(s.specularGlossinessTexture)&&u(s.specularGlossinessTexture)&&(i.specularGlossinessTexture=up(e,t,s.specularGlossinessTexture,n,r)),i.diffuseFactor=tf(oe,s.diffuseFactor),i.specularFactor=tf(h,s.specularFactor),i.glossinessFactor=s.glossinessFactor,o.pbrSpecularGlossiness=s}else if(u(l)){let i=new d8e;u(l.baseColorTexture)&&(i.baseColorTexture=up(e,t,l.baseColorTexture,n,r)),u(l.metallicRoughnessTexture)&&(i.metallicRoughnessTexture=up(e,t,l.metallicRoughnessTexture,n,r)),i.baseColorFactor=tf(oe,l.baseColorFactor),i.metallicFactor=l.metallicFactor,i.roughnessFactor=l.roughnessFactor,o.metallicRoughness=i}return u(i.emissiveTexture)&&(o.emissiveTexture=up(e,t,i.emissiveTexture,n,r)),u(i.normalTexture)&&!e._loadForClassification&&(o.normalTexture=up(e,t,i.normalTexture,n,r)),u(i.occlusionTexture)&&(o.occlusionTexture=up(e,t,i.occlusionTexture,n,r)),o.emissiveFactor=tf(h,i.emissiveFactor),o.alphaMode=i.alphaMode,o.alphaCutoff=i.alphaCutoff,o.doubleSided=i.doubleSided,o}function Bse(e,t){let i=new Pse;return i.featureCount=e.featureCount,i.nullFeatureId=e.nullFeatureId,i.propertyTableId=e.propertyTable,i.setIndex=e.attribute,i.label=e.label,i.positionalLabel=t,i}function kse(e,t,i,n){let r=new Pse,o=e.featureIds;return r.featureCount=i,r.propertyTableId=t,r.setIndex=Lse(o.attribute),r.positionalLabel=n,r}function Vse(e,t){let i=new Rse;return i.propertyTableId=e.propertyTable,i.featureCount=e.featureCount,i.nullFeatureId=e.nullFeatureId,i.label=e.label,i.positionalLabel=t,i.offset=0,i.repeat=1,i}function Use(e,t,i,n){let r=new Rse,o=e.featureIds;r.propertyTableId=t,r.featureCount=i,r.offset=y(o.constant,0);let a=y(o.divisor,0);return r.repeat=0===a?void 0:a,r.positionalLabel=n,r}function V8e(e,t,i,n,r,o){let a=new Ose;a.featureCount=i.featureCount,a.nullFeatureId=i.nullFeatureId,a.propertyTableId=i.propertyTable,a.label=i.label,a.positionalLabel=o;let s=i.texture;a.textureReader=up(e,t,s,n,r,un.NEAREST);let l=(u(s.channels)?s.channels:[0]).map((function(e){return"rgba".charAt(e)})).join("");return a.textureReader.channels=l,a}function U8e(e,t,i,n,r,o,a,s){let l=new Ose,u=i.featureIds,c=u.texture;return l.featureCount=a,l.propertyTableId=n,l.textureReader=up(e,t,c,r,o,un.NEAREST),l.textureReader.channels=u.channels,l.positionalLabel=s,l}function z8e(e,t,i,n,r,o){let a,s=new $4e;for(let l in i)if(i.hasOwnProperty(l)){let u=Fse(e,t,i[l],w9(e,Tt,l),a,false,n,o);s.attributes.push(u.attribute),r.attributePlans.push(u)}return s}function H8e(e,t,i,n,r,o){let a=new Q4e,s=new AA(a);e._primitiveLoadPlans.push(s);let l=i.material;u(l)&&(a.material=k8e(e,t,t.materials[l],r,o));let c=y(i.extensions,y.EMPTY_OBJECT),h=!1,d=c.CESIUM_primitive_outline;e._loadPrimitiveOutline&&u(d)&&(h=!0,s.needsOutlines=!0,s.outlineIndices=G8e(e,t,d,s));let p=e._loadForClassification,f=c.KHR_draco_mesh_compression,m=!1,_=i.attributes;if(u(_))for(let i in _)if(_.hasOwnProperty(i)){let r=_[i],l=w9(e,Tt,i),u=l.modelSemantic;if(p&&!M8e(u))continue;u===Tt.FEATURE_ID&&(m=!0);let c=Fse(e,t,r,l,f,n,h,o);s.attributePlans.push(c),a.attributes.push(c.attribute)}let g=i.targets;if(u(g)&&!p){let i=g.length;for(let n=0;n<i;++n)a.morphTargets.push(z8e(e,t,g[n],h,s,o))}let v=i.indices;if(u(v)){let i=B8e(e,t,v,f,m,h,o);u(i)&&(s.indicesPlan=i,a.indices=i.indices)}let b=c.EXT_structural_metadata,A=c.EXT_mesh_features,T=c.EXT_feature_metadata,E=u(T);u(A)?W8e(e,t,a,A,r,o):E&&j8e(e,t,a,T,r,o),u(b)?q8e(a,b):E&&Y8e(e,a,T);let C=i.mode;if(p&&C!==Ne.TRIANGLES)throw new ue("Only triangle meshes can be used for classification.");return a.primitiveType=C,a}function G8e(e,t,i){return o2(e,t,i.indices,!1)}function W8e(e,t,i,n,r,o){let a;a=u(n)&&u(n.featureIds)?n.featureIds:[];for(let n=0;n<a.length;n++){let s,l=a[n],c=`featureId_${n}`;s=u(l.texture)?V8e(e,t,l,r,o,c):u(l.attribute)?Bse(l,c):Vse(l,c),i.featureIds.push(s)}}function j8e(e,t,i,n,r,o){let a=t.extensions.EXT_feature_metadata.featureTables,s=0,l=n.featureIdAttributes;if(u(l)){let t=l.length;for(let n=0;n<t;++n){let t,r=l[n],o=r.featureTable,c=e._sortedPropertyTableIds.indexOf(o),h=a[o].count,d=`featureId_${s}`;s++,t=u(r.featureIds.attribute)?kse(r,c,h,d):Use(r,c,h,d),i.featureIds.push(t)}}let c=n.featureIdTextures;if(u(c)){let n=c.length;for(let l=0;l<n;++l){let n=c[l],u=n.featureTable,h=e._sortedPropertyTableIds.indexOf(u),d=`featureId_${s}`;s++;let p=U8e(e,t,n,h,r,o,a[u].count,d);i.featureIds.push(p)}}}function q8e(e,t){u(t)&&(u(t.propertyTextures)&&(e.propertyTextureIds=t.propertyTextures),u(t.propertyAttributes)&&(e.propertyAttributeIds=t.propertyAttributes))}function Y8e(e,t,i){u(i.featureTextures)&&(t.propertyTextureIds=i.featureTextures.map((function(t){return e._sortedFeatureTextureIds.indexOf(t)})))}function X8e(e,t,i,n){let r=i.EXT_mesh_gpu_instancing,o=new J4e,a=r.attributes;if(u(a))for(let i in a)if(a.hasOwnProperty(i)){let r=a[i];o.attributes.push(F8e(e,t,r,a,i,n))}let s=y(r.extensions,y.EMPTY_OBJECT),l=i.EXT_instance_features,c=s.EXT_feature_metadata;return u(l)?K8e(o,l):u(c)&&Z8e(t,o,c,e._sortedPropertyTableIds),o}function K8e(e,t){let i=t.featureIds;for(let t=0;t<i.length;t++){let n,r=i[t],o=`instanceFeatureId_${t}`;n=u(r.attribute)?Bse(r,o):Vse(r,o),e.featureIds.push(n)}}function Z8e(e,t,i,n){let r=e.extensions.EXT_feature_metadata.featureTables,o=i.featureIdAttributes;if(u(o)){let e=o.length;for(let i=0;i<e;++i){let e,a=o[i],s=a.featureTable,l=n.indexOf(s),c=r[s].count,h=`instanceFeatureId_${i}`;e=u(a.featureIds.attribute)?kse(a,l,c,h):Use(a,l,c,h),t.featureIds.push(e)}}}function $8e(e,t,i,n,r){let o=new t8e;o.name=i.name,o.matrix=tf(L,i.matrix),o.translation=tf(h,i.translation),o.rotation=tf(Le,i.rotation),o.scale=tf(h,i.scale);let a=y(i.extensions,y.EMPTY_OBJECT),s=a.EXT_mesh_gpu_instancing,l=a.AGI_articulations;if(u(s)){if(e._loadForClassification)throw new ue("Models with the EXT_mesh_gpu_instancing extension cannot be used for classification.");o.instances=X8e(e,t,a,r)}u(l)&&(o.articulationName=l.articulationName);let c=i.mesh;if(u(c)){let a=t.meshes[c],s=a.primitives,l=s.length;for(let i=0;i<l;++i)o.primitives.push(H8e(e,t,s[i],u(o.instances),n,r));let h=y(i.weights,a.weights),d=o.primitives[0].morphTargets.length;o.morphWeights=u(h)?h.slice():new Array(d).fill(0)}return o}function Q8e(e,t,i,n){if(!u(t.nodes))return[];let r,o,a=t.nodes.length,s=new Array(a);for(r=0;r<a;++r){let o=$8e(e,t,t.nodes[r],i,n);o.index=r,s[r]=o}for(r=0;r<a;++r){let e=t.nodes[r].children;if(u(e)){let t=e.length;for(o=0;o<t;++o)s[r].children.push(s[e[o]])}}return s}function J8e(e,t,i,n){let r=new e8e,o=i.joints,a=o.length,s=new Array(a);for(let e=0;e<a;++e)s[e]=n[o[e]];r.joints=s;let l=i.inverseBindMatrices;return u(l)?r.inverseBindMatrices=o2(e,t,l):r.inverseBindMatrices=new Array(a).fill(L.IDENTITY),r}function eHe(e,t,i){let n=t.skins;if(e._loadForClassification||!u(n))return[];let r=t.skins.length,o=new Array(r);for(let n=0;n<r;++n){let r=J8e(e,t,t.skins[n],i);r.index=n,o[n]=r}let a=i.length;for(let e=0;e<a;++e){let n=t.nodes[e].skin;u(n)&&(i[e].skin=o[n])}return o}async function tHe(e,t,i,n,r,o){let a=new JN({gltf:t,extension:i,extensionLegacy:n,gltfResource:e._gltfResource,baseResource:e._baseResource,supportedImageFormats:r,frameState:o,asynchronous:e._asynchronous});return e._structuralMetadataLoader=a,a.load()}function nHe(e,t,i){let n=new i8e,r=i.input;n.input=o2(e,t,r);let o=i.interpolation;n.interpolation=y(Ah[o],Ah.LINEAR);let a=i.output;return n.output=o2(e,t,a,!0),n}function iHe(e,t){let i=new o8e,n=e.node;if(!u(n))return;i.node=t[n];let r=e.path.toUpperCase();return i.path=n8e[r],i}function oHe(e,t,i){let n=new r8e,r=e.sampler;return n.sampler=t[r],n.target=iHe(e.target,i),n}function rHe(e,t,i,n){let r,o=new s8e;o.name=i.name;let a=i.samplers,s=a.length,l=new Array(s);for(r=0;r<s;r++){let i=nHe(e,t,a[r]);i.index=r,l[r]=i}let u=i.channels,c=u.length,h=new Array(c);for(r=0;r<c;r++)h[r]=oHe(u[r],l,n);return o.samplers=l,o.channels=h,o}function sHe(e,t,i){let n=t.animations;if(e._loadForClassification||!u(n))return[];let r=t.animations.length,o=new Array(r);for(let n=0;n<r;++n){let r=rHe(e,t,t.animations[n],i);r.index=n,o[n]=r}return o}function aHe(e){let t=new a8e;t.name=e.name;let i=e.type.toUpperCase();return t.type=cc[i],t.minimumValue=e.minimumValue,t.maximumValue=e.maximumValue,t.initialValue=e.initialValue,t}function cHe(e){let t=new c8e;t.name=e.name;let i=e.stages,n=i.length,r=new Array(n);for(let e=0;e<n;e++){let t=aHe(i[e]);r[e]=t}return t.stages=r,t}function lHe(e){let t=y(e.extensions,y.EMPTY_OBJECT).AGI_articulations;if(!u(t))return[];let i=t.articulations;if(!u(i))return[];let n=i.length,r=new Array(n);for(let e=0;e<n;e++){let t=cHe(i[e]);r[e]=t}return r}function uHe(e){let t;return u(e.scenes)&&u(e.scene)&&(t=e.scenes[e.scene].nodes),t=y(t,e.nodes),t=u(t)?t:[],t}function fHe(e,t){let i=new u8e,n=uHe(e);return i.nodes=n.map((function(e){return t[e]})),i}var dHe=new h;function hHe(e,t,i,n){let r=y(t.extensions,y.EMPTY_OBJECT),o=r.EXT_structural_metadata,a=r.EXT_feature_metadata,s=r.CESIUM_RTC;if(u(a)){let t=a.featureTables,i=a.featureTextures,n=u(t)?t:[],r=u(i)?i:[];e._sortedPropertyTableIds=Object.keys(n).sort(),e._sortedFeatureTextureIds=Object.keys(r).sort()}let l=Q8e(e,t,i,n),c=eHe(e,t,l),d=sHe(e,t,l),p=lHe(t),f=fHe(t,l),m=new f8e,_=new l8e,g=t.asset.copyright;if(u(g)){let e=g.split(";").map((function(e){return new xt(e.trim())}));_.credits=e}if(m.asset=_,m.scene=f,m.nodes=l,m.skins=c,m.animations=d,m.articulations=p,m.upAxis=e._upAxis,m.forwardAxis=e._forwardAxis,u(s)){let e=h.fromArray(s.center,0,dHe);m.transform=L.fromTranslation(e,m.transform)}if(e._components=m,u(o)||u(a)){let r=tHe(e,t,o,a,i,n);e._loaderPromises.push(r)}let v=[];return v.push.apply(v,e._loaderPromises),e._incrementallyLoadTextures||v.push.apply(v,e._texturesPromises),Promise.all(v)}function mHe(e){let t=e._textureLoaders,i=t.length;for(let e=0;e<i;++e)t[e]=!t[e].isDestroyed()&&Gi.unload(t[e]);e._textureLoaders.length=0}function zse(e){let t=e._bufferViewLoaders,i=t.length;for(let e=0;e<i;++e)t[e]=!t[e].isDestroyed()&&Gi.unload(t[e]);e._bufferViewLoaders.length=0}function pHe(e){let t=e._geometryLoaders,i=t.length;for(let e=0;e<i;++e)t[e]=!t[e].isDestroyed()&&Gi.unload(t[e]);e._geometryLoaders.length=0}function _He(e){let t=e._postProcessBuffers,i=t.length;for(let e=0;e<i;e++){let i=t[e];i.isDestroyed()||i.destroy()}t.length=0}function gHe(e){u(e._structuralMetadataLoader)&&!e._structuralMetadataLoader.isDestroyed()&&(e._structuralMetadataLoader.destroy(),e._structuralMetadataLoader=void 0)}id.prototype.isUnloaded=function(){return this._state===Co.UNLOADED},id.prototype.unload=function(){u(this._gltfJsonLoader)&&!this._gltfJsonLoader.isDestroyed()&&Gi.unload(this._gltfJsonLoader),this._gltfJsonLoader=void 0,mHe(this),zse(this),pHe(this),_He(this),gHe(this),this._components=void 0,this._typedArray=void 0,this._state=Co.UNLOADED};var Tg=id;function Hse(e){e=y(e,y.EMPTY_OBJECT),this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.canceled=e.canceled,this.persists=y(e.persists,!1),this.pass=Ee.COMPUTE,this.owner=e.owner}Hse.prototype.execute=function(e){e.execute(this)};var od=Hse;function r2(e,t,i,n,r,o,a,s,l,u,c){this._context=e,this._texture=t,this._textureTarget=i,this._targetFace=n,this._pixelDatatype=a,this._internalFormat=r,this._pixelFormat=o,this._size=s,this._preMultiplyAlpha=l,this._flipY=u,this._initialized=c}Object.defineProperties(r2.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),r2.prototype.copyFrom=function(e){let t=y(e.xOffset,0),i=y(e.yOffset,0),n=e.source,r=this._context._gl,o=this._textureTarget,a=this._targetFace;r.activeTexture(r.TEXTURE0),r.bindTexture(o,this._texture);let s=n.width,l=n.height,c=n.arrayBufferView,h=this._size,d=this._pixelFormat,p=this._internalFormat,f=this._pixelDatatype,m=this._preMultiplyAlpha,_=this._flipY,g=y(e.skipColorSpaceConversion,!1),v=4;u(c)&&(v=rt.alignmentInBytes(d,f,s)),r.pixelStorei(r.UNPACK_ALIGNMENT,v),g?r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE):r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.BROWSER_DEFAULT_WEBGL);let b=!1;if(!this._initialized){if(0===t&&0===i&&s===h&&l===h)u(c)?(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),_&&(c=rt.flipY(c,d,f,h,h)),r.texImage2D(a,0,p,h,h,0,d,Ye.toWebGLConstant(f,this._context),c)):(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,_),r.texImage2D(a,0,p,d,Ye.toWebGLConstant(f,this._context),n)),b=!0;else{r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);let e=rt.createTypedArray(d,f,h,h);r.texImage2D(a,0,p,h,h,0,d,Ye.toWebGLConstant(f,this._context),e)}this._initialized=!0}b||(u(c)?(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1),_&&(c=rt.flipY(c,d,f,s,l)),r.texSubImage2D(a,0,t,i,s,l,d,Ye.toWebGLConstant(f,this._context),c)):(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,_),r.texSubImage2D(a,0,t,i,d,Ye.toWebGLConstant(f,this._context),n))),r.bindTexture(o,null)},r2.prototype.copyFromFramebuffer=function(e,t,i,n,r,o){e=y(e,0),t=y(t,0),i=y(i,0),n=y(n,0),r=y(r,this._size),o=y(o,this._size);let a=this._context._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.copyTexSubImage2D(this._targetFace,0,e,t,i,n,r,o),a.bindTexture(s,null),this._initialized=!0};var fp=r2;function Bw(e){let t,i,n=(e=y(e,y.EMPTY_OBJECT)).context,r=e.source;if(u(r)){let e=[r.positiveX,r.negativeX,r.positiveY,r.negativeY,r.positiveZ,r.negativeZ];t=e[0].width,i=e[0].height}else t=e.width,i=e.height;let o=t,a=y(e.pixelDatatype,Ye.UNSIGNED_BYTE),s=y(e.pixelFormat,rt.RGBA),l=rt.toInternalFormat(s,a,n),c=6*rt.textureSizeInBytes(s,a,o,o),h=e.preMultiplyAlpha||s===rt.RGB||s===rt.LUMINANCE,d=y(e.flipY,!0),p=y(e.skipColorSpaceConversion,!1),f=n._gl,m=f.TEXTURE_CUBE_MAP,_=f.createTexture();function g(e,i,r,c,h){let d=i.arrayBufferView;u(d)||(d=i.bufferView);let p=4;u(d)&&(p=rt.alignmentInBytes(s,a,t)),f.pixelStorei(f.UNPACK_ALIGNMENT,p),h?f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.NONE):f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.BROWSER_DEFAULT_WEBGL),u(d)?(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!1),c&&(d=rt.flipY(d,s,a,o,o)),f.texImage2D(e,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),d)):(f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),f.texImage2D(e,0,l,s,Ye.toWebGLConstant(a,n),i))}f.activeTexture(f.TEXTURE0),f.bindTexture(m,_),u(r)?(g(f.TEXTURE_CUBE_MAP_POSITIVE_X,r.positiveX,h,d,p),g(f.TEXTURE_CUBE_MAP_NEGATIVE_X,r.negativeX,h,d,p),g(f.TEXTURE_CUBE_MAP_POSITIVE_Y,r.positiveY,h,d,p),g(f.TEXTURE_CUBE_MAP_NEGATIVE_Y,r.negativeY,h,d,p),g(f.TEXTURE_CUBE_MAP_POSITIVE_Z,r.positiveZ,h,d,p),g(f.TEXTURE_CUBE_MAP_NEGATIVE_Z,r.negativeZ,h,d,p)):(f.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),null),f.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_X,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),null),f.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Y,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),null),f.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),null),f.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_Z,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),null),f.texImage2D(f.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,l,o,o,0,s,Ye.toWebGLConstant(a,n),null)),f.bindTexture(m,null),this._context=n,this._textureFilterAnisotropic=n._textureFilterAnisotropic,this._textureTarget=m,this._texture=_,this._pixelFormat=s,this._pixelDatatype=a,this._size=o,this._hasMipmap=!1,this._sizeInBytes=c,this._preMultiplyAlpha=h,this._flipY=d,this._sampler=void 0;let v=u(r);this._positiveX=new fp(n,_,m,f.TEXTURE_CUBE_MAP_POSITIVE_X,l,s,a,o,h,d,v),this._negativeX=new fp(n,_,m,f.TEXTURE_CUBE_MAP_NEGATIVE_X,l,s,a,o,h,d,v),this._positiveY=new fp(n,_,m,f.TEXTURE_CUBE_MAP_POSITIVE_Y,l,s,a,o,h,d,v),this._negativeY=new fp(n,_,m,f.TEXTURE_CUBE_MAP_NEGATIVE_Y,l,s,a,o,h,d,v),this._positiveZ=new fp(n,_,m,f.TEXTURE_CUBE_MAP_POSITIVE_Z,l,s,a,o,h,d,v),this._negativeZ=new fp(n,_,m,f.TEXTURE_CUBE_MAP_NEGATIVE_Z,l,s,a,o,h,d,v),this.sampler=u(e.sampler)?e.sampler:new un}Object.defineProperties(Bw.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){let t=e.minificationFilter,i=e.magnificationFilter,n=t===an.NEAREST_MIPMAP_NEAREST||t===an.NEAREST_MIPMAP_LINEAR||t===an.LINEAR_MIPMAP_NEAREST||t===an.LINEAR_MIPMAP_LINEAR,r=this._context,o=this._pixelDatatype;(o===Ye.FLOAT&&!r.textureFloatLinear||o===Ye.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(t=n?an.NEAREST_MIPMAP_NEAREST:an.NEAREST,i=wi.NEAREST);let a=r._gl,s=this._textureTarget;a.activeTexture(a.TEXTURE0),a.bindTexture(s,this._texture),a.texParameteri(s,a.TEXTURE_MIN_FILTER,t),a.texParameteri(s,a.TEXTURE_MAG_FILTER,i),a.texParameteri(s,a.TEXTURE_WRAP_S,e.wrapS),a.texParameteri(s,a.TEXTURE_WRAP_T,e.wrapT),u(this._textureFilterAnisotropic)&&a.texParameteri(s,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),a.bindTexture(s,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),Bw.prototype.generateMipmap=function(e){e=y(e,Xm.DONT_CARE),this._hasMipmap=!0;let t=this._context._gl,i=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(i,this._texture),t.generateMipmap(i),t.bindTexture(i,null)},Bw.prototype.isDestroyed=function(){return!1},Bw.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=le(this._positiveX),this._negativeX=le(this._negativeX),this._positiveY=le(this._positiveY),this._negativeY=le(this._negativeY),this._positiveZ=le(this._positiveZ),this._negativeZ=le(this._negativeZ),le(this)};var bc=Bw,s2="in vec2 v_textureCoordinates;\n\nuniform float originalSize;\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform sampler2D texture3;\nuniform sampler2D texture4;\nuniform sampler2D texture5;\n\nconst float yMipLevel1 = 1.0 - (1.0 / pow(2.0, 1.0));\nconst float yMipLevel2 = 1.0 - (1.0 / pow(2.0, 2.0));\nconst float yMipLevel3 = 1.0 - (1.0 / pow(2.0, 3.0));\nconst float yMipLevel4 = 1.0 - (1.0 / pow(2.0, 4.0));\n\nvoid main()\n{\n    vec2 uv = v_textureCoordinates;\n    vec2 textureSize = vec2(originalSize * 1.5 + 2.0, originalSize);\n    vec2 pixel = 1.0 / textureSize;\n\n    float mipLevel = 0.0;\n\n    if (uv.x - pixel.x > (textureSize.y / textureSize.x))\n    {\n        mipLevel = 1.0;\n        if (uv.y - pixel.y > yMipLevel1)\n        {\n            mipLevel = 2.0;\n            if (uv.y - pixel.y * 3.0 > yMipLevel2)\n            {\n                mipLevel = 3.0;\n                if (uv.y - pixel.y * 5.0 > yMipLevel3)\n                {\n                    mipLevel = 4.0;\n                    if (uv.y - pixel.y * 7.0 > yMipLevel4)\n                    {\n                        mipLevel = 5.0;\n                    }\n                }\n            }\n        }\n    }\n\n    if (mipLevel > 0.0)\n    {\n        float scale = pow(2.0, mipLevel);\n\n        uv.y -= (pixel.y * (mipLevel - 1.0) * 2.0);\n        uv.x *= ((textureSize.x - 2.0) / textureSize.y);\n\n        uv.x -= 1.0 + pixel.x;\n        uv.y -= (1.0 - (1.0 / pow(2.0, mipLevel - 1.0)));\n        uv *= scale;\n    }\n    else\n    {\n        uv.x *= (textureSize.x / textureSize.y);\n    }\n\n    if(mipLevel == 0.0)\n    {\n        out_FragColor = texture(texture0, uv);\n    }\n    else if(mipLevel == 1.0)\n    {\n        out_FragColor = texture(texture1, uv);\n    }\n    else if(mipLevel == 2.0)\n    {\n        out_FragColor = texture(texture2, uv);\n    }\n    else if(mipLevel == 3.0)\n    {\n        out_FragColor = texture(texture3, uv);\n    }\n    else if(mipLevel == 4.0)\n    {\n        out_FragColor = texture(texture4, uv);\n    }\n    else if(mipLevel == 5.0)\n    {\n        out_FragColor = texture(texture5, uv);\n    }\n    else\n    {\n        out_FragColor = vec4(0.0);\n    }\n}\n",a2="in vec3 v_cubeMapCoordinates;\nuniform samplerCube cubeMap;\n\nvoid main()\n{\n    vec4 rgba = czm_textureCube(cubeMap, v_cubeMapCoordinates);\n    #ifdef RGBA_NORMALIZED\n        out_FragColor = vec4(rgba.rgb, 1.0);\n    #else\n        float m = rgba.a * 16.0;\n        vec3 r = rgba.rgb * m;\n        out_FragColor = vec4(r * r, 1.0);\n    #endif\n}\n",c2="in vec4 position;\nin vec3 cubeMapCoordinates;\n\nout vec3 v_cubeMapCoordinates;\n\nvoid main()\n{\n    gl_Position = position;\n    v_cubeMapCoordinates = cubeMapCoordinates;\n}\n";function X0(e){this._url=e,this._cubeMapBuffers=void 0,this._cubeMaps=void 0,this._texture=void 0,this._mipTextures=void 0,this._va=void 0,this._sp=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1,this._errorEvent=new pe}Object.defineProperties(X0.prototype,{url:{get:function(){return this._url}},errorEvent:{get:function(){return this._errorEvent}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}}}),X0.isSupported=function(e){return e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat};var yHe=new h(1,0,0),xHe=new h(0,0,1),bHe=new h(-1,0,0),THe=new h(0,0,-1),l2=new h(0,1,0),AHe=new h(0,-1,0),jse=[l2,bHe,xHe,AHe,yHe,l2,THe,l2,l2],qse=jse.length,Yse=new Float32Array(3*qse),Gse=0;for(let e=0;e<qse;++e,Gse+=3)h.pack(jse[e],Yse,Gse);var CHe=new Float32Array([-1,1,-1,0,0,1,0,0,1,0,1,1,0,-1,-1,-1,1,-1]),EHe=new Uint16Array([0,1,2,2,3,1,7,6,1,3,6,1,2,5,4,3,4,2,4,8,6,3,4,6]);function SHe(e){let t=ut.createVertexBuffer({context:e,typedArray:CHe,usage:Be.STATIC_DRAW}),i=ut.createVertexBuffer({context:e,typedArray:Yse,usage:Be.STATIC_DRAW}),n=ut.createIndexBuffer({context:e,typedArray:EHe,usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT}),r=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:X.FLOAT},{index:1,vertexBuffer:i,componentsPerAttribute:3,componentDatatype:X.FLOAT}];return new ni({context:e,attributes:r,indexBuffer:n})}function Wse(e){return function(){return e}}function v9(e){e._va=e._va&&e._va.destroy(),e._sp=e._sp&&e._sp.destroy();let t,i,n=e._cubeMaps;if(u(n))for(i=n.length,t=0;t<i;++t)n[t].destroy();let r=e._mipTextures;if(u(r))for(i=r.length,t=0;t<i;++t)r[t].destroy();e._va=void 0,e._sp=void 0,e._cubeMaps=void 0,e._cubeMapBuffers=void 0,e._mipTextures=void 0}X0.prototype.update=function(e){let t=e.context;if(!X0.isSupported(t)||(u(this._texture)&&u(this._va)&&v9(this),u(this._texture)))return;if(!u(this._texture)&&!this._loading){let t=e.context.textureCache.getTexture(this._url);u(t)&&(v9(this),this._texture=t,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0)}let i=this._cubeMapBuffers;if(!u(i)&&!this._loading){let e=this;Ll(this._url).then((function(t){e._cubeMapBuffers=t,e._loading=!1})).catch((function(t){e.isDestroyed()||e._errorEvent.raiseEvent(t)})),this._loading=!0}if(!u(this._cubeMapBuffers))return;let n=[],r=i[0].positiveX.pixelDatatype;u(r)?n.push("RGBA_NORMALIZED"):r=t.halfFloatingPointTexture?Ye.HALF_FLOAT:Ye.FLOAT;let o=rt.RGBA,a=new He({defines:n,sources:[a2]});this._va=SHe(t),this._sp=Kt.fromCache({context:t,vertexShaderSource:c2,fragmentShaderSource:a,attributeLocations:{position:0,cubeMapCoordinates:1}});let s=Math.min(i.length,6);this._maximumMipmapLevel=s-1;let l=this._cubeMaps=new Array(s),c=this._mipTextures=new Array(s),h=2*i[0].positiveX.width,d={originalSize:function(){return h}};for(let n=0;n<s;++n){let a=i[n].positiveY;i[n].positiveY=i[n].negativeY,i[n].negativeY=a;let s=l[n]=new bc({context:t,source:i[n],pixelDatatype:r}),u=2*l[n].width,h=c[n]=new Ot({context:t,width:u,height:u,pixelDatatype:r,pixelFormat:o}),p=new od({vertexArray:this._va,shaderProgram:this._sp,uniformMap:{cubeMap:Wse(s)},outputTexture:h,persists:!0,owner:this});e.commandList.push(p),d[`texture${n}`]=Wse(h)}this._texture=new Ot({context:t,width:1.5*h+2,height:h,pixelDatatype:r,pixelFormat:o}),this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture);let p=new od({fragmentShaderSource:s2,uniformMap:d,outputTexture:this._texture,persists:!1,owner:this});e.commandList.push(p),this._ready=!0},X0.prototype.isDestroyed=function(){return!1},X0.prototype.destroy=function(){return v9(this),this._texture=this._texture&&this._texture.destroy(),le(this)};var Bh=X0;function kw(e){e=y(e,y.EMPTY_OBJECT);let t=u(e.imageBasedLightingFactor)?U.clone(e.imageBasedLightingFactor):new U(1,1);this._imageBasedLightingFactor=t;let i=y(e.luminanceAtZenith,.2);this._luminanceAtZenith=i;let n=e.sphericalHarmonicCoefficients;this._sphericalHarmonicCoefficients=n,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapAtlas=void 0,this._specularEnvironmentMapAtlasDirty=!0,this._specularEnvironmentMapLoaded=!1,this._previousSpecularEnvironmentMapLoaded=!1,this._useDefaultSpecularMaps=!1,this._useDefaultSphericalHarmonics=!1,this._shouldRegenerateShaders=!1,this._previousFrameNumber=void 0,this._previousImageBasedLightingFactor=U.clone(t),this._previousLuminanceAtZenith=i,this._previousSphericalHarmonicCoefficients=n,this._removeErrorListener=void 0}function wHe(e,t){if(Bh.isSupported(t)){if(e._specularEnvironmentMapAtlas=e._specularEnvironmentMapAtlas&&e._specularEnvironmentMapAtlas.destroy(),u(e._specularEnvironmentMaps)){let t=new Bh(e._specularEnvironmentMaps);e._specularEnvironmentMapAtlas=t,e._removeErrorListener=t.errorEvent.addEventListener((e=>{console.error(`Error loading specularEnvironmentMaps: ${e}`)}))}e._shouldRegenerateShaders=!0}}Object.defineProperties(kw.prototype,{imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){this._previousImageBasedLightingFactor=U.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor),this._imageBasedLightingFactor=U.clone(e,this._imageBasedLightingFactor)}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(e){this._previousLuminanceAtZenith=this._luminanceAtZenith,this._luminanceAtZenith=e}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients,this._sphericalHarmonicCoefficients=e}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){e!==this._specularEnvironmentMaps&&(this._specularEnvironmentMapAtlasDirty=this._specularEnvironmentMapAtlasDirty||e!==this._specularEnvironmentMaps,this._specularEnvironmentMapLoaded=!1),this._specularEnvironmentMaps=e}},enabled:{get:function(){return this._imageBasedLightingFactor.x>0||this._imageBasedLightingFactor.y>0}},shouldRegenerateShaders:{get:function(){return this._shouldRegenerateShaders}},useDefaultSphericalHarmonics:{get:function(){return this._useDefaultSphericalHarmonics}},useSphericalHarmonicCoefficients:{get:function(){return u(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics}},specularEnvironmentMapAtlas:{get:function(){return this._specularEnvironmentMapAtlas}},useDefaultSpecularMaps:{get:function(){return this._useDefaultSpecularMaps}},useSpecularEnvironmentMaps:{get:function(){return u(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps}}}),kw.prototype.update=function(e){if(e.frameNumber===this._previousFrameNumber)return;this._previousFrameNumber=e.frameNumber;let t=e.context;e.brdfLutGenerator.update(e),this._shouldRegenerateShaders=!1;let i=this._imageBasedLightingFactor,n=this._previousImageBasedLightingFactor;U.equals(i,n)||(this._shouldRegenerateShaders=i.x>0&&0===n.x||0===i.x&&n.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||i.y>0&&0===n.y||0===i.y&&n.y>0,this._previousImageBasedLightingFactor=U.clone(this._imageBasedLightingFactor,this._previousImageBasedLightingFactor)),this._luminanceAtZenith!==this._previousLuminanceAtZenith&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||u(this._luminanceAtZenith)!==u(this._previousLuminanceAtZenith),this._previousLuminanceAtZenith=this._luminanceAtZenith),this._previousSphericalHarmonicCoefficients!==this._sphericalHarmonicCoefficients&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||u(this._previousSphericalHarmonicCoefficients)!==u(this._sphericalHarmonicCoefficients),this._previousSphericalHarmonicCoefficients=this._sphericalHarmonicCoefficients),this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._previousSpecularEnvironmentMapLoaded!==this._specularEnvironmentMapLoaded,this._previousSpecularEnvironmentMapLoaded=this._specularEnvironmentMapLoaded,this._specularEnvironmentMapAtlasDirty&&(wHe(this,t),this._specularEnvironmentMapAtlasDirty=!1),u(this._specularEnvironmentMapAtlas)&&(this._specularEnvironmentMapAtlas.update(e),this._specularEnvironmentMapAtlas.ready&&(this._specularEnvironmentMapLoaded=!0));let r=!u(this._specularEnvironmentMapAtlas)&&u(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,o=!u(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,a=!u(this._sphericalHarmonicCoefficients)&&u(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,s=!u(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||r||o||a||s,this._useDefaultSpecularMaps=!u(this._specularEnvironmentMapAtlas)&&u(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!u(this._sphericalHarmonicCoefficients)&&u(e.sphericalHarmonicCoefficients)},kw.prototype.isDestroyed=function(){return!1},kw.prototype.destroy=function(){return this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),this._removeErrorListener=this._removeErrorListener&&this._removeErrorListener(),le(this)};var CA=kw,u2="uniform sampler2D u_pointCloud_colorGBuffer;\nuniform sampler2D u_pointCloud_depthGBuffer;\nuniform vec2 u_distanceAndEdlStrength;\nin vec2 v_textureCoordinates;\n\nvec2 neighborContribution(float log2Depth, vec2 offset)\n{\n    float dist = u_distanceAndEdlStrength.x;\n    vec2 texCoordOrig = v_textureCoordinates + offset * dist;\n    vec2 texCoord0 = v_textureCoordinates + offset * floor(dist);\n    vec2 texCoord1 = v_textureCoordinates + offset * ceil(dist);\n\n    float depthOrLogDepth0 = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, texCoord0));\n    float depthOrLogDepth1 = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, texCoord1));\n\n    // ignore depth values that are the clear depth\n    if (depthOrLogDepth0 == 0.0 || depthOrLogDepth1 == 0.0) {\n        return vec2(0.0);\n    }\n\n    // interpolate the two adjacent depth values\n    float depthMix = mix(depthOrLogDepth0, depthOrLogDepth1, fract(dist));\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(texCoordOrig, depthMix);\n    return vec2(max(0.0, log2Depth - log2(-eyeCoordinate.z / eyeCoordinate.w)), 1.0);\n}\n\nvoid main()\n{\n    float depthOrLogDepth = czm_unpackDepth(texture(u_pointCloud_depthGBuffer, v_textureCoordinates));\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depthOrLogDepth);\n    eyeCoordinate /= eyeCoordinate.w;\n\n    float log2Depth = log2(-eyeCoordinate.z);\n\n    if (depthOrLogDepth == 0.0) // 0.0 is the clear value for the gbuffer\n    {\n        discard;\n    }\n\n    vec4 color = texture(u_pointCloud_colorGBuffer, v_textureCoordinates);\n\n    // sample from neighbors left, right, down, up\n    vec2 texelSize = 1.0 / czm_viewport.zw;\n\n    vec2 responseAndCount = vec2(0.0);\n\n    responseAndCount += neighborContribution(log2Depth, vec2(-texelSize.x, 0.0));\n    responseAndCount += neighborContribution(log2Depth, vec2(+texelSize.x, 0.0));\n    responseAndCount += neighborContribution(log2Depth, vec2(0.0, -texelSize.y));\n    responseAndCount += neighborContribution(log2Depth, vec2(0.0, +texelSize.y));\n\n    float response = responseAndCount.x / responseAndCount.y;\n    float strength = u_distanceAndEdlStrength.y;\n    float shade = exp(-response * 300.0 * strength);\n    color.rgb *= shade;\n    out_FragColor = vec4(color);\n\n    // Input and output depth are the same.\n    gl_FragDepth = depthOrLogDepth;\n}\n";function EA(){this._framebuffer=new di({colorAttachmentsLength:2,depth:!0,supportsDepthTexture:!0}),this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}function vHe(e){e._framebuffer.destroy(),e._drawCommand=void 0,e._clearCommand=void 0}Object.defineProperties(EA.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}},colorGBuffer:{get:function(){return this._framebuffer.getColorTexture(0)}},depthGBuffer:{get:function(){return this._framebuffer.getColorTexture(1)}}});var D9=new U;function DHe(e,t){let i=new He({defines:["LOG_DEPTH_WRITE"],sources:[u2]}),n={u_pointCloud_colorGBuffer:function(){return e.colorGBuffer},u_pointCloud_depthGBuffer:function(){return e.depthGBuffer},u_distanceAndEdlStrength:function(){return D9.x=e._radius,D9.y=e._strength,D9}},r=Ue.fromCache({blending:ln.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:Lt.setCesium3DTileBit(),stencilMask:Lt.CESIUM_3D_TILE_MASK});e._drawCommand=t.createViewportQuadCommand(i,{uniformMap:n,renderState:r,pass:Ee.CESIUM_3D_TILE,owner:e}),e._clearCommand=new ti({framebuffer:e.framebuffer,color:new z(0,0,0,0),depth:1,renderState:Ue.fromCache(),pass:Ee.CESIUM_3D_TILE,owner:e})}function IHe(e,t){let i=t.drawingBufferWidth,n=t.drawingBufferHeight;e._framebuffer.update(t,i,n),DHe(e,t)}function Xse(e){return e.drawBuffers&&e.fragmentDepth}function PHe(e,t){let i=e.shaderCache.getDerivedShaderProgram(t,"EC");if(!u(i)){let n=t._attributeLocations,r=t.fragmentShaderSource.clone();r.sources.splice(0,0,"layout (location = 0) out vec4 out_FragData_0;\nlayout (location = 1) out vec4 out_FragData_1;"),r.sources=r.sources.map((function(e){return e=(e=He.replaceMain(e,"czm_point_cloud_post_process_main")).replaceAll(/out_FragColor/g,"out_FragData_0")})),r.sources.push("void main() \n{ \n    czm_point_cloud_post_process_main(); \n#ifdef LOG_DEPTH\n    czm_writeLogDepth();\n    out_FragData_1 = czm_packDepth(gl_FragDepth); \n#else\n    out_FragData_1 = czm_packDepth(gl_FragCoord.z);\n#endif\n}"),i=e.shaderCache.createDerivedShaderProgram(t,"EC",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:r,attributeLocations:n})}return i}EA.isSupported=Xse,EA.prototype.update=function(e,t,i,n){if(!Xse(e.context))return;this._strength=i.eyeDomeLightingStrength,this._radius=i.eyeDomeLightingRadius*e.pixelRatio,IHe(this,e.context);let r,o=e.commandList,a=o.length;for(r=t;r<a;++r){let t=o[r];if(t.primitiveType!==Ne.POINTS||t.pass===Ee.TRANSLUCENT)continue;let i,n,a=t.derivedCommands.pointCloudProcessor;u(a)&&(i=a.command,n=a.originalShaderProgram),(!u(i)||t.dirty||n!==t.shaderProgram||i.framebuffer!==this.framebuffer)&&(i=et.shallowClone(t,i),i.framebuffer=this.framebuffer,i.shaderProgram=PHe(e.context,t.shaderProgram),i.castShadows=!1,i.receiveShadows=!1,u(a)||(a={command:i,originalShaderProgram:t.shaderProgram},t.derivedCommands.pointCloudProcessor=a),a.originalShaderProgram=t.shaderProgram),o[r]=i}let s=this._clearCommand,l=this._drawCommand;l.boundingVolume=n,o.push(l),o.push(s)},EA.prototype.isDestroyed=function(){return!1},EA.prototype.destroy=function(){return vHe(this),le(this)};var Ag=EA;function Kse(e){let t=y(e,{});this.attenuation=y(t.attenuation,!1),this.geometricErrorScale=y(t.geometricErrorScale,1),this.maximumAttenuation=t.maximumAttenuation,this.baseResolution=t.baseResolution,this.eyeDomeLighting=y(t.eyeDomeLighting,!0),this.eyeDomeLightingStrength=y(t.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=y(t.eyeDomeLightingRadius,1),this.backFaceCulling=y(t.backFaceCulling,!1),this.normalShading=y(t.normalShading,!0)}Kse.isSupported=function(e){return Ag.isSupported(e.context)};var dp=Kse,ql={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4,castShadows:function(e){return e===ql.ENABLED||e===ql.CAST_ONLY},receiveShadows:function(e){return e===ql.ENABLED||e===ql.RECEIVE_ONLY},fromCastReceive:function(e,t){return e&&t?ql.ENABLED:e?ql.CAST_ONLY:t?ql.RECEIVE_ONLY:ql.DISABLED}},yn=Object.freeze(ql),OHe={LEFT:-1,NONE:0,RIGHT:1},al=Object.freeze(OHe);function Vw(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function Zse(e,t,i,n,r,o){let a=e._cachedTypedArrays,s=a[t];return u(s)||(s=X.createArrayBufferView(i,e.buffer.buffer,e.buffer.byteOffset+o,r*n),a[t]=s),s}function RHe(e,t,i,n){let r=e._cachedTypedArrays,o=r[t];return u(o)||(o=X.createTypedArray(i,n),r[t]=o),o}Vw.prototype.getGlobalProperty=function(e,t,i){let n=this.json[e];if(u(n))return u(n.byteOffset)?Zse(this,e,t=y(t,X.UNSIGNED_INT),i=y(i,1),1,n.byteOffset):n},Vw.prototype.hasProperty=function(e){return u(this.json[e])},Vw.prototype.getPropertyArray=function(e,t,i){let n=this.json[e];if(u(n))return u(n.byteOffset)?(u(n.componentType)&&(t=X.fromName(n.componentType)),Zse(this,e,t,i,this.featuresLength,n.byteOffset)):RHe(this,e,t,n)},Vw.prototype.getProperty=function(e,t,i,n,r){let o=this.json[e];if(!u(o))return;let a=this.getPropertyArray(e,t,i);if(1===i)return a[n];for(let e=0;e<i;++e)r[e]=a[i*n+e];return r};var kh=Vw;function Uw(e){let t,i,n=e.count,r=e.batchTable,o=e.binaryBody,a=y(e.parseAsPropertyAttributes,!1),s=e.customAttributeOutput,l=MHe(r);u(l.jsonProperties)&&(t=new xg({count:n,properties:l.jsonProperties})),u(l.hierarchy)&&(i=new eA({extension:l.hierarchy,binaryBody:o}));let c,h,d,p=Nh.BATCH_TABLE_CLASS_NAME,f=l.binaryProperties;if(a){let e=NHe(n,p,f,o,s);d=e.transcodedSchema,h=[new xA({propertyAttribute:e.propertyAttributeJson,class:e.transcodedClass})]}else{let e=LHe(n,p,f,o);d=e.transcodedSchema;let t=e.featureTableJson;c=new zl({count:t.count,properties:t.properties,class:e.transcodedClass,bufferViews:e.bufferViewsTypedArrays}),h=[]}let m=[];if(u(c)||u(t)||u(i)){let e=new sl({id:0,name:"Batch Table",count:n,metadataTable:c,jsonMetadataTable:t,batchTableHierarchy:i});m.push(e)}let _={schema:d,propertyTables:m,propertyAttributes:h,extensions:l.extensions,extras:l.extras};return new ja(_)}function MHe(e){let t,i=e.HIERARCHY,n=e.extras,r=e.extensions;u(i)?(Uw._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),t=i):u(r)&&(t=r["3DTILES_batch_table_hierarchy"]);let o,a={};for(let t in e){if(!e.hasOwnProperty(t)||"HIERARCHY"===t||"extensions"===t||"extras"===t)continue;let i=e[t];Array.isArray(i)?(o=u(o)?o:{},o[t]=i):a[t]=i}return{binaryProperties:a,jsonProperties:o,hierarchy:t,extras:n,extensions:r}}function LHe(e,t,i,n){let r={},o={},a={},s=0;for(let t in i){if(!i.hasOwnProperty(t))continue;if(!u(n))throw new ue(`Property ${t} requires a batch table binary.`);let l=i[t],c=qu(l);o[t]={bufferView:s},r[t]=$se(l),a[s]=c.createArrayBufferView(n.buffer,n.byteOffset+l.byteOffset,e),s++}let l={classes:{}};l.classes[t]={properties:r};let c=Fh.fromJson(l);return{featureTableJson:{class:t,count:e,properties:o},bufferViewsTypedArrays:a,transcodedSchema:c,transcodedClass:c.classes[t]}}function NHe(e,t,i,n,r){let o={},a={},s=0;for(let t in i){if(!i.hasOwnProperty(t))continue;let l=i[t];if(!u(n)&&!u(l.typedArray))throw new ue(`Property ${t} requires a batch table binary.`);let c=en.sanitizeGlslIdentifier(t);(""===c||o.hasOwnProperty(c))&&(c=`property_${s}`,s++);let h=$se(l);h.name=t,o[c]=h;let d=c.toUpperCase();d.startsWith("_")||(d=`_${d}`);let p=l.typedArray;u(p)||(p=qu(l).createArrayBufferView(n.buffer,n.byteOffset+l.byteOffset,e));let f=new Mt.Attribute;f.name=d,f.count=e,f.type=l.type;let m=X.fromTypedArray(p);(m===X.INT||m===X.UNSIGNED_INT||m===X.DOUBLE)&&(Uw._oneTimeWarning("Cast pnts property to floats",`Point cloud property "${d}" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),p=new Float32Array(p)),f.componentDatatype=X.fromTypedArray(p),f.typedArray=p,r.push(f),a[c]={attribute:d}}let l={classes:{}};l.classes[t]={properties:o};let c=Fh.fromJson(l);return{class:t,propertyAttributeJson:{properties:a},transcodedSchema:c,transcodedClass:c.classes[t]}}function $se(e){let t=FHe(e.componentType);return{type:e.type,componentType:t}}function FHe(e){switch(e){case"BYTE":return"INT8";case"UNSIGNED_BYTE":return"UINT8";case"SHORT":return"INT16";case"UNSIGNED_SHORT":return"UINT16";case"INT":return"INT32";case"UNSIGNED_INT":return"UINT32";case"FLOAT":return"FLOAT32";case"DOUBLE":return"FLOAT64"}}Uw._deprecationWarning=is,Uw._oneTimeWarning=It;var Cg=Uw,K0={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,FAILED:4},BHe=Mt.FeatureIdAttribute;function Eg(e){let t=(e=y(e,y.EMPTY_OBJECT)).b3dmResource,i=e.baseResource,n=e.arrayBuffer,r=y(e.byteOffset,0),o=y(e.releaseGltfJson,!1),a=y(e.asynchronous,!0),s=y(e.incrementallyLoadTextures,!0),l=y(e.upAxis,wo.Y),c=y(e.forwardAxis,wo.X),h=y(e.loadAttributesAsTypedArray,!1),d=y(e.loadAttributesFor2D,!1),p=y(e.loadIndicesForWireframe,!1),f=y(e.loadPrimitiveOutline,!0),m=y(e.loadForClassification,!1);i=u(i)?i:t.clone(),this._b3dmResource=t,this._baseResource=i,this._arrayBuffer=n,this._byteOffset=r,this._releaseGltfJson=o,this._asynchronous=a,this._incrementallyLoadTextures=s,this._upAxis=l,this._forwardAxis=c,this._loadAttributesAsTypedArray=h,this._loadAttributesFor2D=d,this._loadIndicesForWireframe=p,this._loadPrimitiveOutline=f,this._loadForClassification=m,this._state=K0.UNLOADED,this._promise=void 0,this._gltfLoader=void 0,this._batchLength=0,this._propertyTable=void 0,this._batchTable=void 0,this._components=void 0,this._transform=L.IDENTITY}function kHe(e,t){e.unload(),e._state=K0.FAILED;return t=e.getError("Failed to load b3dm",t),Promise.reject(t)}function VHe(e,t){let i,n=e._batchTable,r=e._batchLength;if(0===r)return;if(u(n.json))i=Cg({count:r,batchTable:n.json,binaryBody:n.binary});else{let e=new sl({name:Nh.BATCH_TABLE_CLASS_NAME,count:r});i=new ja({schema:{},propertyTables:[e]})}let o=t.scene.nodes,a=o.length;for(let e=0;e<a;e++)Qse(o[e]);t.structuralMetadata=i}function Qse(e){let t=e.children.length;for(let i=0;i<t;i++)Qse(e.children[i]);let i=e.primitives.length;for(let t=0;t<i;t++){let i=e.primitives[t],n=en.getAttributeBySemantic(i,Tt.FEATURE_ID);if(u(n)){n.setIndex=0;let e=new BHe;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",i.featureIds.push(e)}}}u(Object.create)&&(Eg.prototype=Object.create(io.prototype),Eg.prototype.constructor=Eg),Object.defineProperties(Eg.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),Eg.prototype.load=function(){if(u(this._promise))return this._promise;let e=XO.parse(this._arrayBuffer,this._byteOffset),t=e.batchLength,i=e.featureTableJson,n=e.featureTableBinary,r=e.batchTableJson,o=e.batchTableBinary,a=new kh(i,n);t=a.getGlobalProperty("BATCH_LENGTH"),this._batchLength=t;let s=a.getGlobalProperty("RTC_CENTER",X.FLOAT,3);u(s)&&(this._transform=L.fromTranslation(h.fromArray(s))),this._batchTable={json:r,binary:o};let l=new Tg({typedArray:e.gltf,upAxis:this._upAxis,forwardAxis:this._forwardAxis,gltfResource:this._b3dmResource,baseResource:this._baseResource,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadAttributesFor2D:this._loadAttributesFor2D,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline,loadForClassification:this._loadForClassification,renameBatchIdSemantic:!0});this._gltfLoader=l,this._state=K0.LOADING;let c=this;return this._promise=l.load().then((function(){if(!c.isDestroyed())return c._state=K0.PROCESSING,c})).catch((function(e){if(!c.isDestroyed())return kHe(c,e)})),this._promise},Eg.prototype.process=function(e){if(this._state===K0.READY)return!0;if(this._state!==K0.PROCESSING||!this._gltfLoader.process(e))return!1;let t=this._gltfLoader.components;return t.transform=L.multiplyTransformation(this._transform,t.transform,t.transform),VHe(this,t),this._components=t,this._arrayBuffer=void 0,this._state=K0.READY,!0},Eg.prototype.unload=function(){u(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),this._components=void 0,this._arrayBuffer=void 0};var f2=Eg;function Sg(e){e=y(e,y.EMPTY_OBJECT),this._geoJson=e.geoJson,this._components=void 0}function UHe(){this.lines=void 0,this.points=void 0,this.properties=void 0}function zHe(){this.features=[]}function I9(e){let t=e[0],i=e[1],n=y(e[2],0);return new h(t,i,n)}function P9(e){let t=e.length,i=new Array(t);for(let n=0;n<t;n++)i[n]=I9(e[n]);return[i]}function HHe(e){let t=e.length,i=new Array(t);for(let n=0;n<t;n++)i[n]=P9(e[n])[0];return i}function Jse(e){let t=e.length,i=new Array(t);for(let n=0;n<t;n++)i[n]=P9(e[n])[0];return i}function GHe(e){let t=e.length,i=[];for(let n=0;n<t;n++)Array.prototype.push.apply(i,Jse(e[n]));return i}function WHe(e){return[I9(e)]}function jHe(e){let t=e.length,i=new Array(t);for(let n=0;n<t;n++)i[n]=I9(e[n]);return i}u(Object.create)&&(Sg.prototype=Object.create(io.prototype),Sg.prototype.constructor=Sg),Object.defineProperties(Sg.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),Sg.prototype.load=function(){return Promise.resolve(this)},Sg.prototype.process=function(e){return u(this._components)||(this._components=QHe(this._geoJson,e),this._geoJson=void 0),!0};var qHe={LineString:P9,MultiLineString:HHe,MultiPolygon:GHe,Polygon:Jse,MultiPoint:jHe,Point:WHe},YHe={LineString:Ne.LINES,MultiLineString:Ne.LINES,MultiPolygon:Ne.LINES,Polygon:Ne.LINES,MultiPoint:Ne.POINTS,Point:Ne.POINTS};function eae(e,t){if(!u(e.geometry))return;let i=e.geometry.type,n=qHe[i],r=YHe[i],o=e.geometry.coordinates;if(!u(n)||!u(o))return;let a=new UHe;r===Ne.LINES?a.lines=n(o):r===Ne.POINTS&&(a.points=n(o)),a.properties=e.properties,t.features.push(a)}function XHe(e,t){let i=e.features,n=i.length;for(let e=0;e<n;e++)eae(i[e],t)}var KHe={FeatureCollection:XHe,Feature:eae},d2=new h;function ZHe(e,t,i){let n=0,r=0,o=e.length;for(let t=0;t<o;t++){let i=e[t];if(u(i.lines)){let e=i.lines.length;for(let t=0;t<e;t++){let e=i.lines[t];n+=e.length,r+=2*(e.length-1)}}}let a=new Float32Array(3*n),s=new Float32Array(n),l=ke.createTypedArray(n,r),c=ke.fromTypedArray(l),d=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),p=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),f=0,m=0;for(let i=0;i<o;i++){let n=e[i];if(!u(n.lines))continue;let r=n.lines.length;for(let e=0;e<r;e++){let r=n.lines[e],o=r.length;for(let e=0;e<o;e++){let n=r[e],u=h.fromDegrees(n.x,n.y,n.z,ie.WGS84,d2),c=L.multiplyByPoint(t,u,d2);h.minimumByComponent(d,c,d),h.maximumByComponent(p,c,p),h.pack(c,a,3*f),s[f]=i,e<o-1&&(l[2*m]=f,l[2*m+1]=f+1,m++),f++}}}let _=ut.createVertexBuffer({typedArray:a,context:i.context,usage:Be.STATIC_DRAW});_.vertexArrayDestroyable=!1;let g=ut.createVertexBuffer({typedArray:s,context:i.context,usage:Be.STATIC_DRAW});g.vertexArrayDestroyable=!1;let y=ut.createIndexBuffer({typedArray:l,context:i.context,usage:Be.STATIC_DRAW,indexDatatype:c});y.vertexArrayDestroyable=!1;let v=new Mt.Attribute;v.semantic=Tt.POSITION,v.componentDatatype=X.FLOAT,v.type=nn.VEC3,v.count=n,v.min=d,v.max=p,v.buffer=_;let b=new Mt.Attribute;b.semantic=Tt.FEATURE_ID,b.setIndex=0,b.componentDatatype=X.FLOAT,b.type=nn.SCALAR,b.count=n,b.buffer=g;let A=[v,b],T=new Mt.Material;T.unlit=!0;let E=new Mt.Indices;E.indexDatatype=c,E.count=l.length,E.buffer=y;let C=new Mt.FeatureIdAttribute;C.featureCount=o,C.propertyTableId=0,C.setIndex=0,C.positionalLabel="featureId_0";let x=[C],S=new Mt.Primitive;return S.attributes=A,S.indices=E,S.featureIds=x,S.primitiveType=Ne.LINES,S.material=T,S}function $He(e,t,i){let n=0,r=e.length;for(let t=0;t<r;t++){let i=e[t];u(i.points)&&(n+=i.points.length)}let o=new Float32Array(3*n),a=new Float32Array(n),s=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),c=0;for(let i=0;i<r;i++){let n=e[i];if(!u(n.points))continue;let r=n.points.length;for(let e=0;e<r;e++){let r=n.points[e],u=h.fromDegrees(r.x,r.y,r.z,ie.WGS84,d2),d=L.multiplyByPoint(t,u,d2);h.minimumByComponent(s,d,s),h.maximumByComponent(l,d,l),h.pack(d,o,3*c),a[c]=i,c++}}let d=ut.createVertexBuffer({typedArray:o,context:i.context,usage:Be.STATIC_DRAW});d.vertexArrayDestroyable=!1;let p=ut.createVertexBuffer({typedArray:a,context:i.context,usage:Be.STATIC_DRAW});p.vertexArrayDestroyable=!1;let f=new Mt.Attribute;f.semantic=Tt.POSITION,f.componentDatatype=X.FLOAT,f.type=nn.VEC3,f.count=n,f.min=s,f.max=l,f.buffer=d;let m=new Mt.Attribute;m.semantic=Tt.FEATURE_ID,m.setIndex=0,m.componentDatatype=X.FLOAT,m.type=nn.SCALAR,m.count=n,m.buffer=p;let _=[f,m],g=new Mt.Material;g.unlit=!0;let y=new Mt.FeatureIdAttribute;y.featureCount=r,y.propertyTableId=0,y.setIndex=0,y.positionalLabel="featureId_0";let v=[y],b=new Mt.Primitive;return b.attributes=_,b.featureIds=v,b.primitiveType=Ne.POINTS,b.material=g,b}function QHe(e,t){let i=new zHe,n=KHe[e.type];u(n)&&n(e,i);let r=i.features,o=r.length;if(0===o)throw new ue("GeoJSON must have at least one feature");let a={};for(let e=0;e<o;e++){let t=r[e],i=y(t.properties,y.EMPTY_OBJECT);for(let e in i)i.hasOwnProperty(e)&&(u(a[e])||(a[e]=new Array(o)))}for(let e=0;e<o;e++){let t=r[e];for(let i in a)if(a.hasOwnProperty(i)){let n=y(t.properties[i],"");a[i][e]=n}}let s=new xg({count:o,properties:a}),l=[new sl({id:0,count:o,jsonMetadataTable:s})],c=Fh.fromJson({}),d=new ja({schema:c,propertyTables:l}),p=new h(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),f=new h(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),m=!1,_=!1;for(let e=0;e<o;e++){let t=r[e];if(u(t.lines)){m=!0;let e=t.lines.length;for(let i=0;i<e;i++){let e=t.lines[i],n=e.length;for(let t=0;t<n;t++)h.minimumByComponent(p,e[t],p),h.maximumByComponent(f,e[t],f)}}if(u(t.points)){_=!0;let e=t.points.length;for(let i=0;i<e;i++){let e=t.points[i];h.minimumByComponent(p,e,p),h.maximumByComponent(f,e,f)}}}let g=h.midpoint(p,f,new h),v=h.fromDegrees(g.x,g.y,g.z,ie.WGS84,new h),b=Rt.eastNorthUpToFixedFrame(v,ie.WGS84,new L),A=L.inverseTransformation(b,new L),T=[];m&&T.push(ZHe(r,A,t)),_&&T.push($He(r,A,t));let E=new Mt.Node;E.index=0,E.primitives=T;let C=[E],x=new Mt.Scene;x.nodes=C;let S=new Mt.Components;return S.scene=x,S.nodes=C,S.transform=b,S.structuralMetadata=d,S}Sg.prototype.unload=function(){this._components=void 0};var h2=Sg,m2={};m2._deprecationWarning=is;var wg=Uint32Array.BYTES_PER_ELEMENT;m2.parse=function(e,t){let i=y(t,0);t=i;let n=new Uint8Array(e),r=new DataView(e);t+=wg;let o=r.getUint32(t,!0);if(1!==o)throw new ue(`Only Instanced 3D Model version 1 is supported. Version ${o} is not.`);t+=wg;let a=r.getUint32(t,!0);t+=wg;let s=r.getUint32(t,!0);if(0===s)throw new ue("featureTableJsonByteLength is zero, the feature table must be defined.");t+=wg;let l=r.getUint32(t,!0);t+=wg;let u=r.getUint32(t,!0);t+=wg;let c=r.getUint32(t,!0);t+=wg;let h=r.getUint32(t,!0);if(1!==h&&0!==h)throw new ue(`Only glTF format 0 (uri) or 1 (embedded) are supported. Format ${h} is not.`);let d=So(n,t+=wg,s);t+=s;let p,f,m=new Uint8Array(e,t,l);t+=l,u>0&&(p=So(n,t,u),t+=u,c>0&&(f=new Uint8Array(e,t,c),f=new Uint8Array(f),t+=c));let _,g=i+a-t;if(0===g)throw new ue("glTF byte length must be greater than 0.");return t%4==0?_=new Uint8Array(e,t,g):(m2._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),_=new Uint8Array(n.subarray(t,t+g))),{gltfFormat:h,featureTableJson:d,featureTableBinary:m,batchTableJson:p,batchTableBinary:f,gltf:_}};var p2=m2,hp={NOT_LOADED:0,LOADING:1,PROCESSING:2,POST_PROCESSING:3,READY:4,FAILED:5,UNLOADED:6},_2=Mt.Attribute,JHe=Mt.FeatureIdAttribute,nae=Mt.Instances;function mp(e){let t=(e=y(e,y.EMPTY_OBJECT)).i3dmResource,i=e.arrayBuffer,n=e.baseResource,r=y(e.byteOffset,0),o=y(e.releaseGltfJson,!1),a=y(e.asynchronous,!0),s=y(e.incrementallyLoadTextures,!0),l=y(e.upAxis,wo.Y),c=y(e.forwardAxis,wo.X),h=y(e.loadAttributesAsTypedArray,!1),d=y(e.loadIndicesForWireframe,!1),p=y(e.loadPrimitiveOutline,!0);n=u(n)?n:t.clone(),this._i3dmResource=t,this._baseResource=n,this._arrayBuffer=i,this._byteOffset=r,this._releaseGltfJson=o,this._asynchronous=a,this._incrementallyLoadTextures=s,this._upAxis=l,this._forwardAxis=c,this._loadAttributesAsTypedArray=h,this._loadIndicesForWireframe=d,this._loadPrimitiveOutline=p,this._state=hp.NOT_LOADED,this._promise=void 0,this._gltfLoader=void 0,this._buffers=[],this._components=void 0,this._transform=L.IDENTITY,this._batchTable=void 0,this._featureTable=void 0,this._instancesLength=0}function e5e(e,t){e.unload(),e._state=hp.FAILED;return e.getError("Failed to load i3dm",t)}function t5e(e,t){let i,n=e._batchTable,r=e._instancesLength;if(0!==r){if(u(n.json))i=Cg({count:r,batchTable:n.json,binaryBody:n.binary});else{let e=new sl({name:Nh.BATCH_TABLE_CLASS_NAME,count:r});i=new ja({schema:{},propertyTables:[e]})}t.structuralMetadata=i}}u(Object.create)&&(mp.prototype=Object.create(io.prototype),mp.prototype.constructor=mp),Object.defineProperties(mp.prototype,{texturesLoaded:{get:function(){return this._gltfLoader?.texturesLoaded}},cacheKey:{get:function(){}},components:{get:function(){return this._components}}}),mp.prototype.load=function(){if(u(this._promise))return this._promise;let e=p2.parse(this._arrayBuffer,this._byteOffset),t=e.featureTableJson,i=e.featureTableBinary,n=e.batchTableJson,r=e.batchTableBinary,o=e.gltfFormat,a=new kh(t,i);this._featureTable=a;let s=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=s,!u(s))throw new ue("Feature table global property: INSTANCES_LENGTH must be defined");this._instancesLength=s;let l=a.getGlobalProperty("RTC_CENTER",X.FLOAT,3);u(l)&&(this._transform=L.fromTranslation(h.fromArray(l))),this._batchTable={json:n,binary:r};let c={upAxis:this._upAxis,forwardAxis:this._forwardAxis,releaseGltfJson:this._releaseGltfJson,incrementallyLoadTextures:this._incrementallyLoadTextures,loadAttributesAsTypedArray:this._loadAttributesAsTypedArray,loadIndicesForWireframe:this._loadIndicesForWireframe,loadPrimitiveOutline:this._loadPrimitiveOutline};if(0===o){let t=Il(e.gltf);t=t.replace(/[\s\0]+$/,"");let i=this._baseResource.getDerivedResource({url:t});c.gltfResource=i,c.baseResource=i}else c.gltfResource=this._i3dmResource,c.typedArray=e.gltf;let d=new Tg(c);return this._gltfLoader=d,this._state=hp.LOADING,this._promise=d.load().then((()=>{if(!this.isDestroyed())return this._state=hp.PROCESSING,this})).catch((e=>{if(!this.isDestroyed())throw e5e(this,e)})),this._promise},mp.prototype.process=function(e){if(this._state===hp.READY)return!0;let t=this._gltfLoader,i=!1;if(this._state===hp.PROCESSING&&(i=t.process(e)),!i)return!1;let n=t.components;return n.transform=L.multiplyTransformation(this._transform,n.transform,n.transform),i5e(this,n,e),t5e(this,n),this._components=n,this._arrayBuffer=void 0,this._state=hp.READY,!0};var g2=new h,O9=new Array(4),n5e=new L;function i5e(e,t,i){let n,r=e._featureTable,o=e._instancesLength;if(0===o)return;let a,s,l=r.getGlobalProperty("RTC_CENTER",X.FLOAT,3),c=r.getGlobalProperty("EAST_NORTH_UP"),d=r.hasProperty("NORMAL_UP")||r.hasProperty("NORMAL_UP_OCT32P")||c,p=r.hasProperty("SCALE")||r.hasProperty("SCALE_NON_UNIFORM"),f=r5e(r,o);d&&(a=new Float32Array(4*o)),p&&(s=new Float32Array(3*o));let m=new Float32Array(o),_=h.unpackArray(f),g=new h,y=new h,v=new h,b=new h,A=new $,T=new Le,E=new Array(4),C=new h,x=new Array(3),S=new L;if(!u(l)||h.equals(h.unpack(l),h.ZERO)){let e=se.fromPoints(_);for(n=0;n<_.length;n++)h.subtract(_[n],e.center,g2),f[3*n+0]=g2.x,f[3*n+1]=g2.y,f[3*n+2]=g2.z;let i=L.fromTranslation(e.center,n5e);t.transform=L.multiplyTransformation(i,t.transform,t.transform)}for(n=0;n<o;n++){g=h.clone(_[n]),u(l)&&h.add(g,h.unpack(l),g),d&&(s5e(r,c,n,T,g,v,y,b,A,S),Le.pack(T,E,0),a[4*n+0]=E[0],a[4*n+1]=E[1],a[4*n+2]=E[2],a[4*n+3]=E[3]),p&&(a5e(r,n,C),h.pack(C,x,0),s[3*n+0]=x[0],s[3*n+1]=x[1],s[3*n+2]=x[2]);let e=r.getProperty("BATCH_ID",X.UNSIGNED_SHORT,1,n);u(e)||(e=n),m[n]=e}let w=new nae;w.transformInWorldSpace=!0;let I=e._buffers,P=new _2;if(P.name="Instance Translation",P.semantic=Wr.TRANSLATION,P.componentDatatype=X.FLOAT,P.type=nn.VEC3,P.count=o,P.typedArray=f,!d){let e=ut.createVertexBuffer({context:i.context,typedArray:f,usage:Be.STATIC_DRAW});e.vertexArrayDestroyable=!1,I.push(e),P.buffer=e}if(w.attributes.push(P),d){let e=new _2;e.name="Instance Rotation",e.semantic=Wr.ROTATION,e.componentDatatype=X.FLOAT,e.type=nn.VEC4,e.count=o,e.typedArray=a,w.attributes.push(e)}if(p){let e=new _2;if(e.name="Instance Scale",e.semantic=Wr.SCALE,e.componentDatatype=X.FLOAT,e.type=nn.VEC3,e.count=o,d)e.typedArray=s;else{let t=ut.createVertexBuffer({context:i.context,typedArray:s,usage:Be.STATIC_DRAW});t.vertexArrayDestroyable=!1,I.push(t),e.buffer=t}w.attributes.push(e)}let D=new _2;D.name="Instance Feature ID",D.setIndex=0,D.semantic=Wr.FEATURE_ID,D.componentDatatype=X.FLOAT,D.type=nn.SCALAR,D.count=o;let O=ut.createVertexBuffer({context:i.context,typedArray:m,usage:Be.STATIC_DRAW});O.vertexArrayDestroyable=!1,I.push(O),D.buffer=O,w.attributes.push(D);let R=new JHe;R.propertyTableId=0,R.setIndex=0,R.positionalLabel="instanceFeatureId_0",w.featureIds.push(R);let N=t.nodes,M=N.length,F=!1;for(n=0;n<M;n++){let e=N[n];e.primitives.length>0&&(e.instances=F?o5e(w):w,F=!0)}}function o5e(e){let t=new nae;t.transformInWorldSpace=e.transformInWorldSpace;let i=e.attributes,n=i.length;for(let e=0;e<n;e++){let n=Ge(i[e],!1);t.attributes.push(n)}return t.featureIds=e.featureIds,t}function r5e(e,t){if(e.hasProperty("POSITION"))return e.getPropertyArray("POSITION",X.FLOAT,3);if(e.hasProperty("POSITION_QUANTIZED")){let t=e.getPropertyArray("POSITION_QUANTIZED",X.UNSIGNED_SHORT,3),i=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",X.FLOAT,3);if(!u(i))throw new ue("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");let n=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",X.FLOAT,3);if(!u(n))throw new ue("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let r=new Float32Array(t.length);for(let e=0;e<t.length/3;e++)for(let o=0;o<3;o++){let a=3*e+o;r[a]=t[a]/65535*n[o]+i[o]}return r}throw new ue("Either POSITION or POSITION_QUANTIZED must be defined for each instance.")}var tae=new Array(4);function s5e(e,t,i,n,r,o,a,s,l,c){let d=e.getProperty("NORMAL_UP",X.FLOAT,3,i,O9),p=e.getProperty("NORMAL_RIGHT",X.FLOAT,3,i,tae),f=!1;if(u(d)){if(!u(p))throw new ue("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");h.unpack(d,0,o),h.unpack(p,0,a),f=!0}else{let n=e.getProperty("NORMAL_UP_OCT32P",X.UNSIGNED_SHORT,2,i,O9),s=e.getProperty("NORMAL_RIGHT_OCT32P",X.UNSIGNED_SHORT,2,i,tae);if(u(n)){if(!u(s))throw new ue("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");Gn.octDecodeInRange(n[0],n[1],65535,o),Gn.octDecodeInRange(s[0],s[1],65535,a),f=!0}else t?(Rt.eastNorthUpToFixedFrame(r,ie.WGS84,c),L.getMatrix3(c,l)):$.clone($.IDENTITY,l)}f&&(h.cross(a,o,s),h.normalize(s,s),$.setColumn(l,0,a,l),$.setColumn(l,1,o,l),$.setColumn(l,2,s,l)),Le.fromRotationMatrix(l,n)}function a5e(e,t,i){i=h.fromElements(1,1,1,i);let n=e.getProperty("SCALE",X.FLOAT,1,t);u(n)&&h.multiplyByScalar(i,n,i);let r=e.getProperty("SCALE_NON_UNIFORM",X.FLOAT,3,t,O9);u(r)&&(i.x*=r[0],i.y*=r[1],i.z*=r[2])}function c5e(e){let t=e._buffers,i=t.length;for(let e=0;e<i;e++){let i=t[e];i.isDestroyed()||i.destroy()}t.length=0}mp.prototype.isUnloaded=function(){return this._state===hp.UNLOADED},mp.prototype.unload=function(){u(this._gltfLoader)&&!this._gltfLoader.isDestroyed()&&this._gltfLoader.unload(),c5e(this),this._components=void 0,this._arrayBuffer=void 0,this._state=hp.UNLOADED};var y2=mp,l5e={STOPPED:0,ANIMATING:1},Vh=Object.freeze(l5e),Z0=Mt.AnimatedPropertyType,R9;function M9(e){let t=(e=y(e,y.EMPTY_OBJECT)).channel,i=e.runtimeAnimation,n=e.runtimeNode;this._channel=t,this._runtimeAnimation=i,this._runtimeNode=n,this._splines=[],this._path=void 0,d5e(this)}function u5e(e,t){let i=[],n=[],r=[],o=t.length;for(let e=0;e<o;e+=3)n.push(t[e]),i.push(t[e+1]),r.push(t[e+2]);return n.splice(0,1),r.length=r.length-1,new i0({times:e,points:i,inTangents:n,outTangents:r})}function iae(e,t,i,n){if(1===e.length&&1===t.length)return new f1(t[0]);switch(i){case Ah.STEP:return new MO({times:e,points:t});case Ah.CUBICSPLINE:return u5e(e,t);case Ah.LINEAR:return n===Z0.ROTATION?new TO({times:e,points:t}):new n0({times:e,points:t})}}function f5e(e,t,i,n,r){let o=[];if(n===Z0.WEIGHTS){let a,s,l=t.length/r;for(a=0;a<r;a++){let u=new Array(l),c=a;if(i===Ah.CUBICSPLINE)for(s=0;s<l;s+=3)u[s]=t[c],u[s+1]=t[c+r],u[s+2]=t[c+2*r],c+=3*r;else for(s=0;s<l;s++)u[s]=t[c],c+=r;o.push(iae(e,u,i,n))}}else o.push(iae(e,t,i,n));return o}function d5e(e){let t=e._channel,i=t.sampler,n=i.input,r=i.output,o=i.interpolation,a=t.target.path,s=e._runtimeNode,l=f5e(n,r,o,a,u(s.morphWeights)?s.morphWeights.length:1);switch(e._splines=l,e._path=a,a){case Z0.TRANSLATION:case Z0.SCALE:R9=new h;break;case Z0.ROTATION:R9=new Le;case Z0.WEIGHTS:}}Object.defineProperties(M9.prototype,{channel:{get:function(){return this._channel}},runtimeAnimation:{get:function(){return this._runtimeAnimation}},runtimeNode:{get:function(){return this._runtimeNode}},splines:{get:function(){return this._splines}}}),M9.prototype.animate=function(e){let t=this._splines,i=this._path,n=this._runtimeAnimation.model,r=this._runtimeNode;if(i===Z0.WEIGHTS){let i=r.morphWeights,o=i.length;for(let r=0;r<o;r++){let o=t[r],a=n.clampAnimations?o.clampTime(e):o.wrapTime(e);i[r]=o.evaluate(a)}}else{if(r.userAnimated)return;{let o=t[0],a=n.clampAnimations?o.clampTime(e):o.wrapTime(e);r[i]=o.evaluate(a,R9)}}};var x2=M9;function L9(e,t,i){this._animation=t,this._name=t.name,this._runtimeChannels=void 0,this._startTime=J.clone(i.startTime),this._delay=y(i.delay,0),this._stopTime=J.clone(i.stopTime),this.removeOnStop=y(i.removeOnStop,!1),this._multiplier=y(i.multiplier,1),this._reverse=y(i.reverse,!1),this._loop=y(i.loop,jl.NONE),this._animationTime=i.animationTime,this._prevAnimationDelta=void 0,this.start=new pe,this.update=new pe,this.stop=new pe,this._state=Vh.STOPPED,this._computedStartTime=void 0,this._duration=void 0;let n=this;this._raiseStartEvent=function(){n.start.raiseEvent(e,n)},this._updateEventTime=0,this._raiseUpdateEvent=function(){n.update.raiseEvent(e,n,n._updateEventTime)},this._raiseStopEvent=function(){n.stop.raiseEvent(e,n)},this._model=e,this._localStartTime=void 0,this._localStopTime=void 0,h5e(this)}function h5e(e){let t=Number.MAX_VALUE,i=-Number.MAX_VALUE,n=e._model.sceneGraph,r=e._animation.channels,o=r.length,a=[];for(let s=0;s<o;s++){let o=r[s],l=o.target;if(!u(l))continue;let c=l.node.index,h=n._runtimeNodes[c],d=new x2({channel:o,runtimeAnimation:e,runtimeNode:h}),p=o.sampler.input;t=Math.min(t,p[0]),i=Math.max(i,p[p.length-1]),a.push(d)}e._runtimeChannels=a,e._localStartTime=t,e._localStopTime=i}Object.defineProperties(L9.prototype,{animation:{get:function(){return this._animation}},name:{get:function(){return this._name}},runtimeChannels:{get:function(){return this._runtimeChannels}},model:{get:function(){return this._model}},localStartTime:{get:function(){return this._localStartTime}},localStopTime:{get:function(){return this._localStopTime}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}},animationTime:{get:function(){return this._animationTime}}}),L9.prototype.animate=function(e){let t=this._runtimeChannels,i=t.length;for(let n=0;n<i;n++)t[n].animate(e)};var b2=L9;function pp(e){this.animationAdded=new pe,this.animationRemoved=new pe,this.animateWhilePaused=!1,this._model=e,this._runtimeAnimations=[],this._previousTime=void 0}function N9(e,t,i){let n=e._model,r=new b2(n,t,i);return e._runtimeAnimations.push(r),e.animationAdded.raiseEvent(n,r),r}Object.defineProperties(pp.prototype,{length:{get:function(){return this._runtimeAnimations.length}},model:{get:function(){return this._model}}}),pp.prototype.add=function(e){e=y(e,y.EMPTY_OBJECT);let t=this._model.sceneGraph.components.animations,i=e.index;if(u(i))return N9(this,t[i],e);let n=t.length;for(let r=0;r<n;++r)if(t[r].name===e.name){i=r;break}return N9(this,t[i],e)},pp.prototype.addAll=function(e){e=y(e,y.EMPTY_OBJECT);let t=this._model.sceneGraph.components.animations,i=[],n=t.length;for(let r=0;r<n;++r){let n=N9(this,t[r],e);i.push(n)}return i},pp.prototype.remove=function(e){if(!u(e))return!1;let t=this._runtimeAnimations,i=t.indexOf(e);return-1!==i&&(t.splice(i,1),this.animationRemoved.raiseEvent(this._model,e),!0)},pp.prototype.removeAll=function(){let e=this._model,t=this._runtimeAnimations,i=t.length;this._runtimeAnimations.length=0;for(let n=0;n<i;++n)this.animationRemoved.raiseEvent(e,t[n])},pp.prototype.contains=function(e){return!!u(e)&&-1!==this._runtimeAnimations.indexOf(e)},pp.prototype.get=function(e){return this._runtimeAnimations[e]};var T2=[];function m5e(e,t,i){return function(){e.animationRemoved.raiseEvent(t,i)}}pp.prototype.update=function(e){let t=this._runtimeAnimations,i=t.length;if(0===i)return this._previousTime=void 0,!1;if(!this.animateWhilePaused&&J.equals(e.time,this._previousTime))return!1;this._previousTime=J.clone(e.time,this._previousTime);let n=!1,r=e.time,o=this._model;for(let o=0;o<i;++o){let i=t[o];u(i._computedStartTime)||(i._computedStartTime=J.addSeconds(y(i.startTime,r),i.delay,new J)),u(i._duration)||(i._duration=i.localStopTime*(1/i.multiplier));let a=i._computedStartTime,s=i._duration,l=i.stopTime,c=J.lessThanOrEquals(a,r),h=u(l)&&J.greaterThan(r,l),d=0;if(0!==s){let e=J.secondsDifference(h?l:r,a);d=u(i._animationTime)?i._animationTime(s,e):e/s}let p=i.loop===jl.REPEAT||i.loop===jl.MIRRORED_REPEAT,f=(c||p&&!u(i.startTime))&&(d<=1||p)&&!h;if(d===i._prevAnimationDelta){if(f!==(i._state===Vh.STOPPED))continue}if(i._prevAnimationDelta=d,f||i._state===Vh.ANIMATING){if(f&&i._state===Vh.STOPPED&&(i._state=Vh.ANIMATING,i.start.numberOfListeners>0&&e.afterRender.push(i._raiseStartEvent)),i.loop===jl.REPEAT)d-=Math.floor(d);else if(i.loop===jl.MIRRORED_REPEAT){let e=Math.floor(d),t=d-e;d=e%2==1?1-t:t}i.reverse&&(d=1-d);let t=d*s*i.multiplier;t=P.clamp(t,i.localStartTime,i.localStopTime),i.animate(t),i.update.numberOfListeners>0&&(i._updateEventTime=t,e.afterRender.push(i._raiseUpdateEvent)),n=!0,f||(i._state=Vh.STOPPED,i.stop.numberOfListeners>0&&e.afterRender.push(i._raiseStopEvent),i.removeOnStop&&T2.push(i))}}i=T2.length;for(let n=0;n<i;++n){let i=T2[n];t.splice(t.indexOf(i),1),e.afterRender.push(m5e(this,o,i))}return T2.length=0,n};var A2=pp;function $0(e){this._model=e.model,this._featureTable=e.featureTable,this._featureId=e.featureId,this._color=void 0}Object.defineProperties($0.prototype,{show:{get:function(){return this._featureTable.getShow(this._featureId)},set:function(e){this._featureTable.setShow(this._featureId,e)}},color:{get:function(){return u(this._color)||(this._color=new z),this._featureTable.getColor(this._featureId,this._color)},set:function(e){this._featureTable.setColor(this._featureId,e)}},primitive:{get:function(){return this._model}},featureTable:{get:function(){return this._featureTable}},featureId:{get:function(){return this._featureId}}}),$0.prototype.hasProperty=function(e){return this._featureTable.hasProperty(this._featureId,e)},$0.prototype.getProperty=function(e){return this._featureTable.getProperty(this._featureId,e)},$0.prototype.getPropertyInherited=function(e){return this._featureTable.hasPropertyBySemantic(this._featureId,e)?this._featureTable.getPropertyBySemantic(this._featureId,e):this._featureTable.getProperty(this._featureId,e)},$0.prototype.getPropertyIds=function(e){return this._featureTable.getPropertyIds(e)},$0.prototype.setProperty=function(e,t){return this._featureTable.setProperty(this._featureId,e,t)};var C2=$0,zw={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2,getStyleCommandsNeeded:function(e,t){return 0===t?zw.ALL_OPAQUE:t===e?zw.ALL_TRANSLUCENT:zw.OPAQUE_AND_TRANSLUCENT}},Uh=Object.freeze(zw),vg={GLTF:"GLTF",TILE_GLTF:"TILE_GLTF",TILE_B3DM:"B3DM",TILE_I3DM:"I3DM",TILE_PNTS:"PNTS",TILE_GEOJSON:"TILE_GEOJSON",is3DTiles:function(e){switch(e){case vg.TILE_GLTF:case vg.TILE_B3DM:case vg.TILE_I3DM:case vg.TILE_PNTS:case vg.TILE_GEOJSON:return!0;case vg.GLTF:return!1}}},lr=Object.freeze(vg);function xr(e){let t=e.model,i=e.propertyTable;this._propertyTable=i,this._model=t,this._features=void 0,this._featuresLength=0,this._batchTexture=void 0,this._styleCommandsNeededDirty=!1,this._styleCommandsNeeded=Uh.ALL_OPAQUE,p5e(this)}function p5e(e){let t=e._model,i=lr.is3DTiles(t.type),n=e._propertyTable.count;if(0===n)return;let r,o=new Array(n);if(i){let e=t.content;for(r=0;r<n;r++)o[r]=new Fs(e,r)}else for(r=0;r<n;r++)o[r]=new C2({model:t,featureId:r,featureTable:e});e._features=o,e._featuresLength=n,e._batchTexture=new il({featuresLength:n,owner:e,statistics:i?t.content.tileset.statistics:void 0})}Object.defineProperties(xr.prototype,{batchTexture:{get:function(){return this._batchTexture}},featuresLength:{get:function(){return this._featuresLength}},batchTextureByteLength:{get:function(){return u(this._batchTexture)?this._batchTexture.byteLength:0}},styleCommandsNeededDirty:{get:function(){return this._styleCommandsNeededDirty}}}),xr.prototype.update=function(e){this._styleCommandsNeededDirty=!1,this._batchTexture.update(void 0,e);let t=Uh.getStyleCommandsNeeded(this._featuresLength,this._batchTexture.translucentFeaturesLength);this._styleCommandsNeeded!==t&&(this._styleCommandsNeededDirty=!0,this._styleCommandsNeeded=t)},xr.prototype.setShow=function(e,t){this._batchTexture.setShow(e,t)},xr.prototype.setAllShow=function(e){this._batchTexture.setAllShow(e)},xr.prototype.getShow=function(e){return this._batchTexture.getShow(e)},xr.prototype.setColor=function(e,t){this._batchTexture.setColor(e,t)},xr.prototype.setAllColor=function(e){this._batchTexture.setAllColor(e)},xr.prototype.getColor=function(e,t){return this._batchTexture.getColor(e,t)},xr.prototype.getPickColor=function(e){return this._batchTexture.getPickColor(e)},xr.prototype.getFeature=function(e){return this._features[e]},xr.prototype.hasProperty=function(e,t){return this._propertyTable.hasProperty(e,t)},xr.prototype.hasPropertyBySemantic=function(e,t){return this._propertyTable.hasPropertyBySemantic(e,t)},xr.prototype.getProperty=function(e,t){return this._propertyTable.getProperty(e,t)},xr.prototype.getPropertyBySemantic=function(e,t){return this._propertyTable.getPropertyBySemantic(e,t)},xr.prototype.getPropertyIds=function(e){return this._propertyTable.getPropertyIds(e)},xr.prototype.setProperty=function(e,t,i){return this._propertyTable.setProperty(e,t,i)},xr.prototype.isClass=function(e,t){return this._propertyTable.isClass(e,t)},xr.prototype.isExactClass=function(e,t){return this._propertyTable.isExactClass(e,t)},xr.prototype.getExactClassName=function(e){return this._propertyTable.getExactClassName(e)};var _5e=new z;xr.prototype.applyStyle=function(e){if(!u(e))return this.setAllColor(il.DEFAULT_COLOR_VALUE),void this.setAllShow(il.DEFAULT_SHOW_VALUE);for(let t=0;t<this._featuresLength;t++){let i=this.getFeature(t),n=u(e.color)?y(e.color.evaluateColor(i,_5e),il.DEFAULT_COLOR_VALUE):il.DEFAULT_COLOR_VALUE,r=u(e.show)?y(e.show.evaluate(i),il.DEFAULT_SHOW_VALUE):il.DEFAULT_SHOW_VALUE;this.setColor(t,n),this.setShow(t,r)}},xr.prototype.isDestroyed=function(){return!1},xr.prototype.destroy=function(e){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),le(this)};var E2=xr,S2="czm_modelMaterial defaultModelMaterial()\n{\n    czm_modelMaterial material;\n    material.diffuse = vec3(0.0);\n    material.specular = vec3(1.0);\n    material.roughness = 1.0;\n    material.occlusion = 1.0;\n    material.normalEC = vec3(0.0, 0.0, 1.0);\n    material.emissive = vec3(0.0);\n    material.alpha = 1.0;\n    return material;\n}\n\nvec4 handleAlpha(vec3 color, float alpha)\n{\n    #ifdef ALPHA_MODE_MASK\n    if (alpha < u_alphaCutoff) {\n        discard;\n    }\n    #endif\n\n    return vec4(color, alpha);\n}\n\nSelectedFeature selectedFeature;\n\nvoid main()\n{\n    #ifdef HAS_MODEL_SPLITTER\n    modelSplitterStage();\n    #endif\n\n    czm_modelMaterial material = defaultModelMaterial();\n\n    ProcessedAttributes attributes;\n    geometryStage(attributes);\n\n    FeatureIds featureIds;\n    featureIdStage(featureIds, attributes);\n\n    Metadata metadata;\n    MetadataClass metadataClass;\n    MetadataStatistics metadataStatistics;\n    metadataStage(metadata, metadataClass, metadataStatistics, attributes);\n\n    #ifdef HAS_SELECTED_FEATURE_ID\n    selectedFeatureIdStage(selectedFeature, featureIds);\n    #endif\n\n    #ifndef CUSTOM_SHADER_REPLACE_MATERIAL\n    materialStage(material, attributes, selectedFeature);\n    #endif\n\n    #ifdef HAS_CUSTOM_FRAGMENT_SHADER\n    customShaderStage(material, attributes, featureIds, metadata, metadataClass, metadataStatistics);\n    #endif\n\n    lightingStage(material, attributes);\n\n    #ifdef HAS_SELECTED_FEATURE_ID\n    cpuStylingStage(material, selectedFeature);\n    #endif\n\n    #ifdef HAS_MODEL_COLOR\n    modelColorStage(material);\n    #endif\n\n    #ifdef HAS_PRIMITIVE_OUTLINE\n    primitiveOutlineStage(material);\n    #endif\n\n    vec4 color = handleAlpha(material.diffuse, material.alpha);\n\n    #ifdef HAS_CLIPPING_PLANES\n    modelClippingPlanesStage(color);\n    #endif\n\n    #if defined(HAS_SILHOUETTE) && defined(HAS_NORMALS)\n    silhouetteStage(color);\n    #endif\n\n    out_FragColor = color;\n}\n",w2="precision highp float;\n\nczm_modelVertexOutput defaultVertexOutput(vec3 positionMC) {\n    czm_modelVertexOutput vsOutput;\n    vsOutput.positionMC = positionMC;\n    vsOutput.pointSize = 1.0;\n    return vsOutput;\n}\n\nvoid main() \n{\n    // Initialize the attributes struct with all\n    // attributes except quantized ones.\n    ProcessedAttributes attributes;\n    initializeAttributes(attributes);\n\n    // Dequantize the quantized ones and add them to the\n    // attributes struct.\n    #ifdef USE_DEQUANTIZATION\n    dequantizationStage(attributes);\n    #endif\n\n    #ifdef HAS_MORPH_TARGETS\n    morphTargetsStage(attributes);\n    #endif\n\n    #ifdef HAS_SKINNING\n    skinningStage(attributes);\n    #endif\n\n    #ifdef HAS_PRIMITIVE_OUTLINE\n    primitiveOutlineStage();\n    #endif\n\n    // Compute the bitangent according to the formula in the glTF spec.\n    // Normal and tangents can be affected by morphing and skinning, so\n    // the bitangent should not be computed until their values are finalized.\n    #ifdef HAS_BITANGENTS\n    attributes.bitangentMC = normalize(cross(attributes.normalMC, attributes.tangentMC) * attributes.tangentSignMC);\n    #endif\n\n    FeatureIds featureIds;\n    featureIdStage(featureIds, attributes);\n\n    #ifdef HAS_SELECTED_FEATURE_ID\n    SelectedFeature feature;\n    selectedFeatureIdStage(feature, featureIds);\n    // Handle any show properties that come from the style.\n    cpuStylingStage(attributes.positionMC, feature);\n    #endif\n\n    #if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)\n    // The scene mode 2D pipeline stage and instancing stage add a different\n    // model view matrix to accurately project the model to 2D. However, the\n    // output positions and normals should be transformed by the 3D matrices\n    // to keep the data the same for the fragment shader.\n    mat4 modelView = czm_modelView3D;\n    mat3 normal = czm_normal3D;\n    #else\n    // These are used for individual model projection because they will\n    // automatically change based on the scene mode.\n    mat4 modelView = czm_modelView;\n    mat3 normal = czm_normal;\n    #endif\n\n    // Update the position for this instance in place\n    #ifdef HAS_INSTANCING\n\n        // The legacy instance stage is used when rendering i3dm models that \n        // encode instances transforms in world space, as opposed to glTF models\n        // that use EXT_mesh_gpu_instancing, where instance transforms are encoded\n        // in object space.\n        #ifdef USE_LEGACY_INSTANCING\n        mat4 instanceModelView;\n        mat3 instanceModelViewInverseTranspose;\n        \n        legacyInstancingStage(attributes, instanceModelView, instanceModelViewInverseTranspose);\n\n        modelView = instanceModelView;\n        normal = instanceModelViewInverseTranspose;\n        #else\n        instancingStage(attributes);\n        #endif\n\n        #ifdef USE_PICKING\n        v_pickColor = a_pickColor;\n        #endif\n\n    #endif\n\n    Metadata metadata;\n    MetadataClass metadataClass;\n    MetadataStatistics metadataStatistics;\n    metadataStage(metadata, metadataClass, metadataStatistics, attributes);\n\n    #ifdef HAS_CUSTOM_VERTEX_SHADER\n    czm_modelVertexOutput vsOutput = defaultVertexOutput(attributes.positionMC);\n    customShaderStage(vsOutput, attributes, featureIds, metadata, metadataClass, metadataStatistics);\n    #endif\n\n    // Compute the final position in each coordinate system needed.\n    // This returns the value that will be assigned to gl_Position.\n    vec4 positionClip = geometryStage(attributes, modelView, normal);    \n\n    #ifdef HAS_SILHOUETTE\n    silhouetteStage(attributes, positionClip);\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_SHOW_STYLE\n    float show = pointCloudShowStylingStage(attributes, metadata);\n    #else\n    float show = 1.0;\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING\n    show *= pointCloudBackFaceCullingStage();\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_COLOR_STYLE\n    v_pointCloudColor = pointCloudColorStylingStage(attributes, metadata);\n    #endif\n\n    #ifdef PRIMITIVE_TYPE_POINTS\n        #ifdef HAS_CUSTOM_VERTEX_SHADER\n        gl_PointSize = vsOutput.pointSize;\n        #elif defined(HAS_POINT_CLOUD_POINT_SIZE_STYLE) || defined(HAS_POINT_CLOUD_ATTENUATION)\n        gl_PointSize = pointCloudPointSizeStylingStage(attributes, metadata);\n        #else\n        gl_PointSize = 1.0;\n        #endif\n\n        gl_PointSize *= show;\n    #endif\n\n    gl_Position = show * positionClip;\n}\n";function B9(e){let t=(e=y(e,y.EMPTY_OBJECT)).command,i=e.primitiveRenderResources,n=i.model;this._command=t,this._model=n,this._runtimePrimitive=i.runtimePrimitive,this._modelMatrix=t.modelMatrix,this._boundingVolume=t.boundingVolume,this._cullFace=t.renderState.cull.face;let r=n.classificationType;this._classificationType=r,this._classifiesTerrain=r!==zn.CESIUM_3D_TILE,this._classifies3DTiles=r!==zn.TERRAIN,this._useDebugWireframe=n._enableDebugWireframe&&n.debugWireframe,this._pickId=i.pickId,this._commandListTerrain=[],this._commandList3DTiles=[],this._commandListIgnoreShow=[],this._commandListDebugWireframe=[],this._commandListTerrainPicking=[],this._commandList3DTilesPicking=[],b5e(this)}function g5e(e){return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:e,frontOperation:{fail:ft.KEEP,zFail:ft.DECREMENT_WRAP,zPass:ft.KEEP},backFunction:e,backOperation:{fail:ft.KEEP,zFail:ft.INCREMENT_WRAP,zPass:ft.KEEP},reference:Lt.CESIUM_3D_TILE_MASK,mask:Lt.CESIUM_3D_TILE_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:yc.LESS_OR_EQUAL},depthMask:!1}}var y5e={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Lt.CLASSIFICATION_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND},x5e={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Lt.CLASSIFICATION_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1},sae=[];function b5e(e){let t=e._command,i=sae;if(e._useDebugWireframe){t.pass=Ee.OPAQUE,i.length=0,i.push(t),e._commandListDebugWireframe=Hw(e,i,e._commandListDebugWireframe);let n=e._commandListDebugWireframe,r=n.length;for(let e=0;e<r;e++){let t=n[e];t.count*=2,t.offset*=2}return}let n=e.model.allowPicking;if(e._classifiesTerrain){let r=Ee.TERRAIN_CLASSIFICATION,o=F9(t,r),a=oae(t,r);i.length=0,i.push(o,a),e._commandListTerrain=Hw(e,i,e._commandListTerrain),n&&(e._commandListTerrainPicking=rae(e,i,e._commandListTerrainPicking))}if(e._classifies3DTiles){let r=Ee.CESIUM_3D_TILE_CLASSIFICATION,o=F9(t,r),a=oae(t,r);i.length=0,i.push(o,a),e._commandList3DTiles=Hw(e,i,e._commandList3DTiles),n&&(e._commandList3DTilesPicking=rae(e,i,e._commandList3DTilesPicking))}}function Hw(e,t,i){let n=e._runtimePrimitive,r=n.batchLengths,o=n.batchOffsets,a=r.length,s=t.length;for(let e=0;e<a;e++){let n=r[e],a=o[e];for(let e=0;e<s;e++){let r=t[e],o=et.shallowClone(r);o.count=n,o.offset=a,i.push(o)}}return i}function F9(e,t){let i=et.shallowClone(e);i.cull=!1,i.pass=t;let n=g5e(t===Ee.TERRAIN_CLASSIFICATION?Un.ALWAYS:Un.EQUAL);return i.renderState=Ue.fromCache(n),i}function oae(e,t){let i=et.shallowClone(e);return i.cull=!1,i.pass=t,i.renderState=Ue.fromCache(y5e),i}var T5e=[];function rae(e,t,i){let n=Ue.fromCache(x5e),r=t[0],o=t[1],a=et.shallowClone(r);a.cull=!0,a.pickOnly=!0;let s=et.shallowClone(o);s.cull=!0,s.pickOnly=!0,s.renderState=n,s.pickId=e._pickId;let l=T5e;return l.length=0,l.push(a,s),Hw(e,l,i)}Object.defineProperties(B9.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},batchLengths:{get:function(){return this._runtimePrimitive.batchLengths}},batchOffsets:{get:function(){return this._runtimePrimitive.batchOffsets}},model:{get:function(){return this._model}},classificationType:{get:function(){return this._classificationType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=L.clone(e,this._modelMatrix);let t=this._runtimePrimitive.boundingSphere;this._boundingVolume=se.transform(t,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace=e}}}),B9.prototype.pushCommands=function(e,t){let i=e.passes;if(i.render){if(this._useDebugWireframe)return void t.push.apply(t,this._commandListDebugWireframe);if(this._classifiesTerrain&&t.push.apply(t,this._commandListTerrain),this._classifies3DTiles&&t.push.apply(t,this._commandList3DTiles),e.invertClassification&&this._classifies3DTiles){if(0===this._commandListIgnoreShow.length){let e=Ee.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,t=F9(this._command,e),i=sae;i.length=0,i.push(t),this._commandListIgnoreShow=Hw(this,i,this._commandListIgnoreShow)}t.push.apply(t,this._commandListIgnoreShow)}}return i.pick&&(this._classifiesTerrain&&t.push.apply(t,this._commandListTerrainPicking),this._classifies3DTiles&&t.push.apply(t,this._commandList3DTilesPicking)),t};var v2=B9;function D2(e){let t=(e=y(e,y.EMPTY_OBJECT)).command,i=e.primitiveRenderResources,n=i.model;this._model=n;let r=i.runtimePrimitive;this._runtimePrimitive=r;let o=t.pass===Ee.TRANSLUCENT,a=!r.primitive.material.doubleSided&&!o,s=i.hasSilhouette,l=!o&&!s,u=i.hasSkipLevelOfDetail&&!o,c=s;this._command=t,this._modelMatrix=L.clone(t.modelMatrix),this._boundingVolume=se.clone(t.boundingVolume),this._modelMatrix2D=new L,this._boundingVolume2D=new se,this._modelMatrix2DDirty=!1,this._backFaceCulling=t.renderState.cull.enabled,this._cullFace=t.renderState.cull.face,this._shadows=n.shadows,this._debugShowBoundingVolume=t.debugShowBoundingVolume,this._usesBackFaceCulling=a,this._needsTranslucentCommand=l,this._needsSkipLevelOfDetailCommands=u,this._needsSilhouetteCommands=c,this._originalCommand=void 0,this._translucentCommand=void 0,this._skipLodBackfaceCommand=void 0,this._skipLodStencilCommand=void 0,this._silhouetteModelCommand=void 0,this._silhouetteColorCommand=void 0,this._derivedCommands=[],this._has2DCommands=!1,A5e(this)}function _p(e){this.command=e.command,this.updateShadows=e.updateShadows,this.updateBackFaceCulling=e.updateBackFaceCulling,this.updateCullFace=e.updateCullFace,this.updateDebugShowBoundingVolume=e.updateDebugShowBoundingVolume,this.is2D=y(e.is2D,!1),this.derivedCommand2D=void 0}function A5e(e){let t=e._command;t.modelMatrix=e._modelMatrix,t.boundingVolume=e._boundingVolume;let i=e._model,n=e._usesBackFaceCulling,r=e._derivedCommands;e._originalCommand=new _p({command:t,updateShadows:!0,updateBackFaceCulling:n,updateCullFace:n,updateDebugShowBoundingVolume:!0,is2D:!1}),r.push(e._originalCommand),e._needsTranslucentCommand&&(e._translucentCommand=new _p({command:I5e(t),updateShadows:!0,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!0}),r.push(e._translucentCommand)),e._needsSkipLevelOfDetailCommands&&(e._skipLodBackfaceCommand=new _p({command:N5e(t),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:n,updateDebugShowBoundingVolume:!1}),e._skipLodStencilCommand=new _p({command:F5e(t,i),updateShadows:!0,updateBackFaceCulling:n,updateCullFace:n,updateDebugShowBoundingVolume:!0}),r.push(e._skipLodBackfaceCommand),r.push(e._skipLodStencilCommand)),e._needsSilhouetteCommands&&(e._silhouetteModelCommand=new _p({command:P5e(t,i),updateShadows:!0,updateBackFaceCulling:n,updateCullFace:n,updateDebugShowBoundingVolume:!0}),e._silhouetteColorCommand=new _p({command:O5e(t,i),updateShadows:!1,updateBackFaceCulling:!1,updateCullFace:!1,updateDebugShowBoundingVolume:!1}),r.push(e._silhouetteModelCommand),r.push(e._silhouetteColorCommand))}function C5e(e,t){let i=e._modelMatrix;e._modelMatrix2D=L.clone(i,e._modelMatrix2D),e._modelMatrix2D[13]-=2*P.sign(i[13])*P.PI*t.mapProjection.ellipsoid.maximumRadius,e._boundingVolume2D=se.transform(e.runtimePrimitive.boundingSphere,e._modelMatrix2D,e._boundingVolume2D)}function E5e(e){let t=e.shadows,i=yn.castShadows(t),n=yn.receiveShadows(t),r=e._derivedCommands;for(let e=0;e<r.length;++e){let t=r[e];if(t.updateShadows){let e=t.command;e.castShadows=i,e.receiveShadows=n}}}function S5e(e){let t=e.backFaceCulling,i=e._derivedCommands;for(let e=0;e<i.length;++e){let n=i[e];if(n.updateBackFaceCulling){let e=n.command,i=Ge(e.renderState,!0);i.cull.enabled=t,e.renderState=Ue.fromCache(i)}}}function w5e(e){let t=e.cullFace,i=e._derivedCommands;for(let e=0;e<i.length;++e){let n=i[e];if(n.updateCullFace){let e=n.command,i=Ge(e.renderState,!0);i.cull.face=t,e.renderState=Ue.fromCache(i)}}}function v5e(e){let t=e.debugShowBoundingVolume,i=e._derivedCommands;for(let e=0;e<i.length;++e){let n=i[e];if(n.updateDebugShowBoundingVolume){n.command.debugShowBoundingVolume=t}}}function wA(e,t,i){e.push(t.command),i&&e.push(t.derivedCommand2D.command)}function aae(e,t){if(t.mode!==te.SCENE2D||e.model._projectTo2D)return!1;let i=e.model.sceneGraph._boundingSphere2D,n=i.center.y-i.radius,r=i.center.y+i.radius,o=t.mapProjection.ellipsoid.maximumRadius*P.PI;return n<o&&r>o||n<-o&&r>-o}function SA(e,t){if(!u(t))return;let i=_p.clone(t),n=et.shallowClone(t.command);return n.modelMatrix=e._modelMatrix2D,n.boundingVolume=e._boundingVolume2D,i.command=n,i.updateShadows=!1,i.is2D=!0,t.derivedCommand2D=i,e._derivedCommands.push(i),i}function D5e(e){SA(e,e._originalCommand),SA(e,e._translucentCommand),SA(e,e._skipLodBackfaceCommand),SA(e,e._skipLodStencilCommand),SA(e,e._silhouetteModelCommand),SA(e,e._silhouetteColorCommand)}function I5e(e){let t=et.shallowClone(e);t.pass=Ee.TRANSLUCENT;let i=Ge(e.renderState,!0);return i.cull.enabled=!1,i.depthMask=!1,i.blending=ln.ALPHA_BLEND,t.renderState=Ue.fromCache(i),t}function P5e(e,t){let i=t._silhouetteId%255,n=et.shallowClone(e),r=Ge(e.renderState,!0);return r.stencilTest={enabled:!0,frontFunction:ee.ALWAYS,backFunction:ee.ALWAYS,reference:i,mask:-1,frontOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.REPLACE},backOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.REPLACE}},t.isInvisible()&&(r.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),n.renderState=Ue.fromCache(r),n}function O5e(e,t){let i=t._silhouetteId%255,n=et.shallowClone(e),r=Ge(e.renderState,!0);r.cull.enabled=!1,(e.pass===Ee.TRANSLUCENT||t.silhouetteColor.alpha<1)&&(n.pass=Ee.TRANSLUCENT,r.depthMask=!1,r.blending=ln.ALPHA_BLEND),r.stencilTest={enabled:!0,frontFunction:ee.NOTEQUAL,backFunction:ee.NOTEQUAL,reference:i,mask:-1,frontOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.KEEP},backOperation:{fail:ee.KEEP,zFail:ee.KEEP,zPass:ee.KEEP}};let o=Ge(e.uniformMap);return o.model_silhouettePass=function(){return!0},n.renderState=Ue.fromCache(r),n.uniformMap=o,n.castShadows=!1,n.receiveShadows=!1,n}function R5e(e,t,i){let n=e._skipLodStencilCommand,r=n.command,o=t._selectionDepth;if(o!==M5e(r)){let e=L5e(o),t=Ge(r.renderState,!0);t.stencilTest.reference=e,r.renderState=Ue.fromCache(t),i&&(n.derivedCommand2D.renderState=t)}}function M5e(e){return(e.renderState.stencilTest.reference&Lt.SKIP_LOD_MASK)>>>Lt.SKIP_LOD_BIT_SHIFT}function L5e(e){return Lt.CESIUM_3D_TILE_MASK|e<<Lt.SKIP_LOD_BIT_SHIFT}function N5e(e){let t=et.shallowClone(e),i=Ge(e.renderState,!0);i.cull.enabled=!0,i.cull.face=gi.FRONT,i.colorMask={red:!1,green:!1,blue:!1,alpha:!1},i.polygonOffset={enabled:!0,factor:5,units:5};let n=Ge(t.uniformMap),r=new U(5,5);return n.u_polygonOffset=function(){return r},t.renderState=Ue.fromCache(i),t.uniformMap=n,t.castShadows=!1,t.receiveShadows=!1,t}function F5e(e){let t=et.shallowClone(e),i=Ge(e.renderState,!0),{stencilTest:n}=i;return n.enabled=!0,n.mask=Lt.SKIP_LOD_MASK,n.reference=Lt.CESIUM_3D_TILE_MASK,n.frontFunction=Un.GREATER_OR_EQUAL,n.frontOperation.zPass=ft.REPLACE,n.backFunction=Un.GREATER_OR_EQUAL,n.backOperation.zPass=ft.REPLACE,i.stencilMask=Lt.CESIUM_3D_TILE_MASK|Lt.SKIP_LOD_MASK,t.renderState=Ue.fromCache(i),t}_p.clone=function(e){return new _p({command:e.command,updateShadows:e.updateShadows,updateBackFaceCulling:e.updateBackFaceCulling,updateCullFace:e.updateCullFace,updateDebugShowBoundingVolume:e.updateDebugShowBoundingVolume,is2D:e.is2D,derivedCommand2D:e.derivedCommand2D})},Object.defineProperties(D2.prototype,{command:{get:function(){return this._command}},runtimePrimitive:{get:function(){return this._runtimePrimitive}},model:{get:function(){return this._model}},primitiveType:{get:function(){return this._command.primitiveType}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=L.clone(e,this._modelMatrix),this._modelMatrix2DDirty=!0,this._boundingVolume=se.transform(this.runtimePrimitive.boundingSphere,this._modelMatrix,this._boundingVolume)}},boundingVolume:{get:function(){return this._boundingVolume}},shadows:{get:function(){return this._shadows},set:function(e){this._shadows=e,E5e(this)}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,S5e(this))}},cullFace:{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,w5e(this))}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,v5e(this))}}}),D2.prototype.pushCommands=function(e,t){let i=aae(this,e);i&&!this._has2DCommands&&(D5e(this),this._has2DCommands=!0,this._modelMatrix2DDirty=!0),this._modelMatrix2DDirty&&(C5e(this,e),this._modelMatrix2DDirty=!1);let n=this.model.styleCommandsNeeded;if(!this._needsTranslucentCommand||!u(n)||(n!==Uh.ALL_OPAQUE&&wA(t,this._translucentCommand,i),n!==Uh.ALL_TRANSLUCENT)){if(this._needsSkipLevelOfDetailCommands){let{tileset:e,tile:n}=this._model.content;if(e.hasMixedContent)return n._finalResolution||wA(e._backfaceCommands,this._skipLodBackfaceCommand,i),R5e(this,n,i),void wA(t,this._skipLodStencilCommand,i)}return this._needsSilhouetteCommands?void wA(t,this._silhouetteModelCommand,i):(wA(t,this._originalCommand,i),t)}},D2.prototype.pushSilhouetteCommands=function(e,t){let i=aae(this,e);return wA(t,this._silhouetteColorCommand,i),t};var I2=D2;function B5e(e,t){let i=e.shaderBuilder;i.addVertexLines(w2),i.addFragmentLines(S2);let n=k5e(e),r=new ni({context:t.context,indexBuffer:n,attributes:e.attributes}),o=e.model;o._pipelineResources.push(r);let a=i.buildShaderProgram(t.context);o._pipelineResources.push(a);let s,l,c=e.alphaOptions.pass,h=o.sceneGraph,d=t.mode===te.SCENE3D;if(d||t.scene3DOnly||!o._projectTo2D){let t=d?h._computedModelMatrix:h._computedModelMatrix2D;s=L.multiplyTransformation(t,e.runtimeNode.computedTransform,new L),l=se.transform(e.boundingSphere,s,e.boundingSphere)}else s=L.multiplyTransformation(h._computedModelMatrix,e.runtimeNode.computedTransform,new L),l=e.runtimePrimitive.boundingSphere2D;let p=Ge(Ue.fromCache(e.renderStateOptions),!0);p.cull.face=en.getCullFace(s,e.primitiveType),p=Ue.fromCache(p);let f=u(o.classificationType),m=!f&&yn.castShadows(o.shadows),_=!f&&yn.receiveShadows(o.shadows),g=f?void 0:e.pickId,y=new et({boundingVolume:l,modelMatrix:s,uniformMap:e.uniformMap,renderState:p,vertexArray:r,shaderProgram:a,cull:o.cull,pass:c,count:e.count,owner:o,pickId:g,instanceCount:e.instanceCount,primitiveType:e.primitiveType,debugShowBoundingVolume:o.debugShowBoundingVolume,castShadows:m,receiveShadows:_});return f?new v2({primitiveRenderResources:e,command:y}):new I2({primitiveRenderResources:e,command:y})}function k5e(e){let t=e.wireframeIndexBuffer;if(u(t))return t;let i=e.indices;return u(i)?i.buffer:void 0}var P2=B5e,cae={name:"TilesetPipelineStage",process:function(e,t,i){if(t.hasSkipLevelOfDetail(i)){e.shaderBuilder.addDefine("POLYGON_OFFSET",void 0,Ce.FRAGMENT);let t={u_polygonOffset:function(){return U.ZERO}};e.uniformMap=gt(t,e.uniformMap),e.hasSkipLevelOfDetail=!0}let n=e.renderStateOptions;n.stencilTest=Lt.setCesium3DTileBit(),n.stencilMask=Lt.CESIUM_3D_TILE_MASK}},O2=cae,R2="vec3 proceduralIBL(\n    vec3 positionEC,\n    vec3 normalEC,\n    vec3 lightDirectionEC,\n    vec3 lightColorHdr,\n    czm_pbrParameters pbrParameters\n) {\n    vec3 v = -positionEC;\n    vec3 positionWC = vec3(czm_inverseView * vec4(positionEC, 1.0));\n    vec3 vWC = -normalize(positionWC);\n    vec3 l = normalize(lightDirectionEC);\n    vec3 n = normalEC;\n    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));\n\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = abs(dot(n, v)) + 0.001;\n\n    // Figure out if the reflection vector hits the ellipsoid\n    float vertexRadius = length(positionWC);\n    float horizonDotNadir = 1.0 - min(1.0, czm_ellipsoidRadii.x / vertexRadius);\n    float reflectionDotNadir = dot(r, normalize(positionWC));\n    // Flipping the X vector is a cheap way to get the inverse of czm_temeToPseudoFixed, since that's a rotation about Z.\n    r.x = -r.x;\n    r = -normalize(czm_temeToPseudoFixed * r);\n    r.x = -r.x;\n\n    vec3 diffuseColor = pbrParameters.diffuseColor;\n    float roughness = pbrParameters.roughness;\n    vec3 specularColor = pbrParameters.f0;\n\n    float inverseRoughness = 1.04 - roughness;\n    inverseRoughness *= inverseRoughness;\n    vec3 sceneSkyBox = czm_textureCube(czm_environmentMap, r).rgb * inverseRoughness;\n\n    float atmosphereHeight = 0.05;\n    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);\n    float blendRegionOffset = roughness * -1.0;\n    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);\n    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);\n    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);\n    vec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);\n    vec3 nadirColor = belowHorizonColor * 0.5;\n    vec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);\n    vec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);\n    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);\n    vec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9); \n    float diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;  \n    float diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));\n    vec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);\n    float notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);\n    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);\n    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);\n    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);\n\n    // Luminance model from page 40 of http://silviojemma.com/public/papers/lighting/spherical-harmonic-lighting.pdf\n    #ifdef USE_SUN_LUMINANCE \n    // Angle between sun and zenith\n    float LdotZenith = clamp(dot(normalize(czm_inverseViewRotation * l), vWC), 0.001, 1.0);\n    float S = acos(LdotZenith);\n    // Angle between zenith and current pixel\n    float NdotZenith = clamp(dot(normalize(czm_inverseViewRotation * n), vWC), 0.001, 1.0);\n    // Angle between sun and current pixel\n    float gamma = acos(NdotL);\n    float numerator = ((0.91 + 10.0 * exp(-3.0 * gamma) + 0.45 * pow(NdotL, 2.0)) * (1.0 - exp(-0.32 / NdotZenith)));\n    float denominator = (0.91 + 10.0 * exp(-3.0 * S) + 0.45 * pow(LdotZenith,2.0)) * (1.0 - exp(-0.32));\n    float luminance = model_luminanceAtZenith * (numerator / denominator);\n    #endif \n\n    vec2 brdfLut = texture(czm_brdfLut, vec2(NdotV, roughness)).rg;\n    vec3 iblColor = (diffuseIrradiance * diffuseColor * model_iblFactor.x) + (specularIrradiance * czm_srgbToLinear(specularColor * brdfLut.x + brdfLut.y) * model_iblFactor.y);\n    float maximumComponent = max(max(lightColorHdr.x, lightColorHdr.y), lightColorHdr.z);\n    vec3 lightColor = lightColorHdr / max(maximumComponent, 1.0);\n    iblColor *= lightColor;\n\n    #ifdef USE_SUN_LUMINANCE \n    iblColor *= luminance;\n    #endif\n\n    return iblColor;\n}\n\n#if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)\nvec3 textureIBL(\n    vec3 positionEC,\n    vec3 normalEC,\n    vec3 lightDirectionEC,\n    czm_pbrParameters pbrParameters\n) {\n    vec3 diffuseColor = pbrParameters.diffuseColor;\n    float roughness = pbrParameters.roughness;\n    vec3 specularColor = pbrParameters.f0;\n\n    vec3 v = -positionEC;\n    vec3 n = normalEC;\n    vec3 l = normalize(lightDirectionEC);\n    vec3 h = normalize(v + l);\n\n    float NdotV = abs(dot(n, v)) + 0.001;\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    const mat3 yUpToZUp = mat3(\n        -1.0, 0.0, 0.0,\n        0.0, 0.0, -1.0, \n        0.0, 1.0, 0.0\n    ); \n    vec3 cubeDir = normalize(yUpToZUp * model_iblReferenceFrameMatrix * normalize(reflect(-v, n))); \n\n    #ifdef DIFFUSE_IBL \n        #ifdef CUSTOM_SPHERICAL_HARMONICS\n        vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, model_sphericalHarmonicCoefficients); \n        #else\n        vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients); \n        #endif \n    #else \n    vec3 diffuseIrradiance = vec3(0.0); \n    #endif \n\n    #ifdef SPECULAR_IBL\n    vec3 r0 = specularColor.rgb;\n    float reflectance = max(max(r0.r, r0.g), r0.b);\n    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\n    vec3 F = fresnelSchlick2(r0, r90, VdotH);\n    \n    vec2 brdfLut = texture(czm_brdfLut, vec2(NdotV, roughness)).rg;\n      #ifdef CUSTOM_SPECULAR_IBL \n      vec3 specularIBL = czm_sampleOctahedralProjection(model_specularEnvironmentMaps, model_specularEnvironmentMapsSize, cubeDir, roughness * model_specularEnvironmentMapsMaximumLOD, model_specularEnvironmentMapsMaximumLOD);\n      #else \n      vec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);\n      #endif \n    specularIBL *= F * brdfLut.x + brdfLut.y;\n    #else \n    vec3 specularIBL = vec3(0.0); \n    #endif\n\n    return diffuseColor * diffuseIrradiance + specularColor * specularIBL;\n}\n#endif\n\nvec3 imageBasedLightingStage(\n    vec3 positionEC,\n    vec3 normalEC,\n    vec3 lightDirectionEC,\n    vec3 lightColorHdr,\n    czm_pbrParameters pbrParameters\n) {\n  #if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)\n  // Environment maps were provided, use them for IBL\n  return textureIBL(\n      positionEC,\n      normalEC,\n      lightDirectionEC,\n      pbrParameters\n  );\n  #else\n  // Use the procedural IBL if there are no environment maps\n  return proceduralIBL(\n      positionEC,\n      normalEC,\n      lightDirectionEC,\n      lightColorHdr,\n      pbrParameters\n  );\n  #endif\n}",lae={name:"ImageBasedLightingPipelineStage",process:function(e,t,i){let n=t.imageBasedLighting,r=e.shaderBuilder;r.addDefine("USE_IBL_LIGHTING",void 0,Ce.FRAGMENT),r.addUniform("vec2","model_iblFactor",Ce.FRAGMENT),Bh.isSupported(i.context)&&((n.useSphericalHarmonics||n.useSpecularEnvironmentMaps||n.enabled)&&r.addUniform("mat3","model_iblReferenceFrameMatrix",Ce.FRAGMENT),u(n.sphericalHarmonicCoefficients)?(r.addDefine("DIFFUSE_IBL",void 0,Ce.FRAGMENT),r.addDefine("CUSTOM_SPHERICAL_HARMONICS",void 0,Ce.FRAGMENT),r.addUniform("vec3","model_sphericalHarmonicCoefficients[9]",Ce.FRAGMENT)):n.useDefaultSphericalHarmonics&&r.addDefine("DIFFUSE_IBL",void 0,Ce.FRAGMENT),u(n.specularEnvironmentMapAtlas)&&n.specularEnvironmentMapAtlas.ready?(r.addDefine("SPECULAR_IBL",void 0,Ce.FRAGMENT),r.addDefine("CUSTOM_SPECULAR_IBL",void 0,Ce.FRAGMENT),r.addUniform("sampler2D","model_specularEnvironmentMaps",Ce.FRAGMENT),r.addUniform("vec2","model_specularEnvironmentMapsSize",Ce.FRAGMENT),r.addUniform("float","model_specularEnvironmentMapsMaximumLOD",Ce.FRAGMENT)):t.useDefaultSpecularMaps&&r.addDefine("SPECULAR_IBL",void 0,Ce.FRAGMENT)),u(n.luminanceAtZenith)&&(r.addDefine("USE_SUN_LUMINANCE",void 0,Ce.FRAGMENT),r.addUniform("float","model_luminanceAtZenith",Ce.FRAGMENT)),r.addFragmentLines(R2);let o={model_iblFactor:function(){return n.imageBasedLightingFactor},model_iblReferenceFrameMatrix:function(){return t._iblReferenceFrameMatrix},model_luminanceAtZenith:function(){return n.luminanceAtZenith},model_sphericalHarmonicCoefficients:function(){return n.sphericalHarmonicCoefficients},model_specularEnvironmentMaps:function(){return n.specularEnvironmentMapAtlas.texture},model_specularEnvironmentMapsSize:function(){return n.specularEnvironmentMapAtlas.texture.dimensions},model_specularEnvironmentMapsMaximumLOD:function(){return n.specularEnvironmentMapAtlas.maximumMipmapLevel}};e.uniformMap=gt(o,e.uniformMap)}},M2=lae,V5e=P.EPSILON16;function V9(e){let t=(e=y(e,y.EMPTY_OBJECT)).stage,i=e.runtimeArticulation;this._stage=t,this._runtimeArticulation=i,this._name=t.name,this._type=t.type,this._minimumValue=t.minimumValue,this._maximumValue=t.maximumValue,this._currentValue=t.initialValue}Object.defineProperties(V9.prototype,{stage:{get:function(){return this._stage}},runtimeArticulation:{get:function(){return this._runtimeArticulation}},name:{get:function(){return this._name}},type:{get:function(){return this._type}},minimumValue:{get:function(){return this._minimumValue}},maximumValue:{get:function(){return this._maximumValue}},currentValue:{get:function(){return this._currentValue},set:function(e){e=P.clamp(e,this.minimumValue,this.maximumValue),P.equalsEpsilon(this._currentValue,e,V5e)||(this._currentValue=e,this.runtimeArticulation._dirty=!0)}}});var U5e=new h,k9=new $;V9.prototype.applyStageToMatrix=function(e){let t,i=this.type,n=this.currentValue,r=U5e;switch(i){case cc.XROTATE:t=$.fromRotationX(P.toRadians(n),k9),e=L.multiplyByMatrix3(e,t,e);break;case cc.YROTATE:t=$.fromRotationY(P.toRadians(n),k9),e=L.multiplyByMatrix3(e,t,e);break;case cc.ZROTATE:t=$.fromRotationZ(P.toRadians(n),k9),e=L.multiplyByMatrix3(e,t,e);break;case cc.XTRANSLATE:r.x=n,r.y=0,r.z=0,e=L.multiplyByTranslation(e,r,e);break;case cc.YTRANSLATE:r.x=0,r.y=n,r.z=0,e=L.multiplyByTranslation(e,r,e);break;case cc.ZTRANSLATE:r.x=0,r.y=0,r.z=n,e=L.multiplyByTranslation(e,r,e);break;case cc.XSCALE:r.x=n,r.y=1,r.z=1,e=L.multiplyByScale(e,r,e);break;case cc.YSCALE:r.x=1,r.y=n,r.z=1,e=L.multiplyByScale(e,r,e);break;case cc.ZSCALE:r.x=1,r.y=1,r.z=n,e=L.multiplyByScale(e,r,e);break;case cc.UNIFORMSCALE:e=L.multiplyByUniformScale(e,n,e)}return e};var L2=V9;function N2(e){let t=(e=y(e,y.EMPTY_OBJECT)).articulation,i=e.sceneGraph;this._articulation=t,this._sceneGraph=i,this._name=t.name,this._runtimeStages=[],this._runtimeStagesByName={},this._runtimeNodes=[],this._dirty=!0,z5e(this)}function z5e(e){let t=e.articulation.stages,i=t.length,n=e._runtimeStages,r=e._runtimeStagesByName;for(let o=0;o<i;o++){let i=t[o],a=new L2({stage:i,runtimeArticulation:e});n.push(a),r[i.name]=a}}Object.defineProperties(N2.prototype,{articulation:{get:function(){return this._articulation}},sceneGraph:{get:function(){return this._sceneGraph}},name:{get:function(){return this._name}},runtimeStages:{get:function(){return this._runtimeStages}},runtimeNodes:{get:function(){return this._runtimeNodes}}}),N2.prototype.setArticulationStage=function(e,t){let i=this._runtimeStagesByName[e];u(i)&&(i.currentValue=t)};var H5e=new L,G5e=new L;N2.prototype.apply=function(){if(!this._dirty)return;this._dirty=!1;let e,t=L.clone(L.IDENTITY,H5e),i=this._runtimeStages,n=i.length;for(e=0;e<n;e++)t=i[e].applyStageToMatrix(t);let r=this._runtimeNodes,o=r.length;for(e=0;e<o;e++){let i=r[e],n=L.multiplyTransformation(i.originalTransform,t,G5e);i.transform=n}};var F2=N2,B2="void modelColorStage(inout czm_modelMaterial material)\n{\n    material.diffuse = mix(material.diffuse, model_color.rgb, model_colorBlend);\n    float highlight = ceil(model_colorBlend);\n    material.diffuse *= mix(model_color.rgb, vec3(1.0), highlight);\n    material.alpha *= model_color.a;\n}",vA={name:"ModelColorPipelineStage",COLOR_UNIFORM_NAME:"model_color",COLOR_BLEND_UNIFORM_NAME:"model_colorBlend",process:function(e,t,i){let n=e.shaderBuilder;n.addDefine("HAS_MODEL_COLOR",void 0,Ce.FRAGMENT),n.addFragmentLines(B2);let r={},o=t.color;0===o.alpha&&!t.hasSilhouette(i)&&(e.renderStateOptions.colorMask={red:!1,green:!1,blue:!1,alpha:!1}),o.alpha<1&&(e.alphaOptions.pass=Ee.TRANSLUCENT),n.addUniform("vec4",vA.COLOR_UNIFORM_NAME,Ce.FRAGMENT),r[vA.COLOR_UNIFORM_NAME]=function(){return t.color},n.addUniform("float",vA.COLOR_BLEND_UNIFORM_NAME,Ce.FRAGMENT),r[vA.COLOR_BLEND_UNIFORM_NAME]=function(){return xc.getColorBlend(t.colorBlendMode,t.colorBlendAmount)},e.uniformMap=gt(r,e.uniformMap)}},Q0=vA,k2="#ifdef USE_CLIPPING_PLANES_FLOAT_TEXTURE\nvec4 getClippingPlane(\n    highp sampler2D packedClippingPlanes,\n    int clippingPlaneNumber,\n    mat4 transform\n) {\n    int pixY = clippingPlaneNumber / CLIPPING_PLANES_TEXTURE_WIDTH;\n    int pixX = clippingPlaneNumber - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);\n    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel\n    float v = (float(pixY) + 0.5) * pixelHeight;\n    vec4 plane = texture(packedClippingPlanes, vec2(u, v));\n    return czm_transformPlane(plane, transform);\n}\n#else\n// Handle uint8 clipping texture instead\nvec4 getClippingPlane(\n    highp sampler2D packedClippingPlanes,\n    int clippingPlaneNumber,\n    mat4 transform\n) {\n    int clippingPlaneStartIndex = clippingPlaneNumber * 2; // clipping planes are two pixels each\n    int pixY = clippingPlaneStartIndex / CLIPPING_PLANES_TEXTURE_WIDTH;\n    int pixX = clippingPlaneStartIndex - (pixY * CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelWidth = 1.0 / float(CLIPPING_PLANES_TEXTURE_WIDTH);\n    float pixelHeight = 1.0 / float(CLIPPING_PLANES_TEXTURE_HEIGHT);\n    float u = (float(pixX) + 0.5) * pixelWidth; // sample from center of pixel\n    float v = (float(pixY) + 0.5) * pixelHeight;\n    vec4 oct32 = texture(packedClippingPlanes, vec2(u, v)) * 255.0;\n    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);\n    vec4 plane;\n    plane.xyz = czm_octDecode(oct, 65535.0);\n    plane.w = czm_unpackFloat(texture(packedClippingPlanes, vec2(u + pixelWidth, v)));\n    return czm_transformPlane(plane, transform);\n}\n#endif\n\nfloat clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix) {\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float pixelWidth = czm_metersPerPixel(position);\n    \n    #ifdef UNION_CLIPPING_REGIONS\n    float clipAmount; // For union planes, we want to get the min distance. So we set the initial value to the first plane distance in the loop below.\n    #else\n    float clipAmount = 0.0;\n    bool clipped = true;\n    #endif\n\n    for (int i = 0; i < CLIPPING_PLANES_LENGTH; ++i) {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        \n        #ifdef UNION_CLIPPING_REGIONS\n        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));\n        if (amount <= 0.0) {\n            discard;\n        }\n        #else\n        clipAmount = max(amount, clipAmount);\n        clipped = clipped && (amount <= 0.0);\n        #endif\n    }\n\n    #ifndef UNION_CLIPPING_REGIONS\n    if (clipped) {\n        discard;\n    }\n    #endif\n    \n    return clipAmount;\n}\n\nvoid modelClippingPlanesStage(inout vec4 color)\n{\n    float clipDistance = clip(gl_FragCoord, model_clippingPlanes, model_clippingPlanesMatrix);\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = model_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = model_clippingPlanesEdgeStyle.a;\n    \n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) {\n        color = clippingPlanesEdgeColor;\n    }\n}\n",uae={name:"ModelClippingPlanesPipelineStage"},W5e=new U;uae.process=function(e,t,i){let n=t.clippingPlanes,r=i.context,o=e.shaderBuilder;o.addDefine("HAS_CLIPPING_PLANES",void 0,Ce.FRAGMENT),o.addDefine("CLIPPING_PLANES_LENGTH",n.length,Ce.FRAGMENT),n.unionClippingRegions&&o.addDefine("UNION_CLIPPING_REGIONS",void 0,Ce.FRAGMENT),ys.useFloatTexture(r)&&o.addDefine("USE_CLIPPING_PLANES_FLOAT_TEXTURE",void 0,Ce.FRAGMENT);let a=ys.getTextureResolution(n,r,W5e);o.addDefine("CLIPPING_PLANES_TEXTURE_WIDTH",a.x,Ce.FRAGMENT),o.addDefine("CLIPPING_PLANES_TEXTURE_HEIGHT",a.y,Ce.FRAGMENT),o.addUniform("sampler2D","model_clippingPlanes",Ce.FRAGMENT),o.addUniform("vec4","model_clippingPlanesEdgeStyle",Ce.FRAGMENT),o.addUniform("mat4","model_clippingPlanesMatrix",Ce.FRAGMENT),o.addFragmentLines(k2);let s={model_clippingPlanes:function(){return n.texture},model_clippingPlanesEdgeStyle:function(){let e=z.clone(n.edgeColor);return e.alpha=n.edgeWidth,e},model_clippingPlanesMatrix:function(){return t._clippingPlanesMatrix}};e.uniformMap=gt(s,e.uniformMap)};var V2=uae;function fae(e,t){this._model=e,this._runtimeNode=t}Object.defineProperties(fae.prototype,{name:{get:function(){return this._runtimeNode._name}},id:{get:function(){return this._runtimeNode._id}},show:{get:function(){return this._runtimeNode.show},set:function(e){this._runtimeNode.show=e}},matrix:{get:function(){return this._runtimeNode.transform},set:function(e){u(e)?(this._runtimeNode.transform=e,this._runtimeNode.userAnimated=!0,this._model._userAnimationDirty=!0):(this._runtimeNode.transform=this.originalMatrix,this._runtimeNode.userAnimated=!1)}},originalMatrix:{get:function(){return this._runtimeNode.originalTransform}}});var U2=fae,z2="mat4 getInstancingTransform()\n{\n    mat4 instancingTransform;\n\n    #ifdef HAS_INSTANCE_MATRICES\n    instancingTransform = mat4(\n        a_instancingTransformRow0.x, a_instancingTransformRow1.x, a_instancingTransformRow2.x, 0.0, // Column 1\n        a_instancingTransformRow0.y, a_instancingTransformRow1.y, a_instancingTransformRow2.y, 0.0, // Column 2\n        a_instancingTransformRow0.z, a_instancingTransformRow1.z, a_instancingTransformRow2.z, 0.0, // Column 3\n        a_instancingTransformRow0.w, a_instancingTransformRow1.w, a_instancingTransformRow2.w, 1.0  // Column 4\n    );\n    #else\n    vec3 translation = vec3(0.0, 0.0, 0.0);\n    vec3 scale = vec3(1.0, 1.0, 1.0);\n    \n        #ifdef HAS_INSTANCE_TRANSLATION\n        translation = a_instanceTranslation;\n        #endif\n        #ifdef HAS_INSTANCE_SCALE\n        scale = a_instanceScale;\n        #endif\n\n    instancingTransform = mat4(\n        scale.x, 0.0, 0.0, 0.0,\n        0.0, scale.y, 0.0, 0.0,\n        0.0, 0.0, scale.z, 0.0,\n        translation.x, translation.y, translation.z, 1.0\n    ); \n    #endif\n\n    return instancingTransform;\n}\n\n#ifdef USE_2D_INSTANCING\nmat4 getInstancingTransform2D()\n{\n    mat4 instancingTransform2D;\n\n    #ifdef HAS_INSTANCE_MATRICES\n    instancingTransform2D = mat4(\n        a_instancingTransform2DRow0.x, a_instancingTransform2DRow1.x, a_instancingTransform2DRow2.x, 0.0, // Column 1\n        a_instancingTransform2DRow0.y, a_instancingTransform2DRow1.y, a_instancingTransform2DRow2.y, 0.0, // Column 2\n        a_instancingTransform2DRow0.z, a_instancingTransform2DRow1.z, a_instancingTransform2DRow2.z, 0.0, // Column 3\n        a_instancingTransform2DRow0.w, a_instancingTransform2DRow1.w, a_instancingTransform2DRow2.w, 1.0  // Column 4\n    );\n    #else\n    vec3 translation2D = vec3(0.0, 0.0, 0.0);\n    vec3 scale = vec3(1.0, 1.0, 1.0);\n    \n        #ifdef HAS_INSTANCE_TRANSLATION\n        translation2D = a_instanceTranslation2D;\n        #endif\n        #ifdef HAS_INSTANCE_SCALE\n        scale = a_instanceScale;\n        #endif\n\n    instancingTransform2D = mat4(\n        scale.x, 0.0, 0.0, 0.0,\n        0.0, scale.y, 0.0, 0.0,\n        0.0, 0.0, scale.z, 0.0,\n        translation2D.x, translation2D.y, translation2D.z, 1.0\n    ); \n    #endif\n\n    return instancingTransform2D;\n}\n#endif\n",H2="void instancingStage(inout ProcessedAttributes attributes) \n{\n    vec3 positionMC = attributes.positionMC;\n    \n    mat4 instancingTransform = getInstancingTransform();\n    \n    attributes.positionMC = (instancingTransform * vec4(positionMC, 1.0)).xyz;\n\n    #ifdef HAS_NORMALS\n    vec3 normalMC = attributes.normalMC;\n    attributes.normalMC = (instancingTransform * vec4(normalMC, 0.0)).xyz;\n    #endif\n\n    #ifdef USE_2D_INSTANCING\n    mat4 instancingTransform2D = getInstancingTransform2D();\n    attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;\n    #endif\n}\n",G2="void legacyInstancingStage(\n    inout ProcessedAttributes attributes,\n    out mat4 instanceModelView,\n    out mat3 instanceModelViewInverseTranspose)\n{\n    vec3 positionMC = attributes.positionMC;\n\n    mat4 instancingTransform = getInstancingTransform();\n \n    mat4 instanceModel = instancingTransform * u_instance_nodeTransform;\n    instanceModelView = u_instance_modifiedModelView;\n    instanceModelViewInverseTranspose = mat3(u_instance_modifiedModelView * instanceModel);\n\n    attributes.positionMC = (instanceModel * vec4(positionMC, 1.0)).xyz;\n    \n    #ifdef USE_2D_INSTANCING\n    mat4 instancingTransform2D = getInstancingTransform2D();\n    attributes.position2D = (instancingTransform2D * vec4(positionMC, 1.0)).xyz;\n    #endif\n}\n",W2=new L,j5e=new L,q5e=new L,hae={name:"InstancingPipelineStage",_getInstanceTransformsAsMatrices:yae,_transformsToTypedArray:z9,process:function(e,t,i){let n=t.instances,r=n.attributes[0].count,o=e.shaderBuilder;o.addDefine("HAS_INSTANCING"),o.addVertexLines(z2);let a=e.model,s=a.sceneGraph,l=e.runtimeNode,u=i.mode!==te.SCENE3D&&!i.scene3DOnly&&a._projectTo2D,c=[];aGe(e,i,n,c,u),uGe(e,i,n,c);let h={};if(n.transformInWorldSpace?(o.addDefine("USE_LEGACY_INSTANCING",void 0,Ce.VERTEX),o.addUniform("mat4","u_instance_modifiedModelView",Ce.VERTEX),o.addUniform("mat4","u_instance_nodeTransform",Ce.VERTEX),h.u_instance_modifiedModelView=function(){let e=L.multiplyTransformation(a.modelMatrix,s.components.transform,W2);return u?L.multiplyTransformation(i.context.uniformState.view3D,e,W2):(i.mode!==te.SCENE3D&&(e=Rt.basisTo2D(i.mapProjection,e,W2)),L.multiplyTransformation(i.context.uniformState.view,e,W2))},h.u_instance_nodeTransform=function(){return L.multiplyTransformation(s.axisCorrectionMatrix,l.computedTransform,j5e)},o.addVertexLines(G2)):o.addVertexLines(H2),u){o.addDefine("USE_2D_INSTANCING",void 0,Ce.VERTEX),o.addUniform("mat4","u_modelView2D",Ce.VERTEX);let e=i.context,t=L.fromTranslation(l.instancingReferencePoint2D,new L);h.u_modelView2D=function(){return L.multiplyTransformation(e.uniformState.view,t,q5e)}}e.uniformMap=gt(h,e.uniformMap),e.instanceCount=r,e.attributes.push.apply(e.attributes,c)}},Gw=new L,Y5e=new h;function X5e(e,t,i,n,r){let o=L.multiplyTransformation(t,e,Gw);return o=L.multiplyTransformation(o,i,Gw),r=Rt.basisTo2D(n.mapProjection,o,r)}function K5e(e,t,i,n,r){let o=L.fromTranslation(e,Gw),a=L.multiplyTransformation(t,o,Gw);a=L.multiplyTransformation(a,i,Gw);let s=L.getTranslation(a,Y5e);return r=$i.computeActualWgs84Position(n,s,r)}function mae(e,t,i){let n=e.model,r=n.sceneGraph;e.runtimeNode.node.instances.transformInWorldSpace?(t=L.multiplyTransformation(n.modelMatrix,r.components.transform,t),i=L.multiplyTransformation(r.axisCorrectionMatrix,e.runtimeNode.computedTransform,i)):(t=L.clone(r.computedModelMatrix,t),t=L.multiplyTransformation(t,e.runtimeNode.computedTransform,t),i=L.clone(L.IDENTITY,i))}var pae=new L,_ae=new L,Z5e=new L,$5e=new h;function Q5e(e,t,i,n){let r=pae,o=_ae;mae(t,r,o);let a=t.runtimeNode.instancingReferencePoint2D,s=e.length;for(let t=0;t<s;t++){let s=X5e(e[t],r,o,i,Z5e),l=L.getTranslation(s,$5e),u=h.subtract(l,a,l);n[t]=L.setTranslation(s,u,n[t])}return n}function J5e(e,t,i,n){let r=pae,o=_ae;mae(t,r,o);let a=t.runtimeNode.instancingReferencePoint2D,s=e.length;for(let t=0;t<s;t++){let s=e[t],l=K5e(s,r,o,i,s);n[t]=h.subtract(l,a,n[t])}return n}var eGe=new h,tGe=new h;function gae(e,t){let i=e.runtimeNode,n=e.model.sceneGraph.computedModelMatrix,r=L.multiplyByPoint(n,i.instancingTranslationMin,eGe),o=$i.computeActualWgs84Position(t,r,r),a=L.multiplyByPoint(n,i.instancingTranslationMax,tGe),s=$i.computeActualWgs84Position(t,a,a);i.instancingReferencePoint2D=h.lerp(o,s,.5,new h)}function z9(e){let t=e.length,i=new Float32Array(12*t);for(let n=0;n<t;n++){let t=e[n],r=12*n;i[r+0]=t[0],i[r+1]=t[4],i[r+2]=t[8],i[r+3]=t[12],i[r+4]=t[1],i[r+5]=t[5],i[r+6]=t[9],i[r+7]=t[13],i[r+8]=t[2],i[r+9]=t[6],i[r+10]=t[10],i[r+11]=t[14]}return i}function nGe(e){let t=e.length,i=new Float32Array(3*t);for(let n=0;n<t;n++){let t=e[n],r=3*n;i[r+0]=t[0],i[r+1]=t[4],i[r+2]=t[8]}return i}var iGe=new h,oGe=new Le,rGe=new h;function yae(e,t,i){let n,r=new Array(t),o=en.getAttributeBySemantic(e,Wr.TRANSLATION),a=en.getAttributeBySemantic(e,Wr.ROTATION),s=en.getAttributeBySemantic(e,Wr.SCALE),l=new h(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),c=new h(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),d=u(o),p=u(a),f=u(s),m=d?o.typedArray:new Float32Array(3*t),_=p?a.typedArray:new Float32Array(4*t);p&&a.normalized&&(_=Gn.dequantize(_,a.componentDatatype,a.type,t)),f?n=s.typedArray:(n=new Float32Array(3*t),n.fill(1));for(let e=0;e<t;e++){let t=new h(m[3*e],m[3*e+1],m[3*e+2],iGe);h.maximumByComponent(l,t,l),h.minimumByComponent(c,t,c);let i=new Le(_[4*e],_[4*e+1],_[4*e+2],p?_[4*e+3]:1,oGe),o=new h(n[3*e],n[3*e+1],n[3*e+2],rGe),a=L.fromTranslationQuaternionRotationScale(t,i,o,new L);r[e]=a}let g=i.runtimeNode;return g.instancingTranslationMin=c,g.instancingTranslationMax=l,d&&(o.typedArray=void 0),p&&(a.typedArray=void 0),f&&(s.typedArray=void 0),r}function sGe(e,t,i){let n=new Array(t),r=e.typedArray,o=new h(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new h(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let e=0;e<t;e++){let t=new h(r[3*e],r[3*e+1],r[3*e+2]);n[e]=t,h.minimumByComponent(o,t,o),h.maximumByComponent(a,t,a)}let s=i.runtimeNode;return s.instancingTranslationMin=o,s.instancingTranslationMax=a,e.typedArray=void 0,n}function H9(e,t){let i=ut.createVertexBuffer({context:t.context,typedArray:e,usage:Be.STATIC_DRAW});return i.vertexArrayDestroyable=!1,i}function aGe(e,t,i,n,r){let o=en.getAttributeBySemantic(i,Wr.ROTATION);u(o)?cGe(e,i,n,t,r):lGe(e,i,n,t,r)}function cGe(e,t,i,n,r){let o=e.shaderBuilder,a=t.attributes[0].count,s=e.model,l=e.runtimeNode;o.addDefine("HAS_INSTANCE_MATRICES");let c,h=l.instancingTransformsBuffer;if(!u(h)){c=yae(t,a,e),h=H9(z9(c),n),s._modelResources.push(h),l.instancingTransformsBuffer=h}if(dae(e,h,i,"Transform"),!r)return;let d=Ge(n);d.mode=te.COLUMBUS_VIEW,gae(e,d);let p=l.instancingTransformsBuffer2D;if(!u(p)){p=H9(z9(Q5e(c,e,d,c)),n),s._modelResources.push(p),l.instancingTransformsBuffer2D=p}dae(e,p,i,"Transform2D")}function lGe(e,t,i,n,r){let o=e.shaderBuilder,a=e.runtimeNode,s=en.getAttributeBySemantic(t,Wr.TRANSLATION),l=en.getAttributeBySemantic(t,Wr.SCALE);if(u(l)){o.addDefine("HAS_INSTANCE_SCALE");let t="Scale";U9(e,l.buffer,l.byteOffset,l.byteStride,i,t)}if(!u(s))return;let c,h=s.typedArray;u(h)?c=sGe(s,s.count,e):u(a.instancingTranslationMin)||(a.instancingTranslationMin=s.min,a.instancingTranslationMax=s.max),o.addDefine("HAS_INSTANCE_TRANSLATION");if(U9(e,s.buffer,s.byteOffset,s.byteStride,i,"Translation"),!r)return;let d=Ge(n);d.mode=te.COLUMBUS_VIEW,gae(e,d);let p=a.instancingTranslationBuffer2D;if(!u(p)){p=H9(nGe(J5e(c,e,d,c)),n),e.model._modelResources.push(p),a.instancingTranslationBuffer2D=p}U9(e,p,0,void 0,i,"Translation2D")}function dae(e,t,i,n){let r=X.getSizeInBytes(X.FLOAT),o=12*r,a=[{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:X.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:o,instanceDivisor:1},{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:X.FLOAT,normalize:!1,offsetInBytes:4*r,strideInBytes:o,instanceDivisor:1},{index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:4,componentDatatype:X.FLOAT,normalize:!1,offsetInBytes:8*r,strideInBytes:o,instanceDivisor:1}],s=e.shaderBuilder;s.addAttribute("vec4",`a_instancing${n}Row0`),s.addAttribute("vec4",`a_instancing${n}Row1`),s.addAttribute("vec4",`a_instancing${n}Row2`),i.push.apply(i,a)}function U9(e,t,i,n,r,o){r.push({index:e.attributeIndex++,vertexBuffer:t,componentsPerAttribute:3,componentDatatype:X.FLOAT,normalize:!1,offsetInBytes:i,strideInBytes:n,instanceDivisor:1}),e.shaderBuilder.addAttribute("vec3",`a_instance${o}`)}function uGe(e,t,i,n){let r=i.attributes,o=e.shaderBuilder;for(let t=0;t<r.length;t++){let i=r[t];i.semantic===Wr.FEATURE_ID&&(i.setIndex>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=i.setIndex+1),n.push({index:e.attributeIndex++,vertexBuffer:i.buffer,componentsPerAttribute:nn.getNumberOfComponents(i.type),componentDatatype:i.componentDatatype,normalize:!1,offsetInBytes:i.byteOffset,strideInBytes:i.byteStride,instanceDivisor:1}),o.addAttribute("float",`a_instanceFeatureId_${i.setIndex}`))}}var j2=hae,G9={};function xae(e,t,i,n){let r;n=L.multiplyTransformation(n,e.transform,new L),e.updateComputedTransform();let o=e.runtimePrimitives.length;for(r=0;r<o;r++){let t=e.runtimePrimitives[r].drawCommand;t.modelMatrix=L.multiplyTransformation(i,n,t.modelMatrix),t.cullFace=en.getCullFace(t.modelMatrix,t.primitiveType)}let a=e.children.length;for(r=0;r<a;r++){let o=t._runtimeNodes[e.children[r]];o._transformToRoot=L.clone(n,o._transformToRoot),xae(o,t,i,n),o._transformDirty=!1}}G9.name="ModelMatrixUpdateStage",G9.update=function(e,t,i){let n=i.mode!==te.SCENE3D;if((!n||!t._model._projectTo2D)&&e._transformDirty){xae(e,t,n?t._computedModelMatrix2D:t._computedModelMatrix,e.transformToRoot),e._transformDirty=!1}};var q2=G9,bae={name:"NodeStatisticsPipelineStage",_countInstancingAttributes:Tae,_countGeneratedBuffers:Aae};function Tae(e,t){if(!u(t))return;let i=t.attributes,n=i.length;for(let t=0;t<n;t++){let n=i[t];u(n.buffer)&&e.addBuffer(n.buffer,!1)}}function Aae(e,t){u(t.instancingTransformsBuffer)&&e.addBuffer(t.instancingTransformsBuffer,!1),u(t.instancingTransformsBuffer2D)&&e.addBuffer(t.instancingTransformsBuffer2D,!1),u(t.instancingTranslationBuffer2D)&&e.addBuffer(t.instancingTranslationBuffer2D,!1)}bae.process=function(e,t,i){let n=e.model.statistics,r=t.instances,o=e.runtimeNode;Tae(n,r),Aae(n,o)};var Y2=bae;function DA(e){let t=(e=y(e,y.EMPTY_OBJECT)).node,i=e.transform,n=e.transformToRoot,r=e.sceneGraph,o=e.children;this._node=t,this._name=t.name,this._id=t.index,this._sceneGraph=r,this._children=o,this._originalTransform=L.clone(i,this._originalTransform),this._transform=L.clone(i,this._transform),this._transformToRoot=L.clone(n,this._transformToRoot),this._computedTransform=new L,this._transformDirty=!1,this._transformParameters=void 0,this._morphWeights=[],this._runtimeSkin=void 0,this._computedJointMatrices=[],this.show=!0,this.userAnimated=!1,this.pipelineStages=[],this.runtimePrimitives=[],this.updateStages=[],this.instancingTranslationMin=void 0,this.instancingTranslationMax=void 0,this.instancingTransformsBuffer=void 0,this.instancingTransformsBuffer2D=void 0,this.instancingTranslationBuffer2D=void 0,this.instancingReferencePoint2D=void 0,fGe(this)}function fGe(e){let t=e.transform,i=e.transformToRoot,n=e._computedTransform;e._computedTransform=L.multiply(i,t,n);let r=e.node;u(r.matrix)||(e._transformParameters=new P0(r.translation,r.rotation,r.scale)),u(r.morphWeights)&&(e._morphWeights=r.morphWeights.slice());let o=r.articulationName;if(u(o)){let t=e.sceneGraph._runtimeArticulations[o];u(t)&&t.runtimeNodes.push(e)}}function W9(e,t){e._transformDirty=!0,e._transform=L.fromTranslationRotationScale(t,e._transform)}Object.defineProperties(DA.prototype,{node:{get:function(){return this._node}},sceneGraph:{get:function(){return this._sceneGraph}},children:{get:function(){return this._children}},transform:{get:function(){return this._transform},set:function(e){this._transformDirty=!0,this._transform=L.clone(e,this._transform)}},transformToRoot:{get:function(){return this._transformToRoot}},computedTransform:{get:function(){return this._computedTransform}},originalTransform:{get:function(){return this._originalTransform}},translation:{get:function(){return u(this._transformParameters)?this._transformParameters.translation:void 0},set:function(e){let t=this._transformParameters,i=t.translation;h.equals(i,e)||(t.translation=h.clone(e,t.translation),W9(this,t))}},rotation:{get:function(){return u(this._transformParameters)?this._transformParameters.rotation:void 0},set:function(e){let t=this._transformParameters,i=t.rotation;Le.equals(i,e)||(t.rotation=Le.clone(e,t.rotation),W9(this,t))}},scale:{get:function(){return u(this._transformParameters)?this._transformParameters.scale:void 0},set:function(e){let t=this._transformParameters,i=t.scale;h.equals(i,e)||(t.scale=h.clone(e,t.scale),W9(this,t))}},morphWeights:{get:function(){return this._morphWeights},set:function(e){let t=e.length;for(let i=0;i<t;i++)this._morphWeights[i]=e[i]}},runtimeSkin:{get:function(){return this._runtimeSkin}},computedJointMatrices:{get:function(){return this._computedJointMatrices}}}),DA.prototype.getChild=function(e){return this.sceneGraph._runtimeNodes[this.children[e]]},DA.prototype.configurePipeline=function(){let e=this.node,t=this.pipelineStages;t.length=0;let i=this.updateStages;i.length=0,u(e.instances)&&t.push(j2),t.push(Y2),i.push(q2)},DA.prototype.updateComputedTransform=function(){this._computedTransform=L.multiply(this._transformToRoot,this._transform,this._computedTransform)},DA.prototype.updateJointMatrices=function(){let e=this._runtimeSkin;if(!u(e))return;e.updateJointMatrices();let t=this._computedJointMatrices,i=e.jointMatrices,n=i.length;for(let e=0;e<n;e++){u(t[e])||(t[e]=new L);let n=L.multiplyTransformation(this.transformToRoot,this.transform,t[e]),r=L.inverseTransformation(n,t[e]);t[e]=L.multiplyTransformation(r,i[e],t[e])}};var X2=DA,Cae={name:"AlphaPipelineStage",process:function(e,t,i){let n=e.alphaOptions,r=e.model;n.pass=y(n.pass,r.opaquePass);let o=e.renderStateOptions;n.pass===Ee.TRANSLUCENT&&(o.cull.enabled=!1,o.depthMask=!1,o.blending=ln.ALPHA_BLEND);let a=e.shaderBuilder,s=e.uniformMap;u(n.alphaCutoff)&&(a.addDefine("ALPHA_MODE_MASK",void 0,Ce.FRAGMENT),a.addUniform("float","u_alphaCutoff",Ce.FRAGMENT),s.u_alphaCutoff=function(){return n.alphaCutoff})}},K2=Cae,Eae={name:"BatchTexturePipelineStage",process:function(e,t,i){let n=e.shaderBuilder,r={},o=e.model,a=o.featureTables[o.featureTableId],s=a.featuresLength;n.addUniform("int","model_featuresLength"),r.model_featuresLength=function(){return s};let l=a.batchTexture;n.addUniform("sampler2D","model_batchTexture"),r.model_batchTexture=function(){return y(l.batchTexture,l.defaultTexture)},n.addUniform("vec4","model_textureStep"),r.model_textureStep=function(){return l.textureStep},l.textureDimensions.y>1&&(n.addDefine("MULTILINE_BATCH_TEXTURE"),n.addUniform("vec2","model_textureDimensions"),r.model_textureDimensions=function(){return l.textureDimensions}),e.uniformMap=gt(r,e.uniformMap)}},Z2=Eae,Sae={name:"ClassificationPipelineStage"};function dGe(e,t){let i=en.getAttributeBySemantic(e,Tt.POSITION);if(!u(i))throw new ue("Primitives must have a position attribute to be used for classification.");let n,r=e.indices,o=u(r);o&&(n=r.typedArray,r.typedArray=void 0);let a=o?r.count:i.count,s=en.getAttributeBySemantic(e,Tt.FEATURE_ID,0);if(!u(s))return t.batchLengths=[a],void(t.batchOffsets=[0]);let l=s.typedArray;s.typedArray=void 0;let c=[],h=[0],d=l[o?n[0]:0],p=0;for(let e=1;e<a;e++){let t=l[o?n[e]:e];if(t!==d){let i=e-p,n=e;c.push(i),h.push(n),p=n,d=t}}let f=a-p;c.push(f),t.batchLengths=c,t.batchOffsets=h}Sae.process=function(e,t,i){e.shaderBuilder.addDefine("HAS_CLASSIFICATION",void 0,Ce.BOTH);let n=e.runtimePrimitive;u(n.batchLengths)||dGe(t,n)};var $2=Sae,Q2="void filterByPassType(inout vec3 positionMC, vec4 featureColor)\n{\n    bool styleTranslucent = (featureColor.a != 1.0);\n    // Only render translucent features in the translucent pass (if the style or the original command has translucency).\n    if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)\n    {\n        // If the model has a translucent silhouette, it needs to render during the silhouette color command,\n        // (i.e. the command where model_silhouettePass = true), even if the model isn't translucent.\n        #ifdef HAS_SILHOUETTE\n        positionMC *= float(model_silhouettePass);\n        #else\n        positionMC *= 0.0;\n        #endif\n    }\n    // If the current pass is not the translucent pass and the style is not translucent, don't render the feature.\n    else if (czm_pass != czm_passTranslucent && styleTranslucent)\n    {\n        positionMC *= 0.0;\n    }\n}\n\nvoid cpuStylingStage(inout vec3 positionMC, inout SelectedFeature feature)\n{\n    float show = ceil(feature.color.a);\n    positionMC *= show;\n\n    #if defined(HAS_SELECTED_FEATURE_ID_ATTRIBUTE) && !defined(HAS_CLASSIFICATION)\n    filterByPassType(positionMC, feature.color);\n    #endif\n}\n",J2="void filterByPassType(vec4 featureColor)\n{\n    bool styleTranslucent = (featureColor.a != 1.0);\n    // Only render translucent features in the translucent pass (if the style or the original command has translucency).\n    if (czm_pass == czm_passTranslucent && !styleTranslucent && !model_commandTranslucent)\n    {   \n        // If the model has a translucent silhouette, it needs to render during the silhouette color command,\n        // (i.e. the command where model_silhouettePass = true), even if the model isn't translucent.\n        #ifdef HAS_SILHOUETTE\n        if(!model_silhouettePass) {\n            discard;\n        }\n        #else\n        discard;\n        #endif\n    }\n    // If the current pass is not the translucent pass and the style is not translucent, don't render the feature.\n    else if (czm_pass != czm_passTranslucent && styleTranslucent)\n    {\n        discard;\n    }\n}\n\nvoid cpuStylingStage(inout czm_modelMaterial material, SelectedFeature feature)\n{\n    vec4 featureColor = feature.color;\n    if (featureColor.a == 0.0)\n    {\n        discard;\n    }\n\n    // If a feature ID vertex attribute is used, the pass type filter is applied in the vertex shader.\n    // So, we only apply in in the fragment shader if the feature ID texture is used.\n    #if defined(HAS_SELECTED_FEATURE_ID_TEXTURE) && !defined(HAS_CLASSIFICATION)\n    filterByPassType(featureColor);\n    #endif\n\n    featureColor = czm_gammaCorrect(featureColor);\n\n    // Classification models compute the diffuse differently.\n    #ifdef HAS_CLASSIFICATION\n    material.diffuse = featureColor.rgb * featureColor.a;\n    #else\n    float highlight = ceil(model_colorBlend);\n    material.diffuse *= mix(featureColor.rgb, vec3(1.0), highlight);\n    #endif\n    \n    material.alpha *= featureColor.a;\n}\n",wae={name:"CPUStylingPipelineStage",process:function(e,t,i){let n=e.model,r=e.shaderBuilder;r.addVertexLines(Q2),r.addFragmentLines(J2),r.addDefine("USE_CPU_STYLING",void 0,Ce.BOTH),u(n.color)||(r.addUniform("float",Q0.COLOR_BLEND_UNIFORM_NAME,Ce.FRAGMENT),e.uniformMap[Q0.COLOR_BLEND_UNIFORM_NAME]=function(){return xc.getColorBlend(n.colorBlendMode,n.colorBlendAmount)}),r.addUniform("bool","model_commandTranslucent",Ce.BOTH),e.uniformMap.model_commandTranslucent=function(){return e.alphaOptions.pass===Ee.TRANSLUCENT}}},eF=wae,vae={MODIFY_MATERIAL:"MODIFY_MATERIAL",REPLACE_MATERIAL:"REPLACE_MATERIAL",getDefineName:function(e){return`CUSTOM_SHADER_${e}`}},Dg=Object.freeze(vae),tF="void customShaderStage(\n    inout czm_modelVertexOutput vsOutput, \n    inout ProcessedAttributes attributes, \n    FeatureIds featureIds,\n    Metadata metadata,\n    MetadataClass metadataClass,\n    MetadataStatistics metadataStatistics\n) {\n    // VertexInput and initializeInputStruct() are dynamically generated in JS, \n    // see CustomShaderPipelineStage.js\n    VertexInput vsInput;\n    initializeInputStruct(vsInput, attributes);\n    vsInput.featureIds = featureIds;\n    vsInput.metadata = metadata;\n    vsInput.metadataClass = metadataClass;\n    vsInput.metadataStatistics = metadataStatistics;\n    vertexMain(vsInput, vsOutput);\n    attributes.positionMC = vsOutput.positionMC;\n}\n",nF="void customShaderStage(\n    inout czm_modelMaterial material,\n    ProcessedAttributes attributes,\n    FeatureIds featureIds,\n    Metadata metadata,\n    MetadataClass metadataClass,\n    MetadataStatistics metadataStatistics\n) {\n    // FragmentInput and initializeInputStruct() are dynamically generated in JS, \n    // see CustomShaderPipelineStage.js\n    FragmentInput fsInput;\n    initializeInputStruct(fsInput, attributes);\n    fsInput.featureIds = featureIds;\n    fsInput.metadata = metadata;\n    fsInput.metadataClass = metadataClass;\n    fsInput.metadataStatistics = metadataStatistics;\n    fragmentMain(fsInput, material);\n}\n",iF="void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) {\n  initializeFeatureIds(featureIds, attributes);\n  initializeFeatureIdAliases(featureIds);\n}\n",oF="void featureIdStage(out FeatureIds featureIds, ProcessedAttributes attributes) \n{\n  initializeFeatureIds(featureIds, attributes);\n  initializeFeatureIdAliases(featureIds);\n  setFeatureIdVaryings();\n}\n",Ni={name:"FeatureIdPipelineStage",STRUCT_ID_FEATURE_IDS_VS:"FeatureIdsVS",STRUCT_ID_FEATURE_IDS_FS:"FeatureIdsFS",STRUCT_NAME_FEATURE_IDS:"FeatureIds",FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS:"initializeFeatureIdsVS",FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS:"initializeFeatureIdsFS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS:"initializeFeatureIdAliasesVS",FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS:"initializeFeatureIdAliasesFS",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS:"void initializeFeatureIds(out FeatureIds featureIds, ProcessedAttributes attributes)",FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES:"void initializeFeatureIdAliases(inout FeatureIds featureIds)",FUNCTION_ID_SET_FEATURE_ID_VARYINGS:"setFeatureIdVaryings",FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS:"void setFeatureIdVaryings()"};function hGe(e){e.addStruct(Ni.STRUCT_ID_FEATURE_IDS_VS,Ni.STRUCT_NAME_FEATURE_IDS,Ce.VERTEX),e.addStruct(Ni.STRUCT_ID_FEATURE_IDS_FS,Ni.STRUCT_NAME_FEATURE_IDS,Ce.FRAGMENT),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,Ce.VERTEX),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_IDS,Ce.FRAGMENT),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,Ce.VERTEX),e.addFunction(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,Ni.FUNCTION_SIGNATURE_INITIALIZE_FEATURE_ID_ALIASES,Ce.FRAGMENT),e.addFunction(Ni.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,Ni.FUNCTION_SIGNATURE_SET_FEATURE_ID_VARYINGS,Ce.VERTEX)}function mGe(e,t,i){let n=t.featureIds,r=t.attributes[0].count;for(let t=0;t<n.length;t++){let o=n[t],a=o.positionalLabel;o instanceof Mt.FeatureIdAttribute?_Ge(e,o,a):Dae(e,o,a,r,1,i);let s=o.label;u(s)&&Iae(e,a,s,Ce.BOTH)}}function pGe(e,t,i){let n=t.featureIds,r=en.getAttributeBySemantic(t,Tt.POSITION).count;for(let t=0;t<n.length;t++){let o=n[t],a=o.positionalLabel,s=Ce.BOTH;o instanceof Mt.FeatureIdAttribute?gGe(e,o,a):o instanceof Mt.FeatureIdImplicitRange?Dae(e,o,a,r,void 0,i):(yGe(e,o,a,t,i),s=Ce.FRAGMENT);let l=o.label;u(l)&&Iae(e,a,l,s)}}function _Ge(e,t,i){let n=e.shaderBuilder;n.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",i),n.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",i);let r=t.setIndex,o=i.replace(/_\d+$/,"_"),a=`a_${o}${r}`,s=`v_${o}${r}`,l=`featureIds.${i} = int(czm_round(${a}));`,u=`featureIds.${i} = int(czm_round(${s}));`;n.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[l]),n.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[u]),n.addVarying("float",s),n.addFunctionLines(Ni.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${s} = ${a};`])}function gGe(e,t,i){let n=e.shaderBuilder;n.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",i),n.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",i);let r=t.setIndex,o=i.replace(/_\d+$/,"_"),a=[`featureIds.${i} = int(czm_round(attributes.${o}${r}));`];n.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,a),n.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,a)}function Dae(e,t,i,n,r,o){xGe(e,t,n,r,o);let a=e.shaderBuilder,s=`a_implicit_${i}`;a.addAttribute("float",s);let l=`v_implicit_${i}`;a.addVarying("float",l),a.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",i),a.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",i),a.addFunctionLines(Ni.FUNCTION_ID_SET_FEATURE_ID_VARYINGS,[`${l} = ${s};`]),a.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_VS,[`featureIds.${i} = int(czm_round(${s}));`]),a.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[`featureIds.${i} = int(czm_round(${l}));`])}function yGe(e,t,i,n,r){let o=`u_featureIdTexture_${n}`,a=e.uniformMap,s=t.textureReader;a[o]=function(){return y(s.texture,r.context.defaultTexture)};let l=s.channels,u=e.shaderBuilder;u.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",i),u.addUniform("sampler2D",o,Ce.FRAGMENT);let c=`featureIds.${i} = czm_unpackUint(${`texture(${o}, ${`v_texCoord_${s.texCoord}`}).${l}`});`;u.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_IDS_FS,[c])}function Iae(e,t,i,n){let r=e.shaderBuilder,o=Ce.includesVertexShader(n);o&&r.addStructField(Ni.STRUCT_ID_FEATURE_IDS_VS,"int",i),r.addStructField(Ni.STRUCT_ID_FEATURE_IDS_FS,"int",i);let a=[`featureIds.${i} = featureIds.${t};`];o&&r.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_VS,a),r.addFunctionLines(Ni.FUNCTION_ID_INITIALIZE_FEATURE_ID_ALIASES_FS,a)}function xGe(e,t,i,n,r){let o,a,s=e.model;if(u(t.repeat)){let e=bGe(t,i);o=ut.createVertexBuffer({context:r.context,typedArray:e,usage:Be.STATIC_DRAW}),o.vertexArrayDestroyable=!1,s._pipelineResources.push(o);let n=!1;s.statistics.addBuffer(o,n)}else a=[t.offset];let l={index:e.attributeIndex++,instanceDivisor:n,value:a,vertexBuffer:o,normalize:!1,componentsPerAttribute:1,componentDatatype:X.FLOAT,strideInBytes:X.getSizeInBytes(X.FLOAT),offsetInBytes:0};e.attributes.push(l)}function bGe(e,t){let i=e.offset,n=e.repeat,r=new Float32Array(t);for(let e=0;e<t;e++)r[e]=i+Math.floor(e/n);return r}Ni.process=function(e,t,i){let n=e.shaderBuilder;hGe(n);let r=e.runtimeNode.node.instances;u(r)&&mGe(e,r,i),pGe(e,t,i),n.addVertexLines(oF),n.addFragmentLines(iF)};var J0=Ni,rF="void metadataStage(\n  out Metadata metadata,\n  out MetadataClass metadataClass,\n  out MetadataStatistics metadataStatistics,\n  ProcessedAttributes attributes\n  )\n{\n  initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);\n}\n",sF="void metadataStage(\n  out Metadata metadata,\n  out MetadataClass metadataClass,\n  out MetadataStatistics metadataStatistics,\n  ProcessedAttributes attributes\n  )\n{\n  initializeMetadata(metadata, metadataClass, metadataStatistics, attributes);\n  setMetadataVaryings();\n}\n",Ti={name:"MetadataPipelineStage",STRUCT_ID_METADATA_VS:"MetadataVS",STRUCT_ID_METADATA_FS:"MetadataFS",STRUCT_NAME_METADATA:"Metadata",STRUCT_ID_METADATA_CLASS_VS:"MetadataClassVS",STRUCT_ID_METADATA_CLASS_FS:"MetadataClassFS",STRUCT_NAME_METADATA_CLASS:"MetadataClass",STRUCT_ID_METADATA_STATISTICS_VS:"MetadataStatisticsVS",STRUCT_ID_METADATA_STATISTICS_FS:"MetadataStatisticsFS",STRUCT_NAME_METADATA_STATISTICS:"MetadataStatistics",FUNCTION_ID_INITIALIZE_METADATA_VS:"initializeMetadataVS",FUNCTION_ID_INITIALIZE_METADATA_FS:"initializeMetadataFS",FUNCTION_SIGNATURE_INITIALIZE_METADATA:"void initializeMetadata(out Metadata metadata, out MetadataClass metadataClass, out MetadataStatistics metadataStatistics, ProcessedAttributes attributes)",FUNCTION_ID_SET_METADATA_VARYINGS:"setMetadataVaryings",FUNCTION_SIGNATURE_SET_METADATA_VARYINGS:"void setMetadataVaryings()",METADATA_CLASS_FIELDS:[{specName:"noData",shaderName:"noData"},{specName:"default",shaderName:"defaultValue"},{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"}],METADATA_STATISTICS_FIELDS:[{specName:"min",shaderName:"minValue"},{specName:"max",shaderName:"maxValue"},{specName:"mean",shaderName:"mean",type:"float"},{specName:"median",shaderName:"median"},{specName:"standardDeviation",shaderName:"standardDeviation",type:"float"},{specName:"variance",shaderName:"variance",type:"float"},{specName:"sum",shaderName:"sum"}]};function TGe(e,t,i){return u(e)?e.flatMap((e=>AGe(e,t,i))):[]}function AGe(e,t,i){let{getAttributeByName:n,getAttributeInfo:r,sanitizeGlslIdentifier:o}=en,a=e.class.id,s=i?.classes[a],l=Object.entries(e.properties),u=new Array(l.length);for(let e=0;e<l.length;e++){let[i,a]=l[e],c=n(t,a.attribute),{glslType:h,variableName:d}=r(c);u[e]={metadataVariable:o(i),property:a,type:a.classProperty.type,glslType:h,variableName:d,propertyStatistics:s?.properties[i],shaderDestination:Ce.BOTH}}return u}function CGe(e,t){return u(e)?e.flatMap((e=>EGe(e,t))):[]}function EGe(e,t){let{sanitizeGlslIdentifier:i}=en,n=e.class.id,r=t?.classes[n],o=Object.entries(e.properties).filter((([e,t])=>t.isGpuCompatible())),a=new Array(o.length);for(let e=0;e<o.length;e++){let[t,n]=o[e];a[e]={metadataVariable:i(t),property:n,type:n.classProperty.type,glslType:n.getGlslType(),propertyStatistics:r?.properties[t],shaderDestination:Ce.FRAGMENT}}return a}function SGe(e,t){let i=new Set,n=new Set;for(let e=0;e<t.length;e++){let{type:r,glslType:o,propertyStatistics:a}=t[e];i.add(o),u(a)&&r!==Gt.ENUM&&n.add(o)}let r=Ti.METADATA_CLASS_FIELDS;for(let e of i){a(`${e}MetadataClass`,e,r)}let o=Ti.METADATA_STATISTICS_FIELDS;for(let e of n){a(`${e}MetadataStatistics`,e,o)}function a(t,i,n){e.addStruct(t,t,Ce.BOTH);for(let r=0;r<n.length;r++){let{shaderName:o}=n[r],a="float"===n[r].type?vGe(i):i;e.addStructField(t,a,o)}}}Ti.process=function(e,t,i){let{shaderBuilder:n,model:r}=e,{structuralMetadata:o={},content:a}=r,s=a?.tileset.metadataExtension?.statistics,l=TGe(o.propertyAttributes,t,s),u=CGe(o.propertyTextures,s);SGe(n,l.concat(u)),DGe(n),n.addVertexLines(sF),n.addFragmentLines(rF);for(let t=0;t<l.length;t++){IGe(e,l[t])}for(let t=0;t<u.length;t++){OGe(e,u[t])}};var wGe={int:"float",ivec2:"vec2",ivec3:"vec3",ivec4:"vec4"};function vGe(e){let t=wGe[e];return u(t)?t:e}function DGe(e){e.addStruct(Ti.STRUCT_ID_METADATA_VS,Ti.STRUCT_NAME_METADATA,Ce.VERTEX),e.addStruct(Ti.STRUCT_ID_METADATA_FS,Ti.STRUCT_NAME_METADATA,Ce.FRAGMENT),e.addStruct(Ti.STRUCT_ID_METADATA_CLASS_VS,Ti.STRUCT_NAME_METADATA_CLASS,Ce.VERTEX),e.addStruct(Ti.STRUCT_ID_METADATA_CLASS_FS,Ti.STRUCT_NAME_METADATA_CLASS,Ce.FRAGMENT),e.addStruct(Ti.STRUCT_ID_METADATA_STATISTICS_VS,Ti.STRUCT_NAME_METADATA_STATISTICS,Ce.VERTEX),e.addStruct(Ti.STRUCT_ID_METADATA_STATISTICS_FS,Ti.STRUCT_NAME_METADATA_STATISTICS,Ce.FRAGMENT),e.addFunction(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,Ti.FUNCTION_SIGNATURE_INITIALIZE_METADATA,Ce.VERTEX),e.addFunction(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,Ti.FUNCTION_SIGNATURE_INITIALIZE_METADATA,Ce.FRAGMENT),e.addFunction(Ti.FUNCTION_ID_SET_METADATA_VARYINGS,Ti.FUNCTION_SIGNATURE_SET_METADATA_VARYINGS,Ce.VERTEX)}function IGe(e,t){PGe(e,t),Pae(e.shaderBuilder,t),Oae(e.shaderBuilder,t)}function PGe(e,t){let{shaderBuilder:i}=e,{metadataVariable:n,property:r,glslType:o}=t,a=Mae({valueExpression:`attributes.${t.variableName}`,renderResources:e,glslType:o,metadataVariable:n,shaderDestination:Ce.BOTH,property:r});i.addStructField(Ti.STRUCT_ID_METADATA_VS,o,n),i.addStructField(Ti.STRUCT_ID_METADATA_FS,o,n);let s=`metadata.${n} = ${a};`;i.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,[s]),i.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,[s])}function OGe(e,t){RGe(e,t),Pae(e.shaderBuilder,t),Oae(e.shaderBuilder,t)}function RGe(e,t){let{shaderBuilder:i,uniformMap:n}=e,{metadataVariable:r,glslType:o,property:a}=t,{texCoord:s,channels:l,index:u,texture:c}=a.textureReader,h=`u_propertyTexture_${u}`;n.hasOwnProperty(h)||(i.addUniform("sampler2D",h,Ce.FRAGMENT),n[h]=()=>c),i.addStructField(Ti.STRUCT_ID_METADATA_FS,o,r);let d=`texture(${h}, ${`attributes.texCoord_${s}`}).${l}`,p=`metadata.${r} = ${Mae({valueExpression:a.unpackInShader(d),renderResources:e,glslType:o,metadataVariable:r,shaderDestination:Ce.FRAGMENT,property:a})};`;i.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,[p])}function Pae(e,t){let{classProperty:i}=t.property,{metadataVariable:n,glslType:r,shaderDestination:o}=t,a=Rae(Ti.METADATA_CLASS_FIELDS,i,`metadataClass.${n}`,r),s=`${r}MetadataClass`;e.addStructField(Ti.STRUCT_ID_METADATA_CLASS_FS,s,n),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,a),Ce.includesVertexShader(o)&&(e.addStructField(Ti.STRUCT_ID_METADATA_CLASS_VS,s,n),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,a))}function Oae(e,t){let{propertyStatistics:i}=t;if(!u(i))return;let{metadataVariable:n,type:r,glslType:o}=t;if(r===Gt.ENUM)return;let a=Rae(Ti.METADATA_STATISTICS_FIELDS,i,`metadataStatistics.${n}`,o),s=`${o}MetadataStatistics`;e.addStructField(Ti.STRUCT_ID_METADATA_STATISTICS_FS,s,n),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_FS,a),Ce.includesVertexShader(t.shaderDestination)&&(e.addStructField(Ti.STRUCT_ID_METADATA_STATISTICS_VS,s,n),e.addFunctionLines(Ti.FUNCTION_ID_INITIALIZE_METADATA_VS,a))}function Rae(e,t,i,n){return u(t)?e.map((function(e){let r=t[e.specName];if(u(r))return`${i}.${e.shaderName} = ${n}(${r});`})).filter(u):[]}function Mae(e){let{valueExpression:t,property:i}=e;if(!i.hasValueTransform)return t;let n=e.metadataVariable,r=`u_${n}_offset`,o=`u_${n}_scale`,{shaderBuilder:a,uniformMap:s}=e.renderResources,{glslType:l,shaderDestination:u}=e;a.addUniform(l,r,u),a.addUniform(l,o,u);let{offset:c,scale:h}=i;return s[r]=()=>c,s[o]=()=>h,`czm_valueTransform(${r}, ${o}, ${t})`}var rd=Ti,MGe={INHERIT:0,OPAQUE:1,TRANSLUCENT:2},ex=Object.freeze(MGe),Vs={name:"CustomShaderPipelineStage",STRUCT_ID_ATTRIBUTES_VS:"AttributesVS",STRUCT_ID_ATTRIBUTES_FS:"AttributesFS",STRUCT_NAME_ATTRIBUTES:"Attributes",STRUCT_ID_VERTEX_INPUT:"VertexInput",STRUCT_NAME_VERTEX_INPUT:"VertexInput",STRUCT_ID_FRAGMENT_INPUT:"FragmentInput",STRUCT_NAME_FRAGMENT_INPUT:"FragmentInput",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS:"initializeInputStructVS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS:"void initializeInputStruct(out VertexInput vsInput, ProcessedAttributes attributes)",FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS:"initializeInputStructFS",FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS:"void initializeInputStruct(out FragmentInput fsInput, ProcessedAttributes attributes)",_oneTimeWarning:It};function LGe(e){let t={};for(let i=0;i<e.length;i++){let n=en.getAttributeInfo(e[i]);t[n.variableName]=n}return t}Vs.process=function(e,t,i){let{shaderBuilder:n,model:r,alphaOptions:o}=e,{customShader:a}=r,{lightingModel:s,translucencyMode:l}=a;u(s)&&(e.lightingOptions.lightingModel=s),l===ex.TRANSLUCENT?o.pass=Ee.TRANSLUCENT:l===ex.OPAQUE&&(o.pass=void 0);let c=zGe(a,t);if(!c.customShaderEnabled)return;if(jGe(n,a,c),c.shouldComputePositionWC&&n.addDefine("COMPUTE_POSITION_WC_CUSTOM_SHADER",void 0,Ce.BOTH),u(a.vertexShaderText)&&n.addDefine("HAS_CUSTOM_VERTEX_SHADER",void 0,Ce.VERTEX),u(a.fragmentShaderText)){n.addDefine("HAS_CUSTOM_FRAGMENT_SHADER",void 0,Ce.FRAGMENT);let e=Dg.getDefineName(a.mode);n.addDefine(e,void 0,Ce.FRAGMENT)}let h=a.uniforms;for(let e in h)if(h.hasOwnProperty(e)){let t=h[e];n.addUniform(t.type,e)}let d=a.varyings;for(let e in d)if(d.hasOwnProperty(e)){let t=d[e];n.addVarying(t,e)}e.uniformMap=gt(e.uniformMap,a.uniformMap)};var NGe={position:"vec3",normal:"vec3",tangent:"vec3",bitangent:"vec3",texCoord:"vec2",color:"vec4",joints:"ivec4",weights:"vec4"},FGe={position:"vec3(0.0)",normal:"vec3(0.0, 0.0, 1.0)",tangent:"vec3(1.0, 0.0, 0.0)",bitangent:"vec3(0.0, 1.0, 0.0)",texCoord:"vec2(0.0)",color:"vec4(1.0)",joints:"ivec4(0)",weights:"vec4(0.0)"};function Lae(e){let t=e.replace(/_[0-9]+$/,"");t=t.replace(/(MC|EC)$/,"");let i=NGe[t],n=FGe[t];if(u(i))return{attributeField:[i,e],value:n}}function BGe(e,t){if(!u(e.vertexShaderText))return{enabled:!1};let i,n=e.usedVariablesVertex.attributeSet,r=Nae(t,n,!1),o=Fae(t,n,!1),a=[],s=[];for(let e in r){if(!r.hasOwnProperty(e))continue;let t=[r[e].glslType,e];a.push(t),i=`vsInput.attributes.${e} = attributes.${e};`,s.push(i)}for(let e=0;e<o.length;e++){let t=o[e],n=Lae(t);if(!u(n))return Vs._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveVS",`Primitive is missing attribute ${t}, disabling custom vertex shader`),{enabled:!1};a.push(n.attributeField),i=`vsInput.attributes.${t} = ${n.value};`,s.push(i)}return{enabled:!0,attributeFields:a,initializationLines:s}}function kGe(e){let t=[],i=[],n=e.usedVariablesFragment.attributeSet;return n.hasOwnProperty("positionWC")&&(t.push(["vec3","positionWC"]),i.push("fsInput.attributes.positionWC = attributes.positionWC;")),n.hasOwnProperty("positionEC")&&(t.push(["vec3","positionEC"]),i.push("fsInput.attributes.positionEC = attributes.positionEC;")),{attributeFields:t,initializationLines:i}}function VGe(e,t){if(!u(e.fragmentShaderText))return{enabled:!1};let i,n=e.usedVariablesFragment.attributeSet,r=Nae(t,n,!0),o=Fae(t,n,!0),a=[],s=[];for(let e in r){if(!r.hasOwnProperty(e))continue;let t=[r[e].glslType,e];a.push(t),i=`fsInput.attributes.${e} = attributes.${e};`,s.push(i)}for(let e=0;e<o.length;e++){let t=o[e],n=Lae(t);if(!u(n))return Vs._oneTimeWarning("CustomShaderPipelineStage.incompatiblePrimitiveFS",`Primitive is missing attribute ${t}, disabling custom fragment shader.`),{enabled:!1};a.push(n.attributeField),i=`fsInput.attributes.${t} = ${n.value};`,s.push(i)}let l=kGe(e);return{enabled:!0,attributeFields:a.concat(l.attributeFields),initializationLines:l.initializationLines.concat(s)}}var UGe={positionWC:!0,positionEC:!0};function Nae(e,t,i){let n={};for(let r in e){if(!e.hasOwnProperty(r))continue;let o=e[r],a=r;i&&"normalMC"===r?a="normalEC":i&&"tangentMC"===r&&(a="tangentEC",o.glslType="vec3"),t.hasOwnProperty(a)&&(n[a]=o)}return n}function Fae(e,t,i){let n=[];for(let r in t){if(!t.hasOwnProperty(r)||UGe.hasOwnProperty(r))continue;let o=r;i&&"normalEC"===r?o="normalMC":i&&"tangentEC"===r&&(o="tangentMC"),e.hasOwnProperty(o)||n.push(r)}return n}function zGe(e,t){let i=LGe(t.attributes),n=BGe(e,i),r=VGe(e,i),o=e.usedVariablesFragment.attributeSet.hasOwnProperty("positionWC")&&r.enabled;return{vertexLines:n,fragmentLines:r,customShaderEnabled:n.enabled||r.enabled,shouldComputePositionWC:o}}function HGe(e,t){let i=Vs.STRUCT_ID_ATTRIBUTES_VS;e.addStruct(i,Vs.STRUCT_NAME_ATTRIBUTES,Ce.VERTEX);let{attributeFields:n,initializationLines:r}=t;for(let t=0;t<n.length;t++){let[r,o]=n[t];e.addStructField(i,r,o)}i=Vs.STRUCT_ID_VERTEX_INPUT,e.addStruct(i,Vs.STRUCT_NAME_VERTEX_INPUT,Ce.VERTEX),e.addStructField(i,Vs.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(i,J0.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(i,rd.STRUCT_NAME_METADATA,"metadata"),e.addStructField(i,rd.STRUCT_NAME_METADATA_CLASS,"metadataClass"),e.addStructField(i,rd.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");let o=Vs.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_VS;e.addFunction(o,Vs.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_VS,Ce.VERTEX),e.addFunctionLines(o,r)}function GGe(e,t){let i=Vs.STRUCT_ID_ATTRIBUTES_FS;e.addStruct(i,Vs.STRUCT_NAME_ATTRIBUTES,Ce.FRAGMENT);let{attributeFields:n,initializationLines:r}=t;for(let t=0;t<n.length;t++){let[r,o]=n[t];e.addStructField(i,r,o)}i=Vs.STRUCT_ID_FRAGMENT_INPUT,e.addStruct(i,Vs.STRUCT_NAME_FRAGMENT_INPUT,Ce.FRAGMENT),e.addStructField(i,Vs.STRUCT_NAME_ATTRIBUTES,"attributes"),e.addStructField(i,J0.STRUCT_NAME_FEATURE_IDS,"featureIds"),e.addStructField(i,rd.STRUCT_NAME_METADATA,"metadata"),e.addStructField(i,rd.STRUCT_NAME_METADATA_CLASS,"metadataClass"),e.addStructField(i,rd.STRUCT_NAME_METADATA_STATISTICS,"metadataStatistics");let o=Vs.FUNCTION_ID_INITIALIZE_INPUT_STRUCT_FS;e.addFunction(o,Vs.FUNCTION_SIGNATURE_INITIALIZE_INPUT_STRUCT_FS,Ce.FRAGMENT),e.addFunctionLines(o,r)}var WGe=[];function jGe(e,t,i){let{vertexLines:n,fragmentLines:r}=i,o=WGe;n.enabled&&(HGe(e,n),o.length=0,o.push("#line 0",t.vertexShaderText,tF),e.addVertexLines(o)),r.enabled&&(GGe(e,r),o.length=0,o.push("#line 0",t.fragmentShaderText,nF),e.addFragmentLines(o))}var aF=Vs,Ww={name:"DequantizationPipelineStage",FUNCTION_ID_DEQUANTIZATION_STAGE_VS:"dequantizationStage",FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS:"void dequantizationStage(inout ProcessedAttributes attributes)"};function qGe(e,t){let i=e.shaderBuilder,n=e.uniformMap,r=t.variableName,o=t.attribute.quantization;if(o.octEncoded){let e=`model_normalizationRange_${r}`;i.addUniform("float",e,Ce.VERTEX),n[e]=function(){return o.normalizationRange}}else{let e=`model_quantizedVolumeOffset_${r}`,a=`model_quantizedVolumeStepSize_${r}`,s=t.glslType;i.addUniform(s,e,Ce.VERTEX),i.addUniform(s,a,Ce.VERTEX);let l=o.quantizedVolumeOffset,u=o.quantizedVolumeStepSize;/^color_\d+$/.test(r)&&(l=Bae(l,0),u=Bae(u,1)),n[e]=function(){return l},n[a]=function(){return u}}}function Bae(e,t){return e instanceof oe?e:new oe(e.x,e.y,e.z,t)}function YGe(e,t){let i,n=t.variableName,r=t.attribute.quantization;i=r.octEncoded?XGe(n,r):KGe(n),e.addFunctionLines(Ww.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,[i])}function XGe(e,t){return`${`attributes.${e}`} = czm_octDecode(${`a_quantized_${e}`}, ${`model_normalizationRange_${e}`})${t.octEncodedZXY?".zxy":".xyz"};`}function KGe(e){return`${`attributes.${e}`} = ${`model_quantizedVolumeOffset_${e}`} + ${`a_quantized_${e}`} * ${`model_quantizedVolumeStepSize_${e}`};`}Ww.process=function(e,t,i){let n=e.shaderBuilder,r=e.model,o=u(r.classificationType);n.addDefine("USE_DEQUANTIZATION",void 0,Ce.VERTEX),n.addFunction(Ww.FUNCTION_ID_DEQUANTIZATION_STAGE_VS,Ww.FUNCTION_SIGNATURE_DEQUANTIZATION_STAGE_VS,Ce.VERTEX);let a=t.attributes;for(let t=0;t<a.length;t++){let i=a[t],r=i.quantization;if(!u(r))continue;let s=i.semantic===Tt.POSITION,l=i.semantic===Tt.TEXCOORD;if(o&&!s&&!l)continue;let c=en.getAttributeInfo(i);YGe(n,c),qGe(e,c)}};var cF=Ww,lF="void geometryStage(out ProcessedAttributes attributes)\n{\n  attributes.positionMC = v_positionMC;\n  attributes.positionEC = v_positionEC;\n\n  #ifdef COMPUTE_POSITION_WC_CUSTOM_SHADER\n  attributes.positionWC = v_positionWC;\n  #endif\n\n  #ifdef HAS_NORMALS\n  // renormalize after interpolation\n  attributes.normalEC = normalize(v_normalEC);\n  #endif\n\n  #ifdef HAS_TANGENTS\n  attributes.tangentEC = normalize(v_tangentEC);\n  #endif\n\n  #ifdef HAS_BITANGENTS\n  attributes.bitangentEC = normalize(v_bitangentEC);\n  #endif\n\n  // Everything else is dynamically generated in GeometryPipelineStage\n  setDynamicVaryings(attributes);\n}\n",uF="vec4 geometryStage(inout ProcessedAttributes attributes, mat4 modelView, mat3 normal) \n{\n    vec4 computedPosition;\n\n    // Compute positions in different coordinate systems\n    vec3 positionMC = attributes.positionMC;\n    v_positionMC = positionMC;\n    v_positionEC = (modelView * vec4(positionMC, 1.0)).xyz;\n\n    #if defined(USE_2D_POSITIONS) || defined(USE_2D_INSTANCING)\n    vec3 position2D = attributes.position2D;\n    vec3 positionEC = (u_modelView2D * vec4(position2D, 1.0)).xyz;\n    computedPosition = czm_projection * vec4(positionEC, 1.0);\n    #else\n    computedPosition = czm_projection * vec4(v_positionEC, 1.0);\n    #endif\n\n    // Sometimes the custom shader and/or style needs this\n    #if defined(COMPUTE_POSITION_WC_CUSTOM_SHADER) || defined(COMPUTE_POSITION_WC_STYLE)\n    // Note that this is a 32-bit position which may result in jitter on small\n    // scales.\n    v_positionWC = (czm_model * vec4(positionMC, 1.0)).xyz;\n    #endif\n\n    #ifdef HAS_NORMALS\n    v_normalEC = normalize(normal * attributes.normalMC);\n    #endif\n\n    #ifdef HAS_TANGENTS\n    v_tangentEC = normalize(normal * attributes.tangentMC);    \n    #endif\n\n    #ifdef HAS_BITANGENTS\n    v_bitangentEC = normalize(normal * attributes.bitangentMC);\n    #endif\n\n    // All other varyings need to be dynamically generated in\n    // GeometryPipelineStage\n    setDynamicVaryings(attributes);\n    \n    return computedPosition;\n}\n",jw="vec2 computeSt(float featureId)\n{\n    float stepX = model_textureStep.x;\n    float centerX = model_textureStep.y;\n\n    #ifdef MULTILINE_BATCH_TEXTURE\n    float stepY = model_textureStep.z;\n    float centerY = model_textureStep.w;\n\n    float xId = mod(featureId, model_textureDimensions.x); \n    float yId = floor(featureId / model_textureDimensions.x);\n    \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY));\n    #else\n    return vec2(centerX + (featureId * stepX), 0.5);\n    #endif\n}\n\nvoid selectedFeatureIdStage(out SelectedFeature feature, FeatureIds featureIds)\n{   \n    int featureId = featureIds.SELECTED_FEATURE_ID;\n\n\n    if (featureId < model_featuresLength)\n    {\n        vec2 featureSt = computeSt(float(featureId));\n\n        feature.id = featureId;\n        feature.st = featureSt;\n        feature.color = texture(model_batchTexture, featureSt);\n    }\n    // Floating point comparisons can be unreliable in GLSL, so we\n    // increment the feature ID to make sure it's always greater\n    // then the model_featuresLength - a condition we check for in the\n    // pick ID, to avoid sampling the pick texture if the feature ID is\n    // greater than the number of features.\n    else\n    {\n        feature.id = model_featuresLength + 1;\n        feature.st = vec2(0.0);\n        feature.color = vec4(1.0);\n    }\n\n    #ifdef HAS_NULL_FEATURE_ID\n    if (featureId == model_nullFeatureId) {\n        feature.id = featureId;\n        feature.st = vec2(0.0);\n        feature.color = vec4(1.0);\n    }\n    #endif\n}\n",qw={name:"SelectedFeatureIdPipelineStage",STRUCT_ID_SELECTED_FEATURE:"SelectedFeature",STRUCT_NAME_SELECTED_FEATURE:"SelectedFeature",FUNCTION_ID_FEATURE_VARYINGS_VS:"updateFeatureStructVS",FUNCTION_ID_FEATURE_VARYINGS_FS:"updateFeatureStructFS",FUNCTION_SIGNATURE_UPDATE_FEATURE:"void updateFeatureStruct(inout SelectedFeature feature)"};function kae(e){return e instanceof Mt.FeatureIdTexture?"HAS_SELECTED_FEATURE_ID_TEXTURE":"HAS_SELECTED_FEATURE_ID_ATTRIBUTE"}function Vae(e){return e instanceof Mt.FeatureIdTexture?Ce.FRAGMENT:Ce.BOTH}function ZGe(e,t,i){let n,r;return u(t.instances)&&(r=en.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),u(r))?(n=y(r.label,r.positionalLabel),{featureIds:r,variableName:n,shaderDestination:Vae(r),featureIdDefine:kae(r)}):(r=en.getFeatureIdsByLabel(i.featureIds,e.featureIdLabel),n=y(r.label,r.positionalLabel),{featureIds:r,variableName:n,shaderDestination:Vae(r),featureIdDefine:kae(r)})}function $Ge(e){e.addStructField(qw.STRUCT_ID_SELECTED_FEATURE,"int","id"),e.addStructField(qw.STRUCT_ID_SELECTED_FEATURE,"vec2","st"),e.addStructField(qw.STRUCT_ID_SELECTED_FEATURE,"vec4","color")}qw.process=function(e,t,i){let n=e.shaderBuilder;e.hasPropertyTable=!0;let r=ZGe(e.model,e.runtimeNode.node,t),o=r.shaderDestination;n.addDefine("HAS_SELECTED_FEATURE_ID",void 0,o),n.addDefine("SELECTED_FEATURE_ID",r.variableName,o),n.addDefine(r.featureIdDefine,void 0,o),$Ge(n);let a=r.featureIds.nullFeatureId,s=e.uniformMap;u(a)&&(n.addDefine("HAS_NULL_FEATURE_ID",void 0,o),n.addUniform("int","model_nullFeatureId",o),s.model_nullFeatureId=function(){return a}),r.shaderDestination===Ce.BOTH&&n.addVertexLines(jw),n.addFragmentLines(jw)};var tx=qw,As={name:"GeometryPipelineStage",STRUCT_ID_PROCESSED_ATTRIBUTES_VS:"ProcessedAttributesVS",STRUCT_ID_PROCESSED_ATTRIBUTES_FS:"ProcessedAttributesFS",STRUCT_NAME_PROCESSED_ATTRIBUTES:"ProcessedAttributes",FUNCTION_ID_INITIALIZE_ATTRIBUTES:"initializeAttributes",FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES:"void initializeAttributes(out ProcessedAttributes attributes)",FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS:"setDynamicVaryingsVS",FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS:"setDynamicVaryingsFS",FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS:"void setDynamicVaryings(inout ProcessedAttributes attributes)"};function QGe(e,t,i,n,r,o){let a=e.shaderBuilder,s=en.getAttributeInfo(t),l=r&&!o;n>1?t6e(e,t,i,n):e6e(e,t,i,l),i6e(a,s,l),n6e(a,s),u(t.semantic)&&JGe(a,t),o6e(a,s,r),r6e(a,s,l),s6e(a,s)}function JGe(e,t){let i=t.semantic,n=t.setIndex;switch(i){case Tt.NORMAL:e.addDefine("HAS_NORMALS");break;case Tt.TANGENT:e.addDefine("HAS_TANGENTS");break;case Tt.FEATURE_ID:e.addDefine(`HAS${i}_${n}`);break;case Tt.TEXCOORD:case Tt.COLOR:e.addDefine(`HAS_${i}_${n}`)}}function e6e(e,t,i,n){let r,o,a=t.quantization;u(a)?(r=a.type,o=a.componentDatatype):(r=t.type,o=t.componentDatatype);let s=t.semantic,l=t.setIndex;s===Tt.FEATURE_ID&&l>=e.featureIdVertexAttributeSetIndex&&(e.featureIdVertexAttributeSetIndex=l+1);let c=s===Tt.POSITION,h=c?0:i,d=nn.getNumberOfComponents(r),p={index:h,value:u(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,count:t.count,componentsPerAttribute:d,componentDatatype:o,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};if(e.attributes.push(p),!c||!n)return;let f={index:i,vertexBuffer:e.runtimePrimitive.positionBuffer2D,count:t.count,componentsPerAttribute:d,componentDatatype:X.FLOAT,offsetInBytes:0,strideInBytes:void 0,normalize:t.normalized};e.attributes.push(f)}function t6e(e,t,i,n){let r,o,a=t.quantization;u(a)?(r=a.type,o=a.componentDatatype):(r=t.type,o=t.componentDatatype);let s=t.normalized,l=nn.getNumberOfComponents(r)/n,c=l*X.getSizeInBytes(o),h=t.byteStride;for(let r=0;r<n;r++){let n=t.byteOffset+r*c,a={index:i+r,vertexBuffer:t.buffer,componentsPerAttribute:l,componentDatatype:o,offsetInBytes:n,strideInBytes:h,normalize:s};e.attributes.push(a)}}function n6e(e,t){let i,n=t.variableName,r=`v_${n}`;"normalMC"===n?(r="v_normalEC",i=t.glslType):"tangentMC"===n?(i="vec3",r="v_tangentEC"):i=t.glslType,e.addVarying(i,r)}function i6e(e,t,i){let n,r,o=t.attribute.semantic,a=t.variableName;t.isQuantized?(n=`a_quantized_${a}`,r=t.quantizedGlslType):(n=`a_${a}`,r=t.glslType);let s=o===Tt.POSITION;s?e.setPositionAttribute(r,n):e.addAttribute(r,n),s&&i&&e.addAttribute("vec3","a_position2D")}function o6e(e,t,i){let n=As.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,r=As.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,o=t.variableName;"tangentMC"===o?(e.addStructField(n,"vec3","tangentMC"),e.addStructField(n,"float","tangentSignMC"),e.addStructField(r,"vec3","tangentEC")):"normalMC"===o?(e.addStructField(n,"vec3","normalMC"),e.addStructField(r,"vec3","normalEC")):(e.addStructField(n,t.glslType,o),e.addStructField(r,t.glslType,o)),"positionMC"===o&&i&&e.addStructField(n,"vec3","position2D")}function r6e(e,t,i){let n=As.FUNCTION_ID_INITIALIZE_ATTRIBUTES,r=t.variableName;if("positionMC"===r&&i){let t="attributes.position2D = a_position2D;";e.addFunctionLines(n,[t])}if(t.isQuantized)return;let o=[];"tangentMC"===r?(o.push("attributes.tangentMC = a_tangentMC.xyz;"),o.push("attributes.tangentSignMC = a_tangentMC.w;")):o.push(`attributes.${r} = a_${r};`),e.addFunctionLines(n,o)}function s6e(e,t){let i=t.attribute.semantic,n=t.attribute.setIndex;if(u(i)&&!u(n))return;let r=As.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,o=t.variableName,a=`v_${o} = attributes.${o};`;e.addFunctionLines(r,[a]),r=As.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,a=`attributes.${o} = v_${o};`,e.addFunctionLines(r,[a])}function a6e(e,t){let i=!1,n=!1;for(let e=0;e<t.length;e++){let r=t[e];r.semantic===Tt.NORMAL?i=!0:r.semantic===Tt.TANGENT&&(n=!0)}!i||!n||(e.addDefine("HAS_BITANGENTS"),e.addVarying("vec3","v_bitangentEC"),e.addStructField(As.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"vec3","bitangentMC"),e.addStructField(As.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","bitangentEC"))}As.process=function(e,t,i){let n=e.shaderBuilder,r=e.model;n.addStruct(As.STRUCT_ID_PROCESSED_ATTRIBUTES_VS,"ProcessedAttributes",Ce.VERTEX),n.addStruct(As.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"ProcessedAttributes",Ce.FRAGMENT),n.addStruct(tx.STRUCT_ID_SELECTED_FEATURE,tx.STRUCT_NAME_SELECTED_FEATURE,Ce.BOTH),n.addFunction(As.FUNCTION_ID_INITIALIZE_ATTRIBUTES,As.FUNCTION_SIGNATURE_INITIALIZE_ATTRIBUTES,Ce.VERTEX),n.addVarying("vec3","v_positionWC"),n.addVarying("vec3","v_positionEC"),n.addStructField(As.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionWC"),n.addStructField(As.STRUCT_ID_PROCESSED_ATTRIBUTES_FS,"vec3","positionEC"),n.addFunction(As.FUNCTION_ID_SET_DYNAMIC_VARYINGS_VS,As.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,Ce.VERTEX),n.addFunction(As.FUNCTION_ID_SET_DYNAMIC_VARYINGS_FS,As.FUNCTION_SIGNATURE_SET_DYNAMIC_VARYINGS,Ce.FRAGMENT),r.type===lr.TILE_PNTS&&n.addDefine("HAS_SRGB_COLOR",void 0,Ce.FRAGMENT);let o=i.mode!==te.SCENE3D&&!i.scene3DOnly&&r._projectTo2D,a=u(e.runtimeNode.node.instances),s=o&&!a,l=t.attributes.length;for(let i=0;i<l;i++){let n,r=t.attributes[i],l=nn.getAttributeLocationCount(r.type),u=r.semantic===Tt.POSITION;l>1?(n=e.attributeIndex,e.attributeIndex+=l):n=u&&!s?0:e.attributeIndex++,QGe(e,r,n,l,o,a)}a6e(n,t.attributes),t.primitiveType===Ne.POINTS&&n.addDefine("PRIMITIVE_TYPE_POINTS"),n.addVertexLines(uF),n.addFragmentLines(lF)};var fF=As,dF="#ifdef LIGHTING_PBR\nvec3 computePbrLighting(czm_modelMaterial inputMaterial, ProcessedAttributes attributes)\n{\n    czm_pbrParameters pbrParameters;\n    pbrParameters.diffuseColor = inputMaterial.diffuse;\n    pbrParameters.f0 = inputMaterial.specular;\n    pbrParameters.roughness = inputMaterial.roughness;\n    \n    #ifdef USE_CUSTOM_LIGHT_COLOR\n    vec3 lightColorHdr = model_lightColorHdr;\n    #else\n    vec3 lightColorHdr = czm_lightColorHdr;\n    #endif\n\n    vec3 color = inputMaterial.diffuse;\n    #ifdef HAS_NORMALS\n    color = czm_pbrLighting(\n        attributes.positionEC,\n        inputMaterial.normalEC,\n        czm_lightDirectionEC,\n        lightColorHdr,\n        pbrParameters\n    );\n\n        #ifdef USE_IBL_LIGHTING\n        color += imageBasedLightingStage(\n            attributes.positionEC,\n            inputMaterial.normalEC,\n            czm_lightDirectionEC,\n            lightColorHdr,\n            pbrParameters\n        );\n        #endif\n    #endif\n\n    color *= inputMaterial.occlusion;\n    color += inputMaterial.emissive;\n\n    // In HDR mode, the frame buffer is in linear color space. The\n    // post-processing stages (see PostProcessStageCollection) will handle\n    // tonemapping. However, if HDR is not enabled, we must tonemap else large\n    // values may be clamped to 1.0\n    #ifndef HDR \n    color = czm_acesTonemapping(color);\n    #endif \n\n    return color;\n}\n#endif\n\nvoid lightingStage(inout czm_modelMaterial material, ProcessedAttributes attributes)\n{\n    // Even though the lighting will only set the diffuse color,\n    // pass all other properties so further stages have access to them.\n    vec3 color = vec3(0.0);\n\n    #ifdef LIGHTING_PBR\n    color = computePbrLighting(material, attributes);\n    #else // unlit\n    color = material.diffuse;\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_COLOR_STYLE\n    // The colors resulting from point cloud styles are adjusted differently.\n    color = czm_gammaCorrect(color);\n    #elif !defined(HDR)\n    // If HDR is not enabled, the frame buffer stores sRGB colors rather than\n    // linear colors so the linear value must be converted.\n    color = czm_linearToSrgb(color);\n    #endif\n\n    material.diffuse = color;\n}\n",c6e={UNLIT:0,PBR:1},gp=Object.freeze(c6e),Uae={name:"LightingPipelineStage",process:function(e,t){let i=e.model,n=e.lightingOptions,r=e.shaderBuilder;if(u(i.lightColor)){r.addDefine("USE_CUSTOM_LIGHT_COLOR",void 0,Ce.FRAGMENT),r.addUniform("vec3","model_lightColorHdr",Ce.FRAGMENT),e.uniformMap.model_lightColorHdr=function(){return i.lightColor}}n.lightingModel===gp.PBR?r.addDefine("LIGHTING_PBR",void 0,Ce.FRAGMENT):r.addDefine("LIGHTING_UNLIT",void 0,Ce.FRAGMENT),r.addFragmentLines(dF)}},hF=Uae,mF="// If the style color is white, it implies the feature has not been styled.\nbool isDefaultStyleColor(vec3 color)\n{\n    return all(greaterThan(color, vec3(1.0 - czm_epsilon3)));\n}\n\nvec3 blend(vec3 sourceColor, vec3 styleColor, float styleColorBlend)\n{\n    vec3 blendColor = mix(sourceColor, styleColor, styleColorBlend);\n    vec3 color = isDefaultStyleColor(styleColor.rgb) ? sourceColor : blendColor;\n    return color;\n}\n\nvec2 computeTextureTransform(vec2 texCoord, mat3 textureTransform)\n{\n    return vec2(textureTransform * vec3(texCoord, 1.0));\n}\n\n#ifdef HAS_NORMALS\nvec3 computeNormal(ProcessedAttributes attributes)\n{\n    // Geometry normal. This is already normalized \n    vec3 ng = attributes.normalEC;\n\n    vec3 normal = ng;\n    #if defined(HAS_NORMAL_TEXTURE) && !defined(HAS_WIREFRAME)\n    vec2 normalTexCoords = TEXCOORD_NORMAL;\n        #ifdef HAS_NORMAL_TEXTURE_TRANSFORM\n        normalTexCoords = computeTextureTransform(normalTexCoords, u_normalTextureTransform);\n        #endif\n\n        // If HAS_BITANGENTS is set, then HAS_TANGENTS is also set\n        #ifdef HAS_BITANGENTS\n        vec3 t = attributes.tangentEC;\n        vec3 b = attributes.bitangentEC;\n        mat3 tbn = mat3(t, b, ng);\n        vec3 n = texture(u_normalTexture, normalTexCoords).rgb;\n        normal = normalize(tbn * (2.0 * n - 1.0));\n        #elif (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n        // If derivatives are available (not IE 10), compute tangents\n        vec3 positionEC = attributes.positionEC;\n        vec3 pos_dx = dFdx(positionEC);\n        vec3 pos_dy = dFdy(positionEC);\n        vec3 tex_dx = dFdx(vec3(normalTexCoords,0.0));\n        vec3 tex_dy = dFdy(vec3(normalTexCoords,0.0));\n        vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n        t = normalize(t - ng * dot(ng, t));\n        vec3 b = normalize(cross(ng, t));\n        mat3 tbn = mat3(t, b, ng);\n        vec3 n = texture(u_normalTexture, normalTexCoords).rgb;\n        normal = normalize(tbn * (2.0 * n - 1.0));\n        #endif\n    #endif\n\n    #ifdef HAS_DOUBLE_SIDED_MATERIAL\n    if (czm_backFacing()) {\n        normal = -normal;\n    }\n    #endif\n\n    return normal;\n}\n#endif\n\nvoid materialStage(inout czm_modelMaterial material, ProcessedAttributes attributes, SelectedFeature feature)\n{\n    #ifdef HAS_NORMALS\n    material.normalEC = computeNormal(attributes);\n    #endif\n\n    vec4 baseColorWithAlpha = vec4(1.0);\n    // Regardless of whether we use PBR, set a base color\n    #ifdef HAS_BASE_COLOR_TEXTURE\n    vec2 baseColorTexCoords = TEXCOORD_BASE_COLOR;\n\n        #ifdef HAS_BASE_COLOR_TEXTURE_TRANSFORM\n        baseColorTexCoords = computeTextureTransform(baseColorTexCoords, u_baseColorTextureTransform);\n        #endif\n\n    baseColorWithAlpha = czm_srgbToLinear(texture(u_baseColorTexture, baseColorTexCoords));\n\n        #ifdef HAS_BASE_COLOR_FACTOR\n        baseColorWithAlpha *= u_baseColorFactor;\n        #endif\n    #elif defined(HAS_BASE_COLOR_FACTOR)\n    baseColorWithAlpha = u_baseColorFactor;\n    #endif\n\n    #ifdef HAS_POINT_CLOUD_COLOR_STYLE\n    baseColorWithAlpha = v_pointCloudColor;\n    #elif defined(HAS_COLOR_0)\n    vec4 color = attributes.color_0;\n        // .pnts files store colors in the sRGB color space\n        #ifdef HAS_SRGB_COLOR\n        color = czm_srgbToLinear(color);\n        #endif\n    baseColorWithAlpha *= color;\n    #endif\n\n    material.diffuse = baseColorWithAlpha.rgb;\n    material.alpha = baseColorWithAlpha.a;\n\n    #ifdef USE_CPU_STYLING\n    material.diffuse = blend(material.diffuse, feature.color.rgb, model_colorBlend);\n    #endif\n\n    #ifdef HAS_OCCLUSION_TEXTURE\n    vec2 occlusionTexCoords = TEXCOORD_OCCLUSION;\n        #ifdef HAS_OCCLUSION_TEXTURE_TRANSFORM\n        occlusionTexCoords = computeTextureTransform(occlusionTexCoords, u_occlusionTextureTransform);\n        #endif\n    material.occlusion = texture(u_occlusionTexture, occlusionTexCoords).r;\n    #endif\n\n    #ifdef HAS_EMISSIVE_TEXTURE\n    vec2 emissiveTexCoords = TEXCOORD_EMISSIVE;\n        #ifdef HAS_EMISSIVE_TEXTURE_TRANSFORM\n        emissiveTexCoords = computeTextureTransform(emissiveTexCoords, u_emissiveTextureTransform);\n        #endif\n\n    vec3 emissive = czm_srgbToLinear(texture(u_emissiveTexture, emissiveTexCoords).rgb);\n        #ifdef HAS_EMISSIVE_FACTOR\n        emissive *= u_emissiveFactor;\n        #endif\n    material.emissive = emissive;\n    #elif defined(HAS_EMISSIVE_FACTOR)\n    material.emissive = u_emissiveFactor;\n    #endif\n\n    #if defined(LIGHTING_PBR) && defined(USE_SPECULAR_GLOSSINESS)\n        #ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE\n        vec2 specularGlossinessTexCoords = TEXCOORD_SPECULAR_GLOSSINESS;\n          #ifdef HAS_SPECULAR_GLOSSINESS_TEXTURE_TRANSFORM\n          specularGlossinessTexCoords = computeTextureTransform(specularGlossinessTexCoords, u_specularGlossinessTextureTransform);\n          #endif\n\n        vec4 specularGlossiness = czm_srgbToLinear(texture(u_specularGlossinessTexture, specularGlossinessTexCoords));\n        vec3 specular = specularGlossiness.rgb;\n        float glossiness = specularGlossiness.a;\n            #ifdef HAS_SPECULAR_FACTOR\n            specular *= u_specularFactor;\n            #endif\n\n            #ifdef HAS_GLOSSINESS_FACTOR\n            glossiness *= u_glossinessFactor;\n            #endif\n        #else\n            #ifdef HAS_SPECULAR_FACTOR\n            vec3 specular = clamp(u_specularFactor, vec3(0.0), vec3(1.0));\n            #else\n            vec3 specular = vec3(1.0);\n            #endif\n\n            #ifdef HAS_GLOSSINESS_FACTOR\n            float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);\n            #else\n            float glossiness = 1.0;\n            #endif\n        #endif\n\n        #ifdef HAS_DIFFUSE_TEXTURE\n        vec2 diffuseTexCoords = TEXCOORD_DIFFUSE;\n            #ifdef HAS_DIFFUSE_TEXTURE_TRANSFORM\n            diffuseTexCoords = computeTextureTransform(diffuseTexCoords, u_diffuseTextureTransform);\n            #endif\n\n        vec4 diffuse = czm_srgbToLinear(texture(u_diffuseTexture, diffuseTexCoords));\n            #ifdef HAS_DIFFUSE_FACTOR\n            diffuse *= u_diffuseFactor;\n            #endif\n        #elif defined(HAS_DIFFUSE_FACTOR)\n        vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));\n        #else\n        vec4 diffuse = vec4(1.0);\n        #endif\n    czm_pbrParameters parameters = czm_pbrSpecularGlossinessMaterial(\n      diffuse.rgb,\n      specular,\n      glossiness\n    );\n    material.diffuse = parameters.diffuseColor;\n    // the specular glossiness extension's alpha overrides anything set\n    // by the base material.\n    material.alpha = diffuse.a;\n    material.specular = parameters.f0;\n    material.roughness = parameters.roughness;\n    #elif defined(LIGHTING_PBR)\n        #ifdef HAS_METALLIC_ROUGHNESS_TEXTURE\n        vec2 metallicRoughnessTexCoords = TEXCOORD_METALLIC_ROUGHNESS;\n            #ifdef HAS_METALLIC_ROUGHNESS_TEXTURE_TRANSFORM\n            metallicRoughnessTexCoords = computeTextureTransform(metallicRoughnessTexCoords, u_metallicRoughnessTextureTransform);\n            #endif\n\n        vec3 metallicRoughness = texture(u_metallicRoughnessTexture, metallicRoughnessTexCoords).rgb;\n        float metalness = clamp(metallicRoughness.b, 0.0, 1.0);\n        float roughness = clamp(metallicRoughness.g, 0.04, 1.0);\n            #ifdef HAS_METALLIC_FACTOR\n            metalness *= u_metallicFactor;\n            #endif\n\n            #ifdef HAS_ROUGHNESS_FACTOR\n            roughness *= u_roughnessFactor;\n            #endif\n        #else\n            #ifdef HAS_METALLIC_FACTOR\n            float metalness = clamp(u_metallicFactor, 0.0, 1.0);\n            #else\n            float metalness = 1.0;\n            #endif\n\n            #ifdef HAS_ROUGHNESS_FACTOR\n            float roughness = clamp(u_roughnessFactor, 0.04, 1.0);\n            #else\n            float roughness = 1.0;\n            #endif\n        #endif\n    czm_pbrParameters parameters = czm_pbrMetallicRoughnessMaterial(\n      material.diffuse,\n      metalness,\n      roughness\n    );\n    material.diffuse = parameters.diffuseColor;\n    material.specular = parameters.f0;\n    material.roughness = parameters.roughness;\n    #endif\n}\n",l6e=Mt.Material,j9=Mt.MetallicRoughness,q9=Mt.SpecularGlossiness,zae={name:"MaterialPipelineStage",_processTexture:Ig,_processTextureTransform:Hae};function Hae(e,t,i,n,r){let o=`HAS_${r}_TEXTURE_TRANSFORM`;e.addDefine(o,void 0,Ce.FRAGMENT);let a=`${n}Transform`;e.addUniform("mat3",a,Ce.FRAGMENT),t[a]=function(){return i.transform}}function Ig(e,t,i,n,r,o){e.addUniform("sampler2D",n,Ce.FRAGMENT),t[n]=function(){return y(i.texture,o)};let a=`HAS_${r}_TEXTURE`;e.addDefine(a,void 0,Ce.FRAGMENT);let s=`v_texCoord_${i.texCoord}`,l=`TEXCOORD_${r}`;e.addDefine(l,s,Ce.FRAGMENT);let c=i.transform;u(c)&&!$.equals(c,$.IDENTITY)&&Hae(e,t,i,n,r)}function u6e(e,t,i,n,r,o,a){let s=e.emissiveFactor;if(u(s)&&!h.equals(s,l6e.DEFAULT_EMISSIVE_FACTOR)){i.addUniform("vec3","u_emissiveFactor",Ce.FRAGMENT),t.u_emissiveFactor=function(){return e.emissiveFactor},i.addDefine("HAS_EMISSIVE_FACTOR",void 0,Ce.FRAGMENT);let n=e.emissiveTexture;u(n)&&!a&&Ig(i,t,n,"u_emissiveTexture","EMISSIVE",o)}let l=e.normalTexture;u(l)&&!a&&Ig(i,t,l,"u_normalTexture","NORMAL",r);let c=e.occlusionTexture;u(c)&&!a&&Ig(i,t,c,"u_occlusionTexture","OCCLUSION",n)}function f6e(e,t,i,n,r){let o=e.specularGlossiness;i.addDefine("USE_SPECULAR_GLOSSINESS",void 0,Ce.FRAGMENT);let a=o.diffuseTexture;u(a)&&!r&&Ig(i,t,a,"u_diffuseTexture","DIFFUSE",n);let s=o.diffuseFactor;u(s)&&!oe.equals(s,q9.DEFAULT_DIFFUSE_FACTOR)&&(i.addUniform("vec4","u_diffuseFactor",Ce.FRAGMENT),t.u_diffuseFactor=function(){return o.diffuseFactor},i.addDefine("HAS_DIFFUSE_FACTOR",void 0,Ce.FRAGMENT));let l=o.specularGlossinessTexture;u(l)&&!r&&Ig(i,t,l,"u_specularGlossinessTexture","SPECULAR_GLOSSINESS",n);let c=o.specularFactor;u(c)&&!h.equals(c,q9.DEFAULT_SPECULAR_FACTOR)&&(i.addUniform("vec3","u_specularFactor",Ce.FRAGMENT),t.u_specularFactor=function(){return o.specularFactor},i.addDefine("HAS_SPECULAR_FACTOR",void 0,Ce.FRAGMENT));let d=o.glossinessFactor;u(d)&&d!==q9.DEFAULT_GLOSSINESS_FACTOR&&(i.addUniform("float","u_glossinessFactor",Ce.FRAGMENT),t.u_glossinessFactor=function(){return o.glossinessFactor},i.addDefine("HAS_GLOSSINESS_FACTOR",void 0,Ce.FRAGMENT))}function d6e(e,t,i,n,r){let o=e.metallicRoughness;i.addDefine("USE_METALLIC_ROUGHNESS",void 0,Ce.FRAGMENT);let a=o.baseColorTexture;u(a)&&!r&&Ig(i,t,a,"u_baseColorTexture","BASE_COLOR",n);let s=o.baseColorFactor;u(s)&&!oe.equals(s,j9.DEFAULT_BASE_COLOR_FACTOR)&&(i.addUniform("vec4","u_baseColorFactor",Ce.FRAGMENT),t.u_baseColorFactor=function(){return o.baseColorFactor},i.addDefine("HAS_BASE_COLOR_FACTOR",void 0,Ce.FRAGMENT));let l=o.metallicRoughnessTexture;u(l)&&!r&&Ig(i,t,l,"u_metallicRoughnessTexture","METALLIC_ROUGHNESS",n);let c=o.metallicFactor;u(c)&&c!==j9.DEFAULT_METALLIC_FACTOR&&(i.addUniform("float","u_metallicFactor",Ce.FRAGMENT),t.u_metallicFactor=function(){return o.metallicFactor},i.addDefine("HAS_METALLIC_FACTOR",void 0,Ce.FRAGMENT));let h=o.roughnessFactor;u(h)&&h!==j9.DEFAULT_ROUGHNESS_FACTOR&&(i.addUniform("float","u_roughnessFactor",Ce.FRAGMENT),t.u_roughnessFactor=function(){return o.roughnessFactor},i.addDefine("HAS_ROUGHNESS_FACTOR",void 0,Ce.FRAGMENT))}zae.process=function(e,t,i){let n=t.material,r=e.model,o=u(r.classificationType),a=o,s=e.uniformMap,l=e.shaderBuilder,c=i.context.defaultTexture;u6e(n,s,l,c,i.context.defaultNormalTexture,i.context.defaultEmissiveTexture,a),u(n.specularGlossiness)?f6e(n,s,l,c,a):d6e(n,s,l,c,a);let h=en.getAttributeBySemantic(t,Tt.NORMAL),d=e.lightingOptions;n.unlit||!h||o?d.lightingModel=gp.UNLIT:d.lightingModel=gp.PBR;let p=r.backFaceCulling&&!n.doubleSided;e.renderStateOptions.cull.enabled=p;let f=e.alphaOptions;n.alphaMode===Ym.BLEND?f.pass=Ee.TRANSLUCENT:n.alphaMode===Ym.MASK&&(f.alphaCutoff=n.alphaCutoff),l.addFragmentLines(mF),n.doubleSided&&l.addDefine("HAS_DOUBLE_SIDED_MATERIAL",void 0,Ce.BOTH)};var pF=zae,_F="void morphTargetsStage(inout ProcessedAttributes attributes) \n{\n    vec3 positionMC = attributes.positionMC;\n    attributes.positionMC = getMorphedPosition(positionMC);\n\n    #ifdef HAS_NORMALS\n    vec3 normalMC = attributes.normalMC;\n    attributes.normalMC = getMorphedNormal(normalMC);\n    #endif\n\n    #ifdef HAS_TANGENTS\n    vec3 tangentMC = attributes.tangentMC;\n    attributes.tangentMC = getMorphedTangent(tangentMC);\n    #endif\n}",aa={name:"MorphTargetsPipelineStage",FUNCTION_ID_GET_MORPHED_POSITION:"getMorphedPosition",FUNCTION_SIGNATURE_GET_MORPHED_POSITION:"vec3 getMorphedPosition(in vec3 position)",FUNCTION_ID_GET_MORPHED_NORMAL:"getMorphedNormal",FUNCTION_SIGNATURE_GET_MORPHED_NORMAL:"vec3 getMorphedNormal(in vec3 normal)",FUNCTION_ID_GET_MORPHED_TANGENT:"getMorphedTangent",FUNCTION_SIGNATURE_GET_MORPHED_TANGENT:"vec3 getMorphedTangent(in vec3 tangent)",process:function(e,t){let i=e.shaderBuilder;i.addDefine("HAS_MORPH_TARGETS",void 0,Ce.VERTEX),y6e(i);let n=t.morphTargets.length;for(let i=0;i<n;i++){let n=t.morphTargets[i].attributes,r=n.length;for(let t=0;t<r;t++){let r=n[t],o=r.semantic;o!==Tt.POSITION&&o!==Tt.NORMAL&&o!==Tt.TANGENT||(m6e(e,r,e.attributeIndex,i),e.attributeIndex++)}}x6e(i);let r=e.runtimeNode.morphWeights.length;i.addUniform("float",`u_morphWeights[${r}]`,Ce.VERTEX),i.addVertexLines(_F);let o={u_morphWeights:function(){return e.runtimeNode.morphWeights}};e.uniformMap=gt(o,e.uniformMap)}},h6e={attributeString:void 0,functionId:void 0};function m6e(e,t,i,n){let r=e.shaderBuilder;p6e(e,t,i),g6e(r,_6e(t,h6e),n)}function p6e(e,t,i){let n={index:i,value:u(t.buffer)?void 0:t.constant,vertexBuffer:t.buffer,componentsPerAttribute:nn.getNumberOfComponents(t.type),componentDatatype:t.componentDatatype,offsetInBytes:t.byteOffset,strideInBytes:t.byteStride,normalize:t.normalized};e.attributes.push(n)}function _6e(e,t){switch(e.semantic){case Tt.POSITION:t.attributeString="Position",t.functionId=aa.FUNCTION_ID_GET_MORPHED_POSITION;break;case Tt.NORMAL:t.attributeString="Normal",t.functionId=aa.FUNCTION_ID_GET_MORPHED_NORMAL;break;case Tt.TANGENT:t.attributeString="Tangent",t.functionId=aa.FUNCTION_ID_GET_MORPHED_TANGENT}return t}function g6e(e,t,i){let n=t.attributeString,r=`a_target${n}_${i}`,o=`morphed${n} += u_morphWeights[${i}] * a_target${n}_${i};`;e.addAttribute("vec3",r),e.addFunctionLines(t.functionId,[o])}function y6e(e){e.addFunction(aa.FUNCTION_ID_GET_MORPHED_POSITION,aa.FUNCTION_SIGNATURE_GET_MORPHED_POSITION,Ce.VERTEX);e.addFunctionLines(aa.FUNCTION_ID_GET_MORPHED_POSITION,["vec3 morphedPosition = position;"]),e.addFunction(aa.FUNCTION_ID_GET_MORPHED_NORMAL,aa.FUNCTION_SIGNATURE_GET_MORPHED_NORMAL,Ce.VERTEX);e.addFunctionLines(aa.FUNCTION_ID_GET_MORPHED_NORMAL,["vec3 morphedNormal = normal;"]),e.addFunction(aa.FUNCTION_ID_GET_MORPHED_TANGENT,aa.FUNCTION_SIGNATURE_GET_MORPHED_TANGENT,Ce.VERTEX);e.addFunctionLines(aa.FUNCTION_ID_GET_MORPHED_TANGENT,["vec3 morphedTangent = tangent;"])}function x6e(e){e.addFunctionLines(aa.FUNCTION_ID_GET_MORPHED_POSITION,["return morphedPosition;"]);e.addFunctionLines(aa.FUNCTION_ID_GET_MORPHED_NORMAL,["return morphedNormal;"]);e.addFunctionLines(aa.FUNCTION_ID_GET_MORPHED_TANGENT,["return morphedTangent;"])}var gF=aa,Gae={name:"PickingPipelineStage"};function Wae(e,t){let i=e.model;if(u(i.pickObject))return i.pickObject;let n,r={model:i,node:e.runtimeNode,primitive:e.runtimePrimitive};if(lr.is3DTiles(i.type)){let e=i.content;n={content:e,primitive:e.tileset,detail:r}}else n={primitive:i,detail:r};return n.id=i.id,u(t)&&(n.instanceId=t),n}function b6e(e,t,i){let n,r,o=e.model,a=o.featureIdLabel,s=o.instanceFeatureIdLabel;u(o.featureTableId)?n=o.featureTableId:u(i)?(r=en.getFeatureIdsByLabel(i.featureIds,s),n=r.propertyTableId):(r=en.getFeatureIdsByLabel(t.featureIds,a),n=r.propertyTableId);let l=o.featureTables[n];e.shaderBuilder.addUniform("sampler2D","model_pickTexture",Ce.FRAGMENT);let c=l.batchTexture;e.uniformMap.model_pickTexture=function(){return y(c.pickTexture,c.defaultTexture)},e.pickId="((selectedFeature.id < int(model_featuresLength)) ? texture(model_pickTexture, selectedFeature.st) : vec4(0.0))"}function T6e(e,t){let i=e.instanceCount,n=new Array(i),r=new Uint8Array(4*i),o=e.model,a=o._pipelineResources;for(let o=0;o<i;o++){let i=Wae(e,o),s=t.createPickId(i);a.push(s),n[o]=s;let l=s.color;r[4*o+0]=z.floatToByte(l.red),r[4*o+1]=z.floatToByte(l.green),r[4*o+2]=z.floatToByte(l.blue),r[4*o+3]=z.floatToByte(l.alpha)}o._pickIds=n;let s=ut.createVertexBuffer({context:t,typedArray:r,usage:Be.STATIC_DRAW});s.vertexArrayDestroyable=!1;o.statistics.addBuffer(s,!1),a.push(s);let l={index:e.attributeIndex++,vertexBuffer:s,componentsPerAttribute:4,componentDatatype:X.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1};e.attributes.push(l);let u=e.shaderBuilder;u.addDefine("USE_PICKING",void 0,Ce.BOTH),u.addAttribute("vec4","a_pickColor"),u.addVarying("vec4","v_pickColor"),e.pickId="v_pickColor"}Gae.process=function(e,t,i){let n=i.context,r=e.runtimeNode,o=e.shaderBuilder,a=e.model,s=r.node.instances;if(e.hasPropertyTable)b6e(e,t,s,n);else if(u(s))T6e(e,n);else{let t=Wae(e),i=n.createPickId(t);a._pipelineResources.push(i),a._pickIds.push(i),o.addUniform("vec4","czm_pickColor",Ce.FRAGMENT),e.uniformMap.czm_pickColor=function(){return i.color},e.pickId="czm_pickColor"}};var yF=Gae,A6e={ADD:0,REPLACE:1},Uo=Object.freeze(A6e),xF="float getPointSizeFromAttenuation(vec3 positionEC) {\n  // Variables are packed into a single vector to minimize gl.uniformXXX() calls\n  float pointSize = model_pointCloudParameters.x;\n  float geometricError = model_pointCloudParameters.y;\n  float depthMultiplier = model_pointCloudParameters.z;\n\n  float depth = -positionEC.z;\n  return min((geometricError / depth) * depthMultiplier, pointSize);\n}\n\n#ifdef HAS_POINT_CLOUD_SHOW_STYLE\nfloat pointCloudShowStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  float tiles3d_tileset_time = model_pointCloudParameters.w;\n  return float(getShowFromStyle(attributes, metadata, tiles3d_tileset_time));\n}\n#endif\n\n#ifdef HAS_POINT_CLOUD_COLOR_STYLE\nvec4 pointCloudColorStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  float tiles3d_tileset_time = model_pointCloudParameters.w;\n  return getColorFromStyle(attributes, metadata, tiles3d_tileset_time);\n}\n#endif\n\n#ifdef HAS_POINT_CLOUD_POINT_SIZE_STYLE\nfloat pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  float tiles3d_tileset_time = model_pointCloudParameters.w;\n  return float(getPointSizeFromStyle(attributes, metadata, tiles3d_tileset_time));\n}\n#elif defined(HAS_POINT_CLOUD_ATTENUATION)\nfloat pointCloudPointSizeStylingStage(in ProcessedAttributes attributes, in Metadata metadata) {\n  return getPointSizeFromAttenuation(v_positionEC);\n}\n#endif\n\n#ifdef HAS_POINT_CLOUD_BACK_FACE_CULLING\nfloat pointCloudBackFaceCullingStage() {\n  #if defined(HAS_NORMALS) && !defined(HAS_DOUBLE_SIDED_MATERIAL)\n  // This needs to be computed in eye coordinates so we can't use attributes.normalMC\n  return step(-v_normalEC.z, 0.0);\n  #else\n  return 1.0;\n  #endif\n}\n#endif",C6e=new oe,qae={name:"PointCloudStylingPipelineStage",process:function(e,t,i){let n=e.shaderBuilder,r=e.model,o=r.style,a=r.structuralMetadata,s=u(a)?a.propertyAttributes:void 0,l=u(r.featureTableId)&&r.featureTables[r.featureTableId].featuresLength>0,c=!u(s)&&l;if(u(o)&&!c){let i=D6e(o,v6e(s));I6e(n,i);let r=P6e(i).indexOf("normalMC")>=0,a=en.getAttributeBySemantic(t,Tt.NORMAL);if(r&&!a)throw new ue("Style references the NORMAL semantic but the point cloud does not have normals");n.addDefine("COMPUTE_POSITION_WC_STYLE",void 0,Ce.VERTEX),i.styleTranslucent&&(e.alphaOptions.pass=Ee.TRANSLUCENT)}let h,d,p,f=r.pointCloudShading;f.attenuation&&n.addDefine("HAS_POINT_CLOUD_ATTENUATION",void 0,Ce.VERTEX),f.backFaceCulling&&n.addDefine("HAS_POINT_CLOUD_BACK_FACE_CULLING",void 0,Ce.VERTEX),lr.is3DTiles(r.type)&&(d=!0,h=r.content,p=h.tile.refine===Uo.ADD),n.addUniform("vec4","model_pointCloudParameters",Ce.VERTEX),n.addVertexLines(xF),e.uniformMap.model_pointCloudParameters=function(){let n=C6e,r=1;d&&(r=p?5:h.tileset.memoryAdjustedScreenSpaceError),n.x=y(f.maximumAttenuation,r),n.x*=i.pixelRatio;let o=E6e(e,t,f,h);n.y=o*f.geometricErrorScale;let a,s=i.context,l=i.camera.frustum;return a=i.mode===te.SCENE2D||l instanceof Qt?Number.POSITIVE_INFINITY:s.drawingBufferHeight/i.camera.frustum.sseDenominator,n.z=a,d&&(n.w=h.tileset.timeSinceLoad),n}}},jae=new h;function E6e(e,t,i,n){if(u(n)){let e=n.tile.geometricError;if(e>0)return e}if(u(i.baseResolution))return i.baseResolution;let r=en.getAttributeBySemantic(t,Tt.POSITION),o=r.count,a=e.runtimeNode.transform,s=h.subtract(r.max,r.min,jae);s=L.multiplyByPointAsVector(a,s,jae);let l=s.x*s.y*s.z;return P.cbrt(l/o)}var S6e={colorStyleFunction:void 0,showStyleFunction:void 0,pointSizeStyleFunction:void 0,styleTranslucent:!1},w6e={POSITION:"attributes.positionMC",POSITION_ABSOLUTE:"v_positionWC",COLOR:"attributes.color_0",NORMAL:"attributes.normalMC"};function v6e(e){let t=Ge(w6e);if(!u(e))return t;for(let i=0;i<e.length;i++){let n=e[i].properties;for(let e in n)n.hasOwnProperty(e)&&(t[e]=`metadata.${e}`)}return t}var Y9="ProcessedAttributes attributes, Metadata metadata, float tiles3d_tileset_time";function D6e(e,t){let i=S6e,n={translucent:!1};return i.colorStyleFunction=e.getColorShaderFunction(`getColorFromStyle(${Y9})`,t,n),i.showStyleFunction=e.getShowShaderFunction(`getShowFromStyle(${Y9})`,t,n),i.pointSizeStyleFunction=e.getPointSizeShaderFunction(`getPointSizeFromStyle(${Y9})`,t,n),i.styleTranslucent=u(i.colorStyleFunction)&&n.translucent,i}function I6e(e,t){let i=t.colorStyleFunction;u(i)&&(e.addDefine("HAS_POINT_CLOUD_COLOR_STYLE",void 0,Ce.BOTH),e.addVertexLines(i),e.addVarying("vec4","v_pointCloudColor"));let n=t.showStyleFunction;u(n)&&(e.addDefine("HAS_POINT_CLOUD_SHOW_STYLE",void 0,Ce.VERTEX),e.addVertexLines(n));let r=t.pointSizeStyleFunction;u(r)&&(e.addDefine("HAS_POINT_CLOUD_POINT_SIZE_STYLE",void 0,Ce.VERTEX),e.addVertexLines(r))}function X9(e,t){let i=/attributes\.(\w+)/g,n=i.exec(e);for(;null!==n;){let r=n[1];-1===t.indexOf(r)&&t.push(r),n=i.exec(e)}}function P6e(e){let t=e.colorStyleFunction,i=e.showStyleFunction,n=e.pointSizeStyleFunction,r=[];return u(t)&&X9(t,r),u(i)&&X9(i,r),u(n)&&X9(n,r),r}var bF=qae,TF="void primitiveOutlineStage() {\n    v_outlineCoordinates = a_outlineCoordinates;\n}\n",AF="void primitiveOutlineStage(inout czm_modelMaterial material) {\n    if (!model_showOutline) {\n        return;\n    }\n\n    float outlineX = \n        texture(model_outlineTexture, vec2(v_outlineCoordinates.x, 0.5)).r;\n    float outlineY = \n        texture(model_outlineTexture, vec2(v_outlineCoordinates.y, 0.5)).r;\n    float outlineZ = \n        texture(model_outlineTexture, vec2(v_outlineCoordinates.z, 0.5)).r;\n    float outlineness = max(outlineX, max(outlineY, outlineZ));\n\n    material.diffuse = mix(material.diffuse, model_outlineColor.rgb, model_outlineColor.a * outlineness);\n}\n\n",Yae={name:"PrimitiveOutlinePipelineStage",process:function(e,t,i){let n=e.shaderBuilder,r=e.uniformMap;n.addDefine("HAS_PRIMITIVE_OUTLINE",void 0,Ce.BOTH),n.addAttribute("vec3","a_outlineCoordinates"),n.addVarying("vec3","v_outlineCoordinates");let o=t.outlineCoordinates,a={index:e.attributeIndex++,vertexBuffer:o.buffer,componentsPerAttribute:nn.getNumberOfComponents(o.type),componentDatatype:o.componentDatatype,offsetInBytes:o.byteOffset,strideInBytes:o.byteStride,normalize:o.normalized};e.attributes.push(a),n.addUniform("sampler2D","model_outlineTexture",Ce.FRAGMENT);let s=TA.createTexture(i.context);r.model_outlineTexture=function(){return s};let l=e.model;n.addUniform("vec4","model_outlineColor",Ce.FRAGMENT),r.model_outlineColor=function(){return l.outlineColor},n.addUniform("bool","model_showOutline",Ce.FRAGMENT),r.model_showOutline=function(){return l.showOutline},n.addVertexLines(TF),n.addFragmentLines(AF)}},CF=Yae,Xae={name:"PrimitiveStatisticsPipelineStage",_countGeometry:Kae,_count2DPositions:Zae,_countMorphTargetAttributes:$ae,_countMaterialTextures:Qae,_countFeatureIdTextures:Jae,_countBinaryMetadata:ece};function Kae(e,t){let i=u(t.indices)?t.indices.count:en.getAttributeBySemantic(t,"POSITION").count,n=t.primitiveType;n===Ne.POINTS?e.pointsLength+=i:Ne.isTriangles(n)&&(e.trianglesLength+=O6e(n,i));let r=t.attributes,o=r.length;for(let t=0;t<o;t++){let i=r[t];if(u(i.buffer)){let t=u(i.typedArray);e.addBuffer(i.buffer,t)}}let a=t.outlineCoordinates;u(a)&&u(a.buffer)&&e.addBuffer(a.buffer,!1);let s=t.indices;if(u(s)&&u(s.buffer)){let t=u(s.typedArray);e.addBuffer(s.buffer,t)}}function O6e(e,t){switch(e){case Ne.TRIANGLES:return t/3;case Ne.TRIANGLE_STRIP:case Ne.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function Zae(e,t){let i=t.positionBuffer2D;u(i)&&e.addBuffer(i,!0)}function $ae(e,t){let i=t.morphTargets;if(!u(i))return;let n=i.length;for(let t=0;t<n;t++){let n=i[t].attributes,r=n.length;for(let t=0;t<r;t++){let i=n[t];u(i.buffer)&&e.addBuffer(i.buffer,false)}}}function Qae(e,t){let i=R6e(t),n=i.length;for(let t=0;t<n;t++){let n=i[t];u(n)&&u(n.texture)&&e.addTexture(n.texture)}}function R6e(e){let t=e.metallicRoughness,i=[e.emissiveTexture,e.normalTexture,e.occlusionTexture,t.baseColorTexture,t.metallicRoughnessTexture],n=e.specularGlossiness;return u(n)&&(i.push(n.diffuseTexture),i.push(n.specularGlossinessTexture)),i}function Jae(e,t){let i=t.length;for(let n=0;n<i;n++){let i=t[n];if(i instanceof Mt.FeatureIdTexture){let t=i.textureReader;u(t.texture)&&e.addTexture(t.texture)}}}function ece(e,t){let i=t.structuralMetadata;u(i)&&(M6e(e,i),e.propertyTablesByteLength+=i.propertyTablesByteLength);let n=t.featureTables;if(!u(n))return;let r=n.length;for(let t=0;t<r;t++){let i=n[t];e.addBatchTexture(i.batchTexture)}}function M6e(e,t){let i=t.propertyTextures;if(!u(i))return;let n=i.length;for(let t=0;t<n;t++){let n=i[t].properties;for(let t in n)if(n.hasOwnProperty(t)){let i=n[t].textureReader;u(i.texture)&&e.addTexture(i.texture)}}}Xae.process=function(e,t,i){let n=e.model,r=n.statistics;Kae(r,t),Zae(r,e.runtimePrimitive),$ae(r,t),Qae(r,t.material),Jae(r,t.featureIds),ece(r,n)};var EF=Xae,L6e=new L,N6e=new L,tce={name:"SceneMode2DPipelineStage",process:function(e,t,i){let n=en.getAttributeBySemantic(t,Tt.POSITION),r=e.shaderBuilder,o=e.model,a=o.sceneGraph.computedModelMatrix,s=e.runtimeNode.computedTransform,l=L.multiplyTransformation(a,s,L6e),c=k6e(e,l,i),h=e.runtimePrimitive;h.boundingSphere2D=c;let d=e.runtimeNode.node.instances;if(u(d))return;if(u(n.typedArray)){let e=z6e(n,l,c,i);h.positionBuffer2D=e,o._modelResources.push(e),n.typedArray=void 0}r.addDefine("USE_2D_POSITIONS",void 0,Ce.VERTEX),r.addUniform("mat4","u_modelView2D",Ce.VERTEX);let p=L.fromTranslation(c.center,new L),f=i.context,m={u_modelView2D:function(){return L.multiplyTransformation(f.uniformState.view,p,N6e)}};e.uniformMap=gt(m,e.uniformMap)}},F6e=new h,B6e=new h;function k6e(e,t,i){let n=L.multiplyByPoint(t,e.positionMin,F6e),r=$i.computeActualWgs84Position(i,n,n),o=L.multiplyByPoint(t,e.positionMax,B6e),a=$i.computeActualWgs84Position(i,o,o);return se.fromCornerPoints(r,a,new se)}var nce=new h;function V6e(e,t){let i=e.length,n=new Float32Array(i),r=t.quantizedVolumeOffset,o=t.quantizedVolumeStepSize;for(let t=0;t<i;t+=3){let i=h.fromArray(e,t,nce),a=h.multiplyComponents(i,o,i),s=h.add(a,r,a);n[t]=s.x,n[t+1]=s.y,n[t+2]=s.z}return n}function U6e(e,t,i,n){let r;r=u(e.quantization)?V6e(e.typedArray,e.quantization):e.typedArray.slice();let o=e.byteOffset/Float32Array.BYTES_PER_ELEMENT,a=r.length,s=u(e.byteStride)?e.byteStride/Float32Array.BYTES_PER_ELEMENT:3;for(let e=o;e<a;e+=s){let o=h.fromArray(r,e,nce);if(isNaN(o.x)||isNaN(o.y)||isNaN(o.z))continue;let a=L.multiplyByPoint(t,o,o),s=$i.computeActualWgs84Position(n,a,a),l=h.subtract(s,i,s);r[e]=l.x,r[e+1]=l.y,r[e+2]=l.z}return r}function z6e(e,t,i,n){let r=Ge(n);r.mode=te.COLUMBUS_VIEW;let o=U6e(e,t,i.center,r),a=ut.createVertexBuffer({context:n.context,typedArray:o,usage:Be.STATIC_DRAW});return a.vertexArrayDestroyable=!1,a}var SF=tce,wF="void skinningStage(inout ProcessedAttributes attributes) \n{\n    mat4 skinningMatrix = getSkinningMatrix();\n    mat3 skinningMatrixMat3 = mat3(skinningMatrix);\n\n    vec4 positionMC = vec4(attributes.positionMC, 1.0);\n    attributes.positionMC = vec3(skinningMatrix * positionMC);\n\n    #ifdef HAS_NORMALS\n    vec3 normalMC = attributes.normalMC;\n    attributes.normalMC = skinningMatrixMat3 * normalMC;\n    #endif\n\n    #ifdef HAS_TANGENTS\n    vec3 tangentMC = attributes.tangentMC;\n    attributes.tangentMC = skinningMatrixMat3 * tangentMC;\n    #endif\n}",nx={name:"SkinningPipelineStage",FUNCTION_ID_GET_SKINNING_MATRIX:"getSkinningMatrix",FUNCTION_SIGNATURE_GET_SKINNING_MATRIX:"mat4 getSkinningMatrix()"};function H6e(e){let t=-1,i=e.attributes,n=i.length;for(let e=0;e<n;e++){let n=i[e];(n.semantic===Tt.JOINTS||n.semantic===Tt.WEIGHTS)&&(t=Math.max(t,n.setIndex))}return t}function G6e(e,t){e.addFunction(nx.FUNCTION_ID_GET_SKINNING_MATRIX,nx.FUNCTION_SIGNATURE_GET_SKINNING_MATRIX,Ce.VERTEX);e.addFunctionLines(nx.FUNCTION_ID_GET_SKINNING_MATRIX,["mat4 skinnedMatrix = mat4(0);"]);let i,n,r=["x","y","z","w"],o=H6e(t);for(i=0;i<=o;i++)for(n=0;n<=3;n++){let t=r[n],o=`skinnedMatrix += a_weights_${i}.${t} * u_jointMatrices[int(a_joints_${i}.${t})];`;e.addFunctionLines(nx.FUNCTION_ID_GET_SKINNING_MATRIX,[o])}e.addFunctionLines(nx.FUNCTION_ID_GET_SKINNING_MATRIX,["return skinnedMatrix;"])}nx.process=function(e,t){let i=e.shaderBuilder;i.addDefine("HAS_SKINNING",void 0,Ce.VERTEX),G6e(i,t);let n=e.runtimeNode,r=n.computedJointMatrices;i.addUniform("mat4",`u_jointMatrices[${r.length}]`,Ce.VERTEX),i.addVertexLines(wF);let o={u_jointMatrices:function(){return n.computedJointMatrices}};e.uniformMap=gt(o,e.uniformMap)};var vF=nx,ice={name:"WireframePipelineStage"};function W6e(e,t,i){let n,r=en.getAttributeBySemantic(e,Tt.POSITION).count,o=i.context.webgl2;if(u(t)){let e=t.buffer,i=t.count;u(e)&&o?(n=e.sizeInBytes===i?new Uint8Array(i):ke.createTypedArray(r,i),e.getBufferData(n)):n=t.typedArray}let a=e.primitiveType,s=$S.createWireframeIndices(a,r,n),l=ke.fromSizeInBytes(s.BYTES_PER_ELEMENT);return ut.createIndexBuffer({context:i.context,typedArray:s,usage:Be.STATIC_DRAW,indexDatatype:l})}ice.process=function(e,t,i){e.shaderBuilder.addDefine("HAS_WIREFRAME",void 0,Ce.FRAGMENT);let n=e.model,r=W6e(t,e.indices,i);n._pipelineResources.push(r),e.wireframeIndexBuffer=r;n.statistics.addBuffer(r,!1);let o=e.primitiveType,a=e.count;e.primitiveType=Ne.LINES,e.count=$S.getWireframeIndicesCount(o,a)};var DF=ice;function oce(e){let t=(e=y(e,y.EMPTY_OBJECT)).primitive,i=e.node,n=e.model;this.primitive=t,this.node=i,this.model=n,this.pipelineStages=[],this.drawCommand=void 0,this.boundingSphere=void 0,this.boundingSphere2D=void 0,this.positionBuffer2D=void 0,this.batchLengths=void 0,this.batchOffsets=void 0,this.updateStages=[]}function j6e(e,t,i){let n;return u(t.instances)&&(n=en.getFeatureIdsByLabel(t.instances.featureIds,e.instanceFeatureIdLabel),u(n))?{hasFeatureIds:!0,hasPropertyTable:u(n.propertyTableId)}:(n=en.getFeatureIdsByLabel(i.featureIds,e.featureIdLabel),u(n)?{hasFeatureIds:!0,hasPropertyTable:u(n.propertyTableId)}:{hasFeatureIds:!1,hasPropertyTable:!1})}oce.prototype.configurePipeline=function(e){let t=this.pipelineStages;t.length=0;let i=this.primitive,n=this.node,r=this.model,o=r.customShader,a=r.style,s=e.context.webgl2,l=e.mode!==te.SCENE3D&&!e.scene3DOnly&&r._projectTo2D,c=u(i.morphTargets)&&i.morphTargets.length>0,h=u(n.skin),d=u(o),p=!(d&&u(o.fragmentShaderText))||o.mode!==Dg.REPLACE_MATERIAL,f=en.hasQuantizedAttributes(i.attributes),m=r.debugWireframe&&Ne.isTriangles(i.primitiveType)&&(r._enableDebugWireframe||s),_=r.pointCloudShading,g=u(_)&&_.attenuation,y=u(_)&&_.backFaceCulling,v=i.primitiveType===Ne.POINTS&&(u(a)||g||y),b=r._enableShowOutline&&u(i.outlineCoordinates),A=j6e(r,n,i),T=u(r.classificationType);l&&t.push(SF),t.push(fF),m&&t.push(DF),T&&t.push($2),c&&t.push(gF),h&&t.push(vF),v&&t.push(bF),f&&t.push(cF),p&&t.push(pF),t.push(J0),t.push(rd),A.hasPropertyTable&&(t.push(tx),t.push(Z2),t.push(eF)),d&&t.push(aF),t.push(hF),r.allowPicking&&t.push(yF),b&&t.push(CF),t.push(K2),t.push(EF)};var IF=oce;function K9(e){e=y(e,y.EMPTY_OBJECT),this._sceneGraph=e.sceneGraph;let t=e.skin;this._skin=t,this._inverseBindMatrices=void 0,this._joints=[],this._jointMatrices=[],q6e(this)}function q6e(e){let t=e.skin,i=t.inverseBindMatrices;e._inverseBindMatrices=i;let n=t.joints,r=n.length,o=e.sceneGraph._runtimeNodes,a=e.joints,s=e._jointMatrices;for(let e=0;e<r;e++){let t=o[n[e].index];a.push(t);let r=rce(t,i[e],new L);s.push(r)}}function rce(e,t,i){let n=L.multiplyTransformation(e.transformToRoot,e.transform,i);return i=L.multiplyTransformation(n,t,i)}Object.defineProperties(K9.prototype,{skin:{get:function(){return this._skin}},sceneGraph:{get:function(){return this._sceneGraph}},inverseBindMatrices:{get:function(){return this._inverseBindMatrices}},joints:{get:function(){return this._joints}},jointMatrices:{get:function(){return this._jointMatrices}}}),K9.prototype.updateJointMatrices=function(){let e=this._jointMatrices,t=e.length;for(let i=0;i<t;i++){let t=this.joints[i],n=this.inverseBindMatrices[i];e[i]=rce(t,n,e[i])}};var PF=K9;function Y6e(){this.pass=void 0,this.alphaCutoff=void 0}var OF=Y6e;function X6e(e){this.shaderBuilder=new aA,this.model=e,this.uniformMap={},this.alphaOptions=new OF,this.renderStateOptions=Ue.getState(Ue.fromCache({depthTest:{enabled:!0,func:yc.LESS_OR_EQUAL}})),this.hasSilhouette=!1,this.hasSkipLevelOfDetail=!1}var RF=X6e,MF="void silhouetteStage(inout vec4 color) {\n    if(model_silhouettePass) {\n        color = czm_gammaCorrect(model_silhouetteColor);\n    }\n}",LF="void silhouetteStage(in ProcessedAttributes attributes, inout vec4 positionClip) {\n     #ifdef HAS_NORMALS\n     if(model_silhouettePass) {\n          vec3 normal = normalize(czm_normal3D * attributes.normalMC);\n          normal.x *= czm_projection[0][0];\n          normal.y *= czm_projection[1][1];\n          positionClip.xy += normal.xy * positionClip.w * model_silhouetteSize * czm_pixelRatio / czm_viewport.z;\n    }\n    #endif\n}\n",NF={name:"ModelSilhouettePipelineStage",silhouettesLength:0,process:function(e,t,i){u(t._silhouetteId)||(t._silhouetteId=++NF.silhouettesLength);let n=e.shaderBuilder;n.addDefine("HAS_SILHOUETTE",void 0,Ce.BOTH),n.addVertexLines(LF),n.addFragmentLines(MF),n.addUniform("vec4","model_silhouetteColor",Ce.FRAGMENT),n.addUniform("float","model_silhouetteSize",Ce.VERTEX),n.addUniform("bool","model_silhouettePass",Ce.BOTH);let r={model_silhouetteColor:function(){return t.silhouetteColor},model_silhouetteSize:function(){return t.silhouetteSize},model_silhouettePass:function(){return!1}};e.uniformMap=gt(r,e.uniformMap),e.hasSilhouette=!0}},FF=NF,BF="void modelSplitterStage()\n{\n    // Don't split when rendering the shadow map, because it is rendered from\n    // the perspective of a totally different camera.\n#ifndef SHADOW_MAP\n    if (model_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard;\n    if (model_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard;\n#endif\n}\n",kF={name:"ModelSplitterPipelineStage",SPLIT_DIRECTION_UNIFORM_NAME:"model_splitDirection",process:function(e,t,i){let n=e.shaderBuilder;n.addDefine("HAS_MODEL_SPLITTER",void 0,Ce.FRAGMENT),n.addFragmentLines(BF);let r={};n.addUniform("float",kF.SPLIT_DIRECTION_UNIFORM_NAME,Ce.FRAGMENT),r[kF.SPLIT_DIRECTION_UNIFORM_NAME]=function(){return t.splitDirection},e.uniformMap=gt(r,e.uniformMap)}},VF=kF;function K6e(e,t){this.model=e.model,this.shaderBuilder=e.shaderBuilder.clone(),this.uniformMap=Ge(e.uniformMap),this.alphaOptions=Ge(e.alphaOptions),this.renderStateOptions=Ge(e.renderStateOptions,!0),this.hasSilhouette=e.hasSilhouette,this.hasSkipLevelOfDetail=e.hasSkipLevelOfDetail,this.runtimeNode=t,this.attributes=[],this.attributeIndex=1,this.featureIdVertexAttributeSetIndex=0,this.instanceCount=0}var UF=K6e;function Z6e(e){e=y(e,y.EMPTY_OBJECT),this.lightingModel=y(e.lightingModel,gp.UNLIT)}var zF=Z6e;function $6e(e,t){this.model=e.model,this.runtimeNode=e.runtimeNode,this.attributes=e.attributes.slice(),this.attributeIndex=e.attributeIndex,this.featureIdVertexAttributeSetIndex=e.featureIdVertexAttributeSetIndex,this.uniformMap=Ge(e.uniformMap),this.alphaOptions=Ge(e.alphaOptions),this.renderStateOptions=Ge(e.renderStateOptions,!0),this.hasSilhouette=e.hasSilhouette,this.hasSkipLevelOfDetail=e.hasSkipLevelOfDetail,this.shaderBuilder=e.shaderBuilder.clone(),this.instanceCount=e.instanceCount,this.runtimePrimitive=t;let i=t.primitive;this.count=u(i.indices)?i.indices.count:en.getAttributeBySemantic(i,"POSITION").count,this.hasPropertyTable=!1,this.indices=i.indices,this.wireframeIndexBuffer=void 0,this.primitiveType=i.primitiveType;let n=en.getPositionMinMax(i,this.runtimeNode.instancingTranslationMin,this.runtimeNode.instancingTranslationMax);this.positionMin=h.clone(n.min,new h),this.positionMax=h.clone(n.max,new h),this.boundingSphere=se.fromCornerPoints(this.positionMin,this.positionMax,new se),this.lightingOptions=new zF,this.pickId=void 0}var HF=$6e;function Yl(e){let t=(e=y(e,y.EMPTY_OBJECT)).modelComponents;this._model=e.model,this._components=t,this._pipelineStages=[],this._updateStages=[],this._runtimeNodes=[],this._rootNodes=[],this._skinnedNodes=[],this._runtimeSkins=[],this.modelPipelineStages=[],this._boundingSphere=void 0,this._boundingSphere2D=void 0,this._computedModelMatrix=L.clone(L.IDENTITY),this._computedModelMatrix2D=L.clone(L.IDENTITY),this._axisCorrectionMatrix=en.getAxisCorrectionMatrix(t.upAxis,t.forwardAxis,new L),this._runtimeArticulations={},Q6e(this)}function Q6e(e){let t=e._components,i=t.scene;sce(e,e._model.modelMatrix);let n=t.articulations,r=n.length,o=e._runtimeArticulations;for(let t=0;t<r;t++){let i=n[t],r=new F2({articulation:i,sceneGraph:e});o[r.name]=r}let a=t.nodes,s=a.length;e._runtimeNodes=new Array(s);let l=i.nodes.length,u=L.IDENTITY;for(let t=0;t<l;t++){let n=ace(e,i.nodes[t],u);e._rootNodes.push(n)}let c=t.skins,h=e._runtimeSkins,d=c.length;for(let t=0;t<d;t++){let i=c[t];h.push(new PF({skin:i,sceneGraph:e}))}let p=e._skinnedNodes,f=p.length;for(let t=0;t<f;t++){let i=p[t],n=e._runtimeNodes[i],r=a[i].skin.index;n._runtimeSkin=h[r],n.updateJointMatrices()}e.applyArticulations()}function sce(e,t){let i=e._components,n=e._model;e._computedModelMatrix=L.multiplyTransformation(t,i.transform,e._computedModelMatrix),e._computedModelMatrix=L.multiplyTransformation(e._computedModelMatrix,e._axisCorrectionMatrix,e._computedModelMatrix),e._computedModelMatrix=L.multiplyByUniformScale(e._computedModelMatrix,n.computedScale,e._computedModelMatrix)}Object.defineProperties(Yl.prototype,{components:{get:function(){return this._components}},computedModelMatrix:{get:function(){return this._computedModelMatrix}},axisCorrectionMatrix:{get:function(){return this._axisCorrectionMatrix}},boundingSphere:{get:function(){return this._boundingSphere}}});var J6e=new h;function e9e(e,t){let i=e._computedModelMatrix,n=L.getTranslation(i,J6e);if(h.equals(n,h.ZERO)){let n=e.boundingSphere.center,r=Rt.wgs84To2DModelMatrix(t.mapProjection,n,e._computedModelMatrix2D);e._computedModelMatrix2D=L.multiply(r,i,e._computedModelMatrix2D)}else e._computedModelMatrix2D=Rt.basisTo2D(t.mapProjection,i,e._computedModelMatrix2D);e._boundingSphere2D=se.transform(e._boundingSphere,e._computedModelMatrix2D,e._boundingSphere2D)}function ace(e,t,i){let n=[],r=en.getNodeTransform(t),o=t.children.length;for(let a=0;a<o;a++){let o=ace(e,t.children[a],L.multiplyTransformation(i,r,new L));n.push(o)}let a=new X2({node:t,transform:r,transformToRoot:i,children:n,sceneGraph:e}),s=t.primitives.length;for(let i=0;i<s;i++)a.runtimePrimitives.push(new IF({primitive:t.primitives[i],node:t,model:e._model}));let l=t.index;e._runtimeNodes[l]=a,u(t.skin)&&e._skinnedNodes.push(l);let c=t.name;if(u(c)){let t=e._model,i=new U2(t,a);t._nodesByName[c]=i}return l}var t9e=new h,n9e=new h,i9e=new h,o9e=new h;function cce(e,t,i,n,r){if(i&&!t.show)return;let o=t.children.length;for(let a=0;a<o;a++){cce(e,t.getChild(a),i,n,r)}let a=t.runtimePrimitives,s=a.length;for(let e=0;e<s;e++){n(a[e],r)}}function GF(e,t,i,n){let r=e._rootNodes,o=r.length;for(let a=0;a<o;a++){let o=r[a];cce(e,e._runtimeNodes[o],t,i,n)}}Yl.prototype.buildDrawCommands=function(e){let t=this._model,i=new RF(t);t.statistics.clear(),this.configurePipeline(e);let n,r,o,a=this.modelPipelineStages;for(n=0;n<a.length;n++)a[n].process(i,t,e);let s=h.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,t9e),l=h.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,n9e);for(n=0;n<this._runtimeNodes.length;n++){let t=this._runtimeNodes[n];if(!u(t))continue;t.configurePipeline();let a=t.pipelineStages,c=new UF(i,t);for(r=0;r<a.length;r++)a[r].process(c,t.node,e);let d=t.computedTransform;for(r=0;r<t.runtimePrimitives.length;r++){let i=t.runtimePrimitives[r];i.configurePipeline(e);let n=i.pipelineStages,a=new HF(c,i);for(o=0;o<n.length;o++)n[o].process(a,i.primitive,e);i.boundingSphere=se.clone(a.boundingSphere,new se);let u=L.multiplyByPoint(d,a.positionMin,i9e),p=L.multiplyByPoint(d,a.positionMax,o9e);h.minimumByComponent(s,u,s),h.maximumByComponent(l,p,l);let f=P2(a,e);i.drawCommand=f}}this._boundingSphere=se.fromCornerPoints(s,l,new se),this._boundingSphere=se.transformWithoutScale(this._boundingSphere,this._axisCorrectionMatrix,this._boundingSphere),this._boundingSphere=se.transform(this._boundingSphere,this._components.transform,this._boundingSphere),t._boundingSphere=se.transform(this._boundingSphere,t.modelMatrix,t._boundingSphere),t._initialRadius=t._boundingSphere.radius,t._boundingSphere.radius*=t._clampedScale},Yl.prototype.configurePipeline=function(e){let t=this.modelPipelineStages;t.length=0;let i=this._model;u(i.color)&&t.push(Q0),!u(i.classificationType)&&(i.imageBasedLighting.enabled&&t.push(M2),i.isClippingEnabled()&&t.push(V2),i.hasSilhouette(e)&&t.push(FF),u(i.splitDirection)&&i.splitDirection!==al.NONE&&t.push(VF),lr.is3DTiles(i.type)&&t.push(O2))},Yl.prototype.update=function(e,t){let i,n,r;for(i=0;i<this._runtimeNodes.length;i++){let o=this._runtimeNodes[i];if(!u(o))continue;for(n=0;n<o.updateStages.length;n++)o.updateStages[n].update(o,this,e);let a=e.mode!==te.SCENE3D&&this._model._projectTo2D;for(t&&!a&&this.updateJointMatrices(),n=0;n<o.runtimePrimitives.length;n++){let e=o.runtimePrimitives[n];for(r=0;r<e.updateStages.length;r++)e.updateStages[r].update(e,this)}}},Yl.prototype.updateModelMatrix=function(e,t){sce(this,e),t.mode!==te.SCENE3D&&e9e(this,t);let i=this._rootNodes;for(let e=0;e<i.length;e++){this._runtimeNodes[i[e]]._transformDirty=!0}},Yl.prototype.updateJointMatrices=function(){let e=this._skinnedNodes,t=e.length;for(let i=0;i<t;i++){let t=e[i];this._runtimeNodes[t].updateJointMatrices()}};var r9e={backFaceCulling:void 0};function s9e(e,t){e.drawCommand.backFaceCulling=t.backFaceCulling}Yl.prototype.updateBackFaceCulling=function(e){let t=r9e;t.backFaceCulling=e,GF(this,!1,s9e,t)};var a9e={shadowMode:void 0};function c9e(e,t){e.drawCommand.shadows=t.shadowMode}Yl.prototype.updateShadows=function(e){let t=a9e;t.shadowMode=e,GF(this,!1,c9e,t)};var l9e={debugShowBoundingVolume:void 0};function u9e(e,t){e.drawCommand.debugShowBoundingVolume=t.debugShowBoundingVolume}Yl.prototype.updateShowBoundingVolume=function(e){let t=l9e;t.debugShowBoundingVolume=e,GF(this,!1,u9e,t)};var lce=[],f9e={frameState:void 0,hasSilhouette:void 0};function d9e(e,t){let i=t.frameState,n=t.hasSilhouette,r=i.passes,o=lce,a=e.drawCommand;a.pushCommands(i,i.commandList),n&&!r.pick&&a.pushSilhouetteCommands(i,o)}Yl.prototype.pushDrawCommands=function(e){let t=lce;t.length=0;let i=f9e;i.hasSilhouette=this._model.hasSilhouette(e),i.frameState=e,GF(this,!0,d9e,i),e.commandList.push.apply(e.commandList,t)},Yl.prototype.setArticulationStage=function(e,t){let i=e.split(" ");if(2!==i.length)return;let n=i[0],r=i[1],o=this._runtimeArticulations[n];u(o)&&o.setArticulationStage(r,t)},Yl.prototype.applyArticulations=function(){let e=this._runtimeArticulations;for(let t in e)e.hasOwnProperty(t)&&e[t].apply()};var WF=Yl;function IA(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdSet={},this._batchTextureIdMap=new bt}Object.defineProperties(IA.prototype,{batchTexturesByteLength:{get:function(){let e=this._batchTextureIdMap.length,t=this._batchTextureIdMap.values,i=0;for(let n=0;n<e;n++)i+=t[n].byteLength;return i}}}),IA.prototype.clear=function(){this.pointsLength=0,this.trianglesLength=0,this.geometryByteLength=0,this.texturesByteLength=0,this.propertyTablesByteLength=0,this._bufferIdSet={},this._textureIdSet={},this._batchTextureIdMap.removeAll()},IA.prototype.addBuffer=function(e,t){if(!this._bufferIdSet.hasOwnProperty(e._id)){let i=t?2:1;this.geometryByteLength+=e.sizeInBytes*i}this._bufferIdSet[e._id]=!0},IA.prototype.addTexture=function(e){this._textureIdSet.hasOwnProperty(e._id)||(this.texturesByteLength+=e.sizeInBytes),this._textureIdSet[e._id]=!0},IA.prototype.addBatchTexture=function(e){this._batchTextureIdMap.contains(e._id)||this._batchTextureIdMap.set(e._id,e)};var jF=IA,hce=or(qI(),1),uce={},ix=Uint32Array.BYTES_PER_ELEMENT;function h9e(e,t){let i,n,r,o,a,s,l,c,h,d=e.json,p=u(d.extensions)?d.extensions["3DTILES_draco_point_compression"]:void 0,f=u(t)&&u(t.extensions)?t.extensions["3DTILES_draco_point_compression"]:void 0;if(u(f)&&(r=f.properties),u(p)){n=p.properties;let t=p.byteOffset,r=p.byteLength;if(!u(n)||!u(t)||!u(r))throw new ue("Draco properties, byteOffset, and byteLength must be defined");i=e.buffer.slice(t,t+r),o=u(n.POSITION),a=u(n.RGB)||u(n.RGBA),s=u(n.NORMAL),l=u(n.BATCH_ID),c=u(n.RGBA)}return u(i)&&(h={buffer:i,featureTableProperties:n,batchTableProperties:r,properties:gt(n,r),dequantizeInShader:!0}),{draco:h,hasPositions:o,hasColors:a,isTranslucent:c,hasNormals:s,hasBatchIds:l}}function m9e(e){let t,i=e.json;if(u(i.POSITION))return t=e.getPropertyArray("POSITION",X.FLOAT,3),{name:Tt.POSITION,semantic:Tt.POSITION,typedArray:t,isQuantized:!1,componentDatatype:X.FLOAT,type:nn.VEC3};if(u(i.POSITION_QUANTIZED)){t=e.getPropertyArray("POSITION_QUANTIZED",X.UNSIGNED_SHORT,3);let i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",X.FLOAT,3);if(!u(i))throw new ue("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");let n=65535,r=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",X.FLOAT,3);if(!u(r))throw new ue("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");return{name:Tt.POSITION,semantic:Tt.POSITION,typedArray:t,isQuantized:!0,componentDatatype:X.FLOAT,type:nn.VEC3,quantizedRange:n,quantizedVolumeOffset:h.unpack(r),quantizedVolumeScale:h.unpack(i),quantizedComponentDatatype:X.UNSIGNED_SHORT,quantizedType:nn.VEC3}}}function p9e(e){let t,i=e.json;if(u(i.RGBA))return t=e.getPropertyArray("RGBA",X.UNSIGNED_BYTE,4),{name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,typedArray:t,componentDatatype:X.UNSIGNED_BYTE,type:nn.VEC4,normalized:!0,isRGB565:!1,isTranslucent:!0};if(u(i.RGB))return t=e.getPropertyArray("RGB",X.UNSIGNED_BYTE,3),{name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:t,componentDatatype:X.UNSIGNED_BYTE,type:nn.VEC3,normalized:!0,isRGB565:!1,isTranslucent:!1};if(u(i.RGB565))return t=e.getPropertyArray("RGB565",X.UNSIGNED_SHORT,1),{name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:t,componentDatatype:X.FLOAT,type:nn.VEC3,normalized:!1,isRGB565:!0,isTranslucent:!1};if(u(i.CONSTANT_RGBA)){let t=e.getGlobalProperty("CONSTANT_RGBA",X.UNSIGNED_BYTE,4),i=t[3],n=z.fromBytes(t[0],t[1],t[2],i),r=i<255;return{name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,constantColor:n,componentDatatype:X.FLOAT,type:nn.VEC4,isQuantized:!1,isTranslucent:r}}}function _9e(e){let t,i=e.json;if(u(i.NORMAL))return t=e.getPropertyArray("NORMAL",X.FLOAT,3),{name:Tt.NORMAL,semantic:Tt.NORMAL,typedArray:t,octEncoded:!1,octEncodedZXY:!1,componentDatatype:X.FLOAT,type:nn.VEC3};if(u(i.NORMAL_OCT16P)){t=e.getPropertyArray("NORMAL_OCT16P",X.UNSIGNED_BYTE,2);let i=8;return{name:Tt.NORMAL,semantic:Tt.NORMAL,typedArray:t,octEncoded:!0,octEncodedZXY:!1,quantizedRange:(1<<i)-1,quantizedType:nn.VEC2,quantizedComponentDatatype:X.UNSIGNED_BYTE,componentDatatype:X.FLOAT,type:nn.VEC3}}}function g9e(e){let t=e.json;if(u(t.BATCH_ID)){let t=e.getPropertyArray("BATCH_ID",X.UNSIGNED_SHORT,1);return{name:Tt.FEATURE_ID,semantic:Tt.FEATURE_ID,setIndex:0,typedArray:t,componentDatatype:X.fromTypedArray(t),type:nn.SCALAR}}}uce.parse=function(e,t){t=y(t,0);let i=new Uint8Array(e),n=new DataView(e);t+=ix;let r=n.getUint32(t,!0);if(1!==r)throw new ue(`Only Point Cloud tile version 1 is supported.  Version ${r} is not.`);t+=ix,t+=ix;let o=n.getUint32(t,!0);if(0===o)throw new ue("Feature table must have a byte length greater than zero");t+=ix;let a=n.getUint32(t,!0);t+=ix;let s=n.getUint32(t,!0);t+=ix;let l=n.getUint32(t,!0),c=So(i,t+=ix,o);t+=o;let d,p,f=new Uint8Array(e,t,a);t+=a,s>0&&(d=So(i,t,s),t+=s,l>0&&(p=new Uint8Array(e,t,l),t+=l));let m=new kh(c,f),_=m.getGlobalProperty("POINTS_LENGTH");if(m.featuresLength=_,!u(_))throw new ue("Feature table global property: POINTS_LENGTH must be defined");let g=m.getGlobalProperty("RTC_CENTER",X.FLOAT,3);u(g)&&(g=h.unpack(g));let v=h9e(m,d);if(v.rtcCenter=g,v.pointsLength=_,!v.hasPositions){let e=m9e(m);v.positions=e,v.hasPositions=v.hasPositions||u(e)}if(!v.hasPositions)throw new ue("Either POSITION or POSITION_QUANTIZED must be defined.");if(!v.hasNormals){let e=_9e(m);v.normals=e,v.hasNormals=v.hasNormals||u(e)}if(!v.hasColors){let e=p9e(m);v.colors=e,v.hasColors=v.hasColors||u(e),v.hasConstantColor=u(v.constantColor),v.isTranslucent=u(e)&&e.isTranslucent}if(!v.hasBatchIds){let e=g9e(m);v.batchIds=e,v.hasBatchIds=v.hasBatchIds||u(e)}if(v.hasBatchIds){let e=m.getGlobalProperty("BATCH_LENGTH");if(!u(e))throw new ue("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");v.batchLength=e}return u(p)&&(p=new Uint8Array(p),v.batchTableJson=d,v.batchTableBinary=p),v};var PA=uce,y9e=Mt.Components,x9e=Mt.Scene,b9e=Mt.Node,T9e=Mt.Primitive,A9e=Mt.Attribute,fce=Mt.Quantization,C9e=Mt.FeatureIdAttribute,E9e=Mt.Material,S9e=Mt.MetallicRoughness,dce,qF;function Pg(e){let t=(e=y(e,y.EMPTY_OBJECT)).arrayBuffer,i=y(e.byteOffset,0);this._arrayBuffer=t,this._byteOffset=i,this._loadAttributesFor2D=y(e.loadAttributesFor2D,!1),this._parsedContent=void 0,this._decodePromise=void 0,this._decodedAttributes=void 0,this._promise=void 0,this._error=void 0,this._state=St.UNLOADED,this._buffers=[],this._components=void 0,this._transform=L.IDENTITY}function w9e(e,t){let i,n=e._parsedContent.draco;if(i=u(n)?fg.decodePointCloud(n,t):Promise.resolve(),u(i))return e._decodePromise=i,i.then((function(i){if(!e.isDestroyed())return u(i)&&v9e(e,n,i),k9e(e,t),e._state=St.READY,e})).catch((function(t){e.unload(),e._state=St.FAILED;e._error=e.getError("Failed to load Draco pnts",t)}))}function v9e(e,t,i){e._state=St.READY;let n,r=e._parsedContent;if(u(i.POSITION)){if(n={name:"POSITION",semantic:Tt.POSITION,typedArray:i.POSITION.array,componentDatatype:X.FLOAT,type:nn.VEC3,isQuantized:!1},u(i.POSITION.data.quantization)){let e=i.POSITION.data.quantization,t=e.range,r=h.fromElements(t,t,t),o=h.unpack(e.minValues),a=(1<<e.quantizationBits)-1;n.isQuantized=!0,n.quantizedRange=a,n.quantizedVolumeOffset=o,n.quantizedVolumeScale=r,n.quantizedComponentDatatype=a<=255?X.UNSIGNED_BYTE:X.UNSIGNED_SHORT,n.quantizedType=nn.VEC3}r.positions=n}if(u(i.NORMAL)){if(n={name:"NORMAL",semantic:Tt.NORMAL,typedArray:i.NORMAL.array,componentDatatype:X.FLOAT,type:nn.VEC3,isQuantized:!1,octEncoded:!1,octEncodedZXY:!1},u(i.NORMAL.data.quantization)){let e=(1<<i.NORMAL.data.quantization.quantizationBits)-1;n.quantizedRange=e,n.octEncoded=!0,n.octEncodedZXY=!0,n.quantizedComponentDatatype=X.UNSIGNED_BYTE,n.quantizedType=nn.VEC2}r.normals=n}if(u(i.RGBA)?r.colors={name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:i.RGBA.array,componentDatatype:X.UNSIGNED_BYTE,type:nn.VEC4,normalized:!0,isTranslucent:!0}:u(i.RGB)&&(r.colors={name:"COLOR",semantic:Tt.COLOR,setIndex:0,typedArray:i.RGB.array,componentDatatype:X.UNSIGNED_BYTE,type:nn.VEC3,normalized:!0,isTranslucent:!1}),u(i.BATCH_ID)){let e=i.BATCH_ID.array;r.batchIds={name:"_FEATURE_ID",semantic:Tt.FEATURE_ID,setIndex:0,typedArray:e,componentDatatype:X.fromTypedArray(e),type:nn.SCALAR}}let o=r.batchTableJson,a=t.batchTableProperties;for(let e in a)if(a.hasOwnProperty(e)){let t=i[e];u(o)||(o={}),r.hasDracoBatchTable=!0;let n=t.data;o[e]={byteOffset:n.byteOffset,type:D9e(n.componentsPerAttribute),componentType:I9e(n.componentDatatype),typedArray:t.array}}r.batchTableJson=o}function D9e(e){switch(e){case 1:return"SCALAR";case 2:return"VEC2";case 3:return"VEC3";case 4:return"VEC4"}}function I9e(e){switch(e){case ee.BYTE:return"BYTE";case ee.UNSIGNED_BYTE:return"UNSIGNED_BYTE";case ee.SHORT:return"SHORT";case ee.UNSIGNED_SHORT:return"UNSIGNED_SHORT";case ee.INT:return"INT";case ee.UNSIGNED_INT:return"UNSIGNED_INT";case ee.DOUBLE:return"DOUBLE";case ee.FLOAT:return"FLOAT"}}function Yw(e,t,i){let n,r=t.typedArray;if(t.octEncoded&&(n=new fce,n.octEncoded=t.octEncoded,n.octEncodedZXY=t.octEncodedZXY,n.normalizationRange=t.quantizedRange,n.type=t.quantizedType,n.componentDatatype=t.quantizedComponentDatatype),t.isQuantized){n=new fce;let e=t.quantizedRange;n.normalizationRange=e,n.quantizedVolumeOffset=h.ZERO;let i=t.quantizedVolumeScale;n.quantizedVolumeDimensions=i,n.quantizedVolumeStepSize=h.divideByScalar(i,e,new h),n.componentDatatype=t.quantizedComponentDatatype,n.type=t.quantizedType}let o=new A9e;if(o.name=t.name,o.semantic=t.semantic,o.setIndex=t.setIndex,o.componentDatatype=t.componentDatatype,o.type=t.type,o.normalized=y(t.normalized,!1),o.min=t.min,o.max=t.max,o.quantization=n,t.isRGB565&&(r=Gn.decodeRGB565(r)),u(t.constantColor)){let e=new Array(4);o.constant=z.pack(t.constantColor,e)}else{let t=ut.createVertexBuffer({typedArray:r,context:i,usage:Be.STATIC_DRAW});t.vertexArrayDestroyable=!1,e._buffers.push(t),o.buffer=t}let a=e._loadAttributesFor2D;return o.semantic===Tt.POSITION&&a&&(o.typedArray=r),o}function P9e(e){if(!u(qF)){dce=new hce.default(0),qF=new Array(e);for(let t=0;t<e;++t)qF[t]=dce.random()}return qF}u(Object.create)&&(Pg.prototype=Object.create(io.prototype),Pg.prototype.constructor=Pg),Object.defineProperties(Pg.prototype,{cacheKey:{get:function(){}},components:{get:function(){return this._components}},transform:{get:function(){return this._transform}}}),Pg.prototype.load=function(){if(u(this._promise))return this._promise;this._parsedContent=PA.parse(this._arrayBuffer,this._byteOffset),this._state=St.PROCESSING,this._promise=Promise.resolve(this)},Pg.prototype.process=function(e){if(u(this._error)){let e=this._error;throw this._error=void 0,e}if(this._state===St.READY)return!0;if(this._state===St.PROCESSING){if(u(this._decodePromise))return!1;this._decodePromise=w9e(this,e.context)}return!1};var O9e=new h,R9e=new h,M9e=new h;function L9e(e){let t,i,n,r=e.typedArray,o=r.length/3,a=Math.min(o,20),s=P9e(20),l=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=h.fromElements(l,l,l,O9e),d=h.fromElements(u,u,u,R9e);if(e.isQuantized)c=h.ZERO,d=e.quantizedVolumeScale;else for(t=0;t<a;++t)i=Math.floor(s[t]*o),n=h.unpack(r,3*i,M9e),h.minimumByComponent(c,n,c),h.maximumByComponent(d,n,d);e.min=h.clone(c),e.max=h.clone(d)}var N9e={name:Tt.COLOR,semantic:Tt.COLOR,setIndex:0,constantColor:z.DARKGRAY,componentDatatype:X.FLOAT,type:nn.VEC4,isQuantized:!1,isTranslucent:!1};function F9e(e,t,i){let n,r=[],o=t.positions;return u(o)&&(L9e(o),n=Yw(e,o,i),n.count=t.pointsLength,r.push(n)),u(t.normals)&&(n=Yw(e,t.normals,i),r.push(n)),u(t.colors)?(n=Yw(e,t.colors,i),r.push(n)):(n=Yw(e,N9e,i),r.push(n)),u(t.batchIds)&&(n=Yw(e,t.batchIds,i),r.push(n)),r}function B9e(e,t){let i=e.batchLength,n=e.pointsLength,r=e.batchTableBinary,o=!u(e.batchIds);if(u(r)||e.hasDracoBatchTable){let a=y(i,n);return Cg({count:a,batchTable:e.batchTableJson,binaryBody:r,parseAsPropertyAttributes:o,customAttributeOutput:t})}return new ja({schema:{},propertyTables:[]})}function k9e(e,t){let i=e._parsedContent,n=new S9e;n.metallicFactor=0,n.roughnessFactor=.9;let r=new E9e;r.metallicRoughness=n;let o=i.colors;u(o)&&o.isTranslucent&&(r.alphaMode=Ym.BLEND);let a=!u(i.normals);r.unlit=a;let s=new T9e;if(s.attributes=F9e(e,i,t),s.primitiveType=Ne.POINTS,s.material=r,u(i.batchIds)){let e=new C9e;e.propertyTableId=0,e.setIndex=0,e.positionalLabel="featureId_0",s.featureIds.push(e)}let l=new b9e;l.index=0,l.primitives=[s];let c=new x9e;c.nodes=[l],c.upAxis=wo.Z,c.forwardAxis=wo.X;let h=new y9e;h.scene=c,h.nodes=[l];let d=[];h.structuralMetadata=B9e(i,d),d.length>0&&V9e(e,s,d,t),u(i.rtcCenter)&&(h.transform=L.multiplyByTranslation(h.transform,i.rtcCenter,h.transform));let p=i.positions;u(p)&&p.isQuantized&&(h.transform=L.multiplyByTranslation(h.transform,p.quantizedVolumeOffset,h.transform)),e._components=h,e._parsedContent=void 0,e._arrayBuffer=void 0}function V9e(e,t,i,n){let r=t.attributes,o=i.length;for(let t=0;t<o;t++){let o=i[t],a=ut.createVertexBuffer({typedArray:o.typedArray,context:n,usage:Be.STATIC_DRAW});a.vertexArrayDestroyable=!1,e._buffers.push(a),o.buffer=a,o.typedArray=void 0,r.push(o)}t.propertyAttributeIds=[0]}Pg.prototype.unload=function(){let e=this._buffers;for(let t=0;t<e.length;t++)e[t].destroy();e.length=0,this._components=void 0,this._parsedContent=void 0,this._arrayBuffer=void 0};var YF=Pg;function yo(e){e=y(e,y.EMPTY_OBJECT),this._loader=e.loader,this._resource=e.resource,this.type=y(e.type,lr.GLTF),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=L.clone(this.modelMatrix),this._scale=y(e.scale,1),this._minimumPixelSize=y(e.minimumPixelSize,0),this._maximumScale=e.maximumScale,this._clampedScale=u(this._maximumScale)?Math.min(this._scale,this._maximumScale):this._scale,this._computedScale=this._clampedScale,this._updateModelMatrix=!1,this.referenceMatrix=void 0,this._iblReferenceFrameMatrix=$.clone($.IDENTITY),this._resourcesLoaded=!1,this._drawCommandsBuilt=!1,this._ready=!1,this._customShader=e.customShader,this._content=e.content,this._texturesLoaded=!1,this._defaultTexture=void 0,this._activeAnimations=new A2(this),this._clampAnimations=y(e.clampAnimations,!0),this._userAnimationDirty=!1,this._id=e.id,this._idDirty=!1,this._color=z.clone(e.color),this._colorBlendMode=y(e.colorBlendMode,xc.HIGHLIGHT),this._colorBlendAmount=y(e.colorBlendAmount,.5);let t=y(e.silhouetteColor,z.RED);this._silhouetteColor=z.clone(t),this._silhouetteSize=y(e.silhouetteSize,0),this._silhouetteDirty=!1,this._silhouetteId=void 0,this._cull=y(e.cull,!0),this._opaquePass=y(e.opaquePass,Ee.OPAQUE),this._allowPicking=y(e.allowPicking,!0),this._show=y(e.show,!0),this._style=void 0,this._styleDirty=!1,this._styleCommandsNeeded=void 0;let i=y(e.featureIdLabel,"featureId_0");"number"==typeof i&&(i=`featureId_${i}`),this._featureIdLabel=i;let n=y(e.instanceFeatureIdLabel,"instanceFeatureId_0");"number"==typeof n&&(n=`instanceFeatureId_${n}`),this._instanceFeatureIdLabel=n,this._featureTables=[],this._featureTableId=void 0,this._featureTableIdDirty=!0,this._pipelineResources=[],this._modelResources=[],this._pickIds=[],this._boundingSphere=new se,this._initialRadius=void 0,this._heightReference=y(e.heightReference,We.NONE),this._heightDirty=this._heightReference!==We.NONE,this._removeUpdateHeightCallback=void 0,this._clampedModelMatrix=void 0;let r=e.scene;u(r)&&u(r.terrainProviderChanged)&&(this._terrainProviderChangedCallback=r.terrainProviderChanged.addEventListener((function(){this._heightDirty=!0}),this)),this._scene=r,this._distanceDisplayCondition=e.distanceDisplayCondition;let o=new dp(e.pointCloudShading);this._pointCloudShading=o,this._attenuation=o.attenuation,this._pointCloudBackFaceCulling=o.backFaceCulling;let a=e.clippingPlanes;u(a)&&void 0===a.owner?ys.setOwner(a,this,"_clippingPlanes"):this._clippingPlanes=a,this._clippingPlanesState=0,this._clippingPlanesMatrix=L.clone(L.IDENTITY),this._lightColor=h.clone(e.lightColor),this._imageBasedLighting=u(e.imageBasedLighting)?e.imageBasedLighting:new CA,this._shouldDestroyImageBasedLighting=!u(e.imageBasedLighting),this._backFaceCulling=y(e.backFaceCulling,!0),this._backFaceCullingDirty=!1,this._shadows=y(e.shadows,yn.ENABLED),this._shadowsDirty=!1,this._debugShowBoundingVolumeDirty=!1,this._debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this._enableDebugWireframe=y(e.enableDebugWireframe,!1),this._enableShowOutline=y(e.enableShowOutline,!0),this._debugWireframe=y(e.debugWireframe,!1),!0===this._debugWireframe&&!1===this._enableDebugWireframe&&this.type===lr.GLTF&&It("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltf, otherwise debugWireframe will be ignored.");let s=e.credit;"string"==typeof s&&(s=new xt(s)),this._credits=[],this._credit=s,this._resourceCredits=[],this._gltfCredits=[],this._showCreditsOnScreen=y(e.showCreditsOnScreen,!1),this._showCreditsOnScreenDirty=!0,this._splitDirection=y(e.splitDirection,al.NONE),this._enableShowOutline=y(e.enableShowOutline,!0),this.showOutline=y(e.showOutline,!0),this.outlineColor=y(e.outlineColor,z.BLACK),this._classificationType=e.classificationType,this._statistics=new jF,this._sceneMode=void 0,this._projectTo2D=y(e.projectTo2D,!1),this._skipLevelOfDetail=!1,this._ignoreCommands=y(e.ignoreCommands,!1),this._errorEvent=new pe,this._readyEvent=new pe,this._texturesReadyEvent=new pe,this._sceneGraph=void 0,this._nodesByName={},this.pickObject=e.pickObject}function Z9(e,t){e._errorEvent.numberOfListeners>0?e._errorEvent.raiseEvent(t):console.log(t)}function U9e(e,t){let i=e._featureTables,n=t.propertyTables,r=n.length;for(let t=0;t<r;t++){let r=n[t],o=new E2({model:e,propertyTable:r});i.push(o)}return i}function z9e(e,t){let i,n,r,o,a=t._featureIdLabel,s=t._instanceFeatureIdLabel;for(i=0;i<e.nodes.length;i++)if(o=e.nodes[i],u(o.instances)&&(r=en.getFeatureIdsByLabel(o.instances.featureIds,s),u(r)&&u(r.propertyTableId)))return r.propertyTableId;for(i=0;i<e.nodes.length;i++)for(o=e.nodes[i],n=0;n<o.primitives.length;n++){let e=o.primitives[n],t=en.getFeatureIdsByLabel(e.featureIds,a);if(u(t))return t.propertyTableId}if(1===t._featureTables.length)return 0}function Q9(e,t){if(!u(e)&&!u(t))return!1;if(u(e)!==u(t))return!0;let i=e.alpha,n=t.alpha;return Math.floor(i)!==Math.floor(n)||Math.ceil(i)!==Math.ceil(n)}Object.defineProperties(yo.prototype,{ready:{get:function(){return this._ready}},errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},incrementallyLoadTextures:{get:function(){return y(this._loader.incrementallyLoadTextures,!1)}},texturesReadyEvent:{get:function(){return this._texturesReadyEvent}},loader:{get:function(){return this._loader}},statistics:{get:function(){return this._statistics}},activeAnimations:{get:function(){return this._activeAnimations}},clampAnimations:{get:function(){return this._clampAnimations},set:function(e){this._clampAnimations=e}},cull:{get:function(){return this._cull}},opaquePass:{get:function(){return this._opaquePass}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){e!==this._pointCloudShading&&this.resetDrawCommands(),this._pointCloudShading=e}},customShader:{get:function(){return this._customShader},set:function(e){e!==this._customShader&&this.resetDrawCommands(),this._customShader=e}},sceneGraph:{get:function(){return this._sceneGraph}},content:{get:function(){return this._content}},heightReference:{get:function(){return this._heightReference},set:function(e){e!==this._heightReference&&(this._heightDirty=!0),this._heightReference=e}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=wt.clone(e,this._distanceDisplayCondition)}},structuralMetadata:{get:function(){return this._sceneGraph.components.structuralMetadata}},featureTableId:{get:function(){return this._featureTableId},set:function(e){this._featureTableId=e}},featureTables:{get:function(){return this._featureTables},set:function(e){this._featureTables=e}},id:{get:function(){return this._id},set:function(e){e!==this._id&&(this._idDirty=!0),this._id=e}},allowPicking:{get:function(){return this._allowPicking}},style:{get:function(){return this._style},set:function(e){this._style=e,this._styleDirty=!0}},color:{get:function(){return this._color},set:function(e){Q9(e,this._color)&&this.resetDrawCommands(),this._color=z.clone(e,this._color)}},colorBlendMode:{get:function(){return this._colorBlendMode},set:function(e){this._colorBlendMode=e}},colorBlendAmount:{get:function(){return this._colorBlendAmount},set:function(e){this._colorBlendAmount=e}},silhouetteColor:{get:function(){return this._silhouetteColor},set:function(e){if(!z.equals(e,this._silhouetteColor)){let t=Q9(e,this._silhouetteColor);this._silhouetteDirty=this._silhouetteDirty||t}this._silhouetteColor=z.clone(e,this._silhouetteColor)}},silhouetteSize:{get:function(){return this._silhouetteSize},set:function(e){if(e!==this._silhouetteSize){let t=this._silhouetteSize,i=e>0&&0===t||0===e&&t>0;this._silhouetteDirty=this._silhouetteDirty||i,this._backFaceCullingDirty=this._backFaceCullingDirty||i}this._silhouetteSize=e}},boundingSphere:{get:function(){return _ce(this,u(this._clampedModelMatrix)?this._clampedModelMatrix:this.modelMatrix),this._boundingSphere}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolumeDirty=!0),this._debugShowBoundingVolume=e}},debugWireframe:{get:function(){return this._debugWireframe},set:function(e){this._debugWireframe!==e&&this.resetDrawCommands(),this._debugWireframe=e,!0===this._debugWireframe&&!1===this._enableDebugWireframe&&this.type===lr.GLTF&&It("model-debug-wireframe-ignored","enableDebugWireframe must be set to true in Model.fromGltfAsync, otherwise debugWireframe will be ignored.")}},show:{get:function(){return this._show},set:function(e){this._show=e}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){"number"==typeof e&&(e=`featureId_${e}`),e!==this._featureIdLabel&&(this._featureTableIdDirty=!0),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){"number"==typeof e&&(e=`instanceFeatureId_${e}`),e!==this._instanceFeatureIdLabel&&(this._featureTableIdDirty=!0),this._instanceFeatureIdLabel=e}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&(ys.setOwner(e,this,"_clippingPlanes"),this.resetDrawCommands())}},lightColor:{get:function(){return this._lightColor},set:function(e){u(e)!==u(this._lightColor)&&this.resetDrawCommands(),this._lightColor=h.clone(e,this._lightColor)}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1,this.resetDrawCommands())}},backFaceCulling:{get:function(){return this._backFaceCulling},set:function(e){e!==this._backFaceCulling&&(this._backFaceCullingDirty=!0),this._backFaceCulling=e}},scale:{get:function(){return this._scale},set:function(e){e!==this._scale&&(this._updateModelMatrix=!0),this._scale=e}},computedScale:{get:function(){return this._computedScale}},minimumPixelSize:{get:function(){return this._minimumPixelSize},set:function(e){e!==this._minimumPixelSize&&(this._updateModelMatrix=!0),this._minimumPixelSize=e}},maximumScale:{get:function(){return this._maximumScale},set:function(e){e!==this._maximumScale&&(this._updateModelMatrix=!0),this._maximumScale=e}},shadows:{get:function(){return this._shadows},set:function(e){e!==this._shadows&&(this._shadowsDirty=!0),this._shadows=e}},credit:{get:function(){return this._credit}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen!==e&&(this._showCreditsOnScreenDirty=!0),this._showCreditsOnScreen=e}},splitDirection:{get:function(){return this._splitDirection},set:function(e){this._splitDirection!==e&&this.resetDrawCommands(),this._splitDirection=e}},classificationType:{get:function(){return this._classificationType}},pickIds:{get:function(){return this._pickIds}},styleCommandsNeeded:{get:function(){return this._styleCommandsNeeded}}}),yo.prototype.getNode=function(e){return this._nodesByName[e]},yo.prototype.setArticulationStage=function(e,t){this._sceneGraph.setArticulationStage(e,t)},yo.prototype.applyArticulations=function(){this._sceneGraph.applyArticulations()},yo.prototype.makeStyleDirty=function(){this._styleDirty=!0},yo.prototype.resetDrawCommands=function(){this._drawCommandsBuilt=!1};var H9e=new L,G9e=new $,W9e=new L;function j9e(e,t){return!(!e._resourcesLoaded||e._loader.incrementallyLoadTextures&&!e._texturesLoaded)||(t.afterRender.push((()=>!0)),e._loader.process(t))}function q9e(e,t){u(e._customShader)&&e._customShader.update(t)}function Y9e(e,t){e._imageBasedLighting.update(t),e._imageBasedLighting.shouldRegenerateShaders&&e.resetDrawCommands()}function X9e(e){if(!e._featureTableIdDirty)return;e._featureTableIdDirty=!1;let t=e._sceneGraph.components,i=t.structuralMetadata;u(i)&&i.propertyTableCount>0&&(e.featureTableId=z9e(t,e),e._styleDirty=!0,e.resetDrawCommands())}function K9e(e){e._styleDirty&&(e.applyStyle(e._style),e._styleDirty=!1)}function Z9e(e,t){let i=e._featureTables,n=i.length,r=!1;for(let e=0;e<n;e++)i[e].update(t),i[e].styleCommandsNeededDirty&&(r=!0);r&&pce(e)}function pce(e){let t=e.featureTables[e.featureTableId];e._styleCommandsNeeded=Uh.getStyleCommandsNeeded(t.featuresLength,t.batchTexture.translucentFeaturesLength)}function $9e(e){let t=e.pointCloudShading;t.attenuation!==e._attenuation&&(e.resetDrawCommands(),e._attenuation=t.attenuation),t.backFaceCulling!==e._pointCloudBackFaceCulling&&(e.resetDrawCommands(),e._pointCloudBackFaceCulling=t.backFaceCulling)}function Q9e(e,t){e._silhouetteDirty&&(gce(t)&&e.resetDrawCommands(),e._silhouetteDirty=!1)}function J9e(e,t){let i=e.hasSkipLevelOfDetail(t);i!==e._skipLevelOfDetail&&(e.resetDrawCommands(),e._skipLevelOfDetail=i)}function eWe(e,t){let i=0;e.isClippingEnabled()&&(e._clippingPlanes.owner===e&&e._clippingPlanes.update(t),i=e._clippingPlanes.clippingPlanesState),i!==e._clippingPlanesState&&(e.resetDrawCommands(),e._clippingPlanesState=i)}function tWe(e,t){t.mode!==e._sceneMode&&(e._projectTo2D?e.resetDrawCommands():e._updateModelMatrix=!0,e._sceneMode=t.mode)}function nWe(e,t){e._drawCommandsBuilt||(e.destroyPipelineResources(),e._sceneGraph.buildDrawCommands(t),e._drawCommandsBuilt=!0)}function iWe(e,t){L.equals(e.modelMatrix,e._modelMatrix)||(e._updateModelMatrix=!0,e._modelMatrix=L.clone(e.modelMatrix,e._modelMatrix))}yo.prototype.update=function(e){let t=!1;try{t=j9e(this,e)}catch(e){if(this._loader.incrementallyLoadTextures||"TextureError"!==e.name){Z9(this,en.getError("model",this._resource,e))}else Z9(this,e)}if(q9e(this,e),Y9e(this,e),!this._resourcesLoaded&&t){this._resourcesLoaded=!0;let e=this._loader.components;if(!u(e)){if(this._loader.isUnloaded())return;let e=en.getError("model",this._resource,new ue("Failed to load model."));Z9(e),this._rejectLoad=this._rejectLoad&&this._rejectLoad(e)}let t=e.structuralMetadata;u(t)&&t.propertyTableCount>0&&U9e(this,t);let i=new WF({model:this,modelComponents:e});this._sceneGraph=i,this._gltfCredits=i.components.asset.credits}if(this._resourcesLoaded&&e.mode!==te.MORPHING){if(X9e(this),K9e(this),Z9e(this,e),$9e(this),Q9e(this,e),J9e(this,e),eWe(this,e),tWe(this,e),this._defaultTexture=e.context.defaultTexture,nWe(this,e),iWe(this,e),oWe(this),rWe(this,e),cWe(this,e),!this._ready)return void e.afterRender.push((()=>{this._ready=!0,this._readyEvent.raiseEvent(this)}));this._loader.incrementallyLoadTextures&&!this._texturesLoaded&&this._loader.texturesLoaded&&(this.resetDrawCommands(),this._texturesLoaded=!0,this._texturesReadyEvent.raiseEvent(this)),aWe(this),lWe(this,e),uWe(this),fWe(this,e)}};var zh=new h,XF=new fe;function oWe(e){if(!e._updateModelMatrix&&!e._heightDirty&&0===e._minimumPixelSize)return;u(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);let t=e._scene;if(!u(t)||!u(t.globe)||e.heightReference===We.NONE)return void(e._clampedModelMatrix=void 0);let i=t.globe,n=i.ellipsoid,r=e.modelMatrix;zh.x=r[12],zh.y=r[13],zh.z=r[14];let o=n.cartesianToCartographic(zh);u(e._clampedModelMatrix)||(e._clampedModelMatrix=L.clone(r,new L));let a=i._surface;e._removeUpdateHeightCallback=a.updateHeight(o,mce(e,n,o));let s=i.getHeight(o);if(u(s)){let t=mce(e,n,o);fe.clone(o,XF),XF.height=s,n.cartographicToCartesian(XF,zh),t(zh)}e._heightDirty=!1,e._updateModelMatrix=!0}function rWe(e,t){if(!e._updateModelMatrix&&0===e._minimumPixelSize)return;let i=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;_ce(e,i),sWe(e,i,t)}function _ce(e,t){e._clampedScale=u(e._maximumScale)?Math.min(e._scale,e._maximumScale):e._scale,e._boundingSphere.center=h.multiplyByScalar(e._sceneGraph.boundingSphere.center,e._clampedScale,e._boundingSphere.center),e._boundingSphere.radius=e._initialRadius*e._clampedScale,e._boundingSphere=se.transform(e._boundingSphere,t,e._boundingSphere)}function sWe(e,t,i){let n=e.scale;if(0!==e.minimumPixelSize&&!e._projectTo2D){let r=i.context,o=Math.max(r.drawingBufferWidth,r.drawingBufferHeight);L.getTranslation(t,zh),e._sceneMode!==te.SCENE3D&&$i.computeActualWgs84Position(i,zh,zh);let a=e._boundingSphere.radius,s=dWe(zh,a,i),l=1/s;Math.min(l*(2*a),o)<e.minimumPixelSize&&(n=e.minimumPixelSize*s/(2*e._initialRadius))}e._computedScale=u(e.maximumScale)?Math.min(e.maximumScale,n):n}function aWe(e){if(!e._idDirty)return;e._idDirty=!1;let t=e._id,i=e._pickIds,n=i.length;for(let e=0;e<n;++e)i[e].object.id=t}function cWe(e,t){let i=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix,n=y(e.referenceMatrix,i),r=t.context,o=e._imageBasedLighting;if(o.useSphericalHarmonicCoefficients||o.useSpecularEnvironmentMaps){let t=G9e,i=H9e;i=L.multiply(r.uniformState.view3D,n,i),t=L.getMatrix3(i,t),t=$.getRotation(t,t),e._iblReferenceFrameMatrix=$.transpose(t,e._iblReferenceFrameMatrix)}if(e.isClippingEnabled()){let t=W9e;t=L.multiply(r.uniformState.view3D,n,t),t=L.multiply(t,e._clippingPlanes.modelMatrix,t),e._clippingPlanesMatrix=L.inverseTranspose(t,e._clippingPlanesMatrix)}}function lWe(e,t){let i=e._sceneGraph;if(e._updateModelMatrix||0!==e._minimumPixelSize){let n=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;i.updateModelMatrix(n,t),e._updateModelMatrix=!1}e._backFaceCullingDirty&&(i.updateBackFaceCulling(e._backFaceCulling),e._backFaceCullingDirty=!1),e._shadowsDirty&&(i.updateShadows(e._shadows),e._shadowsDirty=!1),e._debugShowBoundingVolumeDirty&&(i.updateShowBoundingVolume(e._debugShowBoundingVolume),e._debugShowBoundingVolumeDirty=!1);let n=!1;u(e.classificationType)||(n=e._userAnimationDirty||e._activeAnimations.update(t)),i.update(t,n),e._userAnimationDirty=!1}function uWe(e){if(!e._showCreditsOnScreenDirty)return;e._showCreditsOnScreenDirty=!1,e._credits.length=0;let t=e._showCreditsOnScreen;if(u(e._credit)){let i=xt.clone(e._credit);i.showOnScreen=i.showOnScreen||t,e._credits.push(i)}let i=e._resourceCredits,n=i.length;for(let r=0;r<n;r++){let n=xt.clone(i[r]);n.showOnScreen=n.showOnScreen||t,e._credits.push(n)}let r=e._gltfCredits,o=r.length;for(let i=0;i<o;i++){let n=xt.clone(r[i]);n.showOnScreen=n.showOnScreen||t,e._credits.push(n)}}function fWe(e,t){let i=mWe(e,t),n=e.isInvisible(),r=e.hasSilhouette(t),o=e._show&&0!==e._computedScale&&i&&(!n||r),a=t.passes,s=a.render||a.pick&&e.allowPicking;o&&!e._ignoreCommands&&s&&(pWe(e,t),e._sceneGraph.pushDrawCommands(t))}var $9=new se;function dWe(e,t,i){return $9.center=e,$9.radius=t,i.camera.getPixelSize($9,i.context.drawingBufferWidth,i.context.drawingBufferHeight)}function mce(e,t,i){return function(n){if(e.heightReference===We.RELATIVE_TO_GROUND){let e=t.cartesianToCartographic(n,XF);e.height+=i.height,t.cartographicToCartesian(e,n)}let r=e._clampedModelMatrix;L.clone(e.modelMatrix,r),r[12]=n.x,r[13]=n.y,r[14]=n.z,e._heightDirty=!0}}var hWe=new h;function mWe(e,t){let i=e.distanceDisplayCondition;if(!u(i))return!0;let n,r=i.near*i.near,o=i.far*i.far;if(t.mode===te.SCENE2D){let e=.5*(t.camera.frustum.right-t.camera.frustum.left);n=e*e}else{let i=L.getTranslation(e.modelMatrix,hWe);$i.computeActualWgs84Position(t,i,i),n=h.distanceSquared(i,t.camera.positionWC)}return n>=r&&n<=o}function pWe(e,t){let i=t.creditDisplay,n=e._credits,r=n.length;for(let e=0;e<r;e++)i.addCreditToNextFrame(n[e])}function gce(e){return e.context.stencilBuffer}yo.prototype.isTranslucent=function(){let e=this.color;return u(e)&&e.alpha>0&&e.alpha<1},yo.prototype.isInvisible=function(){let e=this.color;return u(e)&&0===e.alpha},yo.prototype.hasSilhouette=function(e){return gce(e)&&this._silhouetteSize>0&&this._silhouetteColor.alpha>0&&!u(this._classificationType)},yo.prototype.hasSkipLevelOfDetail=function(e){if(!lr.is3DTiles(this.type))return!1;let t=e.context.stencilBuffer,i=this._content.tileset;return t&&i.isSkippingLevelOfDetail},yo.prototype.isClippingEnabled=function(){let e=this._clippingPlanes;return u(e)&&e.enabled&&0!==e.length},yo.prototype.isDestroyed=function(){return!1},yo.prototype.destroy=function(){let e=this._loader;u(e)&&e.destroy();let t=this._featureTables;if(u(t)){let e=t.length;for(let i=0;i<e;i++)t[i].destroy()}this.destroyPipelineResources(),this.destroyModelResources(),u(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),u(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0);let i=this._clippingPlanes;u(i)&&!i.isDestroyed()&&i.owner===this&&i.destroy(),this._clippingPlanes=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,le(this)},yo.prototype.destroyPipelineResources=function(){let e=this._pipelineResources;for(let t=0;t<e.length;t++)e[t].destroy();this._pipelineResources.length=0,this._pickIds.length=0},yo.prototype.destroyModelResources=function(){let e=this._modelResources;for(let t=0;t<e.length;t++)e[t].destroy();this._modelResources.length=0},yo.fromGltfAsync=async function(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.url,e.gltf),i={releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline,loadForClassification:u(e.classificationType)},n=y(e.basePath,""),r=ve.createIfNeeded(n);u(t.asset)?(i.gltfJson=t,i.baseResource=r,i.gltfResource=r):t instanceof Uint8Array?(i.typedArray=t,i.baseResource=r,i.gltfResource=r):i.gltfResource=ve.createIfNeeded(t);let o=new Tg(i),a=u(e.content)?lr.TILE_GLTF:lr.GLTF,s=i.gltfResource,l=Xw(o,a,e);l.resource=s;try{await o.load()}catch(e){throw o.destroy(),en.getError("model",s,e)}let c=e.gltfCallback;u(c)&&c(o.gltfJson);let h=new yo(l),d=h._resource.credits;if(u(d)){let e=d.length;for(let t=0;t<e;t++)h._resourceCredits.push(xt.clone(d[t]))}return h},yo.fromB3dm=async function(e){let t={b3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline,loadForClassification:u(e.classificationType)},i=new f2(t);try{return await i.load(),new yo(Xw(i,lr.TILE_B3DM,e))}catch(e){throw i.destroy(),e}},yo.fromPnts=async function(e){let t={arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,loadAttributesFor2D:e.projectTo2D},i=new YF(t);try{return await i.load(),new yo(Xw(i,lr.TILE_PNTS,e))}catch(e){throw i.destroy(),e}},yo.fromI3dm=async function(e){let t={i3dmResource:e.resource,arrayBuffer:e.arrayBuffer,byteOffset:e.byteOffset,releaseGltfJson:e.releaseGltfJson,asynchronous:e.asynchronous,incrementallyLoadTextures:e.incrementallyLoadTextures,upAxis:e.upAxis,forwardAxis:e.forwardAxis,loadAttributesFor2D:e.projectTo2D,loadIndicesForWireframe:e.enableDebugWireframe,loadPrimitiveOutline:e.enableShowOutline},i=new y2(t);try{return await i.load(),new yo(Xw(i,lr.TILE_I3DM,e))}catch(e){throw i.destroy(),e}},yo.fromGeoJson=async function(e){let t={geoJson:e.geoJson};return new yo(Xw(new h2(t),lr.TILE_GEOJSON,e))};var _We=new z;function Xw(e,t,i){return{loader:e,type:t,resource:i.resource,show:i.show,modelMatrix:i.modelMatrix,scale:i.scale,minimumPixelSize:i.minimumPixelSize,maximumScale:i.maximumScale,id:i.id,allowPicking:i.allowPicking,clampAnimations:i.clampAnimations,shadows:i.shadows,debugShowBoundingVolume:i.debugShowBoundingVolume,enableDebugWireframe:i.enableDebugWireframe,debugWireframe:i.debugWireframe,cull:i.cull,opaquePass:i.opaquePass,customShader:i.customShader,content:i.content,heightReference:i.heightReference,scene:i.scene,distanceDisplayCondition:i.distanceDisplayCondition,color:i.color,colorBlendAmount:i.colorBlendAmount,colorBlendMode:i.colorBlendMode,silhouetteColor:i.silhouetteColor,silhouetteSize:i.silhouetteSize,enableShowOutline:i.enableShowOutline,showOutline:i.showOutline,outlineColor:i.outlineColor,clippingPlanes:i.clippingPlanes,lightColor:i.lightColor,imageBasedLighting:i.imageBasedLighting,backFaceCulling:i.backFaceCulling,credit:i.credit,showCreditsOnScreen:i.showCreditsOnScreen,splitDirection:i.splitDirection,projectTo2D:i.projectTo2D,featureIdLabel:i.featureIdLabel,instanceFeatureIdLabel:i.instanceFeatureIdLabel,pointCloudShading:i.pointCloudShading,classificationType:i.classificationType,pickObject:i.pickObject}}yo.prototype.applyColorAndShow=function(e){let t=z.clone(this._color,_We),i=u(e)&&u(e.color),n=u(e)&&u(e.show);this._color=i?e.color.evaluateColor(void 0,this._color):z.clone(z.WHITE,this._color),this._show=!n||e.show.evaluate(void 0),Q9(t,this._color)&&this.resetDrawCommands()},yo.prototype.applyStyle=function(e){let t=this.type===lr.TILE_PNTS,i=u(this.featureTableId)&&this.featureTables[this.featureTableId].featuresLength>0,n=u(this.structuralMetadata)?this.structuralMetadata.propertyAttributes:void 0,r=u(n)&&u(n[0]);!t||i&&!r?i?(this.featureTables[this.featureTableId].applyStyle(e),pce(this,e)):(this.applyColorAndShow(e),this._styleCommandsNeeded=void 0):this.resetDrawCommands()};var Hh=yo;function Cs(e,t,i){this._tileset=e,this._tile=t,this._resource=i,this._model=void 0,this._metadata=void 0,this._group=void 0,this._ready=!1}function Kw(e,t,i,n){let r={cull:!1,releaseGltfJson:!0,opaquePass:Ee.CESIUM_3D_TILE,modelMatrix:t.computedTransform,upAxis:e._modelUpAxis,forwardAxis:e._modelForwardAxis,incrementallyLoadTextures:!1,customShader:e.customShader,content:i,colorBlendMode:e.colorBlendMode,colorBlendAmount:e.colorBlendAmount,lightColor:e.lightColor,imageBasedLighting:e.imageBasedLighting,featureIdLabel:e.featureIdLabel,instanceFeatureIdLabel:e.instanceFeatureIdLabel,pointCloudShading:e.pointCloudShading,clippingPlanes:e.clippingPlanes,backFaceCulling:e.backFaceCulling,shadows:e.shadows,showCreditsOnScreen:e.showCreditsOnScreen,splitDirection:e.splitDirection,enableDebugWireframe:e._enableDebugWireframe,debugWireframe:e.debugWireframe,projectTo2D:e._projectTo2D,enableShowOutline:e._enableShowOutline,showOutline:e.showOutline,outlineColor:e.outlineColor};return gt(n,r)}Object.defineProperties(Cs.prototype,{featuresLength:{get:function(){let e=this._model,t=e.featureTables,i=e.featureTableId;return u(t)&&u(t[i])?t[i].featuresLength:0}},pointsLength:{get:function(){return this._model.statistics.pointsLength}},trianglesLength:{get:function(){return this._model.statistics.trianglesLength}},geometryByteLength:{get:function(){return this._model.statistics.geometryByteLength}},texturesByteLength:{get:function(){return this._model.statistics.texturesByteLength}},batchTableByteLength:{get:function(){let e=this._model.statistics;return e.propertyTablesByteLength+e.batchTexturesByteLength}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){let e=this._model,t=e.featureTables,i=e.featureTableId;if(u(t)&&u(t[i]))return t[i]}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),Cs.prototype.getFeature=function(e){let t=this._model,i=t.featureTableId;return t.featureTables[i].getFeature(e)},Cs.prototype.hasProperty=function(e,t){let i=this._model,n=i.featureTableId;return!!u(n)&&i.featureTables[n].hasProperty(e,t)},Cs.prototype.applyDebugSettings=function(e,t){t=e?t:z.WHITE,0===this.featuresLength?this._model.color=t:u(this.batchTable)&&this.batchTable.setAllColor(t)},Cs.prototype.applyStyle=function(e){this._model.style=e},Cs.prototype.update=function(e,t){let i=this._model,n=this._tile;i.colorBlendAmount=e.colorBlendAmount,i.colorBlendMode=e.colorBlendMode,i.modelMatrix=n.computedTransform,i.customShader=e.customShader,i.featureIdLabel=e.featureIdLabel,i.instanceFeatureIdLabel=e.instanceFeatureIdLabel,i.lightColor=e.lightColor,i.imageBasedLighting=e.imageBasedLighting,i.backFaceCulling=e.backFaceCulling,i.shadows=e.shadows,i.showCreditsOnScreen=e.showCreditsOnScreen,i.splitDirection=e.splitDirection,i.debugWireframe=e.debugWireframe,i.showOutline=e.showOutline,i.outlineColor=e.outlineColor,i.pointCloudShading=e.pointCloudShading;let r=e.clippingPlanes;i.referenceMatrix=e.clippingPlanesOriginMatrix,u(r)&&n.clippingPlanesDirty&&(i._clippingPlanes=r.enabled&&n._isClipped?r:void 0),u(r)&&u(i._clippingPlanes)&&i._clippingPlanes!==r&&(i._clippingPlanes=r,i._clippingPlanesState=0),i.update(t),!this._ready&&i.ready&&(i.activeAnimations.addAll({loop:jl.REPEAT}),this._ready=!0)},Cs.prototype.isDestroyed=function(){return!1},Cs.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),le(this)},Cs.fromGltf=async function(e,t,i,n){let r=new Cs(e,t,i),o=Kw(e,t,r,{gltf:n,basePath:i}),a=e.vectorClassificationOnly?void 0:e.classificationType;o.classificationType=a;let s=await Hh.fromGltfAsync(o);return r._model=s,r},Cs.fromB3dm=async function(e,t,i,n,r){let o=new Cs(e,t,i),a=Kw(e,t,o,{arrayBuffer:n,byteOffset:r,resource:i}),s=e.vectorClassificationOnly?void 0:e.classificationType;a.classificationType=s;let l=await Hh.fromB3dm(a);return o._model=l,o},Cs.fromI3dm=async function(e,t,i,n,r){let o=new Cs(e,t,i),a=Kw(e,t,o,{arrayBuffer:n,byteOffset:r,resource:i}),s=await Hh.fromI3dm(a);return o._model=s,o},Cs.fromPnts=async function(e,t,i,n,r){let o=new Cs(e,t,i),a=Kw(e,t,o,{arrayBuffer:n,byteOffset:r,resource:i}),s=await Hh.fromPnts(a);return o._model=s,o},Cs.fromGeoJson=async function(e,t,i,n){let r=new Cs(e,t,i),o=Kw(e,t,r,{geoJson:n,resource:i}),a=await Hh.fromGeoJson(o);return r._model=a,r};var yp=Cs;function sd(e,t,i){this._tileset=e,this._tile=t,this._resource=i,this.featurePropertiesDirty=!1,this._metadata=void 0,this._group=void 0,this._ready=!1}Object.defineProperties(sd.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},group:{get:function(){return this._group},set:function(e){this._group=e}}}),sd.fromJson=function(e,t,i,n){let r=new sd(e,t,i);return r._tileset.loadTileset(r._resource,n,r._tile),r._ready=!0,r},sd.prototype.hasProperty=function(e,t){return!1},sd.prototype.getFeature=function(e){},sd.prototype.applyDebugSettings=function(e,t){},sd.prototype.applyStyle=function(e){},sd.prototype.update=function(e,t){},sd.prototype.isDestroyed=function(){return!1},sd.prototype.destroy=function(){return le(this)};var KF=sd;function gWe(e,t,i,n,r){return function(){let o=document.createElement("canvas"),a=r+2*n;o.height=o.width=a;let s=o.getContext("2d");return s.clearRect(0,0,a,a),0!==n&&(s.beginPath(),s.arc(a/2,a/2,a/2,0,2*Math.PI,!0),s.closePath(),s.fillStyle=i,s.fill(),e<1&&(s.save(),s.globalCompositeOperation="destination-out",s.beginPath(),s.arc(a/2,a/2,r/2,0,2*Math.PI,!0),s.closePath(),s.fillStyle="black",s.fill(),s.restore())),s.beginPath(),s.arc(a/2,a/2,r/2,0,2*Math.PI,!0),s.closePath(),s.fillStyle=t,s.fill(),o}}var OA=gWe;function Us(e,t,i,n,r){this._content=e,this._billboard=i,this._label=n,this._polyline=r,this._batchId=t,this._billboardImage=void 0,this._billboardColor=void 0,this._billboardOutlineColor=void 0,this._billboardOutlineWidth=void 0,this._billboardSize=void 0,this._pointSize=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._heightOffset=void 0,this._pickIds=new Array(3),RA(this)}var yWe=new fe;function RA(e){let t=e._billboard;if(u(e._billboardImage)&&e._billboardImage!==t.image)return void(t.image=e._billboardImage);if(u(e._billboardImage))return;let i=y(e._color,Us.defaultColor),n=y(e._pointOutlineColor,Us.defaultPointOutlineColor),r=y(e._pointOutlineWidth,Us.defaultPointOutlineWidth),o=y(e._pointSize,Us.defaultPointSize),a=e._billboardColor,s=e._billboardOutlineColor,l=e._billboardOutlineWidth,c=e._billboardSize;if(z.equals(i,a)&&z.equals(n,s)&&r===l&&o===c)return;e._billboardColor=z.clone(i,e._billboardColor),e._billboardOutlineColor=z.clone(n,e._billboardOutlineColor),e._billboardOutlineWidth=r,e._billboardSize=o;let h=i.alpha,d=i.toCssColorString(),p=n.toCssColorString(),f=JSON.stringify([d,o,p,r]);t.setImage(f,OA(h,d,p,r,o))}Object.defineProperties(Us.prototype,{show:{get:function(){return this._label.show},set:function(e){this._label.show=e,this._billboard.show=e,this._polyline.show=e}},color:{get:function(){return this._color},set:function(e){this._color=z.clone(e,this._color),RA(this)}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=e,RA(this)}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=z.clone(e,this._pointOutlineColor),RA(this)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=e,RA(this)}},labelColor:{get:function(){return this._label.fillColor},set:function(e){this._label.fillColor=e,this._polyline.show=this._label.show&&e.alpha>0}},labelOutlineColor:{get:function(){return this._label.outlineColor},set:function(e){this._label.outlineColor=e}},labelOutlineWidth:{get:function(){return this._label.outlineWidth},set:function(e){this._label.outlineWidth=e}},font:{get:function(){return this._label.font},set:function(e){this._label.font=e}},labelStyle:{get:function(){return this._label.style},set:function(e){this._label.style=e}},labelText:{get:function(){return this._label.text},set:function(e){u(e)||(e=""),this._label.text=e}},backgroundColor:{get:function(){return this._label.backgroundColor},set:function(e){this._label.backgroundColor=e}},backgroundPadding:{get:function(){return this._label.backgroundPadding},set:function(e){this._label.backgroundPadding=e}},backgroundEnabled:{get:function(){return this._label.showBackground},set:function(e){this._label.showBackground=e}},scaleByDistance:{get:function(){return this._label.scaleByDistance},set:function(e){this._label.scaleByDistance=e,this._billboard.scaleByDistance=e}},translucencyByDistance:{get:function(){return this._label.translucencyByDistance},set:function(e){this._label.translucencyByDistance=e,this._billboard.translucencyByDistance=e}},distanceDisplayCondition:{get:function(){return this._label.distanceDisplayCondition},set:function(e){this._label.distanceDisplayCondition=e,this._polyline.distanceDisplayCondition=e,this._billboard.distanceDisplayCondition=e}},heightOffset:{get:function(){return this._heightOffset},set:function(e){let t=y(this._heightOffset,0),i=this._content.tileset.ellipsoid,n=i.cartesianToCartographic(this._billboard.position,yWe);n.height=n.height-t+e;let r=i.cartographicToCartesian(n);this._billboard.position=r,this._label.position=this._billboard.position,this._polyline.positions=[this._polyline.positions[0],r],this._heightOffset=e}},anchorLineEnabled:{get:function(){return this._polyline.show},set:function(e){this._polyline.show=e}},anchorLineColor:{get:function(){return this._polyline.material.uniforms.color},set:function(e){this._polyline.material.uniforms.color=z.clone(e,this._polyline.material.uniforms.color)}},image:{get:function(){return this._billboardImage},set:function(e){let t=this._billboardImage!==e;this._billboardImage=e,t&&RA(this)}},disableDepthTestDistance:{get:function(){return this._label.disableDepthTestDistance},set:function(e){this._label.disableDepthTestDistance=e,this._billboard.disableDepthTestDistance=e}},horizontalOrigin:{get:function(){return this._billboard.horizontalOrigin},set:function(e){this._billboard.horizontalOrigin=e}},verticalOrigin:{get:function(){return this._billboard.verticalOrigin},set:function(e){this._billboard.verticalOrigin=e}},labelHorizontalOrigin:{get:function(){return this._label.horizontalOrigin},set:function(e){this._label.horizontalOrigin=e}},labelVerticalOrigin:{get:function(){return this._label.verticalOrigin},set:function(e){this._label.verticalOrigin=e}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},pickIds:{get:function(){let e=this._pickIds;return e[0]=this._billboard.pickId,e[1]=this._label.pickId,e[2]=this._polyline.pickId,e}}}),Us.defaultColor=z.WHITE,Us.defaultPointOutlineColor=z.BLACK,Us.defaultPointOutlineWidth=0,Us.defaultPointSize=8,Us.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},Us.prototype.getPropertyIds=function(e){return this._content.batchTable.getPropertyIds(this._batchId,e)},Us.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},Us.prototype.getPropertyInherited=function(e){return Fs.getPropertyInherited(this._content,this._batchId,e)},Us.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},Us.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},Us.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},Us.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var Og=Us,Dce=or(Tce(),1),bWe={FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2},zo=Object.freeze(bWe),Ace={},Cce=0,TWe=256,AWe=new z(.165,.165,.165,.8),CWe=new U(7,5),jr=Object.freeze({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function ox(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function $w(e){!e._rebindAllGlyphs&&!e._repositionAllGlyphs&&e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function Qw(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function Sce(e){let t=Ace[e._font];if(!u(t)){let i=document.createElement("div");i.style.position="absolute",i.style.opacity=0,i.style.font=e._font,document.body.appendChild(i);let n=parseFloat(Qw(i,"line-height"));isNaN(n)&&(n=void 0),t={family:Qw(i,"font-family"),size:Qw(i,"font-size").replace("px",""),style:Qw(i,"font-style"),weight:Qw(i,"font-weight"),lineHeight:n},document.body.removeChild(i),Cce<TWe&&(Ace[e._font]=t,Cce++)}e._fontFamily=t.family,e._fontSize=t.size,e._fontStyle=t.style,e._fontWeight=t.weight,e._lineHeight=t.lineHeight}function xp(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).translucencyByDistance,n=e.pixelOffsetScaleByDistance,r=e.scaleByDistance,o=e.distanceDisplayCondition;u(i)&&(i=Pt.clone(i)),u(n)&&(n=Pt.clone(n)),u(r)&&(r=Pt.clone(r)),u(o)&&(o=wt.clone(o)),this._renderedText=void 0,this._text=void 0,this._show=y(e.show,!0),this._font=y(e.font,"30px sans-serif"),this._fillColor=z.clone(y(e.fillColor,z.WHITE)),this._outlineColor=z.clone(y(e.outlineColor,z.BLACK)),this._outlineWidth=y(e.outlineWidth,1),this._showBackground=y(e.showBackground,!1),this._backgroundColor=z.clone(y(e.backgroundColor,AWe)),this._backgroundPadding=U.clone(y(e.backgroundPadding,CWe)),this._style=y(e.style,zo.FILL),this._verticalOrigin=y(e.verticalOrigin,On.BASELINE),this._horizontalOrigin=y(e.horizontalOrigin,yi.LEFT),this._pixelOffset=U.clone(y(e.pixelOffset,U.ZERO)),this._eyeOffset=h.clone(y(e.eyeOffset,h.ZERO)),this._position=h.clone(y(e.position,h.ZERO)),this._scale=y(e.scale,1),this._id=e.id,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=n,this._scaleByDistance=r,this._heightReference=y(e.heightReference,We.NONE),this._distanceDisplayCondition=o,this._disableDepthTestDistance=e.disableDepthTestDistance,this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=y(e.text,""),this._relativeSize=1,Sce(this),this._updateClamping()}function EWe(e,t){let i=/[a-zA-Z0-9]/,n=/[()[\]{}<>]/,r=[],o="",a=jr.LTR,s="",l=e.length;for(let u=0;u<l;++u){let l=e.charAt(u);s=t.test(l)?jr.RTL:i.test(l)?jr.LTR:n.test(l)?jr.BRACKETS:jr.WEAK,0===u&&(a=s),a===s&&s!==jr.BRACKETS?o+=l:(""!==o&&r.push({Type:a,Word:o}),a=s,o=l)}return r.push({Type:s,Word:o}),r}function SWe(e){return e.split("").reverse().join("")}function Jw(e,t,i){return e.slice(0,t)+i+e.slice(t)}function wWe(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}Object.defineProperties(xp.prototype,{show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i].billboard;u(n)&&(n.show=e)}let i=this._backgroundBillboard;u(i)&&(i.show=e)}}},position:{get:function(){return this._position},set:function(e){let t=this._position;if(!h.equals(t,e)){h.clone(e,t);let i=this._glyphs;for(let t=0,n=i.length;t<n;t++){let n=i[t].billboard;u(n)&&(n.position=e)}let n=this._backgroundBillboard;u(n)&&(n.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(e!==this._heightReference){this._heightReference=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i].billboard;u(n)&&(n.heightReference=e)}let i=this._backgroundBillboard;u(i)&&(i.heightReference=e),$w(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(this._text!==e){this._text=e;let t=e.replace(/\u00ad/g,"");this._renderedText=xp.enableRightToLeftDetection?IWe(t):t,ox(this)}}},font:{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,ox(this),Sce(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){let t=this._fillColor;z.equals(t,e)||(z.clone(e,t),ox(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;z.equals(t,e)||(z.clone(e,t),ox(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,ox(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){this._showBackground!==e&&(this._showBackground=e,ox(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){let t=this._backgroundColor;if(!z.equals(t,e)){z.clone(e,t);let i=this._backgroundBillboard;u(i)&&(i.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){let t=this._backgroundPadding;U.equals(t,e)||(U.clone(e,t),$w(this))}},style:{get:function(){return this._style},set:function(e){this._style!==e&&(this._style=e,ox(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){let t=this._pixelOffset;if(!U.equals(t,e)){U.clone(e,t);let i=this._glyphs;for(let t=0,n=i.length;t<n;t++){let n=i[t];u(n.billboard)&&(n.billboard.pixelOffset=e)}let n=this._backgroundBillboard;u(n)&&(n.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;if(!Pt.equals(t,e)){this._translucencyByDistance=Pt.clone(e,t);let i=this._glyphs;for(let t=0,n=i.length;t<n;t++){let n=i[t];u(n.billboard)&&(n.billboard.translucencyByDistance=e)}let n=this._backgroundBillboard;u(n)&&(n.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){let t=this._pixelOffsetScaleByDistance;if(!Pt.equals(t,e)){this._pixelOffsetScaleByDistance=Pt.clone(e,t);let i=this._glyphs;for(let t=0,n=i.length;t<n;t++){let n=i[t];u(n.billboard)&&(n.billboard.pixelOffsetScaleByDistance=e)}let n=this._backgroundBillboard;u(n)&&(n.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;if(!Pt.equals(t,e)){this._scaleByDistance=Pt.clone(e,t);let i=this._glyphs;for(let t=0,n=i.length;t<n;t++){let n=i[t];u(n.billboard)&&(n.billboard.scaleByDistance=e)}let n=this._backgroundBillboard;u(n)&&(n.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){let t=this._eyeOffset;if(!h.equals(t,e)){h.clone(e,t);let i=this._glyphs;for(let t=0,n=i.length;t<n;t++){let n=i[t];u(n.billboard)&&(n.billboard.eyeOffset=e)}let n=this._backgroundBillboard;u(n)&&(n.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,$w(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(this._verticalOrigin!==e){this._verticalOrigin=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard.verticalOrigin=e)}let i=this._backgroundBillboard;u(i)&&(i.verticalOrigin=e),$w(this)}}},scale:{get:function(){return this._scale},set:function(e){if(this._scale!==e){this._scale=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard.scale=e*this._relativeSize)}let i=this._backgroundBillboard;u(i)&&(i.scale=e*this._relativeSize),$w(this)}}},totalScale:{get:function(){return this._scale*this._relativeSize}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!wt.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=wt.clone(e,this._distanceDisplayCondition);let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard.distanceDisplayCondition=e)}let i=this._backgroundBillboard;u(i)&&(i.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){this._disableDepthTestDistance=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard.disableDepthTestDistance=e)}let i=this._backgroundBillboard;u(i)&&(i.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard.id=e)}let i=this._backgroundBillboard;u(i)&&(i.id=e)}}},pickId:{get:function(){if(0!==this._glyphs.length&&u(this._glyphs[0].billboard))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=h.clone(e,this._actualClampedPosition);let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard._clampedPosition=e)}let i=this._backgroundBillboard;u(i)&&(i._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;let t=this._glyphs;for(let i=0,n=t.length;i<n;i++){let n=t[i];u(n.billboard)&&(n.billboard.clusterShow=e)}let i=this._backgroundBillboard;u(i)&&(i.clusterShow=e)}}}}),xp.prototype._updateClamping=function(){mo._updateClamping(this._labelCollection,this)},xp.prototype.computeScreenSpacePosition=function(e,t){u(t)||(t=new U);let i=this._labelCollection.modelMatrix,n=u(this._actualClampedPosition)?this._actualClampedPosition:this._position;return mo._computeScreenSpacePosition(i,n,this._eyeOffset,this._pixelOffset,e,t)},xp.getScreenSpaceBoundingBox=function(e,t,i){let n=0,r=0,o=0,a=0,s=e.totalScale,l=e._backgroundBillboard;if(u(l))n=t.x+l._translate.x,r=t.y-l._translate.y,o=l.width*s,a=l.height*s,e.verticalOrigin===On.BOTTOM||e.verticalOrigin===On.BASELINE?r-=a:e.verticalOrigin===On.CENTER&&(r-=.5*a);else{n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;let i=0,l=0,c=e._glyphs,h=c.length;for(let o=0;o<h;++o){let a=c[o],h=a.billboard;if(!u(h))continue;let d=t.x+h._translate.x,p=t.y-h._translate.y,f=a.dimensions.width*s,m=a.dimensions.height*s;e.verticalOrigin===On.BOTTOM||e.verticalOrigin===On.BASELINE?p-=m:e.verticalOrigin===On.CENTER&&(p-=.5*m),e._verticalOrigin===On.TOP?p+=Ns.PADDING*s:(e._verticalOrigin===On.BOTTOM||e._verticalOrigin===On.BASELINE)&&(p-=Ns.PADDING*s),n=Math.min(n,d),r=Math.min(r,p),i=Math.max(i,d+f),l=Math.max(l,p+m)}o=i-n,a=l-r}return u(i)||(i=new qe),i.x=n,i.y=r,i.width=o,i.height=a,i},xp.prototype.equals=function(e){return this===e||u(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&h.equals(this._position,e._position)&&z.equals(this._fillColor,e._fillColor)&&z.equals(this._outlineColor,e._outlineColor)&&z.equals(this._backgroundColor,e._backgroundColor)&&U.equals(this._backgroundPadding,e._backgroundPadding)&&U.equals(this._pixelOffset,e._pixelOffset)&&h.equals(this._eyeOffset,e._eyeOffset)&&Pt.equals(this._translucencyByDistance,e._translucencyByDistance)&&Pt.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&Pt.equals(this._scaleByDistance,e._scaleByDistance)&&wt.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id},xp.prototype.isDestroyed=function(){return!1},xp.enableRightToLeftDetection=!1;var vWe="-",DWe="---",Ece=new RegExp(`[${vWe}${DWe}]`);function IWe(e){let t=e.split("\n"),i="";for(let e=0;e<t.length;e++){let n=t[e],r=Ece.test(n.charAt(0)),o=EWe(n,Ece),a=0,s="";for(let e=0;e<o.length;++e){let t=o[e],i=t.Type===jr.BRACKETS?wWe(t.Word):SWe(t.Word);r?t.Type===jr.RTL?(s=i+s,a=0):t.Type===jr.LTR?(s=Jw(s,a,t.Word),a+=t.Word.length):(t.Type===jr.WEAK||t.Type===jr.BRACKETS)&&(t.Type===jr.WEAK&&o[e-1].Type===jr.BRACKETS?s=i+s:o[e-1].Type===jr.RTL?(s=i+s,a=0):o.length>e+1?o[e+1].Type===jr.RTL?(s=i+s,a=0):(s=Jw(s,a,t.Word),a+=t.Word.length):s=Jw(s,0,i)):t.Type===jr.RTL?s=Jw(s,a,i):t.Type===jr.LTR?(s+=t.Word,a=s.length):(t.Type===jr.WEAK||t.Type===jr.BRACKETS)&&(e>0&&o[e-1].Type===jr.RTL?o.length>e+1?o[e+1].Type===jr.RTL?s=Jw(s,a,i):(s+=t.Word,a=s.length):s+=t.Word:(s+=t.Word,a=s.length))}i+=s,e<t.length-1&&(i+="\n")}return i}var rx=xp,Ice=or(wce(),1);function OWe(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function RWe(e,t,i){this.labelCollection=e,this.index=t,this.dimensions=i}var MWe=1.2,Pce="ID_WHITE_PIXEL",J9=new U(4,4),LWe=new qe(1,1,1,1);function NWe(e){let t=document.createElement("canvas");t.width=J9.x,t.height=J9.y;let i=t.getContext("2d");return i.fillStyle="#fff",i.fillRect(0,0,t.width,t.height),e.addImage(Pce,t)}var nf={};function FWe(e,t,i,n,r,o,a){return nf.font=t,nf.fillColor=i,nf.strokeColor=n,nf.strokeWidth=r,nf.padding=Ns.PADDING,a===On.CENTER?nf.textBaseline="middle":a===On.TOP?nf.textBaseline="top":nf.textBaseline="bottom",nf.fill=o===zo.FILL||o===zo.FILL_AND_OUTLINE,nf.stroke=o===zo.OUTLINE||o===zo.FILL_AND_OUTLINE,nf.backgroundColor=z.BLACK,vT(e,nf)}function eW(e,t){t.textureInfo=void 0,t.dimensions=void 0;let i=t.billboard;u(i)&&(i.show=!1,i.image=void 0,u(i._removeCallbackFunc)&&(i._removeCallbackFunc(),i._removeCallbackFunc=void 0),e._spareBillboards.push(i),t.billboard=void 0)}function BWe(e,t,i,n){n.index=e.addImageSync(t,i)}var kWe=new Ice.default;function VWe(e,t){let i,n,r,o=t._renderedText,a=kWe.splitGraphemes(o),s=a.length,l=t._glyphs,c=l.length;if(t._relativeSize=t._fontSize/Ns.FONT_SIZE,s<c)for(n=s;n<c;++n)eW(e,l[n]);l.length=s;let h=t.show&&t._showBackground&&o.split("\n").join("").length>0,d=t._backgroundBillboard,p=e._backgroundBillboardCollection;h?(u(d)||(d=p.add({collection:e,image:Pce,imageSubRegion:LWe}),t._backgroundBillboard=d),d.color=t._backgroundColor,d.show=t._show,d.position=t._position,d.eyeOffset=t._eyeOffset,d.pixelOffset=t._pixelOffset,d.horizontalOrigin=yi.LEFT,d.verticalOrigin=t._verticalOrigin,d.heightReference=t._heightReference,d.scale=t.totalScale,d.pickPrimitive=t,d.id=t._id,d.translucencyByDistance=t._translucencyByDistance,d.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,d.scaleByDistance=t._scaleByDistance,d.distanceDisplayCondition=t._distanceDisplayCondition,d.disableDepthTestDistance=t._disableDepthTestDistance,d.clusterShow=t.clusterShow):u(d)&&(p.remove(d),t._backgroundBillboard=d=void 0);let f=e._glyphTextureCache;for(r=0;r<s;++r){let n=a[r],o=t._verticalOrigin,s=JSON.stringify([n,t._fontFamily,t._fontStyle,t._fontWeight,+o]),c=f[s];if(!u(c)){let i=FWe(n,`${t._fontStyle} ${t._fontWeight} ${Ns.FONT_SIZE}px ${t._fontFamily}`,z.WHITE,z.WHITE,0,zo.FILL,o);if(c=new RWe(e,-1,i.dimensions),f[s]=c,i.width>0&&i.height>0){let t=(0,Dce.default)(i,{cutoff:Ns.CUTOFF,radius:Ns.RADIUS}),r=i.getContext("2d"),o=i.width,a=i.height,l=r.getImageData(0,0,o,a);for(let e=0;e<o;e++)for(let i=0;i<a;i++){let n=i*o+e,r=255*t[n],a=4*n;l.data[a+0]=r,l.data[a+1]=r,l.data[a+2]=r,l.data[a+3]=r}r.putImageData(l,0,0)," "!==n&&BWe(e._textureAtlas,s,i,c)}}if(i=l[r],u(i)?-1===c.index?eW(e,i):u(i.textureInfo)&&(i.textureInfo=void 0):(i=new OWe,l[r]=i),i.textureInfo=c,i.dimensions=c.dimensions,-1!==c.index){let n=i.billboard,r=e._spareBillboards;u(n)||(r.length>0?n=r.pop():(n=e._billboardCollection.add({collection:e}),n._labelDimensions=new U,n._labelTranslate=new U),i.billboard=n),n.show=t._show,n.position=t._position,n.eyeOffset=t._eyeOffset,n.pixelOffset=t._pixelOffset,n.horizontalOrigin=yi.LEFT,n.verticalOrigin=t._verticalOrigin,n.heightReference=t._heightReference,n.scale=t.totalScale,n.pickPrimitive=t,n.id=t._id,n.image=s,n.translucencyByDistance=t._translucencyByDistance,n.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,n.scaleByDistance=t._scaleByDistance,n.distanceDisplayCondition=t._distanceDisplayCondition,n.disableDepthTestDistance=t._disableDepthTestDistance,n._batchIndex=t._batchIndex,n.outlineColor=t.outlineColor,t.style===zo.FILL_AND_OUTLINE?(n.color=t._fillColor,n.outlineWidth=t.outlineWidth):t.style===zo.FILL?(n.color=t._fillColor,n.outlineWidth=0):t.style===zo.OUTLINE&&(n.color=z.TRANSPARENT,n.outlineWidth=t.outlineWidth)}}t._repositionAllGlyphs=!0}function vce(e,t,i){return t===yi.CENTER?-e/2:t===yi.RIGHT?-(e+i.x):i.x}var $o=new U,UWe=new U;function zWe(e){let t,i,n,r=e._glyphs,o=e._renderedText,a=0,s=0,l=[],c=Number.NEGATIVE_INFINITY,h=0,d=1,p=r.length,f=e._backgroundBillboard,m=U.clone(u(f)?e._backgroundPadding:U.ZERO,UWe);for(m.x/=e._relativeSize,m.y/=e._relativeSize,n=0;n<p;++n)"\n"===o.charAt(n)?(l.push(a),++d,a=0):(t=r[n],i=t.dimensions,h=Math.max(h,i.height-i.descent),c=Math.max(c,i.descent),a+=i.width-i.minx,n<p-1&&(a+=r[n+1].dimensions.minx),s=Math.max(s,a));l.push(a);let _=h+c,g=e.totalScale,y=e._horizontalOrigin,v=e._verticalOrigin,b=0,A=l[b],T=vce(A,y,m),E=(u(e._lineHeight)?e._lineHeight:MWe*e._fontSize)/e._relativeSize,C=E*(d-1),x=s,S=_+C;u(f)&&(x+=2*m.x,S+=2*m.y,f._labelHorizontalOrigin=y),$o.x=T*g,$o.y=0;let w=!0,I=0;for(n=0;n<p;++n)if("\n"===o.charAt(n))++b,I+=E,A=l[b],T=vce(A,y,m),$o.x=T*g,w=!0;else if(t=r[n],i=t.dimensions,v===On.TOP?($o.y=i.height-h-m.y,$o.y+=Ns.PADDING):v===On.CENTER?$o.y=(C+i.height-h)/2:v===On.BASELINE?($o.y=C,$o.y-=Ns.PADDING):($o.y=C+c+m.y,$o.y-=Ns.PADDING),$o.y=($o.y-i.descent-I)*g,w&&($o.x-=Ns.PADDING*g,w=!1),u(t.billboard)&&(t.billboard._setTranslate($o),t.billboard._labelDimensions.x=x,t.billboard._labelDimensions.y=S,t.billboard._labelHorizontalOrigin=y),n<p-1){let e=r[n+1];$o.x+=(i.width-i.minx+e.dimensions.minx)*g}if(u(f)&&o.split("\n").join("").length>0&&(T=y===yi.CENTER?-s/2-m.x:y===yi.RIGHT?-(s+2*m.x):0,$o.x=T*g,v===On.TOP?$o.y=_-h-c:v===On.CENTER?$o.y=(_-h)/2-c:v===On.BASELINE?$o.y=-m.y-c:$o.y=0,$o.y=$o.y*g,f.width=x,f.height=S,f._setTranslate($o),f._labelTranslate=U.clone($o,f._labelTranslate)),e.heightReference===We.CLAMP_TO_GROUND)for(n=0;n<p;++n){t=r[n];let e=t.billboard;u(e)&&(e._labelTranslate=U.clone($o,e._labelTranslate))}}function Oce(e,t){let i=t._glyphs;for(let t=0,n=i.length;t<n;++t)eW(e,i[t]);u(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,u(t._removeCallbackFunc)&&t._removeCallbackFunc(),le(t)}function Gh(e){e=y(e,y.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._backgroundBillboardCollection=new $u({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new $u({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._billboardCollection._sdf=!0,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._highlightColor=z.clone(z.WHITE),this.show=y(e.show,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.blendOption=y(e.blendOption,Ao.OPAQUE_AND_TRANSLUCENT)}Object.defineProperties(Gh.prototype,{length:{get:function(){return this._labels.length}}}),Gh.prototype.add=function(e){let t=new rx(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t},Gh.prototype.remove=function(e){if(u(e)&&e._labelCollection===this){let t=this._labels.indexOf(e);if(-1!==t)return this._labels.splice(t,1),Oce(this,e),!0}return!1},Gh.prototype.removeAll=function(){let e=this._labels;for(let t=0,i=e.length;t<i;++t)Oce(this,e[t]);e.length=0},Gh.prototype.contains=function(e){return u(e)&&e._labelCollection===this},Gh.prototype.get=function(e){return this._labels[e]},Gh.prototype.update=function(e){if(!this.show)return;let t=this._billboardCollection,i=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,i.modelMatrix=this.modelMatrix,i.debugShowBoundingVolume=this.debugShowBoundingVolume;let n=e.context;u(this._textureAtlas)||(this._textureAtlas=new F0({context:n}),t.textureAtlas=this._textureAtlas),u(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new F0({context:n,initialSize:J9}),i.textureAtlas=this._backgroundTextureAtlas,NWe(this._backgroundTextureAtlas));let r=this._labelsToUpdate.length;for(let e=0;e<r;++e){let t=this._labelsToUpdate[e];if(t.isDestroyed())continue;let i=t._glyphs.length;t._rebindAllGlyphs&&(VWe(this,t),t._rebindAllGlyphs=!1),t._repositionAllGlyphs&&(zWe(t),t._repositionAllGlyphs=!1);let n=t._glyphs.length-i;this._totalGlyphCount+=n}let o=i.length>0?Ao.TRANSLUCENT:this.blendOption;t.blendOption=o,i.blendOption=o,t._highlightColor=this._highlightColor,i._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,i.update(e),t.update(e)},Gh.prototype.isDestroyed=function(){return!1},Gh.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),le(this)};var bp=Gh,of="void clipLineSegmentToNearPlane(\n    vec3 p0,\n    vec3 p1,\n    out vec4 positionWC,\n    out bool clipped,\n    out bool culledByNearPlane,\n    out vec4 clippedPositionEC)\n{\n    culledByNearPlane = false;\n    clipped = false;\n\n    vec3 p0ToP1 = p1 - p0;\n    float magnitude = length(p0ToP1);\n    vec3 direction = normalize(p0ToP1);\n\n    // Distance that p0 is behind the near plane. Negative means p0 is\n    // in front of the near plane.\n    float endPoint0Distance =  czm_currentFrustum.x + p0.z;\n\n    // Camera looks down -Z.\n    // When moving a point along +Z: LESS VISIBLE\n    //   * Points in front of the camera move closer to the camera.\n    //   * Points behind the camrea move farther away from the camera.\n    // When moving a point along -Z: MORE VISIBLE\n    //   * Points in front of the camera move farther away from the camera.\n    //   * Points behind the camera move closer to the camera.\n\n    // Positive denominator: -Z, becoming more visible\n    // Negative denominator: +Z, becoming less visible\n    // Nearly zero: parallel to near plane\n    float denominator = -direction.z;\n\n    if (endPoint0Distance > 0.0 && abs(denominator) < czm_epsilon7)\n    {\n        // p0 is behind the near plane and the line to p1 is nearly parallel to\n        // the near plane, so cull the segment completely.\n        culledByNearPlane = true;\n    }\n    else if (endPoint0Distance > 0.0)\n    {\n        // p0 is behind the near plane, and the line to p1 is moving distinctly\n        // toward or away from it.\n\n        // t = (-plane distance - dot(plane normal, ray origin)) / dot(plane normal, ray direction)\n        float t = endPoint0Distance / denominator;\n        if (t < 0.0 || t > magnitude)\n        {\n            // Near plane intersection is not between the two points.\n            // We already confirmed p0 is behind the naer plane, so now\n            // we know the entire segment is behind it.\n            culledByNearPlane = true;\n        }\n        else\n        {\n            // Segment crosses the near plane, update p0 to lie exactly on it.\n            p0 = p0 + t * direction;\n\n            // Numerical noise might put us a bit on the wrong side of the near plane.\n            // Don't let that happen.\n            p0.z = min(p0.z, -czm_currentFrustum.x);\n\n            clipped = true;\n        }\n    }\n\n    clippedPositionEC = vec4(p0, 1.0);\n    positionWC = czm_eyeToWindowCoordinates(clippedPositionEC);\n}\n\nvec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)\n{\n    // expandDirection +1 is to the _left_ when looking from positionEC toward nextEC.\n\n#ifdef POLYLINE_DASH\n    // Compute the window coordinates of the points.\n    vec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\n    vec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\n    vec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\n\n    // Determine the relative screen space direction of the line.\n    vec2 lineDir;\n    if (usePrevious) {\n        lineDir = normalize(positionWindow.xy - previousWindow.xy);\n    }\n    else {\n        lineDir = normalize(nextWindow.xy - positionWindow.xy);\n    }\n    angle = atan(lineDir.x, lineDir.y) - 1.570796327; // precomputed atan(1,0)\n\n    // Quantize the angle so it doesn't change rapidly between segments.\n    angle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\n\n    vec4 clippedPrevWC, clippedPrevEC;\n    bool prevSegmentClipped, prevSegmentCulled;\n    clipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, clippedPrevWC, prevSegmentClipped, prevSegmentCulled, clippedPrevEC);\n\n    vec4 clippedNextWC, clippedNextEC;\n    bool nextSegmentClipped, nextSegmentCulled;\n    clipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, clippedNextWC, nextSegmentClipped, nextSegmentCulled, clippedNextEC);\n\n    bool segmentClipped, segmentCulled;\n    vec4 clippedPositionWC, clippedPositionEC;\n    clipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, clippedPositionWC, segmentClipped, segmentCulled, clippedPositionEC);\n\n    if (segmentCulled)\n    {\n        return vec4(0.0, 0.0, 0.0, 1.0);\n    }\n\n    vec2 directionToPrevWC = normalize(clippedPrevWC.xy - clippedPositionWC.xy);\n    vec2 directionToNextWC = normalize(clippedNextWC.xy - clippedPositionWC.xy);\n\n    // If a segment was culled, we can't use the corresponding direction\n    // computed above. We should never see both of these be true without\n    // `segmentCulled` above also being true.\n    if (prevSegmentCulled)\n    {\n        directionToPrevWC = -directionToNextWC;\n    }\n    else if (nextSegmentCulled)\n    {\n        directionToNextWC = -directionToPrevWC;\n    }\n\n    vec2 thisSegmentForwardWC, otherSegmentForwardWC;\n    if (usePrevious)\n    {\n        thisSegmentForwardWC = -directionToPrevWC;\n        otherSegmentForwardWC = directionToNextWC;\n    }\n    else\n    {\n        thisSegmentForwardWC = directionToNextWC;\n        otherSegmentForwardWC =  -directionToPrevWC;\n    }\n\n    vec2 thisSegmentLeftWC = vec2(-thisSegmentForwardWC.y, thisSegmentForwardWC.x);\n\n    vec2 leftWC = thisSegmentLeftWC;\n    float expandWidth = width * 0.5;\n\n    // When lines are split at the anti-meridian, the position may be at the\n    // same location as the next or previous position, and we need to handle\n    // that to avoid producing NaNs.\n    if (!czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) && !czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))\n    {\n        vec2 otherSegmentLeftWC = vec2(-otherSegmentForwardWC.y, otherSegmentForwardWC.x);\n\n        vec2 leftSumWC = thisSegmentLeftWC + otherSegmentLeftWC;\n        float leftSumLength = length(leftSumWC);\n        leftWC = leftSumLength < czm_epsilon6 ? thisSegmentLeftWC : (leftSumWC / leftSumLength);\n\n        // The sine of the angle between the two vectors is given by the formula\n        //         |a x b| = |a||b|sin(theta)\n        // which is\n        //     float sinAngle = length(cross(vec3(leftWC, 0.0), vec3(-thisSegmentForwardWC, 0.0)));\n        // Because the z components of both vectors are zero, the x and y coordinate will be zero.\n        // Therefore, the sine of the angle is just the z component of the cross product.\n        vec2 u = -thisSegmentForwardWC;\n        vec2 v = leftWC;\n        float sinAngle = abs(u.x * v.y - u.y * v.x);\n        expandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n    }\n\n    vec2 offset = leftWC * expandDirection * expandWidth * czm_pixelRatio;\n    return vec4(clippedPositionWC.xy + offset, -clippedPositionWC.z, 1.0) * (czm_projection * clippedPositionEC).w;\n}\n\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)\n{\n    vec4 positionEC = czm_modelViewRelativeToEye * position;\n    vec4 prevEC = czm_modelViewRelativeToEye * previous;\n    vec4 nextEC = czm_modelViewRelativeToEye * next;\n    return getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);\n}\n",MA="#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\n\nin vec2 v_st;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n\n    vec2 st = v_st;\n    st.t = czm_readNonPerspective(st.t, gl_FragCoord.w);\n\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = vec3(st, 0.0);\n\n    czm_material material = czm_getMaterial(materialInput);\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#ifdef VECTOR_TILE\n    out_FragColor *= u_highlightColor;\n#endif\n\n    czm_writeLogDepth();\n}\n",$F="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 position2DHigh;\nin vec3 position2DLow;\nin vec3 prevPosition3DHigh;\nin vec3 prevPosition3DLow;\nin vec3 prevPosition2DHigh;\nin vec3 prevPosition2DLow;\nin vec3 nextPosition3DHigh;\nin vec3 nextPosition3DLow;\nin vec3 nextPosition2DHigh;\nin vec3 nextPosition2DLow;\nin vec4 texCoordExpandAndBatchIndex;\n\nout vec2  v_st;\nout float v_width;\nout vec4 v_pickColor;\nout float v_polylineAngle;\n\nvoid main()\n{\n    float texCoord = texCoordExpandAndBatchIndex.x;\n    float expandDir = texCoordExpandAndBatchIndex.y;\n    bool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\n    float batchTableIndex = texCoordExpandAndBatchIndex.w;\n\n    vec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\n    float width = widthAndShow.x + 0.5;\n    float show = widthAndShow.y;\n\n    if (width < 1.0)\n    {\n        show = 0.0;\n    }\n\n    vec4 pickColor = batchTable_getPickColor(batchTableIndex);\n\n    vec4 p, prev, next;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\n        prev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\n        next = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\n        prev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\n        next = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\n                czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\n                czm_morphTime);\n        prev = czm_columbusViewMorph(\n                czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\n                czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\n                czm_morphTime);\n        next = czm_columbusViewMorph(\n                czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\n                czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\n                czm_morphTime);\n    }\n\n    #ifdef DISTANCE_DISPLAY_CONDITION\n        vec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\n        vec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\n        vec3 centerLow = centerLowAndRadius.xyz;\n        float radius = centerLowAndRadius.w;\n        vec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\n\n        float lengthSq;\n        if (czm_sceneMode == czm_sceneMode2D)\n        {\n            lengthSq = czm_eyeHeight2D.y;\n        }\n        else\n        {\n            vec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\n            lengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n        }\n\n        float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\n        float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\n        if (lengthSq < nearSq || lengthSq > farSq)\n        {\n            show = 0.0;\n        }\n    #endif\n\n    float polylineAngle;\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, polylineAngle);\n    gl_Position = czm_viewportOrthographic * positionWC * show;\n\n    v_st.s = texCoord;\n    v_st.t = czm_writeNonPerspective(clamp(expandDir, 0.0, 1.0), gl_Position.w);\n\n    v_width = width;\n    v_pickColor = pickColor;\n    v_polylineAngle = polylineAngle;\n}\n",QF="uniform sampler2D image;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 rampColor = texture(image, vec2(materialInput.aspect / (2.0 * czm_pi), 0.5));\n    rampColor = czm_gammaCorrect(rampColor);\n    material.diffuse = rampColor.rgb;\n    material.alpha = rampColor.a;\n    return material;\n}\n",JF="uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    vec2 centerPixel = fract(repeat * st);\n    float centerBump = texture(image, centerPixel).channel;\n\n    float imageWidth = float(imageDimensions.x);\n    vec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\n    float rightBump = texture(image, rightPixel).channel;\n\n    float imageHeight = float(imageDimensions.y);\n    vec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\n    float topBump = texture(image, leftPixel).channel;\n\n    vec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\n    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\n\n    material.normal = normalEC;\n    material.diffuse = vec3(0.01);\n\n    return material;\n}\n",eB="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n    float b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);  // 0.0 or 1.0\n\n    // Find the distance from the closest separator (region between two colors)\n    float scaledWidth = fract(repeat.s * st.s);\n    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\n    float scaledHeight = fract(repeat.t * st.t);\n    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\n    float value = min(scaledWidth, scaledHeight);\n\n    vec4 currentColor = mix(lightColor, darkColor, b);\n    vec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\n\n    color = czm_gammaCorrect(color);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n",tB="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // From Stefan Gustavson's Procedural Textures in GLSL in OpenGL Insights\n    float b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));  // 0.0 or 1.0\n\n    vec4 color = mix(lightColor, darkColor, b);\n    color = czm_gammaCorrect(color);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n",nB="uniform sampler2D heights;\nuniform sampler2D colors;\n\n// This material expects heights to be sorted from lowest to highest.\n\nfloat getHeight(int idx, float invTexSize)\n{\n    vec2 uv = vec2((float(idx) + 0.5) * invTexSize, 0.5);\n#ifdef OES_texture_float\n    return texture(heights, uv).x;\n#else\n    return czm_unpackFloat(texture(heights, uv));\n#endif\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float height = materialInput.height;\n    float invTexSize = 1.0 / float(heightsDimensions.x);\n\n    float minHeight = getHeight(0, invTexSize);\n    float maxHeight = getHeight(heightsDimensions.x - 1, invTexSize);\n\n    // early-out when outside the height range\n    if (height < minHeight || height > maxHeight) {\n        material.diffuse = vec3(0.0);\n        material.alpha = 0.0;\n        return material;\n    }\n\n    // Binary search to find heights above and below.\n    int idxBelow = 0;\n    int idxAbove = heightsDimensions.x;\n    float heightBelow = minHeight;\n    float heightAbove = maxHeight;\n\n    // while loop not allowed, so use for loop with max iterations.\n    // maxIterations of 16 supports a texture size up to 65536 (2^16).\n    const int maxIterations = 16;\n    for (int i = 0; i < maxIterations; i++) {\n        if (idxBelow >= idxAbove - 1) {\n            break;\n        }\n\n        int idxMid = (idxBelow + idxAbove) / 2;\n        float heightTex = getHeight(idxMid, invTexSize);\n\n        if (height > heightTex) {\n            idxBelow = idxMid;\n            heightBelow = heightTex;\n        } else {\n            idxAbove = idxMid;\n            heightAbove = heightTex;\n        }\n    }\n\n    float lerper = heightBelow == heightAbove ? 1.0 : (height - heightBelow) / (heightAbove - heightBelow);\n    vec2 colorUv = vec2(invTexSize * (float(idxBelow) + 0.5 + lerper), 0.5);\n    vec4 color = texture(colors, colorUv);\n\n    // undo preumultiplied alpha\n    if (color.a > 0.0) \n    {\n        color.rgb /= color.a;\n    }\n    \n    color.rgb = czm_gammaCorrect(color.rgb);\n\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n    return material;\n}\n",iB="uniform vec4 color;\nuniform float spacing;\nuniform float width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float distanceToContour = mod(materialInput.height, spacing);\n\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    float dxc = abs(dFdx(materialInput.height));\n    float dyc = abs(dFdy(materialInput.height));\n    float dF = max(dxc, dyc) * czm_pixelRatio * width;\n    float alpha = (distanceToContour < dF) ? 1.0 : 0.0;\n#else\n    // If no derivatives available (IE 10?), use pixel ratio\n    float alpha = (distanceToContour < (czm_pixelRatio * width)) ? 1.0 : 0.0;\n#endif\n\n    vec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha * color.a));\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n\n    return material;\n}\n",oB="uniform sampler2D image;\nuniform float minimumHeight;\nuniform float maximumHeight;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    float scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);\n    vec4 rampColor = texture(image, vec2(scaledHeight, 0.5));\n    rampColor = czm_gammaCorrect(rampColor);\n    material.diffuse = rampColor.rgb;\n    material.alpha = rampColor.a;\n    return material;\n}\n",rB="uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\n\nfloat getTime(float t, float coord)\n{\n    float scalar = 1.0 / maximumDistance;\n    float q  = distance(t, coord) * scalar;\n    if (repeat)\n    {\n        float r = distance(t, coord + 1.0) * scalar;\n        float s = distance(t, coord - 1.0) * scalar;\n        q = min(min(r, s), q);\n    }\n    return clamp(q, 0.0, 1.0);\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float s = getTime(time.x, st.s) * fadeDirection.s;\n    float t = getTime(time.y, st.t) * fadeDirection.t;\n\n    float u = length(vec2(s, t));\n    vec4 color = mix(fadeInColor, fadeOutColor, u);\n\n    color = czm_gammaCorrect(color);\n    material.emission = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n",sB='uniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n    float scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\n    scaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\n    float scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\n    scaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\n\n    float value;\n\n    // Fuzz Factor - Controls blurriness of lines\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    const float fuzz = 1.2;\n    vec2 thickness = (lineThickness * czm_pixelRatio) - 1.0;\n\n    // From "3D Engine Design for Virtual Globes" by Cozzi and Ring, Listing 4.13.\n    vec2 dx = abs(dFdx(st));\n    vec2 dy = abs(dFdy(st));\n    vec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\n    value = min(\n        smoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\n        smoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\n    // If no derivatives available (IE 10?), revert to view-dependent fuzz\n    const float fuzz = 0.05;\n\n    vec2 range = 0.5 - (lineThickness * 0.05);\n    value = min(\n        1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n        1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\n\n    // Edges taken from RimLightingMaterial.glsl\n    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html\n    float dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\n    float sRim = smoothstep(0.8, 1.0, dRim);\n    value *= (1.0 - sRim);\n\n    vec4 halfColor;\n    halfColor.rgb = color.rgb * 0.5;\n    halfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));\n    halfColor = czm_gammaCorrect(halfColor);\n    material.diffuse = halfColor.rgb;\n    material.emission = halfColor.rgb;\n    material.alpha = halfColor.a;\n\n    return material;\n}\n',aB="uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    \n    vec4 textureValue = texture(image, fract(repeat * materialInput.st));\n    vec3 normalTangentSpace = textureValue.channels;\n    normalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\n    normalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\n    normalTangentSpace = normalize(normalTangentSpace);\n    vec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\n    \n    material.normal = normalEC;\n    \n    return material;\n}\n",cB="uniform vec4 color;\n\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\n    float slope = (p0.y - p1.y) / (p0.x - p1.x);\n    return slope * (x - p0.x) + p0.y;\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n\n#if (__VERSION__ == 300 || defined(GL_OES_standard_derivatives))\n    float base = 1.0 - abs(fwidth(st.s)) * 10.0 * czm_pixelRatio;\n#else\n     // If no derivatives available (IE 10?), 2.5% of the line will be the arrow head\n    float base = 0.975;\n#endif\n\n    vec2 center = vec2(1.0, 0.5);\n    float ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\n    float ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\n\n    float halfWidth = 0.15;\n    float s = step(0.5 - halfWidth, st.t);\n    s *= 1.0 - step(0.5 + halfWidth, st.t);\n    s *= 1.0 - step(base, st.s);\n\n    float t = step(base, materialInput.st.s);\n    t *= 1.0 - step(ptOnUpperLine, st.t);\n    t *= step(ptOnLowerLine, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float dist;\n    if (st.s < base)\n    {\n        float d1 = abs(st.t - (0.5 - halfWidth));\n        float d2 = abs(st.t - (0.5 + halfWidth));\n        dist = min(d1, d2);\n    }\n    else\n    {\n        float d1 = czm_infinity;\n        if (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n        {\n            d1 = abs(st.s - base);\n        }\n        float d2 = abs(st.t - ptOnUpperLine);\n        float d3 = abs(st.t - ptOnLowerLine);\n        dist = min(min(d1, d2), d3);\n    }\n\n    vec4 outsideColor = vec4(0.0);\n    vec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\n    vec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\n\n    outColor = czm_gammaCorrect(outColor);\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n    return material;\n}\n",lB="uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nin float v_polylineAngle;\n\nconst float maskLength = 16.0;\n\nmat2 rotate(float rad) {\n    float c = cos(rad);\n    float s = sin(rad);\n    return mat2(\n        c, s,\n        -s, c\n    );\n}\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\n\n    // Get the relative position within the dash from 0 to 1\n    float dashPosition = fract(pos.x / (dashLength * czm_pixelRatio));\n    // Figure out the mask index.\n    float maskIndex = floor(dashPosition * maskLength);\n    // Test the bit mask.\n    float maskTest = floor(dashPattern / pow(2.0, maskIndex));\n    vec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\n    if (fragColor.a < 0.005) {   // matches 0/255 and 1/255\n        discard;\n    }\n\n    fragColor = czm_gammaCorrect(fragColor);\n    material.emission = fragColor.rgb;\n    material.alpha = fragColor.a;\n    return material;\n}\n",uB="uniform vec4 color;\nuniform float glowPower;\nuniform float taperPower;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\n\n    if (taperPower <= 0.99999) {\n        glow *= min(1.0, taperPower / (0.5 - st.s * 0.5) - (taperPower / 0.5));\n    }\n\n    vec4 fragColor;\n    fragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);\n    fragColor.a = clamp(0.0, 1.0, glow) * color.a;\n    fragColor = czm_gammaCorrect(fragColor);\n\n    material.emission = fragColor.rgb;\n    material.alpha = fragColor.a;\n\n    return material;\n}\n",fB="uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\n\nin float v_width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    vec2 st = materialInput.st;\n    float halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\n    float b = step(0.5 - halfInteriorWidth, st.t);\n    b *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\n\n    // Find the distance from the closest separator (region between two colors)\n    float d1 = abs(st.t - (0.5 - halfInteriorWidth));\n    float d2 = abs(st.t - (0.5 + halfInteriorWidth));\n    float dist = min(d1, d2);\n\n    vec4 currentColor = mix(outlineColor, color, b);\n    vec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\n    outColor = czm_gammaCorrect(outColor);\n\n    material.diffuse = outColor.rgb;\n    material.alpha = outColor.a;\n\n    return material;\n}\n",dB="uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // See http://www.fundza.com/rman_shaders/surface/fake_rim/fake_rim1.html\n    float d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\n    float s = smoothstep(1.0 - width, 1.0, d);\n\n    vec4 outColor = czm_gammaCorrect(color);\n    vec4 outRimColor = czm_gammaCorrect(rimColor);\n\n    material.diffuse = outColor.rgb;\n    material.emission = outRimColor.rgb * s;\n    material.alpha = mix(outColor.a, outRimColor.a, s);\n\n    return material;\n}\n",hB="uniform sampler2D image;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    vec4 rampColor = texture(image, vec2(materialInput.slope / (czm_pi / 2.0), 0.5));\n    rampColor = czm_gammaCorrect(rampColor);\n    material.diffuse = rampColor.rgb;\n    material.alpha = rampColor.a;\n    return material;\n}\n",mB="uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    // Based on the Stripes Fragment Shader in the Orange Book (11.1.2)\n    float coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\n    float value = fract((coord - offset) * (repeat * 0.5));\n    float dist = min(value, min(abs(value - 0.5), 1.0 - value));\n\n    vec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\n    vec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\n    color = czm_gammaCorrect(color);\n\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    return material;\n}\n",pB="// Thanks for the contribution Jonas\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\nuniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\n\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\n    czm_material material = czm_getDefaultMaterial(materialInput);\n\n    float time = czm_frameNumber * animationSpeed;\n\n    // fade is a function of the distance from the fragment and the frequency of the waves\n    float fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\n\n    float specularMapValue = texture(specularMap, materialInput.st).r;\n\n    // note: not using directional motion at this time, just set the angle to 0.0;\n    vec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\n    vec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\n\n    // fade out the normal perturbation as we move further from the water surface\n    normalTangentSpace.xy /= fade;\n\n    // attempt to fade out the normal perturbation as we approach non water areas (low specular map value)\n    normalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\n\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // get ratios for alignment of the new normal vector with a vector perpendicular to the tangent plane\n    float tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\n\n    // fade out water effect as specular map value decreases\n    material.alpha = mix(blendColor.a, baseWaterColor.a, specularMapValue) * specularMapValue;\n\n    // base color is a blend of the water and non-water color based on the value from the specular map\n    // may need a uniform blend factor to better control this\n    material.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\n\n    // diffuse highlights are based on how perturbed the normal is\n    material.diffuse += (0.1 * tsPerturbationRatio);\n\n    material.diffuse = material.diffuse;\n\n    material.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\n\n    material.specular = specularIntensity;\n    material.shininess = 10.0;\n\n    return material;\n}\n";function je(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._minificationFilter=y(e.minificationFilter,an.LINEAR),this._magnificationFilter=y(e.magnificationFilter,wi.LINEAR),this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,HWe(e,this),Object.defineProperties(this,{type:{value:this.type,writable:!1}}),u(je._uniformList[this.type])||(je._uniformList[this.type]=Object.keys(this._uniforms))}function HWe(e,t){e=y(e,y.EMPTY_OBJECT),t._strict=y(e.strict,!1),t._count=y(e.count,0),t._template=Ge(y(e.fabric,y.EMPTY_OBJECT)),t._template.uniforms=Ge(y(t._template.uniforms,y.EMPTY_OBJECT)),t._template.materials=Ge(y(t._template.materials,y.EMPTY_OBJECT)),t.type=u(t._template.type)?t._template.type:jn(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];let i,n=je._materialCache.getMaterial(t.type);if(u(n)){let e=Ge(n.fabric,!0);t._template=gt(t._template,e,!0),i=n.translucent}qWe(t),u(n)||je._materialCache.addMaterial(t.type,t),XWe(t),QWe(t),eje(t);let r=0===t._translucentFunctions.length||void 0;if(i=y(i,r),i=y(e.translucent,i),u(i))if("function"==typeof i){let e=function(){return i(t)};t._translucentFunctions.push(e)}else t._translucentFunctions.push(i)}function tW(e,t,i,n){if(u(e))for(let r in e)if(e.hasOwnProperty(r)){let e=-1!==t.indexOf(r);(n&&!e||!n&&e)&&i(r,t)}}function Rce(e,t){}function GWe(e,t){}je._uniformList={},je.fromType=function(e,t){let i=new je({fabric:{type:e}});if(u(t))for(let e in t)t.hasOwnProperty(e)&&(i.uniforms[e]=t[e]);return i},je.prototype.isTranslucent=function(){if(u(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;let e=!0,t=this._translucentFunctions,i=t.length;for(let n=0;n<i;++n){let i=t[n];if(e="function"==typeof i?e&&i():e&&i,!e)break}return e},je.prototype.update=function(e){this._defaultTexture=e.defaultTexture;let t,i,n=this._loadedImages,r=n.length;for(t=0;t<r;++t){let r=n[t];i=r.id;let o,a=r.image;Array.isArray(a)&&(o=a.slice(1,a.length).map((function(e){return e.bufferView})),a=a[0]);let s,l=new un({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter});s=u(a.internalFormat)?new Ot({context:e,pixelFormat:a.internalFormat,width:a.width,height:a.height,source:{arrayBufferView:a.bufferView,mipLevels:o},sampler:l}):new Ot({context:e,source:a,sampler:l});let c=this._textures[i];u(c)&&c!==this._defaultTexture&&c.destroy(),this._textures[i]=s;let h=`${i}Dimensions`;if(this.uniforms.hasOwnProperty(h)){let e=this.uniforms[h];e.x=s._width,e.y=s._height}}n.length=0;let o=this._loadedCubeMaps;for(r=o.length,t=0;t<r;++t){let n=o[t];i=n.id;let r=n.images,a=new bc({context:e,source:{positiveX:r[0],negativeX:r[1],positiveY:r[2],negativeY:r[3],positiveZ:r[4],negativeZ:r[5]},sampler:new un({minificationFilter:this._minificationFilter,magnificationFilter:this._magnificationFilter})});this._textures[i]=a}o.length=0;let a=this._updateFunctions;for(r=a.length,t=0;t<r;++t)a[t](this,e);let s=this.materials;for(let t in s)s.hasOwnProperty(t)&&s[t].update(e)},je.prototype.isDestroyed=function(){return!1},je.prototype.destroy=function(){let e=this._textures;for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];i!==this._defaultTexture&&i.destroy()}let t=this.materials;for(let e in t)t.hasOwnProperty(e)&&t[e].destroy();return le(this)};var WWe=["type","materials","uniforms","components","source"],jWe=["diffuse","specular","shininess","normal","emission","alpha"];function qWe(e){let t=e._template,i=t.uniforms,n=t.materials,r=t.components;tW(t,WWe,Rce,!0),tW(r,jWe,Rce,!0);let o=[];for(let e in n)n.hasOwnProperty(e)&&o.push(e);tW(i,o,GWe,!1)}function YWe(e,t){let i=t._template.materials;for(let t in i)if(i.hasOwnProperty(t)&&e.indexOf(t)>-1)return!0;return!1}function XWe(e){let t=e._template.components,i=e._template.source;if(u(i))e.shaderSource+=`${i}\n`;else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",u(t)){let i=Object.keys(e._template.materials).length>0;for(let n in t)if(t.hasOwnProperty(n))if("diffuse"===n||"emission"===n){let r=i&&YWe(t[n],e)?t[n]:`czm_gammaCorrect(${t[n]})`;e.shaderSource+=`material.${n} = ${r}; \n`}else e.shaderSource+="alpha"===n?`material.alpha = ${t.alpha}; \n`:`material.${n} = ${t[n]};\n`}e.shaderSource+="return material;\n}\n"}}var Mce={mat2:Ji,mat3:$,mat4:L},KWe=/\.ktx2$/i;function ZWe(e){let t;return function(i,n){let r=i.uniforms,o=r[e],a=t!==o,s=!u(o)||o===je.DefaultImageId;t=o;let l,c,h=i._textures[e];if(o instanceof HTMLVideoElement){if(o.readyState>=2){if(a&&u(h)&&(h!==n.defaultTexture&&h.destroy(),h=void 0),!u(h)||h===n.defaultTexture){let t=new un({minificationFilter:i._minificationFilter,magnificationFilter:i._magnificationFilter});return h=new Ot({context:n,source:o,sampler:t}),void(i._textures[e]=h)}h.copyFrom({source:o})}else u(h)||(i._textures[e]=n.defaultTexture);return}if(o instanceof Ot&&o!==h){i._texturePaths[e]=void 0;let t=i._textures[e];return u(t)&&t!==i._defaultTexture&&t.destroy(),i._textures[e]=o,l=`${e}Dimensions`,void(r.hasOwnProperty(l)&&(c=r[l],c.x=o._width,c.y=o._height))}if(a&&u(h)&&s&&(h!==i._defaultTexture&&h.destroy(),h=void 0),u(h)||(i._texturePaths[e]=void 0,h=i._textures[e]=i._defaultTexture,l=`${e}Dimensions`,r.hasOwnProperty(l)&&(c=r[l],c.x=h._width,c.y=h._height)),s)return;let d=o instanceof ve;if(!u(i._texturePaths[e])||d&&o.url!==i._texturePaths[e].url||!d&&o!==i._texturePaths[e]){if("string"==typeof o||d){let t,n=d?o:ve.createIfNeeded(o);t=KWe.test(n.url)?Ll(n.url):n.fetchImage(),Promise.resolve(t).then((function(t){i._loadedImages.push({id:e,image:t})})).catch((function(){u(h)&&h!==i._defaultTexture&&h.destroy(),i._textures[e]=i._defaultTexture}))}else(o instanceof HTMLCanvasElement||o instanceof HTMLImageElement)&&i._loadedImages.push({id:e,image:o});i._texturePaths[e]=o}}}function $We(e){return function(t,i){let n=t.uniforms[e];if(n instanceof bc){let i=t._textures[e];return i!==t._defaultTexture&&i.destroy(),t._texturePaths[e]=void 0,void(t._textures[e]=n)}if(u(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=i.defaultCubeMap),n===je.DefaultCubeMapId)return;let r=n.positiveX+n.negativeX+n.positiveY+n.negativeY+n.positiveZ+n.negativeZ;if(r!==t._texturePaths[e]){let i=[ve.createIfNeeded(n.positiveX).fetchImage(),ve.createIfNeeded(n.negativeX).fetchImage(),ve.createIfNeeded(n.positiveY).fetchImage(),ve.createIfNeeded(n.negativeY).fetchImage(),ve.createIfNeeded(n.positiveZ).fetchImage(),ve.createIfNeeded(n.negativeZ).fetchImage()];Promise.all(i).then((function(i){t._loadedCubeMaps.push({id:e,images:i})})),t._texturePaths[e]=r}}}function QWe(e){let t=e._template.uniforms;for(let i in t)t.hasOwnProperty(i)&&Lce(e,i)}function Lce(e,t){e._strict;let i,n=e._template.uniforms,r=n[t],o=JWe(r);if("channels"===o)i=ev(e,t,r,!1);else{if("sampler2D"===o){let i=`${t}Dimensions`;tje(e,i)>0&&(n[i]={type:"ivec3",x:1,y:1},Lce(e,i))}if(!new RegExp(`uniform\\s+${o}\\s+${t}\\s*;`).test(e.shaderSource)){let i=`uniform ${o} ${t};`;e.shaderSource=i+e.shaderSource}let a=`${t}_${e._count++}`;if(i=ev(e,t,a),e.uniforms[t]=r,"sampler2D"===o)e._uniforms[a]=function(){return e._textures[t]},e._updateFunctions.push(ZWe(t));else if("samplerCube"===o)e._uniforms[a]=function(){return e._textures[t]},e._updateFunctions.push($We(t));else if(-1!==o.indexOf("mat")){let i=new Mce[o];e._uniforms[a]=function(){return Mce[o].fromColumnMajorArray(e.uniforms[t],i)}}else e._uniforms[a]=function(){return e.uniforms[t]}}}function JWe(e){let t=e.type;if(!u(t)){let i=typeof e;if("number"===i)t="float";else if("boolean"===i)t="bool";else if("string"===i||e instanceof ve||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===je.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===i)if(Array.isArray(e))(4===e.length||9===e.length||16===e.length)&&(t=`mat${Math.sqrt(e.length)}`);else{let i=0;for(let t in e)e.hasOwnProperty(t)&&(i+=1);i>=2&&i<=4?t=`vec${i}`:6===i&&(t="samplerCube")}}return t}function eje(e){let t=e._strict,i=e._template.materials;for(let n in i)if(i.hasOwnProperty(n)){let r=new je({strict:t,fabric:i[n],count:e._count});e._count=r._count,e._uniforms=gt(e._uniforms,r._uniforms,!0),e.materials[n]=r,e._translucentFunctions=e._translucentFunctions.concat(r._translucentFunctions);let o="czm_getMaterial",a=`${o}_${e._count++}`;ev(r,o,a),e.shaderSource=r.shaderSource+e.shaderSource;ev(e,n,`${a}(materialInput)`)}}function ev(e,t,i,n){n=y(n,!0);let r=0,o=new RegExp(`([\\w${n?".":""}])?`+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(o,(function(e,t,n){return t||n?e:(r+=1,i)})),r}function tje(e,t,i){return ev(e,t,t,i)}je._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},je.DefaultImageId="czm_defaultImage",je.DefaultCubeMapId="czm_defaultCubeMap",je.ColorType="Color",je._materialCache.addMaterial(je.ColorType,{fabric:{type:je.ColorType,uniforms:{color:new z(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),je.ImageType="Image",je._materialCache.addMaterial(je.ImageType,{fabric:{type:je.ImageType,uniforms:{image:je.DefaultImageId,repeat:new U(1,1),color:new z(1,1,1,1)},components:{diffuse:"texture(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),je.DiffuseMapType="DiffuseMap",je._materialCache.addMaterial(je.DiffuseMapType,{fabric:{type:je.DiffuseMapType,uniforms:{image:je.DefaultImageId,channels:"rgb",repeat:new U(1,1)},components:{diffuse:"texture(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),je.AlphaMapType="AlphaMap",je._materialCache.addMaterial(je.AlphaMapType,{fabric:{type:je.AlphaMapType,uniforms:{image:je.DefaultImageId,channel:"a",repeat:new U(1,1)},components:{alpha:"texture(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),je.SpecularMapType="SpecularMap",je._materialCache.addMaterial(je.SpecularMapType,{fabric:{type:je.SpecularMapType,uniforms:{image:je.DefaultImageId,channel:"r",repeat:new U(1,1)},components:{specular:"texture(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),je.EmissionMapType="EmissionMap",je._materialCache.addMaterial(je.EmissionMapType,{fabric:{type:je.EmissionMapType,uniforms:{image:je.DefaultImageId,channels:"rgb",repeat:new U(1,1)},components:{emission:"texture(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),je.BumpMapType="BumpMap",je._materialCache.addMaterial(je.BumpMapType,{fabric:{type:je.BumpMapType,uniforms:{image:je.DefaultImageId,channel:"r",strength:.8,repeat:new U(1,1)},source:JF},translucent:!1}),je.NormalMapType="NormalMap",je._materialCache.addMaterial(je.NormalMapType,{fabric:{type:je.NormalMapType,uniforms:{image:je.DefaultImageId,channels:"rgb",strength:.8,repeat:new U(1,1)},source:aB},translucent:!1}),je.GridType="Grid",je._materialCache.addMaterial(je.GridType,{fabric:{type:je.GridType,uniforms:{color:new z(0,1,0,1),cellAlpha:.1,lineCount:new U(8,8),lineThickness:new U(1,1),lineOffset:new U(0,0)},source:sB},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),je.StripeType="Stripe",je._materialCache.addMaterial(je.StripeType,{fabric:{type:je.StripeType,uniforms:{horizontal:!0,evenColor:new z(1,1,1,.5),oddColor:new z(0,0,1,.5),offset:0,repeat:5},source:mB},translucent:function(e){let t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),je.CheckerboardType="Checkerboard",je._materialCache.addMaterial(je.CheckerboardType,{fabric:{type:je.CheckerboardType,uniforms:{lightColor:new z(1,1,1,.5),darkColor:new z(0,0,0,.5),repeat:new U(5,5)},source:eB},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),je.DotType="Dot",je._materialCache.addMaterial(je.DotType,{fabric:{type:je.DotType,uniforms:{lightColor:new z(1,1,0,.75),darkColor:new z(0,1,1,.75),repeat:new U(5,5)},source:tB},translucent:function(e){let t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),je.WaterType="Water",je._materialCache.addMaterial(je.WaterType,{fabric:{type:je.WaterType,uniforms:{baseWaterColor:new z(.2,.3,.6,1),blendColor:new z(0,1,.699,1),specularMap:je.DefaultImageId,normalMap:je.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:pB},translucent:function(e){let t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),je.RimLightingType="RimLighting",je._materialCache.addMaterial(je.RimLightingType,{fabric:{type:je.RimLightingType,uniforms:{color:new z(1,0,0,.7),rimColor:new z(1,1,1,.4),width:.3},source:dB},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),je.FadeType="Fade",je._materialCache.addMaterial(je.FadeType,{fabric:{type:je.FadeType,uniforms:{fadeInColor:new z(1,0,0,1),fadeOutColor:new z(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new U(.5,.5)},source:rB},translucent:function(e){let t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),je.PolylineArrowType="PolylineArrow",je._materialCache.addMaterial(je.PolylineArrowType,{fabric:{type:je.PolylineArrowType,uniforms:{color:new z(1,1,1,1)},source:cB},translucent:!0}),je.PolylineDashType="PolylineDash",je._materialCache.addMaterial(je.PolylineDashType,{fabric:{type:je.PolylineDashType,uniforms:{color:new z(1,0,1,1),gapColor:new z(0,0,0,0),dashLength:16,dashPattern:255},source:lB},translucent:!0}),je.PolylineGlowType="PolylineGlow",je._materialCache.addMaterial(je.PolylineGlowType,{fabric:{type:je.PolylineGlowType,uniforms:{color:new z(0,.5,1,1),glowPower:.25,taperPower:1},source:uB},translucent:!0}),je.PolylineOutlineType="PolylineOutline",je._materialCache.addMaterial(je.PolylineOutlineType,{fabric:{type:je.PolylineOutlineType,uniforms:{color:new z(1,1,1,1),outlineColor:new z(1,0,0,1),outlineWidth:1},source:fB},translucent:function(e){let t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),je.ElevationContourType="ElevationContour",je._materialCache.addMaterial(je.ElevationContourType,{fabric:{type:je.ElevationContourType,uniforms:{spacing:100,color:new z(1,0,0,1),width:1},source:iB},translucent:!1}),je.ElevationRampType="ElevationRamp",je._materialCache.addMaterial(je.ElevationRampType,{fabric:{type:je.ElevationRampType,uniforms:{image:je.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:oB},translucent:!1}),je.SlopeRampMaterialType="SlopeRamp",je._materialCache.addMaterial(je.SlopeRampMaterialType,{fabric:{type:je.SlopeRampMaterialType,uniforms:{image:je.DefaultImageId},source:hB},translucent:!1}),je.AspectRampMaterialType="AspectRamp",je._materialCache.addMaterial(je.AspectRampMaterialType,{fabric:{type:je.AspectRampMaterialType,uniforms:{image:je.DefaultImageId},source:QF},translucent:!1}),je.ElevationBandType="ElevationBand",je._materialCache.addMaterial(je.ElevationBandType,{fabric:{type:je.ElevationBandType,uniforms:{heights:je.DefaultImageId,colors:je.DefaultImageId},source:nB},translucent:!0});var Wi=je;function Xl(e,t){e=y(e,y.EMPTY_OBJECT),this._show=y(e.show,!0),this._width=y(e.width,1),this._loop=y(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,u(this._material)||(this._material=Wi.fromType(Wi.ColorType,{color:new z(1,1,1,1)}));let i,n=e.positions;u(n)||(n=[]),this._positions=n,this._actualPositions=go(n,h.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=n.slice()),this._actualPositions.push(h.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id,u(t)&&(i=L.clone(t.modelMatrix)),this._modelMatrix=i,this._segments=Mi.wrapLongitude(this._actualPositions,i),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(Fce),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=se.fromPoints(this._actualPositions),this._boundingVolumeWC=se.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new se}var Nce=Xl.POSITION_INDEX=0,nje=Xl.SHOW_INDEX=1,ije=Xl.WIDTH_INDEX=2,oje=Xl.MATERIAL_INDEX=3,tv=Xl.POSITION_SIZE_INDEX=4,rje=Xl.DISTANCE_DISPLAY_CONDITION=5,Fce=Xl.NUMBER_OF_PROPERTIES=6;function Tp(e,t){++e._propertiesChanged[t];let i=e._polylineCollection;u(i)&&(i._updatePolyline(e,t),e._dirty=!0)}Object.defineProperties(Xl.prototype,{show:{get:function(){return this._show},set:function(e){e!==this._show&&(this._show=e,Tp(this,nje))}},positions:{get:function(){return this._positions},set:function(e){let t=go(e,h.equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(h.clone(t[0]))),(this._actualPositions.length!==t.length||this._actualPositions.length!==this._length)&&Tp(this,tv),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=se.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=se.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),Tp(this,Nce),this.update()}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,Tp(this,oje))}},width:{get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,Tp(this,ije))}},loop:{get:function(){return this._loop},set:function(e){if(e!==this._loop){let t=this._actualPositions;e?t.length>2&&!h.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(h.clone(t[0]))):t.length>2&&h.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,Tp(this,tv)}}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},isDestroyed:{get:function(){return!u(this._polylineCollection)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){wt.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=wt.clone(e,this._distanceDisplayCondition),Tp(this,rje))}}}),Xl.prototype.update=function(){let e=L.IDENTITY;u(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);let t=this._segments.positions.length,i=this._segments.lengths,n=this._propertiesChanged[Nce]>0||this._propertiesChanged[tv]>0;if((!L.equals(e,this._modelMatrix)||n)&&(this._segments=Mi.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=se.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=L.clone(e,this._modelMatrix),this._segments.positions.length!==t)Tp(this,tv);else{let e=i.length;for(let t=0;t<e;++t)if(i[t]!==this._segments.lengths[t]){Tp(this,tv);break}}},Xl.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},Xl.prototype._clean=function(){this._dirty=!1;let e=this._propertiesChanged;for(let t=0;t<Fce-1;++t)e[t]=0},Xl.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var ad=Xl,sje=ad.SHOW_INDEX,aje=ad.WIDTH_INDEX,iW=ad.POSITION_INDEX,cje=ad.MATERIAL_INDEX,Bce=ad.POSITION_SIZE_INDEX,lje=ad.DISTANCE_DISPLAY_CONDITION,Wce=ad.NUMBER_OF_PROPERTIES,cl={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function cd(e){e=y(e,y.EMPTY_OBJECT),this.show=y(e.show,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=L.clone(L.IDENTITY),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(Wce),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:Be.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=z.clone(z.WHITE);let t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}function uje(e,t){u(e._batchTable)&&e._batchTable.destroy();let i=[{functionName:"batchTable_getWidthAndShow",componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:X.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:X.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:X.FLOAT,componentsPerAttribute:2}];e._batchTable=new JT(t,i,e._polylines.length)}Object.defineProperties(cd.prototype,{length:{get:function(){return oW(this),this._polylines.length}}}),cd.prototype.add=function(e){let t=new ad(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},cd.prototype.remove=function(e){if(this.contains(e)){if(this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,u(e._bucket)){let t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()}return e._destroy(),!0}return!1},cd.prototype.removeAll=function(){rW(this),Kce(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},cd.prototype.contains=function(e){return u(e)&&e._polylineCollection===this},cd.prototype.get=function(e){return oW(this),this._polylines[e]};var jce=new Wn,qce=new oe,Yce=new U;cd.prototype.update=function(e){if(oW(this),0===this._polylines.length||!this.show)return;_je(this,e);let t,i=e.context,n=e.mapProjection,r=this._propertiesChanged;if(this._createBatchTable){if(0===zt.maximumVertexTextureImageUnits)throw new ue("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");uje(this,i),this._createBatchTable=!1}if(this._createVertexArray||dje(this))Uce(this,i,n);else if(this._polylinesUpdated){let o=this._polylinesToUpdate;if(this._mode!==te.SCENE3D){let e=o.length;for(let i=0;i<e;++i)t=o[i],t.update()}if(r[Bce]||r[cje])Uce(this,i,n);else{let i=o.length,a=this._polylineBuckets;for(let s=0;s<i;++s){t=o[s],r=t._propertiesChanged;let i=t._bucket,l=0;for(let e in a)if(a.hasOwnProperty(e)){if(a[e]===i){r[iW]&&i.writeUpdate(l,t,this._positionBuffer,n);break}l+=a[e].lengthOfPositions}if((r[sje]||r[aje])&&this._batchTable.setBatchedAttribute(t._index,0,new U(t._width,t._show)),this._batchTable.attributes.length>2){if(r[iW]||r[Bce]){let i=e.mode===te.SCENE2D?t._boundingVolume2D:t._boundingVolumeWC,n=Wn.fromCartesian(i.center,jce),r=oe.fromElements(n.low.x,n.low.y,n.low.z,i.radius,qce);this._batchTable.setBatchedAttribute(t._index,2,n.high),this._batchTable.setBatchedAttribute(t._index,3,r)}if(r[lje]){let e=Yce;e.x=0,e.y=Number.MAX_VALUE;let i=t.distanceDisplayCondition;u(i)&&(e.x=i.near,e.y=i.far),this._batchTable.setBatchedAttribute(t._index,4,e)}}t._clean()}}o.length=0,this._polylinesUpdated=!1}r=this._propertiesChanged;for(let e=0;e<Wce;++e)r[e]=0;let o=L.IDENTITY;e.mode===te.SCENE3D&&(o=this.modelMatrix);let a=e.passes,s=0!==e.morphTime;if((!u(this._opaqueRS)||this._opaqueRS.depthTest.enabled!==s)&&(this._opaqueRS=Ue.fromCache({depthMask:s,depthTest:{enabled:s}})),(!u(this._translucentRS)||this._translucentRS.depthTest.enabled!==s)&&(this._translucentRS=Ue.fromCache({blending:ln.ALPHA_BLEND,depthMask:!s,depthTest:{enabled:s}})),this._batchTable.update(e),a.render||a.pick){fje(this,e,this._colorCommands,o)}};var nv=new se,kce=new se;function fje(e,t,i,n){let r=t.context,o=t.commandList,a=i.length,s=0,l=!0,c=e._vertexArrays,h=e.debugShowBoundingVolume,d=e._batchTable.getUniformMapCallback(),p=c.length;for(let f=0;f<p;++f){let p=c[f],m=p.buckets,_=m.length;for(let c=0;c<_;++c){let f,_,g,y,v=m[c],b=v.offset,A=v.bucket.shaderProgram,T=v.bucket.polylines,E=T.length,C=0;for(let c=0;c<E;++c){let m=T[c],E=mje(m._material);if(E!==f){if(u(f)&&C>0){let t=_.isTranslucent();s>=a?(g=new et({owner:e}),i.push(g)):g=i[s],++s,y=gt(d(_._uniforms),e._uniformMap),g.boundingVolume=se.clone(nv,g.boundingVolume),g.modelMatrix=n,g.shaderProgram=A,g.vertexArray=p.va,g.renderState=t?e._translucentRS:e._opaqueRS,g.pass=t?Ee.TRANSLUCENT:Ee.OPAQUE,g.debugShowBoundingVolume=h,g.pickId="v_pickColor",g.uniformMap=y,g.count=C,g.offset=b,b+=C,C=0,l=!0,o.push(g)}_=m._material,_.update(r),f=E}let x,S=m._locatorBuckets,w=S.length;for(let e=0;e<w;++e){let t=S[e];t.locator===v&&(C+=t.count)}t.mode===te.SCENE3D?x=m._boundingVolumeWC:t.mode===te.COLUMBUS_VIEW?x=m._boundingVolume2D:t.mode===te.SCENE2D?u(m._boundingVolume2D)&&(x=se.clone(m._boundingVolume2D,kce),x.center.x=0):u(m._boundingVolumeWC)&&u(m._boundingVolume2D)&&(x=se.union(m._boundingVolumeWC,m._boundingVolume2D,kce)),l?(l=!1,se.clone(x,nv)):se.union(x,nv,nv)}u(f)&&C>0&&(s>=a?(g=new et({owner:e}),i.push(g)):g=i[s],++s,y=gt(d(_._uniforms),e._uniformMap),g.boundingVolume=se.clone(nv,g.boundingVolume),g.modelMatrix=n,g.shaderProgram=A,g.vertexArray=p.va,g.renderState=_.isTranslucent()?e._translucentRS:e._opaqueRS,g.pass=_.isTranslucent()?Ee.TRANSLUCENT:Ee.OPAQUE,g.debugShowBoundingVolume=h,g.pickId="v_pickColor",g.uniformMap=y,g.count=C,g.offset=b,l=!0,o.push(g)),f=void 0}}i.length=s}function dje(e){let t=!1,i=e._propertiesChanged,n=e._positionBufferUsage;return i[iW]?(n.bufferUsage!==Be.STREAM_DRAW&&(t=!0,n.bufferUsage=Be.STREAM_DRAW),n.frameCount=100):n.bufferUsage!==Be.STATIC_DRAW&&(0===n.frameCount?(t=!0,n.bufferUsage=Be.STATIC_DRAW):n.frameCount--),t}cd.prototype.isDestroyed=function(){return!1},cd.prototype.destroy=function(){return Xce(this),rW(this),Kce(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),le(this)};var Vce=[0,0,0];function Uce(e,t,i){e._createVertexArray=!1,rW(e),Xce(e),pje(e);let n,r,o=[[]],a=o[0],s=e._batchTable,l=e._useHighlightColor,c=[0],h=0,d=[[]],p=0,f=e._polylineBuckets;for(n in f)f.hasOwnProperty(n)&&(r=f[n],r.updateShader(t,s,l),p+=r.lengthOfPositions);if(p>0){let l,m=e._mode,_=new Float32Array(6*p*3),g=new Float32Array(4*p),y=0,v=0,b=0;for(n in f)if(f.hasOwnProperty(n)){r=f[n],r.write(_,g,y,v,b,s,t,i),m===te.MORPHING&&(u(l)||(l=new Float32Array(6*p*3)),r.writeForMorph(l,y));let e=r.lengthOfPositions;y+=6*e*3,v+=4*e,b+=4*e,h=r.updateIndices(o,c,d,h)}let A,T=e._positionBufferUsage.bufferUsage,E=Be.STATIC_DRAW;e._positionBuffer=ut.createVertexBuffer({context:t,typedArray:_,usage:T}),u(l)&&(A=ut.createVertexBuffer({context:t,typedArray:l,usage:T})),e._texCoordExpandAndBatchIndexBuffer=ut.createVertexBuffer({context:t,typedArray:g,usage:E});let C=3*Float32Array.BYTES_PER_ELEMENT,x=4*Float32Array.BYTES_PER_ELEMENT,S=0,w=o.length;for(let i=0;i<w;++i)if(a=o[i],a.length>0){let n=new Uint16Array(a),r=ut.createIndexBuffer({context:t,typedArray:n,usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT});S+=c[i];let o,s,l,u,h=6*(i*(C*P.SIXTY_FOUR_KILOBYTES)-S*C),p=C+h,f=C+p,_=C+f,g=C+_,y=C+g,v=i*(x*P.SIXTY_FOUR_KILOBYTES)-S*x,b=[{index:cl.position3DHigh,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:h,strideInBytes:6*C},{index:cl.position3DLow,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:p,strideInBytes:6*C},{index:cl.position2DHigh,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:h,strideInBytes:6*C},{index:cl.position2DLow,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:p,strideInBytes:6*C},{index:cl.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:f,strideInBytes:6*C},{index:cl.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:_,strideInBytes:6*C},{index:cl.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:f,strideInBytes:6*C},{index:cl.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:_,strideInBytes:6*C},{index:cl.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:g,strideInBytes:6*C},{index:cl.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:y,strideInBytes:6*C},{index:cl.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:g,strideInBytes:6*C},{index:cl.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:X.FLOAT,offsetInBytes:y,strideInBytes:6*C},{index:cl.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:X.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:v}];m===te.SCENE3D?(s=e._positionBuffer,o="vertexBuffer",l=Vce,u="value"):m===te.SCENE2D||m===te.COLUMBUS_VIEW?(s=Vce,o="value",l=e._positionBuffer,u="vertexBuffer"):(s=A,o="vertexBuffer",l=e._positionBuffer,u="vertexBuffer"),b[0][o]=s,b[1][o]=s,b[2][u]=l,b[3][u]=l,b[4][o]=s,b[5][o]=s,b[6][u]=l,b[7][u]=l,b[8][o]=s,b[9][o]=s,b[10][u]=l,b[11][u]=l;let T=new ni({context:t,attributes:b,indexBuffer:r});e._vertexArrays.push({va:T,buckets:d[i]})}}}function hje(e,t){return t instanceof Ot?t.id:t}var _B=[];function mje(e){let t=Wi._uniformList[e.type],i=t.length;_B.length=2*i;let n=0;for(let r=0;r<i;++r){let i=t[r];_B[n]=i,_B[n+1]=e._uniforms[i](),n+=2}return`${e.type}:${JSON.stringify(_B,hje)}`}function pje(e){let t=e._mode,i=e._modelMatrix,n=e._polylineBuckets={},r=e._polylines,o=r.length;for(let e=0;e<o;++e){let o=r[e];if(o._actualPositions.length>1){o.update();let e=o.material,r=n[e.type];u(r)||(r=n[e.type]=new Wh(e,t,i)),r.addPolyline(o)}}}function _je(e,t){let i=t.mode;(e._mode!==i||!L.equals(e._modelMatrix,e.modelMatrix))&&(e._mode=i,e._modelMatrix=L.clone(e.modelMatrix),e._createVertexArray=!0)}function oW(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;let t,i=[],n=[],r=0,o=e._polylines.length;for(let a=0;a<o;++a)t=e._polylines[a],t.isDestroyed||(t._index=r++,n.push(t),i.push(t));e._polylines=i,e._polylinesToUpdate=n}}function rW(e){let t=e._polylines,i=t.length;for(let e=0;e<i;++e)if(!t[e].isDestroyed){let i=t[e]._bucket;u(i)&&(i.shaderProgram=i.shaderProgram&&i.shaderProgram.destroy())}}function Xce(e){let t=e._vertexArrays.length;for(let i=0;i<t;++i)e._vertexArrays[i].va.destroy();e._vertexArrays.length=0}function Kce(e){let t=e._polylines,i=t.length;for(let e=0;e<i;++e)t[e].isDestroyed||t[e]._destroy()}function nW(e,t,i){this.count=e,this.offset=t,this.bucket=i}function Wh(e,t,i){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=i}function Zce(e){return h.dot(h.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(tn.ORIGIN_ZX_PLANE)===Zt.INTERSECTING}cd.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},Wh.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},Wh.prototype.updateShader=function(e,t,i){if(u(this.shaderProgram))return;let n=["DISTANCE_DISPLAY_CONDITION"];i&&n.push("VECTOR_TILE"),-1!==this.material.shaderSource.search(/in\s+float\s+v_polylineAngle;/g)&&n.push("POLYLINE_DASH"),Bt.isInternetExplorer()||n.push("CLIP_POLYLINE");let r=new He({defines:n,sources:["in vec4 v_pickColor;\n",this.material.shaderSource,MA]}),o=t.getVertexShaderCallback()($F),a=new He({defines:n,sources:[of,o]});this.shaderProgram=Kt.fromCache({context:e,vertexShaderSource:a,fragmentShaderSource:r,attributeLocations:cl})},Wh.prototype.getPolylinePositionsLength=function(e){let t;if(this.mode===te.SCENE3D||!Zce(e))return t=e._actualPositions.length,4*t-4;let i=0,n=e._segments.lengths;t=n.length;for(let e=0;e<t;++e)i+=4*n[e]-4;return i};var as=new h,rf=new h,sf=new h,gB=new h,gje=new oe,yje=new U;Wh.prototype.write=function(e,t,i,n,r,o,a,s){let l=this.mode,c=s.ellipsoid.maximumRadius*P.PI,d=this.polylines,p=d.length;for(let n=0;n<p;++n){let p,f=d[n],m=f.width,_=f.show&&m>0,g=f._index,y=this.getSegments(f,s),v=y.positions,b=y.lengths,A=v.length,T=f.getPickId(a).color,E=0,C=0;for(let n=0;n<A;++n){0===n?f._loop?p=v[A-2]:(p=gB,h.subtract(v[0],v[1],p),h.add(v[0],p,p)):p=v[n-1],h.clone(p,rf),h.clone(v[n],as),n===A-1?f._loop?p=v[1]:(p=gB,h.subtract(v[A-1],v[A-2],p),h.add(v[A-1],p,p)):p=v[n+1],h.clone(p,sf);let o=b[E];n===C+o&&(C+=o,++E);let a=n-C==0,s=n===C+b[E]-1;l===te.SCENE2D&&(rf.z=0,as.z=0,sf.z=0),(l===te.SCENE2D||l===te.MORPHING)&&(a||s)&&c-Math.abs(as.x)<1&&((as.x<0&&rf.x>0||as.x>0&&rf.x<0)&&h.clone(as,rf),(as.x<0&&sf.x>0||as.x>0&&sf.x<0)&&h.clone(as,sf));let u=s?2:4;for(let o=a?2:0;o<u;++o){Wn.writeElements(as,e,i),Wn.writeElements(rf,e,i+6),Wn.writeElements(sf,e,i+12);let a=o-2<0?-1:1;t[r]=n/(A-1),t[r+1]=o%2*2-1,t[r+2]=a,t[r+3]=g,i+=18,r+=4}}let x=gje;x.x=z.floatToByte(T.red),x.y=z.floatToByte(T.green),x.z=z.floatToByte(T.blue),x.w=z.floatToByte(T.alpha);let S=yje;S.x=m,S.y=_?1:0;let w=l===te.SCENE2D?f._boundingVolume2D:f._boundingVolumeWC,I=Wn.fromCartesian(w.center,jce),P=I.high,D=oe.fromElements(I.low.x,I.low.y,I.low.z,w.radius,qce),O=Yce;O.x=0,O.y=Number.MAX_VALUE;let L=f.distanceDisplayCondition;u(L)&&(O.x=L.near,O.y=L.far),o.setBatchedAttribute(g,0,S),o.setBatchedAttribute(g,1,x),o.attributes.length>2&&(o.setBatchedAttribute(g,2,P),o.setBatchedAttribute(g,3,D),o.setBatchedAttribute(g,4,O))}};var xje=new h,bje=new h,Tje=new h,zce=new h;Wh.prototype.writeForMorph=function(e,t){let i=this.modelMatrix,n=this.polylines,r=n.length;for(let o=0;o<r;++o){let r=n[o],a=r._segments.positions,s=r._segments.lengths,l=a.length,u=0,c=0;for(let n=0;n<l;++n){let o;0===n?r._loop?o=a[l-2]:(o=zce,h.subtract(a[0],a[1],o),h.add(a[0],o,o)):o=a[n-1],o=L.multiplyByPoint(i,o,bje);let d,p=L.multiplyByPoint(i,a[n],xje);n===l-1?r._loop?d=a[1]:(d=zce,h.subtract(a[l-1],a[l-2],d),h.add(a[l-1],d,d)):d=a[n+1],d=L.multiplyByPoint(i,d,Tje);let f=s[u];n===c+f&&(c+=f,++u);let m=n-c==0,_=n===c+s[u]-1?2:4;for(let i=m?2:0;i<_;++i)Wn.writeElements(p,e,t),Wn.writeElements(o,e,t+6),Wn.writeElements(d,e,t+12),t+=18}}};var Aje=new Array(1);Wh.prototype.updateIndices=function(e,t,i,n){let r=i.length-1,o=new nW(0,n,this);i[r].push(o);let a=0,s=e[e.length-1],l=0;s.length>0&&(l=s[s.length-1]+1);let u=this.polylines,c=u.length;for(let h=0;h<c;++h){let c,d=u[h];if(d._locatorBuckets=[],this.mode===te.SCENE3D){c=Aje;let e=d._actualPositions.length;if(!(e>0))continue;c[0]=e}else c=d._segments.lengths;let p=c.length;if(p>0){let u=0;for(let h=0;h<p;++h){let p=c[h]-1;for(let c=0;c<p;++c)l+4>P.SIXTY_FOUR_KILOBYTES&&(d._locatorBuckets.push({locator:o,count:u}),u=0,t.push(4),s=[],e.push(s),l=0,o.count=a,a=0,n=0,o=new nW(0,0,this),i[++r]=[o]),s.push(l,l+2,l+1),s.push(l+1,l+2,l+3),u+=6,a+=6,n+=6,l+=4}d._locatorBuckets.push({locator:o,count:u}),l+4>P.SIXTY_FOUR_KILOBYTES&&(t.push(0),s=[],e.push(s),l=0,o.count=a,n=0,a=0,o=new nW(0,0,this),i[++r]=[o])}d._clean()}return o.count=a,n},Wh.prototype.getPolylineStartIndex=function(e){let t=this.polylines,i=0,n=t.length;for(let r=0;r<n;++r){let n=t[r];if(n===e)break;i+=n._actualLength}return i};var LA={positions:void 0,lengths:void 0},Hce=new Array(1),Cje=new h,Eje=new fe,Gce;Wh.prototype.getSegments=function(e,t){let i=e._actualPositions;if(this.mode===te.SCENE3D)return Hce[0]=i.length,LA.positions=i,LA.lengths=Hce,LA;Zce(e)&&(i=e._segments.positions);let n,r=t.ellipsoid,o=[],a=this.modelMatrix,s=i.length,l=Cje;for(let e=0;e<s;++e)n=i[e],l=L.multiplyByPoint(a,n,l),o.push(t.project(r.cartesianToCartographic(l,Eje)));if(o.length>0){e._boundingVolume2D=se.fromPoints(o,e._boundingVolume2D);let t=e._boundingVolume2D.center;e._boundingVolume2D.center=new h(t.z,t.x,t.y)}return LA.positions=o,LA.lengths=e._segments.lengths,LA},Wh.prototype.writeUpdate=function(e,t,i,n){let r=this.mode,o=n.ellipsoid.maximumRadius*P.PI,a=t._actualLength;if(a){e+=this.getPolylineStartIndex(t);let s=Gce,l=6*a*3;!u(s)||s.length<l?s=Gce=new Float32Array(l):s.length>l&&(s=new Float32Array(s.buffer,0,l));let c,d=this.getSegments(t,n),p=d.positions,f=d.lengths,m=0,_=0,g=0;a=p.length;for(let e=0;e<a;++e){0===e?t._loop?c=p[a-2]:(c=gB,h.subtract(p[0],p[1],c),h.add(p[0],c,c)):c=p[e-1],h.clone(c,rf),h.clone(p[e],as),e===a-1?t._loop?c=p[1]:(c=gB,h.subtract(p[a-1],p[a-2],c),h.add(p[a-1],c,c)):c=p[e+1],h.clone(c,sf);let i=f[_];e===g+i&&(g+=i,++_);let n=e-g==0,l=e===g+f[_]-1;r===te.SCENE2D&&(rf.z=0,as.z=0,sf.z=0),(r===te.SCENE2D||r===te.MORPHING)&&(n||l)&&o-Math.abs(as.x)<1&&((as.x<0&&rf.x>0||as.x>0&&rf.x<0)&&h.clone(as,rf),(as.x<0&&sf.x>0||as.x>0&&sf.x<0)&&h.clone(as,sf));let u=l?2:4;for(let e=n?2:0;e<u;++e)Wn.writeElements(as,s,m),Wn.writeElements(rf,s,m+6),Wn.writeElements(sf,s,m+12),m+=18}i.copyFromArrayView(s,18*Float32Array.BYTES_PER_ELEMENT*e)}};var jh=cd;function Rg(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=new $u({batchTable:e.batchTable}),this._labelCollection=new bp({batchTable:e.batchTable}),this._polylineCollection=new jh,this._polylineCollection._useHighlightColor=!0,this._packedBuffer=void 0,this._ready=!1,this._promise=void 0,this._error=void 0}function Sje(e,t){let i=e._rectangle,n=e._minHeight,r=e._maxHeight,o=2+ce.packedLength+ie.packedLength,a=new Float64Array(o),s=0;return a[s++]=n,a[s++]=r,ce.pack(i,a,s),s+=ce.packedLength,ie.pack(t,a,s),a}Object.defineProperties(Rg.prototype,{ready:{get:function(){return this._ready}},pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){return this._billboardCollection.textureAtlas.texture.sizeInBytes+this._labelCollection._textureAtlas.texture.sizeInBytes}}});var wje=new pi("createVectorTilePoints",5),vje=new h;function Dje(e,t){let i=e._positions,n=e._packedBuffer;u(n)||(i=e._positions=i.slice(),e._batchIds=e._batchIds.slice(),n=e._packedBuffer=Sje(e,t));let r=[i.buffer,n.buffer],o={positions:i.buffer,packedBuffer:n.buffer},a=wje.scheduleTask(o,r);if(u(a))return a.then((t=>{if(e.isDestroyed())return;e._positions=new Float64Array(t.positions);let n=e._billboardCollection,r=e._labelCollection,o=e._polylineCollection;i=e._positions;let a=e._batchIds,s=i.length/3;for(let e=0;e<s;++e){let t=a[e],s=h.unpack(i,3*e,vje),l=n.add();l.position=s,l._batchIndex=t;let u=r.add();u.text=" ",u.position=s,u._batchIndex=t,o.add().positions=[h.clone(s),h.clone(s)]}e._positions=void 0,e._packedBuffer=void 0,e._ready=!0})).catch((t=>{e.isDestroyed()||(e._error=t)}))}function Ije(e,t){let i=e._batchIds,n=i.length;for(let e=0;e<n;++e){let n=t[i[e]];n.show=!0,n.pointSize=Og.defaultPointSize,n.color=Og.defaultColor,n.pointOutlineColor=Og.defaultPointOutlineColor,n.pointOutlineWidth=Og.defaultPointOutlineWidth,n.labelColor=z.WHITE,n.labelOutlineColor=z.WHITE,n.labelOutlineWidth=1,n.font="30px sans-serif",n.labelStyle=zo.FILL,n.labelText=void 0,n.backgroundColor=new z(.165,.165,.165,.8),n.backgroundPadding=new U(7,5),n.backgroundEnabled=!1,n.scaleByDistance=void 0,n.translucencyByDistance=void 0,n.distanceDisplayCondition=void 0,n.heightOffset=0,n.anchorLineEnabled=!1,n.anchorLineColor=z.WHITE,n.image=void 0,n.disableDepthTestDistance=0,n.horizontalOrigin=yi.CENTER,n.verticalOrigin=On.CENTER,n.labelHorizontalOrigin=yi.RIGHT,n.labelVerticalOrigin=On.BASELINE}}Rg.prototype.createFeatures=function(e,t){let i=this._billboardCollection,n=this._labelCollection,r=this._polylineCollection,o=this._batchIds,a=o.length;for(let s=0;s<a;++s){let a=o[s],l=i.get(s),u=n.get(s),c=r.get(s);t[a]=new Og(e,a,l,u,c)}},Rg.prototype.applyDebugSettings=function(e,t){e?(z.clone(t,this._billboardCollection._highlightColor),z.clone(t,this._labelCollection._highlightColor),z.clone(t,this._polylineCollection._highlightColor)):(z.clone(z.WHITE,this._billboardCollection._highlightColor),z.clone(z.WHITE,this._labelCollection._highlightColor),z.clone(z.WHITE,this._polylineCollection._highlightColor))};var Pje=new z,Oje=new z,Rje=new z,Mje=new z,Lje=new z,Nje=new z,iv=new Pt,ov=new Pt,sW=new wt;Rg.prototype.applyStyle=function(e,t){if(!u(e))return void Ije(this,t);let i=this._batchIds,n=i.length;for(let r=0;r<n;++r){let n=t[i[r]];if(u(e.show)&&(n.show=e.show.evaluate(n)),u(e.pointSize)&&(n.pointSize=e.pointSize.evaluate(n)),u(e.color)&&(n.color=e.color.evaluateColor(n,Pje)),u(e.pointOutlineColor)&&(n.pointOutlineColor=e.pointOutlineColor.evaluateColor(n,Oje)),u(e.pointOutlineWidth)&&(n.pointOutlineWidth=e.pointOutlineWidth.evaluate(n)),u(e.labelColor)&&(n.labelColor=e.labelColor.evaluateColor(n,Rje)),u(e.labelOutlineColor)&&(n.labelOutlineColor=e.labelOutlineColor.evaluateColor(n,Mje)),u(e.labelOutlineWidth)&&(n.labelOutlineWidth=e.labelOutlineWidth.evaluate(n)),u(e.font)&&(n.font=e.font.evaluate(n)),u(e.labelStyle)&&(n.labelStyle=e.labelStyle.evaluate(n)),u(e.labelText)?n.labelText=e.labelText.evaluate(n):n.labelText=void 0,u(e.backgroundColor)&&(n.backgroundColor=e.backgroundColor.evaluateColor(n,Lje)),u(e.backgroundPadding)&&(n.backgroundPadding=e.backgroundPadding.evaluate(n)),u(e.backgroundEnabled)&&(n.backgroundEnabled=e.backgroundEnabled.evaluate(n)),u(e.scaleByDistance)){let t=e.scaleByDistance.evaluate(n);u(t)?(iv.near=t.x,iv.nearValue=t.y,iv.far=t.z,iv.farValue=t.w,n.scaleByDistance=iv):n.scaleByDistance=void 0}else n.scaleByDistance=void 0;if(u(e.translucencyByDistance)){let t=e.translucencyByDistance.evaluate(n);u(t)?(ov.near=t.x,ov.nearValue=t.y,ov.far=t.z,ov.farValue=t.w,n.translucencyByDistance=ov):n.translucencyByDistance=void 0}else n.translucencyByDistance=void 0;if(u(e.distanceDisplayCondition)){let t=e.distanceDisplayCondition.evaluate(n);u(t)?(sW.near=t.x,sW.far=t.y,n.distanceDisplayCondition=sW):n.distanceDisplayCondition=void 0}else n.distanceDisplayCondition=void 0;u(e.heightOffset)&&(n.heightOffset=e.heightOffset.evaluate(n)),u(e.anchorLineEnabled)&&(n.anchorLineEnabled=e.anchorLineEnabled.evaluate(n)),u(e.anchorLineColor)&&(n.anchorLineColor=e.anchorLineColor.evaluateColor(n,Nje)),u(e.image)?n.image=e.image.evaluate(n):n.image=void 0,u(e.disableDepthTestDistance)&&(n.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(n)),u(e.horizontalOrigin)&&(n.horizontalOrigin=e.horizontalOrigin.evaluate(n)),u(e.verticalOrigin)&&(n.verticalOrigin=e.verticalOrigin.evaluate(n)),u(e.labelHorizontalOrigin)&&(n.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(n)),u(e.labelVerticalOrigin)&&(n.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(n))}},Rg.prototype.update=function(e){if(this._ready)this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e);else if(u(this._promise)||(this._promise=Dje(this,e.mapProjection.ellipsoid)),u(this._error)){let e=this._error;throw this._error=void 0,e}},Rg.prototype.isDestroyed=function(){return!1},Rg.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),le(this)};var yB=Rg;function Ap(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=y(e.center,h.ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._promise=void 0,this._error=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=zn.BOTH}function Fje(e){let t=new Float64Array(3+h.packedLength+ie.packedLength+ce.packedLength),i=0;return t[i++]=e._indices.BYTES_PER_ELEMENT,t[i++]=e._minimumHeight,t[i++]=e._maximumHeight,h.pack(e._center,t,i),i+=h.packedLength,ie.pack(e._ellipsoid,t,i),i+=ie.packedLength,ce.pack(e._rectangle,t,i),t}function Bje(e,t){let i=1,n=t[i++],r=e._boundingVolumes=new Array(n);for(let e=0;e<n;++e)r[e]=Pn.unpack(t,i),i+=Pn.packedLength;let o=t[i++],a=e._batchedIndices=new Array(o);for(let e=0;e<o;++e){let n=z.unpack(t,i);i+=z.packedLength;let r=t[i++],o=t[i++],s=t[i++],l=new Array(s);for(let e=0;e<s;++e)l[e]=t[i++];a[e]=new op({color:n,offset:r,count:o,batchIds:l})}}Object.defineProperties(Ap.prototype,{trianglesLength:{get:function(){return u(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return u(this._primitive)?this._primitive.geometryByteLength:0}},ready:{get:function(){return this._ready}}});var kje=new pi("createVectorTilePolygons",5),Vje=new z;function Uje(e){if(u(e._primitive))return;let t=e._positions,i=e._counts,n=e._indexCounts,r=e._indices,o=e._transferrableBatchIds,a=e._batchTableColors,s=e._packedBuffer;if(!u(a)){t=e._positions=e._positions.slice(),i=e._counts=e._counts.slice(),n=e._indexCounts=e._indexCounts.slice(),r=e._indices=e._indices.slice(),e._center=e._ellipsoid.cartographicToCartesian(ce.center(e._rectangle)),o=e._transferrableBatchIds=new Uint32Array(e._batchIds),a=e._batchTableColors=new Uint32Array(o.length);let l=e._batchTable,u=a.length;for(let e=0;e<u;++e){let t=l.getColor(e,Vje);a[e]=t.toRgba()}s=e._packedBuffer=Fje(e)}let l=[t.buffer,i.buffer,n.buffer,r.buffer,o.buffer,a.buffer,s.buffer],c={packedBuffer:s.buffer,positions:t.buffer,counts:i.buffer,indexCounts:n.buffer,indices:r.buffer,batchIds:o.buffer,batchTableColors:a.buffer},h=e._polygonMinimumHeights,d=e._polygonMaximumHeights;u(h)&&u(d)&&(h=h.slice(),d=d.slice(),l.push(h.buffer,d.buffer),c.minimumHeights=h,c.maximumHeights=d);let p=kje.scheduleTask(c,l);return u(p)?p.then((t=>{if(e.isDestroyed())return;e._positions=void 0,e._counts=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0;let i=new Float64Array(t.packedBuffer),n=i[0];Bje(e,i),e._indices=2===ke.getSizeInBytes(n)?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._batchedPositions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.batchIds),zje(e),e._ready=!0})).catch((t=>{e.isDestroyed()||(e._error=t)})):void 0}function zje(e){u(e._primitive)||(e._primitive=new dA({batchTable:e._batchTable,positions:e._batchedPositions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center}),e._batchTable=void 0,e._batchIds=void 0,e._positions=void 0,e._counts=void 0,e._indices=void 0,e._indexCounts=void 0,e._indexOffsets=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0,e._center=void 0,e._rectangle=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0)}Ap.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},Ap.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},Ap.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},Ap.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},Ap.prototype.update=function(e){if(this._ready)this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e);else if(u(this._promise)||(this._promise=Uje(this)),u(this._error)){let e=this._error;throw this._error=void 0,e}},Ap.prototype.isDestroyed=function(){return!1},Ap.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),le(this)};var xB=Ap,bB="in vec4 currentPosition;\nin vec4 previousPosition;\nin vec4 nextPosition;\nin vec2 expandAndWidth;\nin float a_batchId;\n\nuniform mat4 u_modifiedModelView;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = u_modifiedModelView * currentPosition;\n    vec4 prev = u_modifiedModelView * previousPosition;\n    vec4 next = u_modifiedModelView * nextPosition;\n\n    float angle;\n    vec4 positionWC = getPolylineWindowCoordinatesEC(p, prev, next, expandDir, width, usePrev, angle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n}\n";function ld(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=z.clone(z.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._promise=void 0,this._error=void 0}function Hje(e){let t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,r=e._ellipsoid,o=e._center,a=2+ce.packedLength+ie.packedLength+h.packedLength,s=new Float64Array(a),l=0;return s[l++]=i,s[l++]=n,ce.pack(t,s,l),l+=ce.packedLength,ie.pack(r,s,l),l+=ie.packedLength,h.pack(o,s,l),s}Object.defineProperties(ld.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}}});var Gje=new pi("createVectorTilePolylines",5),NA={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};function Wje(e,t){if(u(e._va))return;let i=e._positions,n=e._widths,r=e._counts,o=e._transferrableBatchIds,a=e._packedBuffer;u(a)||(i=e._positions=i.slice(),n=e._widths=n.slice(),r=e._counts=r.slice(),o=e._transferrableBatchIds=e._batchIds.slice(),a=e._packedBuffer=Hje(e));let s=[i.buffer,n.buffer,r.buffer,o.buffer,a.buffer],l={positions:i.buffer,widths:n.buffer,counts:r.buffer,batchIds:o.buffer,packedBuffer:a.buffer,keepDecodedPositions:e._keepDecodedPositions},c=Gje.scheduleTask(l,s);return u(c)?c.then((function(i){if(e.isDestroyed())return;e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(i.decodedPositions),e._decodedPositionOffsets=new Uint32Array(i.decodedPositionOffsets)),e._currentPositions=new Float32Array(i.currentPositions),e._previousPositions=new Float32Array(i.previousPositions),e._nextPositions=new Float32Array(i.nextPositions),e._expandAndWidth=new Float32Array(i.expandAndWidth),e._vertexBatchIds=new Uint16Array(i.batchIds);let n=i.indexDatatype;e._indices=n===ke.UNSIGNED_SHORT?new Uint16Array(i.indices):new Uint32Array(i.indices),jje(e,t),e._ready=!0})).catch((t=>{e.isDestroyed()||(e._error=t)})):void 0}function jje(e,t){if(!u(e._va)){let i=e._currentPositions,n=e._previousPositions,r=e._nextPositions,o=e._expandAndWidth,a=e._vertexBatchIds,s=e._indices,l=n.byteLength+i.byteLength+r.byteLength;l+=o.byteLength+a.byteLength+s.byteLength,e._trianglesLength=s.length/3,e._geometryByteLength=l;let u=ut.createVertexBuffer({context:t,typedArray:n,usage:Be.STATIC_DRAW}),c=ut.createVertexBuffer({context:t,typedArray:i,usage:Be.STATIC_DRAW}),h=ut.createVertexBuffer({context:t,typedArray:r,usage:Be.STATIC_DRAW}),d=ut.createVertexBuffer({context:t,typedArray:o,usage:Be.STATIC_DRAW}),p=ut.createVertexBuffer({context:t,typedArray:a,usage:Be.STATIC_DRAW}),f=ut.createIndexBuffer({context:t,typedArray:s,usage:Be.STATIC_DRAW,indexDatatype:2===s.BYTES_PER_ELEMENT?ke.UNSIGNED_SHORT:ke.UNSIGNED_INT}),m=[{index:NA.previousPosition,vertexBuffer:u,componentDatatype:X.FLOAT,componentsPerAttribute:3},{index:NA.currentPosition,vertexBuffer:c,componentDatatype:X.FLOAT,componentsPerAttribute:3},{index:NA.nextPosition,vertexBuffer:h,componentDatatype:X.FLOAT,componentsPerAttribute:3},{index:NA.expandAndWidth,vertexBuffer:d,componentDatatype:X.FLOAT,componentsPerAttribute:2},{index:NA.a_batchId,vertexBuffer:p,componentDatatype:X.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new ni({context:t,attributes:m,indexBuffer:f}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._currentPositions=void 0,e._previousPositions=void 0,e._nextPositions=void 0,e._expandAndWidth=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}var rv=new L,$ce=new h;function qje(e,t){u(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){let i=t.uniformState.view;return L.clone(i,rv),L.multiplyByPoint(rv,e._center,$ce),L.setTranslation(rv,$ce,rv),rv},u_highlightColor:function(){return e._highlightColor}})}function Yje(e){if(u(e._rs))return;e._rs=Ue.fromCache({blending:ln.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:{enabled:!0,factor:-5,units:-5}})}var Xje="uniform vec4 u_highlightColor; \nvoid main()\n{\n    out_FragColor = u_highlightColor;\n}\n";function Kje(e,t){if(u(e._sp))return;let i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(bB),r=i.getFragmentShaderCallback(!1,void 0,!1)(Xje),o=new He({defines:["VECTOR_TILE",Bt.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[of,n]}),a=new He({defines:["VECTOR_TILE"],sources:[r]});e._sp=Kt.fromCache({context:t,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:NA})}function Zje(e,t){if(!u(e._command)){let t=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new et({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:Ee.TRANSLUCENT,pickId:e._batchTable.getPickId()})}t.commandList.push(e._command)}function $je(e,t){let i=e._batchIds,n=i.length;for(let e=0;e<n;++e){let n=t[i[e]];n.show=!0,n.color=z.WHITE}}ld.getPolylinePositions=function(e,t){let i=e._batchIds,n=e._decodedPositions,r=e._decodedPositionOffsets;if(!u(i)||!u(n))return;let o,a,s=i.length,l=0,c=0;for(o=0;o<s;++o)i[o]===t&&(l+=r[o+1]-r[o]);if(0===l)return;let h=new Float64Array(3*l);for(o=0;o<s;++o)if(i[o]===t){let e=r[o],t=r[o+1]-e;for(a=0;a<t;++a){let t=3*(e+a);h[c++]=n[t],h[c++]=n[t+1],h[c++]=n[t+2]}}return h},ld.prototype.getPositions=function(e){return ld.getPolylinePositions(this,e)},ld.prototype.createFeatures=function(e,t){let i=this._batchIds,n=i.length;for(let r=0;r<n;++r){let n=i[r];t[n]=new Fs(e,n)}},ld.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var Qje=new z,Jje=z.WHITE,e7e=!0;ld.prototype.applyStyle=function(e,t){if(!u(e))return void $je(this,t);let i=this._batchIds,n=i.length;for(let r=0;r<n;++r){let n=t[i[r]];n.color=u(e.color)?e.color.evaluateColor(n,Qje):Jje,n.show=u(e.show)?e.show.evaluate(n):e7e}},ld.prototype.update=function(e){let t=e.context;if(!this._ready){if(u(this._promise)||(this._promise=Wje(this,t)),u(this._error)){let e=this._error;throw this._error=void 0,e}return}qje(this,t),Kje(this,t),Yje(this);let i=e.passes;(i.render||i.pick)&&Zje(this,e)},ld.prototype.isDestroyed=function(){return!1},ld.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),le(this)};var FA=ld,TB='in vec3 startEllipsoidNormal;\nin vec3 endEllipsoidNormal;\nin vec4 startPositionAndHeight;\nin vec4 endPositionAndHeight;\nin vec4 startFaceNormalAndVertexCorner;\nin vec4 endFaceNormalAndHalfWidth;\nin float a_batchId;\n\nuniform mat4 u_modifiedModelView;\nuniform vec2 u_minimumMaximumVectorHeights;\n\nout vec4 v_startPlaneEC;\nout vec4 v_endPlaneEC;\nout vec4 v_rightPlaneEC;\nout float v_halfWidth;\nout vec3 v_volumeUpEC;\n\nvoid main()\n{\n    // vertex corner IDs\n    //          3-----------7\n    //         /|   left   /|\n    //        / | 1       / |\n    //       2-----------6  5  end\n    //       | /         | /\n    // start |/  right   |/\n    //       0-----------4\n    //\n    float isEnd = floor(startFaceNormalAndVertexCorner.w * 0.251); // 0 for front, 1 for end\n    float isTop = floor(startFaceNormalAndVertexCorner.w * mix(0.51, 0.19, isEnd)); // 0 for bottom, 1 for top\n\n    vec3 forward = endPositionAndHeight.xyz - startPositionAndHeight.xyz;\n    vec3 right = normalize(cross(forward, startEllipsoidNormal));\n\n    vec4 position = vec4(startPositionAndHeight.xyz, 1.0);\n    position.xyz += forward * isEnd;\n\n    v_volumeUpEC = czm_normal * normalize(cross(right, forward));\n\n    // Push for volume height\n    float offset;\n    vec3 ellipsoidNormal = mix(startEllipsoidNormal, endEllipsoidNormal, isEnd);\n\n    // offset height to create volume\n    offset = mix(startPositionAndHeight.w, endPositionAndHeight.w, isEnd);\n    offset = mix(u_minimumMaximumVectorHeights.y, u_minimumMaximumVectorHeights.x, isTop) - offset;\n    position.xyz += offset * ellipsoidNormal;\n\n    // move from RTC to EC\n    position = u_modifiedModelView * position;\n    right = czm_normal * right;\n\n    // Push for width in a direction that is in the start or end plane and in a plane with right\n    // N = normalEC ("right-facing" direction for push)\n    // R = right\n    // p = angle between N and R\n    // w = distance to push along R if R == N\n    // d = distance to push along N\n    //\n    //   N   R\n    //  {  p| }      * cos(p) = dot(N, R) = w / d\n    //  d  |  |w    * d = w / dot(N, R)\n    //    { | }\n    //       o---------- polyline segment ----\x3e\n    //\n    vec3 scratchNormal = mix(-startFaceNormalAndVertexCorner.xyz, endFaceNormalAndHalfWidth.xyz, isEnd);\n    scratchNormal = cross(scratchNormal, mix(startEllipsoidNormal, endEllipsoidNormal, isEnd));\n    vec3 miterPushNormal = czm_normal * normalize(scratchNormal);\n\n    offset = 2.0 * endFaceNormalAndHalfWidth.w * max(0.0, czm_metersPerPixel(position)); // offset = widthEC\n    offset = offset / dot(miterPushNormal, right);\n    position.xyz += miterPushNormal * (offset * sign(0.5 - mod(startFaceNormalAndVertexCorner.w, 2.0)));\n\n    gl_Position = czm_depthClamp(czm_projection * position);\n\n    position = u_modifiedModelView * vec4(startPositionAndHeight.xyz, 1.0);\n    vec3 startNormalEC = czm_normal * startFaceNormalAndVertexCorner.xyz;\n    v_startPlaneEC = vec4(startNormalEC, -dot(startNormalEC, position.xyz));\n    v_rightPlaneEC = vec4(right, -dot(right, position.xyz));\n\n    position = u_modifiedModelView * vec4(endPositionAndHeight.xyz, 1.0);\n    vec3 endNormalEC = czm_normal * endFaceNormalAndHalfWidth.xyz;\n    v_endPlaneEC = vec4(endNormalEC, -dot(endNormalEC, position.xyz));\n    v_halfWidth = endFaceNormalAndHalfWidth.w;\n}\n',AB="in vec4 v_startPlaneEC;\nin vec4 v_endPlaneEC;\nin vec4 v_rightPlaneEC;\nin float v_halfWidth;\nin vec3 v_volumeUpEC;\n\nuniform vec4 u_highlightColor;\nvoid main()\n{\n    float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));\n\n    // Discard for sky\n    if (logDepthOrDepth == 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\n        out_FragColor = vec4(0.0, 0.0, 1.0, 0.5);\n        return;\n#else // DEBUG_SHOW_VOLUME\n        discard;\n#endif // DEBUG_SHOW_VOLUME\n    }\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\n    eyeCoordinate /= eyeCoordinate.w;\n\n    float halfMaxWidth = v_halfWidth * czm_metersPerPixel(eyeCoordinate);\n\n    // Expand halfMaxWidth if direction to camera is almost perpendicular with the volume's up direction\n    halfMaxWidth += halfMaxWidth * (1.0 - dot(-normalize(eyeCoordinate.xyz), v_volumeUpEC));\n\n    // Check distance of the eye coordinate against the right-facing plane\n    float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);\n\n    // Check eye coordinate against the mitering planes\n    float distanceFromStart = czm_planeDistance(v_startPlaneEC, eyeCoordinate.xyz);\n    float distanceFromEnd = czm_planeDistance(v_endPlaneEC, eyeCoordinate.xyz);\n\n    if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\n        out_FragColor = vec4(logDepthOrDepth, 0.0, 0.0, 0.5);\n        return;\n#else // DEBUG_SHOW_VOLUME\n        discard;\n#endif // DEBUG_SHOW_VOLUME\n    }\n    out_FragColor = u_highlightColor;\n\n    czm_writeDepthClamp();\n}\n";function Cp(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._minimumMaximumVectorHeights=new U(li._defaultMinTerrainHeight,li._defaultMaxTerrainHeight),this._boundingVolume=Pn.fromRectangle(e.rectangle,li._defaultMinTerrainHeight,li._defaultMaxTerrainHeight,this._ellipsoid),this._classificationType=e.classificationType,this._keepDecodedPositions=e.keepDecodedPositions,this._decodedPositions=void 0,this._decodedPositionOffsets=void 0,this._startEllipsoidNormals=void 0,this._endEllipsoidNormals=void 0,this._startPositionAndHeights=void 0,this._startFaceNormalAndVertexCornerIds=void 0,this._endPositionAndHeights=void 0,this._endFaceNormalAndHalfWidths=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=z.clone(z.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._promise=void 0,this._error=void 0}function t7e(e,t,i){let n=li.getMinimumMaximumHeights(t,i),r=n.minimumTerrainHeight,o=n.maximumTerrainHeight,a=e._minimumMaximumVectorHeights;a.x=r,a.y=o;let s=e._boundingVolume,l=e._rectangle;Pn.fromRectangle(l,r,o,i,s)}function n7e(e){let t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,r=e._ellipsoid,o=e._center,a=2+ce.packedLength+ie.packedLength+h.packedLength,s=new Float64Array(a),l=0;return s[l++]=i,s[l++]=n,ce.pack(t,s,l),l+=ce.packedLength,ie.pack(r,s,l),l+=ie.packedLength,h.pack(o,s,l),s}Object.defineProperties(Cp.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}}});var i7e=new pi("createVectorTileClampedPolylines"),Mg={startEllipsoidNormal:0,endEllipsoidNormal:1,startPositionAndHeight:2,endPositionAndHeight:3,startFaceNormalAndVertexCorner:4,endFaceNormalAndHalfWidth:5,a_batchId:6};function o7e(e,t){if(u(e._va))return;let i=e._positions,n=e._widths,r=e._counts,o=e._transferrableBatchIds,a=e._packedBuffer;u(a)||(i=e._positions=i.slice(),n=e._widths=n.slice(),r=e._counts=r.slice(),o=e._transferrableBatchIds=e._batchIds.slice(),a=e._packedBuffer=n7e(e));let s=[i.buffer,n.buffer,r.buffer,o.buffer,a.buffer],l={positions:i.buffer,widths:n.buffer,counts:r.buffer,batchIds:o.buffer,packedBuffer:a.buffer,keepDecodedPositions:e._keepDecodedPositions},c=i7e.scheduleTask(l,s);return u(c)?c.then((function(i){if(e.isDestroyed())return;e._keepDecodedPositions&&(e._decodedPositions=new Float64Array(i.decodedPositions),e._decodedPositionOffsets=new Uint32Array(i.decodedPositionOffsets)),e._startEllipsoidNormals=new Float32Array(i.startEllipsoidNormals),e._endEllipsoidNormals=new Float32Array(i.endEllipsoidNormals),e._startPositionAndHeights=new Float32Array(i.startPositionAndHeights),e._startFaceNormalAndVertexCornerIds=new Float32Array(i.startFaceNormalAndVertexCornerIds),e._endPositionAndHeights=new Float32Array(i.endPositionAndHeights),e._endFaceNormalAndHalfWidths=new Float32Array(i.endFaceNormalAndHalfWidths),e._vertexBatchIds=new Uint16Array(i.vertexBatchIds);let n=i.indexDatatype;e._indices=n===ke.UNSIGNED_SHORT?new Uint16Array(i.indices):new Uint32Array(i.indices),r7e(e,t),e._ready=!0})).catch((t=>{e.isDestroyed()||(e._error=t)})):void 0}function r7e(e,t){if(!u(e._va)){let i=e._startEllipsoidNormals,n=e._endEllipsoidNormals,r=e._startPositionAndHeights,o=e._endPositionAndHeights,a=e._startFaceNormalAndVertexCornerIds,s=e._endFaceNormalAndHalfWidths,l=e._vertexBatchIds,u=e._indices,c=i.byteLength+n.byteLength;c+=r.byteLength+o.byteLength,c+=a.byteLength+s.byteLength,c+=l.byteLength+u.byteLength,e._trianglesLength=u.length/3,e._geometryByteLength=c;let h=ut.createVertexBuffer({context:t,typedArray:i,usage:Be.STATIC_DRAW}),d=ut.createVertexBuffer({context:t,typedArray:n,usage:Be.STATIC_DRAW}),p=ut.createVertexBuffer({context:t,typedArray:r,usage:Be.STATIC_DRAW}),f=ut.createVertexBuffer({context:t,typedArray:o,usage:Be.STATIC_DRAW}),m=ut.createVertexBuffer({context:t,typedArray:a,usage:Be.STATIC_DRAW}),_=ut.createVertexBuffer({context:t,typedArray:s,usage:Be.STATIC_DRAW}),g=ut.createVertexBuffer({context:t,typedArray:l,usage:Be.STATIC_DRAW}),y=ut.createIndexBuffer({context:t,typedArray:u,usage:Be.STATIC_DRAW,indexDatatype:2===u.BYTES_PER_ELEMENT?ke.UNSIGNED_SHORT:ke.UNSIGNED_INT}),v=[{index:Mg.startEllipsoidNormal,vertexBuffer:h,componentDatatype:X.FLOAT,componentsPerAttribute:3},{index:Mg.endEllipsoidNormal,vertexBuffer:d,componentDatatype:X.FLOAT,componentsPerAttribute:3},{index:Mg.startPositionAndHeight,vertexBuffer:p,componentDatatype:X.FLOAT,componentsPerAttribute:4},{index:Mg.endPositionAndHeight,vertexBuffer:f,componentDatatype:X.FLOAT,componentsPerAttribute:4},{index:Mg.startFaceNormalAndVertexCorner,vertexBuffer:m,componentDatatype:X.FLOAT,componentsPerAttribute:4},{index:Mg.endFaceNormalAndHalfWidth,vertexBuffer:_,componentDatatype:X.FLOAT,componentsPerAttribute:4},{index:Mg.a_batchId,vertexBuffer:g,componentDatatype:X.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new ni({context:t,attributes:v,indexBuffer:y}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._startEllipsoidNormals=void 0,e._endEllipsoidNormals=void 0,e._startPositionAndHeights=void 0,e._startFaceNormalAndVertexCornerIds=void 0,e._endPositionAndHeights=void 0,e._endFaceNormalAndHalfWidths=void 0,e._vertexBatchIds=void 0,e._indices=void 0}}var sv=new L,Qce=new h;function s7e(e,t){u(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){let i=t.uniformState.view;return L.clone(i,sv),L.multiplyByPoint(sv,e._center,Qce),L.setTranslation(sv,Qce,sv),sv},u_highlightColor:function(){return e._highlightColor},u_minimumMaximumVectorHeights:function(){return e._minimumMaximumVectorHeights}})}function Jce(e){return Ue.fromCache({cull:{enabled:!0,face:gi.FRONT},blending:ln.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:Un.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:Un.EQUAL,backOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},reference:Lt.CESIUM_3D_TILE_MASK,mask:Lt.CESIUM_3D_TILE_MASK}})}function a7e(e){u(e._rs)||(e._rs=Jce(!1),e._rs3DTiles=Jce(!0))}function c7e(e,t){if(u(e._sp))return;let i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(TB),r=i.getFragmentShaderCallback(!1,void 0,!0)(AB),o=new He({defines:["VECTOR_TILE",Bt.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[of,n]}),a=new He({defines:["VECTOR_TILE"],sources:[r]});e._sp=Kt.fromCache({context:t,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:Mg})}function l7e(e,t){let i=e._command;if(!u(e._command)){let t=e._batchTable.getUniformMapCallback()(e._uniformMap);i=e._command=new et({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:t,boundingVolume:e._boundingVolume,pass:Ee.TERRAIN_CLASSIFICATION,pickId:e._batchTable.getPickId()});let n=et.shallowClone(i,i.derivedCommands.tileset);n.renderState=e._rs3DTiles,n.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,i.derivedCommands.tileset=n}let n=e._classificationType;(n===zn.TERRAIN||n===zn.BOTH)&&t.commandList.push(i),(n===zn.CESIUM_3D_TILE||n===zn.BOTH)&&t.commandList.push(i.derivedCommands.tileset)}function u7e(e,t){let i=e._batchIds,n=i.length;for(let e=0;e<n;++e){let n=t[i[e]];n.show=!0,n.color=z.WHITE}}Cp.prototype.getPositions=function(e){return FA.getPolylinePositions(this,e)},Cp.prototype.createFeatures=function(e,t){let i=this._batchIds,n=i.length;for(let r=0;r<n;++r){let n=i[r];t[n]=new Fs(e,n)}},Cp.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var f7e=new z,d7e=z.WHITE,h7e=!0;function m7e(e){return li.initialize().then((function(){t7e(e,e._rectangle,e._ellipsoid)})).catch((t=>{e.isDestroyed()||(e._error=t)}))}Cp.prototype.applyStyle=function(e,t){if(!u(e))return void u7e(this,t);let i=this._batchIds,n=i.length;for(let r=0;r<n;++r){let n=t[i[r]];n.color=u(e.color)?e.color.evaluateColor(n,f7e):d7e,n.show=u(e.show)?e.show.evaluate(n):h7e}},Cp.prototype.update=function(e){let t=e.context;if(!this._ready){if(u(this._promise)||(this._promise=m7e(this).then(o7e(this,t))),u(this._error)){let e=this._error;throw this._error=void 0,e}return}s7e(this,t),c7e(this,t),a7e(this);let i=e.passes;(i.render||i.pick)&&l7e(this,e)},Cp.prototype.isDestroyed=function(){return!1},Cp.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),le(this)};var CB=Cp;function qh(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._metadata=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,this._group=void 0,this._ready=!1,x7e(this,n,r)}function p7e(e){return function(t,i){u(e._polygons)&&e._polygons.updateCommands(t,i)}}function _7e(e,t){let i,n,r,o,a=y(e.POLYGONS_LENGTH,0),s=y(e.POLYLINES_LENGTH,0),l=y(e.POINTS_LENGTH,0);if(a>0&&u(e.POLYGON_BATCH_IDS)){let n=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,n,a)}if(s>0&&u(e.POLYLINE_BATCH_IDS)){let i=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,i,s)}if(l>0&&u(e.POINT_BATCH_IDS)){let i=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,i,l)}let c=u(i)||u(n)||u(r),h=a>0&&!u(i)||s>0&&!u(n)||l>0&&!u(r);if(c&&h)throw new ue("If one group of batch ids is defined, then all batch ids must be defined");if(!u(i)&&!u(n)&&!u(r)){let e=0;if(!u(i)&&a>0)for(i=new Uint16Array(a),o=0;o<a;++o)i[o]=e++;if(!u(n)&&s>0)for(n=new Uint16Array(s),o=0;o<s;++o)n[o]=e++;if(!u(r)&&l>0)for(r=new Uint16Array(l),o=0;o<l;++o)r[o]=e++}return{polygons:i,polylines:n,points:r}}Object.defineProperties(qh.prototype,{featuresLength:{get:function(){return u(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return u(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){let e=0;return u(this._polygons)&&(e+=this._polygons.trianglesLength),u(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){let e=0;return u(this._polygons)&&(e+=this._polygons.geometryByteLength),u(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return u(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return u(this._batchTable)?this._batchTable.batchTableByteLength:0}},innerContents:{get:function(){}},ready:{get:function(){return this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},metadata:{get:function(){return this._metadata},set:function(e){this._metadata=e}},batchTable:{get:function(){return this._batchTable}},group:{get:function(){return this._group},set:function(e){this._group=e}}});var ud=Uint32Array.BYTES_PER_ELEMENT;function g7e(e){return new FA(e)}function y7e(e){return new CB(e)}function x7e(e,t,i){i=y(i,0);let n=new Uint8Array(t),r=new DataView(t);i+=ud;let o=r.getUint32(i,!0);if(1!==o)throw new ue(`Only Vector tile version 1 is supported.  Version ${o} is not.`);i+=ud;let a=r.getUint32(i,!0);if(i+=ud,0===a)return void(e._ready=!0);let s=r.getUint32(i,!0);if(i+=ud,0===s)throw new ue("Feature table must have a byte length greater than zero");let l=r.getUint32(i,!0);i+=ud;let c=r.getUint32(i,!0);i+=ud;let d=r.getUint32(i,!0);i+=ud;let p=r.getUint32(i,!0);i+=ud;let f=r.getUint32(i,!0);i+=ud;let m=r.getUint32(i,!0);i+=ud;let _=r.getUint32(i,!0),g=So(n,i+=ud,s);i+=s;let v,b,A=new Uint8Array(t,i,l);i+=l,c>0&&(v=So(n,i,c),i+=c,d>0&&(b=new Uint8Array(t,i,d),b=new Uint8Array(b),i+=d));let T=y(g.POLYGONS_LENGTH,0),E=y(g.POLYLINES_LENGTH,0),C=y(g.POINTS_LENGTH,0),x=T+E+C,S=new ag(e,x,v,b,p7e(e));if(e._batchTable=S,0===x)return;let w=new kh(g,A),I=w.getGlobalProperty("REGION");if(!u(I))throw new ue("Feature table global property: REGION must be defined");let D=ce.unpack(I),O=I[4],R=I[5],N=e._tile.computedTransform,M=w.getGlobalProperty("RTC_CENTER",X.FLOAT,3);u(M)?(M=h.unpack(M),L.multiplyByPoint(N,M,M)):(M=ce.center(D),M.height=P.lerp(O,R,.5),M=ie.WGS84.cartographicToCartesian(M));let F=_7e(g,A);if(i+=(4-i%4)%4,T>0){w.featuresLength=T;let n=y(w.getPropertyArray("POLYGON_COUNTS",X.UNSIGNED_INT,1),w.getPropertyArray("POLYGON_COUNT",X.UNSIGNED_INT,1));if(!u(n))throw new ue("Feature table property: POLYGON_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");let r=y(w.getPropertyArray("POLYGON_INDEX_COUNTS",X.UNSIGNED_INT,1),w.getPropertyArray("POLYGON_INDEX_COUNT",X.UNSIGNED_INT,1));if(!u(r))throw new ue("Feature table property: POLYGON_INDEX_COUNTS must be defined when POLYGONS_LENGTH is greater than 0");let o=n.reduce((function(e,t){return e+2*t}),0),a=r.reduce((function(e,t){return e+t}),0),s=new Uint32Array(t,i,a);i+=p;let l,c,h=new Uint16Array(t,i,o);i+=f,u(g.POLYGON_MINIMUM_HEIGHTS)&&u(g.POLYGON_MAXIMUM_HEIGHTS)&&(l=w.getPropertyArray("POLYGON_MINIMUM_HEIGHTS",X.FLOAT,1),c=w.getPropertyArray("POLYGON_MAXIMUM_HEIGHTS",X.FLOAT,1)),e._polygons=new xB({positions:h,counts:n,indexCounts:r,indices:s,minimumHeight:O,maximumHeight:R,polygonMinimumHeights:l,polygonMaximumHeights:c,center:M,rectangle:D,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:S,batchIds:F.polygons,modelMatrix:N})}if(E>0){w.featuresLength=E;let n=y(w.getPropertyArray("POLYLINE_COUNTS",X.UNSIGNED_INT,1),w.getPropertyArray("POLYLINE_COUNT",X.UNSIGNED_INT,1));if(!u(n))throw new ue("Feature table property: POLYLINE_COUNTS must be defined when POLYLINES_LENGTH is greater than 0");let r=w.getPropertyArray("POLYLINE_WIDTHS",X.UNSIGNED_SHORT,1);if(!u(r)){r=new Uint16Array(E);for(let e=0;e<E;++e)r[e]=2}let o=n.reduce((function(e,t){return e+3*t}),0),a=new Uint16Array(t,i,o);i+=m;let s=e._tileset,l=s.examineVectorLinesFunction;if(u(l)){b7e(M1(new Uint16Array(a),D,O,R,ie.WGS84),n,F.polylines,S,e.url,l)}let c=g7e;u(s.classificationType)&&(c=y7e),e._polylines=c({positions:a,widths:r,counts:n,batchIds:F.polylines,minimumHeight:O,maximumHeight:R,center:M,rectangle:D,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:S,classificationType:s.classificationType,keepDecodedPositions:s.vectorKeepDecodedPositions})}if(C>0){let n=new Uint16Array(t,i,3*C);i+=_,e._points=new yB({positions:n,batchIds:F.points,minimumHeight:O,maximumHeight:R,rectangle:D,batchTable:S})}}function aW(e){let t=e.featuresLength;if(!u(e._features)&&t>0){let i=new Array(t);u(e._polygons)&&e._polygons.createFeatures(e,i),u(e._polylines)&&e._polylines.createFeatures(e,i),u(e._points)&&e._points.createFeatures(e,i),e._features=i}}function b7e(e,t,i,n,r,o){let a=t.length,s=0;for(let l=0;l<a;l++){let a=3*t[l],u=e.slice(s,s+a);s+=a,o(u,i[l],r,n)}}qh.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},qh.prototype.getFeature=function(e){return u(this._features)||aW(this),this._features[e]},qh.prototype.applyDebugSettings=function(e,t){u(this._polygons)&&this._polygons.applyDebugSettings(e,t),u(this._polylines)&&this._polylines.applyDebugSettings(e,t),u(this._points)&&this._points.applyDebugSettings(e,t)},qh.prototype.applyStyle=function(e){u(this._features)||aW(this),u(this._polygons)&&this._polygons.applyStyle(e,this._features),u(this._polylines)&&this._polylines.applyStyle(e,this._features),u(this._points)&&this._points.applyStyle(e,this._features)},qh.prototype.update=function(e,t){let i=!0;u(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(t),i=i&&this._polygons.ready),u(this._polylines)&&(this._polylines.update(t),i=i&&this._polylines.ready),u(this._points)&&(this._points.update(t),i=i&&this._points.ready),u(this._batchTable)&&i&&(u(this._features)||aW(this),this._batchTable.update(e,t),this._ready=!0)},qh.prototype.getPolylinePositions=function(e){let t=this._polylines;if(u(t))return t.getPositions(e)},qh.prototype.isDestroyed=function(){return!1},qh.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),le(this)};var EB=qh,ele={b3dm:function(e,t,i,n,r){return yp.fromB3dm(e,t,i,n,r)},pnts:function(e,t,i,n,r){return yp.fromPnts(e,t,i,n,r)},i3dm:function(e,t,i,n,r){return yp.fromI3dm(e,t,i,n,r)},cmpt:function(e,t,i,n,r){return cN.fromTileType(e,t,i,n,r,ele)},externalTileset:function(e,t,i,n){return KF.fromJson(e,t,i,n)},geom:function(e,t,i,n,r){return new gN(e,t,i,n,r)},vctr:function(e,t,i,n,r){return new EB(e,t,i,n,r)},subt:function(e,t,i,n,r){return Rw.fromSubtreeJson(e,t,i,void 0,n,r)},subtreeJson:function(e,t,i,n){return Rw.fromSubtreeJson(e,t,i,n)},glb:function(e,t,i,n,r){if(n.byteLength<12)throw new ue("Invalid glb content");let o=new DataView(n,r).getUint32(8,!0),a=new Uint8Array(n,r,o);return yp.fromGltf(e,t,i,a)},gltf:function(e,t,i,n){return yp.fromGltf(e,t,i,n)},geoJson:function(e,t,i,n){return yp.fromGeoJson(e,t,i,n)}},BA=ele,T7e={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Ho=Object.freeze(T7e),fd={BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",COMPOSITE:"cmpt",POINT_CLOUD:"pnts",VECTOR:"vctr",GEOMETRY:"geom",GLTF:"gltf",GLTF_BINARY:"glb",IMPLICIT_SUBTREE:"subt",IMPLICIT_SUBTREE_JSON:"subtreeJson",EXTERNAL_TILESET:"externalTileset",MULTIPLE_CONTENT:"multipleContent",GEOJSON:"geoJson",VOXEL_BINARY:"voxl",VOXEL_JSON:"voxelJson",isBinaryFormat:function(e){switch(e){case fd.BATCHED_3D_MODEL:case fd.INSTANCED_3D_MODEL:case fd.COMPOSITE:case fd.POINT_CLOUD:case fd.VECTOR:case fd.GEOMETRY:case fd.IMPLICIT_SUBTREE:case fd.VOXEL_BINARY:case fd.GLTF_BINARY:return!0;default:return!1}}},Es=Object.freeze(fd),A7e={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0},dd=Object.freeze(A7e),Ss={RENDER:0,PICK:1,SHADOW:2,PRELOAD:3,PRELOAD_FLIGHT:4,REQUEST_RENDER_MODE_DEFER_CHECK:5,MOST_DETAILED_PRELOAD:6,MOST_DETAILED_PICK:7,NUMBER_OF_PASSES:8},Ep=new Array(Ss.NUMBER_OF_PASSES);Ep[Ss.RENDER]=Object.freeze({pass:Ss.RENDER,isRender:!0,requestTiles:!0,ignoreCommands:!1}),Ep[Ss.PICK]=Object.freeze({pass:Ss.PICK,isRender:!1,requestTiles:!1,ignoreCommands:!1}),Ep[Ss.SHADOW]=Object.freeze({pass:Ss.SHADOW,isRender:!1,requestTiles:!0,ignoreCommands:!1}),Ep[Ss.PRELOAD]=Object.freeze({pass:Ss.PRELOAD,isRender:!1,requestTiles:!0,ignoreCommands:!0}),Ep[Ss.PRELOAD_FLIGHT]=Object.freeze({pass:Ss.PRELOAD_FLIGHT,isRender:!1,requestTiles:!0,ignoreCommands:!0}),Ep[Ss.REQUEST_RENDER_MODE_DEFER_CHECK]=Object.freeze({pass:Ss.REQUEST_RENDER_MODE_DEFER_CHECK,isRender:!1,requestTiles:!0,ignoreCommands:!0}),Ep[Ss.MOST_DETAILED_PRELOAD]=Object.freeze({pass:Ss.MOST_DETAILED_PRELOAD,isRender:!1,requestTiles:!0,ignoreCommands:!0}),Ep[Ss.MOST_DETAILED_PICK]=Object.freeze({pass:Ss.MOST_DETAILED_PICK,isRender:!1,requestTiles:!1,ignoreCommands:!1}),Ss.getPassOptions=function(e){return Ep[e]};var Io=Object.freeze(Ss);function Sp(e,t){this._tileset=e,this._tile=t,this.featurePropertiesDirty=!1}Object.defineProperties(Sp.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},ready:{get:function(){return!0}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(e){}},batchTable:{get:function(){}},group:{get:function(){},set:function(e){}}}),Sp.prototype.hasProperty=function(e,t){return!1},Sp.prototype.getFeature=function(e){},Sp.prototype.applyDebugSettings=function(e,t){},Sp.prototype.applyStyle=function(e){},Sp.prototype.update=function(e,t){},Sp.prototype.isDestroyed=function(){return!1},Sp.prototype.destroy=function(){return le(this)};var av=Sp;function wp(e){let t=(e=y(e,y.EMPTY_OBJECT)).content,i=e.class;this._class=i,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(wp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),wp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)},wp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)},wp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)},wp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)},wp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)},wp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)},wp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var SB=wp;function cW(e,t){let i=ii(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t.metadata;if(!u(i))return;if(!u(e.schema))return void cW._oneTimeWarning("findContentMetadata-missing-root-schema","Could not find a metadata schema for content metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");let n=y(e.schema.classes,y.EMPTY_OBJECT);if(u(i.class)){let e=n[i.class];return new SB({content:i,class:e})}}cW._oneTimeWarning=It;var kA=cW;function C7e(e,t){let i=e.metadataExtension;if(!u(i))return;let n=i.groups,r=ii(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"].group:t.group;if("number"==typeof r)return n[r];let o=i.groupIds.findIndex((function(e){return e===r}));return o>=0?n[o]:void 0}var VA=C7e;function vp(e){let t=(e=y(e,y.EMPTY_OBJECT)).tile,i=e.class;this._class=i,this._properties=t.properties,this._extensions=t.extensions,this._extras=t.extras}Object.defineProperties(vp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),vp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)},vp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)},vp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)},vp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)},vp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)},vp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)},vp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var wB=vp;function lW(e,t){let i=ii(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t.metadata;if(!u(i))return;if(!u(e.schema))return void lW._oneTimeWarning("findTileMetadata-missing-root-schema","Could not find a metadata schema for tile metadata. For tilesets that contain external tilesets, make sure the schema is added to the root tileset.json.");let n=y(e.schema.classes,y.EMPTY_OBJECT);if(u(i.class)){let e=n[i.class];return new wB({tile:i,class:e})}}lW._oneTimeWarning=It;var vB=lW;function E7e(e){let t=new Uint8Array(e),i=bh(t);if("glTF"===i&&(i="glb"),Es.isBinaryFormat(i))return{contentType:i,binaryPayload:t};let n=S7e(t);if(u(n.root))return{contentType:Es.EXTERNAL_TILESET,jsonPayload:n};if(u(n.asset))return{contentType:Es.GLTF,jsonPayload:n};if(u(n.tileAvailability))return{contentType:Es.IMPLICIT_SUBTREE_JSON,jsonPayload:n};if(u(n.type))return{contentType:Es.GEOJSON,jsonPayload:n};if(u(n.voxelTable))return{contentType:Es.VOXEL_JSON,jsonPayload:n};throw new ue("Invalid tile content.")}function S7e(e){let t;try{t=So(e)}catch{throw new ue("Invalid tile content.")}return t}var Dp=E7e;function hd(e,t,i,n){this._tileset=e,this._tile=t,this._tilesetResource=i,this._contents=[],this._contentsCreated=!1;let r=u(n.contents)?n.contents:n.content;this._innerContentHeaders=r,this._requestsInFlight=0,this._cancelCount=0;let o=this._innerContentHeaders.length;this._arrayFetchPromises=new Array(o),this._requests=new Array(o),this._ready=!1,this._innerContentResources=new Array(o),this._serverKeys=new Array(o);for(let e=0;e<o;e++){let t=i.getDerivedResource({url:r[e].uri}),n=nc.getServerKey(t.getUrlComponent());this._innerContentResources[e]=t,this._serverKeys[e]=n}}function uW(e,t){e._requestsInFlight+=t,e.tileset.statistics.numberOfPendingRequests+=t}function tle(e,t){e._cancelCount++,e._tile._contentState=t;let i=e.tileset.statistics;i.numberOfPendingRequests-=e._requestsInFlight,i.numberOfAttemptedRequests+=e._requestsInFlight,e._requestsInFlight=0;let n=e._innerContentHeaders.length;e._arrayFetchPromises=new Array(n)}function w7e(e){let t={};for(let i=0;i<e.length;i++){let n=e[i];u(t[n])?t[n]++:t[n]=1}for(let e in t)if(t.hasOwnProperty(e)&&!nc.serverHasOpenSlots(e,t[e]))return!1;return nc.heapHasOpenSlots(e.length)}function v7e(e,t,i,n){let r=e._innerContentResources[t].clone(),o=e.tile,a=e._serverKeys[t],s=new Ko({throttle:!0,throttleByServer:!0,type:Jr.TILES3D,priorityFunction:function(){return o._priority},serverKey:a});r.request=s,e._requests[t]=s;let l=r.fetchArrayBuffer();if(u(l))return l.then((function(t){if(!(i<e._cancelCount))return r.request.cancelled||r.request.state===Qn.CANCELLED?void tle(e,n):(uW(e,-1),t)})).catch((function(o){if(!(i<e._cancelCount)){if(r.request.cancelled||r.request.state===Qn.CANCELLED)return void tle(e,n);uW(e,-1),nle(e,t,o)}}))}async function D7e(e){let t=e._cancelCount,i=await Promise.all(e._arrayFetchPromises);if(t<e._cancelCount)return;let n=i.map(((t,i)=>I7e(e,t,i))),r=await Promise.all(n);return e._contentsCreated=!0,e._contents=r.filter(u),r}async function I7e(e,t,i){if(u(t))try{let n=Dp(t);if(n.contentType===Es.EXTERNAL_TILESET)throw new ue("External tilesets are disallowed inside multiple contents");e._disableSkipLevelOfDetail=e._disableSkipLevelOfDetail||n.contentType===Es.GEOMETRY||n.contentType===Es.VECTOR;let r,o=e._tileset,a=e._innerContentResources[i],s=e._tile,l=BA[n.contentType];r=u(n.binaryPayload)?await Promise.resolve(l(o,s,a,n.binaryPayload.buffer,0)):await Promise.resolve(l(o,s,a,n.jsonPayload));let c=e._innerContentHeaders[i];if(s.hasImplicitContentMetadata){let e=s.implicitSubtree,t=s.implicitCoordinates;r.metadata=e.getContentMetadataView(t,i)}else s.hasImplicitContent||(r.metadata=kA(o,c));let h=VA(o,c);return u(h)&&(r.group=new fA({metadata:h})),r}catch(t){nle(e,i,t)}}function nle(e,t,i){let n=e._tileset,r=e._innerContentResources[t].url,o=u(i.message)?i.message:i.toString();n.tileFailed.numberOfListeners>0?n.tileFailed.raiseEvent({url:r,message:o}):(console.log(`A content failed to load: ${r}`),console.log(`Error: ${o}`))}Object.defineProperties(hd.prototype,{featurePropertiesDirty:{get:function(){let e=this._contents,t=e.length;for(let i=0;i<t;++i)if(e[i].featurePropertiesDirty)return!0;return!1},set:function(e){let t=this._contents,i=t.length;for(let n=0;n<i;++n)t[n].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},ready:{get:function(){return!!this._contentsCreated&&this._ready}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},metadata:{get:function(){},set:function(){}},batchTable:{get:function(){}},group:{get:function(){},set:function(){}},innerContentUrls:{get:function(){return this._innerContentHeaders.map((function(e){return e.uri}))}}}),hd.prototype.requestInnerContents=function(){if(!w7e(this._serverKeys))return void(this.tileset.statistics.numberOfAttemptedRequests+=this._serverKeys.length);let e=this._innerContentHeaders;uW(this,e.length);let t=this._cancelCount;for(let i=0;i<e.length;i++)this._arrayFetchPromises[i]=v7e(this,i,t,this._tile._contentState);return D7e(this)},hd.prototype.cancelRequests=function(){for(let e=0;e<this._requests.length;e++){let t=this._requests[e];u(t)&&t.cancel()}},hd.prototype.hasProperty=function(e,t){return!1},hd.prototype.getFeature=function(e){},hd.prototype.applyDebugSettings=function(e,t){let i=this._contents,n=i.length;for(let r=0;r<n;++r)i[r].applyDebugSettings(e,t)},hd.prototype.applyStyle=function(e){let t=this._contents,i=t.length;for(let n=0;n<i;++n)t[n].applyStyle(e)},hd.prototype.update=function(e,t){let i=this._contents,n=i.length,r=!0;for(let o=0;o<n;++o)i[o].update(e,t),r=r&&i[o].ready;!this._ready&&r&&(this._ready=!0)},hd.prototype.isDestroyed=function(){return!1},hd.prototype.destroy=function(){let e=this._contents,t=e.length;for(let i=0;i<t;++i)e[i].destroy();return le(this)};var DB=hd,IB="in vec3 v_positionEC;\nin vec3 v_normalEC;\nin vec4 v_color;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    vec4 color = czm_gammaCorrect(v_color);\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n}\n",PB="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin vec4 color;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\nout vec4 v_color;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_color = color;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",UA="in vec4 v_color;\n\nvoid main()\n{\n    out_FragColor = czm_gammaCorrect(v_color);\n}\n",OB="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec4 color;\nin float batchId;\n\nout vec4 v_color;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_color = color;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n";function Ip(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.translucent,!0),i=y(e.closed,!1),n=y(e.flat,!1),r=n?OB:PB,o=n?UA:IB,a=n?Ip.FLAT_VERTEX_FORMAT:Ip.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=y(e.vertexShaderSource,r),this._fragmentShaderSource=y(e.fragmentShaderSource,o),this._renderState=no.getDefaultRenderState(t,i,e.renderState),this._closed=i,this._vertexFormat=a,this._flat=n,this._faceForward=y(e.faceForward,!i)}Object.defineProperties(Ip.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),Ip.VERTEX_FORMAT=Pe.POSITION_AND_NORMAL,Ip.FLAT_VERTEX_FORMAT=Pe.POSITION_ONLY,Ip.prototype.getFragmentShaderSource=no.prototype.getFragmentShaderSource,Ip.prototype.isTranslucent=no.prototype.isTranslucent,Ip.prototype.getRenderState=no.prototype.getRenderState;var rn=Ip;function P7e(e,t,i){let n,r=!i,o=e.length;if(!r&&o>1){let t=e[0].modelMatrix;for(n=1;n<o;++n)if(!L.equals(t,e[n].modelMatrix)){r=!0;break}}if(r)for(n=0;n<o;++n)u(e[n].geometry)&&Fn.transformToWorldCoordinates(e[n]);else L.multiplyTransformation(t,e[0].modelMatrix,t)}function fW(e,t){let i=e.attributes,n=i.position,r=n.values.length/n.componentsPerAttribute;i.batchId=new Se({componentDatatype:X.FLOAT,componentsPerAttribute:1,values:new Float32Array(r)});let o=i.batchId.values;for(let e=0;e<r;++e)o[e]=t}function O7e(e){let t=e.length;for(let i=0;i<t;++i){let t=e[i];u(t.geometry)?fW(t.geometry,i):u(t.westHemisphereGeometry)&&u(t.eastHemisphereGeometry)&&(fW(t.westHemisphereGeometry,i),fW(t.eastHemisphereGeometry,i))}}function R7e(e){let t,i,n,r=e.instances,o=e.projection,a=e.elementIndexUintSupported,s=e.scene3DOnly,l=e.vertexCacheOptimize,c=e.compressVertices,h=e.modelMatrix,d=r.length;for(t=0;t<d;++t)if(u(r[t].geometry)){n=r[t].geometry.primitiveType;break}if(P7e(r,h,s),!s)for(t=0;t<d;++t)u(r[t].geometry)&&Fn.splitLongitude(r[t]);if(O7e(r),l)for(t=0;t<d;++t){let e=r[t];u(e.geometry)?(Fn.reorderForPostVertexCache(e.geometry),Fn.reorderForPreVertexCache(e.geometry)):u(e.westHemisphereGeometry)&&u(e.eastHemisphereGeometry)&&(Fn.reorderForPostVertexCache(e.westHemisphereGeometry),Fn.reorderForPreVertexCache(e.westHemisphereGeometry),Fn.reorderForPostVertexCache(e.eastHemisphereGeometry),Fn.reorderForPreVertexCache(e.eastHemisphereGeometry))}let p=Fn.combineInstances(r);for(d=p.length,t=0;t<d;++t){i=p[t];let e=i.attributes;if(s)for(let t in e)e.hasOwnProperty(t)&&e[t].componentDatatype===X.DOUBLE&&Fn.encodeAttribute(i,t,`${t}3DHigh`,`${t}3DLow`);else for(let t in e)if(e.hasOwnProperty(t)&&e[t].componentDatatype===X.DOUBLE){let e=`${t}3D`,n=`${t}2D`;Fn.projectTo2D(i,t,e,n,o),u(i.boundingSphere)&&"position"===t&&(i.boundingSphereCV=se.fromVertices(i.attributes.position2D.values)),Fn.encodeAttribute(i,e,`${e}High`,`${e}Low`),Fn.encodeAttribute(i,n,`${n}High`,`${n}Low`)}c&&Fn.compressVertices(i)}if(!a){let e=[];for(d=p.length,t=0;t<d;++t)i=p[t],e=e.concat(Fn.fitToUnsignedShortIndices(i));p=e}return p}function dW(e,t,i,n){let r,o,a,s=n.length-1;if(s>=0){let e=n[s];r=e.offset+e.count,a=e.index,o=i[a].indices.length}else r=0,a=0,o=i[a].indices.length;let l=e.length;for(let s=0;s<l;++s){let l=e[s][t];if(!u(l))continue;let c=l.indices.length;r+c>o&&(r=0,o=i[++a].indices.length),n.push({index:a,offset:r,count:c}),r+=c}}function M7e(e,t){let i=[];return dW(e,"geometry",t,i),dW(e,"westHemisphereGeometry",t,i),dW(e,"eastHemisphereGeometry",t,i),i}var Pp={};function L7e(e,t){let i=e.attributes;for(let e in i)if(i.hasOwnProperty(e)){let n=i[e];u(n)&&u(n.values)&&t.push(n.values.buffer)}u(e.indices)&&t.push(e.indices.buffer)}function N7e(e,t){let i=e.length;for(let n=0;n<i;++n)L7e(e[n],t)}function F7e(e){let t=1,i=e.length;for(let n=0;n<i;n++){let i=e[n];if(++t,!u(i))continue;let r=i.attributes;t+=7+2*se.packedLength+(u(i.indices)?i.indices.length:0);for(let e in r)if(r.hasOwnProperty(e)&&u(r[e])){t+=5+r[e].values.length}}return t}function B7e(e,t){let i=e.length,n=new Float64Array(1+19*i),r=0;n[r++]=i;for(let t=0;t<i;t++){let i=e[t];if(L.pack(i.modelMatrix,n,r),r+=L.packedLength,u(i.attributes)&&u(i.attributes.offset)){let e=i.attributes.offset.value;n[r]=e[0],n[r+1]=e[1],n[r+2]=e[2]}r+=3}return t.push(n.buffer),n}function k7e(e){let t=e,i=new Array(t[0]),n=0,r=1;for(;r<t.length;){let e,o=L.unpack(t,r);r+=L.packedLength,u(t[r])&&(e={offset:new Zi(t[r],t[r+1],t[r+2])}),r+=3,i[n++]={modelMatrix:o,attributes:e}}return i}function ile(e){let t=e.length,i=1+(se.packedLength+1)*t,n=new Float32Array(i),r=0;n[r++]=t;for(let i=0;i<t;++i){let t=e[i];u(t)?(n[r++]=1,se.pack(e[i],n,r)):n[r++]=0,r+=se.packedLength}return n}function ole(e){let t=new Array(e[0]),i=0,n=1;for(;n<e.length;)1===e[n++]&&(t[i]=se.unpack(e,n)),++i,n+=se.packedLength;return t}Pp.combineGeometry=function(e){let t,i,n,r,o=e.instances,a=o.length,s=!1;a>0&&(t=R7e(e),t.length>0&&(i=Fn.createAttributeLocations(t[0]),e.createPickOffsets&&(n=M7e(o,t))),u(o[0].attributes)&&u(o[0].attributes.offset)&&(r=new Array(a),s=!0));let l=new Array(a),c=new Array(a);for(let e=0;e<a;++e){let t=o[e],i=t.geometry;u(i)&&(l[e]=i.boundingSphere,c[e]=i.boundingSphereCV,s&&(r[e]=t.geometry.offsetAttribute));let n=t.eastHemisphereGeometry,a=t.westHemisphereGeometry;u(n)&&u(a)&&(u(n.boundingSphere)&&u(a.boundingSphere)&&(l[e]=se.union(n.boundingSphere,a.boundingSphere)),u(n.boundingSphereCV)&&u(a.boundingSphereCV)&&(c[e]=se.union(n.boundingSphereCV,a.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:i,pickOffsets:n,offsetInstanceExtend:r,boundingSpheres:l,boundingSpheresCV:c}},Pp.packCreateGeometryResults=function(e,t){let i=new Float64Array(F7e(e)),n=[],r={},o=e.length,a=0;i[a++]=o;for(let t=0;t<o;t++){let o=e[t],s=u(o);if(i[a++]=s?1:0,!s)continue;i[a++]=o.primitiveType,i[a++]=o.geometryType,i[a++]=y(o.offsetAttribute,-1);let l=u(o.boundingSphere)?1:0;i[a++]=l,l&&se.pack(o.boundingSphere,i,a),a+=se.packedLength;let c=u(o.boundingSphereCV)?1:0;i[a++]=c,c&&se.pack(o.boundingSphereCV,i,a),a+=se.packedLength;let h=o.attributes,d=[];for(let e in h)h.hasOwnProperty(e)&&u(h[e])&&(d.push(e),u(r[e])||(r[e]=n.length,n.push(e)));i[a++]=d.length;for(let e=0;e<d.length;e++){let t=d[e],n=h[t];i[a++]=r[t],i[a++]=n.componentDatatype,i[a++]=n.componentsPerAttribute,i[a++]=n.normalize?1:0,i[a++]=n.values.length,i.set(n.values,a),a+=n.values.length}let p=u(o.indices)?o.indices.length:0;i[a++]=p,p>0&&(i.set(o.indices,a),a+=p)}return t.push(i.buffer),{stringTable:n,packedData:i}},Pp.unpackCreateGeometryResults=function(e){let t,i=e.stringTable,n=e.packedData,r=new Array(n[0]),o=0,a=1;for(;a<n.length;){if(1!==n[a++]){r[o++]=void 0;continue}let e,s,l=n[a++],u=n[a++],c=n[a++];-1===c&&(c=void 0),1===n[a++]&&(e=se.unpack(n,a)),a+=se.packedLength,1===n[a++]&&(s=se.unpack(n,a)),a+=se.packedLength;let h,d,p,f,m=new hn,_=n[a++];for(t=0;t<_;t++){let e=i[n[a++]],t=n[a++];p=n[a++];let r=0!==n[a++];h=n[a++],d=X.createTypedArray(t,h);for(let e=0;e<h;e++)d[e]=n[a++];m[e]=new Se({componentDatatype:t,componentsPerAttribute:p,normalize:r,values:d})}if(h=n[a++],h>0){let e=d.length/p;for(f=ke.createTypedArray(e,h),t=0;t<h;t++)f[t]=n[a++]}r[o++]=new ct({primitiveType:l,geometryType:u,boundingSphere:e,boundingSphereCV:s,indices:f,attributes:m,offsetAttribute:c})}return r},Pp.packCombineGeometryParameters=function(e,t){let i=e.createGeometryResults,n=i.length;for(let e=0;e<n;e++)t.push(i[e].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:B7e(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof Ii,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},Pp.unpackCombineGeometryParameters=function(e){let t=k7e(e.packedInstances),i=e.createGeometryResults,n=i.length,r=0;for(let e=0;e<n;e++){let n=Pp.unpackCreateGeometryResults(i[e]),o=n.length;for(let e=0;e<o;e++){let i=n[e];t[r].geometry=i,++r}}let o=ie.clone(e.ellipsoid);return{instances:t,ellipsoid:o,projection:e.isGeographic?new Ii(o):new Oi(o),elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:L.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},Pp.packCombineGeometryResults=function(e,t){u(e.geometries)&&N7e(e.geometries,t);let i=ile(e.boundingSpheres),n=ile(e.boundingSpheresCV);return t.push(i.buffer,n.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:i,boundingSpheresCV:n}},Pp.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:ole(e.boundingSpheres),boundingSpheresCV:ole(e.boundingSpheresCV)}};var zA=Pp,V7e={READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6},br=Object.freeze(V7e);function ur(e){e=y(e,y.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=new L,this.show=y(e.show,!0),this._vertexCacheOptimize=y(e.vertexCacheOptimize,!1),this._interleave=y(e.interleave,!1),this._releaseGeometryInstances=y(e.releaseGeometryInstances,!0),this._allowPicking=y(e.allowPicking,!0),this._asynchronous=y(e.asynchronous,!0),this._compressVertices=y(e.compressVertices,!0),this.cull=y(e.cull,!0),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=y(e.shadows,yn.DISABLED),this._translucent=void 0,this._state=br.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=new Map,this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}function U7e(e){let t,i=e.length,n=[],r=e[0].attributes;for(t in r)if(r.hasOwnProperty(t)&&u(r[t])){let o=r[t],a=!0;for(let n=1;n<i;++n){let i=e[n].attributes[t];if(!u(i)||o.componentDatatype!==i.componentDatatype||o.componentsPerAttribute!==i.componentsPerAttribute||o.normalize!==i.normalize){a=!1;break}}a&&n.push(t)}return n}Object.defineProperties(ur.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}}});var z7e=new U,H7e=new h,hle=new oe;function mle(e){let t=e.length;return 1===t?e[0]:2===t?U.unpack(e,0,z7e):3===t?h.unpack(e,0,H7e):4===t?oe.unpack(e,0,hle):void 0}function G7e(e,t){let i=e.geometryInstances,n=Array.isArray(i)?i:[i],r=n.length;if(0===r)return;let o,a,s,l,c=U7e(n),h=c.length,d=[],p={},f={},m=n[0].attributes;for(a=0;a<h;++a)s=c[a],l=m[s],p[s]=a,d.push({functionName:`czm_batchTable_${s}`,componentDatatype:l.componentDatatype,componentsPerAttribute:l.componentsPerAttribute,normalize:l.normalize});-1!==c.indexOf("distanceDisplayCondition")&&(d.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:X.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:X.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:X.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:X.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:X.FLOAT,componentsPerAttribute:1}),f.center3DHigh=d.length-5,f.center3DLow=d.length-4,f.center2DHigh=d.length-3,f.center2DLow=d.length-2,f.radius=d.length-1),-1!==c.indexOf("offset")&&(d.push({functionName:"czm_batchTable_offset2D",componentDatatype:X.FLOAT,componentsPerAttribute:3}),o=d.length-1),d.push({functionName:"czm_batchTable_pickColor",componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});let _=d.length,g=new JT(t,d,r);for(a=0;a<r;++a){let i=n[a];m=i.attributes;for(let e=0;e<h;++e){s=c[e],l=m[s];let t=mle(l.value),i=p[s];g.setBatchedAttribute(a,i,t)}let r={primitive:y(i.pickPrimitive,e)};u(i.id)&&(r.id=i.id);let o=t.createPickId(r);e._pickIds.push(o);let d=o.color,f=hle;f.x=z.floatToByte(d.red),f.y=z.floatToByte(d.green),f.z=z.floatToByte(d.blue),f.w=z.floatToByte(d.alpha),g.setBatchedAttribute(a,_-1,f)}e._batchTable=g,e._batchTableAttributeIndices=p,e._batchTableBoundingSphereAttributeIndices=f,e._batchTableOffsetAttribute2DIndex=o}function W7e(e){let t;return t=Array.isArray(e.values)?e.values.slice(0):new e.values.constructor(e.values),new Se({componentDatatype:e.componentDatatype,componentsPerAttribute:e.componentsPerAttribute,normalize:e.normalize,values:t})}function j7e(e){let t,i=e.attributes,n=new hn;for(let e in i)i.hasOwnProperty(e)&&u(i[e])&&(n[e]=W7e(i[e]));if(u(e.indices)){let i=e.indices;t=Array.isArray(i)?i.slice(0):new i.constructor(i)}return new ct({attributes:n,indices:t,primitiveType:e.primitiveType,boundingSphere:se.clone(e.boundingSphere)})}function q7e(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:L.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var Y7e=/in\s+vec(?:3|4)\s+(.*)3DHigh;/g;function rle(e){return`${He.replaceMain(e,"czm_non_pick_main")}\nout vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}`}function sle(e){return`in vec4 v_pickColor;\n${e}`}function ale(e,t){if(!e.compressVertices)return t;let i=-1!==t.search(/in\s+vec3\s+normal;/g),n=-1!==t.search(/in\s+vec2\s+st;/g);if(!i&&!n)return t;let r=-1!==t.search(/in\s+vec3\s+tangent;/g),o=-1!==t.search(/in\s+vec3\s+bitangent;/g),a=n&&i?2:1;a+=r||o?1:0;let s="compressedAttributes",l=`in ${a>1?`vec${a}`:"float"} ${s};`,u="",c="";if(n){u+="vec2 st;\n",c+=`    st = czm_decompressTextureCoordinates(${a>1?`${s}.x`:s});\n`}i&&r&&o?(u+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",c+=`    czm_octDecode(${s}.${n?"yz":"xy"}, normal, tangent, bitangent);\n`):(i&&(u+="vec3 normal;\n",c+=`    normal = czm_octDecode(${s}${a>1?"."+(n?"y":"x"):""});\n`),r&&(u+="vec3 tangent;\n",c+=`    tangent = czm_octDecode(${s}.${n&&i?"z":"y"});\n`),o&&(u+="vec3 bitangent;\n",c+=`    bitangent = czm_octDecode(${s}.${n&&i?"z":"y"});\n`));let h=t;return h=h.replace(/in\s+vec3\s+normal;/g,""),h=h.replace(/in\s+vec2\s+st;/g,""),h=h.replace(/in\s+vec3\s+tangent;/g,""),h=h.replace(/in\s+vec3\s+bitangent;/g,""),h=He.replaceMain(h,"czm_non_compressed_main"),[l,u,h,`void main() \n{ \n${c}    czm_non_compressed_main(); \n}`].join("\n")}function X7e(e){let t=He.replaceMain(e,"czm_non_depth_clamp_main");return t+="void main() {\n    czm_non_depth_clamp_main();\n    gl_Position = czm_depthClamp(gl_Position);}\n",t}function K7e(e){let t=He.replaceMain(e,"czm_non_depth_clamp_main");return t+="void main() {\n    czm_non_depth_clamp_main();\n    #if defined(LOG_DEPTH)\n        czm_writeLogDepth();\n    #else\n        czm_writeDepthClamp();\n    #endif\n}\n",t}function cle(e,t){e.vertexAttributes}function Z7e(e,t){return function(){return e[t]}}ur._modifyShaderPosition=function(e,t,i){let n,r="",o="",a="";for(;null!==(n=Y7e.exec(t));){let s=n[1],l=`vec4 czm_compute${s[0].toUpperCase()}${s.substr(1)}()`;"vec4 czm_computePosition()"!==l&&(r+=`${l};\n`),u(e.rtcCenter)?(r+="uniform mat4 u_modifiedModelView;\n",o+="in vec4 position;\n",a+=`${l}\n{\n    return u_modifiedModelView * position;\n}\n\n`,t=(t=(t=(t=t.replace(/in\s+vec(?:3|4)\s+position3DHigh;/g,"")).replace(/in\s+vec(?:3|4)\s+position3DLow;/g,"")).replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"")).replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):i?a+=`${l}\n{\n    return czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow);\n}\n\n`:(o+=`in vec3 ${s}2DHigh;\nin vec3 ${s}2DLow;\n`,a+=`${l}\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye(${s}2DHigh.zxy, ${s}2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye(${s}2DHigh.zxy, ${s}2DLow.zxy),\n                czm_translateRelativeToEye(${s}3DHigh, ${s}3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n`)}return[r,o,t,a].join("\n")},ur._appendShowToShader=function(e,t){return u(e._batchTableAttributeIndices.show)?`${He.replaceMain(t,"czm_non_show_main")}\nvoid main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}`:t},ur._updateColorAttribute=function(e,t,i){if(!u(e._batchTableAttributeIndices.color)&&!u(e._batchTableAttributeIndices.depthFailColor)||-1===t.search(/in\s+vec4\s+color;/g))return t;let n=t;return n=n.replace(/in\s+vec4\s+color;/g,""),n=i?n.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):n.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"),n},ur._updatePickColorAttribute=function(e){let t=e.replace(/in\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2"),t},ur._appendOffsetToShader=function(e,t){if(!u(e._batchTableAttributeIndices.offset))return t;let i="in float batchId;\n";i+="in float applyOffset;";let n=t.replace(/in\s+float\s+batchId;/g,"in float batchId;\nin float applyOffset;"),r="vec4 $1 = czm_computePosition();\n";return r+="    if (czm_sceneMode == czm_sceneMode3D)\n",r+="    {\n",r+="        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);",r+="    }\n",r+="    else\n",r+="    {\n",r+="        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);",r+="    }\n",n=n.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,"vec4 $1 = czm_computePosition();\n    if (czm_sceneMode == czm_sceneMode3D)\n    {\n        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);    }\n    else\n    {\n        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);    }\n"),n},ur._appendDistanceDisplayConditionToShader=function(e,t,i){if(!u(e._batchTableAttributeIndices.distanceDisplayCondition))return t;let n="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return n+=i?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",n+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}",`${He.replaceMain(t,"czm_non_distanceDisplayCondition_main")}\n${n}`};var hW=Math.max(Bt.hardwareConcurrency-1,1),RB,$7e=new pi("combineGeometry");function Q7e(e,t){let i,n,r,o,a=e._instanceIds;if(e._state===br.READY){i=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let s,l=e._numberOfInstances=i.length,c=[],h=[];for(r=0;r<l;++r)n=i[r].geometry,a.push(i[r].id),h.push({moduleName:n._workerName,geometry:n});if(!u(RB))for(RB=new Array(hW),r=0;r<hW;r++)RB[r]=new pi("createGeometry");for(h=LO(h,hW),r=0;r<h.length;r++){let e,t=0,i=h[r],a=i.length;for(o=0;o<a;++o)s=i[o],n=s.geometry,u(n.constructor.pack)&&(s.offset=t,t+=y(n.constructor.packedLength,n.packedLength));if(t>0){let r=new Float64Array(t);for(e=[r.buffer],o=0;o<a;++o)s=i[o],n=s.geometry,u(n.constructor.pack)&&(n.constructor.pack(n,r,s.offset),s.geometry=r)}c.push(RB[r].scheduleTask({subTasks:h[r]},e))}e._state=br.CREATING,Promise.all(c).then((function(t){e._createGeometryResults=t,e._state=br.CREATED})).catch((function(i){lv(e,t,br.FAILED,i)}))}else if(e._state===br.CREATED){let n=[];i=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];let r=t.scene3DOnly,o=t.mapProjection,a=$7e.scheduleTask(zA.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:i,ellipsoid:o.ellipsoid,projection:o,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:r,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},n),n);e._createGeometryResults=void 0,e._state=br.COMBINING,Promise.resolve(a).then((function(i){let n=zA.unpackCombineGeometryResults(i);e._geometries=n.geometries,e._attributeLocations=n.attributeLocations,e.modelMatrix=L.clone(n.modelMatrix,e.modelMatrix),e._pickOffsets=n.pickOffsets,e._offsetInstanceExtend=n.offsetInstanceExtend,e._instanceBoundingSpheres=n.boundingSpheres,e._instanceBoundingSpheresCV=n.boundingSpheresCV,u(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=br.COMBINED):lv(e,t,br.FAILED,void 0)})).catch((function(i){lv(e,t,br.FAILED,i)}))}}function J7e(e,t){let i,n,r=Array.isArray(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],o=e._numberOfInstances=r.length,a=new Array(o),s=e._instanceIds,l=0;for(n=0;n<o;n++){i=r[n];let e,t=i.geometry;e=u(t.attributes)&&u(t.primitiveType)?j7e(t):t.constructor.createGeometry(t),a[l++]=q7e(i,e),s.push(i.id)}a.length=l;let c=t.scene3DOnly,h=t.mapProjection,d=zA.combineGeometry({instances:a,ellipsoid:h.ellipsoid,projection:h,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:c,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=d.geometries,e._attributeLocations=d.attributeLocations,e.modelMatrix=L.clone(d.modelMatrix,e.modelMatrix),e._pickOffsets=d.pickOffsets,e._offsetInstanceExtend=d.offsetInstanceExtend,e._instanceBoundingSpheres=d.boundingSpheres,e._instanceBoundingSpheresCV=d.boundingSpheresCV,u(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=br.COMBINED):lv(e,t,br.FAILED,void 0)}function eqe(e,t){let i=e._batchTableAttributeIndices.offset;if(!e._recomputeBoundingSpheres||!u(i))return void(e._recomputeBoundingSpheres=!1);let n,r=e._offsetInstanceExtend,o=e._instanceBoundingSpheres,a=o.length,s=e._tempBoundingSpheres;if(!u(s)){for(s=new Array(a),n=0;n<a;n++)s[n]=new se;e._tempBoundingSpheres=s}for(n=0;n<a;++n){let t=s[n],a=e._batchTable.getBatchedAttribute(n,i,new h);t=o[n].clone(t),yle(t,a,r[n])}let l=[],c=[],d=[];for(n=0;n<a;++n){let e=s[n];e.center.x-e.radius>0||se.intersectPlane(e,tn.ORIGIN_ZX_PLANE)!==Zt.INTERSECTING?l.push(e):(c.push(e),d.push(e))}let p=l[0],f=d[0],m=c[0];for(n=1;n<l.length;n++)p=se.union(p,l[n]);for(n=1;n<d.length;n++)f=se.union(f,d[n]);for(n=1;n<c.length;n++)m=se.union(m,c[n]);let _=[];for(u(p)&&_.push(p),u(f)&&_.push(f),u(m)&&_.push(m),n=0;n<_.length;n++){let i=_[n].clone(e._boundingSpheres[n]);e._boundingSpheres[n]=i,e._boundingSphereCV[n]=se.projectTo2D(i,t.mapProjection,e._boundingSphereCV[n])}ur._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}var lle=new Wn,ple=new fe,_le=new h,gle=new se;function tqe(e,t){if(!u(e._batchTableAttributeIndices.distanceDisplayCondition)||e._batchTableBoundingSpheresUpdated)return;let i=e._batchTableBoundingSphereAttributeIndices,n=i.center3DHigh,r=i.center3DLow,o=i.center2DHigh,a=i.center2DLow,s=i.radius,l=t.mapProjection,c=l.ellipsoid,h=e._batchTable,d=e._instanceBoundingSpheres,p=d.length;for(let i=0;i<p;++i){let p=d[i];if(!u(p))continue;let f=e.modelMatrix;u(f)&&(p=se.transform(p,f,gle));let m=p.center,_=p.radius,g=Wn.fromCartesian(m,lle);if(h.setBatchedAttribute(i,n,g.high),h.setBatchedAttribute(i,r,g.low),!t.scene3DOnly){let e=c.cartesianToCartographic(m,ple),t=l.project(e,_le);g=Wn.fromCartesian(t,lle),h.setBatchedAttribute(i,o,g.high),h.setBatchedAttribute(i,a,g.low)}h.setBatchedAttribute(i,s,_)}e._batchTableBoundingSpheresUpdated=!0}var mW=new h,nqe=new h;function ule(e,t){if(!u(e._batchTableAttributeIndices.offset)||e._batchTableOffsetsUpdated||t.scene3DOnly)return;let i=e._batchTableOffsetAttribute2DIndex,n=t.mapProjection,r=n.ellipsoid,o=e._batchTable,a=e._instanceBoundingSpheres,s=a.length;for(let t=0;t<s;++t){let s=a[t];if(!u(s))continue;let l=o.getBatchedAttribute(t,e._batchTableAttributeIndices.offset);if(h.equals(l,h.ZERO)){o.setBatchedAttribute(t,i,h.ZERO);continue}let c=e.modelMatrix;u(c)&&(s=se.transform(s,c,gle));let d=s.center;d=r.scaleToGeodeticSurface(d,nqe);let p=r.cartesianToCartographic(d,ple),f=n.project(p,_le),m=h.add(l,d,mW);p=r.cartesianToCartographic(m,p);let _=n.project(p,mW),g=h.subtract(_,f,mW),y=g.x;g.x=g.z,g.z=g.y,g.y=y,o.setBatchedAttribute(t,i,g)}e._batchTableOffsetsUpdated=!0}function iqe(e,t){let i=e._attributeLocations,n=e._geometries,r=t.scene3DOnly,o=t.context,a=[],s=n.length;for(let l=0;l<s;++l){let s=n[l];if(a.push(ni.fromGeometry({context:o,geometry:s,attributeLocations:i,bufferUsage:Be.STATIC_DRAW,interleave:e._interleave})),u(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,s);else if(e._boundingSpheres.push(se.clone(s.boundingSphere)),e._boundingSphereWC.push(new se),!r){let t=s.boundingSphereCV.center,i=t.x,n=t.y,r=t.z;t.x=r,t.y=i,t.z=n,e._boundingSphereCV.push(se.clone(s.boundingSphereCV)),e._boundingSphere2D.push(new se),e._boundingSphereMorph.push(new se)}}e._va=a,e._primitiveType=n[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,lv(e,t,br.COMPLETE,void 0)}function oqe(e,t,i,n){let r,o=i.getRenderState();n?(r=Ge(o,!1),r.cull={enabled:!0,face:gi.BACK},e._frontFaceRS=Ue.fromCache(r),r.cull.face=gi.FRONT,e._backFaceRS=Ue.fromCache(r)):(e._frontFaceRS=Ue.fromCache(o),e._backFaceRS=e._frontFaceRS),r=Ge(o,!1),u(e._depthFailAppearance)&&(r.depthTest.enabled=!1),u(e._depthFailAppearance)&&(o=e._depthFailAppearance.getRenderState(),r=Ge(o,!1),r.depthTest.func=yc.GREATER,n?(r.cull={enabled:!0,face:gi.BACK},e._frontFaceDepthFailRS=Ue.fromCache(r),r.cull.face=gi.FRONT,e._backFaceDepthFailRS=Ue.fromCache(r)):(e._frontFaceDepthFailRS=Ue.fromCache(r),e._backFaceDepthFailRS=e._frontFaceRS))}function rqe(e,t,i){let n=t.context,r=e._attributeLocations,o=e._batchTable.getVertexShaderCallback()(i.vertexShaderSource);o=ur._appendOffsetToShader(e,o),o=ur._appendShowToShader(e,o),o=ur._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=rle(o),o=ur._updateColorAttribute(e,o,!1),o=ale(e,o),o=ur._modifyShaderPosition(e,o,t.scene3DOnly);let a=i.getFragmentShaderSource();a=sle(a),e._sp=Kt.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:r}),cle(e._sp,r),u(e._depthFailAppearance)&&(o=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),o=ur._appendShowToShader(e,o),o=ur._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=rle(o),o=ur._updateColorAttribute(e,o,!0),o=ale(e,o),o=ur._modifyShaderPosition(e,o,t.scene3DOnly),o=X7e(o),a=e._depthFailAppearance.getFragmentShaderSource(),a=sle(a),a=K7e(a),e._spDepthFail=Kt.replaceCache({context:n,shaderProgram:e._spDepthFail,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:r}),cle(e._spDepthFail,r))}var cv=new L,fle=new h;function dle(e,t,i,n){let r=u(i)?i._uniforms:void 0,o={},a=t.uniforms;if(u(a))for(let e in a)a.hasOwnProperty(e)&&(o[e]=Z7e(a,e));let s=gt(o,r);return s=e._batchTable.getUniformMapCallback()(s),u(e.rtcCenter)&&(s.u_modifiedModelView=function(){let t=n.context.uniformState.view;return L.multiply(t,e._modelMatrix,cv),L.multiplyByPoint(cv,e.rtcCenter,fle),L.setTranslation(cv,fle,cv),cv}),s}function sqe(e,t,i,n,r,o,a,s){let l,c=dle(e,t,i,s);u(e._depthFailAppearance)&&(l=dle(e,e._depthFailAppearance,e._depthFailAppearance.material,s));let h=n?Ee.TRANSLUCENT:Ee.OPAQUE,d=r?2:1;d*=u(e._depthFailAppearance)?2:1,o.length=e._va.length*d;let p=o.length,f=0;for(let t=0;t<p;++t){let i;r&&(i=o[t],u(i)||(i=o[t]=new et({owner:e,primitiveType:e._primitiveType})),i.vertexArray=e._va[f],i.renderState=e._backFaceRS,i.shaderProgram=e._sp,i.uniformMap=c,i.pass=h,++t),i=o[t],u(i)||(i=o[t]=new et({owner:e,primitiveType:e._primitiveType})),i.vertexArray=e._va[f],i.renderState=e._frontFaceRS,i.shaderProgram=e._sp,i.uniformMap=c,i.pass=h,u(e._depthFailAppearance)&&(r&&(++t,i=o[t],u(i)||(i=o[t]=new et({owner:e,primitiveType:e._primitiveType})),i.vertexArray=e._va[f],i.renderState=e._backFaceDepthFailRS,i.shaderProgram=e._spDepthFail,i.uniformMap=l,i.pass=h),++t,i=o[t],u(i)||(i=o[t]=new et({owner:e,primitiveType:e._primitiveType})),i.vertexArray=e._va[f],i.renderState=e._frontFaceDepthFailRS,i.shaderProgram=e._spDepthFail,i.uniformMap=l,i.pass=h),++f}}function aqe(e,t,i,n,r,o,a,s){let l;ur._updateBoundingVolumes(e,t,r),t.mode===te.SCENE3D?l=e._boundingSphereWC:t.mode===te.COLUMBUS_VIEW?l=e._boundingSphereCV:t.mode===te.SCENE2D&&u(e._boundingSphere2D)?l=e._boundingSphere2D:u(e._boundingSphereMorph)&&(l=e._boundingSphereMorph);let c=t.commandList,h=t.passes;if(h.render||h.pick){let t=e.allowPicking,n=yn.castShadows(e.shadows),h=yn.receiveShadows(e.shadows),d=i.length,p=s?2:1;p*=u(e._depthFailAppearance)?2:1;for(let e=0;e<d;++e){let s=Math.floor(e/p),u=i[e];u.modelMatrix=r,u.boundingVolume=l[s],u.cull=o,u.debugShowBoundingVolume=a,u.castShadows=n,u.receiveShadows=h,u.pickId=t?"v_pickColor":void 0,c.push(u)}}}ur._updateBoundingVolumes=function(e,t,i,n){let r,o,a;if(n||!L.equals(i,e._modelMatrix))for(L.clone(i,e._modelMatrix),o=e._boundingSpheres.length,r=0;r<o;++r)a=e._boundingSpheres[r],u(a)&&(e._boundingSphereWC[r]=se.transform(a,i,e._boundingSphereWC[r]),t.scene3DOnly||(e._boundingSphere2D[r]=se.clone(e._boundingSphereCV[r],e._boundingSphere2D[r]),e._boundingSphere2D[r].center.x=0,e._boundingSphereMorph[r]=se.union(e._boundingSphereWC[r],e._boundingSphereCV[r])));let s=e.appearance.pixelSize;if(u(s))for(o=e._boundingSpheres.length,r=0;r<o;++r){a=e._boundingSpheres[r];let i=e._boundingSphereWC[r],n=t.camera.getPixelSize(a,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*s;i.radius=a.radius+n}},ur.prototype.update=function(e){if(!u(this.geometryInstances)&&0===this._va.length||u(this.geometryInstances)&&Array.isArray(this.geometryInstances)&&0===this.geometryInstances.length||!u(this.appearance)||e.mode!==te.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)return;if(u(this._error))throw this._error;if(this._state===br.FAILED)return;let t=e.context;if(u(this._batchTable)||G7e(this,t),this._batchTable.attributes.length>0){if(0===zt.maximumVertexTextureImageUnits)throw new ue("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==br.COMPLETE&&this._state!==br.COMBINED&&(this.asynchronous?Q7e(this,e):J7e(this,e)),this._state===br.COMBINED&&(tqe(this,e),ule(this,e),iqe(this,e)),!this.show||this._state!==br.COMPLETE)return;this._batchTableOffsetsUpdated||ule(this,e),this._recomputeBoundingSpheres&&eqe(this,e);let i=this.appearance,n=i.material,r=!1,o=!1;this._appearance!==i?(this._appearance=i,this._material=n,r=!0,o=!0):this._material!==n&&(this._material=n,o=!0);let a=this.depthFailAppearance,s=u(a)?a.material:void 0;this._depthFailAppearance!==a?(this._depthFailAppearance=a,this._depthFailMaterial=s,r=!0,o=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,o=!0);let l=this._appearance.isTranslucent();this._translucent!==l&&(this._translucent=l,r=!0),u(this._material)&&this._material.update(t);let c=i.closed&&l;r&&y(this._createRenderStatesFunction,oqe)(this,t,i,c),o&&y(this._createShaderProgramFunction,rqe)(this,e,i),(r||o)&&y(this._createCommandsFunction,sqe)(this,i,n,l,c,this._colorCommands,this._pickCommands,e),y(this._updateAndQueueCommandsFunction,aqe)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,c)};var cqe=new se,lqe=new se;function yle(e,t,i){if(i===on.TOP){let i=se.clone(e,cqe),n=se.clone(e,lqe);n.center=h.add(n.center,t,n.center),e=se.union(i,n,e)}else i===on.ALL&&(e.center=h.add(e.center,t,e.center));return e}function uqe(e,t,i){return function(){let n=e.getBatchedAttribute(t,i),r=e.attributes[i],o=r.componentsPerAttribute,a=X.createTypedArray(r.componentDatatype,o);return u(n.constructor.pack)?n.constructor.pack(n,a,0):a[0]=n,a}}function fqe(e,t,i,n,r){return function(o){let a=mle(o);e.setBatchedAttribute(t,i,a),"offset"===r&&(n._recomputeBoundingSpheres=!0,n._batchTableOffsetsUpdated=!1)}}var dqe=new h;function hqe(e,t,i){t.boundingSphere={get:function(){let n=e._instanceBoundingSpheres[i];if(u(n)){n=n.clone();let r=e.modelMatrix,o=t.offset;u(o)&&yle(n,h.fromArray(o.get(),0,dqe),e._offsetInstanceExtend[i]),u(r)&&(n=se.transform(n,r))}return n}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[i]}}}function mqe(e,t,i){t.pickId={get:function(){return e._pickIds[i]}}}function lv(e,t,i,n){e._error=n,e._state=i,t.afterRender.push((function(){if(e._ready=e._state===br.COMPLETE||e._state===br.FAILED,!u(n))return!0}))}ur.prototype.getGeometryInstanceAttributes=function(e){let t=this._perInstanceAttributeCache.get(e);if(u(t))return t;let i=-1,n=this._lastPerInstanceAttributeIndex,r=this._instanceIds,o=r.length;for(let t=0;t<o;++t){let a=(n+t)%o;if(e===r[a]){i=a;break}}if(-1===i)return;let a=this._batchTable,s=this._batchTableAttributeIndices;t={};let l={};for(let e in s)if(s.hasOwnProperty(e)){let t=s[e];l[e]={get:uqe(a,i,t),set:fqe(a,i,t,this,e)}}return hqe(this,l,i),mqe(this,l,i),Object.defineProperties(t,l),this._lastPerInstanceAttributeIndex=i,this._perInstanceAttributeCache.set(e,t),t},ur.prototype.isDestroyed=function(){return!1},ur.prototype.destroy=function(){let e,t;this._sp=this._sp&&this._sp.destroy(),this._spDepthFail=this._spDepthFail&&this._spDepthFail.destroy();let i=this._va;for(e=i.length,t=0;t<e;++t)i[t].destroy();this._va=void 0;let n=this._pickIds;for(e=n.length,t=0;t<e;++t)n[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,le(this)};var Sn=ur;function GA(e){this.rectangle=ce.clone(e.rectangle),this.minimumHeight=y(e.minimumHeight,0),this.maximumHeight=y(e.maximumHeight,0),this.southwestCornerCartesian=new h,this.northeastCornerCartesian=new h,this.westNormal=new h,this.southNormal=new h,this.eastNormal=new h,this.northNormal=new h;let t=y(e.ellipsoid,ie.WGS84);xqe(this,e.rectangle,t),this._orientedBoundingBox=void 0,this._boundingSphere=void 0,y(e.computeBoundingVolumes,!0)&&this.computeBoundingVolumes(t)}Object.defineProperties(GA.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),GA.prototype.computeBoundingVolumes=function(e){this._orientedBoundingBox=Pn.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,e),this._boundingSphere=se.fromOrientedBoundingBox(this._orientedBoundingBox)};var xle=new h,MB=new h,ble=new h,pqe=new h,_qe=new h,gqe=new h,yqe=new h,af=new fe,Tle=new tn(h.UNIT_X,0),HA=new Tn;function xqe(e,t,i){i.cartographicToCartesian(ce.southwest(t),e.southwestCornerCartesian),i.cartographicToCartesian(ce.northeast(t),e.northeastCornerCartesian),af.longitude=t.west,af.latitude=.5*(t.south+t.north),af.height=0;let n=i.cartographicToCartesian(af,gqe),r=h.cross(n,h.UNIT_Z,pqe);h.normalize(r,e.westNormal),af.longitude=t.east;let o=i.cartographicToCartesian(af,yqe),a=h.cross(h.UNIT_Z,o,xle);h.normalize(a,e.eastNormal);let s=h.subtract(n,o,xle);0===h.magnitude(s)&&(s=h.clone(r,s));let l,u=h.normalize(s,_qe),c=t.south;if(c>0){af.longitude=.5*(t.west+t.east),af.latitude=c;let n=i.cartographicToCartesian(af,HA.origin);h.clone(u,HA.direction);let r=tn.fromPointNormal(e.southwestCornerCartesian,e.westNormal,Tle);Ai.rayPlane(HA,r,e.southwestCornerCartesian),l=i.geodeticSurfaceNormal(n,MB)}else l=i.geodeticSurfaceNormalCartographic(ce.southeast(t),MB);let d=h.cross(l,s,ble);h.normalize(d,e.southNormal);let p,f=t.north;if(f<0){af.longitude=.5*(t.west+t.east),af.latitude=f;let n=i.cartographicToCartesian(af,HA.origin);h.negate(u,HA.direction);let r=tn.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,Tle);Ai.rayPlane(HA,r,e.northeastCornerCartesian),p=i.geodeticSurfaceNormal(n,MB)}else p=i.geodeticSurfaceNormalCartographic(ce.northwest(t),MB);let m=h.cross(s,p,ble);h.normalize(m,e.northNormal)}var bqe=new h,Tqe=new h,Aqe=new h(0,-1,0),Cqe=new h(0,0,-1),Ale=new h;function Eqe(e,t){let i,n,r,o=t.camera,a=o.positionWC,s=o.positionCartographic,l=0;if(!ce.contains(e.rectangle,s)){let i=e.southwestCornerCartesian,n=e.northeastCornerCartesian,r=e.westNormal,o=e.southNormal,s=e.eastNormal,u=e.northNormal;t.mode!==te.SCENE3D&&(i=t.mapProjection.project(ce.southwest(e.rectangle),bqe),i.z=i.y,i.y=i.x,i.x=0,n=t.mapProjection.project(ce.northeast(e.rectangle),Tqe),n.z=n.y,n.y=n.x,n.x=0,r=Aqe,s=h.UNIT_Y,o=Cqe,u=h.UNIT_Z);let c=h.subtract(a,i,Ale),d=h.dot(c,r),p=h.dot(c,o),f=h.subtract(a,n,Ale),m=h.dot(f,s),_=h.dot(f,u);d>0?l+=d*d:m>0&&(l+=m*m),p>0?l+=p*p:_>0&&(l+=_*_)}if(t.mode===te.SCENE3D?(i=s.height,n=e.minimumHeight,r=e.maximumHeight):(i=a.x,n=0,r=0),i>r){let e=i-r;l+=e*e}else if(i<n){let e=n-i;l+=e*e}return Math.sqrt(l)}GA.prototype.distanceToCamera=function(e){let t=Eqe(this,e);if(e.mode===te.SCENE3D&&u(this._orientedBoundingBox)){let i=Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC));return Math.max(t,i)}return t},GA.prototype.intersectPlane=function(e){return this._orientedBoundingBox.intersectPlane(e)},GA.prototype.createDebugVolume=function(e){let t=new L.clone(L.IDENTITY),i=new zT({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),n=new yt({geometry:i,id:"outline",modelMatrix:t,attributes:{color:kt.fromColor(e)}});return new Sn({geometryInstances:n,appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1})};var md=GA,LB=new fe;function uv(e){let t=W_.fromToken(e.token),i=y(e.minimumHeight,0),n=y(e.maximumHeight,0),r=y(e.ellipsoid,ie.WGS84);this.s2Cell=t,this.minimumHeight=i,this.maximumHeight=n,this.ellipsoid=r;let o=Mqe(t,i,n,r);this._boundingPlanes=o;let a,s=Bqe(o);for(this._vertices=s,this._edgeNormals=new Array(6),this._edgeNormals[0]=AW(o[0],s.slice(0,4)),a=0;a<4;a++)this._edgeNormals[0][a]=h.negate(this._edgeNormals[0][a],this._edgeNormals[0][a]);for(this._edgeNormals[1]=AW(o[1],s.slice(4,8)),a=0;a<4;a++)this._edgeNormals[2+a]=AW(o[2+a],[s[a%4],s[(a+1)%4],s[4+(a+1)%4],s[4+a]]);for(this._planeVertices=[this._vertices.slice(0,4),this._vertices.slice(4,8)],a=0;a<4;a++)this._planeVertices.push([this._vertices[a%4],this._vertices[(a+1)%4],this._vertices[4+(a+1)%4],this._vertices[4+a]]);let l=t.getCenter();(LB=r.cartesianToCartographic(l,LB)).height=(n+i)/2,this.center=r.cartographicToCartesian(LB,l),this._boundingSphere=se.fromPoints(s)}var Sqe=new h,wqe=new fe,vqe=new h,Dqe=new fe,Iqe=new h,Pqe=new h,Oqe=new h,Rqe=new h;function Mqe(e,t,i,n){let r=new Array(6),o=e.getCenter(),a=n.geodeticSurfaceNormal(o,Sqe),s=n.cartesianToCartographic(o,wqe);s.height=i;let l=n.cartographicToCartesian(s,vqe),u=tn.fromPointNormal(l,a);r[0]=u;let c,d,p,f=0,m=[];for(c=0;c<4;c++){d=e.getVertex(c),m[c]=d,p=n.cartesianToCartographic(d,Dqe),p.height=t;let i=tn.getPointDistance(u,n.cartographicToCartesian(p,Iqe));i<f&&(f=i)}let _=tn.clone(u);for(_.normal=h.negate(_.normal,_.normal),_.distance=-1*_.distance+f,r[1]=_,c=0;c<4;c++){d=m[c];let e=m[(c+1)%4],t=n.geodeticSurfaceNormal(d,Pqe),i=h.subtract(e,d,Rqe),o=h.cross(i,t,Oqe);o=h.normalize(o,o),r[2+c]=tn.fromPointNormal(d,o)}return r}var sx=new h,ax=new h,cx=new h,pW=new h,_W=new h,gW=new h,Lqe=new h,Nqe=new h,Fqe=new h,yW=new h,xW=new h,bW=new h,Lg=new h,Yh=new $;function Cle(e,t,i){sx=e.normal,ax=t.normal,cx=i.normal,pW=h.multiplyByScalar(e.normal,-e.distance,pW),_W=h.multiplyByScalar(t.normal,-t.distance,_W),gW=h.multiplyByScalar(i.normal,-i.distance,gW),yW=h.multiplyByScalar(h.cross(ax,cx,Lqe),h.dot(pW,sx),yW),xW=h.multiplyByScalar(h.cross(cx,sx,Nqe),h.dot(_W,ax),xW),bW=h.multiplyByScalar(h.cross(sx,ax,Fqe),h.dot(gW,cx),bW),Yh[0]=sx.x,Yh[1]=ax.x,Yh[2]=cx.x,Yh[3]=sx.y,Yh[4]=ax.y,Yh[5]=cx.y,Yh[6]=sx.z,Yh[7]=ax.z,Yh[8]=cx.z;let n=$.determinant(Yh);return Lg=h.add(yW,xW,Lg),Lg=h.add(Lg,bW,Lg),new h(Lg.x/n,Lg.y/n,Lg.z/n)}function Bqe(e){let t=new Array(8);for(let i=0;i<4;i++)t[i]=Cle(e[0],e[2+(i+3)%4],e[2+i%4]),t[i+4]=Cle(e[1],e[2+(i+3)%4],e[2+i%4]);return t}var TW=new h,WA=new h;function AW(e,t){let i=[];for(let n=0;n<4;n++)TW=h.subtract(t[(n+1)%4],t[n],TW),WA=h.cross(e.normal,TW,WA),WA=h.normalize(WA,WA),i[n]=h.clone(WA);return i}Object.defineProperties(uv.prototype,{boundingVolume:{get:function(){return this}},boundingSphere:{get:function(){return this._boundingSphere}}});var CW=new h;uv.prototype.distanceToCamera=function(e){let t,i,n,r,o,a=e.camera.positionWC,s=[],l=[];for(tn.getPointDistance(this._boundingPlanes[0],a)>0?(s.push(0),l.push(this._planeVertices[0]),t=this._edgeNormals[0]):tn.getPointDistance(this._boundingPlanes[1],a)>0&&(s.push(1),l.push(this._planeVertices[1]),t=this._edgeNormals[1]),i=0;i<4;i++)n=2+i,tn.getPointDistance(this._boundingPlanes[n],a)>0&&(s.push(n),l.push(this._planeVertices[n]),t=this._edgeNormals[n]);if(0===s.length)return 0;if(1===s.length)return o=this._boundingPlanes[s[0]],r=EW(tn.projectPointOntoPlane(o,a,CW),l[0],o,t),h.distance(r,a);if(2===s.length){if(0===s[0]){let e=[this._vertices[4*s[0]+(s[1]-2)],this._vertices[4*s[0]+(s[1]-2+1)%4]];return r=Ele(a,e[0],e[1]),h.distance(r,a)}let e,t=Number.MAX_VALUE;for(i=0;i<2;i++)o=this._boundingPlanes[s[i]],r=EW(tn.projectPointOntoPlane(o,a,CW),l[i],o,this._edgeNormals[s[i]]),e=h.distanceSquared(r,a),e<t&&(t=e);return Math.sqrt(t)}if(s.length>3)return r=EW(tn.projectPointOntoPlane(this._boundingPlanes[1],a,CW),this._planeVertices[1],this._boundingPlanes[1],this._edgeNormals[1]),h.distance(r,a);let u=2===s[1]&&5===s[2]?0:1;return 0===s[0]?h.distance(a,this._vertices[(s[1]-2+u)%4]):h.distance(a,this._vertices[4+(s[1]-2+u)%4])};var kqe=new h,Vqe=new h;function Ele(e,t,i){let n=h.subtract(i,t,kqe),r=h.subtract(e,t,Vqe),o=h.dot(n,r);if(o<=0)return t;let a=h.dot(n,n);return o>=a?i:(o/=a,new h((1-o)*t.x+o*i.x,(1-o)*t.y+o*i.y,(1-o)*t.z+o*i.z))}var Uqe=new tn(h.UNIT_X,0);function EW(e,t,i,n){let r,o,a,s=Number.MAX_VALUE;for(let i=0;i<t.length;i++){let l=tn.fromPointNormal(t[i],n[i],Uqe);tn.getPointDistance(l,e)<0||(a=Ele(e,t[i],t[(i+1)%4]),r=h.distance(e,a),r<s&&(s=r,o=a))}return u(o)?o:e}uv.prototype.intersectPlane=function(e){let t=0,i=0;for(let n=0;n<this._vertices.length;n++)h.dot(e.normal,this._vertices[n])+e.distance<0?i++:t++;return t===this._vertices.length?Zt.INSIDE:i===this._vertices.length?Zt.OUTSIDE:Zt.INTERSECTING},uv.prototype.createDebugVolume=function(e){let t=new L.clone(L.IDENTITY),i=new zf({polygonHierarchy:{positions:this._planeVertices[0]}}),n=zf.createGeometry(i),r=new yt({geometry:n,id:"outline",modelMatrix:t,attributes:{color:kt.fromColor(e)}}),o=new zf({polygonHierarchy:{positions:this._planeVertices[1]}}),a=zf.createGeometry(o),s=new yt({geometry:a,id:"outline",modelMatrix:t,attributes:{color:kt.fromColor(e)}}),l=[];for(let i=0;i<4;i++){let n=new zf({polygonHierarchy:{positions:this._planeVertices[2+i]}}),r=zf.createGeometry(n);l[i]=new yt({geometry:r,id:"outline",modelMatrix:t,attributes:{color:kt.fromColor(e)}})}return new Sn({geometryInstances:[l[0],l[1],l[2],l[3],s,r],appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1})};var NB=uv;function jA(e,t){0===t&&(t=P.EPSILON7),this._boundingSphere=new se(e,t)}Object.defineProperties(jA.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}}),jA.prototype.distanceToCamera=function(e){let t=this._boundingSphere;return Math.max(0,h.distance(t.center,e.camera.positionWC)-t.radius)},jA.prototype.intersectPlane=function(e){return se.intersectPlane(this._boundingSphere,e)},jA.prototype.update=function(e,t){h.clone(e,this._boundingSphere.center),this._boundingSphere.radius=t},jA.prototype.createDebugVolume=function(e){let t=new X_({radius:this.radius}),i=L.fromTranslation(this.center,new L.clone(L.IDENTITY)),n=new yt({geometry:t,id:"outline",modelMatrix:i,attributes:{color:kt.fromColor(e)}});return new Sn({geometryInstances:n,appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1})};var Ng=jA,zqe=new h,Hqe=new h,Gqe=new h,Wqe=new h;function lx(e,t,i){i=h.cross(e,t,i);let n=h.magnitude(i);return h.multiplyByScalar(i,P.EPSILON7/n,i)}function SW(e,t){let i=h.normalize(e,Wqe);return lx(e,h.equalsEpsilon(i,h.UNIT_X,P.EPSILON6)?h.UNIT_Y:h.UNIT_X,t)}function Sle(e){let t=$.getColumn(e,0,zqe),i=$.getColumn(e,1,Hqe),n=$.getColumn(e,2,Gqe),r=h.equals(t,h.ZERO),o=h.equals(i,h.ZERO),a=h.equals(n,h.ZERO);return r||o||a?r&&o&&a?(e[0]=P.EPSILON7,e[4]=P.EPSILON7,e[8]=P.EPSILON7,e):(!r||o||a?r||!o||a?r||o||!a?r?o?a||(t=SW(n,t),i=lx(n,t,i)):(t=SW(i,t),n=lx(i,t,n)):(i=SW(t,i),n=lx(i,t,n)):n=lx(i,t,n):i=lx(t,n,i):t=lx(i,n,t),$.setColumn(e,0,t,e),$.setColumn(e,1,i,e),$.setColumn(e,2,n,e),e):e}function qA(e,t){t=Sle(t),this._orientedBoundingBox=new Pn(e,t),this._boundingSphere=se.fromOrientedBoundingBox(this._orientedBoundingBox)}Object.defineProperties(qA.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),qA.prototype.distanceToCamera=function(e){return Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))},qA.prototype.intersectPlane=function(e){return this._orientedBoundingBox.intersectPlane(e)},qA.prototype.update=function(e,t){h.clone(e,this._orientedBoundingBox.center),t=Sle(t),$.clone(t,this._orientedBoundingBox.halfAxes),se.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)},qA.prototype.createDebugVolume=function(e){let t=new lh({minimum:new h(-1,-1,-1),maximum:new h(1,1,1)}),i=L.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),n=new yt({geometry:t,id:"outline",modelMatrix:i,attributes:{color:kt.fromColor(e)}});return new Sn({geometryInstances:n,appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1})};var pd=qA;function Go(e,t,i,n){this._tileset=e,this._header=i;let r=u(i.contents),o=r&&i.contents.length>1||ii(i,"3DTILES_multiple_contents"),a=r&&!o?i.contents[0]:i.content;this._contentHeader=a,this.transform=u(i.transform)?L.unpack(i.transform):L.clone(L.IDENTITY);let s,l,c,h=u(n)?n.computedTransform:e.modelMatrix,d=L.multiply(h,this.transform,new L),p=u(n)?n._initialTransform:L.IDENTITY;this._initialTransform=L.multiply(p,this.transform,new L),this.computedTransform=d,this.metadata=vB(e,i),this._boundingVolume=this.createBoundingVolume(i.boundingVolume,d),this._boundingVolume2D=void 0,u(a)&&u(a.boundingVolume)&&(s=this.createBoundingVolume(a.boundingVolume,d)),this._contentBoundingVolume=s,this._contentBoundingVolume2D=void 0,u(i.viewerRequestVolume)&&(l=this.createBoundingVolume(i.viewerRequestVolume,d)),this._viewerRequestVolume=l,this.geometricError=i.geometricError,this._geometricError=i.geometricError,u(this._geometricError)||(this._geometricError=u(n)?n._geometricError:e._geometricError,Go._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")),this.updateGeometricErrorScale(),u(i.refine)?(("replace"===i.refine||"add"===i.refine)&&Go._deprecationWarning("lowercase-refine",`This tile uses a lowercase refine "${i.refine}". Instead use "${i.refine.toUpperCase()}".`),c="REPLACE"===i.refine.toUpperCase()?Uo.REPLACE:Uo.ADD):c=u(n)?n.refine:Uo.REPLACE,this.refine=c,this.children=[],this.parent=n;let f,m,_,g,y=!1;if(t=ve.createIfNeeded(t),o)m=Ho.UNLOADED,_=t.clone();else if(u(a)){let i=a.uri;u(a.url)&&(Go._deprecationWarning("contentUrl",'This tileset JSON uses the "content.url" property which has been deprecated. Use "content.uri" instead.'),i=a.url),""===i?(Go._deprecationWarning("contentUriEmpty","content.uri property is an empty string, which creates a circular dependency, making this tileset invalid. Omit the content property instead"),f=new av(e,this),y=!0,m=Ho.READY):(m=Ho.UNLOADED,_=t.getDerivedResource({url:i}),g=nc.getServerKey(_.getUrlComponent()))}else f=new av(e,this),y=!0,m=Ho.READY;this._content=f,this._contentResource=_,this._contentState=m,this._expiredContent=void 0,this._serverKey=g,this.hasEmptyContent=y,this.hasTilesetContent=!1,this.hasImplicitContent=!1,this.hasImplicitContentMetadata=!1,this.hasMultipleContents=o,this.cacheNode=void 0;let v,b,A=i.expire;u(A)&&(v=A.duration,u(A.date)&&(b=J.fromIso8601(A.date))),this.expireDuration=v,this.expireDate=b,this.lastStyleTime=0,this._optimChildrenWithinParent=dd.NOT_COMPUTED,this.clippingPlanesDirty=!1,this.priorityDeferred=!1,this.implicitTileset=void 0,this.implicitCoordinates=void 0,this.implicitSubtree=void 0,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._screenSpaceErrorProgressiveResolution=0,this._visibilityPlaneMask=0,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._isClipped=!0,this._clippingPlanesState=0,this._debugBoundingVolume=void 0,this._debugContentBoundingVolume=void 0,this._debugViewerRequestVolume=void 0,this._debugColor=z.fromRandom({alpha:1}),this._debugColorizeTiles=!1,this._priority=0,this._priorityHolder=this,this._priorityProgressiveResolution=!1,this._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1,this._priorityReverseScreenSpaceError=0,this._foveatedFactor=0,this._wasMinPriorityChild=!1,this._loadTimestamp=new J,this._commandsLength=0,this._color=void 0,this._colorDirty=!1,this._request=void 0}Go._deprecationWarning=is,Object.defineProperties(Go.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},boundingVolume:{get:function(){return this._boundingVolume}},contentBoundingVolume:{get:function(){return y(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},isVisible:{get:function(){return this._visible&&this._inRequestVolume}},extras:{get:function(){return this._header.extras}},color:{get:function(){return u(this._color)||(this._color=new z),z.clone(this._color)},set:function(e){this._color=z.clone(e,this._color),this._colorDirty=!0}},hasRenderableContent:{get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent&&!this.hasImplicitContent}},contentAvailable:{get:function(){return this.contentReady&&this.hasRenderableContent||u(this._expiredContent)&&!this.contentFailed}},contentReady:{get:function(){return this._contentState===Ho.READY}},contentUnloaded:{get:function(){return this._contentState===Ho.UNLOADED}},hasUnloadedRenderableContent:{get:function(){return this.hasRenderableContent&&this.contentUnloaded}},contentExpired:{get:function(){return this._contentState===Ho.EXPIRED}},contentFailed:{get:function(){return this._contentState===Ho.FAILED}},commandsLength:{get:function(){return this._commandsLength}}});var Fg=new h;function jqe(e,t){let{tileset:i,boundingSphere:n}=e,{radius:r,center:o}=n,{camera:a}=t,s=h.multiplyByScalar(a.directionWC,e._centerZDepth,Fg),l=h.add(a.positionWC,s,Fg),c=h.subtract(l,o,Fg);if(h.magnitude(c)>r){let t=h.normalize(c,Fg),i=h.multiplyByScalar(t,r,Fg),n=h.add(o,i,Fg),s=h.subtract(n,a.positionWC,Fg),l=h.normalize(s,Fg);e._foveatedFactor=1-Math.abs(h.dot(a.directionWC,l))}else e._foveatedFactor=0;let d=e.refine===Uo.REPLACE,p=i.isSkippingLevelOfDetail;if(d&&!p||!i.foveatedScreenSpaceError||1===i.foveatedConeSize||e._priorityProgressiveResolution&&d&&p||i._pass===Io.PRELOAD_FLIGHT||i._pass===Io.PRELOAD)return!1;let f=1-Math.cos(.5*a.frustum.fov),m=i.foveatedConeSize*f;if(e._foveatedFactor<=m)return!1;let _=f-m,g=P.clamp((e._foveatedFactor-m)/_,0,1),y=i.foveatedInterpolationCallback(i.foveatedMinimumScreenSpaceErrorRelaxation,i.memoryAdjustedScreenSpaceError,g),v=0===e._screenSpaceError&&u(e.parent)?.5*e.parent._screenSpaceError:e._screenSpaceError;return i.memoryAdjustedScreenSpaceError-y<=v}var Dle=new J;function qqe(e,t){if(e.progressiveResolutionHeightFraction<=0||e.progressiveResolutionHeightFraction>.5)return!1;let i=e.memoryAdjustedScreenSpaceError,n=t._screenSpaceErrorProgressiveResolution>i;t._priorityProgressiveResolutionScreenSpaceErrorLeaf=!1;let r=t.parent,o=t._screenSpaceErrorProgressiveResolution<=i,a=u(r)&&r._screenSpaceErrorProgressiveResolution>i;return o&&a&&(t._priorityProgressiveResolutionScreenSpaceErrorLeaf=!0,n=!0),n}function Yqe(e,t){let i=t.parent,n=u(i)&&(!e.isSkippingLevelOfDetail||0===t._screenSpaceError||i.hasTilesetContent||i.hasImplicitContent)?i._screenSpaceError:t._screenSpaceError;return e.root._screenSpaceError-n}function Xqe(e){if(!u(e.expireDuration))return;let t=J.now(Dle);J.addSeconds(t,e.expireDuration,t),u(e.expireDate)?J.lessThan(e.expireDate,t)&&J.clone(t,e.expireDate):e.expireDate=J.clone(t)}function Kqe(e){return function(){return e._priority}}function Zqe(e){let t=e._content,i=e._tileset;if(!u(t)){let n=ii(e._header,"3DTILES_multiple_contents")?e._header.extensions["3DTILES_multiple_contents"]:e._header;t=new DB(i,e,e._contentResource.clone(),n),e._content=t}let n=t.requestInnerContents();if(u(n))return e._contentState=Ho.LOADING,n.then((i=>{if(!e.isDestroyed()&&u(i))return e._contentState=Ho.PROCESSING,t})).catch((t=>{if(!e.isDestroyed())throw e._contentState=Ho.FAILED,t}))}async function $qe(e,t,i,n,r){let o,a=e._contentState;e._contentState=Ho.LOADING,++t.statistics.numberOfPendingRequests;try{o=await r}catch(n){if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;if(i.cancelled||i.state===Qn.CANCELLED)return e._contentState=a,void++t.statistics.numberOfAttemptedRequests;throw e._contentState=Ho.FAILED,n}if(e.isDestroyed())--t.statistics.numberOfPendingRequests;else{if(i.cancelled||i.state===Qn.CANCELLED)return e._contentState=a,--t.statistics.numberOfPendingRequests,void++t.statistics.numberOfAttemptedRequests;try{let i=await Jqe(e,o);return--t.statistics.numberOfPendingRequests,e.isDestroyed()?void 0:(n&&(e.expireDate=void 0),e._content=i,e._contentState=Ho.PROCESSING,i)}catch(i){if(--t.statistics.numberOfPendingRequests,e.isDestroyed())return;throw e._contentState=Ho.FAILED,i}}}function Qqe(e){let t=e._contentResource.clone(),i=e.contentExpired;i&&t.setQueryParameters({expired:e.expireDate.toString()});let n=new Ko({throttle:!0,throttleByServer:!0,type:Jr.TILES3D,priorityFunction:Kqe(e),serverKey:e._serverKey});e._request=n,t.request=n;let r=e._tileset,o=t.fetchArrayBuffer();if(u(o))return $qe(e,r,n,i,o);++r.statistics.numberOfAttemptedRequests}async function Jqe(e,t){let i=Dp(t),n=e._tileset;n._disableSkipLevelOfDetail=n._disableSkipLevelOfDetail||i.contentType===Es.GEOMETRY||i.contentType===Es.VECTOR,(i.contentType===Es.IMPLICIT_SUBTREE||i.contentType===Es.IMPLICIT_SUBTREE_JSON)&&(e.hasImplicitContent=!0),i.contentType===Es.EXTERNAL_TILESET&&(e.hasTilesetContent=!0);let r,o=BA[i.contentType];if(e.isDestroyed())return;r=u(i.binaryPayload)?await Promise.resolve(o(n,e,e._contentResource,i.binaryPayload.buffer,0)):await Promise.resolve(o(n,e,e._contentResource,i.jsonPayload));let a=e._contentHeader;if(e.hasImplicitContentMetadata){let t=e.implicitSubtree,i=e.implicitCoordinates;r.metadata=t.getContentMetadataView(i,0)}else e.hasImplicitContent||(r.metadata=kA(n,a));let s=VA(n,a);return u(s)&&(r.group=new fA({metadata:s})),r}Go.prototype.getScreenSpaceError=function(e,t,i){let n=this._tileset,r=y(i,1),o=u(this.parent)?this.parent.geometricError:n._scaledGeometricError,a=t?o:this.geometricError;if(0===a)return 0;let s,{camera:l,context:c}=e,h=l.frustum,d=c.drawingBufferWidth,p=c.drawingBufferHeight*r;if(e.mode===te.SCENE2D||h instanceof Qt){let e=h.offCenterFrustum;u(e)&&(h=e),s=a/(Math.max(h.top-h.bottom,h.right-h.left)/Math.max(d,p))}else{let e=Math.max(this._distanceToCamera,P.EPSILON7);if(s=a*p/(e*h.sseDenominator),n.dynamicScreenSpaceError){let t=n._dynamicScreenSpaceErrorComputedDensity,i=n.dynamicScreenSpaceErrorFactor;s-=P.fog(e,t)*i}}return s/=e.pixelRatio,s},Go.prototype.updateVisibility=function(e){let{parent:t,tileset:i}=this;if(this._updatedVisibilityFrame===i._updatedVisibilityFrame)return;let n=u(t)?t.computedTransform:i.modelMatrix,r=u(t)?t._visibilityPlaneMask:ns.MASK_INDETERMINATE;this.updateTransform(n),this._distanceToCamera=this.distanceToTile(e),this._centerZDepth=this.distanceToTileCenter(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._screenSpaceErrorProgressiveResolution=this.getScreenSpaceError(e,!1,i.progressiveResolutionHeightFraction),this._visibilityPlaneMask=this.visibility(e,r),this._visible=this._visibilityPlaneMask!==ns.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._priorityReverseScreenSpaceError=Yqe(i,this),this._priorityProgressiveResolution=qqe(i,this),this.priorityDeferred=jqe(this,e),this._updatedVisibilityFrame=i._updatedVisibilityFrame},Go.prototype.updateExpiration=function(){if(u(this.expireDate)&&this.contentReady&&!this.hasEmptyContent&&!this.hasMultipleContents){let e=J.now(Dle);J.lessThan(this.expireDate,e)&&(this._contentState=Ho.EXPIRED,this._expiredContent=this._content)}},Go.prototype.requestContent=function(){if(!this.hasEmptyContent)return this.hasMultipleContents?Zqe(this):Qqe(this)},Go.prototype.cancelRequests=function(){this.hasMultipleContents?this._content.cancelRequests():this._request.cancel()},Go.prototype.unloadContent=function(){this.hasRenderableContent&&(this._content=this._content&&this._content.destroy(),this._contentState=Ho.UNLOADED,this.lastStyleTime=0,this.clippingPlanesDirty=0===this._clippingPlanesState,this._clippingPlanesState=0,this._debugColorizeTiles=!1,this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy())};var Ile=new se;function vW(e,t){if(t.mode!==te.SCENE3D&&!u(e._boundingVolume2D)){let i=e._boundingVolume.boundingSphere,n=se.projectTo2D(i,t.mapProjection,Ile);e._boundingVolume2D=new Ng(n.center,n.radius)}return t.mode!==te.SCENE3D?e._boundingVolume2D:e._boundingVolume}function eYe(e,t){if(t.mode!==te.SCENE3D&&!u(e._contentBoundingVolume2D)){let i=e._contentBoundingVolume.boundingSphere,n=se.projectTo2D(i,t.mapProjection,Ile);e._contentBoundingVolume2D=new Ng(n.center,n.radius)}return t.mode!==te.SCENE3D?e._contentBoundingVolume2D:e._contentBoundingVolume}Go.prototype.visibility=function(e,t){let i=e.cullingVolume,n=vW(this,e),r=this._tileset,o=r.clippingPlanes;if(u(o)&&o.enabled){let e=o.computeIntersectionWithBoundingVolume(n,r.clippingPlanesOriginMatrix);if(this._isClipped=e!==Zt.INSIDE,e===Zt.OUTSIDE)return ns.MASK_OUTSIDE}return i.computeVisibilityWithPlaneMask(n,t)},Go.prototype.contentVisibility=function(e){if(!u(this._contentBoundingVolume))return Zt.INSIDE;if(this._visibilityPlaneMask===ns.MASK_INSIDE)return Zt.INSIDE;let t=e.cullingVolume,i=eYe(this,e),n=this._tileset,r=n.clippingPlanes;if(u(r)&&r.enabled){let e=r.computeIntersectionWithBoundingVolume(i,n.clippingPlanesOriginMatrix);if(this._isClipped=e!==Zt.INSIDE,e===Zt.OUTSIDE)return Zt.OUTSIDE}return t.computeVisibility(i)},Go.prototype.distanceToTile=function(e){return vW(this,e).distanceToCamera(e)};var tYe=new h;Go.prototype.distanceToTileCenter=function(e){let t=vW(this,e).boundingVolume,i=h.subtract(t.center,e.camera.positionWC,tYe);return h.dot(e.camera.directionWC,i)},Go.prototype.insideViewerRequestVolume=function(e){let t=this._viewerRequestVolume;return!u(t)||0===t.distanceToCamera(e)};var Ple=new $,Ole=new h,nYe=new $,Rle=new h,Mle=new ce,iYe=new Pn,wW=new L;function oYe(e,t,i){let n=h.fromElements(e[0],e[1],e[2],Rle),r=$.fromArray(e,3,nYe);n=L.multiplyByPoint(t,n,n);let o=L.getMatrix3(t,Ple);return r=$.multiply(o,r,r),u(i)?(i.update(n,r),i):new pd(n,r)}function rYe(e,t,i,n){let r=ce.unpack(e,0,Mle),o=e[4],a=e[5],s=Pn.fromRectangle(r,o,a,ie.WGS84,iYe),l=s.center,c=s.halfAxes;t=L.multiplyTransformation(t,L.inverseTransformation(i,wW),wW),l=L.multiplyByPoint(t,l,l);let h=L.getMatrix3(t,Ple);return c=$.multiply(h,c,c),u(n)&&n instanceof pd?(n.update(l,c),n):new pd(l,c)}function sYe(e,t,i,n){if(!L.equalsEpsilon(t,i,P.EPSILON8))return rYe(e,t,i,n);if(u(n))return n;let r=ce.unpack(e,0,Mle);return new md({rectangle:r,minimumHeight:e[4],maximumHeight:e[5]})}function aYe(e,t,i){let n=h.fromElements(e[0],e[1],e[2],Rle),r=e[3];n=L.multiplyByPoint(t,n,n);let o=L.getScale(t,Ole);return r*=h.maximumComponent(o),u(i)?(i.update(n,r),i):new Ng(n,r)}function cYe(e,t,i,n){if(!n.isRender)return;let r=u(e._contentHeader)&&u(e._contentHeader.boundingVolume),o=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!r;if(o){let t;t=e._finalResolution?e.hasRenderableContent?z.WHITE:z.DARKGRAY:z.YELLOW,u(e._debugBoundingVolume)||(e._debugBoundingVolume=e._boundingVolume.createDebugVolume(t)),e._debugBoundingVolume.update(i);let n=e._debugBoundingVolume.getGeometryInstanceAttributes("outline");n.color=kt.toValue(t,n.color)}else!o&&u(e._debugBoundingVolume)&&(e._debugBoundingVolume=e._debugBoundingVolume.destroy());t.debugShowContentBoundingVolume&&r?(u(e._debugContentBoundingVolume)||(e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(z.BLUE)),e._debugContentBoundingVolume.update(i)):!t.debugShowContentBoundingVolume&&u(e._debugContentBoundingVolume)&&(e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()),t.debugShowViewerRequestVolume&&u(e._viewerRequestVolume)?(u(e._debugViewerRequestVolume)||(e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(z.YELLOW)),e._debugViewerRequestVolume.update(i)):!t.debugShowViewerRequestVolume&&u(e._debugViewerRequestVolume)&&(e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy());let a=t.debugColorizeTiles&&!e._debugColorizeTiles||u(t._heatmap.tilePropertyName),s=!t.debugColorizeTiles&&e._debugColorizeTiles;a?(t._heatmap.colorize(e,i),e._debugColorizeTiles=!0,e.color=e._debugColor):s&&(e._debugColorizeTiles=!1,e.color=z.WHITE),e._colorDirty&&(e._colorDirty=!1,e._content.applyDebugSettings(!0,e._color)),s&&t.makeStyleDirty()}function lYe(e,t,i){let n=e._expiredContent;if(!e.hasMultipleContents&&u(n)){if(!e.contentReady){try{n.update(t,i)}catch{}return}e._expiredContent.destroy(),e._expiredContent=void 0}if(u(e.content))try{e.content.update(t,i)}catch(t){throw e._contentState=Ho.FAILED,t}}function uYe(e,t){let i=t.clippingPlanes,n=0;u(i)&&e._isClipped&&i.enabled&&(n=i.clippingPlanesState),n!==e._clippingPlanesState&&(e._clippingPlanesState=n,e.clippingPlanesDirty=!0)}Go.prototype.createBoundingVolume=function(e,t,i){let n,r=this.metadata;if(u(r)&&(n=iA.parseBoundingVolumeSemantic("TILE",r)),u(n)&&(e=n),!u(e))throw new ue("boundingVolume must be defined");if(ii(e,"3DTILES_bounding_volume_S2"))return new NB(e.extensions["3DTILES_bounding_volume_S2"]);let{box:o,region:a,sphere:s}=e;if(u(o))return oYe(o,t,i);if(u(a))return sYe(a,t,this._initialTransform,i);if(u(s))return aYe(s,t,i);throw new ue("boundingVolume must contain a sphere, region, or box")},Go.prototype.updateTransform=function(e){e=y(e,L.IDENTITY);let t=L.multiplyTransformation(e,this.transform,wW);if(L.equals(t,this.computedTransform))return;L.clone(t,this.computedTransform);let i=this._header,n=this._contentHeader;this._boundingVolume=this.createBoundingVolume(i.boundingVolume,this.computedTransform,this._boundingVolume),u(this._contentBoundingVolume)&&(this._contentBoundingVolume=this.createBoundingVolume(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),u(this._viewerRequestVolume)&&(this._viewerRequestVolume=this.createBoundingVolume(i.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)),this.updateGeometricErrorScale(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()},Go.prototype.updateGeometricErrorScale=function(){let e=L.getScale(this.computedTransform,Ole),t=h.maximumComponent(e);if(this.geometricError=this._geometricError*t,!u(this.parent)){let e=this._tileset;e._scaledGeometricError=e._geometricError*t}},Go.prototype.update=function(e,t,i){let{commandList:n}=t,r=n.length;uYe(this,e),cYe(this,e,t,i),lYe(this,e,t);let o=n.length;this._commandsLength=o-r;for(let e=r;e<o;++e){let t=n[e],i=t.pass===Ee.TRANSLUCENT;t.depthForTranslucentClassification=i}this.clippingPlanesDirty=!1};var wle=[];function vle(e,t,i){let n=e*Math.pow(10,t);return parseInt(n)*Math.pow(10,i)}function FB(e,t,i){return Math.max(P.normalize(e,t,i)-P.EPSILON7,0)}Go.prototype.process=function(e,t){!this.contentExpired&&!this.contentReady&&this._content.ready&&(Xqe(this),this._selectedFrame=0,this.lastStyleTime=0,J.now(this._loadTimestamp),this._contentState=Ho.READY,!this.hasTilesetContent&&!this.hasImplicitContent&&(e._statistics.incrementLoadCounts(this.content),++e._statistics.numberOfTilesWithContentReady,++e._statistics.numberOfLoadedTilesTotal,e._cache.add(this)));let i=t.commandList;t.commandList=wle;try{this._content.update(e,t)}catch(e){throw this._contentState=Ho.FAILED,e}wle.length=0,t.commandList=i},Go.prototype.updatePriority=function(){let e=this.tileset,t=e.preferLeaves,i=e._minimumPriority,n=e._maximumPriority,r=Math.pow(10,8),o=Math.pow(10,9),a=Math.pow(10,10),s=FB(this._depth,i.depth,n.depth);s=t?1-s:s;let l=vle(e.isSkippingLevelOfDetail||this.refine!==Uo.REPLACE?FB(this._priorityReverseScreenSpaceError,i.reverseScreenSpaceError,n.reverseScreenSpaceError):FB(this._priorityHolder._distanceToCamera,i.distance,n.distance),4,0),u=this._priorityProgressiveResolution?0:r,c=vle(FB(this._priorityHolder._foveatedFactor,i.foveatedFactor,n.foveatedFactor),4,4),h=this.priorityDeferred?o:0,d=e._pass===Io.PRELOAD_FLIGHT?0:a;this._priority=s+l+u+c+h+d},Go.prototype.isDestroyed=function(){return!1},Go.prototype.destroy=function(){return this._content=this._content&&this._content.destroy(),this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy(),le(this)};var _d=Go;function Op(){this.featurePropertiesDirty=!1}Object.defineProperties(Op.prototype,{featuresLength:{get:function(){de.throwInstantiationError()}},pointsLength:{get:function(){de.throwInstantiationError()}},trianglesLength:{get:function(){de.throwInstantiationError()}},geometryByteLength:{get:function(){de.throwInstantiationError()}},texturesByteLength:{get:function(){de.throwInstantiationError()}},batchTableByteLength:{get:function(){de.throwInstantiationError()}},innerContents:{get:function(){de.throwInstantiationError()}},ready:{get:function(){de.throwInstantiationError()}},tileset:{get:function(){de.throwInstantiationError()}},tile:{get:function(){de.throwInstantiationError()}},url:{get:function(){de.throwInstantiationError()}},batchTable:{get:function(){de.throwInstantiationError()}},metadata:{get:function(){de.throwInstantiationError()},set:function(e){de.throwInstantiationError()}},group:{get:function(){de.throwInstantiationError()},set:function(e){de.throwInstantiationError()}}}),Op.prototype.hasProperty=function(e,t){de.throwInstantiationError()},Op.prototype.getFeature=function(e){de.throwInstantiationError()},Op.prototype.applyDebugSettings=function(e,t){de.throwInstantiationError()},Op.prototype.applyStyle=function(e){de.throwInstantiationError()},Op.prototype.update=function(e,t){de.throwInstantiationError()},Op.prototype.isDestroyed=function(){de.throwInstantiationError()},Op.prototype.destroy=function(){de.throwInstantiationError()};var Lle=Op,Nle={},fYe=new h;Nle.checkChildrenWithinParent=function(e){let t=e.children,i=t.length,n=e.boundingVolume;if(n instanceof pd||n instanceof md){let r=n._orientedBoundingBox;e._optimChildrenWithinParent=dd.USE_OPTIMIZATION;for(let n=0;n<i;++n){let i=t[n].boundingVolume;if(!(i instanceof pd||i instanceof md)){e._optimChildrenWithinParent=dd.SKIP_OPTIMIZATION;break}let o=i._orientedBoundingBox,a=h.subtract(o.center,r.center,fYe),s=h.magnitude(a);if(h.divideByScalar(a,s,a),Math.abs(r.halfAxes[0]*a.x)+Math.abs(r.halfAxes[1]*a.y)+Math.abs(r.halfAxes[2]*a.z)+Math.abs(r.halfAxes[3]*a.x)+Math.abs(r.halfAxes[4]*a.y)+Math.abs(r.halfAxes[5]*a.z)+Math.abs(r.halfAxes[6]*a.x)+Math.abs(r.halfAxes[7]*a.y)+Math.abs(r.halfAxes[8]*a.z)<=Math.abs(o.halfAxes[0]*a.x)+Math.abs(o.halfAxes[1]*a.y)+Math.abs(o.halfAxes[2]*a.z)+Math.abs(o.halfAxes[3]*a.x)+Math.abs(o.halfAxes[4]*a.y)+Math.abs(o.halfAxes[5]*a.z)+Math.abs(o.halfAxes[6]*a.x)+Math.abs(o.halfAxes[7]*a.y)+Math.abs(o.halfAxes[8]*a.z)+s){e._optimChildrenWithinParent=dd.SKIP_OPTIMIZATION;break}}}return e._optimChildrenWithinParent===dd.USE_OPTIMIZATION};var BB=Nle;function dYe(e){this.pass=e.pass,this.commandList=e.commandList,this.camera=e.camera,this.cullingVolume=e.cullingVolume,this.ready=!1}var gd=dYe;function Rp(e){let t=(e=y(e,y.EMPTY_OBJECT)).id,i=e.group,n=e.class,r=u(i.properties)?i.properties:{};this._class=n,this._properties=r,this._id=t,this._extras=i.extras,this._extensions=i.extensions}Object.defineProperties(Rp.prototype,{class:{get:function(){return this._class}},id:{get:function(){return this._id}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),Rp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)},Rp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)},Rp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)},Rp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)},Rp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)},Rp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)},Rp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var fv=Rp;function Mp(e){let t=(e=y(e,y.EMPTY_OBJECT)).tileset,i=e.class,n=u(t.properties)?t.properties:{};this._class=i,this._properties=n,this._extras=t.extras,this._extensions=t.extensions}Object.defineProperties(Mp.prototype,{class:{get:function(){return this._class}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}}),Mp.prototype.hasProperty=function(e){return Bn.hasProperty(e,this._properties,this._class)},Mp.prototype.hasPropertyBySemantic=function(e){return Bn.hasPropertyBySemantic(e,this._properties,this._class)},Mp.prototype.getPropertyIds=function(e){return Bn.getPropertyIds(this._properties,this._class,e)},Mp.prototype.getProperty=function(e){return Bn.getProperty(e,this._properties,this._class)},Mp.prototype.setProperty=function(e,t){return Bn.setProperty(e,t,this._properties,this._class)},Mp.prototype.getPropertyBySemantic=function(e){return Bn.getPropertyBySemantic(e,this._properties,this._class)},Mp.prototype.setPropertyBySemantic=function(e,t){return Bn.setPropertyBySemantic(e,t,this._properties,this._class)};var kB=Mp;function Fle(e){let t,i=(e=y(e,y.EMPTY_OBJECT)).metadataJson,n=e.schema,r=y(i.metadata,i.tileset);u(r)&&(t=new kB({tileset:r,class:n.classes[r.class]}));let o=[],a=[],s=i.groups;if(Array.isArray(s)){let e=s.length;for(let t=0;t<e;t++){let e=s[t];a.push(new fv({group:e,class:n.classes[e.class]}))}}else if(u(s)){o=Object.keys(s).sort();let e=o.length;for(let t=0;t<e;t++){let e=o[t];if(s.hasOwnProperty(e)){let t=s[e];a.push(new fv({id:e,group:s[e],class:n.classes[t.class]}))}}}this._schema=n,this._groups=a,this._groupIds=o,this._tileset=t,this._statistics=i.statistics,this._extras=i.extras,this._extensions=i.extensions}Object.defineProperties(Fle.prototype,{schema:{get:function(){return this._schema}},groups:{get:function(){return this._groups}},groupIds:{get:function(){return this._groupIds}},tileset:{get:function(){return this._tileset}},statistics:{get:function(){return this._statistics}},extras:{get:function(){return this._extras}},extensions:{get:function(){return this._extensions}}});var YA=Fle;function ux(){this._list=new N1,this._sentinel=this._list.add(),this._trimTiles=!1}ux.prototype.reset=function(){this._list.splice(this._list.tail,this._sentinel)},ux.prototype.touch=function(e){let t=e.cacheNode;u(t)&&this._list.splice(this._sentinel,t)},ux.prototype.add=function(e){u(e.cacheNode)||(e.cacheNode=this._list.add(e))},ux.prototype.unloadTile=function(e,t,i){let n=t.cacheNode;u(n)&&(this._list.remove(n),t.cacheNode=void 0,i(e,t))},ux.prototype.unloadTiles=function(e,t){let i=this._trimTiles;this._trimTiles=!1;let n=this._list,r=this._sentinel,o=n.head;for(;o!==r&&(e.totalMemoryUsageInBytes>e.cacheBytes||i);){let i=o.item;o=o.next,this.unloadTile(e,i,t)}},ux.prototype.trim=function(){this._trimTiles=!0};var VB=ux;function UB(e){this.tilePropertyName=e,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE,this._previousMinimum=Number.MAX_VALUE,this._previousMaximum=-Number.MAX_VALUE,this._referenceMinimum={},this._referenceMaximum={}}function IW(e,t){let i;return i="_loadTimestamp"===t?J.toDate(e).getTime():e,i}function hYe(e,t){let i=e.tilePropertyName;if(u(i)){let n=IW(t[i],i);return u(n)?(e._maximum=Math.max(n,e._maximum),e._minimum=Math.min(n,e._minimum),n):(e.tilePropertyName=void 0,n)}}UB.prototype.setReferenceMinimumMaximum=function(e,t,i){this._referenceMinimum[i]=IW(e,i),this._referenceMaximum[i]=IW(t,i)};var DW=[new z(.1,.1,.1,1),new z(.153,.278,.878,1),new z(.827,.231,.49,1),new z(.827,.188,.22,1),new z(1,.592,.259,1),new z(1,.843,0,1)];UB.prototype.colorize=function(e,t){let i=this.tilePropertyName;if(!u(i)||!e.contentAvailable||e._selectedFrame!==t.frameNumber)return;let n=hYe(this,e),r=this._previousMinimum,o=this._previousMaximum;if(r===Number.MAX_VALUE||o===-Number.MAX_VALUE)return;let a=o-r+P.EPSILON7,s=P.clamp(n-r,0,a)/a*(DW.length-1),l=Math.floor(s),c=Math.ceil(s),h=s-l,d=DW[l],p=DW[c],f=z.clone(z.WHITE);f.red=P.lerp(d.red,p.red,h),f.green=P.lerp(d.green,p.green,h),f.blue=P.lerp(d.blue,p.blue,h),e._debugColor=f},UB.prototype.resetMinimumMaximum=function(){let e=this.tilePropertyName;if(u(e)){let t=this._referenceMinimum[e],i=this._referenceMaximum[e],n=u(t)&&u(i);this._previousMinimum=n?t:this._minimum,this._previousMaximum=n?i:this._maximum,this._minimum=Number.MAX_VALUE,this._maximum=-Number.MAX_VALUE}};var zB=UB;function XA(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfPendingRequests=0,this.numberOfTilesProcessing=0,this.numberOfTilesWithContentReady=0,this.numberOfTilesTotal=0,this.numberOfLoadedTilesTotal=0,this.numberOfFeaturesSelected=0,this.numberOfFeaturesLoaded=0,this.numberOfPointsSelected=0,this.numberOfPointsLoaded=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0,this.geometryByteLength=0,this.texturesByteLength=0,this.batchTableByteLength=0}function HB(e,t,i,n){let r=t.innerContents,o=t.pointsLength,a=t.trianglesLength,s=t.featuresLength,l=t.geometryByteLength,c=t.texturesByteLength,h=t.batchTableByteLength;if(n?(e.numberOfFeaturesLoaded+=i?-s:s,e.numberOfPointsLoaded+=i?-o:o,e.geometryByteLength+=i?-l:l,e.texturesByteLength+=i?-c:c,e.batchTableByteLength+=i?-h:h):(e.numberOfFeaturesSelected+=i?-s:s,e.numberOfPointsSelected+=i?-o:o,e.numberOfTrianglesSelected+=i?-a:a),u(r)){let t=r.length;for(let o=0;o<t;++o)HB(e,r[o],i,n)}}XA.prototype.clear=function(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfFeaturesSelected=0,this.numberOfPointsSelected=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0},XA.prototype.incrementSelectionCounts=function(e){HB(this,e,!1,!1)},XA.prototype.incrementLoadCounts=function(e){HB(this,e,!1,!0)},XA.prototype.decrementLoadCounts=function(e){HB(this,e,!0,!0)},XA.clone=function(e,t){t.selected=e.selected,t.visited=e.visited,t.numberOfCommands=e.numberOfCommands,t.selected=e.selected,t.numberOfAttemptedRequests=e.numberOfAttemptedRequests,t.numberOfPendingRequests=e.numberOfPendingRequests,t.numberOfTilesProcessing=e.numberOfTilesProcessing,t.numberOfTilesWithContentReady=e.numberOfTilesWithContentReady,t.numberOfTilesTotal=e.numberOfTilesTotal,t.numberOfFeaturesSelected=e.numberOfFeaturesSelected,t.numberOfFeaturesLoaded=e.numberOfFeaturesLoaded,t.numberOfPointsSelected=e.numberOfPointsSelected,t.numberOfPointsLoaded=e.numberOfPointsLoaded,t.numberOfTrianglesSelected=e.numberOfTrianglesSelected,t.numberOfTilesStyled=e.numberOfTilesStyled,t.numberOfFeaturesStyled=e.numberOfFeaturesStyled,t.numberOfTilesCulledWithChildrenUnion=e.numberOfTilesCulledWithChildrenUnion,t.geometryByteLength=e.geometryByteLength,t.texturesByteLength=e.texturesByteLength,t.batchTableByteLength=e.batchTableByteLength};var Bg=XA;function dv(){this._style=void 0,this._styleDirty=!1,this._lastStyleTime=0}Object.defineProperties(dv.prototype,{style:{get:function(){return this._style},set:function(e){e!==this._style&&(this._style=e,this._styleDirty=!0)}}}),dv.prototype.makeDirty=function(){this._styleDirty=!0},dv.prototype.resetDirty=function(){this._styleDirty=!1},dv.prototype.applyStyle=function(e){if(!u(e.root)||u(this._style)&&!this._style._ready)return;let t=this._styleDirty;t&&++this._lastStyleTime;let i=this._lastStyleTime,n=e._statistics,r=t?e._selectedTiles:e._selectedTilesToStyle,o=r.length;for(let e=0;e<o;++e){let t=r[e];if(t.lastStyleTime!==i){let e=t.content;t.lastStyleTime=i,e.applyStyle(this._style),n.numberOfFeaturesStyled+=e.featuresLength,++n.numberOfTilesStyled}}};var GB=dv;function mYe(e,t,i){let n=ii(t,"3DTILES_implicit_tiling")?t.extensions["3DTILES_implicit_tiling"]:t.implicitTiling;this.baseResource=e,this.geometricError=t.geometricError,this.metadataSchema=i;let r=t.boundingVolume;if(!(u(r.box)||u(r.region)||ii(r,"3DTILES_bounding_volume_S2")||ii(r,"3DTILES_bounding_volume_cylinder")))throw new ue("Only box, region, 3DTILES_bounding_volume_S2, and 3DTILES_bounding_volume_cylinder are supported for implicit tiling");this.boundingVolume=r,this.refine=t.refine,this.subtreeUriTemplate=new ve({url:n.subtrees.uri}),this.contentUriTemplates=[],this.contentHeaders=[];let o=pYe(t);for(let e=0;e<o.length;e++){let t=o[e];this.contentHeaders.push(Ge(t,!0));let i=new ve({url:t.uri});this.contentUriTemplates.push(i)}this.contentCount=this.contentHeaders.length,this.tileHeader=_Ye(t),this.subdivisionScheme=Gr[n.subdivisionScheme],this.branchingFactor=Gr.getBranchingFactor(this.subdivisionScheme),this.subtreeLevels=n.subtreeLevels,u(n.availableLevels)?this.availableLevels=n.availableLevels:this.availableLevels=n.maximumLevel+1}function pYe(e){if(ii(e,"3DTILES_multiple_contents")){let t=e.extensions["3DTILES_multiple_contents"];return u(t.contents)?t.contents:t.content}return u(e.contents)?e.contents:u(e.content)?[e.content]:[]}function _Ye(e){let t=Ge(e,!0);return u(t.extensions)&&(delete t.extensions["3DTILES_implicit_tiling"],delete t.extensions["3DTILES_multiple_contents"],0===Object.keys(t.extensions).length&&delete t.extensions),delete t.implicitTiling,delete t.contents,delete t.content,t}var KA=mYe;function Po(e){this.subdivisionScheme=e.subdivisionScheme,this.subtreeLevels=e.subtreeLevels,this.level=e.level,this.x=e.x,this.y=e.y,this.z=void 0,e.subdivisionScheme===Gr.OCTREE&&(this.z=e.z)}Object.defineProperties(Po.prototype,{childIndex:{get:function(){let e=0;return e|=1&this.x,e|=(1&this.y)<<1,this.subdivisionScheme===Gr.OCTREE&&(e|=(1&this.z)<<2),e}},mortonIndex:{get:function(){return this.subdivisionScheme===Gr.OCTREE?b0.encode3D(this.x,this.y,this.z):b0.encode2D(this.x,this.y)}},tileIndex:{get:function(){return(this.subdivisionScheme===Gr.OCTREE?((1<<3*this.level)-1)/7:((1<<2*this.level)-1)/3)+this.mortonIndex}}}),Po.prototype.getDescendantCoordinates=function(e){let t=this.level+e.level,i=(this.x<<e.level)+e.x,n=(this.y<<e.level)+e.y;if(this.subdivisionScheme===Gr.OCTREE){let r=(this.z<<e.level)+e.z;return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:n,z:r})}return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:n})},Po.prototype.getAncestorCoordinates=function(e){let t=1<<e,i=this.level-e,n=Math.floor(this.x/t),r=Math.floor(this.y/t);if(this.subdivisionScheme===Gr.OCTREE){let e=Math.floor(this.z/t);return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:i,x:n,y:r,z:e})}return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:i,x:n,y:r})},Po.prototype.getOffsetCoordinates=function(e){let t=e.level-this.level,i=1<<t,n=e.x%i,r=e.y%i;if(this.subdivisionScheme===Gr.OCTREE){let o=e.z%i;return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:r,z:o})}return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:n,y:r})},Po.prototype.getChildCoordinates=function(e){let t=this.level+1,i=2*this.x+e%2,n=2*this.y+Math.floor(e/2)%2;if(this.subdivisionScheme===Gr.OCTREE){let r=2*this.z+Math.floor(e/4)%2;return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:n,z:r})}return new Po({subdivisionScheme:this.subdivisionScheme,subtreeLevels:this.subtreeLevels,level:t,x:i,y:n})},Po.prototype.getSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels)},Po.prototype.getParentSubtreeCoordinates=function(){return this.getAncestorCoordinates(this.level%this.subtreeLevels+this.subtreeLevels)},Po.prototype.isAncestor=function(e){let t=e.level-this.level;if(t<=0)return!1;let i=e.x>>t,n=e.y>>t,r=this.x===i,o=this.y===n;if(this.subdivisionScheme===Gr.OCTREE){let i=e.z>>t,n=this.z===i;return r&&o&&n}return r&&o},Po.prototype.isEqual=function(e){return this.subdivisionScheme===e.subdivisionScheme&&this.subtreeLevels===e.subtreeLevels&&this.level===e.level&&this.x===e.x&&this.y===e.y&&(this.subdivisionScheme!==Gr.OCTREE||this.z===e.z)},Po.prototype.isImplicitTilesetRoot=function(){return 0===this.level},Po.prototype.isSubtreeRoot=function(){return this.level%this.subtreeLevels==0},Po.prototype.isBottomOfSubtree=function(){return this.level%this.subtreeLevels==this.subtreeLevels-1},Po.prototype.getTemplateValues=function(){let e={level:this.level,x:this.x,y:this.y};return this.subdivisionScheme===Gr.OCTREE&&(e.z=this.z),e};var Ble=[0,0,0];Po.fromMortonIndex=function(e,t,i,n){let r;return e===Gr.OCTREE?(r=b0.decode3D(n,Ble),new Po({subdivisionScheme:e,subtreeLevels:t,level:i,x:r[0],y:r[1],z:r[2]})):(r=b0.decode2D(n,Ble),new Po({subdivisionScheme:e,subtreeLevels:t,level:i,x:r[0],y:r[1]}))},Po.fromTileIndex=function(e,t,i){let n,r,o;return e===Gr.OCTREE?(n=Math.floor(P.log2(7*i+1)/3),r=((1<<3*n)-1)/7,o=i-r):(n=Math.floor(P.log2(3*i+1)/2),r=((1<<2*n)-1)/3,o=i-r),Po.fromMortonIndex(e,t,n,o)};var ZA=Po;function Lp(){}function gYe(e,t){let{tileset:i}=e;if(!i._cullRequestsWhileMoving)return!0;let{positionWCDeltaMagnitude:n,positionWCDeltaMagnitudeLastFrame:r}=t.camera,o=0!==n?n:r,a=Math.max(2*e.boundingSphere.radius,1);return i.cullRequestsWhileMovingMultiplier*o/a<1}function kle(e,t){if(e.updateVisibility(t),!e.isVisible)return;let i=e.children.length>0;if((e.hasTilesetContent||e.hasImplicitContent)&&i){let i=e.children[0];return kle(i,t),void(e._visible=i._visible)}if(yYe(e,t))return void(e._visible=!1);let n=e.refine===Uo.REPLACE,r=e._optimChildrenWithinParent===dd.USE_OPTIMIZATION;return n&&r&&i&&!xYe(e,t)?(++e.tileset._statistics.numberOfTilesCulledWithChildrenUnion,void(e._visible=!1)):void 0}function yYe(e,t){let{parent:i,tileset:n}=e;return!(!u(i)||i.hasTilesetContent||i.hasImplicitContent||i.refine!==Uo.ADD)&&e.getScreenSpaceError(t,!0)<=n.memoryAdjustedScreenSpaceError}function xYe(e,t){let i=!1,n=e.children;for(let e=0;e<n.length;++e){let r=n[e];r.updateVisibility(t),i=i||r.isVisible}return i}function bYe(e){let t=e.tileset._minimumPriority,i=e.tileset._maximumPriority,n=e._priorityHolder;i.distance=Math.max(n._distanceToCamera,i.distance),t.distance=Math.min(n._distanceToCamera,t.distance),i.depth=Math.max(e._depth,i.depth),t.depth=Math.min(e._depth,t.depth),i.foveatedFactor=Math.max(n._foveatedFactor,i.foveatedFactor),t.foveatedFactor=Math.min(n._foveatedFactor,t.foveatedFactor),i.reverseScreenSpaceError=Math.max(e._priorityReverseScreenSpaceError,i.reverseScreenSpaceError),t.reverseScreenSpaceError=Math.min(e._priorityReverseScreenSpaceError,t.reverseScreenSpaceError)}Lp.selectTiles=function(e,t){de.throwInstantiationError()},Lp.sortChildrenByDistanceToCamera=function(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera},Lp.canTraverse=function(e){return 0!==e.children.length&&(e.hasTilesetContent||e.hasImplicitContent?!e.contentExpired:e._screenSpaceError>e.tileset.memoryAdjustedScreenSpaceError)},Lp.selectTile=function(e,t){if(e.contentVisibility(t)===Zt.OUTSIDE)return;let{content:i,tileset:n}=e;i.featurePropertiesDirty?(i.featurePropertiesDirty=!1,e.lastStyleTime=0,n._selectedTilesToStyle.push(e)):e._selectedFrame<t.frameNumber-1&&n._selectedTilesToStyle.push(e),e._selectedFrame=t.frameNumber,n._selectedTiles.push(e)},Lp.visitTile=function(e,t){++e.tileset._statistics.visited,e._visitedFrame=t.frameNumber},Lp.touchTile=function(e,t){e._touchedFrame!==t.frameNumber&&(e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber)},Lp.loadTile=function(e,t){let{tileset:i}=e;if(e._requestedFrame===t.frameNumber||!e.hasUnloadedRenderableContent&&!e.contentExpired||!gYe(e,t))return;let n=t.camera.timeSinceMoved<i.foveatedTimeDelay;e.priorityDeferred&&n||(e._requestedFrame=t.frameNumber,i._requestedTiles.push(e))},Lp.updateTile=function(e,t){kle(e,t),e.updateExpiration(),e._wasMinPriorityChild=!1,e._priorityHolder=e,bYe(e),e._shouldSelect=!1,e._finalResolution=!0};var zs=Lp;function Vle(){}var hv={stack:new Jc,stackMaximumLength:0};function TYe(e){return 0!==e.children.length&&(e.hasTilesetContent||e.hasImplicitContent?!e.contentExpired:(e.hasEmptyContent,!0))}function AYe(e,t,i){let{children:n}=e;for(let e=0;e<n.length;++e){let r=n[e];r.updateVisibility(i),r.isVisible&&t.push(r)}}function CYe(e,t){(t.hasUnloadedRenderableContent||t.contentExpired)&&(t._priority=0,e._requestedTiles.push(t))}function EYe(e,t){e.contentAvailable&&e.contentVisibility(t)!==Zt.OUTSIDE&&e.tileset._selectedTiles.push(e)}Vle.selectTiles=function(e,t){e._selectedTiles.length=0,e._requestedTiles.length=0,e.hasMixedContent=!1;let i=!0,n=e.root;if(n.updateVisibility(t),!n.isVisible)return i;let{touchTile:r,visitTile:o}=zs,a=hv.stack;for(a.push(n);a.length>0;){hv.stackMaximumLength=Math.max(hv.stackMaximumLength,a.length);let n=a.pop(),s=n.refine===Uo.ADD,l=n.refine===Uo.REPLACE,u=TYe(n);u&&AYe(n,a,t),(s||l&&!u)&&(CYe(e,n),r(n,t),EYe(n,t),n.hasRenderableContent&&!n.contentAvailable&&(i=!1)),o(n,t)}return hv.stack.trim(hv.stackMaximumLength),i};var WB=Vle;function Ule(){}var mv={stack:new Jc,stackMaximumLength:0},pv={stack:new Jc,stackMaximumLength:0};function PW(e,t){e.contentAvailable&&zs.selectTile(e,t)}function SYe(e,t,i){let n=e.refine===Uo.REPLACE,{tileset:r,children:o}=e,{updateTile:a,loadTile:s,touchTile:l}=zs;for(let e=0;e<o.length;++e)a(o[e],i);o.sort(zs.sortChildrenByDistanceToCamera);let u=n&&e.hasRenderableContent,c=!0,h=!1,d=-1,p=Number.MAX_VALUE;for(let e=0;e<o.length;++e){let n=o[e];if(n.isVisible?(t.push(n),n._foveatedFactor<p&&(d=e,p=n._foveatedFactor),h=!0):(u||r.loadSiblings)&&(n._foveatedFactor<p&&(d=e,p=n._foveatedFactor),s(n,i),l(n,i)),u){let e;e=!!n._inRequestVolume&&(n.hasRenderableContent?n.contentAvailable:vYe(n,i)),c=c&&e}}if(h||(c=!1),-1!==d&&n){let t=o[d];t._wasMinPriorityChild=!0;let i=(e._wasMinPriorityChild||e===r.root)&&p<=e._priorityHolder._foveatedFactor?e._priorityHolder:e;i._foveatedFactor=Math.min(t._foveatedFactor,i._foveatedFactor),i._distanceToCamera=Math.min(t._distanceToCamera,i._distanceToCamera);for(let e=0;e<o.length;++e)o[e]._priorityHolder=i}return c}function wYe(e,t){let{tileset:i}=e,{canTraverse:n,loadTile:r,visitTile:o,touchTile:a}=zs,s=mv.stack;for(s.push(e);s.length>0;){mv.stackMaximumLength=Math.max(mv.stackMaximumLength,s.length);let e=s.pop(),l=e.parent,c=!u(l)||l._refines;e._refines=!!n(e)&&(SYe(e,s,t)&&c);let h=!e._refines&&c;e.hasRenderableContent?e.refine===Uo.ADD?(PW(e,t),r(e,t)):e.refine===Uo.REPLACE&&(r(e,t),h&&PW(e,t)):(i._emptyTiles.push(e),r(e,t),h&&PW(e,t)),o(e,t),a(e,t)}}function vYe(e,t){let{canTraverse:i,updateTile:n,loadTile:r,touchTile:o}=zs,a=!0,s=pv.stack;for(s.push(e);s.length>0;){pv.stackMaximumLength=Math.max(pv.stackMaximumLength,s.length);let e=s.pop(),l=e.children,u=l.length,c=!e.hasRenderableContent&&i(e),h=!e.hasRenderableContent&&0===e.children.length;if(!c&&!e.contentAvailable&&!h&&(a=!1),n(e,t),e.isVisible||(r(e,t),o(e,t)),c)for(let e=0;e<u;++e){let t=l[e];s.push(t)}}return a}Ule.selectTiles=function(e,t){if(e._requestedTiles.length=0,e.debugFreezeFrame)return;e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e.hasMixedContent=!1;let i=e.root;if(zs.updateTile(i,t),!i.isVisible||i.getScreenSpaceError(t,!0)<=e.memoryAdjustedScreenSpaceError)return;wYe(i,t),mv.stack.trim(mv.stackMaximumLength),pv.stack.trim(pv.stackMaximumLength);let n=e._requestedTiles;for(let e=0;e<n.length;++e)n[e].updatePriority()};var jB=Ule;function zle(){}var _v={stack:new Jc,stackMaximumLength:0},gv={stack:new Jc,stackMaximumLength:0},Np={stack:new Jc,stackMaximumLength:0,ancestorStack:new Jc,ancestorStackMaximumLength:0},DYe=2;function IYe(e,t){let{updateTile:i,touchTile:n,selectTile:r}=zs,o=gv.stack;for(o.push(e);o.length>0;){gv.stackMaximumLength=Math.max(gv.stackMaximumLength,o.length);let a=o.pop().children;for(let s=0;s<a.length;++s){let l=a[s];l.isVisible&&(l.contentAvailable?(i(l,t),n(l,t),r(l,t)):l._depth-e._depth<DYe&&o.push(l))}}}function qB(e,t){let i=e.contentAvailable?e:e._ancestorWithContentAvailable;u(i)?i._shouldSelect=!0:IYe(e,t)}function PYe(e,t){e._ancestorWithContent=void 0,e._ancestorWithContentAvailable=void 0;let{parent:i}=e;if(!u(i))return;let n=!i.hasUnloadedRenderableContent||i._requestedFrame===t.frameNumber;e._ancestorWithContent=n?i:i._ancestorWithContent,e._ancestorWithContentAvailable=i.contentAvailable?i:i._ancestorWithContentAvailable}function OYe(e,t){let i=t._ancestorWithContent;return!e.immediatelyLoadDesiredLevelOfDetail&&(t._priorityProgressiveResolutionScreenSpaceErrorLeaf||u(i)&&t._screenSpaceError<i._screenSpaceError/e.skipScreenSpaceErrorFactor&&t._depth>i._depth+e.skipLevels)}function RYe(e,t,i){let{tileset:n,children:r}=e,{updateTile:o,loadTile:a,touchTile:s}=zs;for(let e=0;e<r.length;++e)o(r[e],i);r.sort(zs.sortChildrenByDistanceToCamera);let l=!1;for(let e=0;e<r.length;++e){let o=r[e];o.isVisible?(t.push(o),l=!0):n.loadSiblings&&(a(o,i),s(o,i))}return l}function MYe(e,t){let{tileset:i}=e;return!i.immediatelyLoadDesiredLevelOfDetail&&(!u(e._ancestorWithContent)||(0===e._screenSpaceError?e.parent._screenSpaceError>t:e._screenSpaceError>t))}function LYe(e,t){let{tileset:i}=e,n=i.immediatelyLoadDesiredLevelOfDetail?Number.MAX_VALUE:Math.max(i.baseScreenSpaceError,i.memoryAdjustedScreenSpaceError),{canTraverse:r,loadTile:o,visitTile:a,touchTile:s}=zs,l=_v.stack;for(l.push(e);l.length>0;){_v.stackMaximumLength=Math.max(_v.stackMaximumLength,l.length);let e=l.pop();PYe(e,t);let c=e.parent,h=!u(c)||c._refines;e._refines=!!r(e)&&(RYe(e,l,t)&&h);let d=!e._refines&&h;e.hasRenderableContent?e.refine===Uo.ADD?(qB(e,t),o(e,t)):e.refine===Uo.REPLACE&&(MYe(e,n)?(o(e,t),d&&qB(e,t)):d?(qB(e,t),o(e,t)):OYe(i,e)&&o(e,t)):(i._emptyTiles.push(e),o(e,t),d&&qB(e,t)),a(e,t),s(e,t)}}function NYe(e,t){let i,{selectTile:n,canTraverse:r}=zs,{stack:o,ancestorStack:a}=Np;for(o.push(e);o.length>0||a.length>0;){if(Np.stackMaximumLength=Math.max(Np.stackMaximumLength,o.length),Np.ancestorStackMaximumLength=Math.max(Np.ancestorStackMaximumLength,a.length),a.length>0){let e=a.peek();if(e._stackLength===o.length){a.pop(),e!==i&&(e._finalResolution=!1),n(e,t);continue}}let e=o.pop();if(!u(e))continue;let s=r(e);if(e._shouldSelect)if(e.refine===Uo.ADD)n(e,t);else{if(e._selectionDepth=a.length,e._selectionDepth>0&&(e.tileset.hasMixedContent=!0),i=e,!s){n(e,t);continue}a.push(e),e._stackLength=o.length}if(s){let t=e.children;for(let e=0;e<t.length;++e){let i=t[e];i.isVisible&&o.push(i)}}}}zle.selectTiles=function(e,t){if(e._requestedTiles.length=0,e.debugFreezeFrame)return;e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e.hasMixedContent=!1;let i=e.root;if(zs.updateTile(i,t),!i.isVisible||i.getScreenSpaceError(t,!0)<=e.memoryAdjustedScreenSpaceError)return;LYe(i,t),NYe(i,t),_v.stack.trim(_v.stackMaximumLength),gv.stack.trim(gv.stackMaximumLength),Np.stack.trim(Np.stackMaximumLength),Np.ancestorStack.trim(Np.ancestorStackMaximumLength);let n=e._requestedTiles;for(let e=0;e<n.length;++e)n[e].updatePriority()};var YB=zle;function Tr(e){e=y(e,y.EMPTY_OBJECT),this._url=void 0,this._basePath=void 0,this._root=void 0,this._resource=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._scaledGeometricError=void 0,this._extensionsUsed=void 0,this._extensions=void 0,this._modelUpAxis=void 0,this._modelForwardAxis=void 0,this._cache=new VB,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._updatedModelMatrixFrame=0,this._modelMatrixChanged=!1,this._previousModelMatrix=void 0,this._extras=void 0,this._credits=void 0,this._showCreditsOnScreen=y(e.showCreditsOnScreen,!1),this._cullWithChildrenBounds=y(e.cullWithChildrenBounds,!0),this._allTilesAdditive=!0,this._hasMixedContent=!1,this._stencilClearCommand=void 0,this._backfaceCommands=new Jc,this._maximumScreenSpaceError=y(e.maximumScreenSpaceError,16),this._memoryAdjustedScreenSpaceError=this._maximumScreenSpaceError,this._cacheBytes=y(e.cacheBytes,536870912);let t=y(e.maximumCacheOverflowBytes,536870912);this._maximumCacheOverflowBytes=t,this._styleEngine=new GB,this._styleApplied=!1,this._modelMatrix=u(e.modelMatrix)?L.clone(e.modelMatrix):L.clone(L.IDENTITY),this._statistics=new Bg,this._statisticsLast=new Bg,this._statisticsPerPass=new Array(Io.NUMBER_OF_PASSES);for(let e=0;e<Io.NUMBER_OF_PASSES;++e)this._statisticsPerPass[e]=new Bg;this._requestedTilesInFlight=[],this._maximumPriority={foveatedFactor:-Number.MAX_VALUE,depth:-Number.MAX_VALUE,distance:-Number.MAX_VALUE,reverseScreenSpaceError:-Number.MAX_VALUE},this._minimumPriority={foveatedFactor:Number.MAX_VALUE,depth:Number.MAX_VALUE,distance:Number.MAX_VALUE,reverseScreenSpaceError:Number.MAX_VALUE},this._heatmap=new zB(e.debugHeatmapTilePropertyName),this.cullRequestsWhileMoving=y(e.cullRequestsWhileMoving,!0),this._cullRequestsWhileMoving=!1,this.cullRequestsWhileMovingMultiplier=y(e.cullRequestsWhileMovingMultiplier,60),this.progressiveResolutionHeightFraction=P.clamp(y(e.progressiveResolutionHeightFraction,.3),0,.5),this.preferLeaves=y(e.preferLeaves,!1),this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._classificationType=e.classificationType,this._ellipsoid=y(e.ellipsoid,ie.WGS84),this._initialClippingPlanesOriginMatrix=L.IDENTITY,this._clippingPlanesOriginMatrix=void 0,this._clippingPlanesOriginMatrixDirty=!0,this._vectorClassificationOnly=y(e.vectorClassificationOnly,!1),this._vectorKeepDecodedPositions=y(e.vectorKeepDecodedPositions,!1),this.preloadWhenHidden=y(e.preloadWhenHidden,!1),this.preloadFlightDestinations=y(e.preloadFlightDestinations,!0),this._pass=void 0,this.dynamicScreenSpaceError=y(e.dynamicScreenSpaceError,!1),this.foveatedScreenSpaceError=y(e.foveatedScreenSpaceError,!0),this._foveatedConeSize=y(e.foveatedConeSize,.1),this._foveatedMinimumScreenSpaceErrorRelaxation=y(e.foveatedMinimumScreenSpaceErrorRelaxation,0),this.foveatedInterpolationCallback=y(e.foveatedInterpolationCallback,P.lerp),this.foveatedTimeDelay=y(e.foveatedTimeDelay,.2),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorFactor=4,this.dynamicScreenSpaceErrorHeightFalloff=.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=y(e.shadows,yn.ENABLED),this.show=y(e.show,!0),this.colorBlendMode=Vl.HIGHLIGHT,this.colorBlendAmount=.5,this._pointCloudShading=new dp(e.pointCloudShading),this._pointCloudEyeDomeLighting=new Ag,this.loadProgress=new pe,this.allTilesLoaded=new pe,this.initialTilesLoaded=new pe,this.tileLoad=new pe,this.tileUnload=new pe,this.tileFailed=new pe,this.tileVisible=new pe,this.skipLevelOfDetail=y(e.skipLevelOfDetail,!1),this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=y(e.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=y(e.skipScreenSpaceErrorFactor,16),this.skipLevels=y(e.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=y(e.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=y(e.loadSiblings,!1),this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,u(e.imageBasedLighting)?(this._imageBasedLighting=e.imageBasedLighting,this._shouldDestroyImageBasedLighting=!1):(this._imageBasedLighting=new CA,this._shouldDestroyImageBasedLighting=!0),this.lightColor=e.lightColor,this.backFaceCulling=y(e.backFaceCulling,!0),this._enableShowOutline=y(e.enableShowOutline,!0),this.showOutline=y(e.showOutline,!0),this.outlineColor=y(e.outlineColor,z.BLACK),this.splitDirection=y(e.splitDirection,al.NONE),this._projectTo2D=y(e.projectTo2D,!1),this.debugFreezeFrame=y(e.debugFreezeFrame,!1),this.debugColorizeTiles=y(e.debugColorizeTiles,!1),this._enableDebugWireframe=y(e.enableDebugWireframe,!1),this.debugWireframe=y(e.debugWireframe,!1),!0===this.debugWireframe&&!1===this._enableDebugWireframe&&It("tileset-debug-wireframe-ignored","enableDebugWireframe must be set to true in the Cesium3DTileset constructor, otherwise debugWireframe will be ignored."),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=y(e.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=y(e.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=y(e.debugShowGeometricError,!1),this.debugShowRenderingStatistics=y(e.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=y(e.debugShowMemoryUsage,!1),this.debugShowUrl=y(e.debugShowUrl,!1),this.examineVectorLinesFunction=void 0,this._metadataExtension=void 0,this._customShader=e.customShader;let i=y(e.featureIdLabel,"featureId_0");"number"==typeof i&&(i=`featureId_${i}`),this._featureIdLabel=i;let n=y(e.instanceFeatureIdLabel,"instanceFeatureId_0");"number"==typeof n&&(n=`instanceFeatureId_${n}`),this._instanceFeatureIdLabel=n}function Hle(e,t,i,n){if(!u(i.implicitTiling)&&!ii(i,"3DTILES_implicit_tiling"))return new _d(e,t,i,n);let r=e.schema,o=new KA(t,i,r),a=new ZA({subdivisionScheme:o.subdivisionScheme,subtreeLevels:o.subtreeLevels,level:0,x:0,y:0,z:0}),s=o.subtreeUriTemplate.getDerivedResource({templateValues:a.getTemplateValues()}).url,l=Ge(i,!0);l.contents=[{uri:s}],delete l.content,delete l.extensions;let c=new _d(e,t,l,n);return c.implicitTileset=o,c.implicitCoordinates=a,c}async function FYe(e,t){let i,n=ii(t,"3DTILES_metadata")?t.extensions["3DTILES_metadata"]:t;if(u(n.schemaUri))e=e.getDerivedResource({url:n.schemaUri}),i=Gi.getSchemaLoader({resource:e});else{if(!u(n.schema))return;i=Gi.getSchemaLoader({schema:n.schema})}await i.load();let r=new YA({schema:i.schema,metadataJson:n});return Gi.unload(i),r}Object.defineProperties(Tr.prototype,{isCesium3DTileset:{get:function(){return!0}},asset:{get:function(){return this._asset}},extensions:{get:function(){return this._extensions}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){ys.setOwner(e,this,"_clippingPlanes")}},properties:{get:function(){return this._properties}},tilesLoaded:{get:function(){return this._tilesLoaded}},resource:{get:function(){return this._resource}},basePath:{get:function(){return is("Cesium3DTileset.basePath","Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},customShader:{get:function(){return this._customShader},set:function(e){this._customShader=e}},hasMixedContent:{get:function(){return this._hasMixedContent},set:function(e){this._hasMixedContent=e}},isSkippingLevelOfDetail:{get:function(){return this.skipLevelOfDetail&&!u(this._classificationType)&&!this._disableSkipLevelOfDetail&&!this._allTilesAdditive}},metadataExtension:{get:function(){return this._metadataExtension}},metadata:{get:function(){if(u(this._metadataExtension))return this._metadataExtension.tileset}},schema:{get:function(){if(u(this._metadataExtension))return this._metadataExtension.schema}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){this._maximumScreenSpaceError=e,this._memoryAdjustedScreenSpaceError=e}},cacheBytes:{get:function(){return this._cacheBytes},set:function(e){this._cacheBytes=e}},maximumCacheOverflowBytes:{get:function(){return this._maximumCacheOverflowBytes},set:function(e){this._maximumCacheOverflowBytes=e}},memoryAdjustedScreenSpaceError:{get:function(){return this._memoryAdjustedScreenSpaceError}},pointCloudShading:{get:function(){return this._pointCloudShading},set:function(e){this._pointCloudShading=e}},root:{get:function(){return this._root}},boundingSphere:{get:function(){return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=L.clone(e,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){let e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},clippingPlanesOriginMatrix:{get:function(){return u(this._clippingPlanesOriginMatrix)?(this._clippingPlanesOriginMatrixDirty&&(L.multiply(this.root.computedTransform,this._initialClippingPlanesOriginMatrix,this._clippingPlanesOriginMatrix),this._clippingPlanesOriginMatrixDirty=!1),this._clippingPlanesOriginMatrix):L.IDENTITY}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}},foveatedConeSize:{get:function(){return this._foveatedConeSize},set:function(e){this._foveatedConeSize=e}},foveatedMinimumScreenSpaceErrorRelaxation:{get:function(){return this._foveatedMinimumScreenSpaceErrorRelaxation},set:function(e){this._foveatedMinimumScreenSpaceErrorRelaxation=e}},extras:{get:function(){return this._extras}},imageBasedLighting:{get:function(){return this._imageBasedLighting},set:function(e){e!==this._imageBasedLighting&&(this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=e,this._shouldDestroyImageBasedLighting=!1)}},vectorClassificationOnly:{get:function(){return this._vectorClassificationOnly}},vectorKeepDecodedPositions:{get:function(){return this._vectorKeepDecodedPositions}},showCreditsOnScreen:{get:function(){return this._showCreditsOnScreen},set:function(e){this._showCreditsOnScreen=e,Kle(this)}},featureIdLabel:{get:function(){return this._featureIdLabel},set:function(e){"number"==typeof e&&(e=`featureId_${e}`),this._featureIdLabel=e}},instanceFeatureIdLabel:{get:function(){return this._instanceFeatureIdLabel},set:function(e){"number"==typeof e&&(e=`instanceFeatureId_${e}`),this._instanceFeatureIdLabel=e}}}),Tr.fromIonAssetId=async function(e,t){let i=await Iu.fromAssetId(e);return Tr.fromUrl(i,t)},Tr.fromUrl=async function(e,t){t=y(t,y.EMPTY_OBJECT);let i,n=ve.createIfNeeded(e);"json"===n.extension?i=n.getBaseUri(!0):n.isDataUri&&(i="");let r=await Tr.loadJson(n),o=await FYe(n,r),a=new Tr(t);a._resource=n,a._url=n.url,a._basePath=i,a._metadataExtension=o,a._geometricError=r.geometricError,a._scaledGeometricError=r.geometricError;let s=r.asset;a._asset=s,a._extras=r.extras,Kle(a);let l=u(r.asset.gltfUpAxis)?wo.fromName(r.asset.gltfUpAxis):wo.Y,c=y(t.modelUpAxis,l),h=y(t.modelForwardAxis,wo.X);a._properties=r.properties,a._extensionsUsed=r.extensionsUsed,a._extensions=r.extensions,a._modelUpAxis=c,a._modelForwardAxis=h,a._root=a.loadTileset(n,r);let d=a._root.createBoundingVolume(r.root.boundingVolume,L.IDENTITY).boundingSphere.center,p=a._ellipsoid.cartesianToCartographic(d);return u(p)&&p.height>li._defaultMinTerrainHeight&&(a._initialClippingPlanesOriginMatrix=Rt.eastNorthUpToFixedFrame(d)),a._clippingPlanesOriginMatrix=L.clone(a._initialClippingPlanesOriginMatrix),a},Tr.loadJson=function(e){return ve.createIfNeeded(e).fetchJson()},Tr.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()},Tr.prototype.loadTileset=function(e,t,i){let n=t.asset;if(!u(n))throw new ue("Tileset must have an asset property.");if("0.0"!==n.version&&"1.0"!==n.version&&"1.1"!==n.version)throw new ue("The tileset must be 3D Tiles version 0.0, 1.0, or 1.1");u(t.extensionsRequired)&&Tr.checkSupportedExtensions(t.extensionsRequired);let r=this._statistics,o=n.tilesetVersion;u(o)&&(this._basePath+=`?v=${o}`,(e=e.clone()).setQueryParameters({v:o}));let a=Hle(this,e,t.root,i);u(i)&&(i.children.push(a),a._depth=i._depth+1);let s=[];for(s.push(a);s.length>0;){let t=s.pop();++r.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&t.refine===Uo.ADD;let i=t._header.children;if(u(i))for(let n=0;n<i.length;++n){let r=Hle(this,e,i[n],t);t.children.push(r),r._depth=t._depth+1,s.push(r)}this._cullWithChildrenBounds&&BB.checkChildrenWithinParent(t)}return a};var Gle=new h,BYe=new fe,kYe=new L,VYe=new h,UYe=new h,zYe=new h;function HYe(e,t){let i,n,r,o,a,s=t.camera,l=e._root,u=l.contentBoundingVolume;if(u instanceof md)i=h.normalize(s.positionWC,Gle),n=s.directionWC,r=s.positionCartographic.height,o=u.minimumHeight,a=u.maximumHeight;else{let e=L.inverseTransformation(l.computedTransform,kYe),c=t.mapProjection.ellipsoid,d=u.boundingVolume,p=L.multiplyByPoint(e,d.center,VYe);if(h.magnitude(p)>c.minimumRadius){let e=fe.fromCartesian(p,c,BYe);i=h.normalize(s.positionWC,Gle),n=s.directionWC,r=s.positionCartographic.height,o=0,a=2*e.height}else{let t=L.multiplyByPoint(e,s.positionWC,UYe);if(i=h.UNIT_Z,n=L.multiplyByPointAsVector(e,s.directionWC,zYe),n=h.normalize(n,n),r=t.z,u instanceof pd){let e=l._header.boundingVolume.box[11];o=p.z-e,a=p.z+e}else if(u instanceof Ng){let e=d.radius;o=p.z-e,a=p.z+e}}}let c=o+(a-o)*e.dynamicScreenSpaceErrorHeightFalloff,d=a,p=P.clamp((r-c)/(d-c),0,1),f=1-Math.abs(h.dot(n,i));f*=1-p,e._dynamicScreenSpaceErrorComputedDensity=e.dynamicScreenSpaceErrorDensity*f}function GYe(e,t){if(t.hasEmptyContent)return;let{statistics:i}=e,n=t.contentExpired,r=t.requestContent();u(r)&&(r.then((n=>{!u(n)||t.isDestroyed()||e.isDestroyed()||(e._processingQueue.push(t),++i.numberOfTilesProcessing)})).catch((i=>{qle(i,e,t)})),n&&(t.hasTilesetContent||t.hasImplicitContent?JYe(e,t):(i.decrementLoadCounts(t.content),--i.numberOfTilesWithContentReady)),e._requestedTilesInFlight.push(t))}function jle(e,t){return e._priority-t._priority}function WYe(e,t){let i=e._requestedTilesInFlight,n=0;for(let e=0;e<i.length;++e){let r=i[e],o=t.frameNumber-r._touchedFrame>=1;r._contentState===Ho.LOADING?o?(r.cancelRequests(),++n):n>0&&(i[e-n]=r):++n}i.length-=n}function jYe(e){let t=e._requestedTiles;t.sort(jle);for(let i=0;i<t.length;++i)GYe(e,t[i])}function qle(e,t,i){if(t.isDestroyed())return;let n;i.isDestroyed()||(n=i._contentResource.url);let r=u(e.message)?e.message:e.toString();t.tileFailed.numberOfListeners>0?t.tileFailed.raiseEvent({url:n,message:r}):(console.log(`A 3D tile failed to load: ${n}`),console.log(`Error: ${r}`))}function qYe(e){let t=e._processingQueue,i=0;for(let e=0;e<t.length;++e){let n=t[e];n.isDestroyed()||n._contentState!==Ho.PROCESSING?++i:i>0&&(t[e-i]=n)}t.length-=i}function YYe(e,t){qYe(e);let i=e._processingQueue,{cacheBytes:n,maximumCacheOverflowBytes:r,statistics:o}=e,a=n+r,s=!1;for(let n=0;n<i.length;++n){if(e.totalMemoryUsageInBytes>a){s=!0;break}let r=i[n];try{r.process(e,t),r.contentReady&&(--o.numberOfTilesProcessing,e.tileLoad.raiseEvent(r))}catch(t){--o.numberOfTilesProcessing,qle(t,e,r)}}e.totalMemoryUsageInBytes<n?KYe(e):s&&i.length>0&&XYe(e)}function XYe(e){e._memoryAdjustedScreenSpaceError*=1.02;let t=e._processingQueue;for(let e=0;e<t.length;++e)t[e].updatePriority();t.sort(jle)}function KYe(e){e._memoryAdjustedScreenSpaceError=Math.max(e.memoryAdjustedScreenSpaceError/1.02,e.maximumScreenSpaceError)}Tr.prototype.postPassesUpdate=function(e){u(this._root)&&(WYe(this,e),tXe(this,e),this._cache.unloadTiles(this,Xle),this._styleApplied&&this._styleEngine.resetDirty(),this._styleApplied=!1)},Tr.prototype.prePassesUpdate=function(e){if(!u(this._root))return;YYe(this,e);let t=this._clippingPlanes;this._clippingPlanesOriginMatrixDirty=!0,u(t)&&t.enabled&&t.update(e),u(this._loadTimestamp)||(this._loadTimestamp=J.clone(e.time)),this._timeSinceLoad=Math.max(1e3*J.secondsDifference(e.time,this._loadTimestamp),0),this.dynamicScreenSpaceError&&HYe(this,e),e.newFrame&&this._cache.reset()};var XB=new h,ZYe={maximumFractionDigits:3};function Wle(e){let t=e/1048576;return t<1?t.toLocaleString(void 0,ZYe):Math.round(t).toLocaleString()}function OW(e){let{halfAxes:t,radius:i,center:n}=e.boundingVolume.boundingVolume,r=h.clone(n,XB);if(u(t))r.x+=.75*(t[0]+t[3]+t[6]),r.y+=.75*(t[1]+t[4]+t[7]),r.z+=.75*(t[2]+t[5]+t[8]);else if(u(i)){let e=h.normalize(n,XB);e=h.multiplyByScalar(e,.75*i,XB),r=h.add(e,n,XB)}return r}function RW(e,t,i){let n="",r=0;if(t.debugShowGeometricError&&(n+=`\nGeometric error: ${e.geometricError}`,r++),t.debugShowRenderingStatistics&&(n+=`\nCommands: ${e.commandsLength}`,r++,e.content.pointsLength>0&&(n+=`\nPoints: ${e.content.pointsLength}`,r++),e.content.trianglesLength>0&&(n+=`\nTriangles: ${e.content.trianglesLength}`,r++),n+=`\nFeatures: ${e.content.featuresLength}`,r++),t.debugShowMemoryUsage&&(n+=`\nTexture Memory: ${Wle(e.content.texturesByteLength)}`,n+=`\nGeometry Memory: ${Wle(e.content.geometryByteLength)}`,r+=2),t.debugShowUrl)if(e.hasMultipleContents){n+="\nUrls:";let t=e.content.innerContentUrls;for(let e=0;e<t.length;e++)n+=`\n- ${t[e]}`;r+=t.length}else n+=`\nUrl: ${e._contentHeader.uri}`,r++;let o={text:n.substring(1),position:i,font:19-r+"px sans-serif",showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(o)}function $Ye(e,t){let i=e._selectedTiles,n=i.length,r=e._emptyTiles,o=r.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if(u(e.debugPickedTile)){let t=u(e.debugPickPosition)?e.debugPickPosition:OW(e.debugPickedTile);RW(e.debugPickedTile,e,t).pixelOffset=new U(15,-15)}}else{for(let t=0;t<n;++t){let n=i[t];RW(n,e,OW(n))}for(let t=0;t<o;++t){let i=r[t];(i.hasTilesetContent||i.hasImplicitContent)&&RW(i,e,OW(i))}}e._tileDebugLabels.update(t)}function QYe(e,t,i){e._styleEngine.applyStyle(e),e._styleApplied=!0;let{commandList:n,context:r}=t,o=n.length,a=e._selectedTiles,s=e.isSkippingLevelOfDetail&&e._hasMixedContent&&r.stencilBuffer&&a.length>0;e._backfaceCommands.length=0,s&&(u(e._stencilClearCommand)||(e._stencilClearCommand=new ti({stencil:0,pass:Ee.CESIUM_3D_TILE,renderState:Ue.fromCache({stencilMask:Lt.SKIP_LOD_MASK})})),n.push(e._stencilClearCommand));let{statistics:l,tileVisible:c}=e,h=i.isRender,d=n.length;for(let n=0;n<a.length;++n){let r=a[n];h&&c.raiseEvent(r),r.update(e,t,i),l.incrementSelectionCounts(r.content),++l.selected}let p=e._emptyTiles;for(let n=0;n<p.length;++n)p[n].update(e,t,i);let f=n.length-d;if(e._backfaceCommands.trim(),s){let t=e._backfaceCommands.values,i=t.length;n.length+=i;for(let e=f-1;e>=0;--e)n[d+i+e]=n[d+e];for(let e=0;e<i;++e)n[d+e]=t[e]}f=n.length-o,l.numberOfCommands=f,h&&(e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&f>0&&e._pointCloudEyeDomeLighting.update(t,o,e.pointCloudShading,e.boundingSphere),e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?(u(e._tileDebugLabels)||(e._tileDebugLabels=new bp),$Ye(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy())}var Yle=[];function JYe(e,t){let i=t,n=Yle;for(n.push(t);n.length>0;){let r=(t=n.pop()).children;for(let e=0;e<r.length;++e)n.push(r[e]);t!==i&&(eXe(e,t),--e._statistics.numberOfTilesTotal)}i.children=[]}function Xle(e,t){e.tileUnload.raiseEvent(t),e._statistics.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady,t.unloadContent()}function eXe(e,t){e._cache.unloadTile(e,t,Xle),t.destroy()}function tXe(e,t){let i=e._statistics,n=e._statisticsLast,r=i.numberOfPendingRequests,o=i.numberOfTilesProcessing,a=n.numberOfPendingRequests,s=n.numberOfTilesProcessing;Bg.clone(i,n);let l=r!==a||o!==s;l&&t.afterRender.push((function(){return e.loadProgress.raiseEvent(r,o),!0})),e._tilesLoaded=0===i.numberOfPendingRequests&&0===i.numberOfTilesProcessing&&0===i.numberOfAttemptedRequests,l&&e._tilesLoaded&&(t.afterRender.push((function(){return e.allTilesLoaded.raiseEvent(),!0})),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push((function(){return e.initialTilesLoaded.raiseEvent(),!0}))))}function nXe(e){e._heatmap.resetMinimumMaximum(),e._minimumPriority.depth=Number.MAX_VALUE,e._maximumPriority.depth=-Number.MAX_VALUE,e._minimumPriority.foveatedFactor=Number.MAX_VALUE,e._maximumPriority.foveatedFactor=-Number.MAX_VALUE,e._minimumPriority.distance=Number.MAX_VALUE,e._maximumPriority.distance=-Number.MAX_VALUE,e._minimumPriority.reverseScreenSpaceError=Number.MAX_VALUE,e._maximumPriority.reverseScreenSpaceError=-Number.MAX_VALUE}function iXe(e,t){t.frameNumber===e._updatedModelMatrixFrame&&u(e._previousModelMatrix)||(e._updatedModelMatrixFrame=t.frameNumber,e._modelMatrixChanged=!L.equals(e.modelMatrix,e._previousModelMatrix),e._modelMatrixChanged&&(e._previousModelMatrix=L.clone(e.modelMatrix,e._previousModelMatrix)))}function oXe(e,t,i,n){if(t.mode===te.MORPHING||!u(e._root))return!1;let r=e._statistics;r.clear(),++e._updatedVisibilityFrame,nXe(e),iXe(e,t),e._cullRequestsWhileMoving=e.cullRequestsWhileMoving&&!e._modelMatrixChanged;let o=e.getTraversal(n).selectTiles(e,t);if(n.requestTiles&&jYe(e),QYe(e,t,n),Bg.clone(r,i),n.isRender){let i=e._credits;if(u(i)&&0!==r.selected)for(let e=0;e<i.length;++e){let n=i[e];t.creditDisplay.addCreditToNextFrame(n)}}return o}function Kle(e){let t=e._credits;u(t)||(t=[]),t.length=0,u(e.resource.credits)&&e.resource.credits.forEach((e=>{t.push(xt.clone(e))}));let i=e.asset.extras;if(u(i)&&u(i.cesium)&&u(i.cesium.credits)){let e=i.cesium.credits;for(let i=0;i<e.length;++i){let n=e[i];t.push(new xt(n.html))}}t.forEach((t=>t.showOnScreen=t.showOnScreen||e._showCreditsOnScreen)),e._credits=t}Tr.prototype.trimLoadedTiles=function(){this._cache.trim()},Tr.prototype.getTraversal=function(e){let{pass:t}=e;return t===Io.MOST_DETAILED_PRELOAD||t===Io.MOST_DETAILED_PICK?WB:this.isSkippingLevelOfDetail?YB:jB},Tr.prototype.update=function(e){this.updateForPass(e,e.tilesetPassState)},Tr.prototype.updateForPass=function(e,t){let i=t.pass;if(i===Io.PRELOAD&&(!this.preloadWhenHidden||this.show)||i===Io.PRELOAD_FLIGHT&&(!this.preloadFlightDestinations||!this.show&&!this.preloadWhenHidden)||i===Io.REQUEST_RENDER_MODE_DEFER_CHECK&&(!this._cullRequestsWhileMoving&&this.foveatedTimeDelay<=0||!this.show))return;let n=e.commandList,r=e.camera,o=e.cullingVolume;t.ready=!1;let a=Io.getPassOptions(i),s=a.ignoreCommands,l=y(t.commandList,n),u=l.length;e.commandList=l,e.camera=y(t.camera,r),e.cullingVolume=y(t.cullingVolume,o);let c=this._statisticsPerPass[i];(this.show||s)&&(this._pass=i,t.ready=oXe(this,e,c,a)),s&&(l.length=u),e.commandList=n,e.camera=r,e.cullingVolume=o},Tr.prototype.hasExtension=function(e){return!!u(this._extensionsUsed)&&this._extensionsUsed.indexOf(e)>-1},Tr.prototype.isDestroyed=function(){return!1},Tr.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),u(this._root)){let e=Yle;for(e.push(this._root);e.length>0;){let t=e.pop();t.destroy();let i=t.children;for(let t=0;t<i.length;++t)e.push(i[t])}}return this._root=void 0,this._shouldDestroyImageBasedLighting&&!this._imageBasedLighting.isDestroyed()&&this._imageBasedLighting.destroy(),this._imageBasedLighting=void 0,le(this)},Tr.supportedExtensions={"3DTILES_metadata":!0,"3DTILES_implicit_tiling":!0,"3DTILES_content_gltf":!0,"3DTILES_multiple_contents":!0,"3DTILES_bounding_volume_S2":!0,"3DTILES_batch_table_hierarchy":!0,"3DTILES_draco_point_compression":!0,MAXAR_content_geojson:!0},Tr.checkSupportedExtensions=function(e){for(let t=0;t<e.length;t++)if(!Tr.supportedExtensions[e[t]])throw new ue(`Unsupported 3D Tiles Extension: ${e[t]}`)};var ca=Tr;function $A(e,t){this._conditionsExpression=Ge(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,sXe(this,t)}function rXe(e,t){this.condition=e,this.expression=t}function sXe(e,t){let i=[],n=e._conditions;if(!u(n))return;let r=n.length;for(let e=0;e<r;++e){let r=n[e],o=String(r[0]),a=String(r[1]);i.push(new rXe(new Jf(o,t),new Jf(a,t)))}e._runtimeConditions=i}Object.defineProperties($A.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}}),$A.prototype.evaluate=function(e,t){let i=this._runtimeConditions;if(!u(i))return;let n=i.length;for(let r=0;r<n;++r){let n=i[r];if(n.condition.evaluate(e))return n.expression.evaluate(e,t)}},$A.prototype.evaluateColor=function(e,t){let i=this._runtimeConditions;if(!u(i))return;let n=i.length;for(let r=0;r<n;++r){let n=i[r];if(n.condition.evaluate(e))return n.expression.evaluateColor(e,t)}},$A.prototype.getShaderFunction=function(e,t,i,n){let r=this._runtimeConditions;if(!u(r)||0===r.length)return;let o="",a=r.length;for(let e=0;e<a;++e){let n=r[e];o+=`    ${0===e?"if":"else if"} (${n.condition.getShaderExpression(t,i)})\n    {\n        return ${n.expression.getShaderExpression(t,i)};\n    }\n`}return o=`${n} ${e}\n{\n${o}    return ${n}(1.0);\n}\n`,o},$A.prototype.getVariables=function(){let e=[],t=this._runtimeConditions;if(!u(t)||0===t.length)return e;let i=t.length;for(let n=0;n<i;++n){let i=t[n];e.push.apply(e,i.condition.getVariables()),e.push.apply(e,i.expression.getVariables())}return e=e.filter((function(e,t,i){return i.indexOf(e)===t})),e};var KB=$A;function kg(e){this._style={},this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,aXe(this,e)}function aXe(e,t){t=y(Ge(t,!0),e._style),e._style=t,e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;let i={};if(u(t.meta)){let e=t.defines,n=y(t.meta,y.EMPTY_OBJECT);for(let t in n)n.hasOwnProperty(t)&&(i[t]=new Jf(n[t],e))}e._meta=i,e._ready=!0}function Wo(e,t){let i=y(e._style,y.EMPTY_OBJECT).defines;if(u(t))return"boolean"==typeof t||"number"==typeof t?new Jf(String(t)):"string"==typeof t?new Jf(t,i):u(t.conditions)?new KB(t,i):t}function jo(e){if(u(e))return u(e.expression)?e.expression:u(e.conditionsExpression)?Ge(e.conditionsExpression,!0):e}Object.defineProperties(kg.prototype,{style:{get:function(){return this._style}},show:{get:function(){return this._show},set:function(e){this._show=Wo(this,e),this._style.show=jo(this._show),this._showShaderFunctionReady=!1}},color:{get:function(){return this._color},set:function(e){this._color=Wo(this,e),this._style.color=jo(this._color),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=Wo(this,e),this._style.pointSize=jo(this._pointSize),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=Wo(this,e),this._style.pointOutlineColor=jo(this._pointOutlineColor)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=Wo(this,e),this._style.pointOutlineWidth=jo(this._pointOutlineWidth)}},labelColor:{get:function(){return this._labelColor},set:function(e){this._labelColor=Wo(this,e),this._style.labelColor=jo(this._labelColor)}},labelOutlineColor:{get:function(){return this._labelOutlineColor},set:function(e){this._labelOutlineColor=Wo(this,e),this._style.labelOutlineColor=jo(this._labelOutlineColor)}},labelOutlineWidth:{get:function(){return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=Wo(this,e),this._style.labelOutlineWidth=jo(this._labelOutlineWidth)}},font:{get:function(){return this._font},set:function(e){this._font=Wo(this,e),this._style.font=jo(this._font)}},labelStyle:{get:function(){return this._labelStyle},set:function(e){this._labelStyle=Wo(this,e),this._style.labelStyle=jo(this._labelStyle)}},labelText:{get:function(){return this._labelText},set:function(e){this._labelText=Wo(this,e),this._style.labelText=jo(this._labelText)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=Wo(this,e),this._style.backgroundColor=jo(this._backgroundColor)}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){this._backgroundPadding=Wo(this,e),this._style.backgroundPadding=jo(this._backgroundPadding)}},backgroundEnabled:{get:function(){return this._backgroundEnabled},set:function(e){this._backgroundEnabled=Wo(this,e),this._style.backgroundEnabled=jo(this._backgroundEnabled)}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){this._scaleByDistance=Wo(this,e),this._style.scaleByDistance=jo(this._scaleByDistance)}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){this._translucencyByDistance=Wo(this,e),this._style.translucencyByDistance=jo(this._translucencyByDistance)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=Wo(this,e),this._style.distanceDisplayCondition=jo(this._distanceDisplayCondition)}},heightOffset:{get:function(){return this._heightOffset},set:function(e){this._heightOffset=Wo(this,e),this._style.heightOffset=jo(this._heightOffset)}},anchorLineEnabled:{get:function(){return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=Wo(this,e),this._style.anchorLineEnabled=jo(this._anchorLineEnabled)}},anchorLineColor:{get:function(){return this._anchorLineColor},set:function(e){this._anchorLineColor=Wo(this,e),this._style.anchorLineColor=jo(this._anchorLineColor)}},image:{get:function(){return this._image},set:function(e){this._image=Wo(this,e),this._style.image=jo(this._image)}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=Wo(this,e),this._style.disableDepthTestDistance=jo(this._disableDepthTestDistance)}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin=Wo(this,e),this._style.horizontalOrigin=jo(this._horizontalOrigin)}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin=Wo(this,e),this._style.verticalOrigin=jo(this._verticalOrigin)}},labelHorizontalOrigin:{get:function(){return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=Wo(this,e),this._style.labelHorizontalOrigin=jo(this._labelHorizontalOrigin)}},labelVerticalOrigin:{get:function(){return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=Wo(this,e),this._style.labelVerticalOrigin=jo(this._labelVerticalOrigin)}},meta:{get:function(){return this._meta},set:function(e){this._meta=e}}}),kg.fromUrl=function(e){return ve.createIfNeeded(e).fetchJson(e).then((function(e){return new kg(e)}))},kg.prototype.getColorShaderFunction=function(e,t,i){return this._colorShaderFunctionReady?(i.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,u(this.color)&&u(this.color.getShaderFunction)?this._colorShaderFunction=this.color.getShaderFunction(e,t,i,"vec4"):this._colorShaderFunction=void 0,this._colorShaderTranslucent=i.translucent,this._colorShaderFunction)},kg.prototype.getShowShaderFunction=function(e,t,i){return this._showShaderFunctionReady||(this._showShaderFunctionReady=!0,u(this.show)&&u(this.show.getShaderFunction)?this._showShaderFunction=this.show.getShaderFunction(e,t,i,"bool"):this._showShaderFunction=void 0),this._showShaderFunction},kg.prototype.getPointSizeShaderFunction=function(e,t,i){return this._pointSizeShaderFunctionReady||(this._pointSizeShaderFunctionReady=!0,u(this.pointSize)&&u(this.pointSize.getShaderFunction)?this._pointSizeShaderFunction=this.pointSize.getShaderFunction(e,t,i,"float"):this._pointSizeShaderFunction=void 0),this._pointSizeShaderFunction},kg.prototype.getVariables=function(){let e=[];return u(this.color)&&u(this.color.getVariables)&&e.push.apply(e,this.color.getVariables()),u(this.show)&&u(this.show.getVariables)&&e.push.apply(e,this.show.getVariables()),u(this.pointSize)&&u(this.pointSize.getVariables)&&e.push.apply(e,this.pointSize.getVariables()),e=e.filter((function(e,t,i){return i.indexOf(e)===t})),e};var QA=kg;function yv(e){e=y(e,y.EMPTY_OBJECT),this._maximumSubtreeCount=y(e.maximumSubtreeCount,0),this._subtreeRequestCounter=0,this._queue=new pT({comparator:yv.comparator})}function cXe(e,t){this.subtree=e,this.stamp=t}yv.prototype.addSubtree=function(e){let t=new cXe(e,this._subtreeRequestCounter);this._subtreeRequestCounter++,this._queue.insert(t);let i=e.implicitCoordinates;if(i.level>0){let e=i.getParentSubtreeCoordinates();this.find(e)}if(this._maximumSubtreeCount>0)for(;this._queue.length>this._maximumSubtreeCount&&this._queue.getMinimum()!==t;)this._queue.removeMinimum()},yv.prototype.find=function(e){let t=this._queue,i=t.internalArray,n=t.length;for(let t=0;t<n;t++){let n=i[t],r=n.subtree.implicitCoordinates;if(e.isEqual(r))return n.subtree}},yv.comparator=function(e,t){let i=e.subtree.implicitCoordinates,n=t.subtree.implicitCoordinates;return i.isAncestor(n)?1:n.isAncestor(i)?-1:e.stamp-t.stamp};var ZB=yv;function ll(){this.orientedBoundingBox=new Pn,this.boundingSphere=new se,this.boundTransform=new L,this.shapeTransform=new L,this._minBounds=h.clone(ll.DefaultMinBounds,new h),this._maxBounds=h.clone(ll.DefaultMaxBounds,new h),this.shaderUniforms={renderMinBounds:new h,renderMaxBounds:new h,boxUvToShapeUvScale:new h,boxUvToShapeUvTranslate:new h},this.shaderDefines={BOX_INTERSECTION_INDEX:void 0,BOX_HAS_SHAPE_BOUNDS:void 0},this.shaderMaximumIntersectionsLength=0}var lXe=new h,MW=new h,uXe=new $,fXe=new h,dXe=new h,hXe=new h,mXe=new h,Zle=L.fromRotationTranslation($.fromUniformScale(.5,new $),new h(.5,.5,.5),new L);ll.prototype.update=function(e,t,i,n,r){n=y(n,ll.DefaultMinBounds),r=y(r,ll.DefaultMaxBounds);let o=ll.DefaultMinBounds,a=ll.DefaultMaxBounds;t=this._minBounds=h.clamp(t,o,a,this._minBounds),i=this._maxBounds=h.clamp(i,o,a,this._maxBounds),n=h.clamp(n,o,a,fXe),r=h.clamp(r,o,a,dXe);let s=h.clamp(t,n,r,hXe),l=h.clamp(i,n,r,mXe),u=L.getScale(e,MW);if(s.x>l.x||s.y>l.y||s.z>l.z||(s.x===l.x)+(s.y===l.y)+(s.z===l.z)>=2||n.x>r.x||n.y>r.y||n.z>r.z||0===u.x||0===u.y||0===u.z)return!1;this.shapeTransform=L.clone(e,this.shapeTransform),this.orientedBoundingBox=$le(s,l,this.shapeTransform,this.orientedBoundingBox),this.boundTransform=L.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=se.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);let{shaderUniforms:c,shaderDefines:d}=this;for(let e in d)d.hasOwnProperty(e)&&(d[e]=void 0);let p=!h.equals(t,o)||!h.equals(i,a),f=0;if(d.BOX_INTERSECTION_INDEX=f,f+=1,c.renderMinBounds=L.multiplyByPoint(Zle,s,c.renderMinBounds),c.renderMaxBounds=L.multiplyByPoint(Zle,l,c.renderMaxBounds),p){d.BOX_HAS_SHAPE_BOUNDS=!0;let e=t,n=i;c.boxUvToShapeUvScale=h.fromElements(2/(e.x===n.x?1:n.x-e.x),2/(e.y===n.y?1:n.y-e.y),2/(e.z===n.z?1:n.z-e.z),c.boxUvToShapeUvScale),c.boxUvToShapeUvTranslate=h.fromElements(-c.boxUvToShapeUvScale.x*(.5*e.x+.5),-c.boxUvToShapeUvScale.y*(.5*e.y+.5),-c.boxUvToShapeUvScale.z*(.5*e.z+.5),c.boxUvToShapeUvTranslate)}return this.shaderMaximumIntersectionsLength=f,!0};var pXe=new h,_Xe=new h;function $le(e,t,i,n){let r=ll.DefaultMinBounds,o=ll.DefaultMaxBounds;if(h.equals(e,r)&&h.equals(t,o))n.center=L.getTranslation(i,n.center),n.halfAxes=L.getMatrix3(i,n.halfAxes);else{let r=L.getScale(i,MW),o=h.midpoint(e,t,lXe);n.center=L.multiplyByPoint(i,o,n.center),r=h.fromElements(.5*r.x*(t.x-e.x),.5*r.y*(t.y-e.y),.5*r.z*(t.z-e.z),MW);let a=L.getRotation(i,uXe);n.halfAxes=$.setScale(a,r,n.halfAxes)}return n}ll.prototype.computeOrientedBoundingBoxForTile=function(e,t,i,n,r){let o=this._minBounds,a=this._maxBounds,s=1/Math.pow(2,e);return $le(h.fromElements(P.lerp(o.x,a.x,s*t),P.lerp(o.y,a.y,s*i),P.lerp(o.z,a.z,s*n),pXe),h.fromElements(P.lerp(o.x,a.x,s*(t+1)),P.lerp(o.y,a.y,s*(i+1)),P.lerp(o.z,a.z,s*(n+1)),_Xe),this.shapeTransform,r)},ll.prototype.computeApproximateStepSize=function(e){return 1/h.maximumComponent(e)},ll.DefaultMinBounds=Object.freeze(new h(-1,-1,-1)),ll.DefaultMaxBounds=Object.freeze(new h(1,1,1));var Fp=ll;function $B(e){this._resource=e,this._metadataTable=void 0}function gXe(e,t,i){let n=t.buffers.length,r=new Array(n);for(let o=0;o<n;o++){let n=t.buffers[o];if(u(n.uri)){let t=e.getDerivedResource({url:n.uri});r[o]=t.fetchArrayBuffer().then((function(e){return new Uint8Array(e)}))}else r[o]=Promise.resolve(i)}return Promise.all(r)}function yXe(e){let t=new DataView(e.buffer,e.byteOffset),i=8,n=t.getUint32(i,!0);i+=8;let r=t.getUint32(i,!0);i+=8;let o=So(e,i,n);return i+=n,{json:o,binary:e.subarray(i,i+r)}}Object.defineProperties($B.prototype,{metadataTable:{get:function(){return this._metadataTable}}}),$B.fromJson=async function(e,t,i,n){let r;r=u(t)?{json:t,binary:void 0}:yXe(i);let o=await gXe(e,r.json,r.binary),a={},s=r.json.bufferViews.length;for(let e=0;e<s;++e){let t=r.json.bufferViews[e],i=t.byteOffset,n=i+t.byteLength,s=o[t.buffer].subarray(i,n);a[e]=s}let l=r.json.voxelTable,c=r.json.propertyTables[l],h=new $B(e);return h._metadataTable=new zl({count:c.count,properties:c.properties,class:n.classes[c.class],bufferViews:a}),h};var QB=$B;function Lr(){this.orientedBoundingBox=new Pn,this.boundingSphere=new se,this.boundTransform=new L,this.shapeTransform=new L,this._minimumRadius=Lr.DefaultMinBounds.x,this._maximumRadius=Lr.DefaultMaxBounds.x,this._minimumHeight=Lr.DefaultMinBounds.y,this._maximumHeight=Lr.DefaultMaxBounds.y,this._minimumAngle=Lr.DefaultMinBounds.z,this._maximumAngle=Lr.DefaultMaxBounds.z,this.shaderUniforms={cylinderUvToRenderBoundsScale:new h,cylinderUvToRenderBoundsTranslate:new h,cylinderUvToRenderRadiusMin:0,cylinderRenderAngleMinMax:new U,cylinderUvToShapeUvRadius:new U,cylinderUvToShapeUvHeight:new U,cylinderUvToShapeUvAngle:new U,cylinderShapeUvAngleMinMax:new U,cylinderShapeUvAngleRangeZeroMid:0},this.shaderDefines={CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN:void 0,CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MAX:void 0,CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT:void 0,CYLINDER_HAS_RENDER_BOUNDS_HEIGHT:void 0,CYLINDER_HAS_RENDER_BOUNDS_HEIGHT_FLAT:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_HALF:void 0,CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF:void 0,CYLINDER_HAS_SHAPE_BOUNDS_RADIUS:void 0,CYLINDER_HAS_SHAPE_BOUNDS_RADIUS_FLAT:void 0,CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT:void 0,CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT_FLAT:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_RANGE_EQUAL_ZERO:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY:void 0,CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED:void 0,CYLINDER_INTERSECTION_INDEX_RADIUS_MAX:void 0,CYLINDER_INTERSECTION_INDEX_RADIUS_MIN:void 0,CYLINDER_INTERSECTION_INDEX_ANGLE:void 0},this.shaderMaximumIntersectionsLength=0}var Jle=new h,xXe=new h,bXe=new h,TXe=new $,AXe=new L,CXe=new L,EXe=L.fromRotationTranslation($.fromUniformScale(2,new $),new h(-1,-1,-1),new L);Lr.prototype.update=function(e,t,i,n,r){n=y(n,Lr.DefaultMinBounds),r=y(r,Lr.DefaultMaxBounds);let o=Lr.DefaultMinBounds.x,a=Lr.DefaultMaxBounds.x,s=Lr.DefaultMinBounds.y,l=Lr.DefaultMaxBounds.y,u=Lr.DefaultMinBounds.z,c=Lr.DefaultMaxBounds.z,d=c-u,p=.5*d,f=P.EPSILON10,m=P.EPSILON3,_=P.EPSILON10,g=P.clamp(t.x,o,a),v=P.clamp(i.x,o,a),b=P.clamp(n.x,o,a),A=P.clamp(r.x,o,a),T=Math.max(g,b),E=Math.min(v,A),C=P.clamp(t.y,s,l),x=P.clamp(i.y,s,l),S=P.clamp(n.y,s,l),w=P.clamp(r.y,s,l),I=Math.max(C,S),D=Math.min(x,w),O=P.negativePiToPi(t.z),R=P.negativePiToPi(i.z),N=P.negativePiToPi(n.z),M=P.negativePiToPi(r.z),F=Math.max(O,N),B=Math.min(R,M),z=L.getScale(e,Jle);if(0===E||T>E||I>D||P.equalsEpsilon(z.x,0,void 0,f)||P.equalsEpsilon(z.y,0,void 0,f)||P.equalsEpsilon(z.z,0,void 0,f))return!1;this._minimumRadius=g,this._maximumRadius=v,this._minimumHeight=C,this._maximumHeight=x,this._minimumAngle=O,this._maximumAngle=R,this.shapeTransform=L.clone(e,this.shapeTransform),this.orientedBoundingBox=NW(T,E,I,D,F,B,this.shapeTransform,this.orientedBoundingBox),this.boundTransform=L.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=se.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);let k=g===o&&v===a,V=C===s&&x===l,H=R<O,G=R-O+H*d,j=G<=_,W=G>p+_&&G<d-_||G>_&&G<p-_||G>=p-_&&G<=p+_||j,q=P.equalsEpsilon(O,u,void 0,m),Y=P.equalsEpsilon(R,c,void 0,m),X=E===a,K=T===o,J=I===s&&D===l,Q=B-F+(B<F)*d,Z=Q>p+_&&Q<d-_,ee=Q>_&&Q<p-_,te=Q>=p-_&&Q<=p+_,ie=Q<=_,ne=Z||ee||te||ie,re=this.shaderUniforms,oe=this.shaderDefines;for(let e in oe)oe.hasOwnProperty(e)&&(oe[e]=void 0);let ae=0;if(oe.CYLINDER_INTERSECTION_INDEX_RADIUS_MAX=ae,ae+=1,K||(oe.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MIN=!0,oe.CYLINDER_INTERSECTION_INDEX_RADIUS_MIN=ae,ae+=1,re.cylinderUvToRenderRadiusMin=E/T),X||(oe.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_MAX=!0),T===E&&(oe.CYLINDER_HAS_RENDER_BOUNDS_RADIUS_FLAT=!0),J||(oe.CYLINDER_HAS_RENDER_BOUNDS_HEIGHT=!0),I===D&&(oe.CYLINDER_HAS_RENDER_BOUNDS_HEIGHT_FLAT=!0),C===x&&(oe.CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT_FLAT=!0),g===v&&(oe.CYLINDER_HAS_SHAPE_BOUNDS_RADIUS_FLAT=!0),!k){oe.CYLINDER_HAS_SHAPE_BOUNDS_RADIUS=!0;let e=1/(v-g),t=g/(g-v);re.cylinderUvToShapeUvRadius=U.fromElements(e,t,re.cylinderUvToShapeUvRadius)}if(!V){oe.CYLINDER_HAS_SHAPE_BOUNDS_HEIGHT=!0;let e=2/(x-C),t=(C+1)/(C-x);re.cylinderUvToShapeUvHeight=U.fromElements(e,t,re.cylinderUvToShapeUvHeight)}if(!X||!J){let e=.5*(D-I),t=h.fromElements(1/E,1/E,1/(0===e?1:e),bXe),i=h.fromElements(0,0,.5*-t.z*(I+D),xXe),n=L.fromRotationTranslation($.fromScale(t,TXe),i,AXe),r=L.multiplyTransformation(n,EXe,CXe);re.cylinderUvToRenderBoundsScale=L.getScale(r,re.cylinderUvToRenderBoundsScale),re.cylinderUvToRenderBoundsTranslate=L.getTranslation(r,re.cylinderUvToRenderBoundsTranslate)}if(H&&(oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_MAX_REVERSED=!0),ne&&(oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE=!0,oe.CYLINDER_INTERSECTION_INDEX_ANGLE=ae,Z?(oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_UNDER_HALF=!0,ae+=1):ee?(oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_OVER_HALF=!0,ae+=2):te?(oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_HALF=!0,ae+=1):ie&&(oe.CYLINDER_HAS_RENDER_BOUNDS_ANGLE_RANGE_EQUAL_ZERO=!0,ae+=2),re.cylinderRenderAngleMinMax=U.fromElements(F,B,re.cylinderAngleMinMax)),W){oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE=!0,j&&(oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_RANGE_EQUAL_ZERO=!0),q&&(oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MIN_DISCONTINUITY=!0),Y&&(oe.CYLINDER_HAS_SHAPE_BOUNDS_ANGLE_MAX_DISCONTINUITY=!0);let e=(O-u)/d,t=(R-u)/d,i=1-G/d;re.cylinderShapeUvAngleMinMax=U.fromElements(e,t,re.cylinderShapeUvAngleMinMax),re.cylinderShapeUvAngleRangeZeroMid=(t+.5*i)%1;let n=d/G,r=-(O-u)/G;re.cylinderUvToShapeUvAngle=U.fromElements(n,r,re.cylinderUvToShapeUvAngle)}return this.shaderMaximumIntersectionsLength=ae,!0},Lr.prototype.computeOrientedBoundingBoxForTile=function(e,t,i,n,r){let o=this._minimumRadius,a=this._maximumRadius,s=this._minimumHeight,l=this._maximumHeight,u=this._minimumAngle,c=this._maximumAngle,h=1/Math.pow(2,e);return NW(P.lerp(o,a,t*h),P.lerp(o,a,(t+1)*h),P.lerp(s,l,i*h),P.lerp(s,l,(i+1)*h),P.lerp(u,c,n*h),P.lerp(u,c,(n+1)*h),this.shapeTransform,r)};var SXe=new Pn,wXe=new h,vXe=new h,DXe=new h;Lr.prototype.computeApproximateStepSize=function(e){let t=this.shapeTransform,i=this._minimumRadius,n=this._maximumRadius,r=this._minimumHeight,o=this._maximumHeight,a=this._minimumAngle,s=this._maximumAngle,l=1-1/e.x,u=1-1/e.y,c=1-1/e.z,d=NW(P.lerp(i,n,l),n,P.lerp(r,o,u),o,P.lerp(a,s,c),s,t,SXe),p=$.getScale(d.halfAxes,wXe),f=L.getScale(t,vXe),m=h.divideComponents(p,f,DXe);return h.minimumComponent(m)},Lr.DefaultMinBounds=Object.freeze(new h(0,-1,-P.PI)),Lr.DefaultMaxBounds=Object.freeze(new h(1,1,+P.PI));var IXe=5,PXe=new Array(IXe),OXe=new h,RXe=new $,MXe=new L,LXe=new L,NXe=new L,LW=new L,FXe=new h,BXe=new h,kXe=new h,eue=new Array(8);for(let e=0;e<8;e++)eue[e]=new h;function Qle(e,t,i){return Math.abs(oe.dot(e,t))<i}function VXe(e){let t=L.getColumn(e,0,FXe),i=L.getColumn(e,1,BXe),n=L.getColumn(e,2,kXe),r=P.EPSILON4;return Qle(t,i,r)&&Qle(i,n,r)}function UXe(e,t){let i=eue;h.fromElements(-.5,-.5,-.5,i[0]),h.fromElements(-.5,-.5,.5,i[1]),h.fromElements(-.5,.5,-.5,i[2]),h.fromElements(-.5,.5,.5,i[3]),h.fromElements(.5,-.5,-.5,i[4]),h.fromElements(.5,-.5,.5,i[5]),h.fromElements(.5,.5,-.5,i[6]),h.fromElements(.5,.5,.5,i[7]);for(let t=0;t<8;++t)L.multiplyByPoint(e,i[t],i[t]);return Pn.fromPoints(i,t)}function NW(e,t,i,n,r,o,a,s){let l=Lr.DefaultMinBounds,u=Lr.DefaultMaxBounds,c=l.x,d=u.x,p=l.y,f=u.y,m=l.z,_=u.z;if(e===c&&t===d&&i===p&&n===f&&r===m&&o===_)return s.center=L.getTranslation(a,s.center),s.halfAxes=L.getMatrix3(a,s.halfAxes),s;o<r&&(o+=P.TWO_PI);let g=o-r,y=r+.5*g,v=PXe,b=0;v[b++]=r,v[b++]=o,v[b++]=y,g>P.PI&&(v[b++]=y-P.PI_OVER_TWO,v[b++]=y+P.PI_OVER_TWO);let A=1,T=1,E=-1,C=-1;for(let i=0;i<b;++i){let n=v[i]-y,r=Math.cos(n),o=Math.sin(n),a=r*e,s=o*e,l=r*t,u=o*t;A=Math.min(A,a),T=Math.min(T,s),A=Math.min(A,l),T=Math.min(T,u),E=Math.max(E,a),C=Math.max(C,s),E=Math.max(E,l),C=Math.max(C,u)}let x=E-A,S=C-T,w=n-i,I=.5*(A+E),D=.5*(T+C),O=.5*(i+n),R=h.fromElements(I,D,O,OXe),N=$.fromRotationZ(y,RXe),M=h.fromElements(x,S,w,Jle),F=L.fromScale(M,NXe),B=L.fromRotation(N,LXe),z=L.fromTranslation(R,MXe),U=L.multiplyTransformation(B,L.multiplyTransformation(z,F,LW),LW),k=L.multiplyTransformation(a,U,LW);return VXe(k)?Pn.fromTransformation(k,s):UXe(k,s)}var Bp=Lr;function ul(){this.orientedBoundingBox=new Pn,this.boundingSphere=new se,this.boundTransform=new L,this.shapeTransform=new L,this._rectangle=new ce,this._minimumHeight=ul.DefaultMinBounds.z,this._maximumHeight=ul.DefaultMaxBounds.z,this._ellipsoid=new ie,this._translation=new h,this._rotation=new $,this.shaderUniforms={ellipsoidRadiiUv:new h,ellipsoidInverseRadiiSquaredUv:new h,ellipsoidRenderLongitudeMinMax:new U,ellipsoidShapeUvLongitudeMinMaxMid:new h,ellipsoidUvToShapeUvLongitude:new U,ellipsoidUvToShapeUvLatitude:new U,ellipsoidRenderLatitudeCosSqrHalfMinMax:new U,ellipsoidInverseHeightDifferenceUv:0,ellipseInnerRadiiUv:new U,ellipsoidInverseInnerScaleUv:0,ellipsoidInverseOuterScaleUv:0},this.shaderDefines={ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_RANGE_EQUAL_ZERO:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE_RANGE_EQUAL_ZERO:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MAX:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MIN:void 0,ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_FLAT:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_MIN:void 0,ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_FLAT:void 0,ELLIPSOID_IS_SPHERE:void 0,ELLIPSOID_INTERSECTION_INDEX_LONGITUDE:void 0,ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX:void 0,ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN:void 0,ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX:void 0,ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN:void 0},this.shaderMaximumIntersectionsLength=0}var zXe=new h,HXe=new $,tue=new h,nue=new h,iue=new h,oue=new h,GXe=new ce;ul.prototype.update=function(e,t,i,n,r){n=y(n,ul.DefaultMinBounds),r=y(r,ul.DefaultMaxBounds);let o=ul.DefaultMinBounds.x,a=ul.DefaultMaxBounds.x,s=a-o,l=.5*s,u=ul.DefaultMinBounds.y,c=ul.DefaultMaxBounds.y,d=c-u,p=P.EPSILON10,f=P.EPSILON3,m=P.EPSILON10,_=P.EPSILON10,g=P.EPSILON3,v=P.clamp(t.x,o,a),b=P.clamp(i.x,o,a),A=P.clamp(n.x,o,a),T=P.clamp(r.x,o,a),E=Math.max(v,A),C=Math.min(b,T),x=P.clamp(t.y,u,c),S=P.clamp(i.y,u,c),w=P.clamp(n.y,u,c),I=P.clamp(r.y,u,c),D=Math.max(x,w),O=Math.min(S,I),R=L.getScale(e,zXe),N=R.x===R.y&&R.y===R.z,M=h.minimumComponent(R),F=Math.max(t.z,-M),B=Math.max(i.z,-M),z=Math.max(n.z,-M),k=Math.max(r.z,-M),V=Math.max(F,z),H=Math.min(B,k),G=h.add(R,h.fromElements(F,F,F,nue),nue),j=h.add(R,h.fromElements(B,B,B,tue),tue),W=h.maximumComponent(j),q=h.add(R,h.fromElements(V,V,V,oue),oue),Y=h.add(R,h.fromElements(H,H,H,iue),iue);if(D>O||D===c||O===u||V>H||P.equalsEpsilon(Y,h.ZERO,void 0,p))return!1;this._rectangle=ce.fromRadians(v,x,b,S),this._translation=L.getTranslation(e,this._translation),this._rotation=L.getRotation(e,this._rotation),this._ellipsoid=ie.fromCartesian3(R,this._ellipsoid),this._minimumHeight=F,this._maximumHeight=B;let X=ce.fromRadians(E,D,C,O,GXe);this.orientedBoundingBox=rue(X,V,H,this._ellipsoid,this._translation,this._rotation,this.orientedBoundingBox),this.shapeTransform=L.fromRotationTranslation($.setScale(this._rotation,j,HXe),this._translation,this.shapeTransform),this.boundTransform=L.fromRotationTranslation(this.orientedBoundingBox.halfAxes,this.orientedBoundingBox.center,this.boundTransform),this.boundingSphere=se.fromOrientedBoundingBox(this.orientedBoundingBox,this.boundingSphere);let K=C-E+(C<E)*s,J=K<=m,Q=K>l+m&&K<s-m,Z=K>=l-m&&K<=l+m,ee=K>m&&K<l-m,te=J||Q||Z||ee,ne=b-v+(b<v)*s,re=ne<=m||ne>l+m&&ne<s-m||ne>=l-m&&ne<=l+m||ne>m&&ne<l-m,oe=O<-g,ae=O>=-g&&O<=+g,le=O>+g&&O<c-_,ue=oe||ae||le,he=D>u+_&&D<-g,de=D>=-g&&D<=+g,pe=D>+g,fe=he||de||pe,me=ue||fe,_e=S-x,ge=S<-g||S>=-g&&S<=+g||S>+g&&S<c-_||x>u+_&&x<-g||x>=-g&&x<=+g||x>+g,ye=!h.equals(q,h.ZERO),ve=!h.equals(Y,h.ZERO),be=ye||ve,Ae=H-V,Te=!h.equals(G,h.ZERO),Ee=!h.equals(j,h.ZERO),Ce=Te||Ee,xe=this.shaderUniforms,Se=this.shaderDefines;for(let e in Se)Se.hasOwnProperty(e)&&(Se[e]=void 0);xe.ellipsoidRadiiUv=h.divideByScalar(j,W,xe.ellipsoidRadiiUv),xe.ellipsoidInverseRadiiSquaredUv=h.divideComponents(h.ONE,h.multiplyComponents(xe.ellipsoidRadiiUv,xe.ellipsoidRadiiUv,xe.ellipsoidInverseRadiiSquaredUv),xe.ellipsoidInverseRadiiSquaredUv);let we=0;if(Se.ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MAX=we,we+=1,be&&(0===Ae&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_FLAT=!0),ye&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MIN=!0,Se.ELLIPSOID_INTERSECTION_INDEX_HEIGHT_MIN=we,we+=1,xe.ellipsoidInverseInnerScaleUv=W/(W-(B-V))),ve&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_HEIGHT_MAX=!0,xe.ellipsoidInverseOuterScaleUv=W/(W-(B-H)))),Ce){if(Te){Se.ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_MIN=!0;let e=(B-F)/W;xe.ellipsoidInverseHeightDifferenceUv=1/e,xe.ellipseInnerRadiiUv=U.fromElements(xe.ellipsoidRadiiUv.x*(1-e),xe.ellipsoidRadiiUv.z*(1-e),xe.ellipseInnerRadiiUv)}F===B&&(Se.ELLIPSOID_HAS_SHAPE_BOUNDS_HEIGHT_FLAT=!0)}if(te&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE=!0,Se.ELLIPSOID_INTERSECTION_INDEX_LONGITUDE=we,Q?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_UNDER_HALF=!0,we+=1):ee?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_OVER_HALF=!0,we+=2):Z?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_HALF=!0,we+=1):J&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_RANGE_EQUAL_ZERO=!0,we+=2),xe.ellipsoidRenderLongitudeMinMax=U.fromElements(E,C,xe.ellipsoidRenderLongitudeMinMax)),re){Se.ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE=!0,b<v&&(Se.ELLIPSOID_HAS_SHAPE_BOUNDS_LONGITUDE_MIN_MAX_REVERSED=!0);let e=s/ne,t=-(v-o)/ne;xe.ellipsoidUvToShapeUvLongitude=U.fromElements(e,t,xe.ellipsoidUvToShapeUvLongitude)}if(te){let e=P.equalsEpsilon(E,o,void 0,f),t=P.equalsEpsilon(C,a,void 0,f);e&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MIN_DISCONTINUITY=!0),t&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LONGITUDE_MAX_DISCONTINUITY=!0);let i=(v-o)/s,n=(b-o)/s,r=((C-o)/s+.5*(1-K/s))%1;xe.ellipsoidShapeUvLongitudeMinMaxMid=h.fromElements(i,n,r,xe.ellipsoidShapeUvLongitudeMinMaxMid)}if(me){Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE=!0,fe&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN=!0,Se.ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MIN=we,he?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_UNDER_HALF=!0,we+=1):de?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_EQUAL_HALF=!0,we+=1):pe&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MIN_OVER_HALF=!0,we+=2)),ue&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX=!0,Se.ELLIPSOID_INTERSECTION_INDEX_LATITUDE_MAX=we,oe?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_UNDER_HALF=!0,we+=2):ae?(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_EQUAL_HALF=!0,we+=1):le&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_MAX_OVER_HALF=!0,we+=1)),D===O&&(Se.ELLIPSOID_HAS_RENDER_BOUNDS_LATITUDE_RANGE_EQUAL_ZERO=!0);let e=Math.pow(Math.cos(P.PI_OVER_TWO-Math.abs(D)),2),t=Math.pow(Math.cos(P.PI_OVER_TWO-Math.abs(O)),2);xe.ellipsoidRenderLatitudeCosSqrHalfMinMax=U.fromElements(e,t,xe.ellipsoidRenderLatitudeCosSqrHalfMinMax)}if(ge){Se.ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE=!0,x===S&&(Se.ELLIPSOID_HAS_SHAPE_BOUNDS_LATITUDE_RANGE_EQUAL_ZERO=!0);let e=d/_e,t=(u-x)/_e;xe.ellipsoidUvToShapeUvLatitude=U.fromElements(e,t,xe.ellipsoidUvToShapeUvLatitude)}return N&&(Se.ELLIPSOID_IS_SPHERE=!0),this.shaderMaximumIntersectionsLength=we,!0};var WXe=new ce;function rue(e,t,i,n,r,o,a){return(a=Pn.fromRectangle(e,t,i,n,a)).center=h.add(a.center,r,a.center),a.halfAxes=$.multiply(a.halfAxes,o,a.halfAxes),a}ul.prototype.computeOrientedBoundingBoxForTile=function(e,t,i,n,r){let o=1/Math.pow(2,e),a=t*o,s=(t+1)*o,l=i*o,u=(i+1)*o,c=n*o,h=(n+1)*o;return rue(ce.subsection(this._rectangle,a,l,s,u,WXe),P.lerp(this._minimumHeight,this._maximumHeight,c),P.lerp(this._minimumHeight,this._maximumHeight,h),this._ellipsoid,this._translation,this._rotation,r)},ul.prototype.computeApproximateStepSize=function(e){let t=this._ellipsoid.maximumRadius,i=this._minimumHeight,n=this._maximumHeight;return(n-i)/(t+n)*.5/e.z},ul.DefaultMinBounds=Object.freeze(new h(-P.PI,-P.PI_OVER_TWO,-Number.MAX_VALUE)),ul.DefaultMaxBounds=Object.freeze(new h(+P.PI,+P.PI_OVER_TWO,+Number.MAX_VALUE));var JA=ul,Kl={BOX:"BOX",ELLIPSOID:"ELLIPSOID",CYLINDER:"CYLINDER",getMinBounds:function(e){switch(e){case Kl.BOX:return Fp.DefaultMinBounds;case Kl.ELLIPSOID:return JA.DefaultMinBounds;case Kl.CYLINDER:return Bp.DefaultMinBounds}},getMaxBounds:function(e){switch(e){case Kl.BOX:return Fp.DefaultMaxBounds;case Kl.ELLIPSOID:return JA.DefaultMaxBounds;case Kl.CYLINDER:return Bp.DefaultMaxBounds}},getShapeConstructor:function(e){switch(e){case Kl.BOX:return Fp;case Kl.ELLIPSOID:return JA;case Kl.CYLINDER:return Bp}}},ji=Object.freeze(Kl);function JB(e){e=y(e,y.EMPTY_OBJECT),this.shapeTransform=void 0,this.globalTransform=void 0,this.shape=void 0,this.minBounds=void 0,this.maxBounds=void 0,this.dimensions=void 0,this.paddingBefore=void 0,this.paddingAfter=void 0,this.names=void 0,this.types=void 0,this.componentTypes=void 0,this.minimumValues=void 0,this.maximumValues=void 0,this.maximumTileCount=void 0,this._implicitTileset=void 0,this._subtreeCache=new ZB}function jXe(e){if(u(e.tileset))return e.tileset.getPropertyBySemantic(gA.TILESET_TILE_COUNT)}function qXe(e){let t=e.root;if(!u(t.content))throw new ue("Root must have content");if(!ii(t.content,"3DTILES_content_voxels"))throw new ue("Root tile content must have 3DTILES_content_voxels extension");if(!ii(t,"3DTILES_implicit_tiling")&&!u(t.implicitTiling))throw new ue("Root tile must have implicit tiling");if(!u(e.schema)&&!u(e.schemaUri)&&!ii(e,"3DTILES_metadata"))throw new ue("Tileset must have a metadata schema")}function YXe(e){let t,i=e.boundingVolume;if(t=u(e.transform)?L.unpack(e.transform):L.clone(L.IDENTITY),u(i.box))return KXe(i.box,t);if(u(i.region))return XXe(i.region);if(ii(i,"3DTILES_bounding_volume_cylinder"))return ZXe(i.extensions["3DTILES_bounding_volume_cylinder"].cylinder,t);throw new ue("Only box, region and 3DTILES_bounding_volume_cylinder are supported in Cesium3DTilesVoxelProvider")}function XXe(e){let t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=L.fromScale(ie.WGS84.radii),l=n,u=r,c=a,d=new h(t,i,o),p=new h(l,u,c);return{shape:ji.ELLIPSOID,minBounds:d,maxBounds:p,shapeTransform:s,globalTransform:L.clone(L.IDENTITY)}}function KXe(e,t){let i=Pn.unpack(e),n=L.fromRotationTranslation(i.halfAxes,i.center);return{shape:ji.BOX,minBounds:h.clone(Fp.DefaultMinBounds),maxBounds:h.clone(Fp.DefaultMaxBounds),shapeTransform:n,globalTransform:t}}function ZXe(e,t){let i=Pn.unpack(e),n=L.fromRotationTranslation(i.halfAxes,i.center);return{shape:ji.CYLINDER,minBounds:h.clone(Bp.DefaultMinBounds),maxBounds:h.clone(Bp.DefaultMaxBounds),shapeTransform:n,globalTransform:t}}function $Xe(e,t){let{schemaUri:i,schema:n}=e;return u(i)?Gi.getSchemaLoader({resource:t.getDerivedResource({url:i})}):Gi.getSchemaLoader({schema:n})}function QXe(e,t,i){let{schema:n,statistics:r}=t,o=r?.classes[i],a=n.classes[i].properties,s=Object.entries(a).map((([e,t])=>{let{type:i,componentType:n}=t,r=o?.properties[e].min,a=o?.properties[e].max,s=Gt.getComponentCount(i);return{id:e,type:i,componentType:n,minValue:sue(r,s),maxValue:sue(a,s)}}));e.names=s.map((e=>e.id)),e.types=s.map((e=>e.type)),e.componentTypes=s.map((e=>e.componentType));let l=s.map((e=>e.minValue)),c=s.map((e=>e.maxValue)),h=l.some(u);e.minimumValues=h?l:void 0,e.maximumValues=h?c:void 0}function sue(e,t){if(!u(e))return;let i=Array.isArray(e)?e:[e];return Array.from({length:t},((e,t)=>i[t]))}async function JXe(e,t){let i=e.contentUriTemplates[0].getDerivedResource({templateValues:t.getTemplateValues()}),n=e.baseResource.getDerivedResource({url:i.url}),r=await n.fetchArrayBuffer(),o=Dp(r);return await QB.fromJson(n,o.jsonPayload,o.binaryPayload,e.metadataSchema)}async function eKe(e,t){let i=e._implicitTileset,n=e._subtreeCache,r=n.find(t);if(u(r))return r;let o=i.subtreeUriTemplate.getDerivedResource({templateValues:t.getTemplateValues()}),a=i.baseResource.getDerivedResource({url:o.url}),s=await a.fetchArrayBuffer();if(r=n.find(t),u(r))return r;let l=Dp(s);return r=await _A.fromSubtreeJson(a,l.jsonPayload,l.binaryPayload,i,t),n.addSubtree(r),r}JB.fromUrl=async function(e){let t=ve.createIfNeeded(e),i=await t.fetchJson();qXe(i);let n=$Xe(i,t);await n.load();let r=i.root,o=r.content.extensions["3DTILES_content_voxels"],a=o.class,s=ii(i,"3DTILES_metadata")?i.extensions["3DTILES_metadata"]:i,l=n.schema,c=new YA({metadataJson:s,schema:l}),d=new JB;QXe(d,c,a);let p,f,m=new KA(t,r,l),{shape:_,minBounds:g,maxBounds:y,shapeTransform:v,globalTransform:b}=YXe(r);return d.shape=_,d.minBounds=g,d.maxBounds=y,d.dimensions=h.unpack(o.dimensions),d.shapeTransform=v,d.globalTransform=b,d.maximumTileCount=jXe(c),u(o.padding)&&(p=h.unpack(o.padding.before),f=h.unpack(o.padding.after)),d.paddingBefore=p,d.paddingAfter=f,d._implicitTileset=m,Gi.unload(n),d},JB.prototype.requestData=function(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.tileLevel,0),i=y(e.tileX,0),n=y(e.tileY,0),r=y(e.tileZ,0);if(0!==y(e.keyframe,0))return;let o=this._implicitTileset,a=this.names,s=new ZA({subdivisionScheme:o.subdivisionScheme,subtreeLevels:o.subtreeLevels,level:t,x:i,y:n,z:r}),l=s.isSubtreeRoot()&&s.level>0;return eKe(this,l?s.getParentSubtreeCoordinates():s.getSubtreeCoordinates()).then((function(e){return(l?e.childSubtreeIsAvailableAtCoordinates(s):e.tileIsAvailableAtCoordinates(s))?JXe(o,s):Promise.reject("Tile is not available")})).then((function(e){return a.map((function(t){return e.metadataTable.getPropertyTypedArray(t)}))}))};var aue=JB;function FW(e){e=y(e,1),this._radius=y(e,1)}Object.defineProperties(FW.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}}),FW.prototype.emit=function(e){let t=P.randomBetween(0,P.TWO_PI),i=P.randomBetween(0,this._radius),n=i*Math.cos(t),r=i*Math.sin(t);e.position=h.fromElements(n,r,0,e.position),e.velocity=h.clone(h.UNIT_Z,e.velocity)};var e3=FW,t3='in vec3 position3DHigh;\nin vec3 position3DLow;\nin float batchId;\n\n#ifdef EXTRUDED_GEOMETRY\nin vec3 extrudeDirection;\n\nuniform float u_globeMinimumAltitude;\n#endif // EXTRUDED_GEOMETRY\n\n#ifdef PER_INSTANCE_COLOR\nout vec4 v_color;\n#endif // PER_INSTANCE_COLOR\n\n#ifdef TEXTURE_COORDINATES\n#ifdef SPHERICAL\nout vec4 v_sphericalExtents;\n#else // SPHERICAL\nout vec2 v_inversePlaneExtents;\nout vec4 v_westPlane;\nout vec4 v_southPlane;\n#endif // SPHERICAL\nout vec3 v_uvMinAndSphericalLongitudeRotation;\nout vec3 v_uMaxAndInverseDistance;\nout vec3 v_vMaxAndInverseDistance;\n#endif // TEXTURE_COORDINATES\n\nvoid main()\n{\n    vec4 position = czm_computePosition();\n\n#ifdef EXTRUDED_GEOMETRY\n    float delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));\n    delta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;\n\n    //extrudeDirection is zero for the top layer\n    position = position + vec4(extrudeDirection * delta, 0.0);\n#endif\n\n#ifdef TEXTURE_COORDINATES\n#ifdef SPHERICAL\n    v_sphericalExtents = czm_batchTable_sphericalExtents(batchId);\n    v_uvMinAndSphericalLongitudeRotation.z = czm_batchTable_longitudeRotation(batchId);\n#else // SPHERICAL\n#ifdef COLUMBUS_VIEW_2D\n    vec4 planes2D_high = czm_batchTable_planes2D_HIGH(batchId);\n    vec4 planes2D_low = czm_batchTable_planes2D_LOW(batchId);\n\n    // If the primitive is split across the IDL (planes2D_high.x > planes2D_high.w):\n    // - If this vertex is on the east side of the IDL (position3DLow.y > 0.0, comparison with position3DHigh may produce artifacts)\n    // - existing "east" is on the wrong side of the world, far away (planes2D_high/low.w)\n    // - so set "east" as beyond the eastmost extent of the projection (idlSplitNewPlaneHiLow)\n    vec2 idlSplitNewPlaneHiLow = vec2(EAST_MOST_X_HIGH - (WEST_MOST_X_HIGH - planes2D_high.w), EAST_MOST_X_LOW - (WEST_MOST_X_LOW - planes2D_low.w));\n    bool idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y > 0.0;\n    planes2D_high.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.w);\n    planes2D_low.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.w);\n\n    // - else, if this vertex is on the west side of the IDL (position3DLow.y < 0.0)\n    // - existing "west" is on the wrong side of the world, far away (planes2D_high/low.x)\n    // - so set "west" as beyond the westmost extent of the projection (idlSplitNewPlaneHiLow)\n    idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y < 0.0;\n    idlSplitNewPlaneHiLow = vec2(WEST_MOST_X_HIGH - (EAST_MOST_X_HIGH - planes2D_high.x), WEST_MOST_X_LOW - (EAST_MOST_X_LOW - planes2D_low.x));\n    planes2D_high.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.x);\n    planes2D_low.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.x);\n\n    vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.xy), vec3(0.0, planes2D_low.xy))).xyz;\n    vec3 northWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.x, planes2D_high.z), vec3(0.0, planes2D_low.x, planes2D_low.z))).xyz;\n    vec3 southEastCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.w, planes2D_high.y), vec3(0.0, planes2D_low.w, planes2D_low.y))).xyz;\n#else // COLUMBUS_VIEW_2D\n    // 3D case has smaller "plane extents," so planes encoded as a 64 bit position and 2 vec3s for distances/direction\n    vec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(czm_batchTable_southWest_HIGH(batchId), czm_batchTable_southWest_LOW(batchId))).xyz;\n    vec3 northWestCorner = czm_normal * czm_batchTable_northward(batchId) + southWestCorner;\n    vec3 southEastCorner = czm_normal * czm_batchTable_eastward(batchId) + southWestCorner;\n#endif // COLUMBUS_VIEW_2D\n\n    vec3 eastWard = southEastCorner - southWestCorner;\n    float eastExtent = length(eastWard);\n    eastWard /= eastExtent;\n\n    vec3 northWard = northWestCorner - southWestCorner;\n    float northExtent = length(northWard);\n    northWard /= northExtent;\n\n    v_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner));\n    v_southPlane = vec4(northWard, -dot(northWard, southWestCorner));\n    v_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent);\n#endif // SPHERICAL\n    vec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId);\n    vec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId);\n\n    v_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z);\n    v_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w);\n    v_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy;\n#endif // TEXTURE_COORDINATES\n\n#ifdef PER_INSTANCE_COLOR\n    v_color = czm_batchTable_color(batchId);\n#endif\n\n    gl_Position = czm_depthClamp(czm_modelViewProjectionRelativeToEye * position);\n}\n',xv="#ifdef TEXTURE_COORDINATES\n#ifdef SPHERICAL\nin vec4 v_sphericalExtents;\n#else // SPHERICAL\nin vec2 v_inversePlaneExtents;\nin vec4 v_westPlane;\nin vec4 v_southPlane;\n#endif // SPHERICAL\nin vec3 v_uvMinAndSphericalLongitudeRotation;\nin vec3 v_uMaxAndInverseDistance;\nin vec3 v_vMaxAndInverseDistance;\n#endif // TEXTURE_COORDINATES\n\n#ifdef PER_INSTANCE_COLOR\nin vec4 v_color;\n#endif\n\n#ifdef NORMAL_EC\nvec3 getEyeCoordinate3FromWindowCoordinate(vec2 fragCoord, float logDepthOrDepth) {\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord, logDepthOrDepth);\n    return eyeCoordinate.xyz / eyeCoordinate.w;\n}\n\nvec3 vectorFromOffset(vec4 eyeCoordinate, vec2 positiveOffset) {\n    vec2 glFragCoordXY = gl_FragCoord.xy;\n    // Sample depths at both offset and negative offset\n    float upOrRightLogDepth = czm_unpackDepth(texture(czm_globeDepthTexture, (glFragCoordXY + positiveOffset) / czm_viewport.zw));\n    float downOrLeftLogDepth = czm_unpackDepth(texture(czm_globeDepthTexture, (glFragCoordXY - positiveOffset) / czm_viewport.zw));\n    // Explicitly evaluate both paths\n    // Necessary for multifrustum and for edges of the screen\n    bvec2 upOrRightInBounds = lessThan(glFragCoordXY + positiveOffset, czm_viewport.zw);\n    float useUpOrRight = float(upOrRightLogDepth > 0.0 && upOrRightInBounds.x && upOrRightInBounds.y);\n    float useDownOrLeft = float(useUpOrRight == 0.0);\n    vec3 upOrRightEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY + positiveOffset, upOrRightLogDepth);\n    vec3 downOrLeftEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY - positiveOffset, downOrLeftLogDepth);\n    return (upOrRightEC - (eyeCoordinate.xyz / eyeCoordinate.w)) * useUpOrRight + ((eyeCoordinate.xyz / eyeCoordinate.w) - downOrLeftEC) * useDownOrLeft;\n}\n#endif // NORMAL_EC\n\nvoid main(void)\n{\n#ifdef REQUIRES_EC\n    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw));\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\n#endif\n\n#ifdef REQUIRES_WC\n    vec4 worldCoordinate4 = czm_inverseView * eyeCoordinate;\n    vec3 worldCoordinate = worldCoordinate4.xyz / worldCoordinate4.w;\n#endif\n\n#ifdef TEXTURE_COORDINATES\n    vec2 uv;\n#ifdef SPHERICAL\n    // Treat world coords as a sphere normal for spherical coordinates\n    vec2 sphericalLatLong = czm_approximateSphericalCoordinates(worldCoordinate);\n    sphericalLatLong.y += v_uvMinAndSphericalLongitudeRotation.z;\n    sphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);\n    uv.x = (sphericalLatLong.y - v_sphericalExtents.y) * v_sphericalExtents.w;\n    uv.y = (sphericalLatLong.x - v_sphericalExtents.x) * v_sphericalExtents.z;\n#else // SPHERICAL\n    // Unpack planes and transform to eye space\n    uv.x = czm_planeDistance(v_westPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.x;\n    uv.y = czm_planeDistance(v_southPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.y;\n#endif // SPHERICAL\n#endif // TEXTURE_COORDINATES\n\n#ifdef PICK\n#ifdef CULL_FRAGMENTS\n    // When classifying translucent geometry, logDepthOrDepth == 0.0\n    // indicates a region that should not be classified, possibly due to there\n    // being opaque pixels there in another buffer.\n    // Check for logDepthOrDepth != 0.0 to make sure this should be classified.\n    if (0.0 <= uv.x && uv.x <= 1.0 && 0.0 <= uv.y && uv.y <= 1.0 || logDepthOrDepth != 0.0) {\n        out_FragColor.a = 1.0; // 0.0 alpha leads to discard from ShaderSource.createPickFragmentShaderSource\n        czm_writeDepthClamp();\n    }\n#else // CULL_FRAGMENTS\n        out_FragColor.a = 1.0;\n#endif // CULL_FRAGMENTS\n#else // PICK\n\n#ifdef CULL_FRAGMENTS\n    // When classifying translucent geometry, logDepthOrDepth == 0.0\n    // indicates a region that should not be classified, possibly due to there\n    // being opaque pixels there in another buffer.\n    if (uv.x <= 0.0 || 1.0 <= uv.x || uv.y <= 0.0 || 1.0 <= uv.y || logDepthOrDepth == 0.0) {\n        discard;\n    }\n#endif\n\n#ifdef NORMAL_EC\n    // Compute normal by sampling adjacent pixels in 2x2 block in screen space\n    vec3 downUp = vectorFromOffset(eyeCoordinate, vec2(0.0, 1.0));\n    vec3 leftRight = vectorFromOffset(eyeCoordinate, vec2(1.0, 0.0));\n    vec3 normalEC = normalize(cross(leftRight, downUp));\n#endif\n\n\n#ifdef PER_INSTANCE_COLOR\n\n    vec4 color = czm_gammaCorrect(v_color);\n#ifdef FLAT\n    out_FragColor = color;\n#else // FLAT\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = -eyeCoordinate.xyz;\n    czm_material material = czm_getDefaultMaterial(materialInput);\n    material.diffuse = color.rgb;\n    material.alpha = color.a;\n\n    out_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);\n#endif // FLAT\n\n    // Premultiply alpha. Required for classification primitives on translucent globe.\n    out_FragColor.rgb *= out_FragColor.a;\n\n#else // PER_INSTANCE_COLOR\n\n    // Material support.\n    // USES_ is distinct from REQUIRES_, because some things are dependencies of each other or\n    // dependencies for culling but might not actually be used by the material.\n\n    czm_materialInput materialInput;\n\n#ifdef USES_NORMAL_EC\n    materialInput.normalEC = normalEC;\n#endif\n\n#ifdef USES_POSITION_TO_EYE_EC\n    materialInput.positionToEyeEC = -eyeCoordinate.xyz;\n#endif\n\n#ifdef USES_TANGENT_TO_EYE\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(worldCoordinate, normalEC);\n#endif\n\n#ifdef USES_ST\n    // Remap texture coordinates from computed (approximately aligned with cartographic space) to the desired\n    // texture coordinate system, which typically forms a tight oriented bounding box around the geometry.\n    // Shader is provided a set of reference points for remapping.\n    materialInput.st.x = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_uMaxAndInverseDistance.xy, uv) * v_uMaxAndInverseDistance.z;\n    materialInput.st.y = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_vMaxAndInverseDistance.xy, uv) * v_vMaxAndInverseDistance.z;\n#endif\n\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else // FLAT\n    out_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material, czm_lightDirectionEC);\n#endif // FLAT\n\n    // Premultiply alpha. Required for classification primitives on translucent globe.\n    out_FragColor.rgb *= out_FragColor.a;\n\n#endif // PER_INSTANCE_COLOR\n    czm_writeDepthClamp();\n#endif // PICK\n}\n";function cf(e,t,i){this._projectionExtentDefines={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};let n=new BW;n.requiresTextureCoordinates=e,n.requiresEC=!i.flat;let r=new BW;if(r.requiresTextureCoordinates=e,i instanceof rn)n.requiresNormalEC=!i.flat;else{let e=`${i.material.shaderSource}\n${i.fragmentShaderSource}`;n.normalEC=-1!==e.indexOf("materialInput.normalEC")||-1!==e.indexOf("czm_getDefaultMaterial"),n.positionToEyeEC=-1!==e.indexOf("materialInput.positionToEyeEC"),n.tangentToEyeMatrix=-1!==e.indexOf("materialInput.tangentToEyeMatrix"),n.st=-1!==e.indexOf("materialInput.st")}this._colorShaderDependencies=n,this._pickShaderDependencies=r,this._appearance=i,this._extentsCulling=e,this._planarExtents=t}cf.prototype.createFragmentShader=function(e){let t=this._appearance,i=this._colorShaderDependencies,n=[];!e&&!this._planarExtents&&n.push("SPHERICAL"),i.requiresEC&&n.push("REQUIRES_EC"),i.requiresWC&&n.push("REQUIRES_WC"),i.requiresTextureCoordinates&&n.push("TEXTURE_COORDINATES"),this._extentsCulling&&n.push("CULL_FRAGMENTS"),i.requiresNormalEC&&n.push("NORMAL_EC"),t instanceof rn&&n.push("PER_INSTANCE_COLOR"),i.normalEC&&n.push("USES_NORMAL_EC"),i.positionToEyeEC&&n.push("USES_POSITION_TO_EYE_EC"),i.tangentToEyeMatrix&&n.push("USES_TANGENT_TO_EYE"),i.st&&n.push("USES_ST"),t.flat&&n.push("FLAT");let r="";return t instanceof rn||(r=t.material.shaderSource),new He({defines:n,sources:[r,xv]})},cf.prototype.createPickFragmentShader=function(e){let t=this._pickShaderDependencies,i=["PICK"];return!e&&!this._planarExtents&&i.push("SPHERICAL"),t.requiresEC&&i.push("REQUIRES_EC"),t.requiresWC&&i.push("REQUIRES_WC"),t.requiresTextureCoordinates&&i.push("TEXTURE_COORDINATES"),this._extentsCulling&&i.push("CULL_FRAGMENTS"),new He({defines:i,sources:[xv],pickColorQualifier:"in"})},cf.prototype.createVertexShader=function(e,t,i,n){return pue(this._colorShaderDependencies,this._planarExtents,i,e,t,this._appearance,n,this._projectionExtentDefines)},cf.prototype.createPickVertexShader=function(e,t,i,n){return pue(this._pickShaderDependencies,this._planarExtents,i,e,t,void 0,n,this._projectionExtentDefines)};var cue=new h,lue=new fe,uue={high:0,low:0};function pue(e,t,i,n,r,o,a,s){let l=n.slice();if(""===s.eastMostYhighDefine){let e=lue;e.longitude=P.PI,e.latitude=0,e.height=0;let t=a.project(e,cue),i=Wn.encode(t.x,uue);s.eastMostYhighDefine=`EAST_MOST_X_HIGH ${i.high.toFixed(`${i.high}`.length+1)}`,s.eastMostYlowDefine=`EAST_MOST_X_LOW ${i.low.toFixed(`${i.low}`.length+1)}`;let n=lue;n.longitude=-P.PI,n.latitude=0,n.height=0;let r=a.project(n,cue);i=Wn.encode(r.x,uue),s.westMostYhighDefine=`WEST_MOST_X_HIGH ${i.high.toFixed(`${i.high}`.length+1)}`,s.westMostYlowDefine=`WEST_MOST_X_LOW ${i.low.toFixed(`${i.low}`.length+1)}`}return i&&(l.push(s.eastMostYhighDefine),l.push(s.eastMostYlowDefine),l.push(s.westMostYhighDefine),l.push(s.westMostYlowDefine)),u(o)&&o instanceof rn&&l.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(l.push("TEXTURE_COORDINATES"),t||i||l.push("SPHERICAL"),i&&l.push("COLUMBUS_VIEW_2D")),new He({defines:l,sources:[r]})}function BW(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}function fue(e,t,i){return Math.abs((t.y-e.y)*i.x-(t.x-e.x)*i.y+t.x*e.y-t.y*e.x)/U.distance(t,e)}Object.defineProperties(BW.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});var tKe=[new U,new U,new U,new U];function _ue(e,t){let i=tKe,n=U.unpack(t,0,i[0]),r=U.unpack(t,2,i[1]),o=U.unpack(t,4,i[2]);e.uMaxVmax=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,o.x,o.y]});let a=1/fue(n,r,o),s=1/fue(n,o,r);e.uvMinAndExtents=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:4,normalize:!1,value:[n.x,n.y,a,s]})}var gue=new fe,yue=new h,nKe=new h,iKe=new h,n3={high:0,low:0};function xue(e,t,i){let n=gue;n.height=0,n.longitude=e.west,n.latitude=e.south;let r=t.project(n,yue);n.latitude=e.north;let o=t.project(n,nKe);n.longitude=e.east,n.latitude=e.south;let a=t.project(n,iKe),s=[0,0,0,0],l=[0,0,0,0],u=Wn.encode(r.x,n3);s[0]=u.high,l[0]=u.low,u=Wn.encode(r.y,n3),s[1]=u.high,l[1]=u.low,u=Wn.encode(o.y,n3),s[2]=u.high,l[2]=u.low,u=Wn.encode(a.x,n3),s[3]=u.high,l[3]=u.low,i.planes2D_HIGH=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:4,normalize:!1,value:s}),i.planes2D_LOW=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:4,normalize:!1,value:l})}var oKe=new L,rKe=new L,due=new h,sKe=new fe,aKe=[new fe,new fe,new fe,new fe,new fe,new fe,new fe,new fe];function cKe(e,t,i,n,r,o){let a=ce.center(e,sKe);a.height=i;let s=fe.toCartesian(a,t,due),l=Rt.eastNorthUpToFixedFrame(s,t,oKe),u=L.inverse(l,rKe),c=e.west,d=e.east,p=e.north,f=e.south,m=aKe;m[0].latitude=f,m[0].longitude=c,m[1].latitude=p,m[1].longitude=c,m[2].latitude=p,m[2].longitude=d,m[3].latitude=f,m[3].longitude=d;let _=.5*(c+d),g=.5*(p+f);m[4].latitude=f,m[4].longitude=_,m[5].latitude=p,m[5].longitude=_,m[6].latitude=g,m[6].longitude=c,m[7].latitude=g,m[7].longitude=d;let y=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let e=0;e<8;e++){m[e].height=i;let n=fe.toCartesian(m[e],t,due);L.multiplyByPoint(u,n,n),n.z=0,y=Math.min(y,n.x),v=Math.max(v,n.x),b=Math.min(b,n.y),A=Math.max(A,n.y)}let T=n;T.x=y,T.y=b,T.z=0,L.multiplyByPoint(l,T,T);let E=r;E.x=v,E.y=b,E.z=0,L.multiplyByPoint(l,E,E),h.subtract(E,T,r);let C=o;C.x=y,C.y=A,C.z=0,L.multiplyByPoint(l,C,C),h.subtract(C,T,o)}var lKe=new h,uKe=new h,fKe=new Wn;cf.getPlanarTextureCoordinateAttributes=function(e,t,i,n,r){let o=yue,a=lKe,s=uKe;cKe(e,i,y(r,0),o,a,s);let l={};_ue(l,t);let u=Wn.fromCartesian(o,fKe);return l.southWest_HIGH=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(u.high,[0,0,0])}),l.southWest_LOW=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(u.low,[0,0,0])}),l.eastward=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(a,[0,0,0])}),l.northward=new hc({componentDatatype:X.FLOAT,componentsPerAttribute:3,normalize:!1,value:h.pack(s,[0,0,0])}),xue(e,n,l),l};var dKe=new h;function hue(e,t,i,n){let r=gue;r.latitude=e,r.longitude=t,r.height=0;let o=fe.toCartesian(r,i,dKe),a=Math.sqrt(o.x*o.x+o.y*o.y),s=P.fastApproximateAtan2(a,o.z),l=P.fastApproximateAtan2(o.x,o.y);return n.x=s,n.y=l,n}var mue=new U;function hKe(e){return Math.max(e.width,e.height)>cf.MAX_WIDTH_FOR_PLANAR_EXTENTS}cf.getSphericalExtentGeometryInstanceAttributes=function(e,t,i,n){let r=hue(e.south,e.west,i,mue),o=r.x,a=r.y,s=hue(e.north,e.east,i,mue),l=s.x,u=s.y,c=0;a>u&&(c=P.PI-a,a=-P.PI,u+=c),o-=P.EPSILON5,a-=P.EPSILON5,l+=P.EPSILON5,u+=P.EPSILON5;let h=1/(u-a),d=1/(l-o),p={sphericalExtents:new hc({componentDatatype:X.FLOAT,componentsPerAttribute:4,normalize:!1,value:[o,a,d,h]}),longitudeRotation:new hc({componentDatatype:X.FLOAT,componentsPerAttribute:1,normalize:!1,value:[c]})};return _ue(p,t),xue(e,n,p),p},cf.hasAttributesForTextureCoordinatePlanes=function(e){return u(e.southWest_HIGH)&&u(e.southWest_LOW)&&u(e.northward)&&u(e.eastward)&&u(e.planes2D_HIGH)&&u(e.planes2D_LOW)&&u(e.uMaxVmax)&&u(e.uvMinAndExtents)},cf.hasAttributesForSphericalExtents=function(e){return u(e.sphericalExtents)&&u(e.longitudeRotation)&&u(e.planes2D_HIGH)&&u(e.planes2D_LOW)&&u(e.uMaxVmax)&&u(e.uvMinAndExtents)},cf.shouldUseSphericalCoordinates=function(e){return hKe(e)},cf.MAX_WIDTH_FOR_PLANAR_EXTENTS=P.toRadians(1);var lf=cf;function fx(e){let t=(e=y(e,y.EMPTY_OBJECT)).geometryInstances;this.geometryInstances=t,this.show=y(e.show,!0),this.classificationType=y(e.classificationType,zn.BOTH),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=y(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=y(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1,this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:y(e.vertexCacheOptimize,!1),interleave:y(e.interleave,!1),releaseGeometryInstances:y(e.releaseGeometryInstances,!0),allowPicking:y(e.allowPicking,!0),asynchronous:y(e.asynchronous,!0),compressVertices:y(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}function eC(e,t){let i=t?Un.EQUAL:Un.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:i,frontOperation:{fail:ft.KEEP,zFail:ft.DECREMENT_WRAP,zPass:ft.KEEP},backFunction:i,backOperation:{fail:ft.KEEP,zFail:ft.INCREMENT_WRAP,zPass:ft.KEEP},reference:Lt.CESIUM_3D_TILE_MASK,mask:Lt.CESIUM_3D_TILE_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:yc.LESS_OR_EQUAL},depthMask:!1}}function VW(e){return{stencilTest:{enabled:e,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Lt.CLASSIFICATION_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:ln.PRE_MULTIPLIED_ALPHA_BLEND}}Object.defineProperties(fx.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}}),fx.isSupported=function(e){return e.context.stencilBuffer};var mKe={stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},backFunction:Un.NOT_EQUAL,backOperation:{fail:ft.ZERO,zFail:ft.ZERO,zPass:ft.ZERO},reference:0,mask:Lt.CLASSIFICATION_MASK},stencilMask:Lt.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function pKe(e,t,i,n){if(u(e._rsStencilDepthPass))return;let r=!e.debugShowShadowVolume;e._rsStencilDepthPass=Ue.fromCache(eC(r,!1)),e._rsStencilDepthPass3DTiles=Ue.fromCache(eC(r,!0)),e._rsColorPass=Ue.fromCache(VW(r,!1)),e._rsPickPass=Ue.fromCache(mKe)}function _Ke(e,t){if(!e.compressVertices)return t;if(-1!==t.search(/in\s+vec3\s+extrudeDirection;/g)){let e="compressedAttributes",i=`in vec2 ${e};`,n="vec3 extrudeDirection;\n",r=`    extrudeDirection = czm_octDecode(${e}, 65535.0);\n`,o=t;return o=o.replace(/in\s+vec3\s+extrudeDirection;/g,""),o=He.replaceMain(o,"czm_non_compressed_main"),[i,n,o,`void main() \n{ \n${r}    czm_non_compressed_main(); \n}`].join("\n")}}function gKe(e,t){let i=t.context,n=e._primitive,r=t3;r=e._primitive._batchTable.getVertexShaderCallback()(r),r=Sn._appendDistanceDisplayConditionToShader(n,r),r=Sn._modifyShaderPosition(e,r,t.scene3DOnly),r=Sn._updateColorAttribute(n,r);let o=e._hasPlanarExtentsAttributes,a=o||e._hasSphericalExtentsAttribute;e._extruded&&(r=_Ke(n,r));let s=e._extruded?"EXTRUDED_GEOMETRY":"",l=new He({defines:[s],sources:[r]}),c=new He({sources:[k0]}),h=e._primitive._attributeLocations,d=new lf(a,o,e.appearance);if(e._spStencil=Kt.replaceCache({context:i,shaderProgram:e._spStencil,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:h}),e._primitive.allowPicking){let o=He.createPickVertexShaderSource(r);o=Sn._appendShowToShader(n,o),o=Sn._updatePickColorAttribute(o);let l=d.createPickFragmentShader(!1),c=d.createPickVertexShader([s],o,!1,t.mapProjection);if(e._spPick=Kt.replaceCache({context:i,shaderProgram:e._spPick,vertexShaderSource:c,fragmentShaderSource:l,attributeLocations:h}),a){let n=i.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!u(n)){let r=d.createPickFragmentShader(!0),a=d.createPickVertexShader([s],o,!0,t.mapProjection);n=i.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:a,fragmentShaderSource:r,attributeLocations:h})}e._spPick2D=n}}else e._spPick=Kt.fromCache({context:i,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:h});r=Sn._appendShowToShader(n,r),l=new He({defines:[s],sources:[r]}),e._sp=Kt.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:l,fragmentShaderSource:c,attributeLocations:h});let p=d.createFragmentShader(!1),f=d.createVertexShader([s],r,!1,t.mapProjection);if(e._spColor=Kt.replaceCache({context:i,shaderProgram:e._spColor,vertexShaderSource:f,fragmentShaderSource:p,attributeLocations:h}),a){let n=i.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!u(n)){let o=d.createFragmentShader(!0),a=d.createVertexShader([s],r,!0,t.mapProjection);n=i.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:h})}e._spColor2D=n}}function yKe(e,t){let i=e._primitive,n=2*i._va.length;t.length=n;let r,o,a,s=0,l=i._batchTable.getUniformMapCallback()(e._uniformMap),c=e._needs2DShader;for(r=0;r<n;r+=2){let n=i._va[s++];o=t[r],u(o)||(o=t[r]=new et({owner:e,primitiveType:i._primitiveType})),o.vertexArray=n,o.renderState=e._rsStencilDepthPass,o.shaderProgram=e._sp,o.uniformMap=l,o.pass=Ee.TERRAIN_CLASSIFICATION,a=et.shallowClone(o,o.derivedCommands.tileset),a.renderState=e._rsStencilDepthPass3DTiles,a.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,o.derivedCommands.tileset=a,o=t[r+1],u(o)||(o=t[r+1]=new et({owner:e,primitiveType:i._primitiveType})),o.vertexArray=n,o.renderState=e._rsColorPass,o.shaderProgram=e._spColor,o.pass=Ee.TERRAIN_CLASSIFICATION;let h=e.appearance.material;if(u(h)&&(l=gt(l,h._uniforms)),o.uniformMap=l,a=et.shallowClone(o,o.derivedCommands.tileset),a.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,o.derivedCommands.tileset=a,c){let t=et.shallowClone(o,o.derivedCommands.appearance2D);t.shaderProgram=e._spColor2D,o.derivedCommands.appearance2D=t,t=et.shallowClone(a,a.derivedCommands.appearance2D),t.shaderProgram=e._spColor2D,a.derivedCommands.appearance2D=t}}let h=e._commandsIgnoreShow,d=e._spStencil,p=0;n=h.length=n/2;for(let e=0;e<n;++e){let i=h[e]=et.shallowClone(t[p],h[e]);i.shaderProgram=d,i.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,p+=2}}function xKe(e,t){let i,n,r=e._usePickOffsets,o=e._primitive,a=2*o._va.length,s=0;r&&(i=o._pickOffsets,a=2*i.length),t.length=a;let l,c,h,d=0,p=o._batchTable.getUniformMapCallback()(e._uniformMap),f=e._needs2DShader;for(l=0;l<a;l+=2){let a=o._va[d++];if(r&&(n=i[s++],a=o._va[n.index]),c=t[l],u(c)||(c=t[l]=new et({owner:e,primitiveType:o._primitiveType,pickOnly:!0})),c.vertexArray=a,c.renderState=e._rsStencilDepthPass,c.shaderProgram=e._sp,c.uniformMap=p,c.pass=Ee.TERRAIN_CLASSIFICATION,r&&(c.offset=n.offset,c.count=n.count),h=et.shallowClone(c,c.derivedCommands.tileset),h.renderState=e._rsStencilDepthPass3DTiles,h.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=h,c=t[l+1],u(c)||(c=t[l+1]=new et({owner:e,primitiveType:o._primitiveType,pickOnly:!0})),c.vertexArray=a,c.renderState=e._rsPickPass,c.shaderProgram=e._spPick,c.uniformMap=p,c.pass=Ee.TERRAIN_CLASSIFICATION,r&&(c.offset=n.offset,c.count=n.count),h=et.shallowClone(c,c.derivedCommands.tileset),h.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,c.derivedCommands.tileset=h,f){let t=et.shallowClone(c,c.derivedCommands.pick2D);t.shaderProgram=e._spPick2D,c.derivedCommands.pick2D=t,t=et.shallowClone(h,h.derivedCommands.pick2D),t.shaderProgram=e._spPick2D,h.derivedCommands.pick2D=t}}}function bKe(e,t,i,n,r,o,a){yKe(e,o),xKe(e,a)}function bue(e,t){return Math.floor(e%t/2)}function kW(e,t,i,n,r,o){e.modelMatrix=i,e.boundingVolume=r,e.cull=n,e.debugShowBoundingVolume=o,t.commandList.push(e)}function Tue(e,t,i,n,r){e.modelMatrix=i,e.boundingVolume=r,e.cull=n,t.commandList.push(e)}function TKe(e,t,i,n,r,o,a,s){let l,c=e._primitive;Sn._updateBoundingVolumes(c,t,r),t.mode===te.SCENE3D?l=c._boundingSphereWC:t.mode===te.COLUMBUS_VIEW?l=c._boundingSphereCV:t.mode===te.SCENE2D&&u(c._boundingSphere2D)?l=c._boundingSphere2D:u(c._boundingSphereMorph)&&(l=c._boundingSphereMorph);let h,d,p,f=e.classificationType,m=f!==zn.CESIUM_3D_TILE,_=f!==zn.TERRAIN,g=t.passes;if(g.render){let n=i.length;for(h=0;h<n;++h)d=l[bue(h,n)],m&&(p=i[h],kW(p,t,r,o,d,a)),_&&(p=i[h].derivedCommands.tileset,kW(p,t,r,o,d,a));if(t.invertClassification){let i=e._commandsIgnoreShow,n=i.length;for(h=0;h<n;++h)d=l[h],p=i[h],kW(p,t,r,o,d,a)}}if(g.pick){let e=n.length,i=c._pickOffsets;for(h=0;h<e;++h){d=l[i[bue(h,e)].index],m&&(p=n[h],Tue(p,t,r,o,d)),_&&(p=n[h].derivedCommands.tileset,Tue(p,t,r,o,d))}}}fx.prototype.update=function(e){if(!u(this._primitive)&&!u(this.geometryInstances))return;let t=this.appearance;u(t)&&u(t.material)&&t.material.update(e.context);let i=this,n=this._primitiveOptions;if(!u(this._primitive)){let e,r,o,a,s=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],l=s.length,c=!1,h=!0,d=!1,p=!1;for(l>0&&(o=s[0].attributes,d=lf.hasAttributesForSphericalExtents(o),p=lf.hasAttributesForTextureCoordinatePlanes(o),a=o.color),e=0;e<l;e++){r=s[e];let t=r.attributes.color;u(t)&&(c=!0),h=h&&u(t)&&kt.equals(a,t)}if(!h&&!d&&!p)throw new de("All GeometryInstances must have the same color attribute except via GroundPrimitives");c&&!u(t)&&(t=new rn({flat:!0}),this.appearance=t),this._usePickOffsets=!d&&!p,this._hasSphericalExtentsAttribute=d,this._hasPlanarExtentsAttributes=p,this._hasPerColorAttribute=c;let f=new Array(l);for(e=0;e<l;++e)r=s[e],f[e]=new yt({geometry:r.geometry,attributes:r.attributes,modelMatrix:r.modelMatrix,id:r.id,pickPrimitive:y(this._pickPrimitive,i)});n.appearance=t,n.geometryInstances=f,u(this._createBoundingVolumeFunction)&&(n._createBoundingVolumeFunction=function(e,t){i._createBoundingVolumeFunction(e,t)}),n._createRenderStatesFunction=function(e,t,n,r){pKe(i,t)},n._createShaderProgramFunction=function(e,t,n){gKe(i,t)},n._createCommandsFunction=function(e,t,n,r,o,a,s){bKe(i,void 0,void 0,!0,!1,a,s)},u(this._updateAndQueueCommandsFunction)?n._updateAndQueueCommandsFunction=function(e,t,n,r,o,a,s,l){i._updateAndQueueCommandsFunction(e,t,n,r,o,a,s,l)}:n._updateAndQueueCommandsFunction=function(e,t,n,r,o,a,s,l){TKe(i,t,n,r,o,a,s,l)},this._primitive=new Sn(n)}this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilDepthPass=Ue.fromCache(eC(!1,!1)),this._rsStencilDepthPass3DTiles=Ue.fromCache(eC(!1,!0)),this._rsColorPass=Ue.fromCache(VW(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilDepthPass=Ue.fromCache(eC(!0,!1)),this._rsStencilDepthPass3DTiles=Ue.fromCache(eC(!0,!0)),this._rsColorPass=Ue.fromCache(VW(!0))),this._primitive.appearance!==t&&(this._primitive.appearance=t),this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push((()=>{u(this._primitive)&&this._primitive.ready&&(this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0))}))},fx.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)},fx.prototype.isDestroyed=function(){return!1},fx.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,le(this)};var bv=fx,UW={CUMULUS:0,validate:function(e){return e===UW.CUMULUS}},Tv=Object.freeze(UW),i3="uniform sampler2D u_noiseTexture;\nuniform vec3 u_noiseTextureDimensions;\nuniform float u_noiseDetail;\nin vec2 v_offset;\nin vec3 v_maximumSize;\nin vec4 v_color;\nin float v_slice;\nin float v_brightness;\n\nfloat wrap(float value, float rangeLength) {\n    if(value < 0.0) {\n        float absValue = abs(value);\n        float modValue = mod(absValue, rangeLength);\n        return mod(rangeLength - modValue, rangeLength);\n    }\n    return mod(value, rangeLength);\n}\n\nvec3 wrapVec(vec3 value, float rangeLength) {\n    return vec3(wrap(value.x, rangeLength),\n                wrap(value.y, rangeLength),\n                wrap(value.z, rangeLength));\n}\n\nvec2 voxelToUV(vec3 voxelIndex) {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float noiseTextureRows = u_noiseTextureDimensions.y;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n\n    float textureSliceWidthSquared = textureSliceWidth * textureSliceWidth;\n    vec2 inverseNoiseTextureDimensions = vec2(noiseTextureRows / textureSliceWidthSquared,\n                                            inverseNoiseTextureRows / textureSliceWidth);\n    vec3 wrappedIndex = wrapVec(voxelIndex, textureSliceWidth);\n    float column = mod(wrappedIndex.z, textureSliceWidth * inverseNoiseTextureRows);\n    float row = floor(wrappedIndex.z / textureSliceWidth * noiseTextureRows);\n\n    float xPixelCoord = wrappedIndex.x + column * textureSliceWidth;\n    float yPixelCoord = wrappedIndex.y + row * textureSliceWidth;\n    return vec2(xPixelCoord, yPixelCoord) * inverseNoiseTextureDimensions;\n}\n\n// Interpolate a voxel with its neighbor (along the positive X-axis)\nvec4 lerpSamplesX(vec3 voxelIndex, float x) {\n    vec2 uv0 = voxelToUV(voxelIndex);\n    vec2 uv1 = voxelToUV(voxelIndex + vec3(1.0, 0.0, 0.0));\n    vec4 sample0 = texture(u_noiseTexture, uv0);\n    vec4 sample1 = texture(u_noiseTexture, uv1);\n    return mix(sample0, sample1, x);\n}\n\nvec4 sampleNoiseTexture(vec3 position) {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    vec3 recenteredPos = position + vec3(textureSliceWidth / 2.0);\n    vec3 lerpValue = fract(recenteredPos);\n    vec3 voxelIndex = floor(recenteredPos);\n\n    vec4 xLerp00 = lerpSamplesX(voxelIndex, lerpValue.x);\n    vec4 xLerp01 = lerpSamplesX(voxelIndex + vec3(0.0, 0.0, 1.0), lerpValue.x);\n    vec4 xLerp10 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 0.0), lerpValue.x);\n    vec4 xLerp11 = lerpSamplesX(voxelIndex + vec3(0.0, 1.0, 1.0), lerpValue.x);\n\n    vec4 yLerp0 = mix(xLerp00, xLerp10, lerpValue.y);\n    vec4 yLerp1 = mix(xLerp01, xLerp11, lerpValue.y);\n    return mix(yLerp0, yLerp1, lerpValue.z);\n}\n\n// Intersection with a unit sphere with radius 0.5 at center (0, 0, 0).\nbool intersectSphere(vec3 origin, vec3 dir, float slice,\n                     out vec3 point, out vec3 normal) {\n    float A = dot(dir, dir);\n    float B = dot(origin, dir);\n    float C = dot(origin, origin) - 0.25;\n    float discriminant = (B * B) - (A * C);\n    if(discriminant < 0.0) {\n        return false;\n    }\n    float root = sqrt(discriminant);\n    float t = (-B - root) / A;\n    if(t < 0.0) {\n        t = (-B + root) / A;\n    }\n    point = origin + t * dir;\n\n    if(slice >= 0.0) {\n        point.z = (slice / 2.0) - 0.5;\n        if(length(point) > 0.5) {\n            return false;\n        }\n    }\n\n    normal = normalize(point);\n    point -= czm_epsilon2 * normal;\n    return true;\n}\n\n// Transforms the ray origin and direction into unit sphere space,\n// then transforms the result back into the ellipsoid's space.\nbool intersectEllipsoid(vec3 origin, vec3 dir, vec3 center, vec3 scale, float slice,\n                        out vec3 point, out vec3 normal) {\n    if(scale.x <= 0.01 || scale.y < 0.01 || scale.z < 0.01) {\n        return false;\n    }\n\n    vec3 o = (origin - center) / scale;\n    vec3 d = dir / scale;\n    vec3 p, n;\n    bool intersected = intersectSphere(o, d, slice, p, n);\n    if(intersected) {\n        point = (p * scale) + center;\n        normal = n;\n    }\n    return intersected;\n}\n\n// Assume that if phase shift is being called for octave i,\n// the frequency is of i - 1. This saves us from doing extra\n// division / multiplication operations.\nvec2 phaseShift2D(vec2 p, vec2 freq) {\n    return (czm_pi / 2.0) * sin(freq.yx * p.yx);\n}\n\nvec2 phaseShift3D(vec3 p, vec2 freq) {\n    return phaseShift2D(p.xy, freq) + czm_pi * vec2(sin(freq.x * p.z));\n}\n\n// The cloud texture function derived from Gardner's 1985 paper,\n// \"Visual Simulation of Clouds.\"\n// https://www.cs.drexel.edu/~david/Classes/Papers/p297-gardner.pdf\nconst float T0    = 0.6;  // contrast of the texture pattern\nconst float k     = 0.1;  // computed to produce a maximum value of 1\nconst float C0    = 0.8;  // coefficient\nconst float FX0   = 0.6;  // frequency X\nconst float FY0   = 0.6;  // frequency Y\nconst int octaves = 5;\n\nfloat T(vec3 point) {\n    vec2 sum = vec2(0.0);\n    float Ci = C0;\n    vec2 FXY = vec2(FX0, FY0);\n    vec2 PXY = vec2(0.0);\n    for(int i = 1; i <= octaves; i++) {\n        PXY = phaseShift3D(point, FXY);\n        Ci *= 0.707;\n        FXY *= 2.0;\n        vec2 sinTerm = sin(FXY * point.xy + PXY);\n        sum += Ci * sinTerm + vec2(T0);\n    }\n    return k * sum.x * sum.y;\n}\n\nconst float a = 0.5;  // fraction of surface reflection due to ambient or scattered light,\nconst float t = 0.4;  // fraction of texture shading\nconst float s = 0.25; // fraction of specular reflection\n\nfloat I(float Id, float Is, float It) {\n    return (1.0 - a) * ((1.0 - t) * ((1.0 - s) * Id + s * Is) + t * It) + a;\n}\n\nconst vec3 lightDir = normalize(vec3(0.2, -1.0, 0.7));\n\nvec4 drawCloud(vec3 rayOrigin, vec3 rayDir, vec3 cloudCenter, vec3 cloudScale, float cloudSlice,\n               float brightness) {\n    vec3 cloudPoint, cloudNormal;\n    if(!intersectEllipsoid(rayOrigin, rayDir, cloudCenter, cloudScale, cloudSlice,\n                            cloudPoint, cloudNormal)) {\n        return vec4(0.0);\n    }\n\n    float Id = clamp(dot(cloudNormal, -lightDir), 0.0, 1.0);  // diffuse reflection\n    float Is = max(pow(dot(-lightDir, -rayDir), 2.0), 0.0);   // specular reflection\n    float It = T(cloudPoint);                                 // texture function\n    float intensity = I(Id, Is, It);\n    vec3 color = vec3(intensity * clamp(brightness, 0.1, 1.0));\n\n    vec4 noise = sampleNoiseTexture(u_noiseDetail * cloudPoint);\n    float W = noise.x;\n    float W2 = noise.y;\n    float W3 = noise.z;\n\n    // The dot product between the cloud's normal and the ray's direction is greatest\n    // in the center of the ellipsoid's surface. It decreases towards the edge.\n    // Thus, it is used to blur the areas leading to the edges of the ellipsoid,\n    // so that no harsh lines appear.\n\n    // The first (and biggest) layer of worley noise is then subtracted from this.\n    // The final result is scaled up so that the base cloud is not too translucent.\n    float ndDot = clamp(dot(cloudNormal, -rayDir), 0.0, 1.0);\n    float TR = pow(ndDot, 3.0) - W; // translucency\n    TR *= 1.3;\n\n    // Subtracting the second and third layers of worley noise is more complicated.\n    // If these layers of noise were simply subtracted from the current translucency,\n    // the shape derived from the first layer of noise would be completely deleted.\n    // The erosion of this noise should thus be constricted to the edges of the cloud.\n    // However, because the edges of the ellipsoid were already blurred away, mapping\n    // the noise to (1.0 - ndDot) will have no impact on most of the cloud's appearance.\n    // The value of (0.5 - ndDot) provides the best compromise.\n    float minusDot = 0.5 - ndDot;\n\n    // Even with the previous calculation, subtracting the second layer of wnoise\n    // erode too much of the cloud. The addition of it, however, will detailed\n    // volume to the cloud. As long as the noise is only added and not subtracted,\n    // the results are aesthetically pleasing.\n\n    // The minusDot product is mapped in a way that it is larger at the edges of\n    // the ellipsoid, so a subtraction and min operation are used instead of\n    // an addition and max one.\n    TR -= min(minusDot * W2, 0.0);\n\n    // The third level of worley noise is subtracted from the result, with some\n    // modifications. First, a scalar is added to minusDot so that the noise\n    // starts affecting the shape farther away from the center of the ellipsoid's\n    // surface. Then, it is scaled down so its impact is not too intense.\n    TR -= 0.8 * (minusDot + 0.25) * W3;\n\n    // The texture function's shading does not correlate with the shape of the cloud\n    // produced by the layers of noise, so an extra shading scalar is calculated.\n    // The darkest areas of the cloud are assigned to be where the noise erodes\n    // the cloud the most. This is then interpolated based on the translucency\n    // and the diffuse shading term of that point in the cloud.\n    float shading = mix(1.0 - 0.8 * W * W, 1.0, Id * TR);\n\n    // To avoid values that are too dark, this scalar is increased by a small amount\n    // and clamped so it never goes to zero.\n    shading = clamp(shading + 0.2, 0.3, 1.0);\n\n    // Finally, the contrast of the cloud's color is increased.\n    vec3 finalColor = mix(vec3(0.5), shading * color, 1.15);\n    return vec4(finalColor, clamp(TR, 0.0, 1.0)) * v_color;\n}\n\nvoid main() {\n#ifdef DEBUG_BILLBOARDS\n    out_FragColor = vec4(0.0, 0.5, 0.5, 1.0);\n#endif\n    // To avoid calculations with high values,\n    // we raycast from an arbitrarily smaller space.\n    vec2 coordinate = v_maximumSize.xy * v_offset;\n\n    vec3 ellipsoidScale = 0.82 * v_maximumSize;\n    vec3 ellipsoidCenter = vec3(0.0);\n\n    float zOffset = max(ellipsoidScale.z - 10.0, 0.0);\n    vec3 eye = vec3(0, 0, -10.0 - zOffset);\n    vec3 rayDir = normalize(vec3(coordinate, 1.0) - eye);\n    vec3 rayOrigin = eye;\n#ifdef DEBUG_ELLIPSOIDS\n    vec3 point, normal;\n    if(intersectEllipsoid(rayOrigin, rayDir, ellipsoidCenter, ellipsoidScale, v_slice,\n                          point, normal)) {\n        out_FragColor = v_brightness * v_color;\n    }\n#else\n#ifndef DEBUG_BILLBOARDS\n    vec4 cloud = drawCloud(rayOrigin, rayDir,\n                           ellipsoidCenter, ellipsoidScale, v_slice, v_brightness);\n    if(cloud.w < 0.01) {\n        discard;\n    }\n    out_FragColor = cloud;\n#endif\n#endif\n}\n",o3="#ifdef INSTANCED\nin vec2 direction;\n#endif\nin vec4 positionHighAndScaleX;\nin vec4 positionLowAndScaleY;\nin vec4 packedAttribute0;\nin vec4 packedAttribute1;\nin vec4 color;\n\nout vec2 v_offset;\nout vec3 v_maximumSize;\nout vec4 v_color;\nout float v_slice;\nout float v_brightness;\n\nvoid main() {\n    // Unpack attributes.\n    vec3 positionHigh = positionHighAndScaleX.xyz;\n    vec3 positionLow = positionLowAndScaleY.xyz;\n    vec2 scale = vec2(positionHighAndScaleX.w, positionLowAndScaleY.w);\n\n    float show = packedAttribute0.x;\n    float brightness = packedAttribute0.y;\n    vec2 coordinates = packedAttribute0.wz;\n    vec3 maximumSize = packedAttribute1.xyz;\n    float slice = packedAttribute1.w;\n\n#ifdef INSTANCED\n    vec2 dir = direction;\n#else\n    vec2 dir = coordinates;\n#endif\n\n    vec2 offset = dir - vec2(0.5, 0.5);\n    vec2 scaledOffset = scale * offset;\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n    positionEC.xy += scaledOffset;\n    \n    positionEC.xyz *= show;\n    gl_Position = czm_projection * positionEC;\n\n    v_offset = offset;\n    v_maximumSize = maximumSize;\n    v_color = color;\n    v_slice = slice;\n    v_brightness = brightness;\n}\n",r3="uniform vec3 u_noiseTextureDimensions;\nuniform float u_noiseDetail;\nuniform vec3 u_noiseOffset;\nin vec2 v_position;\n\nfloat wrap(float value, float rangeLength) {\n    if(value < 0.0) {\n        float absValue = abs(value);\n        float modValue = mod(absValue, rangeLength);\n        return mod(rangeLength - modValue, rangeLength);\n    }\n    return mod(value, rangeLength);\n}\n\nvec3 wrapVec(vec3 value, float rangeLength) {\n    return vec3(wrap(value.x, rangeLength),\n                wrap(value.y, rangeLength),\n                wrap(value.z, rangeLength));\n}\n\nvec3 random3(vec3 p) {\n    float dot1 = dot(p, vec3(127.1, 311.7, 932.8));\n    float dot2 = dot(p, vec3(269.5, 183.3, 421.4));\n    return fract(vec3(sin(dot1 - dot2), cos(dot1 * dot2), dot1 * dot2));\n}\n\n// Frequency corresponds to cell size.\n// The higher the frequency, the smaller the cell size.\nvec3 getWorleyCellPoint(vec3 centerCell, vec3 offset, float freq) {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    vec3 cell = centerCell + offset;\n    cell = wrapVec(cell, textureSliceWidth / u_noiseDetail);\n    cell += floor(u_noiseOffset / u_noiseDetail);\n    vec3 p = offset + random3(cell);\n    return p;\n}\n\nfloat worleyNoise(vec3 p, float freq) {\n    vec3 centerCell = floor(p * freq);\n    vec3 pointInCell = fract(p * freq);\n    float shortestDistance = 1000.0;\n\n    for(float z = -1.0; z <= 1.0; z++) {\n        for(float y = -1.0; y <= 1.0; y++) {\n            for(float x = -1.0; x <= 1.0; x++) {\n                vec3 offset = vec3(x, y, z);\n                vec3 point = getWorleyCellPoint(centerCell, offset, freq);\n\n                float distance = length(pointInCell - point);\n                if(distance < shortestDistance) {\n                    shortestDistance = distance;\n                }\n            }\n        }\n    }\n\n    return shortestDistance;\n}\n\nconst float MAX_FBM_ITERATIONS = 10.0;\n\nfloat worleyFBMNoise(vec3 p, float octaves, float scale) {\n    float noise = 0.0;\n    float freq = 1.0;\n    float persistence = 0.625;\n    for(float i = 0.0; i < MAX_FBM_ITERATIONS; i++) {\n        if(i >= octaves) {\n            break;\n        }\n\n        noise += worleyNoise(p * scale, freq * scale) * persistence;\n        persistence *= 0.5;\n        freq *= 2.0;\n    }\n    return noise;\n}\n\nvoid main() {\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n    float x = mod(v_position.x, textureSliceWidth);\n    float y = mod(v_position.y, textureSliceWidth);\n    float sliceRow = floor(v_position.y / textureSliceWidth);\n    float z = floor(v_position.x / textureSliceWidth) + sliceRow * inverseNoiseTextureRows * textureSliceWidth;\n\n    vec3 position = vec3(x, y, z);\n    position /= u_noiseDetail;\n    float worley0 = clamp(worleyFBMNoise(position, 3.0, 1.0), 0.0, 1.0);\n    float worley1 = clamp(worleyFBMNoise(position, 3.0, 2.0), 0.0, 1.0);\n    float worley2 = clamp(worleyFBMNoise(position, 3.0, 3.0), 0.0, 1.0);\n    out_FragColor = vec4(worley0, worley1, worley2, 1.0);\n}\n",s3="uniform vec3 u_noiseTextureDimensions;\nin vec2 position;\n\nout vec2 v_position;\n\nvoid main()\n{\n    gl_Position = vec4(position, 0.1, 1.0);\n\n    float textureSliceWidth = u_noiseTextureDimensions.x;\n    float noiseTextureRows = u_noiseTextureDimensions.y;\n    float inverseNoiseTextureRows = u_noiseTextureDimensions.z;\n    vec2 transformedPos = (position * 0.5) + vec2(0.5);\n    transformedPos *= textureSliceWidth;\n    transformedPos.x *= textureSliceWidth * inverseNoiseTextureRows;\n    transformedPos.y *= noiseTextureRows;\n    v_position = transformedPos;\n}\n";function yd(e,t){if(e=y(e,y.EMPTY_OBJECT),this._show=y(e.show,!0),this._position=h.clone(y(e.position,h.ZERO)),!u(e.scale)&&u(e.maximumSize))this._maximumSize=h.clone(e.maximumSize),this._scale=new U(this._maximumSize.x,this._maximumSize.y);else{this._scale=U.clone(y(e.scale,new U(20,12)));let t=new h(this._scale.x,this._scale.y,Math.min(this._scale.x,this._scale.y)/1.5);this._maximumSize=h.clone(y(e.maximumSize,t))}this._slice=y(e.slice,-1),this._color=z.clone(y(e.color,z.WHITE)),this._brightness=y(e.brightness,1),this._cloudCollection=t,this._index=-1}var AKe=yd.SHOW_INDEX=0,CKe=yd.POSITION_INDEX=1,EKe=yd.SCALE_INDEX=2,SKe=yd.MAXIMUM_SIZE_INDEX=3,wKe=yd.SLICE_INDEX=4,vKe=yd.BRIGHTNESS_INDEX=5,DKe=yd.COLOR_INDEX=6;function dx(e,t){let i=e._cloudCollection;u(i)&&(i._updateCloud(e,t),e._dirty=!0)}yd.NUMBER_OF_PROPERTIES=7,Object.defineProperties(yd.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,dx(this,AKe))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),dx(this,CKe))}},scale:{get:function(){return this._scale},set:function(e){let t=this._scale;U.equals(t,e)||(U.clone(e,t),dx(this,EKe))}},maximumSize:{get:function(){return this._maximumSize},set:function(e){let t=this._maximumSize;h.equals(t,e)||(h.clone(e,t),dx(this,SKe))}},color:{get:function(){return this._color},set:function(e){let t=this._color;z.equals(t,e)||(z.clone(e,t),dx(this,DKe))}},slice:{get:function(){return this._slice},set:function(e){this._slice!==e&&(this._slice=e,dx(this,wKe))}},brightness:{get:function(){return this._brightness},set:function(e){this._brightness!==e&&(this._brightness=e,dx(this,vKe))}}}),yd.prototype._destroy=function(){this._cloudCollection=void 0};var uf=yd,Zl,a3=new h,IKe={positionHighAndScaleX:0,positionLowAndScaleY:1,packedAttribute0:2,packedAttribute1:3,color:4},PKe={direction:0,positionHighAndScaleX:1,positionLowAndScaleY:2,packedAttribute0:3,packedAttribute1:4,color:5},OKe=uf.SHOW_INDEX,RKe=uf.POSITION_INDEX,MKe=uf.SCALE_INDEX,LKe=uf.MAXIMUM_SIZE_INDEX,NKe=uf.SLICE_INDEX,FKe=uf.BRIGHTNESS_INDEX,BKe=uf.NUMBER_OF_PROPERTIES,kKe=uf.COLOR_INDEX;function xd(e){e=y(e,y.EMPTY_OBJECT),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(BKe),this._noiseTexture=void 0,this._textureSliceWidth=128,this._noiseTextureRows=4,this.noiseDetail=y(e.noiseDetail,16),this.noiseOffset=h.clone(y(e.noiseOffset,h.ZERO)),this._loading=!1,this._ready=!1;let t=this;this._uniforms={u_noiseTexture:function(){return t._noiseTexture},u_noiseTextureDimensions:Aue(t),u_noiseDetail:function(){return t.noiseDetail}},this._vaNoise=void 0,this._spNoise=void 0,this._spCreated=!1,this._sp=void 0,this._rs=void 0,this.show=y(e.show,!0),this._colorCommands=[],this.debugBillboards=y(e.debugBillboards,!1),this._compiledDebugBillboards=!1,this.debugEllipsoids=y(e.debugEllipsoids,!1),this._compiledDebugEllipsoids=!1}function Aue(e){return function(){return a3.x=e._textureSliceWidth,a3.y=e._noiseTextureRows,a3.z=1/e._noiseTextureRows,a3}}function Cue(e){let t=e.length;for(let i=0;i<t;++i)e[i]&&e[i]._destroy()}function HW(e){if(e._cloudsRemoved){e._cloudsRemoved=!1;let t=[],i=e._clouds,n=i.length;for(let e=0,r=0;e<n;++e){let n=i[e];u(n)&&(i._index=r++,t.push(n))}e._clouds=t}}Object.defineProperties(xd.prototype,{length:{get:function(){return HW(this),this._clouds.length}}}),xd.prototype.add=function(e){let t;return e=y(e,y.EMPTY_OBJECT),y(e.cloudType,Tv.CUMULUS)===Tv.CUMULUS&&(t=new uf(e,this),t._index=this._clouds.length,this._clouds.push(t),this._createVertexArray=!0),t},xd.prototype.remove=function(e){return!!this.contains(e)&&(this._clouds[e._index]=void 0,this._cloudsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},xd.prototype.removeAll=function(){Cue(this._clouds),this._clouds=[],this._cloudsToUpdate=[],this._cloudsToUpdateIndex=0,this._cloudsRemoved=!1,this._createVertexArray=!0},xd.prototype._updateCloud=function(e,t){e._dirty||(this._cloudsToUpdate[this._cloudsToUpdateIndex++]=e),++this._propertiesChanged[t]},xd.prototype.contains=function(e){return u(e)&&e._cloudCollection===this},xd.prototype.get=function(e){return HW(this),this._clouds[e]};var VKe=new Float32Array([-1,-1,1,-1,1,1,-1,1]),UKe=new Uint16Array([0,1,2,0,2,3]),GW;function zKe(e){let t=ut.createVertexBuffer({context:e,typedArray:VKe,usage:Be.STATIC_DRAW}),i=ut.createIndexBuffer({context:e,typedArray:UKe,usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT}),n=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:X.FLOAT}];return new ni({context:e,attributes:n,indexBuffer:i})}function HKe(e){let t=e.cache.cloudCollection_indexBufferBatched;if(u(t))return t;let i=new Uint16Array(98298);for(let e=0,t=0;e<98298;e+=6,t+=4)i[e]=t,i[e+1]=t+1,i[e+2]=t+2,i[e+3]=t,i[e+4]=t+2,i[e+5]=t+3;return t=ut.createIndexBuffer({context:e,typedArray:i,usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferBatched=t,t}function GKe(e){let t=e.cache.cloudCollection_indexBufferInstanced;return u(t)||(t=ut.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_indexBufferInstanced=t),t}function WKe(e){let t=e.cache.cloudCollection_vertexBufferInstanced;return u(t)||(t=ut.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:Be.STATIC_DRAW}),t.vertexArrayDestroyable=!1,e.cache.cloudCollection_vertexBufferInstanced=t),t}function jKe(e,t,i){let n=[{index:Zl.positionHighAndScaleX,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:Be.STATIC_DRAW},{index:Zl.positionLowAndScaleY,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:Be.STATIC_DRAW},{index:Zl.packedAttribute0,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:Be.STATIC_DRAW},{index:Zl.packedAttribute1,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:Be.STATIC_DRAW},{index:Zl.color,componentsPerAttribute:4,componentDatatype:X.UNSIGNED_BYTE,normalize:!0,usage:Be.STATIC_DRAW}];return i&&n.push({index:Zl.direction,componentsPerAttribute:2,componentDatatype:X.FLOAT,vertexBuffer:WKe(e)}),new tg(e,n,i?t:4*t,i)}var zW=new Wn;function Eue(e,t,i,n){let r,o=i[Zl.positionHighAndScaleX],a=i[Zl.positionLowAndScaleY],s=n.position;Wn.fromCartesian(s,zW);let l=n.scale,u=zW.high,c=zW.low;e._instanced?(r=n._index,o(r,u.x,u.y,u.z,l.x),a(r,c.x,c.y,c.z,l.y)):(r=4*n._index,o(r+0,u.x,u.y,u.z,l.x),o(r+1,u.x,u.y,u.z,l.x),o(r+2,u.x,u.y,u.z,l.x),o(r+3,u.x,u.y,u.z,l.x),a(r+0,c.x,c.y,c.z,l.y),a(r+1,c.x,c.y,c.z,l.y),a(r+2,c.x,c.y,c.z,l.y),a(r+3,c.x,c.y,c.z,l.y))}function Sue(e,t,i,n){let r,o=i[Zl.packedAttribute0],a=n.show,s=n.brightness;e._instanced?(r=n._index,o(r,a,s,0,0)):(r=4*n._index,o(r+0,a,s,0,0),o(r+1,a,s,1,0),o(r+2,a,s,1,1),o(r+3,a,s,0,1))}function wue(e,t,i,n){let r,o=i[Zl.packedAttribute1],a=n.maximumSize,s=n.slice;e._instanced?(r=n._index,o(r,a.x,a.y,a.z,s)):(r=4*n._index,o(r+0,a.x,a.y,a.z,s),o(r+1,a.x,a.y,a.z,s),o(r+2,a.x,a.y,a.z,s),o(r+3,a.x,a.y,a.z,s))}function vue(e,t,i,n){let r,o=i[Zl.color],a=n.color,s=z.floatToByte(a.red),l=z.floatToByte(a.green),u=z.floatToByte(a.blue),c=z.floatToByte(a.alpha);e._instanced?(r=n._index,o(r,s,l,u,c)):(r=4*n._index,o(r+0,s,l,u,c),o(r+1,s,l,u,c),o(r+2,s,l,u,c),o(r+3,s,l,u,c))}function qKe(e,t,i,n){Eue(e,t,i,n),Sue(e,t,i,n),wue(e,t,i,n),vue(e,t,i,n)}function YKe(e,t,i,n){let r=e,o=r._textureSliceWidth,a=r._noiseTextureRows,s=t.context;r._vaNoise=zKe(s),r._spNoise=Kt.fromCache({context:s,vertexShaderSource:i,fragmentShaderSource:n,attributeLocations:{position:0}});let l=r.noiseDetail,u=r.noiseOffset;r._noiseTexture=new Ot({context:s,width:o*o/a,height:o*a,pixelDatatype:Ye.UNSIGNED_BYTE,pixelFormat:rt.RGBA,sampler:new un({wrapS:vn.REPEAT,wrapT:vn.REPEAT,minificationFilter:an.NEAREST,magnificationFilter:wi.NEAREST})});let c=new od({vertexArray:r._vaNoise,shaderProgram:r._spNoise,outputTexture:r._noiseTexture,uniformMap:{u_noiseTextureDimensions:Aue(r),u_noiseDetail:function(){return l},u_noiseOffset:function(){return u}},persists:!1,owner:e,postExecute:function(e){r._ready=!0,r._loading=!1}});t.commandList.push(c),r._loading=!0}function XKe(e,t){let i=e,n=t.context;i._createVertexArray=!1,i._vaf=i._vaf&&i._vaf.destroy();let r=e._clouds,o=r.length;if(o>0){i._vaf=jKe(n,o,i._instanced);let a,s=i._vaf.writers;for(a=0;a<o;++a){qKe(e,t,s,r[a])}i._vaf.commit(GW(n))}}var KKe=[];function ZKe(e,t){let i=t.context,n=e,r=n._clouds.length,o=n._cloudsToUpdate,a=n._cloudsToUpdateIndex,s=n._propertiesChanged,l=KKe;l.length=0,(s[RKe]||s[MKe])&&l.push(Eue),(s[OKe]||s[FKe])&&l.push(Sue),(s[LKe]||s[NKe])&&l.push(wue),s[kKe]&&l.push(vue);let u,c,h,d=l.length,p=n._vaf.writers;if(a/r>.1){for(u=0;u<a;++u)for(c=o[u],c._dirty=!1,h=0;h<d;++h)l[h](e,t,p,c);n._vaf.commit(GW(i))}else{for(u=0;u<a;++u){for(c=o[u],c._dirty=!1,h=0;h<d;++h)l[h](e,t,p,c);n._instanced?n._vaf.subCommit(c._index,1):n._vaf.subCommit(4*c._index,4)}n._vaf.endSubCommits()}n._cloudsToUpdateIndex=0}function $Ke(e,t,i,n){let r=t.context,o=e,a=new He({defines:[],sources:[i]});o._instanced&&a.defines.push("INSTANCED");let s=new He({defines:[],sources:[n]});o.debugBillboards&&s.defines.push("DEBUG_BILLBOARDS"),o.debugEllipsoids&&s.defines.push("DEBUG_ELLIPSOIDS"),o._sp=Kt.replaceCache({context:r,shaderProgram:o._sp,vertexShaderSource:a,fragmentShaderSource:s,attributeLocations:Zl}),o._rs=Ue.fromCache({depthTest:{enabled:!0,func:ee.LESS},depthMask:!1,blending:ln.ALPHA_BLEND}),o._spCreated=!0,o._compiledDebugBillboards=o.debugBillboards,o._compiledDebugEllipsoids=o.debugEllipsoids}function QKe(e,t){let i=e,n=t.passes,r=i._uniforms,o=t.commandList;if(n.render){let t=i._colorCommands,n=i._vaf.va,a=n.length;t.length=a;for(let s=0;s<a;s++){let a=t[s];u(a)||(a=t[s]=new et),a.pass=Ee.TRANSLUCENT,a.owner=e,a.uniformMap=r,a.count=n[s].indicesCount,a.vertexArray=n[s].va,a.shaderProgram=i._sp,a.renderState=i._rs,i._instanced&&(a.count=6,a.instanceCount=i._clouds.length),o.push(a)}}}xd.prototype.update=function(e){if(HW(this),!this.show)return;let t=this.debugBillboards||this.debugEllipsoids;this._ready=!!t||u(this._noiseTexture),!this._ready&&!this._loading&&!t&&YKe(this,e,s3,r3),this._instanced=e.context.instancedArrays,Zl=this._instanced?PKe:IKe,GW=this._instanced?GKe:HKe;let i=this._clouds.length,n=this._cloudsToUpdate,r=this._cloudsToUpdateIndex;this._createVertexArray?XKe(this,e):r>0&&ZKe(this,e),r>1.5*i&&(n.length=i),u(this._vaf)&&u(this._vaf.va)&&!(!this._ready&!t)&&((!this._spCreated||this.debugBillboards!==this._compiledDebugBillboards||this.debugEllipsoids!==this._compiledDebugEllipsoids)&&$Ke(this,e,o3,i3),QKe(this,e))},xd.prototype.isDestroyed=function(){return!1},xd.prototype.destroy=function(){return this._noiseTexture=this._noiseTexture&&this._noiseTexture.destroy(),this._sp=this._sp&&this._sp.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),Cue(this._clouds),le(this)};var Due=xd;async function WW(e,t){let i,n=t.terrainProvider,r=t.mapProjection,o=r.ellipsoid,a=t.camera.getRectangleCameraCoordinates(e);if(i=t.mode===te.SCENE3D?o.cartesianToCartographic(a):r.unproject(a),!u(n))return i;let s=n.availability;if(!u(s)||t.mode===te.SCENE2D)return i;let l=[ce.center(e),ce.southeast(e),ce.southwest(e),ce.northeast(e),ce.northwest(e)],c=await WW._sampleTerrainMostDetailed(n,l),h=!1,d=c.reduce((function(e,t){return u(t.height)?(h=!0,Math.max(t.height,e)):e}),-Number.MAX_VALUE),p=i;return h&&(p.height+=d),p}WW._sampleTerrainMostDetailed=j_;var tC=WW,JKe=P.toRadians(30);function jW(e){this._angle=y(e,JKe)}Object.defineProperties(jW.prototype,{angle:{get:function(){return this._angle},set:function(e){this._angle=e}}}),jW.prototype.emit=function(e){let t=Math.tan(this._angle),i=P.randomBetween(0,P.TWO_PI),n=P.randomBetween(0,t),r=n*Math.cos(i),o=n*Math.sin(i);e.velocity=h.fromElements(r,o,1,e.velocity),h.normalize(e.velocity,e.velocity),e.position=h.clone(h.ZERO,e.position)};var Iue=jW,eZe=new z,tZe=new z,nZe=new z,iZe=new z,Pue=new oe,Av=new Uint8Array(4);function Oue(e,t,i,n){let r=t.height===i.height?0:(e-t.height)/(i.height-t.height);return z.lerp(t.color,i.color,r,n)}function c3(e,t){return{height:e,color:z.clone(t)}}function Rue(e){return e=(e=(e=e.filter((function(e,t,i){let n=t>0,r=t<i.length-1,o=!n||e.height===i[t-1].height,a=!r||e.height===i[t+1].height;return!o||!a}))).filter((function(e,t,i){let n=t>0,r=t<i.length-1,o=!!n&&z.equals(e.color,i[t-1].color),a=!!r&&z.equals(e.color,i[t+1].color);return!o||!a}))).filter((function(e,t,i){let n=t>0,r=!!n&&z.equals(e.color,i[t-1].color),o=!n||e.height===i[t-1].height;return!r||!o}))}function oZe(e){let t,i,n=[],r=e.length;for(t=0;t<r;t++){let r=e[t],o=r.entries,a=o.length,s=[];for(i=0;i<a;i++){let e=o[i],t=P.clamp(e.height,fl._minimumHeight,fl._maximumHeight),n=z.clone(e.color,eZe);n.red*=n.alpha,n.green*=n.alpha,n.blue*=n.alpha,s.push(c3(t,n))}let l=!0,u=!0;for(i=0;i<a-1;i++){let e=s[i+0],t=s[i+1];l=l&&e.height<=t.height,u=u&&e.height>=t.height}u?s=s.reverse():l||N_(s,(function(e,t){return P.sign(e.height-t.height)}));let c=y(r.extendDownwards,!1),h=y(r.extendUpwards,!1);1===s.length&&!c&&!h&&(c=!0,h=!0),c&&s.splice(0,0,c3(fl._minimumHeight,s[0].color)),h&&s.splice(s.length,0,c3(fl._maximumHeight,s[s.length-1].color)),s=Rue(s),n.push(s)}return n}function rZe(e){let t,i=oZe(e),n=[],r=[];function o(e,t){n.push(c3(e,t))}function a(e,t,i){let n=z.multiplyByScalar(i,1-t.alpha,iZe);n=z.add(n,t,n),o(e,n)}let s=i.length;for(t=0;t<s;t++){let e=i[t],s=0,l=0;r=n,n=[];let c=e.length,h=r.length;for(;s<c||l<h;){let t=s<c?e[s]:void 0,i=s>0?e[s-1]:void 0,n=s<c-1?e[s+1]:void 0,d=l<h?r[l]:void 0,p=l>0?r[l-1]:void 0,f=l<h-1?r[l+1]:void 0;if(u(t)&&u(d)&&t.height===d.height){let e=u(f)&&d.height===f.height,r=!u(p),c=!u(f),h=u(n)&&t.height===n.height,m=!u(i),_=!u(n);e?h?(a(t.height,t.color,d.color),a(t.height,n.color,f.color)):m?(o(t.height,d.color),a(t.height,t.color,f.color)):_?(a(t.height,t.color,d.color),o(t.height,f.color)):(a(t.height,t.color,d.color),a(t.height,t.color,f.color)):r?h?(o(t.height,t.color),a(t.height,n.color,d.color)):_?(o(t.height,t.color),o(t.height,d.color)):(m||o(t.height,t.color),a(t.height,t.color,d.color)):c?h?(a(t.height,t.color,d.color),o(t.height,n.color)):m?(o(t.height,d.color),o(t.height,t.color)):_?a(t.height,t.color,d.color):(a(t.height,t.color,d.color),o(t.height,t.color)):h?(a(t.height,t.color,d.color),a(t.height,n.color,d.color)):m?(o(t.height,d.color),a(t.height,t.color,d.color)):_?(a(t.height,t.color,d.color),o(t.height,d.color)):a(t.height,t.color,d.color),s+=h?2:1,l+=e?2:1}else if(u(t)&&u(d)&&u(p)&&t.height<d.height){let e=Oue(t.height,p,d,nZe);u(i)?u(n)?a(t.height,t.color,e):(a(t.height,t.color,e),o(t.height,e)):(o(t.height,e),a(t.height,t.color,e)),s++}else if(u(d)&&u(t)&&u(i)&&d.height<t.height){let e=Oue(d.height,i,t,tZe);u(p)?u(f)?a(d.height,e,d.color):(a(d.height,e,d.color),o(d.height,e)):(o(d.height,e),a(d.height,e,d.color)),l++}else u(t)&&(!u(d)||t.height<d.height)?(!u(d)||u(p)||u(n)?(!u(d)&&u(p)&&!u(i)&&(o(p.height,fl._emptyColor),o(t.height,fl._emptyColor)),o(t.height,t.color)):(o(t.height,t.color),o(t.height,fl._emptyColor),o(d.height,fl._emptyColor)),s++):u(d)&&(!u(t)||d.height<t.height)&&(o(d.height,d.color),l++)}}return Rue(n)}function fl(e){let t,i,n,{scene:r,layers:o}=y(e,y.EMPTY_OBJECT),{context:a}=r,s=rZe(o),l=s.length;if(fl._useFloatTexture(a)){i=Ye.FLOAT,n=a.webgl2?rt.RED:rt.LUMINANCE,t=new Float32Array(l);for(let e=0;e<l;e++)t[e]=s[e].height}else{i=Ye.UNSIGNED_BYTE,n=rt.RGBA,t=new Uint8Array(4*l);for(let e=0;e<l;e++)oe.packFloat(s[e].height,Pue),oe.pack(Pue,t,4*e)}let u=Ot.create({context:a,pixelFormat:n,pixelDatatype:i,source:{arrayBufferView:t,width:l,height:1},sampler:new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.NEAREST,magnificationFilter:wi.NEAREST})}),c=new Uint8Array(4*l);for(let e=0;e<l;e++)s[e].color.toBytes(Av),c[4*e+0]=Av[0],c[4*e+1]=Av[1],c[4*e+2]=Av[2],c[4*e+3]=Av[3];let h=Ot.create({context:a,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,source:{arrayBufferView:c,width:l,height:1},sampler:new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.LINEAR,magnificationFilter:wi.LINEAR})});return Wi.fromType("ElevationBand",{heights:u,colors:h})}fl._useFloatTexture=function(e){return e.floatingPointTexture},fl._maximumHeight=5906376425472,fl._minimumHeight=-5906376425472,fl._emptyColor=new z(0,0,0,0);var Mue=fl;async function sZe(e,t){if((t=y(t,{})).cacheBytes=y(t.cacheBytes,1610612736),t.maximumCacheOverflowBytes=y(t.maximumCacheOverflowBytes,1073741824),e=y(e,TT.defaultApiKey),!u(e))return aZe(t);let i,n=TT.getDefaultCredit();u(n)&&(i=[n]);let r=new ve({url:`${TT.mapTilesApiEndpoint}3dtiles/root.json`,queryParameters:{key:e},credits:i});return ca.fromUrl(r,t)}var Lue={};async function aZe(e){let t=Lue[2275207];u(t)||(t=Iu.fromAssetId(2275207),Lue[2275207]=t);let i=await t;return ca.fromUrl(i,e)}var Nue=sZe;async function cZe(e){let t=await ca.fromIonAssetId(96188,e),i=(e=y(e,y.EMPTY_OBJECT)).style;if(!u(i)){let t=y(e.defaultColor,z.WHITE).toCssColorString();i=new QA({color:`Boolean(\${feature['cesium#color']}) ? color(\${feature['cesium#color']}) : ${t}`})}return t.style=i,t}var Fue=cZe;function lZe(e){let t=[],i=(e=y(e,y.EMPTY_OBJECT)).geometry;(!u(i.attributes)||!u(i.primitiveType))&&(i=i.constructor.createGeometry(i));let n=i.attributes,r=L.clone(y(e.modelMatrix,L.IDENTITY)),o=y(e.length,1e4);if(u(n.normal)&&t.push(new yt({geometry:Fn.createLineSegmentsForVectors(i,"normal",o),attributes:{color:new kt(1,0,0,1)},modelMatrix:r})),u(n.tangent)&&t.push(new yt({geometry:Fn.createLineSegmentsForVectors(i,"tangent",o),attributes:{color:new kt(0,1,0,1)},modelMatrix:r})),u(n.bitangent)&&t.push(new yt({geometry:Fn.createLineSegmentsForVectors(i,"bitangent",o),attributes:{color:new kt(0,0,1,1)},modelMatrix:r})),t.length>0)return new Sn({asynchronous:!1,geometryInstances:t,appearance:new rn({flat:!0,translucent:!1})})}var Bue=lZe,kue=/{[^}]+}/g,Vue={x:hZe,y:pZe,z:yZe,s:xZe,reverseX:mZe,reverseY:_Ze,reverseZ:gZe,westDegrees:bZe,southDegrees:TZe,eastDegrees:AZe,northDegrees:CZe,westProjected:EZe,southProjected:SZe,eastProjected:wZe,northProjected:vZe,width:DZe,height:IZe},uZe=gt(Vue,{i:PZe,j:OZe,reverseI:RZe,reverseJ:MZe,longitudeDegrees:NZe,latitudeDegrees:FZe,longitudeProjected:BZe,latitudeProjected:kZe,format:UZe});function Cv(e){e=y(e,y.EMPTY_OBJECT),this._errorEvent=new pe;let t=ve.createIfNeeded(e.url),i=ve.createIfNeeded(e.pickFeaturesUrl);this._resource=t,this._urlSchemeZeroPadding=e.urlSchemeZeroPadding,this._getFeatureInfoFormats=e.getFeatureInfoFormats,this._pickFeaturesResource=i;let n=e.subdomains;n=Array.isArray(n)?n.slice():u(n)&&n.length>0?n.split(""):["a","b","c"],this._subdomains=n,this._tileWidth=y(e.tileWidth,256),this._tileHeight=y(e.tileHeight,256),this._minimumLevel=y(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._tilingScheme=y(e.tilingScheme,new zr({ellipsoid:e.ellipsoid})),this._rectangle=y(e.rectangle,this._tilingScheme.rectangle),this._rectangle=ce.intersection(this._rectangle,this._tilingScheme.rectangle),this._tileDiscardPolicy=e.tileDiscardPolicy;let r=e.credit;"string"==typeof r&&(r=new xt(r)),this._credit=r,this._hasAlphaChannel=y(e.hasAlphaChannel,!0);let o=e.customTags,a=gt(Vue,o),s=gt(uZe,o);this._tags=a,this._pickFeaturesTags=s,this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this.enablePickFeatures=y(e.enablePickFeatures,!0)}Object.defineProperties(Cv.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return this._hasAlphaChannel}}}),Cv.prototype.getTileCredits=function(e,t,i){},Cv.prototype.requestImage=function(e,t,i,n){return el.loadImage(this,fZe(this,e,t,i,n))},Cv.prototype.pickFeatures=function(e,t,i,n,r){if(!this.enablePickFeatures||!u(this._pickFeaturesResource)||0===this._getFeatureInfoFormats.length)return;let o=0,a=this;function s(e,t){return e.callback(t)}return function l(){if(o>=a._getFeatureInfoFormats.length)return Promise.resolve([]);let u=a._getFeatureInfoFormats[o],c=dZe(a,e,t,i,n,r,u.format);return++o,"json"===u.type?c.fetchJson().then(u.callback).catch(l):"xml"===u.type?c.fetchXML().then(u.callback).catch(l):"text"===u.type||"html"===u.type?c.fetchText().then(u.callback).catch(l):c.fetch({responseType:u.format}).then(s.bind(void 0,u)).catch(l)}()};var l3=!1,$l=new ce,u3=!1,Ev=new ce;function fZe(e,t,i,n,r){l3=!1,u3=!1;let o=e._resource,a=o.getUrlComponent(!0),s=e._tags,l={},c=a.match(kue);return u(c)&&c.forEach((function(r){let o=r.substring(1,r.length-1);u(s[o])&&(l[o]=s[o](e,t,i,n))})),o.getDerivedResource({request:r,templateValues:l})}var qW=!1,iC=new U,YW=!1;function dZe(e,t,i,n,r,o,a){l3=!1,u3=!1,qW=!1,YW=!1;let s=e._pickFeaturesResource,l=s.getUrlComponent(!0),c=e._pickFeaturesTags,h={},d=l.match(kue);return u(d)&&d.forEach((function(s){let l=s.substring(1,s.length-1);u(c[l])&&(h[l]=c[l](e,t,i,n,r,o,a))})),s.getDerivedResource({templateValues:h})}function oC(e,t,i){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){let n=e.urlSchemeZeroPadding[t];if("string"==typeof n){let e=n.length;e>1&&(i=i.length>=e?i:new Array(e-i.toString().length+1).join("0")+i)}}return i}function hZe(e,t,i,n){return oC(e,"{x}",t)}function mZe(e,t,i,n){let r=e.tilingScheme.getNumberOfXTilesAtLevel(n)-t-1;return oC(e,"{reverseX}",r)}function pZe(e,t,i,n){return oC(e,"{y}",i)}function _Ze(e,t,i,n){let r=e.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1;return oC(e,"{reverseY}",r)}function gZe(e,t,i,n){let r=e.maximumLevel;return oC(e,"{reverseZ}",u(r)&&n<r?r-n-1:n)}function yZe(e,t,i,n){return oC(e,"{z}",n)}function xZe(e,t,i,n){let r=(t+i+n)%e._subdomains.length;return e._subdomains[r]}function f3(e,t,i,n){l3||(e.tilingScheme.tileXYToRectangle(t,i,n,$l),$l.west=P.toDegrees($l.west),$l.south=P.toDegrees($l.south),$l.east=P.toDegrees($l.east),$l.north=P.toDegrees($l.north),l3=!0)}function bZe(e,t,i,n){return f3(e,t,i,n),$l.west}function TZe(e,t,i,n){return f3(e,t,i,n),$l.south}function AZe(e,t,i,n){return f3(e,t,i,n),$l.east}function CZe(e,t,i,n){return f3(e,t,i,n),$l.north}function d3(e,t,i,n){u3||(e.tilingScheme.tileXYToNativeRectangle(t,i,n,Ev),u3=!0)}function EZe(e,t,i,n){return d3(e,t,i,n),Ev.west}function SZe(e,t,i,n){return d3(e,t,i,n),Ev.south}function wZe(e,t,i,n){return d3(e,t,i,n),Ev.east}function vZe(e,t,i,n){return d3(e,t,i,n),Ev.north}function DZe(e,t,i,n){return e.tileWidth}function IZe(e,t,i,n){return e.tileHeight}function PZe(e,t,i,n,r,o,a){return h3(e,t,i,n,r,o),iC.x}function OZe(e,t,i,n,r,o,a){return h3(e,t,i,n,r,o),iC.y}function RZe(e,t,i,n,r,o,a){return h3(e,t,i,n,r,o),e.tileWidth-iC.x-1}function MZe(e,t,i,n,r,o,a){return h3(e,t,i,n,r,o),e.tileHeight-iC.y-1}var LZe=new ce,nC=new h;function h3(e,t,i,n,r,o,a){if(qW)return;XW(e,t,i,n,r,o);let s=nC,l=e.tilingScheme.tileXYToNativeRectangle(t,i,n,LZe);iC.x=e.tileWidth*(s.x-l.west)/l.width|0,iC.y=e.tileHeight*(l.north-s.y)/l.height|0,qW=!0}function NZe(e,t,i,n,r,o,a){return P.toDegrees(r)}function FZe(e,t,i,n,r,o,a){return P.toDegrees(o)}function BZe(e,t,i,n,r,o,a){return XW(e,t,i,n,r,o),nC.x}function kZe(e,t,i,n,r,o,a){return XW(e,t,i,n,r,o),nC.y}var VZe=new fe;function XW(e,t,i,n,r,o,a){if(!YW){if(e.tilingScheme.projection instanceof Ii)nC.x=P.toDegrees(r),nC.y=P.toDegrees(o);else{let t=VZe;t.longitude=r,t.latitude=o,e.tilingScheme.projection.project(t,nC)}YW=!0}}function UZe(e,t,i,n,r,o,a){return a}var qa=Cv;function ff(e){qa.call(this,e)}function Uue(e,t){return e.west<t.rectangle.west&&(e.west=t.rectangle.west),e.east>t.rectangle.east&&(e.east=t.rectangle.east),e.south<t.rectangle.south&&(e.south=t.rectangle.south),e.north>t.rectangle.north&&(e.north=t.rectangle.north),e}function zue(e,t,i){let n=e.positionToTileXY(ce.southwest(t),i),r=e.positionToTileXY(ce.northeast(t),i);return(Math.abs(r.x-n.x)+1)*(Math.abs(r.y-n.y)+1)>4?0:i}ff._requestMetadata=async function(e,t,i,n){try{let r=await i.fetchXML();return ff._metadataSuccess(r,e,t,i,n)}catch(i){if(i instanceof wm)return ff._metadataFailure(e,t);throw i}},ff.fromUrl=async function(e,t){let i=ve.createIfNeeded(e);i.appendForwardSlash();let n=i,r=i.getDerivedResource({url:"tilemapresource.xml"});t=y(t,y.EMPTY_OBJECT);let o=await ff._requestMetadata(t,n,r);return new ff(o)},u(Object.create)&&(ff.prototype=Object.create(qa.prototype),ff.prototype.constructor=ff),ff._metadataSuccess=function(e,t,i,n,r){let o,a,s,l,c=/tileformat/i,h=/tileset/i,d=/tilesets/i,p=/boundingbox/i,f=[],m=e.childNodes[0].childNodes;for(let e=0;e<m.length;e++)if(c.test(m.item(e).nodeName))o=m.item(e);else if(d.test(m.item(e).nodeName)){s=m.item(e);let t=m.item(e).childNodes;for(let e=0;e<t.length;e++)h.test(t.item(e).nodeName)&&f.push(t.item(e))}else p.test(m.item(e).nodeName)&&(a=m.item(e));if(!u(s)||!u(a))throw l=`Unable to find expected tilesets or bbox attributes in ${n.url}.`,u(r)&&bo.reportError(void 0,r,r.errorEvent,l),new ue(l);let _=y(t.fileExtension,o.getAttribute("extension")),g=y(t.tileWidth,parseInt(o.getAttribute("width"),10)),v=y(t.tileHeight,parseInt(o.getAttribute("height"),10)),b=y(t.minimumLevel,parseInt(f[0].getAttribute("order"),10)),A=y(t.maximumLevel,parseInt(f[f.length-1].getAttribute("order"),10)),T=s.getAttribute("profile"),E=t.tilingScheme;if(!u(E))if("geodetic"===T||"global-geodetic"===T)E=new Ui({ellipsoid:t.ellipsoid});else{if("mercator"!==T&&"global-mercator"!==T)throw l=`${n.url} specifies an unsupported profile attribute, ${T}.`,u(r)&&bo.reportError(void 0,r,r.errorEvent,l),new ue(l);E=new zr({ellipsoid:t.ellipsoid})}let C=ce.clone(t.rectangle);if(!u(C)){let e,i,n,r;y(t.flipXY,!1)?(n=new U(parseFloat(a.getAttribute("miny")),parseFloat(a.getAttribute("minx"))),r=new U(parseFloat(a.getAttribute("maxy")),parseFloat(a.getAttribute("maxx")))):(n=new U(parseFloat(a.getAttribute("minx")),parseFloat(a.getAttribute("miny"))),r=new U(parseFloat(a.getAttribute("maxx")),parseFloat(a.getAttribute("maxy"))));let o="geodetic"===T||"mercator"===T;if(E.projection instanceof Ii||o)e=fe.fromDegrees(n.x,n.y),i=fe.fromDegrees(r.x,r.y);else{let t=E.projection;e=t.unproject(n),i=t.unproject(r)}C=new ce(e.longitude,e.latitude,i.longitude,i.latitude)}return C=Uue(C,E),b=zue(E,C,b),{url:i.getDerivedResource({url:`{z}/{x}/{reverseY}.${_}`}),tilingScheme:E,rectangle:C,tileWidth:g,tileHeight:v,minimumLevel:b,maximumLevel:A,tileDiscardPolicy:t.tileDiscardPolicy,credit:t.credit}},ff._metadataFailure=function(e,t){let i=y(e.fileExtension,"png"),n=y(e.tileWidth,256),r=y(e.tileHeight,256),o=e.maximumLevel,a=u(e.tilingScheme)?e.tilingScheme:new zr({ellipsoid:e.ellipsoid}),s=y(e.rectangle,a.rectangle);s=Uue(s,a);let l=zue(a,s,e.minimumLevel);return{url:t.getDerivedResource({url:`{z}/{x}/{reverseY}.${i}`}),tilingScheme:a,rectangle:s,tileWidth:n,tileHeight:r,minimumLevel:l,maximumLevel:o,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit}};var hx=ff;function Hue(e){this.channel=e.channel,this.ellipsoid=e.ellipsoid,this.tilingScheme=void 0,this.version=void 0}function zZe(e,t){let i,n;try{i=JSON.parse(e)}catch{i=JSON.parse(e.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}for(let e=0;e<i.layers.length;e++)if(i.layers[e].id===t.channel){n=i.layers[e];break}if(!u(n)){let e=`Could not find layer with channel (id) of ${t.channel}.`;throw new ue(e)}if(!u(n.version)){let e=`Could not find a version in channel (id) ${t.channel}.`;throw new ue(e)}if(t.version=n.version,u(i.projection)&&"flat"===i.projection)t.tilingScheme=new Ui({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new ce(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:t.ellipsoid});else{if(u(i.projection)&&"mercator"!==i.projection){let e=`Unsupported projection ${i.projection}.`;throw new ue(e)}t.tilingScheme=new zr({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:t.ellipsoid})}return!0}function HZe(e,t,i){let n=`An error occurred while accessing ${t.url}.`;throw u(e)&&u(e.message)&&(n+=`: ${e.message}`),bo.reportError(void 0,i,u(i)?i._errorEvent:void 0,n),new ue(n)}async function GZe(e,t,i){try{zZe(await e.fetchText(),t)}catch(t){HZe(t,e,i)}}function dl(e){e=y(e,{}),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=1.9,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._channel=e.channel,this._requestType="ImageryMaps",this._credit=new xt(`<a href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"><img src="${dl.logoUrl}" title="Google Imagery"/></a>`),this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=e.maximumLevel,this._errorEvent=new pe}Hue.prototype.build=function(e){e._channel=this.channel,e._version=this.version,e._tilingScheme=this.tilingScheme},Object.defineProperties(dl.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},version:{get:function(){return this._version}},requestType:{get:function(){return this._requestType}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),dl.fromUrl=async function(e,t,i){i=y(i,{});let n=y(i.path,"/default_map"),r=ve.createIfNeeded(e).getDerivedResource({url:"/"===n[0]?n.substring(1):n});r.appendForwardSlash();let o=r.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),a=new Hue(i);a.channel=t,await GZe(o,a);let s=new dl(i);return a.build(s),s._resource=r,s._url=e,s._path=n,s},dl.prototype.getTileCredits=function(e,t,i){},dl.prototype.requestImage=function(e,t,i,n){let r=this._resource.getDerivedResource({url:"query",request:n,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:e,y:t,z:i+1}});return el.loadImage(this,r)},dl.prototype.pickFeatures=function(e,t,i,n,r){},dl._logoUrl=void 0,Object.defineProperties(dl,{logoUrl:{get:function(){return u(dl._logoUrl)||(dl._logoUrl=$t("Assets/Images/google_earth_credit.png")),dl._logoUrl},set:function(e){dl._logoUrl=e}}});var m3=dl,WZe=/\/$/,Gue=new xt('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function rC(e){let t=(e=y(e,y.EMPTY_OBJECT)).mapId,i=e.accessToken;this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let n=ve.createIfNeeded(y(e.url,"https://{s}.tiles.mapbox.com/v4/"));this._mapId=t,this._accessToken=i;let r=y(e.format,"png");/\./.test(r)||(r=`.${r}`),this._format=r;let o,a=n.getUrlComponent();WZe.test(a)||(a+="/"),a+=`${t}/{z}/{x}/{y}${this._format}`,n.url=a,n.setQueryParameters({access_token:i}),u(e.credit)?(o=e.credit,"string"==typeof o&&(o=new xt(o))):o=Gue,this._resource=n,this._imageryProvider=new qa({url:n,credit:o,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(rC.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),rC.prototype.getTileCredits=function(e,t,i){},rC.prototype.requestImage=function(e,t,i,n){return this._imageryProvider.requestImage(e,t,i,n)},rC.prototype.pickFeatures=function(e,t,i,n,r){return this._imageryProvider.pickFeatures(e,t,i,n,r)},rC._defaultCredit=Gue;var p3=rC;function mx(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let t=y(e.rectangle,ce.MAX_VALUE),i=new Ui({rectangle:t,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=i,this._image=void 0,this._texture=void 0,this._hasError=!1,this._errorEvent=new pe;let n=e.credit;"string"==typeof n&&(n=new xt(n)),this._credit=n;let r=ve.createIfNeeded(e.url);this._resource=r,this._tileWidth=e.tileWidth,this._tileHeight=e.tileHeight}function jZe(e,t,i,n){let r=`Failed to load image ${e.url}`;u(t)&&u(t.message)&&(r+=`: ${t.message}`);let o=bo.reportError(n,i,u(i)?i._errorEvent:void 0,r,0,0,0,t);if(o.retry)return KW(e,i,o);throw u(i)&&(i._hasError=!0),new ue(r)}async function KW(e,t,i){try{return await el.loadImage(null,e)}catch(n){return jZe(e,n,t,i)}}Object.defineProperties(mx.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),mx.fromUrl=async function(e,t){let i=ve.createIfNeeded(e),n=await KW(i);t=y(t,y.EMPTY_OBJECT);let r=new mx({...t,url:e,tileWidth:n.width,tileHeight:n.height});return r._image=n,r},mx.prototype.getTileCredits=function(e,t,i){},mx.prototype.requestImage=async function(e,t,i,n){if(!this._hasError&&!u(this._image)){let e=await KW(this._resource,this);return this._image=e,bo.reportSuccess(this._errorEvent),e}return this._image},mx.prototype.pickFeatures=function(e,t,i,n,r){};var _3=mx;function qZe(e,t,i){this.type=e,u(t)||("json"===e?t="application/json":"xml"===e?t="text/xml":"html"===e?t="text/html":"text"===e&&(t="text/plain")),this.format=t,u(i)||("json"===e?i=YZe:"xml"===e?i=$Ze:("html"===e||"text"===e)&&(i=Wue)),this.callback=i}function YZe(e){let t=[],i=e.features;for(let e=0;e<i.length;++e){let n=i[e],r=new vh;if(r.data=n,r.properties=n.properties,r.configureNameFromProperties(n.properties),r.configureDescriptionFromProperties(n.properties),u(n.geometry)&&"Point"===n.geometry.type){let e=n.geometry.coordinates[0],t=n.geometry.coordinates[1];r.position=fe.fromDegrees(e,t)}t.push(r)}return t}var ZW="http://www.mapinfo.com/mxp",XZe="http://www.esri.com/wms",KZe="http://www.opengis.net/wfs",ZZe="http://www.opengis.net/gml";function $Ze(e){let t=e.documentElement;if("MultiFeatureCollection"===t.localName&&t.namespaceURI===ZW)return QZe(e);if("FeatureInfoResponse"===t.localName&&t.namespaceURI===XZe)return JZe(e);if("FeatureCollection"===t.localName&&t.namespaceURI===KZe)return e$e(e);if("ServiceExceptionReport"===t.localName)throw new ue((new XMLSerializer).serializeToString(t));return"msGMLOutput"===t.localName?t$e(e):n$e(e)}function QZe(e){let t=[],i=e.documentElement.getElementsByTagNameNS(ZW,"Feature");for(let e=0;e<i.length;++e){let n=i[e],r={},o=n.getElementsByTagNameNS(ZW,"Val");for(let e=0;e<o.length;++e){let t=o[e];if(t.hasAttribute("ref")){let e=t.getAttribute("ref"),i=t.textContent.trim();r[e]=i}}let a=new vh;a.data=n,a.properties=r,a.configureNameFromProperties(r),a.configureDescriptionFromProperties(r),t.push(a)}return t}function JZe(e){let t,i=e.documentElement,n=[],r=i.getElementsByTagNameNS("*","FIELDS");if(r.length>0)for(let e=0;e<r.length;++e){let i=r[e];t={};let o=i.attributes;for(let e=0;e<o.length;++e){let i=o[e];t[i.name]=i.value}n.push(g3(i,t))}else{let e=i.getElementsByTagNameNS("*","FeatureInfo");for(let i=0;i<e.length;++i){let r=e[i];t={};let o=r.childNodes;for(let e=0;e<o.length;++e){let i=o[e];i.nodeType===Node.ELEMENT_NODE&&(t[i.localName]=i.textContent)}n.push(g3(r,t))}}return n}function e$e(e){let t=[],i=e.documentElement.getElementsByTagNameNS(ZZe,"featureMember");for(let e=0;e<i.length;++e){let n=i[e],r={};$W(n,r),t.push(g3(n,r))}return t}function t$e(e){let t,i=[],n=e.documentElement.childNodes;for(let e=0;e<n.length;e++)if(n[e].nodeType===Node.ELEMENT_NODE){t=n[e];break}if(!u(t))throw new ue("Unable to find first child of the feature info xml document");let r=t.childNodes;for(let e=0;e<r.length;++e){let t=r[e];if(t.nodeType===Node.ELEMENT_NODE){let e={};$W(t,e),i.push(g3(t,e))}}return i}function $W(e,t){let i=!0;for(let n=0;n<e.childNodes.length;++n){let r=e.childNodes[n];r.nodeType===Node.ELEMENT_NODE&&(i=!1),"Point"!==r.localName&&"LineString"!==r.localName&&"Polygon"!==r.localName&&"boundedBy"!==r.localName&&r.hasChildNodes()&&$W(r,t)&&(t[r.localName]=r.textContent)}return i}function g3(e,t){let i=new vh;return i.data=e,i.properties=t,i.configureNameFromProperties(t),i.configureDescriptionFromProperties(t),i}function n$e(e){let t=(new XMLSerializer).serializeToString(e),i=document.createElement("div"),n=document.createElement("pre");n.textContent=t,i.appendChild(n);let r=new vh;return r.data=e,r.description=i.innerHTML,[r]}var i$e=/<body>\s*<\/body>/im,o$e=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,r$e=/<title>([\s\S]*)<\/title>/im;function Wue(e){if(i$e.test(e)||o$e.test(e))return;let t,i=r$e.exec(e);i&&i.length>1&&(t=i[1]);let n=new vh;return n.name=t,n.description=e,n.data=e,[n]}var sC=qZe;function Sv(e){e=y(e,y.EMPTY_OBJECT),this._tileCache={},this._tilesRequestedForInterval=[];let t=this._clock=e.clock;this._times=e.times,this._requestImageFunction=e.requestImageFunction,this._reloadFunction=e.reloadFunction,this._currentIntervalIndex=-1,t.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(t)}function jue(e,t,i){return`${e}-${t}-${i}`}function s$e(e){let t=e.split("-");if(3===t.length)return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}function que(e){let t=e._times;if(!u(t))return;let i=e._clock,n=i.currentTime,r=i.canAnimate&&i.shouldAnimate,o=i.multiplier;if(!r&&0!==o)return;let a,s=t.indexOf(n);if(s<0)return;let l=t.get(s);return o>0?(a=J.secondsDifference(l.stop,n),++s):(a=J.secondsDifference(l.start,n),--s),a/=o,s>=0&&a<=5?t.get(s):void 0}function Yue(e,t,i){let n=e._times.indexOf(i.start),r=e._tileCache,o=r[n];u(o)||(o=r[n]={});let a=t.key;if(u(o[a]))return!0;let s=s$e(a),l=new Ko({throttle:!1,throttleByServer:!0,type:Jr.IMAGERY,priorityFunction:t.priorityFunction}),c=e._requestImageFunction(s.x,s.y,s.level,l,i);return!!u(c)&&(o[a]={promise:c,request:l},!0)}Object.defineProperties(Sv.prototype,{clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._clockOnTick(e),this._reloadFunction())}},times:{get:function(){return this._times},set:function(e){this._times!==e&&(this._times=e,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}}),Sv.prototype.getFromCache=function(e,t,i,n){let r,o=jue(e,t,i),a=this._tileCache[this._currentIntervalIndex];if(u(a)&&u(a[o])){let e=a[o];r=e.promise.catch((function(t){throw n.state=e.request.state,t})),delete a[o]}return r},Sv.prototype.checkApproachingInterval=function(e,t,i,n){let r=jue(e,t,i),o=this._tilesRequestedForInterval,a=que(this),s={key:r,priorityFunction:n.priorityFunction};(!u(a)||!Yue(this,s,a))&&o.push(s),o.length>=512&&o.splice(0,256)},Sv.prototype._clockOnTick=function(e){let t=e.currentTime,i=this._times.indexOf(t),n=this._currentIntervalIndex;if(i!==n){let e=this._tileCache[n];for(let t in e)e.hasOwnProperty(t)&&e[t].request.cancel();return delete this._tileCache[n],this._tilesRequestedForInterval=[],this._currentIntervalIndex=i,void this._reloadFunction()}let r=que(this);if(u(r)){let e=this._tilesRequestedForInterval,t=!0;for(;t&&0!==e.length;){let i=e.pop();t=Yue(this,i,r),t||e.push(i)}}};var aC=Sv,a$e=[3034,3035,3042,3043,3044],c$e=[4471,4559];function bd(e){if(e=y(e,y.EMPTY_OBJECT),u(e.times)&&!u(e.clock))throw new de("options.times was specified, so options.clock is required.");this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._getFeatureInfoUrl=y(e.getFeatureInfoUrl,e.url);let t=ve.createIfNeeded(e.url),i=ve.createIfNeeded(this._getFeatureInfoUrl);t.setQueryParameters(bd.DefaultParameters,!0),i.setQueryParameters(bd.GetFeatureInfoDefaultParameters,!0),u(e.parameters)&&t.setQueryParameters(Xue(e.parameters)),u(e.getFeatureInfoParameters)&&i.setQueryParameters(Xue(e.getFeatureInfoParameters));let n=this;this._reload=void 0,u(e.times)&&(this._timeDynamicImagery=new aC({clock:e.clock,times:e.times,requestImageFunction:function(e,t,i,r,o){return Kue(n,e,t,i,r,o)},reloadFunction:function(){u(n._reload)&&n._reload()}}));let r={};if(r.layers=e.layers,r.bbox="{westProjected},{southProjected},{eastProjected},{northProjected}",r.width="{width}",r.height="{height}",parseFloat(t.queryParameters.version)>=1.3){r.crs=y(e.crs,e.tilingScheme&&e.tilingScheme.projection instanceof Oi?"EPSG:3857":"CRS:84");let t=r.crs.split(":");if("EPSG"===t[0]&&2===t.length){let e=Number(t[1]);(e>=4e3&&e<5e3&&!c$e.includes(e)||a$e.includes(e))&&(r.bbox="{southProjected},{westProjected},{northProjected},{eastProjected}")}}else r.srs=y(e.srs,e.tilingScheme&&e.tilingScheme.projection instanceof Oi?"EPSG:3857":"EPSG:4326");t.setQueryParameters(r,!0),i.setQueryParameters(r,!0);let o={query_layers:e.layers,info_format:"{format}"};parseFloat(i.queryParameters.version)>=1.3?(o.i="{i}",o.j="{j}"):(o.x="{i}",o.y="{j}"),i.setQueryParameters(o,!0),this._resource=t,this._pickFeaturesResource=i,this._layers=e.layers,this._tileProvider=new qa({url:t,pickFeaturesUrl:i,tilingScheme:y(e.tilingScheme,new Ui({ellipsoid:e.ellipsoid})),rectangle:e.rectangle,tileWidth:e.tileWidth,tileHeight:e.tileHeight,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,subdomains:e.subdomains,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit,getFeatureInfoFormats:y(e.getFeatureInfoFormats,bd.DefaultGetFeatureInfoFormats),enablePickFeatures:e.enablePickFeatures})}function Kue(e,t,i,n,r,o){let a=u(o)?o.data:void 0,s=e._tileProvider;return u(a)&&s._resource.setQueryParameters(a),s.requestImage(t,i,n,r)}function l$e(e,t,i,n,r,o,a){let s=u(a)?a.data:void 0,l=e._tileProvider;return u(s)&&l._pickFeaturesResource.setQueryParameters(s),l.pickFeatures(t,i,n,r,o)}function Xue(e){let t={};for(let i in e)e.hasOwnProperty(i)&&(t[i.toLowerCase()]=e[i]);return t}Object.defineProperties(bd.prototype,{url:{get:function(){return this._resource._url}},proxy:{get:function(){return this._resource.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},getFeatureInfoUrl:{get:function(){return this._getFeatureInfoUrl}}}),bd.prototype.getTileCredits=function(e,t,i){return this._tileProvider.getTileCredits(e,t,i)},bd.prototype.requestImage=function(e,t,i,n){let r,o,a=this._timeDynamicImagery;return u(a)&&(o=a.currentInterval,r=a.getFromCache(e,t,i,n)),u(r)||(r=Kue(this,e,t,i,n,o)),u(r)&&u(a)&&a.checkApproachingInterval(e,t,i,n),r},bd.prototype.pickFeatures=function(e,t,i,n,r){let o=this._timeDynamicImagery;return l$e(this,e,t,i,n,r,u(o)?o.currentInterval:void 0)},bd.DefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"}),bd.GetFeatureInfoDefaultParameters=Object.freeze({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"}),bd.DefaultGetFeatureInfoFormats=Object.freeze([Object.freeze(new sC("json","application/json")),Object.freeze(new sC("xml","text/xml")),Object.freeze(new sC("text","text/html"))]);var y3=bd,u$e=Object.freeze({service:"WMTS",version:"1.0.0",request:"GetTile"});function wv(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let t=ve.createIfNeeded(e.url),i=e.style,n=e.tileMatrixSetID,r=t.url,o=r.match(/{/g);if(!u(o)||1===o.length&&/{s}/.test(r))t.setQueryParameters(u$e),this._useKvp=!0;else{let e={style:i,Style:i,TileMatrixSet:n};t.setTemplateValues(e),this._useKvp=!1}this._resource=t,this._layer=e.layer,this._style=i,this._tileMatrixSetID=n,this._tileMatrixLabels=e.tileMatrixLabels,this._format=y(e.format,"image/jpeg"),this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=u(e.tilingScheme)?e.tilingScheme:new zr({ellipsoid:e.ellipsoid}),this._tileWidth=y(e.tileWidth,256),this._tileHeight=y(e.tileHeight,256),this._minimumLevel=y(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._rectangle=y(e.rectangle,this._tilingScheme.rectangle),this._dimensions=e.dimensions;let a=this;this._reload=void 0,u(e.times)&&(this._timeDynamicImagery=new aC({clock:e.clock,times:e.times,requestImageFunction:function(e,t,i,n,r){return Zue(a,e,t,i,n,r)},reloadFunction:function(){u(a._reload)&&a._reload()}}));let s=this._tilingScheme.positionToTileXY(ce.southwest(this._rectangle),this._minimumLevel),l=this._tilingScheme.positionToTileXY(ce.northeast(this._rectangle),this._minimumLevel);Math.abs(l.x-s.x),Math.abs(l.y-s.y);this._errorEvent=new pe;let c=e.credit;this._credit="string"==typeof c?new xt(c):c,this._subdomains=e.subdomains,Array.isArray(this._subdomains)?this._subdomains=this._subdomains.slice():u(this._subdomains)&&this._subdomains.length>0?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"]}function Zue(e,t,i,n,r,o){let a,s,l=e._tileMatrixLabels,c=u(l)?l[n]:n.toString(),h=e._subdomains,d=e._dimensions,p=u(o)?o.data:void 0;if(e._useKvp){let o={};o.tilematrix=c,o.layer=e._layer,o.style=e._style,o.tilerow=i,o.tilecol=t,o.tilematrixset=e._tileMatrixSetID,o.format=e._format,u(d)&&(o=gt(o,d)),u(p)&&(o=gt(o,p)),s={s:h[(t+i+n)%h.length]},a=e._resource.getDerivedResource({queryParameters:o,request:r}),a.setTemplateValues(s)}else s={TileMatrix:c,TileRow:i.toString(),TileCol:t.toString(),s:h[(t+i+n)%h.length]},a=e._resource.getDerivedResource({request:r}),a.setTemplateValues(s),u(d)&&a.setTemplateValues(d),u(p)&&a.setTemplateValues(p);return el.loadImage(e,a)}Object.defineProperties(wv.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},dimensions:{get:function(){return this._dimensions},set:function(e){this._dimensions!==e&&(this._dimensions=e,u(this._reload)&&this._reload())}}}),wv.prototype.getTileCredits=function(e,t,i){},wv.prototype.requestImage=function(e,t,i,n){let r,o,a=this._timeDynamicImagery;return u(a)&&(o=a.currentInterval,r=a.getFromCache(e,t,i,n)),u(r)||(r=Zue(this,e,t,i,n,o)),u(r)&&u(a)&&a.checkApproachingInterval(e,t,i,n),r},wv.prototype.pickFeatures=function(e,t,i,n,r){};var x3=wv,f$e={ARCGIS_MAPSERVER:$_.fromUrl,BING:async(e,t)=>OL.fromUrl(e,t),GOOGLE_EARTH:async(e,t)=>{let i=t.channel;return delete t.channel,m3.fromUrl(e,i,t)},MAPBOX:(e,t)=>new p3({url:e,...t}),SINGLE_TILE:_3.fromUrl,TMS:hx.fromUrl,URL_TEMPLATE:(e,t)=>new qa({url:e,...t}),WMS:(e,t)=>new y3({url:e,...t}),WMTS:(e,t)=>new x3({url:e,...t})};function Xh(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileCredits=void 0,this._errorEvent=new pe}Object.defineProperties(Xh.prototype,{rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}},proxy:{get:function(){}}}),Xh.fromAssetId=async function(e,t){t=y(t,y.EMPTY_OBJECT);let i=Iu._createEndpointResource(e,t),n=e.toString()+t.accessToken+t.server,r=Xh._endpointCache[n];u(r)||(r=i.fetchJson(),Xh._endpointCache[n]=r);let o=await r;if("IMAGERY"!==o.type)throw new ue(`Cesium ion asset ${e} is not an imagery asset.`);let a,s=o.externalType;if(u(s)){let e=f$e[s];if(!u(e))throw new ue(`Unrecognized Cesium ion imagery type: ${s}`);let t={...o.options},i=t.url;delete t.url,a=await e(i,t)}else a=await hx.fromUrl(new Iu(o,i));let l=new Xh(t);return a.errorEvent.addEventListener((function(e){e.provider=l,l._errorEvent.raiseEvent(e)})),l._tileCredits=Iu.getCreditsFromEndpoint(o,i),l._imageryProvider=a,l},Xh.prototype.getTileCredits=function(e,t,i){let n=this._imageryProvider.getTileCredits(e,t,i);return u(n)?this._tileCredits.concat(n):this._tileCredits},Xh.prototype.requestImage=function(e,t,i,n){return this._imageryProvider.requestImage(e,t,i,n)},Xh.prototype.pickFeatures=function(e,t,i,n,r){return this._imageryProvider.pickFeatures(e,t,i,n,r)},Xh._endpointCache={};var Vg=Xh,d$e={AERIAL:2,AERIAL_WITH_LABELS:3,ROAD:4},Ug=Object.freeze(d$e);function h$e(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.style,Ug.AERIAL);return Vg.fromAssetId(t)}var zg=h$e,tfe=or(Sl(),1),$ue=576,m$e=100,vv="#ffffff",QW="#48b";function nfe(e,t){this.credit=e,this.count=y(t,1)}function p$e(e,t){let i=e.length;for(let n=0;n<i;n++){let i=e[n];if(xt.equals(i,t))return!0}return!1}function _$e(e){let t=e._previousCesiumCredit,i=e._currentCesiumCredit;xt.equals(i,t)||(u(t)&&e._cesiumCreditContainer.removeChild(t.element),u(i)&&e._cesiumCreditContainer.appendChild(i.element),e._previousCesiumCredit=i)}var ife="cesium-credit-delimiter",b3;function Que(e){let t=document.createElement("span");return t.textContent=e,t.className=ife,t}function Jue(e,t){if(u(t)){let i=document.createElement(t);i._creditId=e._creditId,i.appendChild(e),e=i}return e}function efe(e,t,i,n){let r=e.childNodes,o=-1;t.sort((function(e,t){return t.count-e.count}));for(let a=0;a<t.length;++a){let s=t[a].credit;if(u(s)){if(o=a,u(i)&&(o*=2,a>0)){let t=o-1;if(r.length<=t)e.appendChild(Que(i));else{let n=r[t];n.className!==ife&&e.replaceChild(Que(i),n)}}let t=s.element;if(r.length<=o)e.appendChild(Jue(t,n));else{let i=r[o];i._creditId!==s._id&&e.replaceChild(Jue(t,n),i)}}}for(++o;o<r.length;)e.removeChild(r[o])}function g$e(e){let t=e._lightboxCredits,i=e.viewport.clientWidth,n=e.viewport.clientHeight;i!==e._lastViewportWidth&&(i<$ue?(t.className="cesium-credit-lightbox cesium-credit-lightbox-mobile",t.style.marginTop="0"):(t.className="cesium-credit-lightbox cesium-credit-lightbox-expanded",t.style.marginTop=`${Math.floor(.5*(n-t.clientHeight))}px`),e._lastViewportWidth=i),i>=$ue&&n!==e._lastViewportHeight&&(t.style.marginTop=`${Math.floor(.5*(n-t.clientHeight))}px`,e._lastViewportHeight=n)}function Ya(e,t){let i=`${e} {`;for(let e in t)t.hasOwnProperty(e)&&(i+=`${e}: ${t[e]}; `);return i+=" }\n",i}function y$e(e){let t="";t+=Ya(".cesium-credit-lightbox-overlay",{display:"none","z-index":"1",position:"absolute",top:"0",left:"0",width:"100%",height:"100%","background-color":"rgba(80, 80, 80, 0.8)"}),t+=Ya(".cesium-credit-lightbox",{"background-color":"#303336",color:vv,position:"relative","min-height":`${m$e}px`,margin:"auto"}),t+=Ya(".cesium-credit-lightbox > ul > li a, .cesium-credit-lightbox > ul > li a:visited",{color:vv}),t+=Ya(".cesium-credit-lightbox > ul > li a:hover",{color:QW}),t+=Ya(".cesium-credit-lightbox.cesium-credit-lightbox-expanded",{border:"1px solid #444","border-radius":"5px","max-width":"370px"}),t+=Ya(".cesium-credit-lightbox.cesium-credit-lightbox-mobile",{height:"100%",width:"100%"}),t+=Ya(".cesium-credit-lightbox-title",{padding:"20px 20px 0 20px"}),t+=Ya(".cesium-credit-lightbox-close",{"font-size":"18pt",cursor:"pointer",position:"absolute",top:"0",right:"6px",color:vv}),t+=Ya(".cesium-credit-lightbox-close:hover",{color:QW}),t+=Ya(".cesium-credit-lightbox > ul",{margin:"0",padding:"12px 20px 12px 40px","font-size":"13px"}),t+=Ya(".cesium-credit-lightbox > ul > li",{"padding-bottom":"6px"}),t+=Ya(".cesium-credit-lightbox > ul > li *",{padding:"0",margin:"0"}),t+=Ya(".cesium-credit-expand-link",{"padding-left":"5px",cursor:"pointer","text-decoration":"underline",color:vv}),t+=Ya(".cesium-credit-expand-link:hover",{color:QW}),t+=Ya(".cesium-credit-text",{color:vv}),t+=Ya(".cesium-credit-textContainer *, .cesium-credit-logoContainer *",{display:"inline"});let i=y(function(e){if(e.shadowRoot)return e.shadowRoot;if(e.getRootNode){let t=e.getRootNode();if(t instanceof ShadowRoot)return t}}(e),document.head),n=document.createElement("style");n.innerHTML=t,i.appendChild(n)}function Qo(e,t,i){let n=this;i=y(i,document.body);let r=document.createElement("div");r.className="cesium-credit-lightbox-overlay",i.appendChild(r);let o=document.createElement("div");function a(e){o.contains(e.target)||n.hideLightbox()}o.className="cesium-credit-lightbox",r.appendChild(o),r.addEventListener("click",a,!1);let s=document.createElement("div");s.className="cesium-credit-lightbox-title",s.textContent="Data provided by:",o.appendChild(s);let l=document.createElement("a");l.onclick=this.hideLightbox.bind(this),l.innerHTML="&times;",l.className="cesium-credit-lightbox-close",o.appendChild(l);let u=document.createElement("ul");o.appendChild(u);let c=document.createElement("div");c.className="cesium-credit-logoContainer",c.style.display="inline",e.appendChild(c);let h=document.createElement("div");h.className="cesium-credit-textContainer",h.style.display="inline",e.appendChild(h);let d=document.createElement("a");d.className="cesium-credit-expand-link",d.onclick=this.showLightbox.bind(this),d.textContent="Data attribution",e.appendChild(d),y$e(e);let p=xt.clone(Qo.cesiumCredit);this._delimiter=y(t,"  "),this._screenContainer=h,this._cesiumCreditContainer=c,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=o,this._creditList=u,this._lightbox=r,this._hideLightbox=a,this._expandLink=d,this._expanded=!1,this._staticCredits=[],this._cesiumCredit=p,this._previousCesiumCredit=void 0,this._currentCesiumCredit=p,this._creditDisplayElementPool=[],this._creditDisplayElementIndex=0,this._currentFrameCredits={screenCredits:new bt,lightboxCredits:new bt},this._defaultCredit=void 0,this.viewport=i,this.container=e}function ofe(e,t,i,n){n=y(n,1);let r=t.get(i.id);if(u(r))r.count<Number.MAX_VALUE&&(r.count+=n);else{let o=e._creditDisplayElementPool,a=e._creditDisplayElementPoolIndex;a<o.length?(r=o[a],r.credit=i,r.count=n):(r=new nfe(i,n),o.push(r)),++e._creditDisplayElementPoolIndex,t.set(i.id,r)}}function rfe(){if(!u(b3)){let e=$t("Assets/Images/ion-credit.png");0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&0!==e.indexOf("data:")&&(e=new tfe.default(e).path()),b3=new xt(`<a href="https://cesium.com/" target="_blank"><img src="${e}" title="Cesium ion"/></a>`,!0)}return Qo._cesiumCreditInitialized||(Qo._cesiumCredit=b3,Qo._cesiumCreditInitialized=!0),b3}Qo.prototype.addCreditToNextFrame=function(e){if(e.isIon())return u(this._defaultCredit)||(this._defaultCredit=xt.clone(rfe())),void(this._currentCesiumCredit=this._defaultCredit);let t;t=e.showOnScreen?this._currentFrameCredits.screenCredits:this._currentFrameCredits.lightboxCredits,ofe(this,t,e)},Qo.prototype.addStaticCredit=function(e){let t=this._staticCredits;p$e(t,e)||t.push(e)},Qo.prototype.removeStaticCredit=function(e){let t=this._staticCredits,i=t.indexOf(e);-1!==i&&t.splice(i,1)},Qo.prototype.showLightbox=function(){this._lightbox.style.display="block",this._expanded=!0},Qo.prototype.hideLightbox=function(){this._lightbox.style.display="none",this._expanded=!1},Qo.prototype.update=function(){this._expanded&&g$e(this)},Qo.prototype.beginFrame=function(){let e=this._currentFrameCredits;this._creditDisplayElementPoolIndex=0;let t=e.screenCredits,i=e.lightboxCredits;t.removeAll(),i.removeAll();let n=this._staticCredits;for(let e=0;e<n.length;++e){let r=n[e],o=r.showOnScreen?t:i;r.isIon()&&xt.equals(Qo.cesiumCredit,this._cesiumCredit)||ofe(this,o,r,Number.MAX_VALUE)}xt.equals(Qo.cesiumCredit,this._cesiumCredit)||(this._cesiumCredit=xt.clone(Qo.cesiumCredit)),this._currentCesiumCredit=this._cesiumCredit},Qo.prototype.endFrame=function(){let e=this._currentFrameCredits.screenCredits.values;efe(this._screenContainer,e,this._delimiter,void 0);let t=this._currentFrameCredits.lightboxCredits.values;this._expandLink.style.display=t.length>0?"inline":"none",efe(this._creditList,t,void 0,"li"),_$e(this)},Qo.prototype.destroy=function(){return this._lightbox.removeEventListener("click",this._hideLightbox,!1),this.container.removeChild(this._cesiumCreditContainer),this.container.removeChild(this._screenContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),le(this)},Qo.prototype.isDestroyed=function(){return!1},Qo._cesiumCredit=void 0,Qo._cesiumCreditInitialized=!1,Object.defineProperties(Qo,{cesiumCredit:{get:function(){return rfe(),Qo._cesiumCredit},set:function(e){Qo._cesiumCredit=e,Qo._cesiumCreditInitialized=!0}}}),Qo.CreditDisplayElement=nfe;var T3=Qo;function Dv(e){let t=(e=y(e,y.EMPTY_OBJECT)).attributeName,i=e.perInstanceAttribute;u(i)||(i=!1);let n,r=y(e.glslDatatype,"vec3"),o=`v_${t}`;if("normal"===t||"tangent"===t||"bitangent"===t)n=`vec4 getColor() { return vec4((${o} + vec3(1.0)) * 0.5, 1.0); }\n`;else switch("st"===t&&(r="vec2"),r){case"float":n=`vec4 getColor() { return vec4(vec3(${o}), 1.0); }\n`;break;case"vec2":n=`vec4 getColor() { return vec4(${o}, 0.0, 1.0); }\n`;break;case"vec3":n=`vec4 getColor() { return vec4(${o}, 1.0); }\n`;break;case"vec4":n=`vec4 getColor() { return ${o}; }\n`}let a=`in vec3 position3DHigh;\nin vec3 position3DLow;\nin float batchId;\n${i?"":`in ${r} ${t};\n`}out ${r} ${o};\nvoid main()\n{\nvec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n${i?`${o} = czm_batchTable_${t}(batchId);\n`:`${o} = ${t};\n`}gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}`,s=`in ${r} ${o};\n${n}\nvoid main()\n{\nout_FragColor = getColor();\n}`;this.material=void 0,this.translucent=y(e.translucent,!1),this._vertexShaderSource=y(e.vertexShaderSource,a),this._fragmentShaderSource=y(e.fragmentShaderSource,s),this._renderState=no.getDefaultRenderState(!1,!1,e.renderState),this._closed=y(e.closed,!1),this._attributeName=t,this._glslDatatype=r}Object.defineProperties(Dv.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}}),Dv.prototype.getFragmentShaderSource=no.prototype.getFragmentShaderSource,Dv.prototype.isTranslucent=no.prototype.isTranslucent,Dv.prototype.getRenderState=no.prototype.getRenderState;var sfe=Dv;function A3(e){e=y(e,y.EMPTY_OBJECT),this._camera=e.camera,this._frustumSplits=e.frustumSplits,this._color=y(e.color,z.CYAN),this._updateOnChange=y(e.updateOnChange,!0),this.show=y(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var x$e=new h,b$e=new $,T$e=new Le,A$e=new Ei,C$e=new $c,E$e=new Qt,S$e=new Or,w$e=new z,v$e=[1,1e5];A3.prototype.update=function(e){if(!this.show)return;let t,i,n=this._planesPrimitives,r=this._outlinePrimitives;if(this._updateOnChange){for(i=n.length,t=0;t<i;++t)r[t]=r[t]&&r[t].destroy(),n[t]=n[t]&&n[t].destroy();n.length=0,r.length=0}if(0===n.length){let e,i=this._camera,o=i.frustum;e=o instanceof Ei?A$e:o instanceof $c?C$e:o instanceof Qt?E$e:S$e,e=o.clone(e);let a,s=this._frustumSplits;!u(s)||s.length<=1?(s=v$e,s[0]=this._camera.frustum.near,s[1]=this._camera.frustum.far,a=1):a=s.length-1;let l=i.positionWC,c=i.directionWC,d=i.upWC,p=i.rightWC;p=h.negate(p,x$e);let f=b$e;$.setColumn(f,0,p,f),$.setColumn(f,1,d,f),$.setColumn(f,2,c,f);let m=Le.fromRotationMatrix(f,T$e);for(n.length=r.length=a,t=0;t<a;++t)e.near=s[t],e.far=s[t+1],n[t]=new Sn({geometryInstances:new yt({geometry:new bT({origin:l,orientation:m,frustum:e,_drawNearPlane:0===t}),attributes:{color:kt.fromColor(z.fromAlpha(this._color,.1,w$e))},id:this.id,pickPrimitive:this}),appearance:new rn({translucent:!0,flat:!0}),asynchronous:!1}),r[t]=new Sn({geometryInstances:new yt({geometry:new V1({origin:l,orientation:m,frustum:e,_drawNearPlane:0===t}),attributes:{color:kt.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1})}for(i=n.length,t=0;t<i;++t)r[t].update(e),n[t].update(e)},A3.prototype.isDestroyed=function(){return!1},A3.prototype.destroy=function(){let e=this._planesPrimitives.length;for(let t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return le(this)};var kp=A3;function afe(){this._cachedShowFrustumsShaders={}}function D$e(e){let t={},i=e.vertexAttributes;for(let e in i)i.hasOwnProperty(e)&&(t[e]=i[e].index);return t}function I$e(e,t){let i=e.context,n=t,r=n.fragmentShaderSource.clone(),o=[];r.sources=r.sources.map((function(e){e=He.replaceMain(e,"czm_Debug_main");let t,i=/out_FragData_(\d+)/g;for(;null!==(t=i.exec(e));)-1===o.indexOf(t[1])&&o.push(t[1]);return e}));let a,s=o.length,l="";if(l+="uniform vec3 debugShowCommandsColor;\n",l+="uniform vec3 debugShowFrustumsColor;\n",l+="void main() \n{ \n    czm_Debug_main(); \n",s>0)for(a=0;a<s;++a)l+=`    out_FragData_${o[a]}.rgb *= debugShowCommandsColor;\n`,l+=`    out_FragData_${o[a]}.rgb *= debugShowFrustumsColor;\n`;else l+="    out_FragColor.rgb *= debugShowCommandsColor;\n",l+="    out_FragColor.rgb *= debugShowFrustumsColor;\n";l+="}",r.sources.push(l);let u=D$e(n);return Kt.fromCache({context:i,vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:r,attributeLocations:u})}var Iv=new z;function P$e(e,t){let i;return i=u(t.uniformMap)?t.uniformMap:{},u(i.debugShowCommandsColor)||u(i.debugShowFrustumsColor)||(i.debugShowCommandsColor=function(){return e.debugShowCommands?(u(t._debugColor)||(t._debugColor=z.fromRandom()),t._debugColor):z.WHITE},i.debugShowFrustumsColor=function(){return e.debugShowFrustums?(Iv.red=1&t.debugOverlappingFrustums?1:0,Iv.green=2&t.debugOverlappingFrustums?1:0,Iv.blue=4&t.debugOverlappingFrustums?1:0,Iv.alpha=1,Iv):z.WHITE}),i}var O$e=new et;afe.prototype.executeDebugShowFrustumsCommand=function(e,t,i){let n=t.shaderProgram.id,r=this._cachedShowFrustumsShaders[n];u(r)||(r=I$e(e,t.shaderProgram),this._cachedShowFrustumsShaders[n]=r);let o=et.shallowClone(t,O$e);o.shaderProgram=r,o.uniformMap=P$e(e,t),o.execute(e.context,i)};var C3=afe,E3="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 prevPosition3DHigh;\nin vec3 prevPosition3DLow;\nin vec3 nextPosition3DHigh;\nin vec3 nextPosition3DLow;\nin vec2 expandAndWidth;\nin vec4 color;\nin float batchId;\n\nout vec4 v_color;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = czm_computePosition();\n    vec4 prev = czm_computePrevPosition();\n    vec4 next = czm_computeNextPosition();\n\n    float angle;\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n\n    v_color = color;\n}\n",JW=`${of}\n${E3}`,R$e=UA;function px(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.translucent,!0),i=px.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=y(e.vertexShaderSource,JW),this._fragmentShaderSource=y(e.fragmentShaderSource,R$e),this._renderState=no.getDefaultRenderState(t,false,e.renderState),this._closed=false,this._vertexFormat=i}Bt.isInternetExplorer()||(JW=`#define CLIP_POLYLINE \n${JW}`),Object.defineProperties(px.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),px.VERTEX_FORMAT=Pe.POSITION_ONLY,px.prototype.getFragmentShaderSource=no.prototype.getFragmentShaderSource,px.prototype.isTranslucent=no.prototype.isTranslucent,px.prototype.getRenderState=no.prototype.getRenderState;var qr=px;function S3(e){e=y(e,y.EMPTY_OBJECT),this.length=y(e.length,1e7),this._length=void 0,this.width=y(e.width,2),this._width=void 0,this.show=y(e.show,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=new L,this.id=e.id,this._id=void 0,this._primitive=void 0}S3.prototype.update=function(e){if(this.show){if(!u(this._primitive)||!L.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=L.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,u(this._primitive)&&this._primitive.destroy(),0===this.modelMatrix[12]&&0===this.modelMatrix[13]&&0===this.modelMatrix[14]&&(this.modelMatrix[14]=.01);let e=new yt({geometry:new V_({positions:[h.ZERO,h.UNIT_X],width:this.width,vertexFormat:qr.VERTEX_FORMAT,colors:[z.RED,z.RED],arcType:Yt.NONE}),modelMatrix:L.multiplyByUniformScale(this.modelMatrix,this.length,new L),id:this.id,pickPrimitive:this}),t=new yt({geometry:new V_({positions:[h.ZERO,h.UNIT_Y],width:this.width,vertexFormat:qr.VERTEX_FORMAT,colors:[z.GREEN,z.GREEN],arcType:Yt.NONE}),modelMatrix:L.multiplyByUniformScale(this.modelMatrix,this.length,new L),id:this.id,pickPrimitive:this}),i=new yt({geometry:new V_({positions:[h.ZERO,h.UNIT_Z],width:this.width,vertexFormat:qr.VERTEX_FORMAT,colors:[z.BLUE,z.BLUE],arcType:Yt.NONE}),modelMatrix:L.multiplyByUniformScale(this.modelMatrix,this.length,new L),id:this.id,pickPrimitive:this});this._primitive=new Sn({geometryInstances:[e,t,i],appearance:new qr,asynchronous:!1})}this._primitive.update(e)}},S3.prototype.isDestroyed=function(){return!1},S3.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),le(this)};var w3=S3,v3="in vec4 positionEC;\n\nvoid main()\n{\n    vec3 position;\n    vec3 direction;\n    if (czm_orthographicIn3D == 1.0)\n    {\n        vec2 uv = (gl_FragCoord.xy -  czm_viewport.xy) / czm_viewport.zw;\n        vec2 minPlane = vec2(czm_frustumPlanes.z, czm_frustumPlanes.y); // left, bottom\n        vec2 maxPlane = vec2(czm_frustumPlanes.w, czm_frustumPlanes.x); // right, top\n        position = vec3(mix(minPlane, maxPlane, uv), 0.0);\n        direction = vec3(0.0, 0.0, -1.0);\n    } \n    else \n    {\n        position = vec3(0.0);\n        direction = normalize(positionEC.xyz);\n    }\n\n    czm_ray ray = czm_ray(position, direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n    if (!czm_isEmpty(intersection))\n    {\n        out_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n    }\n    else\n    {\n        discard;\n    }\n\n    czm_writeLogDepth();\n}\n",D3="in vec4 position;\n\nout vec4 positionEC;\n\nvoid main()\n{\n    positionEC = czm_modelView * position;\n    gl_Position = czm_projection * positionEC;\n\n    czm_vertexLogDepth();\n}\n";function Ov(e){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1,this._ellipsoidOffset=y(e,0)}var Pv=Bt.supportsTypedArrays()?new Float32Array(12):[],cfe=new h,lfe=new h,ej=new h,ufe=new h,I3=new h;function M$e(e,t){let i,n,r,o=e.radii,a=t.camera;if(a.frustum instanceof Qt)i=h.ZERO,n=a.rightWC,r=a.upWC;else{let t=a.positionWC,o=h.multiplyComponents(e.oneOverRadii,t,cfe),s=h.normalize(o,lfe),l=h.normalize(h.cross(h.UNIT_Z,o,ej),ej),u=h.normalize(h.cross(s,l,ufe),ufe),c=h.magnitude(o),d=Math.sqrt(c*c-1);i=h.multiplyByScalar(s,1/c,cfe);let p=d/c;n=h.multiplyByScalar(l,p,lfe),r=h.multiplyByScalar(u,p,ej)}let s=h.add(i,r,I3);h.subtract(s,n,s),h.multiplyComponents(o,s,s),h.pack(s,Pv,0);let l=h.subtract(i,r,I3);h.subtract(l,n,l),h.multiplyComponents(o,l,l),h.pack(l,Pv,3);let u=h.add(i,r,I3);h.add(u,n,u),h.multiplyComponents(o,u,u),h.pack(u,Pv,6);let c=h.subtract(i,r,I3);return h.add(c,n,c),h.multiplyComponents(o,c,c),h.pack(c,Pv,9),Pv}Ov.prototype.update=function(e){if(this._mode=e.mode,e.mode!==te.SCENE3D)return;let t=e.context,i=e.mapProjection.ellipsoid.radii,n=new ie(i.x+this._ellipsoidOffset,i.y+this._ellipsoidOffset,i.z+this._ellipsoidOffset),r=e.useLogDepth;if(u(this._command)||(this._rs=Ue.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new et({renderState:this._rs,boundingVolume:new se(h.ZERO,n.maximumRadius),pass:Ee.OPAQUE,owner:this})),!u(this._sp)||this._useLogDepth!==r){this._useLogDepth=r;let e=new He({sources:[D3]}),i=new He({sources:[v3]});r&&(i.defines.push("LOG_DEPTH"),e.defines.push("LOG_DEPTH")),this._sp=Kt.replaceCache({shaderProgram:this._sp,context:t,vertexShaderSource:e,fragmentShaderSource:i,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}let o=M$e(n,e);if(u(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(o);else{let e=new ct({attributes:{position:new Se({componentDatatype:X.FLOAT,componentsPerAttribute:3,values:o})},indices:[0,1,2,2,1,3],primitiveType:Ne.TRIANGLES});this._va=ni.fromGeometry({context:t,geometry:e,attributeLocations:{position:0},bufferUsage:Be.DYNAMIC_DRAW}),this._command.vertexArray=this._va}},Ov.prototype.execute=function(e,t){this._mode===te.SCENE3D&&this._command.execute(e,t)},Ov.prototype.isDestroyed=function(){return!1},Ov.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()};var P3=Ov;function Rv(){}var L$e=/\bgl_FragDepth\b/,N$e=/\bdiscard\b/;function F$e(e,t){let i=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if(!u(i)){let n,r=t._attributeLocations,o=t.fragmentShaderSource,a=!1,s=o.sources,l=s.length;for(n=0;n<l;++n)if(L$e.test(s[n])||N$e.test(s[n])){a=!0;break}let u,c=!1,h=o.defines;for(l=h.length,n=0;n<l;++n)if("LOG_DEPTH"===h[n]){c=!0;break}a||c?!a&&c&&(u="void main() \n{ \n    out_FragColor = vec4(1.0); \n    czm_writeLogDepth(); \n} \n",o=new He({defines:["LOG_DEPTH"],sources:[u]})):(u="void main() \n{ \n    out_FragColor = vec4(1.0); \n} \n",o=new He({sources:[u]})),i=e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:o,attributeLocations:r})}return i}function B$e(e,t){let i=e._depthOnlyRenderStateCache,n=i[t.id];if(!u(n)){let e=Ue.getState(t);e.depthMask=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1},n=Ue.fromCache(e),i[t.id]=n}return n}Rv.createDepthOnlyDerivedCommand=function(e,t,i,n){let r,o;return u(n)||(n={}),u(n.depthOnlyCommand)&&(r=n.depthOnlyCommand.shaderProgram,o=n.depthOnlyCommand.renderState),n.depthOnlyCommand=et.shallowClone(t,n.depthOnlyCommand),u(r)&&n.shaderProgramId===t.shaderProgram.id?(n.depthOnlyCommand.shaderProgram=r,n.depthOnlyCommand.renderState=o):(n.depthOnlyCommand.shaderProgram=F$e(i,t.shaderProgram),n.depthOnlyCommand.renderState=B$e(e,t.renderState),n.shaderProgramId=t.shaderProgram.id),n};var k$e=/\s+czm_writeLogDepth\(/,V$e=/\s+czm_vertexLogDepth\(/;function U$e(e,t){if(t.fragmentShaderSource.defines.indexOf("LOG_DEPTH_READ_ONLY")>=0)return t;let i=e.shaderCache.getDerivedShaderProgram(t,"logDepth");if(!u(i)){let n=t._attributeLocations,r=t.vertexShaderSource.clone(),o=t.fragmentShaderSource.clone();r.defines=u(r.defines)?r.defines.slice(0):[],r.defines.push("LOG_DEPTH"),o.defines=u(o.defines)?o.defines.slice(0):[],o.defines.push("LOG_DEPTH");let a,s,l=!1,c=r.sources,h=c.length;for(a=0;a<h;++a)if(V$e.test(c[a])){l=!0;break}if(!l){for(a=0;a<h;++a)c[a]=He.replaceMain(c[a],"czm_log_depth_main");s="\n\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_vertexLogDepth(); \n} \n",c.push(s)}for(c=o.sources,h=c.length,l=!1,a=0;a<h;++a)k$e.test(c[a])&&(l=!0);-1!==o.defines.indexOf("LOG_DEPTH_WRITE")&&(l=!0);let d="";if(!l){for(a=0;a<h;a++)c[a]=He.replaceMain(c[a],"czm_log_depth_main");d+="\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_writeLogDepth(); \n} \n"}c.push(d),i=e.shaderCache.createDerivedShaderProgram(t,"logDepth",{vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:n})}return i}function z$e(e,t,i){let n=e.shaderCache.getDerivedShaderProgram(t,"pick");if(!u(n)){let r=t._attributeLocations,o=t.fragmentShaderSource,a=o.sources,s=a.length,l=a.some((e=>e.includes("out_FragData")))?"out_FragData_0":"out_FragColor",u=`void main () \n{ \n    czm_non_pick_main(); \n    if (${l}.a == 0.0) { \n        discard; \n    } \n    ${l} = ${i}; \n} `,c=new Array(s+1);for(let e=0;e<s;++e)c[e]=He.replaceMain(a[e],"czm_non_pick_main");c[s]=u,o=new He({sources:c,defines:o.defines}),n=e.shaderCache.createDerivedShaderProgram(t,"pick",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:o,attributeLocations:r})}return n}function H$e(e,t){let i=e.picking.pickRenderStateCache,n=i[t.id];if(!u(n)){let e=Ue.getState(t);e.blending.enabled=!1,e.depthMask=!0,n=Ue.fromCache(e),i[t.id]=n}return n}function G$e(e,t){let i=e.shaderCache.getDerivedShaderProgram(t,"HDR");if(!u(i)){let n=t._attributeLocations,r=t.vertexShaderSource.clone(),o=t.fragmentShaderSource.clone();r.defines=u(r.defines)?r.defines.slice(0):[],r.defines.push("HDR"),o.defines=u(o.defines)?o.defines.slice(0):[],o.defines.push("HDR"),i=e.shaderCache.createDerivedShaderProgram(t,"HDR",{vertexShaderSource:r,fragmentShaderSource:o,attributeLocations:n})}return i}Rv.createLogDepthCommand=function(e,t,i){let n;return u(i)||(i={}),u(i.command)&&(n=i.command.shaderProgram),i.command=et.shallowClone(e,i.command),u(n)&&i.shaderProgramId===e.shaderProgram.id?i.command.shaderProgram=n:(i.command.shaderProgram=U$e(t,e.shaderProgram),i.shaderProgramId=e.shaderProgram.id),i},Rv.createPickDerivedCommand=function(e,t,i,n){let r,o;return u(n)||(n={}),u(n.pickCommand)&&(r=n.pickCommand.shaderProgram,o=n.pickCommand.renderState),n.pickCommand=et.shallowClone(t,n.pickCommand),u(r)&&n.shaderProgramId===t.shaderProgram.id?(n.pickCommand.shaderProgram=r,n.pickCommand.renderState=o):(n.pickCommand.shaderProgram=z$e(i,t.shaderProgram,t.pickId),n.pickCommand.renderState=H$e(e,t.renderState),n.shaderProgramId=t.shaderProgram.id),n},Rv.createHdrCommand=function(e,t,i){let n;return u(i)||(i={}),u(i.command)&&(n=i.command.shaderProgram),i.command=et.shallowClone(e,i.command),u(n)&&i.shaderProgramId===e.shaderProgram.id?i.command.shaderProgram=n:(i.command.shaderProgram=G$e(t,e.shaderProgram),i.shaderProgramId=e.shaderProgram.id),i};var Hg=Rv;function O3(e){this._scene=e,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;let t=this;function i(e){let i=e.alpha;if(!u(i))return t._alpha=void 0,t._beta=void 0,void(t._gamma=void 0);t._alpha=P.toRadians(i),t._beta=P.toRadians(e.beta),t._gamma=P.toRadians(e.gamma)}window.addEventListener("deviceorientation",i,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",i,!1)}}var W$e=new Le,ffe=new Le,j$e=new $;function q$e(e,t,i,n){let r=e.direction,o=e.right,a=e.up,s=Le.fromAxisAngle(r,i,ffe),l=Le.fromAxisAngle(o,n,W$e),u=Le.multiply(l,s,l),c=Le.fromAxisAngle(a,t,ffe);Le.multiply(c,u,u);let h=$.fromQuaternion(u,j$e);$.multiplyByVector(h,o,o),$.multiplyByVector(h,a,a),$.multiplyByVector(h,r,r)}O3.prototype.update=function(){if(!u(this._alpha))return;u(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);let e=this._lastAlpha-this._alpha,t=this._lastBeta-this._beta,i=this._lastGamma-this._gamma;q$e(this._scene.camera,-e,t,i),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma},O3.prototype.isDestroyed=function(){return!1},O3.prototype.destroy=function(){return this._removeListener(),le(this)};var R3=O3;function Y$e(e){this.direction=h.clone(e.direction),this.color=z.clone(y(e.color,z.WHITE)),this.intensity=y(e.intensity,1)}var dfe=Y$e,Mv="uniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\n\nin vec3 v_positionEC;\n\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\n    vec3 positionEC = czm_pointAlongRay(ray, intersection);\n    vec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\n    vec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\n    vec3 sphericalNormal = normalize(positionMC / u_radii);\n    vec3 normalMC = geodeticNormal * side;              // normalized surface normal (always facing the viewer) in model coordinates\n    vec3 normalEC = normalize(czm_normal * normalMC);   // normalized surface normal in eye coordinates\n\n    vec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\n    vec3 positionToEyeEC = -positionEC;\n\n    czm_materialInput materialInput;\n    materialInput.s = st.s;\n    materialInput.st = st;\n    materialInput.str = (positionMC + u_radii) / u_radii;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef ONLY_SUN_LIGHTING\n    return czm_private_phong(normalize(positionToEyeEC), material, czm_sunDirectionEC);\n#else\n    return czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n\nvoid main()\n{\n    // PERFORMANCE_TODO: When dynamic branching is available, compute ratio of maximum and minimum radii\n    // in the vertex shader. Only when it is larger than some constant, march along the ray.\n    // Otherwise perform one intersection test which will be the common case.\n\n    // Test if the ray intersects a sphere with the ellipsoid's maximum radius.\n    // For very oblate ellipsoids, using the ellipsoid's radii for an intersection test\n    // may cause false negatives. This will discard fragments before marching the ray forward.\n    float maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\n    vec3 direction = normalize(v_positionEC);\n    vec3 ellipsoidCenter = czm_modelView[3].xyz;\n\n    float t1 = -1.0;\n    float t2 = -1.0;\n\n    float b = -2.0 * dot(direction, ellipsoidCenter);\n    float c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\n\n    float discriminant = b * b - 4.0 * c;\n    if (discriminant >= 0.0) {\n        t1 = (-b - sqrt(discriminant)) * 0.5;\n        t2 = (-b + sqrt(discriminant)) * 0.5;\n    }\n\n    if (t1 < 0.0 && t2 < 0.0) {\n        discard;\n    }\n\n    float t = min(t1, t2);\n    if (t < 0.0) {\n        t = 0.0;\n    }\n\n    // March ray forward to intersection with larger sphere and find\n    czm_ray ray = czm_ray(t * direction, direction);\n\n    vec3 ellipsoid_inverseRadii = vec3(1.0 / u_radii.x, 1.0 / u_radii.y, 1.0 / u_radii.z);\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoidCenter, ellipsoid_inverseRadii);\n\n    if (czm_isEmpty(intersection))\n    {\n        discard;\n    }\n\n    // If the viewer is outside, compute outsideFaceColor, with normals facing outward.\n    vec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\n\n    // If the viewer either is inside or can see inside, compute insideFaceColor, with normals facing inward.\n    vec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\n\n    out_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\n    out_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n\n#if (defined(WRITE_DEPTH) && (__VERSION__ == 300 || defined(GL_EXT_frag_depth)))\n    t = (intersection.start != 0.0) ? intersection.start : intersection.stop;\n    vec3 positionEC = czm_pointAlongRay(ray, t);\n    vec4 positionCC = czm_projection * vec4(positionEC, 1.0);\n#ifdef LOG_DEPTH\n    czm_writeLogDepth(1.0 + positionCC.w);\n#else\n    float z = positionCC.z / positionCC.w;\n\n    float n = czm_depthRange.near;\n    float f = czm_depthRange.far;\n\n    gl_FragDepth = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n}\n",Lv="in vec3 position;\n\nuniform vec3 u_radii;\n\nout vec3 v_positionEC;\n\nvoid main()\n{\n    // In the vertex data, the cube goes from (-1.0, -1.0, -1.0) to (1.0, 1.0, 1.0) in model coordinates.\n    // Scale to consider the radii.  We could also do this once on the CPU when using the BoxGeometry,\n    // but doing it here allows us to change the radii without rewriting the vertex data, and\n    // allows all ellipsoids to reuse the same vertex data.\n    vec4 p = vec4(u_radii * position, 1.0);\n\n    v_positionEC = (czm_modelView * p).xyz;     // position in eye coordinates\n    gl_Position = czm_modelViewProjection * p;  // position in clip coordinates\n\n    // With multi-frustum, when the ellipsoid primitive is positioned on the intersection of two frustums\n    // and close to terrain, the terrain (writes depth) in the closest frustum can overwrite part of the\n    // ellipsoid (does not write depth) that was rendered in the farther frustum.\n    //\n    // Here, we clamp the depth in the vertex shader to avoid being overwritten; however, this creates\n    // artifacts since some fragments can be alpha blended twice.  This is solved by only rendering\n    // the ellipsoid in the closest frustum to the viewer.\n    gl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n\n    czm_vertexLogDepth();\n}\n",tj={position:0};function M3(e){e=y(e,y.EMPTY_OBJECT),this.center=h.clone(y(e.center,h.ZERO)),this._center=new h,this.radii=h.clone(e.radii),this._radii=new h,this._oneOverEllipsoidRadiiSquared=new h,this._boundingSphere=new se,this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=new L,this._computedModelMatrix=new L,this.show=y(e.show,!0),this.material=y(e.material,Wi.fromType(Wi.ColorType)),this._material=void 0,this._translucent=void 0,this.id=e.id,this._id=void 0,this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.onlySunLighting=y(e.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=y(e.depthTestEnabled,!0),this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new et({owner:y(e._owner,this)}),this._pickCommand=new et({owner:y(e._owner,this),pickOnly:!0});let t=this;this._uniforms={u_radii:function(){return t.radii},u_oneOverEllipsoidRadiiSquared:function(){return t._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return t._pickId.color}}}function X$e(e){let t=e.cache.ellipsoidPrimitive_vertexArray;if(u(t))return t;let i=Dl.createGeometry(Dl.fromDimensions({dimensions:new h(2,2,2),vertexFormat:Pe.POSITION_ONLY}));return t=ni.fromGeometry({context:e,geometry:i,attributeLocations:tj,bufferUsage:Be.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=t,t}M3.prototype.update=function(e){if(!this.show||e.mode!==te.SCENE3D||!u(this.center)||!u(this.radii))return;let t=e.context,i=this.material.isTranslucent(),n=this._translucent!==i;(!u(this._rs)||n)&&(this._translucent=i,this._rs=Ue.fromCache({cull:{enabled:!0,face:gi.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!i&&t.fragmentDepth,blending:i?ln.ALPHA_BLEND:void 0})),u(this._va)||(this._va=X$e(t));let r=!1,o=this.radii;if(!h.equals(this._radii,o)){h.clone(o,this._radii);let e=this._oneOverEllipsoidRadiiSquared;e.x=1/(o.x*o.x),e.y=1/(o.y*o.y),e.z=1/(o.z*o.z),r=!0}(!L.equals(this.modelMatrix,this._modelMatrix)||!h.equals(this.center,this._center))&&(L.clone(this.modelMatrix,this._modelMatrix),h.clone(this.center,this._center),L.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),r=!0),r&&(h.clone(h.ZERO,this._boundingSphere.center),this._boundingSphere.radius=h.maximumComponent(o),se.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));let a=this._material!==this.material;this._material=this.material,this._material.update(t);let s=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;let l=e.useLogDepth,c=this._useLogDepth!==l;this._useLogDepth=l;let d,p,f=this._colorCommand;(a||s||n||c)&&(d=new He({sources:[Lv]}),p=new He({sources:[this.material.shaderSource,Mv]}),this.onlySunLighting&&p.defines.push("ONLY_SUN_LIGHTING"),!i&&t.fragmentDepth&&p.defines.push("WRITE_DEPTH"),this._useLogDepth&&(d.defines.push("LOG_DEPTH"),p.defines.push("LOG_DEPTH")),this._sp=Kt.replaceCache({context:t,shaderProgram:this._sp,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:tj}),f.vertexArray=this._va,f.renderState=this._rs,f.shaderProgram=this._sp,f.uniformMap=gt(this._uniforms,this.material._uniforms),f.executeInClosestFrustum=i);let m=e.commandList,_=e.passes;if(_.render&&(f.boundingVolume=this._boundingSphere,f.debugShowBoundingVolume=this.debugShowBoundingVolume,f.modelMatrix=this._computedModelMatrix,f.pass=i?Ee.TRANSLUCENT:Ee.OPAQUE,m.push(f)),_.pick){let e=this._pickCommand;(!u(this._pickId)||this._id!==this.id)&&(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=t.createPickId({primitive:this,id:this.id})),(a||s||!u(this._pickSP)||c)&&(d=new He({sources:[Lv]}),p=new He({sources:[this.material.shaderSource,Mv],pickColorQualifier:"uniform"}),this.onlySunLighting&&p.defines.push("ONLY_SUN_LIGHTING"),!i&&t.fragmentDepth&&p.defines.push("WRITE_DEPTH"),this._useLogDepth&&(d.defines.push("LOG_DEPTH"),p.defines.push("LOG_DEPTH")),this._pickSP=Kt.replaceCache({context:t,shaderProgram:this._pickSP,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:tj}),e.vertexArray=this._va,e.renderState=this._rs,e.shaderProgram=this._pickSP,e.uniformMap=gt(gt(this._uniforms,this._pickUniforms),this.material._uniforms),e.executeInClosestFrustum=i),e.boundingVolume=this._boundingSphere,e.modelMatrix=this._computedModelMatrix,e.pass=i?Ee.TRANSLUCENT:Ee.OPAQUE,m.push(e)}},M3.prototype.isDestroyed=function(){return!1},M3.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),le(this)};var L3=M3,N3="in vec3 v_positionMC;\nin vec3 v_positionEC;\nin vec2 v_st;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n\n    vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    materialInput.s = v_st.s;\n    materialInput.st = v_st;\n    materialInput.str = vec3(v_st, 0.0);\n\n    // Convert tangent space material normal to eye space\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\n\n    // Convert view vector to world space\n    vec3 positionToEyeEC = -v_positionEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n",F3="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec2 st;\nin float batchId;\n\nout vec3 v_positionMC;\nout vec3 v_positionEC;\nout vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionMC = position3DHigh + position3DLow;           // position in model coordinates\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;     // position in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n";function _x(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.translucent,!0),i=y(e.aboveGround,!1);this.material=u(e.material)?e.material:Wi.fromType(Wi.ColorType),this.translucent=y(e.translucent,!0),this._vertexShaderSource=y(e.vertexShaderSource,F3),this._fragmentShaderSource=y(e.fragmentShaderSource,N3),this._renderState=no.getDefaultRenderState(t,!i,e.renderState),this._closed=!1,this._flat=y(e.flat,!1),this._faceForward=y(e.faceForward,i),this._aboveGround=i}Object.defineProperties(_x.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return _x.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}}),_x.VERTEX_FORMAT=Pe.POSITION_AND_ST,_x.prototype.getFragmentShaderSource=no.prototype.getFragmentShaderSource,_x.prototype.isTranslucent=no.prototype.isTranslucent,_x.prototype.getRenderState=no.prototype.getRenderState;var hfe=_x;function mfe(){this.enabled=!0,this.renderable=!0,this.density=2e-4,this.screenSpaceErrorFactor=2,this.minimumBrightness=.03}var B3=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],Kh=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7];for(let e=0;e<Kh.length;++e)Kh[e]*=1e6;var pfe=Kh[1],nj=Kh[Kh.length-1];for(let e=0;e<Kh.length;++e)Kh[e]=(Kh[e]-nj)/(pfe-nj);var Hs=0;function K$e(e){let t,i=B3,n=i.length;if(e<i[0])return Hs=0;if(e>i[n-1])return Hs=n-2;if(e>=i[Hs]){if(Hs+1<n&&e<i[Hs+1])return Hs;if(Hs+2<n&&e<i[Hs+2])return++Hs}else if(Hs-1>=0&&e>=i[Hs-1])return--Hs;for(t=0;t<n-2&&!(e>=i[t]&&e<i[t+1]);++t);return Hs=t}var Z$e=new h;mfe.prototype.update=function(e){if(!(e.fog.enabled=this.enabled))return;e.fog.renderable=this.renderable;let t=e.camera,i=t.positionCartographic;if(!u(i)||i.height>8e5||e.mode!==te.SCENE3D)return void(e.fog.enabled=!1);let n=i.height,r=K$e(n),o=P.clamp((n-B3[r])/(B3[r+1]-B3[r]),0,1),a=P.lerp(Kh[r],Kh[r+1],o),s=1e6*this.density;a=a*(s-s/pfe*nj)*1e-6;let l=h.normalize(t.positionWC,Z$e);a*=1-Math.abs(h.dot(t.directionWC,l)),e.fog.density=a,e.fog.sse=this.screenSpaceErrorFactor,e.fog.minimumBrightness=this.minimumBrightness};var k3=mfe;function hl(e){this._scene=e.scene,this.samplingWindow=y(e.samplingWindow,hl.defaultSettings.samplingWindow),this.quietPeriod=y(e.quietPeriod,hl.defaultSettings.quietPeriod),this.warmupPeriod=y(e.warmupPeriod,hl.defaultSettings.warmupPeriod),this.minimumFrameRateDuringWarmup=y(e.minimumFrameRateDuringWarmup,hl.defaultSettings.minimumFrameRateDuringWarmup),this.minimumFrameRateAfterWarmup=y(e.minimumFrameRateAfterWarmup,hl.defaultSettings.minimumFrameRateAfterWarmup),this._lowFrameRate=new pe,this._nominalFrameRate=new pe,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;let t=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener((function(e,i){$$e(t,i)})),this._hiddenPropertyName=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0;let i=void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0;function n(){Q$e(t)}this._visibilityChangeRemoveListener=void 0,u(i)&&(document.addEventListener(i,n,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(i,n,!1)})}function $$e(e,t){if(e._pauseCount>0)return;let i=_i();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=i+e.quietPeriod/Xn.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/Xn.SECONDS_PER_MILLISECOND;else if(i>=e._quietPeriodEndTime){e._frameTimes.push(i);let t=i-e.samplingWindow/Xn.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=t){for(;e._frameTimes.length>=2&&e._frameTimes[1]<t;)e._frameTimes.shift();let n=(i-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/n,n>1e3/(i>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup)?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}function Q$e(e){document[e._hiddenPropertyName]?e.pause():e.unpause()}hl.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8},hl.fromScene=function(e){return(!u(e._frameRateMonitor)||e._frameRateMonitor.isDestroyed())&&(e._frameRateMonitor=new hl({scene:e})),e._frameRateMonitor},Object.defineProperties(hl.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}}),hl.prototype.pause=function(){++this._pauseCount,1===this._pauseCount&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)},hl.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)},hl.prototype.isDestroyed=function(){return!1},hl.prototype.destroy=function(){return this._preUpdateRemoveListener(),u(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),le(this)};var V3=hl;function J$e(e,t,i){this.context=e,this.commandList=[],this.shadowMaps=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=te.SCENE3D,this.morphTime=te.getMorphTime(te.SCENE3D),this.frameNumber=0,this.newFrame=!1,this.time=void 0,this.jobScheduler=i,this.mapProjection=void 0,this.camera=void 0,this.cameraUnderground=!1,this.globeTranslucencyState=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.pixelRatio=1,this.passes={render:!1,pick:!1,depth:!1,postProcess:!1,offscreen:!1},this.creditDisplay=t,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.shadowState={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.splitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.light=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.useLogDepth=!1,this.tilesetPassState=void 0,this.minimumTerrainHeight=0}var U3=J$e;function eQe(e,t){this.near=y(e,0),this.far=y(t,0);let i=Ee.NUMBER_OF_PASSES,n=new Array(i),r=new Array(i);for(let e=0;e<i;++e)n[e]=[],r[e]=0;this.commands=n,this.indices=r}var z3=eQe;function tQe(e,t,i){return`    float clipDistance = clip(gl_FragCoord, ${e}, ${t}); \n    vec4 clippingPlanesEdgeColor = vec4(1.0); \n    clippingPlanesEdgeColor.rgb = ${i}.rgb; \n    float clippingPlanesEdgeWidth = ${i}.a; \n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) \n    { \n        out_FragColor = clippingPlanesEdgeColor;\n    } \n`}var H3=tQe,G3="uniform vec4 u_initialColor;\n\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_DAY_NIGHT_ALPHA\nuniform float u_dayTextureNightAlpha[TEXTURE_UNITS];\nuniform float u_dayTextureDayAlpha[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\n\n#ifdef APPLY_COLOR_TO_ALPHA\nuniform vec4 u_colorsToAlpha[TEXTURE_UNITS];\n#endif\n\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\nuniform highp sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG) && defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\nuniform float u_minimumBrightness;\n#endif\n\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift; // Hue, saturation, brightness\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\nuniform vec4 u_fillHighlightColor;\n#endif\n\n#ifdef TRANSLUCENT\nuniform vec4 u_frontFaceAlphaByDistance;\nuniform vec4 u_backFaceAlphaByDistance;\nuniform vec4 u_translucencyRectangle;\n#endif\n\n#ifdef UNDERGROUND_COLOR\nuniform vec4 u_undergroundColor;\nuniform vec4 u_undergroundColorAlphaByDistance;\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\nuniform float u_lambertDiffuseMultiplier;\nuniform float u_vertexShadowDarkness;\n#endif\n\nin vec3 v_positionMC;\nin vec3 v_positionEC;\nin vec3 v_textureCoordinates;\nin vec3 v_normalMC;\nin vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nin float v_height;\nin float v_slope;\nin float v_aspect;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nin float v_distance;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\nin vec3 v_atmosphereRayleighColor;\nin vec3 v_atmosphereMieColor;\nin float v_atmosphereOpacity;\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nfloat interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n#endif\n\n#if defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT) || defined(APPLY_MATERIAL)\nvec4 alphaBlend(vec4 sourceColor, vec4 destinationColor)\n{\n    return sourceColor * vec4(sourceColor.aaa, 1.0) + destinationColor * (1.0 - sourceColor.a);\n}\n#endif\n\n#ifdef TRANSLUCENT\nbool inTranslucencyRectangle()\n{\n    return\n        v_textureCoordinates.x > u_translucencyRectangle.x &&\n        v_textureCoordinates.x < u_translucencyRectangle.z &&\n        v_textureCoordinates.y > u_translucencyRectangle.y &&\n        v_textureCoordinates.y < u_translucencyRectangle.w;\n}\n#endif\n\nvec4 sampleAndBlend(\n    vec4 previousColor,\n    sampler2D textureToSample,\n    vec2 tileTextureCoordinates,\n    vec4 textureCoordinateRectangle,\n    vec4 textureCoordinateTranslationAndScale,\n    float textureAlpha,\n    float textureNightAlpha,\n    float textureDayAlpha,\n    float textureBrightness,\n    float textureContrast,\n    float textureHue,\n    float textureSaturation,\n    float textureOneOverGamma,\n    float split,\n    vec4 colorToAlpha,\n    float nightBlend)\n{\n    // This crazy step stuff sets the alpha to 0.0 if this following condition is true:\n    //    tileTextureCoordinates.s < textureCoordinateRectangle.s ||\n    //    tileTextureCoordinates.s > textureCoordinateRectangle.p ||\n    //    tileTextureCoordinates.t < textureCoordinateRectangle.t ||\n    //    tileTextureCoordinates.t > textureCoordinateRectangle.q\n    // In other words, the alpha is zero if the fragment is outside the rectangle\n    // covered by this texture.  Would an actual 'if' yield better performance?\n    vec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n    alphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\n    textureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    textureAlpha *= mix(textureDayAlpha, textureNightAlpha, nightBlend);\n#endif\n\n    vec2 translation = textureCoordinateTranslationAndScale.xy;\n    vec2 scale = textureCoordinateTranslationAndScale.zw;\n    vec2 textureCoordinates = tileTextureCoordinates * scale + translation;\n    vec4 value = texture(textureToSample, textureCoordinates);\n    vec3 color = value.rgb;\n    float alpha = value.a;\n\n#ifdef APPLY_COLOR_TO_ALPHA\n    vec3 colorDiff = abs(color.rgb - colorToAlpha.rgb);\n    colorDiff.r = max(max(colorDiff.r, colorDiff.g), colorDiff.b);\n    alpha = czm_branchFreeTernary(colorDiff.r < colorToAlpha.a, 0.0, alpha);\n#endif\n\n#if !defined(APPLY_GAMMA)\n    vec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\n    color = tempColor.rgb;\n    alpha = tempColor.a;\n#else\n    color = pow(color, vec3(textureOneOverGamma));\n#endif\n\n#ifdef APPLY_SPLIT\n    float splitPosition = czm_splitPosition;\n    // Split to the left\n    if (split < 0.0 && gl_FragCoord.x > splitPosition) {\n       alpha = 0.0;\n    }\n    // Split to the right\n    else if (split > 0.0 && gl_FragCoord.x < splitPosition) {\n       alpha = 0.0;\n    }\n#endif\n\n#ifdef APPLY_BRIGHTNESS\n    color = mix(vec3(0.0), color, textureBrightness);\n#endif\n\n#ifdef APPLY_CONTRAST\n    color = mix(vec3(0.5), color, textureContrast);\n#endif\n\n#ifdef APPLY_HUE\n    color = czm_hue(color, textureHue);\n#endif\n\n#ifdef APPLY_SATURATION\n    color = czm_saturation(color, textureSaturation);\n#endif\n\n    float sourceAlpha = alpha * textureAlpha;\n    float outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\n    outAlpha += sign(outAlpha) - 1.0;\n\n    vec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\n\n    // When rendering imagery for a tile in multiple passes,\n    // some GPU/WebGL implementation combinations will not blend fragments in\n    // additional passes correctly if their computation includes an unmasked\n    // divide-by-zero operation,\n    // even if it's not in the output or if the output has alpha zero.\n    //\n    // For example, without sanitization for outAlpha,\n    // this renders without artifacts:\n    //   if (outAlpha == 0.0) { outColor = vec3(0.0); }\n    //\n    // but using czm_branchFreeTernary will cause portions of the tile that are\n    // alpha-zero in the additional pass to render as black instead of blending\n    // with the previous pass:\n    //   outColor = czm_branchFreeTernary(outAlpha == 0.0, vec3(0.0), outColor);\n    //\n    // So instead, sanitize against divide-by-zero,\n    // store this state on the sign of outAlpha, and correct on return.\n\n    return vec4(outColor, max(outAlpha, 0.0));\n}\n\nvec3 colorCorrect(vec3 rgb) {\n#ifdef COLOR_CORRECT\n    // Convert rgb color to hsb\n    vec3 hsb = czm_RGBToHSB(rgb);\n    // Perform hsb shift\n    hsb.x += u_hsbShift.x; // hue\n    hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n    hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n    // Convert shifted hsb back to rgb\n    rgb = czm_HSBToRGB(hsb);\n#endif\n    return rgb;\n}\n\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\n\nconst float fExposure = 2.0;\n\nvec3 computeEllipsoidPosition()\n{\n    float mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0), 1.0);\n    vec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\n    xy *= czm_viewport.zw * mpp * 0.5;\n\n    vec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\n    czm_ray ray = czm_ray(vec3(0.0), direction);\n\n    vec3 ellipsoid_center = czm_view[3].xyz;\n\n    czm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid_center, czm_ellipsoidInverseRadii);\n\n    vec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\n    return (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\n}\n\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\n    if (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\n        v_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n        {\n            discard;\n        }\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\n    vec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));   // normalized surface normal in model coordinates\n    vec3 normalEC = czm_normal3D * normalMC;                                         // normalized surface normal in eye coordinates\n#endif\n\n#if defined(APPLY_DAY_NIGHT_ALPHA) && defined(ENABLE_DAYNIGHT_SHADING)\n    float nightBlend = 1.0 - clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0, 0.0, 1.0);\n#else\n    float nightBlend = 0.0;\n#endif\n\n    // The clamp below works around an apparent bug in Chrome Canary v23.0.1241.0\n    // where the fragment shader sees textures coordinates < 0.0 and > 1.0 for the\n    // fragments on the edges of tiles even though the vertex shader is outputting\n    // coordinates strictly in the 0-1 range.\n    vec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0), nightBlend);\n\n#ifdef SHOW_TILE_BOUNDARIES\n    if (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\n        v_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n    {\n        color = vec4(1.0, 0.0, 0.0, 1.0);\n    }\n#endif\n\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\n    float cameraDist;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        cameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n    }\n    else if (czm_sceneMode == czm_sceneModeColumbusView)\n    {\n        cameraDist = -czm_view[3].z;\n    }\n    else\n    {\n        cameraDist = length(czm_view[3]);\n    }\n    float fadeOutDist = u_lightingFadeDistance.x;\n    float fadeInDist = u_lightingFadeDistance.y;\n    if (czm_sceneMode != czm_sceneMode3D) {\n        vec3 radii = czm_ellipsoidRadii;\n        float maxRadii = max(radii.x, max(radii.y, radii.z));\n        fadeOutDist -= maxRadii;\n        fadeInDist -= maxRadii;\n    }\n    float fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\n    float fade = 0.0;\n#endif\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n    vec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\n    vec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\n    vec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\n    waterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\n\n    float mask = texture(u_waterMask, waterMaskTextureCoordinates).r;\n\n    if (mask > 0.0)\n    {\n        mat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\n\n        vec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\n        vec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\n\n        vec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\n\n        color = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n    }\n#endif\n\n#ifdef APPLY_MATERIAL\n    czm_materialInput materialInput;\n    materialInput.st = v_textureCoordinates.st;\n    materialInput.normalEC = normalize(v_normalEC);\n    materialInput.positionToEyeEC = -v_positionEC;\n    materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalize(v_normalEC));     \n    materialInput.slope = v_slope;\n    materialInput.height = v_height;\n    materialInput.aspect = v_aspect;\n    czm_material material = czm_getMaterial(materialInput);\n    vec4 materialColor = vec4(material.diffuse, material.alpha);\n    color = alphaBlend(materialColor, color);\n#endif\n\n#ifdef ENABLE_VERTEX_LIGHTING\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalize(v_normalEC)) * u_lambertDiffuseMultiplier + u_vertexShadowDarkness, 0.0, 1.0);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\n    float diffuseIntensity = clamp(czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\n    diffuseIntensity = mix(1.0, diffuseIntensity, fade);\n    vec4 finalColor = vec4(color.rgb * czm_lightColor * diffuseIntensity, color.a);\n#else\n    vec4 finalColor = color;\n#endif\n\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n\n#ifdef HIGHLIGHT_FILL_TILE\n    finalColor = vec4(mix(finalColor.rgb, u_fillHighlightColor.rgb, u_fillHighlightColor.a), finalColor.a);\n#endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n#if defined(GROUND_ATMOSPHERE) || defined(FOG)\n    if (!czm_backFacing())\n    {\n        bool dynamicLighting = false;\n        #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n            dynamicLighting = true;     \n        #endif\n\n        vec3 rayleighColor;\n        vec3 mieColor;\n        float opacity;\n\n        vec3 positionWC;\n        vec3 lightDirection;\n\n        // When the camera is far away (camera distance > nightFadeOutDistance), the scattering is computed in the fragment shader.\n        // Otherwise, the scattering is computed in the vertex shader.\n        #ifdef PER_FRAGMENT_GROUND_ATMOSPHERE\n            positionWC = computeEllipsoidPosition();\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            computeAtmosphereScattering(\n                positionWC,\n                lightDirection,\n                rayleighColor,\n                mieColor,\n                opacity\n            );\n        #else\n            positionWC = v_positionMC;\n            lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(positionWC));\n            rayleighColor = v_atmosphereRayleighColor;\n            mieColor = v_atmosphereMieColor;\n            opacity = v_atmosphereOpacity;\n        #endif\n\n        rayleighColor = colorCorrect(rayleighColor);\n        mieColor = colorCorrect(mieColor);\n\n        vec4 groundAtmosphereColor = computeAtmosphereColor(positionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n        // Fog is applied to tiles selected for fog, close to the Earth.\n        #ifdef FOG\n            vec3 fogColor = groundAtmosphereColor.rgb;\n            \n            // If there is lighting, apply that to the fog.\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float darken = clamp(dot(normalize(czm_viewerPositionWC), atmosphereLightDirection), u_minimumBrightness, 1.0);\n                fogColor *= darken;                \n            #endif\n\n            #ifndef HDR\n                fogColor.rgb = czm_acesTonemapping(fogColor.rgb);\n                fogColor.rgb = czm_inverseGamma(fogColor.rgb);\n            #endif\n            \n            const float modifier = 0.15;\n            finalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor.rgb, modifier), finalColor.a);\n\n        #else\n            // The transmittance is based on optical depth i.e. the length of segment of the ray inside the atmosphere.\n            // This value is larger near the \"circumference\", as it is further away from the camera. We use it to\n            // brighten up that area of the ground atmosphere.\n            const float transmittanceModifier = 0.5;\n            float transmittance = transmittanceModifier + clamp(1.0 - groundAtmosphereColor.a, 0.0, 1.0);\n\n            vec3 finalAtmosphereColor = finalColor.rgb + groundAtmosphereColor.rgb * transmittance;\n\n            #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING))\n                float fadeInDist = u_nightFadeDistance.x;\n                float fadeOutDist = u_nightFadeDistance.y;\n            \n                float sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.05, 1.0);\n                float darken = clamp(dot(normalize(positionWC), atmosphereLightDirection), 0.0, 1.0);\n                vec3 darkenendGroundAtmosphereColor = mix(groundAtmosphereColor.rgb, finalAtmosphereColor.rgb, darken);\n\n                finalAtmosphereColor = mix(darkenendGroundAtmosphereColor, finalAtmosphereColor, sunlitAtmosphereIntensity);\n            #endif\n            \n            #ifndef HDR\n                finalAtmosphereColor.rgb = vec3(1.0) - exp(-fExposure * finalAtmosphereColor.rgb);\n            #else\n                finalAtmosphereColor.rgb = czm_saturation(finalAtmosphereColor.rgb, 1.6);\n            #endif\n            \n            finalColor.rgb = mix(finalColor.rgb, finalAtmosphereColor.rgb, fade);\n        #endif\n    }\n#endif\n\n#ifdef UNDERGROUND_COLOR\n    if (czm_backFacing())\n    {\n        float distanceFromEllipsoid = max(czm_eyeHeight, 0.0);\n        float distance = max(v_distance - distanceFromEllipsoid, 0.0);\n        float blendAmount = interpolateByDistance(u_undergroundColorAlphaByDistance, distance);\n        vec4 undergroundColor = vec4(u_undergroundColor.rgb, u_undergroundColor.a * blendAmount);\n        finalColor = alphaBlend(undergroundColor, finalColor);\n    }\n#endif\n\n#ifdef TRANSLUCENT\n    if (inTranslucencyRectangle())\n    {\n      vec4 alphaByDistance = gl_FrontFacing ? u_frontFaceAlphaByDistance : u_backFaceAlphaByDistance;\n      finalColor.a *= interpolateByDistance(alphaByDistance, v_distance);\n    }\n#endif\n    \n    out_FragColor =  finalColor;\n}\n\n\n#ifdef SHOW_REFLECTIVE_OCEAN\n\nfloat waveFade(float edge0, float edge1, float x)\n{\n    float y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return pow(1.0 - y, 5.0);\n}\n\nfloat linearFade(float edge0, float edge1, float x)\n{\n    return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\n\n// Based on water rendering by Jonas Wagner:\n// http://29a.ch/2012/7/19/webgl-terrain-rendering-water-fog\n\n// low altitude wave settings\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\n\n// high altitude wave settings\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\n\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\n    vec3 positionToEyeEC = -positionEyeCoordinates;\n    float positionToEyeECLength = length(positionToEyeEC);\n\n    // The double normalize below works around a bug in Firefox on Android devices.\n    vec3 normalizedPositionToEyeEC = normalize(normalize(positionToEyeEC));\n\n    // Fade out the waves as the camera moves far from the surface.\n    float waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n\n#ifdef SHOW_OCEAN_WAVES\n    // high altitude waves\n    float time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\n    vec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\n    vec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\n\n    // low altitude waves\n    time = czm_frameNumber * oceanAnimationSpeedLowAltitude;\n    noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\n    vec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\n\n    // blend the 2 wave layers based on distance to surface\n    float highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\n    float lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\n    vec3 normalTangentSpace =\n        (highAltitudeFade * normalTangentSpaceHighAltitude) +\n        (lowAltitudeFade * normalTangentSpaceLowAltitude);\n    normalTangentSpace = normalize(normalTangentSpace);\n\n    // fade out the normal perturbation as we move farther from the water surface\n    normalTangentSpace.xy *= waveIntensity;\n    normalTangentSpace = normalize(normalTangentSpace);\n#else\n    vec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 normalEC = enuToEye * normalTangentSpace;\n\n    const vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\n\n    // Use diffuse light to highlight the waves\n    float diffuseIntensity = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC) * maskValue;\n    vec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n\n#ifdef SHOW_OCEAN_WAVES\n    // Where diffuse light is low or non-existent, use wave highlights based solely on\n    // the wave bumpiness and no particular light direction.\n    float tsPerturbationRatio = normalTangentSpace.z;\n    vec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\n    vec3 nonDiffuseHighlight = vec3(0.0);\n#endif\n\n    // Add specular highlights in 3D, and in all modes when zoomed in.\n    float specularIntensity = czm_getSpecular(czm_lightDirectionEC, normalizedPositionToEyeEC, normalEC, 10.0);\n    float surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\n    float specular = specularIntensity * surfaceReflectance;\n\n#ifdef HDR\n    specular *= 1.4;\n\n    float e = 0.2;\n    float d = 3.3;\n    float c = 1.7;\n\n    vec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\n    vec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\n\n    return vec4(color, imageryColor.a);\n}\n\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n",W3="#ifdef QUANTIZATION_BITS12\nin vec4 compressed0;\nin float compressed1;\n#else\nin vec4 position3DAndHeight;\nin vec4 textureCoordAndEncodedNormals;\n#endif\n\n#ifdef GEODETIC_SURFACE_NORMALS\nin vec3 geodeticSurfaceNormal;\n#endif\n\n#ifdef EXAGGERATION\nuniform vec2 u_terrainExaggerationAndRelativeHeight;\n#endif\n\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\n\n// Uniforms for 2D Mercator projection\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\n\nout vec3 v_positionMC;\nout vec3 v_positionEC;\n\nout vec3 v_textureCoordinates;\nout vec3 v_normalMC;\nout vec3 v_normalEC;\n\n#ifdef APPLY_MATERIAL\nout float v_slope;\nout float v_aspect;\nout float v_height;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\nout float v_distance;\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nout vec3 v_atmosphereRayleighColor;\nout vec3 v_atmosphereMieColor;\nout float v_atmosphereOpacity;\n#endif\n\n// These functions are generated at runtime.\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\n\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return u_modifiedModelViewProjection * vec4(position, 1.0);\n}\n\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\n    // The width of a tile at level 11, in radians and assuming a single root tile, is\n    //   2.0 * czm_pi / pow(2.0, 11.0)\n    // We want to just linearly interpolate the 2D position from the texture coordinates\n    // when we're at this level or higher.  The constant below is the expression\n    // above evaluated and then rounded up at the 4th significant digit.\n    const float maxTileWidth = 0.003068;\n    float positionFraction = textureCoordinates.y;\n    float southLatitude = u_southAndNorthLatitude.x;\n    float northLatitude = u_southAndNorthLatitude.y;\n    if (northLatitude - southLatitude > maxTileWidth)\n    {\n        float southMercatorY = u_southMercatorYAndOneOverHeight.x;\n        float oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\n\n        float currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\n        currentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\n        positionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n    }\n    return positionFraction;\n}\n\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\n    return textureCoordinates.y;\n}\n\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    return u_modifiedModelViewProjection * rtcPosition2D;\n}\n\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\n\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    return getPositionPlanarEarth(position, height, textureCoordinates);\n}\n\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\n    // We do not do RTC while morphing, so there is potential for jitter.\n    // This is unlikely to be noticeable, though.\n    vec3 position3DWC = position + u_center3D;\n    float yPositionFraction = get2DYPositionFraction(textureCoordinates);\n    vec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\n    vec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\n    return czm_modelViewProjection * morphPosition;\n}\n\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\n\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\n    vec2 xy = czm_decompressTextureCoordinates(compressed0.x);\n    vec2 zh = czm_decompressTextureCoordinates(compressed0.y);\n    vec3 position = vec3(xy, zh.x);\n    float height = zh.y;\n    vec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\n\n    height = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\n    position = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\n    float encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = compressed0.w;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#else\n    // A single float per element\n    vec3 position = position3DAndHeight.xyz;\n    float height = position3DAndHeight.w;\n    vec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\n    float webMercatorT = textureCoordAndEncodedNormals.z;\n    float encodedNormal = 0.0;\n#else\n    float webMercatorT = textureCoordinates.y;\n    float encodedNormal = 0.0;\n#endif\n\n#endif\n\n    vec3 position3DWC = position + u_center3D;\n\n#ifdef GEODETIC_SURFACE_NORMALS\n    vec3 ellipsoidNormal = geodeticSurfaceNormal;\n#else\n    vec3 ellipsoidNormal = normalize(position3DWC);\n#endif\n\n#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)\n    float exaggeration = u_terrainExaggerationAndRelativeHeight.x;\n    float relativeHeight = u_terrainExaggerationAndRelativeHeight.y;\n    float newHeight = (height - relativeHeight) * exaggeration + relativeHeight;\n\n    // stop from going through center of earth\n    float minRadius = min(min(czm_ellipsoidRadii.x, czm_ellipsoidRadii.y), czm_ellipsoidRadii.z);\n    newHeight = max(newHeight, -minRadius);\n\n    vec3 offset = ellipsoidNormal * (newHeight - height);\n    position += offset;\n    position3DWC += offset;\n    height = newHeight;\n#endif\n\n    gl_Position = getPosition(position, height, textureCoordinates);\n\n    v_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\n    v_positionMC = position3DWC;  // position in model coordinates\n\n    v_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\n    vec3 normalMC = czm_octDecode(encodedNormal);\n\n#if defined(EXAGGERATION) && defined(GEODETIC_SURFACE_NORMALS)\n    vec3 projection = dot(normalMC, ellipsoidNormal) * ellipsoidNormal;\n    vec3 rejection = normalMC - projection;\n    normalMC = normalize(projection + rejection * exaggeration);\n#endif\n\n    v_normalMC = normalMC;\n    v_normalEC = czm_normal3D * v_normalMC;\n#endif\n\n#if defined(FOG) || (defined(GROUND_ATMOSPHERE) && !defined(PER_FRAGMENT_GROUND_ATMOSPHERE))\n\n    bool dynamicLighting = false;\n\n    #if defined(DYNAMIC_ATMOSPHERE_LIGHTING) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\n        dynamicLighting = true;\n    #endif\n\n#if defined(DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN)\n    vec3 atmosphereLightDirection = czm_sunDirectionWC;\n#else\n    vec3 atmosphereLightDirection = czm_lightDirectionWC;\n#endif\n\n    vec3 lightDirection = czm_branchFreeTernary(dynamicLighting, atmosphereLightDirection, normalize(position3DWC));\n\n    computeAtmosphereScattering(\n        position3DWC,\n        lightDirection,\n        v_atmosphereRayleighColor,\n        v_atmosphereMieColor,\n        v_atmosphereOpacity\n    );\n#endif\n\n#if defined(FOG) || defined(GROUND_ATMOSPHERE) || defined(UNDERGROUND_COLOR) || defined(TRANSLUCENT)\n    v_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n\n#ifdef APPLY_MATERIAL\n    float northPoleZ = czm_ellipsoidRadii.z;\n    vec3 northPolePositionMC = vec3(0.0, 0.0, northPoleZ);\n    vec3 vectorEastMC = normalize(cross(northPolePositionMC - v_positionMC, ellipsoidNormal));\n    float dotProd = abs(dot(ellipsoidNormal, v_normalMC));\n    v_slope = acos(dotProd);\n    vec3 normalRejected = ellipsoidNormal * dotProd;\n    vec3 normalProjected = v_normalMC - normalRejected;\n    vec3 aspectVector = normalize(normalProjected);\n    v_aspect = acos(dot(aspectVector, vectorEastMC));\n    float determ = dot(cross(vectorEastMC, aspectVector), ellipsoidNormal);\n    v_aspect = czm_branchFreeTernary(determ < 0.0, 2.0 * czm_pi - v_aspect, v_aspect);\n    v_height = height;\n#endif\n}\n",Gg="uniform vec3 u_radiiAndDynamicAtmosphereColor;\n\nuniform float u_atmosphereLightIntensity;\nuniform float u_atmosphereRayleighScaleHeight;\nuniform float u_atmosphereMieScaleHeight;\nuniform float u_atmosphereMieAnisotropy;\nuniform vec3 u_atmosphereRayleighCoefficient;\nuniform vec3 u_atmosphereMieCoefficient;\n\nconst float ATMOSPHERE_THICKNESS = 111e3; // The thickness of the atmosphere in meters.\nconst int PRIMARY_STEPS_MAX = 16; // Maximum number of times the ray from the camera to the world position (primary ray) is sampled.\nconst int LIGHT_STEPS_MAX = 4; // Maximum number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.\n\n/**\n * Rational approximation to tanh(x)\n*/\nfloat approximateTanh(float x) {\n    float x2 = x * x;\n    return max(-1.0, min(+1.0, x * (27.0 + x2) / (27.0 + 9.0 * x2)));\n}\n\n/**\n * This function computes the colors contributed by Rayliegh and Mie scattering on a given ray, as well as\n * the transmittance value for the ray.\n *\n * @param {czm_ray} primaryRay The ray from the camera to the position.\n * @param {float} primaryRayLength The length of the primary ray.\n * @param {vec3} lightDirection The direction of the light to calculate the scattering from.\n * @param {vec3} rayleighColor The variable the Rayleigh scattering will be written to.\n * @param {vec3} mieColor The variable the Mie scattering will be written to.\n * @param {float} opacity The variable the transmittance will be written to.\n * @glslFunction\n */\nvoid computeScattering(\n    czm_ray primaryRay,\n    float primaryRayLength,\n    vec3 lightDirection,\n    float atmosphereInnerRadius,\n    out vec3 rayleighColor,\n    out vec3 mieColor,\n    out float opacity\n) {\n\n    // Initialize the default scattering amounts to 0.\n    rayleighColor = vec3(0.0);\n    mieColor = vec3(0.0);\n    opacity = 0.0;\n\n    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;\n\n    vec3 origin = vec3(0.0);\n\n    // Calculate intersection from the camera to the outer ring of the atmosphere.\n    czm_raySegment primaryRayAtmosphereIntersect = czm_raySphereIntersectionInterval(primaryRay, origin, atmosphereOuterRadius);\n\n    // Return empty colors if no intersection with the atmosphere geometry.\n    if (primaryRayAtmosphereIntersect == czm_emptyRaySegment) {\n        return;\n    }\n\n    // To deal with smaller values of PRIMARY_STEPS (e.g. 4)\n    // we implement a split strategy: sky or horizon.\n    // For performance reasons, instead of a if/else branch\n    // a soft choice is implemented through a weight 0.0 <= w_stop_gt_lprl <= 1.0\n    float x = 1e-7 * primaryRayAtmosphereIntersect.stop / length(primaryRayLength);\n    // Value close to 0.0: close to the horizon\n    // Value close to 1.0: above in the sky\n    float w_stop_gt_lprl = 0.5 * (1.0 + approximateTanh(x));\n    \n    // The ray should start from the first intersection with the outer atmopshere, or from the camera position, if it is inside the atmosphere.\n    float start_0 = primaryRayAtmosphereIntersect.start;\n    primaryRayAtmosphereIntersect.start = max(primaryRayAtmosphereIntersect.start, 0.0);\n    // The ray should end at the exit from the atmosphere or at the distance to the vertex, whichever is smaller.\n    primaryRayAtmosphereIntersect.stop = min(primaryRayAtmosphereIntersect.stop, length(primaryRayLength));\n\n    // For the number of ray steps, distinguish inside or outside atmosphere (outer space)\n    // (1) from outer space we have to use more ray steps to get a realistic rendering\n    // (2) within atmosphere we need fewer steps for faster rendering\n    float x_o_a = start_0 - ATMOSPHERE_THICKNESS; // ATMOSPHERE_THICKNESS used as an ad-hoc constant, no precise meaning here, only the order of magnitude matters\n    float w_inside_atmosphere = 1.0 - 0.5 * (1.0 + approximateTanh(x_o_a));\n    int PRIMARY_STEPS = PRIMARY_STEPS_MAX - int(w_inside_atmosphere * 12.0); // Number of times the ray from the camera to the world position (primary ray) is sampled.\n    int LIGHT_STEPS = LIGHT_STEPS_MAX - int(w_inside_atmosphere * 2.0); // Number of times the light is sampled from the light source's intersection with the atmosphere to a sample position on the primary ray.\n\n    // Setup for sampling positions along the ray - starting from the intersection with the outer ring of the atmosphere.\n    float rayPositionLength = primaryRayAtmosphereIntersect.start;\n    // (1) Outside the atmosphere: constant rayStepLength\n    // (2) Inside atmosphere: variable rayStepLength to compensate the rough rendering of the smaller number of ray steps\n    float totalRayLength = primaryRayAtmosphereIntersect.stop - rayPositionLength;\n    float rayStepLengthIncrease = w_inside_atmosphere * ((1.0 - w_stop_gt_lprl) * totalRayLength / (float(PRIMARY_STEPS * (PRIMARY_STEPS + 1)) / 2.0));\n    float rayStepLength = max(1.0 - w_inside_atmosphere, w_stop_gt_lprl) * totalRayLength / max(7.0 * w_inside_atmosphere, float(PRIMARY_STEPS));\n\n    vec3 rayleighAccumulation = vec3(0.0);\n    vec3 mieAccumulation = vec3(0.0);\n    vec2 opticalDepth = vec2(0.0);\n    vec2 heightScale = vec2(u_atmosphereRayleighScaleHeight, u_atmosphereMieScaleHeight);\n\n    // Sample positions on the primary ray.\n    for (int i = 0; i < PRIMARY_STEPS_MAX; ++i) {\n\n        // The loop should be: for (int i = 0; i < PRIMARY_STEPS; ++i) {...} but WebGL1 cannot\n        // loop with non-constant condition, so it has to break early instead\n        if (i >= PRIMARY_STEPS) {\n            break;\n        }\n\n        // Calculate sample position along viewpoint ray.\n        vec3 samplePosition = primaryRay.origin + primaryRay.direction * (rayPositionLength + rayStepLength);\n\n        // Calculate height of sample position above ellipsoid.\n        float sampleHeight = length(samplePosition) - atmosphereInnerRadius;\n\n        // Calculate and accumulate density of particles at the sample position.\n        vec2 sampleDensity = exp(-sampleHeight / heightScale) * rayStepLength;\n        opticalDepth += sampleDensity;\n\n        // Generate ray from the sample position segment to the light source, up to the outer ring of the atmosphere.\n        czm_ray lightRay = czm_ray(samplePosition, lightDirection);\n        czm_raySegment lightRayAtmosphereIntersect = czm_raySphereIntersectionInterval(lightRay, origin, atmosphereOuterRadius);\n\n        float lightStepLength = lightRayAtmosphereIntersect.stop / float(LIGHT_STEPS);\n        float lightPositionLength = 0.0;\n\n        vec2 lightOpticalDepth = vec2(0.0);\n\n        // Sample positions along the light ray, to accumulate incidence of light on the latest sample segment.\n        for (int j = 0; j < LIGHT_STEPS_MAX; ++j) {\n\n            // The loop should be: for (int j = 0; i < LIGHT_STEPS; ++j) {...} but WebGL1 cannot\n            // loop with non-constant condition, so it has to break early instead\n            if (j >= LIGHT_STEPS) {\n                break;\n            }\n\n            // Calculate sample position along light ray.\n            vec3 lightPosition = samplePosition + lightDirection * (lightPositionLength + lightStepLength * 0.5);\n\n            // Calculate height of the light sample position above ellipsoid.\n            float lightHeight = length(lightPosition) - atmosphereInnerRadius;\n\n            // Calculate density of photons at the light sample position.\n            lightOpticalDepth += exp(-lightHeight / heightScale) * lightStepLength;\n\n            // Increment distance on light ray.\n            lightPositionLength += lightStepLength;\n        }\n\n        // Compute attenuation via the primary ray and the light ray.\n        vec3 attenuation = exp(-((u_atmosphereMieCoefficient * (opticalDepth.y + lightOpticalDepth.y)) + (u_atmosphereRayleighCoefficient * (opticalDepth.x + lightOpticalDepth.x))));\n\n        // Accumulate the scattering.\n        rayleighAccumulation += sampleDensity.x * attenuation;\n        mieAccumulation += sampleDensity.y * attenuation;\n\n        // Increment distance on primary ray.\n        rayPositionLength += (rayStepLength += rayStepLengthIncrease);\n    }\n\n    // Compute the scattering amount.\n    rayleighColor = u_atmosphereRayleighCoefficient * rayleighAccumulation;\n    mieColor = u_atmosphereMieCoefficient * mieAccumulation;\n\n    // Compute the transmittance i.e. how much light is passing through the atmosphere.\n    opacity = length(exp(-((u_atmosphereMieCoefficient * opticalDepth.y) + (u_atmosphereRayleighCoefficient * opticalDepth.x))));\n}\n\nvec4 computeAtmosphereColor(\n    vec3 positionWC,\n    vec3 lightDirection,\n    vec3 rayleighColor,\n    vec3 mieColor,\n    float opacity\n) {\n    // Setup the primary ray: from the camera position to the vertex position.\n    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;\n    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);\n\n    float cosAngle = dot(cameraToPositionWCDirection, lightDirection);\n    float cosAngleSq = cosAngle * cosAngle;\n\n    float G = u_atmosphereMieAnisotropy;\n    float GSq = G * G;\n\n    // The Rayleigh phase function.\n    float rayleighPhase = 3.0 / (50.2654824574) * (1.0 + cosAngleSq);\n    // The Mie phase function.\n    float miePhase = 3.0 / (25.1327412287) * ((1.0 - GSq) * (cosAngleSq + 1.0)) / (pow(1.0 + GSq - 2.0 * cosAngle * G, 1.5) * (2.0 + GSq));\n\n    // The final color is generated by combining the effects of the Rayleigh and Mie scattering.\n    vec3 rayleigh = rayleighPhase * rayleighColor;\n    vec3 mie = miePhase * mieColor;\n\n    vec3 color = (rayleigh + mie) * u_atmosphereLightIntensity;\n\n    return vec4(color, opacity);\n}\n",Nv="void computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity) {\n\n    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;\n    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);\n    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);\n    \n    float atmosphereInnerRadius = length(positionWC);\n\n    computeScattering(\n        primaryRay,\n        length(cameraToPositionWC),\n        lightDirection,\n        atmosphereInnerRadius,\n        rayleighColor,\n        mieColor,\n        opacity\n    );\n}\n";function nQe(e,t,i,n,r){this.numberOfDayTextures=e,this.flags=t,this.material=i,this.shaderProgram=n,this.clippingShaderState=r}function ij(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}function iQe(e){let t;switch(e){case te.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case te.SCENE2D:case te.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case te.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}function oQe(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}ij.prototype.getShaderProgram=function(e){let t=e.frameState,i=e.surfaceTile,n=e.numberOfDayTextures,r=e.applyBrightness,o=e.applyContrast,a=e.applyHue,s=e.applySaturation,l=e.applyGamma,c=e.applyAlpha,h=e.applyDayNightAlpha,d=e.applySplit,p=e.showReflectiveOcean,f=e.showOceanWaves,m=e.enableLighting,_=e.dynamicAtmosphereLighting,g=e.dynamicAtmosphereLightingFromSun,y=e.showGroundAtmosphere,v=e.perFragmentGroundAtmosphere,b=e.hasVertexNormals,A=e.useWebMercatorProjection,T=e.enableFog,E=e.enableClippingPlanes,C=e.clippingPlanes,x=e.clippedByBoundaries,S=e.hasImageryLayerCutout,w=e.colorCorrect,I=e.highlightFillTile,P=e.colorToAlpha,D=e.hasGeodeticSurfaceNormals,O=e.hasExaggeration,L=e.showUndergroundColor,R=e.translucent,N=0,M="",F=i.renderedMesh.encoding;F.quantization===Os.BITS12&&(N=1,M="QUANTIZATION_BITS12");let B=0,z="";x&&(B=1,z="TILE_LIMIT_RECTANGLE");let U=0,k="";S&&(U=1,k="APPLY_IMAGERY_CUTOUT");let V=t.mode,H=V|r<<2|o<<3|a<<4|s<<5|l<<6|c<<7|p<<8|f<<9|m<<10|_<<11|g<<12|y<<13|v<<14|b<<15|A<<16|T<<17|N<<18|d<<19|E<<20|B<<21|U<<22|w<<23|I<<24|P<<25|D<<26|O<<27|L<<28|R<<29|h<<30,G=0;u(C)&&C.length>0&&(G=E?C.clippingPlanesState:0);let j=i.surfaceShader;if(u(j)&&j.numberOfDayTextures===n&&j.flags===H&&j.material===this.material&&j.clippingShaderState===G)return j.shaderProgram;let W=this._shadersByTexturesFlags[n];if(u(W)||(W=this._shadersByTexturesFlags[n]=[]),j=W[H],!u(j)||j.material!==this.material||j.clippingShaderState!==G){let e=this.baseVertexShaderSource.clone(),i=this.baseFragmentShaderSource.clone();0!==G&&i.sources.unshift(og(C,t.context)),e.defines.push(M),i.defines.push(`TEXTURE_UNITS ${n}`,z,k),r&&i.defines.push("APPLY_BRIGHTNESS"),o&&i.defines.push("APPLY_CONTRAST"),a&&i.defines.push("APPLY_HUE"),s&&i.defines.push("APPLY_SATURATION"),l&&i.defines.push("APPLY_GAMMA"),c&&i.defines.push("APPLY_ALPHA"),h&&i.defines.push("APPLY_DAY_NIGHT_ALPHA"),p&&(i.defines.push("SHOW_REFLECTIVE_OCEAN"),e.defines.push("SHOW_REFLECTIVE_OCEAN")),f&&i.defines.push("SHOW_OCEAN_WAVES"),P&&i.defines.push("APPLY_COLOR_TO_ALPHA"),L&&(e.defines.push("UNDERGROUND_COLOR"),i.defines.push("UNDERGROUND_COLOR")),R&&(e.defines.push("TRANSLUCENT"),i.defines.push("TRANSLUCENT")),m&&(b?(e.defines.push("ENABLE_VERTEX_LIGHTING"),i.defines.push("ENABLE_VERTEX_LIGHTING")):(e.defines.push("ENABLE_DAYNIGHT_SHADING"),i.defines.push("ENABLE_DAYNIGHT_SHADING"))),_&&(e.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),i.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING"),g&&(e.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"),i.defines.push("DYNAMIC_ATMOSPHERE_LIGHTING_FROM_SUN"))),y&&(e.defines.push("GROUND_ATMOSPHERE"),i.defines.push("GROUND_ATMOSPHERE"),v&&(e.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"),i.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE"))),e.defines.push("INCLUDE_WEB_MERCATOR_Y"),i.defines.push("INCLUDE_WEB_MERCATOR_Y"),T&&(e.defines.push("FOG"),i.defines.push("FOG")),d&&i.defines.push("APPLY_SPLIT"),E&&i.defines.push("ENABLE_CLIPPING_PLANES"),w&&i.defines.push("COLOR_CORRECT"),I&&i.defines.push("HIGHLIGHT_FILL_TILE"),D&&e.defines.push("GEODETIC_SURFACE_NORMALS"),O&&e.defines.push("EXAGGERATION");let u="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates, float nightBlend)\n    {\n        vec4 color = initialColor;\n";S&&(u+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(let e=0;e<n;++e)u+=S?`        cutoutAndColorResult = u_dayTextureCutoutRectangles[${e}];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n`:"        color = sampleAndBlend(\n",u+=`            color,\n            u_dayTextures[${e}],\n            u_dayTextureUseWebMercatorT[${e}] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle[${e}],\n            u_dayTextureTranslationAndScale[${e}],\n            ${c?`u_dayTextureAlpha[${e}]`:"1.0"},\n            ${h?`u_dayTextureNightAlpha[${e}]`:"1.0"},\n${h?`u_dayTextureDayAlpha[${e}]`:"1.0"},\n${r?`u_dayTextureBrightness[${e}]`:"0.0"},\n            ${o?`u_dayTextureContrast[${e}]`:"0.0"},\n            ${a?`u_dayTextureHue[${e}]`:"0.0"},\n            ${s?`u_dayTextureSaturation[${e}]`:"0.0"},\n            ${l?`u_dayTextureOneOverGamma[${e}]`:"0.0"},\n            ${d?`u_dayTextureSplit[${e}]`:"0.0"},\n            ${P?`u_colorsToAlpha[${e}]`:"vec4(0.0)"},\n        nightBlend        );\n`,S&&(u+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");u+="        return color;\n    }",i.sources.push(u),e.sources.push(iQe(V)),e.sources.push(oQe(A));let x=Kt.fromCache({context:t.context,vertexShaderSource:e,fragmentShaderSource:i,attributeLocations:F.getAttributeLocations()});j=W[H]=new nQe(n,H,this.material,x,G)}return i.surfaceShader=j,j.shaderProgram},ij.prototype.destroy=function(){let e,t,i=this._shadersByTexturesFlags;for(let n in i)if(i.hasOwnProperty(n)){let r=i[n];if(!u(r))continue;for(e in r)r.hasOwnProperty(e)&&(t=r[e],u(t)&&t.shaderProgram.destroy())}return le(this)};var j3=ij,rQe={UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7},oi=Object.freeze(rQe),sQe={START:0,LOADING:1,DONE:2,FAILED:3},Gs=Object.freeze(sQe),aQe={FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6},so=Object.freeze(aQe);function qo(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new oe(0,0,1,1),this.terrainData=void 0,this.vertexArray=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new h,this.boundingVolumeSourceTile=void 0,this.boundingVolumeIsFromMesh=!1,this.terrainState=so.UNLOADED,this.mesh=void 0,this.fill=void 0,this.pickBoundingSphere=new se,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}Object.defineProperties(qo.prototype,{eligibleForUnloading:{get:function(){let e=this.terrainState,t=!(e===so.RECEIVING||e===so.TRANSFORMING),i=this.imagery;for(let e=0,n=i.length;t&&e<n;++e){let n=i[e];t=!u(n.loadingImagery)||n.loadingImagery.state!==oi.TRANSITIONING}return t}},renderedMesh:{get:function(){return u(this.vertexArray)?this.mesh:u(this.fill)?this.fill.mesh:void 0}}});var cQe=new fe;function oj(e,t,i,n,r,o){let a=e.getExaggeratedPosition(n,r,o);if(u(t)&&t!==te.SCENE3D){let e=i.ellipsoid.cartesianToCartographic(a,cQe);a=i.project(e,o),a=h.fromElements(a.z,a.x,a.y,o)}return a}var lQe=new h,uQe=new h,fQe=new h;function _fe(e,t,i,n){let r=e.renderedMesh,o=r.vertices,a=r.encoding,s=o.length/a.stride,l=sc.clone(a);l.hasGeodeticSurfaceNormals=t,l=sc.clone(l);let u=l.stride,c=new Float32Array(s*u);t?a.addGeodeticSurfaceNormals(o,c,i):a.removeGeodeticSurfaceNormals(o,c),r.vertices=c,r.stride=u,r!==e.mesh?(qo._freeVertexArray(e.fill.vertexArray),e.fill.vertexArray=qo._createVertexArrayForMesh(n.context,r)):(qo._freeVertexArray(e.vertexArray),e.vertexArray=qo._createVertexArrayForMesh(n.context,r)),qo._freeVertexArray(e.wireframeVertexArray),e.wireframeVertexArray=void 0}function dQe(e,t,i){let n=t.getTileDataAvailable(e.x,e.y,e.level);if(!u(n)&&u(e.parent)){let t=e.parent,i=t.data;u(i)&&u(i.terrainData)&&(n=i.terrainData.isChildAvailable(t.x,t.y,e.x,e.y))}!1===n&&(e.data.terrainState=so.FAILED);for(let n=0,r=i.length;n<r;++n){let r=i.get(n);r.show&&r._createTileImagerySkeletons(e,t)}}function hQe(e,t,i,n,r,o){let a=e.data,s=e.parent;if(a.terrainState===so.FAILED&&void 0!==s&&(void 0!==s.data&&void 0!==s.data.terrainData&&!1!==s.data.terrainData.canUpsample||qo.processStateMachine(s,t,i,n,r,o,!0)),a.terrainState===so.FAILED&&mQe(a,e,t,i,e.x,e.y,e.level),a.terrainState===so.UNLOADED&&pQe(a,i,e.x,e.y,e.level),a.terrainState===so.RECEIVED&&gQe(a,t,i,e.x,e.y,e.level),a.terrainState===so.TRANSFORMED&&(yQe(a,t.context,i,e.x,e.y,e.level,o),a.updateExaggeration(e,t,r)),a.terrainState>=so.RECEIVED&&void 0===a.waterMaskTexture&&i.hasWaterMask)if(void 0!==a.terrainData.waterMask)bQe(t.context,a);else{let t=a._findAncestorTileWithTerrainData(e);u(t)&&u(t.data.waterMaskTexture)&&(a.waterMaskTexture=t.data.waterMaskTexture,++a.waterMaskTexture.referenceCount,a._computeWaterMaskTranslationAndScale(e,t,a.waterMaskTranslationAndScale))}}function mQe(e,t,i,n,r,o,a){let s=t.parent;if(!s)return void(t.state=Gs.FAILED);let l=s.data.terrainData,c=s.x,h=s.y,d=s.level;if(!u(l))return;let p=l.upsample(n.tilingScheme,c,h,d,r,o,a);u(p)&&(e.terrainState=so.RECEIVING,Promise.resolve(p).then((function(t){u(t)&&(e.terrainData=t,e.terrainState=so.RECEIVED)})).catch((function(){e.terrainState=so.FAILED})))}function pQe(e,t,i,n,r){function o(){let a=new Ko({throttle:!1,throttleByServer:!0,type:Jr.TERRAIN});e.request=a;let s=t.requestTileGeometry(i,n,r,a);u(s)?(e.terrainState=so.RECEIVING,Promise.resolve(s).then((function(t){!function(t){if(!u(t))return e.terrainState=so.UNLOADED,void(e.request=void 0);e.terrainData=t,e.terrainState=so.RECEIVED,e.request=void 0}(t)})).catch((function(a){!function(a){if(e.request.state===Qn.CANCELLED)return e.terrainData=void 0,e.terrainState=so.UNLOADED,void(e.request=void 0);e.terrainState=so.FAILED,e.request=void 0;let s=`Failed to obtain terrain tile X: ${i} Y: ${n} Level: ${r}. Error message: "${a}"`;t._requestError=bo.reportError(t._requestError,t,t.errorEvent,s,i,n,r),t._requestError.retry&&o()}(a)}))):(e.terrainState=so.UNLOADED,e.request=void 0)}o()}qo.prototype.pick=function(e,t,i,n,r){let o=this.renderedMesh;if(!u(o))return;let a=o.vertices,s=o.indices,l=o.encoding,c=s.length,h=Number.MAX_VALUE;for(let r=0;r<c;r+=3){let o=s[r],c=s[r+1],d=s[r+2],p=oj(l,t,i,a,o,lQe),f=oj(l,t,i,a,c,uQe),m=oj(l,t,i,a,d,fQe),_=Ai.rayTriangleParametric(e,p,f,m,n);u(_)&&_<h&&_>=0&&(h=_)}return h!==Number.MAX_VALUE?Tn.getPoint(e,h,r):void 0},qo.prototype.freeResources=function(){u(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,this.terrainState=so.UNLOADED,this.mesh=void 0,this.fill=this.fill&&this.fill.destroy();let e=this.imagery;for(let t=0,i=e.length;t<i;++t)e[t].freeResources();this.imagery.length=0,this.freeVertexArray()},qo.prototype.freeVertexArray=function(){qo._freeVertexArray(this.vertexArray),this.vertexArray=void 0,qo._freeVertexArray(this.wireframeVertexArray),this.wireframeVertexArray=void 0},qo.initialize=function(e,t,i){let n=e.data;u(n)||(n=e.data=new qo),e.state===Gs.START&&(dQe(e,t,i),e.state=Gs.LOADING)},qo.processStateMachine=function(e,t,i,n,r,o,a){qo.initialize(e,i,n);let s=e.data;if(e.state===Gs.LOADING&&hQe(e,t,i,n,r,o),a)return;let l=e.renderable;e.renderable=u(s.vertexArray);let c=s.terrainState===so.READY;e.upsampledFromParent=u(s.terrainData)&&s.terrainData.wasCreatedByUpsampling();let h=s.processImagery(e,i,t);if(c&&h){let t=e._loadedCallbacks,i={};for(let n in t)t.hasOwnProperty(n)&&(t[n](e)||(i[n]=t[n]));e._loadedCallbacks=i,e.state=Gs.DONE}l&&(e.renderable=!0)},qo.prototype.processImagery=function(e,t,i,n){let r,o,a=e.data,s=e.upsampledFromParent,l=!1,c=!0,h=a.imagery;for(r=0,o=h.length;r<o;++r){let a=h[r];if(!u(a.loadingImagery)){s=!1;continue}if(a.loadingImagery.state===oi.PLACEHOLDER){let i=a.loadingImagery.imageryLayer;if(i.ready){a.freeResources(),h.splice(r,1),i._createTileImagerySkeletons(e,t,r),--r,o=h.length;continue}s=!1}let d=a.processStateMachine(e,i,n);c=c&&d,l=l||d||u(a.readyImagery),s=s&&u(a.loadingImagery)&&(a.loadingImagery.state===oi.FAILED||a.loadingImagery.state===oi.INVALID)}return e.upsampledFromParent=s,e.renderable=e.renderable&&(l||c),c},qo.prototype.addGeodeticSurfaceNormals=function(e,t){_fe(this,!0,e,t)},qo.prototype.removeGeodeticSurfaceNormals=function(e){_fe(this,!1,void 0,e)},qo.prototype.updateExaggeration=function(e,t,i){let n=this,r=n.renderedMesh;if(void 0===r)return;let o=t.terrainExaggeration,a=t.terrainExaggerationRelativeHeight,s=1!==o,l=r.encoding,u=l.exaggeration!==o,c=l.exaggerationRelativeHeight!==a;if(u||c){if(u)if(s&&!l.hasGeodeticSurfaceNormals){let i=e.tilingScheme.ellipsoid;n.addGeodeticSurfaceNormals(i,t)}else!s&&l.hasGeodeticSurfaceNormals&&n.removeGeodeticSurfaceNormals(t);if(l.exaggeration=o,l.exaggerationRelativeHeight=a,void 0!==i){i._tileToUpdateHeights.push(e);let t=e.customData,n=t.length;for(let e=0;e<n;e++){t[e].level=-1}}}};var _Qe={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0,throttle:!0};function gQe(e,t,i,n,r,o){let a=i.tilingScheme,s=_Qe;s.tilingScheme=a,s.x=n,s.y=r,s.level=o,s.exaggeration=t.terrainExaggeration,s.exaggerationRelativeHeight=t.terrainExaggerationRelativeHeight,s.throttle=!0;let l=e.terrainData.createMesh(s);u(l)&&(e.terrainState=so.TRANSFORMING,Promise.resolve(l).then((function(t){e.mesh=t,e.terrainState=so.TRANSFORMED})).catch((function(){e.terrainState=so.FAILED})))}function yQe(e,t,i,n,r,o,a){e.vertexArray=qo._createVertexArrayForMesh(t,e.mesh),e.terrainState=so.READY,e.fill=e.fill&&e.fill.destroy(a)}function xQe(e){let t=e.cache.tile_waterMaskData;if(!u(t)){let i=Ot.create({context:e,pixelFormat:rt.LUMINANCE,pixelDatatype:Ye.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});i.referenceCount=1,t={allWaterTexture:i,sampler:new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.LINEAR,magnificationFilter:wi.LINEAR}),destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}function bQe(e,t){let i,n=t.terrainData.waterMask,r=xQe(e),o=n.length;if(1===o){if(0===n[0])return;i=r.allWaterTexture}else{let t=Math.sqrt(o);i=Ot.create({context:e,pixelFormat:rt.LUMINANCE,pixelDatatype:Ye.UNSIGNED_BYTE,source:{width:t,height:t,arrayBufferView:n},sampler:r.sampler,flipY:!1}),i.referenceCount=0}++i.referenceCount,t.waterMaskTexture=i,oe.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}qo._createVertexArrayForMesh=function(e,t){let i=t.vertices,n=ut.createVertexBuffer({context:e,typedArray:i,usage:Be.STATIC_DRAW}),r=t.encoding.getAttributes(n),o=t.indices.indexBuffers||{},a=o[e.id];if(!u(a)||a.isDestroyed()){let i=t.indices;a=ut.createIndexBuffer({context:e,typedArray:i,usage:Be.STATIC_DRAW,indexDatatype:ke.fromSizeInBytes(i.BYTES_PER_ELEMENT)}),a.vertexArrayDestroyable=!1,a.referenceCount=1,o[e.id]=a,t.indices.indexBuffers=o}else++a.referenceCount;return new ni({context:e,attributes:r,indexBuffer:a})},qo._freeVertexArray=function(e){if(u(e)){let t=e.indexBuffer;e.isDestroyed()||e.destroy(),u(t)&&!t.isDestroyed()&&u(t.referenceCount)&&(--t.referenceCount,0===t.referenceCount&&t.destroy())}},qo.prototype._findAncestorTileWithTerrainData=function(e){let t=e.parent;for(;u(t)&&(!u(t.data)||!u(t.data.terrainData)||t.data.terrainData.wasCreatedByUpsampling());)t=t.parent;return t},qo.prototype._computeWaterMaskTranslationAndScale=function(e,t,i){let n=t.rectangle,r=e.rectangle,o=r.width,a=r.height,s=o/n.width,l=a/n.height;return i.x=s*(r.west-n.west)/o,i.y=l*(r.south-n.south)/a,i.z=s,i.w=l,i};var Td=qo,q3="uniform sampler2D u_texture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    out_FragColor = texture(u_texture, v_textureCoordinates);\n}\n",Y3="in vec4 position;\nin float webMercatorT;\n\nuniform vec2 u_textureDimensions;\n\nout vec2 v_textureCoordinates;\n\nvoid main()\n{\n    v_textureCoordinates = vec2(position.x, webMercatorT);\n    gl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n";function cC(e,t,i,n,r){if(this.imageryLayer=e,this.x=t,this.y=i,this.level=n,this.request=void 0,0!==n){let r=t/2|0,o=i/2|0,a=n-1;this.parent=e.getImageryFromCache(r,o,a)}this.state=oi.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!u(r)&&e.ready&&(r=e.imageryProvider.tilingScheme.tileXYToRectangle(t,i,n)),this.rectangle=r}cC.createPlaceholder=function(e){let t=new cC(e,0,0,0);return t.addReference(),t.state=oi.PLACEHOLDER,t},cC.prototype.addReference=function(){++this.referenceCount},cC.prototype.releaseReference=function(){return--this.referenceCount,0===this.referenceCount?(this.imageryLayer.removeImageryFromCache(this),u(this.parent)&&this.parent.releaseReference(),u(this.image)&&u(this.image.destroy)&&this.image.destroy(),u(this.texture)&&this.texture.destroy(),u(this.textureWebMercator)&&this.texture!==this.textureWebMercator&&this.textureWebMercator.destroy(),le(this),0):this.referenceCount},cC.prototype.processStateMachine=function(e,t,i){this.state===oi.UNLOADED&&!i&&(this.state=oi.TRANSITIONING,this.imageryLayer._requestImagery(this)),this.state===oi.RECEIVED&&(this.state=oi.TRANSITIONING,this.imageryLayer._createTexture(e.context,this));let n=this.state===oi.READY&&t&&!this.texture;(this.state===oi.TEXTURE_LOADED||n)&&(this.state=oi.TRANSITIONING,this.imageryLayer._reprojectTexture(e,this,t))};var Fv=cC;function rj(e,t,i){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=i}rj.prototype.freeResources=function(){u(this.readyImagery)&&this.readyImagery.releaseReference(),u(this.loadingImagery)&&this.loadingImagery.releaseReference()},rj.prototype.processStateMachine=function(e,t,i){let n=this.loadingImagery,r=n.imageryLayer;if(n.processStateMachine(t,!this.useWebMercatorT,i),n.state===oi.READY)return u(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=r._calculateTextureTranslationAndScale(e,this),!0;let o,a=n.parent;for(;u(a)&&(a.state!==oi.READY||!this.useWebMercatorT&&!u(a.texture));)a.state!==oi.FAILED&&a.state!==oi.INVALID&&(o=o||a),a=a.parent;return this.readyImagery!==a&&(u(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=a,u(a)&&(a.addReference(),this.textureTranslationAndScale=r._calculateTextureTranslationAndScale(e,this))),(n.state===oi.FAILED||n.state===oi.INVALID)&&(!u(o)||(o.processStateMachine(t,!this.useWebMercatorT,i),!1))};var Bv=rj;function hi(e,t){this._imageryProvider=e,this._readyEvent=new pe,this._errorEvent=new pe,t=y(t,y.EMPTY_OBJECT),e=y(e,y.EMPTY_OBJECT),this.alpha=y(t.alpha,y(e._defaultAlpha,1)),this.nightAlpha=y(t.nightAlpha,y(e._defaultNightAlpha,1)),this.dayAlpha=y(t.dayAlpha,y(e._defaultDayAlpha,1)),this.brightness=y(t.brightness,y(e._defaultBrightness,hi.DEFAULT_BRIGHTNESS)),this.contrast=y(t.contrast,y(e._defaultContrast,hi.DEFAULT_CONTRAST)),this.hue=y(t.hue,y(e._defaultHue,hi.DEFAULT_HUE)),this.saturation=y(t.saturation,y(e._defaultSaturation,hi.DEFAULT_SATURATION)),this.gamma=y(t.gamma,y(e._defaultGamma,hi.DEFAULT_GAMMA)),this.splitDirection=y(t.splitDirection,hi.DEFAULT_SPLIT),this.minificationFilter=y(t.minificationFilter,y(e._defaultMinificationFilter,hi.DEFAULT_MINIFICATION_FILTER)),this.magnificationFilter=y(t.magnificationFilter,y(e._defaultMagnificationFilter,hi.DEFAULT_MAGNIFICATION_FILTER)),this.show=y(t.show,!0),this._minimumTerrainLevel=t.minimumTerrainLevel,this._maximumTerrainLevel=t.maximumTerrainLevel,this._rectangle=y(t.rectangle,ce.MAX_VALUE),this._maximumAnisotropy=t.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new Bv(Fv.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[],this.cutoutRectangle=t.cutoutRectangle,this.colorToAlpha=t.colorToAlpha,this.colorToAlphaThreshold=y(t.colorToAlphaThreshold,hi.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD)}Object.defineProperties(hi.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},ready:{get:function(){return u(this._imageryProvider)}},errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},rectangle:{get:function(){return this._rectangle}}}),hi.DEFAULT_BRIGHTNESS=1,hi.DEFAULT_CONTRAST=1,hi.DEFAULT_HUE=0,hi.DEFAULT_SATURATION=1,hi.DEFAULT_GAMMA=1,hi.DEFAULT_SPLIT=al.NONE,hi.DEFAULT_MINIFICATION_FILTER=an.LINEAR,hi.DEFAULT_MAGNIFICATION_FILTER=wi.LINEAR,hi.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD=.004,hi.fromProviderAsync=function(e,t){let i=new hi(void 0,t);return SQe(i,Promise.resolve(e)),i},hi.fromWorldImagery=function(e){return e=y(e,y.EMPTY_OBJECT),hi.fromProviderAsync(zg({style:e.style}),e)},hi.prototype.isBaseLayer=function(){return this._isBaseLayer},hi.prototype.isDestroyed=function(){return!1},hi.prototype.destroy=function(){return le(this)};var xfe=new ce,gfe=new ce,sj=new ce,bfe=new ce;function yfe(e,t,i){return`${e}:${t}:${i}`}function Tfe(e,t,i){return JSON.stringify([e,t,i])}hi.prototype.getImageryRectangle=function(){let e=this._imageryProvider,t=this._rectangle;return ce.intersection(e.rectangle,t)},hi.prototype._createTileImagerySkeletons=function(e,t,i){let n=e.data;if(!u(t)||u(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel||u(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel)return!1;u(i)||(i=n.imagery.length);let r=this._imageryProvider;if(!this.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),n.imagery.splice(i,0,this._skeletonPlaceholder),!0;let o=r.tilingScheme.projection instanceof Oi&&e.rectangle.north<Oi.MaximumLatitude&&e.rectangle.south>-Oi.MaximumLatitude,a=ce.intersection(r.rectangle,this._rectangle,xfe),s=ce.intersection(e.rectangle,a,gfe);if(!u(s)){if(!this.isBaseLayer())return!1;let t=a,i=e.rectangle;s=gfe,i.south>=t.north?s.north=s.south=t.north:i.north<=t.south?s.north=s.south=t.south:(s.south=Math.max(i.south,t.south),s.north=Math.min(i.north,t.north)),i.west>=t.east?s.west=s.east=t.east:i.east<=t.west?s.west=s.east=t.west:(s.west=Math.max(i.west,t.west),s.east=Math.min(i.east,t.east))}let l=0;s.south>0?l=s.south:s.north<0&&(l=s.north);let c=CQe(this,1*t.getLevelMaximumGeometricError(e.level),l);c=Math.max(0,c);let h=r.maximumLevel;if(c>h&&(c=h),u(r.minimumLevel)){let e=r.minimumLevel;c<e&&(c=e)}let d=r.tilingScheme,p=d.positionToTileXY(ce.northwest(s),c),f=d.positionToTileXY(ce.southeast(s),c),m=e.rectangle.width/512,_=e.rectangle.height/512,g=d.tileXYToRectangle(p.x,p.y,c);Math.abs(g.south-e.rectangle.north)<_&&p.y<f.y&&++p.y,Math.abs(g.east-e.rectangle.west)<m&&p.x<f.x&&++p.x;let y=d.tileXYToRectangle(f.x,f.y,c);Math.abs(y.north-e.rectangle.south)<_&&f.y>p.y&&--f.y,Math.abs(y.west-e.rectangle.east)<m&&f.x>p.x&&--f.x;let v,b=ce.clone(e.rectangle,bfe),A=d.tileXYToRectangle(p.x,p.y,c),T=ce.intersection(A,a,sj);o?(d.rectangleToNativeRectangle(b,b),d.rectangleToNativeRectangle(A,A),d.rectangleToNativeRectangle(T,T),d.rectangleToNativeRectangle(a,a),v=d.tileXYToNativeRectangle.bind(d),m=b.width/512,_=b.height/512):v=d.tileXYToRectangle.bind(d);let E,C,x=0,S=1;!this.isBaseLayer()&&Math.abs(T.west-b.west)>=m&&(x=Math.min(1,(T.west-b.west)/b.width)),!this.isBaseLayer()&&Math.abs(T.north-b.north)>=_&&(S=Math.max(0,(T.north-b.south)/b.height));let w=S;for(let e=p.x;e<=f.x;e++)if(E=x,A=v(e,p.y,c),T=ce.simpleIntersection(A,a,sj),u(T)){x=Math.min(1,(T.east-b.west)/b.width),e===f.x&&(this.isBaseLayer()||Math.abs(T.east-b.east)<m)&&(x=1),S=w;for(let t=p.y;t<=f.y;t++){if(C=S,A=v(e,t,c),T=ce.simpleIntersection(A,a,sj),!u(T))continue;S=Math.max(0,(T.south-b.south)/b.height),t===f.y&&(this.isBaseLayer()||Math.abs(T.south-b.south)<_)&&(S=0);let r=new oe(E,S,x,C),s=this.getImageryFromCache(e,t,c);n.imagery.splice(i,0,new Bv(s,r,o)),++i}}return!0},hi.prototype._calculateTextureTranslationAndScale=function(e,t){let i=t.readyImagery.rectangle,n=e.rectangle;if(t.useWebMercatorT){let e=t.readyImagery.imageryLayer.imageryProvider.tilingScheme;i=e.rectangleToNativeRectangle(i,xfe),n=e.rectangleToNativeRectangle(n,bfe)}let r=n.width,o=n.height,a=r/i.width,s=o/i.height;return new oe(a*(n.west-i.west)/r,s*(n.south-i.south)/o,a,s)},hi.prototype._requestImagery=function(e){let t=this._imageryProvider,i=this;function n(n){if(e.request.state===Qn.CANCELLED)return e.state=oi.UNLOADED,void(e.request=void 0);e.state=oi.FAILED,e.request=void 0;let o=`Failed to obtain image tile X: ${e.x} Y: ${e.y} Level: ${e.level}.`;i._requestImageError=bo.reportError(i._requestImageError,t,t.errorEvent,o,e.x,e.y,e.level,n),i._requestImageError.retry&&r()}function r(){let r=new Ko({throttle:!1,throttleByServer:!0,type:Jr.IMAGERY});e.request=r,e.state=oi.TRANSITIONING;let o=t.requestImage(e.x,e.y,e.level,r);if(!u(o))return e.state=oi.UNLOADED,void(e.request=void 0);u(t.getTileCredits)&&(e.credits=t.getTileCredits(e.x,e.y,e.level)),o.then((function(t){!function(t){if(!u(t))return n();e.image=t,e.state=oi.RECEIVED,e.request=void 0,bo.reportSuccess(i._requestImageError)}(t)})).catch((function(e){n(e)}))}r()},hi.prototype._createTextureWebGL=function(e,t){let i=new un({minificationFilter:this.minificationFilter,magnificationFilter:this.magnificationFilter}),n=t.image;return u(n.internalFormat)?new Ot({context:e,pixelFormat:n.internalFormat,width:n.width,height:n.height,source:{arrayBufferView:n.bufferView},sampler:i}):new Ot({context:e,source:n,pixelFormat:this._imageryProvider.hasAlphaChannel?rt.RGBA:rt.RGB,sampler:i})},hi.prototype._createTexture=function(e,t){let i=this._imageryProvider,n=t.image;if(u(i.tileDiscardPolicy)){let e=i.tileDiscardPolicy;if(u(e)){if(!e.isReady())return void(t.state=oi.RECEIVED);if(e.shouldDiscardImage(n))return void(t.state=oi.INVALID)}}let r=this._createTextureWebGL(e,t);i.tilingScheme.projection instanceof Oi?t.textureWebMercator=r:t.texture=r,t.image=void 0,t.state=oi.TEXTURE_LOADED},hi.prototype._finalizeReprojectTexture=function(e,t){let i=this.minificationFilter,n=this.magnificationFilter;if(i===an.LINEAR&&n===wi.LINEAR&&!rt.isCompressedFormat(t.pixelFormat)&&P.isPowerOfTwo(t.width)&&P.isPowerOfTwo(t.height)){i=an.LINEAR_MIPMAP_LINEAR;let r=zt.maximumTextureFilterAnisotropy,o=Math.min(r,y(this._maximumAnisotropy,r)),a=yfe(i,n,o),s=e.cache.imageryLayerMipmapSamplers;u(s)||(s={},e.cache.imageryLayerMipmapSamplers=s);let l=s[a];u(l)||(l=s[a]=new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:i,magnificationFilter:n,maximumAnisotropy:o})),t.generateMipmap(Xm.NICEST),t.sampler=l}else{let r=yfe(i,n,0),o=e.cache.imageryLayerNonMipmapSamplers;u(o)||(o={},e.cache.imageryLayerNonMipmapSamplers=o);let a=o[r];u(a)||(a=o[r]=new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:i,magnificationFilter:n})),t.sampler=a}},hi.prototype._reprojectTexture=function(e,t,i){let n=t.textureWebMercator||t.texture,r=t.rectangle,o=e.context;if((i=y(i,!0))&&!(this._imageryProvider.tilingScheme.projection instanceof Ii)&&r.width/n.width>1e-5){let e=this;t.addReference();let i=new od({persists:!0,owner:this,preExecute:function(e){AQe(e,o,n,t.rectangle)},postExecute:function(i){t.texture=i,e._finalizeReprojectTexture(o,i),t.state=oi.READY,t.releaseReference()},canceled:function(){t.state=oi.TEXTURE_LOADED,t.releaseReference()}});this._reprojectComputeCommands.push(i)}else i&&(t.texture=n),this._finalizeReprojectTexture(o,n),t.state=oi.READY},hi.prototype.queueReprojectionCommands=function(e){let t=this._reprojectComputeCommands,i=t.length;for(let n=0;n<i;++n)e.commandList.push(t[n]);t.length=0},hi.prototype.cancelReprojections=function(){this._reprojectComputeCommands.forEach((function(e){u(e.canceled)&&e.canceled()})),this._reprojectComputeCommands.length=0},hi.prototype.getImageryFromCache=function(e,t,i,n){let r=Tfe(e,t,i),o=this._imageryCache[r];return u(o)||(o=new Fv(this,e,t,i,n),this._imageryCache[r]=o),o.addReference(),o},hi.prototype.removeImageryFromCache=function(e){let t=Tfe(e.x,e.y,e.level);delete this._imageryCache[t]};var X3={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new U,texture:void 0},TQe=Bt.supportsTypedArrays()?new Float32Array(128):void 0;function AQe(e,t,i,n){let r=t.cache.imageryLayer_reproject;if(!u(r)){r=t.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){u(this.framebuffer)&&this.framebuffer.destroy(),u(this.vertexArray)&&this.vertexArray.destroy(),u(this.shaderProgram)&&this.shaderProgram.destroy()}};let e=new Float32Array(256),i=0;for(let t=0;t<64;++t){let n=t/63;e[i++]=0,e[i++]=n,e[i++]=1,e[i++]=n}let n={position:0,webMercatorT:1},o=Ur.getRegularGridIndices(2,64),a=ut.createIndexBuffer({context:t,typedArray:o,usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT});r.vertexArray=new ni({context:t,attributes:[{index:n.position,vertexBuffer:ut.createVertexBuffer({context:t,typedArray:e,usage:Be.STATIC_DRAW}),componentsPerAttribute:2},{index:n.webMercatorT,vertexBuffer:ut.createVertexBuffer({context:t,sizeInBytes:512,usage:Be.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:a});let s=new He({sources:[Y3]});r.shaderProgram=Kt.fromCache({context:t,vertexShaderSource:s,fragmentShaderSource:q3,attributeLocations:n}),r.sampler=new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.LINEAR,magnificationFilter:wi.LINEAR})}i.sampler=r.sampler;let o=i.width,a=i.height;X3.textureDimensions.x=o,X3.textureDimensions.y=a,X3.texture=i;let s=Math.sin(n.south),l=.5*Math.log((1+s)/(1-s));s=Math.sin(n.north);let c=1/(.5*Math.log((1+s)/(1-s))-l),h=new Ot({context:t,width:o,height:a,pixelFormat:i.pixelFormat,pixelDatatype:i.pixelDatatype,preMultiplyAlpha:i.preMultiplyAlpha});P.isPowerOfTwo(o)&&P.isPowerOfTwo(a)&&h.generateMipmap(Xm.NICEST);let d=n.south,p=n.north,f=TQe,m=0;for(let e=0;e<64;++e){let t=e/63,i=P.lerp(d,p,t);s=Math.sin(i);let n=(.5*Math.log((1+s)/(1-s))-l)*c;f[m++]=n,f[m++]=n}r.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(f),e.shaderProgram=r.shaderProgram,e.outputTexture=h,e.uniformMap=X3,e.vertexArray=r.vertexArray}function CQe(e,t,i){let n=e._imageryProvider,r=n.tilingScheme,o=r.ellipsoid,a=e._imageryProvider.tilingScheme.projection instanceof Ii?1:Math.cos(i),s=r.rectangle,l=o.maximumRadius*s.width*a/(n.tileWidth*r.getNumberOfXTilesAtLevel(0))/t,u=Math.log(l)/Math.log(2);return 0|Math.round(u)}function EQe(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}async function SQe(e,t){let i;try{if(i=await Promise.resolve(t),e.isDestroyed())return;e._imageryProvider=i,e._readyEvent.raiseEvent(i)}catch(t){EQe(e._errorEvent,t)}}var la=hi,Afe={NONE:0,CULLED:1,RENDERED:2,REFINED:3,RENDERED_AND_KICKED:6,REFINED_AND_KICKED:7,CULLED_BUT_NEEDED:9,wasKicked:function(e){return e>=Afe.RENDERED_AND_KICKED},originalResult:function(e){return 3&e},kick:function(e){return 4|e}},Kn=Afe;function uC(e){this.tile=e,this.frameLastUpdated=void 0,this.westMeshes=[],this.westTiles=[],this.southMeshes=[],this.southTiles=[],this.eastMeshes=[],this.eastTiles=[],this.northMeshes=[],this.northTiles=[],this.southwestMesh=void 0,this.southwestTile=void 0,this.southeastMesh=void 0,this.southeastTile=void 0,this.northwestMesh=void 0,this.northwestTile=void 0,this.northeastMesh=void 0,this.northeastTile=void 0,this.changedThisFrame=!0,this.visitedFrame=void 0,this.enqueuedFrame=void 0,this.mesh=void 0,this.vertexArray=void 0,this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new oe}uC.prototype.update=function(e,t,i){this.changedThisFrame&&(Ife(e,t,this.tile,i),this.changedThisFrame=!1)},uC.prototype.destroy=function(e){this._destroyVertexArray(e),u(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0)},uC.prototype._destroyVertexArray=function(e){u(this.vertexArray)&&(u(e)?e.push(this.vertexArray):Td._freeVertexArray(this.vertexArray),this.vertexArray=void 0)};var wQe=new f0;function cs(e,t,i,n,r,o,a,s,l){if(void 0===n)return;let c=n;for(;c&&(c._lastSelectionResultFrame!==r||Kn.wasKicked(c._lastSelectionResult)||Kn.originalResult(c._lastSelectionResult)===Kn.CULLED);){if(a)return;let e=c.parent;if(o>=pn.NORTHWEST&&void 0!==e)switch(o){case pn.NORTHWEST:c=c===e.northwestChild?e:void 0;break;case pn.NORTHEAST:c=c===e.northeastChild?e:void 0;break;case pn.SOUTHWEST:c=c===e.southwestChild?e:void 0;break;case pn.SOUTHEAST:c=c===e.southeastChild?e:void 0}else c=e}if(void 0!==c){if(c._lastSelectionResult===Kn.RENDERED){if(u(c.data.vertexArray))return;return void vQe(e,t,i,c,o,r,s,l)}if(Kn.originalResult(n._lastSelectionResult)!==Kn.CULLED)switch(o){case pn.WEST:cs(e,t,i,n.northwestChild,r,o,!0,s,l),cs(e,t,i,n.southwestChild,r,o,!0,s,l);break;case pn.EAST:cs(e,t,i,n.southeastChild,r,o,!0,s,l),cs(e,t,i,n.northeastChild,r,o,!0,s,l);break;case pn.SOUTH:cs(e,t,i,n.southwestChild,r,o,!0,s,l),cs(e,t,i,n.southeastChild,r,o,!0,s,l);break;case pn.NORTH:cs(e,t,i,n.northeastChild,r,o,!0,s,l),cs(e,t,i,n.northwestChild,r,o,!0,s,l);break;case pn.NORTHWEST:cs(e,t,i,n.northwestChild,r,o,!0,s,l);break;case pn.NORTHEAST:cs(e,t,i,n.northeastChild,r,o,!0,s,l);break;case pn.SOUTHWEST:cs(e,t,i,n.southwestChild,r,o,!0,s,l);break;case pn.SOUTHEAST:cs(e,t,i,n.southeastChild,r,o,!0,s,l);break;default:throw new de("Invalid edge")}}}function vQe(e,t,i,n,r,o,a,s){let l=n.data;if(void 0===l.fill)l.fill=new uC(n);else if(l.fill.visitedFrame===o)return;l.fill.enqueuedFrame!==o&&(l.fill.enqueuedFrame=o,l.fill.changedThisFrame=!1,a.enqueue(n)),DQe(e,t,i,n,r,s)}function DQe(e,t,i,n,r,o){let a,s,l,c=n.data.fill,h=i.data.fill;switch(u(h)?(h.visitedFrame=t.frameNumber,h.changedThisFrame&&(Ife(e,t,i,o),h.changedThisFrame=!1),a=i.data.fill.mesh):a=i.data.mesh,r){case pn.WEST:s=c.westMeshes,l=c.westTiles;break;case pn.SOUTH:s=c.southMeshes,l=c.southTiles;break;case pn.EAST:s=c.eastMeshes,l=c.eastTiles;break;case pn.NORTH:s=c.northMeshes,l=c.northTiles;break;case pn.NORTHWEST:return c.changedThisFrame=c.changedThisFrame||c.northwestMesh!==a,c.northwestMesh=a,void(c.northwestTile=i);case pn.NORTHEAST:return c.changedThisFrame=c.changedThisFrame||c.northeastMesh!==a,c.northeastMesh=a,void(c.northeastTile=i);case pn.SOUTHWEST:return c.changedThisFrame=c.changedThisFrame||c.southwestMesh!==a,c.southwestMesh=a,void(c.southwestTile=i);case pn.SOUTHEAST:return c.changedThisFrame=c.changedThisFrame||c.southeastMesh!==a,c.southeastMesh=a,void(c.southeastTile=i)}if(i.level<=n.level)return c.changedThisFrame=c.changedThisFrame||s[0]!==a||1!==s.length,s[0]=a,l[0]=i,s.length=1,void(l.length=1);let d,p,f,m,_,g=i.rectangle,y=n.rectangle;switch(r){case pn.WEST:for(_=(y.north-y.south)*P.EPSILON5,d=0;d<l.length&&(f=l[d],m=f.rectangle,!P.greaterThan(g.north,m.south,_));++d);for(p=d;p<l.length&&(f=l[p],m=f.rectangle,!P.greaterThanOrEquals(g.south,m.north,_));++p);break;case pn.SOUTH:for(_=(y.east-y.west)*P.EPSILON5,d=0;d<l.length&&(f=l[d],m=f.rectangle,!P.lessThan(g.west,m.east,_));++d);for(p=d;p<l.length&&(f=l[p],m=f.rectangle,!P.lessThanOrEquals(g.east,m.west,_));++p);break;case pn.EAST:for(_=(y.north-y.south)*P.EPSILON5,d=0;d<l.length&&(f=l[d],m=f.rectangle,!P.lessThan(g.south,m.north,_));++d);for(p=d;p<l.length&&(f=l[p],m=f.rectangle,!P.lessThanOrEquals(g.north,m.south,_));++p);break;case pn.NORTH:for(_=(y.east-y.west)*P.EPSILON5,d=0;d<l.length&&(f=l[d],m=f.rectangle,!P.greaterThan(g.east,m.west,_));++d);for(p=d;p<l.length&&(f=l[p],m=f.rectangle,!P.greaterThanOrEquals(g.west,m.east,_));++p);}p-d==1?(c.changedThisFrame=c.changedThisFrame||s[d]!==a,s[d]=a,l[d]=i):(c.changedThisFrame=!0,s.splice(d,p-d,a),l.splice(d,p-d,i))}uC.updateFillTiles=function(e,t,i,n){let r=e._quadtree,o=r._levelZeroTiles,a=r._lastSelectionFrameNumber,s=wQe;s.clear();for(let e=0;e<t.length;++e){let i=t[e];u(i.data.vertexArray)&&s.enqueue(t[e])}let l=s.dequeue();for(;void 0!==l;){let t=l.findTileToWest(o),r=l.findTileToSouth(o),u=l.findTileToEast(o),c=l.findTileToNorth(o);cs(e,i,l,t,a,pn.EAST,!1,s,n),cs(e,i,l,r,a,pn.NORTH,!1,s,n),cs(e,i,l,u,a,pn.WEST,!1,s,n),cs(e,i,l,c,a,pn.SOUTH,!1,s,n);let h=t.findTileToNorth(o),d=t.findTileToSouth(o),p=u.findTileToNorth(o),f=u.findTileToSouth(o);cs(e,i,l,h,a,pn.SOUTHEAST,!1,s,n),cs(e,i,l,p,a,pn.SOUTHWEST,!1,s,n),cs(e,i,l,d,a,pn.NORTHEAST,!1,s,n),cs(e,i,l,f,a,pn.NORTHWEST,!1,s,n),l=s.dequeue()}};var gx=new fe,IQe=new fe,lC=new h,uj=new h,aj=new U,cj=new U,Ql=new U;function tk(){this.height=0,this.encodedNormal=new U}function K3(e,t,i,n,r,o,a,s,l){if(u(r))return r;let c;if(u(o)&&u(a))c=.5*(o.height+a.height);else if(u(o))c=o.height;else if(u(a))c=a.height;else if(u(s))c=s.height;else{let t=e.tile.data.tileBoundingRegion,i=0,n=0;u(t)&&(i=t.minimumHeight,n=t.maximumHeight),c=.5*(i+n)}return Pfe(e,t,i,n,c,l),l}var PQe={minimumHeight:0,maximumHeight:0},OQe=new h,Cfe=new tk,Efe=new tk,Sfe=new tk,wfe=new tk,RQe=typeof Uint8Array<"u"?new Uint8Array(81):void 0,MQe={tilingScheme:void 0,x:0,y:0,level:0,exaggeration:1,exaggerationRelativeHeight:0};function Ife(e,t,i,n){Td.initialize(i,e.terrainProvider,e._imageryLayers);let r=i.data,o=r.fill,a=i.rectangle,s=t.terrainExaggeration,l=t.terrainExaggerationRelativeHeight,c=1!==s,h=i.tilingScheme.ellipsoid,d=$3(o,h,0,1,o.northwestTile,o.northwestMesh,o.northTiles,o.northMeshes,o.westTiles,o.westMeshes,Sfe),p=$3(o,h,0,0,o.southwestTile,o.southwestMesh,o.westTiles,o.westMeshes,o.southTiles,o.southMeshes,Cfe),f=$3(o,h,1,0,o.southeastTile,o.southeastMesh,o.southTiles,o.southMeshes,o.eastTiles,o.eastMeshes,Efe),m=$3(o,h,1,1,o.northeastTile,o.northeastMesh,o.eastTiles,o.eastMeshes,o.northTiles,o.northMeshes,wfe);d=K3(o,h,0,1,d,p,m,f,Sfe),p=K3(o,h,0,0,p,d,f,m,Cfe),f=K3(o,h,1,1,f,p,m,d,Efe),m=K3(o,h,1,1,m,f,d,p,wfe);let _,g,y=p.height,v=f.height,b=d.height,A=m.height,T=Math.min(y,v,b,A),E=Math.max(y,v,b,A),C=.5*(T+E),x=e.getLevelMaximumGeometricError(i.level),S=h.maximumRadius-x,w=4*Math.acos(S/h.maximumRadius);if(w*=1.5,a.width>w&&E-T<=x){let e=new va({width:9,height:9,buffer:RQe,structure:{heightOffset:E}}),t=MQe;t.tilingScheme=i.tilingScheme,t.x=i.x,t.y=i.y,t.level=i.level,t.exaggeration=s,t.exaggerationRelativeHeight=l,o.mesh=e._createMeshSync(t)}else{let t=c,n=ce.center(a,IQe);n.height=C;let r,u=h.cartographicToCartesian(n,OQe),y=new sc(u,void 0,void 0,void 0,void 0,!0,!0,t,s,l),v=5;for(r=o.westMeshes,_=0,g=r.length;_<g;++_)v+=r[_].eastIndicesNorthToSouth.length;for(r=o.southMeshes,_=0,g=r.length;_<g;++_)v+=r[_].northIndicesWestToEast.length;for(r=o.eastMeshes,_=0,g=r.length;_<g;++_)v+=r[_].westIndicesSouthToNorth.length;for(r=o.northMeshes,_=0,g=r.length;_<g;++_)v+=r[_].southIndicesEastToWest.length;let b=PQe;b.minimumHeight=T,b.maximumHeight=E;let A=y.stride,x=new Float32Array(v*A),S=0,w=S;S=Z3(h,a,y,x,S,0,1,d.height,d.encodedNormal,1,b),S=J3(o,h,y,x,S,o.westTiles,o.westMeshes,pn.EAST,b);let I=S;S=Z3(h,a,y,x,S,0,0,p.height,p.encodedNormal,0,b),S=J3(o,h,y,x,S,o.southTiles,o.southMeshes,pn.NORTH,b);let P=S;S=Z3(h,a,y,x,S,1,0,f.height,f.encodedNormal,0,b),S=J3(o,h,y,x,S,o.eastTiles,o.eastMeshes,pn.WEST,b);let D=S;S=Z3(h,a,y,x,S,1,1,m.height,m.encodedNormal,1,b),S=J3(o,h,y,x,S,o.northTiles,o.northMeshes,pn.SOUTH,b),T=b.minimumHeight,E=b.maximumHeight;let O=Pn.fromRectangle(a,T,E,i.tilingScheme.ellipsoid),L=Oi.geodeticLatitudeToMercatorAngle(a.south),R=1/(Oi.geodeticLatitudeToMercatorAngle(a.north)-L),N=(Oi.geodeticLatitudeToMercatorAngle(n.latitude)-L)*R,M=h.geodeticSurfaceNormalCartographic(gx,uj),F=Gn.octEncode(M,aj),B=S;y.encode(x,S*A,O.center,U.fromElements(.5,.5,Ql),C,F,N,M),++S;let z,k=S,V=3*(k-1),H=V*(k<256?1:2);if((x.length-k*A)*Float32Array.BYTES_PER_ELEMENT>=H){let e=k*A*Float32Array.BYTES_PER_ELEMENT;z=k<256?new Uint8Array(x.buffer,e,V):new Uint16Array(x.buffer,e,V)}else z=k<256?new Uint8Array(V):new Uint16Array(V);x=new Float32Array(x.buffer,0,k*A);let G=0;for(_=0;_<k-2;++_)z[G++]=B,z[G++]=_,z[G++]=_+1;z[G++]=B,z[G++]=_,z[G++]=0;let j=[];for(_=I;_>=w;--_)j.push(_);let W=[];for(_=P;_>=I;--_)W.push(_);let q=[];for(_=D;_>=P;--_)q.push(_);let Y=[];for(Y.push(0),_=B-1;_>=D;--_)Y.push(_);o.mesh=new Ff(y.center,x,z,V,k,T,E,se.fromOrientedBoundingBox(O),UQe(e,O.center,a,T,E),y.stride,O,y,j,W,q,Y)}let I=t.context;o._destroyVertexArray(n),o.vertexArray=Td._createVertexArrayForMesh(I,o.mesh),r.processImagery(i,e.terrainProvider,t,!0);let P=o.waterMaskTexture;if(o.waterMaskTexture=void 0,e.terrainProvider.hasWaterMask){let e=r._findAncestorTileWithTerrainData(i);u(e)&&u(e.data.waterMaskTexture)&&(o.waterMaskTexture=e.data.waterMaskTexture,++o.waterMaskTexture.referenceCount,r._computeWaterMaskTranslationAndScale(i,e,o.waterMaskTranslationAndScale))}u(P)&&(--P.referenceCount,0===P.referenceCount&&P.destroy())}function Z3(e,t,i,n,r,o,a,s,l,u,c){let h=gx;h.longitude=P.lerp(t.west,t.east,o),h.latitude=P.lerp(t.south,t.north,a),h.height=s;let d,p=e.cartographicToCartesian(h,lC);i.hasGeodeticSurfaceNormals&&(d=e.geodeticSurfaceNormal(p,uj));let f=cj;return f.x=o,f.y=a,i.encode(n,r*i.stride,p,f,s,l,u,d),c.minimumHeight=Math.min(c.minimumHeight,s),c.maximumHeight=Math.max(c.maximumHeight,s),r+1}var ek=new ce;function kv(e,t,i,n){let r=e.rectangle,o=t.rectangle;0===t.x&&1===i.x&&e.x===e.tilingScheme.getNumberOfXTilesAtLevel(e.level)-1?(r=ce.clone(e.rectangle,ek),r.west-=P.TWO_PI,r.east-=P.TWO_PI):0===e.x&&0===i.x&&t.x===t.tilingScheme.getNumberOfXTilesAtLevel(t.level)-1&&(r=ce.clone(e.rectangle,ek),r.west+=P.TWO_PI,r.east+=P.TWO_PI);let a=r.east-r.west,s=(o.west-r.west)/a,l=(o.east-r.west)/a,u=r.north-r.south,c=(o.south-r.south)/u,h=(o.north-r.south)/u,d=(i.x-s)/(l-s),p=(i.y-c)/(h-c);return Math.abs(d)<Math.EPSILON5?d=0:Math.abs(d-1)<Math.EPSILON5&&(d=1),Math.abs(p)<Math.EPSILON5?p=0:Math.abs(p-1)<Math.EPSILON5&&(p=1),n.x=d,n.y=p,n}var LQe=new U;function lj(e,t,i,n,r){let o=e.encoding,a=e.vertices;if(r.height=o.decodeHeight(a,t),o.hasVertexNormals)o.getOctEncodedNormal(a,t,r.encodedNormal);else{let e=r.encodedNormal;e.x=0,e.y=0}}var NQe=new U,FQe=new h;function BQe(e,t,i,n,r,o,a,s,l,u){let c,d=n.encoding,p=n.vertices,f=kv(t,i,d.decodeTextureCoordinates(p,r,Ql),Ql),m=kv(t,i,d.decodeTextureCoordinates(p,o,cj),cj);c=l?(a-f.x)/(m.x-f.x):(s-f.y)/(m.y-f.y);let _,g=d.decodeHeight(p,r),y=d.decodeHeight(p,o),v=i.rectangle;if(gx.longitude=P.lerp(v.west,v.east,a),gx.latitude=P.lerp(v.south,v.north,s),u.height=gx.height=P.lerp(g,y,c),d.hasVertexNormals){let e=d.getOctEncodedNormal(p,r,LQe),t=d.getOctEncodedNormal(p,o,NQe),i=Gn.octDecode(e.x,e.y,lC),n=Gn.octDecode(t.x,t.y,FQe);_=h.lerp(i,n,c,lC),h.normalize(_,_),Gn.octEncode(_,u.encodedNormal)}else _=e.geodeticSurfaceNormalCartographic(gx,lC),Gn.octEncode(_,u.encodedNormal)}function Pfe(e,t,i,n,r,o){o.height=r;let a=t.geodeticSurfaceNormalCartographic(gx,lC);Gn.octEncode(a,o.encodedNormal)}function $3(e,t,i,n,r,o,a,s,l,c,h){if(Dfe(e,t,s,a,!1,i,n,h)||Dfe(e,t,c,l,!0,i,n,h))return h;let d,p;return fj(r,o)?(d=0===i?0===n?o.eastIndicesNorthToSouth[0]:o.southIndicesEastToWest[0]:0===n?o.northIndicesWestToEast[0]:o.westIndicesSouthToNorth[0],lj(o,d,i,n,h),h):(p=0===i?0===n?Q3(e.westMeshes,e.westTiles,pn.EAST,e.southMeshes,e.southTiles,pn.NORTH,i,n):Q3(e.northMeshes,e.northTiles,pn.SOUTH,e.westMeshes,e.westTiles,pn.EAST,i,n):0===n?Q3(e.southMeshes,e.southTiles,pn.NORTH,e.eastMeshes,e.eastTiles,pn.WEST,i,n):Q3(e.eastMeshes,e.eastTiles,pn.WEST,e.northMeshes,e.northTiles,pn.SOUTH,i,n),u(p)?(Pfe(e,t,i,n,p,h),h):void 0)}function Q3(e,t,i,n,r,o,a,s){let l=vfe(e,t,!1,i,a,s),c=vfe(n,r,!0,o,a,s);return u(l)&&u(c)?.5*(l+c):u(l)?l:c}function J3(e,t,i,n,r,o,a,s,l){for(let u=0;u<o.length;++u)r=kQe(e,t,i,n,r,o[u],a[u],s,l);return r}function kQe(e,t,i,n,r,o,a,s,l){let u=o.rectangle;s===pn.EAST&&0===e.tile.x?(u=ce.clone(o.rectangle,ek),u.west-=P.TWO_PI,u.east-=P.TWO_PI):s===pn.WEST&&0===o.x&&(u=ce.clone(o.rectangle,ek),u.west+=P.TWO_PI,u.east+=P.TWO_PI);let c,h,d,p,f=e.tile.rectangle;switch(r>0&&(i.decodeTextureCoordinates(n,r-1,Ql),c=Ql.x,h=Ql.y),s){case pn.WEST:d=a.westIndicesSouthToNorth,p=!1;break;case pn.NORTH:d=a.northIndicesWestToEast,p=!0;break;case pn.EAST:d=a.eastIndicesNorthToSouth,p=!1;break;case pn.SOUTH:d=a.southIndicesEastToWest,p=!0}let m,_,g=o,y=e.tile,v=a.encoding,b=a.vertices,A=i.stride;v.hasWebMercatorT&&(m=Oi.geodeticLatitudeToMercatorAngle(f.south),_=1/(Oi.geodeticLatitudeToMercatorAngle(f.north)-m));for(let e=0;e<d.length;++e){let o=d[e],a=v.decodeTextureCoordinates(b,o,Ql);kv(g,y,a,a);let s=a.x,u=a.y,T=p?s:u;if(T<0||T>1||Math.abs(s-c)<P.EPSILON5&&Math.abs(u-h)<P.EPSILON5)continue;let E=Math.abs(s)<P.EPSILON5||Math.abs(s-1)<P.EPSILON5,C=Math.abs(u)<P.EPSILON5||Math.abs(u-1)<P.EPSILON5;if(E&&C)continue;let x,S=v.decodePosition(b,o,lC),w=v.decodeHeight(b,o);v.hasVertexNormals?x=v.getOctEncodedNormal(b,o,aj):(x=aj,x.x=0,x.y=0);let I,D=u;if(v.hasWebMercatorT){let e=P.lerp(f.south,f.north,u);D=(Oi.geodeticLatitudeToMercatorAngle(e)-m)*_}i.hasGeodeticSurfaceNormals&&(I=t.geodeticSurfaceNormal(S,uj)),i.encode(n,r*A,S,a,w,x,D,I),l.minimumHeight=Math.min(l.minimumHeight,w),l.maximumHeight=Math.max(l.maximumHeight,w),++r}return r}function vfe(e,t,i,n,r,o){let a,s,l;i?(a=0,s=e.length,l=1):(a=e.length-1,s=-1,l=-1);for(let r=a;r!==s;r+=l){let o,a=e[r];if(!fj(t[r],a))continue;switch(n){case pn.WEST:o=a.westIndicesSouthToNorth;break;case pn.SOUTH:o=a.southIndicesEastToWest;break;case pn.EAST:o=a.eastIndicesNorthToSouth;break;case pn.NORTH:o=a.northIndicesWestToEast}let s=o[i?0:o.length-1];if(u(s))return a.encoding.decodeHeight(a.vertices,s)}}function fj(e,t){return u(t)&&(!u(e.data.fill)||!e.data.fill.changedThisFrame)}function Dfe(e,t,i,n,r,o,a,s){let l,u,c,h,d,p=n[r?0:i.length-1],f=i[r?0:i.length-1];if(fj(p,f)&&(0===o?0===a?(l=r?f.northIndicesWestToEast:f.eastIndicesNorthToSouth,u=r,c=r):(l=r?f.eastIndicesNorthToSouth:f.southIndicesEastToWest,u=!r,c=!1):0===a?(l=r?f.westIndicesSouthToNorth:f.northIndicesWestToEast,u=!r,c=!0):(l=r?f.southIndicesEastToWest:f.westIndicesSouthToNorth,u=r,c=!r),l.length>0)){h=r?0:l.length-1,d=l[h],f.encoding.decodeTextureCoordinates(f.vertices,d,Ql);let i=kv(p,e.tile,Ql,Ql);if(i.x===o&&i.y===a)return lj(f,d,o,a,s),!0;if(h=Eo(l,u?o:a,(function(t,i){f.encoding.decodeTextureCoordinates(f.vertices,t,Ql);let n=kv(p,e.tile,Ql,Ql);return c?u?n.x-o:n.y-a:u?o-n.x:a-n.y})),!(h<0))return lj(f,l[h],o,a,s),!0;if(h=~h,h>0&&h<l.length)return BQe(t,p,e.tile,f,l[h-1],l[h],o,a,u,s),!0}return!1}var VQe=[new h,new h,new h,new h];function UQe(e,t,i,n,r,o){let a=e.quadtree._occluders.ellipsoid,s=a.ellipsoid,l=VQe;return h.fromRadians(i.west,i.south,r,s,l[0]),h.fromRadians(i.east,i.south,r,s,l[1]),h.fromRadians(i.west,i.north,r,s,l[2]),h.fromRadians(i.east,i.north,r,s,l[3]),a.computeHorizonCullingPointPossiblyUnderEllipsoid(t,l,n,o)}var Vv=uC;function Yo(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.dynamicAtmosphereLighting=!1,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!1,this.shadows=yn.RECEIVE_ONLY,this.vertexShadowDarkness=.3,this.fillHighlightColor=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this.showSkirts=!0,this.backFaceCulling=!0,this.undergroundColor=void 0,this.undergroundColorAlphaByDistance=void 0,this.lambertDiffuseMultiplier=0,this.materialUniformMap=void 0,this._materialUniformMap=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._disableCullingRenderState=void 0,this._disableCullingBlendRenderState=void 0,this._errorEvent=new pe,this._removeLayerAddedListener=this._imageryLayers.layerAdded.addEventListener(Yo.prototype._onLayerAdded,this),this._removeLayerRemovedListener=this._imageryLayers.layerRemoved.addEventListener(Yo.prototype._onLayerRemoved,this),this._removeLayerMovedListener=this._imageryLayers.layerMoved.addEventListener(Yo.prototype._onLayerMoved,this),this._removeLayerShownListener=this._imageryLayers.layerShownOrHidden.addEventListener(Yo.prototype._onLayerShownOrHidden,this),this._imageryLayersUpdatedEvent=new pe,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new z(0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=ce.clone(ce.MAX_VALUE),this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1,this._oldTerrainExaggeration=void 0,this._oldTerrainExaggerationRelativeHeight=void 0}function zQe(e,t){let i=e.loadingImagery;u(i)||(i=e.readyImagery);let n=t.loadingImagery;return u(n)||(n=t.readyImagery),i.imageryLayer._layerIndex-n.imageryLayer._layerIndex}function HQe(e,t){let i=t.creditDisplay,n=e._terrainProvider;u(n)&&u(n.credit)&&i.addCreditToNextFrame(n.credit);let r=e._imageryLayers;for(let e=0,t=r.length;e<t;++e){let t=r.get(e);t.ready&&t.show&&u(t.imageryProvider.credit)&&i.addCreditToNextFrame(t.imageryProvider.credit)}}function Nfe(e,t){let i=t.globeTranslucencyState;if(i.translucent){let n=e.renderState.blending.enabled;i.pushDerivedCommands(e,n,t)}else t.commandList.push(e)}Object.defineProperties(Yo.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=oe.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},tilingScheme:{get:function(){if(u(this._terrainProvider))return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,u(this._quadtree)&&this._quadtree.invalidateAllTiles())}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){ys.setOwner(e,this,"_clippingPlanes")}}}),Yo.prototype.update=function(e){this._imageryLayers._update()},Yo.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile((function(e){e.data.imagery.sort(zQe)}))),HQe(this,e);let t=this._vertexArraysToDestroy,i=t.length;for(let e=0;e<i;++e)Td._freeVertexArray(t[e]);t.length=0},Yo.prototype.beginUpdate=function(e){let t=this._tilesToRenderByTextureCount;for(let e=0,i=t.length;e<i;++e){let i=t[e];u(i)&&(i.length=0)}let i=this._clippingPlanes;u(i)&&i.enabled&&i.update(e),this._usedDrawCommands=0,this._hasLoadedTilesThisFrame=!1,this._hasFillTilesThisFrame=!1},Yo.prototype.endUpdate=function(e){if(!u(this._renderState)){this._renderState=Ue.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:yc.LESS}}),this._blendRenderState=Ue.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:yc.LESS_OR_EQUAL},blending:ln.ALPHA_BLEND});let e=Ge(this._renderState,!0);e.cull.enabled=!1,this._disableCullingRenderState=Ue.fromCache(e),e=Ge(this._blendRenderState,!0),e.cull.enabled=!1,this._disableCullingBlendRenderState=Ue.fromCache(e)}this._hasFillTilesThisFrame&&this._hasLoadedTilesThisFrame&&Vv.updateFillTiles(this,this._quadtree._tilesToRender,e,this._vertexArraysToDestroy);let t=this.quadtree,i=e.terrainExaggeration,n=e.terrainExaggerationRelativeHeight,r=this._oldTerrainExaggeration!==i||this._oldTerrainExaggerationRelativeHeight!==n;this._oldTerrainExaggeration=i,this._oldTerrainExaggerationRelativeHeight=n,r&&t.forEachLoadedTile((function(i){i.data.updateExaggeration(i,e,t)}));let o=this._tilesToRenderByTextureCount;for(let t=0,i=o.length;t<i;++t){let i=o[t];if(u(i))for(let t=0,n=i.length;t<n;++t){let n=i[t],r=n.data.tileBoundingRegion;dJe(this,n,e),e.minimumTerrainHeight=Math.min(e.minimumTerrainHeight,r.minimumHeight)}}},Yo.prototype.updateForPick=function(e){let t=this._drawCommands;for(let i=0,n=this._usedDrawCommands;i<n;++i)Nfe(t[i],e)},Yo.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},Yo.prototype.getLevelMaximumGeometricError=function(e){return u(this._terrainProvider)?this._terrainProvider.getLevelMaximumGeometricError(e):0},Yo.prototype.loadTile=function(e,t){let i,n=t.data,r=!0;u(n)&&(r=n.boundingVolumeSourceTile!==t||t._lastSelectionResult===Kn.CULLED_BUT_NEEDED,i=n.terrainState),Td.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,r),n=t.data,r&&i!==t.data.terrainState&&this.computeTileVisibility(t,e,this.quadtree.occluders)!==rr.NONE&&n.boundingVolumeSourceTile===t&&(r=!1,Td.processStateMachine(t,e,this.terrainProvider,this._imageryLayers,this.quadtree,this._vertexArraysToDestroy,r))};var GQe=new se,Ffe=new ce,WQe=new ce,jQe=new fe;function ik(e,t){if(t.west<t.east)return t;let i=ce.clone(t,WQe);return ce.center(e,jQe).longitude>0?i.east=P.PI:i.west=-P.PI,i}function Bfe(e,t){if(t.cameraUnderground||t.globeTranslucencyState.translucent)return!0;if(e.backFaceCulling)return!1;let i=e._clippingPlanes;return!!(u(i)&&i.enabled||!ce.equals(e.cartographicLimitRectangle,ce.MAX_VALUE))}Yo.prototype.computeTileVisibility=function(e,t,i){let n=this.computeDistanceToTile(e,t);e._distance=n;let r=Bfe(this,t);if(t.fog.enabled&&!r&&P.fog(n,t.fog.density)>=1)return rr.NONE;let o=e.data,a=o.tileBoundingRegion;if(void 0===o.boundingVolumeSourceTile)return rr.PARTIAL;let s=t.cullingVolume,l=a.boundingVolume;u(l)||(l=a.boundingSphere),o.clippedByBoundaries=!1;let c=ik(e.rectangle,this.cartographicLimitRectangle),d=ce.simpleIntersection(c,e.rectangle,Ffe);if(!u(d))return rr.NONE;if(ce.equals(d,e.rectangle)||(o.clippedByBoundaries=!0),t.mode!==te.SCENE3D&&(l=GQe,se.fromRectangleWithHeights2D(e.rectangle,t.mapProjection,a.minimumHeight,a.maximumHeight,l),h.fromElements(l.center.z,l.center.x,l.center.y,l.center),t.mode===te.MORPHING&&u(o.renderedMesh)&&(l=se.union(a.boundingSphere,l,l))),!u(l))return rr.PARTIAL;let p=this._clippingPlanes;if(u(p)&&p.enabled){let t=p.computeIntersectionWithBoundingVolume(l);if(e.isClipped=t!==Zt.INSIDE,t===Zt.OUTSIDE)return rr.NONE}let f,m=s.computeVisibility(l);if(m===Zt.OUTSIDE?f=rr.NONE:m===Zt.INTERSECTING?f=rr.PARTIAL:m===Zt.INSIDE&&(f=rr.FULL),f===rr.NONE)return f;let _=t.mode===te.SCENE3D&&t.camera.frustum instanceof Qt;if(t.mode===te.SCENE3D&&!_&&u(i)&&!r){let e=o.occludeePointInScaledSpace;return!u(e)||i.ellipsoid.isScaledSpacePointVisiblePossiblyUnderEllipsoid(e,a.minimumHeight)?f:rr.NONE}return f},Yo.prototype.canRefine=function(e){return!!u(e.data.terrainData)||void 0!==this.terrainProvider.getTileDataAvailable(2*e.x,2*e.y,e.level+1)};var qQe=[],YQe=[];Yo.prototype.canRenderWithoutLosingDetail=function(e,t){let i=e.data,n=qQe;n.length=this._imageryLayers.length;let r,o,a,s=!1,l=!1;for(u(i)&&(s=i.terrainState===so.READY,l=!0,r=i.imagery),o=0,a=n.length;o<a;++o)n[o]=l;if(u(r))for(o=0,a=r.length;o<a;++o){let e=r[o],t=e.loadingImagery,i=!u(t)||t.state===oi.FAILED||t.state===oi.INVALID,a=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;n[a]=i&&n[a]}let c=this.quadtree._lastSelectionFrameNumber,h=YQe;for(h.length=0,h.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild);h.length>0;){let e=h.pop(),t=e._lastSelectionResultFrame===c?e._lastSelectionResult:Kn.NONE;if(t===Kn.RENDERED){let t=e.data;if(!u(t))continue;if(!s&&e.data.terrainState===so.READY)return!1;let i=e.data.imagery;for(o=0,a=i.length;o<a;++o){let e=i[o],t=e.loadingImagery,r=!u(t)||t.state===oi.FAILED||t.state===oi.INVALID,a=(e.loadingImagery||e.readyImagery).imageryLayer._layerIndex;if(r&&!n[a])return!1}}else t===Kn.REFINED&&h.push(e.southwestChild,e.southeastChild,e.northwestChild,e.northeastChild)}return!0};var XQe=new h;Yo.prototype.computeTileLoadPriority=function(e,t){let i=e.data;if(void 0===i)return 0;let n=i.tileBoundingRegion.boundingVolume;if(void 0===n)return 0;let r=t.camera.positionWC,o=t.camera.directionWC,a=h.subtract(n.center,r,XQe),s=h.magnitude(a);return s<P.EPSILON5?0:(h.divideByScalar(a,s,a),(1-h.dot(a,o))*e._distance)};var Ofe=new L,nk=new L,KQe=new oe,ZQe=new oe,$Qe=new oe,QQe=new h,Rfe=new h,JQe=new h,eJe=new h;Yo.prototype.showTileThisFrame=function(e,t){let i=0,n=e.data.imagery;for(let e=0,t=n.length;e<t;++e){let t=n[e];u(t.readyImagery)&&0!==t.readyImagery.imageryLayer.alpha&&++i}let r=this._tilesToRenderByTextureCount[i];u(r)||(r=[],this._tilesToRenderByTextureCount[i]=r),r.push(e);let o=e.data;u(o.vertexArray)?this._hasLoadedTilesThisFrame=!0:this._hasFillTilesThisFrame=!0;let a=this._debug;++a.tilesRendered,a.texturesRendered+=i};var tJe=[new h,new h,new h,new h];function Mfe(e,t,i,n,r,o){let a=e.quadtree._occluders.ellipsoid,s=a.ellipsoid,l=tJe;return h.fromRadians(i.west,i.south,r,s,l[0]),h.fromRadians(i.east,i.south,r,s,l[1]),h.fromRadians(i.west,i.north,r,s,l[2]),h.fromRadians(i.east,i.north,r,s,l[3]),a.computeHorizonCullingPointPossiblyUnderEllipsoid(t,l,n,o)}function nJe(e,t,i){let n=e.data;void 0===n&&(n=e.data=new Td);let r=e.tilingScheme.ellipsoid;void 0===n.tileBoundingRegion&&(n.tileBoundingRegion=new md({computeBoundingVolumes:!1,rectangle:e.rectangle,ellipsoid:r,minimumHeight:0,maximumHeight:0}));let o=n.tileBoundingRegion,a=o.minimumHeight,s=o.maximumHeight,l=!1,c=e,d=n.mesh,p=n.terrainData;if(void 0!==d&&void 0!==d.minimumHeight&&void 0!==d.maximumHeight)o.minimumHeight=d.minimumHeight,o.maximumHeight=d.maximumHeight,l=!0;else if(void 0!==p&&void 0!==p._minimumHeight&&void 0!==p._maximumHeight)o.minimumHeight=p._minimumHeight,o.maximumHeight=p._maximumHeight;else{o.minimumHeight=Number.NaN,o.maximumHeight=Number.NaN;let t=e.parent;for(;void 0!==t;){let e=t.data;if(void 0!==e){let t=e.mesh,i=e.terrainData;if(void 0!==t&&void 0!==t.minimumHeight&&void 0!==t.maximumHeight){o.minimumHeight=t.minimumHeight,o.maximumHeight=t.maximumHeight;break}if(void 0!==i&&void 0!==i._minimumHeight&&void 0!==i._maximumHeight){o.minimumHeight=i._minimumHeight,o.maximumHeight=i._maximumHeight;break}}t=t.parent}c=t}if(void 0!==c){let p=i.terrainExaggeration,f=i.terrainExaggerationRelativeHeight;if(1!==p&&(l=!1,o.minimumHeight=Wc.getHeight(o.minimumHeight,p,f),o.maximumHeight=Wc.getHeight(o.maximumHeight,p,f)),l)n.boundingVolumeIsFromMesh||(o._orientedBoundingBox=Pn.clone(d.orientedBoundingBox,o._orientedBoundingBox),o._boundingSphere=se.clone(d.boundingSphere3D,o._boundingSphere),n.occludeePointInScaledSpace=h.clone(d.occludeePointInScaledSpace,n.occludeePointInScaledSpace),u(n.occludeePointInScaledSpace)||(n.occludeePointInScaledSpace=Mfe(t,o._orientedBoundingBox.center,e.rectangle,o.minimumHeight,o.maximumHeight,n.occludeePointInScaledSpace)));else{let i=void 0===o._orientedBoundingBox||void 0===o._boundingSphere;(o.minimumHeight!==a||o.maximumHeight!==s||i)&&(o.computeBoundingVolumes(r),n.occludeePointInScaledSpace=Mfe(t,o._orientedBoundingBox.center,e.rectangle,o.minimumHeight,o.maximumHeight,n.occludeePointInScaledSpace))}n.boundingVolumeSourceTile=c,n.boundingVolumeIsFromMesh=l}else n.boundingVolumeSourceTile=void 0,n.boundingVolumeIsFromMesh=!1}function iJe(e,t,i){return function(n){let r,o,a,s=-1,l=n.data.imagery,c=l.length;for(a=0;a<c;++a)if(r=l[a],o=y(r.readyImagery,r.loadingImagery),o.imageryLayer===t){s=a;break}if(-1!==s){let c=s+e;if(r=l[c],o=u(r)?y(r.readyImagery,r.loadingImagery):void 0,!u(o)||o.imageryLayer!==t)return!t._createTileImagerySkeletons(n,i,c);for(a=s;a<c;++a)l[a].freeResources();l.splice(s,e)}return!0}}Yo.prototype.computeDistanceToTile=function(e,t){nJe(e,this,t);let i=e.data;if(void 0===i.boundingVolumeSourceTile)return 9999999999;let n=i.tileBoundingRegion,r=n.minimumHeight,o=n.maximumHeight;if(i.boundingVolumeSourceTile!==e){let e=t.camera.positionCartographic.height;Math.abs(e-r)>Math.abs(e-o)?(n.minimumHeight=r,n.maximumHeight=r):(n.minimumHeight=o,n.maximumHeight=o)}let a=n.distanceToCamera(t);return n.minimumHeight=r,n.maximumHeight=o,a},Yo.prototype.isDestroyed=function(){return!1},Yo.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._removeLayerAddedListener=this._removeLayerAddedListener&&this._removeLayerAddedListener(),this._removeLayerRemovedListener=this._removeLayerRemovedListener&&this._removeLayerRemovedListener(),this._removeLayerMovedListener=this._removeLayerMovedListener&&this._removeLayerMovedListener(),this._removeLayerShownListener=this._removeLayerShownListener&&this._removeLayerShownListener(),le(this)},Yo.prototype._onLayerAdded=function(e,t){if(!this.isDestroyed()&&e.show){let t=this._terrainProvider,i=this,n=this._imageryLayersUpdatedEvent,r=function(){e._imageryCache={},i._quadtree.forEachLoadedTile((function(i){if(u(i._loadedCallbacks[e._layerIndex]))return;let n,r=i.data.imagery,o=r.length,a=-1,s=0;for(n=0;n<o;++n){let t=r[n];if(y(t.readyImagery,t.loadingImagery).imageryLayer===e)-1===a&&(a=n),++s;else if(-1!==a)break}if(-1===a)return;let l=a+s;e._createTileImagerySkeletons(i,t,l)&&(i._loadedCallbacks[e._layerIndex]=iJe(s,e,t),i.state=Gs.LOADING)}))};if(e.ready){e.imageryProvider._reload=r}this._quadtree.forEachLoadedTile((function(n){e._createTileImagerySkeletons(n,t)&&(n.state=Gs.LOADING,0!==n.level&&(n._lastSelectionResultFrame!==i.quadtree._lastSelectionFrameNumber||n._lastSelectionResult!==Kn.RENDERED)&&(n.renderable=!1))})),this._layerOrderChanged=!0,n.raiseEvent()}},Yo.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile((function(t){let i=t.data.imagery,n=-1,r=0;for(let t=0,o=i.length;t<o;++t){let o=i[t],a=o.loadingImagery;if(u(a)||(a=o.readyImagery),a.imageryLayer===e)-1===n&&(n=t),o.freeResources(),++r;else if(-1!==n)break}-1!==n&&i.splice(n,r)})),u(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},Yo.prototype._onLayerMoved=function(e,t,i){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},Yo.prototype._onLayerShownOrHidden=function(e,t,i){i?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var oJe=new L,rJe=new L,kfe,Vfe,ok;function Lfe(e,t){let i={u_initialColor:function(){return this.properties.initialColor},u_fillHighlightColor:function(){return this.properties.fillHighlightColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_atmosphereLightIntensity:function(){return this.properties.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return this.properties.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return this.properties.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return this.properties.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return this.properties.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return this.properties.atmosphereMieAnisotropy},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_terrainExaggerationAndRelativeHeight:function(){return this.properties.terrainExaggerationAndRelativeHeight},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){let t=e.context.uniformState.view,i=L.multiplyByPoint(t,this.properties.rtc,Rfe);return L.setTranslation(t,i,Ofe),Ofe},u_modifiedModelViewProjection:function(){let t=e.context.uniformState.view,i=e.context.uniformState.projection,n=L.multiplyByPoint(t,this.properties.rtc,Rfe);return L.setTranslation(t,n,nk),L.multiply(i,nk,nk),nk},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureNightAlpha:function(){return this.properties.dayTextureNightAlpha},u_dayTextureDayAlpha:function(){return this.properties.dayTextureDayAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){let i=t._clippingPlanes;return u(i)&&u(i.texture)?i.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){let i=t._clippingPlanes,n=u(i)?L.multiply(e.context.uniformState.view,i.modelMatrix,oJe):L.IDENTITY;return L.inverseTranspose(n,rJe)},u_clippingPlanesEdgeStyle:function(){let e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},u_colorsToAlpha:function(){return this.properties.colorsToAlpha},u_frontFaceAlphaByDistance:function(){return this.properties.frontFaceAlphaByDistance},u_backFaceAlphaByDistance:function(){return this.properties.backFaceAlphaByDistance},u_translucencyRectangle:function(){return this.properties.localizedTranslucencyRectangle},u_undergroundColor:function(){return this.properties.undergroundColor},u_undergroundColorAlphaByDistance:function(){return this.properties.undergroundColorAlphaByDistance},u_lambertDiffuseMultiplier:function(){return this.properties.lambertDiffuseMultiplier},u_vertexShadowDarkness:function(){return this.properties.vertexShadowDarkness},properties:{initialColor:new oe(0,0,.5,1),fillHighlightColor:new z(0,0,0,0),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new U(65e5,9e6),nightFadeDistance:new U(1e7,4e7),atmosphereLightIntensity:10,atmosphereRayleighCoefficient:new h(55e-7,13e-6,284e-7),atmosphereMieCoefficient:new h(21e-6,21e-6,21e-6),atmosphereRayleighScaleHeight:1e4,atmosphereMieScaleHeight:3200,atmosphereMieAnisotropy:.9,hsbShift:new h,center3D:void 0,rtc:new h,modifiedModelView:new L,tileRectangle:new oe,terrainExaggerationAndRelativeHeight:new U(1,0),dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureNightAlpha:[],dayTextureDayAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,colorsToAlpha:[],southAndNorthLatitude:new U,southMercatorYAndOneOverHeight:new U,waterMask:void 0,waterMaskTranslationAndScale:new oe,minMaxHeight:new U,scaleAndBias:new L,clippingPlanesEdgeColor:z.clone(z.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new oe,frontFaceAlphaByDistance:new oe,backFaceAlphaByDistance:new oe,localizedTranslucencyRectangle:new oe,undergroundColor:z.clone(z.TRANSPARENT),undergroundColorAlphaByDistance:new oe,lambertDiffuseMultiplier:0,vertexShadowDarkness:0}};return u(t.materialUniformMap)?gt(i,t.materialUniformMap):i}function sJe(e,t,i){let n,r,o=i.data;if(u(o.vertexArray)?(n=o.mesh,r=o.vertexArray):u(o.fill)&&u(o.fill.vertexArray)&&(n=o.fill.mesh,r=o.fill.vertexArray),u(n)&&u(r)){if(u(o.wireframeVertexArray)){if(o.wireframeVertexArray.mesh===n)return;o.wireframeVertexArray.destroy(),o.wireframeVertexArray=void 0}o.wireframeVertexArray=aJe(e,r,n),o.wireframeVertexArray.mesh=n}}function aJe(e,t,i){let n={indices:i.indices,primitiveType:Ne.TRIANGLES};Fn.toWireframe(n);let r=n.indices,o=ut.createIndexBuffer({context:e,typedArray:r,usage:Be.STATIC_DRAW,indexDatatype:ke.fromSizeInBytes(r.BYTES_PER_ELEMENT)});return new ni({context:e,attributes:t._attributes,indexBuffer:o})}!function(){let e,t,i=new yt({geometry:lh.fromDimensions({dimensions:new h(2,2,2)})}),n=new yt({geometry:new X_({radius:1})}),r=new L;function o(e){return new Sn({geometryInstances:e,appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1})}kfe=function(n,a){return n===e||(ok(),e=n,r=L.fromRotationTranslation(n.halfAxes,n.center,r),i.modelMatrix=r,i.attributes.color=kt.fromColor(a),t=o(i)),t},Vfe=function(i,a){return i===e||(ok(),e=i,r=L.fromTranslation(i.center,r),r=L.multiplyByUniformScale(r,i.radius,r),n.modelMatrix=r,n.attributes.color=kt.fromColor(a),t=o(n)),t},ok=function(){u(t)&&(t.destroy(),t=void 0,e=void 0)}}();var cJe=new oe(0,0,0,0),lJe={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applyDayNightAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,dynamicAtmosphereLighting:void 0,dynamicAtmosphereLightingFromSun:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0,colorToAlpha:void 0,hasGeodeticSurfaceNormals:void 0,hasExaggeration:void 0},uJe=z.TRANSPARENT,fJe=new Pt;function dJe(e,t,i){let n=t.data;u(n.vertexArray)||(void 0===n.fill&&(n.fill=new Vv(t)),n.fill.update(e,i));let r=i.creditDisplay,o=n.terrainData;if(u(o)&&u(o.credits)){let e=o.credits;for(let t=0,i=e.length;t<i;++t)r.addCreditToNextFrame(e[t])}let a=zt.maximumTextureImageUnits,s=n.waterMaskTexture,l=n.waterMaskTranslationAndScale;!u(s)&&u(n.fill)&&(s=n.fill.waterMaskTexture,l=n.fill.waterMaskTranslationAndScale);let c=i.cameraUnderground,d=i.globeTranslucencyState,p=d.translucent,f=d.frontFaceAlphaByDistance,m=d.backFaceAlphaByDistance,_=d.rectangle,g=y(e.undergroundColor,uJe),v=y(e.undergroundColorAlphaByDistance,fJe),b=Bfe(e,i)&&i.mode===te.SCENE3D&&g.alpha>0&&(v.nearValue>0||v.farValue>0),A=e.lambertDiffuseMultiplier,T=e.vertexShadowDarkness,E=e.hasWaterMask&&u(s),C=e.oceanNormalMap,x=E&&u(C),S=e.terrainProvider,w=u(S)&&e.terrainProvider.hasVertexNormals,I=i.fog.enabled&&i.fog.renderable&&!c,D=e.showGroundAtmosphere&&i.mode===te.SCENE3D,O=yn.castShadows(e.shadows)&&!p,R=yn.receiveShadows(e.shadows)&&!p,N=e.hueShift,M=e.saturationShift,F=e.brightnessShift,B=!(P.equalsEpsilon(N,0,P.EPSILON7)&&P.equalsEpsilon(M,0,P.EPSILON7)&&P.equalsEpsilon(F,0,P.EPSILON7)),U=!1;if(D){U=h.magnitude(i.camera.positionWC)>e.nightFadeOutDistance}E&&--a,x&&--a,u(i.shadowState)&&i.shadowState.shadowsEnabled&&--a,u(e.clippingPlanes)&&e.clippingPlanes.enabled&&--a,a-=d.numberOfTextureUniforms;let k=n.renderedMesh,V=k.center,H=k.encoding,G=n.tileBoundingRegion,j=i.terrainExaggeration,W=i.terrainExaggerationRelativeHeight,q=1!==j,Y=H.hasGeodeticSurfaceNormals,X=KQe,$=0,K=0,J=0,Q=0,Z=!1;if(i.mode!==te.SCENE3D){let e=i.mapProjection,n=e.project(ce.southwest(t.rectangle),JQe),r=e.project(ce.northeast(t.rectangle),eJe);if(X.x=n.x,X.y=n.y,X.z=r.x,X.w=r.y,i.mode!==te.MORPHING&&(V=QQe,V.x=0,V.y=.5*(X.z+X.x),V.z=.5*(X.w+X.y),X.x-=V.y,X.y-=V.z,X.z-=V.y,X.w-=V.z),i.mode===te.SCENE2D&&H.quantization===Os.BITS12){let e=1/(Math.pow(2,12)-1)*.5,t=(X.z-X.x)*e,i=(X.w-X.y)*e;X.x-=t,X.y-=i,X.z+=t,X.w+=i}e instanceof Oi&&($=t.rectangle.south,K=t.rectangle.north,J=Oi.geodeticLatitudeToMercatorAngle($),Q=1/(Oi.geodeticLatitudeToMercatorAngle(K)-J),Z=!0)}let ee=lJe;ee.frameState=i,ee.surfaceTile=n,ee.showReflectiveOcean=E,ee.showOceanWaves=x,ee.enableLighting=e.enableLighting,ee.dynamicAtmosphereLighting=e.dynamicAtmosphereLighting,ee.dynamicAtmosphereLightingFromSun=e.dynamicAtmosphereLightingFromSun,ee.showGroundAtmosphere=D,ee.atmosphereLightIntensity=e.atmosphereLightIntensity,ee.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,ee.atmosphereMieCoefficient=e.atmosphereMieCoefficient,ee.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,ee.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,ee.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,ee.perFragmentGroundAtmosphere=U,ee.hasVertexNormals=w,ee.useWebMercatorProjection=Z,ee.clippedByBoundaries=n.clippedByBoundaries,ee.hasGeodeticSurfaceNormals=Y,ee.hasExaggeration=q;let ie=n.imagery,ne=0,re=ie.length,ae=e.showSkirts&&!c&&!p,le=e.backFaceCulling&&!c&&!p,ue=le?e._renderState:e._disableCullingRenderState,he=le?e._blendRenderState:e._disableCullingBlendRenderState,de=ue,pe=e._firstPassInitialColor,fe=i.context;if(u(e._debug.boundingSphereTile)||ok(),e._materialUniformMap!==e.materialUniformMap){e._materialUniformMap=e.materialUniformMap;let t=e._drawCommands.length;for(let n=0;n<t;++n)e._uniformMaps[n]=Lfe(i,e)}do{let o,y,E=0;if(e._drawCommands.length<=e._usedDrawCommands?(o=new et,o.owner=t,o.cull=!1,o.boundingVolume=new se,o.orientedBoundingBox=void 0,y=Lfe(i,e),e._drawCommands.push(o),e._uniformMaps.push(y)):(o=e._drawCommands[e._usedDrawCommands],y=e._uniformMaps[e._usedDrawCommands]),o.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile){let e=G.boundingVolume,t=G.boundingSphere;u(e)?kfe(e,z.RED).update(i):u(t)&&Vfe(t,z.RED).update(i)}let x=y.properties;oe.clone(pe,x.initialColor),x.oceanNormalMap=C,x.lightingFadeDistance.x=e.lightingFadeOutDistance,x.lightingFadeDistance.y=e.lightingFadeInDistance,x.nightFadeDistance.x=e.nightFadeOutDistance,x.nightFadeDistance.y=e.nightFadeInDistance,x.atmosphereLightIntensity=e.atmosphereLightIntensity,x.atmosphereRayleighCoefficient=e.atmosphereRayleighCoefficient,x.atmosphereMieCoefficient=e.atmosphereMieCoefficient,x.atmosphereRayleighScaleHeight=e.atmosphereRayleighScaleHeight,x.atmosphereMieScaleHeight=e.atmosphereMieScaleHeight,x.atmosphereMieAnisotropy=e.atmosphereMieAnisotropy,x.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity;let S=c?m:f,w=c?f:m;u(S)&&(oe.fromElements(S.near,S.nearValue,S.far,S.farValue,x.frontFaceAlphaByDistance),oe.fromElements(w.near,w.nearValue,w.far,w.farValue,x.backFaceAlphaByDistance)),oe.fromElements(v.near,v.nearValue,v.far,v.farValue,x.undergroundColorAlphaByDistance),z.clone(g,x.undergroundColor),x.lambertDiffuseMultiplier=A,x.vertexShadowDarkness=T;let U=!u(n.vertexArray)&&u(e.fillHighlightColor)&&e.fillHighlightColor.alpha>0;U&&z.clone(e.fillHighlightColor,x.fillHighlightColor),x.terrainExaggerationAndRelativeHeight.x=j,x.terrainExaggerationAndRelativeHeight.y=W,x.center3D=k.center,h.clone(V,x.rtc),oe.clone(X,x.tileRectangle),x.southAndNorthLatitude.x=$,x.southAndNorthLatitude.y=K,x.southMercatorYAndOneOverHeight.x=J,x.southMercatorYAndOneOverHeight.y=Q;let q=ZQe,Y=ik(t.rectangle,e.cartographicLimitRectangle),Z=$Qe,le=ik(t.rectangle,_);h.fromElements(N,M,F,x.hsbShift);let ue=t.rectangle,me=1/ue.width,_e=1/ue.height;q.x=(Y.west-ue.west)*me,q.y=(Y.south-ue.south)*_e,q.z=(Y.east-ue.west)*me,q.w=(Y.north-ue.south)*_e,oe.clone(q,x.localizedCartographicLimitRectangle),Z.x=(le.west-ue.west)*me,Z.y=(le.south-ue.south)*_e,Z.z=(le.east-ue.west)*me,Z.w=(le.north-ue.south)*_e,oe.clone(Z,x.localizedTranslucencyRectangle);let ge=I&&P.fog(t._distance,i.fog.density)>P.EPSILON3;B=B&&(ge||D);let ye=!1,ve=!1,be=!1,Ae=!1,Te=!1,Ce=!1,xe=!1,Se=!1,we=!1,Ie=!1;for(;E<a&&ne<re;){let e=ie[ne],i=e.readyImagery;if(++ne,!u(i)||0===i.imageryLayer.alpha)continue;let n=e.useWebMercatorT?i.textureWebMercator:i.texture,o=i.imageryLayer;u(e.textureTranslationAndScale)||(e.textureTranslationAndScale=o._calculateTextureTranslationAndScale(t,e)),x.dayTextures[E]=n,x.dayTextureTranslationAndScale[E]=e.textureTranslationAndScale,x.dayTextureTexCoordsRectangle[E]=e.textureCoordinateRectangle,x.dayTextureUseWebMercatorT[E]=e.useWebMercatorT,x.dayTextureAlpha[E]=o.alpha,Ce=Ce||1!==x.dayTextureAlpha[E],x.dayTextureNightAlpha[E]=o.nightAlpha,xe=xe||1!==x.dayTextureNightAlpha[E],x.dayTextureDayAlpha[E]=o.dayAlpha,xe=xe||1!==x.dayTextureDayAlpha[E],x.dayTextureBrightness[E]=o.brightness,ye=ye||x.dayTextureBrightness[E]!==la.DEFAULT_BRIGHTNESS,x.dayTextureContrast[E]=o.contrast,ve=ve||x.dayTextureContrast[E]!==la.DEFAULT_CONTRAST,x.dayTextureHue[E]=o.hue,be=be||x.dayTextureHue[E]!==la.DEFAULT_HUE,x.dayTextureSaturation[E]=o.saturation,Ae=Ae||x.dayTextureSaturation[E]!==la.DEFAULT_SATURATION,x.dayTextureOneOverGamma[E]=1/o.gamma,Te=Te||x.dayTextureOneOverGamma[E]!==1/la.DEFAULT_GAMMA,x.dayTextureSplit[E]=o.splitDirection,Se=Se||0!==x.dayTextureSplit[E];let a=x.dayTextureCutoutRectangles[E];if(u(a)||(a=x.dayTextureCutoutRectangles[E]=new oe),oe.clone(oe.ZERO,a),u(o.cutoutRectangle)){let e=ik(ue,o.cutoutRectangle),t=ce.simpleIntersection(e,ue,Ffe);we=u(t)||we,a.x=(e.west-ue.west)*me,a.y=(e.south-ue.south)*_e,a.z=(e.east-ue.west)*me,a.w=(e.north-ue.south)*_e}let s=x.colorsToAlpha[E];u(s)||(s=x.colorsToAlpha[E]=new oe);let l=u(o.colorToAlpha)&&o.colorToAlphaThreshold>0;if(Ie=Ie||l,l){let e=o.colorToAlpha;s.x=e.red,s.y=e.green,s.z=e.blue,s.w=o.colorToAlphaThreshold}else s.w=-1;if(u(i.credits)){let e=i.credits;for(let t=0,i=e.length;t<i;++t)r.addCreditToNextFrame(e[t])}++E}x.dayTextures.length=E,x.waterMask=s,oe.clone(l,x.waterMaskTranslationAndScale),x.minMaxHeight.x=H.minimumHeight,x.minMaxHeight.y=H.maximumHeight,L.clone(H.matrix,x.scaleAndBias);let Pe=e._clippingPlanes,De=u(Pe)&&Pe.enabled&&t.isClipped;De&&(x.clippingPlanesEdgeColor=z.clone(Pe.edgeColor,x.clippingPlanesEdgeColor),x.clippingPlanesEdgeWidth=Pe.edgeWidth),ee.numberOfDayTextures=E,ee.applyBrightness=ye,ee.applyContrast=ve,ee.applyHue=be,ee.applySaturation=Ae,ee.applyGamma=Te,ee.applyAlpha=Ce,ee.applyDayNightAlpha=xe,ee.applySplit=Se,ee.enableFog=ge,ee.enableClippingPlanes=De,ee.clippingPlanes=Pe,ee.hasImageryLayerCutout=we,ee.colorCorrect=B,ee.highlightFillTile=U,ee.colorToAlpha=Ie,ee.showUndergroundColor=b,ee.translucent=p;let Oe=n.renderedMesh.indices.length;ae||(Oe=n.renderedMesh.indexCountWithoutSkirts),o.shaderProgram=e._surfaceShaderSet.getShaderProgram(ee),o.castShadows=O,o.receiveShadows=R,o.renderState=de,o.primitiveType=Ne.TRIANGLES,o.vertexArray=n.vertexArray||n.fill.vertexArray,o.count=Oe,o.uniformMap=y,o.pass=Ee.GLOBE,e._debug.wireframe&&(sJe(fe,e,t),u(n.wireframeVertexArray)&&(o.vertexArray=n.wireframeVertexArray,o.primitiveType=Ne.LINES,o.count=2*Oe));let Le=o.boundingVolume,Re=o.orientedBoundingBox;i.mode!==te.SCENE3D?(se.fromRectangleWithHeights2D(t.rectangle,i.mapProjection,G.minimumHeight,G.maximumHeight,Le),h.fromElements(Le.center.z,Le.center.x,Le.center.y,Le.center),i.mode===te.MORPHING&&(Le=se.union(G.boundingSphere,Le,Le))):(o.boundingVolume=se.clone(G.boundingSphere,Le),o.orientedBoundingBox=Pn.clone(G.boundingVolume,Re)),o.dirty=!0,p&&d.updateDerivedCommands(o,i),Nfe(o,i),de=he,pe=cJe}while(ne<re)}var rk=Yo;function Ufe(){this._enabled=!1,this._frontFaceAlpha=1,this._frontFaceAlphaByDistance=void 0,this._backFaceAlpha=1,this._backFaceAlphaByDistance=void 0,this._rectangle=ce.clone(ce.MAX_VALUE)}Object.defineProperties(Ufe.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabled=e}},frontFaceAlpha:{get:function(){return this._frontFaceAlpha},set:function(e){this._frontFaceAlpha=e}},frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance},set:function(e){this._frontFaceAlphaByDistance=Pt.clone(e,this._frontFaceAlphaByDistance)}},backFaceAlpha:{get:function(){return this._backFaceAlpha},set:function(e){this._backFaceAlpha=e}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance},set:function(e){this._backFaceAlphaByDistance=Pt.clone(e,this._backFaceAlphaByDistance)}},rectangle:{get:function(){return this._rectangle},set:function(e){u(e)||(e=ce.clone(ce.MAX_VALUE)),ce.clone(e,this._rectangle)}}});var sk=Ufe;function ls(){this._layers=[],this.layerAdded=new pe,this.layerRemoved=new pe,this.layerMoved=new pe,this.layerShownOrHidden=new pe}function ak(e,t){return e.indexOf(t)}function zfe(e,t,i){let n=e._layers;if((t=P.clamp(t,0,n.length-1))===(i=P.clamp(i,0,n.length-1)))return;let r=n[t];n[t]=n[i],n[i]=r,e._update(),e.layerMoved.raiseEvent(r,i,t)}Object.defineProperties(ls.prototype,{length:{get:function(){return this._layers.length}}}),ls.prototype.add=function(e,t){u(t)?this._layers.splice(t,0,e):(t=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,t);let i=e.readyEvent.addEventListener((()=>{this.layerShownOrHidden.raiseEvent(e,e._layerIndex,e.show),i()}))},ls.prototype.addImageryProvider=function(e,t){let i=new la(e);return this.add(i,t),i},ls.prototype.remove=function(e,t){t=y(t,!0);let i=this._layers.indexOf(e);return-1!==i&&(this._layers.splice(i,1),this._update(),this.layerRemoved.raiseEvent(e,i),t&&e.destroy(),!0)},ls.prototype.removeAll=function(e){e=y(e,!0);let t=this._layers;for(let i=0,n=t.length;i<n;i++){let n=t[i];this.layerRemoved.raiseEvent(n,i),e&&n.destroy()}this._layers=[]},ls.prototype.contains=function(e){return-1!==this.indexOf(e)},ls.prototype.indexOf=function(e){return this._layers.indexOf(e)},ls.prototype.get=function(e){return this._layers[e]},ls.prototype.raise=function(e){let t=ak(this._layers,e);zfe(this,t,t+1)},ls.prototype.lower=function(e){let t=ak(this._layers,e);zfe(this,t,t-1)},ls.prototype.raiseToTop=function(e){let t=ak(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},ls.prototype.lowerToBottom=function(e){let t=ak(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var hJe=new ce;function Hfe(e,t,i,n){let r,o=e.globe._surface._tilesToRender;for(let e=0;!u(r)&&e<o.length;++e){let i=o[e];ce.contains(i.rectangle,t)&&(r=i)}if(!u(r))return;let a=r.data.imagery;for(let e=a.length-1;e>=0;--e){let o=a[e],s=o.readyImagery;if(!u(s)||!s.imageryLayer.ready)continue;let l=s.imageryLayer.imageryProvider;if(i&&!u(l.pickFeatures)||!ce.contains(s.rectangle,t))continue;let c=hJe,h=1/1024;c.west=P.lerp(r.rectangle.west,r.rectangle.east,o.textureCoordinateRectangle.x-h),c.east=P.lerp(r.rectangle.west,r.rectangle.east,o.textureCoordinateRectangle.z+h),c.south=P.lerp(r.rectangle.south,r.rectangle.north,o.textureCoordinateRectangle.y-h),c.north=P.lerp(r.rectangle.south,r.rectangle.north,o.textureCoordinateRectangle.w+h),ce.contains(c,t)&&n(s)}}ls.prototype.pickImageryLayers=function(e,t){let i=t.globe.pick(e,t);if(!u(i))return;let n=t.globe.ellipsoid.cartesianToCartographic(i),r=[];return Hfe(t,n,!1,(function(e){r.push(e.imageryLayer)})),0!==r.length?r:void 0},ls.prototype.pickImageryLayerFeatures=function(e,t){let i=t.globe.pick(e,t);if(!u(i))return;let n=t.globe.ellipsoid.cartesianToCartographic(i),r=[],o=[];return Hfe(t,n,!0,(function(e){if(!e.imageryLayer.ready)return;let t=e.imageryLayer.imageryProvider.pickFeatures(e.x,e.y,e.level,n.longitude,n.latitude);u(t)&&(r.push(t),o.push(e.imageryLayer))})),0!==r.length?Promise.all(r).then((function(e){let t=[];for(let i=0;i<e.length;++i){let r=e[i],a=o[i];if(u(r)&&r.length>0)for(let e=0;e<r.length;++e){let i=r[e];i.imageryLayer=a,u(i.position)||(i.position=n),t.push(i)}}return t})):void 0},ls.prototype.queueReprojectionCommands=function(e){let t=this._layers;for(let i=0,n=t.length;i<n;++i)t[i].queueReprojectionCommands(e)},ls.prototype.cancelReprojections=function(){let e=this._layers;for(let t=0,i=e.length;t<i;++t)e[t].cancelReprojections()},ls.prototype.isDestroyed=function(){return!1},ls.prototype.destroy=function(){return this.removeAll(!0),le(this)},ls.prototype._update=function(){let e,t,i,n,r=!0,o=this._layers;for(i=0,n=o.length;i<n;++i)t=o[i],t._layerIndex=i,t.show?(t._isBaseLayer=r,r=!1):t._isBaseLayer=!1,t.show!==t._show&&(u(t._show)&&(u(e)||(e=[]),e.push(t)),t._show=t.show);if(u(e))for(i=0,n=e.length;i<n;++i)t=e[i],this.layerShownOrHidden.raiseEvent(t,t._layerIndex,t.show)};var ck=ls;function Gfe(e){this._ellipsoid=new i_(e.ellipsoid,h.ZERO)}Object.defineProperties(Gfe.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var lk=Gfe;function Tc(e){this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this.replacementPrevious=void 0,this.replacementNext=void 0,this._distance=0,this._loadPriority=0,this._customData=[],this._frameUpdated=void 0,this._lastSelectionResult=Kn.NONE,this._lastSelectionResultFrame=void 0,this._loadedCallbacks={},this.state=Gs.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function uk(e){u(e)&&e.freeResources()}Tc.createLevelZeroTiles=function(e){let t=e.getNumberOfXTilesAtLevel(0),i=e.getNumberOfYTilesAtLevel(0),n=new Array(t*i),r=0;for(let o=0;o<i;++o)for(let i=0;i<t;++i)n[r++]=new Tc({tilingScheme:e,x:i,y:o,level:0});return n},Tc.prototype._updateCustomData=function(e,t,i){let n,r,o,a=this.customData;if(u(t)&&u(i)){for(a=a.filter((function(e){return-1===i.indexOf(e)})),this._customData=a,o=this._rectangle,n=0;n<t.length;++n)r=t[n],ce.contains(o,r.positionCartographic)&&a.push(r);this._frameUpdated=e}else{let e=this._parent;if(u(e)&&this._frameUpdated!==e._frameUpdated){a.length=0,o=this._rectangle;let t=e.customData;for(n=0;n<t.length;++n)r=t[n],ce.contains(o,r.positionCartographic)&&a.push(r);this._frameUpdated=e._frameUpdated}}},Object.defineProperties(Tc.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return u(this._southwestChild)||(this._southwestChild=new Tc({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return u(this._southeastChild)||(this._southeastChild=new Tc({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return u(this._northwestChild)||(this._northwestChild=new Tc({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return u(this._northeastChild)||(this._northeastChild=new Tc({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<Gs.DONE}},eligibleForUnloading:{get:function(){let e=!0;return u(this.data)&&(e=this.data.eligibleForUnloading,u(e)||(e=!0)),e}}}),Tc.prototype.findLevelZeroTile=function(e,t,i){let n=this.tilingScheme.getNumberOfXTilesAtLevel(0);if(t<0?t+=n:t>=n&&(t-=n),!(i<0||i>=this.tilingScheme.getNumberOfYTilesAtLevel(0)))return e.filter((function(e){return e.x===t&&e.y===i}))[0]},Tc.prototype.findTileToWest=function(e){let t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x-1,this.y);if(t.southeastChild===this)return t.southwestChild;if(t.northeastChild===this)return t.northwestChild;let i=t.findTileToWest(e);return void 0!==i?t.southwestChild===this?i.southeastChild:i.northeastChild:void 0},Tc.prototype.findTileToEast=function(e){let t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x+1,this.y);if(t.southwestChild===this)return t.southeastChild;if(t.northwestChild===this)return t.northeastChild;let i=t.findTileToEast(e);return void 0!==i?t.southeastChild===this?i.southwestChild:i.northwestChild:void 0},Tc.prototype.findTileToSouth=function(e){let t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y+1);if(t.northwestChild===this)return t.southwestChild;if(t.northeastChild===this)return t.southeastChild;let i=t.findTileToSouth(e);return void 0!==i?t.southwestChild===this?i.northwestChild:i.northeastChild:void 0},Tc.prototype.findTileToNorth=function(e){let t=this.parent;if(void 0===t)return this.findLevelZeroTile(e,this.x,this.y-1);if(t.southwestChild===this)return t.northwestChild;if(t.southeastChild===this)return t.northeastChild;let i=t.findTileToNorth(e);return void 0!==i?t.northwestChild===this?i.southwestChild:i.southeastChild:void 0},Tc.prototype.freeResources=function(){this.state=Gs.START,this.renderable=!1,this.upsampledFromParent=!1,u(this.data)&&u(this.data.freeResources)&&this.data.freeResources(),uk(this._southwestChild),this._southwestChild=void 0,uk(this._southeastChild),this._southeastChild=void 0,uk(this._northwestChild),this._northwestChild=void 0,uk(this._northeastChild),this._northeastChild=void 0};var fk=Tc;function dk(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function Wfe(e,t){let i=t.replacementPrevious,n=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=n),t===e.head?e.head=n:i.replacementNext=n,t===e.tail?e.tail=i:n.replacementPrevious=i,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}dk.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},dk.prototype.trimTiles=function(e){let t=this.tail,i=!0;for(;i&&u(this._lastBeforeStartOfFrame)&&this.count>e&&u(t);){i=t!==this._lastBeforeStartOfFrame;let e=t.replacementPrevious;t.eligibleForUnloading&&(t.freeResources(),Wfe(this,t)),t=e}},dk.prototype.markTileRendered=function(e){let t=this.head;if(t!==e)return++this.count,u(t)?((u(e.replacementPrevious)||u(e.replacementNext))&&Wfe(this,e),e.replacementPrevious=void 0,e.replacementNext=t,t.replacementPrevious=e,void(this.head=e)):(e.replacementPrevious=void 0,e.replacementNext=void 0,this.head=e,void(this.tail=e));e===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=e.replacementNext)};var hk=dk;function df(e){this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,maxDepthVisited:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastMaxDepthVisited:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};let t=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new hk,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this._cameraPositionCartographic=void 0,this._cameraReferenceFrameOriginCartographic=void 0,this.maximumScreenSpaceError=y(e.maximumScreenSpaceError,2),this.tileCacheSize=y(e.tileCacheSize,100),this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this._occluders=new lk({ellipsoid:t}),this._tileLoadProgressEvent=new pe,this._lastTileLoadQueueLength=0,this._lastSelectionFrameNumber=void 0}function mJe(e){let t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,qfe(e);let i=e._levelZeroTiles;if(u(i))for(let t=0;t<i.length;++t){let n=i[t].customData,r=n.length;for(let t=0;t<r;++t){let i=n[t];i.level=0,e._addHeightCallbacks.push(i)}i[t].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}function qfe(e){let t=e._debug;t.maxDepth=0,t.maxDepthVisited=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}function pJe(e,t){let i=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;if(i!==e._lastTileLoadQueueLength||e._tilesInvalidated){let n=pe.prototype.raiseEvent.bind(e._tileLoadProgressEvent,i);t.afterRender.push((()=>(n(),!0))),e._lastTileLoadQueueLength=i}let n=e._debug;n.enableDebugOutput&&!n.suspendLodUpdate&&(n.maxDepth=e._tilesToRender.reduce((function(e,t){return Math.max(e,t.level)}),-1),n.tilesRendered=e._tilesToRender.length,(n.tilesVisited!==n.lastTilesVisited||n.tilesRendered!==n.lastTilesRendered||n.tilesCulled!==n.lastTilesCulled||n.maxDepth!==n.lastMaxDepth||n.tilesWaitingForChildren!==n.lastTilesWaitingForChildren||n.maxDepthVisited!==n.lastMaxDepthVisited)&&(console.log(`Visited ${n.tilesVisited}, Rendered: ${n.tilesRendered}, Culled: ${n.tilesCulled}, Max Depth Rendered: ${n.maxDepth}, Max Depth Visited: ${n.maxDepthVisited}, Waiting for children: ${n.tilesWaitingForChildren}`),n.lastTilesVisited=n.tilesVisited,n.lastTilesRendered=n.tilesRendered,n.lastTilesCulled=n.tilesCulled,n.lastMaxDepth=n.maxDepth,n.lastTilesWaitingForChildren=n.tilesWaitingForChildren,n.lastMaxDepthVisited=n.maxDepthVisited))}Object.defineProperties(df.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}},occluders:{get:function(){return this._occluders}}}),df.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0},df.prototype.forEachLoadedTile=function(e){let t=this._tileReplacementQueue.head;for(;u(t);)t.state!==Gs.START&&e(t),t=t.replacementNext},df.prototype.forEachRenderedTile=function(e){let t=this._tilesToRender;for(let i=0,n=t.length;i<n;++i)e(t[i])},df.prototype.updateHeight=function(e,t){let i=this,n={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t,removeFunc:function(){let e=i._addHeightCallbacks,t=e.length;for(let i=0;i<t;++i)if(e[i]===n){e.splice(i,1);break}i._removeHeightCallbacks.push(n),n.callback&&(n.callback=void 0)}};return i._addHeightCallbacks.push(n),n.removeFunc},df.prototype.update=function(e){u(this._tileProvider.update)&&this._tileProvider.update(e)},df.prototype.beginFrame=function(e){e.passes.render&&(this._tilesInvalidated&&(mJe(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),qfe(this),!this._debug.suspendLodUpdate&&this._tileReplacementQueue.markStartOfRenderFrame())},df.prototype.render=function(e){let t=e.passes,i=this._tileProvider;t.render&&(i.beginUpdate(e),yJe(this,e),DJe(this,e),i.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&i.updateForPick(e)},df.prototype.endFrame=function(e){!e.passes.render||e.mode===te.MORPHING||(EJe(this,e),vJe(this,e),pJe(this,e))},df.prototype.isDestroyed=function(){return!1},df.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var zv,jfe=new fe;function _Je(e,t){let i=ce.center(e.rectangle,jfe),n=i.longitude-zv.longitude,r=i.latitude-zv.latitude;i=ce.center(t.rectangle,jfe);let o=i.longitude-zv.longitude,a=i.latitude-zv.latitude;return n*n+r*r-(o*o+a*a)}var gJe=new h,Uv=[];function yJe(e,t){let i=e._debug;if(i.suspendLodUpdate)return;e._tilesToRender.length=0;let n,r=e._tileProvider;if(!u(e._levelZeroTiles)){let t=r.tilingScheme;if(!u(t))return;{let t=r.tilingScheme;e._levelZeroTiles=fk.createLevelZeroTiles(t);let i=e._levelZeroTiles.length;if(Uv.length<i)for(Uv=new Array(i),n=0;n<i;++n)void 0===Uv[n]&&(Uv[n]=new Hv)}}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;let o,a=e._levelZeroTiles,s=a.length>1?e._occluders:void 0;zv=t.camera.positionCartographic,a.sort(_Je);let l,c=e._addHeightCallbacks,h=e._removeHeightCallbacks,d=t.frameNumber;if(c.length>0||h.length>0){for(n=0,l=a.length;n<l;++n)o=a[n],o._updateCustomData(d,c,h);c.length=0,h.length=0}let p=t.camera;e._cameraPositionCartographic=p.positionCartographic;let f=L.getTranslation(p.transform,gJe);for(e._cameraReferenceFrameOriginCartographic=e.tileProvider.tilingScheme.ellipsoid.cartesianToCartographic(f,e._cameraReferenceFrameOriginCartographic),n=0,l=a.length;n<l;++n)o=a[n],e._tileReplacementQueue.markTileRendered(o),o.renderable?ua(e,o,r,t,s,!1,Uv[n]):(Vp(e,e._tileLoadQueueHigh,o,t),++i.tilesWaitingForChildren);e._lastSelectionFrameNumber=d}function Vp(e,t,i,n){i.needsLoading&&(void 0!==e.tileProvider.computeTileLoadPriority&&(i._loadPriority=e.tileProvider.computeTileLoadPriority(i,n)),t.push(i))}function Hv(){this.allAreRenderable=!0,this.anyWereRenderedLastFrame=!1,this.notYetRenderableCount=0}function Yfe(){this.southwest=new Hv,this.southeast=new Hv,this.northwest=new Hv,this.northeast=new Hv}Yfe.prototype.combine=function(e){let t=this.southwest,i=this.southeast,n=this.northwest,r=this.northeast;e.allAreRenderable=t.allAreRenderable&&i.allAreRenderable&&n.allAreRenderable&&r.allAreRenderable,e.anyWereRenderedLastFrame=t.anyWereRenderedLastFrame||i.anyWereRenderedLastFrame||n.anyWereRenderedLastFrame||r.anyWereRenderedLastFrame,e.notYetRenderableCount=t.notYetRenderableCount+i.notYetRenderableCount+n.notYetRenderableCount+r.notYetRenderableCount};var mj=new Array(31);for(let e=0;e<mj.length;++e)mj[e]=new Yfe;function xJe(e,t,i,n,r){let o=e._debug;++o.tilesVisited,e._tileReplacementQueue.markTileRendered(i),i._updateCustomData(t.frameNumber),i.level>o.maxDepthVisited&&(o.maxDepthVisited=i.level);let a=AJe(e,t,i)<e.maximumScreenSpaceError,s=i.southwestChild,l=i.southeastChild,c=i.northwestChild,h=i.northeastChild,d=e._lastSelectionFrameNumber,p=i._lastSelectionResultFrame===d?i._lastSelectionResult:Kn.NONE,f=e.tileProvider;if(a||n){let o=Kn.originalResult(p)===Kn.RENDERED,s=Kn.originalResult(p)===Kn.CULLED||p===Kn.NONE,l=i.state===Gs.DONE,c=o||s||l;if(c||u(f.canRenderWithoutLosingDetail)&&(c=f.canRenderWithoutLosingDetail(i)),c)return a&&Vp(e,e._tileLoadQueueMedium,i,t),mk(e,i),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=p===Kn.RENDERED,r.notYetRenderableCount=i.renderable?0:1,i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=Kn.RENDERED,void(r.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(i));n=!0,a&&Vp(e,e._tileLoadQueueHigh,i,t)}if(f.canRefine(i)){if(s.upsampledFromParent&&l.upsampledFromParent&&c.upsampledFromParent&&h.upsampledFromParent)return mk(e,i),Vp(e,e._tileLoadQueueMedium,i,t),e._tileReplacementQueue.markTileRendered(s),e._tileReplacementQueue.markTileRendered(l),e._tileReplacementQueue.markTileRendered(c),e._tileReplacementQueue.markTileRendered(h),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=p===Kn.RENDERED,r.notYetRenderableCount=i.renderable?0:1,i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=Kn.RENDERED,void(r.anyWereRenderedLastFrame||e._tileToUpdateHeights.push(i));i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=Kn.REFINED;let a=e._tilesToRender.length,u=e._tileLoadQueueLow.length,d=e._tileLoadQueueMedium.length,f=e._tileLoadQueueHigh.length,m=e._tileToUpdateHeights.length;if(bJe(e,s,l,c,h,t,n,r),a!==e._tilesToRender.length){let n=r.allAreRenderable,s=r.anyWereRenderedLastFrame,l=r.notYetRenderableCount,c=!1;if(!n&&!s){let n=e._tilesToRender;for(let e=a;e<n.length;++e){let t=n[e];for(;void 0!==t&&t._lastSelectionResult!==Kn.KICKED&&t!==i;)t._lastSelectionResult=Kn.kick(t._lastSelectionResult),t=t.parent}e._tilesToRender.length=a,e._tileToUpdateHeights.length=m,mk(e,i),i._lastSelectionResult=Kn.RENDERED;let s=p===Kn.RENDERED;!s&&l>e.loadingDescendantLimit&&(e._tileLoadQueueLow.length=u,e._tileLoadQueueMedium.length=d,e._tileLoadQueueHigh.length=f,Vp(e,e._tileLoadQueueMedium,i,t),r.notYetRenderableCount=i.renderable?0:1,c=!0),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=s,s||e._tileToUpdateHeights.push(i),++o.tilesWaitingForChildren}e.preloadAncestors&&!c&&Vp(e,e._tileLoadQueueLow,i,t)}}else i._lastSelectionResultFrame=t.frameNumber,i._lastSelectionResult=Kn.RENDERED,mk(e,i),Vp(e,e._tileLoadQueueHigh,i,t),r.allAreRenderable=i.renderable,r.anyWereRenderedLastFrame=p===Kn.RENDERED,r.notYetRenderableCount=i.renderable?0:1}function bJe(e,t,i,n,r,o,a,s){let l=o.camera.positionCartographic,u=e._tileProvider,c=e._occluders,h=mj[t.level],d=h.southwest,p=h.southeast,f=h.northwest,m=h.northeast;l.longitude<t.rectangle.east?l.latitude<t.rectangle.north?(ua(e,t,u,o,c,a,d),ua(e,i,u,o,c,a,p),ua(e,n,u,o,c,a,f),ua(e,r,u,o,c,a,m)):(ua(e,n,u,o,c,a,f),ua(e,t,u,o,c,a,d),ua(e,r,u,o,c,a,m),ua(e,i,u,o,c,a,p)):l.latitude<t.rectangle.north?(ua(e,i,u,o,c,a,p),ua(e,t,u,o,c,a,d),ua(e,r,u,o,c,a,m),ua(e,n,u,o,c,a,f)):(ua(e,r,u,o,c,a,m),ua(e,n,u,o,c,a,f),ua(e,i,u,o,c,a,p),ua(e,t,u,o,c,a,d)),h.combine(s)}function TJe(e,t){let i=t.rectangle;return u(e._cameraPositionCartographic)&&ce.contains(i,e._cameraPositionCartographic)||u(e._cameraReferenceFrameOriginCartographic)&&ce.contains(i,e._cameraReferenceFrameOriginCartographic)}function ua(e,t,i,n,r,o,a){if(i.computeTileVisibility(t,n,r)!==rr.NONE)return xJe(e,n,t,o,a);if(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),a.allAreRenderable=!0,a.anyWereRenderedLastFrame=!1,a.notYetRenderableCount=0,TJe(e,t)){(!u(t.data)||!u(t.data.vertexArray))&&Vp(e,e._tileLoadQueueMedium,t,n);let i=e._lastSelectionFrameNumber,r=t._lastSelectionResultFrame===i?t._lastSelectionResult:Kn.NONE;r!==Kn.CULLED_BUT_NEEDED&&r!==Kn.RENDERED&&e._tileToUpdateHeights.push(t),t._lastSelectionResult=Kn.CULLED_BUT_NEEDED}else e.preloadSiblings||0===t.level?(Vp(e,e._tileLoadQueueLow,t,n),t._lastSelectionResult=Kn.CULLED):t._lastSelectionResult=Kn.CULLED;t._lastSelectionResultFrame=n.frameNumber}function AJe(e,t,i){if(t.mode===te.SCENE2D||t.camera.frustum instanceof Qt||t.camera.frustum instanceof Or)return CJe(e,t,i);let n=e._tileProvider.getLevelMaximumGeometricError(i.level),r=i._distance,o=n*t.context.drawingBufferHeight/(r*t.camera.frustum.sseDenominator);return t.fog.enabled&&(o-=P.fog(r,t.fog.density)*t.fog.sse),o/=t.pixelRatio,o}function CJe(e,t,i){let n=t.camera.frustum,r=n.offCenterFrustum;u(r)&&(n=r);let o=t.context,a=o.drawingBufferWidth,s=o.drawingBufferHeight,l=e._tileProvider.getLevelMaximumGeometricError(i.level)/(Math.max(n.top-n.bottom,n.right-n.left)/Math.max(a,s));return t.fog.enabled&&t.mode!==te.SCENE2D&&(l-=P.fog(i._distance,t.fog.density)*t.fog.sse),l/=t.pixelRatio,l}function mk(e,t){e._tilesToRender.push(t)}function EJe(e,t){let i=e._tileLoadQueueHigh,n=e._tileLoadQueueMedium,r=e._tileLoadQueueLow;if(0===i.length&&0===n.length&&0===r.length)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);let o=_i()+e._loadQueueTimeSlice,a=e._tileProvider,s=dj(e,t,a,o,i,!1);s=dj(e,t,a,o,n,s),dj(e,t,a,o,r,s)}function SJe(e,t){return e._loadPriority-t._loadPriority}function dj(e,t,i,n,r,o){void 0!==i.computeTileLoadPriority&&r.sort(SJe);for(let a=0,s=r.length;a<s&&(_i()<n||!o);++a){let n=r[a];e._tileReplacementQueue.markTileRendered(n),i.loadTile(t,n),o=!0}return o}var fC=new Tn,hj=new fe,Wg=new h,wJe=[];function vJe(e,t){if(!u(e.tileProvider.tilingScheme))return;let i=wJe;i.length=0;let n,r=e._tileToUpdateHeights,o=_i()+e._updateHeightsTimeSlice,a=t.mode,s=t.mapProjection,l=e.tileProvider.tilingScheme.ellipsoid;for(;r.length>0;){let t=r[0];if(!u(t.data)||!u(t.data.mesh)){let n=t._lastSelectionResultFrame===e._lastSelectionFrameNumber?t._lastSelectionResult:Kn.NONE;(n===Kn.RENDERED||n===Kn.CULLED_BUT_NEEDED)&&i.push(t),r.shift(),e._lastTileIndex=0;continue}let c=t.customData,d=c.length,p=!1;for(n=e._lastTileIndex;n<d;++n){let e=c[n],i=t.data.terrainData,r=u(i)&&i.wasCreatedByUpsampling();if(t.level>e.level&&!r){if(u(e.positionOnEllipsoidSurface)||(e.positionOnEllipsoidSurface=h.fromRadians(e.positionCartographic.longitude,e.positionCartographic.latitude,0,l)),a===te.SCENE3D){let i=l.geodeticSurfaceNormal(e.positionOnEllipsoidSurface,fC.direction),n=l.getSurfaceNormalIntersectionWithZAxis(e.positionOnEllipsoidSurface,11500,fC.origin);if(!u(n)){let n=0;u(t.data.tileBoundingRegion)&&(n=t.data.tileBoundingRegion.minimumHeight);let r=Math.min(n,-11500),o=h.multiplyByScalar(i,Math.abs(r)+1,Wg);h.subtract(e.positionOnEllipsoidSurface,o,fC.origin)}}else fe.clone(e.positionCartographic,hj),hj.height=-11500,s.project(hj,Wg),h.fromElements(Wg.z,Wg.x,Wg.y,Wg),h.clone(Wg,fC.origin),h.clone(h.UNIT_X,fC.direction);let i=t.data.pick(fC,a,s,!1,Wg);u(i)&&(u(e.callback)&&e.callback(i),e.level=t.level)}if(_i()>=o){p=!0;break}}if(p){e._lastTileIndex=n;break}e._lastTileIndex=0,r.shift()}for(n=0;n<i.length;n++)r.push(i[n])}function DJe(e,t){let i=e._tileProvider,n=e._tilesToRender;for(let e=0,r=n.length;e<r;++e){let r=n[e];i.showTileThisFrame(r,t)}}var pk=df;function Ad(e){e=y(e,ie.WGS84);let t=new Wm({ellipsoid:e}),i=new ck;this._ellipsoid=e,this._imageryLayerCollection=i,this._surfaceShaderSet=new j3,this._material=void 0,this._surface=new pk({tileProvider:new rk({terrainProvider:t,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new pe,this._undergroundColor=z.clone(z.BLACK),this._undergroundColorAlphaByDistance=new Pt(e.maximumRadius/1e3,0,e.maximumRadius/5,1),this._translucency=new sk,_j(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new ve({url:$t("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.loadingDescendantLimit=20,this.preloadAncestors=!0,this.preloadSiblings=!1,this.fillHighlightColor=void 0,this.enableLighting=!1,this.lambertDiffuseMultiplier=.9,this.dynamicAtmosphereLighting=!0,this.dynamicAtmosphereLightingFromSun=!1,this.showGroundAtmosphere=!0,this.atmosphereLightIntensity=10,this.atmosphereRayleighCoefficient=new h(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new h(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=yn.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this.terrainExaggeration=1,this.terrainExaggerationRelativeHeight=0,this.showSkirts=!0,this.backFaceCulling=!0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0,this.vertexShadowDarkness=.3}function _j(e){let t=[],i=u(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),n=[Gg,Nv];!u(e._material)||i&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.materialUniformMap=void 0:(n.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.materialUniformMap=e._material._uniforms),n.push(G3),e._surfaceShaderSet.baseVertexShaderSource=new He({sources:[Gg,Nv,W3],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new He({sources:n,defines:t}),e._surfaceShaderSet.material=e._material}function IJe(e){return function(t,i){return se.distanceSquaredTo(t.pickBoundingSphere,e)-se.distanceSquaredTo(i.pickBoundingSphere,e)}}Object.defineProperties(Ad.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tilesLoaded:{get:function(){return!u(this._surface)||0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){u(e)||(e=ce.clone(ce.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),u(this._material)&&_j(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,_j(this))}},undergroundColor:{get:function(){return this._undergroundColor},set:function(e){this._undergroundColor=z.clone(e,this._undergroundColor)}},undergroundColorAlphaByDistance:{get:function(){return this._undergroundColorAlphaByDistance},set:function(e){this._undergroundColorAlphaByDistance=Pt.clone(e,this._undergroundColorAlphaByDistance)}},translucency:{get:function(){return this._translucency}}});var PJe=[],OJe={start:0,stop:0};Ad.prototype.pickWorldCoordinates=function(e,t,i,n){i=y(i,!0);let r=t.mode,o=t.mapProjection,a=PJe;a.length=0;let s,l,c,d=this._surface._tilesToRender,p=d.length;for(l=0;l<p;++l){s=d[l];let t=s.data;if(!u(t))continue;let i=t.pickBoundingSphere;if(r!==te.SCENE3D)t.pickBoundingSphere=i=se.fromRectangleWithHeights2D(s.rectangle,o,t.tileBoundingRegion.minimumHeight,t.tileBoundingRegion.maximumHeight,i),h.fromElements(i.center.z,i.center.x,i.center.y,i.center);else{if(!u(t.renderedMesh))continue;se.clone(t.tileBoundingRegion.boundingSphere,i)}let n=Ai.raySphere(e,i,OJe);u(n)&&a.push(t)}for(a.sort(IJe(e.origin)),p=a.length,l=0;l<p&&(c=a[l].pick(e,t.mode,t.mapProjection,i,n),!u(c));++l);return c};var RJe=new fe;Ad.prototype.pick=function(e,t,i){if(i=this.pickWorldCoordinates(e,t,!0,i),u(i)&&t.mode!==te.SCENE3D){i=h.fromElements(i.y,i.z,i.x,i);let e=t.mapProjection.unproject(i,RJe);i=t.globe.ellipsoid.cartographicToCartesian(e,i)}return i};var MJe=new h,Xfe=new h,LJe=new fe,NJe=new Tn;function pj(e,t){return u(e)&&ce.contains(e.rectangle,t)?e:void 0}Ad.prototype.getHeight=function(e){let t=this._surface._levelZeroTiles;if(!u(t))return;let i,n,r=t.length;for(n=0;n<r&&(i=t[n],!ce.contains(i.rectangle,e));++n);if(n>=r)return;let o=i;for(;u(i);)i=pj(i._southwestChild,e)||pj(i._southeastChild,e)||pj(i._northwestChild,e)||i._northeastChild,u(i)&&u(i.data)&&u(i.data.renderedMesh)&&(o=i);if(i=o,!u(i)||!u(i.data)||!u(i.data.renderedMesh))return;let a=this._surface._tileProvider.tilingScheme.projection,s=this._surface._tileProvider.tilingScheme.ellipsoid,l=h.fromRadians(e.longitude,e.latitude,0,s,MJe),c=NJe,d=s.geodeticSurfaceNormal(l,c.direction),p=s.getSurfaceNormalIntersectionWithZAxis(l,11500,c.origin);if(!u(p)){let e;u(i.data.tileBoundingRegion)&&(e=i.data.tileBoundingRegion.minimumHeight);let t=Math.min(y(e,0),-11500),n=h.multiplyByScalar(d,Math.abs(t)+1,Xfe);h.subtract(l,n,c.origin)}let f=i.data.pick(c,void 0,a,!1,Xfe);return u(f)?s.cartesianToCartographic(f,LJe).height:void 0},Ad.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},Ad.prototype.beginFrame=function(e){let t=this._surface,i=t.tileProvider,n=this.terrainProvider,r=this.showWaterEffect&&u(n)&&n.hasWaterMask&&n.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;let t=this._oceanNormalMapResource,i=t.url;if(u(i)){let n=this;t.fetchImage().then((function(t){i===n._oceanNormalMapResource.url&&(n._oceanNormalMap=n._oceanNormalMap&&n._oceanNormalMap.destroy(),n._oceanNormalMap=new Ot({context:e.context,source:t}))}))}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}let o=e.passes,a=e.mode;o.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,t.loadingDescendantLimit=this.loadingDescendantLimit,t.preloadAncestors=this.preloadAncestors,t.preloadSiblings=this.preloadSiblings,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=a===te.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.dynamicAtmosphereLighting=this.dynamicAtmosphereLighting,i.dynamicAtmosphereLightingFromSun=this.dynamicAtmosphereLightingFromSun,i.showGroundAtmosphere=this.showGroundAtmosphere,i.atmosphereLightIntensity=this.atmosphereLightIntensity,i.atmosphereRayleighCoefficient=this.atmosphereRayleighCoefficient,i.atmosphereMieCoefficient=this.atmosphereMieCoefficient,i.atmosphereRayleighScaleHeight=this.atmosphereRayleighScaleHeight,i.atmosphereMieScaleHeight=this.atmosphereMieScaleHeight,i.atmosphereMieAnisotropy=this.atmosphereMieAnisotropy,i.shadows=this.shadows,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,i.fillHighlightColor=this.fillHighlightColor,i.showSkirts=this.showSkirts,i.backFaceCulling=this.backFaceCulling,i.vertexShadowDarkness=this.vertexShadowDarkness,i.undergroundColor=this._undergroundColor,i.undergroundColorAlphaByDistance=this._undergroundColorAlphaByDistance,i.lambertDiffuseMultiplier=this.lambertDiffuseMultiplier,t.beginFrame(e))},Ad.prototype.render=function(e){this.show&&(u(this._material)&&this._material.update(e.context),this._surface.render(e))},Ad.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},Ad.prototype.isDestroyed=function(){return!1},Ad.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),le(this)};var _k=Ad,Jl="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    out_FragColor = texture(colorTexture, v_textureCoordinates);\n}\n",yx="uniform highp sampler2D u_depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    out_FragColor = czm_packDepth(texture(u_depthTexture, v_textureCoordinates).r);\n}\n";function Zh(){this._picking=!1,this._numSamples=1,this._tempCopyDepthTexture=void 0,this._pickColorFramebuffer=new di({depthStencil:!0,supportsDepthTexture:!0}),this._outputFramebuffer=new di({depthStencil:!0,supportsDepthTexture:!0}),this._copyDepthFramebuffer=new di,this._tempCopyDepthFramebuffer=new di,this._updateDepthFramebuffer=new di({createColorAttachments:!1,createDepthAttachments:!1,depthStencil:!0}),this._clearGlobeColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._viewport=new qe,this._rs=void 0,this._rsBlend=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0,this._clearGlobeDepth=void 0}function FJe(e){e._pickColorFramebuffer.destroy(),e._outputFramebuffer.destroy(),e._copyDepthFramebuffer.destroy(),e._tempCopyDepthFramebuffer.destroy(),e._updateDepthFramebuffer.destroy()}function Kfe(e,t,i,n,r){e._viewport.width=i,e._viewport.height=n;let o=!qe.equals(e._viewport,r.viewport),a=o!==e._useScissorTest;e._useScissorTest=o,qe.equals(e._scissorRectangle,r.viewport)||(e._scissorRectangle=qe.clone(r.viewport,e._scissorRectangle),a=!0),(!u(e._rs)||!qe.equals(e._viewport,e._rs.viewport)||a)&&(e._rs=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}}),e._rsBlend=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:ln.ALPHA_BLEND}),e._rsUpdate=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:Un.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:Un.NEVER,reference:Lt.CESIUM_3D_TILE_MASK,mask:Lt.CESIUM_3D_TILE_MASK}})),u(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand(yx,{uniformMap:{u_depthTexture:function(){return e.colorFramebufferManager.getDepthStencilTexture()}},owner:e})),e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer.framebuffer,e._copyDepthCommand.renderState=e._rs,u(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(Jl,{uniformMap:{colorTexture:function(){return e.colorFramebufferManager.getColorTexture()}},owner:e})),e._copyColorCommand.renderState=e._rs,u(e._tempCopyDepthCommand)||(e._tempCopyDepthCommand=t.createViewportQuadCommand(yx,{uniformMap:{u_depthTexture:function(){return e._tempCopyDepthTexture}},owner:e})),e._tempCopyDepthCommand.framebuffer=e._tempCopyDepthFramebuffer.framebuffer,e._tempCopyDepthCommand.renderState=e._rs,u(e._updateDepthCommand)||(e._updateDepthCommand=t.createViewportQuadCommand(Jl,{uniformMap:{colorTexture:function(){return e._tempCopyDepthFramebuffer.getColorTexture()}},owner:e})),e._updateDepthCommand.framebuffer=e._updateDepthFramebuffer.framebuffer,e._updateDepthCommand.renderState=e._rsUpdate,u(e._clearGlobeColorCommand)||(e._clearGlobeColorCommand=new ti({color:new z(0,0,0,0),stencil:0,owner:e})),e._clearGlobeColorCommand.framebuffer=e.framebuffer}Object.defineProperties(Zh.prototype,{colorFramebufferManager:{get:function(){return this._picking?this._pickColorFramebuffer:this._outputFramebuffer}},framebuffer:{get:function(){return this.colorFramebufferManager.framebuffer}},depthStencilTexture:{get:function(){return this.colorFramebufferManager.getDepthStencilTexture()}},picking:{get:function(){return this._picking},set:function(e){this._picking=e}}}),Zh.prototype.update=function(e,t,i,n,r,o){let a=i.width,s=i.height,l=r?e.halfFloatingPointTexture?Ye.HALF_FLOAT:Ye.FLOAT:Ye.UNSIGNED_BYTE;this._numSamples=n,this.picking?this._pickColorFramebuffer.update(e,a,s):this._outputFramebuffer.update(e,a,s,n,l),this._copyDepthFramebuffer.update(e,a,s),Kfe(this,e,a,s,t),e.uniformState.globeDepthTexture=void 0,this._useHdr=r,this._clearGlobeDepth=o},Zh.prototype.prepareColorTextures=function(e,t){!this.picking&&this._numSamples>1&&this._outputFramebuffer.prepareTextures(e,t)},Zh.prototype.executeCopyDepth=function(e,t){u(this._copyDepthCommand)&&(this.prepareColorTextures(e),this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._copyDepthFramebuffer.getColorTexture())},Zh.prototype.executeUpdateDepth=function(e,t,i,n){let r=u(n)?n:t.framebuffer.depthStencilTexture;if(i||r!==this.colorFramebufferManager.getDepthStencilTexture()){if(u(this._updateDepthCommand)){if(!u(this._updateDepthFramebuffer.framebuffer)||this._updateDepthFramebuffer.getDepthStencilTexture()!==r||this._updateDepthFramebuffer.getColorTexture()!==this._copyDepthFramebuffer.getColorTexture()){let i=this._copyDepthFramebuffer.getColorTexture().width,n=this._copyDepthFramebuffer.getColorTexture().height;this._tempCopyDepthFramebuffer.destroy(),this._tempCopyDepthFramebuffer.update(e,i,n);let o=this._copyDepthFramebuffer.getColorTexture();this._updateDepthFramebuffer.setColorTexture(o,0),this._updateDepthFramebuffer.setDepthStencilTexture(r),this._updateDepthFramebuffer.update(e,i,n),Kfe(this,e,i,n,t)}this._tempCopyDepthTexture=r,this._tempCopyDepthCommand.execute(e,t),this._updateDepthCommand.execute(e,t)}}else u(this._copyDepthCommand)&&this._copyDepthCommand.execute(e,t)},Zh.prototype.executeCopyColor=function(e,t){u(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},Zh.prototype.clear=function(e,t,i){let n=this._clearGlobeColorCommand;u(n)&&(z.clone(i,n.color),this.colorFramebufferManager.clear(e,n,t))},Zh.prototype.isDestroyed=function(){return!1},Zh.prototype.destroy=function(){return FJe(this),u(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),u(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy()),u(this._tempCopyDepthCommand)&&(this._tempCopyDepthCommand.shaderProgram=this._tempCopyDepthCommand.shaderProgram.destroy()),u(this._updateDepthCommand)&&(this._updateDepthCommand.shaderProgram=this._updateDepthCommand.shaderProgram.destroy()),le(this)};var gk=Zh;function xx(){this._framebuffer=new di({depthStencil:!0,supportsDepthTexture:!0}),this._packedDepthFramebuffer=new di,this._renderState=void 0,this._packedDepthCommand=void 0,this._clearCommand=void 0,this._viewport=new qe,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHdr=void 0}function BJe(e){e._framebuffer.destroy(),e._packedDepthFramebuffer.destroy()}function kJe(e,t,i,n,r){let o=r?t.halfFloatingPointTexture?Ye.HALF_FLOAT:Ye.FLOAT:Ye.UNSIGNED_BYTE;e._framebuffer.update(t,i,n,1,o),e._packedDepthFramebuffer.update(t,i,n)}function VJe(e,t,i,n,r){e._viewport.width=i,e._viewport.height=n;let o=!qe.equals(e._viewport,r.viewport),a=o!==e._useScissorTest;e._useScissorTest=o,qe.equals(e._scissorRectangle,r.viewport)||(e._scissorRectangle=qe.clone(r.viewport,e._scissorRectangle),a=!0),(!u(e._renderState)||!qe.equals(e._viewport,e._renderState.viewport)||a)&&(e._renderState=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),u(e._packedDepthCommand)||(e._packedDepthCommand=t.createViewportQuadCommand(yx,{uniformMap:{u_depthTexture:function(){return e.depthStencilTexture}},owner:e})),u(e._clearCommand)||(e._clearCommand=new ti({color:new z(0,0,0,0),depth:1,stencil:0,owner:e})),e._packedDepthCommand.framebuffer=e._packedDepthFramebuffer.framebuffer,e._packedDepthCommand.renderState=e._renderState,e._clearCommand.framebuffer=e.classificationFramebuffer,e._clearCommand.renderState=e._renderState}Object.defineProperties(xx.prototype,{classificationTexture:{get:function(){return this._framebuffer.getColorTexture()}},classificationFramebuffer:{get:function(){return this._framebuffer.framebuffer}},packedDepthFramebuffer:{get:function(){return this._packedDepthFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._framebuffer.getDepthStencilTexture()}},depthStencilRenderbuffer:{get:function(){return this._framebuffer.getDepthStencilRenderbuffer()}},packedDepthTexture:{get:function(){return this._packedDepthFramebuffer.getColorTexture()}}}),xx.prototype.updateAndClear=function(e,t,i,n){let r=t.width,o=t.height;kJe(this,i,r,o,e),VJe(this,i,r,o,n),this._useHdr=e},xx.prototype.clearClassification=function(e,t){this._clearCommand.execute(e,t)},xx.prototype.packDepth=function(e,t){return this._packedDepthCommand.execute(e,t),this.packedDepthTexture},xx.prototype.isDestroyed=function(){return!1},xx.prototype.destroy=function(){return BJe(this),le(this)};var yk=xx,Ws={OPAQUE_FRONT_FACE:0,OPAQUE_BACK_FACE:1,DEPTH_ONLY_FRONT_FACE:2,DEPTH_ONLY_BACK_FACE:3,DEPTH_ONLY_FRONT_AND_BACK_FACE:4,TRANSLUCENT_FRONT_FACE:5,TRANSLUCENT_BACK_FACE:6,TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:7,TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:8,PICK_FRONT_FACE:9,PICK_BACK_FACE:10,DERIVED_COMMANDS_MAXIMUM_LENGTH:11},bx=Ws.DERIVED_COMMANDS_MAXIMUM_LENGTH,rde=["opaqueFrontFaceCommand","opaqueBackFaceCommand","depthOnlyFrontFaceCommand","depthOnlyBackFaceCommand","depthOnlyFrontAndBackFaceCommand","translucentFrontFaceCommand","translucentBackFaceCommand","translucentFrontFaceManualDepthTestCommand","translucentBackFaceManualDepthTestCommand","pickFrontFaceCommand","pickBackFaceCommand"];function Tx(){this._frontFaceAlphaByDistance=new Pt(0,1,0,1),this._backFaceAlphaByDistance=new Pt(0,1,0,1),this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._requiresManualDepthTest=!1,this._sunVisibleThroughGlobe=!1,this._environmentVisible=!1,this._useDepthPlane=!1,this._numberOfTextureUniforms=0,this._globeTranslucencyFramebuffer=void 0,this._rectangle=ce.clone(ce.MAX_VALUE),this._derivedCommandKey=0,this._derivedCommandsDirty=!1,this._derivedCommandPacks=void 0,this._derivedCommandTypes=new Array(bx),this._derivedBlendCommandTypes=new Array(bx),this._derivedPickCommandTypes=new Array(bx),this._derivedCommandTypesToUpdate=new Array(bx),this._derivedCommandsLength=0,this._derivedBlendCommandsLength=0,this._derivedPickCommandsLength=0,this._derivedCommandsToUpdateLength=0}function Zfe(e,t,i,n){return e?u(i)?(Pt.clone(i,n),n.nearValue*=t,n.farValue*=t,n):(n.nearValue=t,n.farValue=t,n):(n.nearValue=1,n.farValue=1,n)}function $fe(e,t,i){return e&&(i.baseColor.alpha<1||t.nearValue<1||t.farValue<1)}function UJe(e,t){let i=e._frontFaceTranslucent,n=e._backFaceTranslucent;return i&&(t.cameraUnderground||n)}function zJe(e,t){return!t.cameraUnderground||e._frontFaceTranslucent}function HJe(e,t){return!t.cameraUnderground&&!e._frontFaceTranslucent}function GJe(e,t,i){return e._frontFaceTranslucent&&!e._backFaceTranslucent&&!i.depthTestAgainstTerrain&&t.mode!==te.SCENE2D&&t.context.depthTexture}function WJe(e){let t=0;return e._frontFaceTranslucent&&++t,e._requiresManualDepthTest&&++t,t}function jJe(e,t){e._derivedCommandsLength=gj(e,t,!1,!1,e._derivedCommandTypes),e._derivedBlendCommandsLength=gj(e,t,!0,!1,e._derivedBlendCommandTypes),e._derivedPickCommandsLength=gj(e,t,!1,!0,e._derivedPickCommandTypes);let i,n=0;for(i=0;i<e._derivedCommandsLength;++i)n|=1<<e._derivedCommandTypes[i];for(i=0;i<e._derivedBlendCommandsLength;++i)n|=1<<e._derivedBlendCommandTypes[i];for(i=0;i<e._derivedPickCommandsLength;++i)n|=1<<e._derivedPickCommandTypes[i];let r=0;for(i=0;i<bx;++i)(n&1<<i)>0&&(e._derivedCommandTypesToUpdate[r++]=i);e._derivedCommandsToUpdateLength=r;let o=n!==e._derivedCommandKey;e._derivedCommandKey=n,e._derivedCommandsDirty=o,!u(e._derivedCommandPacks)&&e._frontFaceTranslucent&&(e._derivedCommandPacks=set())}function gj(e,t,i,n,r){let o=0,a=e._frontFaceTranslucent,s=e._backFaceTranslucent;if(!a)return o;let l=t.cameraUnderground,u=e._requiresManualDepthTest,c=n?Ws.PICK_FRONT_FACE:u?Ws.TRANSLUCENT_FRONT_FACE_MANUAL_DEPTH_TEST:Ws.TRANSLUCENT_FRONT_FACE,h=n?Ws.PICK_BACK_FACE:u?Ws.TRANSLUCENT_BACK_FACE_MANUAL_DEPTH_TEST:Ws.TRANSLUCENT_BACK_FACE;return t.mode===te.SCENE2D?(r[o++]=Ws.DEPTH_ONLY_FRONT_FACE,r[o++]=c,o):(s?(i||(r[o++]=Ws.DEPTH_ONLY_FRONT_AND_BACK_FACE),l?(r[o++]=c,r[o++]=h):(r[o++]=h,r[o++]=c)):l?(i||(r[o++]=Ws.DEPTH_ONLY_BACK_FACE),r[o++]=Ws.OPAQUE_FRONT_FACE,r[o++]=h):(i||(r[o++]=Ws.DEPTH_ONLY_FRONT_FACE),r[o++]=Ws.OPAQUE_BACK_FACE,r[o++]=c),o)}function hf(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}function Qfe(e,t){return e.indexOf(t)>-1}function qJe(e,t){hf(e.defines,"TRANSLUCENT"),hf(t.defines,"TRANSLUCENT")}function YJe(e,t){hf(e.defines,"GROUND_ATMOSPHERE"),hf(t.defines,"GROUND_ATMOSPHERE"),hf(e.defines,"FOG"),hf(t.defines,"FOG"),hf(e.defines,"TRANSLUCENT"),hf(t.defines,"TRANSLUCENT")}function yj(e,t){if(Qfe(t.defines,"TILE_LIMIT_RECTANGLE")||Qfe(t.defines,"ENABLE_CLIPPING_PLANES"))return;t.sources=["void main() \n{ \n    out_FragColor = vec4(1.0); \n} \n"]}function xj(e,t){let i=t.sources,n=i.length;for(let e=0;e<n;++e)i[e]=He.replaceMain(i[e],"czm_globe_translucency_main");i.push("\n\nuniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n#ifdef MANUAL_DEPTH_TEST \n    float logDepthOrDepth = czm_unpackDepth(texture(czm_globeDepthTexture, st)); \n    if (logDepthOrDepth != 0.0) \n    { \n        vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth); \n        float depthEC = eyeCoordinate.z / eyeCoordinate.w; \n        if (v_positionEC.z < depthEC) \n        { \n            discard; \n        } \n    } \n#endif \n    czm_globe_translucency_main(); \n    vec4 classificationColor = texture(u_classificationTexture, st); \n    if (classificationColor.a > 0.0) \n    { \n        // Reverse premultiplication process to get the correct composited result of the classification primitives \n        classificationColor.rgb /= classificationColor.a; \n    } \n    out_FragColor = classificationColor * vec4(classificationColor.aaa, 1.0) + out_FragColor * (1.0 - classificationColor.a); \n} \n")}function sde(e,t){xj(e,t),hf(e.defines,"GROUND_ATMOSPHERE"),hf(t.defines,"GROUND_ATMOSPHERE"),hf(e.defines,"FOG"),hf(t.defines,"FOG")}function XJe(e,t){xj(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function KJe(e,t){sde(e,t),e.defines.push("GENERATE_POSITION"),t.defines.push("MANUAL_DEPTH_TEST")}function Jfe(e,t){t.sources=["uniform sampler2D u_classificationTexture; \nvoid main() \n{ \n    vec2 st = gl_FragCoord.xy / czm_viewport.zw; \n    vec4 pickColor = texture(u_classificationTexture, st); \n    if (pickColor == vec4(0.0)) \n    { \n        discard; \n    } \n    out_FragColor = pickColor; \n} \n"]}function ZJe(e,t,i,n,r,o){if(!u(r))return t;if(!n&&u(i))return i;let a=e.shaderCache.getDerivedShaderProgram(t,o);if(!u(a)){let i=t._attributeLocations,n=t.vertexShaderSource.clone(),s=t.fragmentShaderSource.clone();n.defines=u(n.defines)?n.defines.slice(0):[],s.defines=u(s.defines)?s.defines.slice(0):[],r(n,s),a=e.shaderCache.createDerivedShaderProgram(t,o,{vertexShaderSource:n,fragmentShaderSource:s,attributeLocations:i})}return a}function $Je(e){e.cull.face=gi.BACK,e.cull.enabled=!0}function QJe(e){e.cull.face=gi.FRONT,e.cull.enabled=!0}function JJe(e){e.cull.face=gi.BACK,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function eet(e){e.cull.face=gi.FRONT,e.cull.enabled=!0,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function tet(e){e.cull.enabled=!1,e.colorMask={red:!1,green:!1,blue:!1,alpha:!1}}function ede(e){e.cull.face=gi.BACK,e.cull.enabled=!0,e.depthMask=!1,e.blending=ln.ALPHA_BLEND}function tde(e){e.cull.face=gi.FRONT,e.cull.enabled=!0,e.depthMask=!1,e.blending=ln.ALPHA_BLEND}function net(e){e.cull.face=gi.BACK,e.cull.enabled=!0,e.blending.enabled=!1}function iet(e){e.cull.face=gi.FRONT,e.cull.enabled=!0,e.blending.enabled=!1}function oet(e,t,i,n,r){if(!u(n))return e;if(!i&&u(t))return t;let o=r[e.id];if(!u(o)){let t=Ue.getState(e);n(t),o=Ue.fromCache(t),r[e.id]=o}return o}function dC(e){return{u_classificationTexture:function(){return e._globeTranslucencyFramebuffer.classificationTexture}}}function ret(e,t,i,n,r){return u(r)?!n&&u(i)?i:gt(t,r(e),!1):t}function Cd(e){this.pass=e.pass,this.pickOnly=e.pickOnly,this.getShaderProgramFunction=e.getShaderProgramFunction,this.getRenderStateFunction=e.getRenderStateFunction,this.getUniformMapFunction=e.getUniformMapFunction,this.renderStateCache={}}function set(){return[new Cd({pass:Ee.GLOBE,pickOnly:!1,getShaderProgramFunction:qJe,getRenderStateFunction:$Je,getUniformMapFunction:void 0}),new Cd({pass:Ee.GLOBE,pickOnly:!1,getShaderProgramFunction:YJe,getRenderStateFunction:QJe,getUniformMapFunction:void 0}),new Cd({pass:Ee.GLOBE,pickOnly:!1,getShaderProgramFunction:yj,getRenderStateFunction:JJe,getUniformMapFunction:void 0}),new Cd({pass:Ee.GLOBE,pickOnly:!1,getShaderProgramFunction:yj,getRenderStateFunction:eet,getUniformMapFunction:void 0}),new Cd({pass:Ee.GLOBE,pickOnly:!1,getShaderProgramFunction:yj,getRenderStateFunction:tet,getUniformMapFunction:void 0}),new Cd({pass:Ee.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:xj,getRenderStateFunction:ede,getUniformMapFunction:dC}),new Cd({pass:Ee.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:sde,getRenderStateFunction:tde,getUniformMapFunction:dC}),new Cd({pass:Ee.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:XJe,getRenderStateFunction:ede,getUniformMapFunction:dC}),new Cd({pass:Ee.TRANSLUCENT,pickOnly:!1,getShaderProgramFunction:KJe,getRenderStateFunction:tde,getUniformMapFunction:dC}),new Cd({pass:Ee.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:Jfe,getRenderStateFunction:net,getUniformMapFunction:dC}),new Cd({pass:Ee.TRANSLUCENT,pickOnly:!0,getShaderProgramFunction:Jfe,getRenderStateFunction:iet,getUniformMapFunction:dC})]}Object.defineProperties(Tx.prototype,{frontFaceAlphaByDistance:{get:function(){return this._frontFaceAlphaByDistance}},backFaceAlphaByDistance:{get:function(){return this._backFaceAlphaByDistance}},translucent:{get:function(){return this._frontFaceTranslucent}},sunVisibleThroughGlobe:{get:function(){return this._sunVisibleThroughGlobe}},environmentVisible:{get:function(){return this._environmentVisible}},useDepthPlane:{get:function(){return this._useDepthPlane}},numberOfTextureUniforms:{get:function(){return this._numberOfTextureUniforms}},rectangle:{get:function(){return this._rectangle}}}),Tx.prototype.update=function(e){let t=e.globe;if(!u(t)||!t.show)return this._frontFaceTranslucent=!1,this._backFaceTranslucent=!1,this._sunVisibleThroughGlobe=!0,this._environmentVisible=!0,void(this._useDepthPlane=!1);this._frontFaceAlphaByDistance=Zfe(t.translucency.enabled,t.translucency.frontFaceAlpha,t.translucency.frontFaceAlphaByDistance,this._frontFaceAlphaByDistance),this._backFaceAlphaByDistance=Zfe(t.translucency.enabled,t.translucency.backFaceAlpha,t.translucency.backFaceAlphaByDistance,this._backFaceAlphaByDistance),this._frontFaceTranslucent=$fe(t.translucency.enabled,this._frontFaceAlphaByDistance,t),this._backFaceTranslucent=$fe(t.translucency.enabled,this._backFaceAlphaByDistance,t),this._requiresManualDepthTest=GJe(this,e,t),this._sunVisibleThroughGlobe=UJe(this,e),this._environmentVisible=zJe(this,e),this._useDepthPlane=HJe(this,e),this._numberOfTextureUniforms=WJe(this),this._rectangle=ce.clone(t.translucency.rectangle,this._rectangle),jJe(this,e)};var nde=new Array(bx),ide=new Array(bx);function aet(e,t,i,n,r,o,a){let s=t.derivedCommands.globeTranslucency,l=e._derivedCommandsDirty;if(t.dirty||!u(s)||l){t.dirty=!1,u(s)||(s={},t.derivedCommands.globeTranslucency=s);let l=a.frameNumber,c=y(s.uniformMapDirtyFrame,0),h=y(s.shaderProgramDirtyFrame,0),d=y(s.renderStateDirtyFrame,0),p=s.uniformMap!==t.uniformMap,f=s.shaderProgramId!==t.shaderProgram.id,m=s.renderStateId!==t.renderState.id;p&&(s.uniformMapDirtyFrame=l),f&&(s.shaderProgramDirtyFrame=l),m&&(s.renderStateDirtyFrame=l),s.uniformMap=t.uniformMap,s.shaderProgramId=t.shaderProgram.id,s.renderStateId=t.renderState.id;for(let _=0;_<i;++_){let i,g,v,b=o[_],A=n[_],T=r[_],E=s[T];u(E)?(i=E.uniformMap,g=E.shaderProgram,v=E.renderState):(i=void 0,g=void 0,v=void 0),E=et.shallowClone(t,E),s[T]=E;let C=y(E.derivedCommands.uniformMapDirtyFrame,0),x=y(E.derivedCommands.shaderProgramDirtyFrame,0),S=y(E.derivedCommands.renderStateDirtyFrame,0),w=p||C<c,I=f||x<h,P=m||S<d;w&&(E.derivedCommands.uniformMapDirtyFrame=l),I&&(E.derivedCommands.shaderProgramDirtyFrame=l),P&&(E.derivedCommands.renderStateDirtyFrame=l),E.derivedCommands.type=A,E.pass=b.pass,E.pickOnly=b.pickOnly,E.uniformMap=ret(e,t.uniformMap,i,w,b.getUniformMapFunction),E.shaderProgram=ZJe(a.context,t.shaderProgram,g,I,b.getShaderProgramFunction,T),E.renderState=oet(t.renderState,v,P,b.getRenderStateFunction,b.renderStateCache)}}}function ade(e,t,i,n,r,o,a){for(let s=0;s<t;++s){let t=e[s],l=t.derivedCommands.type;(!u(a)||a.indexOf(l)>-1)&&i(t,n,r,o)}}function ode(e,t,i,n,r,o){for(let a=0;a<t;++a)i(e[a],n,r,o)}Tx.prototype.updateDerivedCommands=function(e,t){let i=this._derivedCommandTypesToUpdate,n=this._derivedCommandsToUpdateLength;if(0!==n){for(let e=0;e<n;++e)ide[e]=this._derivedCommandPacks[i[e]],nde[e]=rde[i[e]];aet(this,e,n,i,nde,ide,t)}},Tx.prototype.pushDerivedCommands=function(e,t,i){let n=i.passes.pick;if(n&&t)return;let r=this._derivedCommandTypes,o=this._derivedCommandsLength;if(n?(r=this._derivedPickCommandTypes,o=this._derivedPickCommandsLength):t&&(r=this._derivedBlendCommandTypes,o=this._derivedBlendCommandsLength),0===o)return void i.commandList.push(e);let a=e.derivedCommands.globeTranslucency;for(let e=0;e<o;++e){let t=rde[r[e]];i.commandList.push(a[t])}};var cet=[Ws.OPAQUE_FRONT_FACE,Ws.OPAQUE_BACK_FACE],uet=[Ws.DEPTH_ONLY_FRONT_FACE,Ws.DEPTH_ONLY_BACK_FACE,Ws.DEPTH_ONLY_FRONT_AND_BACK_FACE];Tx.prototype.executeGlobeCommands=function(e,t,i,n,r){let o=n.context,a=e.commands[Ee.GLOBE],s=e.indices[Ee.GLOBE];0!==s&&(this._globeTranslucencyFramebuffer=i,i.clearClassification(o,r),ade(a,s,t,n,o,r,cet))},Tx.prototype.executeGlobeClassificationCommands=function(e,t,i,n,r){let o=n.context,a=e.commands[Ee.GLOBE],s=e.indices[Ee.GLOBE],l=e.commands[Ee.TERRAIN_CLASSIFICATION],u=e.indices[Ee.TERRAIN_CLASSIFICATION];if(0===s||0===u)return;let c=this._frontFaceTranslucent,h=this._backFaceTranslucent;if((!c||!h)&&ode(l,u,t,n,o,r),!c&&!h)return;this._globeTranslucencyFramebuffer=i;let d=o.uniformState.globeDepthTexture,p=r.framebuffer;if(r.framebuffer=i.classificationFramebuffer,ade(a,s,t,n,o,r,uet),o.depthTexture){let e=i.packDepth(o,r);o.uniformState.globeDepthTexture=e}ode(l,u,t,n,o,r),o.uniformState.globeDepthTexture=d,r.framebuffer=p};var xk=Tx,cde=or(gG(),1);function bj(){this._image=new Image}function Ax(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=new Ui({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new ce(-P.PI,-P.PI,P.PI,P.PI),ellipsoid:e.ellipsoid});let t=e.credit;"string"==typeof t&&(t=new xt(t)),this._credit=t,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,u(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new bj),this._errorEvent=new pe}function fet(e,t,i,n,r,o){let a=O_.tileXYToQuadKey(i,n,r),s=t.imageryVersion;return s=u(s)&&s>0?s:1,e._metadata.resource.getDerivedResource({url:`flatfile?f1-0${a}-i.${s.toString()}`,request:o})}function det(e){let t="JFIF";if(e[6]===t.charCodeAt(0)&&e[7]===t.charCodeAt(1)&&e[8]===t.charCodeAt(2)&&e[9]===t.charCodeAt(3))return"image/jpeg";let i="PNG";return e[1]===i.charCodeAt(0)&&e[2]===i.charCodeAt(1)&&e[3]===i.charCodeAt(2)?"image/png":void 0}function het(e){let t=cde.Reader.create(e),i=t.len,n={};for(;t.pos<i;){let e,i=t.uint32();switch(i>>>3){case 1:n.imageType=t.uint32();break;case 2:n.imageData=t.bytes();break;case 3:n.alphaType=t.uint32();break;case 4:n.imageAlpha=t.bytes();break;case 5:if(e=n.copyrightIds,u(e)||(e=n.copyrightIds=[]),2==(7&i)){let i=t.uint32()+t.pos;for(;t.pos<i;)e.push(t.uint32())}else e.push(t.uint32());break;default:t.skipType(7&i)}}let r=n.imageType;if(u(r))switch(r){case 0:n.imageType="image/jpeg";break;case 4:n.imageType="image/png";break;default:throw new ue("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}let o=n.alphaType;return u(o)&&0!==o&&(console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported."),delete n.alphaType,delete n.imageAlpha),n}bj.prototype.isReady=function(){return!0},bj.prototype.shouldDiscardImage=function(e){return e===this._image},Object.defineProperties(Ax.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}}),Ax.fromMetadata=function(e,t){if(!e.imageryPresent)throw new ue(`The server ${e.url} doesn't have imagery`);let i=new Ax(t);return i._metadata=e,i},Ax.prototype.getTileCredits=function(e,t,i){let n=this._metadata,r=n.getTileInformation(e,t,i);if(u(r)){let e=n.providers[r.imageryProvider];if(u(e))return[e]}},Ax.prototype.requestImage=function(e,t,i,n){let r=this._tileDiscardPolicy._image,o=this._metadata,a=O_.tileXYToQuadKey(e,t,i),s=o.getTileInformation(e,t,i);if(!u(s)){if(o.isValid(a)){let r=new Ko({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction});return void o.populateSubtree(e,t,i,r)}return Promise.resolve(r)}if(!s.hasImagery())return Promise.resolve(r);let l=fet(this,s,e,t,i,n).fetchArrayBuffer();return u(l)?l.then((function(e){R1(o.key,e);let t,i=new Uint8Array(e),n=o.protoImagery;if((!u(n)||!n)&&(t=det(i)),!u(t)&&(!u(n)||n)){let e=het(i);t=e.imageType,i=e.imageData}return u(t)&&u(i)?ST({uint8Array:i,format:t,flipY:!0}):r})):void 0},Ax.prototype.pickFeatures=function(e,t,i,n,r){};var lde=Ax,met=new z(1,1,1,.4),pet=new z(0,1,0,.05),_et=new z(0,.5,0,.2);function Cx(e){e=y(e,y.EMPTY_OBJECT),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0,this._tilingScheme=u(e.tilingScheme)?e.tilingScheme:new Ui({ellipsoid:e.ellipsoid}),this._cells=y(e.cells,8),this._color=y(e.color,met),this._glowColor=y(e.glowColor,pet),this._glowWidth=y(e.glowWidth,6),this._backgroundColor=y(e.backgroundColor,_et),this._errorEvent=new pe,this._tileWidth=y(e.tileWidth,256),this._tileHeight=y(e.tileHeight,256),this._canvasSize=y(e.canvasSize,256),this._canvas=this._createGridCanvas()}Object.defineProperties(Cx.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),Cx.prototype._drawGrid=function(e){let t=this._canvasSize;for(let i=0;i<=this._cells;++i){let n=1+i/this._cells*(t-1);e.moveTo(n,0),e.lineTo(n,t),e.moveTo(0,n),e.lineTo(t,n)}e.stroke()},Cx.prototype._createGridCanvas=function(){let e=document.createElement("canvas");e.width=this._canvasSize,e.height=this._canvasSize;let t=this._canvasSize,i=e.getContext("2d"),n=this._backgroundColor.toCssColorString();i.fillStyle=n,i.fillRect(0,0,t,t);let r=this._glowColor.toCssColorString();i.strokeStyle=r,i.lineWidth=this._glowWidth,i.strokeRect(0,0,t,t),this._drawGrid(i),i.lineWidth=.5*this._glowWidth,i.strokeRect(0,0,t,t),this._drawGrid(i);let o=this._color.toCssColorString();return i.strokeStyle=o,i.lineWidth=2,i.strokeRect(0,0,t,t),i.lineWidth=1,this._drawGrid(i),e},Cx.prototype.getTileCredits=function(e,t,i){},Cx.prototype.requestImage=function(e,t,i,n){return Promise.resolve(this._canvas)},Cx.prototype.pickFeatures=function(e,t,i,n,r){};var ude=Cx,bk='in vec4 v_startPlaneNormalEcAndHalfWidth;\nin vec4 v_endPlaneNormalEcAndBatchId;\nin vec4 v_rightPlaneEC; // Technically can compute distance for this here\nin vec4 v_endEcAndStartEcX;\nin vec4 v_texcoordNormalizationAndStartEcYZ;\n\n#ifdef PER_INSTANCE_COLOR\nin vec4 v_color;\n#endif\n\nvoid main(void)\n{\n    float logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));\n    vec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);\n\n    // Discard for sky\n    if (logDepthOrDepth == 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\n        out_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\n        return;\n#else // DEBUG_SHOW_VOLUME\n        discard;\n#endif // DEBUG_SHOW_VOLUME\n    }\n\n    vec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\n    eyeCoordinate /= eyeCoordinate.w;\n\n    float halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);\n    // Check distance of the eye coordinate against the right-facing plane\n    float widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);\n\n    // Check eye coordinate against the mitering planes\n    float distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);\n    float distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);\n\n    if (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\n        out_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\n        return;\n#else // DEBUG_SHOW_VOLUME\n        discard;\n#endif // DEBUG_SHOW_VOLUME\n    }\n\n    // Check distance of the eye coordinate against start and end planes with normals in the right plane.\n    // For computing unskewed lengthwise texture coordinate.\n    // Can also be used for clipping extremely pointy miters, but in practice unnecessary because of miter breaking.\n\n    // aligned plane: cross the right plane normal with miter plane normal, then cross the result with right again to point it more "forward"\n    vec3 alignedPlaneNormal;\n\n    // start aligned plane\n    alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);\n    alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\n    distanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);\n\n    // end aligned plane\n    alignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);\n    alignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\n    distanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);\n\n#ifdef PER_INSTANCE_COLOR\n    out_FragColor = czm_gammaCorrect(v_color);\n#else // PER_INSTANCE_COLOR\n    // Clamp - distance to aligned planes may be negative due to mitering,\n    // so fragment texture coordinate might be out-of-bounds.\n    float s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);\n    s = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;\n    float t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);\n\n    czm_materialInput materialInput;\n\n    materialInput.s = s;\n    materialInput.st = vec2(s, t);\n    materialInput.str = vec3(s, t, 0.0);\n\n    czm_material material = czm_getMaterial(materialInput);\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\n\n    // Premultiply alpha. Required for classification primitives on translucent globe.\n    out_FragColor.rgb *= out_FragColor.a;\n\n    czm_writeDepthClamp();\n}\n',Tk="in vec3 v_forwardDirectionEC;\nin vec3 v_texcoordNormalizationAndHalfWidth;\nin float v_batchId;\n\n#ifdef PER_INSTANCE_COLOR\nin vec4 v_color;\n#else\nin vec2 v_alignedPlaneDistances;\nin float v_texcoordT;\n#endif\n\nfloat rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {\n    // We don't expect the ray to ever be parallel to the plane\n    return (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);\n}\n\nvoid main(void)\n{\n    vec4 eyeCoordinate = gl_FragCoord;\n    eyeCoordinate /= eyeCoordinate.w;\n\n#ifdef PER_INSTANCE_COLOR\n    out_FragColor = czm_gammaCorrect(v_color);\n#else // PER_INSTANCE_COLOR\n    // Use distances for planes aligned with segment to prevent skew in dashing\n    float distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);\n    float distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);\n\n    // Clamp - distance to aligned planes may be negative due to mitering\n    distanceFromStart = max(0.0, distanceFromStart);\n    distanceFromEnd = max(0.0, distanceFromEnd);\n\n    float s = distanceFromStart / (distanceFromStart + distanceFromEnd);\n    s = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;\n\n    czm_materialInput materialInput;\n\n    materialInput.s = s;\n    materialInput.st = vec2(s, v_texcoordT);\n    materialInput.str = vec3(s, v_texcoordT, 0.0);\n\n    czm_material material = czm_getMaterial(materialInput);\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\n}\n",Ak='in vec3 position3DHigh;\nin vec3 position3DLow;\n\nin vec4 startHiAndForwardOffsetX;\nin vec4 startLoAndForwardOffsetY;\nin vec4 startNormalAndForwardOffsetZ;\nin vec4 endNormalAndTextureCoordinateNormalizationX;\nin vec4 rightNormalAndTextureCoordinateNormalizationY;\nin vec4 startHiLo2D;\nin vec4 offsetAndRight2D;\nin vec4 startEndNormals2D;\nin vec2 texcoordNormalization2D;\n\nin float batchId;\n\nout vec3 v_forwardDirectionEC;\nout vec3 v_texcoordNormalizationAndHalfWidth;\nout float v_batchId;\n\n// For materials\n#ifdef WIDTH_VARYING\nout float v_width;\n#endif\n#ifdef ANGLE_VARYING\nout float v_polylineAngle;\n#endif\n\n#ifdef PER_INSTANCE_COLOR\nout vec4 v_color;\n#else\nout vec2 v_alignedPlaneDistances;\nout float v_texcoordT;\n#endif\n\n// Morphing planes using SLERP or NLERP doesn\'t seem to work, so instead draw the material directly on the shadow volume.\n// Morph views are from very far away and aren\'t meant to be used precisely, so this should be sufficient.\nvoid main()\n{\n    v_batchId = batchId;\n\n    // Start position\n    vec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));\n    vec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);\n    vec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\n    vec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\n    vec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\n    vec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\n\n    // Start plane\n    vec4 startPlane2D;\n    vec4 startPlane3D;\n    startPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);\n    startPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\n    startPlane2D.w = -dot(startPlane2D.xyz, posEc2D);\n    startPlane3D.w = -dot(startPlane3D.xyz, posEc3D);\n\n    // Right plane\n    vec4 rightPlane2D;\n    vec4 rightPlane3D;\n    rightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\n    rightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\n    rightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);\n    rightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);\n\n    // End position\n    posRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);\n    posRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);\n    posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\n    posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\n    posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\n    vec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\n    vec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));\n    vec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));\n\n    // End plane\n    vec4 endPlane2D;\n    vec4 endPlane3D;\n    endPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);\n    endPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\n    endPlane2D.w = -dot(endPlane2D.xyz, posEc2D);\n    endPlane3D.w = -dot(endPlane3D.xyz, posEc3D);\n\n    // Forward direction\n    v_forwardDirectionEC = normalize(endEC - startEC);\n\n    vec2 cleanTexcoordNormalization2D;\n    cleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);\n    cleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));\n    vec2 cleanTexcoordNormalization3D;\n    cleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\n    cleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;\n    cleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));\n\n    v_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);\n\n#ifdef PER_INSTANCE_COLOR\n    v_color = czm_batchTable_color(batchId);\n#else // PER_INSTANCE_COLOR\n    // For computing texture coordinates\n\n    v_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);\n    v_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);\n#endif // PER_INSTANCE_COLOR\n\n#ifdef WIDTH_VARYING\n    float width = czm_batchTable_width(batchId);\n    float halfWidth = width * 0.5;\n    v_width = width;\n    v_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#else\n    float halfWidth = 0.5 * czm_batchTable_width(batchId);\n    v_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#endif\n\n    // Compute a normal along which to "push" the position out, extending the miter depending on view distance.\n    // Position has already been "pushed" by unit length along miter normal, and miter normals are encoded in the planes.\n    // Decode the normal to use at this specific vertex, push the position back, and then push to where it needs to be.\n    // Since this is morphing, compute both 3D and 2D positions and then blend.\n\n    // ****** 3D ******\n    // Check distance to the end plane and start plane, pick the plane that is closer\n    vec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow); // w = 1.0, see czm_computePosition\n    float absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));\n    float absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));\n    vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);\n    vec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection)); // Points "up" for start plane, "down" at end plane.\n    vec3 normalEC = normalize(cross(planeDirection, upOrDown));         // In practice, the opposite seems to work too.\n\n    // Nudge the top vertex upwards to prevent flickering\n    vec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));\n    geodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);\n    geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\n    positionEc3D.xyz += geodeticSurfaceNormal;\n\n    // Determine if this vertex is on the "left" or "right"\n    normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\n\n    // A "perfect" implementation would push along normals according to the angle against forward.\n    // In practice, just pushing the normal out by halfWidth is sufficient for morph views.\n    positionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC; // prevent artifacts when czm_metersPerPixel is negative (behind camera)\n\n    // ****** 2D ******\n    // Check distance to the end plane and start plane, pick the plane that is closer\n    vec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy); // w = 1.0, see czm_computePosition\n    absStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));\n    absEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));\n    planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);\n    upOrDown = normalize(cross(rightPlane2D.xyz, planeDirection)); // Points "up" for start plane, "down" at end plane.\n    normalEC = normalize(cross(planeDirection, upOrDown));         // In practice, the opposite seems to work too.\n\n    // Nudge the top vertex upwards to prevent flickering\n    geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));\n    geodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);\n    geodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\n    positionEc2D.xyz += geodeticSurfaceNormal;\n\n    // Determine if this vertex is on the "left" or "right"\n    normalEC *= sign(texcoordNormalization2D.x);\n#ifndef PER_INSTANCE_COLOR\n    // Use vertex\'s sidedness to compute its texture coordinate.\n    v_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);\n#endif\n\n    // A "perfect" implementation would push along normals according to the angle against forward.\n    // In practice, just pushing the normal out by halfWidth is sufficient for morph views.\n    positionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC; // prevent artifacts when czm_metersPerPixel is negative (behind camera)\n\n    // Blend for actual position\n    gl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);\n\n#ifdef ANGLE_VARYING\n    // Approximate relative screen space direction of the line.\n    vec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));\n    approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\n    v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n',Ck='in vec3 position3DHigh;\nin vec3 position3DLow;\n\n// In 2D and in 3D, texture coordinate normalization component signs encodes:\n// * X sign - sidedness relative to right plane\n// * Y sign - is negative OR magnitude is greater than 1.0 if vertex is on bottom of volume\n#ifndef COLUMBUS_VIEW_2D\nin vec4 startHiAndForwardOffsetX;\nin vec4 startLoAndForwardOffsetY;\nin vec4 startNormalAndForwardOffsetZ;\nin vec4 endNormalAndTextureCoordinateNormalizationX;\nin vec4 rightNormalAndTextureCoordinateNormalizationY;\n#else\nin vec4 startHiLo2D;\nin vec4 offsetAndRight2D;\nin vec4 startEndNormals2D;\nin vec2 texcoordNormalization2D;\n#endif\n\nin float batchId;\n\nout vec4 v_startPlaneNormalEcAndHalfWidth;\nout vec4 v_endPlaneNormalEcAndBatchId;\nout vec4 v_rightPlaneEC;\nout vec4 v_endEcAndStartEcX;\nout vec4 v_texcoordNormalizationAndStartEcYZ;\n\n// For materials\n#ifdef WIDTH_VARYING\nout float v_width;\n#endif\n#ifdef ANGLE_VARYING\nout float v_polylineAngle;\n#endif\n\n#ifdef PER_INSTANCE_COLOR\nout vec4 v_color;\n#endif\n\nvoid main()\n{\n#ifdef COLUMBUS_VIEW_2D\n    vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;\n\n    vec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);\n    vec3 ecEnd = forwardDirectionEC + ecStart;\n    forwardDirectionEC = normalize(forwardDirectionEC);\n\n    // Right plane\n    v_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\n    v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\n\n    // start plane\n    vec4 startPlaneEC;\n    startPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);\n    startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\n\n    // end plane\n    vec4 endPlaneEC;\n    endPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);\n    endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\n\n    v_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);\n    v_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;\n\n#else // COLUMBUS_VIEW_2D\n    vec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;\n    vec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);\n    vec3 ecEnd = ecStart + offset;\n\n    vec3 forwardDirectionEC = normalize(offset);\n\n    // start plane\n    vec4 startPlaneEC;\n    startPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\n    startPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\n\n    // end plane\n    vec4 endPlaneEC;\n    endPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\n    endPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\n\n    // Right plane\n    v_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\n    v_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\n\n    v_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\n    v_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;\n\n#endif // COLUMBUS_VIEW_2D\n\n    v_endEcAndStartEcX.xyz = ecEnd;\n    v_endEcAndStartEcX.w = ecStart.x;\n    v_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;\n\n#ifdef PER_INSTANCE_COLOR\n    v_color = czm_batchTable_color(batchId);\n#endif // PER_INSTANCE_COLOR\n\n    // Compute a normal along which to "push" the position out, extending the miter depending on view distance.\n    // Position has already been "pushed" by unit length along miter normal, and miter normals are encoded in the planes.\n    // Decode the normal to use at this specific vertex, push the position back, and then push to where it needs to be.\n    vec4 positionRelativeToEye = czm_computePosition();\n\n    // Check distance to the end plane and start plane, pick the plane that is closer\n    vec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye; // w = 1.0, see czm_computePosition\n    float absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));\n    float absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));\n    vec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);\n    vec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection)); // Points "up" for start plane, "down" at end plane.\n    vec3 normalEC = normalize(cross(planeDirection, upOrDown));           // In practice, the opposite seems to work too.\n\n    // Extrude bottom vertices downward for far view distances, like for GroundPrimitives\n    upOrDown = cross(forwardDirectionEC, normalEC);\n    upOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;\n    upOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;\n    upOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;\n    positionEC.xyz += upOrDown;\n\n    v_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));\n\n    // Determine distance along normalEC to push for a volume of appropriate width.\n    // Make volumes about double pixel width for a conservative fit - in practice the\n    // extra cost here is minimal compared to the loose volume heights.\n    //\n    // N = normalEC (guaranteed "right-facing")\n    // R = rightEC\n    // p = angle between N and R\n    // w = distance to push along R if R == N\n    // d = distance to push along N\n    //\n    //   N   R\n    //  {  p| }      * cos(p) = dot(N, R) = w / d\n    //  d  |  |w    * d = w / dot(N, R)\n    //    { | }\n    //       o---------- polyline segment ----\x3e\n    //\n    float width = czm_batchTable_width(batchId);\n#ifdef WIDTH_VARYING\n    v_width = width;\n#endif\n\n    v_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;\n    v_startPlaneNormalEcAndHalfWidth.w = width * 0.5;\n\n    v_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;\n    v_endPlaneNormalEcAndBatchId.w = batchId;\n\n    width = width * max(0.0, czm_metersPerPixel(positionEC)); // width = distance to push along R\n    width = width / dot(normalEC, v_rightPlaneEC.xyz); // width = distance to push along N\n\n    // Determine if this vertex is on the "left" or "right"\n#ifdef COLUMBUS_VIEW_2D\n        normalEC *= sign(texcoordNormalization2D.x);\n#else\n        normalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\n#endif\n\n    positionEC.xyz += width * normalEC;\n    gl_Position = czm_depthClamp(czm_projection * positionEC);\n\n#ifdef ANGLE_VARYING\n    // Approximate relative screen space direction of the line.\n    vec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));\n    approxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\n    v_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n',Ek="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 prevPosition3DHigh;\nin vec3 prevPosition3DLow;\nin vec3 nextPosition3DHigh;\nin vec3 nextPosition3DLow;\nin vec2 expandAndWidth;\nin vec2 st;\nin float batchId;\n\nout float v_width;\nout vec2 v_st;\nout float v_polylineAngle;\n\nvoid main()\n{\n    float expandDir = expandAndWidth.x;\n    float width = abs(expandAndWidth.y) + 0.5;\n    bool usePrev = expandAndWidth.y < 0.0;\n\n    vec4 p = czm_computePosition();\n    vec4 prev = czm_computePrevPosition();\n    vec4 next = czm_computeNextPosition();\n\n    float angle;\n    vec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\n    gl_Position = czm_viewportOrthographic * positionWC;\n\n    v_width = width;\n    v_st.s = st.s;\n    v_st.t = czm_writeNonPerspective(st.t, gl_Position.w);\n    v_polylineAngle = angle;\n}\n",Tj=`${of}\n${Ek}`,get=MA;function Ex(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.translucent,!0),i=Ex.VERTEX_FORMAT;this.material=u(e.material)?e.material:Wi.fromType(Wi.ColorType),this.translucent=t,this._vertexShaderSource=y(e.vertexShaderSource,Tj),this._fragmentShaderSource=y(e.fragmentShaderSource,get),this._renderState=no.getDefaultRenderState(t,false,e.renderState),this._closed=false,this._vertexFormat=i}Bt.isInternetExplorer()||(Tj=`#define CLIP_POLYLINE \n${Tj}`),Object.defineProperties(Ex.prototype,{vertexShaderSource:{get:function(){let e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/in\s+float\s+v_polylineAngle;/g)&&(e=`#define POLYLINE_DASH\n${e}`),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),Ex.VERTEX_FORMAT=Pe.POSITION_AND_ST,Ex.prototype.getFragmentShaderSource=no.prototype.getFragmentShaderSource,Ex.prototype.isTranslucent=no.prototype.isTranslucent,Ex.prototype.getRenderState=no.prototype.getRenderState;var fa=Ex;function Up(e){e=y(e,y.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;let t=e.appearance;u(t)||(t=new fa),this.appearance=t,this.show=y(e.show,!0),this.classificationType=y(e.classificationType,zn.BOTH),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=y(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:y(e.interleave,!1),releaseGeometryInstances:y(e.releaseGeometryInstances,!0),allowPicking:y(e.allowPicking,!0),asynchronous:y(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1,this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=fde(!1),this._renderState3DTiles=fde(!0),this._renderStateMorph=Ue.fromCache({cull:{enabled:!0,face:gi.FRONT},depthTest:{enabled:!0},blending:ln.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1})}function yet(e,t,i){let n=t.context,r=e._primitive,o=r._attributeLocations,a=r._batchTable.getVertexShaderCallback()(Ck);a=Sn._appendShowToShader(r,a),a=Sn._appendDistanceDisplayConditionToShader(r,a),a=Sn._modifyShaderPosition(e,a,t.scene3DOnly);let s=r._batchTable.getVertexShaderCallback()(Ak);s=Sn._appendShowToShader(r,s),s=Sn._appendDistanceDisplayConditionToShader(r,s),s=Sn._modifyShaderPosition(e,s,t.scene3DOnly);let l=r._batchTable.getVertexShaderCallback()(bk),c=[`GLOBE_MINIMUM_ALTITUDE ${t.mapProjection.ellipsoid.minimumRadius.toFixed(1)}`],h="",d="";u(i.material)?(d=u(i.material)?i.material.shaderSource:"",-1!==d.search(/in\s+float\s+v_polylineAngle;/g)&&c.push("ANGLE_VARYING"),-1!==d.search(/in\s+float\s+v_width;/g)&&c.push("WIDTH_VARYING")):h="PER_INSTANCE_COLOR",c.push(h);let p=e.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",h]:[h],f=new He({defines:c,sources:[a]}),m=new He({defines:p,sources:[d,l]});e._sp=Kt.replaceCache({context:n,shaderProgram:r._sp,vertexShaderSource:f,fragmentShaderSource:m,attributeLocations:o});let _=n.shaderCache.getDerivedShaderProgram(e._sp,"2dColor");if(!u(_)){let t=new He({defines:c.concat(["COLUMBUS_VIEW_2D"]),sources:[a]});_=n.shaderCache.createDerivedShaderProgram(e._sp,"2dColor",{context:n,shaderProgram:e._sp2D,vertexShaderSource:t,fragmentShaderSource:m,attributeLocations:o})}e._sp2D=_;let g=n.shaderCache.getDerivedShaderProgram(e._sp,"MorphColor");if(!u(g)){let t=new He({defines:c.concat([`MAX_TERRAIN_HEIGHT ${li._defaultMaxTerrainHeight.toFixed(1)}`]),sources:[s]});l=r._batchTable.getVertexShaderCallback()(Tk);let i=new He({defines:p,sources:[d,l]});g=n.shaderCache.createDerivedShaderProgram(e._sp,"MorphColor",{context:n,shaderProgram:e._spMorph,vertexShaderSource:t,fragmentShaderSource:i,attributeLocations:o})}e._spMorph=g}function fde(e){return Ue.fromCache({cull:{enabled:!0},blending:ln.PRE_MULTIPLIED_ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:Un.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:Un.EQUAL,backOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},reference:Lt.CESIUM_3D_TILE_MASK,mask:Lt.CESIUM_3D_TILE_MASK}})}function xet(e,t,i,n,r,o){let a=e._primitive,s=a._va.length;r.length=s,o.length=s;let l=t instanceof qr?{}:i._uniforms,c=a._batchTable.getUniformMapCallback()(l);for(let t=0;t<s;t++){let i=a._va[t],n=r[t];u(n)||(n=r[t]=new et({owner:e,primitiveType:a._primitiveType})),n.vertexArray=i,n.renderState=e._renderState,n.shaderProgram=e._sp,n.uniformMap=c,n.pass=Ee.TERRAIN_CLASSIFICATION,n.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";let o=et.shallowClone(n,n.derivedCommands.tileset);o.renderState=e._renderState3DTiles,o.pass=Ee.CESIUM_3D_TILE_CLASSIFICATION,n.derivedCommands.tileset=o;let s=et.shallowClone(n,n.derivedCommands.color2D);s.shaderProgram=e._sp2D,n.derivedCommands.color2D=s;let l=et.shallowClone(o,o.derivedCommands.color2D);l.shaderProgram=e._sp2D,o.derivedCommands.color2D=l;let h=et.shallowClone(n,n.derivedCommands.colorMorph);h.renderState=e._renderStateMorph,h.shaderProgram=e._spMorph,h.pickId="czm_batchTable_pickColor(v_batchId)",n.derivedCommands.colorMorph=h}}function dde(e,t,i,n,r,o,a){i.mode===te.MORPHING?t=t.derivedCommands.colorMorph:i.mode!==te.SCENE3D&&(t=t.derivedCommands.color2D),t.modelMatrix=n,t.boundingVolume=o,t.cull=r,t.debugShowBoundingVolume=a,i.commandList.push(t)}function bet(e,t,i,n,r,o,a){let s,l=e._primitive;Sn._updateBoundingVolumes(l,t,r),t.mode===te.SCENE3D?s=l._boundingSphereWC:t.mode===te.COLUMBUS_VIEW?s=l._boundingSphereCV:t.mode===te.SCENE2D&&u(l._boundingSphere2D)?s=l._boundingSphere2D:u(l._boundingSphereMorph)&&(s=l._boundingSphereMorph);let c,h=t.mode===te.MORPHING,d=e.classificationType,p=d!==zn.CESIUM_3D_TILE,f=d!==zn.TERRAIN&&!h,m=t.passes;if(m.render||m.pick&&l.allowPicking){let n=i.length;for(let l=0;l<n;++l){let n=s[l];p&&(c=i[l],dde(e,c,t,r,o,n,a)),f&&(c=i[l].derivedCommands.tileset,dde(e,c,t,r,o,n,a))}}}Object.defineProperties(Up.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}}),Up.initializeTerrainHeights=function(){return li.initialize()},Up.prototype.update=function(e){if(!u(this._primitive)&&!u(this.geometryInstances))return;if(!li.initialized)return void Up.initializeTerrainHeights();let t,i=this,n=this._primitiveOptions;if(!u(this._primitive)){let r,o=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],a=o.length,s=new Array(a);for(t=0;t<a;++t)if(r=o[t].attributes,!u(r)||!u(r.color)){this._hasPerInstanceColors=!1;break}for(t=0;t<a;++t){let n=o[t];r={};let a=n.attributes;for(let e in a)a.hasOwnProperty(e)&&(r[e]=a[e]);u(r.width)||(r.width=new hc({componentDatatype:X.UNSIGNED_BYTE,componentsPerAttribute:1,value:[n.geometry.width]})),n.geometry._scene3DOnly=e.scene3DOnly,AT.setProjectionAndEllipsoid(n.geometry,e.mapProjection),s[t]=new yt({geometry:n.geometry,attributes:r,id:n.id,pickPrimitive:i})}n.geometryInstances=s,n.appearance=this.appearance,n._createShaderProgramFunction=function(e,t,n){yet(i,t,n)},n._createCommandsFunction=function(e,t,n,r,o,a,s){xet(i,t,n,r,a,s)},n._updateAndQueueCommandsFunction=function(e,t,n,r,o,a,s,l){bet(i,t,n,r,o,a,s)},this._primitive=new Sn(n)}if(this.appearance instanceof qr&&!this._hasPerInstanceColors)throw new de("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push((()=>{!this._ready&&u(this._primitive)&&this._primitive.ready&&(this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0))}))},Up.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)},Up.isSupported=function(e){return e.frameState.context.depthTexture},Up.prototype.isDestroyed=function(){return!1},Up.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,le(this)};var $h=Up,Tet={u_globeMinimumAltitude:function(){return 55e3}};function ml(e){let t=(e=y(e,y.EMPTY_OBJECT)).appearance,i=e.geometryInstances;if(!u(t)&&u(i)){let e=Array.isArray(i)?i:[i],n=e.length;for(let i=0;i<n;i++){let n=e[i].attributes;if(u(n)&&u(n.color)){t=new rn({flat:!0});break}}}this.appearance=t,this.geometryInstances=e.geometryInstances,this.show=y(e.show,!0),this.classificationType=y(e.classificationType,zn.BOTH),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=y(e.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1,this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=li._defaultMaxTerrainHeight,this._minTerrainHeight=li._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[],this._useFragmentCulling=!1,this._zIndex=void 0;this._classificationPrimitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:y(e.vertexCacheOptimize,!1),interleave:y(e.interleave,!1),releaseGeometryInstances:y(e.releaseGeometryInstances,!0),allowPicking:y(e.allowPicking,!0),asynchronous:y(e.asynchronous,!0),compressVertices:y(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:this,_extruded:!0,_uniformMap:Tet}}function hde(e){return function(t,i){let n=i.maximumRadius,r=n/Math.cos(.5*t)-n;return e._maxHeight+r}}function mde(e){return function(t,i){return e._minHeight}}Object.defineProperties(ml.prototype,{vertexCacheOptimize:{get:function(){return this._classificationPrimitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._classificationPrimitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._classificationPrimitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._classificationPrimitiveOptions.allowPicking}},asynchronous:{get:function(){return this._classificationPrimitiveOptions.asynchronous}},compressVertices:{get:function(){return this._classificationPrimitiveOptions.compressVertices}},ready:{get:function(){return this._ready}}}),ml.isSupported=bv.isSupported;var Aet=new h,Cet=new h,Eet=new h,wet=new fe,vet=new ce;function Sk(e,t){let i=e.mapProjection.ellipsoid;if(!u(t.attributes)||!u(t.attributes.position3DHigh))return u(t.rectangle)?t.rectangle:void 0;let n=t.attributes.position3DHigh.values,r=t.attributes.position3DLow.values,o=n.length,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e+=3){let t=h.unpack(n,e,Aet),o=h.unpack(r,e,Cet),u=h.add(t,o,Eet),d=i.cartesianToCartographic(u,wet),p=d.latitude,f=d.longitude;a=Math.min(a,p),s=Math.min(s,f),l=Math.max(l,p),c=Math.max(c,f)}let d=vet;return d.north=l,d.south=a,d.east=c,d.west=s,d}function Det(e,t,i){let n=li.getMinimumMaximumHeights(t,i);e._minTerrainHeight=n.minimumTerrainHeight,e._maxTerrainHeight=n.maximumTerrainHeight}function Iet(e,t,i){let n=t.mapProjection.ellipsoid,r=Sk(t,i),o=Pn.fromRectangle(r,e._minHeight,e._maxHeight,n);if(e._boundingVolumes.push(o),!t.scene3DOnly){let i=t.mapProjection,n=se.fromRectangleWithHeights2D(r,i,e._maxHeight,e._minHeight);h.fromElements(n.center.z,n.center.x,n.center.y,n.center),e._boundingVolumes2D.push(n)}}function Aj(e,t){return Math.floor(e%t/2)}function Cj(e,t,i,n,r,o,a){let s=e._primitive;i.mode!==te.SCENE3D&&t.shaderProgram===s._spColor&&s._needs2DShader&&(t=t.derivedCommands.appearance2D),t.owner=e,t.modelMatrix=n,t.boundingVolume=o,t.cull=r,t.debugShowBoundingVolume=a,i.commandList.push(t)}function pde(e,t,i,n,r,o){let a=e._primitive;i.mode!==te.SCENE3D&&t.shaderProgram===a._spPick&&a._needs2DShader&&(t=t.derivedCommands.pick2D),t.owner=e,t.modelMatrix=n,t.boundingVolume=o,t.cull=r,i.commandList.push(t)}function Pet(e,t,i,n,r,o,a,s){let l;l=t.mode===te.SCENE3D?e._boundingVolumes:e._boundingVolumes2D;let u,c,h,d=e.classificationType,p=d!==zn.CESIUM_3D_TILE,f=d!==zn.TERRAIN,m=t.passes,_=e._primitive;if(m.render){let n=i.length;for(u=0;u<n;++u)c=l[Aj(u,n)],p&&(h=i[u],Cj(e,h,t,r,o,c,a)),f&&(h=i[u].derivedCommands.tileset,Cj(e,h,t,r,o,c,a));if(t.invertClassification){let i=_._commandsIgnoreShow,n=i.length;for(u=0;u<n;++u)c=l[u],h=i[u],Cj(e,h,t,r,o,c,a)}}if(m.pick){let i,a=n.length;for(e._useFragmentCulling||(i=_._primitive._pickOffsets),u=0;u<a;++u){if(c=l[Aj(u,a)],!e._useFragmentCulling){c=l[i[Aj(u,a)].index]}p&&(h=n[u],pde(e,h,t,r,o,c)),f&&(h=n[u].derivedCommands.tileset,pde(e,h,t,r,o,c))}}}ml.initializeTerrainHeights=function(){return li.initialize()},ml.prototype.update=function(e){if(!u(this._primitive)&&!u(this.geometryInstances))return;if(!li.initialized)return void ml.initializeTerrainHeights();let t=this,i=this._classificationPrimitiveOptions;if(!u(this._primitive)){let n,r,o,a,s,l=e.mapProjection.ellipsoid,c=Array.isArray(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],h=c.length,d=new Array(h);for(a=0;a<h;++a){n=c[a],r=n.geometry;let t=Sk(e,r);u(s)?u(t)&&ce.union(s,t,s):s=ce.clone(t);let i=n.id;if(u(i)&&u(t)){let e=li.getBoundingSphere(t,l);this._boundingSpheresKeys.push(i),this._boundingSpheres.push(e)}o=r.constructor,!u(o)||u(o.createShadowVolume)}Det(this,s,l);let p=e.terrainExaggeration,f=e.terrainExaggerationRelativeHeight;this._minHeight=Wc.getHeight(this._minTerrainHeight,p,f),this._maxHeight=Wc.getHeight(this._maxTerrainHeight,p,f);let m=ml._supportsMaterials(e.context);if(this._useFragmentCulling=m,m){let t,i=!0;for(a=0;a<h;++a)if(n=c[a],r=n.geometry,s=Sk(e,r),lf.shouldUseSphericalCoordinates(s)){i=!1;break}for(a=0;a<h;++a){n=c[a],r=n.geometry,o=r.constructor;let s=Sk(e,r),u=r.textureCoordinateRotationPoints;t=i?lf.getPlanarTextureCoordinateAttributes(s,u,l,e.mapProjection,this._maxHeight):lf.getSphericalExtentGeometryInstanceAttributes(s,u,l,e.mapProjection);let h=n.attributes;for(let e in h)h.hasOwnProperty(e)&&(t[e]=h[e]);d[a]=new yt({geometry:o.createShadowVolume(r,mde(this),hde(this)),attributes:t,id:n.id})}}else for(a=0;a<h;++a)n=c[a],r=n.geometry,o=r.constructor,d[a]=new yt({geometry:o.createShadowVolume(r,mde(this),hde(this)),attributes:n.attributes,id:n.id});i.geometryInstances=d,i.appearance=this.appearance,i._createBoundingVolumeFunction=function(e,i){Iet(t,e,i)},i._updateAndQueueCommandsFunction=function(e,i,n,r,o,a,s,l){Pet(t,i,n,r,o,a,s,l)},this._primitive=new bv(i)}this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),e.afterRender.push((()=>{!this._ready&&u(this._primitive)&&this._primitive.ready&&(this._ready=!0,this.releaseGeometryInstances&&(this.geometryInstances=void 0))}))},ml.prototype.getBoundingSphere=function(e){let t=this._boundingSpheresKeys.indexOf(e);if(-1!==t)return this._boundingSpheres[t]},ml.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)},ml.prototype.isDestroyed=function(){return!1},ml.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),le(this)},ml._supportsMaterials=function(e){return e.depthTexture},ml.supportsMaterials=function(e){return ml._supportsMaterials(e.frameState.context)};var pl=ml;function Ed(){}async function Oet(){if(await Ed._decodeTaskProcessor.initWebAssemblyModule({wasmBinaryFile:"ThirdParty/draco_decoder.wasm"}))return Ed._decodeTaskProcessor;throw new ue("I3S decoder could not be initialized.")}Ed._maxDecodingConcurrency=Math.max(Bt.hardwareConcurrency-1,1),Ed._decodeTaskProcessor=new pi("decodeI3S",Ed._maxDecodingConcurrency),Ed._promise=void 0,Ed.decode=async function(e,t,i,n){return u(Ed._promise)||(Ed._promise=Oet()),Ed._promise.then((function(r){let o=i._parent._data,a=i._parent._inverseRotationMatrix,s=0,l=0,c=0;u(o.obb)?(s=o.obb.center[0],l=o.obb.center[1],c=o.obb.center[2]):u(o.mbs)&&(s=o.mbs[0],l=o.mbs[1],c=o.mbs[2]);let h=$.fromRotationX(-P.PI_OVER_TWO),d=new $;$.multiply(h,a,d);let p=fe.fromDegrees(s,l,c),f=ie.WGS84.cartographicToCartesian(p),m={binaryData:i._data,featureData:u(n)&&u(n[0])?n[0].data:void 0,schema:t,bufferInfo:i._geometryBufferInfo,ellipsoidRadiiSquare:ie.WGS84.radiiSquared,url:e,geoidDataList:i._dataProvider._geoidDataList,cartographicCenter:p,cartesianCenter:f,parentRotation:d};return r.scheduleTask(m)}))};var wk=Ed;function Ej(e,t){this._parent=e,this._dataProvider=e._dataProvider,this._layer=e._layer,u(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${t}`}):this._resource=this._parent.resource.getDerivedResource({url:t})}Object.defineProperties(Ej.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}}}),Ej.prototype.load=async function(){return this._data=await hC.loadJson(this._resource,this._dataProvider._traceFetches),this._data};var vk=Ej;function mC(e,t){this._storageInfo=t,this._parent=e,this._dataProvider=e._dataProvider;let i=`attributes/${t.key}/0`;u(this._parent._nodeIndex)?this._resource=this._parent._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.attribute.resource}/${i}`}):this._resource=this._parent.resource.getDerivedResource({url:i})}function Ret(e){return"UInt8"===e||"Int8"===e?1:"UInt16"===e||"Int16"===e?2:"UInt32"===e||"Int32"===e||"Oid32"===e||"Float32"===e?4:"UInt64"===e||"Int64"===e||"Float64"===e?8:0}Object.defineProperties(mC.prototype,{resource:{get:function(){return this._resource}},header:{get:function(){return this._header}},values:{get:function(){return u(this._values)&&u(this._values.attributeValues)?this._values.attributeValues:[]}},name:{get:function(){return this._storageInfo.name}}}),mC.prototype.load=function(){let e=this;return this._dataProvider._loadBinary(this._resource).then((function(t){let i=new DataView(t),n=!0;if(i.getUint8(0)==="{".charCodeAt(0)&&(new TextDecoder).decode(t).includes("404")&&(n=!1,console.error(`Failed to load: ${e.resource.url}`)),n){e._data=t;let n=e._parseHeader(i),r=Ret(e._storageInfo.attributeValues.valueType);r>0&&(n=Math.ceil(n/r)*r),e._parseBody(i,n)}}))},mC.prototype._parseValue=function(e,t,i){let n;if("UInt8"===t)n=e.getUint8(i),i+=1;else if("Int8"===t)n=e.getInt8(i),i+=1;else if("UInt16"===t)n=e.getUint16(i,!0),i+=2;else if("Int16"===t)n=e.getInt16(i,!0),i+=2;else if("UInt32"===t)n=e.getUint32(i,!0),i+=4;else if("Oid32"===t)n=e.getUint32(i,!0),i+=4;else if("Int32"===t)n=e.getInt32(i,!0),i+=4;else if("UInt64"===t){let t=e.getUint32(i,!0),r=e.getUint32(i+4,!0);n=t+Math.pow(2,32)*r,i+=8}else if("Int64"===t){let t=e.getUint32(i,!0),r=e.getUint32(i+4,!0);n=r<Math.pow(2,31)?t+Math.pow(2,32)*r:t+Math.pow(2,32)*(r-Math.pow(2,32)),i+=8}else"Float32"===t?(n=e.getFloat32(i,!0),i+=4):"Float64"===t?(n=e.getFloat64(i,!0),i+=8):"String"===t&&(n=String.fromCharCode(e.getUint8(i)),i+=1);return{value:n,offset:i}},mC.prototype._parseHeader=function(e){let t=0;this._header={};for(let i=0;i<this._storageInfo.header.length;i++){let n=this._storageInfo.header[i],r=this._parseValue(e,n.valueType,t);this._header[n.property]=r.value,t=r.offset}return t},mC.prototype._parseBody=function(e,t){this._values={};for(let i=0;i<this._storageInfo.ordering.length;i++){let n=this._storageInfo.ordering[i],r=this._storageInfo[n];if(u(r)){this._values[n]=[];for(let i=0;i<this._header.count;++i)if("String"!==r.valueType){let i=this._parseValue(e,r.valueType,t);this._values[n].push(i.value),t=i.offset}else{let o=this._values.attributeByteCounts[i],a="";for(let i=0;i<o;++i){let i=this._parseValue(e,r.valueType,t);0!==i.value.charCodeAt(0)&&(a+=i.value),t=i.offset}this._values[n].push(a)}}}};var Dk=mC;function Gv(e,t){let i,n=e._dataProvider,r=e._layer;i=u(e._nodeIndex)?r.resource.getDerivedResource({url:`nodes/${e._data.mesh.geometry.resource}/${t}`}):e.resource.getDerivedResource({url:t}),this._parent=e,this._dataProvider=n,this._layer=r,this._resource=i,this._customAttributes=void 0}Object.defineProperties(Gv.prototype,{resource:{get:function(){return this._resource}},data:{get:function(){return this._data}},customAttributes:{get:function(){return this._customAttributes}}}),Gv.prototype.load=function(){let e=this;return this._dataProvider._loadBinary(this._resource).then((function(t){return e._data=t,t}))};var Met=new h,Let=new h,Net=new h,Fet=new h,Bet=new h;function Sj(e,t,i,n){let r=h.subtract(n,i,Met),o=h.cross(r,h.subtract(e,i,Let),Fet),a=h.cross(r,h.subtract(t,i,Net),Bet);return h.dot(o,a)>=0}var ket=new h,Vet=new h,Uet=new h,zet=new h,Het=new h,Get=new h,Wet=new h,jet=new h,qet=new h,Yet=new h;Gv.prototype.getClosestPointIndexOnTriangle=function(e,t,i){if(u(this._customAttributes)&&u(this._customAttributes.positions)){let n=new h(e,t,i);n.x-=this._customAttributes.cartesianCenter.x,n.y-=this._customAttributes.cartesianCenter.y,n.z-=this._customAttributes.cartesianCenter.z,$.multiplyByVector(this._customAttributes.parentRotation,n,n);let r,o,a,s,l,c=Number.MAX_VALUE,d=this._customAttributes.positions,p=this._customAttributes.indices;l=u(p)?p.length:d.length/3;for(let e=0;e<l;e++){let t,i,l;u(p)?(t=p[e],i=p[e+1],l=p[e+2]):(t=3*e,i=3*e+1,l=3*e+2);let f=h.fromElements(d[3*t],d[3*t+1],d[3*t+2],ket),m=h.fromElements(d[3*i],d[3*i+1],d[3*i+2],Vet),_=new h(d[3*l],d[3*l+1],d[3*l+2],Uet);if(!Sj(n,f,m,_)||!Sj(n,m,f,_)||!Sj(n,_,f,m))continue;let g=h.subtract(m,f,zet),y=h.subtract(_,f,Het),v=h.cross(g,y,Get);if(0===h.magnitude(v))continue;let b=h.normalize(v,Wet),A=h.subtract(n,f,jet),T=Math.abs(h.dot(A,b));if(T<c){c=T,r=e;let u=h.magnitudeSquared(h.subtract(n,f,A)),d=h.magnitudeSquared(h.subtract(n,m,qet)),p=h.magnitudeSquared(h.subtract(n,_,Yet));u<d&&u<p?(a=t,s=f,o=u):d<p?(a=i,s=m,o=d):(a=l,s=_,o=p)}}if(u(r))return{index:a,distanceSquared:o,distance:Math.sqrt(o),queriedPosition:n,closestPosition:h.clone(s)}}return{index:-1,distanceSquared:Number.Infinity,distance:Number.Infinity}},Gv.prototype._generateGltf=function(e,t,i,n,r,o){let a,s={pbrMetallicRoughness:{metallicFactor:0},doubleSided:!0,name:"Material"},l=!1,c="";if(u(this._parent._data.mesh)&&u(this._layer._data.materialDefinitions)){let e=this._parent._data.mesh.material.definition;if(e>=0&&e<this._layer._data.materialDefinitions.length&&(a=this._layer._data.materialDefinitions[e],s=a,u(s.pbrMetallicRoughness)&&u(s.pbrMetallicRoughness.baseColorTexture))){l=!0,s.pbrMetallicRoughness.baseColorTexture.index=0;let e="0";if(u(this._layer._data.textureSetDefinitions))for(let t=0;t<this._layer._data.textureSetDefinitions.length;t++){let i=this._layer._data.textureSetDefinitions[t];for(let t=0;t<i.formats.length;t++){let n=i.formats[t];if("jpg"===n.format){e=n.name;break}}}u(this._parent._data.mesh)&&this._parent._data.mesh.material.resource>=0&&(c=this._layer.resource.getDerivedResource({url:`nodes/${this._parent._data.mesh.material.resource}/textures/${e}`}).url)}}else u(this._parent._data.textureData)&&(l=!0,c=this._parent.resource.getDerivedResource({url:`${this._parent._data.textureData[0].href}`}).url,s.pbrMetallicRoughness.baseColorTexture={index:0});let h=[],d=[],p=[];return l&&(h=[{sampler:0,source:0}],d=[{uri:c}],p=[{magFilter:9729,minFilter:9986,wrapS:10497,wrapT:10497}]),{scene:0,scenes:[{nodes:e}],nodes:t,meshes:i,buffers:n,bufferViews:r,accessors:o,materials:[s],textures:h,images:d,samplers:p,asset:{version:"2.0"}}};var Wv=Gv;function eu(e,t,i){let n,r,o,a;i?(n=0,r=e):(n=e._level+1,r=e._layer),"number"==typeof t?o=t:a=e.resource.getDerivedResource({url:`${t}/`}),this._parent=e,this._dataProvider=e._dataProvider,this._isRoot=i,this._level=n,this._layer=r,this._nodeIndex=o,this._resource=a,this._isLoading=!1,this._tile=void 0,this._data=void 0,this._geometryData=[],this._featureData=[],this._fields={},this._children=[],this._childrenReadyPromise=void 0,this._globalTransform=void 0,this._inverseGlobalTransform=void 0,this._inverseRotationMatrix=void 0}function Xet(e,t,i,n,r,o){return(i*(1-e)+n*e)*(1-t)+(r*(1-e)+o*e)*t}function Ik(e,t,i,n){return n[e+t*i]}function Ket(e,t,i){let n=i.nativeExtent,r=(e-n.west)/(n.east-n.west)*(i.width-1),o=(t-n.south)/(n.north-n.south)*(i.height-1),a=Math.floor(r),s=Math.floor(o);r-=a,o-=s;let l=a<i.width?a+1:a,u=s<i.height?s+1:s;s=i.height-1-s,u=i.height-1-u;let c=Xet(r,o,Ik(a,s,i.width,i.buffer),Ik(l,s,i.width,i.buffer),Ik(a,u,i.width,i.buffer),Ik(l,u,i.width,i.buffer));return c=c*i.scale+i.offset,c}Object.defineProperties(eu.prototype,{resource:{get:function(){return this._resource}},layer:{get:function(){return this._layer}},parent:{get:function(){return this._parent}},children:{get:function(){return this._children}},geometryData:{get:function(){return this._geometryData}},featureData:{get:function(){return this._featureData}},fields:{get:function(){return this._fields}},tile:{get:function(){return this._tile}},data:{get:function(){return this._data}}}),eu.prototype.load=async function(){let e=this;function t(){if(!e._isRoot){let t=e._create3DTileDefinition();e._tile=new _d(e._layer._tileset,e._dataProvider.resource,t,e._parent._tile),e._tile._i3sNode=e}}if(!u(this._nodeIndex)){let i=await hC.loadJson(this._resource,this._dataProvider._traceFetches);return e._data=i,void t()}let i,n=await this._layer._getNodeInNodePages(this._nodeIndex);e._data=n,e._isRoot?i="nodes/root/":u(n.mesh)&&(i=`../${n.mesh.geometry.resource}/`),u(i)&&(e._resource=e._parent.resource.getDerivedResource({url:i})),t()},eu.prototype.loadFields=function(){let e=this._layer._data.attributeStorageInfo,t=this;function i(e,i){let n=new Dk(t,e[i]);return t._fields[n._storageInfo.name]=n,n.load()}let n=[];if(u(e))for(let t=0;t<e.length;t++)n.push(i(e,t));return Promise.all(n)},eu.prototype.getFieldsForPickedPosition=function(e){let t=this.geometryData[0];if(!u(t.customAttributes.featureIndex))return{};let i=t.getClosestPointIndexOnTriangle(e.x,e.y,e.z);if(-1===i.index||i.index>t.customAttributes.featureIndex.length)return{};let n=t.customAttributes.featureIndex[i.index];return this.getFieldsForFeature(n)},eu.prototype.getFieldsForFeature=function(e){let t={};for(let i in this.fields)if(this.fields.hasOwnProperty(i)){let n=this.fields[i];e>=0&&e<n.values.length&&(t[n.name]=n.values[e])}return t},eu.prototype._loadChildren=function(){let e=this;if(u(this._childrenReadyPromise))return this._childrenReadyPromise;let t=[];if(u(e._data.children))for(let i=0;i<e._data.children.length;i++){let n=e._data.children[i],r=new eu(e,y(n.href,n),!1);e._children.push(r),t.push(r.load())}return this._childrenReadyPromise=Promise.all(t).then((function(){for(let t=0;t<e._children.length;t++)e._tile.children.push(e._children[t]._tile)})),this._childrenReadyPromise},eu.prototype._loadGeometryData=function(){let e=[];if(u(this._data.geometryData))for(let t=0;t<this._data.geometryData.length;t++){let i=new Wv(this,this._data.geometryData[t].href);this._geometryData.push(i),e.push(i.load())}else if(u(this._data.mesh)){let t=this._layer._findBestGeometryBuffers(this._data.mesh.geometry.definition,["position","uv0"]),i=`./geometries/${t.bufferIndex}/`,n=new Wv(this,i);n._geometryDefinitions=t.definition,n._geometryBufferInfo=t.geometryBufferInfo,this._geometryData.push(n),e.push(n.load())}return Promise.all(e)},eu.prototype._loadFeatureData=function(){let e=[];if(u(this._data.featureData))for(let t=0;t<this._data.featureData.length;t++){let i=new vk(this,this._data.featureData[t].href);this._featureData.push(i),e.push(i.load())}return Promise.all(e)},eu.prototype._clearGeometryData=function(){this._geometryData=[]},eu.prototype._create3DTileDefinition=function(){let e,t=this._data.obb,i=this._data.mbs;if(!u(t)&&!u(i))return void console.error("Failed to load I3S node. Bounding volume is required.");if(e=u(t)?fe.fromDegrees(t.center[0],t.center[1],t.center[2]):fe.fromDegrees(i[0],i[1],i[2]),u(this._dataProvider._geoidDataList)&&u(e))for(let t=0;t<this._dataProvider._geoidDataList.length;t++){let i=this._dataProvider._geoidDataList[t],n=i.projection.project(e);if(n.x>i.nativeExtent.west&&n.x<i.nativeExtent.east&&n.y>i.nativeExtent.south&&n.y<i.nativeExtent.north){e.height+=Ket(n.x,n.y,i);break}}let n,r={},o=0;u(t)?(r={box:[0,0,0,t.halfSize[0],0,0,0,t.halfSize[1],0,0,0,t.halfSize[2]]},o=Math.max(Math.max(this._data.obb.halfSize[0],this._data.obb.halfSize[1]),this._data.obb.halfSize[2]),n=ie.WGS84.cartographicToCartesian(e)):(r={sphere:[0,0,0,i[3]]},n=ie.WGS84.cartographicToCartesian(e),o=this._data.mbs[3]),o*=2;let a=1/0;if(u(this._data.lodThreshold))if("maxScreenThresholdSQ"===this._layer._data.nodePages.lodSelectionMetricType){a=o/Math.sqrt(this._data.lodThreshold/(.25*Math.PI))}else if("maxScreenThreshold"===this._layer._data.nodePages.lodSelectionMetricType){a=o/this._data.lodThreshold}else console.error("Invalid lodSelectionMetricType in Layer");else if(u(this._data.lodSelection))for(let e=0;e<this._data.lodSelection.length;e++)"maxScreenThreshold"===this._data.lodSelection[e].metricType&&(a=o/this._data.lodSelection[e].maxError);a===1/0&&(a=1e5);let s=16*a,l=new oc(0,0,0),c=Rt.headingPitchRollQuaternion(n,l);u(this._data.obb)&&(c=new Le(this._data.obb.quaternion[0],this._data.obb.quaternion[1],this._data.obb.quaternion[2],this._data.obb.quaternion[3]));let h=$.fromQuaternion(c),d=$.inverse(h,new $),p=new L(h[0],h[1],h[2],0,h[3],h[4],h[5],0,h[6],h[7],h[8],0,n.x,n.y,n.z,1),f=L.inverse(p,new L),m=L.clone(p);u(this._parent._globalTransform)&&L.multiply(p,this._parent._inverseGlobalTransform,m),this._globalTransform=p,this._inverseGlobalTransform=f,this._inverseRotationMatrix=d;let _=[];for(let e=0;e<this._children.length;e++)_.push(this._children[e]._create3DTileDefinition());return{children:_,refine:"REPLACE",boundingVolume:r,transform:[m[0],m[4],m[8],m[12],m[1],m[5],m[9],m[13],m[2],m[6],m[10],m[14],m[3],m[7],m[11],m[15]],content:{uri:u(this._resource)?this._resource.url:void 0},geometricError:s}},eu.prototype._createContentURL=async function(){let e={scene:0,scenes:[{nodes:[0]}],nodes:[{name:"singleNode"}],meshes:[],buffers:[],bufferViews:[],accessors:[],materials:[],textures:[],images:[],samplers:[],asset:{version:"2.0"}},t=[this._loadGeometryData()];if(this._dataProvider.legacyVersion16&&t.push(this._loadFeatureData()),await Promise.all(t),u(this._geometryData)&&this._geometryData.length>0){let t=this._geometryData[0].resource.url,i=this._layer._data.store.defaultGeometrySchema,n=this._geometryData[0],r=await wk.decode(t,i,n,this._featureData[0]);if(!u(r))return;e=n._generateGltf(r.meshData.nodesInScene,r.meshData.nodes,r.meshData.meshes,r.meshData.buffers,r.meshData.bufferViews,r.meshData.accessors),this._geometryData[0]._customAttributes=r.meshData._customAttributes}let i=this._dataProvider._binarizeGltf(e),n=new Blob([i],{type:"application/binary"});return URL.createObjectURL(n)},_d.prototype._hookedRequestContent=_d.prototype.requestContent,_d.prototype.requestContent=function(){return this.tileset._isI3STileSet?this._isLoading?void 0:(this._isLoading=!0,this._i3sNode._createContentURL().then((e=>{if(u(e))return this._contentResource=new ve({url:e}),this._hookedRequestContent();this._isLoading=!1})).then((e=>(this._isLoading=!1,e)))):this._hookedRequestContent()},Object.defineProperties(_d.prototype,{i3sNode:{get:function(){return this._i3sNode}}});var jv=eu;function mf(e,t,i){this._dataProvider=e,!u(t.href)&&u(i)&&(t.href=`layers/${i}`);let n=this._dataProvider.resource.getUrlComponent(),r="";r=n.match(/layers\/\d/)?`${n}`.replace(/\/+$/,""):`${n}`.replace(/\/?$/,"/").concat(`${t.href}`),this._version=t.store.version;let o=this._version.split(".");this._majorVersion=parseInt(o[0]),this._minorVersion=o.length>1?parseInt(o[1]):0,this._resource=new ve({url:r}),this._resource.setQueryParameters(this._dataProvider.resource.queryParameters),this._resource.appendForwardSlash(),this._data=t,this._rootNode=void 0,this._nodePages={},this._nodePageFetches={},this._extent=void 0,this._tileset=void 0,this._geometryDefinitions=void 0,this._computeGeometryDefinitions(!0),this._computeExtent()}Object.defineProperties(mf.prototype,{resource:{get:function(){return this._resource}},rootNode:{get:function(){return this._rootNode}},tileset:{get:function(){return this._tileset}},data:{get:function(){return this._data}},version:{get:function(){return this._version}},majorVersion:{get:function(){return this._majorVersion}},minorVersion:{get:function(){return this._minorVersion}},legacyVersion16:{get:function(){if(u(this.version))return this.majorVersion<1||1===this.majorVersion&&this.minorVersion<=6}}}),mf.prototype.load=async function(e){if(4326!==this._data.spatialReference.wkid)throw new ue(`Unsupported spatial reference: ${this._data.spatialReference.wkid}`);if(await this._dataProvider.loadGeoidData(),await this._loadRootNode(e),await this._create3DTileset(e),this._rootNode._tile=this._tileset._root,this._tileset._root._i3sNode=this._rootNode,this.legacyVersion16)return this._rootNode._loadChildren()},mf.prototype._computeGeometryDefinitions=function(e){if(this._geometryDefinitions=[],u(this._data.geometryDefinitions))for(let t=0;t<this._data.geometryDefinitions.length;t++){let i=[],n=this._data.geometryDefinitions[t].geometryBuffers;for(let t=0;t<n.length;t++){let r=n[t],o=[],a=!1;if(u(r.compressedAttributes)&&e){a=!0;let e=r.compressedAttributes.attributes;for(let t=0;t<e.length;t++)o.push(e[t])}else for(let e in r)"offset"!==e&&o.push(e);i.push({compressed:a,attributes:o,index:n.indexOf(r)})}i.sort((function(e,t){return e.compressed&&!t.compressed?-1:!e.compressed&&t.compressed?1:e.attributes.length-t.attributes.length})),this._geometryDefinitions.push(i)}},mf.prototype._findBestGeometryBuffers=function(e,t){let i=this._geometryDefinitions[e];if(u(i))for(let e=0;e<i.length;++e){let n=i[e],r=!1,o=n.attributes;for(let e=0;e<t.length;e++)if(!o.includes(t[e])){r=!0;break}if(!r)return{bufferIndex:n.index,definition:i,geometryBufferInfo:n}}return 0},mf.prototype._loadRootNode=function(e){if(u(this._data.nodePages)){let e=0;u(this._data.nodePages.rootIndex)&&(e=this._data.nodePages.rootIndex),this._rootNode=new jv(this,e,!0)}else this._rootNode=new jv(this,this._data.store.rootNode,!0);return this._rootNode.load(e)},mf.prototype._getNodeInNodePages=function(e){let t=Math.floor(e/this._data.nodePages.nodesPerPage),i=e%this._data.nodePages.nodesPerPage;return this._loadNodePage(t).then((function(e){return e.nodes[i]}))},mf._fetchJson=function(e){return e.fetchJson()},mf.prototype._loadNodePage=function(e){let t=this;if(!u(this._nodePageFetches[e])){let i=this.resource.getDerivedResource({url:`nodepages/${e}/`}),n=mf._fetchJson(i).then((function(i){return u(i.error)&&200!==i.error.code?Promise.reject(i.error):(t._nodePages[e]=i.nodes,i)}));this._nodePageFetches[e]=n}return this._nodePageFetches[e]},mf.prototype._computeExtent=function(){u(this._data.fullExtent)?this._extent=ce.fromDegrees(this._data.fullExtent.xmin,this._data.fullExtent.ymin,this._data.fullExtent.xmax,this._data.fullExtent.ymax):u(this._data.store.extent)&&(this._extent=ce.fromDegrees(this._data.store.extent[0],this._data.store.extent[1],this._data.store.extent[2],this._data.store.extent[3]))},mf.prototype._create3DTileset=async function(e){let t={asset:{version:"1.0"},geometricError:Number.MAX_VALUE,root:this._rootNode._create3DTileDefinition()},i=new Blob([JSON.stringify(t)],{type:"application/json"}),n=URL.createObjectURL(i);this._tileset=await ca.fromUrl(n,e),this._tileset.show=this._dataProvider.show,this._tileset._isI3STileSet=!0,this._tileset.tileUnload.addEventListener((function(e){e._i3sNode._clearGeometryData(),URL.revokeObjectURL(e._contentResource._url),e._contentResource=e._i3sNode.resource})),this._tileset.tileVisible.addEventListener((function(e){u(e._i3sNode)&&e._i3sNode._loadChildren()}))};var qv=mf,gde=or(_de(),1);function js(e){e=y(e,y.EMPTY_OBJECT),this._name=e.name,this._show=y(e.show,!0),this._geoidTiledTerrainProvider=e.geoidTiledTerrainProvider,this._traceFetches=y(e.traceFetches,!1),this._cesium3dTilesetOptions=y(e.cesium3dTilesetOptions,y.EMPTY_OBJECT),this._layers=[],this._data=void 0,this._extent=void 0,this._geoidDataPromise=void 0,this._geoidDataList=void 0,this._decoderTaskProcessor=void 0,this._taskProcessorReadyPromise=void 0}Object.defineProperties(js.prototype,{name:{get:function(){return this._name}},show:{get:function(){return this._show},set:function(e){this._show=e;for(let e=0;e<this._layers.length;e++)u(this._layers[e]._tileset)&&(this._layers[e]._tileset.show=this._show)}},traceFetches:{get:function(){return this._traceFetches},set:function(e){this._traceFetches=e}},geoidTiledTerrainProvider:{get:function(){return this._geoidTiledTerrainProvider}},layers:{get:function(){return this._layers}},data:{get:function(){return this._data}},extent:{get:function(){return this._extent}},resource:{get:function(){return this._resource}}}),js.prototype.destroy=function(){for(let e=0;e<this._layers.length;e++)u(this._layers[e]._tileset)&&this._layers[e]._tileset.destroy();return le(this)},js.prototype.isDestroyed=function(){return!1},js.prototype.update=function(e){for(let t=0;t<this._layers.length;t++)u(this._layers[t]._tileset)&&this._layers[t]._tileset.update(e)},js.prototype.prePassesUpdate=function(e){for(let t=0;t<this._layers.length;t++)u(this._layers[t]._tileset)&&this._layers[t]._tileset.prePassesUpdate(e)},js.prototype.postPassesUpdate=function(e){for(let t=0;t<this._layers.length;t++)u(this._layers[t]._tileset)&&this._layers[t]._tileset.postPassesUpdate(e)},js.prototype.updateForPass=function(e,t){for(let i=0;i<this._layers.length;i++)u(this._layers[i]._tileset)&&this._layers[i]._tileset.updateForPass(e,t)},js.fromUrl=async function(e,t){t=y(t,y.EMPTY_OBJECT);let i=ve.createIfNeeded(e),n=await js.loadJson(i),r=new js(t);if(r._resource=i,r._data=n,u(n.layers))for(let e=0;e<n.layers.length;e++){let t=new qv(r,n.layers[e],e);r._layers.push(t)}else{let e=new qv(r,n,n.id);r._layers.push(e)}r._computeExtent();let o=[];for(let e=0;e<r._layers.length;e++)o.push(r._layers[e].load(t.cesium3dTilesetOptions));return await Promise.all(o),r},js._fetchJson=function(e){return e.fetchJson()},js.loadJson=async function(e,t){t&&console.log("I3S FETCH:",e.url);let i=await js._fetchJson(e);if(u(i.error)){if(console.error("Failed to fetch I3S ",e.url),u(i.error.message)&&console.error(i.error.message),u(i.error.details))for(let e=0;e<i.error.details.length;e++)console.log(i.error.details[e]);throw new ue(i.error)}return i},js.prototype._loadBinary=function(e){return this._traceFetches&&console.log("I3S FETCH:",e.url),e.fetchArrayBuffer()},js.prototype._binarizeGltf=function(e){let t=(new TextEncoder).encode(JSON.stringify(e)),i=new Uint8Array(t.byteLength+20),n={magic:new Uint8Array(i.buffer,0,4),version:new Uint32Array(i.buffer,4,1),length:new Uint32Array(i.buffer,8,1),chunkLength:new Uint32Array(i.buffer,12,1),chunkType:new Uint32Array(i.buffer,16,1),chunkData:new Uint8Array(i.buffer,20,t.byteLength)};return n.magic[0]="g".charCodeAt(),n.magic[1]="l".charCodeAt(),n.magic[2]="T".charCodeAt(),n.magic[3]="F".charCodeAt(),n.version[0]=2,n.length[0]=i.byteLength,n.chunkLength[0]=t.byteLength,n.chunkType[0]=1313821514,n.chunkData.set(t),i};var Zet=new U;function $et(e,t){let i=e.tilingScheme,n=[],r={},o=e._lodCount,a=fe.fromRadians(t.west,t.north),s=fe.fromRadians(t.east,t.south),l=i.positionToTileXY(a,o),u=i.positionToTileXY(s,o);for(let t=l.x;t<=u.x;t++)for(let a=l.y;a<=u.y;a++){let s=U.fromElements(t,a,Zet),l=s.toString();if(!r.hasOwnProperty(l)){let t={x:s.x,y:s.y,level:o,tilingScheme:i,terrainProvider:e,positions:[]};r[l]=t,n.push(t)}}let c=[];for(let e=0;e<n.length;++e){let t=n[e],i=t.terrainProvider.requestTileGeometry(t.x,t.y,t.level);c.push(i)}return Promise.all(c).then((function(e){let t=[];for(let r=0;r<e.length;r++){let o={tilingScheme:i,x:n[r].x,y:n[r].y,level:n[r].level},a=e[r],s="Geographic";i._projection instanceof Oi&&(s="WebMercator");let l={projectionType:s,projection:i._projection,nativeExtent:i.tileXYToNativeRectangle(o.x,o.y,o.level),height:a._height,width:a._width,scale:a._structure.heightScale,offset:a._structure.heightOffset};if(a._encoding===Mf.LERC){let e=gde.default.decode(a._buffer);l.buffer=e.pixels[0]}else l.buffer=a._buffer;t.push(l)}return t}))}async function Qet(e){let t=e._geoidTiledTerrainProvider;if(u(t))try{let i=await $et(t,e._extent);e._geoidDataList=i}catch{console.log("Error retrieving Geoid Terrain tiles - no geoid conversion will be performed.")}else console.log("No Geoid Terrain service provided - no geoid conversion will be performed.")}js.prototype.loadGeoidData=async function(){return u(this._geoidDataPromise)||(this._geoidDataPromise=Qet(this)),this._geoidDataPromise},js.prototype._computeExtent=function(){let e;for(let t=0;t<this._layers.length;t++)if(u(this._layers[t]._extent)){let i=this._layers[t]._extent;u(e)?ce.union(e,i,e):e=ce.clone(i)}this._extent=e};var hC=js;function Qh(){this._numSamples=1,this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._fbo=new di({depthStencil:!0,createDepthAttachments:!1}),this._fboClassified=new di({depthStencil:!0,createDepthAttachments:!1}),this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new ti({color:new z(0,0,0,0),owner:this}),this._clearCommand=new ti({color:new z(0,0,0,0),depth:1,stencil:0});let e=this;this._uniformMap={colorTexture:function(){return e._fbo.getColorTexture()},depthTexture:function(){return e._depthStencilTexture},classifiedTexture:function(){return e._fboClassified.getColorTexture()}}}Object.defineProperties(Qh.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}}),Qh.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth};var Jet={depthMask:!1,stencilTest:{enabled:!0,frontFunction:Un.EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:Un.NEVER,reference:0,mask:Lt.CLASSIFICATION_MASK},blending:ln.ALPHA_BLEND},ett={depthMask:!1,stencilTest:{enabled:!0,frontFunction:Un.NOT_EQUAL,frontOperation:{fail:ft.KEEP,zFail:ft.KEEP,zPass:ft.KEEP},backFunction:Un.NEVER,reference:0,mask:Lt.CLASSIFICATION_MASK},blending:ln.ALPHA_BLEND},ttt={depthMask:!0,depthTest:{enabled:!0},stencilTest:Lt.setCesium3DTileBit(),stencilMask:Lt.CESIUM_3D_TILE_MASK,blending:ln.ALPHA_BLEND},ntt="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform sampler2D classifiedTexture;\nin vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n    bool isClassified = all(equal(texture(classifiedTexture, v_textureCoordinates), vec4(0.0)));\n#ifdef UNCLASSIFIED\n    vec4 highlightColor = czm_invertClassificationColor;\n    if (isClassified)\n    {\n        discard;\n    }\n#else\n    vec4 highlightColor = vec4(1.0);\n    if (!isClassified)\n    {\n        discard;\n    }\n#endif\n    out_FragColor = color * highlightColor;\n    gl_FragDepth = texture(depthTexture, v_textureCoordinates).r;\n}\n",itt="uniform sampler2D colorTexture;\nin vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n#ifdef UNCLASSIFIED\n    out_FragColor = color * czm_invertClassificationColor;\n#else\n    out_FragColor = color;\n#endif\n}\n";Qh.prototype.update=function(e,t,i){let n=this._fbo.getColorTexture(),r=this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;let o=this._numSamples!==t,a=e.drawingBufferWidth,s=e.drawingBufferHeight,l=!u(n)||n.width!==a||n.height!==s;if((l||r||o)&&(this._numSamples=t,this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),u(this._previousFramebuffer)||(this._depthStencilTexture=new Ot({context:e,width:a,height:s,pixelFormat:rt.DEPTH_STENCIL,pixelDatatype:Ye.UNSIGNED_INT_24_8}),t>1&&(this._depthStencilRenderbuffer=new ju({context:e,width:a,height:s,format:nl.DEPTH24_STENCIL8,numSamples:t})))),!u(this._fbo.framebuffer)||l||r||o){let n,r;this._fbo.destroy(),this._fboClassified.destroy(),u(this._previousFramebuffer)?(n=i.getDepthStencilTexture(),r=i.getDepthStencilRenderbuffer()):(n=this._depthStencilTexture,r=this._depthStencilRenderbuffer),this._fbo.setDepthStencilTexture(n),u(r)&&this._fbo.setDepthStencilRenderbuffer(r),this._fbo.update(e,a,s,t),u(this._previousFramebuffer)||(this._fboClassified.setDepthStencilTexture(n),this._fboClassified.update(e,a,s))}if(u(this._rsUnclassified)||(this._rsUnclassified=Ue.fromCache(Jet),this._rsClassified=Ue.fromCache(ett),this._rsDefault=Ue.fromCache(ttt)),!u(this._unclassifiedCommand)||r||o){u(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());let t=u(this._previousFramebuffer)?itt:ntt,i=new He({defines:["UNCLASSIFIED"],sources:[t]}),n=new He({sources:[t]});this._unclassifiedCommand=e.createViewportQuadCommand(i,{renderState:u(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(n,{renderState:u(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),u(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),u(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(Jl,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}},Qh.prototype.prepareTextures=function(e,t){this._fbo._numSamples>1&&this._fbo.prepareTextures(e,t)},Qh.prototype.clear=function(e,t){u(this._previousFramebuffer)?this._fbo.clear(e,this._clearColorCommand,t):(this._fbo.clear(e,this._clearCommand,t),this._fboClassified.clear(e,this._clearCommand,t))},Qh.prototype.executeClassified=function(e,t){if(!u(this._previousFramebuffer)){let i=t.framebuffer;this.prepareTextures(e,!0),t.framebuffer=this._fboClassified.framebuffer,this._translucentCommand.execute(e,t),t.framebuffer=i}this._classifiedCommand.execute(e,t)},Qh.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)},Qh.prototype.isDestroyed=function(){return!1},Qh.prototype.destroy=function(){return this._fbo.destroy(),this._fboClassified.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy(),u(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),le(this)};var Yv=Qh;function Ok(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}function jg(e){let t=new Array(Ha.NUMBER_OF_JOB_TYPES);t[Ha.TEXTURE]=new Ok(u(e)?e[Ha.TEXTURE]:10),t[Ha.PROGRAM]=new Ok(u(e)?e[Ha.PROGRAM]:10),t[Ha.BUFFER]=new Ok(u(e)?e[Ha.BUFFER]:30);let i,n=t.length,r=0;for(i=0;i<n;++i)r+=t[i].total;let o=new Array(n);for(i=0;i<n;++i)o[i]=!1;this._totalBudget=r,this._totalUsedThisFrame=0,this._budgets=t,this._executedThisFrame=o}Object.defineProperties(Ok.prototype,{total:{get:function(){return this._total}}}),jg.getTimestamp=_i,Object.defineProperties(jg.prototype,{totalBudget:{get:function(){return this._totalBudget}}}),jg.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget},jg.prototype.resetBudgets=function(){let e=this._budgets,t=e.length;for(let i=0;i<t;++i){let t=e[i];t.starvedLastFrame=t.starvedThisFrame,t.starvedThisFrame=!1,t.usedThisFrame=0,t.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0},jg.prototype.execute=function(e,t){let i,n=this._budgets,r=n[t],o=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&o)return r.starvedThisFrame=!0,!1;if(r.usedThisFrame+r.stolenFromMeThisFrame>=r.total){let e,t=n.length;for(e=0;e<t&&(i=n[e],!(i.usedThisFrame+i.stolenFromMeThisFrame<i.total)||i.starvedLastFrame);++e);if(e===t&&o)return!1;o&&(r.starvedThisFrame=!0)}let a=jg.getTimestamp();e.execute();let s=jg.getTimestamp()-a;return this._totalUsedThisFrame+=s,i?i.stolenFromMeThisFrame+=s:r.usedThisFrame+=s,this._executedThisFrame[t]=!0,!0};var Rk=jg,yde=Object.freeze({UNLOADED:0,RECEIVING:1,RECEIVED:2,LOADED:3,FAILED:4,UNAVAILABLE:5});function Mk(e,t){this.spatialNode=e,this.keyframe=t,this.state=yde.UNLOADED,this.metadatas=[],this.megatextureIndex=-1,this.priority=-Number.MAX_VALUE,this.highPriorityFrameNumber=-1}Mk.priorityComparator=function(e,t){return e.priority-t.priority},Mk.searchComparator=function(e,t){return e.keyframe-t.keyframe},Mk.LoadState=yde;var Qi=Mk;function xde(){}Object.defineProperties(xde.prototype,{color:{get:de.throwInstantiationError},intensity:{get:de.throwInstantiationError}});var bde=xde,ott=/\/$/,Tde=new xt('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function pC(e){let t=(e=y(e,y.EMPTY_OBJECT)).styleId,i=e.accessToken;this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0;let n=ve.createIfNeeded(y(e.url,"https://api.mapbox.com/styles/v1/"));this._styleId=t,this._accessToken=i;let r=y(e.tilesize,512);this._tilesize=r;let o=y(e.username,"mapbox");this._username=o;let a,s=u(e.scaleFactor)?"@2x":"",l=n.getUrlComponent();ott.test(l)||(l+="/"),l+=`${this._username}/${t}/tiles/${this._tilesize}/{z}/{x}/{y}${s}`,n.url=l,n.setQueryParameters({access_token:i}),u(e.credit)?(a=e.credit,"string"==typeof a&&(a=new xt(a))):a=Tde,this._resource=n,this._imageryProvider=new qa({url:n,credit:a,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object.defineProperties(pC.prototype,{url:{get:function(){return this._imageryProvider.url}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),pC.prototype.getTileCredits=function(e,t,i){},pC.prototype.requestImage=function(e,t,i,n){return this._imageryProvider.requestImage(e,t,i,n)},pC.prototype.pickFeatures=function(e,t,i,n,r){return this._imageryProvider.pickFeatures(e,t,i,n,r)},pC._defaultCredit=Tde;var Ade=pC,Lk="in vec3 v_positionEC;\nin vec3 v_normalEC;\nin vec3 v_tangentEC;\nin vec3 v_bitangentEC;\nin vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n    mat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.tangentToEyeMatrix = tangentToEyeMatrix;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n",Nk="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin vec3 tangent;\nin vec3 bitangent;\nin vec2 st;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\nout vec3 v_tangentEC;\nout vec3 v_bitangentEC;\nout vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_tangentEC = czm_normal * tangent;                       // tangent in eye coordinates\n    v_bitangentEC = czm_normal * bitangent;                   // bitangent in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",Fk="in vec3 v_positionEC;\nin vec3 v_normalEC;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n",Bk="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",kk="in vec3 v_positionEC;\nin vec3 v_normalEC;\nin vec2 v_st;\n\nvoid main()\n{\n    vec3 positionToEyeEC = -v_positionEC;\n\n    vec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\n    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\n\n    czm_materialInput materialInput;\n    materialInput.normalEC = normalEC;\n    materialInput.positionToEyeEC = positionToEyeEC;\n    materialInput.st = v_st;\n    czm_material material = czm_getMaterial(materialInput);\n\n#ifdef FLAT\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\n    out_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n#endif\n}\n",Vk="in vec3 position3DHigh;\nin vec3 position3DLow;\nin vec3 normal;\nin vec2 st;\nin float batchId;\n\nout vec3 v_positionEC;\nout vec3 v_normalEC;\nout vec2 v_st;\n\nvoid main()\n{\n    vec4 p = czm_computePosition();\n\n    v_positionEC = (czm_modelViewRelativeToEye * p).xyz;      // position in eye coordinates\n    v_normalEC = czm_normal * normal;                         // normal in eye coordinates\n    v_st = st;\n\n    gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n";function Sx(e){e=y(e,y.EMPTY_OBJECT);let t=y(e.translucent,!0),i=y(e.closed,!1),n=y(e.materialSupport,Sx.MaterialSupport.TEXTURED);this.material=u(e.material)?e.material:Wi.fromType(Wi.ColorType),this.translucent=t,this._vertexShaderSource=y(e.vertexShaderSource,n.vertexShaderSource),this._fragmentShaderSource=y(e.fragmentShaderSource,n.fragmentShaderSource),this._renderState=no.getDefaultRenderState(t,i,e.renderState),this._closed=i,this._materialSupport=n,this._vertexFormat=n.vertexFormat,this._flat=y(e.flat,!1),this._faceForward=y(e.faceForward,!i)}Object.defineProperties(Sx.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),Sx.prototype.getFragmentShaderSource=no.prototype.getFragmentShaderSource,Sx.prototype.isTranslucent=no.prototype.isTranslucent,Sx.prototype.getRenderState=no.prototype.getRenderState,Sx.MaterialSupport={BASIC:Object.freeze({vertexFormat:Pe.POSITION_AND_NORMAL,vertexShaderSource:Bk,fragmentShaderSource:Fk}),TEXTURED:Object.freeze({vertexFormat:Pe.POSITION_NORMAL_AND_ST,vertexShaderSource:Vk,fragmentShaderSource:kk}),ALL:Object.freeze({vertexFormat:Pe.ALL,vertexShaderSource:Nk,fragmentShaderSource:Lk})};var ao=Sx;function qg(e,t,i,n,r){n===Jt.UNSIGNED_SHORT&&(n=Jt.FLOAT32);let o,a,s=e.floatingPointTexture;if(n===Jt.FLOAT32&&!s)throw new ue("Floating point texture not supported");n===Jt.FLOAT32||n===Jt.FLOAT64?o=Ye.FLOAT:n===Jt.UINT8&&(o=Ye.UNSIGNED_BYTE),1===i?a=e.webgl2?rt.RED:rt.LUMINANCE:2===i?a=e.webgl2?rt.RG:rt.LUMINANCE_ALPHA:3===i?a=rt.RGB:4===i&&(a=rt.RGBA);r=Math.min(y(r,134217728),536870912);let l=zt.maximumTextureSize,u=Jt.getSizeInBytes(n),c=Math.floor(r/(i*u)),d=Math.min(l,P.previousPowerOfTwo(Math.floor(Math.sqrt(c)))),p=Math.ceil(Math.sqrt(t.x)),f=Math.ceil(t.z/p),m=p*t.x,_=f*t.y,g=Math.floor(d/m),v=Math.floor(d/_);if(0===g||0===v)throw new ue("Tileset is too large to fit into megatexture");this.channelCount=i,this.componentType=n,this.voxelCountPerTile=h.clone(t,new h),this.maximumTileCount=g*v,this.regionCountPerMegatexture=new U(g,v),this.voxelCountPerRegion=new U(m,_),this.sliceCountPerRegion=new U(p,f),this.voxelSizeUv=new U(1/d,1/d),this.sliceSizeUv=new U(t.x/d,t.y/d),this.regionSizeUv=new U(m/d,_/d),this.texture=new Ot({context:e,pixelFormat:a,pixelDatatype:o,flipY:!1,width:d,height:d,sampler:new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:an.LINEAR,magnificationFilter:wi.LINEAR})});let b=Jt.toComponentDatatype(n);this.tileVoxelDataTemp=X.createTypedArray(b,m*_*i),this.nodes=new Array(this.maximumTileCount);for(let e=0;e<this.maximumTileCount;e++)this.nodes[e]=new rtt(e);for(let e=0;e<this.maximumTileCount;e++){let t=this.nodes[e];t.previousNode=e>0?this.nodes[e-1]:void 0,t.nextNode=e<this.maximumTileCount-1?this.nodes[e+1]:void 0}this.occupiedList=void 0,this.emptyList=this.nodes[0],this.occupiedCount=0}function rtt(e){this.index=e,this.nextNode=void 0,this.previousNode=void 0}qg.prototype.add=function(e){if(this.isFull())throw new de("Trying to add when there are no empty spots");let t=this.emptyList;this.emptyList=this.emptyList.nextNode,u(this.emptyList)&&(this.emptyList.previousNode=void 0),t.nextNode=this.occupiedList,u(t.nextNode)&&(t.nextNode.previousNode=t),this.occupiedList=t;let i=t.index;return this.writeDataToTexture(i,e),this.occupiedCount++,i},qg.prototype.remove=function(e){if(e<0||e>=this.maximumTileCount)throw new de("Megatexture index out of bounds");let t=this.nodes[e];u(t.previousNode)&&(t.previousNode.nextNode=t.nextNode),u(t.nextNode)&&(t.nextNode.previousNode=t.previousNode),t.nextNode=this.emptyList,u(t.nextNode)&&(t.nextNode.previousNode=t),t.previousNode=void 0,this.emptyList=t,this.occupiedCount--},qg.prototype.isFull=function(){return void 0===this.emptyList},qg.getApproximateTextureMemoryByteLength=function(e,t,i,n){n===Jt.UNSIGNED_SHORT&&(n=Jt.FLOAT32);let r=Jt.getSizeInBytes(n),o=e*t.x*t.y*t.z,a=Math.ceil(Math.sqrt(t.z)),s=Math.ceil(t.z/a),l=a*t.x,u=s*t.y,c=P.previousPowerOfTwo(Math.floor(Math.sqrt(o)));for(;;){if(Math.floor(c/l)*Math.floor(c/u)>=e)break;c*=2}return c*c*i*r},qg.prototype.writeDataToTexture=function(e,t){let i=t.constructor===Uint16Array?new Float32Array(t):t,n=this.voxelCountPerTile,r=this.sliceCountPerRegion,o=this.voxelCountPerRegion,a=this.channelCount,s=this.tileVoxelDataTemp;for(let e=0;e<n.z;e++){let t=e%r.x*n.x,l=Math.floor(e/r.x)*n.y;for(let r=0;r<n.y;r++)for(let u=0;u<n.x;u++){let c=e*n.y*n.x+r*n.x+u,h=(l+r)*o.x+(t+u);for(let e=0;e<a;e++)s[h*a+e]=i[c*a+e]}}let l=this.regionCountPerMegatexture,u={source:{arrayBufferView:s,width:o.x,height:o.y},xOffset:e%l.x*o.x,yOffset:Math.floor(e/l.x)*o.y};this.texture.copyFrom(u)},qg.prototype.isDestroyed=function(){return!1},qg.prototype.destroy=function(){return this.texture=this.texture&&this.texture.destroy(),le(this)};var Xv=qg;function Kv(e){let t=(e=y(e,y.EMPTY_OBJECT)).textureUrl;u(t)||(t=$t("Assets/Textures/moonSmall.jpg")),this.show=y(e.show,!0),this.textureUrl=t,this._ellipsoid=y(e.ellipsoid,ie.MOON),this.onlySunLighting=y(e.onlySunLighting,!0),this._ellipsoidPrimitive=new L3({radii:this.ellipsoid.radii,material:Wi.fromType(Wi.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new eO}Object.defineProperties(Kv.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var Uk=new $,stt=new $,att=new h,zk=[];Kv.prototype.update=function(e){if(!this.show)return;let t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;let i=e.time;u(Rt.computeIcrfToFixedMatrix(i,Uk))||Rt.computeTemeToPseudoFixedMatrix(i,Uk);let n=this._axes.evaluate(i,stt);$.transpose(n,n),$.multiply(Uk,n,n);let r=D0.computeMoonPositionInEarthInertialFrame(i,att);$.multiplyByVector(Uk,r,r),L.fromRotationTranslation(n,r,t.modelMatrix);let o=e.commandList;return e.commandList=zk,zk.length=0,t.update(e),e.commandList=o,1===zk.length?zk[0]:void 0},Kv.prototype.isDestroyed=function(){return!1},Kv.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),le(this)};var Hk=Kv;function wj(e){}wj.prototype.isReady=function(){return!0},wj.prototype.shouldDiscardImage=function(e){return!1};var Cde=wj,Zv="#ifdef MRT\nlayout (location = 0) out vec4 out_FragData_0;\nlayout (location = 1) out vec4 out_FragData_1;\n#else\nlayout (location = 0) out vec4 out_FragColor;\n#endif\n\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    if (texture(u_depthTexture, v_textureCoordinates).r < 1.0)\n    {\n#ifdef MRT\n        out_FragData_0 = u_bgColor;\n        out_FragData_1 = vec4(u_bgColor.a);\n#else\n        out_FragColor = u_bgColor;\n#endif\n        return;\n    }\n    \n    discard;\n}\n",Gk="/**\n * Compositing for Weighted Blended Order-Independent Transparency. See:\n * - http://jcgt.org/published/0002/02/09/\n * - http://casual-effects.blogspot.com/2014/03/weighted-blended-order-independent.html\n */\n\nuniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 opaque = texture(u_opaque, v_textureCoordinates);\n    vec4 accum = texture(u_accumulation, v_textureCoordinates);\n    float r = texture(u_revealage, v_textureCoordinates).r;\n\n#ifdef MRT\n    vec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\n    vec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\n\n    out_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n\n    if (opaque != czm_backgroundColor)\n    {\n        out_FragColor.a = 1.0;\n    }\n}\n";function zp(e){this._numSamples=1,this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;let t=e.colorBufferFloat&&e.depthTexture&&e.floatBlend;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=new di({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._alphaFBO=new di({createColorAttachments:!1,createDepthAttachments:!1,depth:!0}),this._adjustTranslucentFBO=new di({colorAttachmentsLength:this._translucentMRTSupport?2:1,createColorAttachments:!1}),this._adjustAlphaFBO=new di({createColorAttachments:!1}),this._opaqueClearCommand=new ti({color:new z(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new ti({color:new z(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new ti({color:new z(0,0,0,0),owner:this}),this._alphaClearCommand=new ti({color:new z(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new qe,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1}function Ede(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function vj(e){e._translucentFBO.destroy(),e._alphaFBO.destroy(),e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO.destroy()}function Sde(e){Ede(e),vj(e)}function ctt(e,t,i,n){Ede(e),e._accumulationTexture=new Ot({context:t,width:i,height:n,pixelFormat:rt.RGBA,pixelDatatype:Ye.FLOAT});let r=new Float32Array(i*n*4);e._revealageTexture=new Ot({context:t,pixelFormat:rt.RGBA,pixelDatatype:Ye.FLOAT,source:{arrayBufferView:r,width:i,height:n},flipY:!1})}function ltt(e,t){vj(e);let i=ee.FRAMEBUFFER_COMPLETE,n=!0,{width:r,height:o}=e._accumulationTexture;if(e._translucentMRTSupport&&(e._translucentFBO.setColorTexture(e._accumulationTexture,0),e._translucentFBO.setColorTexture(e._revealageTexture,1),e._translucentFBO.setDepthStencilTexture(e._depthStencilTexture),e._translucentFBO.update(t,r,o),e._adjustTranslucentFBO.setColorTexture(e._accumulationTexture,0),e._adjustTranslucentFBO.setColorTexture(e._revealageTexture,1),e._adjustTranslucentFBO.update(t,r,o),(e._translucentFBO.status!==i||e._adjustTranslucentFBO.status!==i)&&(vj(e),e._translucentMRTSupport=!1)),!e._translucentMRTSupport){e._translucentFBO.setColorTexture(e._accumulationTexture),e._translucentFBO.setDepthStencilTexture(e._depthStencilTexture),e._translucentFBO.update(t,r,o),e._alphaFBO.setColorTexture(e._revealageTexture),e._alphaFBO.setDepthStencilTexture(e._depthStencilTexture),e._alphaFBO.update(t,r,o),e._adjustTranslucentFBO.setColorTexture(e._accumulationTexture),e._adjustTranslucentFBO.update(t,r,o),e._adjustAlphaFBO.setColorTexture(e._revealageTexture),e._adjustAlphaFBO.update(t,r,o);let a=e._translucentFBO.status===i,s=e._alphaFBO.status===i,l=e._adjustTranslucentFBO.status===i,u=e._adjustAlphaFBO.status===i;(!a||!s||!l||!u)&&(Sde(e),e._translucentMultipassSupport=!1,n=!1)}return n}zp.prototype.update=function(e,t,i,n,r){if(!this.isSupported())return;this._opaqueFBO=i,this._opaqueTexture=i.getColorTexture(0),this._depthStencilTexture=i.getDepthStencilTexture();let{width:o,height:a}=this._opaqueTexture,s=this._accumulationTexture,l=!u(s)||s.width!==o||s.height!==a||n!==this._useHDR,c=this._numSamples!==r;if((l||c)&&(this._numSamples=r,ctt(this,e,o,a)),(!u(this._translucentFBO.framebuffer)||l||c)&&!ltt(this,e))return;this._useHDR=n;let h,d,p=this;u(this._compositeCommand)||(h=new He({sources:[Gk]}),this._translucentMRTSupport&&h.defines.push("MRT"),d={u_opaque:function(){return p._opaqueTexture},u_accumulation:function(){return p._accumulationTexture},u_revealage:function(){return p._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(h,{uniformMap:d,owner:this})),u(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(h=new He({defines:["MRT"],sources:[Zv]}),d={u_bgColor:function(){return p._translucentMRTClearCommand.color},u_depthTexture:function(){return p._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(h,{uniformMap:d,owner:this})):this._translucentMultipassSupport&&(h=new He({sources:[Zv]}),d={u_bgColor:function(){return p._translucentMultipassClearCommand.color},u_depthTexture:function(){return p._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(h,{uniformMap:d,owner:this}),d={u_bgColor:function(){return p._alphaClearCommand.color},u_depthTexture:function(){return p._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(h,{uniformMap:d,owner:this}))),this._viewport.width=o,this._viewport.height=a;let f=!qe.equals(this._viewport,t.viewport),m=f!==this._useScissorTest;this._useScissorTest=f,qe.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=qe.clone(t.viewport,this._scissorRectangle),m=!0),(!u(this._rs)||!qe.equals(this._viewport,this._rs.viewport)||m)&&(this._rs=Ue.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),u(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),u(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)};var utt={enabled:!0,color:new z(0,0,0,0),equationRgb:La.ADD,equationAlpha:La.ADD,functionSourceRgb:To.ONE,functionDestinationRgb:To.ONE,functionSourceAlpha:To.ZERO,functionDestinationAlpha:To.ONE_MINUS_SOURCE_ALPHA},ftt={enabled:!0,color:new z(0,0,0,0),equationRgb:La.ADD,equationAlpha:La.ADD,functionSourceRgb:To.ONE,functionDestinationRgb:To.ONE,functionSourceAlpha:To.ONE,functionDestinationAlpha:To.ONE},dtt={enabled:!0,color:new z(0,0,0,0),equationRgb:La.ADD,equationAlpha:La.ADD,functionSourceRgb:To.ZERO,functionDestinationRgb:To.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:To.ZERO,functionDestinationAlpha:To.ONE_MINUS_SOURCE_ALPHA};function Dj(e,t,i,n){let r=i[n.id];if(!u(r)){let e=Ue.getState(n);e.depthMask=!1,e.blending=t,r=Ue.fromCache(e),i[n.id]=r}return r}function htt(e,t,i){return Dj(t,utt,e._translucentRenderStateCache,i)}function mtt(e,t,i){return Dj(t,ftt,e._translucentRenderStateCache,i)}function ptt(e,t,i){return Dj(t,dtt,e._alphaRenderStateCache,i)}var _tt="    vec3 Ci = czm_out_FragColor.rgb * czm_out_FragColor.a;\n    float ai = czm_out_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    out_FragData_0 = vec4(Ci * wzi, ai);\n    out_FragData_1 = vec4(ai * wzi);\n",gtt="    vec3 Ci = czm_out_FragColor.rgb * czm_out_FragColor.a;\n    float ai = czm_out_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    out_FragColor = vec4(Ci, ai) * wzi;\n",ytt="    float ai = czm_out_FragColor.a;\n    out_FragColor = vec4(ai);\n";function Ij(e,t,i,n){let{shaderCache:r}=e,o=r.getDerivedShaderProgram(t,i);if(u(o))return o;let a=t._attributeLocations,s=t.fragmentShaderSource.clone();s.sources=s.sources.map((function(e){return He.replaceMain(e,"czm_translucent_main").replace(/out_FragColor/g,"czm_out_FragColor").replace(/layout\s*\(location\s*=\s*0\)\s*out\s+vec4\s+out_FragColor;/g,"").replace(/\bdiscard\b/g,"czm_discard = true").replace(/czm_phong/g,"czm_translucentPhong")})),s.sources.splice(0,0,"vec4 czm_out_FragColor;\nbool czm_discard = false;\n");let l=[...n.matchAll(/out_FragData_(\d+)/g)],c="";for(let e=0;e<l.length;e++){let t=l[e];c=`layout (location = ${t[1]}) out vec4 ${t[0]};\n${c}`}return s.sources.push(c),s.sources.push(`void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n${n}}\n`),r.createDerivedShaderProgram(t,i,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:s,attributeLocations:a})}function xtt(e,t){return Ij(e,t,"translucentMRT",_tt)}function btt(e,t){return Ij(e,t,"translucentMultipass",gtt)}function Ttt(e,t){return Ij(e,t,"alphaMultipass",ytt)}function Att(e,t,i,n,r,o){let a,s,l,{context:c,frameState:h}=t,{useLogDepth:d,shadowState:p}=h,f=t._hdr,m=n.framebuffer,_=p.lightShadowsEnabled;n.framebuffer=e._adjustTranslucentFBO.framebuffer,e._adjustTranslucentCommand.execute(c,n),n.framebuffer=e._adjustAlphaFBO.framebuffer,e._adjustAlphaCommand.execute(c,n);let g=e._opaqueFBO.framebuffer;for(n.framebuffer=e._translucentFBO.framebuffer,l=0;l<r.length;++l)a=r[l],a=d?a.derivedCommands.logDepth.command:a,a=f?a.derivedCommands.hdr.command:a,s=_&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand,i(s,t,c,n,g);for(u(o)&&(a=o.unclassifiedCommand,s=_&&a.receiveShadows?a.derivedCommands.oit.shadows.translucentCommand:a.derivedCommands.oit.translucentCommand,i(s,t,c,n,g)),n.framebuffer=e._alphaFBO.framebuffer,l=0;l<r.length;++l)a=r[l],a=d?a.derivedCommands.logDepth.command:a,a=f?a.derivedCommands.hdr.command:a,s=_&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand,i(s,t,c,n,g);u(o)&&(a=o.unclassifiedCommand,s=_&&a.receiveShadows?a.derivedCommands.oit.shadows.alphaCommand:a.derivedCommands.oit.alphaCommand,i(s,t,c,n,g)),n.framebuffer=m}function Ctt(e,t,i,n,r,o){let{context:a,frameState:s}=t,{useLogDepth:l,shadowState:c}=s,h=t._hdr,d=n.framebuffer,p=c.lightShadowsEnabled;n.framebuffer=e._adjustTranslucentFBO.framebuffer,e._adjustTranslucentCommand.execute(a,n);let f,m,_=e._opaqueFBO.framebuffer;n.framebuffer=e._translucentFBO.framebuffer;for(let e=0;e<r.length;++e)f=r[e],f=l?f.derivedCommands.logDepth.command:f,f=h?f.derivedCommands.hdr.command:f,m=p&&f.receiveShadows?f.derivedCommands.oit.shadows.translucentCommand:f.derivedCommands.oit.translucentCommand,i(m,t,a,n,_);u(o)&&(f=o.unclassifiedCommand,m=p&&f.receiveShadows?f.derivedCommands.oit.shadows.translucentCommand:f.derivedCommands.oit.translucentCommand,i(m,t,a,n,_)),n.framebuffer=d}zp.prototype.createDerivedCommands=function(e,t,i){if(u(i)||(i={}),this._translucentMRTSupport){let n,r;return u(i.translucentCommand)&&(n=i.translucentCommand.shaderProgram,r=i.translucentCommand.renderState),i.translucentCommand=et.shallowClone(e,i.translucentCommand),u(n)&&i.shaderProgramId===e.shaderProgram.id?(i.translucentCommand.shaderProgram=n,i.translucentCommand.renderState=r):(i.translucentCommand.shaderProgram=xtt(t,e.shaderProgram),i.translucentCommand.renderState=htt(this,t,e.renderState),i.shaderProgramId=e.shaderProgram.id),i}let n,r,o,a;return u(i.translucentCommand)&&(n=i.translucentCommand.shaderProgram,r=i.translucentCommand.renderState,o=i.alphaCommand.shaderProgram,a=i.alphaCommand.renderState),i.translucentCommand=et.shallowClone(e,i.translucentCommand),i.alphaCommand=et.shallowClone(e,i.alphaCommand),u(n)&&i.shaderProgramId===e.shaderProgram.id?(i.translucentCommand.shaderProgram=n,i.translucentCommand.renderState=r,i.alphaCommand.shaderProgram=o,i.alphaCommand.renderState=a):(i.translucentCommand.shaderProgram=btt(t,e.shaderProgram),i.translucentCommand.renderState=mtt(this,t,e.renderState),i.alphaCommand.shaderProgram=Ttt(t,e.shaderProgram),i.alphaCommand.renderState=ptt(this,t,e.renderState),i.shaderProgramId=e.shaderProgram.id),i},zp.prototype.executeCommands=function(e,t,i,n,r){this._translucentMRTSupport?Ctt(this,e,t,i,n,r):Att(this,e,t,i,n,r)},zp.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},zp.prototype.clear=function(e,t,i){let n=t.framebuffer;t.framebuffer=this._opaqueFBO.framebuffer,z.clone(i,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO.framebuffer,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO.framebuffer,this._alphaClearCommand.execute(e,t)),t.framebuffer=n},zp.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},zp.prototype.isDestroyed=function(){return!1},zp.prototype.destroy=function(){return Sde(this),u(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),u(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),u(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),le(this)};var Wk=zp,Ett=new xt("MapQuest, Open Street Map and contributors, CC-BY-SA");function jk(e){e=y(e,y.EMPTY_OBJECT);let t=ve.createIfNeeded(y(e.url,"https://tile.openstreetmap.org/"));t.appendForwardSlash(),t.url+=`{z}/{x}/{y}${e.retinaTiles?"@2x":""}.${y(e.fileExtension,"png")}`;let i=new zr({ellipsoid:e.ellipsoid}),n=y(e.minimumLevel,0),r=e.maximumLevel,o=y(e.rectangle,i.rectangle),a=i.positionToTileXY(ce.southwest(o),n),s=i.positionToTileXY(ce.northeast(o),n),l=(Math.abs(s.x-a.x),Math.abs(s.y-a.y),y(e.credit,Ett));"string"==typeof l&&(l=new xt(l)),qa.call(this,{url:t,credit:l,tilingScheme:i,tileWidth:256,tileHeight:256,minimumLevel:n,maximumLevel:r,rectangle:o})}u(Object.create)&&(jk.prototype=Object.create(qa.prototype),jk.prototype.constructor=jk);var Yg=jk;function qs(e){e=y(e,y.EMPTY_OBJECT),this._primitives=[],this._guid=jn(),this._primitiveAdded=new pe,this._primitiveRemoved=new pe,this._zIndex=void 0,this.show=y(e.show,!0),this.destroyPrimitives=y(e.destroyPrimitives,!0)}function qk(e,t){return e._primitives.indexOf(t)}Object.defineProperties(qs.prototype,{length:{get:function(){return this._primitives.length}},primitiveAdded:{get:function(){return this._primitiveAdded}},primitiveRemoved:{get:function(){return this._primitiveRemoved}}}),qs.prototype.add=function(e,t){let i=u(t),n=e._external=e._external||{};return(n._composites=n._composites||{})[this._guid]={collection:this},i?this._primitives.splice(t,0,e):this._primitives.push(e),this._primitiveAdded.raiseEvent(e),e},qs.prototype.remove=function(e){if(this.contains(e)){let t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),this._primitiveRemoved.raiseEvent(e),!0}return!1},qs.prototype.removeAndDestroy=function(e){let t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},qs.prototype.removeAll=function(){let e=this._primitives,t=e.length;for(let i=0;i<t;++i)delete e[i]._external._composites[this._guid],this.destroyPrimitives&&e[i].destroy(),this._primitiveRemoved.raiseEvent(e[i]);this._primitives=[]},qs.prototype.contains=function(e){return!!(u(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},qs.prototype.raise=function(e){if(u(e)){let t=qk(this,e),i=this._primitives;if(t!==i.length-1){let e=i[t];i[t]=i[t+1],i[t+1]=e}}},qs.prototype.raiseToTop=function(e){if(u(e)){let t=qk(this,e),i=this._primitives;t!==i.length-1&&(i.splice(t,1),i.push(e))}},qs.prototype.lower=function(e){if(u(e)){let t=qk(this,e),i=this._primitives;if(0!==t){let e=i[t];i[t]=i[t-1],i[t-1]=e}}},qs.prototype.lowerToBottom=function(e){if(u(e)){let t=qk(this,e),i=this._primitives;0!==t&&(i.splice(t,1),i.unshift(e))}},qs.prototype.get=function(e){return this._primitives[e]},qs.prototype.update=function(e){if(!this.show)return;let t=this._primitives;for(let i=0;i<t.length;++i)t[i].update(e)},qs.prototype.prePassesUpdate=function(e){let t=this._primitives;for(let i=0;i<t.length;++i){let n=t[i];u(n.prePassesUpdate)&&n.prePassesUpdate(e)}},qs.prototype.updateForPass=function(e,t){let i=this._primitives;for(let n=0;n<i.length;++n){let r=i[n];u(r.updateForPass)&&r.updateForPass(e,t)}},qs.prototype.postPassesUpdate=function(e){let t=this._primitives;for(let i=0;i<t.length;++i){let n=t[i];u(n.postPassesUpdate)&&n.postPassesUpdate(e)}},qs.prototype.isDestroyed=function(){return!1},qs.prototype.destroy=function(){return this.removeAll(),le(this)};var tu=qs;function Jh(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}Object.defineProperties(Jh.prototype,{length:{get:function(){return this._length}}}),Jh.prototype.add=function(e,t){t=y(t,0);let i=this._collections[t];if(!u(i)){i=new tu({destroyPrimitives:!1}),i._zIndex=t,this._collections[t]=i;let e=this._collectionsArray,n=0;for(;n<e.length&&e[n]._zIndex<t;)n++;e.splice(n,0,i)}return i.add(e),this._length++,e._zIndex=t,e},Jh.prototype.set=function(e,t){return t===e._zIndex||(this.remove(e,!0),this.add(e,t)),e},Jh.prototype.remove=function(e,t){if(this.contains(e)){let i,n=e._zIndex,r=this._collections[n];return i=t?r.remove(e):r.removeAndDestroy(e),i&&this._length--,0===r.length&&(this._collectionsArray.splice(this._collectionsArray.indexOf(r),1),this._collections[n]=void 0,r.destroy()),i}return!1},Jh.prototype.removeAll=function(){let e=this._collectionsArray;for(let t=0;t<e.length;t++){let i=e[t];i.destroyPrimitives=!0,i.destroy()}this._collections={},this._collectionsArray=[],this._length=0},Jh.prototype.contains=function(e){if(!u(e))return!1;let t=this._collections[e._zIndex];return u(t)&&t.contains(e)},Jh.prototype.update=function(e){if(!this.show)return;let t=this._collectionsArray;for(let i=0;i<t.length;i++)t[i].update(e)},Jh.prototype.isDestroyed=function(){return!1},Jh.prototype.destroy=function(){return this.removeAll(),le(this)};var Yk=Jh,Stt=new U(1,1);function Pj(e){e=y(e,y.EMPTY_OBJECT),this.mass=y(e.mass,1),this.position=h.clone(y(e.position,h.ZERO)),this.velocity=h.clone(y(e.velocity,h.ZERO)),this.life=y(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=z.clone(y(e.startColor,z.WHITE)),this.endColor=z.clone(y(e.endColor,z.WHITE)),this.startScale=y(e.startScale,1),this.endScale=y(e.endScale,1),this.imageSize=U.clone(y(e.imageSize,Stt)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object.defineProperties(Pj.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var wde=new h;Pj.prototype.update=function(e,t){return h.multiplyByScalar(this.velocity,e,wde),h.add(this.position,wde,this.position),u(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};var $v=Pj;function vde(e){e=y(e,y.EMPTY_OBJECT),this.time=y(e.time,0),this.minimum=y(e.minimum,0),this.maximum=y(e.maximum,50),this._complete=!1}Object.defineProperties(vde.prototype,{complete:{get:function(){return this._complete}}});var Dde=vde;function Ide(e){}Ide.prototype.emit=function(e){de.throwInstantiationError()};var Pde=Ide,Ode=new U(1,1);function Qv(e){e=y(e,y.EMPTY_OBJECT),this.show=y(e.show,!0),this.updateCallback=e.updateCallback,this.loop=y(e.loop,!0),this.image=y(e.image,void 0);let t=e.emitter;u(t)||(t=new e3(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._emitterModelMatrix=L.clone(y(e.emitterModelMatrix,L.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new L,this._startColor=z.clone(y(e.color,y(e.startColor,z.WHITE))),this._endColor=z.clone(y(e.color,y(e.endColor,z.WHITE))),this._startScale=y(e.scale,y(e.startScale,1)),this._endScale=y(e.scale,y(e.endScale,1)),this._emissionRate=y(e.emissionRate,5),this._minimumSpeed=y(e.speed,y(e.minimumSpeed,1)),this._maximumSpeed=y(e.speed,y(e.maximumSpeed,1)),this._minimumParticleLife=y(e.particleLife,y(e.minimumParticleLife,5)),this._maximumParticleLife=y(e.particleLife,y(e.maximumParticleLife,5)),this._minimumMass=y(e.mass,y(e.minimumMass,1)),this._maximumMass=y(e.mass,y(e.maximumMass,1)),this._minimumImageSize=U.clone(y(e.imageSize,y(e.minimumImageSize,Ode))),this._maximumImageSize=U.clone(y(e.imageSize,y(e.maximumImageSize,Ode))),this._sizeInMeters=y(e.sizeInMeters,!1),this._lifetime=y(e.lifetime,Number.MAX_VALUE),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new pe,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}function wtt(e){let t=e._emissionRate,i=e._maximumParticleLife,n=0,r=e._bursts;if(u(r)){let e=r.length;for(let t=0;t<e;++t)n+=r[t].maximum}let o=e._billboardCollection,a=e.image,s=Math.ceil(t*i+n),l=e._particles,c=e._particlePool,h=Math.max(s-l.length-c.length,0);for(let e=0;e<h;++e){let e=new $v;e._billboard=o.add({image:a,show:!1}),c.push(e)}e._particleEstimate=s}function vtt(e){let t=e._particlePool.pop();return u(t)||(t=new $v),t}function Dtt(e,t){e._particlePool.push(t)}function Itt(e){let t=e._particles,i=e._particlePool,n=e._billboardCollection,r=t.length,o=i.length,a=e._particleEstimate,s=o-Math.max(a-r-o,0);for(let e=s;e<o;++e){let t=i[e];n.remove(t._billboard)}i.length=s}function Ptt(e){u(e._billboard)&&(e._billboard.show=!1)}function Rde(e,t){let i=t._billboard;u(i)||(i=t._billboard=e._billboardCollection.add({image:t.image})),i.width=t.imageSize.x,i.height=t.imageSize.y,i.position=t.position,i.sizeInMeters=e.sizeInMeters,i.show=!0;let n=P.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),r=P.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),o=P.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),a=P.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);i.color=new z(n,r,o,a),i.scale=P.lerp(t.startScale,t.endScale,t.normalizedAge)}function Ott(e,t){t.startColor=z.clone(e._startColor,t.startColor),t.endColor=z.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=P.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=P.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=P.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=P.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;let i=P.randomBetween(e._minimumSpeed,e._maximumSpeed);h.multiplyByScalar(t.velocity,i,t.velocity),e._particles.push(t)}function Rtt(e,t){if(e._isComplete)return 0;let i=(t=P.mod(t,e._lifetime))*e._emissionRate,n=Math.floor(i);if(e._carryOver+=i-n,e._carryOver>1&&(n++,e._carryOver-=1),u(e.bursts)){let t=e.bursts.length;for(let i=0;i<t;i++){let t=e.bursts[i],r=e._currentTime;u(t)&&!t._complete&&r>t.time&&(n+=P.randomBetween(t.minimum,t.maximum),t._complete=!0)}}return n}Object.defineProperties(Qv.prototype,{emitter:{get:function(){return this._emitter},set:function(e){this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!L.equals(this._modelMatrix,e),L.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){this._matrixDirty=this._matrixDirty||!L.equals(this._emitterModelMatrix,e),L.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){z.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){z.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){this._maximumImageSize=e}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters=e}},lifetime:{get:function(){return this._lifetime},set:function(e){this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});var Xk=new h;Qv.prototype.update=function(e){if(!this.show)return;u(this._billboardCollection)||(this._billboardCollection=new $u),this._updateParticlePool&&(wtt(this),this._updateParticlePool=!1);let t=0;this._previousTime&&(t=J.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);let i,n,r=this._particles,o=this._emitter,a=this.updateCallback,s=r.length;for(i=0;i<s;++i)n=r[i],n.update(t,a)?Rde(this,n):(Ptt(n),Dtt(this,n),r[i]=r[s-1],--i,--s);r.length=s;let l=Rtt(this,t);if(l>0&&u(o)){this._matrixDirty&&(this._combinedMatrix=L.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);let e=this._combinedMatrix;for(i=0;i<l;i++)n=vtt(this),this._emitter.emit(n),h.add(n.position,n.velocity,Xk),L.multiplyByPoint(e,Xk,Xk),n.position=L.multiplyByPoint(e,n.position,n.position),h.subtract(Xk,n.position,n.velocity),h.normalize(n.velocity,n.velocity),Ott(this,n),Rde(this,n)}if(this._billboardCollection.update(e),this._previousTime=J.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=P.mod(this._currentTime,this._lifetime),this.bursts){let e=this.bursts.length;for(i=0;i<e;i++)this.bursts[i]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120==0&&Itt(this)},Qv.prototype.isDestroyed=function(){return!1},Qv.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),le(this)};var Mde=Qv;function Mtt(e){return"string"==typeof e&&(e=document.getElementById(e)),e}var In=Mtt;function Kk(e){e=y(e,y.EMPTY_OBJECT);let t=In(e.container);this._container=t;let i=document.createElement("div");i.className="cesium-performanceDisplay";let n=document.createElement("div");n.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),n.appendChild(this._fpsText);let r=document.createElement("div");r.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),r.appendChild(this._msText),i.appendChild(r),i.appendChild(n),this._container.appendChild(i),this._lastFpsSampleTime=_i(),this._lastMsSampleTime=_i(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;let o=document.createElement("div");o.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),o.appendChild(this._throttledText),i.appendChild(o)}Object.defineProperties(Kk.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),Kk.prototype.update=function(e){let t=_i(),i=y(e,!0);this._fpsFrameCount++;let n=t-this._lastFpsSampleTime;if(n>1e3){let e="N/A";i&&(e=1e3*this._fpsFrameCount/n|0),this._fpsText.nodeValue=`${e} FPS`,this._lastFpsSampleTime=t,this._fpsFrameCount=0}this._msFrameCount++;let r=t-this._lastMsSampleTime;if(r>200){let e="N/A";i&&(e=(r/this._msFrameCount).toFixed(2)),this._msText.nodeValue=`${e} MS`,this._lastMsSampleTime=t,this._msFrameCount=0}},Kk.prototype.destroy=function(){return le(this)};var Xg=Kk;function wx(){this._framebuffer=new di,this._textureToCopy=void 0,this._copyDepthCommand=void 0}function Ltt(e,t,i){let n=i.width,r=i.height;e._framebuffer.update(t,n,r)}function Ntt(e,t,i){if(!u(e._copyDepthCommand)){let i="uniform highp sampler2D u_texture;\nin vec2 v_textureCoordinates;\nvoid main()\n{\n    out_FragColor = czm_packDepth(texture(u_texture, v_textureCoordinates).r);\n}\n";e._copyDepthCommand=t.createViewportQuadCommand(i,{renderState:Ue.fromCache(),uniformMap:{u_texture:function(){return e._textureToCopy}},owner:e})}e._textureToCopy=i,e._copyDepthCommand.framebuffer=e.framebuffer}Object.defineProperties(wx.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}}),wx.prototype.update=function(e,t){Ltt(this,e,t),Ntt(this,e,t)};var Ftt=new oe,Btt=new oe(1,1/255,1/65025,1/16581375);wx.prototype.getDepth=function(e,t,i){if(!u(this.framebuffer))return;let n=e.readPixels({x:t,y:i,width:1,height:1,framebuffer:this.framebuffer}),r=oe.unpack(n,0,Ftt);return oe.divideByScalar(r,255,r),oe.dot(r,Btt)},wx.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},wx.prototype.isDestroyed=function(){return!1},wx.prototype.destroy=function(){return this._framebuffer.destroy(),u(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=u(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy()),le(this)};var Zk=wx;function ktt(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}var Ac=ktt;function Jv(){this._framebuffer=new di({color:!1,depthStencil:!0,supportsDepthTexture:!0}),this._passState=void 0}function Vtt(e){e._framebuffer.destroy()}function Utt(e,t){let i=t.drawingBufferWidth,n=t.drawingBufferHeight;e._framebuffer.update(t,i,n);let r=new Ac(t);r.blendingEnabled=!1,r.scissorTest={enabled:!0,rectangle:new qe},r.viewport=new qe,e._passState=r}Object.defineProperties(Jv.prototype,{framebuffer:{get:function(){return this._framebuffer.framebuffer}}}),Jv.prototype.update=function(e,t,i){let n=i.width,r=i.height;this._framebuffer.isDirty(n,r)&&Utt(this,e);let o=this.framebuffer,a=this._passState;return a.framebuffer=o,a.viewport.width=n,a.viewport.height=r,a.scissorTest.rectangle.x=t.x,a.scissorTest.rectangle.y=r-t.y,a.scissorTest.rectangle.width=1,a.scissorTest.rectangle.height=1,a},Jv.prototype.isDestroyed=function(){return!1},Jv.prototype.destroy=function(){return Vtt(this),le(this)};var $k=Jv;function tD(e){let t=new Ac(e);t.blendingEnabled=!1,t.scissorTest={enabled:!0,rectangle:new qe},t.viewport=new qe,this._context=e,this._fb=new di({depthStencil:!0}),this._passState=t,this._width=0,this._height=0}tD.prototype.begin=function(e,t){let i=this._context,n=t.width,r=t.height;return qe.clone(e,this._passState.scissorTest.rectangle),this._width=n,this._height=r,this._fb.update(i,n,r),this._passState.framebuffer=this._fb.framebuffer,this._passState.viewport.width=n,this._passState.viewport.height=r,this._passState};var eD=new z;tD.prototype.end=function(e){let t=y(e.width,1),i=y(e.height,1),n=this._context,r=n.readPixels({x:e.x,y:e.y,width:t,height:i,framebuffer:this._fb.framebuffer}),o=Math.max(t,i),a=o*o,s=Math.floor(.5*t),l=Math.floor(.5*i),c=0,h=0,d=0,p=-1;for(let e=0;e<a;++e){if(-s<=c&&c<=s&&-l<=h&&h<=l){let e=4*((l-h)*t+c+s);eD.red=z.byteToFloat(r[e]),eD.green=z.byteToFloat(r[e+1]),eD.blue=z.byteToFloat(r[e+2]),eD.alpha=z.byteToFloat(r[e+3]);let i=n.getObjectByPickColor(eD);if(u(i))return i}if(c===h||c<0&&-c===h||c>0&&c===1-h){let e=d;d=-p,p=e}c+=d,h+=p}},tD.prototype.isDestroyed=function(){return!1},tD.prototype.destroy=function(){return this._fb.destroy(),le(this)};var Qk=tD;function Hp(){this._numSamples=1,this._colorFramebuffer=new di({depthStencil:!0,supportsDepthTexture:!0}),this._idFramebuffer=new di({depthStencil:!0,supportsDepthTexture:!0}),this._idClearColor=new z(0,0,0,0),this._clearCommand=new ti({color:new z(0,0,0,0),depth:1,owner:this})}function ztt(e){e._colorFramebuffer.destroy(),e._idFramebuffer.destroy()}Object.defineProperties(Hp.prototype,{framebuffer:{get:function(){return this._colorFramebuffer.framebuffer}},idFramebuffer:{get:function(){return this._idFramebuffer.framebuffer}},depthStencilTexture:{get:function(){return this._colorFramebuffer.getDepthStencilTexture()}}}),Hp.prototype.update=function(e,t,i,n){let r=t.width,o=t.height,a=i?e.halfFloatingPointTexture?Ye.HALF_FLOAT:Ye.FLOAT:Ye.UNSIGNED_BYTE;this._numSamples=n,this._colorFramebuffer.update(e,r,o,n,a),this._idFramebuffer.update(e,r,o)},Hp.prototype.clear=function(e,t,i){z.clone(i,this._clearCommand.color),z.clone(this._idClearColor,this._clearCommand.color),this._colorFramebuffer.clear(e,this._clearCommand,t),this._idFramebuffer.clear(e,this._clearCommand,t)},Hp.prototype.getFramebuffer=function(){return this._colorFramebuffer.framebuffer},Hp.prototype.getIdFramebuffer=function(){return this._idFramebuffer.framebuffer},Hp.prototype.prepareColorTextures=function(e){this._numSamples>1&&this._colorFramebuffer.prepareTextures(e)},Hp.prototype.isDestroyed=function(){return!1},Hp.prototype.destroy=function(){return ztt(this),le(this)};var _C=Hp;function vx(){}vx.getShadowCastShaderKeyword=function(e,t,i,n){return`castShadow ${e} ${t} ${i} ${n}`},vx.createShadowCastVertexShader=function(e,t,i){let n=e.defines.slice(0),r=e.sources.slice(0);n.push("SHADOW_MAP"),i&&n.push("GENERATE_POSITION");let o=He.findPositionVarying(e),a=u(o);if(t&&!a){let e=r.length;for(let t=0;t<e;++t)r[t]=He.replaceMain(r[t],"czm_shadow_cast_main");let t="out vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}";r.push(t)}return new He({defines:n,sources:r})},vx.createShadowCastFragmentShader=function(e,t,i,n){let r=e.defines.slice(0),o=e.sources.slice(0);r.push("SHADOW_MAP");let a=He.findPositionVarying(e),s=u(a);s||(a="v_positionEC");let l=o.length;for(let e=0;e<l;++e)o[e]=He.replaceMain(o[e],"czm_shadow_cast_main");let c="";return t&&(s||(c+="in vec3 v_positionEC; \n"),c+="uniform vec4 shadowMap_lightPositionEC; \n"),c+=n?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (out_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",c+=t?`    float distance = length(${a}); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    out_FragColor = czm_packDepth(distance); \n`:i?"    out_FragColor = vec4(1.0); \n":"    out_FragColor = czm_packDepth(gl_FragCoord.z); \n",c+="} \n",o.push(c),new He({defines:r,sources:o})},vx.getShadowReceiveShaderKeyword=function(e,t,i,n){return`receiveShadow ${e._usesDepthTexture}${e._polygonOffsetSupported}${e._isPointLight}${e._isSpotLight}${e._numberOfCascades>1}${e.debugCascadeColors}${e.softShadows}${t}${i}${n}`},vx.createShadowReceiveVertexShader=function(e,t,i){let n=e.defines.slice(0),r=e.sources.slice(0);return n.push("SHADOW_MAP"),t&&(i?n.push("GENERATE_POSITION_AND_NORMAL"):n.push("GENERATE_POSITION")),new He({defines:n,sources:r})},vx.createShadowReceiveFragmentShader=function(e,t,i,n,r){let o=He.findNormalVarying(e),a=!n&&u(o)||n&&r,s=He.findPositionVarying(e),l=u(s),c=t._usesDepthTexture,h=t._polygonOffsetSupported,d=t._isPointLight,p=t._isSpotLight,f=t._numberOfCascades>1,m=t.debugCascadeColors,_=t.softShadows,g=d?t._pointBias:n?t._terrainBias:t._primitiveBias,y=e.defines.slice(0),v=e.sources.slice(0),b=v.length;for(let e=0;e<b;++e)v[e]=He.replaceMain(v[e],"czm_shadow_receive_main");d?y.push("USE_CUBE_MAP_SHADOW"):c&&y.push("USE_SHADOW_DEPTH_TEXTURE"),_&&!d&&y.push("USE_SOFT_SHADOWS"),f&&i&&n&&(a?y.push("ENABLE_VERTEX_LIGHTING"):y.push("ENABLE_DAYNIGHT_SHADING")),i&&g.normalShading&&a&&(y.push("USE_NORMAL_SHADING"),g.normalShadingSmooth>0&&y.push("USE_NORMAL_SHADING_SMOOTH"));let A,T="";return T+=d?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",A=l?`    return vec4(${s}, 1.0); \n`:"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n",T+=`uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nin vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n${A}} \nvec3 getNormalEC() \n{ \n${a?`    return normalize(${o}); \n`:"    return vec3(1.0); \n"}} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n${g.normalOffset&&a?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":""}} \n`,T+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",T+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",n?T+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":h||(T+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),T+=d?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":p?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":f?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(m?"    // Draw cascade colors for debugging \n    out_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",T+="    out_FragColor.rgb *= visibility; \n} \n",v.push(T),new He({defines:y,sources:v})};var Gp=vx;function em(e){let t=(e=y(e,y.EMPTY_OBJECT)).context;this._enabled=y(e.enabled,!0),this._softShadows=y(e.softShadows,!1),this._normalOffset=y(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=y(e.fromLightSource,!0),this.darkness=y(e.darkness,.3),this._darkness=this.darkness,this.fadingEnabled=y(e.fadingEnabled,!0),this.maximumDistance=y(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;let i,n=!0;(Bt.isInternetExplorer()||Bt.isEdge()||(Bt.isChrome()||Bt.isFirefox())&&Bt.isWindows()&&!t.depthTexture)&&(n=!1),this._polygonOffsetSupported=n,this._terrainBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new L,this._shadowMapTexture=void 0,this._lightDirectionEC=new h,this._lightPositionEC=new oe,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new Jk,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new se,this._isPointLight=y(e.isPointLight,!1),this._pointLightRadius=y(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&y(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?y(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new U,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new Or:u(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new oe,new oe],this._cascadeMatrices=[new L,new L,new L,new L],this._cascadeDistances=new oe,i=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(i);for(let e=0;e<i;++e)this._passes[e]=new Htt(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Rj(this),this._clearCommand=new ti({depth:1,color:new z}),this._clearPassState=new Ac(t),this._size=y(e.size,2048),this.size=this._size}function Htt(e){this.camera=new Jk,this.passState=new Ac(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function Oj(e,t){return Ue.fromCache({cull:{enabled:!0,face:gi.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function Rj(e){let t=!e._usesDepthTexture;e._primitiveRenderState=Oj(t,e._primitiveBias),e._terrainRenderState=Oj(t,e._terrainBias),e._pointRenderState=Oj(t,e._pointBias)}function Mj(e){let t=e._passes.length;for(let i=0;i<t;++i){let t=e._passes[i],n=t.framebuffer;u(n)&&!n.isDestroyed()&&n.destroy(),t.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function Gtt(e,t){let i=new ju({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nl.DEPTH_COMPONENT16}),n=new Ot({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,sampler:un.NEAREST}),r=new oa({context:t,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),o=e._passes.length;for(let t=0;t<o;++t){let i=e._passes[t];i.framebuffer=r,i.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}function Wtt(e,t){let i=new Ot({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:rt.DEPTH_STENCIL,pixelDatatype:Ye.UNSIGNED_INT_24_8,sampler:un.NEAREST}),n=new oa({context:t,depthStencilTexture:i,destroyAttachments:!1}),r=e._passes.length;for(let t=0;t<r;++t){let i=e._passes[t];i.framebuffer=n,i.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=i}function jtt(e,t){let i=new ju({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nl.DEPTH_COMPONENT16}),n=new bc({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,sampler:un.NEAREST}),r=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ];for(let n=0;n<6;++n){let o=new oa({context:t,depthRenderbuffer:i,colorTextures:[r[n]],destroyAttachments:!1}),a=e._passes[n];a.framebuffer=o,a.passState.framebuffer=o}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}function Fde(e,t){e._isPointLight?jtt(e,t):e._usesDepthTexture?Wtt(e,t):Gtt(e,t)}function qtt(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==ee.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,Rj(e),Mj(e),Fde(e,t))}function Ytt(e,t){(!u(e._passes[0].framebuffer)||e._shadowMapTexture.width!==e._textureSize.x)&&(Mj(e),Fde(e,t),qtt(e,t),Bde(e,t))}function Bde(e,t,i){i=y(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}function Xtt(e,t){e._size=t;let i=e._passes,n=i.length,r=e._textureSize;if(e._isPointLight){t=zt.maximumCubeMapSize>=t?t:zt.maximumCubeMapSize,r.x=t,r.y=t;let e=new qe(0,0,t,t);i[0].passState.viewport=e,i[1].passState.viewport=e,i[2].passState.viewport=e,i[3].passState.viewport=e,i[4].passState.viewport=e,i[5].passState.viewport=e}else 1===n?(t=zt.maximumTextureSize>=t?t:zt.maximumTextureSize,r.x=t,r.y=t,i[0].passState.viewport=new qe(0,0,t,t)):4===n&&(t=zt.maximumTextureSize>=2*t?t:zt.maximumTextureSize/2,r.x=2*t,r.y=2*t,i[0].passState.viewport=new qe(0,0,t,t),i[1].passState.viewport=new qe(t,0,t,t),i[2].passState.viewport=new qe(0,t,t,t),i[3].passState.viewport=new qe(t,t,t,t));e._clearPassState.viewport=new qe(0,0,r.x,r.y);for(let e=0;e<n;++e){let t=i[e],n=t.passState.viewport,o=n.x/r.x,a=n.y/r.y,s=n.width/r.x,l=n.height/r.y;t.textureOffsets=new L(s,0,0,o,0,l,0,a,0,0,1,0,0,0,0,1)}}em.MAXIMUM_DISTANCE=2e4,em.prototype.debugCreateRenderStates=function(){Rj(this)},Object.defineProperties(em.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){Xtt(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var Ktt=new qe;function Ztt(e,t){let i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nin vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(czm_textureCube(shadowMap_textureCube, dir)); \n    out_FragColor = vec4(vec3(shadow), 1.0); \n} \n":`uniform sampler2D shadowMap_texture; \nin vec2 v_textureCoordinates; \nvoid main() \n{ \n${e._usesDepthTexture?"    float shadow = texture(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture(shadowMap_texture, v_textureCoordinates)); \n"}    out_FragColor = vec4(vec3(shadow), 1.0); \n} \n`;let n=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return n.pass=Ee.OVERLAY,n}function $tt(e,t){let i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,o=.3*Math.min(n,r),a=Ktt;a.x=n-o,a.y=0,a.width=o,a.height=o;let s=e._debugShadowViewCommand;u(s)||(s=Ztt(e,i),e._debugShadowViewCommand=s),(!u(s.renderState)||!qe.equals(s.renderState.viewport,a))&&(s.renderState=Ue.fromCache({viewport:qe.clone(a)})),t.commandList.push(e._debugShadowViewCommand)}var tm=new Array(8);tm[0]=new oe(-1,-1,-1,1),tm[1]=new oe(1,-1,-1,1),tm[2]=new oe(1,1,-1,1),tm[3]=new oe(-1,1,-1,1),tm[4]=new oe(-1,-1,1,1),tm[5]=new oe(1,-1,1,1),tm[6]=new oe(1,1,1,1),tm[7]=new oe(-1,1,1,1);var Kg=new L,Lj=new Array(8);for(let e=0;e<8;++e)Lj[e]=new oe;function Qtt(e,t){let i=new yt({geometry:new lh({minimum:new h(-.5,-.5,-.5),maximum:new h(.5,.5,.5)}),attributes:{color:kt.fromColor(t)}}),n=new yt({geometry:new X_({radius:.5}),attributes:{color:kt.fromColor(t)}});return new Sn({geometryInstances:[i,n],appearance:new rn({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}var Jtt=[z.RED,z.GREEN,z.BLUE,z.MAGENTA],ent=new h;function tnt(e,t){$tt(e,t);let i=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(i&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new kp({camera:e._sceneCamera,color:z.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){i&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new kp({camera:e._shadowMapCamera,color:z.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(let n=0;n<e._numberOfCascades;++n)i&&(e._debugCascadeFrustums[n]=e._debugCascadeFrustums[n]&&e._debugCascadeFrustums[n].destroy(),e._debugCascadeFrustums[n]=new kp({camera:e._passes[n].camera,color:Jtt[n],updateOnChange:!1})),e._debugCascadeFrustums[n].update(t)}}else if(e._isPointLight){if(!u(e._debugLightFrustum)||e._needsUpdate){let t=e._shadowMapCamera.positionWC,i=Le.IDENTITY,n=2*e._pointLightRadius,r=h.fromElements(n,n,n,ent),o=L.fromTranslationQuaternionRotationScale(t,i,r,Kg);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=Qtt(o,z.YELLOW)}e._debugLightFrustum.update(t)}else(!u(e._debugLightFrustum)||e._needsUpdate)&&(e._debugLightFrustum=new kp({camera:e._shadowMapCamera,color:z.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function Jk(){this.viewMatrix=new L,this.inverseViewMatrix=new L,this.frustum=void 0,this.positionCartographic=new fe,this.positionWC=new h,this.directionWC=h.clone(h.UNIT_Z),this.upWC=h.clone(h.UNIT_Y),this.rightWC=h.clone(h.UNIT_X),this.viewProjectionMatrix=new L}Jk.prototype.clone=function(e){L.clone(e.viewMatrix,this.viewMatrix),L.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),fe.clone(e.positionCartographic,this.positionCartographic),h.clone(e.positionWC,this.positionWC),h.clone(e.directionWC,this.directionWC),h.clone(e.upWC,this.upWC),h.clone(e.rightWC,this.rightWC)};var nnt=new L(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);Jk.prototype.getViewProjection=function(){let e=this.viewMatrix,t=this.frustum.projectionMatrix;return L.multiply(t,e,this.viewProjectionMatrix),L.multiply(nnt,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var int=new Array(5),ont=new Ei,rnt=new Array(4),kde=new h,Vde=new h;function snt(e,t){let i,n=e._shadowMapCamera,r=e._sceneCamera,o=r.frustum.near,a=r.frustum.far,s=e._numberOfCascades,l=a-o,u=a/o,c=.9,d=!1;t.shadowState.closestObjectSize<200&&(d=!0,c=.9);let p=rnt,f=int;for(f[0]=o,f[s]=a,i=0;i<s;++i){let e=(i+1)/s,t=o*Math.pow(u,e),n=o+l*e,r=P.lerp(n,t,c);f[i+1]=r,p[i]=r-f[i]}if(d){for(i=0;i<s;++i)p[i]=Math.min(p[i],e._maximumCascadeDistances[i]);let t=f[0];for(i=0;i<s-1;++i)t+=p[i],f[i+1]=t}oe.unpack(f,0,e._cascadeSplits[0]),oe.unpack(f,1,e._cascadeSplits[1]),oe.unpack(p,0,e._cascadeDistances);let m=n.frustum,_=m.left,g=m.right,y=m.bottom,v=m.top,b=m.near,A=m.far,T=n.positionWC,E=n.directionWC,C=n.upWC,x=r.frustum.clone(ont),S=n.getViewProjection();for(i=0;i<s;++i){x.near=f[i],x.far=f[i+1];let t=L.multiply(x.projectionMatrix,r.viewMatrix,Kg),o=L.inverse(t,Kg),a=L.multiply(S,o,Kg),s=h.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,kde),l=h.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Vde);for(let e=0;e<8;++e){let t=oe.clone(tm[e],Lj[e]);L.multiplyByVector(a,t,t),h.divideByScalar(t,t.w,t),h.minimumByComponent(t,s,s),h.maximumByComponent(t,l,l)}s.x=Math.max(s.x,0),s.y=Math.max(s.y,0),s.z=0,l.x=Math.min(l.x,1),l.y=Math.min(l.y,1),l.z=Math.min(l.z,1);let u=e._passes[i],c=u.camera;c.clone(n);let d=c.frustum;d.left=_+s.x*(g-_),d.right=_+l.x*(g-_),d.bottom=y+s.y*(v-y),d.top=y+l.y*(v-y),d.near=b+s.z*(A-b),d.far=b+l.z*(A-b),u.cullingVolume=c.frustum.computeCullingVolume(T,E,C);let p=e._cascadeMatrices[i];L.multiply(c.getViewProjection(),r.inverseViewMatrix,p),L.multiply(u.textureOffsets,p,p)}}var ant=new L,cnt=new h,lnt=new h,Lde=new h;function unt(e,t){let i=e._shadowMapCamera,n=e._sceneCamera,r=L.multiply(n.frustum.projectionMatrix,n.viewMatrix,Kg),o=L.inverse(r,Kg),a=i.directionWC,s=n.directionWC;h.equalsEpsilon(a,s,P.EPSILON10)&&(s=n.upWC);let l=h.cross(a,s,cnt);s=h.cross(l,a,lnt),h.normalize(s,s),h.normalize(l,l);let u=h.fromElements(0,0,0,Lde),c=L.computeView(u,a,s,l,ant),d=L.multiply(c,o,Kg),p=h.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,kde),f=h.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Vde);for(let e=0;e<8;++e){let t=oe.clone(tm[e],Lj[e]);L.multiplyByVector(d,t,t),h.divideByScalar(t,t.w,t),h.minimumByComponent(t,p,p),h.maximumByComponent(t,f,f)}f.z+=1e3,p.z-=10;let m=Lde;m.x=-.5*(p.x+f.x),m.y=-.5*(p.y+f.y),m.z=-f.z;let _=L.fromTranslation(m,Kg);c=L.multiply(_,c,c);let g=.5*(f.x-p.x),y=.5*(f.y-p.y),v=f.z-p.z,b=i.frustum;b.left=-g,b.right=g,b.bottom=-y,b.top=y,b.near=.01,b.far=v,L.clone(c,i.viewMatrix),L.inverse(c,i.inverseViewMatrix),L.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),h.clone(a,i.directionWC),h.clone(s,i.upWC),h.clone(l,i.rightWC)}var fnt=[new h(-1,0,0),new h(0,-1,0),new h(0,0,-1),new h(1,0,0),new h(0,1,0),new h(0,0,1)],dnt=[new h(0,-1,0),new h(0,0,-1),new h(0,-1,0),new h(0,-1,0),new h(0,0,1),new h(0,-1,0)],hnt=[new h(0,0,1),new h(1,0,0),new h(-1,0,0),new h(0,0,-1),new h(1,0,0),new h(1,0,0)];function mnt(e,t){let i=new Ei;i.fov=P.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(let n=0;n<6;++n){let r=e._passes[n].camera;r.positionWC=e._shadowMapCamera.positionWC,r.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=fnt[n],r.upWC=dnt[n],r.rightWC=hnt[n],L.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),L.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}var pnt=new h,_nt=new h,Ude=new se,Nde=Ude.center;function gnt(e,t){let i=e._sceneCamera,n=e._shadowMapCamera,r=Ude;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);let r=t.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,pnt),o=h.negate(n.directionWC,_nt),a=h.dot(r,o);if(e.fadingEnabled){let t=P.clamp(a/.1,0,1);e._darkness=P.lerp(1,e.darkness,t)}else e._darkness=e.darkness;if(a<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)r.center=n.positionWC,r.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(r)===Zt.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),se.clone(r,e._boundingSphere);else{let i=n.frustum.far/2,o=h.add(n.positionWC,h.multiplyByScalar(n.directionWC,i,Nde),Nde);r.center=o,r.radius=i,e._outOfView=t.cullingVolume.computeVisibility(r)===Zt.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),se.clone(r,e._boundingSphere)}}function ynt(e,t){let i=t.camera,n=e._lightCamera,r=e._sceneCamera,o=e._shadowMapCamera;e._cascadesEnabled?h.clone(n.directionWC,o.directionWC):e._isPointLight?h.clone(n.positionWC,o.positionWC):o.clone(n);let a,s,l=e._lightDirectionEC;L.multiplyByPointAsVector(i.viewMatrix,o.directionWC,l),h.normalize(l,l),h.negate(l,l),L.multiplyByPoint(i.viewMatrix,o.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(a=Math.min(t.shadowState.nearPlane,e.maximumDistance),s=Math.min(t.shadowState.farPlane,e.maximumDistance),s=Math.max(s,a+1)):(a=i.frustum.near,s=e.maximumDistance),e._sceneCamera=oo.clone(i,r),i.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=a,e._sceneCamera.frustum.far=s,e._distance=s-a,gnt(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}em.prototype.update=function(e){if(ynt(this,e),this._needsUpdate)if(Ytt(this,e.context),this._isPointLight&&mnt(this,e),this._cascadesEnabled&&(unt(this,e),this._numberOfCascades>1&&snt(this,e)),this._isPointLight)this._shadowMapCullingVolume=ns.fromBoundingSphere(this._boundingSphere);else{let e=this._shadowMapCamera,t=e.positionWC,i=e.directionWC,n=e.upWC;this._shadowMapCullingVolume=e.frustum.computeCullingVolume(t,i,n),1===this._passes.length&&this._passes[0].camera.clone(e)}if(1===this._passes.length){let e=this._sceneCamera.inverseViewMatrix;L.multiply(this._shadowMapCamera.getViewProjection(),e,this._shadowMapMatrix)}this.debugShow&&tnt(this,e)},em.prototype.updatePass=function(e,t){Bde(this,e,t)};var xnt=new U;function zde(e,t,i){let n=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,r={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){let t=xnt;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,oe.fromElements(t.x,t.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return oe.fromElements(n.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new oe,combinedUniforms2:new oe};return gt(t,r,!1)}function bnt(e,t,i,n,r,o){let a,s,l;if(u(o)&&(a=o.shaderProgram,s=o.renderState,l=o.uniformMap),(o=et.shallowClone(i,o)).castShadows=!0,o.receiveShadows=!1,!u(a)||r!==i.shaderProgram.id||t){let t=i.shaderProgram,r=i.pass===Ee.GLOBE,o=i.pass!==Ee.TRANSLUCENT,c=e._isPointLight,h=e._usesDepthTexture,d=Gp.getShadowCastShaderKeyword(c,r,h,o);if(a=n.shaderCache.getDerivedShaderProgram(t,d),!u(a)){let e=t.vertexShaderSource,i=t.fragmentShaderSource,s=Gp.createShadowCastVertexShader(e,c,r),l=Gp.createShadowCastFragmentShader(i,c,h,o);a=n.shaderCache.createDerivedShaderProgram(t,d,{vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:t._attributeLocations})}s=e._primitiveRenderState,c?s=e._pointRenderState:r&&(s=e._terrainRenderState),i.renderState.cull.enabled||(s=Ge(s,!1),s.cull=Ge(s.cull,!1),s.cull.enabled=!1,s=Ue.fromCache(s)),l=zde(e,i.uniformMap,r)}return o.shaderProgram=a,o.renderState=s,o.uniformMap=l,o}em.createReceiveDerivedCommand=function(e,t,i,n,r){u(r)||(r={});let o=e.length>0,a=t.shaderProgram,s=a.vertexShaderSource,l=a.fragmentShaderSource,c=t.pass===Ee.GLOBE,h=!1;if(c&&(h=t.owner.data.renderedMesh.encoding.hasVertexNormals),t.receiveShadows&&o){let o,d;u(r.receiveCommand)&&(o=r.receiveCommand.shaderProgram,d=r.receiveCommand.uniformMap),r.receiveCommand=et.shallowClone(t,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;let p=r.receiveShaderCastShadows!==t.castShadows,f=r.receiveShaderProgramId!==t.shaderProgram.id;if(!u(o)||f||i||p){let i=Gp.getShadowReceiveShaderKeyword(e[0],t.castShadows,c,h);if(o=n.shaderCache.getDerivedShaderProgram(a,i),!u(o)){let r=Gp.createShadowReceiveVertexShader(s,c,h),u=Gp.createShadowReceiveFragmentShader(l,e[0],t.castShadows,c,h);o=n.shaderCache.createDerivedShaderProgram(a,i,{vertexShaderSource:r,fragmentShaderSource:u,attributeLocations:a._attributeLocations})}d=zde(e[0],t.uniformMap,c)}r.receiveCommand.shaderProgram=o,r.receiveCommand.uniformMap=d,r.receiveShaderProgramId=t.shaderProgram.id,r.receiveShaderCastShadows=t.castShadows}return r},em.createCastDerivedCommand=function(e,t,i,n,r){if(u(r)||(r={}),t.castShadows){let o=r.castCommands;u(o)||(o=r.castCommands=[]);let a=r.castShaderProgramId,s=e.length;o.length=s;for(let r=0;r<s;++r)o[r]=bnt(e[r],i,t,n,a,o[r]);r.castShaderProgramId=t.shaderProgram.id}return r},em.prototype.isDestroyed=function(){return!1},em.prototype.destroy=function(){Mj(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(let e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return le(this)};var Zg=em,eV="uniform sampler2D u_opaqueDepthTexture;\nuniform sampler2D u_translucentDepthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    float opaqueDepth = texture(u_opaqueDepthTexture, v_textureCoordinates).r;\n    float translucentDepth = texture(u_translucentDepthTexture, v_textureCoordinates).r;\n    translucentDepth = czm_branchFreeTernary(translucentDepth > opaqueDepth, 1.0, translucentDepth);\n    out_FragColor = czm_packDepth(translucentDepth);\n}\n",gC="uniform sampler2D colorTexture;\n\n#ifdef DEBUG_SHOW_DEPTH\nuniform sampler2D u_packedTranslucentDepth;\n#endif\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n#ifdef DEBUG_SHOW_DEPTH\n    if (v_textureCoordinates.x < 0.5)\n    {\n        out_FragColor.rgb = vec3(czm_unpackDepth(texture(u_packedTranslucentDepth, v_textureCoordinates)));\n        out_FragColor.a = 1.0;\n    }\n#else\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n\n#ifdef PICK\n    if (color == vec4(0.0))\n    {\n        discard;\n    }\n#else\n    // Reverse premultiplication process to get the correct composited result of the classification primitives\n    color.rgb /= color.a;\n#endif\n    out_FragColor = color;\n#endif\n}\n",Tnt=!1;function $g(e){this._drawClassificationFBO=new di({createDepthAttachments:!1}),this._accumulationFBO=new di({createDepthAttachments:!1}),this._packFBO=new di,this._opaqueDepthStencilTexture=void 0,this._textureToComposite=void 0,this._translucentDepthStencilTexture=void 0,this._packDepthCommand=void 0,this._accumulateCommand=void 0,this._compositeCommand=void 0,this._copyCommand=void 0,this._clearColorCommand=new ti({color:new z(0,0,0,0),owner:this}),this._clearDepthStencilCommand=new ti({depth:1,stencil:0,owner:this}),this._supported=e.depthTexture,this._viewport=new qe,this._rsDepth=void 0,this._rsAccumulate=void 0,this._rsComp=void 0,this._useScissorTest=void 0,this._scissorRectangle=void 0,this._hasTranslucentDepth=!1,this._frustumsDrawn=0}function Hde(e){e._textureToComposite=void 0,e._translucentDepthStencilTexture=e._translucentDepthStencilTexture&&!e._translucentDepthStencilTexture.isDestroyed()&&e._translucentDepthStencilTexture.destroy()}function Gde(e){e._drawClassificationFBO.destroy(),e._accumulationFBO.destroy(),e._packFBO.destroy()}function Ant(e,t,i,n){Hde(e),e._translucentDepthStencilTexture=new Ot({context:t,width:i,height:n,pixelFormat:rt.DEPTH_STENCIL,pixelDatatype:Ye.UNSIGNED_INT_24_8,sampler:un.NEAREST})}function Cnt(e,t,i,n){Gde(e),e._drawClassificationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._drawClassificationFBO.update(t,i,n),e._accumulationFBO.setDepthStencilTexture(e._translucentDepthStencilTexture),e._accumulationFBO.update(t,i,n),e._packFBO.update(t,i,n)}function Ent(e,t,i,n){if(!e.isSupported())return;e._opaqueDepthStencilTexture=n;let r,o,a=e._opaqueDepthStencilTexture.width,s=e._opaqueDepthStencilTexture.height;if(e._drawClassificationFBO.isDirty(a,s)&&(Ant(e,t,a,s),Cnt(e,t,a,s)),u(e._packDepthCommand)||(r=new He({sources:[eV]}),o={u_opaqueDepthTexture:function(){return e._opaqueDepthStencilTexture},u_translucentDepthTexture:function(){return e._translucentDepthStencilTexture}},e._packDepthCommand=t.createViewportQuadCommand(r,{uniformMap:o,owner:e})),!u(e._compositeCommand)){r=new He({sources:[gC]}),o={colorTexture:function(){return e._textureToComposite}},Tnt&&(r.defines=["DEBUG_SHOW_DEPTH"],o.u_packedTranslucentDepth=function(){return e._packFBO.getColorTexture()}),e._compositeCommand=t.createViewportQuadCommand(r,{uniformMap:o,owner:e});let i=e._compositeCommand,n=i.shaderProgram,a=t.shaderCache.createDerivedShaderProgram(n,"pick",{vertexShaderSource:n.vertexShaderSource,fragmentShaderSource:new He({sources:r.sources,defines:["PICK"]}),attributeLocations:n._attributeLocations}),s=et.shallowClone(i);s.shaderProgram=a,i.derivedCommands.pick=s}u(e._copyCommand)||(r=new He({sources:[gC]}),o={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._copyCommand=t.createViewportQuadCommand(r,{uniformMap:o,owner:e})),u(e._accumulateCommand)||(r=new He({sources:[gC]}),o={colorTexture:function(){return e._drawClassificationFBO.getColorTexture()}},e._accumulateCommand=t.createViewportQuadCommand(r,{uniformMap:o,owner:e})),e._viewport.width=a,e._viewport.height=s;let l=!qe.equals(e._viewport,i.viewport),c=l!==e._useScissorTest;e._useScissorTest=l,qe.equals(e._scissorRectangle,i.viewport)||(e._scissorRectangle=qe.clone(i.viewport,e._scissorRectangle),c=!0),(!u(e._rsDepth)||!qe.equals(e._viewport,e._rsDepth.viewport)||c)&&(e._rsDepth=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}})),u(e._packDepthCommand)&&(e._packDepthCommand.renderState=e._rsDepth),(!u(e._rsAccumulate)||!qe.equals(e._viewport,e._rsAccumulate.viewport)||c)&&(e._rsAccumulate=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:Un.EQUAL,reference:Lt.CESIUM_3D_TILE_MASK}})),u(e._accumulateCommand)&&(e._accumulateCommand.renderState=e._rsAccumulate),(!u(e._rsComp)||!qe.equals(e._viewport,e._rsComp.viewport)||c)&&(e._rsComp=Ue.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},blending:ln.ALPHA_BLEND})),u(e._compositeCommand)&&(e._compositeCommand.renderState=e._rsComp,e._compositeCommand.derivedCommands.pick.renderState=e._rsComp)}function Snt(e,t,i){if(!e._hasTranslucentDepth)return;let n=i.framebuffer;i.framebuffer=e._drawClassificationFBO.framebuffer,e._clearColorCommand.execute(t._context,i),i.framebuffer=n,e._frustumsDrawn>1&&(i.framebuffer=e._accumulationFBO.framebuffer,e._clearColorCommand.execute(t._context,i)),e._hasTranslucentDepth=!1,e._frustumsDrawn=0}Object.defineProperties($g.prototype,{hasTranslucentDepth:{get:function(){return this._hasTranslucentDepth}}}),$g.prototype.executeTranslucentCommands=function(e,t,i,n,r){let o,a,s=n.length,l=e.frameState.useLogDepth,u=e.context,c=i.framebuffer;for(a=0;a<s;++a)if(o=n[a],o=l?o.derivedCommands.logDepth.command:o,o.depthForTranslucentClassification){this._hasTranslucentDepth=!0;break}if(this._hasTranslucentDepth){for(Ent(this,u,i,r),i.framebuffer=this._drawClassificationFBO.framebuffer,this._clearDepthStencilCommand.execute(u,i),a=0;a<s;++a){if(o=n[a],o=l?o.derivedCommands.logDepth.command:o,!o.depthForTranslucentClassification)continue;t(o.derivedCommands.depth.depthOnlyCommand,e,u,i)}this._frustumsDrawn+=this._hasTranslucentDepth?1:0,this._hasTranslucentDepth&&(i.framebuffer=this._packFBO.framebuffer,this._packDepthCommand.execute(u,i)),i.framebuffer=c}},$g.prototype.executeClassificationCommands=function(e,t,i,n){if(!this._hasTranslucentDepth)return;let r=e.context,o=r.uniformState,a=i.framebuffer;2===this._frustumsDrawn&&(i.framebuffer=this._accumulationFBO.framebuffer,this._copyCommand.execute(r,i)),i.framebuffer=this._drawClassificationFBO.framebuffer,this._frustumsDrawn>1&&this._clearColorCommand.execute(r,i),o.updatePass(Ee.CESIUM_3D_TILE_CLASSIFICATION);let s=o.globeDepthTexture;o.globeDepthTexture=this._packFBO.getColorTexture();let l=n.commands[Ee.CESIUM_3D_TILE_CLASSIFICATION],u=n.indices[Ee.CESIUM_3D_TILE_CLASSIFICATION];for(let n=0;n<u;++n)t(l[n],e,r,i);o.globeDepthTexture=s,i.framebuffer=a,1!==this._frustumsDrawn&&(i.framebuffer=this._accumulationFBO.framebuffer,this._accumulateCommand.execute(r,i),i.framebuffer=a)},$g.prototype.execute=function(e,t){this._hasTranslucentDepth&&(1===this._frustumsDrawn?this._textureToComposite=this._drawClassificationFBO.getColorTexture():this._textureToComposite=this._accumulationFBO.getColorTexture(),(e.frameState.passes.pick?this._compositeCommand.derivedCommands.pick:this._compositeCommand).execute(e.context,t),Snt(this,e,t))},$g.prototype.isSupported=function(){return this._supported},$g.prototype.isDestroyed=function(){return!1},$g.prototype.destroy=function(){return Hde(this),Gde(this),u(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),u(this._packDepthCommand)&&(this._packDepthCommand.shaderProgram=this._packDepthCommand.shaderProgram&&this._packDepthCommand.shaderProgram.destroy()),le(this)};var tV=$g;function wnt(){this.command=void 0,this.near=void 0,this.far=void 0}function nV(e,t,i){let n,r,o=e.context;o.depthTexture&&(n=new gk),e._useOIT&&o.depthTexture&&(r=new Wk(o));let a=new Ac(o);a.viewport=qe.clone(i),this.camera=t,this._cameraClone=oo.clone(t),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=i,this.passState=a,this.pickFramebuffer=new Qk(o),this.pickDepthFramebuffer=new $k,this.sceneFramebuffer=new _C,this.globeDepth=n,this.globeTranslucencyFramebuffer=new yk,this.oit=r,this.translucentTileClassification=new tV(o),this.pickDepths=[],this.frustumCommandsList=[],this.debugFrustumStatistics=void 0,this._commandExtents=[]}var Wde=new h,jde=new h;function vnt(e,t){let i=Math.max(Math.abs(e.x),Math.abs(t.x)),n=Math.max(Math.abs(e.y),Math.abs(t.y)),r=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.max(Math.max(i,n),r)}function Dnt(e,t,i){let n=1/Math.max(1,vnt(e.position,t.position));return h.multiplyByScalar(e.position,n,Wde),h.multiplyByScalar(t.position,n,jde),h.equalsEpsilon(Wde,jde,i)&&h.equalsEpsilon(e.direction,t.direction,i)&&h.equalsEpsilon(e.up,t.up,i)&&h.equalsEpsilon(e.right,t.right,i)&&L.equalsEpsilon(e.transform,t.transform,i)&&e.frustum.equalsEpsilon(t.frustum,i)}function Int(e,t,i,n){let r,o=t.frameState,a=o.camera,s=o.useLogDepth?t.logarithmicDepthFarToNearRatio:t.farToNearRatio,l=t.mode===te.SCENE2D,c=t.nearToFarDistance2D;n*=1+P.EPSILON2,i=Math.min(Math.max(i,a.frustum.near),a.frustum.far),n=Math.max(Math.min(n,a.frustum.far),i),l?(n=Math.min(n,a.position.z+t.nearToFarDistance2D),i=Math.min(i,n),r=Math.ceil(Math.max(1,n-i)/t.nearToFarDistance2D)):r=Math.ceil(Math.log(n/i)/Math.log(s));let h=e.frustumCommandsList;h.length=r;for(let e=0;e<r;++e){let t,r;l?(t=Math.min(n-c,i+e*c),r=Math.min(n,t+c)):(t=Math.max(i,Math.pow(s,e)*i),r=Math.min(n,s*t));let o=h[e];u(o)?(o.near=t,o.far=r):o=h[e]=new z3(t,r)}}function Pnt(e,t,i,n,r){t.debugShowFrustums&&(i.debugOverlappingFrustums=0);let o=e.frustumCommandsList,a=o.length;for(let e=0;e<a;++e){let a=o[e],s=a.near;if(n>a.far)continue;if(r<s)break;let l=i.pass,u=a.indices[l]++;if(a.commands[l][u]=i,t.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<e),i.executeInClosestFrustum)break}if(t.debugShowFrustums){let t=e.debugFrustumStatistics.commandsInFrustums;t[i.debugOverlappingFrustums]=u(t[i.debugOverlappingFrustums])?t[i.debugOverlappingFrustums]+1:1,++e.debugFrustumStatistics.totalCommands}t.updateDerivedCommands(i)}nV.prototype.checkForCameraUpdates=function(e){let t=this.camera,i=this._cameraClone;return Dnt(t,i,P.EPSILON15)?(this._cameraStartFired&&_i()-this._cameraMovedTime>e.cameraEventWaitTime&&(t.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(t.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=_i(),oo.clone(t,i),!0)};var qde=new ns,Ont=new Uc;nV.prototype.createPotentiallyVisibleSet=function(e){let t=e.frameState,i=t.camera,n=i.directionWC,r=i.positionWC,o=e._computeCommandList,a=e._overlayCommandList,s=t.commandList;e.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});let l=this.frustumCommandsList,c=l.length,h=Ee.NUMBER_OF_PASSES;for(let e=0;e<c;++e)for(let t=0;t<h;++t)l[e].indices[t]=0;o.length=0,a.length=0;let d=this._commandExtents,p=d.length,f=0,m=+Number.MAX_VALUE,_=-Number.MAX_VALUE,g=t.shadowState.shadowsEnabled,y=+Number.MAX_VALUE,v=-Number.MAX_VALUE,b=Number.MAX_VALUE,A=t.mode===te.SCENE3D?t.occluder:void 0,T=t.cullingVolume,E=qde.planes;for(let e=0;e<5;++e)E[e]=T.planes[e];T=qde;let C,x,S=s.length;for(let t=0;t<S;++t){let l=s[t],c=l.pass;if(c===Ee.COMPUTE)o.push(l);else if(c===Ee.OVERLAY)a.push(l);else{let t,o,a=l.boundingVolume;if(u(a)){if(!e.isVisible(l,T,A))continue;let i=a.computePlaneDistances(r,n,Ont);if(t=i.start,o=i.stop,m=Math.min(m,t),_=Math.max(_,o),g&&l.receiveShadows&&t<Zg.MAXIMUM_DISTANCE&&!(c===Ee.GLOBE&&t<-100&&o>100)){let e=o-t;c!==Ee.GLOBE&&t<100&&(b=Math.min(b,e)),y=Math.min(y,t),v=Math.max(v,o)}}else l instanceof ti?(t=i.frustum.near,o=i.frustum.far):(t=i.frustum.near,o=i.frustum.far,m=Math.min(m,t),_=Math.max(_,o));let s=d[f];u(s)||(s=d[f]=new wnt),s.command=l,s.near=t,s.far=o,f++}}for(g&&(y=Math.min(Math.max(y,i.frustum.near),i.frustum.far),v=Math.max(Math.min(v,i.frustum.far),y)),g&&(t.shadowState.nearPlane=y,t.shadowState.farPlane=v,t.shadowState.closestObjectSize=b),Int(this,e,m,_),C=0;C<f;C++)x=d[C],Pnt(this,e,x.command,x.near,x.far);if(f<p)for(C=f;C<p&&(x=d[C],u(x.command));C++)x.command=void 0;let w=l.length,I=t.frustumSplits;I.length=w+1;for(let e=0;e<w;++e)I[e]=l[e].near,e===w-1&&(I[e+1]=l[e].far)},nV.prototype.destroy=function(){this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy(),this.translucentTileClassification=this.translucentTileClassification&&this.translucentTileClassification.destroy(),this.globeTranslucencyFramebuffer=this.globeTranslucencyFramebuffer&&this.globeTranslucencyFramebuffer.destroy();let e,t=this.pickDepths,i=t.length;for(e=0;e<i;++e)t[e].destroy()};var yC=nV,Xde=.1,Rnt=new gd({pass:Io.MOST_DETAILED_PRELOAD}),Mnt=new gd({pass:Io.MOST_DETAILED_PICK}),Nj=new gd({pass:Io.PICK});function da(e){this._mostDetailedRayPicks=[],this.pickRenderStateCache={},this._pickPositionCache={},this._pickPositionCacheDirty=!1;let t=new qe(0,0,1,1),i=new oo(e);i.frustum=new Qt({width:Xde,aspectRatio:1,near:.1}),this._pickOffscreenView=new yC(e,i,t)}da.prototype.update=function(){this._pickPositionCacheDirty=!0},da.prototype.getPickDepth=function(e,t){let i=e.view.pickDepths,n=i[t];return u(n)||(n=new Zk,i[t]=n),n};var Lnt=new Or,Nnt=new h,iV=new h,Fnt=new U,Bnt=new L;function knt(e,t,i,n,r){let o=e.camera,a=o.frustum,s=a.offCenterFrustum;u(s)&&(a=s);let l=2*(t.x-r.x)/r.width-1;l*=.5*(a.right-a.left);let c=2*(r.height-t.y-r.y)/r.height-1;c*=.5*(a.top-a.bottom);let d=L.clone(o.transform,Bnt);o._setTransform(L.IDENTITY);let p=h.clone(o.position,Nnt);h.multiplyByScalar(o.right,l,iV),h.add(iV,p,p),h.multiplyByScalar(o.up,c,iV),h.add(iV,p,p),o._setTransform(d),e.mode===te.SCENE2D&&h.fromElements(p.z,p.x,p.y,p);let f=a.getPixelDimensions(r.width,r.height,1,1,Fnt),m=Lnt;return m.right=.5*f.x,m.left=-m.right,m.top=.5*f.y,m.bottom=-m.top,m.near=a.near,m.far=a.far,m.computeCullingVolume(p,o.directionWC,o.upWC)}var Vnt=new $c,Unt=new U;function znt(e,t,i,n,r){let o=e.camera,a=o.frustum,s=a.near,l=Math.tan(.5*a.fovy),u=a.aspectRatio*l,c=(2*(t.x-r.x)/r.width-1)*s*u,h=(2*(r.height-t.y-r.y)/r.height-1)*s*l,d=a.getPixelDimensions(r.width,r.height,1,1,Unt),p=d.x*i*.5,f=d.y*n*.5,m=Vnt;return m.top=h+f,m.bottom=h-f,m.right=c+p,m.left=c-p,m.near=s,m.far=a.far,m.computeCullingVolume(o.positionWC,o.directionWC,o.upWC)}function Kde(e,t,i,n,r){let o=e.camera.frustum;return o instanceof Qt||o instanceof Or?knt(e,t,i,n,r):znt(e,t,i,n,r)}var xC=3,nD=3,nm=new qe(0,0,xC,nD),Zde=new U,Fj=new z(0,0,0,0);function Hnt(e,t){let i=e.context,n=e.frameState,r=e.environmentState,o=e.defaultView;e.view=o;let a=o.viewport;a.x=0,a.y=0,a.width=i.drawingBufferWidth,a.height=i.drawingBufferHeight;let s=o.passState;s.viewport=qe.clone(a,s.viewport),e.clearPasses(n.passes),n.passes.pick=!0,n.passes.depth=!0,n.cullingVolume=Kde(e,t,1,1,a),n.tilesetPassState=Nj,e.updateEnvironment(),r.renderTranslucentDepthForPick=!0,s=o.pickDepthFramebuffer.update(i,t,a),e.updateAndExecuteCommands(s,Fj),e.resolveFramebuffers(s),i.endFrame()}da.prototype.pick=function(e,t,i,n){xC=y(i,3),nD=y(n,xC);let r=e.context,o=r.uniformState,a=e.frameState,s=e.defaultView;e.view=s;let l=s.viewport;l.x=0,l.y=0,l.width=r.drawingBufferWidth,l.height=r.drawingBufferHeight;let u=s.passState;u.viewport=qe.clone(l,u.viewport);let c=$i.transformWindowToDrawingBuffer(e,t,Zde);e.jobScheduler.disableThisFrame(),e.updateFrameState(),a.cullingVolume=Kde(e,c,xC,nD,l),a.invertClassification=!1,a.passes.pick=!0,a.tilesetPassState=Nj,o.update(a),e.updateEnvironment(),nm.x=c.x-.5*(xC-1),nm.y=e.drawingBufferHeight-c.y-.5*(nD-1),nm.width=xC,nm.height=nD,u=s.pickFramebuffer.begin(nm,s.viewport),e.updateAndExecuteCommands(u,Fj),e.resolveFramebuffers(u);let h=s.pickFramebuffer.end(nm);return r.endFrame(),h};var Gnt=new Ei,Wnt=new $c,jnt=new Qt,qnt=new Or;da.prototype.pickPositionWorldCoordinates=function(e,t,i){if(!e.useDepthPicking)return;let n=t.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(n))return h.clone(this._pickPositionCache[n],i);let r=e.frameState,o=e.context,a=o.uniformState,s=e.defaultView;e.view=s;let l=$i.transformWindowToDrawingBuffer(e,t,Zde);e.pickTranslucentDepth?Hnt(e,l):(e.updateFrameState(),a.update(r),e.updateEnvironment()),l.y=e.drawingBufferHeight-l.y;let c,d=e.camera;c=u(d.frustum.fov)?d.frustum.clone(Gnt):u(d.frustum.infiniteProjectionMatrix)?d.frustum.clone(Wnt):u(d.frustum.width)?d.frustum.clone(jnt):d.frustum.clone(qnt);let p=s.frustumCommandsList,f=p.length;for(let t=0;t<f;++t){let s=this.getPickDepth(e,t).getDepth(o,l.x,l.y);if(u(s)&&s>0&&s<1){let o,u=p[t];return e.mode===te.SCENE2D?(o=d.position.z,d.position.z=o-u.near+1,c.far=Math.max(1,u.far-u.near),c.near=1,a.update(r),a.updateFrustum(c)):(c.near=u.near*(0!==t?e.opaqueFrustumNearOffset:1),c.far=u.far,a.updateFrustum(c)),i=$i.drawingBufferToWgs84Coordinates(e,l,s,i),e.mode===te.SCENE2D&&(d.position.z=o,a.update(r)),this._pickPositionCache[n]=h.clone(i),i}}this._pickPositionCache[n]=void 0};var Ynt=new fe;function $de(e,t){let i,n,r=[],o=[],a=[],s=[];u(e)||(e=Number.MAX_VALUE);let l=t();for(;u(l);){let i=l.object,c=l.position,h=l.exclude;if(u(c)&&!u(i)){r.push(l);break}if(!u(i)||!u(i.primitive)||!h&&(r.push(l),0>=--e))break;let d=i.primitive,p=!1;"function"==typeof d.getGeometryInstanceAttributes&&u(i.id)&&(n=d.getGeometryInstanceAttributes(i.id),u(n)&&u(n.show)&&(p=!0,n.show=gn.toValue(!1,n.show),a.push(n))),i instanceof Fs&&(p=!0,i.show=!1,s.push(i)),p||(d.show=!1,o.push(d)),l=t()}for(i=0;i<o.length;++i)o[i].show=!0;for(i=0;i<a.length;++i)n=a[i],n.show=gn.toValue(!0,n.show);for(i=0;i<s.length;++i)s[i].show=!0;return r}da.prototype.pickPosition=function(e,t,i){if(i=this.pickPositionWorldCoordinates(e,t,i),u(i)&&e.mode!==te.SCENE3D){h.fromElements(i.y,i.z,i.x,i);let t=e.mapProjection,n=t.ellipsoid,r=t.unproject(i,Ynt);n.cartographicToCartesian(r,i)}return i},da.prototype.drillPick=function(e,t,i,n,r){let o=this;return $de(i,(function(){let i=o.pick(e,t,n,r);if(u(i))return{object:i,position:void 0,exclude:!1}})).map((function(e){return e.object}))};var Yde=new h,Xnt=new h;function Knt(e,t,i){this.ray=e,this.width=t,this.tilesets=i,this.ready=!1;let n=this;this.promise=new Promise((e=>{n._completePick=()=>{e()}}))}function Qde(e,t,i,n){let r=t.direction,o=h.mostOrthogonalAxis(r,Yde),a=h.cross(r,o,Yde),s=h.cross(r,a,Xnt);return n.position=t.origin,n.direction=r,n.up=s,n.right=a,n.frustum.width=y(i,Xde),n.frustum.computeCullingVolume(n.positionWC,n.directionWC,n.upWC)}function Znt(e,t,i){let n=t.frameState,r=i.ray,o=i.width,a=i.tilesets,s=e._pickOffscreenView.camera,l=Qde(e,r,o,s),u=Rnt;u.camera=s,u.cullingVolume=l;let c=!0,h=a.length;for(let e=0;e<h;++e){let i=a[e];i.show&&t.primitives.contains(i)&&(i.updateForPass(n,u),c=c&&u.ready)}return c&&i._completePick(),c}function Jde(e,t,i){let n=e.length;for(let r=0;r<n;++r){let n=e.get(r);n.show&&(u(n.isCesium3DTileset)?(!u(t)||-1===t.indexOf(n))&&i.push(n):n instanceof tu&&Jde(n,t,i))}}function oV(e,t,i,n,r,o){let a=[];if(Jde(t.primitives,n,a),0===a.length)return Promise.resolve(o());let s=new Knt(i,r,a);return e._mostDetailedRayPicks.push(s),s.promise.then((function(){return o()}))}function $nt(e,t){return!(!u(e)||!u(t)||0===t.length)&&(t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1)}function Qnt(e,t,i,n,r,o,a){let s=t.context,l=s.uniformState,c=t.frameState,h=e._pickOffscreenView;t.view=h,Qde(e,i,r,h.camera),nm=qe.clone(h.viewport,nm);let d=h.pickFramebuffer.begin(nm,h.viewport);t.jobScheduler.disableThisFrame(),t.updateFrameState(),c.invertClassification=!1,c.passes.pick=!0,c.passes.offscreen=!0,c.tilesetPassState=a?Mnt:Nj,l.update(c),t.updateEnvironment(),t.updateAndExecuteCommands(d,Fj),t.resolveFramebuffers(d);let p,f=h.pickFramebuffer.end(nm);if(t.context.depthTexture){let n=h.frustumCommandsList.length;for(let r=0;r<n;++r){let n=e.getPickDepth(t,r).getDepth(s,0,0);if(u(n)&&n>0&&n<1){let e=h.frustumCommandsList[r],o=e.near*(0!==r?t.opaqueFrustumNearOffset:1),a=o+n*(e.far-o);p=Tn.getPoint(i,a);break}}}if(t.view=t.defaultView,s.endFrame(),u(f)||u(p))return{object:f,position:p,exclude:!u(p)&&o||$nt(f,n)}}function ehe(e,t,i,n,r,o,a,s){return $de(n,(function(){return Qnt(e,t,i,r,o,a,s)}))}function bC(e,t,i,n,r,o,a){let s=ehe(e,t,i,1,n,r,o,a);if(s.length>0)return s[0]}function the(e,t,i,n,r,o,a,s){return ehe(e,t,i,n,r,o,a,s)}function rV(e,t){return new Promise(((i,n)=>{t.then((function(t){let n=e.postRender.addEventListener((function(){n(),i(t)}));e.requestRender()})).catch((function(e){n(e)}))}))}da.prototype.updateMostDetailedRayPicks=function(e){let t=this._mostDetailedRayPicks;for(let i=0;i<t.length;++i)Znt(this,e,t[i])&&t.splice(i--,1)},da.prototype.pickFromRay=function(e,t,i,n){return bC(this,e,t,i,n,!1,!1)},da.prototype.drillPickFromRay=function(e,t,i,n,r){return the(this,e,t,i,n,r,!1,!1)},da.prototype.pickFromRayMostDetailed=function(e,t,i,n){let r=this;return t=Tn.clone(t),i=u(i)?i.slice():i,rV(e,oV(r,e,t,i,n,(function(){return bC(r,e,t,i,n,!1,!0)})))},da.prototype.drillPickFromRayMostDetailed=function(e,t,i,n,r){let o=this;return t=Tn.clone(t),n=u(n)?n.slice():n,rV(e,oV(o,e,t,n,r,(function(){return the(o,e,t,i,n,r,!1,!0)})))};var Jnt=new h,eit=new h,tit=new Tn,nhe=new fe;function Bj(e,t){let i=e.globe,n=u(i)?i.ellipsoid:e.mapProjection.ellipsoid,r=li._defaultMaxTerrainHeight,o=n.geodeticSurfaceNormalCartographic(t,eit),a=fe.toCartesian(t,n,Jnt),s=tit;s.origin=a,s.direction=o;let l=new Tn;return Tn.getPoint(s,r,l.origin),h.negate(o,l.direction),l}function ihe(e,t){let i=e.globe,n=u(i)?i.ellipsoid:e.mapProjection.ellipsoid;return Bj(e,fe.fromCartesian(t,n,nhe))}function ohe(e,t){let i=e.globe,n=u(i)?i.ellipsoid:e.mapProjection.ellipsoid;return fe.fromCartesian(t,n,nhe).height}function nit(e,t,i,n,r){let o=Bj(t,i);return oV(e,t,o,n,r,(function(){let i=bC(e,t,o,n,r,!0,!0);if(u(i))return ohe(t,i.position)}))}function iit(e,t,i,n,r,o){let a=ihe(t,i);return oV(e,t,a,n,r,(function(){let i=bC(e,t,a,n,r,!0,!0);if(u(i))return h.clone(i.position,o)}))}da.prototype.sampleHeight=function(e,t,i,n){let r=bC(this,e,Bj(e,t),i,n,!0,!1);if(u(r))return ohe(e,r.position)},da.prototype.clampToHeight=function(e,t,i,n,r){let o=bC(this,e,ihe(e,t),i,n,!0,!1);if(u(o))return h.clone(o.position,r)},da.prototype.sampleHeightMostDetailed=function(e,t,i,n){i=u(i)?i.slice():i;let r=t.length,o=new Array(r);for(let a=0;a<r;++a)o[a]=nit(this,e,t[a],i,n);return rV(e,Promise.all(o).then((function(e){let i=e.length;for(let n=0;n<i;++n)t[n].height=e[n];return t})))},da.prototype.clampToHeightMostDetailed=function(e,t,i,n){i=u(i)?i.slice():i;let r=t.length,o=new Array(r);for(let a=0;a<r;++a)o[a]=iit(this,e,t[a],i,n,t[a]);return rV(e,Promise.all(o).then((function(e){let i=e.length;for(let n=0;n<i;++n)t[n]=e[n];return t})))},da.prototype.destroy=function(){this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy()};var sV=da,ahe=or(qI(),1),oit={modifyFragmentShader:function(e){return e=He.replaceMain(e,"czm_splitter_main"),e+="uniform float czm_splitDirection; \nvoid main() \n{ \n#ifndef SHADOW_MAP\n    if (czm_splitDirection < 0.0 && gl_FragCoord.x > czm_splitPosition) discard; \n    if (czm_splitDirection > 0.0 && gl_FragCoord.x < czm_splitPosition) discard; \n#endif\n    czm_splitter_main(); \n} \n"},addUniforms:function(e,t){t.czm_splitDirection=function(){return e.splitDirection}}},iD=oit,Dx={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function oD(e){this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=z.clone(z.DARKGRAY),this._highlightColor=z.clone(z.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=Dx.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._batchTableLoaded=e.batchTableLoaded,this._pickIdLoaded=e.pickIdLoaded,this._opaquePass=y(e.opaquePass,Ee.OPAQUE),this._cull=y(e.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=L.clone(L.IDENTITY),this._modelMatrix=L.clone(L.IDENTITY),this.time=0,this.shadows=yn.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,this.splitDirection=y(e.splitDirection,al.NONE),this._splittingEnabled=!1,this._error=void 0,rit(this,e)}function rit(e,t){let i=PA.parse(t.arrayBuffer,t.byteOffset);if(e._parsedContent=i,e._rtcCenter=i.rtcCenter,e._hasNormals=i.hasNormals,e._hasColors=i.hasColors,e._hasBatchIds=i.hasBatchIds,e._isTranslucent=i.isTranslucent,!i.hasBatchIds&&u(i.batchTableBinary)&&(i.styleableProperties=ag.getBinaryProperties(i.pointsLength,i.batchTableJson,i.batchTableBinary)),u(i.draco)){let t=i.draco;e._decodingState=Dx.NEEDS_DECODE,t.dequantizeInShader=e._dequantizeInShader}let n=i.positions;u(n)&&(e._isQuantized=n.isQuantized,e._quantizedVolumeScale=n.quantizedVolumeScale,e._quantizedVolumeOffset=n.quantizedVolumeOffset,e._quantizedRange=n.quantizedRange);let r=i.normals;u(r)&&(e._isOctEncoded16P=r.octEncoded);let o=i.colors;u(o)&&(u(o.constantColor)&&(e._constantColor=z.clone(o.constantColor,e._constantColor),e._hasColors=!1),e._isRGB565=o.isRGB565);let a=i.batchIds;u(i.batchIds)&&(a.name="BATCH_ID",a.semantic="BATCH_ID",a.setIndex=void 0),i.hasBatchIds&&e._batchTableLoaded(i.batchLength,i.batchTableJson,i.batchTableBinary),e._pointsLength=i.pointsLength}Object.defineProperties(oD.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},color:{get:function(){return z.clone(this._highlightColor)},set:function(e){this._highlightColor=z.clone(e,this._highlightColor)}},boundingSphere:{get:function(){if(u(this._drawCommand))return this._drawCommand.boundingVolume},set:function(e){this._boundingSphere=se.clone(e,this._boundingSphere)}}});var sit=new h,ait=new h,cit=new h,rhe,aV;function lit(e){if(!u(aV)){rhe=new ahe.default(0),aV=new Array(e);for(let t=0;t<e;++t)aV[t]=rhe.random()}return aV}function uit(e){let t=e.length/3,i=Math.min(t,20),n=lit(20),r=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=h.fromElements(r,r,r,sit),s=h.fromElements(o,o,o,ait);for(let r=0;r<i;++r){let i=Math.floor(n[r]*t),o=h.unpack(e,3*i,cit);h.minimumByComponent(a,o,a),h.maximumByComponent(s,o,s)}let l=se.fromCornerPoints(a,s);return l.radius+=P.EPSILON2,l}function she(e,t){let i=X.fromTypedArray(e);return i===X.INT||i===X.UNSIGNED_INT||i===X.DOUBLE?(It("Cast pnts property to floats",`Point cloud property "${t}" will be cast to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.`),new Float32Array(e)):e}var fit=new oe,dit=new oe,hit=new z,che=0,cV=1,Hj=2,lhe=3,mit=4,kj=new L,pit=new L;function _it(e,t){let i,n,r=t.context,o=e._parsedContent,a=e._pointsLength,s=o.positions,l=o.colors,c=o.normals,d=o.batchIds,p=o.styleableProperties,f=u(p),m=e._isQuantized,_=e._isQuantizedDraco,g=e._isOctEncoded16P,y=e._isOctEncodedDraco,v=e._quantizedRange,b=e._octEncodedRange,A=e._isRGB565,T=e._isTranslucent,E=e._hasColors,C=e._hasNormals,x=e._hasBatchIds,S=[],w={};if(e._styleableShaderAttributes=w,f){let t=mit;for(let o in p)if(p.hasOwnProperty(o)){let a=p[o],s=she(a.typedArray,o);i=a.componentCount,n=X.fromTypedArray(s);let l=ut.createVertexBuffer({context:r,typedArray:s,usage:Be.STATIC_DRAW});e._geometryByteLength+=l.sizeInBytes;let u={index:t,vertexBuffer:l,componentsPerAttribute:i,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0};S.push(u),w[o]={location:t,componentCount:i},++t}}let I,P,D,O=ut.createVertexBuffer({context:r,typedArray:s.typedArray,usage:Be.STATIC_DRAW});e._geometryByteLength+=O.sizeInBytes,E&&(I=ut.createVertexBuffer({context:r,typedArray:l.typedArray,usage:Be.STATIC_DRAW}),e._geometryByteLength+=I.sizeInBytes),C&&(P=ut.createVertexBuffer({context:r,typedArray:c.typedArray,usage:Be.STATIC_DRAW}),e._geometryByteLength+=P.sizeInBytes),x&&(d.typedArray=she(d.typedArray,"batchIds"),D=ut.createVertexBuffer({context:r,typedArray:d.typedArray,usage:Be.STATIC_DRAW}),e._geometryByteLength+=D.sizeInBytes);let R=[];if(n=m?X.UNSIGNED_SHORT:_?v<=255?X.UNSIGNED_BYTE:X.UNSIGNED_SHORT:X.FLOAT,R.push({index:che,vertexBuffer:O,componentsPerAttribute:3,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0}),e._cull&&(e._boundingSphere=m||_?se.fromCornerPoints(h.ZERO,e._quantizedVolumeScale):uit(s.typedArray)),E)if(A)R.push({index:cV,vertexBuffer:I,componentsPerAttribute:1,componentDatatype:X.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{let e=T?4:3;R.push({index:cV,vertexBuffer:I,componentsPerAttribute:e,componentDatatype:X.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}C&&(g?(i=2,n=X.UNSIGNED_BYTE):y?(i=2,n=b<=255?X.UNSIGNED_BYTE:X.UNSIGNED_SHORT):(i=3,n=X.FLOAT),R.push({index:Hj,vertexBuffer:P,componentsPerAttribute:i,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0})),x&&R.push({index:lhe,vertexBuffer:D,componentsPerAttribute:1,componentDatatype:X.fromTypedArray(d.typedArray),normalize:!1,offsetInBytes:0,strideInBytes:0}),f&&(R=R.concat(S));let N=new ni({context:r,attributes:R}),M={depthTest:{enabled:!0}},F={depthTest:{enabled:!0},depthMask:!1,blending:ln.ALPHA_BLEND};e._opaquePass===Ee.CESIUM_3D_TILE&&(M.stencilTest=Lt.setCesium3DTileBit(),M.stencilMask=Lt.CESIUM_3D_TILE_MASK,F.stencilTest=Lt.setCesium3DTileBit(),F.stencilMask=Lt.CESIUM_3D_TILE_MASK),e._opaqueRenderState=Ue.fromCache(M),e._translucentRenderState=Ue.fromCache(F),e._drawCommand=new et({boundingVolume:new se,cull:e._cull,modelMatrix:new L,primitiveType:Ne.POINTS,vertexArray:N,count:a,shaderProgram:void 0,uniformMap:void 0,renderState:T?e._translucentRenderState:e._opaqueRenderState,pass:T?Ee.TRANSLUCENT:e._opaquePass,owner:e,castShadows:!1,receiveShadows:!1,pickId:e._pickIdLoaded()})}function git(e,t){let i=t.context,n=e._isQuantized,r=e._isQuantizedDraco,o=e._isOctEncodedDraco,a={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){let n=fit;if(n.x=e._attenuation?e.maximumAttenuation:e._pointSize,n.x*=t.pixelRatio,n.y=e.time,e._attenuation){let r,o=t.camera.frustum;r=t.mode===te.SCENE2D||o instanceof Qt?Number.POSITIVE_INFINITY:i.drawingBufferHeight/t.camera.frustum.sseDenominator,n.z=e.geometricError*e.geometricErrorScale,n.w=r}return n},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_clippingPlanes:function(){let t=e.clippingPlanes;return e.isClipped?t.texture:i.defaultTexture},u_clippingPlanesEdgeStyle:function(){let t=e.clippingPlanes;if(!u(t))return z.TRANSPARENT;let i=z.clone(t.edgeColor,hit);return i.alpha=t.edgeWidth,i},u_clippingPlanesMatrix:function(){let t=e.clippingPlanes;if(!u(t))return L.IDENTITY;let n=y(e.clippingPlanesOriginMatrix,e._modelMatrix);L.multiply(i.uniformState.view3D,n,kj);let r=L.multiply(kj,t.modelMatrix,kj);return L.inverseTranspose(r,pit)}};iD.addUniforms(e,a),(n||r||o)&&(a=gt(a,{u_quantizedVolumeScaleAndOctEncodedRange:function(){let t=dit;if(u(e._quantizedVolumeScale)){let i=h.clone(e._quantizedVolumeScale,t);h.divideByScalar(i,e._quantizedRange,t)}return t.w=e._octEncodedRange,t}})),u(e._uniformMapLoaded)&&(a=e._uniformMapLoaded(a)),e._drawCommand.uniformMap=a}function Vj(e,t){let i=/czm_3dtiles_property_(\d+)/g,n=i.exec(e);for(;null!==n;){let r=parseInt(n[1]);-1===t.indexOf(r)&&t.push(r),n=i.exec(e)}}function Uj(e,t){e=e.slice(e.indexOf("\n"));let i=/czm_3dtiles_builtin_property_(\w+)/g,n=i.exec(e);for(;null!==n;){let r=n[1];-1===t.indexOf(r)&&t.push(r),n=i.exec(e)}}function zj(e,t){let i=e.numberOfAttributes;for(let n=0;n<i;++n){let i=e.getAttribute(n);if(i.index===t)return i}}var yit={POSITION:"czm_3dtiles_builtin_property_POSITION",POSITION_ABSOLUTE:"czm_3dtiles_builtin_property_POSITION_ABSOLUTE",COLOR:"czm_3dtiles_builtin_property_COLOR",NORMAL:"czm_3dtiles_builtin_property_NORMAL"};function xit(e,t,i){let n,r,o,a,s,l,c=t.context,h=u(i),d=e._isQuantized,p=e._isQuantizedDraco,f=e._isOctEncoded16P,m=e._isOctEncodedDraco,_=e._isRGB565,g=e._isTranslucent,y=e._hasColors,v=e._hasNormals,b=e._hasBatchIds,A=e._backFaceCulling,T=e._normalShading,E=e._drawCommand.vertexArray,C=e.clippingPlanes,x=e._attenuation,S=g,w=Ge(yit),I={},P=e._styleableShaderAttributes;for(r in P)P.hasOwnProperty(r)&&(o=P[r],w[r]=`czm_3dtiles_property_${o.location}`,I[o.location]=o);if(h){let e={translucent:!1},t="(vec3 czm_3dtiles_builtin_property_POSITION, vec3 czm_3dtiles_builtin_property_POSITION_ABSOLUTE, vec4 czm_3dtiles_builtin_property_COLOR, vec3 czm_3dtiles_builtin_property_NORMAL)";a=i.getColorShaderFunction(`getColorFromStyle${t}`,w,e),s=i.getShowShaderFunction(`getShowFromStyle${t}`,w,e),l=i.getPointSizeShaderFunction(`getPointSizeFromStyle${t}`,w,e),u(a)&&e.translucent&&(S=!0)}e._styleTranslucent=S;let D=u(a),O=u(s),L=u(l),R=e.isClipped,N=[],M=[];D&&(Vj(a,N),Uj(a,M)),O&&(Vj(s,N),Uj(s,M)),L&&(Vj(l,N),Uj(l,M));let F=M.indexOf("COLOR")>=0,B=M.indexOf("NORMAL")>=0;if(B&&!v)throw new ue("Style references the NORMAL semantic but the point cloud does not have normals");for(r in P)if(P.hasOwnProperty(r)){o=P[r];let e=N.indexOf(o.location)>=0;zj(E,o.location).enabled=e}let z=y&&(!D||F);if(y){zj(E,cV).enabled=z}let U=v&&(T||A||B);if(v){zj(E,Hj).enabled=U}let k={a_position:che};z&&(k.a_color=cV),U&&(k.a_normal=Hj),b&&(k.a_batchId=lhe);let V="",H=N.length;for(n=0;n<H;++n){let e=N[n];o=I[e];let t,i=o.componentCount,r=`czm_3dtiles_property_${e}`;t=1===i?"float":`vec${i}`,V+=`in ${t} ${r}; \n`,k[r]=o.location}git(e,t);let G="in vec3 a_position; \nout vec4 v_color; \nuniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";G+="float u_pointSize; \nfloat tiles3d_tileset_time; \n",x&&(G+="float u_geometricError; \nfloat u_depthMultiplier; \n"),G+=V,z&&(G+=g?"in vec4 a_color; \n":_?"in float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"in vec3 a_color; \n"),U&&(G+=f||m?"in vec2 a_normal; \n":"in vec3 a_normal; \n"),b&&(G+="in float a_batchId; \n"),(d||p||m)&&(G+="uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; \n"),D&&(G+=a),O&&(G+=s),L&&(G+=l),G+="void main() \n{ \n    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; \n    tiles3d_tileset_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; \n",x&&(G+="    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; \n"),G+=z?g?"    vec4 color = a_color; \n":_?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",G+=d||p?"    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; \n":"    vec3 position = a_position; \n",G+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",U?(G+=f?"    vec3 normal = czm_octDecode(a_normal); \n":m?"    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; \n":"    vec3 normal = a_normal; \n",G+="    vec3 normalEC = czm_normal * normal; \n"):G+="    vec3 normal = vec3(1.0); \n",D&&(G+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),O&&(G+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),G+=L?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal) * czm_pixelRatio; \n":x?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",G+="    color = color * u_highlightColor; \n",U&&T&&(G+="    float diffuseStrength = czm_getLambertDiffuse(czm_lightDirectionEC, normalEC); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength * czm_lightColor; \n"),G+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",U&&A&&(G+="    float visible = step(-normalEC.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),O&&(G+="    gl_Position.w *= float(show); \n    gl_PointSize *= float(show); \n"),G+="} \n";let j="in vec4 v_color; \n";R&&(j+="uniform highp sampler2D u_clippingPlanes; \nuniform mat4 u_clippingPlanesMatrix; \nuniform vec4 u_clippingPlanesEdgeStyle; \n",j+="\n",j+=og(C,c),j+="\n"),j+="void main() \n{ \n    out_FragColor = czm_gammaCorrect(v_color); \n",R&&(j+=H3("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),j+="} \n",e.splitDirection!==al.NONE&&(j=iD.modifyFragmentShader(j)),u(e._vertexShaderLoaded)&&(G=e._vertexShaderLoaded(G)),u(e._fragmentShaderLoaded)&&(j=e._fragmentShaderLoaded(j));let W=e._drawCommand;u(W.shaderProgram)&&W.shaderProgram.destroy(),W.shaderProgram=Kt.fromCache({context:c,vertexShaderSource:G,fragmentShaderSource:j,attributeLocations:k});try{W.shaderProgram._bind()}catch{throw new ue("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}function bit(e,t){if(e._decodingState===Dx.READY)return!1;if(e._decodingState===Dx.NEEDS_DECODE){let i=e._parsedContent,n=i.draco,r=fg.decodePointCloud(n,t);u(r)&&(e._decodingState=Dx.DECODING,r.then((function(t){e._decodingState=Dx.READY;let r=u(t.POSITION)?t.POSITION.array:void 0,o=u(t.RGB)?t.RGB.array:void 0,a=u(t.RGBA)?t.RGBA.array:void 0,s=u(t.NORMAL)?t.NORMAL.array:void 0,l=u(t.BATCH_ID)?t.BATCH_ID.array:void 0,c=u(r)&&u(t.POSITION.data.quantization),d=u(s)&&u(t.NORMAL.data.quantization);if(c){let i=t.POSITION.data.quantization,n=i.range;e._quantizedVolumeScale=h.fromElements(n,n,n),e._quantizedVolumeOffset=h.unpack(i.minValues),e._quantizedRange=(1<<i.quantizationBits)-1,e._isQuantizedDraco=!0}d&&(e._octEncodedRange=(1<<t.NORMAL.data.quantization.quantizationBits)-1,e._isOctEncodedDraco=!0);let p=i.styleableProperties,f=n.batchTableProperties;for(let e in f)if(f.hasOwnProperty(e)){let i=t[e];u(p)||(p={}),p[e]={typedArray:i.array,componentCount:i.data.componentsPerAttribute}}u(r)&&(i.positions={typedArray:r});let m=y(a,o);u(m)&&(i.colors={typedArray:m}),u(s)&&(i.normals={typedArray:s}),u(l)&&(i.batchIds={typedArray:l}),i.styleableProperties=p})).catch((function(t){e._decodingState=Dx.FAILED,e._error=t})))}return!0}var Tit=new oe,Ait=new h;oD.prototype.update=function(e){let t=e.context;if(u(this._error)){let e=this._error;throw this._error=void 0,e}if(bit(this,t))return;let i=!1,n=!L.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==e.mode&&(this._mode=e.mode,n=!0),u(this._drawCommand)||(_it(this,e),n=!0,i=!0,this._ready=!0,this._parsedContent=void 0),n){L.clone(this.modelMatrix,this._modelMatrix);let t=this._drawCommand.modelMatrix;if(L.clone(this._modelMatrix,t),u(this._rtcCenter)&&L.multiplyByTranslation(t,this._rtcCenter,t),u(this._quantizedVolumeOffset)&&L.multiplyByTranslation(t,this._quantizedVolumeOffset,t),e.mode!==te.SCENE3D){let i=e.mapProjection,n=L.getColumn(t,3,Tit);oe.equals(n,oe.UNIT_W)||Rt.basisTo2D(i,t,t)}let i=this._drawCommand.boundingVolume;if(se.clone(this._boundingSphere,i),this._cull){let e=i.center;L.multiplyByPoint(t,e,e);let n=L.getScale(t,Ait);i.radius*=h.maximumComponent(n)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,i=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,i=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,i=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,i=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,i=!0);let r=this.splitDirection!==al.NONE;this._splittingEnabled!==r&&(this._splittingEnabled=r,i=!0),i&&xit(this,e,this._style),this._drawCommand.castShadows=yn.castShadows(this.shadows),this._drawCommand.receiveShadows=yn.receiveShadows(this.shadows);let o=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=o?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=o?Ee.TRANSLUCENT:this._opaquePass;let a=e.commandList,s=e.passes;(s.render||s.pick)&&a.push(this._drawCommand)},oD.prototype.isDestroyed=function(){return!1},oD.prototype.destroy=function(){let e=this._drawCommand;return u(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),le(this)};var lV=oD;function Ar(e,t){let i=(e=y(e,y.EMPTY_OBJECT)).translucencyByDistance,n=e.scaleByDistance,r=e.distanceDisplayCondition;u(i)&&(i=Pt.clone(i)),u(n)&&(n=Pt.clone(n)),u(r)&&(r=wt.clone(r)),this._show=y(e.show,!0),this._position=h.clone(y(e.position,h.ZERO)),this._actualPosition=h.clone(this._position),this._color=z.clone(y(e.color,z.WHITE)),this._outlineColor=z.clone(y(e.outlineColor,z.TRANSPARENT)),this._outlineWidth=y(e.outlineWidth,0),this._pixelSize=y(e.pixelSize,10),this._scaleByDistance=n,this._translucencyByDistance=i,this._distanceDisplayCondition=r,this._disableDepthTestDistance=y(e.disableDepthTestDistance,0),this._id=e.id,this._collection=y(e.collection,t),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1}var uhe=Ar.SHOW_INDEX=0,hhe=Ar.POSITION_INDEX=1,Cit=Ar.COLOR_INDEX=2,Eit=Ar.OUTLINE_COLOR_INDEX=3,Sit=Ar.OUTLINE_WIDTH_INDEX=4,wit=Ar.PIXEL_SIZE_INDEX=5,vit=Ar.SCALE_BY_DISTANCE_INDEX=6,Dit=Ar.TRANSLUCENCY_BY_DISTANCE_INDEX=7,Iit=Ar.DISTANCE_DISPLAY_CONDITION_INDEX=8,Pit=Ar.DISABLE_DEPTH_DISTANCE_INDEX=9;function pf(e,t){let i=e._pointPrimitiveCollection;u(i)&&(i._updatePointPrimitive(e,t),e._dirty=!0)}Ar.NUMBER_OF_PROPERTIES=10,Object.defineProperties(Ar.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,pf(this,uhe))}},position:{get:function(){return this._position},set:function(e){let t=this._position;h.equals(t,e)||(h.clone(e,t),h.clone(e,this._actualPosition),pf(this,hhe))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){let t=this._scaleByDistance;Pt.equals(t,e)||(this._scaleByDistance=Pt.clone(e,t),pf(this,vit))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){let t=this._translucencyByDistance;Pt.equals(t,e)||(this._translucencyByDistance=Pt.clone(e,t),pf(this,Dit))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){this._pixelSize!==e&&(this._pixelSize=e,pf(this,wit))}},color:{get:function(){return this._color},set:function(e){let t=this._color;z.equals(t,e)||(z.clone(e,t),pf(this,Cit))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){let t=this._outlineColor;z.equals(t,e)||(z.clone(e,t),pf(this,Eit))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,pf(this,Sit))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){wt.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=wt.clone(e,this._distanceDisplayCondition),pf(this,Iit))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance!==e&&(this._disableDepthTestDistance=e,pf(this,Pit))}},id:{get:function(){return this._id},set:function(e){this._id=e,u(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,pf(this,uhe))}}}),Ar.prototype.getPickId=function(e){return u(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},Ar.prototype._getActualPosition=function(){return this._actualPosition},Ar.prototype._setActualPosition=function(e){h.clone(e,this._actualPosition),pf(this,hhe)};var fhe=new oe;Ar._computeActualPosition=function(e,t,i){return t.mode===te.SCENE3D?e:(L.multiplyByPoint(i,e,fhe),$i.computeActualWgs84Position(t,fhe))};var dhe=new oe;Ar._computeScreenSpacePosition=function(e,t,i,n){let r=L.multiplyByVector(e,oe.fromElements(t.x,t.y,t.z,1,dhe),dhe);return $i.wgs84ToWindowCoordinates(i,r,n)},Ar.prototype.computeScreenSpacePosition=function(e,t){let i=this._pointPrimitiveCollection;u(t)||(t=new U);let n=i.modelMatrix,r=Ar._computeScreenSpacePosition(n,this._actualPosition,e,t);if(u(r))return r.y=e.canvas.clientHeight-r.y,r},Ar.getScreenSpaceBoundingBox=function(e,t,i){let n=e.pixelSize,r=.5*n,o=t.x-r,a=t.y-r,s=n,l=n;return u(i)||(i=new qe),i.x=o,i.y=a,i.width=s,i.height=l,i},Ar.prototype.equals=function(e){return this===e||u(e)&&this._id===e._id&&h.equals(this._position,e._position)&&z.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&z.equals(this._outlineColor,e._outlineColor)&&Pt.equals(this._scaleByDistance,e._scaleByDistance)&&Pt.equals(this._translucencyByDistance,e._translucencyByDistance)&&wt.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},Ar.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var Ys=Ar,Ix="in vec4 v_color;\nin vec4 v_outlineColor;\nin float v_innerPercent;\nin float v_pixelDistance;\nin vec4 v_pickColor;\n\nvoid main()\n{\n    // The distance in UV space from this fragment to the center of the point, at most 0.5.\n    float distanceToCenter = length(gl_PointCoord - vec2(0.5));\n    // The max distance stops one pixel shy of the edge to leave space for anti-aliasing.\n    float maxDistance = max(0.0, 0.5 - v_pixelDistance);\n    float wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);\n    float innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);\n\n    vec4 color = mix(v_outlineColor, v_color, innerAlpha);\n    color.a *= wholeAlpha;\n\n// Fully transparent parts of the billboard are not pickable.\n#if !defined(OPAQUE) && !defined(TRANSLUCENT)\n    if (color.a < 0.005)   // matches 0/255 and 1/255\n    {\n        discard;\n    }\n#else\n// The billboard is rendered twice. The opaque pass discards translucent fragments\n// and the translucent pass discards opaque fragments.\n#ifdef OPAQUE\n    if (color.a < 0.995)   // matches < 254/255\n    {\n        discard;\n    }\n#else\n    if (color.a >= 0.995)  // matches 254/255 and 255/255\n    {\n        discard;\n    }\n#endif\n#endif\n\n    out_FragColor = czm_gammaCorrect(color);\n    czm_writeLogDepth();\n}\n",uV='uniform float u_maxTotalPointSize;\n\nin vec4 positionHighAndSize;\nin vec4 positionLowAndOutline;\nin vec4 compressedAttribute0;                       // color, outlineColor, pick color\nin vec4 compressedAttribute1;                       // show, translucency by distance, some free space\nin vec4 scaleByDistance;                            // near, nearScale, far, farScale\nin vec3 distanceDisplayConditionAndDisableDepth;    // near, far, disableDepthTestDistance\n\nout vec4 v_color;\nout vec4 v_outlineColor;\nout float v_innerPercent;\nout float v_pixelDistance;\nout vec4 v_pickColor;\n\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\n\nvoid main()\n{\n    // Modifying this shader may also require modifications to PointPrimitive._computeScreenSpacePosition\n\n    // unpack attributes\n    vec3 positionHigh = positionHighAndSize.xyz;\n    vec3 positionLow = positionLowAndOutline.xyz;\n    float outlineWidthBothSides = 2.0 * positionLowAndOutline.w;\n    float totalSize = positionHighAndSize.w + outlineWidthBothSides;\n    float outlinePercent = outlineWidthBothSides / totalSize;\n    // Scale in response to browser-zoom.\n    totalSize *= czm_pixelRatio;\n\n    float temp = compressedAttribute1.x * SHIFT_RIGHT8;\n    float show = floor(temp);\n\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    vec4 translucencyByDistance;\n    translucencyByDistance.x = compressedAttribute1.z;\n    translucencyByDistance.z = compressedAttribute1.w;\n\n    translucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n\n    temp = compressedAttribute1.y * SHIFT_RIGHT8;\n    translucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n\n    ///////////////////////////////////////////////////////////////////////////\n\n    vec4 color;\n    vec4 outlineColor;\n    vec4 pickColor;\n\n    // compressedAttribute0.z => pickColor.rgb\n\n    temp = compressedAttribute0.z * SHIFT_RIGHT8;\n    pickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    pickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    pickColor.r = floor(temp);\n\n    // compressedAttribute0.x => color.rgb\n\n    temp = compressedAttribute0.x * SHIFT_RIGHT8;\n    color.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    color.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    color.r = floor(temp);\n\n    // compressedAttribute0.y => outlineColor.rgb\n\n    temp = compressedAttribute0.y * SHIFT_RIGHT8;\n    outlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\n    temp = floor(temp) * SHIFT_RIGHT8;\n    outlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\n    outlineColor.r = floor(temp);\n\n    // compressedAttribute0.w => color.a, outlineColor.a, pickColor.a\n\n    temp = compressedAttribute0.w * SHIFT_RIGHT8;\n    pickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\n    pickColor = pickColor / 255.0;\n\n    temp = floor(temp) * SHIFT_RIGHT8;\n    outlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\n    outlineColor /= 255.0;\n    color.a = floor(temp);\n    color /= 255.0;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n    vec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\n    vec4 positionEC = czm_modelViewRelativeToEye * p;\n\n    ///////////////////////////////////////////////////////////////////////////\n\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\n    float lengthSq;\n    if (czm_sceneMode == czm_sceneMode2D)\n    {\n        // 2D camera distance is a special case\n        // treat all billboards as flattened to the z=0.0 plane\n        lengthSq = czm_eyeHeight2D.y;\n    }\n    else\n    {\n        lengthSq = dot(positionEC.xyz, positionEC.xyz);\n    }\n#endif\n\n#ifdef EYE_DISTANCE_SCALING\n    totalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);\n#endif\n    if (totalSize > 0.0) {\n        // Add padding for anti-aliasing on both sides.\n        totalSize += 3.0;\n    }\n\n    // Clamp to max point size.\n    totalSize = min(totalSize, u_maxTotalPointSize);\n    // If size is too small, push vertex behind near plane for clipping.\n    // Note that context.minimumAliasedPointSize "will be at most 1.0".\n    if (totalSize < 1.0)\n    {\n        positionEC.xyz = vec3(0.0);\n        totalSize = 1.0;\n    }\n\n    float translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\n    translucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\n    // push vertex behind near plane for clipping\n    if (translucency < 0.004)\n    {\n        positionEC.xyz = vec3(0.0);\n    }\n#endif\n\n#ifdef DISTANCE_DISPLAY_CONDITION\n    float nearSq = distanceDisplayConditionAndDisableDepth.x;\n    float farSq = distanceDisplayConditionAndDisableDepth.y;\n    if (lengthSq < nearSq || lengthSq > farSq) {\n        // push vertex behind camera to force it to be clipped\n        positionEC.xyz = vec3(0.0, 0.0, 1.0);\n    }\n#endif\n\n    gl_Position = czm_projection * positionEC;\n    czm_vertexLogDepth();\n\n#ifdef DISABLE_DEPTH_DISTANCE\n    float disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;\n    if (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n    {\n        disableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n    }\n\n    if (disableDepthTestDistance != 0.0)\n    {\n        // Don\'t try to "multiply both sides" by w.  Greater/less-than comparisons won\'t work for negative values of w.\n        float zclip = gl_Position.z / gl_Position.w;\n        bool clipped = (zclip < -1.0 || zclip > 1.0);\n        if (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n        {\n            // Position z on the near plane.\n            gl_Position.z = -gl_Position.w;\n#ifdef LOG_DEPTH\n            czm_vertexLogDepth(vec4(czm_currentFrustum.x));\n#endif\n        }\n    }\n#endif\n\n    v_color = color;\n    v_color.a *= translucency * show;\n    v_outlineColor = outlineColor;\n    v_outlineColor.a *= translucency * show;\n\n    v_innerPercent = 1.0 - outlinePercent;\n    v_pixelDistance = 2.0 / totalSize;\n    gl_PointSize = totalSize * show;\n    gl_Position *= show;\n\n    v_pickColor = pickColor;\n}\n',Oit=Ys.SHOW_INDEX,jj=Ys.POSITION_INDEX,mhe=Ys.COLOR_INDEX,Rit=Ys.OUTLINE_COLOR_INDEX,Mit=Ys.OUTLINE_WIDTH_INDEX,Lit=Ys.PIXEL_SIZE_INDEX,phe=Ys.SCALE_BY_DISTANCE_INDEX,_he=Ys.TRANSLUCENCY_BY_DISTANCE_INDEX,ghe=Ys.DISTANCE_DISPLAY_CONDITION_INDEX,Nit=Ys.DISABLE_DEPTH_DISTANCE_INDEX,qj=Ys.NUMBER_OF_PROPERTIES,Xa={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5};function _f(e){e=y(e,y.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(qj),this._maxPixelSize=1,this._baseVolume=new se,this._baseVolumeWC=new se,this._baseVolume2D=new se,this._boundingVolume=new se,this._boundingVolumeDirty=!1,this._colorCommands=[],this.show=y(e.show,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._modelMatrix=L.clone(L.IDENTITY),this.debugShowBoundingVolume=y(e.debugShowBoundingVolume,!1),this.blendOption=y(e.blendOption,Ao.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=te.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW,Be.STATIC_DRAW];let t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}function yhe(e){let t=e.length;for(let i=0;i<t;++i)e[i]&&e[i]._destroy()}function Yj(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;let t=[],i=e._pointPrimitives,n=i.length;for(let e=0,r=0;e<n;++e){let n=i[e];n&&(n._index=r++,t.push(n))}e._pointPrimitives=t}}function Fit(e,t,i){return new tg(e,[{index:Xa.positionHighAndSize,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[jj]},{index:Xa.positionLowAndShow,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[jj]},{index:Xa.compressedAttribute0,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[mhe]},{index:Xa.compressedAttribute1,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[_he]},{index:Xa.scaleByDistance,componentsPerAttribute:4,componentDatatype:X.FLOAT,usage:i[phe]},{index:Xa.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:X.FLOAT,usage:i[ghe]}],t)}Object.defineProperties(_f.prototype,{length:{get:function(){return Yj(this),this._pointPrimitives.length}}}),_f.prototype.add=function(e){let t=new Ys(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t},_f.prototype.remove=function(e){return!!this.contains(e)&&(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},_f.prototype.removeAll=function(){yhe(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0},_f.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]},_f.prototype.contains=function(e){return u(e)&&e._pointPrimitiveCollection===this},_f.prototype.get=function(e){return Yj(this),this._pointPrimitives[e]},_f.prototype.computeNewBuffersUsage=function(){let e=this._buffersUsage,t=!1,i=this._propertiesChanged;for(let n=0;n<qj;++n){let r=0===i[n]?Be.STATIC_DRAW:Be.STREAM_DRAW;t=t||e[n]!==r,e[n]=r}return t};var Gj=new Wn;function xhe(e,t,i,n){let r=n._index,o=n._getActualPosition();e._mode===te.SCENE3D&&(se.expand(e._baseVolume,o,e._baseVolume),e._boundingVolumeDirty=!0),Wn.fromCartesian(o,Gj);let a=n.pixelSize,s=n.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,a+s);let l=i[Xa.positionHighAndSize],u=Gj.high;l(r,u.x,u.y,u.z,a);let c=i[Xa.positionLowAndOutline],h=Gj.low;c(r,h.x,h.y,h.z,s)}var fV=65536,rD=256;function bhe(e,t,i,n){let r=n._index,o=n.color,a=n.getPickId(t).color,s=n.outlineColor,l=z.floatToByte(o.red),u=z.floatToByte(o.green),c=z.floatToByte(o.blue),h=l*fV+u*rD+c;l=z.floatToByte(s.red),u=z.floatToByte(s.green),c=z.floatToByte(s.blue);let d=l*fV+u*rD+c;l=z.floatToByte(a.red),u=z.floatToByte(a.green),c=z.floatToByte(a.blue);let p=l*fV+u*rD+c,f=z.floatToByte(o.alpha)*fV+z.floatToByte(s.alpha)*rD+z.floatToByte(a.alpha);(0,i[Xa.compressedAttribute0])(r,h,d,p,f)}function The(e,t,i,n){let r=n._index,o=0,a=1,s=1,l=1,c=n.translucencyByDistance;u(c)&&(o=c.near,a=c.nearValue,s=c.far,l=c.farValue,(1!==a||1!==l)&&(e._shaderTranslucencyByDistance=!0));let h=n.show&&n.clusterShow;0===n.color.alpha&&0===n.outlineColor.alpha&&(h=!1),a=P.clamp(a,0,1),a=1===a?255:255*a|0;let d=(h?1:0)*rD+a;l=P.clamp(l,0,1),l=1===l?255:255*l|0;let p=l;(0,i[Xa.compressedAttribute1])(r,d,p,o,s)}function Ahe(e,t,i,n){let r=n._index,o=i[Xa.scaleByDistance],a=0,s=1,l=1,c=1,h=n.scaleByDistance;u(h)&&(a=h.near,s=h.nearValue,l=h.far,c=h.farValue,(1!==s||1!==c)&&(e._shaderScaleByDistance=!0)),o(r,a,s,l,c)}function Che(e,t,i,n){let r=n._index,o=i[Xa.distanceDisplayConditionAndDisableDepth],a=0,s=Number.MAX_VALUE,l=n.distanceDisplayCondition;u(l)&&(a=l.near,s=l.far,a*=a,s*=s,e._shaderDistanceDisplayCondition=!0);let c=n.disableDepthTestDistance;c*=c,c>0&&(e._shaderDisableDepthDistance=!0,c===Number.POSITIVE_INFINITY&&(c=-1)),o(r,a,s,c)}function Bit(e,t,i,n){xhe(e,t,i,n),bhe(e,t,i,n),The(e,t,i,n),Ahe(e,t,i,n),Che(e,t,i,n)}function Wj(e,t,i,n,r,o){let a;n.mode===te.SCENE3D?(a=e._baseVolume,e._boundingVolumeDirty=!0):a=e._baseVolume2D;let s=[];for(let e=0;e<i;++e){let i=t[e],l=i.position,c=Ys._computeActualPosition(l,n,r);u(c)&&(i._setActualPosition(c),o?s.push(c):se.expand(a,c,a))}o&&se.fromPoints(s,a)}function kit(e,t){let i=t.mode,n=e._pointPrimitives,r=e._pointPrimitivesToUpdate,o=e._modelMatrix;e._createVertexArray||e._mode!==i||i!==te.SCENE3D&&!L.equals(o,e.modelMatrix)?(e._mode=i,L.clone(e.modelMatrix,o),e._createVertexArray=!0,(i===te.SCENE3D||i===te.SCENE2D||i===te.COLUMBUS_VIEW)&&Wj(e,n,n.length,t,o,!0)):i===te.MORPHING?Wj(e,n,n.length,t,o,!0):(i===te.SCENE2D||i===te.COLUMBUS_VIEW)&&Wj(e,r,e._pointPrimitivesToUpdateIndex,t,o,!1)}function Vit(e,t,i){let n=t.camera.getPixelSize(i,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*e._maxPixelSize;i.radius+=n}var Uit=[];_f.prototype.update=function(e){if(Yj(this),!this.show)return;this._maxTotalPointSize=zt.maximumAliasedPointSize,kit(this,e);let t,i=this._pointPrimitives.length,n=this._pointPrimitivesToUpdate,r=this._pointPrimitivesToUpdateIndex,o=this._propertiesChanged,a=this._createVertexArray,s=e.context,l=e.passes,c=l.pick;if(a||!c&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(let e=0;e<qj;++e)o[e]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=Fit(s,i,this._buffersUsage),t=this._vaf.writers;for(let e=0;e<i;++e){let i=this._pointPrimitives[e];i._dirty=!1,Bit(this,s,t,i)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(r>0){let e=Uit;e.length=0,(o[jj]||o[Mit]||o[Lit])&&e.push(xhe),(o[mhe]||o[Rit])&&e.push(bhe),(o[Oit]||o[_he])&&e.push(The),o[phe]&&e.push(Ahe),(o[ghe]||o[Nit])&&e.push(Che);let a=e.length;if(t=this._vaf.writers,r/i>.1){for(let i=0;i<r;++i){let r=n[i];r._dirty=!1;for(let i=0;i<a;++i)e[i](this,s,t,r)}this._vaf.commit()}else{for(let i=0;i<r;++i){let r=n[i];r._dirty=!1;for(let i=0;i<a;++i)e[i](this,s,t,r);this._vaf.subCommit(r._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(r>1.5*i&&(n.length=i),!u(this._vaf)||!u(this._vaf.va))return;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,se.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));let h,d=L.IDENTITY;e.mode===te.SCENE3D?(d=this.modelMatrix,h=se.clone(this._baseVolumeWC,this._boundingVolume)):h=se.clone(this._baseVolume2D,this._boundingVolume),Vit(this,e,h);let p,f,m=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,m&&(this._blendOption===Ao.OPAQUE||this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=Ue.fromCache({depthTest:{enabled:!0,func:ee.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===Ao.TRANSLUCENT||this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=Ue.fromCache({depthTest:{enabled:!0,func:ee.LEQUAL},depthMask:!1,blending:ln.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance,(m||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance)&&(p=new He({sources:[uV]}),this._shaderScaleByDistance&&p.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&p.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&p.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&p.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT&&(f=new He({defines:["OPAQUE"],sources:[Ix]}),this._sp=Kt.replaceCache({context:s,shaderProgram:this._sp,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:Xa}),f=new He({defines:["TRANSLUCENT"],sources:[Ix]}),this._spTranslucent=Kt.replaceCache({context:s,shaderProgram:this._spTranslucent,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:Xa})),this._blendOption===Ao.OPAQUE&&(f=new He({sources:[Ix]}),this._sp=Kt.replaceCache({context:s,shaderProgram:this._sp,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:Xa})),this._blendOption===Ao.TRANSLUCENT&&(f=new He({sources:[Ix]}),this._spTranslucent=Kt.replaceCache({context:s,shaderProgram:this._spTranslucent,vertexShaderSource:p,fragmentShaderSource:f,attributeLocations:Xa})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance);let _,g,y,v,b=e.commandList;if(l.render||c){let e=this._colorCommands,t=this._blendOption===Ao.OPAQUE,i=this._blendOption===Ao.OPAQUE_AND_TRANSLUCENT;_=this._vaf.va,g=_.length,e.length=g;let n=i?2*g:g;for(v=0;v<n;++v){let n=t||i&&v%2==0;y=e[v],u(y)||(y=e[v]=new et),y.primitiveType=Ne.POINTS,y.pass=n||!i?Ee.OPAQUE:Ee.TRANSLUCENT,y.owner=this;let r=i?Math.floor(v/2):v;y.boundingVolume=h,y.modelMatrix=d,y.shaderProgram=n?this._sp:this._spTranslucent,y.uniformMap=this._uniforms,y.vertexArray=_[r].va,y.renderState=n?this._rsOpaque:this._rsTranslucent,y.debugShowBoundingVolume=this.debugShowBoundingVolume,y.pickId="v_pickColor",b.push(y)}}},_f.prototype.isDestroyed=function(){return!1},_f.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),yhe(this._pointPrimitives),le(this)};var sD=_f,zit={NEAREST:0,LINEAR:1},gf=zit;function Px(e){let t=(e=y(e,y.EMPTY_OBJECT)).fragmentShader,i=y(e.textureScale,1),n=y(e.pixelFormat,rt.RGBA);this._fragmentShader=t,this._uniforms=e.uniforms,this._textureScale=i,this._forcePowerOfTwo=y(e.forcePowerOfTwo,!1),this._sampleMode=y(e.sampleMode,gf.NEAREST),this._pixelFormat=n,this._pixelDatatype=y(e.pixelDatatype,Ye.UNSIGNED_BYTE),this._clearColor=y(e.clearColor,z.BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;let r=new Ac;r.scissorTest={enabled:!0,rectangle:u(e.scissorRectangle)?qe.clone(e.scissorRectangle):new qe},this._passState=r,this._ready=!1;let o=e.name;u(o)||(o=jn()),this._name=o,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object.defineProperties(Px.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(u(this._textureCache)){let e=this._textureCache.getFramebuffer(this._name);if(u(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});var Hit=/uniform\s+sampler2D\s+depthTexture/g;function Git(e,t,i){let n=t[i];return("string"==typeof n||n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof ImageData)&&e._dirtyUniforms.push(i),{get:function(){return t[i]},set:function(n){let r=t[i];t[i]=n;let o=e._actualUniforms,a=o[i];u(a)&&a!==r&&a instanceof Ot&&!u(e._textureCache.getStageByName(i))&&(e._texturesToRelease.push(a),delete o[i],delete o[`${i}Dimensions`]),r instanceof Ot&&e._texturesToRelease.push(r),"string"==typeof n||n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof ImageData?e._dirtyUniforms.push(i):o[i]=n}}}function Wit(e,t){return function(){let i=e._actualUniforms[t];return"function"==typeof i?i():i}}function jit(e,t){return function(){let i=e[t]();if(u(i))return i.dimensions}}function qit(e){if(u(e._uniformMap))return;let t={},i={},n=e._uniforms,r=e._actualUniforms;for(let o in n)if(n.hasOwnProperty(o)){"function"!=typeof n[o]?(t[o]=Wit(e,o),i[o]=Git(e,n,o)):(t[o]=n[o],i[o]=n[o]),r[o]=n[o];let a=t[o]();("string"==typeof a||a instanceof Ot||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement)&&(t[`${o}Dimensions`]=jit(t,o))}e._uniforms={},Object.defineProperties(e._uniforms,i),e._uniformMap=gt(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}function Yit(e,t){if(u(e._command)&&!e._logDepthChanged&&!e._selectedDirty)return;let i=e._fragmentShader;if(u(e._selectedIdTexture)){let t=e._selectedIdTexture.width;i=i.replace(/in\s+vec2\s+v_textureCoordinates;/g,""),i=`#define CZM_SELECTED_FEATURE \nuniform sampler2D czm_idTexture; \nuniform sampler2D czm_selectedIdTexture; \nuniform float czm_selectedIdTextureStep; \nin vec2 v_textureCoordinates; \nbool czm_selected(vec2 offset) \n{ \n    bool selected = false;\n    vec4 id = texture(czm_idTexture, v_textureCoordinates + offset); \n    for (int i = 0; i < ${t}; ++i) \n    { \n        vec4 selectedId = texture(czm_selectedIdTexture, vec2((float(i) + 0.5) * czm_selectedIdTextureStep, 0.5)); \n        if (all(equal(id, selectedId))) \n        { \n            return true; \n        } \n    } \n    return false; \n} \n\nbool czm_selected() \n{ \n    return czm_selected(vec2(0.0)); \n} \n\n${i}`}let n=new He({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[i]});e._command=t.createViewportQuadCommand(n,{uniformMap:e._uniformMap,owner:e})}function Xit(e){let t,i;e._sampleMode===gf.LINEAR?(t=an.LINEAR,i=wi.LINEAR):(t=an.NEAREST,i=wi.NEAREST);let n=e._sampler;(!u(n)||n.minificationFilter!==t||n.magnificationFilter!==i)&&(e._sampler=new un({wrapS:vn.CLAMP_TO_EDGE,wrapT:vn.CLAMP_TO_EDGE,minificationFilter:t,magnificationFilter:i}))}function Kit(e,t){return function(i){e._texturesToCreate.push({name:t,source:i})}}function Zit(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function $it(e,t){let i,n,r,o=e._texturesToRelease,a=o.length;for(i=0;i<a;++i)n=o[i],n=n&&n.destroy();o.length=0;let s=e._texturesToCreate;for(a=s.length,i=0;i<a;++i){let n=s[i];r=n.name;let o=n.source;e._actualUniforms[r]=new Ot({context:t,source:o})}s.length=0;let l=e._dirtyUniforms;if(0===l.length&&!u(e._texturePromise))return void(e._ready=!0);if(0===l.length||u(e._texturePromise))return;a=l.length;let c=e._uniforms,h=[];for(i=0;i<a;++i){r=l[i];let t=c[r],n=e._textureCache.getStageByName(t);if(u(n))e._actualUniforms[r]=Zit(e,t);else if("string"==typeof t){let i=new ve({url:t});h.push(i.fetchImage().then(Kit(e,r)))}else e._texturesToCreate.push({name:r,source:t})}l.length=0,h.length>0?(e._ready=!1,e._texturePromise=Promise.all(h).then((function(){e._ready=!0,e._texturePromise=void 0}))):e._ready=!0}function Ehe(e){u(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();let t=e._textureCache;if(!u(t))return;let i=e._uniforms,n=e._actualUniforms;for(let r in n)n.hasOwnProperty(r)&&n[r]instanceof Ot&&(u(t.getStageByName(i[r]))||n[r].destroy(),e._dirtyUniforms.push(r))}function Qit(e){let t=u(e._selected)?e._selected.length:0,i=u(e._parentSelected)?e._parentSelected:0,n=e._selected!==e._selectedShadow||t!==e._selectedLength;if(n=n||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,u(e._selected)&&u(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):u(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!n&&u(e._combinedSelected)){if(!u(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(let i=0;i<t;++i)if(e._combinedSelected[i]!==e._combinedSelectedShadow[i])return!0}return n}function Jit(e,t){if(!e._selectedDirty)return;e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;let i=e._combinedSelected;if(!u(i))return;let n,r,o=0,a=i.length;for(n=0;n<a;++n)r=i[n],u(r.pickIds)?o+=r.pickIds.length:u(r.pickId)&&++o;if(0===a||0===o){let i=new Uint8Array(4);return i[0]=255,i[1]=255,i[2]=255,i[3]=255,void(e._selectedIdTexture=new Ot({context:t,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,source:{arrayBufferView:i,width:1,height:1},sampler:un.NEAREST}))}let s,l=0,c=new Uint8Array(4*o);for(n=0;n<a;++n)if(r=i[n],u(r.pickIds)){let e=r.pickIds,t=e.length;for(let i=0;i<t;++i)s=e[i].color,c[l]=z.floatToByte(s.red),c[l+1]=z.floatToByte(s.green),c[l+2]=z.floatToByte(s.blue),c[l+3]=z.floatToByte(s.alpha),l+=4}else u(r.pickId)&&(s=r.pickId.color,c[l]=z.floatToByte(s.red),c[l+1]=z.floatToByte(s.green),c[l+2]=z.floatToByte(s.blue),c[l+3]=z.floatToByte(s.alpha),l+=4);e._selectedIdTexture=new Ot({context:t,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,source:{arrayBufferView:c,width:o,height:1},sampler:un.NEAREST})}Px.prototype._isSupported=function(e){return!Hit.test(this._fragmentShader)||e.depthTexture},Px.prototype.update=function(e,t){if(this.enabled!==this._enabled&&!this.enabled&&Ehe(this),this._enabled=this.enabled,!this._enabled||(this._logDepthChanged=t!==this._useLogDepth,this._useLogDepth=t,this._selectedDirty=Qit(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=u(this._selected)?this._selected.length:0,this._parentSelectedLength=u(this._parentSelected)?this._parentSelected.length:0,Jit(this,e),qit(this),$it(this,e),Yit(this,e),Xit(this),this._selectedDirty=!1,!this._ready))return;let i=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=i,!u(i))return;let n,r=i.getColorTexture(0);(r.width!==e.drawingBufferWidth||r.height!==e.drawingBufferHeight)&&(n=this._renderState,(!u(n)||r.width!==n.viewport.width||r.height!==n.viewport.height)&&(this._renderState=Ue.fromCache({viewport:new qe(0,0,r.width,r.height)}))),this._command.renderState=n},Px.prototype.execute=function(e,t,i,n){if(!(u(this._command)&&u(this._command.framebuffer)&&this._ready&&this._enabled))return;this._colorTexture=t,this._depthTexture=i,this._idTexture=n,un.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);let r=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;u(r)&&(r.context=e),this._command.execute(e,r)},Px.prototype.isDestroyed=function(){return!1},Px.prototype.destroy=function(){return Ehe(this),le(this)};var _o=Px,dV="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    color /= texture(autoExposure, vec2(0.5)).r;\n#endif\n    color = czm_acesTonemapping(color);\n    color = czm_inverseGamma(color);\n\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",hV="uniform sampler2D randomTexture;\nuniform sampler2D depthTexture;\nuniform float intensity;\nuniform float bias;\nuniform float lengthCap;\nuniform float stepSize;\nuniform float frustumLength;\n\nin vec2 v_textureCoordinates;\n\nvec4 clipToEye(vec2 uv, float depth)\n{\n    vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n    vec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);\n    posEC = posEC / posEC.w;\n    return posEC;\n}\n\n//Reconstruct Normal Without Edge Removation\nvec3 getNormalXEdge(vec3 posInCamera, float depthU, float depthD, float depthL, float depthR, vec2 pixelSize)\n{\n    vec4 posInCameraUp = clipToEye(v_textureCoordinates - vec2(0.0, pixelSize.y), depthU);\n    vec4 posInCameraDown = clipToEye(v_textureCoordinates + vec2(0.0, pixelSize.y), depthD);\n    vec4 posInCameraLeft = clipToEye(v_textureCoordinates - vec2(pixelSize.x, 0.0), depthL);\n    vec4 posInCameraRight = clipToEye(v_textureCoordinates + vec2(pixelSize.x, 0.0), depthR);\n\n    vec3 up = posInCamera.xyz - posInCameraUp.xyz;\n    vec3 down = posInCameraDown.xyz - posInCamera.xyz;\n    vec3 left = posInCamera.xyz - posInCameraLeft.xyz;\n    vec3 right = posInCameraRight.xyz - posInCamera.xyz;\n\n    vec3 DX = length(left) < length(right) ? left : right;\n    vec3 DY = length(up) < length(down) ? up : down;\n\n    return normalize(cross(DY, DX));\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = clipToEye(v_textureCoordinates, depth);\n\n    if (posInCamera.z > frustumLength)\n    {\n        out_FragColor = vec4(1.0);\n        return;\n    }\n\n    vec2 pixelSize = czm_pixelRatio / czm_viewport.zw;\n    float depthU = czm_readDepth(depthTexture, v_textureCoordinates - vec2(0.0, pixelSize.y));\n    float depthD = czm_readDepth(depthTexture, v_textureCoordinates + vec2(0.0, pixelSize.y));\n    float depthL = czm_readDepth(depthTexture, v_textureCoordinates - vec2(pixelSize.x, 0.0));\n    float depthR = czm_readDepth(depthTexture, v_textureCoordinates + vec2(pixelSize.x, 0.0));\n    vec3 normalInCamera = getNormalXEdge(posInCamera.xyz, depthU, depthD, depthL, depthR, pixelSize);\n\n    float ao = 0.0;\n    vec2 sampleDirection = vec2(1.0, 0.0);\n    float gapAngle = 90.0 * czm_radiansPerDegree;\n\n    // RandomNoise\n    float randomVal = texture(randomTexture, v_textureCoordinates / pixelSize / 255.0).x;\n\n    //Loop for each direction\n    for (int i = 0; i < 4; i++)\n    {\n        float newGapAngle = gapAngle * (float(i) + randomVal);\n        float cosVal = cos(newGapAngle);\n        float sinVal = sin(newGapAngle);\n\n        //Rotate Sampling Direction\n        vec2 rotatedSampleDirection = vec2(cosVal * sampleDirection.x - sinVal * sampleDirection.y, sinVal * sampleDirection.x + cosVal * sampleDirection.y);\n        float localAO = 0.0;\n        float localStepSize = stepSize;\n\n        //Loop for each step\n        for (int j = 0; j < 6; j++)\n        {\n            vec2 newCoords = v_textureCoordinates + rotatedSampleDirection * localStepSize * pixelSize;\n\n            //Exception Handling\n            if(newCoords.x > 1.0 || newCoords.y > 1.0 || newCoords.x < 0.0 || newCoords.y < 0.0)\n            {\n                break;\n            }\n\n            float stepDepthInfo = czm_readDepth(depthTexture, newCoords);\n            vec4 stepPosInCamera = clipToEye(newCoords, stepDepthInfo);\n            vec3 diffVec = stepPosInCamera.xyz - posInCamera.xyz;\n            float len = length(diffVec);\n\n            if (len > lengthCap)\n            {\n                break;\n            }\n\n            float dotVal = clamp(dot(normalInCamera, normalize(diffVec)), 0.0, 1.0 );\n            float weight = len / lengthCap;\n            weight = 1.0 - weight * weight;\n\n            if (dotVal < bias)\n            {\n                dotVal = 0.0;\n            }\n\n            localAO = max(localAO, dotVal * weight);\n            localStepSize += stepSize;\n        }\n        ao += localAO;\n    }\n\n    ao /= 4.0;\n    ao = 1.0 - clamp(ao, 0.0, 1.0);\n    ao = pow(ao, intensity);\n    out_FragColor = vec4(vec3(ao), 1.0);\n}\n",mV="uniform sampler2D colorTexture;\nuniform sampler2D ambientOcclusionTexture;\nuniform bool ambientOcclusionOnly;\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    vec4 ao = texture(ambientOcclusionTexture, v_textureCoordinates);\n    out_FragColor = ambientOcclusionOnly ? ao : ao * color;\n}\n",pV="uniform sampler2D colorTexture;\nuniform float gradations;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        out_FragColor = vec4(rgb, 1.0);\n        return;\n    }\n#endif\n    float luminance = czm_luminance(rgb);\n    float darkness = luminance * gradations;\n    darkness = (darkness - fract(darkness)) / gradations;\n    out_FragColor = vec4(vec3(darkness), 1.0);\n}\n",_V="uniform sampler2D colorTexture;\nuniform sampler2D bloomTexture;\nuniform bool glowOnly;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n\n#ifdef CZM_SELECTED_FEATURE\n    if (czm_selected()) {\n        out_FragColor = color;\n        return;\n    }\n#endif\n\n    vec4 bloom = texture(bloomTexture, v_textureCoordinates);\n    out_FragColor = glowOnly ? bloom : bloom + color;\n}\n",gV="uniform sampler2D colorTexture;\nuniform float brightness;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;\n    vec3 target = vec3(0.0);\n    out_FragColor = vec4(mix(target, rgb, brightness), 1.0);\n}\n",yV="uniform sampler2D colorTexture;\nuniform float contrast;\nuniform float brightness;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec3 sceneColor = texture(colorTexture, v_textureCoordinates).xyz;\n    sceneColor = czm_RGBToHSB(sceneColor);\n    sceneColor.z += brightness;\n    sceneColor = czm_HSBToRGB(sceneColor);\n\n    float factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));\n    sceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);\n    out_FragColor = vec4(sceneColor, 1.0);\n}\n",xV="uniform sampler2D colorTexture;\nuniform sampler2D blurTexture;\nuniform sampler2D depthTexture;\nuniform float focalDistance;\n\nin vec2 v_textureCoordinates;\n\nvec4 toEye(vec2 uv, float depth)\n{\n   vec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\n   vec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\n   posInCamera = posInCamera / posInCamera.w;\n   return posInCamera;\n}\n\nfloat computeDepthBlur(float depth)\n{\n    float f;\n    if (depth < focalDistance)\n    {\n        f = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);\n    }\n    else\n    {\n        f = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);\n        f = pow(f, 0.1);\n    }\n    f *= f;\n    f = clamp(f, 0.0, 1.0);\n    return pow(f, 0.5);\n}\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    vec4 posInCamera = toEye(v_textureCoordinates, depth);\n    float d = computeDepthBlur(-posInCamera.z);\n    out_FragColor = mix(texture(colorTexture, v_textureCoordinates), texture(blurTexture, v_textureCoordinates), d);\n}\n",bV="uniform sampler2D depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float depth = czm_readDepth(depthTexture, v_textureCoordinates);\n    out_FragColor = vec4(vec3(depth), 1.0);\n}\n",TV="uniform sampler2D depthTexture;\nuniform float length;\nuniform vec4 color;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    float directions[3];\n    directions[0] = -1.0;\n    directions[1] = 0.0;\n    directions[2] = 1.0;\n\n    float scalars[3];\n    scalars[0] = 3.0;\n    scalars[1] = 10.0;\n    scalars[2] = 3.0;\n\n    float padx = czm_pixelRatio / czm_viewport.z;\n    float pady = czm_pixelRatio / czm_viewport.w;\n\n#ifdef CZM_SELECTED_FEATURE\n    bool selected = false;\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        selected = selected || czm_selected(vec2(-padx, dir * pady));\n        selected = selected || czm_selected(vec2(padx, dir * pady));\n        selected = selected || czm_selected(vec2(dir * padx, -pady));\n        selected = selected || czm_selected(vec2(dir * padx, pady));\n        if (selected)\n        {\n            break;\n        }\n    }\n    if (!selected)\n    {\n        out_FragColor = vec4(color.rgb, 0.0);\n        return;\n    }\n#endif\n\n    float horizEdge = 0.0;\n    float vertEdge = 0.0;\n\n    for (int i = 0; i < 3; ++i)\n    {\n        float dir = directions[i];\n        float scale = scalars[i];\n\n        horizEdge -= texture(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;\n        horizEdge += texture(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;\n\n        vertEdge -= texture(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;\n        vertEdge += texture(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;\n    }\n\n    float len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);\n    out_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);\n}\n",AV="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\n// See slides 142 and 143:\n//     http://www.gdcvault.com/play/1012459/Uncharted_2__HDR_Lighting\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n\n#ifdef AUTO_EXPOSURE\n    float exposure = texture(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#endif\n\n\tconst float A = 0.22; // shoulder strength\n\tconst float B = 0.30; // linear strength\n\tconst float C = 0.10; // linear angle\n\tconst float D = 0.20; // toe strength\n\tconst float E = 0.01; // toe numerator\n\tconst float F = 0.30; // toe denominator\n\n\tconst float white = 11.2; // linear white point value\n\n\tvec3 c = ((color * (A * color + C * B) + D * E) / (color * ( A * color + B) + D * F)) - E / F;\n\tfloat w = ((white * (A * white + C * B) + D * E) / (white * ( A * white + B) + D * F)) - E / F;\n\n\tc = czm_inverseGamma(c / w);\n\tout_FragColor = vec4(c, fragmentColor.a);\n}\n",CV="in vec2 v_textureCoordinates;\n\nuniform sampler2D colorTexture;\n\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\n\nvoid main()\n{\n    vec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;\n    vec4 color = FxaaPixelShader(\n        v_textureCoordinates,\n        colorTexture,\n        fxaaQualityRcpFrame,\n        fxaaQualitySubpix,\n        fxaaQualityEdgeThreshold,\n        fxaaQualityEdgeThresholdMin);\n    float alpha = texture(colorTexture, v_textureCoordinates).a;\n    out_FragColor = vec4(color.rgb, alpha);\n}\n",Ox="#define SAMPLES 8\n\nuniform float delta;\nuniform float sigma;\nuniform float direction; // 0.0 for x direction, 1.0 for y direction\n\nuniform sampler2D colorTexture;\n\n#ifdef USE_STEP_SIZE\nuniform float stepSize;\n#else\nuniform vec2 step;\n#endif\n\nin vec2 v_textureCoordinates;\n\n//  Incremental Computation of the Gaussian:\n//  https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch40.html\n\nvoid main()\n{\n    vec2 st = v_textureCoordinates;\n    vec2 dir = vec2(1.0 - direction, direction);\n\n#ifdef USE_STEP_SIZE\n    vec2 step = vec2(stepSize * (czm_pixelRatio / czm_viewport.zw));\n#else\n    vec2 step = step;\n#endif\n\n    vec3 g;\n    g.x = 1.0 / (sqrt(czm_twoPi) * sigma);\n    g.y = exp((-0.5 * delta * delta) / (sigma * sigma));\n    g.z = g.y * g.y;\n\n    vec4 result = texture(colorTexture, st) * g.x;\n    for (int i = 1; i < SAMPLES; ++i)\n    {\n        g.xy *= g.yz;\n\n        vec2 offset = float(i) * dir * step;\n        result += texture(colorTexture, st - offset) * g.x;\n        result += texture(colorTexture, st + offset) * g.x;\n    }\n\n    out_FragColor = result;\n}\n",EV="uniform sampler2D colorTexture;\nuniform sampler2D dirtTexture;\nuniform sampler2D starTexture;\nuniform vec2 dirtTextureDimensions;\nuniform float distortion;\nuniform float ghostDispersal;\nuniform float haloWidth;\nuniform float dirtAmount;\nuniform float earthRadius;\nuniform float intensity;\n\nin vec2 v_textureCoordinates;\n\n// whether it is in space or not\n// 6500000.0 is empirical value\n#define DISTANCE_TO_SPACE 6500000.0\n\n// return ndc from world coordinate biased earthRadius\nvec4 getNDCFromWC(vec3 WC, float earthRadius)\n{\n    vec4 positionEC = czm_view * vec4(WC, 1.0);\n    positionEC = vec4(positionEC.x + earthRadius, positionEC.y, positionEC.z, 1.0);\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    return czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n}\n\n// Check if current pixel is included Earth\n// if then mask it gradually\nfloat isInEarth(vec2 texcoord, vec2 sceneSize)\n{\n    vec2 NDC = texcoord * 2.0 - 1.0;\n    vec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);\n    vec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);\n    NDC.xy -= earthPosSC.xy;\n\n    float X = abs(NDC.x) * sceneSize.x;\n    float Y = abs(NDC.y) * sceneSize.y;\n\n    return clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));\n}\n\n// For Chromatic effect\nvec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)\n{\n    vec2 sceneSize = czm_viewport.zw;\n    vec3 color;\n    if(isSpace)\n    {\n        color.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture(tex, texcoord + direction * distortion.r).r;\n        color.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture(tex, texcoord + direction * distortion.g).g;\n        color.b = isInEarth(texcoord + direction * distortion.b, sceneSize) * texture(tex, texcoord + direction * distortion.b).b;\n    }\n    else\n    {\n        color.r = texture(tex, texcoord + direction * distortion.r).r;\n        color.g = texture(tex, texcoord + direction * distortion.g).g;\n        color.b = texture(tex, texcoord + direction * distortion.b).b;\n    }\n    return vec4(clamp(color, 0.0, 1.0), 0.0);\n}\n\nvoid main(void)\n{\n    vec4 originalColor = texture(colorTexture, v_textureCoordinates);\n    vec3 rgb = originalColor.rgb;\n    bool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;\n\n    // Sun position\n    vec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    vec4 sunPositionEC = czm_view * sunPos;\n    vec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);\n    sunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);\n\n    // If sun is not in the screen space, use original color.\n    if(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))\n    {\n        // Lens flare is disabled when not in space until #5932 is fixed.\n        //    https://github.com/CesiumGS/cesium/issues/5932\n        out_FragColor = originalColor;\n        return;\n    }\n\n    vec2 texcoord = vec2(1.0) - v_textureCoordinates;\n    vec2 pixelSize = czm_pixelRatio / czm_viewport.zw;\n    vec2 invPixelSize = 1.0 / pixelSize;\n    vec3 distortionVec = pixelSize.x * vec3(-distortion, 0.0, distortion);\n\n    // ghost vector to image centre:\n    vec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;\n    vec3 direction = normalize(vec3(ghostVec, 0.0));\n\n    // sample ghosts:\n    vec4 result = vec4(0.0);\n    vec4 ghost = vec4(0.0);\n    for (int i = 0; i < 4; ++i)\n    {\n        vec2 offset = fract(texcoord + ghostVec * float(i));\n        // Only bright spots from the centre of the source image\n        ghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);\n    }\n    result += ghost;\n\n    // sample halo\n    vec2 haloVec = normalize(ghostVec) * haloWidth;\n    float weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\n    weightForHalo = pow(1.0 - weightForHalo, 5.0);\n\n    result += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;\n\n    // dirt on lens\n    vec2 dirtTexCoords = (v_textureCoordinates * invPixelSize) / dirtTextureDimensions;\n    if (dirtTexCoords.x > 1.0)\n    {\n        dirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);\n    }\n    if (dirtTexCoords.y > 1.0)\n    {\n        dirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);\n    }\n    result += dirtAmount * texture(dirtTexture, dirtTexCoords);\n\n    // Rotating starburst texture's coordinate\n    // dot(czm_view[0].xyz, vec3(0.0, 0.0, 1.0)) + dot(czm_view[1].xyz, vec3(0.0, 1.0, 0.0))\n    float camrot = czm_view[0].z + czm_view[1].y;\n    float cosValue = cos(camrot);\n    float sinValue = sin(camrot);\n    mat3 rotation = mat3(\n        cosValue, -sinValue, 0.0,\n        sinValue, cosValue, 0.0,\n        0.0, 0.0, 1.0\n    );\n\n    vec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);\n    vec3 st2 = vec3((rotation * st1).xy, 1.0);\n    vec3 st3 = st2 * 0.5 + vec3(0.5);\n    vec2 lensStarTexcoord = st3.xy;\n    float weightForLensFlare = length(vec3(sunPos.xy, 0.0));\n    float oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);\n\n    if (!isSpace)\n    {\n        result *= oneMinusWeightForLensFlare * intensity * 0.2;\n    }\n    else\n    {\n        result *= oneMinusWeightForLensFlare * intensity;\n        result *= texture(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;\n    }\n\n    result += texture(colorTexture, v_textureCoordinates);\n\n    out_FragColor = result;\n}\n",SV="uniform sampler2D colorTexture;\nuniform vec3 white;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\n// See equation 4:\n//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\n    float exposure = texture(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#endif\n    color = (color * (1.0 + color / white)) / (1.0 + color);\n    color = czm_inverseGamma(color);\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",wV="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main(void)\n{\n    float noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;\n    vec3 rgb = texture(colorTexture, v_textureCoordinates).rgb;\n    vec3 green = vec3(0.0, 1.0, 0.0);\n    out_FragColor = vec4((noiseValue + rgb) * green, 1.0);\n}\n",vV="uniform sampler2D colorTexture;\n\nin vec2 v_textureCoordinates;\n\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\n\n// See equation 3:\n//    http://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf\n\nvoid main()\n{\n    vec4 fragmentColor = texture(colorTexture, v_textureCoordinates);\n    vec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\n    float exposure = texture(autoExposure, vec2(0.5)).r;\n    color /= exposure;\n#endif\n    color = color / (1.0 + color);\n    color = czm_inverseGamma(color);\n    out_FragColor = vec4(color, fragmentColor.a);\n}\n",DV="uniform sampler2D colorTexture;\nuniform sampler2D silhouetteTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main(void)\n{\n    vec4 silhouetteColor = texture(silhouetteTexture, v_textureCoordinates);\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    out_FragColor = mix(color, silhouetteColor, silhouetteColor.a);\n}\n",IV="/**\n * @license\n * Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *  * Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *  * Neither the name of NVIDIA CORPORATION nor the names of its\n *    contributors may be used to endorse or promote products derived\n *    from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n// NVIDIA GameWorks Graphics Samples GitHub link: https://github.com/NVIDIAGameWorks/GraphicsSamples\n// Original FXAA 3.11 shader link: https://github.com/NVIDIAGameWorks/GraphicsSamples/blob/master/samples/es3-kepler/FXAA/FXAA3_11.h\n\n// Steps used to integrate into Cesium:\n// * The following defines are set:\n//       #define FXAA_PC 1\n//       #define FXAA_WEBGL_1 1\n//       #define FXAA_GREEN_AS_LUMA 1\n//       #define FXAA_EARLY_EXIT 1\n//       #define FXAA_GLSL_120 1\n// * All other preprocessor directives besides the FXAA_QUALITY__P* directives were removed.\n// * Double underscores are invalid for preprocessor directives so replace them with a single underscore. Replace\n//   /FXAA_QUALITY__P(.*)/g with /FXAA_QUALITY__P$1/.\n// * There are no implicit conversions from ivec* to vec* so replace:\n//       #define FxaaInt2 ivec2\n//           with\n//       #define FxaaInt2 vec2\n// * The texture2DLod function is only available in vertex shaders so replace:\n//       #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)\n//       #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)\n//           with\n//       #define FxaaTexTop(t, p) texture(t, p)\n//       #define FxaaTexOff(t, p, o, r) texture(t, p + (o * r))\n// * FXAA_QUALITY_PRESET is prepended in the javascript code. We may want to expose that setting in the future.\n// * The following parameters to FxaaPixelShader are unused and can be removed:\n//       fxaaConsolePosPos\n//       fxaaConsoleRcpFrameOpt\n//       fxaaConsoleRcpFrameOpt2\n//       fxaaConsole360RcpFrameOpt2\n//       fxaaConsoleEdgeSharpness\n//       fxaaConsoleEdgeThreshold\n//       fxaaConsoleEdgeThresholdMi\n//       fxaaConsole360ConstDir\n\n//\n// Choose the quality preset.\n// This needs to be compiled into the shader as it effects code.\n// Best option to include multiple presets is to\n// in each shader define the preset, then include this file.\n//\n// OPTIONS\n// -----------------------------------------------------------------------\n// 10 to 15 - default medium dither (10=fastest, 15=highest quality)\n// 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)\n// 39       - no dither, very expensive\n//\n// NOTES\n// -----------------------------------------------------------------------\n// 12 = slightly faster then FXAA 3.9 and higher edge quality (default)\n// 13 = about same speed as FXAA 3.9 and better than 12\n// 23 = closest to FXAA 3.9 visually and performance wise\n//  _ = the lowest digit is directly related to performance\n// _  = the highest digit is directly related to style\n//\n//#define FXAA_QUALITY_PRESET 12\n\n\n#if (FXAA_QUALITY_PRESET == 10)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 3.0\n    #define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 3.0\n    #define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 4.0\n    #define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 4.0\n    #define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 4.0\n    #define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n    #define FXAA_QUALITY_PS 3\n    #define FXAA_QUALITY_P0 1.5\n    #define FXAA_QUALITY_P1 2.0\n    #define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n    #define FXAA_QUALITY_PS 4\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n    #define FXAA_QUALITY_PS 5\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n    #define FXAA_QUALITY_PS 6\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n    #define FXAA_QUALITY_PS 7\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 3.0\n    #define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n    #define FXAA_QUALITY_PS 8\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 4.0\n    #define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n    #define FXAA_QUALITY_PS 9\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 4.0\n    #define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n    #define FXAA_QUALITY_PS 10\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 4.0\n    #define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n    #define FXAA_QUALITY_PS 11\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 4.0\n    #define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.5\n    #define FXAA_QUALITY_P2 2.0\n    #define FXAA_QUALITY_P3 2.0\n    #define FXAA_QUALITY_P4 2.0\n    #define FXAA_QUALITY_P5 2.0\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n    #define FXAA_QUALITY_PS 12\n    #define FXAA_QUALITY_P0 1.0\n    #define FXAA_QUALITY_P1 1.0\n    #define FXAA_QUALITY_P2 1.0\n    #define FXAA_QUALITY_P3 1.0\n    #define FXAA_QUALITY_P4 1.0\n    #define FXAA_QUALITY_P5 1.5\n    #define FXAA_QUALITY_P6 2.0\n    #define FXAA_QUALITY_P7 2.0\n    #define FXAA_QUALITY_P8 2.0\n    #define FXAA_QUALITY_P9 2.0\n    #define FXAA_QUALITY_P10 4.0\n    #define FXAA_QUALITY_P11 8.0\n#endif\n\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture(t, p)\n#define FxaaTexOff(t, p, o, r) texture(t, p + (o * r))\n\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\n\nFxaaFloat4 FxaaPixelShader(\n    //\n    // Use noperspective interpolation here (turn off perspective interpolation).\n    // {xy} = center of pixel\n    FxaaFloat2 pos,\n    //\n    // Input color texture.\n    // {rgb_} = color in linear or perceptual color space\n    // if (FXAA_GREEN_AS_LUMA == 0)\n    //     {___a} = luma in perceptual color space (not linear)\n    FxaaTex tex,\n    //\n    // Only used on FXAA Quality.\n    // This must be from a constant/uniform.\n    // {x_} = 1.0/screenWidthInPixels\n    // {_y} = 1.0/screenHeightInPixels\n    FxaaFloat2 fxaaQualityRcpFrame,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_SUBPIX define.\n    // It is here now to allow easier tuning.\n    // Choose the amount of sub-pixel aliasing removal.\n    // This can effect sharpness.\n    //   1.00 - upper limit (softer)\n    //   0.75 - default amount of filtering\n    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)\n    //   0.25 - almost off\n    //   0.00 - completely off\n    FxaaFloat fxaaQualitySubpix,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.\n    // It is here now to allow easier tuning.\n    // The minimum amount of local contrast required to apply algorithm.\n    //   0.333 - too little (faster)\n    //   0.250 - low quality\n    //   0.166 - default\n    //   0.125 - high quality\n    //   0.063 - overkill (slower)\n    FxaaFloat fxaaQualityEdgeThreshold,\n    //\n    // Only used on FXAA Quality.\n    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.\n    // It is here now to allow easier tuning.\n    // Trims the algorithm from processing darks.\n    //   0.0833 - upper limit (default, the start of visible unfiltered edges)\n    //   0.0625 - high quality (faster)\n    //   0.0312 - visible limit (slower)\n    // Special notes when using FXAA_GREEN_AS_LUMA,\n    //   Likely want to set this to zero.\n    //   As colors that are mostly not-green\n    //   will appear very dark in the green channel!\n    //   Tune by looking at mostly non-green content,\n    //   then start at zero and increase until aliasing is a problem.\n    FxaaFloat fxaaQualityEdgeThresholdMin\n) {\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posM;\n    posM.x = pos.x;\n    posM.y = pos.y;\n    FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n    #define lumaM rgbyM.y\n    FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat maxSM = max(lumaS, lumaM);\n    FxaaFloat minSM = min(lumaS, lumaM);\n    FxaaFloat maxESM = max(lumaE, maxSM);\n    FxaaFloat minESM = min(lumaE, minSM);\n    FxaaFloat maxWN = max(lumaN, lumaW);\n    FxaaFloat minWN = min(lumaN, lumaW);\n    FxaaFloat rangeMax = max(maxWN, maxESM);\n    FxaaFloat rangeMin = min(minWN, minESM);\n    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\n    FxaaFloat range = rangeMax - rangeMin;\n    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\n    FxaaBool earlyExit = range < rangeMaxClamped;\n/*--------------------------------------------------------------------------*/\n    if(earlyExit)\n        return rgbyM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\n    FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNS = lumaN + lumaS;\n    FxaaFloat lumaWE = lumaW + lumaE;\n    FxaaFloat subpixRcpRange = 1.0/range;\n    FxaaFloat subpixNSWE = lumaNS + lumaWE;\n    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\n    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNESE = lumaNE + lumaSE;\n    FxaaFloat lumaNWNE = lumaNW + lumaNE;\n    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\n    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat lumaNWSW = lumaNW + lumaSW;\n    FxaaFloat lumaSWSE = lumaSW + lumaSE;\n    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\n    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\n    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\n    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\n    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\n    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\n    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;\n    FxaaBool horzSpan = edgeHorz >= edgeVert;\n    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\n/*--------------------------------------------------------------------------*/\n    if(!horzSpan) lumaN = lumaW;\n    if(!horzSpan) lumaS = lumaE;\n    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\n    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat gradientN = lumaN - lumaM;\n    FxaaFloat gradientS = lumaS - lumaM;\n    FxaaFloat lumaNN = lumaN + lumaM;\n    FxaaFloat lumaSS = lumaS + lumaM;\n    FxaaBool pairN = abs(gradientN) >= abs(gradientS);\n    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));\n    if(pairN) lengthSign = -lengthSign;\n    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posB;\n    posB.x = posM.x;\n    posB.y = posM.y;\n    FxaaFloat2 offNP;\n    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\n    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\n    if(!horzSpan) posB.x += lengthSign * 0.5;\n    if( horzSpan) posB.y += lengthSign * 0.5;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat2 posN;\n    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\n    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat2 posP;\n    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\n    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\n    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\n    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\n    FxaaFloat subpixE = subpixC * subpixC;\n    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\n/*--------------------------------------------------------------------------*/\n    if(!pairN) lumaNN = lumaSS;\n    FxaaFloat gradientScaled = gradient * 1.0/4.0;\n    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;\n    FxaaFloat subpixF = subpixD * subpixE;\n    FxaaBool lumaMLTZero = lumaMM < 0.0;\n/*--------------------------------------------------------------------------*/\n    lumaEndN -= lumaNN * 0.5;\n    lumaEndP -= lumaNN * 0.5;\n    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;\n    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;\n    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\n    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\n    FxaaBool doneNP = (!doneN) || (!doneP);\n    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\n    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\n/*--------------------------------------------------------------------------*/\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 3)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 4)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 5)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 6)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n/*--------------------------------------------------------------------------*/\n                        #if (FXAA_QUALITY_PS > 7)\n                        if(doneNP) {\n                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                            doneN = abs(lumaEndN) >= gradientScaled;\n                            doneP = abs(lumaEndP) >= gradientScaled;\n                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\n                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\n                            doneNP = (!doneN) || (!doneP);\n                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\n                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n/*--------------------------------------------------------------------------*/\n    #if (FXAA_QUALITY_PS > 8)\n    if(doneNP) {\n        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n        doneN = abs(lumaEndN) >= gradientScaled;\n        doneP = abs(lumaEndP) >= gradientScaled;\n        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\n        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\n        doneNP = (!doneN) || (!doneP);\n        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\n        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n/*--------------------------------------------------------------------------*/\n        #if (FXAA_QUALITY_PS > 9)\n        if(doneNP) {\n            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n            doneN = abs(lumaEndN) >= gradientScaled;\n            doneP = abs(lumaEndP) >= gradientScaled;\n            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\n            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\n            doneNP = (!doneN) || (!doneP);\n            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\n            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n/*--------------------------------------------------------------------------*/\n            #if (FXAA_QUALITY_PS > 10)\n            if(doneNP) {\n                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                doneN = abs(lumaEndN) >= gradientScaled;\n                doneP = abs(lumaEndP) >= gradientScaled;\n                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\n                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\n                doneNP = (!doneN) || (!doneP);\n                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\n                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n/*--------------------------------------------------------------------------*/\n                #if (FXAA_QUALITY_PS > 11)\n                if(doneNP) {\n                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                    doneN = abs(lumaEndN) >= gradientScaled;\n                    doneP = abs(lumaEndP) >= gradientScaled;\n                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\n                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\n                    doneNP = (!doneN) || (!doneP);\n                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\n                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n/*--------------------------------------------------------------------------*/\n                    #if (FXAA_QUALITY_PS > 12)\n                    if(doneNP) {\n                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\n                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\n                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\n                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\n                        doneN = abs(lumaEndN) >= gradientScaled;\n                        doneP = abs(lumaEndP) >= gradientScaled;\n                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\n                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\n                        doneNP = (!doneN) || (!doneP);\n                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\n                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n    #endif\n/*--------------------------------------------------------------------------*/\n                        }\n                        #endif\n/*--------------------------------------------------------------------------*/\n                    }\n                    #endif\n/*--------------------------------------------------------------------------*/\n                }\n                #endif\n/*--------------------------------------------------------------------------*/\n            }\n            #endif\n/*--------------------------------------------------------------------------*/\n        }\n        #endif\n/*--------------------------------------------------------------------------*/\n    }\n/*--------------------------------------------------------------------------*/\n    FxaaFloat dstN = posM.x - posN.x;\n    FxaaFloat dstP = posP.x - posM.x;\n    if(!horzSpan) dstN = posM.y - posN.y;\n    if(!horzSpan) dstP = posP.y - posM.y;\n/*--------------------------------------------------------------------------*/\n    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\n    FxaaFloat spanLength = (dstP + dstN);\n    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\n    FxaaFloat spanLengthRcp = 1.0/spanLength;\n/*--------------------------------------------------------------------------*/\n    FxaaBool directionN = dstN < dstP;\n    FxaaFloat dst = min(dstN, dstP);\n    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\n    FxaaFloat subpixG = subpixF * subpixF;\n    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\n    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;\n/*--------------------------------------------------------------------------*/\n    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\n    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\n    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\n    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\n    return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n";function Rx(e){e=y(e,y.EMPTY_OBJECT),this._stages=e.stages,this._inputPreviousStageTexture=y(e.inputPreviousStageTexture,!0);let t=e.name;u(t)||(t=jn()),this._name=t,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}function eot(e){let t=u(e._selected)?e._selected.length:0,i=u(e._parentSelected)?e._parentSelected:0,n=e._selected!==e._selectedShadow||t!==e._selectedLength;if(n=n||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,u(e._selected)&&u(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):u(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!n&&u(e._combinedSelected)){if(!u(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(let i=0;i<t;++i)if(e._combinedSelected[i]!==e._combinedSelectedShadow[i])return!0}return n}Object.defineProperties(Rx.prototype,{ready:{get:function(){let e=this._stages,t=e.length;for(let i=0;i<t;++i)if(!e[i].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){let t=this._stages,i=t.length;for(let n=0;n<i;++n)t[n].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),Rx.prototype._isSupported=function(e){let t=this._stages,i=t.length;for(let n=0;n<i;++n)if(!t[n]._isSupported(e))return!1;return!0},Rx.prototype.get=function(e){return this._stages[e]},Rx.prototype.update=function(e,t){this._selectedDirty=eot(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=u(this._selected)?this._selected.length:0,this._parentSelectedLength=u(this._parentSelected)?this._parentSelected.length:0;let i=this._stages,n=i.length;for(let r=0;r<n;++r){let n=i[r];this._selectedDirty&&(n.parentSelected=this._combinedSelected),n.update(e,t)}},Rx.prototype.isDestroyed=function(){return!1},Rx.prototype.destroy=function(){let e=this._stages,t=e.length;for(let i=0;i<t;++i)e[i].destroy();return le(this)};var _l=Rx,Cr={};function PV(e){let t=`#define USE_STEP_SIZE\n${Ox}`,i=new _o({name:`${e}_x_direction`,fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:gf.LINEAR}),n=new _o({name:`${e}_y_direction`,fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:gf.LINEAR}),r={};return Object.defineProperties(r,{delta:{get:function(){return i.uniforms.delta},set:function(e){let t=i.uniforms,r=n.uniforms;t.delta=r.delta=e}},sigma:{get:function(){return i.uniforms.sigma},set:function(e){let t=i.uniforms,r=n.uniforms;t.sigma=r.sigma=e}},stepSize:{get:function(){return i.uniforms.stepSize},set:function(e){let t=i.uniforms,r=n.uniforms;t.stepSize=r.stepSize=e}}}),new _l({name:e,stages:[i,n],uniforms:r})}function tot(e){if(!u(e))return Cr.createEdgeDetectionStage();let t=new _l({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),i={},n="",r="";for(let t=0;t<e.length;++t)n+=`uniform sampler2D edgeTexture${t}; \n`,r+=`        vec4 edge${t} = texture(edgeTexture${t}, v_textureCoordinates); \n        if (edge${t}.a > 0.0) \n        { \n            color = edge${t}; \n            break; \n        } \n`,i[`edgeTexture${t}`]=e[t].name;let o=`${n}in vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n    for (int i = 0; i < ${e.length}; i++) \n    { \n${r}    } \n    out_FragColor = color; \n} \n`,a=new _o({name:"czm_edge_detection_combine",fragmentShader:o,uniforms:i});return new _l({name:"czm_edge_detection_composite",stages:[t,a]})}Cr.createBlurStage=function(){return PV("czm_blur")},Cr.createDepthOfFieldStage=function(){let e=PV("czm_depth_of_field_blur"),t=new _o({name:"czm_depth_of_field_composite",fragmentShader:xV,uniforms:{focalDistance:5,blurTexture:e.name}}),i={};return Object.defineProperties(i,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new _l({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:i})},Cr.isDepthOfFieldSupported=function(e){return e.context.depthTexture},Cr.createEdgeDetectionStage=function(){let e=jn();return new _o({name:`czm_edge_detection_${e}`,fragmentShader:TV,uniforms:{length:.25,color:z.clone(z.BLACK)}})},Cr.isEdgeDetectionSupported=function(e){return e.context.depthTexture},Cr.createSilhouetteStage=function(e){let t=tot(e),i=new _o({name:"czm_silhouette_color_edges",fragmentShader:DV,uniforms:{silhouetteTexture:t.name}});return new _l({name:"czm_silhouette",stages:[t,i],inputPreviousStageTexture:!1,uniforms:t.uniforms})},Cr.isSilhouetteSupported=function(e){return e.context.depthTexture},Cr.createBloomStage=function(){let e=new _o({name:"czm_bloom_contrast_bias",fragmentShader:yV,uniforms:{contrast:128,brightness:-.3}}),t=PV("czm_bloom_blur"),i=new _l({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),n=new _o({name:"czm_bloom_generate_composite",fragmentShader:_V,uniforms:{glowOnly:!1,bloomTexture:i.name}}),r={};return Object.defineProperties(r,{glowOnly:{get:function(){return n.uniforms.glowOnly},set:function(e){n.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new _l({name:"czm_bloom",stages:[i,n],inputPreviousStageTexture:!1,uniforms:r})},Cr.createAmbientOcclusionStage=function(){let e=new _o({name:"czm_ambient_occlusion_generate",fragmentShader:hV,uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=PV("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;let i=new _l({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),n=new _o({name:"czm_ambient_occlusion_composite",fragmentShader:mV,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:i.name}}),r={};return Object.defineProperties(r,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(t){e.uniforms.frustumLength=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}},ambientOcclusionOnly:{get:function(){return n.uniforms.ambientOcclusionOnly},set:function(e){n.uniforms.ambientOcclusionOnly=e}}}),new _l({name:"czm_ambient_occlusion",stages:[i,n],inputPreviousStageTexture:!1,uniforms:r})},Cr.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};var not=`#define FXAA_QUALITY_PRESET 39 \n${IV}\n${CV}`;Cr.createFXAAStage=function(){return new _o({name:"czm_FXAA",fragmentShader:not,sampleMode:gf.LINEAR})},Cr.createAcesTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=dV,new _o({name:"czm_aces",fragmentShader:t,uniforms:{autoExposure:void 0}})},Cr.createFilmicTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=AV,new _o({name:"czm_filmic",fragmentShader:t,uniforms:{autoExposure:void 0}})},Cr.createReinhardTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=vV,new _o({name:"czm_reinhard",fragmentShader:t,uniforms:{autoExposure:void 0}})},Cr.createModifiedReinhardTonemappingStage=function(e){let t=e?"#define AUTO_EXPOSURE\n":"";return t+=SV,new _o({name:"czm_modified_reinhard",fragmentShader:t,uniforms:{white:z.WHITE,autoExposure:void 0}})},Cr.createAutoExposureStage=function(){return new YO},Cr.createBlackAndWhiteStage=function(){return new _o({name:"czm_black_and_white",fragmentShader:pV,uniforms:{gradations:5}})},Cr.createBrightnessStage=function(){return new _o({name:"czm_brightness",fragmentShader:gV,uniforms:{brightness:.5}})},Cr.createNightVisionStage=function(){return new _o({name:"czm_night_vision",fragmentShader:wV})},Cr.createDepthViewStage=function(){return new _o({name:"czm_depth_view",fragmentShader:bV})},Cr.createLensFlareStage=function(){return new _o({name:"czm_lens_flare",fragmentShader:EV,uniforms:{dirtTexture:$t("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:$t("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,dirtAmount:.4,earthRadius:ie.WGS84.maximumRadius}})};var Sd=Cr;function Wp(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function cD(e){for(;u(e.length);)e=e.get(e.length-1);return e.name}function Xj(e,t,i,n,r){if(!n.enabled||!n._isSupported(t))return r;let o=i[n.name]={};if(u(r)){o[cD(e.getStageByName(r))]=!0}let a=n.uniforms;if(u(a)){let t=Object.getOwnPropertyNames(a),i=t.length;for(let n=0;n<i;++n){let i=a[t[n]];if("string"==typeof i){let t=e.getStageByName(i);u(t)&&(o[cD(t)]=!0)}}}return n.name}function aD(e,t,i,n,r){if(u(n.enabled)&&!n.enabled||u(n._isSupported)&&!n._isSupported(t))return r;let o,a,s=r,l=!u(n.inputPreviousStageTexture)||n.inputPreviousStageTexture,c=r,h=n.length;for(let o=0;o<h;++o){let a=n.get(o);c=u(a.length)?aD(e,t,i,a,r):Xj(e,t,i,a,r),l&&(r=c)}if(l)for(o=1;o<h;++o)a=cD(n.get(o)),u(i[a])||(i[a]={}),i[a][s]=!0;else for(o=1;o<h;++o){a=cD(n.get(o));let e=i[a];for(let t=0;t<o;++t)e[cD(n.get(t))]=!0}return c}function iot(e,t){let i={};if(u(e.ambientOcclusion)){let n=e.ambientOcclusion,r=e.bloom,o=e._tonemapping,a=e.fxaa,s=aD(e,t,i,n,void 0);s=aD(e,t,i,r,s),s=Xj(e,t,i,o,s),s=aD(e,t,i,e,s),Xj(e,t,i,a,s)}else aD(e,t,i,e,void 0);return i}function oot(e,t,i){let n,r,o=e._collection.getStageByName(t),a=o._textureScale,s=o._forcePowerOfTwo,l=o._pixelFormat,c=o._pixelDatatype,h=o._clearColor,d=e._framebuffers,p=d.length;for(n=0;n<p;++n){if(r=d[n],a!==r.textureScale||s!==r.forcePowerOfTwo||l!==r.pixelFormat||c!==r.pixelDatatype||!z.equals(h,r.clearColor))continue;let e=r.stages,t=e.length,o=!1;for(let n=0;n<t;++n)if(i[e[n]]){o=!0;break}if(!o)break}return u(r)&&n<p?(r.stages.push(t),r):(r={textureScale:a,forcePowerOfTwo:s,pixelFormat:l,pixelDatatype:c,clearColor:h,stages:[t],buffer:new di({pixelFormat:l,pixelDatatype:c}),clear:void 0},d.push(r),r)}function rot(e,t){let i=iot(e._collection,t);for(let t in i)i.hasOwnProperty(t)&&(e._stageNameToFramebuffer[t]=oot(e,t,i[t]))}function Kj(e){let t=e._framebuffers,i=t.length;for(let e=0;e<i;++e)t[e].buffer.destroy()}function sot(e,t){let i=e._width,n=e._height,r=e._framebuffers,o=r.length;for(let e=0;e<o;++e){let o=r[e],a=o.textureScale,s=Math.ceil(i*a),l=Math.ceil(n*a),u=Math.min(s,l);o.forcePowerOfTwo&&(P.isPowerOfTwo(u)||(u=P.nextPowerOfTwo(u)),s=u,l=u),o.buffer.update(t,s,l),o.clear=new ti({color:o.clearColor,framebuffer:o.buffer.framebuffer})}}Wp.prototype.updateDependencies=function(){this._updateDependencies=!0},Wp.prototype.update=function(e){let t=this._collection,i=this._updateDependencies,n=u(t.ambientOcclusion)&&t.ambientOcclusion.enabled&&t.ambientOcclusion._isSupported(e),r=u(t.bloom)&&t.bloom.enabled&&t.bloom._isSupported(e),o=u(t._tonemapping)&&t._tonemapping.enabled&&t._tonemapping._isSupported(e),a=u(t.fxaa)&&t.fxaa.enabled&&t.fxaa._isSupported(e),s=!u(t._activeStages)||t._activeStages.length>0||n||r||o||a;if((i||!s&&this._framebuffers.length>0)&&(Kj(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),!i&&!s)return;0===this._framebuffers.length&&rot(this,e);let l=e.drawingBufferWidth,c=e.drawingBufferHeight,h=this._width!==l||this._height!==c;!i&&!h||(this._width=l,this._height=c,this._updateDependencies=!1,Kj(this),sot(this,e))},Wp.prototype.clear=function(e){let t=this._framebuffers;for(let i=0;i<t.length;++i)t[i].clear.execute(e)},Wp.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},Wp.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},Wp.prototype.getFramebuffer=function(e){let t=this._stageNameToFramebuffer[e];if(u(t))return t.buffer.framebuffer},Wp.prototype.isDestroyed=function(){return!1},Wp.prototype.destroy=function(){return Kj(this),le(this)};var TC=Wp,lD={REINHARD:0,MODIFIED_REINHARD:1,FILMIC:2,ACES:3,validate:function(e){return e===lD.REINHARD||e===lD.MODIFIED_REINHARD||e===lD.FILMIC||e===lD.ACES}},Mx=Object.freeze(lD),Zj=[];function Cc(){let e=Sd.createFXAAStage(),t=Sd.createAmbientOcclusionStage(),i=Sd.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=Sd.createAutoExposureStage(),this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=Mx.ACES;let n=this._tonemapping;e.enabled=!1,t.enabled=!1,i.enabled=!1,n.enabled=!1;let r=new TC(this),o={},a=Zj;for(a.push(e,t,i,n);a.length>0;){let e=a.pop();o[e.name]=e,e._textureCache=r;let t=e.length;if(u(t))for(let i=0;i<t;++i)a.push(e.get(i))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0;let s=this;t.uniforms.randomTexture=function(){return s._randomTexture},this._ao=t,this._bloom=i,this._fxaa=e,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._activeStagesChanged=!1,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=o,this._textureCache=r}function $j(e){if(!e._stagesRemoved)return;e._stagesRemoved=!1;let t=[],i=e._stages,n=i.length;for(let e=0,r=0;e<n;++e){let n=i[e];n&&(n._index=r++,t.push(n))}e._stages=t}function Lx(e){for(;u(e.length);)e=e.get(e.length-1);return e.outputTexture}function im(e,t,i,n,r){if(u(e.execute))return void e.execute(t,i,n,r);let o,a=e.length;if(e.inputPreviousStageTexture)for(im(e.get(0),t,i,n,r),o=1;o<a;++o)im(e.get(o),t,Lx(e.get(o-1)),n,r);else for(o=0;o<a;++o)im(e.get(o),t,i,n,r)}Object.defineProperties(Cc.prototype,{ready:{get:function(){let e=!1,t=this._stages;for(let i=t.length-1;i>=0;--i){let n=t[i];e=e||n.ready&&n.enabled}let i=this._fxaa,n=this._ao,r=this._bloom,o=this._tonemapping;return e=e||i.ready&&i.enabled,e=e||n.ready&&n.enabled,e=e||r.ready&&r.enabled,e=e||o.ready&&o.enabled,e}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return $j(this),this._stages.length}},outputTexture:{get:function(){let e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);let t=this._stages;for(let e=t.length-1;e>=0;--e){let i=t[e];if(u(i)&&i.ready&&i.enabled)return this.getOutputTexture(i.name)}let i=this._tonemapping;if(i.enabled&&i.ready)return this.getOutputTexture(i.name);let n=this._bloom;if(n.enabled&&n.ready)return this.getOutputTexture(n.name);let r=this._ao;return r.enabled&&r.ready?this.getOutputTexture(r.name):void 0}},hasSelected:{get:function(){let e=this._stages.slice();for(;e.length>0;){let t=e.pop();if(!u(t))continue;if(u(t.selected))return!0;let i=t.length;if(u(i))for(let n=0;n<i;++n)e.push(t.get(n))}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper===e)return;u(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());let t,i=this._autoExposureEnabled;switch(e){case Mx.REINHARD:t=Sd.createReinhardTonemappingStage(i);break;case Mx.MODIFIED_REINHARD:t=Sd.createModifiedReinhardTonemappingStage(i);break;case Mx.FILMIC:t=Sd.createFilmicTonemappingStage(i);break;default:t=Sd.createAcesTonemappingStage(i)}if(i){let e=this._autoExposure;t.uniforms.autoExposure=function(){return e.outputTexture}}this._tonemapper=e,this._tonemapping=t,u(this._stageNames)&&(this._stageNames[t.name]=t,t._textureCache=this._textureCache),this._textureCacheDirty=!0}}}),Cc.prototype.add=function(e){let t=this._stageNames,i=Zj;for(i.push(e);i.length>0;){let e=i.pop();t[e.name]=e,e._textureCache=this._textureCache;let n=e.length;if(u(n))for(let t=0;t<n;++t)i.push(e.get(t))}let n=this._stages;return e._index=n.length,n.push(e),this._textureCacheDirty=!0,e},Cc.prototype.remove=function(e){if(!this.contains(e))return!1;let t=this._stageNames,i=Zj;for(i.push(e);i.length>0;){let e=i.pop();delete t[e.name];let n=e.length;if(u(n))for(let t=0;t<n;++t)i.push(e.get(t))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},Cc.prototype.contains=function(e){return u(e)&&u(e._index)&&e._textureCache===this._textureCache},Cc.prototype.get=function(e){return $j(this),this._stages[e]},Cc.prototype.removeAll=function(){let e=this._stages,t=e.length;for(let i=0;i<t;++i)this.remove(e[i]);e.length=0},Cc.prototype.getStageByName=function(e){return this._stageNames[e]},Cc.prototype.update=function(e,t,i){$j(this);let n=this._activeStages,r=this._activeStages=this._previousActiveStages;this._previousActiveStages=n;let o,a,s=this._stages,l=r.length=s.length,c=0;for(o=0;o<l;++o)a=s[o],a.ready&&a.enabled&&a._isSupported(e)&&(r[c++]=a);r.length=c;let h=c!==n.length;if(!h)for(o=0;o<c;++o)if(r[o]!==n[o]){h=!0;break}let d=this._ao,p=this._bloom,f=this._autoExposure,m=this._tonemapping,_=this._fxaa;m.enabled=i;let g=d.enabled&&d._isSupported(e),y=p.enabled&&p._isSupported(e),v=m.enabled&&m._isSupported(e),b=_.enabled&&_._isSupported(e);if((h||this._textureCacheDirty||g!==this._aoEnabled||y!==this._bloomEnabled||v!==this._tonemappingEnabled||b!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._aoEnabled=g,this._bloomEnabled=y,this._tonemappingEnabled=v,this._fxaaEnabled=b,this._textureCacheDirty=!1),u(this._randomTexture)&&!g&&(this._randomTexture.destroy(),this._randomTexture=void 0),!u(this._randomTexture)&&g){l=196608;let t=new Uint8Array(l);for(o=0;o<l;o+=3)t[o]=Math.floor(255*Math.random());this._randomTexture=new Ot({context:e,pixelFormat:rt.RGB,pixelDatatype:Ye.UNSIGNED_BYTE,source:{arrayBufferView:t,width:256,height:256},sampler:new un({wrapS:vn.REPEAT,wrapT:vn.REPEAT,minificationFilter:an.NEAREST,magnificationFilter:wi.NEAREST})})}for(this._textureCache.update(e),_.update(e,t),d.update(e,t),p.update(e,t),m.update(e,t),this._autoExposureEnabled&&f.update(e,t),l=s.length,o=0;o<l;++o)s[o].update(e,t);for(c=0,o=0;o<l;++o)a=s[o],a.ready&&a.enabled&&a._isSupported(e)&&c++;h=c!==r.length,h&&this.update(e,t,i)},Cc.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)},Cc.prototype.getOutputTexture=function(e){let t=this.getStageByName(e);if(u(t))return Lx(t)},Cc.prototype.execute=function(e,t,i,n){let r=this._activeStages,o=r.length,a=this._fxaa,s=this._ao,l=this._bloom,u=this._autoExposure,c=this._tonemapping,h=s.enabled&&s._isSupported(e),d=l.enabled&&l._isSupported(e),p=this._autoExposureEnabled,f=c.enabled&&c._isSupported(e),m=a.enabled&&a._isSupported(e);if(!(m||h||d||f||0!==o))return;let _=t;h&&s.ready&&(im(s,e,_,i,n),_=Lx(s)),d&&l.ready&&(im(l,e,_,i,n),_=Lx(l)),p&&u.ready&&im(u,e,_,i,n),f&&c.ready&&(im(c,e,_,i,n),_=Lx(c));let g=_;if(o>0){im(r[0],e,_,i,n);for(let t=1;t<o;++t)im(r[t],e,Lx(r[t-1]),i,n);g=Lx(r[o-1])}m&&a.ready&&im(a,e,g,i,n)},Cc.prototype.copy=function(e,t){if(!u(this._copyColorCommand)){let t=this;this._copyColorCommand=e.createViewportQuadCommand(Jl,{uniformMap:{colorTexture:function(){return t.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},Cc.prototype.isDestroyed=function(){return!1},Cc.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),le(this)};var OV=Cc;function nu(){de.throwInstantiationError()}nu.computeDefaultLevelZeroMaximumGeometricError=function(e){return 2*e.ellipsoid.maximumRadius*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))},Object.defineProperties(nu.prototype,{quadtree:{get:de.throwInstantiationError,set:de.throwInstantiationError},tilingScheme:{get:de.throwInstantiationError},errorEvent:{get:de.throwInstantiationError}}),nu.prototype.update=de.throwInstantiationError,nu.prototype.beginUpdate=de.throwInstantiationError,nu.prototype.endUpdate=de.throwInstantiationError,nu.prototype.getLevelMaximumGeometricError=de.throwInstantiationError,nu.prototype.loadTile=de.throwInstantiationError,nu.prototype.computeTileVisibility=de.throwInstantiationError,nu.prototype.showTileThisFrame=de.throwInstantiationError,nu.prototype.computeDistanceToTile=de.throwInstantiationError,nu.prototype.isDestroyed=de.throwInstantiationError,nu.prototype.destroy=de.throwInstantiationError;var She=nu,AC="in vec4 position;\nin vec2 textureCoordinates;\n\nout vec2 v_textureCoordinates;\n\nvoid main() \n{\n    gl_Position = position;\n    v_textureCoordinates = textureCoordinates;\n}\n";function RV(e){this._context=e}var uD,aot=new et({primitiveType:Ne.TRIANGLES}),cot=new ti({color:new z(0,0,0,0)});function lot(e,t){return new oa({context:e,colorTextures:[t],destroyAttachments:!1})}function uot(e,t){return Kt.fromCache({context:e,vertexShaderSource:AC,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}function fot(e,t){return(!u(uD)||uD.viewport.width!==e||uD.viewport.height!==t)&&(uD=Ue.fromCache({viewport:new qe(0,0,e,t)})),uD}RV.prototype.execute=function(e){u(e.preExecute)&&e.preExecute(e);let t=e.outputTexture,i=t.width,n=t.height,r=this._context,o=u(e.vertexArray)?e.vertexArray:r.getViewportQuadVertexArray(),a=u(e.shaderProgram)?e.shaderProgram:uot(r,e.fragmentShaderSource),s=lot(r,t),l=fot(i,n),c=e.uniformMap,h=cot;h.framebuffer=s,h.renderState=l,h.execute(r);let d=aot;d.vertexArray=o,d.renderState=l,d.shaderProgram=a,d.uniformMap=c,d.framebuffer=s,d.execute(r),s.destroy(),e.persists||(a.destroy(),u(e.vertexArray)&&o.destroy()),u(e.postExecute)&&e.postExecute(t)},RV.prototype.isDestroyed=function(){return!1},RV.prototype.destroy=function(){return le(this)};var MV=RV;function wd(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function dot(e){let t=Object.keys(e).sort();return JSON.stringify(e,t)}function Qj(e,t){let i=t.derivedKeywords,n=i.length;for(let r=0;r<n;++r){let n=i[r]+t.keyword;Qj(e,e._shaders[n])}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}Object.defineProperties(wd.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),wd.prototype.replaceShaderProgram=function(e){return u(e.shaderProgram)&&e.shaderProgram.destroy(),this.getShaderProgram(e)},wd.prototype.getShaderProgram=function(e){let t=e.vertexShaderSource,i=e.fragmentShaderSource,n=e.attributeLocations;"string"==typeof t&&(t=new He({sources:[t]})),"string"==typeof i&&(i=new He({sources:[i]}));let r,o=`${t.getCacheKey()}:${i.getCacheKey()}:${u(n)?dot(n):""}`;if(u(this._shaders[o]))r=this._shaders[o],delete this._shadersToRelease[o];else{let e=this._context,a=t.createCombinedVertexShader(e),s=i.createCombinedFragmentShader(e),l=new Kt({gl:e._gl,logShaderCompilation:e.logShaderCompilation,debugShaders:e.debugShaders,vertexShaderSource:t,vertexShaderText:a,fragmentShaderSource:i,fragmentShaderText:s,attributeLocations:n});r={cache:this,shaderProgram:l,keyword:o,derivedKeywords:[],count:0},l._cachedShader=r,this._shaders[o]=r,++this._numberOfShaders}return++r.count,r.shaderProgram},wd.prototype.replaceDerivedShaderProgram=function(e,t,i){let n=e._cachedShader,r=t+n.keyword,o=this._shaders[r];if(u(o)){Qj(this,o);let e=n.derivedKeywords.indexOf(t);e>-1&&n.derivedKeywords.splice(e,1)}return this.createDerivedShaderProgram(e,t,i)},wd.prototype.getDerivedShaderProgram=function(e,t){let i=t+e._cachedShader.keyword,n=this._shaders[i];if(u(n))return n.shaderProgram},wd.prototype.createDerivedShaderProgram=function(e,t,i){let n=e._cachedShader,r=t+n.keyword,o=i.vertexShaderSource,a=i.fragmentShaderSource,s=i.attributeLocations;"string"==typeof o&&(o=new He({sources:[o]})),"string"==typeof a&&(a=new He({sources:[a]}));let l=this._context,u=o.createCombinedVertexShader(l),c=a.createCombinedFragmentShader(l),h=new Kt({gl:l._gl,logShaderCompilation:l.logShaderCompilation,debugShaders:l.debugShaders,vertexShaderSource:o,vertexShaderText:u,fragmentShaderSource:a,fragmentShaderText:c,attributeLocations:s}),d={cache:this,shaderProgram:h,keyword:r,derivedKeywords:[],count:0};return n.derivedKeywords.push(t),h._cachedShader=d,this._shaders[r]=d,h},wd.prototype.destroyReleasedShaderPrograms=function(){let e=this._shadersToRelease;for(let t in e)if(e.hasOwnProperty(t)){Qj(this,e[t]),--this._numberOfShaders}this._shadersToRelease={}},wd.prototype.releaseShaderProgram=function(e){if(u(e)){let t=e._cachedShader;t&&0==--t.count&&(this._shadersToRelease[t.keyword]=t)}},wd.prototype.isDestroyed=function(){return!1},wd.prototype.destroy=function(){let e=this._shaders;for(let t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return le(this)};var LV=wd;function Nx(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}Object.defineProperties(Nx.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}}),Nx.prototype.getTexture=function(e){let t=this._textures[e];if(u(t))return delete this._texturesToRelease[e],++t.count,t.texture},Nx.prototype.addTexture=function(e,t){let i={texture:t,count:1};t.finalDestroy=t.destroy;let n=this;t.destroy=function(){0==--i.count&&(n._texturesToRelease[e]=i)},this._textures[e]=i,++this._numberOfTextures},Nx.prototype.destroyReleasedTextures=function(){let e=this._texturesToRelease;for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];delete this._textures[t],i.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}},Nx.prototype.isDestroyed=function(){return!1},Nx.prototype.destroy=function(){let e=this._textures;for(let t in e)e.hasOwnProperty(t)&&e[t].texture.finalDestroy();return le(this)};var NV=Nx;function hot(e){e=y(e,y.EMPTY_OBJECT),this.color=z.clone(y(e.color,z.WHITE)),this.intensity=y(e.intensity,2)}var Qg=hot;function CC(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new qe,this._viewportCartesian4=new oe,this._viewportDirty=!1,this._viewportOrthographicMatrix=L.clone(L.IDENTITY),this._viewportTransformation=L.clone(L.IDENTITY),this._model=L.clone(L.IDENTITY),this._view=L.clone(L.IDENTITY),this._inverseView=L.clone(L.IDENTITY),this._projection=L.clone(L.IDENTITY),this._infiniteProjection=L.clone(L.IDENTITY),this._entireFrustum=new U,this._currentFrustum=new U,this._frustumPlanes=new oe,this._farDepthFromNearPlusOne=void 0,this._log2FarDepthFromNearPlusOne=void 0,this._oneOverLog2FarDepthFromNearPlusOne=void 0,this._frameState=void 0,this._temeToPseudoFixed=$.clone(L.IDENTITY),this._view3DDirty=!0,this._view3D=new L,this._inverseView3DDirty=!0,this._inverseView3D=new L,this._inverseModelDirty=!0,this._inverseModel=new L,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new $,this._viewRotation=new $,this._inverseViewRotation=new $,this._viewRotation3D=new $,this._inverseViewRotation3D=new $,this._inverseProjectionDirty=!0,this._inverseProjection=new L,this._modelViewDirty=!0,this._modelView=new L,this._modelView3DDirty=!0,this._modelView3D=new L,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new L,this._inverseModelViewDirty=!0,this._inverseModelView=new L,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new L,this._viewProjectionDirty=!0,this._viewProjection=new L,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new L,this._modelViewProjectionDirty=!0,this._modelViewProjection=new L,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new L,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new L,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new L,this._normalDirty=!0,this._normal=new $,this._normal3DDirty=!0,this._normal3D=new $,this._inverseNormalDirty=!0,this._inverseNormal=new $,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new $,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new Wn,this._cameraPosition=new h,this._sunPositionWC=new h,this._sunPositionColumbusView=new h,this._sunDirectionWC=new h,this._sunDirectionEC=new h,this._moonDirectionEC=new h,this._lightDirectionWC=new h,this._lightDirectionEC=new h,this._lightColor=new h,this._lightColorHdr=new h,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._ellipsoid=void 0,this._cameraDirection=new h,this._cameraRight=new h,this._cameraUp=new h,this._frustum2DWidth=0,this._eyeHeight=0,this._eyeHeight2D=new U,this._pixelRatio=1,this._orthographicIn3D=!1,this._backgroundColor=new z,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsDimensions=new U,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._splitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0}function mot(e,t){L.clone(t,e._view),L.getMatrix3(t,e._viewRotation),e._view3DDirty=!0,e._inverseView3DDirty=!0,e._modelViewDirty=!0,e._modelView3DDirty=!0,e._modelViewRelativeToEyeDirty=!0,e._inverseModelViewDirty=!0,e._inverseModelView3DDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0,e._modelViewInfiniteProjectionDirty=!0,e._normalDirty=!0,e._inverseNormalDirty=!0,e._normal3DDirty=!0,e._inverseNormal3DDirty=!0}function pot(e,t){L.clone(t,e._inverseView),L.getMatrix3(t,e._inverseViewRotation)}function _ot(e,t){L.clone(t,e._projection),e._inverseProjectionDirty=!0,e._viewProjectionDirty=!0,e._inverseViewProjectionDirty=!0,e._modelViewProjectionDirty=!0,e._modelViewProjectionRelativeToEyeDirty=!0}function got(e,t){L.clone(t,e._infiniteProjection),e._modelViewInfiniteProjectionDirty=!0}function yot(e,t){h.clone(t.positionWC,e._cameraPosition),h.clone(t.directionWC,e._cameraDirection),h.clone(t.rightWC,e._cameraRight),h.clone(t.upWC,e._cameraUp);let i=t.positionCartographic;u(i)?e._eyeHeight=i.height:e._eyeHeight=-e._ellipsoid.maximumRadius,e._encodedCameraPositionMCDirty=!0}Object.defineProperties(CC.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(e){if(!qe.equals(e,this._viewport)){qe.clone(e,this._viewport);let t=this._viewport,i=this._viewportCartesian4;i.x=t.x,i.y=t.y,i.z=t.width,i.w=t.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return whe(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return whe(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){L.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,L.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){let e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,L.getMatrix3(this.inverseModel,e),$.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return Jj(this),this._view3D}},viewRotation:{get:function(){return Jj(this),this._viewRotation}},viewRotation3D:{get:function(){return Jj(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return Ihe(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return Ihe(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){return Cot(this),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){return Eot(this),this._modelView}},modelView3D:{get:function(){return Sot(this),this._modelView3D}},modelViewRelativeToEye:{get:function(){return Oot(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){return wot(this),this._inverseModelView}},inverseModelView3D:{get:function(){return vot(this),this._inverseModelView3D}},viewProjection:{get:function(){return Dot(this),this._viewProjection}},inverseViewProjection:{get:function(){return Iot(this),this._inverseViewProjection}},modelViewProjection:{get:function(){return Pot(this),this._modelViewProjection}},inverseModelViewProjection:{get:function(){return Rot(this),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){return Mot(this),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){return Lot(this),this._modelViewInfiniteProjection}},normal:{get:function(){return Not(this),this._normal}},normal3D:{get:function(){return Fot(this),this._normal3D}},inverseNormal:{get:function(){return Bot(this),this._inverseNormal}},inverseNormal3D:{get:function(){return kot(this),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},farDepthFromNearPlusOne:{get:function(){return this._farDepthFromNearPlusOne}},log2FarDepthFromNearPlusOne:{get:function(){return this._log2FarDepthFromNearPlusOne}},oneOverLog2FarDepthFromNearPlusOne:{get:function(){return this._oneOverLog2FarDepthFromNearPlusOne}},eyeHeight:{get:function(){return this._eyeHeight}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},lightDirectionWC:{get:function(){return this._lightDirectionWC}},lightDirectionEC:{get:function(){return this._lightDirectionEC}},lightColor:{get:function(){return this._lightColor}},lightColorHdr:{get:function(){return this._lightColorHdr}},encodedCameraPositionMCHigh:{get:function(){return Dhe(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return Dhe(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},pixelRatio:{get:function(){return this._pixelRatio}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsDimensions:{get:function(){return this._specularEnvironmentMapsDimensions}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},splitPosition:{get:function(){return this._splitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}},ellipsoid:{get:function(){return y(this._ellipsoid,ie.WGS84)}}});var fD=new $,xot=new fe;function bot(e,t){u(Rt.computeIcrfToFixedMatrix(t.time,fD))||(fD=Rt.computeTemeToPseudoFixedMatrix(t.time,fD));let i=D0.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);$.multiplyByVector(fD,i,i),h.normalize(i,e._sunDirectionWC),i=$.multiplyByVector(e.viewRotation3D,i,e._sunDirectionEC),h.normalize(i,i),i=D0.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),$.multiplyByVector(fD,i,i),$.multiplyByVector(e.viewRotation3D,i,i),h.normalize(i,i);let n=t.mapProjection,r=n.ellipsoid.cartesianToCartographic(e._sunPositionWC,xot);n.project(r,e._sunPositionColumbusView)}CC.prototype.updateCamera=function(e){mot(this,e.viewMatrix),pot(this,e.inverseViewMatrix),yot(this,e),this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==te.SCENE2D&&e.frustum instanceof Qt},CC.prototype.updateFrustum=function(e){_ot(this,e.projectionMatrix),u(e.infiniteProjectionMatrix)&&got(this,e.infiniteProjectionMatrix),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,this._farDepthFromNearPlusOne=e.far-e.near+1,this._log2FarDepthFromNearPlusOne=P.log2(this._farDepthFromNearPlusOne),this._oneOverLog2FarDepthFromNearPlusOne=1/this._log2FarDepthFromNearPlusOne;let t=e.offCenterFrustum;u(t)&&(e=t),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},CC.prototype.updatePass=function(e){this._pass=e};var Tot=[],Aot=new Qg;function whe(e){if(e._viewportDirty){let t=e._viewport;L.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),L.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}function Cot(e){e._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode===te.SCENE2D||e._mode===te.MORPHING||e._orthographicIn3D?L.clone(L.ZERO,e._inverseProjection):L.inverse(e._projection,e._inverseProjection))}function Eot(e){e._modelViewDirty&&(e._modelViewDirty=!1,L.multiplyTransformation(e._view,e._model,e._modelView))}function Sot(e){e._modelView3DDirty&&(e._modelView3DDirty=!1,L.multiplyTransformation(e.view3D,e._model,e._modelView3D))}function wot(e){e._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,L.inverse(e.modelView,e._inverseModelView))}function vot(e){e._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,L.inverse(e.modelView3D,e._inverseModelView3D))}function Dot(e){e._viewProjectionDirty&&(e._viewProjectionDirty=!1,L.multiply(e._projection,e._view,e._viewProjection))}function Iot(e){e._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,L.inverse(e.viewProjection,e._inverseViewProjection))}function Pot(e){e._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,L.multiply(e._projection,e.modelView,e._modelViewProjection))}function Oot(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;let t=e.modelView,i=e._modelViewRelativeToEye;i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=0,i[13]=0,i[14]=0,i[15]=t[15]}}function Rot(e){e._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,L.inverse(e.modelViewProjection,e._inverseModelViewProjection))}function Mot(e){e._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,L.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye))}function Lot(e){e._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,L.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection))}function Not(e){if(e._normalDirty){e._normalDirty=!1;let t=e._normal;L.getMatrix3(e.inverseModelView,t),$.transpose(t,t)}}function Fot(e){if(e._normal3DDirty){e._normal3DDirty=!1;let t=e._normal3D;L.getMatrix3(e.inverseModelView3D,t),$.transpose(t,t)}}function Bot(e){if(e._inverseNormalDirty){e._inverseNormalDirty=!1;let t=e._inverseNormal;L.getMatrix3(e.modelView,t),$.transpose(t,t)}}function kot(e){if(e._inverseNormal3DDirty){e._inverseNormal3DDirty=!1;let t=e._inverseNormal3D;L.getMatrix3(e.modelView3D,t),$.transpose(t,t)}}CC.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection,this._ellipsoid=e.mapProjection.ellipsoid,this._pixelRatio=e.pixelRatio;let t=e.camera;this.updateCamera(t),e.mode===te.SCENE2D?(this._frustum2DWidth=t.frustum.right-t.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),bot(this,e);let i=y(e.light,Aot);i instanceof Qg?(this._lightDirectionWC=h.clone(this._sunDirectionWC,this._lightDirectionWC),this._lightDirectionEC=h.clone(this._sunDirectionEC,this._lightDirectionEC)):(this._lightDirectionWC=h.normalize(h.negate(i.direction,this._lightDirectionWC),this._lightDirectionWC),this._lightDirectionEC=$.multiplyByVector(this.viewRotation3D,this._lightDirectionWC,this._lightDirectionEC));let n=i.color,r=h.fromElements(n.red,n.green,n.blue,this._lightColorHdr);r=h.multiplyByScalar(r,i.intensity,r);let o=h.maximumComponent(r);o>1?h.divideByScalar(r,o,this._lightColor):h.clone(r,this._lightColor);let a=e.brdfLutGenerator,s=u(a)?a.colorTexture:void 0;this._brdfLut=s,this._environmentMap=y(e.environmentMap,e.context.defaultCubeMap),this._sphericalHarmonicCoefficients=y(e.sphericalHarmonicCoefficients,Tot),this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=e.specularEnvironmentMapsMaximumLOD,u(this._specularEnvironmentMaps)&&U.clone(this._specularEnvironmentMaps.dimensions,this._specularEnvironmentMapsDimensions),this._fogDensity=e.fog.density,this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=Rt.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._splitPosition=e.splitPosition*e.context.drawingBufferWidth;let l,c=t.frustum.fov,d=this._viewport;l=u(c)?d.height>d.width?2*Math.tan(.5*c)/d.height:2*Math.tan(.5*c)/d.width:1/Math.max(d.width,d.height),this._geometricToleranceOverMeter=l*e.maximumScreenSpaceError,z.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};var vhe=new h;function Dhe(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,L.multiplyByPoint(e.inverseModel,e._cameraPosition,vhe),Wn.fromCartesian(vhe,e._encodedCameraPositionMC))}var Vot=new h,Uot=new h,zot=new h,Hot=new h,Got=new fe,Wot=new h,jot=new L;function qot(e,t,i,n,r,o,a,s){let l=Vot;l.x=e.y,l.y=e.z,l.z=e.x;let c=Uot;c.x=i.y,c.y=i.z,c.z=i.x;let d=zot;d.x=n.y,d.y=n.z,d.z=n.x;let p=Hot;p.x=t.y,p.y=t.z,p.z=t.x,o===te.SCENE2D&&(l.z=.5*r);let f=a.unproject(l,Got);f.longitude=P.clamp(f.longitude,-Math.PI,Math.PI),f.latitude=P.clamp(f.latitude,-P.PI_OVER_TWO,P.PI_OVER_TWO);let m=a.ellipsoid,_=m.cartographicToCartesian(f,Wot),g=Rt.eastNorthUpToFixedFrame(_,m,jot);return L.multiplyByPointAsVector(g,c,c),L.multiplyByPointAsVector(g,d,d),L.multiplyByPointAsVector(g,p,p),u(s)||(s=new L),s[0]=c.x,s[1]=d.x,s[2]=-p.x,s[3]=0,s[4]=c.y,s[5]=d.y,s[6]=-p.y,s[7]=0,s[8]=c.z,s[9]=d.z,s[10]=-p.z,s[11]=0,s[12]=-h.dot(c,_),s[13]=-h.dot(d,_),s[14]=h.dot(p,_),s[15]=1,s}function Jj(e){e._view3DDirty&&(e._mode===te.SCENE3D?L.clone(e._view,e._view3D):qot(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),L.getMatrix3(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function Ihe(e){e._inverseView3DDirty&&(L.inverseTransformation(e.view3D,e._inverseView3D),L.getMatrix3(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}var FV=CC;function iu(e,t){let{getWebGLStub:i,requestWebgl1:n,webgl:r={},allowTextureFilterAnisotropic:o=!0}=y(t,{});r.alpha=y(r.alpha,!1),r.stencil=y(r.stencil,!0),r.powerPreference=y(r.powerPreference,"high-performance");let a=u(i)?i(e,r):Yot(e,r,n),s=typeof WebGL2RenderingContext<"u"&&a instanceof WebGL2RenderingContext;this._canvas=e,this._originalGLContext=a,this._gl=a,this._webgl2=s,this._id=jn(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new LV(this),this._textureCache=new NV;let l=a;this._stencilBits=l.getParameter(l.STENCIL_BITS),zt._maximumCombinedTextureImageUnits=l.getParameter(l.MAX_COMBINED_TEXTURE_IMAGE_UNITS),zt._maximumCubeMapSize=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),zt._maximumFragmentUniformVectors=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),zt._maximumTextureImageUnits=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),zt._maximumRenderbufferSize=l.getParameter(l.MAX_RENDERBUFFER_SIZE),zt._maximumTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),zt._maximumVaryingVectors=l.getParameter(l.MAX_VARYING_VECTORS),zt._maximumVertexAttributes=l.getParameter(l.MAX_VERTEX_ATTRIBS),zt._maximumVertexTextureImageUnits=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),zt._maximumVertexUniformVectors=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),zt._maximumSamples=this._webgl2?l.getParameter(l.MAX_SAMPLES):0;let c=l.getParameter(l.ALIASED_LINE_WIDTH_RANGE);zt._minimumAliasedLineWidth=c[0],zt._maximumAliasedLineWidth=c[1];let h=l.getParameter(l.ALIASED_POINT_SIZE_RANGE);zt._minimumAliasedPointSize=h[0],zt._maximumAliasedPointSize=h[1];let d=l.getParameter(l.MAX_VIEWPORT_DIMS);zt._maximumViewportWidth=d[0],zt._maximumViewportHeight=d[1];let p=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT);zt._highpFloatSupported=0!==p.precision;let f=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_INT);zt._highpIntSupported=0!==f.rangeMax,this._antialias=l.getContextAttributes().antialias,this._standardDerivatives=!!Er(l,["OES_standard_derivatives"]),this._blendMinmax=!!Er(l,["EXT_blend_minmax"]),this._elementIndexUint=!!Er(l,["OES_element_index_uint"]),this._depthTexture=!!Er(l,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!Er(l,["EXT_frag_depth"]),this._debugShaders=Er(l,["WEBGL_debug_shaders"]),this._textureFloat=!!Er(l,["OES_texture_float"]),this._textureHalfFloat=!!Er(l,["OES_texture_half_float"]),this._textureFloatLinear=!!Er(l,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!Er(l,["OES_texture_half_float_linear"]),this._colorBufferFloat=!!Er(l,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._floatBlend=!!Er(l,["EXT_float_blend"]),this._colorBufferHalfFloat=!!Er(l,["EXT_color_buffer_half_float"]),this._s3tc=!!Er(l,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!Er(l,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._astc=!!Er(l,["WEBGL_compressed_texture_astc"]),this._etc=!!Er(l,["WEBG_compressed_texture_etc"]),this._etc1=!!Er(l,["WEBGL_compressed_texture_etc1"]),this._bc7=!!Er(l,["EXT_texture_compression_bptc"]),Ll.setKTX2SupportedFormats(this._s3tc,this._pvrtc,this._astc,this._etc,this._etc1,this._bc7);let m,_,g,v,b,A,T,E,C,x,S=o?Er(l,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;if(this._textureFilterAnisotropic=S,zt._maximumTextureFilterAnisotropy=u(S)?l.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,s){let e=this;m=function(){return e._gl.createVertexArray()},_=function(t){e._gl.bindVertexArray(t)},g=function(t){e._gl.deleteVertexArray(t)},v=function(e,t,i,n,r){l.drawElementsInstanced(e,t,i,n,r)},b=function(e,t,i,n){l.drawArraysInstanced(e,t,i,n)},A=function(e,t){l.vertexAttribDivisor(e,t)},T=function(e){l.drawBuffers(e)}}else E=Er(l,["OES_vertex_array_object"]),u(E)&&(m=function(){return E.createVertexArrayOES()},_=function(e){E.bindVertexArrayOES(e)},g=function(e){E.deleteVertexArrayOES(e)}),C=Er(l,["ANGLE_instanced_arrays"]),u(C)&&(v=function(e,t,i,n,r){C.drawElementsInstancedANGLE(e,t,i,n,r)},b=function(e,t,i,n){C.drawArraysInstancedANGLE(e,t,i,n)},A=function(e,t){C.vertexAttribDivisorANGLE(e,t)}),x=Er(l,["WEBGL_draw_buffers"]),u(x)&&(T=function(e){x.drawBuffersWEBGL(e)});this.glCreateVertexArray=m,this.glBindVertexArray=_,this.glDeleteVertexArray=g,this.glDrawElementsInstanced=v,this.glDrawArraysInstanced=b,this.glVertexAttribDivisor=A,this.glDrawBuffers=T,this._vertexArrayObject=!!E,this._instancedArrays=!!C,this._drawBuffers=!!x,zt._maximumDrawBuffers=this.drawBuffers?l.getParameter(ee.MAX_DRAW_BUFFERS):1,zt._maximumColorAttachments=this.drawBuffers?l.getParameter(ee.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new z(0,0,0,0),this._clearDepth=1,this._clearStencil=0;let w=new FV,I=new Ac(this),P=Ue.fromCache();this._defaultPassState=I,this._defaultRenderState=P,this._defaultTexture=void 0,this._defaultEmissiveTexture=void 0,this._defaultNormalTexture=void 0,this._defaultCubeMap=void 0,this._us=w,this._currentRenderState=P,this._currentPassState=I,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(let e=0;e<zt._maximumVertexAttributes;e++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options={getWebGLStub:i,requestWebgl1:n,webgl:r,allowTextureFilterAnisotropic:o},this.cache={},Ue.apply(l,P,I)}function Yot(e,t,i){if(typeof WebGLRenderingContext>"u")throw new ue("The browser does not support WebGL.  Visit http://get.webgl.org.");!i&&!(typeof WebGL2RenderingContext<"u")&&(i=!0);let n=i?"webgl":"webgl2",r=e.getContext(n,t);if(!u(r))throw new ue("The browser supports WebGL, but initialization failed.");return r}function Xot(e,t){let i="WebGL Error:  ";switch(t){case e.INVALID_ENUM:i+="INVALID_ENUM";break;case e.INVALID_VALUE:i+="INVALID_VALUE";break;case e.INVALID_OPERATION:i+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:i+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:i+="CONTEXT_LOST_WEBGL lost";break;default:i+=`Unknown (${t})`}return i}function Kot(e,t,i,n){let r=`${Xot(e,n)}: ${t.name}(`;for(let e=0;e<i.length;++e)0!==e&&(r+=", "),r+=i[e];return r+=");",r}function Zot(e,t,i){let n=e.getError();if(n!==e.NO_ERROR)throw new ue(Kot(e,t,i,n))}function $ot(e,t,i){return{get:function(){let n=e[t];return i(e,`get: ${t}`,n),e[t]},set:function(n){e[t]=n,i(e,`set: ${t}`,n)}}}function Qot(e,t){if(!u(t))return e;function i(i){return function(){let n=i.apply(e,arguments);return t(e,i,arguments),n}}let n={};for(let r in e){let o=e[r];o instanceof Function?n[r]=i(o):Object.defineProperty(n,r,$ot(e,r,t))}return n}function Er(e,t){let i=t.length;for(let n=0;n<i;++n){let i=e.getExtension(t[n]);if(i)return i}}var Jot={},e7;function Phe(e,t,i,n){let r=e._currentRenderState,o=e._currentPassState;e._currentRenderState=t,e._currentPassState=i,Ue.partialApply(e._gl,r,t,o,i,n)}function t7(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;let i=e7;if(u(t))t._bind(),i=t._getActiveColorAttachments();else{let t=e._gl;t.bindFramebuffer(t.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(i)}}Object.defineProperties(iu.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},msaa:{get:function(){return this._webgl2}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},floatBlend:{get:function(){return this._floatBlend}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},astc:{get:function(){return this._astc}},etc:{get:function(){return this._etc}},etc1:{get:function(){return this._etc1}},bc7:{get:function(){return this._bc7}},supportsBasis:{get:function(){return this._s3tc||this._pvrtc||this._astc||this._etc||this._etc1||this._bc7}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=Qot(this._originalGLContext,e?Zot:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new Ot({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultEmissiveTexture:{get:function(){return void 0===this._defaultEmissiveTexture&&(this._defaultEmissiveTexture=new Ot({context:this,pixelFormat:rt.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([0,0,0])},flipY:!1})),this._defaultEmissiveTexture}},defaultNormalTexture:{get:function(){return void 0===this._defaultNormalTexture&&(this._defaultNormalTexture=new Ot({context:this,pixelFormat:rt.RGB,source:{width:1,height:1,arrayBufferView:new Uint8Array([128,128,255])},flipY:!1})),this._defaultNormalTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){let e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new bc({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return Jot}}}),typeof WebGLRenderingContext<"u"&&(e7=[ee.BACK]);var ert=new ti;function trt(e,t,i,n,r){t7(e,t),Phe(e,r,i,!1),n._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,n.maximumTextureUnitIndex)}function nrt(e,t,i,n){let r=t._primitiveType,o=t._vertexArray,a=t._offset,s=t._count,l=t.instanceCount;e._us.model=y(t._modelMatrix,L.IDENTITY),i._setUniforms(n,e._us,e.validateShaderProgram),o._bind();let c=o.indexBuffer;u(c)?(a*=c.bytesPerIndex,s=u(s)?Math.min(s,c.numberOfIndices):c.numberOfIndices,0===l?e._gl.drawElements(r,s,c.indexDatatype,a):e.glDrawElementsInstanced(r,s,c.indexDatatype,a,l)):(s=u(s)?Math.min(s,o.numberOfVertices):o.numberOfVertices,0===l?e._gl.drawArrays(r,a,s):e.glDrawArraysInstanced(r,a,s,l)),o._unBind()}iu.prototype.clear=function(e,t){e=y(e,ert),t=y(t,this._defaultPassState);let i=this._gl,n=0,r=e.color,o=e.depth,a=e.stencil;u(r)&&(z.equals(this._clearColor,r)||(z.clone(r,this._clearColor),i.clearColor(r.red,r.green,r.blue,r.alpha)),n|=i.COLOR_BUFFER_BIT),u(o)&&(o!==this._clearDepth&&(this._clearDepth=o,i.clearDepth(o)),n|=i.DEPTH_BUFFER_BIT),u(a)&&(a!==this._clearStencil&&(this._clearStencil=a,i.clearStencil(a)),n|=i.STENCIL_BUFFER_BIT),Phe(this,y(e.renderState,this._defaultRenderState),t,!0),t7(this,y(e.framebuffer,t.framebuffer)),i.clear(n)},iu.prototype.draw=function(e,t,i,n){t=y(t,this._defaultPassState);let r=y(e._framebuffer,t.framebuffer),o=y(e._renderState,this._defaultRenderState);i=y(i,e._shaderProgram),n=y(n,e._uniformMap),trt(this,r,t,i,o),nrt(this,e,i,n)},iu.prototype.endFrame=function(){let e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);let t=e7;this.drawBuffers&&this.glDrawBuffers(t);let i=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(let t=0;t<i;++t)e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},iu.prototype.readPixels=function(e){let t=this._gl;e=y(e,y.EMPTY_OBJECT);let i=Math.max(y(e.x,0),0),n=Math.max(y(e.y,0),0),r=y(e.width,t.drawingBufferWidth),o=y(e.height,t.drawingBufferHeight),a=e.framebuffer,s=Ye.UNSIGNED_BYTE;u(a)&&a.numberOfColorAttachments>0&&(s=a.getColorTexture(0).pixelDatatype);let l=rt.createTypedArray(rt.RGBA,s,r,o);return t7(this,a),t.readPixels(i,n,r,o,rt.RGBA,Ye.toWebGLConstant(s,this),l),l};var Ohe={position:0,textureCoordinates:1};function n7(e,t,i){this._pickObjects=e,this.key=t,this.color=i}iu.prototype.getViewportQuadVertexArray=function(){let e=this.cache.viewportQuad_vertexArray;if(!u(e)){let t=new ct({attributes:{position:new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new Se({componentDatatype:X.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:Ne.TRIANGLES});e=ni.fromGeometry({context:this,geometry:t,attributeLocations:Ohe,bufferUsage:Be.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},iu.prototype.createViewportQuadCommand=function(e,t){return t=y(t,y.EMPTY_OBJECT),new et({vertexArray:this.getViewportQuadVertexArray(),primitiveType:Ne.TRIANGLES,renderState:t.renderState,shaderProgram:Kt.fromCache({context:this,vertexShaderSource:AC,fragmentShaderSource:e,attributeLocations:Ohe}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})},iu.prototype.getObjectByPickColor=function(e){return this._pickObjects[e.toRgba()]},Object.defineProperties(n7.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),n7.prototype.destroy=function(){delete this._pickObjects[this.key]},iu.prototype.createPickId=function(e){++this._nextPickColor[0];let t=this._nextPickColor[0];if(0===t)throw new ue("Out of unique Pick IDs.");return this._pickObjects[t]=e,new n7(this._pickObjects,t,z.fromRgba(t))},iu.prototype.isDestroyed=function(){return!1},iu.prototype.destroy=function(){let e=this.cache;for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];u(i.destroy)&&i.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultEmissiveTexture=this._defaultEmissiveTexture&&this._defaultEmissiveTexture.destroy(),this._defaultNormalTexture=this._defaultNormalTexture&&this._defaultNormalTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),le(this)},iu._deprecationWarning=is;var BV=iu;function Fx(e){this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}Fx.prototype.completeMorph=function(){u(this._completeMorph)&&this._completeMorph()},Fx.prototype.morphTo2D=function(e,t){u(this._completeMorph)&&this._completeMorph();let i=this._scene;this._previousMode=i.mode,this._morphToOrthographic=i.camera.frustum instanceof Qt,this._previousMode!==te.SCENE2D&&this._previousMode!==te.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,te.SCENE2D,!0),i._mode=te.MORPHING,i.camera._setTransform(L.IDENTITY),this._previousMode===te.COLUMBUS_VIEW?Nrt(this,e):Hrt(this,e,t),0===e&&u(this._completeMorph)&&this._completeMorph())};var irt=new h,ort=new h,rrt=new h,srt=new h,art=new h,crt=new h,lrt=new h,urt=new fe,frt=new L,drt=new Ei,hrt=new Qt,mrt={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};Fx.prototype.morphToColumbusView=function(e,t){u(this._completeMorph)&&this._completeMorph();let i=this._scene;if(this._previousMode=i.mode,this._previousMode===te.COLUMBUS_VIEW||this._previousMode===te.MORPHING)return;this._scene.morphStart.raiseEvent(this,this._previousMode,te.COLUMBUS_VIEW,!0),i.camera._setTransform(L.IDENTITY);let n,r=irt,o=ort,a=rrt;if(e>0)r.x=0,r.y=-1,r.z=1,r=h.multiplyByScalar(h.normalize(r,r),5*t.maximumRadius,r),h.negate(h.normalize(r,o),o),h.cross(h.UNIT_X,o,a);else{let e=i.camera;if(this._previousMode===te.SCENE2D)h.clone(e.position,r),r.z=e.frustum.right-e.frustum.left,h.negate(h.UNIT_Z,o),h.clone(h.UNIT_Y,a);else{h.clone(e.positionWC,r),h.clone(e.directionWC,o),h.clone(e.upWC,a);let n=t.scaleToGeodeticSurface(r,lrt),s=Rt.eastNorthUpToFixedFrame(n,t,frt);L.inverseTransformation(s,s),i.mapProjection.project(t.cartesianToCartographic(r,urt),r),L.multiplyByPointAsVector(s,o,o),L.multiplyByPointAsVector(s,a,a)}}this._morphToOrthographic?(n=hrt,n.width=i.camera.frustum.right-i.camera.frustum.left,n.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight):(n=drt,n.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,n.fov=P.toRadians(60));let s=mrt;s.position=r,s.direction=o,s.up=a,s.frustum=n;let l=Wrt(s);dD(this,l),this._previousMode===te.SCENE2D?Grt(this,e,s,l):(s.position2D=L.multiplyByPoint(oo.TRANSFORM_2D,r,srt),s.direction2D=L.multiplyByPointAsVector(oo.TRANSFORM_2D,o,art),s.up2D=L.multiplyByPointAsVector(oo.TRANSFORM_2D,a,crt),i._mode=te.MORPHING,Hhe(this,e,s,l)),0===e&&u(this._completeMorph)&&this._completeMorph()};var r7={position:new h,direction:new h,up:new h,frustum:void 0},Mhe=new Ei;function dD(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new Hu(e._scene.canvas);let i=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=i,e._morphHandler.setInputAction(i,_n.LEFT_DOWN),e._morphHandler.setInputAction(i,_n.MIDDLE_DOWN),e._morphHandler.setInputAction(i,_n.RIGHT_DOWN),e._morphHandler.setInputAction(i,_n.WHEEL)}}function kV(e){let t=e._currentTweens;for(let e=0;e<t.length;++e)t[e].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}Fx.prototype.morphTo3D=function(e,t){u(this._completeMorph)&&this._completeMorph();let i=this._scene;if(this._previousMode=i.mode,this._previousMode!==te.SCENE3D&&this._previousMode!==te.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,te.SCENE3D,!0),i._mode=te.MORPHING,i.camera._setTransform(L.IDENTITY),this._previousMode===te.SCENE2D)Srt(this,e,t);else{let n;e>0?(n=r7,h.fromDegrees(0,0,5*t.maximumRadius,t,n.position),h.negate(n.position,n.direction),h.normalize(n.direction,n.direction),h.clone(h.UNIT_Z,n.up)):n=Lhe(this,t);let r,o=i.camera;o.frustum instanceof Qt?r=o.frustum.clone():(r=Mhe,r.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,r.fov=P.toRadians(60)),n.frustum=r;let a=Whe(n);dD(this,a),o7(this,e,n,a)}0===e&&u(this._completeMorph)&&this._completeMorph()}},Fx.prototype.isDestroyed=function(){return!1},Fx.prototype.destroy=function(){return kV(this),le(this)};var prt=new fe,_rt=new h,grt=new L;function Lhe(e,t){let i=e._scene,n=i.camera,r=r7,o=r.position,a=r.direction,s=r.up,l=i.mapProjection.unproject(n.position,prt);t.cartographicToCartesian(l,o);let u=t.scaleToGeodeticSurface(o,_rt),c=Rt.eastNorthUpToFixedFrame(u,t,grt);return L.multiplyByPointAsVector(c,n.direction,a),L.multiplyByPointAsVector(c,n.up,s),r}var yrt=new h,xrt=new h,brt=new h,Trt=new h,Art=new h,Crt=new h;function o7(e,t,i,n){t*=.5;let r=e._scene,o=r.camera,a=h.clone(o.position,yrt),s=h.clone(o.direction,xrt),l=h.clone(o.up,brt),u=L.multiplyByPoint(oo.TRANSFORM_2D_INVERSE,i.position,Trt),c=L.multiplyByPointAsVector(oo.TRANSFORM_2D_INVERSE,i.direction,Art),d=L.multiplyByPointAsVector(oo.TRANSFORM_2D_INVERSE,i.up,Crt);let p=r.tweens.add({duration:t,easingFunction:Ir.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){yf(a,u,e.time,o.position),yf(s,c,e.time,o.direction),yf(l,d,e.time,o.up),h.cross(o.direction,o.up,o.right),h.normalize(o.right,o.right)},complete:function(){Ghe(e,r,0,1,t,n)}});e._currentTweens.push(p)}var Ert=new Qt,Nhe=new h,Fhe=new h,Bhe=new h,s7=new h,khe=new h,Vhe=new h;function Srt(e,t,i){t/=3;let n,r,o=e._scene,a=o.camera;t>0?(n=r7,h.fromDegrees(0,0,5*i.maximumRadius,i,n.position),h.negate(n.position,n.direction),h.normalize(n.direction,n.direction),h.clone(h.UNIT_Z,n.up)):(a.position.z=a.frustum.right-a.frustum.left,n=Lhe(e,i)),e._morphToOrthographic?(r=Ert,r.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,r.width=a.frustum.right-a.frustum.left):(r=Mhe,r.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,r.fov=P.toRadians(60)),n.frustum=r;let s,l=Whe(n);dD(e,l),s=e._morphToOrthographic?function(){o7(e,t,n,l)}:function(){zhe(e,t,n,(function(){o7(e,t,n,l)}))},t>0?(o._mode=te.SCENE2D,a.flyTo({duration:t,destination:h.fromDegrees(0,0,5*i.maximumRadius,i,s7),complete:function(){o._mode=te.MORPHING,s()}})):s()}function yf(e,t,i,n){return h.lerp(e,t,i,n)}function Uhe(e,t,i,n,r){let o=e._scene,a=o.camera;if(a.frustum instanceof Qt)return;let s=a.frustum.fov,l=.5*P.RADIANS_PER_DEGREE,u=i.position.z*Math.tan(.5*s);a.frustum.far=u/Math.tan(.5*l)+1e7;let c=o.tweens.add({duration:t,easingFunction:Ir.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){a.frustum.fov=P.lerp(s,l,e.time);let t=u/Math.tan(.5*a.frustum.fov);n(a,t)},complete:function(){a.frustum=i.frustum.clone(),r(e)}});e._currentTweens.push(c)}var wrt=new h,vrt=new h,Drt=new h,i7=new h,Irt=new h,Prt=new h,Ort=new Or,Rrt=new Tn,Mrt=new h,Lrt={position:void 0,direction:void 0,up:void 0,frustum:void 0};function Nrt(e,t){t*=.5;let i=e._scene,n=i.camera,r=h.clone(n.position,wrt),o=h.clone(n.direction,vrt),a=h.clone(n.up,Drt),s=h.negate(h.UNIT_Z,Irt),l=h.clone(h.UNIT_Y,Prt),c=i7;if(t>0)h.clone(h.ZERO,i7),c.z=5*i.mapProjection.ellipsoid.maximumRadius;else{h.clone(r,i7);let e=Rrt;L.multiplyByPoint(oo.TRANSFORM_2D,r,e.origin),L.multiplyByPointAsVector(oo.TRANSFORM_2D,o,e.direction);let t=i.globe;if(u(t)){let n=t.pickWorldCoordinates(e,i,!0,Mrt);u(n)&&(L.multiplyByPoint(oo.TRANSFORM_2D_INVERSE,n,c),c.z+=h.distance(r,c))}}let d=Ort;d.right=.5*c.z,d.left=-d.right,d.top=d.right*(i.drawingBufferHeight/i.drawingBufferWidth),d.bottom=-d.top;let p=Lrt;p.position=c,p.direction=s,p.up=l,p.frustum=d;let f=jhe(p);function m(e,t){e.position.z=t}dD(e,f);let _=i.tweens.add({duration:t,easingFunction:Ir.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){yf(r,c,e.time,n.position),yf(o,s,e.time,n.direction),yf(a,l,e.time,n.up),h.cross(n.direction,n.up,n.right),h.normalize(n.right,n.right),n._adjustOrthographicFrustum(!0)},complete:function(){Uhe(e,t,p,m,f)}});e._currentTweens.push(_)}var Rhe=new fe,Frt={position:new h,direction:new h,up:new h,position2D:new h,direction2D:new h,up2D:new h,frustum:new Or},Brt={position:new h,direction:new h,up:new h,frustum:void 0},krt=new h,Vrt=new Tn,Urt=new L,zrt=new h;function Hrt(e,t,i){t*=.5;let n=e._scene,r=n.camera,o=Frt;if(t>0)h.clone(h.ZERO,o.position),o.position.z=5*i.maximumRadius,h.negate(h.UNIT_Z,o.direction),h.clone(h.UNIT_Y,o.up);else{i.cartesianToCartographic(r.positionWC,Rhe),n.mapProjection.project(Rhe,o.position),h.negate(h.UNIT_Z,o.direction),h.clone(h.UNIT_Y,o.up);let e=Vrt;h.clone(o.position2D,e.origin);let t=h.clone(r.directionWC,e.direction),a=i.scaleToGeodeticSurface(r.positionWC,zrt),s=Rt.eastNorthUpToFixedFrame(a,i,Urt);L.inverseTransformation(s,s),L.multiplyByPointAsVector(s,t,t),L.multiplyByPointAsVector(oo.TRANSFORM_2D,t,t);let l=n.globe;if(u(l)){let t=l.pickWorldCoordinates(e,n,!0,krt);if(u(t)){let e=h.distance(o.position2D,t);t.x+=e,h.clone(t,o.position2D)}}}function a(e,t){e.position.x=t}L.multiplyByPoint(oo.TRANSFORM_2D,o.position,o.position2D),L.multiplyByPointAsVector(oo.TRANSFORM_2D,o.direction,o.direction2D),L.multiplyByPointAsVector(oo.TRANSFORM_2D,o.up,o.up2D);let s=o.frustum;s.right=.5*o.position.z,s.left=-s.right,s.top=s.right*(n.drawingBufferHeight/n.drawingBufferWidth),s.bottom=-s.top;let l=Brt;L.multiplyByPoint(oo.TRANSFORM_2D_INVERSE,o.position2D,l.position),h.clone(o.direction,l.direction),h.clone(o.up,l.up),l.frustum=s;let c=jhe(l);dD(e,c),Hhe(e,t,o,(function(){Uhe(e,t,o,a,c)}))}function zhe(e,t,i,n){let r=e._scene,o=r.camera,a=o.frustum.right-o.frustum.left;o.frustum=i.frustum.clone();let s=o.frustum.fov,l=.5*P.RADIANS_PER_DEGREE,u=a*Math.tan(.5*s);o.frustum.far=u/Math.tan(.5*l)+1e7,o.frustum.fov=l;let c=r.tweens.add({duration:t,easingFunction:Ir.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){o.frustum.fov=P.lerp(l,s,e.time),o.position.z=u/Math.tan(.5*o.frustum.fov)},complete:function(){n(e)}});e._currentTweens.push(c)}function Grt(e,t,i,n){t*=.5;let r=e._scene,o=r.camera,a=h.clone(i.position,s7),s=h.clone(i.direction,khe),l=h.clone(i.up,Vhe);function u(){o.frustum=i.frustum.clone();let u=h.clone(o.position,Nhe),c=h.clone(o.direction,Fhe),d=h.clone(o.up,Bhe);u.z=a.z;let p=r.tweens.add({duration:t,easingFunction:Ir.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){yf(u,a,e.time,o.position),yf(c,s,e.time,o.direction),yf(d,l,e.time,o.up),h.cross(o.direction,o.up,o.right),h.normalize(o.right,o.right)},complete:function(){n(e)}});e._currentTweens.push(p)}r._mode=te.MORPHING,e._morphToOrthographic?u():zhe(e,0,i,u)}function Hhe(e,t,i,n){let r=e._scene,o=r.camera,a=h.clone(o.position,Nhe),s=h.clone(o.direction,Fhe),l=h.clone(o.up,Bhe),u=h.clone(i.position2D,s7),c=h.clone(i.direction2D,khe),d=h.clone(i.up2D,Vhe);let p=r.tweens.add({duration:t,easingFunction:Ir.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){yf(a,u,e.time,o.position),yf(s,c,e.time,o.direction),yf(l,d,e.time,o.up),h.cross(o.direction,o.up,o.right),h.normalize(o.right,o.right),o._adjustOrthographicFrustum(!0)},complete:function(){Ghe(e,r,1,0,t,n)}});e._currentTweens.push(p)}function Ghe(e,t,i,n,r,o){let a={object:t,property:"morphTime",startValue:i,stopValue:n,duration:r,easingFunction:Ir.QUARTIC_OUT};u(o)&&(a.complete=function(){o(e)});let s=t.tweens.addProperty(a);e._currentTweens.push(s)}function Whe(e){return function(t){let i=t._scene;i._mode=te.SCENE3D,i.morphTime=te.getMorphTime(te.SCENE3D),kV(t);let n=i.camera;(t._previousMode!==te.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,h.clone(e.position,n.position),h.clone(e.direction,n.direction),h.clone(e.up,n.up),h.cross(n.direction,n.up,n.right),h.normalize(n.right,n.right),n.frustum=e.frustum.clone());let r=n.frustum;i.frameState.useLogDepth&&(r.near=.1,r.far=1e10);let o=u(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,te.SCENE3D,o)}}function jhe(e){return function(t){let i=t._scene;i._mode=te.SCENE2D,i.morphTime=te.getMorphTime(te.SCENE2D),kV(t);let n=i.camera;h.clone(e.position,n.position),n.position.z=2*i.mapProjection.ellipsoid.maximumRadius,h.clone(e.direction,n.direction),h.clone(e.up,n.up),h.cross(n.direction,n.up,n.right),h.normalize(n.right,n.right),n.frustum=e.frustum.clone();let r=u(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,te.SCENE2D,r)}}function Wrt(e){return function(t){let i=t._scene;i._mode=te.COLUMBUS_VIEW,i.morphTime=te.getMorphTime(te.COLUMBUS_VIEW),kV(t);let n=i.camera;(t._previousModeMode!==te.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,h.clone(e.position,n.position),h.clone(e.direction,n.direction),h.clone(e.up,n.up),h.cross(n.direction,n.up,n.right),h.normalize(n.right,n.right));let r=n.frustum;i.frameState.useLogDepth&&(r.near=.1,r.far=1e10);let o=u(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,te.COLUMBUS_VIEW,o)}}var VV=Fx;function UV(e,t,i,n,r,o,a,s,l,u){this._tweens=e,this._tweenjs=t,this._startObject=Ge(i),this._stopObject=Ge(n),this._duration=r,this._delay=o,this._easingFunction=a,this._update=s,this._complete=l,this.cancel=u,this.needsStart=!0}function vd(){this._tweens=[]}Object.defineProperties(UV.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),UV.prototype.cancelTween=function(){this._tweens.remove(this)},Object.defineProperties(vd.prototype,{length:{get:function(){return this._tweens.length}}}),vd.prototype.add=function(e){if(0===(e=y(e,y.EMPTY_OBJECT)).duration)return u(e.complete)&&e.complete(),new UV(this);let t=e.duration/Xn.SECONDS_PER_MILLISECOND,i=y(e.delay,0),n=i/Xn.SECONDS_PER_MILLISECOND,r=y(e.easingFunction,Ir.LINEAR_NONE),o=e.startObject,a=new yJ(o);a.to(Ge(e.stopObject),t),a.delay(n),a.easing(r),u(e.update)&&a.onUpdate((function(){e.update(o)})),a.onComplete(y(e.complete,null)),a.repeat(y(e._repeat,0));let s=new UV(this,a,e.startObject,e.stopObject,e.duration,i,r,e.update,e.complete,e.cancel);return this._tweens.push(s),s},vd.prototype.addProperty=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).object,i=e.property,n=e.startValue,r=e.stopValue;return this.add({startObject:{value:n},stopObject:{value:r},duration:y(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){t[i]=e.value},complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},vd.prototype.addAlpha=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).material,i=[];for(let e in t.uniforms)t.uniforms.hasOwnProperty(e)&&u(t.uniforms[e])&&u(t.uniforms[e].alpha)&&i.push(e);return this.add({startObject:{alpha:y(e.startValue,0)},stopObject:{alpha:y(e.stopValue,1)},duration:y(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){let n=i.length;for(let r=0;r<n;++r)t.uniforms[i[r]].alpha=e.alpha},complete:e.complete,cancel:e.cancel})},vd.prototype.addOffsetIncrement=function(e){let t=(e=y(e,y.EMPTY_OBJECT)).material.uniforms;return this.addProperty({object:t,property:"offset",startValue:t.offset,stopValue:t.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},vd.prototype.remove=function(e){if(!u(e))return!1;let t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),u(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},vd.prototype.removeAll=function(){let e=this._tweens;for(let t=0;t<e.length;++t){let i=e[t];i.tweenjs.stop(),u(i.cancel)&&i.cancel()}e.length=0},vd.prototype.contains=function(e){return u(e)&&-1!==this._tweens.indexOf(e)},vd.prototype.get=function(e){return this._tweens[e]},vd.prototype.update=function(e){let t=this._tweens,i=0;for(e=u(e)?e/Xn.SECONDS_PER_MILLISECOND:_i();i<t.length;){let n=t[i],r=n.tweenjs;n.needsStart?(n.needsStart=!1,r.start(e)):r.update(e)?i++:(r.stop(),t.splice(i,1))}};var EC=vd;function mD(e){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=Li.LEFT_DRAG,this.zoomEventTypes=[Li.RIGHT_DRAG,Li.WHEEL,Li.PINCH],this.rotateEventTypes=Li.LEFT_DRAG,this.tiltEventTypes=[Li.MIDDLE_DRAG,Li.PINCH,{eventType:Li.LEFT_DRAG,modifier:na.CTRL},{eventType:Li.RIGHT_DRAG,modifier:na.CTRL}],this.lookEventTypes={eventType:Li.LEFT_DRAG,modifier:na.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumPickingTerrainDistanceWithInertia=4e3,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=e,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new aN(e.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._inertiaDisablers={_lastInertiaZoomMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement","_lastInertiaTiltMovement"],_lastInertiaTiltMovement:["_lastInertiaSpinMovement","_lastInertiaTranslateMovement"]},this._tweens=new EC,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new U(-1,-1),this._tiltCenter=new h,this._rotateMousePosition=new U(-1,-1),this._rotateStartPosition=new h,this._strafeStartPosition=new h,this._strafeMousePosition=new U,this._strafeEndMousePosition=new U,this._zoomMouseStart=new U(-1,-1),this._zoomWorldPosition=new h,this._useZoomWorldPosition=!1,this._panLastMousePosition=new U,this._panLastWorldPosition=new h,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._zoomingUnderground=!1,this._rotatingZoom=!1,this._adjustedHeightForTerrain=!1,this._cameraUnderground=!1;let t=e.mapProjection;this._maxCoord=t.project(new fe(Math.PI,P.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3,this._minimumUndergroundPickDistance=2e3,this._maximumUndergroundPickDistance=1e4}function jrt(e,t){if(e<0)return 0;let i=25*(1-t);return Math.exp(-i*e)}function qrt(e){return U.equalsEpsilon(e.startPosition,e.endPosition,P.EPSILON14)}var Yrt=.4;function Xrt(e,t,i,n,r,o,a){let s=o[a];u(s)||(s=o[a]={startPosition:new U,endPosition:new U,motion:new U,inertiaEnabled:!0});let l=e.getButtonPressTime(t,i),c=e.getButtonReleaseTime(t,i),h=l&&c&&(c.getTime()-l.getTime())/1e3,d=c&&((new Date).getTime()-c.getTime())/1e3;if(l&&c&&h<Yrt){let a=jrt(d,n),l=e.getLastMovement(t,i);if(!u(l)||qrt(l)||!s.inertiaEnabled||(s.motion.x=.5*(l.endPosition.x-l.startPosition.x),s.motion.y=.5*(l.endPosition.y-l.startPosition.y),s.startPosition=U.clone(l.startPosition,s.startPosition),s.endPosition=U.multiplyByScalar(s.motion,a,s.endPosition),s.endPosition=U.add(s.startPosition,s.endPosition,s.endPosition),isNaN(s.endPosition.x)||isNaN(s.endPosition.y)||U.distance(s.startPosition,s.endPosition)<.5))return;if(!e.isButtonDown(t,i)){r(o,e.getStartMousePosition(t,i),s)}}}function Krt(e,t){if(u(t)){let i=e[t];u(i)&&(i.inertiaEnabled=!0);let n=e._inertiaDisablers[t];if(u(n)){let t=n.length;for(let r=0;r<t;++r)i=e[n[r]],u(i)&&(i.inertiaEnabled=!1)}}}var qhe=[];function Ec(e,t,i,n,r,o){if(!u(i))return;let a=e._aggregator;Array.isArray(i)||(qhe[0]=i,i=qhe);let s=i.length;for(let l=0;l<s;++l){let s=i[l],c=u(s.eventType)?s.eventType:s,h=s.modifier,d=a.isMoving(c,h)&&a.getMovement(c,h),p=a.getStartMousePosition(c,h);e.enableInputs&&t&&(d?(n(e,p,d),Krt(e,o)):r<1&&Xrt(a,c,h,r,n,e,o))}}var zV=new Tn,Zrt=new h,$rt=new U,Qrt=new h,Jrt=new U,est=new h,tst=new h,nst=new h,ist=new h,ome=new h,ost=new h,rst=new h,sst=new h,ast=new h,cst=new h,lst=new h,ust=new h,fst=new h,dst=new h,hst=new h,Bx=new h,Yhe=new h,Xhe=new h,a7={orientation:new oc};function p7(e,t,i,n,r,o){let a=1;u(o)&&(a=P.clamp(Math.abs(o),.25,1));let s=i.endPosition.y-i.startPosition.y,l=s>0?e.minimumZoomDistance*a:0,c=e.maximumZoomDistance,d=n*(r-l);d=P.clamp(d,e._minimumZoomRate,e._maximumZoomRate);let p=s/e._scene.canvas.clientHeight;p=Math.min(p,e.maximumMovementRatio);let f=d*p;if(e.enableCollisionDetection||0===e.minimumZoomDistance||!u(e._globe)){if(f>0&&Math.abs(r-l)<1||f<0&&Math.abs(r-c)<1)return;r-f<l?f=r-l-1:r-f>c&&(f=r-c)}let m=e._scene,_=m.camera,g=m.mode,v=a7.orientation;if(v.heading=_.heading,v.pitch=_.pitch,v.roll=_.roll,_.frustum instanceof Qt)return void(Math.abs(f)>0&&(_.zoomIn(f),_._adjustOrthographicFrustum(!0)));let b,A=y(i.inertiaEnabled,U.equals(t,e._zoomMouseStart)),T=e._zoomingOnVector,E=e._rotatingZoom;if(A||(e._zoomMouseStart=U.clone(t,e._zoomMouseStart),u(e._globe)&&g===te.SCENE2D?(b=_.getPickRay(t,zV).origin,b=h.fromElements(b.y,b.z,b.x)):u(e._globe)&&(b=jp(e,t,Zrt)),u(b)?(e._useZoomWorldPosition=!0,e._zoomWorldPosition=h.clone(b,e._zoomWorldPosition)):e._useZoomWorldPosition=!1,T=e._zoomingOnVector=!1,E=e._rotatingZoom=!1,e._zoomingUnderground=e._cameraUnderground),!e._useZoomWorldPosition)return void _.zoomIn(f);let C=g===te.COLUMBUS_VIEW;if(_.positionCartographic.height<2e6&&(E=!0),!A||E){if(g===te.SCENE2D){let i=e._zoomWorldPosition,n=_.position;if(!h.equals(i,n)&&_.positionCartographic.height<2*e._maxCoord.x){let r=_.position.x,o=h.subtract(i,n,Qrt);h.normalize(o,o);let a=h.distance(i,n)*f/(.5*_.getMagnitude());_.move(o,.5*a),(_.position.x<0&&r>0||_.position.x>0&&r<0)&&(b=_.getPickRay(t,zV).origin,b=h.fromElements(b.y,b.z,b.x),e._zoomWorldPosition=h.clone(b,e._zoomWorldPosition))}}else if(g===te.SCENE3D){let t=h.normalize(_.position,ome);if(e._cameraUnderground||e._zoomingUnderground||_.positionCartographic.height<3e3&&Math.abs(h.dot(_.direction,t))<.6)C=!0;else{let i=m.canvas,n=Jrt;n.x=i.clientWidth/2,n.y=i.clientHeight/2;let r=jp(e,n,est);if(u(r))if(_.positionCartographic.height<1e6){if(!(h.dot(_.direction,t)>=-.5)){let i=rst;h.clone(_.position,i);let n=e._zoomWorldPosition,r=ost;if(r=h.normalize(n,r),h.dot(r,t)<0)return;let o=hst,a=cst;h.clone(_.direction,a),h.add(i,h.multiplyByScalar(a,1e3,Bx),o);let s=lst,l=ust;h.subtract(n,i,s),h.normalize(s,l);let u=h.dot(t,l);if(u>=0)return void(e._zoomMouseStart.x=-1);let c=Math.acos(-u),d=h.magnitude(i),p=h.magnitude(n),m=d-f,g=h.magnitude(s),y=Math.asin(P.clamp(g/p*Math.sin(c),-1,1))-Math.asin(P.clamp(m/p*Math.sin(c),-1,1))+c,v=sst;h.normalize(i,v);let b=ast;b=h.cross(l,v,b),b=h.normalize(b,b),h.normalize(h.cross(v,b,Bx),a),h.multiplyByScalar(h.normalize(o,Bx),h.magnitude(o)-f,o),h.normalize(i,i),h.multiplyByScalar(i,m,i);let A=fst;h.multiplyByScalar(h.add(h.multiplyByScalar(v,Math.cos(y)-1,Yhe),h.multiplyByScalar(a,Math.sin(y),Xhe),Bx),m,A),h.add(i,A,i),h.normalize(o,v),h.normalize(h.cross(v,b,Bx),a);let T=dst;return h.multiplyByScalar(h.add(h.multiplyByScalar(v,Math.cos(y)-1,Yhe),h.multiplyByScalar(a,Math.sin(y),Xhe),Bx),h.magnitude(o),T),h.add(o,T,o),h.clone(i,_.position),h.normalize(h.subtract(o,i,Bx),_.direction),h.clone(_.direction,_.direction),h.cross(_.direction,_.up,_.right),h.cross(_.right,_.direction,_.up),void _.setView(a7)}C=!0}else{let t=h.normalize(r,tst),i=h.normalize(e._zoomWorldPosition,nst),n=h.dot(i,t);if(n>0&&n<1){let e=P.acosClamped(n),r=h.cross(i,t,ist),o=f/(Math.abs(e)>P.toRadians(20)?.75*_.positionCartographic.height:_.positionCartographic.height-f);_.rotate(r,e*o)}}else C=!0}}e._rotatingZoom=!C}if(!A&&C||T){let i,n=$i.wgs84ToWindowCoordinates(m,e._zoomWorldPosition,$rt);i=g!==te.COLUMBUS_VIEW&&U.equals(t,e._zoomMouseStart)&&u(n)?_.getPickRay(n,zV):_.getPickRay(t,zV);let r=i.direction;(g===te.COLUMBUS_VIEW||g===te.SCENE2D)&&h.fromElements(r.y,r.z,r.x,r),_.move(r,f),e._zoomingOnVector=!0}else _.zoomIn(f);e._cameraUnderground||_.setView(a7)}var mst=new Tn,pst=new Tn,_st=new h;function gst(e,t,i){let n=e._scene.camera,r=n.getPickRay(i.startPosition,mst).origin,o=n.getPickRay(i.endPosition,pst).origin;r=h.fromElements(r.y,r.z,r.x,r),o=h.fromElements(o.y,o.z,o.x,o);let a=h.subtract(r,o,_st),s=h.magnitude(a);s>0&&(h.normalize(a,a),n.move(a,s))}function Khe(e,t,i){u(i.distance)&&(i=i.distance);let n=e._scene.camera;p7(e,t,i,e._zoomFactor,n.getMagnitude())}var yst=new U,xst=new U;function Zhe(e,t,i){if(u(i.angleAndHeight))return void bst(e,t,i.angleAndHeight);let n=e._scene,r=n.camera,o=n.canvas,a=o.clientWidth,s=o.clientHeight,l=yst;l.x=2/a*i.startPosition.x-1,l.y=2/s*(s-i.startPosition.y)-1,l=U.normalize(l,l);let c=xst;c.x=2/a*i.endPosition.x-1,c.y=2/s*(s-i.endPosition.y)-1,c=U.normalize(c,c);let h=P.acosClamped(l.x);l.y<0&&(h=P.TWO_PI-h);let d=P.acosClamped(c.x);c.y<0&&(d=P.TWO_PI-d);let p=d-h;r.twistRight(p)}function bst(e,t,i){let n=e._rotateFactor*e._rotateRateRangeAdjustment;n>e._maximumRotateRate&&(n=e._maximumRotateRate),n<e._minimumRotateRate&&(n=e._minimumRotateRate);let r=e._scene,o=r.camera,a=r.canvas,s=(i.endPosition.x-i.startPosition.x)/a.clientWidth;s=Math.min(s,e.maximumMovementRatio);let l=n*s*Math.PI*4;o.twistRight(l)}function Tst(e){let t=e._scene.mapMode2D===kl.ROTATE;L.equals(L.IDENTITY,e._scene.camera.transform)?(Ec(e,e.enableTranslate,e.translateEventTypes,gst,e.inertiaTranslate,"_lastInertiaTranslateMovement"),Ec(e,e.enableZoom,e.zoomEventTypes,Khe,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&Ec(e,e.enableRotate,e.tiltEventTypes,Zhe,e.inertiaSpin,"_lastInertiaTiltMovement")):(Ec(e,e.enableZoom,e.zoomEventTypes,Khe,e.inertiaZoom,"_lastInertiaZoomMovement"),t&&Ec(e,e.enableRotate,e.translateEventTypes,Zhe,e.inertiaSpin,"_lastInertiaSpinMovement"))}var rme=new Tn,Ast=new h,Cst=new h;function jp(e,t,i){let n,r=e._scene,o=e._globe,a=r.camera;if(r.pickPositionSupported&&(n=r.pickPositionWorldCoordinates(t,Ast)),!u(o))return h.clone(n,i);let s=!e._cameraUnderground,l=a.getPickRay(t,rme),c=o.pickWorldCoordinates(l,r,s,Cst);return(u(n)?h.distance(n,a.positionWC):Number.POSITIVE_INFINITY)<(u(c)?h.distance(c,a.positionWC):Number.POSITIVE_INFINITY)?h.clone(n,i):h.clone(c,i)}var Est=new fe;function XV(e){let t=e._ellipsoid,i=e._scene,n=i.camera,r=0;if(i.mode===te.SCENE3D){let e=t.cartesianToCartographic(n.position,Est);u(e)&&(r=e.height)}else r=n.position.z;let o=y(e._scene.globeHeight,0);return Math.abs(o-r)}var Sst=new h;function sme(e,t){let i=t.origin,n=t.direction,r=XV(e),o=h.normalize(i,Sst),a=Math.abs(h.dot(o,n));return a=2*Math.max(a,.5),r*a}function ame(e,t,i,n){let r=h.distance(t.origin,i),o=XV(e);return r>P.clamp(5*o,e._minimumUndergroundPickDistance,e._maximumUndergroundPickDistance)&&(r=Math.min(r,o/5),r=Math.max(r,100)),Tn.getPoint(t,r,n)}function cme(e,t,i,n){let r;return u(i)?(r=h.distance(t.origin,i),r>e._maximumUndergroundPickDistance&&(r=XV(e))):r=XV(e),Tn.getPoint(t,r,n)}var wst=new U;function lme(e,t){let i=t.endPosition,n=U.subtract(t.endPosition,t.startPosition,wst),r=e._strafeEndMousePosition;U.add(r,n,r),t.endPosition=r,_7(e,t,e._strafeStartPosition),t.endPosition=i}var $he=new Tn,vst=new Tn,c7=new h,Dst=new h,Ist=new h,Pst=new h,Ost=new tn(h.UNIT_X,0),Rst=new U,Mst=new U;function Lst(e,t,i){if(h.equals(t,e._translateMousePosition)||(e._looking=!1),h.equals(t,e._strafeMousePosition)||(e._strafing=!1),e._looking)return void ru(e,t,i);if(e._strafing)return void lme(e,i);let n,r=e._scene.camera,o=e._cameraUnderground,a=U.clone(i.startPosition,Rst),s=U.clone(i.endPosition,Mst),l=r.getPickRay(a,$he),c=h.clone(h.ZERO,Pst),d=h.UNIT_X;if(r.position.z<e._minimumPickingTerrainHeight&&(n=jp(e,a,c7),u(n)&&(c.x=n.x)),o||c.x>r.position.z&&u(n)){let r=n;return o&&(r=cme(e,l,n,c7)),U.clone(t,e._strafeMousePosition),U.clone(t,e._strafeEndMousePosition),h.clone(r,e._strafeStartPosition),e._strafing=!0,void _7(e,i,e._strafeStartPosition)}let p=tn.fromPointNormal(c,d,Ost);l=r.getPickRay(a,$he);let f=Ai.rayPlane(l,p,c7),m=r.getPickRay(s,vst),_=Ai.rayPlane(m,p,Dst);if(!u(f)||!u(_))return e._looking=!0,ru(e,t,i),void U.clone(t,e._translateMousePosition);let g=h.subtract(f,_,Ist),y=g.x;g.x=g.y,g.y=g.z,g.z=y;let v=h.magnitude(g);v>P.EPSILON6&&(h.normalize(g,g),r.move(g,v))}var ume=new U,WV=new Tn,jV=new h,Nst=new h,fme=new L,Fst=new L,Bst=new h,kst=new tn(h.UNIT_X,0),l7=new h,d7=new fe,dme=new L,Vst=new Le,Ust=new $,qV=new h;function zst(e,t,i){if(u(i.angleAndHeight)&&(i=i.angleAndHeight),U.equals(t,e._tiltCenterMousePosition)||(e._tiltCVOffMap=!1,e._looking=!1),e._looking)return void ru(e,t,i);let n=e._scene.camera;e._tiltCVOffMap||!e.onMap()||Math.abs(n.position.z)>e._minimumPickingTerrainHeight?(e._tiltCVOffMap=!0,Hst(e,t,i)):Gst(e,t,i)}function Hst(e,t,i){let n=e._scene,r=n.camera,o=n.canvas,a=ume;a.x=o.clientWidth/2,a.y=o.clientHeight/2;let s,l=r.getPickRay(a,WV),c=h.UNIT_X,d=l.origin,p=l.direction,f=h.dot(c,p);if(Math.abs(f)>P.EPSILON6&&(s=-h.dot(c,d)/f),!u(s)||s<=0)return e._looking=!0,ru(e,t,i),void U.clone(t,e._tiltCenterMousePosition);let m=h.multiplyByScalar(p,s,jV);h.add(d,m,m);let _=n.mapProjection,g=_.ellipsoid;h.fromElements(m.y,m.z,m.x,m);let y=_.unproject(m,d7);g.cartographicToCartesian(y,m);let v=Rt.eastNorthUpToFixedFrame(m,g,fme),b=e._globe,A=e._ellipsoid;e._globe=void 0,e._ellipsoid=ie.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let T=L.clone(r.transform,dme);r._setTransform(v),ou(e,t,i,h.UNIT_Z),r._setTransform(T),e._globe=b,e._ellipsoid=A;let E=A.maximumRadius;e._rotateFactor=1/E,e._rotateRateRangeAdjustment=E}function Gst(e,t,i){let n,r,o=e._scene,a=o.camera,s=e._cameraUnderground,l=h.UNIT_X;if(U.equals(t,e._tiltCenterMousePosition))n=h.clone(e._tiltCenter,jV);else{if(a.position.z<e._minimumPickingTerrainHeight&&(n=jp(e,t,jV)),!u(n)){r=a.getPickRay(t,WV);let o,s=r.origin,c=r.direction,d=h.dot(l,c);if(Math.abs(d)>P.EPSILON6&&(o=-h.dot(l,s)/d),!u(o)||o<=0)return e._looking=!0,ru(e,t,i),void U.clone(t,e._tiltCenterMousePosition);n=h.multiplyByScalar(c,o,jV),h.add(s,n,n)}s&&(u(r)||(r=a.getPickRay(t,WV)),ame(e,r,n,n)),U.clone(t,e._tiltCenterMousePosition),h.clone(n,e._tiltCenter)}let c=o.canvas,d=ume;d.x=c.clientWidth/2,d.y=e._tiltCenterMousePosition.y,r=a.getPickRay(d,WV);let p=h.clone(h.ZERO,Bst);p.x=n.x;let f=tn.fromPointNormal(p,l,kst),m=Ai.rayPlane(r,f,Nst),_=a._projection,g=_.ellipsoid;h.fromElements(n.y,n.z,n.x,n);let y=_.unproject(n,d7);g.cartographicToCartesian(y,n);let v,b=Rt.eastNorthUpToFixedFrame(n,g,fme);u(m)?(h.fromElements(m.y,m.z,m.x,m),y=_.unproject(m,d7),g.cartographicToCartesian(y,m),v=Rt.eastNorthUpToFixedFrame(m,g,Fst)):v=b;let A=e._globe,T=e._ellipsoid;e._globe=void 0,e._ellipsoid=ie.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let E=h.UNIT_Z,C=L.clone(a.transform,dme);a._setTransform(b);let x=h.cross(h.UNIT_Z,h.normalize(a.position,l7),l7),S=h.dot(a.right,x);if(ou(e,t,i,E,!1,!0),a._setTransform(v),S<0){let n=i.startPosition.y-i.endPosition.y;(s&&n<0||!s&&n>0)&&(E=void 0);let r=a.constrainedAxis;a.constrainedAxis=void 0,ou(e,t,i,E,!0,!1),a.constrainedAxis=r}else ou(e,t,i,E,!0,!1);if(u(a.constrainedAxis)){let e=h.cross(a.direction,a.constrainedAxis,qV);h.equalsEpsilon(e,h.ZERO,P.EPSILON6)||(h.dot(e,a.right)<0&&h.negate(e,e),h.cross(e,a.direction,a.up),h.cross(a.direction,a.up,a.right),h.normalize(a.up,a.up),h.normalize(a.right,a.right))}a._setTransform(C),e._globe=A,e._ellipsoid=T;let w=T.maximumRadius;e._rotateFactor=1/w,e._rotateRateRangeAdjustment=w;let I=h.clone(a.positionWC,l7);if(e.enableCollisionDetection&&x7(e),!h.equals(a.positionWC,I)){a._setTransform(v),a.worldToCameraCoordinatesPoint(I,I);let e=h.magnitudeSquared(I);h.magnitudeSquared(a.position)>e&&(h.normalize(a.position,a.position),h.multiplyByScalar(a.position,Math.sqrt(e),a.position));let t=h.angleBetween(I,a.position),i=h.cross(I,a.position,I);h.normalize(i,i);let n=Le.fromAxisAngle(i,t,Vst),r=$.fromQuaternion(n,Ust);$.multiplyByVector(r,a.direction,a.direction),$.multiplyByVector(r,a.up,a.up),h.cross(a.direction,a.up,a.right),h.cross(a.right,a.direction,a.up),a._setTransform(C)}}var hme=new U,mme=new Tn,pme=new h;function Wst(e,t,i){u(i.distance)&&(i=i.distance);let n,r=e._scene,o=r.camera,a=r.canvas,s=e._cameraUnderground;s?n=t:(n=hme,n.x=a.clientWidth/2,n.y=a.clientHeight/2);let l,c,d=o.getPickRay(n,mme),p=d.origin,f=d.direction,m=o.position.z;if(m<e._minimumPickingTerrainHeight&&(l=jp(e,n,pme)),u(l)&&(c=h.distance(p,l)),s){let t=sme(e,d,m);c=u(c)?Math.min(c,t):t}if(!u(c)){let e=h.UNIT_X;c=-h.dot(e,p)/h.dot(e,f)}p7(e,t,i,e._zoomFactor,c)}function jst(e){let t=e._scene.camera;if(L.equals(L.IDENTITY,t.transform)){let i=e._tweens;if(e._aggregator.anyButtonDown&&i.removeAll(),Ec(e,e.enableTilt,e.tiltEventTypes,zst,e.inertiaSpin,"_lastInertiaTiltMovement"),Ec(e,e.enableTranslate,e.translateEventTypes,Lst,e.inertiaTranslate,"_lastInertiaTranslateMovement"),Ec(e,e.enableZoom,e.zoomEventTypes,Wst,e.inertiaZoom,"_lastInertiaZoomMovement"),Ec(e,e.enableLook,e.lookEventTypes,ru),!e._aggregator.anyButtonDown&&!i.contains(e._tween)){let n=t.createCorrectPositionTween(e.bounceAnimationTime);u(n)&&(e._tween=i.add(n))}i.update()}else Ec(e,e.enableRotate,e.rotateEventTypes,ou,e.inertiaSpin,"_lastInertiaSpinMovement"),Ec(e,e.enableZoom,e.zoomEventTypes,gme,e.inertiaZoom,"_lastInertiaZoomMovement")}var qst=new Tn,Yst=new tn(h.UNIT_X,0),Xst=new h,Kst=new h;function _7(e,t,i){let n=e._scene,r=n.camera,o=r.getPickRay(t.endPosition,qst),a=h.clone(r.direction,Kst);n.mode===te.COLUMBUS_VIEW&&h.fromElements(a.z,a.x,a.y,a);let s=tn.fromPointNormal(i,a,Yst),l=Ai.rayPlane(o,s,Xst);u(l)&&(a=h.subtract(i,l,a),n.mode===te.COLUMBUS_VIEW&&h.fromElements(a.y,a.z,a.x,a),h.add(r.position,a,r.position))}var Qhe=new h,_me=new fe,h7=new h,m7=new ie,Zst=new h,$st=new h,Qst=new h;function Jst(e,t,i){let n=e._scene.camera,r=e._cameraUnderground,o=e._ellipsoid;if(!L.equals(n.transform,L.IDENTITY))return void ou(e,t,i);let a,s,l=o.geodeticSurfaceNormal(n.position,Zst);if(U.equals(t,e._rotateMousePosition)){if(e._looking)ru(e,t,i,l);else if(e._rotating)ou(e,t,i);else if(e._strafing)lme(e,i);else{if(h.magnitude(n.position)<h.magnitude(e._rotateStartPosition))return;a=h.magnitude(e._rotateStartPosition),s=h7,s.x=s.y=s.z=a,o=ie.fromCartesian3(s,m7),f7(e,t,i,o)}return}e._looking=!1,e._rotating=!1,e._strafing=!1;let c=o.cartesianToCartographic(n.positionWC,_me).height,d=e._globe;if(u(d)&&c<e._minimumPickingTerrainHeight){let c=jp(e,i.startPosition,Qst);if(u(c)){let l=!1,u=n.getPickRay(i.startPosition,rme);if(r)l=!0,cme(e,u,c,c);else{let e=o.geodeticSurfaceNormal(c,$st);l=Math.abs(h.dot(u.direction,e))<.05||h.magnitude(n.position)<h.magnitude(c)}l?(U.clone(t,e._strafeEndMousePosition),h.clone(c,e._strafeStartPosition),e._strafing=!0,_7(e,i,e._strafeStartPosition)):(a=h.magnitude(c),s=h7,s.x=s.y=s.z=a,o=ie.fromCartesian3(s,m7),f7(e,t,i,o),h.clone(c,e._rotateStartPosition))}else e._looking=!0,ru(e,t,i,l)}else u(n.pickEllipsoid(i.startPosition,e._ellipsoid,Qhe))?(f7(e,t,i,e._ellipsoid),h.clone(Qhe,e._rotateStartPosition)):c>e._minimumTrackBallHeight?(e._rotating=!0,ou(e,t,i)):(e._looking=!0,ru(e,t,i,l));U.clone(t,e._rotateMousePosition)}function ou(e,t,i,n,r,o){r=y(r,!1),o=y(o,!1);let a=e._scene,s=a.camera,l=a.canvas,c=s.constrainedAxis;u(n)&&(s.constrainedAxis=n);let d=h.magnitude(s.position),p=e._rotateFactor*(d-e._rotateRateRangeAdjustment);p>e._maximumRotateRate&&(p=e._maximumRotateRate),p<e._minimumRotateRate&&(p=e._minimumRotateRate);let f=(i.startPosition.x-i.endPosition.x)/l.clientWidth,m=(i.startPosition.y-i.endPosition.y)/l.clientHeight;f=Math.min(f,e.maximumMovementRatio),m=Math.min(m,e.maximumMovementRatio);let _=p*f*Math.PI*2,g=p*m*Math.PI;r||s.rotateRight(_),o||s.rotateUp(g),s.constrainedAxis=c}var u7=oe.clone(oe.UNIT_W),Jhe=oe.clone(oe.UNIT_W),HV=new h,SC=new h,GV=new h,eme=new h,eat=new U,tat=new U,nat=new U,iat=new U,oat=new Tn;function f7(e,t,i,n){let r,o,a=e._scene,s=a.camera,l=U.clone(i.startPosition,eat),c=U.clone(i.endPosition,tat),d=n.cartesianToCartographic(s.positionWC,_me).height;if(!i.inertiaEnabled&&d<e._minimumPickingTerrainHeight&&(r=h.clone(e._panLastWorldPosition,u7),!u(e._globe)&&!U.equalsEpsilon(l,e._panLastMousePosition)&&(r=jp(e,l,u7)),!u(e._globe)&&u(r))){let t=h.subtract(r,s.positionWC,SC),i=h.multiplyByScalar(s.directionWC,h.dot(s.directionWC,t),SC),n=h.magnitude(i),d=s.frustum.getPixelDimensions(a.drawingBufferWidth,a.drawingBufferHeight,n,a.pixelRatio,iat),p=U.subtract(c,l,nat),f=h.multiplyByScalar(s.rightWC,p.x*d.x,SC),m=h.normalize(s.positionWC,ome),_=s.getPickRay(c,oat).direction,g=h.subtract(_,h.projectVector(_,s.rightWC,GV),GV),y=h.angleBetween(g,s.directionWC),v=1;u(s.frustum.fov)&&(v=Math.max(Math.tan(y),.1));let b=Math.abs(h.dot(s.directionWC,m)),A=-p.y*d.y*2/Math.sqrt(v)*(1-b),T=h.multiplyByScalar(_,A,GV);b=Math.abs(h.dot(s.upWC,m));let E=h.multiplyByScalar(s.upWC,-p.y*(1-b)*d.y,eme);o=h.add(r,f,Jhe),o=h.add(o,T,o),o=h.add(o,E,o),h.clone(o,e._panLastWorldPosition),U.clone(c,e._panLastMousePosition)}if((!u(r)||!u(o))&&(r=s.pickEllipsoid(l,n,u7),o=s.pickEllipsoid(c,n,Jhe)),!u(r)||!u(o))return e._rotating=!0,void ou(e,t,i);if(r=s.worldToCameraCoordinates(r,r),o=s.worldToCameraCoordinates(o,o),u(s.constrainedAxis)){let e=s.constrainedAxis,t=h.mostOrthogonalAxis(e,HV);h.cross(t,e,t),h.normalize(t,t);let i=h.cross(e,t,SC),n=h.magnitude(r),a=h.dot(e,r),l=Math.acos(a/n),u=h.multiplyByScalar(e,a,GV);h.subtract(r,u,u),h.normalize(u,u);let c=h.magnitude(o),d=h.dot(e,o),p=Math.acos(d/c),f=h.multiplyByScalar(e,d,eme);h.subtract(o,f,f),h.normalize(f,f);let m=Math.acos(h.dot(u,t));h.dot(u,i)<0&&(m=P.TWO_PI-m);let _=Math.acos(h.dot(f,t));h.dot(f,i)<0&&(_=P.TWO_PI-_);let g,y=m-_;g=h.equalsEpsilon(e,s.position,P.EPSILON2)?s.right:h.cross(e,s.position,HV);let v,b=h.cross(e,g,HV),A=h.dot(b,h.subtract(r,e,SC)),T=h.dot(b,h.subtract(o,e,SC));v=A>0&&T>0?p-l:A>0&&T<=0?h.dot(s.position,e)>0?-l-p:l+p:l-p,s.rotateRight(y),s.rotateUp(v)}else{h.normalize(r,r),h.normalize(o,o);let e=h.dot(r,o),t=h.cross(r,o,HV);if(e<1&&!h.equalsEpsilon(t,h.ZERO,P.EPSILON14)){let i=Math.acos(e);s.rotate(t,i)}}}var rat=new h,sat=new fe,tme=0;function gme(e,t,i){u(i.distance)&&(i=i.distance);let n,r=i.inertiaEnabled,o=e._ellipsoid,a=e._scene,s=a.camera,l=a.canvas,c=e._cameraUnderground;c?n=t:(n=hme,n.x=l.clientWidth/2,n.y=l.clientHeight/2);let d,p,f=s.getPickRay(n,mme),m=o.cartesianToCartographic(s.position,sat).height,_=Math.abs(tme)<e.minimumPickingTerrainDistanceWithInertia;if((r?_:m<e._minimumPickingTerrainHeight)&&(d=jp(e,n,pme)),u(d)&&(p=h.distance(f.origin,d),tme=p),c){let t=sme(e,f,m);p=u(p)?Math.min(p,t):t}u(p)||(p=m);let g=h.normalize(s.position,rat);p7(e,t,i,e._zoomFactor,p,h.dot(g,s.direction))}var yme=new U,YV=new Tn,hD=new h,aat=new h,xme=new L,cat=new L,bme=new L,lat=new Le,uat=new $,g7=new fe,y7=new h;function fat(e,t,i){let n=e._scene.camera;if(!L.equals(n.transform,L.IDENTITY))return;if(u(i.angleAndHeight)&&(i=i.angleAndHeight),U.equals(t,e._tiltCenterMousePosition)||(e._tiltOnEllipsoid=!1,e._looking=!1),e._looking){let r=e._ellipsoid.geodeticSurfaceNormal(n.position,y7);return void ru(e,t,i,r)}let r=e._ellipsoid.cartesianToCartographic(n.position,g7);e._tiltOnEllipsoid||r.height>e._minimumCollisionTerrainHeight?(e._tiltOnEllipsoid=!0,hat(e,t,i)):mat(e,t,i)}var dat=new fe;function hat(e,t,i){let n=e._ellipsoid,r=e._scene,o=r.camera,a=.25*e.minimumZoomDistance,s=n.cartesianToCartographic(o.positionWC,dat).height;if(s-a-1<P.EPSILON3&&i.endPosition.y-i.startPosition.y<0)return;let l=r.canvas,c=yme;c.x=l.clientWidth/2,c.y=l.clientHeight/2;let d,p=o.getPickRay(c,YV),f=Ai.rayEllipsoid(p,n);if(u(f))d=Tn.getPoint(p,f.start,hD);else{if(!(s>e._minimumTrackBallHeight)){e._looking=!0;let n=e._ellipsoid.geodeticSurfaceNormal(o.position,y7);return ru(e,t,i,n),void U.clone(t,e._tiltCenterMousePosition)}{let e=Ai.grazingAltitudeLocation(p,n);if(!u(e))return;let t=n.cartesianToCartographic(e,g7);t.height=0,d=n.cartographicToCartesian(t,hD)}}let m=Rt.eastNorthUpToFixedFrame(d,n,xme),_=e._globe,g=e._ellipsoid;e._globe=void 0,e._ellipsoid=ie.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let y=L.clone(o.transform,bme);o._setTransform(m),ou(e,t,i,h.UNIT_Z),o._setTransform(y),e._globe=_,e._ellipsoid=g;let v=g.maximumRadius;e._rotateFactor=1/v,e._rotateRateRangeAdjustment=v}function mat(e,t,i){let n,r,o,a=e._ellipsoid,s=e._scene,l=s.camera,c=e._cameraUnderground;if(U.equals(t,e._tiltCenterMousePosition))n=h.clone(e._tiltCenter,hD);else{if(n=jp(e,t,hD),!u(n)){if(r=l.getPickRay(t,YV),o=Ai.rayEllipsoid(r,a),!u(o)){if(a.cartesianToCartographic(l.position,g7).height<=e._minimumTrackBallHeight){e._looking=!0;let n=e._ellipsoid.geodeticSurfaceNormal(l.position,y7);ru(e,t,i,n),U.clone(t,e._tiltCenterMousePosition)}return}n=Tn.getPoint(r,o.start,hD)}c&&(u(r)||(r=l.getPickRay(t,YV)),ame(e,r,n,n)),U.clone(t,e._tiltCenterMousePosition),h.clone(n,e._tiltCenter)}let d=s.canvas,p=yme;p.x=d.clientWidth/2,p.y=e._tiltCenterMousePosition.y,r=l.getPickRay(p,YV);let f=h.magnitude(n),m=h.fromElements(f,f,f,h7),_=ie.fromCartesian3(m,m7);if(o=Ai.rayEllipsoid(r,_),!u(o))return;let g=h.magnitude(r.origin)>f?o.start:o.stop,y=Tn.getPoint(r,g,aat),v=Rt.eastNorthUpToFixedFrame(n,a,xme),b=Rt.eastNorthUpToFixedFrame(y,_,cat),A=e._globe,T=e._ellipsoid;e._globe=void 0,e._ellipsoid=ie.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;let E=h.UNIT_Z,C=L.clone(l.transform,bme);l._setTransform(b);let x=h.cross(y,l.positionWC,qV);if(h.dot(l.rightWC,x)<0){let n=i.startPosition.y-i.endPosition.y;(c&&n<0||!c&&n>0)&&(E=void 0);let r=l.constrainedAxis;l.constrainedAxis=void 0,ou(e,t,i,E,!0,!1),l.constrainedAxis=r}else ou(e,t,i,E,!0,!1);if(l._setTransform(v),ou(e,t,i,E,!1,!0),u(l.constrainedAxis)){let e=h.cross(l.direction,l.constrainedAxis,qV);h.equalsEpsilon(e,h.ZERO,P.EPSILON6)||(h.dot(e,l.right)<0&&h.negate(e,e),h.cross(e,l.direction,l.up),h.cross(l.direction,l.up,l.right),h.normalize(l.up,l.up),h.normalize(l.right,l.right))}l._setTransform(C),e._globe=A,e._ellipsoid=T;let S=T.maximumRadius;e._rotateFactor=1/S,e._rotateRateRangeAdjustment=S;let w=h.clone(l.positionWC,qV);if(e.enableCollisionDetection&&x7(e),!h.equals(l.positionWC,w)){l._setTransform(b),l.worldToCameraCoordinatesPoint(w,w);let e=h.magnitudeSquared(w);h.magnitudeSquared(l.position)>e&&(h.normalize(l.position,l.position),h.multiplyByScalar(l.position,Math.sqrt(e),l.position));let t=h.angleBetween(w,l.position),i=h.cross(w,l.position,w);h.normalize(i,i);let n=Le.fromAxisAngle(i,t,lat),r=$.fromQuaternion(n,uat);$.multiplyByVector(r,l.direction,l.direction),$.multiplyByVector(r,l.up,l.up),h.cross(l.direction,l.up,l.right),h.cross(l.right,l.direction,l.up),l._setTransform(C)}}var pat=new U,_at=new U,nme=new Tn,ime=new Tn,gat=new h,yat=new h;function ru(e,t,i,n){let r=e._scene.camera,o=pat;o.x=i.startPosition.x,o.y=0;let a=_at;a.x=i.endPosition.x,a.y=0;let s,l,c=r.getPickRay(o,nme),d=r.getPickRay(a,ime),p=0;r.frustum instanceof Qt?(s=c.origin,l=d.origin,h.add(r.direction,s,s),h.add(r.direction,l,l),h.subtract(s,r.position,s),h.subtract(l,r.position,l),h.normalize(s,s),h.normalize(l,l)):(s=c.direction,l=d.direction);let f=h.dot(s,l);f<1&&(p=Math.acos(f)),p=i.startPosition.x>i.endPosition.x?-p:p;let m=e._horizontalRotationAxis;if(u(n)?r.look(n,-p):u(m)?r.look(m,-p):r.lookLeft(p),o.x=0,o.y=i.startPosition.y,a.x=0,a.y=i.endPosition.y,c=r.getPickRay(o,nme),d=r.getPickRay(a,ime),p=0,r.frustum instanceof Qt?(s=c.origin,l=d.origin,h.add(r.direction,s,s),h.add(r.direction,l,l),h.subtract(s,r.position,s),h.subtract(l,r.position,l),h.normalize(s,s),h.normalize(l,l)):(s=c.direction,l=d.direction),f=h.dot(s,l),f<1&&(p=Math.acos(f)),p=i.startPosition.y>i.endPosition.y?-p:p,n=y(n,m),u(n)){let e=r.direction,t=h.negate(n,gat),i=h.equalsEpsilon(e,n,P.EPSILON2),o=h.equalsEpsilon(e,t,P.EPSILON2);if(i||o)(i&&p<0||o&&p>0)&&r.look(r.right,-p);else{f=h.dot(e,n);let i=P.acosClamped(f);p>0&&p>i&&(p=i-P.EPSILON4),f=h.dot(e,t),i=P.acosClamped(f),p<0&&-p>i&&(p=-i+P.EPSILON4);let o=h.cross(n,e,yat);r.look(o,p)}}else r.lookUp(p)}function xat(e){Ec(e,e.enableRotate,e.rotateEventTypes,Jst,e.inertiaSpin,"_lastInertiaSpinMovement"),Ec(e,e.enableZoom,e.zoomEventTypes,gme,e.inertiaZoom,"_lastInertiaZoomMovement"),Ec(e,e.enableTilt,e.tiltEventTypes,fat,e.inertiaSpin,"_lastInertiaTiltMovement"),Ec(e,e.enableLook,e.lookEventTypes,ru)}var bat=new L,Tat=new fe;function x7(e){e._adjustedHeightForTerrain=!0;let t=e._scene,i=t.mode,n=t.globe;if(!u(n)||i===te.SCENE2D||i===te.MORPHING)return;let r,o,a=t.camera,s=n.ellipsoid,l=t.mapProjection;L.equals(a.transform,L.IDENTITY)||(r=L.clone(a.transform,bat),o=h.magnitude(a.position),a._setTransform(L.IDENTITY));let c=Tat;i===te.SCENE3D?s.cartesianToCartographic(a.position,c):l.unproject(a.position,c);let d=!1;if(c.height<e._minimumCollisionTerrainHeight){let t=e._scene.globeHeight;if(u(t)){let n=t+e.minimumZoomDistance;c.height<n&&(c.height=n,i===te.SCENE3D?s.cartographicToCartesian(c,a.position):l.project(c,a.position),d=!0)}}u(r)&&(a._setTransform(r),d&&(h.normalize(a.position,a.position),h.negate(a.position,a.direction),h.multiplyByScalar(a.position,Math.max(o,e.minimumZoomDistance),a.position),h.normalize(a.direction,a.direction),h.cross(a.direction,a.up,a.right),h.cross(a.right,a.direction,a.up)))}mD.prototype.onMap=function(){let e=this._scene,t=e.mode,i=e.camera;return t!==te.COLUMBUS_VIEW||Math.abs(i.position.x)-this._maxCoord.x<0&&Math.abs(i.position.y)-this._maxCoord.y<0};var Aat=new h,Cat=new h;mD.prototype.update=function(){let e=this._scene,t=e.camera,i=e.globe,n=e.mode;L.equals(t.transform,L.IDENTITY)?(this._globe=i,this._ellipsoid=u(this._globe)?this._globe.ellipsoid:e.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=ie.UNIT_SPHERE);let r=u(this._globe)?this._globe.terrainExaggeration:1,o=u(this._globe)?this._globe.terrainExaggerationRelativeHeight:0;this._minimumCollisionTerrainHeight=Wc.getHeight(this.minimumCollisionTerrainHeight,r,o),this._minimumPickingTerrainHeight=Wc.getHeight(this.minimumPickingTerrainHeight,r,o),this._minimumTrackBallHeight=Wc.getHeight(this.minimumTrackBallHeight,r,o),this._cameraUnderground=e.cameraUnderground&&u(this._globe);let a=this._ellipsoid.maximumRadius;this._rotateFactor=1/a,this._rotateRateRangeAdjustment=a,this._adjustedHeightForTerrain=!1;let s=h.clone(t.positionWC,Aat),l=h.clone(t.directionWC,Cat);n===te.SCENE2D?Tst(this):n===te.COLUMBUS_VIEW?(this._horizontalRotationAxis=h.UNIT_Z,jst(this)):n===te.SCENE3D&&(this._horizontalRotationAxis=void 0,xat(this)),this.enableCollisionDetection&&!this._adjustedHeightForTerrain&&(!h.equals(s,t.positionWC)||!h.equals(l,t.directionWC))&&x7(this),this._aggregator.reset()},mD.prototype.isDestroyed=function(){return!1},mD.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),le(this)};var KV=mD,ZV="uniform sampler2D colorTexture;\nuniform sampler2D colorTexture2;\n\nuniform vec2 center;\nuniform float radius;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color0 = texture(colorTexture, v_textureCoordinates);\n    vec4 color1 = texture(colorTexture2, v_textureCoordinates);\n\n    float x = length(gl_FragCoord.xy - center) / radius;\n    float t = smoothstep(0.5, 0.8, x);\n    out_FragColor = mix(color0 + color1, color1, t);\n}\n",$V='uniform sampler2D colorTexture;\n\nuniform float avgLuminance;\nuniform float threshold;\nuniform float offset;\n\nin vec2 v_textureCoordinates;\n\nfloat key(float avg)\n{\n    float guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\n    return max(0.0, guess) + 0.1;\n}\n\n// See section 9. "The bright-pass filter" of Realtime HDR Rendering\n// http://www.cg.tuwien.ac.at/research/publications/2007/Luksch_2007_RHR/Luksch_2007_RHR-RealtimeHDR%20.pdf\n\nvoid main()\n{\n    vec4 color = texture(colorTexture, v_textureCoordinates);\n    vec3 xyz = czm_RGBToXYZ(color.rgb);\n    float luminance = xyz.r;\n\n    float scaledLum = key(avgLuminance) * luminance / avgLuminance;\n    float brightLum = max(scaledLum - threshold, 0.0);\n    float brightness = brightLum / (offset + brightLum);\n\n    xyz.r = brightness;\n    out_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n';function qp(){this._sceneFramebuffer=new _C;let e=.125,t=new Array(6);t[0]=new _o({fragmentShader:Jl,textureScale:e,forcePowerOfTwo:!0,sampleMode:gf.LINEAR});let i=t[1]=new _o({fragmentShader:$V,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:e,forcePowerOfTwo:!0}),n=this;this._delta=1,this._sigma=2,this._blurStep=new U,t[2]=new _o({fragmentShader:Ox,uniforms:{step:function(){return n._blurStep.x=n._blurStep.y=1/i.outputTexture.width,n._blurStep},delta:function(){return n._delta},sigma:function(){return n._sigma},direction:0},textureScale:e,forcePowerOfTwo:!0}),t[3]=new _o({fragmentShader:Ox,uniforms:{step:function(){return n._blurStep.x=n._blurStep.y=1/i.outputTexture.width,n._blurStep},delta:function(){return n._delta},sigma:function(){return n._sigma},direction:1},textureScale:e,forcePowerOfTwo:!0}),t[4]=new _o({fragmentShader:Jl,sampleMode:gf.LINEAR}),this._uCenter=new U,this._uRadius=void 0,t[5]=new _o({fragmentShader:ZV,uniforms:{center:function(){return n._uCenter},radius:function(){return n._uRadius},colorTexture2:function(){return n._sceneFramebuffer.framebuffer.getColorTexture(0)}}}),this._stages=new _l({stages:t});let r=new TC(this),o=t.length;for(let e=0;e<o;++e)t[e]._textureCache=r;this._textureCache=r,this.length=t.length}qp.prototype.get=function(e){return this._stages.get(e)},qp.prototype.getStageByName=function(e){let t=this._stages.length;for(let i=0;i<t;++i){let t=this._stages.get(i);if(t.name===e)return t}};var Eat=new oe,Tme=new U,Sat=new U,Ame=new L;function wat(e,t,i){let n=t.uniformState,r=n.sunPositionWC,o=n.view,a=n.viewProjection,s=n.projection,l=L.computeViewportTransformation(i,0,1,Ame),u=L.multiplyByPoint(o,r,Eat),c=Rt.pointToGLWindowCoordinates(a,l,r,Tme);u.x+=P.SOLAR_RADIUS;let h=Rt.pointToGLWindowCoordinates(s,l,u,u),d=30*U.magnitude(U.subtract(h,c,h))*2,p=Sat;p.x=d,p.y=d,e._uCenter=U.clone(c,e._uCenter),e._uRadius=.15*Math.max(p.x,p.y);let f=t.drawingBufferWidth,m=t.drawingBufferHeight,_=e._stages,g=_.get(0),y=g.outputTexture.width,v=g.outputTexture.height,b=new qe;b.width=y,b.height=v,l=L.computeViewportTransformation(b,0,1,Ame),c=Rt.pointToGLWindowCoordinates(a,l,r,Tme),p.x*=y/f,p.y*=v/m;let A=g.scissorRectangle;A.x=Math.max(c.x-.5*p.x,0),A.y=Math.max(c.y-.5*p.y,0),A.width=Math.min(p.x,f),A.height=Math.min(p.y,m);for(let e=1;e<4;++e)qe.clone(A,_.get(e).scissorRectangle)}qp.prototype.clear=function(e,t,i){this._sceneFramebuffer.clear(e,t,i),this._textureCache.clear(e)},qp.prototype.update=function(e){let t=e.context,i=e.viewport,n=this._sceneFramebuffer;n.update(t,i);let r=n.framebuffer;return this._textureCache.update(t),this._stages.update(t,!1),wat(this,t,i),r},qp.prototype.execute=function(e){let t=this._sceneFramebuffer.framebuffer.getColorTexture(0),i=this._stages,n=i.length;i.get(0).execute(e,t);for(let t=1;t<n;++t)i.get(t).execute(e,i.get(t-1).outputTexture)},qp.prototype.copy=function(e,t){if(!u(this._copyColorCommand)){let t=this;this._copyColorCommand=e.createViewportQuadCommand(Jl,{uniformMap:{colorTexture:function(){return t._stages.get(t._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},qp.prototype.isDestroyed=function(){return!1},qp.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),le(this)};var QV=qp,eU=function(e){return function(){e.frameState.afterRender.push((function(){e.requestRender()}))}};function ki(e){let t=(e=y(e,y.EMPTY_OBJECT)).canvas,i=e.creditContainer,n=e.creditViewport,r=Ge(e.contextOptions),o=u(i),a=new BV(t,r);o||(i=document.createElement("div"),i.style.position="absolute",i.style.bottom="0",i.style["text-shadow"]="0 0 2px #000000",i.style.color="#ffffff",i.style["font-size"]="10px",i.style["padding-right"]="5px",t.parentNode.appendChild(i)),u(n)||(n=t.parentNode),this._id=jn(),this._jobScheduler=new Rk,this._frameState=new U3(a,new T3(i,"  ",n),this._jobScheduler),this._frameState.scene3DOnly=y(e.scene3DOnly,!1),this._removeCreditContainer=!o,this._creditContainer=i,this._canvas=t,this._context=a,this._computeEngine=new MV(a),this._globe=void 0,this._globeTranslucencyState=new xk,this._primitives=new tu,this._groundPrimitives=new tu,this._globeHeight=void 0,this._cameraUnderground=!1,this._logDepthBuffer=a.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new EC,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=y(e.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,this._depthPlane=new P3(e.depthPlaneEllipsoidOffset),this._clearColorCommand=new ti({color:new z,stencil:0,owner:this}),this._depthClearCommand=new ti({depth:1,owner:this}),this._stencilClearCommand=new ti({stencil:0}),this._classificationStencilClearCommand=new ti({stencil:0,renderState:Ue.fromCache({stencilMask:Lt.CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._transitioner=new VV(this),this._preUpdate=new pe,this._postUpdate=new pe,this._renderError=new pe,this._preRender=new pe,this._postRender=new pe,this._minimumDisableDepthTestDistance=0,this._debugInspector=new C3,this._msaaSamples=y(e.msaaSamples,1),this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new pe,this.morphComplete=new pe,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=z.clone(z.BLACK),this._mode=te.SCENE3D,this._mapProjection=u(e.mapProjection)?e.mapProjection:new Ii,this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this.pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.fog=new k3,this._shadowMapCamera=new oo(this),this.shadowMap=new Zg({context:a,lightCamera:this._shadowMapCamera,enabled:y(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=z.clone(z.WHITE),this._actualInvertClassificationColor=z.clone(this._invertClassificationColor),this._invertClassification=new Yv,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new OV,this._brdfLutGenerator=new ML,this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new KV(this),this._cameraUnderground=!1,this._mapMode2D=y(e.mapMode2D,kl.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this.requestRenderMode=y(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=y(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=nc.requestCompletedEvent.addEventListener(eU(this)),this._removeTaskProcessorListenerCallback=pi.taskCompletedEvent.addEventListener(eU(this)),this._removeGlobeCallbacks=[],this._removeTerrainProviderReadyListener=void 0;let s=new qe(0,0,a.drawingBufferWidth,a.drawingBufferHeight),l=new oo(this);this._logDepthBuffer&&(l.frustum.near=.1,l.frustum.far=1e10),this.preloadFlightCamera=new oo(this),this.preloadFlightCullingVolume=void 0,this._picking=new sV(this),this._defaultView=new yC(this,l,s),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!1,this.gamma=2.2,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentMapAtlas=void 0,this.light=new Qg,wme(this,0,J.now()),this.updateFrameState(),this.initializeFrame()}function vat(e,t){for(let t=0;t<e._removeGlobeCallbacks.length;++t)e._removeGlobeCallbacks[t]();e._removeGlobeCallbacks.length=0;let i=[];u(t)&&(i.push(t.imageryLayersUpdatedEvent.addEventListener(eU(e))),i.push(t.terrainProviderChanged.addEventListener(eU(e)))),e._removeGlobeCallbacks=i}function Cme(e,t,i){let n=e._frameState,r=e._context,o=e._view.oit,a=n.shadowState.lightShadowMaps,s=n.shadowState.lightShadowsEnabled,l=t.derivedCommands;u(t.pickId)&&(l.picking=Hg.createPickDerivedCommand(e,t,r,l.picking)),t.pickOnly||(l.depth=Hg.createDepthOnlyDerivedCommand(e,t,r,l.depth)),l.originalCommand=t,e._hdr&&(l.hdr=Hg.createHdrCommand(t,r,l.hdr),l=(t=l.hdr.command).derivedCommands),s&&t.receiveShadows&&(l.shadows=Zg.createReceiveDerivedCommand(a,t,i,r,l.shadows)),t.pass===Ee.TRANSLUCENT&&u(o)&&o.isSupported()&&(s&&t.receiveShadows?(l.oit=u(l.oit)?l.oit:{},l.oit.shadows=o.createDerivedCommands(l.shadows.receiveCommand,r,l.oit.shadows)):l.oit=o.createDerivedCommands(t,r,l.oit))}Object.defineProperties(ki.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return zt.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return zt.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},specularEnvironmentMapsSupported:{get:function(){return Bh.isSupported(this._context)}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,vat(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},view:{get:function(){return this._view},set:function(e){this._view=e}},defaultView:{get:function(){return this._defaultView}},picking:{get:function(){return this._picking}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},jobScheduler:{get:function(){return this._jobScheduler}},frameState:{get:function(){return this._frameState}},environmentState:{get:function(){return this._environmentState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(u(this.globe))return this.globe.imageryLayers}},terrainProvider:{get:function(){if(u(this.globe))return this.globe.terrainProvider},set:function(e){this._removeTerrainProviderReadyListener=this._removeTerrainProviderReadyListener&&this._removeTerrainProviderReadyListener(),u(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(u(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){e===te.SCENE2D?this.morphTo2D(0):e===te.SCENE3D?this.morphTo3D(0):e===te.COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},useWebVR:{get:function(){return this._useWebVR},set:function(e){this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new oo(this),u(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new R3(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},splitPosition:{get:function(){return this._frameState.splitPosition},set:function(e){this._frameState.splitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(e){this._context.uniformState.gamma=e}},highDynamicRange:{get:function(){return this._hdr},set:function(e){let t=this._context,i=e&&t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat);this._hdrDirty=i!==this._hdr,this._hdr=i}},highDynamicRangeSupported:{get:function(){let e=this._context;return e.depthTexture&&(e.colorBufferFloat||e.colorBufferHalfFloat)}},cameraUnderground:{get:function(){return this._cameraUnderground}},msaaSamples:{get:function(){return this._msaaSamples},set:function(e){e=Math.min(e,zt.maximumSamples),this._msaaSamples=e}},msaaSupported:{get:function(){return this._context.msaa}},pixelRatio:{get:function(){return this._frameState.pixelRatio},set:function(e){this._frameState.pixelRatio=e}},opaqueFrustumNearOffset:{get:function(){return.9999}},globeHeight:{get:function(){return this._globeHeight}}}),ki.prototype.getCompressedTextureFormatSupported=function(e){let t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc"===e||"etc"===e)&&t.etc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1||("WEBGL_compressed_texture_astc"===e||"astc"===e)&&t.astc||("EXT_texture_compression_bptc"===e||"bc7"===e)&&t.bc7},ki.prototype.updateDerivedCommands=function(e){if(!u(e.derivedCommands))return;let t=this._frameState,i=this._context,n=!1,r=t.shadowState.lastDirtyTime;e.lastDirtyTime!==r&&(e.lastDirtyTime=r,e.dirty=!0,n=!0);let o=t.useLogDepth,a=this._hdr,s=e.derivedCommands,l=u(s.logDepth),c=u(s.hdr),h=u(s.originalCommand),d=o&&!l,p=a&&!c,f=!(o&&a||h);if(e.dirty=e.dirty||d||p||f,e.dirty){e.dirty=!1;let r=t.shadowState.shadowMaps;t.shadowState.shadowsEnabled&&e.castShadows&&(s.shadows=Zg.createCastDerivedCommand(r,e,n,i,s.shadows)),(l||d)&&(s.logDepth=Hg.createLogDepthCommand(e,i,s.logDepth),Cme(this,s.logDepth.command,n)),(h||f)&&Cme(this,e,n)}};var Dat=new gd({pass:Io.RENDER}),b7=new gd({pass:Io.PRELOAD}),T7=new gd({pass:Io.PRELOAD_FLIGHT}),Iat=new gd({pass:Io.REQUEST_RENDER_MODE_DEFER_CHECK}),Eme=new se,A7;function Pat(e){let t=e.globe;if(e._mode===te.SCENE3D&&u(t)&&t.show&&!e._cameraUnderground&&!e._globeTranslucencyState.translucent){let i=t.ellipsoid,n=e.frameState.minimumTerrainHeight;return Eme.radius=i.minimumRadius+n,A7=lO.fromBoundingSphere(Eme,e.camera.positionWC,A7)}}function wme(e,t,i){let n=e._frameState;n.frameNumber=t,n.time=J.clone(i,n.time)}ki.prototype.clearPasses=function(e){e.render=!1,e.pick=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1},ki.prototype.updateFrameState=function(){let e=this.camera,t=this._frameState;t.commandList.length=0,t.shadowMaps.length=0,t.brdfLutGenerator=this._brdfLutGenerator,t.environmentMap=this.skyBox&&this.skyBox._cubeMap,t.mode=this._mode,t.morphTime=this.morphTime,t.mapProjection=this.mapProjection,t.camera=e,t.cullingVolume=e.frustum.computeCullingVolume(e.positionWC,e.directionWC,e.upWC),t.occluder=Pat(this),t.minimumTerrainHeight=0,t.minimumDisableDepthTestDistance=this._minimumDisableDepthTestDistance,t.invertClassification=this.invertClassification,t.useLogDepth=this._logDepthBuffer&&!(this.camera.frustum instanceof Qt||this.camera.frustum instanceof Or),t.light=this.light,t.cameraUnderground=this._cameraUnderground,t.globeTranslucencyState=this._globeTranslucencyState,u(this.globe)&&(t.terrainExaggeration=this.globe.terrainExaggeration,t.terrainExaggerationRelativeHeight=this.globe.terrainExaggerationRelativeHeight),u(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready?(t.specularEnvironmentMaps=this._specularEnvironmentMapAtlas.texture,t.specularEnvironmentMapsMaximumLOD=this._specularEnvironmentMapAtlas.maximumMipmapLevel):(t.specularEnvironmentMaps=void 0,t.specularEnvironmentMapsMaximumLOD=void 0),t.sphericalHarmonicCoefficients=this.sphericalHarmonicCoefficients,this._actualInvertClassificationColor=z.clone(this.invertClassificationColor,this._actualInvertClassificationColor),Yv.isTranslucencySupported(this._context)||(this._actualInvertClassificationColor.alpha=1),t.invertClassificationColor=this._actualInvertClassificationColor,u(this.globe)?t.maximumScreenSpaceError=this.globe.maximumScreenSpaceError:t.maximumScreenSpaceError=2,this.clearPasses(t.passes),t.tilesetPassState=void 0},ki.prototype.isVisible=function(e,t,i){return u(e)&&(!u(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==Zt.OUTSIDE&&(!u(i)||!e.occlude||!e.boundingVolume.isOccluded(i)))};var JV=new L(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);function Oat(e,t,i,n){let r=t._frameState,o=r.context,a=e.boundingVolume;u(t._debugVolume)&&t._debugVolume.destroy();let s,l=h.clone(a.center);if(r.mode!==te.SCENE3D){l=L.multiplyByPoint(JV,l,l);let e=r.mapProjection,t=e.unproject(l);l=e.ellipsoid.cartographicToCartesian(t)}if(u(a.radius)){let e=a.radius;s=Fn.toWireframe(Ms.createGeometry(new Ms({radii:new h(e,e,e),vertexFormat:rn.FLAT_VERTEX_FORMAT}))),t._debugVolume=new Sn({geometryInstances:new yt({geometry:s,modelMatrix:L.fromTranslation(l),attributes:{color:new kt(1,0,0,1)}}),appearance:new rn({flat:!0,translucent:!1}),asynchronous:!1})}else{let e=a.halfAxes;s=Fn.toWireframe(Dl.createGeometry(Dl.fromDimensions({dimensions:new h(2,2,2),vertexFormat:rn.FLAT_VERTEX_FORMAT}))),t._debugVolume=new Sn({geometryInstances:new yt({geometry:s,modelMatrix:L.fromRotationTranslation(e,l,new L),attributes:{color:new kt(1,0,0,1)}}),appearance:new rn({flat:!0,translucent:!1}),asynchronous:!1})}let c,d=r.commandList,p=r.commandList=[];t._debugVolume.update(r),e=p[0],r.useLogDepth&&(e=Hg.createLogDepthCommand(e,o).command),u(n)&&(c=i.framebuffer,i.framebuffer=n),e.execute(o,i),u(c)&&(i.framebuffer=c),r.commandList=d}function ha(e,t,i,n,r){let o=t._frameState;if(u(t.debugCommandFilter)&&!t.debugCommandFilter(e))return;if(e instanceof ti)return void e.execute(i,n);e.debugShowBoundingVolume&&u(e.boundingVolume)&&Oat(e,t,n,r),o.useLogDepth&&u(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);let a=o.passes;if(!a.pick&&!a.depth&&t._hdr&&u(e.derivedCommands)&&u(e.derivedCommands.hdr)&&(e=e.derivedCommands.hdr.command),a.pick||a.depth){if(a.pick&&!a.depth&&u(e.derivedCommands.picking))return void(e=e.derivedCommands.picking.pickCommand).execute(i,n);if(u(e.derivedCommands.depth))return void(e=e.derivedCommands.depth.depthOnlyCommand).execute(i,n)}t.debugShowCommands||t.debugShowFrustums?t._debugInspector.executeDebugShowFrustumsCommand(t,e,n):o.shadowState.lightShadowsEnabled&&e.receiveShadows&&u(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(i,n):e.execute(i,n)}function pD(e,t,i,n){let r=t._frameState,o=e.derivedCommands;u(o)&&(r.useLogDepth&&u(o.logDepth)&&(e=o.logDepth.command),o=e.derivedCommands,u(o.picking)?(e=o.picking.pickCommand).execute(i,n):u(o.depth)&&(e=o.depth.depthOnlyCommand).execute(i,n))}function vme(e,t,i){return t.boundingVolume.distanceSquaredTo(i)-e.boundingVolume.distanceSquaredTo(i)}function Rat(e,t,i){return e.boundingVolume.distanceSquaredTo(i)-t.boundingVolume.distanceSquaredTo(i)+P.EPSILON12}function Mat(e,t,i,n,r){let o=e.context;N_(n,vme,e.camera.positionWC),u(r)&&t(r.unclassifiedCommand,e,o,i);let a=n.length;for(let r=0;r<a;++r)t(n[r],e,o,i)}function Lat(e,t,i,n,r){let o=e.context;N_(n,Rat,e.camera.positionWC),u(r)&&t(r.unclassifiedCommand,e,o,i);let a=n.length;for(let r=0;r<a;++r)t(n[r],e,o,i)}function Nat(e,t,i,n){let r=e.context;N_(n,vme,e.camera.positionWC);let o=n.length;for(let a=0;a<o;++a)t(n[a],e,r,i)}JV=L.inverseTransformation(JV,JV);var Fat=new Ei,Bat=new $c,kat=new Qt,Vat=new Or;function C7(e,t){let i,n=e.camera,r=e.context,o=e.frameState,a=r.uniformState;a.updateCamera(n),i=u(n.frustum.fov)?n.frustum.clone(Fat):u(n.frustum.infiniteProjectionMatrix)?n.frustum.clone(Bat):u(n.frustum.width)?n.frustum.clone(kat):n.frustum.clone(Vat),i.near=n.frustum.near,i.far=n.frustum.far,a.updateFrustum(i),a.updatePass(Ee.ENVIRONMENT);let s,l=o.passes,c=l.pick,h=e._environmentState,d=e._view,p=h.renderTranslucentDepthForPick,f=h.useWebVR;if(!c){let i=h.skyBoxCommand;if(u(i)&&ha(i,e,r,t),h.isSkyAtmosphereVisible&&ha(h.skyAtmosphereCommand,e,r,t),h.isSunVisible&&(h.sunDrawCommand.execute(r,t),e.sunBloom&&!f)){let i;i=h.useGlobeDepthFramebuffer?d.globeDepth.framebuffer:h.usePostProcess?d.sceneFramebuffer.framebuffer:h.originalFramebuffer,e._sunPostProcess.execute(r),e._sunPostProcess.copy(r,i),t.framebuffer=i}h.isMoonVisible&&h.moonCommand.execute(r,t)}h.useOIT?(u(e._executeOITFunction)||(e._executeOITFunction=function(e,t,i,n,o){d.globeDepth.prepareColorTextures(r),d.oit.executeCommands(e,t,i,n,o)}),s=e._executeOITFunction):s=l.render?Mat:Lat;let m,_=d.frustumCommandsList,g=_.length,y=h.clearGlobeDepth,v=h.useDepthPlane,b=e._globeTranslucencyState,A=b.translucent,T=e._view.globeTranslucencyFramebuffer,E=e._depthClearCommand,C=e._stencilClearCommand,x=e._classificationStencilClearCommand,S=e._depthPlane,w=h.usePostProcessSelected,I=n.position.z;for(let l=0;l<g;++l){let f=g-l-1,P=_[f];e.mode===te.SCENE2D?(n.position.z=I-P.near+1,i.far=Math.max(1,P.far-P.near),i.near=1,a.update(o),a.updateFrustum(i)):(i.near=0!==f?P.near*e.opaqueFrustumNearOffset:P.near,i.far=P.far,a.updateFrustum(i)),E.execute(r,t),r.stencilBuffer&&C.execute(r,t),a.updatePass(Ee.GLOBE);let D=P.commands[Ee.GLOBE],O=P.indices[Ee.GLOBE];if(A)b.executeGlobeCommands(P,ha,T,e,t);else for(m=0;m<O;++m)ha(D[m],e,r,t);let L,R=d.globeDepth;if(u(R)&&h.useGlobeDepthFramebuffer&&R.executeCopyDepth(r,t),!h.renderTranslucentDepthForPick)if(a.updatePass(Ee.TERRAIN_CLASSIFICATION),D=P.commands[Ee.TERRAIN_CLASSIFICATION],O=P.indices[Ee.TERRAIN_CLASSIFICATION],A)b.executeGlobeClassificationCommands(P,ha,T,e,t);else for(m=0;m<O;++m)ha(D[m],e,r,t);if(y&&(E.execute(r,t),v&&S.execute(r,t)),!h.useInvertClassification||c||h.renderTranslucentDepthForPick){for(a.updatePass(Ee.CESIUM_3D_TILE),D=P.commands[Ee.CESIUM_3D_TILE],O=P.indices[Ee.CESIUM_3D_TILE],m=0;m<O;++m)ha(D[m],e,r,t);if(O>0&&(u(R)&&h.useGlobeDepthFramebuffer&&(R.prepareColorTextures(r,y),R.executeUpdateDepth(r,t,y,R.depthStencilTexture)),!h.renderTranslucentDepthForPick))for(a.updatePass(Ee.CESIUM_3D_TILE_CLASSIFICATION),D=P.commands[Ee.CESIUM_3D_TILE_CLASSIFICATION],O=P.indices[Ee.CESIUM_3D_TILE_CLASSIFICATION],m=0;m<O;++m)ha(D[m],e,r,t)}else{e._invertClassification.clear(r,t);let i=t.framebuffer;for(t.framebuffer=e._invertClassification._fbo.framebuffer,a.updatePass(Ee.CESIUM_3D_TILE),D=P.commands[Ee.CESIUM_3D_TILE],O=P.indices[Ee.CESIUM_3D_TILE],m=0;m<O;++m)ha(D[m],e,r,t);for(u(R)&&h.useGlobeDepthFramebuffer&&(e._invertClassification.prepareTextures(r),R.executeUpdateDepth(r,t,y,e._invertClassification._fbo.getDepthStencilTexture())),a.updatePass(Ee.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),D=P.commands[Ee.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],O=P.indices[Ee.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW],m=0;m<O;++m)ha(D[m],e,r,t);for(t.framebuffer=i,e._invertClassification.executeClassified(r,t),1===o.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(r,t),O>0&&r.stencilBuffer&&x.execute(r,t),a.updatePass(Ee.CESIUM_3D_TILE_CLASSIFICATION),D=P.commands[Ee.CESIUM_3D_TILE_CLASSIFICATION],O=P.indices[Ee.CESIUM_3D_TILE_CLASSIFICATION],m=0;m<O;++m)ha(D[m],e,r,t)}for(O>0&&r.stencilBuffer&&C.execute(r,t),a.updatePass(Ee.VOXELS),D=P.commands[Ee.VOXELS],O=P.indices[Ee.VOXELS],D.length=O,Nat(e,ha,t,D),a.updatePass(Ee.OPAQUE),D=P.commands[Ee.OPAQUE],O=P.indices[Ee.OPAQUE],m=0;m<O;++m)ha(D[m],e,r,t);if(0!==f&&e.mode!==te.SCENE2D&&(i.near=P.near,a.updateFrustum(i)),!c&&h.useInvertClassification&&o.invertClassificationColor.alpha<1&&(L=e._invertClassification),a.updatePass(Ee.TRANSLUCENT),D=P.commands[Ee.TRANSLUCENT],D.length=P.indices[Ee.TRANSLUCENT],s(e,ha,t,D,L),P.indices[Ee.CESIUM_3D_TILE_CLASSIFICATION]>0&&d.translucentTileClassification.isSupported()&&(d.translucentTileClassification.executeTranslucentCommands(e,ha,t,D,R.depthStencilTexture),d.translucentTileClassification.executeClassificationCommands(e,ha,t,P)),r.depthTexture&&e.useDepthPicking&&(h.useGlobeDepthFramebuffer||p)){let i=R.depthStencilTexture,n=e._picking.getPickDepth(e,f);n.update(r,i),n.executeCopyDepth(r,t)}if(c||!w)continue;let N=t.framebuffer;if(t.framebuffer=d.sceneFramebuffer.getIdFramebuffer(),i.near=0!==f?P.near*e.opaqueFrustumNearOffset:P.near,i.far=P.far,a.updateFrustum(i),a.updatePass(Ee.GLOBE),D=P.commands[Ee.GLOBE],O=P.indices[Ee.GLOBE],A)b.executeGlobeCommands(P,pD,T,e,t);else for(m=0;m<O;++m)pD(D[m],e,r,t);for(y&&(E.framebuffer=t.framebuffer,E.execute(r,t),E.framebuffer=void 0),y&&v&&S.execute(r,t),a.updatePass(Ee.CESIUM_3D_TILE),D=P.commands[Ee.CESIUM_3D_TILE],O=P.indices[Ee.CESIUM_3D_TILE],m=0;m<O;++m)pD(D[m],e,r,t);for(a.updatePass(Ee.OPAQUE),D=P.commands[Ee.OPAQUE],O=P.indices[Ee.OPAQUE],m=0;m<O;++m)pD(D[m],e,r,t);for(a.updatePass(Ee.TRANSLUCENT),D=P.commands[Ee.TRANSLUCENT],O=P.indices[Ee.TRANSLUCENT],m=0;m<O;++m)pD(D[m],e,r,t);t.framebuffer=N}}function Dme(e){e.context.uniformState.updatePass(Ee.COMPUTE);let t=e._environmentState.sunComputeCommand;u(t)&&t.execute(e._computeEngine);let i=e._computeCommandList,n=i.length;for(let t=0;t<n;++t)i[t].execute(e._computeEngine)}function Uat(e,t){e.context.uniformState.updatePass(Ee.OVERLAY);let i=e.context,n=e._overlayCommandList,r=n.length;for(let e=0;e<r;++e)n[e].execute(i,t)}function zat(e,t,i){let n=i.shadowMapCullingVolume,r=i.isPointLight,o=i.passes,a=o.length,s=t.length;for(let i=0;i<s;++i){let s=t[i];if(e.updateDerivedCommands(s),s.castShadows&&(s.pass===Ee.GLOBE||s.pass===Ee.CESIUM_3D_TILE||s.pass===Ee.OPAQUE||s.pass===Ee.TRANSLUCENT)&&e.isVisible(s,n))if(r)for(let e=0;e<a;++e)o[e].commandList.push(s);else if(1===a)o[0].commandList.push(s);else{let t=!1;for(let i=a-1;i>=0;--i){let n=o[i].cullingVolume;if(e.isVisible(s,n))o[i].commandList.push(s),t=!0;else if(t)break}}}}function Ime(e){let t=e.frameState,i=t.shadowState.shadowMaps,n=i.length;if(!t.shadowState.shadowsEnabled)return;let r=e.context,o=r.uniformState;for(let t=0;t<n;++t){let n=i[t];if(n.outOfView)continue;let a=n.passes,s=a.length;for(let e=0;e<s;++e)a[e].commandList.length=0;zat(e,e.frameState.commandList,n);for(let i=0;i<s;++i){let a=n.passes[i];o.updateCamera(a.camera),n.updatePass(r,i);let s=a.commandList.length;for(let i=0;i<s;++i){let n=a.commandList[i];o.updatePass(n.pass),ha(n.derivedCommands.shadows.castCommands[t],e,r,a.passState)}}}}var Hat=new h;function Gat(e,t,i){let n=e._view,r=n.camera,o=e._environmentState.renderTranslucentDepthForPick;E7(e,t,i),Pme(e),n.createPotentiallyVisibleSet(e),Dme(e),o||Ime(e);let a=t.viewport;a.x=0,a.y=0,a.width=.5*a.width;let s=oo.clone(r,e._cameraVR);s.frustum=r.frustum;let l=r.frustum.near,u=l*y(e.focalLength,5),c=y(e.eyeSeparation,u/30),d=h.multiplyByScalar(s.right,.5*c,Hat);r.frustum.aspectRatio=a.width/a.height;let p=.5*c*l/u;h.add(s.position,d,r.position),r.frustum.xOffset=p,C7(e,t),a.x=a.width,h.subtract(s.position,d,r.position),r.frustum.xOffset=-p,C7(e,t),oo.clone(s,r)}ki.prototype.updateAndExecuteCommands=function(e,t){let i=this._frameState.mode;this._environmentState.useWebVR?Gat(this,e,t):i!==te.SCENE2D||this._mapMode2D===kl.ROTATE?Jg(!0,this,e,t):(E7(this,e,t),Qat(this,e))};var Wat=new fe(Math.PI,P.PI_OVER_TWO),jat=new h,qat=new h,Yat=new L,Xat=new L,Kat=new h,Zat=new h,$at=new qe;function Qat(e,t){let i=e.context,n=e.frameState,r=e.camera,o=t.viewport,a=qe.clone(o,$at);t.viewport=a;let s=Wat,l=jat;e.mapProjection.project(s,l);let u=h.clone(r.position,qat),c=L.clone(r.transform,Xat),d=r.frustum.clone();r._setTransform(L.IDENTITY);let p=L.computeViewportTransformation(a,0,1,Yat),f=r.frustum.projectionMatrix,m=r.positionWC.y,_=h.fromElements(P.sign(m)*l.x-m,0,-r.positionWC.x,Kat),g=Rt.pointToGLWindowCoordinates(f,p,_,Zat);g.x=Math.floor(g.x);let y=a.x,v=a.width;if(0===m||g.x<=y||g.x>=y+v)Jg(!0,e,t);else if(Math.abs(y+.5*v-g.x)<1)a.width=g.x-a.x,r.position.x*=P.sign(r.position.x),r.frustum.right=0,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Jg(!0,e,t),a.x=g.x,r.position.x=-r.position.x,r.frustum.right=-r.frustum.left,r.frustum.left=0,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Jg(!1,e,t);else if(g.x>y+.5*v){a.width=g.x-y;let o=r.frustum.right;r.frustum.right=l.x-m,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Jg(!0,e,t),a.x=g.x,a.width=y+v-g.x,r.position.x=-r.position.x,r.frustum.left=-r.frustum.right,r.frustum.right=o-2*r.frustum.right,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Jg(!1,e,t)}else{a.x=g.x,a.width=y+v-g.x;let o=r.frustum.left;r.frustum.left=-l.x-m,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Jg(!0,e,t),a.x=y,a.width=g.x-y,r.position.x=-r.position.x,r.frustum.right=-r.frustum.left,r.frustum.left=o-2*r.frustum.left,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Jg(!1,e,t)}r._setTransform(c),h.clone(u,r.position),r.frustum=d.clone(),t.viewport=o}function Jg(e,t,i,n){let r=t._environmentState,o=t._view,a=r.renderTranslucentDepthForPick;e||(t.frameState.commandList.length=0),Pme(t),o.createPotentiallyVisibleSet(t),e&&(u(n)&&E7(t,i,n),Dme(t),a||Ime(t)),C7(t,i)}var Sme=new ns;function Jat(e){let t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new kp({camera:e.camera,updateOnChange:!1,frustumSplits:t.frustumSplits}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),u(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}function ect(e){let t=e._frameState,i=t.shadowMaps,n=i.length,r=n>0&&!t.passes.pick&&e.mode===te.SCENE3D;if(r!==t.shadowState.shadowsEnabled&&(++t.shadowState.lastDirtyTime,t.shadowState.shadowsEnabled=r),t.shadowState.lightShadowsEnabled=!1,r){for(let e=0;e<n;++e)if(i[e]!==t.shadowState.shadowMaps[e]){++t.shadowState.lastDirtyTime;break}t.shadowState.shadowMaps.length=0,t.shadowState.lightShadowMaps.length=0;for(let e=0;e<n;++e){let n=i[e];n.update(t),t.shadowState.shadowMaps.push(n),n.fromLightSource&&(t.shadowState.lightShadowMaps.push(n),t.shadowState.lightShadowsEnabled=!0),n.dirty&&(++t.shadowState.lastDirtyTime,n.dirty=!1)}}}function Pme(e){let t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),Jat(e),ect(e),e._globe&&e._globe.render(t)}function E7(e,t,i){let n=e._context,r=e._frameState,o=e._environmentState,a=e._view,s=e._frameState.passes.pick;u(a.globeDepth)&&(a.globeDepth.picking=s);let l=o.useWebVR;o.originalFramebuffer=t.framebuffer,u(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!l?e._sunPostProcess=new QV:u(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!u(e.sun)&&u(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);let c=e._clearColorCommand;z.clone(i,c.color),c.execute(n,t);let h=o.useGlobeDepthFramebuffer=u(a.globeDepth);h&&(a.globeDepth.update(n,t,a.viewport,e.msaaSamples,e._hdr,o.clearGlobeDepth),a.globeDepth.clear(n,t,i));let d=a.oit,p=o.useOIT=!s&&u(d)&&d.isSupported();p&&(d.update(n,t,a.globeDepth.colorFramebufferManager,e._hdr,e.msaaSamples),d.clear(n,t,i),o.useOIT=d.isSupported());let f=e.postProcessStages,m=o.usePostProcess=!s&&(e._hdr||f.length>0||f.ambientOcclusion.enabled||f.fxaa.enabled||f.bloom.enabled);if(o.usePostProcessSelected=!1,m&&(a.sceneFramebuffer.update(n,a.viewport,e._hdr,e.msaaSamples),a.sceneFramebuffer.clear(n,t,i),f.update(n,r.useLogDepth,e._hdr),f.clear(n),m=o.usePostProcess=f.ready,o.usePostProcessSelected=m&&f.hasSelected),o.isSunVisible&&e.sunBloom&&!l?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(n,t,i)):h?t.framebuffer=a.globeDepth.framebuffer:m&&(t.framebuffer=a.sceneFramebuffer.framebuffer),u(t.framebuffer)&&c.execute(n,t),o.useInvertClassification=!s&&u(t.framebuffer)&&e.invertClassification){let i;if(1===e.frameState.invertClassificationColor.alpha&&o.useGlobeDepthFramebuffer&&(i=a.globeDepth.framebuffer),u(i)||n.depthTexture){if(e._invertClassification.previousFramebuffer=i,e._invertClassification.update(n,e.msaaSamples,a.globeDepth.colorFramebufferManager),e._invertClassification.clear(n,t),e.frameState.invertClassificationColor.alpha<1&&p){let t=e._invertClassification.unclassifiedCommand,i=t.derivedCommands;i.oit=d.createDerivedCommands(t,n,i.oit)}}else o.useInvertClassification=!1}e._globeTranslucencyState.translucent&&a.globeTranslucencyFramebuffer.updateAndClear(e._hdr,a.viewport,n,t)}function tct(e){let t=e._frameState.afterRender;for(let i=0,n=t.length;i<n;++i)t[i]()&&e.requestRender();t.length=0}function nct(e){let t=e._globe,i=e.camera.positionCartographic;if(u(t)&&t.show&&u(i))return t.getHeight(i)}function ict(e){let t=e.camera,i=e._mode,n=e.globe,r=e._screenSpaceCameraController,o=t.positionCartographic;if(!u(o))return!1;if(!r.onMap()&&o.height<0)return!0;if(!u(n)||!n.show||i===te.SCENE2D||i===te.MORPHING)return!1;let a=e._globeHeight;return u(a)&&o.height<a}function oct(e,t){if(e.debugShowFramesPerSecond){if(!u(e._performanceDisplay)){let t=document.createElement("div");t.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(t);let i=new Xg({container:t});e._performanceDisplay=i,e._performanceContainer=t}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else u(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}function rct(e){e._jobScheduler.resetBudgets();let t=e._frameState;e.primitives.prePassesUpdate(t),u(e.globe)&&e.globe.update(t),e._picking.update(),t.creditDisplay.update()}function sct(e){let t=e._frameState;e.primitives.postPassesUpdate(t),nc.update()}ki.prototype.updateEnvironment=function(){let e=this._frameState,t=this._view,i=this._environmentState,n=e.passes.render,r=e.passes.offscreen,o=this.skyAtmosphere,a=this.globe,s=this._globeTranslucencyState;if(!n||this._mode!==te.SCENE2D&&t.camera.frustum instanceof Qt||!s.environmentVisible)i.skyAtmosphereCommand=void 0,i.skyBoxCommand=void 0,i.sunDrawCommand=void 0,i.sunComputeCommand=void 0,i.moonCommand=void 0;else{u(o)?(u(a)?(o.setDynamicAtmosphereColor(a.enableLighting&&a.dynamicAtmosphereLighting,a.dynamicAtmosphereLightingFromSun),i.isReadyForAtmosphere=i.isReadyForAtmosphere||!a.show||a._surface._tilesToRender.length>0):i.isReadyForAtmosphere=!0,i.skyAtmosphereCommand=o.update(e,a),u(i.skyAtmosphereCommand)&&this.updateDerivedCommands(i.skyAtmosphereCommand)):i.skyAtmosphereCommand=void 0,i.skyBoxCommand=u(this.skyBox)?this.skyBox.update(e,this._hdr):void 0;let n=u(this.sun)?this.sun.update(e,t.passState,this._hdr):void 0;i.sunDrawCommand=u(n)?n.drawCommand:void 0,i.sunComputeCommand=u(n)?n.computeCommand:void 0,i.moonCommand=u(this.moon)?this.moon.update(e):void 0}let l=i.clearGlobeDepth=u(a)&&a.show&&(!a.depthTestAgainstTerrain||this.mode===te.SCENE2D);(i.useDepthPlane=l&&this.mode===te.SCENE3D&&s.useDepthPlane)&&this._depthPlane.update(e),i.renderTranslucentDepthForPick=!1,i.useWebVR=this._useWebVR&&this.mode!==te.SCENE2D&&!r;let c=e.mode!==te.SCENE3D||s.sunVisibleThroughGlobe?void 0:e.occluder,h=e.cullingVolume,d=Sme.planes;for(let e=0;e<5;++e)d[e]=h.planes[e];h=Sme,i.isSkyAtmosphereVisible=u(i.skyAtmosphereCommand)&&i.isReadyForAtmosphere,i.isSunVisible=this.isVisible(i.sunDrawCommand,h,c),i.isMoonVisible=this.isVisible(i.moonCommand,h,c);let p=this.specularEnvironmentMaps,f=this._specularEnvironmentMapAtlas;!u(p)||u(f)&&f.url===p?!u(p)&&u(f)&&(f.destroy(),this._specularEnvironmentMapAtlas=void 0):(f=f&&f.destroy(),this._specularEnvironmentMapAtlas=new Bh(p)),u(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e)},ki.prototype.resolveFramebuffers=function(e){let t=this._context,i=this._environmentState,n=this._view,r=n.globeDepth;u(r)&&r.prepareColorTextures(t);let o=i.useOIT,a=i.useGlobeDepthFramebuffer,s=i.usePostProcess,l=i.originalFramebuffer,c=a?r.colorFramebufferManager:void 0,h=n.sceneFramebuffer._colorFramebuffer,d=n.sceneFramebuffer.idFramebuffer;o&&(e.framebuffer=s?h.framebuffer:l,n.oit.execute(t,e));let p=n.translucentTileClassification;if(p.hasTranslucentDepth&&p.isSupported()&&p.execute(this,e),s){n.sceneFramebuffer.prepareColorTextures(t);let e=h;a&&!o&&(e=c);let i=this.postProcessStages,r=e.getColorTexture(0),s=d.getColorTexture(0),u=y(c,h).getDepthStencilTexture();i.execute(t,r,u,s),i.copy(t,l)}!o&&!s&&a&&(e.framebuffer=l,r.executeCopyColor(t,e))},ki.prototype.initializeFrame=function(){120==this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._globeHeight=nct(this),this._cameraUnderground=ict(this),this._globeTranslucencyState.update(this),this._screenSpaceCameraController.update(),u(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};var act=new z;function cct(e){let t=e._frameState,i=e.context,n=i.uniformState,r=e._defaultView;e._view=r,e.updateFrameState(),t.passes.render=!0,t.passes.postProcess=e.postProcessStages.hasSelected,t.tilesetPassState=Dat;let o=y(e.backgroundColor,z.BLACK);e._hdr&&(o=z.clone(o,act),o.red=Math.pow(o.red,e.gamma),o.green=Math.pow(o.green,e.gamma),o.blue=Math.pow(o.blue,e.gamma)),t.backgroundColor=o,e.fog.update(t),n.update(t);let a=e.shadowMap;u(a)&&a.enabled&&(!u(e.light)||e.light instanceof Qg?h.negate(n.sunDirectionWC,e._shadowMapCamera.direction):h.clone(e.light.direction,e._shadowMapCamera.direction),t.shadowMaps.push(a)),e._computeCommandList.length=0,e._overlayCommandList.length=0;let s=r.viewport;s.x=0,s.y=0,s.width=i.drawingBufferWidth,s.height=i.drawingBufferHeight;let l=r.passState;l.framebuffer=void 0,l.blendingEnabled=void 0,l.scissorTest=void 0,l.viewport=qe.clone(s,l.viewport),u(e.globe)&&e.globe.beginFrame(t),e.updateEnvironment(),e.updateAndExecuteCommands(l,o),e.resolveFramebuffers(l),l.framebuffer=void 0,Uat(e,l),u(e.globe)&&(e.globe.endFrame(t),e.globe.tilesLoaded||(e._renderRequested=!0)),i.endFrame()}function kx(e,t){try{t(e)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}function lct(e){return e._picking.updateMostDetailedRayPicks(e)}function uct(e){let t=e._frameState;b7.camera=t.camera,b7.cullingVolume=t.cullingVolume,e.primitives.updateForPass(t,b7)}function fct(e){let t=e._frameState;t.camera.canPreloadFlight()&&(T7.camera=e.preloadFlightCamera,T7.cullingVolume=e.preloadFlightCullingVolume,e.primitives.updateForPass(t,T7))}function dct(e){e.primitives.updateForPass(e._frameState,Iat)}function hct(e,t){e._removeTerrainProviderReadyListener=e._removeTerrainProviderReadyListener&&e._removeTerrainProviderReadyListener(),t.ready?u(e.globe)&&(e.globe.terrainProvider=t.provider):(e.globe.terrainProvider=void 0,e._removeTerrainProviderReadyListener=t.readyEvent.addEventListener((t=>{u(e)&&u(e.globe)&&(e.globe.terrainProvider=t),e._removeTerrainProviderReadyListener()})))}ki.prototype.render=function(e){this._preUpdate.raiseEvent(this,e);let t=this._frameState;t.newFrame=!1,u(e)||(e=J.now());let i=this._view.checkForCameraUpdates(this),n=!this.requestRenderMode||this._renderRequested||i||this._logDepthBufferDirty||this._hdrDirty||this.mode===te.MORPHING;if(!n&&u(this.maximumRenderTimeChange)&&u(this._lastRenderTime)){let t=Math.abs(J.secondsDifference(this._lastRenderTime,e));n=n||t>this.maximumRenderTimeChange}if(n){this._lastRenderTime=J.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,wme(this,P.incrementWrap(t.frameNumber,15e6,1),e),t.newFrame=!0}kx(this,rct),this.primitives.show&&(kx(this,lct),kx(this,uct),kx(this,fct),n||kx(this,dct)),this._postUpdate.raiseEvent(this,e),n&&(this._preRender.raiseEvent(this,e),t.creditDisplay.beginFrame(),kx(this,cct)),oct(this,n),kx(this,sct),tct(this),n&&(this._postRender.raiseEvent(this,e),t.creditDisplay.endFrame())},ki.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},ki.prototype.requestRender=function(){this._renderRequested=!0},ki.prototype.clampLineWidth=function(e){return Math.max(zt.minimumAliasedLineWidth,Math.min(e,zt.maximumAliasedLineWidth))},ki.prototype.pick=function(e,t,i){return this._picking.pick(this,e,t,i)},ki.prototype.pickPositionWorldCoordinates=function(e,t){return this._picking.pickPositionWorldCoordinates(this,e,t)},ki.prototype.pickPosition=function(e,t){return this._picking.pickPosition(this,e,t)},ki.prototype.drillPick=function(e,t,i,n){return this._picking.drillPick(this,e,t,i,n)},ki.prototype.pickFromRay=function(e,t,i){return this._picking.pickFromRay(this,e,t,i)},ki.prototype.drillPickFromRay=function(e,t,i,n){return this._picking.drillPickFromRay(this,e,t,i,n)},ki.prototype.pickFromRayMostDetailed=function(e,t,i){return this._picking.pickFromRayMostDetailed(this,e,t,i)},ki.prototype.drillPickFromRayMostDetailed=function(e,t,i,n){return this._picking.drillPickFromRayMostDetailed(this,e,t,i,n)},ki.prototype.sampleHeight=function(e,t,i){return this._picking.sampleHeight(this,e,t,i)},ki.prototype.clampToHeight=function(e,t,i,n){return this._picking.clampToHeight(this,e,t,i,n)},ki.prototype.sampleHeightMostDetailed=function(e,t,i){return this._picking.sampleHeightMostDetailed(this,e,t,i)},ki.prototype.clampToHeightMostDetailed=function(e,t,i){return this._picking.clampToHeightMostDetailed(this,e,t,i)},ki.prototype.cartesianToCanvasCoordinates=function(e,t){return $i.wgs84ToWindowCoordinates(this,e,t)},ki.prototype.completeMorph=function(){this._transitioner.completeMorph()},ki.prototype.morphTo2D=function(e){let t,i=this.globe;t=u(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=y(e,2),this._transitioner.morphTo2D(e,t)},ki.prototype.morphToColumbusView=function(e){let t,i=this.globe;t=u(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=y(e,2),this._transitioner.morphToColumbusView(e,t)},ki.prototype.morphTo3D=function(e){let t,i=this.globe;t=u(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=y(e,2),this._transitioner.morphTo3D(e,t)},ki.prototype.setTerrain=function(e){return hct(this,e),e},ki.prototype.isDestroyed=function(){return!1},ki.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this._removeTerrainProviderReadyListener=this._removeTerrainProviderReadyListener&&this._removeTerrainProviderReadyListener(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._picking=this._picking&&this._picking.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),u(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(let e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,le(this)};var tU=ki,_D="float interpolateByDistance(vec4 nearFarScalar, float distance)\n{\n    float startDistance = nearFarScalar.x;\n    float startValue = nearFarScalar.y;\n    float endDistance = nearFarScalar.z;\n    float endValue = nearFarScalar.w;\n    float t = clamp((distance - startDistance) / (endDistance - startDistance), 0.0, 1.0);\n    return mix(startValue, endValue, t);\n}\n\nvec3 getLightDirection(vec3 positionWC)\n{\n    float lightEnum = u_radiiAndDynamicAtmosphereColor.z;\n    vec3 lightDirection =\n        positionWC * float(lightEnum == 0.0) +\n        czm_lightDirectionWC * float(lightEnum == 1.0) +\n        czm_sunDirectionWC * float(lightEnum == 2.0);\n    return normalize(lightDirection);\n}\n\nvoid computeAtmosphereScattering(vec3 positionWC, vec3 lightDirection, out vec3 rayleighColor, out vec3 mieColor, out float opacity, out float underTranslucentGlobe)\n{\n    float ellipsoidRadiiDifference = czm_ellipsoidRadii.x - czm_ellipsoidRadii.z;\n\n    // Adjustment to the atmosphere radius applied based on the camera height.\n    float distanceAdjustMin = czm_ellipsoidRadii.x / 4.0;\n    float distanceAdjustMax = czm_ellipsoidRadii.x;\n    float distanceAdjustModifier = ellipsoidRadiiDifference / 2.0;\n    float distanceAdjust = distanceAdjustModifier * clamp((czm_eyeHeight - distanceAdjustMin) / (distanceAdjustMax - distanceAdjustMin), 0.0, 1.0);\n\n    // Since atmosphere scattering assumes the atmosphere is a spherical shell, we compute an inner radius of the atmosphere best fit \n    // for the position on the ellipsoid.\n    float radiusAdjust = (ellipsoidRadiiDifference / 4.0) + distanceAdjust;\n    float atmosphereInnerRadius = (length(czm_viewerPositionWC) - czm_eyeHeight) - radiusAdjust;\n\n    // Setup the primary ray: from the camera position to the vertex position.\n    vec3 cameraToPositionWC = positionWC - czm_viewerPositionWC;\n    vec3 cameraToPositionWCDirection = normalize(cameraToPositionWC);\n    czm_ray primaryRay = czm_ray(czm_viewerPositionWC, cameraToPositionWCDirection);\n\n    underTranslucentGlobe = 0.0;\n\n    // Brighten the sky atmosphere under the Earth's atmosphere when translucency is enabled.\n    #if defined(GLOBE_TRANSLUCENT)\n\n        // Check for intersection with the inner radius of the atmopshere.\n        czm_raySegment primaryRayEarthIntersect = czm_raySphereIntersectionInterval(primaryRay, vec3(0.0), atmosphereInnerRadius + radiusAdjust);\n        if (primaryRayEarthIntersect.start > 0.0 && primaryRayEarthIntersect.stop > 0.0) {\n            \n            // Compute position on globe.\n            vec3 direction = normalize(positionWC);\n            czm_ray ellipsoidRay = czm_ray(positionWC, -direction);\n            czm_raySegment ellipsoidIntersection = czm_rayEllipsoidIntersectionInterval(ellipsoidRay, vec3(0.0), czm_ellipsoidInverseRadii);\n            vec3 onEarth = positionWC - (direction * ellipsoidIntersection.start);\n\n            // Control the color using the camera angle.\n            float angle = dot(normalize(czm_viewerPositionWC), normalize(onEarth));\n\n            // Control the opacity using the distance from Earth.\n            opacity = interpolateByDistance(vec4(0.0, 1.0, czm_ellipsoidRadii.x, 0.0), length(czm_viewerPositionWC - onEarth));\n            vec3 horizonColor = vec3(0.1, 0.2, 0.3);\n            vec3 nearColor = vec3(0.0);\n\n            rayleighColor = mix(nearColor, horizonColor, exp(-angle) * opacity);\n            \n            // Set the traslucent flag to avoid alpha adjustment in computeFinalColor funciton.\n            underTranslucentGlobe = 1.0;\n            return;\n        }\n    #endif\n\n    computeScattering(\n        primaryRay,\n        length(cameraToPositionWC),\n        lightDirection,\n        atmosphereInnerRadius,\n        rayleighColor,\n        mieColor,\n        opacity\n    );\n\n    // Alter the opacity based on how close the viewer is to the ground.\n    // (0.0 = At edge of atmosphere, 1.0 = On ground)\n    float cameraHeight = czm_eyeHeight + atmosphereInnerRadius;\n    float atmosphereOuterRadius = atmosphereInnerRadius + ATMOSPHERE_THICKNESS;\n    opacity = clamp((atmosphereOuterRadius - cameraHeight) / (atmosphereOuterRadius - atmosphereInnerRadius), 0.0, 1.0);\n\n    // Alter alpha based on time of day (0.0 = night , 1.0 = day)\n    float nightAlpha = (u_radiiAndDynamicAtmosphereColor.z != 0.0) ? clamp(dot(normalize(positionWC), lightDirection), 0.0, 1.0) : 1.0;\n    opacity *= pow(nightAlpha, 0.5);\n}\n",nU="in vec3 v_outerPositionWC;\n\nuniform vec3 u_hsbShift;\n\n#ifndef PER_FRAGMENT_ATMOSPHERE\nin vec3 v_mieColor;\nin vec3 v_rayleighColor;\nin float v_opacity;\nin float v_translucent;\n#endif\n\nvoid main (void)\n{\n    vec3 lightDirection = getLightDirection(v_outerPositionWC);\n   \n    vec3 mieColor;\n    vec3 rayleighColor;\n    float opacity;\n    float translucent;\n\n    #ifdef PER_FRAGMENT_ATMOSPHERE\n        computeAtmosphereScattering(\n            v_outerPositionWC,\n            lightDirection,\n            rayleighColor,\n            mieColor,\n            opacity,\n            translucent\n        );\n    #else\n        mieColor = v_mieColor;\n        rayleighColor = v_rayleighColor;\n        opacity = v_opacity;\n        translucent = v_translucent;\n    #endif\n\n    vec4 color = computeAtmosphereColor(v_outerPositionWC, lightDirection, rayleighColor, mieColor, opacity);\n\n    #ifndef HDR\n        color.rgb = czm_acesTonemapping(color.rgb);\n        color.rgb = czm_inverseGamma(color.rgb);\n    #endif\n\n    #ifdef COLOR_CORRECT\n        // Convert rgb color to hsb\n        vec3 hsb = czm_RGBToHSB(color.rgb);\n        // Perform hsb shift\n        hsb.x += u_hsbShift.x; // hue\n        hsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0); // saturation\n        hsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0; // brightness\n        // Convert shifted hsb back to rgb\n        color.rgb = czm_HSBToRGB(hsb);\n    #endif\n\n    // For the parts of the sky atmosphere that are not behind a translucent globe,\n    // we mix in the default opacity so that the sky atmosphere still appears at distance.\n    // This is needed because the opacity in the sky atmosphere is initially adjusted based\n    // on the camera height.\n    if (translucent == 0.0) {\n        color.a = mix(color.b, 1.0, color.a) * smoothstep(0.0, 1.0, czm_morphTime);\n    }\n\n    out_FragColor = color;\n}\n",iU="in vec4 position;\n\nout vec3 v_outerPositionWC;\n\n#ifndef PER_FRAGMENT_ATMOSPHERE\nout vec3 v_mieColor;\nout vec3 v_rayleighColor;\nout float v_opacity;\nout float v_translucent;\n#endif\n\nvoid main(void)\n{\n    vec4 positionWC = czm_model * position;\n    vec3 lightDirection = getLightDirection(positionWC.xyz);\n\n    #ifndef PER_FRAGMENT_ATMOSPHERE\n        computeAtmosphereScattering(\n            positionWC.xyz,\n            lightDirection,\n            v_rayleighColor,\n            v_mieColor,\n            v_opacity,\n            v_translucent\n        );\n    #endif\n    \n    v_outerPositionWC = positionWC.xyz;\n    gl_Position = czm_modelViewProjection * position;\n}\n";function wC(e){e=y(e,ie.WGS84),this.show=!0,this.perFragmentAtmosphere=!1,this._ellipsoid=e;let t=h.multiplyByScalar(e.radii,1.025,new h);this._scaleMatrix=L.fromScale(t),this._modelMatrix=new L,this._command=new et({owner:this,modelMatrix:this._modelMatrix}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._flags=void 0,this.atmosphereLightIntensity=50,this.atmosphereRayleighCoefficient=new h(55e-7,13e-6,284e-7),this.atmosphereMieCoefficient=new h(21e-6,21e-6,21e-6),this.atmosphereRayleighScaleHeight=1e4,this.atmosphereMieScaleHeight=3200,this.atmosphereMieAnisotropy=.9,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new h;let i=new h;i.x=1.025*e.maximumRadius,i.y=e.maximumRadius,i.z=0,this._radiiAndDynamicAtmosphereColor=i;let n=this;this._command.uniformMap={u_radiiAndDynamicAtmosphereColor:function(){return n._radiiAndDynamicAtmosphereColor},u_hsbShift:function(){return n._hueSaturationBrightness.x=n.hueShift,n._hueSaturationBrightness.y=n.saturationShift,n._hueSaturationBrightness.z=n.brightnessShift,n._hueSaturationBrightness},u_atmosphereLightIntensity:function(){return n.atmosphereLightIntensity},u_atmosphereRayleighCoefficient:function(){return n.atmosphereRayleighCoefficient},u_atmosphereMieCoefficient:function(){return n.atmosphereMieCoefficient},u_atmosphereRayleighScaleHeight:function(){return n.atmosphereRayleighScaleHeight},u_atmosphereMieScaleHeight:function(){return n.atmosphereMieScaleHeight},u_atmosphereMieAnisotropy:function(){return n.atmosphereMieAnisotropy}}}Object.defineProperties(wC.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),wC.prototype.setDynamicAtmosphereColor=function(e,t){let i=e?t?2:1:0;this._radiiAndDynamicAtmosphereColor.z=i};var S7=new L;function mct(e){return!(P.equalsEpsilon(e.hueShift,0,P.EPSILON7)&&P.equalsEpsilon(e.saturationShift,0,P.EPSILON7)&&P.equalsEpsilon(e.brightnessShift,0,P.EPSILON7))}wC.prototype.update=function(e,t){if(!this.show)return;let i=e.mode;if(i!==te.SCENE3D&&i!==te.MORPHING||!e.passes.render)return;let n=L.fromRotationTranslation(e.context.uniformState.inverseViewRotation,h.ZERO,S7),r=L.multiplyTransformation(n,wo.Y_UP_TO_Z_UP,S7),o=L.multiply(this._scaleMatrix,r,S7);L.clone(o,this._modelMatrix);let a=e.context,s=mct(this),l=e.globeTranslucencyState.translucent,c=this.perFragmentAtmosphere||l||!u(t)||!t.show,d=this._command;if(!u(d.vertexArray)){let e=Ms.createGeometry(new Ms({radii:new h(1,1,1),slicePartitions:256,stackPartitions:256,vertexFormat:Pe.POSITION_ONLY}));d.vertexArray=ni.fromGeometry({context:a,geometry:e,attributeLocations:Fn.createAttributeLocations(e),bufferUsage:Be.STATIC_DRAW}),d.renderState=Ue.fromCache({cull:{enabled:!0,face:gi.FRONT},blending:ln.ALPHA_BLEND,depthMask:!1})}let p=s|c<<2|l<<3;if(p!==this._flags){this._flags=p;let e=[];s&&e.push("COLOR_CORRECT"),c&&e.push("PER_FRAGMENT_ATMOSPHERE"),l&&e.push("GLOBE_TRANSLUCENT");let t=new He({defines:e,sources:[Gg,_D,iU]}),i=new He({defines:e,sources:[Gg,_D,nU]});this._spSkyAtmosphere=Kt.fromCache({context:a,vertexShaderSource:t,fragmentShaderSource:i}),d.shaderProgram=this._spSkyAtmosphere}return d},wC.prototype.isDestroyed=function(){return!1},wC.prototype.destroy=function(){let e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyAtmosphere=this._spSkyAtmosphere&&this._spSkyAtmosphere.destroy(),le(this)};var oU=wC;function pct(e,t,i){let n={flipY:!0,skipColorSpaceConversion:i,preferImageBitmap:!0},r=[ve.createIfNeeded(t.positiveX).fetchImage(n),ve.createIfNeeded(t.negativeX).fetchImage(n),ve.createIfNeeded(t.positiveY).fetchImage(n),ve.createIfNeeded(t.negativeY).fetchImage(n),ve.createIfNeeded(t.positiveZ).fetchImage(n),ve.createIfNeeded(t.negativeZ).fetchImage(n)];return Promise.all(r).then((function(t){return new bc({context:e,source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}})}))}var rU=pct,sU="uniform samplerCube u_cubeMap;\n\nin vec3 v_texCoord;\n\nvoid main()\n{\n    vec4 color = czm_textureCube(u_cubeMap, normalize(v_texCoord));\n    out_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n}\n",aU="in vec3 position;\n\nout vec3 v_texCoord;\n\nvoid main()\n{\n    vec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n    gl_Position = czm_projection * vec4(p, 1.0);\n    v_texCoord = position.xyz;\n}\n";function cU(e){this.sources=e.sources,this._sources=void 0,this.show=y(e.show,!0),this._command=new et({modelMatrix:L.clone(L.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}cU.prototype.update=function(e,t){let i=this;if(!this.show||e.mode!==te.SCENE3D&&e.mode!==te.MORPHING||!e.passes.render)return;let n=e.context;if(this._sources!==this.sources){this._sources=this.sources;let e=this.sources;"string"==typeof e.positiveX?rU(n,this._sources).then((function(e){i._cubeMap=i._cubeMap&&i._cubeMap.destroy(),i._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new bc({context:n,source:e}))}let r=this._command;if(!u(r.vertexArray)){r.uniformMap={u_cubeMap:function(){return i._cubeMap}};let e=Dl.createGeometry(Dl.fromDimensions({dimensions:new h(2,2,2),vertexFormat:Pe.POSITION_ONLY})),t=this._attributeLocations=Fn.createAttributeLocations(e);r.vertexArray=ni.fromGeometry({context:n,geometry:e,attributeLocations:t,bufferUsage:Be.STATIC_DRAW}),r.renderState=Ue.fromCache({blending:ln.ALPHA_BLEND})}if(!u(r.shaderProgram)||this._useHdr!==t){let e=new He({defines:[t?"HDR":""],sources:[sU]});r.shaderProgram=Kt.fromCache({context:n,vertexShaderSource:aU,fragmentShaderSource:e,attributeLocations:this._attributeLocations}),this._useHdr=t}return u(this._cubeMap)?r:void 0},cU.prototype.isDestroyed=function(){return!1},cU.prototype.destroy=function(){let e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),le(this)};var lU=cU;function xf(e,t,i,n,r,o,a){this.children=void 0,this.parent=r,this.level=e,this.x=t,this.y=i,this.z=n,this.keyframeNodes=[],this.renderableKeyframeNodes=[],this.renderableKeyframeNodeLerp=0,this.renderableKeyframeNodePrevious=void 0,this.renderableKeyframeNodeNext=void 0,this.orientedBoundingBox=new Pn,this.approximateVoxelSize=0,this.screenSpaceError=0,this.visitedFrameNumber=-1,this.computeBoundingVolumes(o,a)}var _ct=new h;xf.prototype.computeBoundingVolumes=function(e,t){this.orientedBoundingBox=e.computeOrientedBoundingBoxForTile(this.level,this.x,this.y,this.z,this.orientedBoundingBox);let i=$.getScale(this.orientedBoundingBox.halfAxes,_ct),n=2*h.maximumComponent(i);this.approximateVoxelSize=n/h.minimumComponent(t)},xf.prototype.constructChildNodes=function(e,t){let{level:i,x:n,y:r,z:o}=this,a=2*n,s=2*r,l=2*o,u=s+1,c=a+1,h=l+1,d=i+1,p=[[d,a,s,l],[d,c,s,l],[d,a,u,l],[d,c,u,l],[d,a,s,h],[d,c,s,h],[d,a,u,h],[d,c,u,h]];this.children=p.map((([i,n,r,o])=>new xf(i,n,r,o,this,e,t)))},xf.prototype.visibility=function(e,t){let i=this.orientedBoundingBox;return e.cullingVolume.computeVisibilityWithPlaneMask(i,t)},xf.prototype.computeScreenSpaceError=function(e,t){let i=this.orientedBoundingBox,n=Math.sqrt(i.distanceSquaredTo(e));n=Math.max(n,P.EPSILON7);let r=t*(this.approximateVoxelSize/n);this.screenSpaceError=r};var Ome={keyframe:0};function gD(e,t){return Ome.keyframe=e,Eo(t,Ome,Qi.searchComparator)}function gct(e,t){let i=gD(e,t);return i<0?P.clamp(~i-1,0,t.length-1):i}function Rme(e,t){return e*Math.exp(4*e)+t*(t>=0?1:-200)}xf.prototype.computeSurroundingRenderableKeyframeNodes=function(e){let t,i,n=this,r=n.level,o=Math.floor(e),a=Math.ceil(e),s=+Number.MAX_VALUE,l=+Number.MAX_VALUE;for(;u(n);){let{renderableKeyframeNodes:e}=n;if(e.length>=1){let u=gct(o,e),c=e[u],h=e[a===o||o<c.keyframe?u:Math.min(u+1,e.length-1)],d=o-c.keyframe,p=Rme(r-n.level,d);p<s&&(s=p,t=c);let f=h.keyframe-a,m=Rme(r-n.level,f);if(m<l&&(l=m,i=h),0===d&&0===f)break}n=n.parent}if(this.renderableKeyframeNodePrevious=t,this.renderableKeyframeNodeNext=i,!u(t)||!u(i))return;let c=t.keyframe,h=i.keyframe;this.renderableKeyframeNodeLerp=c===h?0:P.clamp((e-c)/(h-c),0,1)},xf.prototype.isVisited=function(e){return this.visitedFrameNumber===e},xf.prototype.createKeyframeNode=function(e){let t=gD(e,this.keyframeNodes);if(t<0){t=~t;let i=new Qi(this,e);this.keyframeNodes.splice(t,0,i)}},xf.prototype.destroyKeyframeNode=function(e,t){let i=e.keyframe,n=gD(i,this.keyframeNodes);if(n<0)throw new de("Keyframe node does not exist.");if(this.keyframeNodes.splice(n,1),-1!==e.megatextureIndex){for(let i=0;i<t.length;i++)t[i].remove(e.megatextureIndex);let n=gD(i,this.renderableKeyframeNodes);if(n<0)throw new de("Renderable keyframe node does not exist.");this.renderableKeyframeNodes.splice(n,1)}e.spatialNode=void 0,e.state=Qi.LoadState.UNLOADED,e.metadatas={},e.megatextureIndex=-1,e.priority=-Number.MAX_VALUE,e.highPriorityFrameNumber=-1},xf.prototype.addKeyframeNodeToMegatextures=function(e,t){if(e.state!==Qi.LoadState.RECEIVED||-1!==e.megatextureIndex||e.metadatas.length!==t.length)throw new de("Keyframe node cannot be added to megatexture");for(let i=0;i<t.length;i++){let n=t[i];e.megatextureIndex=n.add(e.metadatas[i]),e.metadatas[i]=void 0}e.state=Qi.LoadState.LOADED;let i=this.renderableKeyframeNodes,n=gD(e.keyframe,i);if(n>=0)throw new de("Keyframe already renderable");n=~n,i.splice(n,0,e)},xf.prototype.isRenderable=function(e){let t=this.renderableKeyframeNodePrevious,i=this.renderableKeyframeNodeNext,n=this.level;return u(t)&&u(i)&&(t.spatialNode.level===n||i.spatialNode.level===n)&&this.visitedFrameNumber===e};var uU=xf;function w7(e){e=y(e,1),this._radius=y(e,1)}Object.defineProperties(w7.prototype,{radius:{get:function(){return this._radius},set:function(e){this._radius=e}}}),w7.prototype.emit=function(e){let t=P.randomBetween(0,P.TWO_PI),i=P.randomBetween(0,P.PI),n=P.randomBetween(0,this._radius),r=n*Math.cos(t)*Math.sin(i),o=n*Math.sin(t)*Math.sin(i),a=n*Math.cos(i);e.position=h.fromElements(r,o,a,e.position),e.velocity=h.normalize(e.position,e.velocity)};var Mme=w7;function yD(){}yD.prototype.evaluate=function(e,t){de.throwInstantiationError()},yD.prototype.evaluateColor=function(e,t){de.throwInstantiationError()},yD.prototype.getShaderFunction=function(e,t,i,n){de.throwInstantiationError()},yD.prototype.getVariables=function(){de.throwInstantiationError()};var Lme=yD,fU="uniform sampler2D u_texture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    vec4 color = texture(u_texture, v_textureCoordinates);\n    out_FragColor = czm_gammaCorrect(color);\n}\n",dU="uniform float u_radiusTS;\n\nin vec2 v_textureCoordinates;\n\nvec2 rotate(vec2 p, vec2 direction)\n{\n    return vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\n\nvec4 addBurst(vec2 position, vec2 direction, float lengthScalar)\n{\n    vec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\n    float radius = length(rotatedPosition) * lengthScalar;\n    float burst = 1.0 - smoothstep(0.0, 0.55, radius);\n    return vec4(burst);\n}\n\nvoid main()\n{\n    float lengthScalar = 2.0 / sqrt(2.0);\n    vec2 position = v_textureCoordinates - vec2(0.5);\n    float radius = length(position) * lengthScalar;\n    float surface = step(radius, u_radiusTS);\n    vec4 color = vec4(vec2(1.0), surface + 0.2, surface);\n\n    float glow = 1.0 - smoothstep(0.0, 0.55, radius);\n    color.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\n\n    vec4 burst = vec4(0.0);\n\n    // The following loop has been manually unrolled for speed, to\n    // avoid sin() and cos().\n    //\n    //for (float i = 0.4; i < 3.2; i += 1.047) {\n    //    vec2 direction = vec2(sin(i), cos(i));\n    //    burst += 0.4 * addBurst(position, direction, lengthScalar);\n    //\n    //    direction = vec2(sin(i - 0.08), cos(i - 0.08));\n    //    burst += 0.3 * addBurst(position, direction, lengthScalar);\n    //}\n\n    burst += 0.4 * addBurst(position, vec2(0.38942,  0.92106), lengthScalar);  // angle == 0.4\n    burst += 0.4 * addBurst(position, vec2(0.99235,  0.12348), lengthScalar);  // angle == 0.4 + 1.047\n    burst += 0.4 * addBurst(position, vec2(0.60327, -0.79754), lengthScalar);  // angle == 0.4 + 1.047 * 2.0\n\n    burst += 0.3 * addBurst(position, vec2(0.31457,  0.94924), lengthScalar);  // angle == 0.4 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.97931,  0.20239), lengthScalar);  // angle == 0.4 + 1.047 - 0.08\n    burst += 0.3 * addBurst(position, vec2(0.66507, -0.74678), lengthScalar);  // angle == 0.4 + 1.047 * 2.0 - 0.08\n\n    // End of manual loop unrolling.\n\n    color += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\n\n    out_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n",hU="in vec2 direction;\n\nuniform float u_size;\n\nout vec2 v_textureCoordinates;\n\nvoid main() \n{\n    vec4 position;\n    if (czm_morphTime == 1.0)\n    {\n        position = vec4(czm_sunPositionWC, 1.0);\n    }\n    else\n    {\n        position = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n    }\n    \n    vec4 positionEC = czm_view * position;\n    vec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\n    \n    vec2 halfSize = vec2(u_size * 0.5);\n    halfSize *= ((direction * 2.0) - 1.0);\n    \n    gl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\n    \n    v_textureCoordinates = direction;\n}\n";function bD(){this.show=!0,this._drawCommand=new et({primitiveType:Ne.TRIANGLES,boundingVolume:new se,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new se,this._boundingVolume2D=new se,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;let e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object.defineProperties(bD.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var yct=new U,xct=new U,bct=new oe,xD=new oe;bD.prototype.update=function(e,t,i){if(!this.show)return;let n=e.mode;if(n===te.SCENE2D||n===te.MORPHING||!e.passes.render)return;let r=e.context,o=t.viewport.width,a=t.viewport.height;if(!u(this._texture)||o!==this._drawingBufferWidth||a!==this._drawingBufferHeight||this._glowFactorDirty||i!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=o,this._drawingBufferHeight=a,this._glowFactorDirty=!1,this._useHdr=i;let e=Math.max(o,a);e=Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))-2),e=Math.max(1,e);let t=i?r.halfFloatingPointTexture?Ye.HALF_FLOAT:Ye.FLOAT:Ye.UNSIGNED_BYTE;this._texture=new Ot({context:r,width:e,height:e,pixelFormat:rt.RGBA,pixelDatatype:t}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;let n=this,s={u_radiusTS:function(){return n._radiusTS}};this._commands.computeCommand=new od({fragmentShaderSource:dU,outputTexture:this._texture,uniformMap:s,persists:!1,owner:this,postExecute:function(){n._commands.computeCommand=void 0}})}let s=this._drawCommand;if(!u(s.vertexArray)){let e={direction:0},t=new Uint8Array(8);t[0]=0,t[1]=0,t[2]=255,t[3]=0,t[4]=255,t[5]=255,t[6]=0,t[7]=255;let i=ut.createVertexBuffer({context:r,typedArray:t,usage:Be.STATIC_DRAW}),n=[{index:e.direction,vertexBuffer:i,componentsPerAttribute:2,normalize:!0,componentDatatype:X.UNSIGNED_BYTE}],o=ut.createIndexBuffer({context:r,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:Be.STATIC_DRAW,indexDatatype:ke.UNSIGNED_SHORT});s.vertexArray=new ni({context:r,attributes:n,indexBuffer:o}),s.shaderProgram=Kt.fromCache({context:r,vertexShaderSource:hU,fragmentShaderSource:fU,attributeLocations:e}),s.renderState=Ue.fromCache({blending:ln.ALPHA_BLEND}),s.uniformMap=this._uniformMap}let l=r.uniformState.sunPositionWC,c=r.uniformState.sunPositionColumbusView,d=this._boundingVolume,p=this._boundingVolume2D;h.clone(l,d.center),p.center.x=c.z,p.center.y=c.x,p.center.z=c.y,d.radius=P.SOLAR_RADIUS+P.SOLAR_RADIUS*this._glowLengthTS,p.radius=d.radius,n===te.SCENE3D?se.clone(d,s.boundingVolume):n===te.COLUMBUS_VIEW&&se.clone(p,s.boundingVolume);let f=$i.computeActualWgs84Position(e,l,xD),m=h.magnitude(h.subtract(f,e.camera.position,xD)),_=r.uniformState.projection,g=bct;g.x=0,g.y=0,g.z=-m,g.w=1;let y=L.multiplyByVector(_,g,xD),v=$i.clipToGLWindowCoordinates(t.viewport,y,yct);g.x=P.SOLAR_RADIUS;let b=L.multiplyByVector(_,g,xD),A=$i.clipToGLWindowCoordinates(t.viewport,b,xct);return this._size=U.magnitude(U.subtract(A,v,xD)),this._size=2*this._size*(1+2*this._glowLengthTS),this._size=Math.ceil(this._size),this._commands},bD.prototype.isDestroyed=function(){return!1},bD.prototype.destroy=function(){let e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),le(this)};var mU=bD;function pU(e){this._ready=!1,this._provider=void 0,this._errorEvent=new pe,this._readyEvent=new pe,Act(this,e)}function Tct(e,t){e.numberOfListeners>0?e.raiseEvent(t):console.error(t)}async function Act(e,t){let i;try{i=await Promise.resolve(t),e._provider=i,e._ready=!0,e._readyEvent.raiseEvent(i)}catch(t){Tct(e._errorEvent,t)}}Object.defineProperties(pU.prototype,{errorEvent:{get:function(){return this._errorEvent}},readyEvent:{get:function(){return this._readyEvent}},ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}}}),pU.fromWorldTerrain=function(e){return new pU(uT(e))};var _U=pU;function vC(){}vC.prototype.boundingVolume=void 0,vC.prototype.boundingSphere=void 0,vC.prototype.distanceToCamera=function(e){de.throwInstantiationError()},vC.prototype.intersectPlane=function(e){de.throwInstantiationError()},vC.prototype.createDebugVolume=function(e){de.throwInstantiationError()};var Nme=vC;function TD(e){e=y(e,y.EMPTY_OBJECT),this._tilingScheme=u(e.tilingScheme)?e.tilingScheme:new Ui({ellipsoid:e.ellipsoid}),this._color=y(e.color,z.YELLOW),this._errorEvent=new pe,this._tileWidth=y(e.tileWidth,256),this._tileHeight=y(e.tileHeight,256),this._defaultAlpha=void 0,this._defaultNightAlpha=void 0,this._defaultDayAlpha=void 0,this._defaultBrightness=void 0,this._defaultContrast=void 0,this._defaultHue=void 0,this._defaultSaturation=void 0,this._defaultGamma=void 0,this._defaultMinificationFilter=void 0,this._defaultMagnificationFilter=void 0}Object.defineProperties(TD.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),TD.prototype.getTileCredits=function(e,t,i){},TD.prototype.requestImage=function(e,t,i,n){let r=document.createElement("canvas");r.width=256,r.height=256;let o=r.getContext("2d"),a=this._color.toCssColorString();return o.strokeStyle=a,o.lineWidth=2,o.strokeRect(1,1,255,255),o.font="bold 25px Arial",o.textAlign="center",o.fillStyle=a,o.fillText(`L: ${i}`,124,86),o.fillText(`X: ${e}`,124,136),o.fillText(`Y: ${t}`,124,186),Promise.resolve(r)},TD.prototype.pickFeatures=function(e,t,i,n,r){};var gU=TD;function v7(e){de.throwInstantiationError()}v7.prototype.isReady=de.throwInstantiationError,v7.prototype.shouldDiscardImage=de.throwInstantiationError;var Fme=v7,Cct={START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3},Bme=Object.freeze(Cct);function Ux(e){e=y(e,y.EMPTY_OBJECT),this.show=y(e.show,!0),this.modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this.shadows=y(e.shadows,yn.ENABLED),this.maximumMemoryUsage=y(e.maximumMemoryUsage,256),this.shading=new dp(e.shading),this.style=e.style,this.frameFailed=new pe,this.frameChanged=new pe,this._clock=e.clock,this._intervals=e.intervals,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._pointCloudEyeDomeLighting=new Ag,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=new Array(5).fill(0),this._runningAverage=0}function Ect(e){return`uniform vec4 czm_pickColor;\n${e}`}function Sct(e){return function(t){return gt(t,{czm_pickColor:function(){return e._pickId.color}})}}function wct(){return"czm_pickColor"}Object.defineProperties(Ux.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){ys.setOwner(e,this,"_clippingPlanes")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if(u(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}}}),Ux.prototype.makeStyleDirty=function(){this._styleDirty=!0},Ux.prototype._getAverageLoadTime=function(){return 0===this._runningLength?.05:this._runningAverage};var vct=new J;function I7(e){let t=e._clock,i=t.canAnimate&&t.shouldAnimate,n=t.multiplier;return i?n:0}function Vx(e,t){return e._intervals.indexOf(t.start)}function Dct(e,t){let i=e._intervals,n=e._clock,r=I7(e);if(0===r)return;let o=e._getAverageLoadTime(),a=J.addSeconds(n.currentTime,o*r,vct),s=i.indexOf(a);return s===Vx(e,t)&&(r>=0?++s:--s),i.get(s)}function Ict(e){let t=e._intervals,i=e._clock.currentTime,n=t.indexOf(i);return t.get(n)}function Pct(e,t,i){let n=I7(e),r=Vx(e,t),o=Vx(e,i);return n>=0?r>=o:r<=o}function Vme(e,t){return function(i){let n=u(i.message)?i.message:i.toString();e.frameFailed.numberOfListeners>0?e.frameFailed.raiseEvent({uri:t,message:n}):(console.log(`A frame failed to load: ${t}`),console.log(`Error: ${n}`))}}function Oct(e,t,i){let n=Vx(e,t),r=e._frames,o=r[n];if(!u(o)){let a=t.data.transform,s=u(a)?L.fromArray(a):void 0,l=t.data.uri;o={pointCloud:void 0,transform:s,timestamp:_i(),sequential:!0,ready:!1,touchedFrameNumber:i.frameNumber,uri:l},r[n]=o,ve.fetchArrayBuffer({url:l}).then((function(t){o.pointCloud=new lV({arrayBuffer:t,cull:!0,fragmentShaderLoaded:Ect,uniformMapLoaded:Sct(e),pickIdLoaded:wct})})).catch(Vme(e,l))}return o}function Rct(e,t){e._runningSum+=t,e._runningSum-=e._runningSamples[e._runningIndex],e._runningSamples[e._runningIndex]=t,e._runningLength=Math.min(e._runningLength+1,e._runningSamples.length),e._runningIndex=(e._runningIndex+1)%e._runningSamples.length,e._runningAverage=e._runningSum/e._runningLength}function Mct(e,t,i,n){t.touchedFrameNumber<n.frameNumber-1&&(t.sequential=!1);let r=t.pointCloud;if(u(r)&&!t.ready){let o=n.commandList,a=o.length;if(Ume(e,t,i,n),r.ready&&(t.ready=!0,e._totalMemoryUsageInBytes+=r.geometryByteLength,o.length=a,t.sequential)){Rct(e,(_i()-t.timestamp)/1e3)}}t.touchedFrameNumber=n.frameNumber}var Lct=new L;function Nct(e,t){let i=e.shading;return u(i)&&u(i.baseResolution)?i.baseResolution:u(t.boundingSphere)?P.cbrt(t.boundingSphere.volume()/t.pointsLength):0}function Fct(e){let t=e.shading;return u(t)&&u(t.maximumAttenuation)?t.maximumAttenuation:10}var Bct=new dp;function Ume(e,t,i,n){let r=y(e.shading,Bct),o=t.pointCloud,a=y(t.transform,L.IDENTITY);o.modelMatrix=L.multiplyTransformation(e.modelMatrix,a,Lct),o.style=e.style,o.time=i.timeSinceLoad,o.shadows=e.shadows,o.clippingPlanes=e._clippingPlanes,o.isClipped=i.isClipped,o.attenuation=r.attenuation,o.backFaceCulling=r.backFaceCulling,o.normalShading=r.normalShading,o.geometricError=Nct(e,o),o.geometricErrorScale=r.geometricErrorScale,o.maximumAttenuation=Fct(e);try{o.update(n)}catch(i){Vme(e,t.uri)(i)}t.touchedFrameNumber=n.frameNumber}function D7(e,t,i,n){Mct(e,Oct(e,t,n),i,n)}function kct(e){return function(t){return t.touchedFrameNumber<e.frameNumber}}function zme(e,t){let i=e._frames,n=i.length;for(let r=0;r<n;++r){let n=i[r];if(u(n)&&(!u(t)||t(n))){let t=n.pointCloud;n.ready&&(e._totalMemoryUsageInBytes-=t.geometryByteLength),u(t)&&t.destroy(),n===e._lastRenderedFrame&&(e._lastRenderedFrame=void 0),i[r]=void 0}}}function Vct(e,t){let i=Vx(e,t),n=e._frames[i];if(u(n)&&n.ready)return n}function kme(e,t,i,n,r){return!!u(i)&&(!!i.ready||(D7(e,t,n,r),i.ready))}function Uct(e,t,i,n,r){let o,a,s,l=e._intervals,u=e._frames,c=Vx(e,i),h=Vx(e,t);if(c>=h){for(o=c;o>=h;--o)if(a=l.get(o),s=u[o],kme(e,a,s,n,r))return a}else for(o=c;o<=h;++o)if(a=l.get(o),s=u[o],kme(e,a,s,n,r))return a;return t}function zct(e,t,i){let n=e._frames,r=n.length;for(let e=0;e<r;++e){let r=n[e];u(r)&&u(r.pointCloud)&&(r.pointCloud.clippingPlanesDirty=t,r.pointCloud.styleDirty=i)}}var DC={timeSinceLoad:0,isClipped:!1,clippingPlanesDirty:!1};Ux.prototype.update=function(e){if(e.mode===te.MORPHING||!this.show)return;u(this._pickId)||(this._pickId=e.context.createPickId({primitive:this})),u(this._loadTimestamp)||(this._loadTimestamp=J.clone(e.time));let t=Math.max(1e3*J.secondsDifference(e.time,this._loadTimestamp),0),i=this._clippingPlanes,n=0,r=!1,o=u(i)&&i.enabled;o&&(i.update(e),n=i.clippingPlanesState),this._clippingPlanesState!==n&&(this._clippingPlanesState=n,r=!0);let a=this._styleDirty;this._styleDirty=!1,(r||a)&&zct(this,r,a),DC.timeSinceLoad=t,DC.isClipped=o;let s=this.shading,l=this._pointCloudEyeDomeLighting,c=e.commandList,h=c.length,d=this._previousInterval,p=this._nextInterval,f=Ict(this);if(!u(f))return;let m=!1,_=I7(this),g=0===_;_!==this._clockMultiplier&&(m=!0,this._clockMultiplier=_),(!u(d)||g)&&(d=f),(!u(p)||m||Pct(this,f,p))&&(p=Dct(this,f)),d=Uct(this,d,f,DC,e);let y=Vct(this,d);u(y)||(D7(this,d,DC,e),y=this._lastRenderedFrame),u(y)&&Ume(this,y,DC,e),u(p)&&D7(this,p,DC,e);let v=this;u(y)&&!u(this._lastRenderedFrame)&&e.afterRender.push((function(){return!0})),u(y)&&y!==this._lastRenderedFrame&&v.frameChanged.numberOfListeners>0&&e.afterRender.push((function(){return v.frameChanged.raiseEvent(v),!0})),this._previousInterval=d,this._nextInterval=p,this._lastRenderedFrame=y,this._totalMemoryUsageInBytes>1024*this.maximumMemoryUsage*1024&&zme(this,kct(e));let b=c.length-h;u(s)&&s.attenuation&&s.eyeDomeLighting&&b>0&&l.update(e,h,s,this.boundingSphere)},Ux.prototype.isDestroyed=function(){return!1},Ux.prototype.destroy=function(){return zme(this),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),le(this)};var AD=Ux,yU="\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    czm_materialInput materialInput;\n    \n    materialInput.s = v_textureCoordinates.s;\n    materialInput.st = v_textureCoordinates;\n    materialInput.str = vec3(v_textureCoordinates, 0.0);\n    materialInput.normalEC = vec3(0.0, 0.0, -1.0);\n    \n    czm_material material = czm_getMaterial(materialInput);\n\n    out_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n";function xU(e,t){this.show=!0,u(e)||(e=new qe),this.rectangle=qe.clone(e),u(t)||(t=Wi.fromType(Wi.ColorType,{color:new z(1,1,1,1)})),this.material=t,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}xU.prototype.update=function(e){if(!this.show)return;let t=this._rs;if((!u(t)||!qe.equals(t.viewport,this.rectangle))&&(this._rs=Ue.fromCache({blending:ln.ALPHA_BLEND,viewport:this.rectangle})),e.passes.render){let t=e.context;if(this._material!==this.material||!u(this._overlayCommand)){this._material=this.material,u(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();let e=new He({sources:[this._material.shaderSource,yU]});this._overlayCommand=t.createViewportQuadCommand(e,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=Ee.OVERLAY}this._material.update(t),this._overlayCommand.renderState=this._rs,this._overlayCommand.uniformMap=this._material._uniforms,e.commandList.push(this._overlayCommand)}},xU.prototype.isDestroyed=function(){return!1},xU.prototype.destroy=function(){return u(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),le(this)};var Hme=xU;function ey(e,t,i,n,r,o,a){this._primitive=e;let s=n.length;this.megatextures=new Array(s);for(let e=0;e<s;e++){let o=n[e],s=Gt.getComponentCount(o),l=r[e];this.megatextures[e]=new Xv(t,i,s,l,a)}let l=this.megatextures[0].maximumTileCount;this._simultaneousRequestCount=0,this._debugPrint=!1,this._frameNumber=0;let u=e._shape;this.rootNode=new uU(0,0,0,0,void 0,u,i),this._priorityQueue=new pT({maximumLength:l,comparator:Qi.priorityComparator}),this._highPriorityKeyframeNodes=new Array(l),this._keyframeNodesInMegatexture=new Array(l),this._keyframeCount=o,this._sampleCount=void 0,this._keyframeLocation=0,this._binaryTreeKeyframeWeighting=new Array(o);let c=this._binaryTreeKeyframeWeighting;c[0]=0,c[o-1]=0,P7(c,1,o-2,0);let h=2048,d=Math.floor(h/9),p=Math.ceil(l/d);this.internalNodeTexture=new Ot({context:t,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,flipY:!1,width:h,height:p,sampler:new un({minificationFilter:an.NEAREST,magnificationFilter:wi.NEAREST})}),this.internalNodeTilesPerRow=d,this.internalNodeTexelSizeUv=new U(1/h,1/p),this.leafNodeTexture=void 0,this.leafNodeTilesPerRow=void 0,this.leafNodeTexelSizeUv=new U}function P7(e,t,i,n){if(t>i)return;let r=Math.floor((t+i)/2);e[r]=n,P7(e,t,r-1,n+1),P7(e,r+1,i,n+1)}function Gme(e,t){let i=e._primitive,n=i._shape,r=i._provider.dimensions;if(t.computeBoundingVolumes(n,r),u(t.children))for(let i=0;i<8;i++){Gme(e,t.children[i])}}function Hct(e,t){if(e._simultaneousRequestCount>=ey.simultaneousRequestCountMaximum)return;let i=e._primitive,n=i._provider;let{keyframe:r,spatialNode:o}=t,a=n.requestData({tileLevel:o.level,tileX:o.x,tileY:o.y,tileZ:o.z,keyframe:r});u(a)?(e._simultaneousRequestCount++,t.state=Qi.LoadState.RECEIVING,a.then((function(n){e._simultaneousRequestCount--;let r=i._provider.types.length;if(u(n))if(n===Qi.LoadState.FAILED)t.state=Qi.LoadState.FAILED;else if(Array.isArray(n)&&n.length===r){let i=e.megatextures;for(let e=0;e<r;e++){let{voxelCountPerTile:r,channelCount:o}=i[e],{x:a,y:s,z:l}=r,u=a*s*l,c=n[e],h=u*o;if(c.length!==h){t.state=Qi.LoadState.FAILED;break}t.metadatas[e]=c,t.state=Qi.LoadState.RECEIVED}}else t.state=Qi.LoadState.FAILED;else t.state=Qi.LoadState.UNAVAILABLE})).catch((function(){e._simultaneousRequestCount--,t.state=Qi.LoadState.FAILED}))):t.state=Qi.LoadState.FAILED}function Gct(e){return e/(1+e)}function Wct(e,t){let i=e._frameNumber,n=e._primitive,r=n._shape,{dimensions:o}=n,a=n.screenSpaceError,s=e._priorityQueue,l=e._keyframeLocation,c=e._keyframeCount,h=e.rootNode,{camera:d,context:p,pixelRatio:f}=t,{positionWC:m,frustum:_}=d,g=p.drawingBufferHeight/f/_.sseDenominator;function y(t,i,n){let r=Math.min(Math.abs(i-t),Math.abs(i-n)),o=Math.max(t,c-n-1,1),a=Math.pow(1-r/o,4),s=Math.exp(-e._binaryTreeKeyframeWeighting[i]);return P.lerp(s,a,.15+.85*a)}s.reset(),function e(n,h){if(n.computeScreenSpaceError(m,g),(h=n.visibility(t,h))===ns.MASK_OUTSIDE)return;n.visitedFrameNumber=i;let d=P.clamp(Math.floor(l),0,c-2),p=d+1;if(1===c)n.createKeyframeNode(0);else if(n.keyframeNodes.length!==c)for(let e=0;e<c;e++)n.createKeyframeNode(e);let f=Gct(n.screenSpaceError),_=!1,v=n.keyframeNodes;for(let e=0;e<v.length;e++){let t=v[e];t.priority=10*f+y(d,t.keyframe,p),t.state!==Qi.LoadState.UNAVAILABLE&&t.state!==Qi.LoadState.FAILED&&t.priority!==-Number.MAX_VALUE&&s.insert(t),t.state===Qi.LoadState.LOADED&&(_=!0)}if(n.screenSpaceError<a||!_)n.children=void 0;else{u(n.children)||n.constructChildNodes(r,o);for(let t=0;t<8;t++){e(n.children[t],h)}}}(h,ns.MASK_INDETERMINATE);let v,b=e._highPriorityKeyframeNodes,A=0;for(;s.length>0;)v=s.removeMaximum(),v.highPriorityFrameNumber=i,b[A]=v,A++;let T=e._keyframeNodesInMegatexture,E=e.megatextures[0],C=E.occupiedCount;T.length=C,T.sort((function(e,t){return e.highPriorityFrameNumber===t.highPriorityFrameNumber?t.priority-e.priority:t.highPriorityFrameNumber-e.highPriorityFrameNumber}));let x=0,S=0;for(let t=0;t<A;t++)if(v=b[t],v.state!==Qi.LoadState.LOADED&&void 0!==v.spatialNode&&(v.state===Qi.LoadState.UNLOADED&&Hct(e,v),v.state===Qi.LoadState.RECEIVED)){let t=0;if(E.isFull()){t=C-1-x,x++;let i=T[t];i.spatialNode.destroyKeyframeNode(i,e.megatextures)}else t=C+S,S++;v.spatialNode.addKeyframeNodeToMegatextures(v,e.megatextures),T[t]=v}}function jct(e,t,i,n){let r=e._keyframeCount,o=e.rootNode,a=Object.keys(Qi.LoadState).length,s=new Array(a),l=new Array(a),c=0;for(let e=0;e<a;e++){let t=new Array(r);s[e]=t;for(let e=0;e<r;e++)t[e]=0;l[e]=0}!function e(t){let i=t.keyframeNodes;for(let e=0;e<i.length;e++){let t=i[e],n=t.keyframe,r=t.state;s[r][n]+=1,l[r]+=1,c++}if(u(t.children))for(let i=0;i<8;i++){e(t.children[i])}}(o);let h=`KEYFRAMES: ${s[Qi.LoadState.LOADED]}`,d=`UNLOADED: ${l[Qi.LoadState.UNLOADED]} | RECEIVING: ${l[Qi.LoadState.RECEIVING]} | RECEIVED: ${l[Qi.LoadState.RECEIVED]} | LOADED: ${l[Qi.LoadState.LOADED]} | FAILED: ${l[Qi.LoadState.FAILED]} | UNAVAILABLE: ${l[Qi.LoadState.UNAVAILABLE]} | TOTAL: ${c}`,p=`LOAD: ${Math.round(100*t)/100} | OCT: ${Math.round(100*i)/100} | ALL: ${Math.round(100*n)/100}`;console.log(`${h} || ${d} || ${p}`)}ey.simultaneousRequestCountMaximum=50,ey.prototype.update=function(e,t,i,n){let r=this._primitive,o=e.context,a=this.megatextures[0].maximumTileCount,s=this._keyframeCount,l=r._levelBlendFactor,c=(l>0?2:1)*(s>1?2:1);this._sampleCount=c;let h=c>=2;if(h&&!u(this.leafNodeTexture)){let e=Math.floor(512),t=Math.ceil(a/e);this.leafNodeTexture=new Ot({context:o,pixelFormat:rt.RGBA,pixelDatatype:Ye.UNSIGNED_BYTE,flipY:!1,width:1024,height:t,sampler:new un({minificationFilter:an.NEAREST,magnificationFilter:wi.NEAREST})}),this.leafNodeTexelSizeUv=U.fromElements(1/1024,1/t,this.leafNodeTexelSizeUv),this.leafNodeTilesPerRow=e}else!h&&u(this.leafNodeTexture)&&(this.leafNodeTexture=this.leafNodeTexture.destroy());if(this._keyframeLocation=P.clamp(t,0,s-1),i&&Gme(this,this.rootNode),n)return;this._frameNumber=e.frameNumber;let d=_i();Wct(this,e);let p=_i();qct(this,c,l);let f=_i();if(this._debugPrint){jct(this,p-d,f-p,f-d)}},ey.prototype.isRenderable=function(e){return e.isRenderable(this._frameNumber)},ey.prototype.isDestroyed=function(){return!1},ey.prototype.destroy=function(){let e=this.megatextures,t=e.length;for(let i=0;i<t;i++)e[i]=e[i]&&e[i].destroy();return this.internalNodeTexture=this.internalNodeTexture&&this.internalNodeTexture.destroy(),this.leafNodeTexture=this.leafNodeTexture&&this.leafNodeTexture.destroy(),le(this)};var bU={INTERNAL:0,LEAF:1,PACKED_LEAF_FROM_PARENT:2};function qct(e,t,i){let n=e._primitive._screenSpaceError,r=e._keyframeLocation,o=e._frameNumber,a=t>=2,s=0,l=0,c=[],h=[];let d=e.rootNode;d.computeSurroundingRenderableKeyframeNodes(r),d.isRenderable(o)&&function e(t,d,p,f,m){let _=!1;if(u(t.children))for(let e=0;e<8;e++){let i=t.children[e];i.computeSurroundingRenderableKeyframeNodes(r),i.isRenderable(o)&&(_=!0)}if(_){c[m]=bU.INTERNAL<<16|d,c[p]=f,s++,m=9*(f=d)+1;for(let i=0;i<8;i++){e(t.children[i],d=s,p=9*d+0,f,m+i)}}else{if(a){let e=5*l,r=t.renderableKeyframeNodePrevious,o=t.level-r.spatialNode.level,a=r.spatialNode.parent,s=u(a)?a.renderableKeyframeNodePrevious:r,d=Yct(t,n,i),p=o,f=1,_=r.megatextureIndex,g=s.megatextureIndex;h[e+0]=d,h[e+1]=p,h[e+2]=f,h[e+3]=_,h[e+4]=g,c[m]=bU.LEAF<<16|l}else{let e=t.renderableKeyframeNodePrevious,i=t.level-e.spatialNode.level==0?bU.LEAF:bU.PACKED_LEAF_FROM_PARENT;c[m]=i<<16|e.megatextureIndex}l++}}(d,0,0,0,0),Xct(c,9,e.internalNodeTilesPerRow,e.internalNodeTexture),a&&Kct(h,2,e.leafNodeTilesPerRow,e.leafNodeTexture)}function Yct(e,t,i){if(void 0===e.parent)return 0;let n=e.screenSpaceError,r=((t-n)/(e.parent.screenSpaceError-n)+i-1)/i;return P.clamp(r,0,1)}function Xct(e,t,i,n){let r=rt.componentsLength(n.pixelFormat),o=Math.ceil(e.length/t),a=Math.max(1,t*Math.min(o,i)),s=Math.max(1,Math.ceil(o/i)),l=new Uint8Array(a*s*r);for(let t=0;t<e.length;t++){let i=e[t],n=t*r;for(let e=0;e<r;e++)l[n+e]=i>>>8*e&255}let u={source:{arrayBufferView:l,width:a,height:s},xOffset:0,yOffset:0};n.copyFrom(u)}function Kct(e,t,i,n){let r=rt.componentsLength(n.pixelFormat),o=Math.ceil(e.length/5),a=Math.max(1,t*Math.min(o,i)),s=Math.max(1,Math.ceil(o/i)),l=new Uint8Array(a*s*r);for(let t=0;t<o;t++){let i=e[5*t+0],n=e[5*t+1],r=e[5*t+2],o=e[5*t+3],a=e[5*t+4],s=P.clamp(Math.floor(65536*i),0,65535);l[8*t+0]=s>>>0&255,l[8*t+1]=s>>>8&255,l[8*t+2]=255&n,l[8*t+3]=255&r,l[8*t+4]=o>>>0&255,l[8*t+5]=o>>>8&255,l[8*t+6]=a>>>0&255,l[8*t+7]=a>>>8&255}let u={source:{arrayBufferView:l,width:a,height:s},xOffset:0,yOffset:0};n.copyFrom(u)}ey.getApproximateTextureMemoryByteLength=function(e,t,i,n){let r=0,o=i.length;for(let a=0;a<o;a++){let o=i[a],s=n[a],l=Gt.getComponentCount(o);r+=Xv.getApproximateTextureMemoryByteLength(e,t,l,s)}return r};var CD=ey,Zct={FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",MAT2:"mat2",MAT3:"mat3",MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},ED=Object.freeze(Zct);function IC(){this._defaultTexture=void 0,this._textures={},this._loadedImages=[],this._lastUpdatedFrame=-1}function $ct(e,t,i){i.resource.fetchImage().then((function(n){e._loadedImages.push({id:t,image:n,textureUniform:i})})).catch((function(){let i=e._textures[t];u(i)&&i!==e._defaultTexture&&i.destroy(),e._textures[t]=e._defaultTexture}))}function Qct(e,t,i){let{id:n,textureUniform:r,image:o}=t,a=i.webgl2?TU(r,o,i):Jct(r,o,i),s=e._textures[n];u(s)&&s!==i.defaultTexture&&s.destroy(),e._textures[n]=a}function TU(e,t,i){let{typedArray:n,sampler:r}=e,o=u(n)?jme(e,i):new Ot({context:i,source:t,sampler:r});return Wme(r)&&o.generateMipmap(),o}function Jct(e,t,i){let{typedArray:n,sampler:r}=e,o=Wme(r),a=r.wrapS===vn.REPEAT||r.wrapS===vn.MIRRORED_REPEAT||r.wrapT===vn.REPEAT||r.wrapT===vn.MIRRORED_REPEAT,{width:s,height:l}=u(n)?e:t,c=[s,l].every(P.isPowerOfTwo);if(!o&&!a||c)return TU(e,t,i);if(!u(n)){return TU(e,S0(t),i)}if(e.pixelDatatype===Ye.UNSIGNED_BYTE){let e=z1(n,s,l);return TU({sampler:r},S0(e),i)}return o?console.warn("Texture requires resizing for mipmaps but pixelDataType cannot be resized. The texture may be rendered incorrectly."):a&&console.warn("Texture requires resizing for wrapping but pixelDataType cannot be resized. The texture may be rendered incorrectly."),jme(e,i)}function Wme(e){return[an.NEAREST_MIPMAP_NEAREST,an.NEAREST_MIPMAP_LINEAR,an.LINEAR_MIPMAP_NEAREST,an.LINEAR_MIPMAP_LINEAR].includes(e.minificationFilter)}function jme(e,t){let{pixelFormat:i,pixelDatatype:n,width:r,height:o,typedArray:a,sampler:s}=e;return new Ot({context:t,pixelFormat:i,pixelDatatype:n,source:{arrayBufferView:a,width:r,height:o},sampler:s,flipY:!1})}IC.prototype.getTexture=function(e){return this._textures[e]},IC.prototype.loadTexture2D=function(e,t){u(t.typedArray)?this._loadedImages.push({id:e,textureUniform:t}):$ct(this,e,t)},IC.prototype.update=function(e){if(e.frameNumber===this._lastUpdatedFrame)return;this._lastUpdatedFrame=e.frameNumber;let t=e.context;this._defaultTexture=t.defaultTexture;let i=this._loadedImages;for(let e=0;e<i.length;e++){Qct(this,i[e],t)}i.length=0},IC.prototype.isDestroyed=function(){return!1},IC.prototype.destroy=function(){let e=this._textures;for(let t in e)if(e.hasOwnProperty(t)){let i=e[t];i!==this._defaultTexture&&i.destroy()}return le(this)};var AU=IC;function SD(e){e=y(e,y.EMPTY_OBJECT),this.mode=y(e.mode,Dg.MODIFY_MATERIAL),this.lightingModel=e.lightingModel,this.uniforms=y(e.uniforms,y.EMPTY_OBJECT),this.varyings=y(e.varyings,y.EMPTY_OBJECT),this.vertexShaderText=e.vertexShaderText,this.fragmentShaderText=e.fragmentShaderText,this.translucencyMode=y(e.translucencyMode,ex.INHERIT),this._textureManager=new AU,this._defaultTexture=void 0,this.uniformMap=elt(this),this.usedVariablesVertex={attributeSet:{},featureIdSet:{},metadataSet:{}},this.usedVariablesFragment={attributeSet:{},featureIdSet:{},metadataSet:{},materialSet:{}},ilt(this),olt(this)}function elt(e){let t=e.uniforms,i={};for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];r.type===ED.SAMPLER_2D?(e._textureManager.loadTexture2D(n,r.value),i[n]=tlt(e,n)):i[n]=nlt(e,n)}return i}function tlt(e,t){return function(){return y(e._textureManager.getTexture(t),e._defaultTexture)}}function nlt(e,t){return function(){return e.uniforms[t].value}}function zx(e,t,i){let n;for(;null!==(n=t.exec(e));){i[n[1]]=!0}}function ilt(e){let t,i=/[vf]sInput\.attributes\.(\w+)/g,n=/[vf]sInput\.featureIds\.(\w+)/g,r=/[vf]sInput\.metadata.(\w+)/g,o=e.vertexShaderText;u(o)&&(t=e.usedVariablesVertex.attributeSet,zx(o,i,t),t=e.usedVariablesVertex.featureIdSet,zx(o,n,t),t=e.usedVariablesVertex.metadataSet,zx(o,r,t));let a=e.fragmentShaderText;if(u(a)){t=e.usedVariablesFragment.attributeSet,zx(a,i,t),t=e.usedVariablesFragment.featureIdSet,zx(a,n,t),t=e.usedVariablesFragment.metadataSet,zx(a,r,t),zx(a,/material\.(\w+)/g,e.usedVariablesFragment.materialSet)}}function qme(e){return/^.*MC$/.test(e)?`${e} (model coordinates)`:/^.*WC$/.test(e)?`${e} (Cartesian world coordinates)`:/^.*EC$/.test(e)?`${e} (eye coordinates)`:e}function Ka(e,t,i,n){if(e.hasOwnProperty(t)){let e=`${qme(t)} is not available in the ${n} shader. Did you mean ${qme(i)} instead?`;throw new de(e)}}function olt(e){let t=e.usedVariablesVertex.attributeSet;Ka(t,"position","positionMC","vertex"),Ka(t,"normal","normalMC","vertex"),Ka(t,"tangent","tangentMC","vertex"),Ka(t,"bitangent","bitangentMC","vertex"),Ka(t,"positionWC","positionMC","vertex"),Ka(t,"positionEC","positionMC","vertex"),Ka(t,"normalEC","normalMC","vertex"),Ka(t,"tangentEC","tangentMC","vertex"),Ka(t,"bitangentEC","bitangentMC","vertex");let i=e.usedVariablesFragment.attributeSet;Ka(i,"position","positionEC","fragment"),Ka(i,"normal","normalEC","fragment"),Ka(i,"tangent","tangentEC","fragment"),Ka(i,"bitangent","bitangentEC","fragment"),Ka(i,"normalMC","normalEC","fragment"),Ka(i,"tangentMC","tangentEC","fragment"),Ka(i,"bitangentMC","bitangentEC","fragment")}SD.prototype.setUniform=function(e,t){let i=this.uniforms[e];i.type===ED.SAMPLER_2D?this._textureManager.loadTexture2D(e,t):u(t.clone)?i.value=t.clone(i.value):i.value=t},SD.prototype.update=function(e){this._defaultTexture=e.context.defaultTexture,this._textureManager.update(e)},SD.prototype.isDestroyed=function(){return!1},SD.prototype.destroy=function(){this._textureManager=this._textureManager&&this._textureManager.destroy(),le(this)};var PC=SD;function om(e){e=y(e,y.EMPTY_OBJECT),this._ready=!1,this._provider=y(e.provider,om.DefaultProvider),this._traversal=void 0,this._shape=void 0,this._shapeVisible=!1,this._paddingBefore=new h,this._paddingAfter=new h,this._minBounds=new h,this._minBoundsOld=new h,this._maxBounds=new h,this._maxBoundsOld=new h,this._minClippingBounds=new h,this._minClippingBoundsOld=new h,this._maxClippingBounds=new h,this._maxClippingBoundsOld=new h,this._clippingPlanes=void 0,this._clippingPlanesState=0,this._clippingPlanesEnabled=!1,this._modelMatrix=L.clone(y(e.modelMatrix,L.IDENTITY)),this._compoundModelMatrix=new L,this._compoundModelMatrixOld=new L,this._customShader=y(e.customShader,om.DefaultCustomShader),this._customShaderCompilationEvent=new pe,this._shaderDirty=!0,this._drawCommand=void 0,this._drawCommandPick=void 0,this._pickId=void 0,this._clock=e.clock,this._transformPositionWorldToUv=new L,this._transformPositionUvToWorld=new L,this._transformDirectionWorldToLocal=new $,this._transformNormalLocalToWorld=new $,this._stepSizeUv=1,this._jitter=!0,this._nearestSampling=!1,this._levelBlendFactor=0,this._stepSizeMultiplier=1,this._depthTest=!0,this._useLogDepth=void 0,this._screenSpaceError=4,this._debugPolylines=new jh,this._debugDraw=!1,this._disableRender=!1,this._disableUpdate=!1,this._uniforms={octreeInternalNodeTexture:void 0,octreeInternalNodeTilesPerRow:0,octreeInternalNodeTexelSizeUv:new U,octreeLeafNodeTexture:void 0,octreeLeafNodeTilesPerRow:0,octreeLeafNodeTexelSizeUv:new U,megatextureTextures:[],megatextureSliceDimensions:new U,megatextureTileDimensions:new U,megatextureVoxelSizeUv:new U,megatextureSliceSizeUv:new U,megatextureTileSizeUv:new U,dimensions:new h,paddingBefore:new h,paddingAfter:new h,transformPositionViewToUv:new L,transformPositionUvToView:new L,transformDirectionViewToLocal:new $,transformNormalLocalToWorld:new $,cameraPositionUv:new h,ndcSpaceAxisAlignedBoundingBox:new oe,clippingPlanesTexture:void 0,clippingPlanesMatrix:new L,stepSize:0,pickColor:new z},this._shapeDefinesOld={},this._uniformMap={};let t=this._uniforms,i=this._uniformMap;for(let e in t)if(t.hasOwnProperty(e)){i[`u_${e}`]=function(){return t[e]}}rlt(this,this._provider)}function rlt(e,t){let{shape:i,minBounds:n=ji.getMinBounds(i),maxBounds:r=ji.getMaxBounds(i)}=t;e.minBounds=n,e.maxBounds=r,e.minClippingBounds=ji.getMinBounds(i),e.maxClippingBounds=ji.getMaxBounds(i),Xme(e,t);let o=ji.getShapeConstructor(i);e._shape=new o,e._shapeVisible=Kme(e,e._shape,t)}Object.defineProperties(om.prototype,{ready:{get:function(){return this._ready}},provider:{get:function(){return this._provider}},boundingSphere:{get:function(){return this._shape.boundingSphere}},orientedBoundingBox:{get:function(){return this.shape.orientedBoundingBox}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=L.clone(e,this._modelMatrix)}},shape:{get:function(){return this._provider.shape}},dimensions:{get:function(){return this._provider.dimensions}},minimumValues:{get:function(){return this._provider.minimumValues}},maximumValues:{get:function(){return this._provider.maximumValues}},show:{get:function(){return!this._disableRender},set:function(e){this._disableRender=!e}},disableUpdate:{get:function(){return this._disableUpdate},set:function(e){this._disableUpdate=e}},debugDraw:{get:function(){return this._debugDraw},set:function(e){this._debugDraw=e}},depthTest:{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._shaderDirty=!0)}},jitter:{get:function(){return this._jitter},set:function(e){this._jitter!==e&&(this._jitter=e,this._shaderDirty=!0)}},nearestSampling:{get:function(){return this._nearestSampling},set:function(e){this._nearestSampling!==e&&(this._nearestSampling=e,this._shaderDirty=!0)}},levelBlendFactor:{get:function(){return this._levelBlendFactor},set:function(e){this._levelBlendFactor=P.clamp(e,0,1)}},screenSpaceError:{get:function(){return this._screenSpaceError},set:function(e){this._screenSpaceError=e}},stepSize:{get:function(){return this._stepSizeMultiplier},set:function(e){this._stepSizeMultiplier=e}},minBounds:{get:function(){return this._minBounds},set:function(e){this._minBounds=h.clone(e,this._minBounds)}},maxBounds:{get:function(){return this._maxBounds},set:function(e){this._maxBounds=h.clone(e,this._maxBounds)}},minClippingBounds:{get:function(){return this._minClippingBounds},set:function(e){this._minClippingBounds=h.clone(e,this._minClippingBounds)}},maxClippingBounds:{get:function(){return this._maxClippingBounds},set:function(e){this._maxClippingBounds=h.clone(e,this._maxClippingBounds)}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){ys.setOwner(e,this,"_clippingPlanes")}},customShader:{get:function(){return this._customShader},set:function(e){if(this._customShader!==e){let t=this._uniformMap,i=this._customShader.uniformMap;for(let e in i)i.hasOwnProperty(e)&&delete t[e];u(e)?this._customShader=e:this._customShader=om.DefaultCustomShader,this._shaderDirty=!0}}},customShaderCompilationEvent:{get:function(){return this._customShaderCompilationEvent}}});var slt=new h,alt=new oe,clt=new oe,llt=new h,ult=new h,flt=new $,dlt=new $,hlt=new L,mlt=new L,plt=new L,_lt=L.fromRotationTranslation($.fromUniformScale(.5,new $),new h(.5,.5,.5),new L),glt=L.fromRotationTranslation($.fromUniformScale(2,new $),new h(-1,-1,-1),new L);function ylt(e,t,i){let n=e._uniforms;e._pickId=i.createPickId({primitive:e}),n.pickColor=z.clone(e._pickId.color,n.pickColor);let{shaderDefines:r,shaderUniforms:o}=e._shape;e._shapeDefinesOld=Ge(r,!0);let a=e._uniformMap;for(let e in o)if(o.hasOwnProperty(e)){a[`u_${e}`]=function(){return o[e]}}n.dimensions=h.clone(t.dimensions,n.dimensions),e._paddingBefore=h.clone(y(t.paddingBefore,h.ZERO),e._paddingBefore),n.paddingBefore=h.clone(e._paddingBefore,n.paddingBefore),e._paddingAfter=h.clone(y(t.paddingAfter,h.ZERO),e._paddingBefore),n.paddingAfter=h.clone(e._paddingAfter,n.paddingAfter),e._traversal=xlt(e,t,i),blt(e._traversal,n)}function Xme(e,t){let i=y(t.shapeTransform,L.IDENTITY),n=y(t.globalTransform,L.IDENTITY);return L.multiplyTransformation(n,e._modelMatrix,e._compoundModelMatrix),L.multiplyTransformation(e._compoundModelMatrix,i,e._compoundModelMatrix),wD(e,"_compoundModelMatrix","_compoundModelMatrixOld")+wD(e,"_minBounds","_minBoundsOld")+wD(e,"_maxBounds","_maxBoundsOld")+wD(e,"_minClippingBounds","_minClippingBoundsOld")+wD(e,"_maxClippingBounds","_maxClippingBoundsOld")>0}function wD(e,t,i){let n=e[t],r=e[i],o=!n.equals(r);return o&&n.clone(r),o?1:0}function Kme(e,t,i){if(!t.update(e._compoundModelMatrix,e.minBounds,e.maxBounds,e.minClippingBounds,e.maxClippingBounds))return!1;let n=t.shapeTransform,r=L.inverse(n,hlt),o=L.getRotation(n,flt),a=L.getScale(n,llt),s=h.maximumComponent(a),l=h.divideByScalar(a,s,ult),u=$.multiplyByScale(o,l,dlt),c=i.dimensions;return e._stepSizeUv=t.computeApproximateStepSize(c),e._transformPositionWorldToUv=L.multiplyTransformation(_lt,r,e._transformPositionWorldToUv),e._transformPositionUvToWorld=L.multiplyTransformation(n,glt,e._transformPositionUvToWorld),e._transformDirectionWorldToLocal=L.getMatrix3(r,e._transformDirectionWorldToLocal),e._transformNormalLocalToWorld=$.inverseTranspose(u,e._transformNormalLocalToWorld),!0}function xlt(e,t,i){let n=h.clone(t.dimensions,slt);h.add(n,e._paddingBefore,n),h.add(n,e._paddingAfter,n);let r=t.maximumTileCount,o=u(r)?CD.getApproximateTextureMemoryByteLength(r,n,t.types,t.componentTypes):void 0,a=y(t.keyframeCount,1);return new CD(e,i,n,t.types,t.componentTypes,a,o)}function blt(e,t){t.octreeInternalNodeTexture=e.internalNodeTexture,t.octreeInternalNodeTexelSizeUv=U.clone(e.internalNodeTexelSizeUv,t.octreeInternalNodeTexelSizeUv),t.octreeInternalNodeTilesPerRow=e.internalNodeTilesPerRow;let i=e.megatextures,n=i[0],r=i.length;t.megatextureTextures=new Array(r);for(let e=0;e<r;e++)t.megatextureTextures[e]=i[e].texture;t.megatextureSliceDimensions=U.clone(n.sliceCountPerRegion,t.megatextureSliceDimensions),t.megatextureTileDimensions=U.clone(n.regionCountPerMegatexture,t.megatextureTileDimensions),t.megatextureVoxelSizeUv=U.clone(n.voxelSizeUv,t.megatextureVoxelSizeUv),t.megatextureSliceSizeUv=U.clone(n.sliceSizeUv,t.megatextureSliceSizeUv),t.megatextureTileSizeUv=U.clone(n.regionSizeUv,t.megatextureTileSizeUv)}function Tlt(e,t){let i=t.shaderDefines,n=Object.keys(i).some((t=>i[t]!==e._shapeDefinesOld[t]));return n&&(e._shapeDefinesOld=Ge(i,!0)),n}function Alt(e,t){if(!u(e)||!u(t))return 0;let i,n=t.currentTime,r=e.indexOf(n);r>=0?i=e.get(r):(r=~r,r===e.length?(r=e.length-1,i=e.get(r),n=i.stop):(i=e.get(r),n=i.start));let o=J.secondsDifference(i.stop,i.start);return r+J.secondsDifference(n,i.start)/o}function Clt(e,t){let i=e.clippingPlanes;if(!u(i))return!1;i.update(t);let{clippingPlanesState:n,enabled:r}=i;if(r){let t=e._uniforms;t.clippingPlanesTexture=i.texture,t.clippingPlanesMatrix=L.transpose(L.multiplyTransformation(L.inverse(i.modelMatrix,t.clippingPlanesMatrix),e._transformPositionUvToWorld,t.clippingPlanesMatrix),t.clippingPlanesMatrix)}return(e._clippingPlanesState!==n||e._clippingPlanesEnabled!==r)&&(e._clippingPlanesState=n,e._clippingPlanesEnabled=r,!0)}om.prototype.update=function(e){let t=this._provider;this._customShader.update(e);let i=e.context;if(!this._ready)return ylt(this,t,i),void e.afterRender.push((()=>(this._ready=!0,!0)));let n=Xme(this,t),r=this._shape;if(n&&(this._shapeVisible=Kme(this,r,t),Tlt(this,r)&&(this._shaderDirty=!0)),!this._shapeVisible)return;let o=Alt(t.timeIntervalCollection,this._clock),a=this._traversal,s=a._sampleCount;if(a.update(e,o,n,this._disableUpdate),s!==a._sampleCount&&(this._shaderDirty=!0),!a.isRenderable(a.rootNode)||(this._debugDraw&&Plt(this,e),this._disableRender))return;this._useLogDepth!==e.useLogDepth&&(this._useLogDepth=e.useLogDepth,this._shaderDirty=!0),Clt(this,e)&&(this._shaderDirty=!0);let l=a.leafNodeTexture,c=this._uniforms;u(l)&&(c.octreeLeafNodeTexture=a.leafNodeTexture,c.octreeLeafNodeTexelSizeUv=U.clone(a.leafNodeTexelSizeUv,c.octreeLeafNodeTexelSizeUv),c.octreeLeafNodeTilesPerRow=a.leafNodeTilesPerRow),this._shaderDirty&&(QL(this,i),this._shaderDirty=!1);let h=i.uniformState.viewProjection,d=wlt(r.orientedBoundingBox,h,clt);if(1===d.x||1===d.y||-1===d.z||-1===d.w)return;c.ndcSpaceAxisAlignedBoundingBox=oe.clone(d,c.ndcSpaceAxisAlignedBoundingBox);let p=i.uniformState.inverseView;c.transformPositionViewToUv=L.multiplyTransformation(this._transformPositionWorldToUv,p,c.transformPositionViewToUv);let f=i.uniformState.view;c.transformPositionUvToView=L.multiplyTransformation(f,this._transformPositionUvToWorld,c.transformPositionUvToView);let m=i.uniformState.inverseViewRotation;c.transformDirectionViewToLocal=$.multiply(this._transformDirectionWorldToLocal,m,c.transformDirectionViewToLocal),c.transformNormalLocalToWorld=$.clone(this._transformNormalLocalToWorld,c.transformNormalLocalToWorld);let _=e.camera.positionWC;c.cameraPositionUv=L.multiplyByPoint(this._transformPositionWorldToUv,_,c.cameraPositionUv),c.stepSize=this._stepSizeUv*this._stepSizeMultiplier;let g=e.passes.pick?this._drawCommandPick:this._drawCommand;g.boundingVolume=r.boundingSphere,e.commandList.push(g)},om.prototype.isDestroyed=function(){return!1},om.prototype.destroy=function(){let e=this._drawCommand;u(e)&&(e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy());let t=this._drawCommandPick;return u(t)&&(t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy()),this._pickId=this._pickId&&this._pickId.destroy(),this._traversal=this._traversal&&this._traversal.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),le(this)};var Yme=new Array(new oe(-1,-1,-1,1),new oe(1,-1,-1,1),new oe(-1,1,-1,1),new oe(1,1,-1,1),new oe(-1,-1,1,1),new oe(1,-1,1,1),new oe(-1,1,1,1),new oe(1,1,1,1)),Elt=new Array(1,2,4,0,3,5,0,3,6,1,2,7,0,5,6,1,4,7,2,4,7,3,5,6),Slt=new Array(new oe,new oe,new oe,new oe,new oe,new oe,new oe,new oe);function wlt(e,t,i){let n,r=L.fromRotationTranslation(e.halfAxes,e.center,mlt),o=L.multiply(t,r,plt),a=+Number.MAX_VALUE,s=-Number.MAX_VALUE,l=+Number.MAX_VALUE,u=-Number.MAX_VALUE,c=Slt,h=Yme.length;for(n=0;n<h;n++)L.multiplyByVector(o,Yme[n],c[n]);for(n=0;n<h;n++){let e=c[n];if(e.z>=-e.w){let t=e.x/e.w,i=e.y/e.w;a=Math.min(a,t),s=Math.max(s,t),l=Math.min(l,i),u=Math.max(u,i)}else for(let t=0;t<3;t++){let i=c[Elt[3*n+t]];if(i.z>=-i.w){let t=e.z+e.w,n=t/(t-(i.z+i.w)),r=oe.lerp(e,i,n,alt),o=r.x/r.w,c=r.y/r.w;a=Math.min(a,o),s=Math.max(s,o),l=Math.min(l,c),u=Math.max(u,c)}}}return a=P.clamp(a,-1,1),l=P.clamp(l,-1,1),s=P.clamp(s,-1,1),u=P.clamp(u,-1,1),i=oe.fromElements(a,l,s,u,i)}var O7=3e7,vlt=new h(O7,0,0),Dlt=new h(0,O7,0),Ilt=new h(0,0,O7);function Plt(e,t){let i=e._traversal,n=e._debugPolylines;function r(e,t,i,r){n.add({positions:[e,t],width:r,material:Wi.fromType("Color",{color:i})})}function o(e,t,i){let n=e.computeCorners();r(n[0],n[1],t,i),r(n[2],n[3],t,i),r(n[4],n[5],t,i),r(n[6],n[7],t,i),r(n[0],n[2],t,i),r(n[4],n[6],t,i),r(n[1],n[3],t,i),r(n[5],n[7],t,i),r(n[0],n[4],t,i),r(n[2],n[6],t,i),r(n[1],n[5],t,i),r(n[3],n[7],t,i)}n.removeAll(),o(e._shape.orientedBoundingBox,z.WHITE,5),function e(t){if(!i.isRenderable(t))return;let n=t.level,r=Math.max(1,5/Math.pow(2,n)),a=[z.RED,z.LIME,z.BLUE][n%3];if(o(t.orientedBoundingBox,a,r),u(t.children))for(let i=0;i<8;i++)e(t.children[i])}(i.rootNode);r(h.ZERO,vlt,z.RED,10),r(h.ZERO,Dlt,z.LIME,10),r(h.ZERO,Ilt,z.BLUE,10),n.update(t)}function Zme(){this.ready=!0,this.shape=ji.BOX,this.dimensions=new h(1,1,1),this.names=["data"],this.types=[Gt.SCALAR],this.componentTypes=[Jt.FLOAT32],this.maximumTileCount=1}om.DefaultCustomShader=new PC({fragmentShaderText:"void fragmentMain(FragmentInput fsInput, inout czm_modelMaterial material)\n{\n    material.diffuse = vec3(1.0);\n    material.alpha = 1.0;\n}"}),Zme.prototype.requestData=function(e){if(!((u(e)?y(e.tileLevel,0):0)>=1))return Promise.resolve([new Float32Array(1)])},om.DefaultProvider=new Zme;var vD=om;function R7(){de.throwInstantiationError()}Object.defineProperties(R7.prototype,{globalTransform:{get:de.throwInstantiationError},shapeTransform:{get:de.throwInstantiationError},shape:{get:de.throwInstantiationError},minBounds:{get:de.throwInstantiationError},maxBounds:{get:de.throwInstantiationError},dimensions:{get:de.throwInstantiationError},paddingBefore:{get:de.throwInstantiationError},paddingAfter:{get:de.throwInstantiationError},names:{get:de.throwInstantiationError},types:{get:de.throwInstantiationError},componentTypes:{get:de.throwInstantiationError},minimumValues:{get:de.throwInstantiationError},maximumValues:{get:de.throwInstantiationError},maximumTileCount:{get:de.throwInstantiationError},keyframeCount:{get:de.throwInstantiationError},timeIntervalCollection:{get:de.throwInstantiationError}}),R7.prototype.requestData=de.throwInstantiationError;var $me=R7;function Hx(){de.throwInstantiationError()}Object.defineProperties(Hx.prototype,{orientedBoundingBox:{get:de.throwInstantiationError},boundingSphere:{get:de.throwInstantiationError},boundTransform:{get:de.throwInstantiationError},shapeTransform:{get:de.throwInstantiationError},shaderUniforms:{get:de.throwInstantiationError},shaderDefines:{get:de.throwInstantiationError},shaderMaximumIntersectionsLength:{get:de.throwInstantiationError}}),Hx.prototype.update=de.throwInstantiationError,Hx.prototype.computeOrientedBoundingBoxForTile=de.throwInstantiationError,Hx.prototype.computeApproximateStepSize=de.throwInstantiationError,Hx.DefaultMinBounds=de.throwInstantiationError,Hx.DefaultMaxBounds=de.throwInstantiationError;var Qme=Hx;function OC(e){return $t(`Assets/Textures/SkyBox/tycho2t3_80_${e}.jpg`)}function Olt(e){e._renderLoopRunning=!0;let t=0;requestAnimationFrame((function i(n){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{let r=e._targetFrameRate;if(u(r)){let o=1e3/r,a=n-t;a>o&&(e.resize(),e.render(),t=n-a%o),requestAnimationFrame(i)}else e.resize(),e.render(),requestAnimationFrame(i)}catch(t){if(e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors){let i="An error occurred while rendering.  Rendering has stopped.";e.showErrorPanel(i,void 0,t)}}else e._renderLoopRunning=!1}))}function Jme(e){let t=e._useBrowserRecommendedResolution?1:window.devicePixelRatio;return t*=e._resolutionScale,u(e._scene)&&(e._scene.pixelRatio=t),t}function epe(e){let t=e._canvas,i=t.clientWidth,n=t.clientHeight,r=Jme(e);e._canvasClientWidth=i,e._canvasClientHeight=n,i*=r,n*=r,t.width=i,t.height=n,e._canRender=0!==i&&0!==n,e._lastDevicePixelRatio=window.devicePixelRatio}function tpe(e){let t=e._canvas,i=t.width,n=t.height;if(0!==i&&0!==n){let t=e._scene.camera.frustum;u(t.aspectRatio)?t.aspectRatio=i/n:(t.top=t.right*(n/i),t.bottom=-t.top)}}function Gx(e,t){e=In(e),t=y(t,y.EMPTY_OBJECT);let i=document.createElement("div");i.className="cesium-widget",e.appendChild(i);let n=document.createElement("canvas"),r=Bt.supportsImageRenderingPixelated();function o(){n!==n.ownerDocument.activeElement&&n.ownerDocument.activeElement.blur()}this._supportsImageRenderingPixelated=r,r&&(n.style.imageRendering=Bt.imageRenderingValue()),n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},y(t.blurActiveElementOnCanvasFocus,!0)&&(n.addEventListener("mousedown",o),n.addEventListener("pointerdown",o)),i.appendChild(n);let a=document.createElement("div");a.className="cesium-widget-credits";let s=u(t.creditContainer)?In(t.creditContainer):i;s.appendChild(a);let l=u(t.creditViewport)?In(t.creditViewport):i,c=y(t.showRenderLoopErrors,!0),d=y(t.useBrowserRecommendedResolution,!0);this._element=i,this._container=e,this._canvas=n,this._canvasClientWidth=0,this._canvasClientHeight=0,this._lastDevicePixelRatio=0,this._creditViewport=l,this._creditContainer=s,this._innerCreditContainer=a,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=c,this._resolutionScale=1,this._useBrowserRecommendedResolution=d,this._forceResize=!1,this._clock=u(t.clock)?t.clock:new ph,epe(this);try{let e=new tU({canvas:n,contextOptions:t.contextOptions,creditContainer:a,creditViewport:l,mapProjection:t.mapProjection,orderIndependentTranslucency:t.orderIndependentTranslucency,scene3DOnly:y(t.scene3DOnly,!1),shadows:t.shadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange,depthPlaneEllipsoidOffset:t.depthPlaneEllipsoidOffset,msaaSamples:t.msaaSamples});this._scene=e,e.camera.constrainedAxis=h.UNIT_Z,Jme(this),tpe(this);let i=y(e.mapProjection.ellipsoid,ie.WGS84),r=t.globe;u(r)||(r=new _k(i)),!1!==r&&(e.globe=r,e.globe.shadows=y(t.terrainShadows,yn.RECEIVE_ONLY));let o=t.skyBox;u(o)||(o=new lU({sources:{positiveX:OC("px"),negativeX:OC("mx"),positiveY:OC("py"),negativeY:OC("my"),positiveZ:OC("pz"),negativeZ:OC("mz")}})),!1!==o&&(e.skyBox=o,e.sun=new mU,e.moon=new Hk);let s=t.skyAtmosphere;u(s)||(s=new oU(i),s.show=!1!==t.globe&&r.show),!1!==s&&(e.skyAtmosphere=s);let c=t.baseLayer;!1!==t.globe&&!1!==c&&(u(c)||(c=la.fromWorldImagery()),e.imageryLayers.add(c)),u(t.terrainProvider)&&!1!==t.globe&&(e.terrainProvider=t.terrainProvider),u(t.terrain)&&!1!==t.globe&&e.setTerrain(t.terrain),this._screenSpaceEventHandler=new Hu(n),u(t.sceneMode)&&(t.sceneMode===te.SCENE2D&&this._scene.morphTo2D(0),t.sceneMode===te.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=y(t.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=t.targetFrameRate;let d=this;this._onRenderError=function(e,t){if(d._useDefaultRenderLoop=!1,d._renderLoopRunning=!1,d._showRenderLoopErrors){let e="An error occurred while rendering.  Rendering has stopped.";d.showErrorPanel(e,void 0,t)}},e.renderError.addEventListener(this._onRenderError)}catch(e){if(c){let t="Error constructing CesiumWidget.",i='Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:';this.showErrorPanel(t,i,e)}throw e}}Object.defineProperties(Gx.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},creditDisplay:{get:function(){return this._scene.frameState.creditDisplay}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&Olt(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){this._resolutionScale!==e&&(this._resolutionScale=e,this._forceResize=!0)}},useBrowserRecommendedResolution:{get:function(){return this._useBrowserRecommendedResolution},set:function(e){this._useBrowserRecommendedResolution!==e&&(this._useBrowserRecommendedResolution=e,this._forceResize=!0)}}}),Gx.prototype.showErrorPanel=function(e,t,i){let n=this._element,r=document.createElement("div");r.className="cesium-widget-errorPanel";let o=document.createElement("div");o.className="cesium-widget-errorPanel-content",r.appendChild(o);let a=document.createElement("div");a.className="cesium-widget-errorPanel-header",a.appendChild(document.createTextNode(e)),o.appendChild(a);let s=document.createElement("div");function l(){s.style.maxHeight=`${Math.max(Math.round(.9*n.clientHeight-100),30)}px`}s.className="cesium-widget-errorPanel-scroll",o.appendChild(s),l(),u(window.addEventListener)&&window.addEventListener("resize",l,!1);let c=u(t),h=u(i);if(c||h){let n=document.createElement("div");if(n.className="cesium-widget-errorPanel-message",s.appendChild(n),h){let n=Om(i);c||("string"==typeof i&&(i=new Error(i)),t=Om({name:i.name,message:i.message}),n=i.stack),typeof console<"u"&&console.error(`${e}\n${t}\n${n}`);let r=document.createElement("div");r.className="cesium-widget-errorPanel-message-details collapsed";let a=document.createElement("span");a.className="cesium-widget-errorPanel-more-details",a.appendChild(document.createTextNode("See more...")),r.appendChild(a),r.onclick=function(e){r.removeChild(a),r.appendChild(document.createTextNode(n)),r.className="cesium-widget-errorPanel-message-details",o.className="cesium-widget-errorPanel-content expanded",r.onclick=void 0},s.appendChild(r)}n.innerHTML=`<p>${t}</p>`}let d=document.createElement("div");d.className="cesium-widget-errorPanel-buttonPanel",o.appendChild(d);let p=document.createElement("button");p.setAttribute("type","button"),p.className="cesium-button",p.appendChild(document.createTextNode("OK")),p.onclick=function(){u(l)&&u(window.removeEventListener)&&window.removeEventListener("resize",l,!1),n.removeChild(r)},d.appendChild(p),n.appendChild(r)},Gx.prototype.isDestroyed=function(){return!1},Gx.prototype.destroy=function(){u(this._scene)&&(this._scene.renderError.removeEventListener(this._onRenderError),this._scene=this._scene.destroy()),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),le(this)},Gx.prototype.resize=function(){let e=this._canvas;!this._forceResize&&this._canvasClientWidth===e.clientWidth&&this._canvasClientHeight===e.clientHeight&&this._lastDevicePixelRatio===window.devicePixelRatio||(this._forceResize=!1,epe(this),tpe(this),this._scene.requestRender())},Gx.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();let e=this._clock.tick();this._scene.render(e)}else this._clock.tick()};var CU=Gx;function ty(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new pe,this.setValue(e)}Object.defineProperties(ty.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}}),ty.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value},ty.prototype.setValue=function(e){let t=this._value;if(t!==e){let i=u(e),n=i&&"function"==typeof e.clone,r=i&&"function"==typeof e.equals;(!r||!e.equals(t))&&(this._hasClone=n,this._hasEquals=r,this._value=n?e.clone(this._value):e,this._definitionChanged.raiseEvent(this))}},ty.prototype.equals=function(e){return this===e||e instanceof ty&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))},ty.prototype.valueOf=function(){return this._value},ty.prototype.toString=function(){return String(this._value)};var Zn=ty;function Rlt(e,t,i,n,r){return{configurable:n,get:function(){return this[t]},set:function(n){let o=this[t],a=this[i];u(a)&&(a(),this[i]=void 0),void 0!==n&&(!u(n)||!u(n.getValue))&&u(r)&&(n=r(n)),o!==n&&(this[t]=n,this._definitionChanged.raiseEvent(this,e,n,o)),u(n)&&u(n.definitionChanged)&&(this[i]=n.definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this,e,n,n)}),this))}}}function Mlt(e){return new Zn(e)}function Llt(e,t,i){return Rlt(e,`_${e.toString()}`,`_${e.toString()}Subscription`,y(t,!1),y(i,Mlt))}var ae=Llt;function DD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._image=void 0,this._imageSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(DD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),image:ae("image"),scale:ae("scale"),pixelOffset:ae("pixelOffset"),eyeOffset:ae("eyeOffset"),horizontalOrigin:ae("horizontalOrigin"),verticalOrigin:ae("verticalOrigin"),heightReference:ae("heightReference"),color:ae("color"),rotation:ae("rotation"),alignedAxis:ae("alignedAxis"),sizeInMeters:ae("sizeInMeters"),width:ae("width"),height:ae("height"),scaleByDistance:ae("scaleByDistance"),translucencyByDistance:ae("translucencyByDistance"),pixelOffsetScaleByDistance:ae("pixelOffsetScaleByDistance"),imageSubRegion:ae("imageSubRegion"),distanceDisplayCondition:ae("distanceDisplayCondition"),disableDepthTestDistance:ae("disableDepthTestDistance")}),DD.prototype.clone=function(e){return u(e)?(e.show=this._show,e.image=this._image,e.scale=this._scale,e.pixelOffset=this._pixelOffset,e.eyeOffset=this._eyeOffset,e.horizontalOrigin=this._horizontalOrigin,e.verticalOrigin=this._verticalOrigin,e.heightReference=this._heightReference,e.color=this._color,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.sizeInMeters=this._sizeInMeters,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.imageSubRegion=this._imageSubRegion,e.distanceDisplayCondition=this._distanceDisplayCondition,e.disableDepthTestDistance=this._disableDepthTestDistance,e):new DD(this)},DD.prototype.merge=function(e){this.show=y(this._show,e.show),this.image=y(this._image,e.image),this.scale=y(this._scale,e.scale),this.pixelOffset=y(this._pixelOffset,e.pixelOffset),this.eyeOffset=y(this._eyeOffset,e.eyeOffset),this.horizontalOrigin=y(this._horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=y(this._verticalOrigin,e.verticalOrigin),this.heightReference=y(this._heightReference,e.heightReference),this.color=y(this._color,e.color),this.rotation=y(this._rotation,e.rotation),this.alignedAxis=y(this._alignedAxis,e.alignedAxis),this.sizeInMeters=y(this._sizeInMeters,e.sizeInMeters),this.width=y(this._width,e.width),this.height=y(this._height,e.height),this.scaleByDistance=y(this._scaleByDistance,e.scaleByDistance),this.translucencyByDistance=y(this._translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=y(this._pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.imageSubRegion=y(this._imageSubRegion,e.imageSubRegion),this.distanceDisplayCondition=y(this._distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=y(this._disableDepthTestDistance,e.disableDepthTestDistance)};var Sc=DD,Nlt={DONE:0,PENDING:1,FAILED:2},at=Object.freeze(Nlt);function Dd(){de.throwInstantiationError()}Object.defineProperties(Dd.prototype,{isConstant:{get:de.throwInstantiationError},definitionChanged:{get:de.throwInstantiationError}}),Dd.prototype.getValue=de.throwInstantiationError,Dd.prototype.equals=de.throwInstantiationError,Dd.equals=function(e,t){return e===t||u(e)&&e.equals(t)},Dd.arrayEquals=function(e,t){if(e===t)return!0;if(!u(e)||!u(t)||e.length!==t.length)return!1;let i=e.length;for(let n=0;n<i;n++)if(!Dd.equals(e[n],t[n]))return!1;return!0},Dd.isConstant=function(e){return!u(e)||e.isConstant},Dd.getValueOrUndefined=function(e,t,i){return u(e)?e.getValue(t,i):void 0},Dd.getValueOrDefault=function(e,t,i,n){return u(e)?y(e.getValue(t,n),i):i},Dd.getValueOrClonedDefault=function(e,t,i,n){let r;return u(e)&&(r=e.getValue(t,n)),u(r)||(r=i.clone(r)),r};var j=Dd,Flt=z.WHITE,Blt=h.ZERO,klt=We.NONE,Vlt=U.ZERO,Ult=1,zlt=0,Hlt=h.ZERO,Glt=yi.CENTER,Wlt=On.CENTER,jlt=!1,qlt=new h,Ylt=new z,Xlt=new h,Klt=new U,Zlt=new Pt,$lt=new Pt,Qlt=new Pt,Jlt=new qe,eut=new wt;function npe(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function ny(e,t){t.collectionChanged.addEventListener(ny.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new bt,this._onCollectionChanged(t,t.values,[],[])}function M7(e,t,i){u(e)&&(e.billboard=void 0,i.removeBillboard(t))}ny.prototype.update=function(e){let t=this._items.values,i=this._cluster;for(let n=0,r=t.length;n<r;n++){let r,o,a=t[n],s=a.entity,l=s._billboard,c=a.billboard,h=s.isShowing&&s.isAvailable(e)&&j.getValueOrDefault(l._show,e,!0);if(h&&(o=j.getValueOrUndefined(s._position,e,qlt),r=j.getValueOrUndefined(l._image,e),h=u(o)&&u(r)),!h){M7(a,s,i);continue}j.isConstant(s._position)||(i._clusterDirty=!0),u(c)||(c=i.getBillboard(s),c.id=s,c.image=void 0,a.billboard=c),c.show=h,(!u(c.image)||a.textureValue!==r)&&(c.image=r,a.textureValue=r),c.position=o,c.color=j.getValueOrDefault(l._color,e,Flt,Ylt),c.eyeOffset=j.getValueOrDefault(l._eyeOffset,e,Blt,Xlt),c.heightReference=j.getValueOrDefault(l._heightReference,e,klt),c.pixelOffset=j.getValueOrDefault(l._pixelOffset,e,Vlt,Klt),c.scale=j.getValueOrDefault(l._scale,e,Ult),c.rotation=j.getValueOrDefault(l._rotation,e,zlt),c.alignedAxis=j.getValueOrDefault(l._alignedAxis,e,Hlt),c.horizontalOrigin=j.getValueOrDefault(l._horizontalOrigin,e,Glt),c.verticalOrigin=j.getValueOrDefault(l._verticalOrigin,e,Wlt),c.width=j.getValueOrUndefined(l._width,e),c.height=j.getValueOrUndefined(l._height,e),c.scaleByDistance=j.getValueOrUndefined(l._scaleByDistance,e,Zlt),c.translucencyByDistance=j.getValueOrUndefined(l._translucencyByDistance,e,$lt),c.pixelOffsetScaleByDistance=j.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,Qlt),c.sizeInMeters=j.getValueOrDefault(l._sizeInMeters,e,jlt),c.distanceDisplayCondition=j.getValueOrUndefined(l._distanceDisplayCondition,e,eut),c.disableDepthTestDistance=j.getValueOrUndefined(l._disableDepthTestDistance,e);let d=j.getValueOrUndefined(l._imageSubRegion,e,Jlt);u(d)&&c.setImageSubRegion(c._imageId,d)}return!0},ny.prototype.getBoundingSphere=function(e,t){let i=this._items.get(e.id);if(!u(i)||!u(i.billboard))return at.FAILED;let n=i.billboard;if(n.heightReference===We.NONE)t.center=h.clone(n.position,t.center);else{if(!u(n._clampedPosition))return at.PENDING;t.center=h.clone(n._clampedPosition,t.center)}return t.radius=0,at.DONE},ny.prototype.isDestroyed=function(){return!1},ny.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(ny.prototype._onCollectionChanged,this);let e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return le(this)},ny.prototype._onCollectionChanged=function(e,t,i,n){let r,o,a=this._items,s=this._cluster;for(r=t.length-1;r>-1;r--)o=t[r],u(o._billboard)&&u(o._position)&&a.set(o.id,new npe(o));for(r=n.length-1;r>-1;r--)o=n[r],u(o._billboard)&&u(o._position)?a.contains(o.id)||a.set(o.id,new npe(o)):(M7(a.get(o.id),o,s),a.remove(o.id));for(r=i.length-1;r>-1;r--)o=i[r],M7(a.get(o.id),o,s),a.remove(o.id)};var EU=ny;function RC(e){this._definitionChanged=new pe,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(RC.prototype,{isConstant:{get:function(){return j.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ae("color")}),RC.prototype.getType=function(e){return"Color"},RC.prototype.getValue=function(e,t){return u(t)||(t={}),t.color=j.getValueOrClonedDefault(this._color,e,z.WHITE,t.color),t},RC.prototype.equals=function(e){return this===e||e instanceof RC&&j.equals(this._color,e._color)};var Nt=RC;function MC(){de.throwInstantiationError()}Object.defineProperties(MC.prototype,{isConstant:{get:de.throwInstantiationError},definitionChanged:{get:de.throwInstantiationError}}),MC.prototype.getType=de.throwInstantiationError,MC.prototype.getValue=de.throwInstantiationError,MC.prototype.equals=de.throwInstantiationError,MC.getValue=function(e,t,i){let n;return u(t)&&(n=t.getType(e),u(n))?((!u(i)||i.type!==n)&&(i=Wi.fromType(n)),t.getValue(e,i.uniforms),i):((!u(i)||i.type!==Wi.ColorType)&&(i=Wi.fromType(Wi.ColorType)),z.clone(z.WHITE,i.uniforms.color),i)};var Jo=MC;function Wx(e,t,i){this._primitives=t,this._orderedGroundPrimitives=i,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=e,this._options=e._options,this._entity=e._entity,this._material=void 0}Wx.prototype._isHidden=function(e,t,i){return!e.isShowing||!e.isAvailable(i)||!j.getValueOrDefault(t.show,i,!0)},Wx.prototype._setOptions=de.throwInstantiationError,Wx.prototype.update=function(e){let t=this._geometryUpdater,i=t._onTerrain,n=this._primitives,r=this._orderedGroundPrimitives;i?r.remove(this._primitive):(n.removeAndDestroy(this._primitive),n.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;let o=this._entity,a=o[this._geometryUpdater._geometryPropertyName];if(this._setOptions(o,a,e),this._isHidden(o,a,e))return;let s=this._geometryUpdater.shadowsProperty.getValue(e),l=this._options;if(!u(a.fill)||a.fill.getValue(e)){let o,a=t.fillMaterialProperty,u=a instanceof Nt,c=t._getIsClosed(l);if(u)o=new rn({closed:c,flat:i&&!t._supportsMaterialsforEntitiesOnTerrain});else{let t=Jo.getValue(e,a,this._material);this._material=t,o=new ao({material:t,translucent:t.isTranslucent(),closed:c})}if(i)l.vertexFormat=rn.VERTEX_FORMAT,this._primitive=r.add(new pl({geometryInstances:this._geometryUpdater.createFillGeometryInstance(e),appearance:o,asynchronous:!1,shadows:s,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(e)}),j.getValueOrUndefined(this._geometryUpdater.zIndex,e));else{l.vertexFormat=o.vertexFormat;let t=this._geometryUpdater.createFillGeometryInstance(e);u&&(o.translucent=255!==t.attributes.color.value[3]),this._primitive=n.add(new Sn({geometryInstances:t,appearance:o,asynchronous:!1,shadows:s}))}}if(!i&&u(a.outline)&&a.outline.getValue(e)){let i=this._geometryUpdater.createOutlineGeometryInstance(e),r=j.getValueOrDefault(a.outlineWidth,e,1);this._outlinePrimitive=n.add(new Sn({geometryInstances:i,appearance:new rn({flat:!0,translucent:255!==i.attributes.color.value[3],renderState:{lineWidth:t._scene.clampLineWidth(r)}}),asynchronous:!1,shadows:s}))}},Wx.prototype.getBoundingSphere=function(e){let t,i=this._entity,n=this._primitive,r=this._outlinePrimitive;return u(n)&&n.show&&n.ready&&(t=n.getGeometryInstanceAttributes(i),u(t)&&u(t.boundingSphere))||u(r)&&r.show&&r.ready&&(t=r.getGeometryInstanceAttributes(i),u(t)&&u(t.boundingSphere))?(se.clone(t.boundingSphere,e),at.DONE):u(n)&&!n.ready||u(r)&&!r.ready?at.PENDING:at.FAILED},Wx.prototype.isDestroyed=function(){return!1},Wx.prototype.destroy=function(){let e=this._primitives,t=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?t.remove(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),le(this)};var ri=Wx,tut=new U(1,1),nut=!1,iut=z.WHITE;function LC(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}Object.defineProperties(LC.prototype,{isConstant:{get:function(){return j.isConstant(this._image)&&j.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:ae("image"),repeat:ae("repeat"),color:ae("color"),transparent:ae("transparent")}),LC.prototype.getType=function(e){return"Image"},LC.prototype.getValue=function(e,t){return u(t)||(t={}),t.image=j.getValueOrUndefined(this._image,e),t.repeat=j.getValueOrClonedDefault(this._repeat,e,tut,t.repeat),t.color=j.getValueOrClonedDefault(this._color,e,iut,t.color),j.getValueOrDefault(this._transparent,e,nut)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t},LC.prototype.equals=function(e){return this===e||e instanceof LC&&j.equals(this._image,e._image)&&j.equals(this._repeat,e._repeat)&&j.equals(this._color,e._color)&&j.equals(this._transparent,e._transparent)};var jx=LC;function out(e){if(e instanceof z)return new Nt(e);if("string"==typeof e||e instanceof ve||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){let t=new jx;return t.image=e,t}}function rut(e,t){return ae(e,t,out)}var Oo=rut;function ID(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(ID.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),dimensions:ae("dimensions"),heightReference:ae("heightReference"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition")}),ID.prototype.clone=function(e){return u(e)?(e.show=this.show,e.dimensions=this.dimensions,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new ID(this)},ID.prototype.merge=function(e){this.show=y(this.show,e.show),this.dimensions=y(this.dimensions,e.dimensions),this.heightReference=y(this.heightReference,e.heightReference),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var NC=ID;function FC(){de.throwInstantiationError()}Object.defineProperties(FC.prototype,{isConstant:{get:de.throwInstantiationError},definitionChanged:{get:de.throwInstantiationError},referenceFrame:{get:de.throwInstantiationError}}),FC.prototype.getValue=de.throwInstantiationError,FC.prototype.getValueInReferenceFrame=de.throwInstantiationError,FC.prototype.equals=de.throwInstantiationError;var L7=new $;FC.convertToReferenceFrame=function(e,t,i,n,r){if(!u(t))return t;if(u(r)||(r=new h),i===n)return h.clone(t,r);let o=Rt.computeIcrfToFixedMatrix(e,L7);return u(o)||(o=Rt.computeTemeToPseudoFixedMatrix(e,L7)),i===to.INERTIAL?$.multiplyByVector(o,t,r):i===to.FIXED?$.multiplyByVector($.transpose(o,L7),t,r):void 0};var iy=FC;function qx(e,t){this._definitionChanged=new pe,this._value=h.clone(e),this._referenceFrame=y(t,to.FIXED)}Object.defineProperties(qx.prototype,{isConstant:{get:function(){return!u(this._value)||this._referenceFrame===to.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),qx.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,to.FIXED,t)},qx.prototype.setValue=function(e,t){let i=!1;h.equals(this._value,e)||(i=!0,this._value=h.clone(e)),u(t)&&this._referenceFrame!==t&&(i=!0,this._referenceFrame=t),i&&this._definitionChanged.raiseEvent(this)},qx.prototype.getValueInReferenceFrame=function(e,t,i){return iy.convertToReferenceFrame(e,this._value,this._referenceFrame,t,i)},qx.prototype.equals=function(e){return this===e||e instanceof qx&&h.equals(this._value,e._value)&&this._referenceFrame===e._referenceFrame};var gl=qx;function PD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(PD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),positions:ae("positions"),width:ae("width"),height:ae("height"),heightReference:ae("heightReference"),extrudedHeight:ae("extrudedHeight"),extrudedHeightReference:ae("extrudedHeightReference"),cornerType:ae("cornerType"),granularity:ae("granularity"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition"),classificationType:ae("classificationType"),zIndex:ae("zIndex")}),PD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new PD(this)},PD.prototype.merge=function(e){this.show=y(this.show,e.show),this.positions=y(this.positions,e.positions),this.width=y(this.width,e.width),this.height=y(this.height,e.height),this.heightReference=y(this.heightReference,e.heightReference),this.extrudedHeight=y(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=y(this.extrudedHeightReference,e.extrudedHeightReference),this.cornerType=y(this.cornerType,e.cornerType),this.granularity=y(this.granularity,e.granularity),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=y(this.classificationType,e.classificationType),this.zIndex=y(this.zIndex,e.zIndex)};var BC=PD;function sut(e){return e}function aut(e,t){return ae(e,t,sut)}var su=aut;function OD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(OD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),length:ae("length"),topRadius:ae("topRadius"),bottomRadius:ae("bottomRadius"),heightReference:ae("heightReference"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),numberOfVerticalLines:ae("numberOfVerticalLines"),slices:ae("slices"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition")}),OD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.length=this.length,e.topRadius=this.topRadius,e.bottomRadius=this.bottomRadius,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new OD(this)},OD.prototype.merge=function(e){this.show=y(this.show,e.show),this.length=y(this.length,e.length),this.topRadius=y(this.topRadius,e.topRadius),this.bottomRadius=y(this.bottomRadius,e.bottomRadius),this.heightReference=y(this.heightReference,e.heightReference),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=y(this.numberOfVerticalLines,e.numberOfVerticalLines),this.slices=y(this.slices,e.slices),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var kC=OD;function RD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(RD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),semiMajorAxis:ae("semiMajorAxis"),semiMinorAxis:ae("semiMinorAxis"),height:ae("height"),heightReference:ae("heightReference"),extrudedHeight:ae("extrudedHeight"),extrudedHeightReference:ae("extrudedHeightReference"),rotation:ae("rotation"),stRotation:ae("stRotation"),granularity:ae("granularity"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),numberOfVerticalLines:ae("numberOfVerticalLines"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition"),classificationType:ae("classificationType"),zIndex:ae("zIndex")}),RD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new RD(this)},RD.prototype.merge=function(e){this.show=y(this.show,e.show),this.semiMajorAxis=y(this.semiMajorAxis,e.semiMajorAxis),this.semiMinorAxis=y(this.semiMinorAxis,e.semiMinorAxis),this.height=y(this.height,e.height),this.heightReference=y(this.heightReference,e.heightReference),this.extrudedHeight=y(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=y(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=y(this.rotation,e.rotation),this.stRotation=y(this.stRotation,e.stRotation),this.granularity=y(this.granularity,e.granularity),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=y(this.numberOfVerticalLines,e.numberOfVerticalLines),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=y(this.classificationType,e.classificationType),this.zIndex=y(this.zIndex,e.zIndex)};var VC=RD;function MD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._innerRadii=void 0,this._innerRadiiSubscription=void 0,this._minimumClock=void 0,this._minimumClockSubscription=void 0,this._maximumClock=void 0,this._maximumClockSubscription=void 0,this._minimumCone=void 0,this._minimumConeSubscription=void 0,this._maximumCone=void 0,this._maximumConeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(MD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),radii:ae("radii"),innerRadii:ae("innerRadii"),minimumClock:ae("minimumClock"),maximumClock:ae("maximumClock"),minimumCone:ae("minimumCone"),maximumCone:ae("maximumCone"),heightReference:ae("heightReference"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),stackPartitions:ae("stackPartitions"),slicePartitions:ae("slicePartitions"),subdivisions:ae("subdivisions"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition")}),MD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.radii=this.radii,e.innerRadii=this.innerRadii,e.minimumClock=this.minimumClock,e.maximumClock=this.maximumClock,e.minimumCone=this.minimumCone,e.maximumCone=this.maximumCone,e.heightReference=this.heightReference,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new MD(this)},MD.prototype.merge=function(e){this.show=y(this.show,e.show),this.radii=y(this.radii,e.radii),this.innerRadii=y(this.innerRadii,e.innerRadii),this.minimumClock=y(this.minimumClock,e.minimumClock),this.maximumClock=y(this.maximumClock,e.maximumClock),this.minimumCone=y(this.minimumCone,e.minimumCone),this.maximumCone=y(this.maximumCone,e.maximumCone),this.heightReference=y(this.heightReference,e.heightReference),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.stackPartitions=y(this.stackPartitions,e.stackPartitions),this.slicePartitions=y(this.slicePartitions,e.slicePartitions),this.subdivisions=y(this.subdivisions,e.subdivisions),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var UC=MD;function LD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(LD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),text:ae("text"),font:ae("font"),style:ae("style"),scale:ae("scale"),showBackground:ae("showBackground"),backgroundColor:ae("backgroundColor"),backgroundPadding:ae("backgroundPadding"),pixelOffset:ae("pixelOffset"),eyeOffset:ae("eyeOffset"),horizontalOrigin:ae("horizontalOrigin"),verticalOrigin:ae("verticalOrigin"),heightReference:ae("heightReference"),fillColor:ae("fillColor"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),translucencyByDistance:ae("translucencyByDistance"),pixelOffsetScaleByDistance:ae("pixelOffsetScaleByDistance"),scaleByDistance:ae("scaleByDistance"),distanceDisplayCondition:ae("distanceDisplayCondition"),disableDepthTestDistance:ae("disableDepthTestDistance")}),LD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.text=this.text,e.font=this.font,e.style=this.style,e.scale=this.scale,e.showBackground=this.showBackground,e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.pixelOffset=this.pixelOffset,e.eyeOffset=this.eyeOffset,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.heightReference=this.heightReference,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.scaleByDistance=this.scaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new LD(this)},LD.prototype.merge=function(e){this.show=y(this.show,e.show),this.text=y(this.text,e.text),this.font=y(this.font,e.font),this.style=y(this.style,e.style),this.scale=y(this.scale,e.scale),this.showBackground=y(this.showBackground,e.showBackground),this.backgroundColor=y(this.backgroundColor,e.backgroundColor),this.backgroundPadding=y(this.backgroundPadding,e.backgroundPadding),this.pixelOffset=y(this.pixelOffset,e.pixelOffset),this.eyeOffset=y(this.eyeOffset,e.eyeOffset),this.horizontalOrigin=y(this.horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=y(this.verticalOrigin,e.verticalOrigin),this.heightReference=y(this.heightReference,e.heightReference),this.fillColor=y(this.fillColor,e.fillColor),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.translucencyByDistance=y(this.translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=y(this.pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.scaleByDistance=y(this.scaleByDistance,e.scaleByDistance),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=y(this.disableDepthTestDistance,e.disableDepthTestDistance)};var rm=LD,N7=new P0;function ND(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=e.translation,this.rotation=e.rotation,this.scale=e.scale}Object.defineProperties(ND.prototype,{isConstant:{get:function(){return j.isConstant(this._translation)&&j.isConstant(this._rotation)&&j.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:ae("translation"),rotation:ae("rotation"),scale:ae("scale")}),ND.prototype.getValue=function(e,t){return u(t)||(t=new P0),t.translation=j.getValueOrClonedDefault(this._translation,e,N7.translation,t.translation),t.rotation=j.getValueOrClonedDefault(this._rotation,e,N7.rotation,t.rotation),t.scale=j.getValueOrClonedDefault(this._scale,e,N7.scale,t.scale),t},ND.prototype.equals=function(e){return this===e||e instanceof ND&&j.equals(this._translation,e._translation)&&j.equals(this._rotation,e._rotation)&&j.equals(this._scale,e._scale)};var zC=ND;function Yp(e,t){this._propertyNames=[],this._definitionChanged=new pe,u(e)&&this.merge(e,t)}function cut(e){return new Zn(e)}function lut(e,t){let i=e._propertyNames,n=t._propertyNames,r=i.length;if(r!==n.length)return!1;for(let o=0;o<r;++o){let r=i[o];if(-1===n.indexOf(r)||!j.equals(e[r],t[r]))return!1}return!0}Object.defineProperties(Yp.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){let e=this._propertyNames;for(let t=0,i=e.length;t<i;t++)if(!j.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),Yp.prototype.hasProperty=function(e){return-1!==this._propertyNames.indexOf(e)},Yp.prototype.addProperty=function(e,t,i){this._propertyNames.push(e),Object.defineProperty(this,e,ae(e,!0,y(i,cut))),u(t)&&(this[e]=t),this._definitionChanged.raiseEvent(this)},Yp.prototype.removeProperty=function(e){let t=this._propertyNames.indexOf(e);this._propertyNames.splice(t,1),delete this[e],this._definitionChanged.raiseEvent(this)},Yp.prototype.getValue=function(e,t){u(t)||(t={});let i=this._propertyNames;for(let n=0,r=i.length;n<r;n++){let r=i[n];t[r]=j.getValueOrUndefined(this[r],e,t[r])}return t},Yp.prototype.merge=function(e,t){let i=this._propertyNames,n=u(e._propertyNames)?e._propertyNames:Object.keys(e);for(let r=0,o=n.length;r<o;r++){let o=n[r],a=this[o],s=e[o];void 0===a&&-1===i.indexOf(o)&&this.addProperty(o,void 0,t),void 0!==s&&(void 0!==a?u(a)&&u(a.merge)&&a.merge(s):u(s)&&u(s.merge)&&u(s.clone)?this[o]=s.clone():this[o]=s)}},Yp.prototype.equals=function(e){return this===e||e instanceof Yp&&lut(this,e)};var au=Yp;function ipe(e){return new zC(e)}function uut(e){return new au(e,ipe)}function fut(e){return new au(e)}function FD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._runAnimations=void 0,this._runAnimationsSubscription=void 0,this._clampAnimations=void 0,this._clampAnimationsSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._imageBasedLightingFactor=void 0,this._imageBasedLightingFactorSubscription=void 0,this._lightColor=void 0,this._lightColorSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._articulations=void 0,this._articulationsSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this._customShader=void 0,this._customShaderSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(FD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),uri:ae("uri"),scale:ae("scale"),minimumPixelSize:ae("minimumPixelSize"),maximumScale:ae("maximumScale"),incrementallyLoadTextures:ae("incrementallyLoadTextures"),runAnimations:ae("runAnimations"),clampAnimations:ae("clampAnimations"),shadows:ae("shadows"),heightReference:ae("heightReference"),silhouetteColor:ae("silhouetteColor"),silhouetteSize:ae("silhouetteSize"),color:ae("color"),colorBlendMode:ae("colorBlendMode"),colorBlendAmount:ae("colorBlendAmount"),imageBasedLightingFactor:ae("imageBasedLightingFactor"),lightColor:ae("lightColor"),distanceDisplayCondition:ae("distanceDisplayCondition"),nodeTransformations:ae("nodeTransformations",void 0,uut),articulations:ae("articulations",void 0,fut),clippingPlanes:ae("clippingPlanes"),customShader:ae("customShader")}),FD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.uri=this.uri,e.scale=this.scale,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.runAnimations=this.runAnimations,e.clampAnimations=this.clampAnimations,e.heightReference=this._heightReference,e.silhouetteColor=this.silhouetteColor,e.silhouetteSize=this.silhouetteSize,e.color=this.color,e.colorBlendMode=this.colorBlendMode,e.colorBlendAmount=this.colorBlendAmount,e.imageBasedLightingFactor=this.imageBasedLightingFactor,e.lightColor=this.lightColor,e.distanceDisplayCondition=this.distanceDisplayCondition,e.nodeTransformations=this.nodeTransformations,e.articulations=this.articulations,e.clippingPlanes=this.clippingPlanes,e.customShader=this.customShader,e):new FD(this)},FD.prototype.merge=function(e){this.show=y(this.show,e.show),this.uri=y(this.uri,e.uri),this.scale=y(this.scale,e.scale),this.minimumPixelSize=y(this.minimumPixelSize,e.minimumPixelSize),this.maximumScale=y(this.maximumScale,e.maximumScale),this.incrementallyLoadTextures=y(this.incrementallyLoadTextures,e.incrementallyLoadTextures),this.runAnimations=y(this.runAnimations,e.runAnimations),this.clampAnimations=y(this.clampAnimations,e.clampAnimations),this.shadows=y(this.shadows,e.shadows),this.heightReference=y(this.heightReference,e.heightReference),this.silhouetteColor=y(this.silhouetteColor,e.silhouetteColor),this.silhouetteSize=y(this.silhouetteSize,e.silhouetteSize),this.color=y(this.color,e.color),this.colorBlendMode=y(this.colorBlendMode,e.colorBlendMode),this.colorBlendAmount=y(this.colorBlendAmount,e.colorBlendAmount),this.imageBasedLightingFactor=y(this.imageBasedLightingFactor,e.imageBasedLightingFactor),this.lightColor=y(this.lightColor,e.lightColor),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.clippingPlanes=y(this.clippingPlanes,e.clippingPlanes),this.customShader=y(this.customShader,e.customShader);let t=e.nodeTransformations;if(u(t)){let e=this.nodeTransformations;u(e)?e.merge(t):this.nodeTransformations=new au(t,ipe)}let i=e.articulations;if(u(i)){let e=this.articulations;u(e)?e.merge(i):this.articulations=new au(i)}};var oy=FD;function BD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._maximumScreenSpaceError=void 0,this._maximumScreenSpaceErrorSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(BD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),uri:ae("uri"),maximumScreenSpaceError:ae("maximumScreenSpaceError")}),BD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.uri=this.uri,e.maximumScreenSpaceError=this.maximumScreenSpaceError,e):new BD(this)},BD.prototype.merge=function(e){this.show=y(this.show,e.show),this.uri=y(this.uri,e.uri),this.maximumScreenSpaceError=y(this.maximumScreenSpaceError,e.maximumScreenSpaceError)};var HC=BD;function kD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(kD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),leadTime:ae("leadTime"),trailTime:ae("trailTime"),width:ae("width"),resolution:ae("resolution"),material:Oo("material"),distanceDisplayCondition:ae("distanceDisplayCondition")}),kD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.width=this.width,e.resolution=this.resolution,e.material=this.material,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new kD(this)},kD.prototype.merge=function(e){this.show=y(this.show,e.show),this.leadTime=y(this.leadTime,e.leadTime),this.trailTime=y(this.trailTime,e.trailTime),this.width=y(this.width,e.width),this.resolution=y(this.resolution,e.resolution),this.material=y(this.material,e.material),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var ry=kD;function VD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(VD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),plane:ae("plane"),dimensions:ae("dimensions"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition")}),VD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.plane=this.plane,e.dimensions=this.dimensions,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new VD(this)},VD.prototype.merge=function(e){this.show=y(this.show,e.show),this.plane=y(this.plane,e.plane),this.dimensions=y(this.dimensions,e.dimensions),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var SU=VD;function UD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(UD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),pixelSize:ae("pixelSize"),heightReference:ae("heightReference"),color:ae("color"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),scaleByDistance:ae("scaleByDistance"),translucencyByDistance:ae("translucencyByDistance"),distanceDisplayCondition:ae("distanceDisplayCondition"),disableDepthTestDistance:ae("disableDepthTestDistance")}),UD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.pixelSize=this.pixelSize,e.heightReference=this.heightReference,e.color=this.color,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new UD(this)},UD.prototype.merge=function(e){this.show=y(this.show,e.show),this.pixelSize=y(this.pixelSize,e.pixelSize),this.heightReference=y(this.heightReference,e.heightReference),this.color=y(this.color,e.color),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.scaleByDistance=y(this.scaleByDistance,e.scaleByDistance),this.translucencyByDistance=y(this._translucencyByDistance,e.translucencyByDistance),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=y(this.disableDepthTestDistance,e.disableDepthTestDistance)};var GC=UD;function dut(e){return Array.isArray(e)&&(e=new Pa(e)),new Zn(e)}function zD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._textureCoordinates=void 0,this._textureCoordinatesSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(zD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),hierarchy:ae("hierarchy",void 0,dut),height:ae("height"),heightReference:ae("heightReference"),extrudedHeight:ae("extrudedHeight"),extrudedHeightReference:ae("extrudedHeightReference"),stRotation:ae("stRotation"),granularity:ae("granularity"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),perPositionHeight:ae("perPositionHeight"),closeTop:ae("closeTop"),closeBottom:ae("closeBottom"),arcType:ae("arcType"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition"),classificationType:ae("classificationType"),zIndex:ae("zIndex"),textureCoordinates:ae("textureCoordinates")}),zD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.hierarchy=this.hierarchy,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.arcType=this.arcType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e.textureCoordinates=this.textureCoordinates,e):new zD(this)},zD.prototype.merge=function(e){this.show=y(this.show,e.show),this.hierarchy=y(this.hierarchy,e.hierarchy),this.height=y(this.height,e.height),this.heightReference=y(this.heightReference,e.heightReference),this.extrudedHeight=y(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=y(this.extrudedHeightReference,e.extrudedHeightReference),this.stRotation=y(this.stRotation,e.stRotation),this.granularity=y(this.granularity,e.granularity),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.perPositionHeight=y(this.perPositionHeight,e.perPositionHeight),this.closeTop=y(this.closeTop,e.closeTop),this.closeBottom=y(this.closeBottom,e.closeBottom),this.arcType=y(this.arcType,e.arcType),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=y(this.classificationType,e.classificationType),this.zIndex=y(this.zIndex,e.zIndex),this.textureCoordinates=y(this.textureCoordinates,e.textureCoordinates)};var sm=zD;function HD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._clampToGround=void 0,this._clampToGroundSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(HD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),positions:ae("positions"),width:ae("width"),granularity:ae("granularity"),material:Oo("material"),depthFailMaterial:Oo("depthFailMaterial"),arcType:ae("arcType"),clampToGround:ae("clampToGround"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition"),classificationType:ae("classificationType"),zIndex:ae("zIndex")}),HD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.width=this.width,e.granularity=this.granularity,e.material=this.material,e.depthFailMaterial=this.depthFailMaterial,e.arcType=this.arcType,e.clampToGround=this.clampToGround,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new HD(this)},HD.prototype.merge=function(e){this.show=y(this.show,e.show),this.positions=y(this.positions,e.positions),this.width=y(this.width,e.width),this.granularity=y(this.granularity,e.granularity),this.material=y(this.material,e.material),this.depthFailMaterial=y(this.depthFailMaterial,e.depthFailMaterial),this.arcType=y(this.arcType,e.arcType),this.clampToGround=y(this.clampToGround,e.clampToGround),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=y(this.classificationType,e.classificationType),this.zIndex=y(this.zIndex,e.zIndex)};var wc=HD;function GD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(GD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),positions:ae("positions"),shape:ae("shape"),cornerType:ae("cornerType"),granularity:ae("granularity"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition")}),GD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.shape=this.shape,e.cornerType=this.cornerType,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new GD(this)},GD.prototype.merge=function(e){this.show=y(this.show,e.show),this.positions=y(this.positions,e.positions),this.shape=y(this.shape,e.shape),this.cornerType=y(this.cornerType,e.cornerType),this.granularity=y(this.granularity,e.granularity),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var WC=GD;function WD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(WD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),coordinates:ae("coordinates"),height:ae("height"),heightReference:ae("heightReference"),extrudedHeight:ae("extrudedHeight"),extrudedHeightReference:ae("extrudedHeightReference"),rotation:ae("rotation"),stRotation:ae("stRotation"),granularity:ae("granularity"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition"),classificationType:ae("classificationType"),zIndex:ae("zIndex")}),WD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.coordinates=this.coordinates,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.rotation=this.rotation,e.stRotation=this.stRotation,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new WD(this)},WD.prototype.merge=function(e){this.show=y(this.show,e.show),this.coordinates=y(this.coordinates,e.coordinates),this.height=y(this.height,e.height),this.heightReference=y(this.heightReference,e.heightReference),this.extrudedHeight=y(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=y(this.extrudedHeightReference,e.extrudedHeightReference),this.rotation=y(this.rotation,e.rotation),this.stRotation=y(this.stRotation,e.stRotation),this.granularity=y(this.granularity,e.granularity),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=y(this.classificationType,e.classificationType),this.zIndex=y(this.zIndex,e.zIndex)};var am=WD;function jD(e){this._definitionChanged=new pe,this._show=void 0,this._showSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(y(e,y.EMPTY_OBJECT))}Object.defineProperties(jD.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:ae("show"),positions:ae("positions"),minimumHeights:ae("minimumHeights"),maximumHeights:ae("maximumHeights"),granularity:ae("granularity"),fill:ae("fill"),material:Oo("material"),outline:ae("outline"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth"),shadows:ae("shadows"),distanceDisplayCondition:ae("distanceDisplayCondition")}),jD.prototype.clone=function(e){return u(e)?(e.show=this.show,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.material=this.material,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new jD(this)},jD.prototype.merge=function(e){this.show=y(this.show,e.show),this.positions=y(this.positions,e.positions),this.minimumHeights=y(this.minimumHeights,e.minimumHeights),this.maximumHeights=y(this.maximumHeights,e.maximumHeights),this.granularity=y(this.granularity,e.granularity),this.fill=y(this.fill,e.fill),this.material=y(this.material,e.material),this.outline=y(this.outline,e.outline),this.outlineColor=y(this.outlineColor,e.outlineColor),this.outlineWidth=y(this.outlineWidth,e.outlineWidth),this.shadows=y(this.shadows,e.shadows),this.distanceDisplayCondition=y(this.distanceDisplayCondition,e.distanceDisplayCondition)};var sy=jD,hut=new fe;function mut(e){return new gl(e)}function put(e){return ae(e,void 0,mut)}function Xs(e,t){return ae(e,void 0,(function(e){return e instanceof t?e:new t(e)}))}function cm(e){let t=(e=y(e,y.EMPTY_OBJECT)).id;u(t)||(t=jn()),this._availability=void 0,this._id=t,this._definitionChanged=new pe,this._name=e.name,this._show=y(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","tileset","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._tileset=void 0,this._tilesetSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function F7(e,t,i){let n=t.length;for(let e=0;e<n;e++){let n=t[e],r=n._show;(!i&&r)!==(i&&r)&&F7(n,n._children,i)}e._definitionChanged.raiseEvent(e,"isShowing",i,!i)}Object.defineProperties(cm.prototype,{availability:su("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:su("name"),show:{get:function(){return this._show},set:function(e){if(e===this._show)return;let t=this.isShowing;this._show=e;let i=this.isShowing;t!==i&&F7(this,this._children,i),this._definitionChanged.raiseEvent(this,"show",e,!e)}},isShowing:{get:function(){return this._show&&(!u(this.entityCollection)||this.entityCollection.show)&&(!u(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){let t=this._parent;if(t===e)return;let i=this.isShowing;if(u(t)){let e=t._children.indexOf(this);t._children.splice(e,1)}this._parent=e,u(e)&&e._children.push(this);let n=this.isShowing;i!==n&&F7(this,this._children,n),this._definitionChanged.raiseEvent(this,"parent",e,t)}},propertyNames:{get:function(){return this._propertyNames}},billboard:Xs("billboard",Sc),box:Xs("box",NC),corridor:Xs("corridor",BC),cylinder:Xs("cylinder",kC),description:ae("description"),ellipse:Xs("ellipse",VC),ellipsoid:Xs("ellipsoid",UC),label:Xs("label",rm),model:Xs("model",oy),tileset:Xs("tileset",HC),orientation:ae("orientation"),path:Xs("path",ry),plane:Xs("plane",SU),point:Xs("point",GC),polygon:Xs("polygon",sm),polyline:Xs("polyline",wc),polylineVolume:Xs("polylineVolume",WC),properties:Xs("properties",au),position:put("position"),rectangle:Xs("rectangle",am),viewFrom:ae("viewFrom"),wall:Xs("wall",sy)}),cm.prototype.isAvailable=function(e){let t=this._availability;return!u(t)||t.contains(e)},cm.prototype.addProperty=function(e){this._propertyNames.push(e),Object.defineProperty(this,e,su(e,!0))},cm.prototype.removeProperty=function(e){let t=this._propertyNames.indexOf(e);this._propertyNames.splice(t,1),delete this[e]},cm.prototype.merge=function(e){this.name=y(this.name,e.name),this.availability=y(this.availability,e.availability);let t=this._propertyNames,i=u(e._propertyNames)?e._propertyNames:Object.keys(e),n=i.length;for(let r=0;r<n;r++){let n=i[r];if("parent"===n||"name"===n||"availability"===n||"children"===n)continue;let o=this[n],a=e[n];!u(o)&&-1===t.indexOf(n)&&this.addProperty(n),u(a)&&(u(o)?u(o.merge)&&o.merge(a):u(a.merge)&&u(a.clone)?this[n]=a.clone():this[n]=a)}};var ope=new $,rpe=new h,spe=new Le;cm.prototype.computeModelMatrix=function(e,t){let i=j.getValueOrUndefined(this._position,e,rpe);if(!u(i))return;let n=j.getValueOrUndefined(this._orientation,e,spe);return t=u(n)?L.fromRotationTranslation($.fromQuaternion(n,ope),i,t):Rt.eastNorthUpToFixedFrame(i,void 0,t)},cm.prototype.computeModelMatrixForHeightReference=function(e,t,i,n,r){let o=j.getValueOrDefault(t,e,We.NONE),a=j.getValueOrUndefined(this._position,e,rpe);if(o===We.NONE||!u(a)||h.equalsEpsilon(a,h.ZERO,P.EPSILON8))return this.computeModelMatrix(e,r);let s=n.cartesianToCartographic(a,hut);o===We.CLAMP_TO_GROUND?s.height=i:s.height+=i,a=n.cartographicToCartesian(s,a);let l=j.getValueOrUndefined(this._orientation,e,spe);return r=u(l)?L.fromRotationTranslation($.fromQuaternion(l,ope),a,r):Rt.eastNorthUpToFixedFrame(a,void 0,r)},cm.supportsMaterialsforEntitiesOnTerrain=function(e){return pl.supportsMaterials(e)},cm.supportsPolylinesOnTerrain=function(e){return $h.isSupported(e)};var er=cm,_ut=new Nt(z.WHITE),gut=new Zn(!0),yut=new Zn(!0),xut=new Zn(!1),but=new Zn(z.BLACK),Tut=new Zn(yn.DISABLED),Aut=new Zn(new wt),Cut=new Zn(zn.BOTH);function vc(e){let t=e.entity,i=e.geometryPropertyName;this._entity=t,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new pe,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=i,this._id=`${i}-${t.id}`,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=er.supportsMaterialsforEntitiesOnTerrain(e.scene)}Object.defineProperties(vc.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!u(this._entity.availability)&&j.isConstant(this._showProperty)&&j.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!u(this._entity.availability)&&j.isConstant(this._showProperty)&&j.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),vc.prototype.isOutlineVisible=function(e){let t=this._entity,i=this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e);return y(i,!1)},vc.prototype.isFilled=function(e){let t=this._entity,i=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e);return y(i,!1)},vc.prototype.createFillGeometryInstance=de.throwInstantiationError,vc.prototype.createOutlineGeometryInstance=de.throwInstantiationError,vc.prototype.isDestroyed=function(){return!1},vc.prototype.destroy=function(){le(this)},vc.prototype._isHidden=function(e,t){let i=t.show;return u(i)&&i.isConstant&&!i.getValue(ze.MINIMUM_VALUE)},vc.prototype._isOnTerrain=function(e,t){return!1},vc.prototype._getIsClosed=function(e){return!0},vc.prototype._isDynamic=de.throwInstantiationError,vc.prototype._setStaticOptions=de.throwInstantiationError,vc.prototype._onEntityPropertyChanged=function(e,t,i,n){if(-1===this._observedPropertyNames.indexOf(t))return;let r=this._entity[this._geometryPropertyName];if(!u(r))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));let o=r.fill,a=!u(o)||!o.isConstant||o.getValue(ze.MINIMUM_VALUE),s=r.outline,l=u(s);if(l&&s.isConstant&&(l=s.getValue(ze.MINIMUM_VALUE)),!a&&!l)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));let c=r.show;if(this._isHidden(e,r))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));this._materialProperty=y(r.material,_ut),this._fillProperty=y(o,yut),this._showProperty=y(c,gut),this._showOutlineProperty=y(r.outline,xut),this._outlineColorProperty=l?y(r.outlineColor,but):void 0,this._shadowsProperty=y(r.shadows,Tut),this._distanceDisplayConditionProperty=y(r.distanceDisplayCondition,Aut),this._classificationTypeProperty=y(r.classificationType,Cut),this._fillEnabled=a;let h=this._isOnTerrain(e,r)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof Nt);if(l&&h&&(It(It.geometryOutlines),l=!1),this._onTerrain=h,this._outlineEnabled=l,this._isDynamic(e,r))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(e,r),this._isClosed=this._getIsClosed(this._options);let t=r.outlineWidth;this._outlineWidth=u(t)?t.getValue(ze.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}},vc.prototype.createDynamicUpdater=function(e,t){return new this.constructor.DynamicGeometryUpdater(this,e,t)};var si=vc;function jC(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new pe,this.setCallback(e,t)}Object.defineProperties(jC.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}}),jC.prototype.getValue=function(e,t){return this._callback(e,t)},jC.prototype.setCallback=function(e,t){let i=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,i&&this._definitionChanged.raiseEvent(this)},jC.prototype.equals=function(e){return this===e||e instanceof jC&&this._callback===e._callback&&this._isConstant===e._isConstant};var lm=jC,ape=new h,Eut=new fe;function qC(e,t,i,n){this._scene=e,this._heightReference=i,this._extrudedHeightReference=n,this._positionProperty=t,this._position=new h,this._cartographicPosition=new fe,this._normal=new h,this._definitionChanged=new pe,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;let r=this;if(u(e.globe)&&(this._removeEventListener=e.terrainProviderChanged.addEventListener((function(){r._updateClamping()})),this._removeModeListener=e.morphComplete.addEventListener((function(){r._updateClamping()}))),t.isConstant){let i=t.getValue(ze.MINIMUM_VALUE,ape);if(!u(i)||h.equals(i,h.ZERO)||!u(e.globe))return;this._position=h.clone(i,this._position),this._updateClamping(),this._normal=e.globe.ellipsoid.geodeticSurfaceNormal(i,this._normal)}}Object.defineProperties(qC.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),qC.prototype._updateClamping=function(){u(this._removeCallbackFunc)&&this._removeCallbackFunc();let e=this._scene,t=e.globe,i=this._position;if(!u(t)||h.equals(i,h.ZERO))return void(this._terrainHeight=0);let n=t.ellipsoid,r=t._surface,o=this,a=n.cartesianToCartographic(i,this._cartographicPosition),s=t.getHeight(a);u(s)?this._terrainHeight=s:this._terrainHeight=0,this._removeCallbackFunc=r.updateHeight(a,(function(t){if(e.mode===te.SCENE3D){let e=n.cartesianToCartographic(t,Eut);o._terrainHeight=e.height}else o._terrainHeight=t.x;o.definitionChanged.raiseEvent()}))},qC.prototype.getValue=function(e,t){let i=j.getValueOrDefault(this._heightReference,e,We.NONE),n=j.getValueOrDefault(this._extrudedHeightReference,e,We.NONE);if(i===We.NONE&&n!==We.RELATIVE_TO_GROUND)return this._position=h.clone(h.ZERO,this._position),h.clone(h.ZERO,t);if(this._positionProperty.isConstant)return h.multiplyByScalar(this._normal,this._terrainHeight,t);let r=this._scene,o=this._positionProperty.getValue(e,ape);if(!u(o)||h.equals(o,h.ZERO)||!u(r.globe))return h.clone(h.ZERO,t);if(h.equalsEpsilon(this._position,o,P.EPSILON10))return h.multiplyByScalar(this._normal,this._terrainHeight,t);this._position=h.clone(o,this._position),this._updateClamping();let a=r.globe.ellipsoid.geodeticSurfaceNormal(o,this._normal);return h.multiplyByScalar(a,this._terrainHeight,t)},qC.prototype.isDestroyed=function(){return!1},qC.prototype.destroy=function(){return u(this._removeEventListener)&&this._removeEventListener(),u(this._removeModeListener)&&this._removeModeListener(),u(this._removeCallbackFunc)&&this._removeCallbackFunc(),le(this)};var YC=qC;function Sut(e,t,i,n){if(si.prototype._onEntityPropertyChanged.call(this,e,t,i,n),-1===this._observedPropertyNames.indexOf(t))return;let r=this._entity[this._geometryPropertyName];if(!u(r))return;u(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let o=r.heightReference;if(u(o)){let e=new lm(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new YC(this._scene,e,o)}}var ay=Sut,cpe=h.ZERO,lpe=new h,wut=new h,upe=new z;function vut(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function cu(e,t){si.call(this,{entity:e,scene:t,geometryOptions:new vut(e),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function XC(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(cu.prototype=Object.create(si.prototype),cu.prototype.constructor=cu),Object.defineProperties(cu.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),cu.prototype.createFillGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),r=this._distanceDisplayConditionProperty.getValue(e),o={show:n,distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),color:void 0,offset:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(t=this._materialProperty.color.getValue(e,upe)),u(t)||(t=z.WHITE),o.color=kt.fromColor(t)}return u(this._options.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,cpe,lpe))),new yt({id:t,geometry:Dl.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:o})},cu.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,upe),r=this._distanceDisplayConditionProperty.getValue(e),o={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return u(this._options.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,cpe,lpe))),new yt({id:t,geometry:lh.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:o})},cu.prototype._computeCenter=function(e,t){return j.getValueOrUndefined(this._entity.position,e,t)},cu.prototype._isHidden=function(e,t){return!u(t.dimensions)||!u(e.position)||si.prototype._isHidden.call(this,e,t)},cu.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&j.isConstant(e.orientation)&&t.dimensions.isConstant&&j.isConstant(t.outlineWidth))},cu.prototype._setStaticOptions=function(e,t){let i=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof Nt?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,n.dimensions=t.dimensions.getValue(ze.MINIMUM_VALUE,n.dimensions),n.offsetAttribute=i!==We.NONE?on.ALL:void 0},cu.prototype._onEntityPropertyChanged=ay,cu.DynamicGeometryUpdater=XC,u(Object.create)&&(XC.prototype=Object.create(ri.prototype),XC.prototype.constructor=XC),XC.prototype._isHidden=function(e,t,i){let n=j.getValueOrUndefined(e.position,i,wut),r=this._options.dimensions;return!u(n)||!u(r)||ri.prototype._isHidden.call(this,e,t,i)},XC.prototype._setOptions=function(e,t,i){let n=j.getValueOrDefault(t.heightReference,i,We.NONE),r=this._options;r.dimensions=j.getValueOrUndefined(t.dimensions,i,r.dimensions),r.offsetAttribute=n!==We.NONE?on.ALL:void 0};var wU=cu,Dut=new L;function cy(e,t){t.collectionChanged.addEventListener(cy.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._tilesetHash={},this._entitiesToVisualize=new bt,this._onCollectionChanged(t,t.values,[],[])}function B7(e,t,i,n){let r=i[t.id];u(r)&&(u(r.tilesetPrimitive)&&n.removeAndDestroy(r.tilesetPrimitive),delete i[t.id])}async function Iut(e,t,i,n){t[i.id]={url:e.url,loadFail:!1};try{let r=await ca.fromUrl(e);if(r.id=i,n.add(r),!u(t[i.id]))return;t[i.id].tilesetPrimitive=r}catch(e){console.error(e),t[i.id].loadFail=!0}}cy.prototype.update=function(e){let t=this._entitiesToVisualize.values,i=this._tilesetHash,n=this._primitives;for(let r=0,o=t.length;r<o;r++){let o,a,s=t[r],l=s._tileset,c=i[s.id],h=s.isShowing&&s.isAvailable(e)&&j.getValueOrDefault(l._show,e,!0);h&&(a=s.computeModelMatrix(e,Dut),o=ve.createIfNeeded(j.getValueOrUndefined(l._uri,e)));let d=u(c)?c.tilesetPrimitive:void 0;h?((!u(c)||o.url!==c.url)&&(u(d)&&n.removeAndDestroy(d),delete i[s.id],Iut(o,i,s,n)),u(d)&&(d.show=!0,u(a)&&(d.modelMatrix=a),d.maximumScreenSpaceError=j.getValueOrDefault(l.maximumScreenSpaceError,e,d.maximumScreenSpaceError))):u(d)&&(d.show=!1)}return!0},cy.prototype.isDestroyed=function(){return!1},cy.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(cy.prototype._onCollectionChanged,this);let e=this._entitiesToVisualize.values,t=this._tilesetHash,i=this._primitives;for(let n=e.length-1;n>-1;n--)B7(this,e[n],t,i);return le(this)},cy.prototype.getBoundingSphere=function(e,t){let i=this._tilesetHash[e.id];if(!u(i)||i.loadFail)return at.FAILED;let n=i.tilesetPrimitive;return u(n)?n.show?(se.clone(n.boundingSphere,t),at.DONE):at.FAILED:at.PENDING},cy.prototype._onCollectionChanged=function(e,t,i,n){let r,o,a=this._entitiesToVisualize,s=this._tilesetHash,l=this._primitives;for(r=t.length-1;r>-1;r--)o=t[r],u(o._tileset)&&a.set(o.id,o);for(r=n.length-1;r>-1;r--)o=n[r],u(o._tileset)?a.set(o.id,o):(B7(this,o,s,l),a.remove(o.id));for(r=i.length-1;r>-1;r--)o=i[r],B7(this,o,s,l),a.remove(o.id)};var vU=cy,Put=z.WHITE,Out=z.BLACK,Rut=new U(2,2);function KC(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object.defineProperties(KC.prototype,{isConstant:{get:function(){return j.isConstant(this._evenColor)&&j.isConstant(this._oddColor)&&j.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:ae("evenColor"),oddColor:ae("oddColor"),repeat:ae("repeat")}),KC.prototype.getType=function(e){return"Checkerboard"},KC.prototype.getValue=function(e,t){return u(t)||(t={}),t.lightColor=j.getValueOrClonedDefault(this._evenColor,e,Put,t.lightColor),t.darkColor=j.getValueOrClonedDefault(this._oddColor,e,Out,t.darkColor),t.repeat=j.getValueOrDefault(this._repeat,e,Rut),t},KC.prototype.equals=function(e){return this===e||e instanceof KC&&j.equals(this._evenColor,e._evenColor)&&j.equals(this._oddColor,e._oddColor)&&j.equals(this._repeat,e._repeat)};var qD=KC,fpe={id:void 0};function YD(e){if(e._firing)e._refire=!0;else if(0===e._suspendCount){let t=e._addedEntities,i=e._removedEntities,n=e._changedEntities;if(0!==n.length||0!==t.length||0!==i.length){e._firing=!0;do{e._refire=!1;let r=t.values.slice(0),o=i.values.slice(0),a=n.values.slice(0);t.removeAll(),i.removeAll(),n.removeAll(),e._collectionChanged.raiseEvent(e,r,o,a)}while(e._refire);e._firing=!1}}}function Za(e){this._owner=e,this._entities=new bt,this._addedEntities=new bt,this._removedEntities=new bt,this._changedEntities=new bt,this._suspendCount=0,this._collectionChanged=new pe,this._id=jn(),this._show=!0,this._firing=!1,this._refire=!1}Za.prototype.suspendEvents=function(){this._suspendCount++},Za.prototype.resumeEvents=function(){this._suspendCount--,YD(this)},Object.defineProperties(Za.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(e===this._show)return;this.suspendEvents();let t,i=[],n=this._entities.values,r=n.length;for(t=0;t<r;t++)i.push(n[t].isShowing);for(this._show=e,t=0;t<r;t++){let e=i[t],r=n[t];e!==r.isShowing&&r.definitionChanged.raiseEvent(r,"isShowing",r.isShowing,e)}this.resumeEvents()}},owner:{get:function(){return this._owner}}}),Za.prototype.computeAvailability=function(){let e=ze.MAXIMUM_VALUE,t=ze.MINIMUM_VALUE,i=this._entities.values;for(let n=0,r=i.length;n<r;n++){let r=i[n].availability;if(u(r)){let i=r.start,n=r.stop;J.lessThan(i,e)&&!i.equals(ze.MINIMUM_VALUE)&&(e=i),J.greaterThan(n,t)&&!n.equals(ze.MAXIMUM_VALUE)&&(t=n)}}return ze.MAXIMUM_VALUE.equals(e)&&(e=ze.MINIMUM_VALUE),ze.MINIMUM_VALUE.equals(t)&&(t=ze.MAXIMUM_VALUE),new Cn({start:e,stop:t})},Za.prototype.add=function(e){e instanceof er||(e=new er(e));let t=e.id,i=this._entities;if(i.contains(t))throw new ue(`An entity with id ${t} already exists in this collection.`);return e.entityCollection=this,i.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(Za.prototype._onEntityDefinitionChanged,this),YD(this),e},Za.prototype.remove=function(e){return!!u(e)&&this.removeById(e.id)},Za.prototype.contains=function(e){return this._entities.get(e.id)===e},Za.prototype.removeById=function(e){if(!u(e))return!1;let t=this._entities.get(e);return!!this._entities.remove(e)&&(this._addedEntities.remove(e)||(this._removedEntities.set(e,t),this._changedEntities.remove(e)),this._entities.remove(e),t.definitionChanged.removeEventListener(Za.prototype._onEntityDefinitionChanged,this),YD(this),!0)},Za.prototype.removeAll=function(){let e=this._entities,t=e.length,i=e.values,n=this._addedEntities,r=this._removedEntities;for(let e=0;e<t;e++){let t=i[e],o=t.id,a=n.get(o);u(a)||(t.definitionChanged.removeEventListener(Za.prototype._onEntityDefinitionChanged,this),r.set(o,t))}e.removeAll(),n.removeAll(),this._changedEntities.removeAll(),YD(this)},Za.prototype.getById=function(e){return this._entities.get(e)},Za.prototype.getOrCreateEntity=function(e){let t=this._entities.get(e);return u(t)||(fpe.id=e,t=new er(fpe),this.add(t)),t},Za.prototype._onEntityDefinitionChanged=function(e){let t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),YD(this)};var Ks=Za,DU={id:void 0},ZC=new Array(2);function k7(e){let t=e.propertyNames,i=t.length;for(let n=0;n<i;n++)e[t[n]]=void 0;e._name=void 0,e._availability=void 0}function dpe(e,t,i,n){ZC[0]=i,ZC[1]=n.id,t[JSON.stringify(ZC)]=n.definitionChanged.addEventListener(Sr.prototype._onDefinitionChanged,e)}function hpe(e,t,i,n){ZC[0]=i,ZC[1]=n.id;let r=JSON.stringify(ZC);t[r](),t[r]=void 0}function ly(e){if(e._shouldRecomposite=!0,0!==e._suspendCount)return;let t,i,n,r,o,a,s=e._collections,l=s.length,c=e._collectionsCopy,h=c.length,d=e._composite,p=new Ks(e),f=e._eventHash;for(t=0;t<h;t++)for(o=c[t],o.collectionChanged.removeEventListener(Sr.prototype._onCollectionChanged,e),n=o.values,a=o.id,r=n.length-1;r>-1;r--)i=n[r],hpe(e,f,a,i);for(t=l-1;t>=0;t--)for(o=s[t],o.collectionChanged.addEventListener(Sr.prototype._onCollectionChanged,e),n=o.values,a=o.id,r=n.length-1;r>-1;r--){i=n[r],dpe(e,f,a,i);let t=p.getById(i.id);u(t)||(t=d.getById(i.id),u(t)?k7(t):(DU.id=i.id,t=new er(DU)),p.add(t)),t.merge(i)}e._collectionsCopy=s.slice(0),d.suspendEvents(),d.removeAll();let m=p.values;for(t=0;t<m.length;t++)d.add(m[t]);d.resumeEvents()}function Sr(e,t){this._owner=t,this._composite=new Ks(this),this._suspendCount=0,this._collections=u(e)?e.slice():[],this._collectionsCopy=[],this._id=jn(),this._eventHash={},ly(this),this._shouldRecomposite=!1}function IU(e,t){return e.indexOf(t)}function mpe(e,t,i){let n=e._collections;if((t=P.clamp(t,0,n.length-1))===(i=P.clamp(i,0,n.length-1)))return;let r=n[t];n[t]=n[i],n[i]=r,ly(e)}Object.defineProperties(Sr.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}}),Sr.prototype.addCollection=function(e,t){u(t)?this._collections.splice(t,0,e):(t=this._collections.length,this._collections.push(e)),ly(this)},Sr.prototype.removeCollection=function(e){let t=this._collections.indexOf(e);return-1!==t&&(this._collections.splice(t,1),ly(this),!0)},Sr.prototype.removeAllCollections=function(){this._collections.length=0,ly(this)},Sr.prototype.containsCollection=function(e){return-1!==this._collections.indexOf(e)},Sr.prototype.contains=function(e){return this._composite.contains(e)},Sr.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)},Sr.prototype.getCollection=function(e){return this._collections[e]},Sr.prototype.getCollectionsLength=function(){return this._collections.length},Sr.prototype.raiseCollection=function(e){let t=IU(this._collections,e);mpe(this,t,t+1)},Sr.prototype.lowerCollection=function(e){let t=IU(this._collections,e);mpe(this,t,t-1)},Sr.prototype.raiseCollectionToTop=function(e){let t=IU(this._collections,e);t!==this._collections.length-1&&(this._collections.splice(t,1),this._collections.push(e),ly(this))},Sr.prototype.lowerCollectionToBottom=function(e){let t=IU(this._collections,e);0!==t&&(this._collections.splice(t,1),this._collections.splice(0,0,e),ly(this))},Sr.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()},Sr.prototype.resumeEvents=function(){this._suspendCount--,this._shouldRecomposite&&0===this._suspendCount&&(ly(this),this._shouldRecomposite=!1),this._composite.resumeEvents()},Sr.prototype.computeAvailability=function(){return this._composite.computeAvailability()},Sr.prototype.getById=function(e){return this._composite.getById(e)},Sr.prototype._onCollectionChanged=function(e,t,i){let n=this._collectionsCopy,r=n.length,o=this._composite;o.suspendEvents();let a,s,l,c,h=i.length,d=this._eventHash,p=e.id;for(a=0;a<h;a++){let e=i[a];hpe(this,d,p,e);let t=e.id;for(s=r-1;s>=0;s--)l=n[s].getById(t),u(l)&&(u(c)||(c=o.getById(t),k7(c)),c.merge(l));u(c)||o.removeById(t),c=void 0}let f=t.length;for(a=0;a<f;a++){let e=t[a];dpe(this,d,p,e);let i=e.id;for(s=r-1;s>=0;s--)l=n[s].getById(i),u(l)&&(u(c)||(c=o.getById(i),u(c)?k7(c):(DU.id=i,c=new er(DU),o.add(c))),c.merge(l));c=void 0}o.resumeEvents()},Sr.prototype._onDefinitionChanged=function(e,t,i,n){let r=this._collections,o=this._composite,a=r.length,s=e.id,l=o.getById(s),c=l[t],h=!u(c),d=!0;for(let i=a-1;i>=0;i--){let n=r[i].getById(e.id);if(u(n)){let e=n[t];if(u(e)){if(d){if(d=!1,!u(e.merge)||!u(e.clone)){c=e;break}c=e.clone(c)}c.merge(e)}}}h&&-1===l.propertyNames.indexOf(t)&&l.addProperty(t),l[t]=c};var ppe=Sr;function Mut(e,t,i,n){function r(){i.raiseEvent(e)}let o=[];t.removeAll();let a=n.length;for(let e=0;e<a;e++){let i=n.get(e);u(i.data)&&-1===o.indexOf(i.data)&&t.add(i.data.definitionChanged,r)}}function Yx(){this._eventHelper=new Pr,this._definitionChanged=new pe,this._intervals=new Mr,this._intervals.changedEvent.addEventListener(Yx.prototype._intervalsChanged,this)}Object.defineProperties(Yx.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),Yx.prototype.getValue=function(e,t){let i=this._intervals.findDataForIntervalContainingDate(e);if(u(i))return i.getValue(e,t)},Yx.prototype.equals=function(e){return this===e||e instanceof Yx&&this._intervals.equals(e._intervals,j.equals)},Yx.prototype._intervalsChanged=function(){Mut(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var Dc=Yx;function uy(){this._definitionChanged=new pe,this._composite=new Dc,this._composite.definitionChanged.addEventListener(uy.prototype._raiseDefinitionChanged,this)}Object.defineProperties(uy.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}}),uy.prototype.getType=function(e){let t=this._composite._intervals.findDataForIntervalContainingDate(e);if(u(t))return t.getType(e)},uy.prototype.getValue=function(e,t){let i=this._composite._intervals.findDataForIntervalContainingDate(e);if(u(i))return i.getValue(e,t)},uy.prototype.equals=function(e){return this===e||e instanceof uy&&this._composite.equals(e._composite,j.equals)},uy.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var XD=uy;function fy(e){this._referenceFrame=y(e,to.FIXED),this._definitionChanged=new pe,this._composite=new Dc,this._composite.definitionChanged.addEventListener(fy.prototype._raiseDefinitionChanged,this)}Object.defineProperties(fy.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}}),fy.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,to.FIXED,t)},fy.prototype.getValueInReferenceFrame=function(e,t,i){let n=this._composite._intervals.findDataForIntervalContainingDate(e);if(u(n))return n.getValueInReferenceFrame(e,t,i)},fy.prototype.equals=function(e){return this===e||e instanceof fy&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,j.equals)},fy.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var ma=fy,Lut=new Zn(0);function Ic(e){si.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}u(Object.create)&&(Ic.prototype=Object.create(si.prototype),Ic.prototype.constructor=Ic),Object.defineProperties(Ic.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),Ic.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!u(t.height)&&!u(t.extrudedHeight)&&pl.isSupported(this._scene)},Ic.prototype._getIsClosed=function(e){let t=e.height,i=e.extrudedHeight;return 0===t||u(i)&&i!==t},Ic.prototype._computeCenter=de.throwInstantiationError,Ic.prototype._onEntityPropertyChanged=function(e,t,i,n){if(si.prototype._onEntityPropertyChanged.call(this,e,t,i,n),-1===this._observedPropertyNames.indexOf(t))return;let r=this._entity[this._geometryPropertyName];if(!u(r))return;u(r.zIndex)&&(u(r.height)||u(r.extrudedHeight))&&It(It.geometryZIndex),this._zIndex=y(r.zIndex,Lut),u(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);let o=r.heightReference,a=r.extrudedHeightReference;if(u(o)||u(a)){let e=new lm(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new YC(this._scene,e,o,a)}},Ic.prototype.destroy=function(){u(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0),si.prototype.destroy.call(this)},Ic.getGeometryHeight=function(e,t){if(u(e))return t!==We.CLAMP_TO_GROUND?e:0;t!==We.NONE&&It(It.geometryHeightReference)},Ic.getGeometryExtrudedHeight=function(e,t){if(u(e))return t!==We.CLAMP_TO_GROUND?e:Ic.CLAMP_TO_GROUND;t!==We.NONE&&It(It.geometryExtrudedHeightReference)},Ic.CLAMP_TO_GROUND="clamp",Ic.computeGeometryOffsetAttribute=function(e,t,i,n){(!u(e)||!u(t))&&(t=We.NONE),(!u(i)||!u(n))&&(n=We.NONE);let r=0;return t!==We.NONE&&r++,n===We.RELATIVE_TO_GROUND&&r++,2===r?on.ALL:1===r?on.TOP:void 0};var qn=Ic,_pe=new z,gpe=h.ZERO,ype=new h,xpe=new ce;function Nut(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function Id(e,t){qn.call(this,{entity:e,scene:t,geometryOptions:new Nut(e),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function $C(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(Id.prototype=Object.create(qn.prototype),Id.prototype.constructor=Id),Id.prototype.createFillGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(t=this._materialProperty.color.getValue(e,_pe)),u(t)||(t=z.WHITE),n.color=kt.fromColor(t)}return u(this._options.offsetAttribute)&&(n.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,gpe,ype))),new yt({id:t,geometry:new lT(this._options),attributes:n})},Id.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,_pe),r={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return u(this._options.offsetAttribute)&&(r.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,gpe,ype))),new yt({id:t,geometry:new I1(this._options),attributes:r})},Id.prototype._computeCenter=function(e,t){let i=j.getValueOrUndefined(this._entity.corridor.positions,e);if(u(i)&&0!==i.length)return h.clone(i[Math.floor(i.length/2)],t)},Id.prototype._isHidden=function(e,t){return!u(t.positions)||!u(t.width)||si.prototype._isHidden.call(this,e,t)},Id.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!j.isConstant(t.height)||!j.isConstant(t.extrudedHeight)||!j.isConstant(t.granularity)||!j.isConstant(t.width)||!j.isConstant(t.outlineWidth)||!j.isConstant(t.cornerType)||!j.isConstant(t.zIndex)||this._onTerrain&&!j.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Nt)},Id.prototype._setStaticOptions=function(e,t){let i=j.getValueOrUndefined(t.height,ze.MINIMUM_VALUE),n=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),r=j.getValueOrUndefined(t.extrudedHeight,ze.MINIMUM_VALUE),o=j.getValueOrDefault(t.extrudedHeightReference,ze.MINIMUM_VALUE,We.NONE);u(r)&&!u(i)&&(i=0);let a=this._options;a.vertexFormat=this._materialProperty instanceof Nt?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,a.positions=t.positions.getValue(ze.MINIMUM_VALUE,a.positions),a.width=t.width.getValue(ze.MINIMUM_VALUE),a.granularity=j.getValueOrUndefined(t.granularity,ze.MINIMUM_VALUE),a.cornerType=j.getValueOrUndefined(t.cornerType,ze.MINIMUM_VALUE),a.offsetAttribute=qn.computeGeometryOffsetAttribute(i,n,r,o),a.height=qn.getGeometryHeight(i,n),r=qn.getGeometryExtrudedHeight(r,o),r===qn.CLAMP_TO_GROUND&&(r=li.getMinimumMaximumHeights(lT.computeRectangle(a,xpe)).minimumTerrainHeight),a.extrudedHeight=r},Id.DynamicGeometryUpdater=$C,u(Object.create)&&($C.prototype=Object.create(ri.prototype),$C.prototype.constructor=$C),$C.prototype._isHidden=function(e,t,i){let n=this._options;return!u(n.positions)||!u(n.width)||ri.prototype._isHidden.call(this,e,t,i)},$C.prototype._setOptions=function(e,t,i){let n=this._options,r=j.getValueOrUndefined(t.height,i),o=j.getValueOrDefault(t.heightReference,i,We.NONE),a=j.getValueOrUndefined(t.extrudedHeight,i),s=j.getValueOrDefault(t.extrudedHeightReference,i,We.NONE);u(a)&&!u(r)&&(r=0),n.positions=j.getValueOrUndefined(t.positions,i),n.width=j.getValueOrUndefined(t.width,i),n.granularity=j.getValueOrUndefined(t.granularity,i),n.cornerType=j.getValueOrUndefined(t.cornerType,i),n.offsetAttribute=qn.computeGeometryOffsetAttribute(r,o,a,s),n.height=qn.getGeometryHeight(r,o),a=qn.getGeometryExtrudedHeight(a,s),a===qn.CLAMP_TO_GROUND&&(a=li.getMinimumMaximumHeights(lT.computeRectangle(n,xpe)).minimumTerrainHeight),n.extrudedHeight=a};var PU=Id;function OU(){de.throwInstantiationError()}Object.defineProperties(OU.prototype,{name:{get:de.throwInstantiationError},clock:{get:de.throwInstantiationError},entities:{get:de.throwInstantiationError},isLoading:{get:de.throwInstantiationError},changedEvent:{get:de.throwInstantiationError},errorEvent:{get:de.throwInstantiationError},loadingEvent:{get:de.throwInstantiationError},show:{get:de.throwInstantiationError},clustering:{get:de.throwInstantiationError}}),OU.prototype.update=function(e){de.throwInstantiationError()},OU.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))};var Nr=OU,bpe=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],V7=1,KD=8,$D=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[i,n]=new Uint8Array(t,0,2);if(219!==i)throw new Error("Data does not appear to be in a KDBush format.");let r=n>>4;if(r!==V7)throw new Error(`Got v${r} data when expected v${V7}.`);let o=bpe[15&n];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new e(s,a,o,t)}constructor(e,t=64,i=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let r=bpe.indexOf(this.ArrayType),o=2*e*this.ArrayType.BYTES_PER_ELEMENT,a=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-a%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${i}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,KD,e),this.coords=new this.ArrayType(this.data,KD+a+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(KD+o+a+s),this.ids=new this.IndexArrayType(this.data,KD,e),this.coords=new this.ArrayType(this.data,KD+a+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(V7<<4)+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=t,i}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return z7(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,i,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:r,coords:o,nodeSize:a}=this,s=[0,r.length-1,0],l=[];for(;s.length;){let u=s.pop()||0,c=s.pop()||0,h=s.pop()||0;if(c-h<=a){for(let a=h;a<=c;a++){let s=o[2*a],u=o[2*a+1];s>=e&&s<=i&&u>=t&&u<=n&&l.push(r[a])}continue}let d=h+c>>1,p=o[2*d],f=o[2*d+1];p>=e&&p<=i&&f>=t&&f<=n&&l.push(r[d]),(0===u?e<=p:t<=f)&&(s.push(h),s.push(d-1),s.push(1-u)),(0===u?i>=p:n>=f)&&(s.push(d+1),s.push(c),s.push(1-u))}return l}within(e,t,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:n,coords:r,nodeSize:o}=this,a=[0,n.length-1,0],s=[],l=i*i;for(;a.length;){let u=a.pop()||0,c=a.pop()||0,h=a.pop()||0;if(c-h<=o){for(let i=h;i<=c;i++)Tpe(r[2*i],r[2*i+1],e,t)<=l&&s.push(n[i]);continue}let d=h+c>>1,p=r[2*d],f=r[2*d+1];Tpe(p,f,e,t)<=l&&s.push(n[d]),(0===u?e-i<=p:t-i<=f)&&(a.push(h),a.push(d-1),a.push(1-u)),(0===u?e+i>=p:t+i>=f)&&(a.push(d+1),a.push(c),a.push(1-u))}return s}};function z7(e,t,i,n,r,o){if(r-n<=i)return;let a=n+r>>1;Ape(e,t,a,n,r,o),z7(e,t,i,n,a-1,1-o),z7(e,t,i,a+1,r,1-o)}function Ape(e,t,i,n,r,o){for(;r>n;){if(r-n>600){let a=r-n+1,s=i-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);Ape(e,t,i,Math.max(n,Math.floor(i-s*u/a+c)),Math.min(r,Math.floor(i+(a-s)*u/a+c)),o)}let a=t[2*i+o],s=n,l=r;for(ZD(e,t,n,i),t[2*r+o]>a&&ZD(e,t,n,r);s<l;){for(ZD(e,t,s,l),s++,l--;t[2*s+o]<a;)s++;for(;t[2*l+o]>a;)l--}t[2*n+o]===a?ZD(e,t,n,l):(l++,ZD(e,t,l,r)),l<=i&&(n=l+1),i<=l&&(r=l-1)}}function ZD(e,t,i,n){U7(e,i,n),U7(t,2*i,2*n),U7(t,2*i+1,2*n+1)}function U7(e,t,i){let n=e[t];e[t]=e[i],e[i]=n}function Tpe(e,t,i,n){let r=e-i,o=t-n;return r*r+o*o}function Pd(e){e=y(e,y.EMPTY_OBJECT),this._enabled=y(e.enabled,!1),this._pixelRange=y(e.pixelRange,80),this._minimumClusterSize=y(e.minimumClusterSize,2),this._clusterBillboards=y(e.clusterBillboards,!0),this._clusterLabels=y(e.clusterLabels,!0),this._clusterPoints=y(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new pe,this.show=y(e.show,!0)}function Cpe(e,t){e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t}var Fut=new qe;function Epe(e,t,i,n,r){if(u(e._labelCollection)&&n._clusterLabels?r=rx.getScreenSpaceBoundingBox(e,t,r):u(e._billboardCollection)&&n._clusterBillboards?r=mo.getScreenSpaceBoundingBox(e,t,r):u(e._pointPrimitiveCollection)&&n._clusterPoints&&(r=Ys.getScreenSpaceBoundingBox(e,t,r)),Cpe(r,i),n._clusterLabels&&!u(e._labelCollection)&&u(e.id)&&wpe(n,e.id.id)&&u(e.id._label)){let o=n._collectionIndicesByEntity[e.id.id].labelIndex,a=n._labelCollection.get(o),s=rx.getScreenSpaceBoundingBox(a,t,Fut);Cpe(s,i),r=qe.union(r,s,r)}return r}function But(e,t){if(e.clusterShow=!0,!u(e._labelCollection)&&u(e.id)&&wpe(t,e.id.id)&&u(e.id._label)){let i=t._collectionIndicesByEntity[e.id.id].labelIndex;t._labelCollection.get(i).clusterShow=!0}}function Spe(e,t,i,n){let r={billboard:n._clusterBillboardCollection.add(),label:n._clusterLabelCollection.add(),point:n._clusterPointCollection.add()};r.billboard.show=!1,r.point.show=!1,r.label.show=!0,r.label.text=t.toLocaleString(),r.label.id=i,r.billboard.position=r.label.position=r.point.position=e,n._clusterEvent.raiseEvent(i,r)}function wpe(e,t){return u(e)&&u(e._collectionIndicesByEntity[t])&&u(e._collectionIndicesByEntity[t].labelIndex)}function H7(e,t,i,n,r){if(!u(e))return;let o=e.length;for(let a=0;a<o;++a){let o=e.get(a);if(o.clusterShow=!1,!o.show||r._scene.mode===te.SCENE3D&&!n.isPointVisible(o.position))continue;let s=r._clusterLabels&&u(o._labelCollection),l=r._clusterBillboards&&u(o.id._billboard),c=r._clusterPoints&&u(o.id._point);if(s&&(c||l))continue;let h=o.computeScreenSpacePosition(i);u(h)&&t.push({index:a,collection:e,clustered:!1,coord:h})}}var kut=new qe,Vut=new qe,Uut=new qe;function zut(e){return function(t){if(u(t)&&t<.05||!e.enabled)return;let i=e._scene,n=e._labelCollection,r=e._billboardCollection,o=e._pointCollection;if(!u(n)&&!u(r)&&!u(o)||!e._clusterBillboards&&!e._clusterLabels&&!e._clusterPoints)return;let a=e._clusterLabelCollection,s=e._clusterBillboardCollection,l=e._clusterPointCollection;u(a)?a.removeAll():a=e._clusterLabelCollection=new bp({scene:i}),u(s)?s.removeAll():s=e._clusterBillboardCollection=new $u({scene:i}),u(l)?l.removeAll():l=e._clusterPointCollection=new sD;let c,d,p,f,m,_,g,y,v,b,A,T,E=e._pixelRange,C=e._minimumClusterSize,x=e._previousClusters,S=[],w=e._previousHeight,I=i.camera.positionCartographic.height,P=i.mapProjection.ellipsoid,D=i.camera.positionWC,O=new i_(P,D),R=[];if(e._clusterLabels&&H7(n,R,i,O,e),e._clusterBillboards&&H7(r,R,i,O,e),e._clusterPoints&&H7(o,R,i,O,e),R.length>0){let t=new $D(R.length,64,Uint32Array);for(let e=0;e<R.length;++e)t.add(R[e].coord.x,R[e].coord.y);if(t.finish(),I<w)for(p=x.length,c=0;c<p;++c){let n=x[c];if(!O.isPointVisible(n.position))continue;let r=mo._computeScreenSpacePosition(L.IDENTITY,n.position,h.ZERO,U.ZERO,i);if(!u(r))continue;let o=1-I/w,a=n.width=n.width*o,s=n.height=n.height*o;a=Math.max(a,n.minimumWidth),s=Math.max(s,n.minimumHeight);let l=r.x-.5*a,p=r.y-.5*s,f=r.x+a,E=r.y+s;for(m=t.range(l,p,f,E),_=m.length,b=0,v=[],d=0;d<_;++d)g=m[d],y=R[g],y.clustered||(++b,A=y.collection,T=y.index,v.push(A.get(T).id));if(b>=C)for(Spe(n.position,b,v,e),S.push(n),d=0;d<_;++d)R[m[d]].clustered=!0}for(p=R.length,c=0;c<p;++c){let i=R[c];if(i.clustered)continue;i.clustered=!0,A=i.collection,T=i.index;let n=A.get(T);f=Epe(n,i.coord,E,e,kut);let r=qe.clone(f,Vut);m=t.range(f.x,f.y,f.x+f.width,f.y+f.height),_=m.length;let o=h.clone(n.position);for(b=1,v=[n.id],d=0;d<_;++d)if(g=m[d],y=R[g],!y.clustered){let t=y.collection.get(y.index),i=Epe(t,y.coord,E,e,Uut);h.add(t.position,o,o),qe.union(r,i,r),++b,v.push(t.id)}if(b>=C){let t=h.multiplyByScalar(o,1/b,o);for(Spe(t,b,v,e),S.push({position:t,width:r.width,height:r.height,minimumWidth:f.width,minimumHeight:f.height}),d=0;d<_;++d)R[m[d]].clustered=!0}else But(n,e)}}0===a.length&&(a.destroy(),e._clusterLabelCollection=void 0),0===s.length&&(s.destroy(),e._clusterBillboardCollection=void 0),0===l.length&&(l.destroy(),e._clusterPointCollection=void 0),e._previousClusters=S,e._previousHeight=I}}function W7(e,t,i,n){return function(r){let o=this[e];u(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});let a=this._collectionIndicesByEntity[r.id];if(u(a)||(a=this._collectionIndicesByEntity[r.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),u(o)&&u(a[n]))return o.get(a[n]);u(o)||(o=this[e]=new t({scene:this._scene}));let s,l,c=this[i];c.length>0?(s=c.shift(),l=o.get(s)):(l=o.add(),s=o.length-1),a[n]=s;let h=this;return Promise.resolve().then((function(){h._clusterDirty=!0})),l}}function j7(e,t){let i=e._collectionIndicesByEntity[t];!u(i.billboardIndex)&&!u(i.labelIndex)&&!u(i.pointIndex)&&delete e._collectionIndicesByEntity[t]}function G7(e){if(!u(e))return;let t=e.length;for(let i=0;i<t;++i)e.get(i).clusterShow=!0}function Hut(e){e.enabled||(u(e._clusterLabelCollection)&&e._clusterLabelCollection.destroy(),u(e._clusterBillboardCollection)&&e._clusterBillboardCollection.destroy(),u(e._clusterPointCollection)&&e._clusterPointCollection.destroy(),e._clusterLabelCollection=void 0,e._clusterBillboardCollection=void 0,e._clusterPointCollection=void 0,G7(e._labelCollection),G7(e._billboardCollection),G7(e._pointCollection))}Pd.prototype._initialize=function(e){this._scene=e;let t=zut(this);this._cluster=t,this._removeEventListener=e.camera.changed.addEventListener(t)},Object.defineProperties(Pd.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}}),Pd.prototype.getLabel=W7("_labelCollection",bp,"_unusedLabelIndices","labelIndex"),Pd.prototype.removeLabel=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!u(this._labelCollection)||!u(t)||!u(t.labelIndex))return;let i=t.labelIndex;t.labelIndex=void 0,j7(this,e.id);let n=this._labelCollection.get(i);n.show=!1,n.text="",n.id=void 0,this._unusedLabelIndices.push(i),this._clusterDirty=!0},Pd.prototype.getBillboard=W7("_billboardCollection",$u,"_unusedBillboardIndices","billboardIndex"),Pd.prototype.removeBillboard=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!u(this._billboardCollection)||!u(t)||!u(t.billboardIndex))return;let i=t.billboardIndex;t.billboardIndex=void 0,j7(this,e.id);let n=this._billboardCollection.get(i);n.id=void 0,n.show=!1,n.image=void 0,this._unusedBillboardIndices.push(i),this._clusterDirty=!0},Pd.prototype.getPoint=W7("_pointCollection",sD,"_unusedPointIndices","pointIndex"),Pd.prototype.removePoint=function(e){let t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(!u(this._pointCollection)||!u(t)||!u(t.pointIndex))return;let i=t.pointIndex;t.pointIndex=void 0,j7(this,e.id);let n=this._pointCollection.get(i);n.show=!1,n.id=void 0,this._unusedPointIndices.push(i),this._clusterDirty=!0},Pd.prototype.update=function(e){if(!this.show)return;let t;u(this._labelCollection)&&this._labelCollection.length>0&&0===this._labelCollection.get(0)._glyphs.length&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),u(this._billboardCollection)&&this._billboardCollection.length>0&&!u(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,Hut(this),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),u(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),u(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),u(this._clusterPointCollection)&&this._clusterPointCollection.update(e),u(this._labelCollection)&&this._labelCollection.update(e),u(this._billboardCollection)&&this._billboardCollection.update(e),u(this._pointCollection)&&this._pointCollection.update(e)},Pd.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),u(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var bf=Pd;function q7(e){this._name=e,this._clock=void 0,this._changed=new pe,this._error=new pe,this._isLoading=!1,this._loading=new pe,this._entityCollection=new Ks(this),this._entityCluster=new bf}Object.defineProperties(q7.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){Nr.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}}),q7.prototype.update=function(e){return!0};var RU=q7,vpe=h.ZERO,Dpe=new h,Gut=new h,Ipe=new z;function Wut(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function lu(e,t){si.call(this,{entity:e,scene:t,geometryOptions:new Wut(e),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function QC(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(lu.prototype=Object.create(si.prototype),lu.prototype.constructor=lu),Object.defineProperties(lu.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),lu.prototype.createFillGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),r=this._distanceDisplayConditionProperty.getValue(e),o={show:n,distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),color:void 0,offset:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(t=this._materialProperty.color.getValue(e,Ipe)),u(t)||(t=z.WHITE),o.color=kt.fromColor(t)}return u(this._options.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,vpe,Dpe))),new yt({id:t,geometry:new P1(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:o})},lu.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,Ipe),r=this._distanceDisplayConditionProperty.getValue(e),o={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return u(this._options.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,vpe,Dpe))),new yt({id:t,geometry:new O1(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:o})},lu.prototype._computeCenter=function(e,t){return j.getValueOrUndefined(this._entity.position,e,t)},lu.prototype._isHidden=function(e,t){return!u(e.position)||!u(t.length)||!u(t.topRadius)||!u(t.bottomRadius)||si.prototype._isHidden.call(this,e,t)},lu.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&j.isConstant(e.orientation)&&t.length.isConstant&&t.topRadius.isConstant&&t.bottomRadius.isConstant&&j.isConstant(t.slices)&&j.isConstant(t.outlineWidth)&&j.isConstant(t.numberOfVerticalLines))},lu.prototype._setStaticOptions=function(e,t){let i=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof Nt?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,n.length=t.length.getValue(ze.MINIMUM_VALUE),n.topRadius=t.topRadius.getValue(ze.MINIMUM_VALUE),n.bottomRadius=t.bottomRadius.getValue(ze.MINIMUM_VALUE),n.slices=j.getValueOrUndefined(t.slices,ze.MINIMUM_VALUE),n.numberOfVerticalLines=j.getValueOrUndefined(t.numberOfVerticalLines,ze.MINIMUM_VALUE),n.offsetAttribute=i!==We.NONE?on.ALL:void 0},lu.prototype._onEntityPropertyChanged=ay,lu.DynamicGeometryUpdater=QC,u(Object.create)&&(QC.prototype=Object.create(ri.prototype),QC.prototype.constructor=QC),QC.prototype._isHidden=function(e,t,i){let n=this._options,r=j.getValueOrUndefined(e.position,i,Gut);return!u(r)||!u(n.length)||!u(n.topRadius)||!u(n.bottomRadius)||ri.prototype._isHidden.call(this,e,t,i)},QC.prototype._setOptions=function(e,t,i){let n=j.getValueOrDefault(t.heightReference,i,We.NONE),r=this._options;r.length=j.getValueOrUndefined(t.length,i),r.topRadius=j.getValueOrUndefined(t.topRadius,i),r.bottomRadius=j.getValueOrUndefined(t.bottomRadius,i),r.slices=j.getValueOrUndefined(t.slices,i),r.numberOfVerticalLines=j.getValueOrUndefined(t.numberOfVerticalLines,i),r.offsetAttribute=n!==We.NONE?on.ALL:void 0};var MU=lu,aI=or(Sl(),1);function Xx(){this._definitionChanged=new pe,this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0}Object.defineProperties(Xx.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:su("startTime"),stopTime:su("stopTime"),currentTime:su("currentTime"),clockRange:su("clockRange"),clockStep:su("clockStep"),multiplier:su("multiplier")}),Xx.prototype.clone=function(e){return u(e)||(e=new Xx),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e},Xx.prototype.equals=function(e){return this===e||u(e)&&J.equals(this.startTime,e.startTime)&&J.equals(this.stopTime,e.stopTime)&&J.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier},Xx.prototype.merge=function(e){this.startTime=y(this.startTime,e.startTime),this.stopTime=y(this.stopTime,e.stopTime),this.currentTime=y(this.currentTime,e.currentTime),this.clockRange=y(this.clockRange,e.clockRange),this.clockStep=y(this.clockStep,e.clockStep),this.multiplier=y(this.multiplier,e.multiplier)},Xx.prototype.getValue=function(e){return u(e)||(e=new ph),e.startTime=y(this.startTime,e.startTime),e.stopTime=y(this.stopTime,e.stopTime),e.currentTime=y(this.currentTime,e.currentTime),e.clockRange=y(this.clockRange,e.clockRange),e.multiplier=y(this.multiplier,e.multiplier),e.clockStep=y(this.clockStep,e.clockStep),e};var um=Xx,jut=z.WHITE,qut=.1,Yut=new U(8,8),Xut=new U(0,0),Kut=new U(1,1);function JC(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object.defineProperties(JC.prototype,{isConstant:{get:function(){return j.isConstant(this._color)&&j.isConstant(this._cellAlpha)&&j.isConstant(this._lineCount)&&j.isConstant(this._lineThickness)&&j.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ae("color"),cellAlpha:ae("cellAlpha"),lineCount:ae("lineCount"),lineThickness:ae("lineThickness"),lineOffset:ae("lineOffset")}),JC.prototype.getType=function(e){return"Grid"},JC.prototype.getValue=function(e,t){return u(t)||(t={}),t.color=j.getValueOrClonedDefault(this._color,e,jut,t.color),t.cellAlpha=j.getValueOrDefault(this._cellAlpha,e,qut),t.lineCount=j.getValueOrClonedDefault(this._lineCount,e,Yut,t.lineCount),t.lineThickness=j.getValueOrClonedDefault(this._lineThickness,e,Kut,t.lineThickness),t.lineOffset=j.getValueOrClonedDefault(this._lineOffset,e,Xut,t.lineOffset),t},JC.prototype.equals=function(e){return this===e||e instanceof JC&&j.equals(this._color,e._color)&&j.equals(this._cellAlpha,e._cellAlpha)&&j.equals(this._lineCount,e._lineCount)&&j.equals(this._lineThickness,e._lineThickness)&&j.equals(this._lineOffset,e._lineOffset)};var QD=JC;function eE(e){this._definitionChanged=new pe,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object.defineProperties(eE.prototype,{isConstant:{get:function(){return j.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ae("color")}),eE.prototype.getType=function(e){return"PolylineArrow"},eE.prototype.getValue=function(e,t){return u(t)||(t={}),t.color=j.getValueOrClonedDefault(this._color,e,z.WHITE,t.color),t},eE.prototype.equals=function(e){return this===e||e instanceof eE&&j.equals(this._color,e._color)};var JD=eE,Zut=z.WHITE,$ut=z.TRANSPARENT,Qut=16,Jut=255;function tE(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object.defineProperties(tE.prototype,{isConstant:{get:function(){return j.isConstant(this._color)&&j.isConstant(this._gapColor)&&j.isConstant(this._dashLength)&&j.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ae("color"),gapColor:ae("gapColor"),dashLength:ae("dashLength"),dashPattern:ae("dashPattern")}),tE.prototype.getType=function(e){return"PolylineDash"},tE.prototype.getValue=function(e,t){return u(t)||(t={}),t.color=j.getValueOrClonedDefault(this._color,e,Zut,t.color),t.gapColor=j.getValueOrClonedDefault(this._gapColor,e,$ut,t.gapColor),t.dashLength=j.getValueOrDefault(this._dashLength,e,Qut,t.dashLength),t.dashPattern=j.getValueOrDefault(this._dashPattern,e,Jut,t.dashPattern),t},tE.prototype.equals=function(e){return this===e||e instanceof tE&&j.equals(this._color,e._color)&&j.equals(this._gapColor,e._gapColor)&&j.equals(this._dashLength,e._dashLength)&&j.equals(this._dashPattern,e._dashPattern)};var eI=tE,eft=z.WHITE,tft=.25,nft=1;function nE(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this._taperPower=void 0,this._taperPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower,this.taperPower=e.taperPower}Object.defineProperties(nE.prototype,{isConstant:{get:function(){return j.isConstant(this._color)&&j.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ae("color"),glowPower:ae("glowPower"),taperPower:ae("taperPower")}),nE.prototype.getType=function(e){return"PolylineGlow"},nE.prototype.getValue=function(e,t){return u(t)||(t={}),t.color=j.getValueOrClonedDefault(this._color,e,eft,t.color),t.glowPower=j.getValueOrDefault(this._glowPower,e,tft,t.glowPower),t.taperPower=j.getValueOrDefault(this._taperPower,e,nft,t.taperPower),t},nE.prototype.equals=function(e){return this===e||e instanceof nE&&j.equals(this._color,e._color)&&j.equals(this._glowPower,e._glowPower)&&j.equals(this._taperPower,e._taperPower)};var tI=nE,ift=z.WHITE,oft=z.BLACK,rft=1;function iE(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object.defineProperties(iE.prototype,{isConstant:{get:function(){return j.isConstant(this._color)&&j.isConstant(this._outlineColor)&&j.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:ae("color"),outlineColor:ae("outlineColor"),outlineWidth:ae("outlineWidth")}),iE.prototype.getType=function(e){return"PolylineOutline"},iE.prototype.getValue=function(e,t){return u(t)||(t={}),t.color=j.getValueOrClonedDefault(this._color,e,ift,t.color),t.outlineColor=j.getValueOrClonedDefault(this._outlineColor,e,oft,t.outlineColor),t.outlineWidth=j.getValueOrDefault(this._outlineWidth,e,rft),t},iE.prototype.equals=function(e){return this===e||e instanceof iE&&j.equals(this._color,e._color)&&j.equals(this._outlineColor,e._outlineColor)&&j.equals(this._outlineWidth,e._outlineWidth)};var Kx=iE;function Xp(e,t){this._value=void 0,this._definitionChanged=new pe,this._eventHelper=new Pr,this._referenceFrame=y(t,to.FIXED),this.setValue(e)}Object.defineProperties(Xp.prototype,{isConstant:{get:function(){let e=this._value;if(!u(e))return!0;let t=e.length;for(let i=0;i<t;i++)if(!j.isConstant(e[i]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),Xp.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,to.FIXED,t)},Xp.prototype.getValueInReferenceFrame=function(e,t,i){let n=this._value;if(!u(n))return;let r=n.length;u(i)||(i=new Array(r));let o=0,a=0;for(;o<r;){let r=n[o].getValueInReferenceFrame(e,t,i[o]);u(r)&&(i[a]=r,a++),o++}return i.length=a,i},Xp.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),u(e)){this._value=e.slice();let i=e.length;for(let n=0;n<i;n++){let i=e[n];u(i)&&t.add(i.definitionChanged,Xp.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},Xp.prototype.equals=function(e){return this===e||e instanceof Xp&&this._referenceFrame===e._referenceFrame&&j.arrayEquals(this._value,e._value)},Xp.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var dy=Xp;function hy(e){this._value=void 0,this._definitionChanged=new pe,this._eventHelper=new Pr,this.setValue(e)}Object.defineProperties(hy.prototype,{isConstant:{get:function(){let e=this._value;if(!u(e))return!0;let t=e.length;for(let i=0;i<t;i++)if(!j.isConstant(e[i]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),hy.prototype.getValue=function(e,t){let i=this._value;if(!u(i))return;let n=i.length;u(t)||(t=new Array(n));let r=0,o=0;for(;r<n;){let i=this._value[r].getValue(e,t[r]);u(i)&&(t[o]=i,o++),r++}return t.length=o,t},hy.prototype.setValue=function(e){let t=this._eventHelper;if(t.removeAll(),u(e)){this._value=e.slice();let i=e.length;for(let n=0;n<i;n++){let i=e[n];u(i)&&t.add(i.definitionChanged,hy.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},hy.prototype.equals=function(e){return this===e||e instanceof hy&&j.arrayEquals(this._value,e._value)},hy.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var nI=hy;function Zx(e){let t=e._targetProperty;if(!u(t)){let i=e._targetEntity;if(!u(i)){if(i=e._targetCollection.getById(e._targetId),!u(i))return void(e._targetEntity=e._targetProperty=void 0);i.definitionChanged.addEventListener(uu.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=i}let n=e._targetPropertyNames;t=e._targetEntity;for(let e=0,i=n.length;e<i&&u(t);++e)t=t[n[e]];e._targetProperty=t}return t}function uu(e,t,i){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=i,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new pe,e.collectionChanged.addEventListener(uu.prototype._onCollectionChanged,this)}Object.defineProperties(uu.prototype,{isConstant:{get:function(){return j.isConstant(Zx(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){let e=Zx(this);return u(e)?e.referenceFrame:void 0}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return Zx(this)}}}),uu.fromString=function(e,t){let i,n=[],r=!0,o=!1,a="";for(let e=0;e<t.length;++e){let s=t.charAt(e);o?(a+=s,o=!1):"\\"===s?o=!0:r&&"#"===s?(i=a,r=!1,a=""):r||"."!==s?a+=s:(n.push(a),a="")}return n.push(a),new uu(e,i,n)},uu.prototype.getValue=function(e,t){let i=Zx(this);return u(i)?i.getValue(e,t):void 0},uu.prototype.getValueInReferenceFrame=function(e,t,i){let n=Zx(this);return u(n)?n.getValueInReferenceFrame(e,t,i):void 0},uu.prototype.getType=function(e){let t=Zx(this);return u(t)?t.getType(e):void 0},uu.prototype.equals=function(e){if(this===e)return!0;let t=this._targetPropertyNames,i=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==i.length)return!1;let n=this._targetPropertyNames.length;for(let e=0;e<n;e++)if(t[e]!==i[e])return!1;return!0},uu.prototype._onTargetEntityDefinitionChanged=function(e,t,i,n){u(this._targetProperty)&&this._targetPropertyNames[0]===t&&(this._targetProperty=void 0,this._definitionChanged.raiseEvent(this))},uu.prototype._onCollectionChanged=function(e,t,i){let n=this._targetEntity;u(n)&&-1!==i.indexOf(n)?(n.definitionChanged.removeEventListener(uu.prototype._onTargetEntityDefinitionChanged,this),this._targetEntity=this._targetProperty=void 0):u(n)||(n=Zx(this),u(n)&&this._definitionChanged.raiseEvent(this))};var my=uu,sft={packedLength:1,pack:function(e,t,i){return t[i=y(i,0)]=e,t},unpack:function(e,t,i){return e[t=y(t,0)]},convertPackedArrayForInterpolation:function(e,t,i,n){let r;u(n)||(n=[]),t=y(t,0);for(let o=0,a=(i=y(i,e.length))-t+1;o<a;o++){let i=e[t+o];0===o||Math.abs(r-i)<Math.PI?n[o]=i:n[o]=i-P.TWO_PI,r=i}},unpackInterpolationResult:function(e,t,i,n,r){return(r=e[0])<0?r+P.TWO_PI:r}},Od=sft,Ppe={packedLength:1,pack:function(e,t,i){t[i=y(i,0)]=e},unpack:function(e,t,i){return e[t=y(t,0)]}};function Ope(e,t,i){let n,r=e.length,o=i.length,a=r+o;if(e.length=a,r!==t){let i=r-1;for(n=a-1;n>=t;n--)e[n]=e[i--]}for(n=0;n<o;n++)e[t++]=i[n]}function Rpe(e,t){return e instanceof J?e:"string"==typeof e?J.fromIso8601(e):J.addSeconds(t,e,new J)}var Y7=[],X7=[];function LU(e,t,i,n,r){let o,a,s,l,c,h,d=0;for(;d<n.length;){c=Rpe(n[d],e),s=Eo(t,c,J.compare);let p=0,f=0;if(s<0){for(s=~s,l=s*r,a=void 0,h=t[s];d<n.length&&(c=Rpe(n[d],e),!(u(a)&&J.compare(a,c)>=0||u(h)&&J.compare(c,h)>=0));){for(Y7[p++]=c,d+=1,o=0;o<r;o++)X7[f++]=n[d],d+=1;a=c}p>0&&(X7.length=f,Ope(i,l,X7),Y7.length=p,Ope(t,s,Y7))}else{for(o=0;o<r;o++)d++,i[s*r+o]=n[d];d++}}}function Rd(e,t){let i=e;i===Number&&(i=Ppe);let n,r=i.packedLength,o=y(i.packedInterpolationLength,r),a=0;if(u(t)){let e=t.length;n=new Array(e);for(let i=0;i<e;i++){let e=t[i];e===Number&&(e=Ppe);let a=e.packedLength;r+=a,o+=y(e.packedInterpolationLength,a),n[i]=e}a=e}this._type=e,this._innerType=i,this._interpolationDegree=1,this._interpolationAlgorithm=ET,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=r,this._packedInterpolationLength=o,this._updateTableLength=!0,this._interpolationResult=new Array(o),this._definitionChanged=new pe,this._derivativeTypes=t,this._innerDerivativeTypes=n,this._inputOrder=a,this._forwardExtrapolationType=Bu.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=Bu.NONE,this._backwardExtrapolationDuration=0}function Mpe(e,t,i){let n=e._packedLength;e._times.splice(t,i),e._values.splice(t*n,i*n),e._updateTableLength=!0,e._definitionChanged.raiseEvent(e)}Object.defineProperties(Rd.prototype,{isConstant:{get:function(){return 0===this._values.length}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}}),Rd.prototype.getValue=function(e,t){let i=this._times,n=i.length;if(0===n)return;let r,o=this._innerType,a=this._values,s=Eo(i,e,J.compare);if(s<0){if(s=~s,0===s){let n=i[s];if(r=this._backwardExtrapolationDuration,this._backwardExtrapolationType===Bu.NONE||0!==r&&J.secondsDifference(n,e)>r)return;if(this._backwardExtrapolationType===Bu.HOLD)return o.unpack(a,0,t)}if(s>=n){s=n-1;let l=i[s];if(r=this._forwardExtrapolationDuration,this._forwardExtrapolationType===Bu.NONE||0!==r&&J.secondsDifference(e,l)>r)return;if(this._forwardExtrapolationType===Bu.HOLD)return s=n-1,o.unpack(a,s*o.packedLength,t)}let l=this._xTable,c=this._yTable,h=this._interpolationAlgorithm,d=this._packedInterpolationLength,p=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;let e=Math.min(h.getRequiredDataPoints(this._interpolationDegree,p),n);e!==this._numberOfPoints&&(this._numberOfPoints=e,l.length=e,c.length=e*d)}let f=this._numberOfPoints-1;if(f<1)return;let m=0,_=n-1;if(_-m+1>=f+1){let e=s-(f/2|0)-1;e<m&&(e=m);let t=e+f;t>_&&(t=_,e=t-f,e<m&&(e=m)),m=e,_=t}let g=_-m+1;for(let e=0;e<g;++e)l[e]=J.secondsDifference(i[m+e],i[_]);if(u(o.convertPackedArrayForInterpolation))o.convertPackedArrayForInterpolation(a,m,_,c);else{let e=0,t=this._packedLength,i=m*t,n=(_+1)*t;for(;i<n;)c[e]=a[i],i++,e++}let y,v=J.secondsDifference(e,i[_]);if(0!==p&&u(h.interpolate)){let e=Math.floor(d/(p+1));y=h.interpolate(v,l,c,e,p,p,this._interpolationResult)}else y=h.interpolateOrderZero(v,l,c,d,this._interpolationResult);return u(o.unpackInterpolationResult)?o.unpackInterpolationResult(y,a,m,_,t):o.unpack(y,0,t)}return o.unpack(a,s*this._packedLength,t)},Rd.prototype.setInterpolationOptions=function(e){if(!u(e))return;let t=!1,i=e.interpolationAlgorithm,n=e.interpolationDegree;u(i)&&this._interpolationAlgorithm!==i&&(this._interpolationAlgorithm=i,t=!0),u(n)&&this._interpolationDegree!==n&&(this._interpolationDegree=n,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))},Rd.prototype.addSample=function(e,t,i){let n=this._innerDerivativeTypes,r=u(n),o=this._innerType,a=[];if(a.push(e),o.pack(t,a,a.length),r){let e=n.length;for(let t=0;t<e;t++)n[t].pack(i[t],a,a.length)}LU(void 0,this._times,this._values,a,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},Rd.prototype.addSamples=function(e,t,i){let n=this._innerDerivativeTypes,r=u(n),o=this._innerType,a=e.length,s=[];for(let l=0;l<a;l++)if(s.push(e[l]),o.pack(t[l],s,s.length),r){let e=i[l],t=n.length;for(let i=0;i<t;i++)n[i].pack(e[i],s,s.length)}LU(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},Rd.prototype.addSamplesPackedArray=function(e,t){LU(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},Rd.prototype.removeSample=function(e){let t=Eo(this._times,e,J.compare);return!(t<0)&&(Mpe(this,t,1),!0)},Rd.prototype.removeSamples=function(e){let t=this._times,i=Eo(t,e.start,J.compare);i<0?i=~i:e.isStartIncluded||++i;let n=Eo(t,e.stop,J.compare);n<0?n=~n:e.isStopIncluded&&++n,Mpe(this,i,n-i)},Rd.prototype.equals=function(e){if(this===e)return!0;if(!u(e)||this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;let t,i,n=this._derivativeTypes,r=u(n),o=e._derivativeTypes;if(r!==u(o))return!1;if(r){if(i=n.length,i!==o.length)return!1;for(t=0;t<i;t++)if(n[t]!==o[t])return!1}let a=this._times,s=e._times;if(i=a.length,i!==s.length)return!1;for(t=0;t<i;t++)if(!J.equals(a[t],s[t]))return!1;let l=this._values,c=e._values;for(i=l.length,t=0;t<i;t++)if(l[t]!==c[t])return!1;return!0},Rd._mergeNewSamples=LU;var Tf=Rd;function Af(e,t){let i;if((t=y(t,0))>0){i=new Array(t);for(let e=0;e<t;e++)i[e]=h}this._numberOfDerivatives=t,this._property=new Tf(h,i),this._definitionChanged=new pe,this._referenceFrame=y(e,to.FIXED),this._property._definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this)}),this)}Object.defineProperties(Af.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}}),Af.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,to.FIXED,t)},Af.prototype.getValueInReferenceFrame=function(e,t,i){if(i=this._property.getValue(e,i),u(i))return iy.convertToReferenceFrame(e,i,this._referenceFrame,t,i)},Af.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)},Af.prototype.addSample=function(e,t,i){this._numberOfDerivatives;this._property.addSample(e,t,i)},Af.prototype.addSamples=function(e,t,i){this._property.addSamples(e,t,i)},Af.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)},Af.prototype.removeSample=function(e){return this._property.removeSample(e)},Af.prototype.removeSamples=function(e){this._property.removeSamples(e)},Af.prototype.equals=function(e){return this===e||e instanceof Af&&j.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};var pa=Af,aft={HORIZONTAL:0,VERTICAL:1},fm=Object.freeze(aft),cft=fm.HORIZONTAL,lft=z.WHITE,uft=z.BLACK,fft=0,dft=1;function oE(e){e=y(e,y.EMPTY_OBJECT),this._definitionChanged=new pe,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object.defineProperties(oE.prototype,{isConstant:{get:function(){return j.isConstant(this._orientation)&&j.isConstant(this._evenColor)&&j.isConstant(this._oddColor)&&j.isConstant(this._offset)&&j.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:ae("orientation"),evenColor:ae("evenColor"),oddColor:ae("oddColor"),offset:ae("offset"),repeat:ae("repeat")}),oE.prototype.getType=function(e){return"Stripe"},oE.prototype.getValue=function(e,t){return u(t)||(t={}),t.horizontal=j.getValueOrDefault(this._orientation,e,cft)===fm.HORIZONTAL,t.evenColor=j.getValueOrClonedDefault(this._evenColor,e,lft,t.evenColor),t.oddColor=j.getValueOrClonedDefault(this._oddColor,e,uft,t.oddColor),t.offset=j.getValueOrDefault(this._offset,e,fft),t.repeat=j.getValueOrDefault(this._repeat,e,dft),t},oE.prototype.equals=function(e){return this===e||e instanceof oE&&j.equals(this._orientation,e._orientation)&&j.equals(this._evenColor,e._evenColor)&&j.equals(this._oddColor,e._oddColor)&&j.equals(this._offset,e._offset)&&j.equals(this._repeat,e._repeat)};var iI=oE;function py(e){this._definitionChanged=new pe,this._intervals=new Mr,this._intervals.changedEvent.addEventListener(py.prototype._intervalsChanged,this),this._referenceFrame=y(e,to.FIXED)}Object.defineProperties(py.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}}),py.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,to.FIXED,t)},py.prototype.getValueInReferenceFrame=function(e,t,i){let n=this._intervals.findDataForIntervalContainingDate(e);if(u(n))return iy.convertToReferenceFrame(e,n,this._referenceFrame,t,i)},py.prototype.equals=function(e){return this===e||e instanceof py&&this._intervals.equals(e._intervals,j.equals)&&this._referenceFrame===e._referenceFrame},py.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var _y=py;function $x(){this._definitionChanged=new pe,this._intervals=new Mr,this._intervals.changedEvent.addEventListener($x.prototype._intervalsChanged,this)}Object.defineProperties($x.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),$x.prototype.getValue=function(e,t){let i=this._intervals.findDataForIntervalContainingDate(e);return u(i)&&"function"==typeof i.clone?i.clone(t):i},$x.prototype.equals=function(e){return this===e||e instanceof $x&&this._intervals.equals(e._intervals,j.equals)},$x.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var gy=$x;function rE(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new pe,this._normalize=y(t,!0),this.position=e}Object.defineProperties(rE.prototype,{isConstant:{get:function(){return j.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){let t=this._position;t!==e&&(u(t)&&this._subscription(),this._position=e,u(e)&&(this._subscription=e._definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this)}),this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var hft=new h,Lpe=new h,Npe=new J,K7=1/60;rE.prototype.getValue=function(e,t){return this._getValue(e,t)},rE.prototype._getValue=function(e,t,i){u(t)||(t=new h);let n=this._position;if(j.isConstant(n))return this._normalize?void 0:h.clone(h.ZERO,t);let r=n.getValue(e,hft),o=n.getValue(J.addSeconds(e,K7,Npe),Lpe);if(!u(r)||!u(o)&&(o=r,r=n.getValue(J.addSeconds(e,-K7,Npe),Lpe),!u(r)))return;if(h.equals(r,o))return this._normalize?void 0:h.clone(h.ZERO,t);u(i)&&r.clone(i);let a=h.subtract(o,r,t);return this._normalize?h.normalize(a,t):h.divideByScalar(a,K7,t)},rE.prototype.equals=function(e){return this===e||e instanceof rE&&j.equals(this._position,e._position)};var sE=rE;function oI(e,t){this._velocityVectorProperty=new sE(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new pe,this.ellipsoid=y(t,ie.WGS84);let i=this;this._velocityVectorProperty.definitionChanged.addEventListener((function(){i._definitionChanged.raiseEvent(i)}))}Object.defineProperties(oI.prototype,{isConstant:{get:function(){return j.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var Fpe=new h,mft=new h,Bpe=new $;oI.prototype.getValue=function(e,t){let i=this._velocityVectorProperty._getValue(e,mft,Fpe);if(u(i))return Rt.rotationMatrixFromPositionVelocity(Fpe,i,this._ellipsoid,Bpe),Le.fromRotationMatrix(Bpe,t)},oI.prototype.equals=function(e){return this===e||e instanceof oI&&j.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};var NU=oI,Z7;function yy(){}function rI(e,t){return"#"===t[0]&&(t=Z7+t),my.fromString(e,t)}function kpe(e,t,i){if(u(i.reference))return rI(t,i.reference);if(u(i.velocityReference)){let n=rI(t,i.velocityReference);switch(e){case h:case yy:return new sE(n,e===yy);case Le:return new NU(n)}}throw new ue(`${JSON.stringify(i)} is not valid CZML.`)}function pft(e,t){return new lm((function(i,n){return t(e.getValue(i,n))}),e.isConstant)}yy.packedLength=h.packedLength,yy.unpack=h.unpack,yy.pack=h.pack;var Fi=new h,Pc=new RO,$a=new fe,Qx=new Cn,FU=new Le;function _ft(e){let t=e.rgbaf;if(u(t))return t;let i=e.rgba;if(!u(i))return;let n=i.length;if(n===z.packedLength)return[z.byteToFloat(i[0]),z.byteToFloat(i[1]),z.byteToFloat(i[2]),z.byteToFloat(i[3])];t=new Array(n);for(let e=0;e<n;e+=5)t[e]=i[e],t[e+1]=z.byteToFloat(i[e+1]),t[e+2]=z.byteToFloat(i[e+2]),t[e+3]=z.byteToFloat(i[e+3]),t[e+4]=z.byteToFloat(i[e+4]);return t}function Vpe(e,t){let i=y(e.uri,e);return u(t)?t.getDerivedResource({url:i}):ve.createIfNeeded(i)}function gft(e){let t=e.wsen;if(u(t))return t;let i=e.wsenDegrees;if(!u(i))return;let n=i.length;if(n===ce.packedLength)return[P.toRadians(i[0]),P.toRadians(i[1]),P.toRadians(i[2]),P.toRadians(i[3])];t=new Array(n);for(let e=0;e<n;e+=5)t[e]=i[e],t[e+1]=P.toRadians(i[e+1]),t[e+2]=P.toRadians(i[e+2]),t[e+3]=P.toRadians(i[e+3]),t[e+4]=P.toRadians(i[e+4]);return t}function yft(e){let t=e.length;if(Pc.magnitude=1,2===t)return Pc.clock=e[0],Pc.cone=e[1],h.fromSpherical(Pc,Fi),[Fi.x,Fi.y,Fi.z];let i=new Array(t/3*4);for(let n=0,r=0;n<t;n+=3,r+=4)i[r]=e[n],Pc.clock=e[n+1],Pc.cone=e[n+2],h.fromSpherical(Pc,Fi),i[r+1]=Fi.x,i[r+2]=Fi.y,i[r+3]=Fi.z;return i}function xft(e){let t=e.length;if(3===t)return Pc.clock=e[0],Pc.cone=e[1],Pc.magnitude=e[2],h.fromSpherical(Pc,Fi),[Fi.x,Fi.y,Fi.z];let i=new Array(t);for(let n=0;n<t;n+=4)i[n]=e[n],Pc.clock=e[n+1],Pc.cone=e[n+2],Pc.magnitude=e[n+3],h.fromSpherical(Pc,Fi),i[n+1]=Fi.x,i[n+2]=Fi.y,i[n+3]=Fi.z;return i}function bft(e){let t=e.length;if(3===t)return $a.longitude=e[0],$a.latitude=e[1],$a.height=e[2],ie.WGS84.cartographicToCartesian($a,Fi),[Fi.x,Fi.y,Fi.z];let i=new Array(t);for(let n=0;n<t;n+=4)i[n]=e[n],$a.longitude=e[n+1],$a.latitude=e[n+2],$a.height=e[n+3],ie.WGS84.cartographicToCartesian($a,Fi),i[n+1]=Fi.x,i[n+2]=Fi.y,i[n+3]=Fi.z;return i}function Tft(e){let t=e.length;if(3===t)return $a.longitude=P.toRadians(e[0]),$a.latitude=P.toRadians(e[1]),$a.height=e[2],ie.WGS84.cartographicToCartesian($a,Fi),[Fi.x,Fi.y,Fi.z];let i=new Array(t);for(let n=0;n<t;n+=4)i[n]=e[n],$a.longitude=P.toRadians(e[n+1]),$a.latitude=P.toRadians(e[n+2]),$a.height=e[n+3],ie.WGS84.cartographicToCartesian($a,Fi),i[n+1]=Fi.x,i[n+2]=Fi.y,i[n+3]=Fi.z;return i}function $7(e){let t=e.cartesian;if(u(t))return t;let i=e.cartesianVelocity;if(u(i))return i;let n=e.unitCartesian;if(u(n))return n;let r=e.unitSpherical;if(u(r))return yft(r);let o=e.spherical;if(u(o))return xft(o);let a=e.cartographicRadians;if(u(a))return bft(a);let s=e.cartographicDegrees;if(u(s))return Tft(s);throw new ue(`${JSON.stringify(e)} is not a valid CZML interval.`)}function Upe(e,t){h.unpack(e,t,Fi),h.normalize(Fi,Fi),h.pack(Fi,e,t)}function Aft(e){let t=$7(e);if(3===t.length)return Upe(t,0),t;for(let e=1;e<t.length;e+=4)Upe(t,e);return t}function zpe(e,t){Le.unpack(e,t,FU),Le.normalize(FU,FU),Le.pack(FU,e,t)}function Cft(e){let t=e.unitQuaternion;if(u(t)){if(4===t.length)return zpe(t,0),t;for(let e=1;e<t.length;e+=5)zpe(t,e)}return t}function Hpe(e){return"boolean"==typeof e?Boolean:"number"==typeof e?Number:"string"==typeof e?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?qe:e.hasOwnProperty("cartesian2")?U:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?h:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?yy:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?z:e.hasOwnProperty("arcType")?Yt:e.hasOwnProperty("classificationType")?zn:e.hasOwnProperty("colorBlendMode")?xc:e.hasOwnProperty("cornerType")?Ri:e.hasOwnProperty("heightReference")?We:e.hasOwnProperty("horizontalOrigin")?yi:e.hasOwnProperty("date")?J:e.hasOwnProperty("labelStyle")?zo:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?Pt:e.hasOwnProperty("distanceDisplayCondition")?wt:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?Le:e.hasOwnProperty("shadowMode")?yn:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?fm:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?ce:e.hasOwnProperty("uri")?aI.default:e.hasOwnProperty("verticalOrigin")?On:Object}function Eft(e,t,i){switch(e){case Yt:return Yt[y(t.arcType,t)];case Array:return t.array;case Boolean:return y(t.boolean,t);case qe:return t.boundingRectangle;case U:return t.cartesian2;case h:return $7(t);case yy:return Aft(t);case z:return _ft(t);case zn:return zn[y(t.classificationType,t)];case xc:return xc[y(t.colorBlendMode,t)];case Ri:return Ri[y(t.cornerType,t)];case We:return We[y(t.heightReference,t)];case yi:return yi[y(t.horizontalOrigin,t)];case Image:return Vpe(t,i);case J:return J.fromIso8601(y(t.date,t));case zo:return zo[y(t.labelStyle,t)];case Number:return y(t.number,t);case Pt:return t.nearFarScalar;case wt:return t.distanceDisplayCondition;case Object:return y(y(t.object,t.value),t);case Le:return Cft(t);case Od:return y(t.number,t);case yn:return yn[y(y(t.shadowMode,t.shadows),t)];case String:return y(t.string,t);case fm:return fm[y(t.stripeOrientation,t)];case ce:return gft(t);case aI.default:return Vpe(t,i);case On:return On[y(t.verticalOrigin,t)];default:throw new ue(e)}}var Sft={HERMITE:$1,LAGRANGE:oO,LINEAR:ET};function BU(e,t){let i=e.interpolationAlgorithm,n=e.interpolationDegree;(u(i)||u(n))&&t.setInterpolationOptions({interpolationAlgorithm:Sft[i],interpolationDegree:n});let r=e.forwardExtrapolationType;u(r)&&(t.forwardExtrapolationType=Bu[r]);let o=e.forwardExtrapolationDuration;u(o)&&(t.forwardExtrapolationDuration=o);let a=e.backwardExtrapolationType;u(a)&&(t.backwardExtrapolationType=Bu[a]);let s=e.backwardExtrapolationDuration;u(s)&&(t.backwardExtrapolationDuration=s)}var Gpe={iso8601:void 0};function tr(e){if(u(e))return Gpe.iso8601=e,Cn.fromIso8601(Gpe)}function Q7(e){let t=ze.MAXIMUM_INTERVAL.clone();return t.data=e,t}function Wpe(e){let t=new Dc;return t.intervals.addInterval(Q7(e)),t}function jpe(e){let t=new ma(e.referenceFrame);return t.intervals.addInterval(Q7(e)),t}function kU(e,t,i,n,r,o,a){let s=tr(n.interval);u(r)&&(s=u(s)?Cn.intersect(s,r,Qx):r);let l,c,h,d=!u(n.reference)&&!u(n.velocityReference),p=u(s)&&!s.equals(ze.MAXIMUM_INTERVAL);if(!0===n.delete)return p?n_e(t[i],s):void(t[i]=void 0);let f=!1;if(d){if(c=Eft(e,n,o),!u(c))return;l=y(e.packedLength,1),h=y(c.length,1),f=!u(n.array)&&"string"!=typeof c&&h>l&&e!==Object}let m="function"==typeof e.unpack&&e!==Od;if(!f&&!p)return void(t[i]=d?new Zn(m?e.unpack(c,0):c):kpe(e,a,n));let _,g,v=t[i],b=n.epoch;if(u(b)&&(_=J.fromIso8601(b)),f&&!p)return v instanceof Tf||(t[i]=v=new Tf(e)),v.addSamplesPackedArray(c,_),void BU(n,v);if(!f&&p)return s=s.clone(),s.data=d?m?e.unpack(c,0):c:kpe(e,a,n),u(v)||(t[i]=v=d?new gy:new Dc),void(d&&v instanceof gy?v.intervals.addInterval(s):v instanceof Dc?(d&&(s.data=new Zn(s.data)),v.intervals.addInterval(s)):(t[i]=v=Wpe(v),d&&(s.data=new Zn(s.data)),v.intervals.addInterval(s)));u(v)||(t[i]=v=new Dc),v instanceof Dc||(t[i]=v=Wpe(v));let A=v.intervals;g=A.findInterval(s),(!u(g)||!(g.data instanceof Tf))&&(g=s.clone(),g.data=new Tf(e),A.addInterval(g)),g.data.addSamplesPackedArray(c,_),BU(n,g.data)}function n_e(e,t){if(e instanceof Tf)e.removeSamples(t);else if(e instanceof gy)e.intervals.removeInterval(t);else if(e instanceof Dc){let i=e.intervals;for(let e=0;e<i.length;++e){let n=Cn.intersect(i.get(e),t,Qx);n.isEmpty||n_e(n.data,t)}i.removeInterval(t)}else;}function _e(e,t,i,n,r,o,a){if(u(n))if(Array.isArray(n))for(let s=0,l=n.length;s<l;++s)kU(e,t,i,n[s],r,o,a);else kU(e,t,i,n,r,o,a)}function qpe(e,t,i,n,r,o){let a=tr(i.interval);u(n)&&(a=u(a)?Cn.intersect(a,n,Qx):n);let s,l,c=u(i.cartesianVelocity)?1:0,d=h.packedLength*(c+1),p=!u(i.reference),f=u(a)&&!a.equals(ze.MAXIMUM_INTERVAL);if(!0===i.delete)return f?i_e(e[t],a):void(e[t]=void 0);let m,_=!1;if(p&&(u(i.referenceFrame)&&(m=to[i.referenceFrame]),m=y(m,to.FIXED),s=$7(i),l=y(s.length,1),_=l>d),!_&&!f)return void(e[t]=p?new gl(h.unpack(s),m):rI(o,i.reference));let g,v,b=e[t],A=i.epoch;if(u(A)&&(g=J.fromIso8601(A)),_&&!f)return(!(b instanceof pa)||u(m)&&b.referenceFrame!==m)&&(e[t]=b=new pa(m,c)),b.addSamplesPackedArray(s,g),void BU(i,b);if(!_&&f)return a=a.clone(),a.data=p?h.unpack(s):rI(o,i.reference),u(b)||(b=p?new _y(m):new ma(m),e[t]=b),void(p&&b instanceof _y&&u(m)&&b.referenceFrame===m?b.intervals.addInterval(a):b instanceof ma?(p&&(a.data=new gl(a.data,m)),b.intervals.addInterval(a)):(e[t]=b=jpe(b),p&&(a.data=new gl(a.data,m)),b.intervals.addInterval(a)));u(b)?b instanceof ma||(e[t]=b=jpe(b)):e[t]=b=new ma(m);let T=b.intervals;v=T.findInterval(a),(!u(v)||!(v.data instanceof pa)||u(m)&&v.data.referenceFrame!==m)&&(v=a.clone(),v.data=new pa(m,c),T.addInterval(v)),v.data.addSamplesPackedArray(s,g),BU(i,v.data)}function i_e(e,t){if(e instanceof pa)e.removeSamples(t);else if(e instanceof _y)e.intervals.removeInterval(t);else if(e instanceof ma){let i=e.intervals;for(let e=0;e<i.length;++e){let n=Cn.intersect(i.get(e),t,Qx);n.isEmpty||i_e(n.data,t)}i.removeInterval(t)}else;}function o_e(e,t,i,n,r,o){if(u(i))if(Array.isArray(i))for(let a=0,s=i.length;a<s;++a)qpe(e,t,i[a],n,r,o);else qpe(e,t,i,n,r,o)}function Ype(e,t,i,n){u(i.references)?VU(e,t,i.references,i.interval,n,nI,Dc):(u(i.cartesian2)?i.array=U.unpackArray(i.cartesian2):u(i.cartesian)&&(i.array=U.unpackArray(i.cartesian)),u(i.array)&&_e(Array,e,t,i,void 0,void 0,n))}function Xpe(e,t,i,n,r,o){let a=tr(i.interval);u(n)&&(a=u(a)?Cn.intersect(a,n,Qx):n);let s,l,c,h=e[t];if(u(a)){h instanceof XD||(h=new XD,e[t]=h);let i=h.intervals;l=i.findInterval({start:a.start,stop:a.stop}),u(l)?s=l.data:(l=a.clone(),i.addInterval(l))}else s=h;u(i.solidColor)?(s instanceof Nt||(s=new Nt),c=i.solidColor,_e(z,s,"color",c.color,void 0,void 0,o)):u(i.grid)?(s instanceof QD||(s=new QD),c=i.grid,_e(z,s,"color",c.color,void 0,r,o),_e(Number,s,"cellAlpha",c.cellAlpha,void 0,r,o),_e(U,s,"lineCount",c.lineCount,void 0,r,o),_e(U,s,"lineThickness",c.lineThickness,void 0,r,o),_e(U,s,"lineOffset",c.lineOffset,void 0,r,o)):u(i.image)?(s instanceof jx||(s=new jx),c=i.image,_e(Image,s,"image",c.image,void 0,r,o),_e(U,s,"repeat",c.repeat,void 0,r,o),_e(z,s,"color",c.color,void 0,r,o),_e(Boolean,s,"transparent",c.transparent,void 0,r,o)):u(i.stripe)?(s instanceof iI||(s=new iI),c=i.stripe,_e(fm,s,"orientation",c.orientation,void 0,r,o),_e(z,s,"evenColor",c.evenColor,void 0,r,o),_e(z,s,"oddColor",c.oddColor,void 0,r,o),_e(Number,s,"offset",c.offset,void 0,r,o),_e(Number,s,"repeat",c.repeat,void 0,r,o)):u(i.polylineOutline)?(s instanceof Kx||(s=new Kx),c=i.polylineOutline,_e(z,s,"color",c.color,void 0,r,o),_e(z,s,"outlineColor",c.outlineColor,void 0,r,o),_e(Number,s,"outlineWidth",c.outlineWidth,void 0,r,o)):u(i.polylineGlow)?(s instanceof tI||(s=new tI),c=i.polylineGlow,_e(z,s,"color",c.color,void 0,r,o),_e(Number,s,"glowPower",c.glowPower,void 0,r,o),_e(Number,s,"taperPower",c.taperPower,void 0,r,o)):u(i.polylineArrow)?(s instanceof JD||(s=new JD),c=i.polylineArrow,_e(z,s,"color",c.color,void 0,void 0,o)):u(i.polylineDash)?(s instanceof eI||(s=new eI),c=i.polylineDash,_e(z,s,"color",c.color,void 0,void 0,o),_e(z,s,"gapColor",c.gapColor,void 0,void 0,o),_e(Number,s,"dashLength",c.dashLength,void 0,r,o),_e(Number,s,"dashPattern",c.dashPattern,void 0,r,o)):u(i.checkerboard)&&(s instanceof qD||(s=new qD),c=i.checkerboard,_e(z,s,"evenColor",c.evenColor,void 0,r,o),_e(z,s,"oddColor",c.oddColor,void 0,r,o),_e(U,s,"repeat",c.repeat,void 0,r,o)),u(l)?l.data=s:e[t]=s}function fu(e,t,i,n,r,o){if(u(i))if(Array.isArray(i))for(let a=0,s=i.length;a<s;++a)Xpe(e,t,i[a],n,r,o);else Xpe(e,t,i,n,r,o)}function wft(e,t,i,n){let r=t.name;u(r)&&(e.name=t.name)}function vft(e,t,i,n){let r=t.description;u(r)&&_e(String,e,"description",r,void 0,n,i)}function Dft(e,t,i,n){let r=t.position;u(r)&&o_e(e,"position",r,void 0,n,i)}function Ift(e,t,i,n){let r=t.viewFrom;u(r)&&_e(h,e,"viewFrom",r,void 0,n,i)}function Pft(e,t,i,n){let r=t.orientation;u(r)&&_e(Le,e,"orientation",r,void 0,n,i)}function Oft(e,t,i,n){let r=t.properties;if(u(r)){u(e.properties)||(e.properties=new au);for(let t in r)if(r.hasOwnProperty(t)){e.properties.hasProperty(t)||e.properties.addProperty(t);let o=r[t];if(Array.isArray(o))for(let r=0,a=o.length;r<a;++r)kU(Hpe(o[r]),e.properties,t,o[r],void 0,n,i);else kU(Hpe(o),e.properties,t,o,void 0,n,i)}}}function VU(e,t,i,n,r,o,a){let s=i.map((function(e){return rI(r,e)}));if(u(n)){n=tr(n);let i=e[t];if(!(i instanceof a)){let n=new a;n.intervals.addInterval(Q7(i)),e[t]=i=n}n.data=new o(s),i.intervals.addInterval(n)}else e[t]=new o(s)}function Kpe(e,t,i,n){let r=i.references;u(r)?VU(e,t,r,i.interval,n,nI,Dc):_e(Array,e,t,i,void 0,void 0,n)}function Zpe(e,t,i,n){if(u(i))if(Array.isArray(i))for(let r=0,o=i.length;r<o;++r)Kpe(e,t,i[r],n);else Kpe(e,t,i,n)}function $pe(e,t,i,n){let r=i.references;u(r)?VU(e,t,r,i.interval,n,dy,ma):(u(i.cartesian)?i.array=h.unpackArray(i.cartesian):u(i.cartographicRadians)?i.array=h.fromRadiansArrayHeights(i.cartographicRadians,ie.WGS84):u(i.cartographicDegrees)&&(i.array=h.fromDegreesArrayHeights(i.cartographicDegrees,ie.WGS84)),u(i.array)&&_e(Array,e,t,i,void 0,void 0,n))}function cI(e,t,i,n){if(u(i))if(Array.isArray(i))for(let r=0,o=i.length;r<o;++r)$pe(e,t,i[r],n);else $pe(e,t,i,n)}function Rft(e){return h.unpackArray(e)}function Mft(e){return h.fromRadiansArrayHeights(e,ie.WGS84)}function Lft(e){return h.fromDegreesArrayHeights(e,ie.WGS84)}function Qpe(e,t,i,n){let r=i.references;if(u(r)){let o=r.map((function(e){let t={};return VU(t,"positions",e,i.interval,n,dy,ma),t.positions}));e[t]=new dy(o)}else u(i.cartesian)?i.array=i.cartesian.map(Rft):u(i.cartographicRadians)?i.array=i.cartographicRadians.map(Mft):u(i.cartographicDegrees)&&(i.array=i.cartographicDegrees.map(Lft)),u(i.array)&&_e(Array,e,t,i,void 0,void 0,n)}function Nft(e,t,i,n){if(u(i))if(Array.isArray(i))for(let r=0,o=i.length;r<o;++r)Qpe(e,t,i[r],n);else Qpe(e,t,i,n)}function Fft(e,t,i,n){if(u(i))if(Array.isArray(i))for(let r=0,o=i.length;r<o;r++)Ype(e,t,i[r],n);else Ype(e,t,i,n)}function Bft(e,t,i,n){let r,o=t.availability;if(u(o)){if(Array.isArray(o))for(let e=0,t=o.length;e<t;++e)u(r)||(r=new Mr),r.addInterval(tr(o[e]));else r=new Mr,r.addInterval(tr(o));e.availability=r}}function kft(e,t,i,n,r){u(t)&&_e(yy,e,"alignedAxis",t,i,n,r)}function Vft(e,t,i,n){let r=t.billboard;if(!u(r))return;let o=tr(r.interval),a=e.billboard;u(a)||(e.billboard=a=new Sc),_e(Boolean,a,"show",r.show,o,n,i),_e(Image,a,"image",r.image,o,n,i),_e(Number,a,"scale",r.scale,o,n,i),_e(U,a,"pixelOffset",r.pixelOffset,o,n,i),_e(h,a,"eyeOffset",r.eyeOffset,o,n,i),_e(yi,a,"horizontalOrigin",r.horizontalOrigin,o,n,i),_e(On,a,"verticalOrigin",r.verticalOrigin,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(z,a,"color",r.color,o,n,i),_e(Od,a,"rotation",r.rotation,o,n,i),kft(a,r.alignedAxis,o,n,i),_e(Boolean,a,"sizeInMeters",r.sizeInMeters,o,n,i),_e(Number,a,"width",r.width,o,n,i),_e(Number,a,"height",r.height,o,n,i),_e(Pt,a,"scaleByDistance",r.scaleByDistance,o,n,i),_e(Pt,a,"translucencyByDistance",r.translucencyByDistance,o,n,i),_e(Pt,a,"pixelOffsetScaleByDistance",r.pixelOffsetScaleByDistance,o,n,i),_e(qe,a,"imageSubRegion",r.imageSubRegion,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(Number,a,"disableDepthTestDistance",r.disableDepthTestDistance,o,n,i)}function Uft(e,t,i,n){let r=t.box;if(!u(r))return;let o=tr(r.interval),a=e.box;u(a)||(e.box=a=new NC),_e(Boolean,a,"show",r.show,o,n,i),_e(h,a,"dimensions",r.dimensions,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i)}function zft(e,t,i,n){let r=t.corridor;if(!u(r))return;let o=tr(r.interval),a=e.corridor;u(a)||(e.corridor=a=new BC),_e(Boolean,a,"show",r.show,o,n,i),cI(a,"positions",r.positions,i),_e(Number,a,"width",r.width,o,n,i),_e(Number,a,"height",r.height,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Number,a,"extrudedHeight",r.extrudedHeight,o,n,i),_e(We,a,"extrudedHeightReference",r.extrudedHeightReference,o,n,i),_e(Ri,a,"cornerType",r.cornerType,o,n,i),_e(Number,a,"granularity",r.granularity,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(zn,a,"classificationType",r.classificationType,o,n,i),_e(Number,a,"zIndex",r.zIndex,o,n,i)}function Hft(e,t,i,n){let r=t.cylinder;if(!u(r))return;let o=tr(r.interval),a=e.cylinder;u(a)||(e.cylinder=a=new kC),_e(Boolean,a,"show",r.show,o,n,i),_e(Number,a,"length",r.length,o,n,i),_e(Number,a,"topRadius",r.topRadius,o,n,i),_e(Number,a,"bottomRadius",r.bottomRadius,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Number,a,"numberOfVerticalLines",r.numberOfVerticalLines,o,n,i),_e(Number,a,"slices",r.slices,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i)}function Gft(e,t){let i=e.version;if(u(i)&&"string"==typeof i){let e=i.split(".");if(2===e.length){if("1"!==e[0])throw new ue("Cesium only supports CZML version 1.");t._version=i}}if(!u(t._version))throw new ue("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");let n=t._documentPacket;u(e.name)&&(n.name=e.name);let r=e.clock;if(u(r)){let e=n.clock;u(e)?(e.interval=y(r.interval,e.interval),e.currentTime=y(r.currentTime,e.currentTime),e.range=y(r.range,e.range),e.step=y(r.step,e.step),e.multiplier=y(r.multiplier,e.multiplier)):n.clock={interval:r.interval,currentTime:r.currentTime,range:r.range,step:r.step,multiplier:r.multiplier}}}function Wft(e,t,i,n){let r=t.ellipse;if(!u(r))return;let o=tr(r.interval),a=e.ellipse;u(a)||(e.ellipse=a=new VC),_e(Boolean,a,"show",r.show,o,n,i),_e(Number,a,"semiMajorAxis",r.semiMajorAxis,o,n,i),_e(Number,a,"semiMinorAxis",r.semiMinorAxis,o,n,i),_e(Number,a,"height",r.height,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Number,a,"extrudedHeight",r.extrudedHeight,o,n,i),_e(We,a,"extrudedHeightReference",r.extrudedHeightReference,o,n,i),_e(Od,a,"rotation",r.rotation,o,n,i),_e(Od,a,"stRotation",r.stRotation,o,n,i),_e(Number,a,"granularity",r.granularity,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Number,a,"numberOfVerticalLines",r.numberOfVerticalLines,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(zn,a,"classificationType",r.classificationType,o,n,i),_e(Number,a,"zIndex",r.zIndex,o,n,i)}function jft(e,t,i,n){let r=t.ellipsoid;if(!u(r))return;let o=tr(r.interval),a=e.ellipsoid;u(a)||(e.ellipsoid=a=new UC),_e(Boolean,a,"show",r.show,o,n,i),_e(h,a,"radii",r.radii,o,n,i),_e(h,a,"innerRadii",r.innerRadii,o,n,i),_e(Number,a,"minimumClock",r.minimumClock,o,n,i),_e(Number,a,"maximumClock",r.maximumClock,o,n,i),_e(Number,a,"minimumCone",r.minimumCone,o,n,i),_e(Number,a,"maximumCone",r.maximumCone,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Number,a,"stackPartitions",r.stackPartitions,o,n,i),_e(Number,a,"slicePartitions",r.slicePartitions,o,n,i),_e(Number,a,"subdivisions",r.subdivisions,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i)}function qft(e,t,i,n){let r=t.label;if(!u(r))return;let o=tr(r.interval),a=e.label;u(a)||(e.label=a=new rm),_e(Boolean,a,"show",r.show,o,n,i),_e(String,a,"text",r.text,o,n,i),_e(String,a,"font",r.font,o,n,i),_e(zo,a,"style",r.style,o,n,i),_e(Number,a,"scale",r.scale,o,n,i),_e(Boolean,a,"showBackground",r.showBackground,o,n,i),_e(z,a,"backgroundColor",r.backgroundColor,o,n,i),_e(U,a,"backgroundPadding",r.backgroundPadding,o,n,i),_e(U,a,"pixelOffset",r.pixelOffset,o,n,i),_e(h,a,"eyeOffset",r.eyeOffset,o,n,i),_e(yi,a,"horizontalOrigin",r.horizontalOrigin,o,n,i),_e(On,a,"verticalOrigin",r.verticalOrigin,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(z,a,"fillColor",r.fillColor,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Pt,a,"translucencyByDistance",r.translucencyByDistance,o,n,i),_e(Pt,a,"pixelOffsetScaleByDistance",r.pixelOffsetScaleByDistance,o,n,i),_e(Pt,a,"scaleByDistance",r.scaleByDistance,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(Number,a,"disableDepthTestDistance",r.disableDepthTestDistance,o,n,i)}function Yft(e,t,i,n){let r=t.model;if(!u(r))return;let o=tr(r.interval),a=e.model;u(a)||(e.model=a=new oy),_e(Boolean,a,"show",r.show,o,n,i),_e(aI.default,a,"uri",r.gltf,o,n,i),_e(Number,a,"scale",r.scale,o,n,i),_e(Number,a,"minimumPixelSize",r.minimumPixelSize,o,n,i),_e(Number,a,"maximumScale",r.maximumScale,o,n,i),_e(Boolean,a,"incrementallyLoadTextures",r.incrementallyLoadTextures,o,n,i),_e(Boolean,a,"runAnimations",r.runAnimations,o,n,i),_e(Boolean,a,"clampAnimations",r.clampAnimations,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(z,a,"silhouetteColor",r.silhouetteColor,o,n,i),_e(Number,a,"silhouetteSize",r.silhouetteSize,o,n,i),_e(z,a,"color",r.color,o,n,i),_e(xc,a,"colorBlendMode",r.colorBlendMode,o,n,i),_e(Number,a,"colorBlendAmount",r.colorBlendAmount,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i);let s,l,c=r.nodeTransformations;if(u(c))if(Array.isArray(c))for(s=0,l=c.length;s<l;++s)Jpe(a,c[s],o,n,i);else Jpe(a,c,o,n,i);let h=r.articulations;if(u(h))if(Array.isArray(h))for(s=0,l=h.length;s<l;++s)e_e(a,h[s],o,n,i);else e_e(a,h,o,n,i)}function Jpe(e,t,i,n,r){let o=tr(t.interval);u(i)&&(o=u(o)?Cn.intersect(o,i,Qx):i);let a=e.nodeTransformations,s=Object.keys(t);for(let i=0,l=s.length;i<l;++i){let l=s[i];if("interval"===l)continue;let c=t[l];if(!u(c))continue;u(a)||(e.nodeTransformations=a=new au),a.hasProperty(l)||a.addProperty(l);let d=a[l];u(d)||(a[l]=d=new zC),_e(h,d,"translation",c.translation,o,n,r),_e(Le,d,"rotation",c.rotation,o,n,r),_e(h,d,"scale",c.scale,o,n,r)}}function e_e(e,t,i,n,r){let o=tr(t.interval);u(i)&&(o=u(o)?Cn.intersect(o,i,Qx):i);let a=e.articulations,s=Object.keys(t);for(let i=0,l=s.length;i<l;++i){let l=s[i];if("interval"===l)continue;let c=t[l];u(c)&&(u(a)||(e.articulations=a=new au),a.hasProperty(l)||a.addProperty(l),_e(Number,a,l,c,o,n,r))}}function Xft(e,t,i,n){let r=t.path;if(!u(r))return;let o=tr(r.interval),a=e.path;u(a)||(e.path=a=new ry),_e(Boolean,a,"show",r.show,o,n,i),_e(Number,a,"leadTime",r.leadTime,o,n,i),_e(Number,a,"trailTime",r.trailTime,o,n,i),_e(Number,a,"width",r.width,o,n,i),_e(Number,a,"resolution",r.resolution,o,n,i),fu(a,"material",r.material,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i)}function Kft(e,t,i,n){let r=t.point;if(!u(r))return;let o=tr(r.interval),a=e.point;u(a)||(e.point=a=new GC),_e(Boolean,a,"show",r.show,o,n,i),_e(Number,a,"pixelSize",r.pixelSize,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(z,a,"color",r.color,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Pt,a,"scaleByDistance",r.scaleByDistance,o,n,i),_e(Pt,a,"translucencyByDistance",r.translucencyByDistance,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(Number,a,"disableDepthTestDistance",r.disableDepthTestDistance,o,n,i)}function sI(e){this.polygon=e,this._definitionChanged=new pe}function Zft(e,t,i,n){let r=t.polygon;if(!u(r))return;let o=tr(r.interval),a=e.polygon;u(a)||(e.polygon=a=new sm),_e(Boolean,a,"show",r.show,o,n,i),cI(a,"_positions",r.positions,i),Nft(a,"_holes",r.holes,i),(u(a._positions)||u(a._holes))&&(a.hierarchy=new sI(a)),_e(Number,a,"height",r.height,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Number,a,"extrudedHeight",r.extrudedHeight,o,n,i),_e(We,a,"extrudedHeightReference",r.extrudedHeightReference,o,n,i),_e(Od,a,"stRotation",r.stRotation,o,n,i),_e(Number,a,"granularity",r.granularity,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Boolean,a,"perPositionHeight",r.perPositionHeight,o,n,i),_e(Boolean,a,"closeTop",r.closeTop,o,n,i),_e(Boolean,a,"closeBottom",r.closeBottom,o,n,i),_e(Yt,a,"arcType",r.arcType,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(zn,a,"classificationType",r.classificationType,o,n,i),_e(Number,a,"zIndex",r.zIndex,o,n,i)}function $ft(e){return e?Yt.GEODESIC:Yt.NONE}function Qft(e,t,i,n){let r=t.polyline;if(!u(r))return;let o=tr(r.interval),a=e.polyline;if(u(a)||(e.polyline=a=new wc),_e(Boolean,a,"show",r.show,o,n,i),cI(a,"positions",r.positions,i),_e(Number,a,"width",r.width,o,n,i),_e(Number,a,"granularity",r.granularity,o,n,i),fu(a,"material",r.material,o,n,i),fu(a,"depthFailMaterial",r.depthFailMaterial,o,n,i),_e(Yt,a,"arcType",r.arcType,o,n,i),_e(Boolean,a,"clampToGround",r.clampToGround,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(zn,a,"classificationType",r.classificationType,o,n,i),_e(Number,a,"zIndex",r.zIndex,o,n,i),u(r.followSurface)&&!u(r.arcType)){let e={};_e(Boolean,e,"followSurface",r.followSurface,o,n,i),a.arcType=pft(e.followSurface,$ft)}}function Jft(e,t,i,n){let r=t.polylineVolume;if(!u(r))return;let o=tr(r.interval),a=e.polylineVolume;u(a)||(e.polylineVolume=a=new WC),cI(a,"positions",r.positions,i),Fft(a,"shape",r.shape,i),_e(Boolean,a,"show",r.show,o,n,i),_e(Ri,a,"cornerType",r.cornerType,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(Number,a,"granularity",r.granularity,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i)}function edt(e,t,i,n){let r=t.rectangle;if(!u(r))return;let o=tr(r.interval),a=e.rectangle;u(a)||(e.rectangle=a=new am),_e(Boolean,a,"show",r.show,o,n,i),_e(ce,a,"coordinates",r.coordinates,o,n,i),_e(Number,a,"height",r.height,o,n,i),_e(We,a,"heightReference",r.heightReference,o,n,i),_e(Number,a,"extrudedHeight",r.extrudedHeight,o,n,i),_e(We,a,"extrudedHeightReference",r.extrudedHeightReference,o,n,i),_e(Od,a,"rotation",r.rotation,o,n,i),_e(Od,a,"stRotation",r.stRotation,o,n,i),_e(Number,a,"granularity",r.granularity,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i),_e(zn,a,"classificationType",r.classificationType,o,n,i),_e(Number,a,"zIndex",r.zIndex,o,n,i)}function tdt(e,t,i,n){let r=t.tileset;if(!u(r))return;let o=tr(r.interval),a=e.tileset;u(a)||(e.tileset=a=new HC),_e(Boolean,a,"show",r.show,o,n,i),_e(aI.default,a,"uri",r.uri,o,n,i),_e(Number,a,"maximumScreenSpaceError",r.maximumScreenSpaceError,o,n,i)}function ndt(e,t,i,n){let r=t.wall;if(!u(r))return;let o=tr(r.interval),a=e.wall;u(a)||(e.wall=a=new sy),_e(Boolean,a,"show",r.show,o,n,i),cI(a,"positions",r.positions,i),Zpe(a,"minimumHeights",r.minimumHeights,i),Zpe(a,"maximumHeights",r.maximumHeights,i),_e(Number,a,"granularity",r.granularity,o,n,i),_e(Boolean,a,"fill",r.fill,o,n,i),fu(a,"material",r.material,o,n,i),_e(Boolean,a,"outline",r.outline,o,n,i),_e(z,a,"outlineColor",r.outlineColor,o,n,i),_e(Number,a,"outlineWidth",r.outlineWidth,o,n,i),_e(yn,a,"shadows",r.shadows,o,n,i),_e(wt,a,"distanceDisplayCondition",r.distanceDisplayCondition,o,n,i)}function t_e(e,t,i,n,r){let o=e.id;if(u(o)||(o=jn()),Z7=o,!u(r._version)&&"document"!==o)throw new ue("The first CZML packet is required to be the document object.");if(!0===e.delete)t.removeById(o);else if("document"===o)Gft(e,r);else{let r=t.getOrCreateEntity(o),a=e.parent;u(a)&&(r.parent=t.getOrCreateEntity(a));for(let o=i.length-1;o>-1;o--)i[o](r,e,t,n)}Z7=void 0}function idt(e){let t,i=e._documentPacket.clock;if(!u(i)){if(!u(e._clock)){let i=e._entityCollection.computeAvailability();if(!i.start.equals(ze.MINIMUM_VALUE)){let n=i.start,r=i.stop,o=J.secondsDifference(r,n),a=Math.round(o/120);return t=new um,t.startTime=J.clone(n),t.stopTime=J.clone(r),t.clockRange=Dr.LOOP_STOP,t.multiplier=a,t.currentTime=J.clone(n),t.clockStep=ho.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}u(e._clock)?t=e._clock.clone():(t=new um,t.startTime=ze.MINIMUM_VALUE.clone(),t.stopTime=ze.MAXIMUM_VALUE.clone(),t.currentTime=ze.MINIMUM_VALUE.clone(),t.clockRange=Dr.LOOP_STOP,t.clockStep=ho.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1);let n=tr(i.interval);return u(n)&&(t.startTime=n.start,t.stopTime=n.stop),u(i.currentTime)&&(t.currentTime=J.fromIso8601(i.currentTime)),u(i.range)&&(t.clockRange=y(Dr[i.range],Dr.LOOP_STOP)),u(i.step)&&(t.clockStep=y(ho[i.step],ho.SYSTEM_CLOCK_MULTIPLIER)),u(i.multiplier)&&(t.multiplier=i.multiplier),!t.equals(e._clock)&&(e._clock=t.clone(e._clock),!0)}function r_e(e,t,i,n){let r=t,o=(i=y(i,y.EMPTY_OBJECT)).sourceUri,a=i.credit;if("string"==typeof a&&(a=new xt(a)),e._credit=a,"string"==typeof t||t instanceof ve){r=(t=ve.createIfNeeded(t)).fetchJson(),o=y(o,t.clone());let i=e._resourceCredits,n=t.credits;if(u(n)){let e=n.length;for(let t=0;t<e;t++)i.push(n[t])}}return o=ve.createIfNeeded(o),Nr.setLoading(e,!0),Promise.resolve(r).then((function(t){return odt(e,t,o,n)})).catch((function(t){return Nr.setLoading(e,!1),e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)}))}function odt(e,t,i,n){Nr.setLoading(e,!0);let r=e._entityCollection;n&&(e._version=void 0,e._documentPacket=new s_e,r.removeAll()),yl._processCzml(t,r,i,void 0,e);let o=idt(e),a=e._documentPacket;return u(a.name)&&e._name!==a.name?(e._name=a.name,o=!0):!u(e._name)&&u(i)&&(e._name=P_(i.getUrlComponent()),o=!0),Nr.setLoading(e,!1),o&&e._changed.raiseEvent(e),e}function s_e(){this.name=void 0,this.clock=void 0}function yl(e){this._name=e,this._changed=new pe,this._error=new pe,this._isLoading=!1,this._loading=new pe,this._clock=void 0,this._documentPacket=new s_e,this._version=void 0,this._entityCollection=new Ks(this),this._entityCluster=new bf,this._credit=void 0,this._resourceCredits=[]}Object.defineProperties(sI.prototype,{isConstant:{get:function(){let e=this.polygon._positions,t=this.polygon._holes;return(!u(e)||e.isConstant)&&(!u(t)||t.isConstant)}},definitionChanged:{get:function(){return this._definitionChanged}}}),sI.prototype.getValue=function(e,t){let i,n;return u(this.polygon._positions)&&(i=this.polygon._positions.getValue(e)),u(this.polygon._holes)&&(n=this.polygon._holes.getValue(e),u(n)&&(n=n.map((function(e){return new Pa(e)})))),u(t)?(t.positions=i,t.holes=n,t):new Pa(i,n)},sI.prototype.equals=function(e){return this===e||e instanceof sI&&j.equals(this.polygon._positions,e.polygon._positions)&&j.equals(this.polygon._holes,e.polygon._holes)},yl.load=function(e,t){return(new yl).load(e,t)},Object.defineProperties(yl.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}}}),yl.updaters=[Vft,Uft,zft,Hft,Wft,jft,qft,Yft,wft,vft,Xft,Kft,Zft,Qft,Jft,Oft,edt,Dft,tdt,Ift,ndt,Pft,Bft],yl.prototype.process=function(e,t){return r_e(this,e,t,!1)},yl.prototype.load=function(e,t){return r_e(this,e,t,!0)},yl.prototype.update=function(e){return!0},yl.processPacketData=_e,yl.processPositionPacketData=o_e,yl.processMaterialPacketData=fu,yl._processCzml=function(e,t,i,n,r){if(n=y(n,yl.updaters),Array.isArray(e))for(let o=0,a=e.length;o<a;++o)t_e(e[o],t,n,i,r);else t_e(e,t,n,i,r)};var UU=yl;function Oc(){this._dataSources=[],this._dataSourceAdded=new pe,this._dataSourceRemoved=new pe,this._dataSourceMoved=new pe}function zU(e,t){return e.indexOf(t)}function a_e(e,t,i){let n=e._dataSources,r=n.length-1;if((t=P.clamp(t,0,r))===(i=P.clamp(i,0,r)))return;let o=n[t];n[t]=n[i],n[i]=o,e.dataSourceMoved.raiseEvent(o,i,t)}Object.defineProperties(Oc.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}},dataSourceMoved:{get:function(){return this._dataSourceMoved}}}),Oc.prototype.add=function(e){let t=this,i=this._dataSources;return Promise.resolve(e).then((function(e){return i===t._dataSources&&(t._dataSources.push(e),t._dataSourceAdded.raiseEvent(t,e)),e}))},Oc.prototype.remove=function(e,t){t=y(t,!1);let i=this._dataSources.indexOf(e);return-1!==i&&(this._dataSources.splice(i,1),this._dataSourceRemoved.raiseEvent(this,e),t&&"function"==typeof e.destroy&&e.destroy(),!0)},Oc.prototype.removeAll=function(e){e=y(e,!1);let t=this._dataSources;for(let i=0,n=t.length;i<n;++i){let n=t[i];this._dataSourceRemoved.raiseEvent(this,n),e&&"function"==typeof n.destroy&&n.destroy()}this._dataSources=[]},Oc.prototype.contains=function(e){return-1!==this.indexOf(e)},Oc.prototype.indexOf=function(e){return this._dataSources.indexOf(e)},Oc.prototype.get=function(e){return this._dataSources[e]},Oc.prototype.getByName=function(e){return this._dataSources.filter((function(t){return t.name===e}))},Oc.prototype.raise=function(e){let t=zU(this._dataSources,e);a_e(this,t,t+1)},Oc.prototype.lower=function(e){let t=zU(this._dataSources,e);a_e(this,t,t-1)},Oc.prototype.raiseToTop=function(e){let t=zU(this._dataSources,e);t!==this._dataSources.length-1&&(this._dataSources.splice(t,1),this._dataSources.push(e),this.dataSourceMoved.raiseEvent(e,this._dataSources.length-1,t))},Oc.prototype.lowerToBottom=function(e){let t=zU(this._dataSources,e);0!==t&&(this._dataSources.splice(t,1),this._dataSources.splice(0,0,e),this.dataSourceMoved.raiseEvent(e,0,t))},Oc.prototype.isDestroyed=function(){return!1},Oc.prototype.destroy=function(){return this.removeAll(!0),le(this)};var HU=Oc;function aE(e,t){this._primitives=e,this._orderedGroundPrimitives=t,this._dynamicUpdaters=new bt}aE.prototype.add=function(e,t){this._dynamicUpdaters.set(t.id,t.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))},aE.prototype.remove=function(e){let t=e.id,i=this._dynamicUpdaters.get(t);u(i)&&(this._dynamicUpdaters.remove(t),i.destroy())},aE.prototype.update=function(e){let t=this._dynamicUpdaters.values;for(let i=0,n=t.length;i<n;i++)t[i].update(e);return!0},aE.prototype.removeAllPrimitives=function(){let e=this._dynamicUpdaters.values;for(let t=0,i=e.length;t<i;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},aE.prototype.getBoundingSphere=function(e,t){return e=this._dynamicUpdaters.get(e.id),u(e)&&u(e.getBoundingSphere)?e.getBoundingSphere(t):at.FAILED};var cE=aE,c_e=new z,l_e=h.ZERO,u_e=new h,f_e=new ce;function rdt(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function Md(e,t){qn.call(this,{entity:e,scene:t,geometryOptions:new rdt(e),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function lE(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(Md.prototype=Object.create(qn.prototype),Md.prototype.constructor=Md),Md.prototype.createFillGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(t=this._materialProperty.color.getValue(e,c_e)),u(t)||(t=z.WHITE),n.color=kt.fromColor(t)}return u(this._options.offsetAttribute)&&(n.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,l_e,u_e))),new yt({id:t,geometry:new Yc(this._options),attributes:n})},Md.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,c_e),r=this._distanceDisplayConditionProperty.getValue(e),o={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return u(this._options.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,l_e,u_e))),new yt({id:t,geometry:new Ru(this._options),attributes:o})},Md.prototype._computeCenter=function(e,t){return j.getValueOrUndefined(this._entity.position,e,t)},Md.prototype._isHidden=function(e,t){let i=e.position;return!u(i)||!u(t.semiMajorAxis)||!u(t.semiMinorAxis)||si.prototype._isHidden.call(this,e,t)},Md.prototype._isDynamic=function(e,t){return!e.position.isConstant||!t.semiMajorAxis.isConstant||!t.semiMinorAxis.isConstant||!j.isConstant(t.rotation)||!j.isConstant(t.height)||!j.isConstant(t.extrudedHeight)||!j.isConstant(t.granularity)||!j.isConstant(t.stRotation)||!j.isConstant(t.outlineWidth)||!j.isConstant(t.numberOfVerticalLines)||!j.isConstant(t.zIndex)||this._onTerrain&&!j.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Nt)},Md.prototype._setStaticOptions=function(e,t){let i=j.getValueOrUndefined(t.height,ze.MINIMUM_VALUE),n=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),r=j.getValueOrUndefined(t.extrudedHeight,ze.MINIMUM_VALUE),o=j.getValueOrDefault(t.extrudedHeightReference,ze.MINIMUM_VALUE,We.NONE);u(r)&&!u(i)&&(i=0);let a=this._options;a.vertexFormat=this._materialProperty instanceof Nt?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,a.center=e.position.getValue(ze.MINIMUM_VALUE,a.center),a.semiMajorAxis=t.semiMajorAxis.getValue(ze.MINIMUM_VALUE,a.semiMajorAxis),a.semiMinorAxis=t.semiMinorAxis.getValue(ze.MINIMUM_VALUE,a.semiMinorAxis),a.rotation=j.getValueOrUndefined(t.rotation,ze.MINIMUM_VALUE),a.granularity=j.getValueOrUndefined(t.granularity,ze.MINIMUM_VALUE),a.stRotation=j.getValueOrUndefined(t.stRotation,ze.MINIMUM_VALUE),a.numberOfVerticalLines=j.getValueOrUndefined(t.numberOfVerticalLines,ze.MINIMUM_VALUE),a.offsetAttribute=qn.computeGeometryOffsetAttribute(i,n,r,o),a.height=qn.getGeometryHeight(i,n),r=qn.getGeometryExtrudedHeight(r,o),r===qn.CLAMP_TO_GROUND&&(r=li.getMinimumMaximumHeights(Yc.computeRectangle(a,f_e)).minimumTerrainHeight),a.extrudedHeight=r},Md.DynamicGeometryUpdater=lE,u(Object.create)&&(lE.prototype=Object.create(ri.prototype),lE.prototype.constructor=lE),lE.prototype._isHidden=function(e,t,i){let n=this._options;return!u(n.center)||!u(n.semiMajorAxis)||!u(n.semiMinorAxis)||ri.prototype._isHidden.call(this,e,t,i)},lE.prototype._setOptions=function(e,t,i){let n=this._options,r=j.getValueOrUndefined(t.height,i),o=j.getValueOrDefault(t.heightReference,i,We.NONE),a=j.getValueOrUndefined(t.extrudedHeight,i),s=j.getValueOrDefault(t.extrudedHeightReference,i,We.NONE);u(a)&&!u(r)&&(r=0),n.center=j.getValueOrUndefined(e.position,i,n.center),n.semiMajorAxis=j.getValueOrUndefined(t.semiMajorAxis,i),n.semiMinorAxis=j.getValueOrUndefined(t.semiMinorAxis,i),n.rotation=j.getValueOrUndefined(t.rotation,i),n.granularity=j.getValueOrUndefined(t.granularity,i),n.stRotation=j.getValueOrUndefined(t.stRotation,i),n.numberOfVerticalLines=j.getValueOrUndefined(t.numberOfVerticalLines,i),n.offsetAttribute=qn.computeGeometryOffsetAttribute(r,o,a,s),n.height=qn.getGeometryHeight(r,o),a=qn.getGeometryExtrudedHeight(a,s),a===qn.CLAMP_TO_GROUND&&(a=li.getMinimumMaximumHeights(Yc.computeRectangle(n,f_e)).minimumTerrainHeight),n.extrudedHeight=a};var GU=Md,sdt=new Nt(z.WHITE),J7=h.ZERO,eq=new h,adt=new h,cdt=new h,tq=new z,ldt=new h(1,1,1);function udt(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.innerRadii=void 0,this.minimumClock=void 0,this.maximumClock=void 0,this.minimumCone=void 0,this.maximumCone=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function du(e,t){si.call(this,{entity:e,scene:t,geometryOptions:new udt(e),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function lI(e,t,i){ri.call(this,e,t,i),this._scene=e._scene,this._modelMatrix=new L,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new h,this._material={}}u(Object.create)&&(du.prototype=Object.create(si.prototype),du.prototype.constructor=du),Object.defineProperties(du.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),du.prototype.createFillGeometryInstance=function(e,t,i){let n,r=this._entity,o=r.isAvailable(e),a=new gn(o&&r.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),s=this._distanceDisplayConditionProperty.getValue(e),l={show:a,distanceDisplayCondition:Vn.fromDistanceDisplayCondition(s),color:void 0,offset:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)&&(t=this._materialProperty.color.getValue(e,tq)),u(t)||(t=z.WHITE),n=kt.fromColor(t),l.color=n}return u(this._options.offsetAttribute)&&(l.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,J7,eq))),new yt({id:r,geometry:new Ms(this._options),modelMatrix:t?void 0:r.computeModelMatrixForHeightReference(e,r.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,i),attributes:l})},du.prototype.createOutlineGeometryInstance=function(e,t,i){let n=this._entity,r=n.isAvailable(e),o=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,tq),a=this._distanceDisplayConditionProperty.getValue(e),s={show:new gn(r&&n.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(a),offset:void 0};return u(this._options.offsetAttribute)&&(s.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,J7,eq))),new yt({id:n,geometry:new Fu(this._options),modelMatrix:t?void 0:n.computeModelMatrixForHeightReference(e,n.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,i),attributes:s})},du.prototype._computeCenter=function(e,t){return j.getValueOrUndefined(this._entity.position,e,t)},du.prototype._isHidden=function(e,t){return!u(e.position)||!u(t.radii)||si.prototype._isHidden.call(this,e,t)},du.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&j.isConstant(e.orientation)&&t.radii.isConstant&&j.isConstant(t.innerRadii)&&j.isConstant(t.stackPartitions)&&j.isConstant(t.slicePartitions)&&j.isConstant(t.outlineWidth)&&j.isConstant(t.minimumClock)&&j.isConstant(t.maximumClock)&&j.isConstant(t.minimumCone)&&j.isConstant(t.maximumCone)&&j.isConstant(t.subdivisions))},du.prototype._setStaticOptions=function(e,t){let i=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof Nt?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,n.radii=t.radii.getValue(ze.MINIMUM_VALUE,n.radii),n.innerRadii=j.getValueOrUndefined(t.innerRadii,n.radii),n.minimumClock=j.getValueOrUndefined(t.minimumClock,ze.MINIMUM_VALUE),n.maximumClock=j.getValueOrUndefined(t.maximumClock,ze.MINIMUM_VALUE),n.minimumCone=j.getValueOrUndefined(t.minimumCone,ze.MINIMUM_VALUE),n.maximumCone=j.getValueOrUndefined(t.maximumCone,ze.MINIMUM_VALUE),n.stackPartitions=j.getValueOrUndefined(t.stackPartitions,ze.MINIMUM_VALUE),n.slicePartitions=j.getValueOrUndefined(t.slicePartitions,ze.MINIMUM_VALUE),n.subdivisions=j.getValueOrUndefined(t.subdivisions,ze.MINIMUM_VALUE),n.offsetAttribute=i!==We.NONE?on.ALL:void 0},du.prototype._onEntityPropertyChanged=ay,du.DynamicGeometryUpdater=lI,u(Object.create)&&(lI.prototype=Object.create(ri.prototype),lI.prototype.constructor=lI),lI.prototype.update=function(e){let t=this._entity,i=t.ellipsoid;if(!t.isShowing||!t.isAvailable(e)||!j.getValueOrDefault(i.show,e,!0))return u(this._primitive)&&(this._primitive.show=!1),void(u(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));let n=j.getValueOrUndefined(i.radii,e,adt),r=u(n)?t.computeModelMatrixForHeightReference(e,i.heightReference,.5*n.z,this._scene.mapProjection.ellipsoid,this._modelMatrix):void 0;if(!u(r)||!u(n))return u(this._primitive)&&(this._primitive.show=!1),void(u(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));let o=j.getValueOrDefault(i.fill,e,!0),a=j.getValueOrDefault(i.outline,e,!1),s=j.getValueOrClonedDefault(i.outlineColor,e,z.BLACK,tq),l=Jo.getValue(e,y(i.material,sdt),this._material),c=j.getValueOrUndefined(i.innerRadii,e,cdt),d=j.getValueOrUndefined(i.minimumClock,e),p=j.getValueOrUndefined(i.maximumClock,e),f=j.getValueOrUndefined(i.minimumCone,e),m=j.getValueOrUndefined(i.maximumCone,e),_=j.getValueOrUndefined(i.stackPartitions,e),g=j.getValueOrUndefined(i.slicePartitions,e),v=j.getValueOrUndefined(i.subdivisions,e),b=j.getValueOrDefault(i.outlineWidth,e,1),A=j.getValueOrDefault(i.heightReference,e,We.NONE),T=A!==We.NONE?on.ALL:void 0,E=this._scene.mode,C=E===te.SCENE3D&&A===We.NONE,x=this._options,S=this._geometryUpdater.shadowsProperty.getValue(e),w=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),I=j.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,e,J7,eq);if(!C||this._lastSceneMode!==E||!u(this._primitive)||x.stackPartitions!==_||x.slicePartitions!==g||u(c)&&!h.equals(x.innerRadii!==c)||x.minimumClock!==d||x.maximumClock!==p||x.minimumCone!==f||x.maximumCone!==m||x.subdivisions!==v||this._lastOutlineWidth!==b||x.offsetAttribute!==T){let t=this._primitives;if(t.removeAndDestroy(this._primitive),t.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=E,this._lastOutlineWidth=b,x.stackPartitions=_,x.slicePartitions=g,x.subdivisions=v,x.offsetAttribute=T,x.radii=h.clone(C?ldt:n,x.radii),u(c))if(C){let e=h.magnitude(n);x.innerRadii=h.fromElements(c.x/e,c.y/e,c.z/e,x.innerRadii)}else x.innerRadii=h.clone(c,x.innerRadii);else x.innerRadii=void 0;x.minimumClock=d,x.maximumClock=p,x.minimumCone=f,x.maximumCone=m;let i=new ao({material:l,translucent:l.isTranslucent(),closed:!0});x.vertexFormat=i.vertexFormat;let r=this._geometryUpdater.createFillGeometryInstance(e,C,this._modelMatrix);this._primitive=t.add(new Sn({geometryInstances:r,appearance:i,asynchronous:!1,shadows:S}));let y=this._geometryUpdater.createOutlineGeometryInstance(e,C,this._modelMatrix);this._outlinePrimitive=t.add(new Sn({geometryInstances:y,appearance:new rn({flat:!0,translucent:255!==y.attributes.color.value[3],renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(b)}}),asynchronous:!1,shadows:S})),this._lastShow=o,this._lastOutlineShow=a,this._lastOutlineColor=z.clone(s,this._lastOutlineColor),this._lastDistanceDisplayCondition=w,this._lastOffset=h.clone(I,this._lastOffset)}else if(this._primitive.ready){let e=this._primitive,i=this._outlinePrimitive;e.show=!0,i.show=!0,e.appearance.material=l;let n=this._attributes;u(n)||(n=e.getGeometryInstanceAttributes(t),this._attributes=n),o!==this._lastShow&&(n.show=gn.toValue(o,n.show),this._lastShow=o);let r=this._outlineAttributes;u(r)||(r=i.getGeometryInstanceAttributes(t),this._outlineAttributes=r),a!==this._lastOutlineShow&&(r.show=gn.toValue(a,r.show),this._lastOutlineShow=a),z.equals(s,this._lastOutlineColor)||(r.color=kt.toValue(s,r.color),z.clone(s,this._lastOutlineColor)),wt.equals(w,this._lastDistanceDisplayCondition)||(n.distanceDisplayCondition=Vn.toValue(w,n.distanceDisplayCondition),r.distanceDisplayCondition=Vn.toValue(w,r.distanceDisplayCondition),wt.clone(w,this._lastDistanceDisplayCondition)),h.equals(I,this._lastOffset)||(n.offset=Zi.toValue(I,n.offset),r.offset=Zi.toValue(I,n.offset),h.clone(I,this._lastOffset))}C&&(n.x=Math.max(n.x,.001),n.y=Math.max(n.y,.001),n.z=Math.max(n.z,.001),r=L.multiplyByScale(r,n,r),this._primitive.modelMatrix=r,this._outlinePrimitive.modelMatrix=r)};var WU=du,fdt=new h,d_e=new z;function ddt(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function Cf(e,t){si.call(this,{entity:e,scene:t,geometryOptions:new ddt(e),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}function uE(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(Cf.prototype=Object.create(si.prototype),Cf.prototype.constructor=Cf),Cf.prototype.createFillGeometryInstance=function(e){let t,i,n=this._entity,r=n.isAvailable(e),o=new gn(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),s=Vn.fromDistanceDisplayCondition(a);if(this._materialProperty instanceof Nt){let n;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(n=this._materialProperty.color.getValue(e,d_e)),u(n)||(n=z.WHITE),i=kt.fromColor(n),t={show:o,distanceDisplayCondition:s,color:i}}else t={show:o,distanceDisplayCondition:s};let l=n.plane,c=this._options,h=n.computeModelMatrix(e),d=j.getValueOrDefault(l.plane,e,c.plane),p=j.getValueOrUndefined(l.dimensions,e,c.dimensions);return c.plane=d,c.dimensions=p,h=nq(d,p,h,h),new yt({id:n,geometry:new hO(this._options),modelMatrix:h,attributes:t})},Cf.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,d_e),r=this._distanceDisplayConditionProperty.getValue(e),o=t.plane,a=this._options,s=t.computeModelMatrix(e),l=j.getValueOrDefault(o.plane,e,a.plane),u=j.getValueOrUndefined(o.dimensions,e,a.dimensions);return a.plane=l,a.dimensions=u,s=nq(l,u,s,s),new yt({id:t,geometry:new pO,modelMatrix:s,attributes:{show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r)}})},Cf.prototype._isHidden=function(e,t){return!u(t.plane)||!u(t.dimensions)||!u(e.position)||si.prototype._isHidden.call(this,e,t)},Cf.prototype._getIsClosed=function(e){return!1},Cf.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&j.isConstant(e.orientation)&&t.plane.isConstant&&t.dimensions.isConstant&&j.isConstant(t.outlineWidth))},Cf.prototype._setStaticOptions=function(e,t){let i=this._materialProperty instanceof Nt,n=this._options;n.vertexFormat=i?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,n.plane=t.plane.getValue(ze.MINIMUM_VALUE,n.plane),n.dimensions=t.dimensions.getValue(ze.MINIMUM_VALUE,n.dimensions)},Cf.DynamicGeometryUpdater=uE,u(Object.create)&&(uE.prototype=Object.create(ri.prototype),uE.prototype.constructor=uE),uE.prototype._isHidden=function(e,t,i){let n=this._options,r=j.getValueOrUndefined(e.position,i,fdt);return!u(r)||!u(n.plane)||!u(n.dimensions)||ri.prototype._isHidden.call(this,e,t,i)},uE.prototype._setOptions=function(e,t,i){let n=this._options;n.plane=j.getValueOrDefault(t.plane,i,n.plane),n.dimensions=j.getValueOrUndefined(t.dimensions,i,n.dimensions)};var hdt=new h,mdt=new h,pdt=new h,_dt=new h,gdt=new $,ydt=new $,xdt=new L;function nq(e,t,i,n){let r=e.normal,o=e.distance,a=h.multiplyByScalar(r,-o,pdt),s=h.clone(h.UNIT_Z,mdt);P.equalsEpsilon(Math.abs(h.dot(s,r)),1,P.EPSILON8)&&(s=h.clone(h.UNIT_Y,s));let l=h.cross(s,r,hdt);s=h.cross(r,l,s),h.normalize(l,l),h.normalize(s,s);let u=gdt;$.setColumn(u,0,l,u),$.setColumn(u,1,s,u),$.setColumn(u,2,r,u);let c=h.fromElements(t.x,t.y,1,_dt),d=$.multiplyByScale(u,c,ydt),p=L.fromRotationTranslation(d,a,xdt);return L.multiplyTransformation(i,p,n)}Cf.createPrimitiveMatrix=nq;var jU=Cf,h_e="Entity polygons cannot have both height and perPositionHeight.  height will be ignored",m_e="heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored",p_e=new z,__e=h.ZERO,g_e=new h,y_e=new ce,bdt=[],Tdt=new U;function Adt(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0,this.arcType=void 0,this.textureCoordinates=void 0}function hu(e,t){qn.call(this,{entity:e,scene:t,geometryOptions:new Adt(e),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function fE(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(hu.prototype=Object.create(qn.prototype),hu.prototype.constructor=hu),hu.prototype.createFillGeometryInstance=function(e){let t,i=this._entity,n=i.isAvailable(e),r=this._options,o={show:new gn(n&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,p_e)),u(t)||(t=z.WHITE),o.color=kt.fromColor(t)}return u(r.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,__e,g_e))),t=r.perPositionHeight&&!u(r.extrudedHeight)?new b1(r):new MT(r),new yt({id:i,geometry:t,attributes:o})},hu.prototype.createOutlineGeometryInstance=function(e){let t,i=this._entity,n=i.isAvailable(e),r=this._options,o=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,p_e),a=this._distanceDisplayConditionProperty.getValue(e),s={show:new gn(n&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(o),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(a),offset:void 0};return u(r.offsetAttribute)&&(s.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,__e,g_e))),t=r.perPositionHeight&&!u(r.extrudedHeight)?new zf(r):new yO(r),new yt({id:i,geometry:t,attributes:s})},hu.prototype._computeCenter=function(e,t){let i=j.getValueOrUndefined(this._entity.polygon.hierarchy,e);if(!u(i))return;let n=i.positions;if(0===n.length)return;let r=this._scene.mapProjection.ellipsoid,o=Vr.fromPoints(n,r),a=o.projectPointsOntoPlane(n,bdt),s=a.length,l=0,c=s-1,h=new U;for(let e=0;e<s;c=e++){let t=a[e],i=a[c],n=t.x*i.y-i.x*t.y,r=U.add(t,i,Tdt);r=U.multiplyByScalar(r,n,r),h=U.add(h,r,h),l+=n}let d=1/(3*l);return h=U.multiplyByScalar(h,d,h),o.projectPointOntoEllipsoid(h,t)},hu.prototype._isHidden=function(e,t){return!u(t.hierarchy)||si.prototype._isHidden.call(this,e,t)},hu.prototype._isOnTerrain=function(e,t){let i=qn.prototype._isOnTerrain.call(this,e,t),n=t.perPositionHeight,r=u(n)&&(!n.isConstant||n.getValue(ze.MINIMUM_VALUE));return i&&!r},hu.prototype._isDynamic=function(e,t){return!t.hierarchy.isConstant||!j.isConstant(t.height)||!j.isConstant(t.extrudedHeight)||!j.isConstant(t.granularity)||!j.isConstant(t.stRotation)||!j.isConstant(t.textureCoordinates)||!j.isConstant(t.outlineWidth)||!j.isConstant(t.perPositionHeight)||!j.isConstant(t.closeTop)||!j.isConstant(t.closeBottom)||!j.isConstant(t.zIndex)||!j.isConstant(t.arcType)||this._onTerrain&&!j.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Nt)},hu.prototype._setStaticOptions=function(e,t){let i=this._materialProperty instanceof Nt,n=this._options;n.vertexFormat=i?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat;let r,o=t.hierarchy.getValue(ze.MINIMUM_VALUE),a=j.getValueOrUndefined(t.height,ze.MINIMUM_VALUE),s=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),l=j.getValueOrUndefined(t.extrudedHeight,ze.MINIMUM_VALUE),c=j.getValueOrDefault(t.extrudedHeightReference,ze.MINIMUM_VALUE,We.NONE),h=j.getValueOrDefault(t.perPositionHeight,ze.MINIMUM_VALUE,!1);a=qn.getGeometryHeight(a,s),h?(u(a)&&(a=void 0,It(h_e)),s!==We.NONE&&h&&(a=void 0,It(m_e))):(u(l)&&!u(a)&&(a=0),r=qn.computeGeometryOffsetAttribute(a,s,l,c)),n.polygonHierarchy=o,n.granularity=j.getValueOrUndefined(t.granularity,ze.MINIMUM_VALUE),n.stRotation=j.getValueOrUndefined(t.stRotation,ze.MINIMUM_VALUE),n.perPositionHeight=h,n.closeTop=j.getValueOrDefault(t.closeTop,ze.MINIMUM_VALUE,!0),n.closeBottom=j.getValueOrDefault(t.closeBottom,ze.MINIMUM_VALUE,!0),n.offsetAttribute=r,n.height=a,n.arcType=j.getValueOrDefault(t.arcType,ze.MINIMUM_VALUE,Yt.GEODESIC),n.textureCoordinates=j.getValueOrUndefined(t.textureCoordinates,ze.MINIMUM_VALUE),l=qn.getGeometryExtrudedHeight(l,c),l===qn.CLAMP_TO_GROUND&&(l=li.getMinimumMaximumHeights(MT.computeRectangle(n,y_e)).minimumTerrainHeight),n.extrudedHeight=l},hu.prototype._getIsClosed=function(e){let t=e.height,i=e.extrudedHeight,n=u(i)&&i!==t;return!e.perPositionHeight&&(!n&&0===t||n&&e.closeTop&&e.closeBottom)},hu.DynamicGeometryUpdater=fE,u(Object.create)&&(fE.prototype=Object.create(ri.prototype),fE.prototype.constructor=fE),fE.prototype._isHidden=function(e,t,i){return!u(this._options.polygonHierarchy)||ri.prototype._isHidden.call(this,e,t,i)},fE.prototype._setOptions=function(e,t,i){let n=this._options;n.polygonHierarchy=j.getValueOrUndefined(t.hierarchy,i);let r,o=j.getValueOrUndefined(t.height,i),a=j.getValueOrDefault(t.heightReference,i,We.NONE),s=j.getValueOrDefault(t.extrudedHeightReference,i,We.NONE),l=j.getValueOrUndefined(t.extrudedHeight,i),c=j.getValueOrUndefined(t.perPositionHeight,i);o=qn.getGeometryHeight(o,s),c?(u(o)&&(o=void 0,It(h_e)),a!==We.NONE&&c&&(o=void 0,It(m_e))):(u(l)&&!u(o)&&(o=0),r=qn.computeGeometryOffsetAttribute(o,a,l,s)),n.granularity=j.getValueOrUndefined(t.granularity,i),n.stRotation=j.getValueOrUndefined(t.stRotation,i),n.textureCoordinates=j.getValueOrUndefined(t.textureCoordinates,i),n.perPositionHeight=j.getValueOrUndefined(t.perPositionHeight,i),n.closeTop=j.getValueOrDefault(t.closeTop,i,!0),n.closeBottom=j.getValueOrDefault(t.closeBottom,i,!0),n.offsetAttribute=r,n.height=o,n.arcType=j.getValueOrDefault(t.arcType,i,Yt.GEODESIC),l=qn.getGeometryExtrudedHeight(l,s),l===qn.CLAMP_TO_GROUND&&(l=li.getMinimumMaximumHeights(MT.computeRectangle(n,y_e)).minimumTerrainHeight),n.extrudedHeight=l};var qU=hu,x_e=new z;function Cdt(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function dm(e,t){si.call(this,{entity:e,scene:t,geometryOptions:new Cdt(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function dE(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(dm.prototype=Object.create(si.prototype),dm.prototype.constructor=dm),dm.prototype.createFillGeometryInstance=function(e){let t,i,n=this._entity,r=n.isAvailable(e),o=new gn(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),s=Vn.fromDistanceDisplayCondition(a);if(this._materialProperty instanceof Nt){let n;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(n=this._materialProperty.color.getValue(e,x_e)),u(n)||(n=z.WHITE),i=kt.fromColor(n),t={show:o,distanceDisplayCondition:s,color:i}}else t={show:o,distanceDisplayCondition:s};return new yt({id:n,geometry:new xO(this._options),attributes:t})},dm.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,x_e),r=this._distanceDisplayConditionProperty.getValue(e);return new yt({id:t,geometry:new bO(this._options),attributes:{show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r)}})},dm.prototype._isHidden=function(e,t){return!u(t.positions)||!u(t.shape)||si.prototype._isHidden.call(this,e,t)},dm.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&t.shape.isConstant&&j.isConstant(t.granularity)&&j.isConstant(t.outlineWidth)&&j.isConstant(t.cornerType))},dm.prototype._setStaticOptions=function(e,t){let i=t.granularity,n=t.cornerType,r=this._options,o=this._materialProperty instanceof Nt;r.vertexFormat=o?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,r.polylinePositions=t.positions.getValue(ze.MINIMUM_VALUE,r.polylinePositions),r.shapePositions=t.shape.getValue(ze.MINIMUM_VALUE,r.shape),r.granularity=u(i)?i.getValue(ze.MINIMUM_VALUE):void 0,r.cornerType=u(n)?n.getValue(ze.MINIMUM_VALUE):void 0},dm.DynamicGeometryUpdater=dE,u(Object.create)&&(dE.prototype=Object.create(ri.prototype),dE.prototype.constructor=dE),dE.prototype._isHidden=function(e,t,i){let n=this._options;return!u(n.polylinePositions)||!u(n.shapePositions)||ri.prototype._isHidden.call(this,e,t,i)},dE.prototype._setOptions=function(e,t,i){let n=this._options;n.polylinePositions=j.getValueOrUndefined(t.positions,i,n.polylinePositions),n.shapePositions=j.getValueOrUndefined(t.shape,i),n.granularity=j.getValueOrUndefined(t.granularity,i),n.cornerType=j.getValueOrUndefined(t.cornerType,i)};var YU=dm,b_e=new z,T_e=h.ZERO,A_e=new h,C_e=new ce,Edt=new ce,Sdt=new fe;function wdt(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function Ld(e,t){qn.call(this,{entity:e,scene:t,geometryOptions:new wdt(e),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function hE(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(Ld.prototype=Object.create(qn.prototype),Ld.prototype.constructor=Ld),Ld.prototype.createFillGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};if(this._materialProperty instanceof Nt){let t;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||i)&&(t=this._materialProperty.color.getValue(e,b_e)),u(t)||(t=z.WHITE),n.color=kt.fromColor(t)}return u(this._options.offsetAttribute)&&(n.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,T_e,A_e))),new yt({id:t,geometry:new kT(this._options),attributes:n})},Ld.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,b_e),r=this._distanceDisplayConditionProperty.getValue(e),o={show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r),offset:void 0};return u(this._options.offsetAttribute)&&(o.offset=Zi.fromCartesian3(j.getValueOrDefault(this._terrainOffsetProperty,e,T_e,A_e))),new yt({id:t,geometry:new zT(this._options),attributes:o})},Ld.prototype._computeCenter=function(e,t){let i=j.getValueOrUndefined(this._entity.rectangle.coordinates,e,Edt);if(!u(i))return;let n=ce.center(i,Sdt);return fe.toCartesian(n,ie.WGS84,t)},Ld.prototype._isHidden=function(e,t){return!u(t.coordinates)||si.prototype._isHidden.call(this,e,t)},Ld.prototype._isDynamic=function(e,t){return!t.coordinates.isConstant||!j.isConstant(t.height)||!j.isConstant(t.extrudedHeight)||!j.isConstant(t.granularity)||!j.isConstant(t.stRotation)||!j.isConstant(t.rotation)||!j.isConstant(t.outlineWidth)||!j.isConstant(t.zIndex)||this._onTerrain&&!j.isConstant(this._materialProperty)&&!(this._materialProperty instanceof Nt)},Ld.prototype._setStaticOptions=function(e,t){let i=this._materialProperty instanceof Nt,n=j.getValueOrUndefined(t.height,ze.MINIMUM_VALUE),r=j.getValueOrDefault(t.heightReference,ze.MINIMUM_VALUE,We.NONE),o=j.getValueOrUndefined(t.extrudedHeight,ze.MINIMUM_VALUE),a=j.getValueOrDefault(t.extrudedHeightReference,ze.MINIMUM_VALUE,We.NONE);u(o)&&!u(n)&&(n=0);let s=this._options;s.vertexFormat=i?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,s.rectangle=t.coordinates.getValue(ze.MINIMUM_VALUE,s.rectangle),s.granularity=j.getValueOrUndefined(t.granularity,ze.MINIMUM_VALUE),s.stRotation=j.getValueOrUndefined(t.stRotation,ze.MINIMUM_VALUE),s.rotation=j.getValueOrUndefined(t.rotation,ze.MINIMUM_VALUE),s.offsetAttribute=qn.computeGeometryOffsetAttribute(n,r,o,a),s.height=qn.getGeometryHeight(n,r),o=qn.getGeometryExtrudedHeight(o,a),o===qn.CLAMP_TO_GROUND&&(o=li.getMinimumMaximumHeights(kT.computeRectangle(s,C_e)).minimumTerrainHeight),s.extrudedHeight=o},Ld.DynamicGeometryUpdater=hE,u(Object.create)&&(hE.prototype=Object.create(ri.prototype),hE.prototype.constructor=hE),hE.prototype._isHidden=function(e,t,i){return!u(this._options.rectangle)||ri.prototype._isHidden.call(this,e,t,i)},hE.prototype._setOptions=function(e,t,i){let n=this._options,r=j.getValueOrUndefined(t.height,i),o=j.getValueOrDefault(t.heightReference,i,We.NONE),a=j.getValueOrUndefined(t.extrudedHeight,i),s=j.getValueOrDefault(t.extrudedHeightReference,i,We.NONE);u(a)&&!u(r)&&(r=0),n.rectangle=j.getValueOrUndefined(t.coordinates,i,n.rectangle),n.granularity=j.getValueOrUndefined(t.granularity,i),n.stRotation=j.getValueOrUndefined(t.stRotation,i),n.rotation=j.getValueOrUndefined(t.rotation,i),n.offsetAttribute=qn.computeGeometryOffsetAttribute(r,o,a,s),n.height=qn.getGeometryHeight(r,o),a=qn.getGeometryExtrudedHeight(a,s),a===qn.CLAMP_TO_GROUND&&(a=li.getMinimumMaximumHeights(kT.computeRectangle(n,C_e)).minimumTerrainHeight),n.extrudedHeight=a};var XU=Ld,E_e=new z,vdt=new wt,Ddt=new wt,Idt=h.ZERO,Pdt=new h;function Nd(e,t,i,n,r,o,a){let s;this.translucent=t,this.appearanceType=i,this.depthFailAppearanceType=n,this.depthFailMaterialProperty=r,this.depthFailMaterial=void 0,this.closed=o,this.shadows=a,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new bt,this.updaters=new bt,this.updatersWithAttributes=new bt,this.attributes=new bt,this.subscriptions=new bt,this.showsUpdated=new bt,this.itemsToRemove=[],this.invalidated=!1,u(r)&&(s=r.definitionChanged.addEventListener(Nd.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=s}function mE(e,t,i,n,r){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}function S_e(e,t){for(let i=e.length-1;i>=0;i--){let n=e[i];if(n.remove(t))return 0===n.updaters.length&&(e.splice(i,1),n.destroy()),!0}return!1}function w_e(e,t,i){let n=!1,r=t.length;for(let o=0;o<r;++o){let r=t[o],a=r.itemsToRemove,s=a.length;if(s>0)for(o=0;o<s;o++){let t=a[o];r.remove(t),e.add(i,t),n=!0}}return n}function KU(e,t,i,n){let r,o=t.length;for(r=o-1;r>=0;r--){let n=t[r];if(n.invalidated){t.splice(r,1);let o=n.updaters.values,a=o.length;for(let t=0;t<a;t++)e.add(i,o[t]);n.destroy()}}for(o=t.length,r=0;r<o;++r)n=t[r].update(i)&&n;return n}function v_e(e,t,i){let n=e.length;for(let r=0;r<n;r++){let n=e[r];if(n.contains(t))return n.getBoundingSphere(t,i)}return at.FAILED}function D_e(e){let t=e.length;for(let i=0;i<t;i++)e[i].destroy();e.length=0}Nd.prototype.onMaterialChanged=function(){this.invalidated=!0},Nd.prototype.isMaterial=function(e){let t=this.depthFailMaterialProperty,i=e.depthFailMaterialProperty;return i===t||!!u(t)&&t.equals(i)},Nd.prototype.add=function(e,t){let i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&j.isConstant(e.distanceDisplayConditionProperty)&&j.isConstant(e.terrainOffsetProperty)){let t=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&t.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e)},Nd.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let e=this.subscriptions.get(t);return u(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},Nd.prototype.update=function(e){let t,i=!0,n=0,r=this.primitive,o=this.primitives;if(this.createPrimitive){let t=this.geometry.values;if(t.length>0){let n;u(r)&&(u(this.oldPrimitive)?o.remove(r):this.oldPrimitive=r),u(this.depthFailAppearanceType)&&(u(this.depthFailMaterialProperty)&&(this.depthFailMaterial=Jo.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),n=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),r=new Sn({show:!1,asynchronous:!0,geometryInstances:t.slice(),appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:n,shadows:this.shadows}),o.add(r),i=!1}else{u(r)&&(o.remove(r),r=void 0);let e=this.oldPrimitive;u(e)&&(o.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=r,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(u(r)&&r.ready){r.show=!0,u(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0),u(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof Nt)&&(this.depthFailMaterial=Jo.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);let i=this.updatersWithAttributes.values,a=i.length,s=this.waitingOnCreate;for(t=0;t<a;t++){let o=i[t],a=this.geometry.get(o.id),l=this.attributes.get(a.id.id);if(u(l)||(l=r.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,l)),!o.fillMaterialProperty.isConstant||s){let t=o.fillMaterialProperty.color,i=j.getValueOrDefault(t,e,z.WHITE,E_e);z.equals(l._lastColor,i)||(l._lastColor=z.clone(i,l._lastColor),l.color=kt.toValue(i,l.color),(this.translucent&&255===l.color[3]||!this.translucent&&255!==l.color[3])&&(this.itemsToRemove[n++]=o))}if(u(this.depthFailAppearanceType)&&o.depthFailMaterialProperty instanceof Nt&&(!o.depthFailMaterialProperty.isConstant||s)){let t=o.depthFailMaterialProperty.color,i=j.getValueOrDefault(t,e,z.WHITE,E_e);z.equals(l._lastDepthFailColor,i)||(l._lastDepthFailColor=z.clone(i,l._lastDepthFailColor),l.depthFailColor=kt.toValue(i,l.depthFailColor))}let c=o.entity.isShowing&&(o.hasConstantFill||o.isFilled(e));c!==(1===l.show[0])&&(l.show=gn.toValue(c,l.show));let d=o.distanceDisplayConditionProperty;if(!j.isConstant(d)){let t=j.getValueOrDefault(d,e,Ddt,vdt);wt.equals(t,l._lastDistanceDisplayCondition)||(l._lastDistanceDisplayCondition=wt.clone(t,l._lastDistanceDisplayCondition),l.distanceDisplayCondition=Vn.toValue(t,l.distanceDisplayCondition))}let p=o.terrainOffsetProperty;if(!j.isConstant(p)){let t=j.getValueOrDefault(p,e,Idt,Pdt);h.equals(t,l._lastOffset)||(l._lastOffset=h.clone(t,l._lastOffset),l.offset=Zi.toValue(t,l.offset))}}this.updateShows(r),this.waitingOnCreate=!1}else u(r)&&!r.ready&&(i=!1);return this.itemsToRemove.length=n,i},Nd.prototype.updateShows=function(e){let t=this.showsUpdated.values,i=t.length;for(let n=0;n<i;n++){let i=t[n],r=this.geometry.get(i.id),o=this.attributes.get(r.id.id);u(o)||(o=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,o));let a=i.entity.isShowing;a!==(1===o.show[0])&&(o.show=gn.toValue(a,o.show),r.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},Nd.prototype.contains=function(e){return this.updaters.contains(e.id)},Nd.prototype.getBoundingSphere=function(e,t){let i=this.primitive;if(!i.ready)return at.PENDING;let n=i.getGeometryInstanceAttributes(e.entity);return!u(n)||!u(n.boundingSphere)||u(n.show)&&0===n.show[0]?at.FAILED:(n.boundingSphere.clone(t),at.DONE)},Nd.prototype.destroy=function(){let e=this.primitive,t=this.primitives;u(e)&&t.remove(e);let i=this.oldPrimitive;u(i)&&t.remove(i),u(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},mE.prototype.add=function(e,t){let i,n,r=t.createFillGeometryInstance(e);255===r.attributes.color.value[3]?(i=this._solidItems,n=!1):(i=this._translucentItems,n=!0);let o=i.length;for(let e=0;e<o;e++){let n=i[e];if(n.isMaterial(t))return void n.add(t,r)}let a=new Nd(this._primitives,n,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);a.add(t,r),i.push(a)},mE.prototype.remove=function(e){S_e(this._solidItems,e)||S_e(this._translucentItems,e)},mE.prototype.update=function(e){let t=KU(this,this._solidItems,e,!0);t=KU(this,this._translucentItems,e,t)&&t;let i=w_e(this,this._solidItems,e),n=w_e(this,this._translucentItems,e);return(i||n)&&(t=KU(this,this._solidItems,e,t)&&t,t=KU(this,this._translucentItems,e,t)&&t),t},mE.prototype.getBoundingSphere=function(e,t){let i=v_e(this._solidItems,e,t);return i===at.FAILED?v_e(this._translucentItems,e,t):i},mE.prototype.removeAllPrimitives=function(){D_e(this._solidItems),D_e(this._translucentItems)};var Fd=mE,Odt=new wt,Rdt=new wt,Mdt=h.ZERO,Ldt=new h;function Bd(e,t,i,n,r,o,a){this.primitives=e,this.appearanceType=t,this.materialProperty=i,this.depthFailAppearanceType=n,this.depthFailMaterialProperty=r,this.closed=o,this.shadows=a,this.updaters=new bt,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new bt,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new bt,this.attributes=new bt,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(Bd.prototype.onMaterialChanged,this),this.subscriptions=new bt,this.showsUpdated=new bt}Bd.prototype.onMaterialChanged=function(){this.invalidated=!0},Bd.prototype.isMaterial=function(e){let t=this.materialProperty,i=e.fillMaterialProperty,n=this.depthFailMaterialProperty,r=e.depthFailMaterialProperty;if(i===t&&r===n)return!0;let o=u(t)&&t.equals(i);return o=(!u(n)&&!u(r)||u(n)&&n.equals(r))&&o,o},Bd.prototype.add=function(e,t){let i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,t.createFillGeometryInstance(e)),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&j.isConstant(t.distanceDisplayConditionProperty)&&j.isConstant(t.terrainOffsetProperty)){let e=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&e.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(i,t);this.createPrimitive=!0},Bd.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let e=this.subscriptions.get(t);return u(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var Ndt=new z;function pE(e,t,i,n,r){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}Bd.prototype.update=function(e){let t,i=!0,n=this.primitive,r=this.primitives,o=this.geometry.values;if(this.createPrimitive){if(o.length>0){let t;u(n)&&(u(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),this.material=Jo.getValue(e,this.materialProperty,this.material),u(this.depthFailMaterialProperty)&&(this.depthFailMaterial=Jo.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),t=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),n=new Sn({show:!1,asynchronous:!0,geometryInstances:o.slice(),appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:t,shadows:this.shadows}),r.add(n),i=!1}else{u(n)&&(r.remove(n),n=void 0);let e=this.oldPrimitive;u(e)&&(r.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=Jo.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,u(this.depthFailAppearanceType)&&!(this.depthFailMaterialProperty instanceof Nt)&&(this.depthFailMaterial=Jo.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);let i=this.updatersWithAttributes.values,o=i.length;for(t=0;t<o;t++){let r=i[t],o=r.entity,a=this.geometry.get(r.id),s=this.attributes.get(a.id.id);if(u(s)||(s=n.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s)),u(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof Nt&&!r.depthFailMaterialProperty.isConstant){let t=r.depthFailMaterialProperty.color,i=j.getValueOrDefault(t,e,z.WHITE,Ndt);z.equals(s._lastDepthFailColor,i)||(s._lastDepthFailColor=z.clone(i,s._lastDepthFailColor),s.depthFailColor=kt.toValue(i,s.depthFailColor))}let l=o.isShowing&&(r.hasConstantFill||r.isFilled(e));l!==(1===s.show[0])&&(s.show=gn.toValue(l,s.show));let c=r.distanceDisplayConditionProperty;if(!j.isConstant(c)){let t=j.getValueOrDefault(c,e,Rdt,Odt);wt.equals(t,s._lastDistanceDisplayCondition)||(s._lastDistanceDisplayCondition=wt.clone(t,s._lastDistanceDisplayCondition),s.distanceDisplayCondition=Vn.toValue(t,s.distanceDisplayCondition))}let d=r.terrainOffsetProperty;if(!j.isConstant(d)){let t=j.getValueOrDefault(d,e,Mdt,Ldt);h.equals(t,s._lastOffset)||(s._lastOffset=h.clone(t,s._lastOffset),s.offset=Zi.toValue(t,s.offset))}}this.updateShows(n)}else u(n)&&!n.ready&&(i=!1);return i},Bd.prototype.updateShows=function(e){let t=this.showsUpdated.values,i=t.length;for(let n=0;n<i;n++){let i=t[n],r=i.entity,o=this.geometry.get(i.id),a=this.attributes.get(o.id.id);u(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));let s=r.isShowing;s!==(1===a.show[0])&&(a.show=gn.toValue(s,a.show),o.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()},Bd.prototype.contains=function(e){return this.updaters.contains(e.id)},Bd.prototype.getBoundingSphere=function(e,t){let i=this.primitive;if(!i.ready)return at.PENDING;let n=i.getGeometryInstanceAttributes(e.entity);return!u(n)||!u(n.boundingSphere)||u(n.show)&&0===n.show[0]?at.FAILED:(n.boundingSphere.clone(t),at.DONE)},Bd.prototype.destroy=function(){let e=this.primitive,t=this.primitives;u(e)&&t.remove(e);let i=this.oldPrimitive;u(i)&&t.remove(i),this.removeMaterialSubscription()},pE.prototype.add=function(e,t){let i=this._items,n=i.length;for(let r=0;r<n;r++){let n=i[r];if(n.isMaterial(t))return void n.add(e,t)}let r=new Bd(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);r.add(e,t),i.push(r)},pE.prototype.remove=function(e){let t=this._items;for(let i=t.length-1;i>=0;i--){let n=t[i];if(n.remove(e)){0===n.updaters.length&&(t.splice(i,1),n.destroy());break}}},pE.prototype.update=function(e){let t,i=this._items;for(t=i.length-1;t>=0;t--){let n=i[t];if(n.invalidated){i.splice(t,1);let r=n.updaters.values,o=r.length;for(let t=0;t<o;t++)this.add(e,r[t]);n.destroy()}}let n=!0;for(t=0;t<i.length;t++)n=i[t].update(e)&&n;return n},pE.prototype.getBoundingSphere=function(e,t){let i=this._items,n=i.length;for(let r=0;r<n;r++){let n=i[r];if(n.contains(e))return n.getBoundingSphere(e,t)}return at.FAILED},pE.prototype.removeAllPrimitives=function(){let e=this._items,t=e.length;for(let i=0;i<t;i++)e[i].destroy();this._items.length=0};var kd=pE,Fdt=new z,Bdt=new wt,kdt=new wt;function Kp(e,t,i,n){this.primitives=e,this.zIndex=n,this.classificationType=t,this.color=i,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new bt,this.updaters=new bt,this.updatersWithAttributes=new bt,this.attributes=new bt,this.subscriptions=new bt,this.showsUpdated=new bt,this.itemsToRemove=[],this.isDirty=!1,this.rectangleCollisionCheck=new NT}function _E(e,t){this._batches=[],this._primitives=e,this._classificationType=t}Kp.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},Kp.prototype.add=function(e,t){let i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),this.rectangleCollisionCheck.insert(i,t.geometry.rectangle),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&j.isConstant(e.distanceDisplayConditionProperty)){let t=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&t.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e)},Kp.prototype.remove=function(e){let t=e.id,i=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,i.geometry.rectangle),this.updatersWithAttributes.remove(t);let e=this.subscriptions.get(t);return u(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},Kp.prototype.update=function(e){let t,i=!0,n=this.primitive,r=this.primitives;if(this.createPrimitive){let e=this.geometry.values;if(e.length>0)u(n)&&(u(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),n=new pl({show:!1,asynchronous:!0,geometryInstances:e.slice(),classificationType:this.classificationType}),r.add(n,this.zIndex),i=!1;else{u(n)&&(r.remove(n),n=void 0);let e=this.oldPrimitive;u(e)&&(r.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0);let i=this.updatersWithAttributes.values,o=i.length,a=this.waitingOnCreate;for(t=0;t<o;t++){let r=i[t],o=this.geometry.get(r.id),s=this.attributes.get(o.id.id);if(u(s)||(s=n.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,s)),!r.fillMaterialProperty.isConstant||a){let t=r.fillMaterialProperty.color,i=j.getValueOrDefault(t,e,z.WHITE,Fdt);z.equals(s._lastColor,i)||(s._lastColor=z.clone(i,s._lastColor),s.color=kt.toValue(i,s.color))}let l=r.entity.isShowing&&(r.hasConstantFill||r.isFilled(e));l!==(1===s.show[0])&&(s.show=gn.toValue(l,s.show));let c=r.distanceDisplayConditionProperty;if(!j.isConstant(c)){let t=j.getValueOrDefault(c,e,kdt,Bdt);wt.equals(t,s._lastDistanceDisplayCondition)||(s._lastDistanceDisplayCondition=wt.clone(t,s._lastDistanceDisplayCondition),s.distanceDisplayCondition=Vn.toValue(t,s.distanceDisplayCondition))}}this.updateShows(n),this.waitingOnCreate=!1}else u(n)&&!n.ready&&(i=!1);return this.itemsToRemove.length=0,i},Kp.prototype.updateShows=function(e){let t=this.showsUpdated.values,i=t.length;for(let n=0;n<i;n++){let i=t[n],r=this.geometry.get(i.id),o=this.attributes.get(r.id.id);u(o)||(o=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,o));let a=i.entity.isShowing;a!==(1===o.show[0])&&(o.show=gn.toValue(a,o.show),r.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},Kp.prototype.contains=function(e){return this.updaters.contains(e.id)},Kp.prototype.getBoundingSphere=function(e,t){let i=this.primitive;if(!i.ready)return at.PENDING;let n=i.getBoundingSphere(e.entity);return u(n)?(n.clone(t),at.DONE):at.FAILED},Kp.prototype.removeAllPrimitives=function(){let e=this.primitives,t=this.primitive;u(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());let i=this.oldPrimitive;u(i)&&(e.remove(i),this.oldPrimitive=void 0)},_E.prototype.add=function(e,t){let i,n=t.createFillGeometryInstance(e),r=this._batches,o=j.getValueOrDefault(t.zIndex,0),a=r.length;for(let e=0;e<a;++e){let t=r[e];if(t.zIndex===o&&!t.overlapping(n.geometry.rectangle)){i=t;break}}return u(i)||(i=new Kp(this._primitives,this._classificationType,n.attributes.color.value,o),r.push(i)),i.add(t,n),i},_E.prototype.remove=function(e){let t=this._batches,i=t.length;for(let n=0;n<i;++n)if(t[n].remove(e))return},_E.prototype.update=function(e){let t,i,n=!0,r=this._batches,o=r.length;for(t=0;t<o;++t)n=r[t].update(e)&&n;for(t=0;t<o;++t){let n=r[t],o=n.itemsToRemove,a=o.length;for(let t=0;t<a;t++){i=o[t],n.remove(i);let r=this.add(e,i);n.isDirty=!0,r.isDirty=!0}}for(t=o-1;t>=0;--t){let i=r[t];i.isDirty&&(n=r[t].update(e)&&n,i.isDirty=!1),0===i.geometry.length&&r.splice(t,1)}return n},_E.prototype.getBoundingSphere=function(e,t){let i=this._batches,n=i.length;for(let r=0;r<n;++r){let n=i[r];if(n.contains(e))return n.getBoundingSphere(e,t)}return at.FAILED},_E.prototype.removeAllPrimitives=function(){let e=this._batches,t=e.length;for(let i=0;i<t;++i)e[i].removeAllPrimitives()};var uI=_E,Vdt=new wt,Udt=new wt;function Ef(e,t,i,n,r,o){this.primitives=e,this.classificationType=t,this.appearanceType=i,this.materialProperty=n,this.updaters=new bt,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new bt,this.material=void 0,this.updatersWithAttributes=new bt,this.attributes=new bt,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(Ef.prototype.onMaterialChanged,this),this.subscriptions=new bt,this.showsUpdated=new bt,this.usingSphericalTextureCoordinates=r,this.zIndex=o,this.rectangleCollisionCheck=new NT}function gE(e,t,i){this._items=[],this._primitives=e,this._classificationType=t,this._appearanceType=i}Ef.prototype.onMaterialChanged=function(){this.invalidated=!0},Ef.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},Ef.prototype.isMaterial=function(e){let t=this.materialProperty,i=e.fillMaterialProperty;return i===t||i instanceof Nt&&t instanceof Nt||u(t)&&t.equals(i)},Ef.prototype.add=function(e,t,i){let n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,i),this.rectangleCollisionCheck.insert(n,i.geometry.rectangle),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&j.isConstant(t.distanceDisplayConditionProperty)){let e=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&e.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},Ef.prototype.remove=function(e){let t=e.id,i=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,i.geometry.rectangle),this.updatersWithAttributes.remove(t);let e=this.subscriptions.get(t);return u(e)&&(e(),this.subscriptions.remove(t)),!0}return!1},Ef.prototype.update=function(e){let t,i=!0,n=this.primitive,r=this.primitives,o=this.geometry.values;if(this.createPrimitive){if(o.length>0)u(n)&&(u(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),this.material=Jo.getValue(e,this.materialProperty,this.material),n=new pl({show:!1,asynchronous:!0,geometryInstances:o.slice(),appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),r.add(n,this.zIndex),i=!1;else{u(n)&&(r.remove(n),n=void 0);let e=this.oldPrimitive;u(e)&&(r.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=Jo.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;let i=this.updatersWithAttributes.values,o=i.length;for(t=0;t<o;t++){let r=i[t],o=r.entity,a=this.geometry.get(r.id),s=this.attributes.get(a.id.id);u(s)||(s=n.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s));let l=o.isShowing&&(r.hasConstantFill||r.isFilled(e));l!==(1===s.show[0])&&(s.show=gn.toValue(l,s.show));let c=r.distanceDisplayConditionProperty;if(!j.isConstant(c)){let t=j.getValueOrDefault(c,e,Udt,Vdt);wt.equals(t,s._lastDistanceDisplayCondition)||(s._lastDistanceDisplayCondition=wt.clone(t,s._lastDistanceDisplayCondition),s.distanceDisplayCondition=Vn.toValue(t,s.distanceDisplayCondition))}}this.updateShows(n)}else u(n)&&!n.ready&&(i=!1);return i},Ef.prototype.updateShows=function(e){let t=this.showsUpdated.values,i=t.length;for(let n=0;n<i;n++){let i=t[n],r=i.entity,o=this.geometry.get(i.id),a=this.attributes.get(o.id.id);u(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));let s=r.isShowing;s!==(1===a.show[0])&&(a.show=gn.toValue(s,a.show),o.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()},Ef.prototype.contains=function(e){return this.updaters.contains(e.id)},Ef.prototype.getBoundingSphere=function(e,t){let i=this.primitive;if(!i.ready)return at.PENDING;let n=i.getGeometryInstanceAttributes(e.entity);return!u(n)||!u(n.boundingSphere)||u(n.show)&&0===n.show[0]?at.FAILED:(n.boundingSphere.clone(t),at.DONE)},Ef.prototype.destroy=function(){let e=this.primitive,t=this.primitives;u(e)&&t.remove(e);let i=this.oldPrimitive;u(i)&&t.remove(i),this.removeMaterialSubscription()},gE.prototype.add=function(e,t){let i=this._items,n=i.length,r=t.createFillGeometryInstance(e),o=lf.shouldUseSphericalCoordinates(r.geometry.rectangle),a=j.getValueOrDefault(t.zIndex,0);for(let s=0;s<n;++s){let n=i[s];if(n.isMaterial(t)&&n.usingSphericalTextureCoordinates===o&&n.zIndex===a&&!n.overlapping(r.geometry.rectangle))return void n.add(e,t,r)}let s=new Ef(this._primitives,this._classificationType,this._appearanceType,t.fillMaterialProperty,o,a);s.add(e,t,r),i.push(s)},gE.prototype.remove=function(e){let t=this._items;for(let i=t.length-1;i>=0;i--){let n=t[i];if(n.remove(e)){0===n.updaters.length&&(t.splice(i,1),n.destroy());break}}},gE.prototype.update=function(e){let t,i=this._items;for(t=i.length-1;t>=0;t--){let n=i[t];if(n.invalidated){i.splice(t,1);let r=n.updaters.values,o=r.length;for(let t=0;t<o;t++)this.add(e,r[t]);n.destroy()}}let n=!0;for(t=0;t<i.length;t++)n=i[t].update(e)&&n;return n},gE.prototype.getBoundingSphere=function(e,t){let i=this._items,n=i.length;for(let r=0;r<n;r++){let n=i[r];if(n.contains(e))return n.getBoundingSphere(e,t)}return at.FAILED},gE.prototype.removeAllPrimitives=function(){let e=this._items,t=e.length;for(let i=0;i<t;i++)e[i].destroy();this._items.length=0};var ZU=gE,zdt=new z,Hdt=new wt,Gdt=new wt,Wdt=h.ZERO,jdt=new h;function Zp(e,t,i,n){this.translucent=t,this.width=i,this.shadows=n,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new bt,this.updaters=new bt,this.updatersWithAttributes=new bt,this.attributes=new bt,this.itemsToRemove=[],this.subscriptions=new bt,this.showsUpdated=new bt}function yE(e,t,i){this._primitives=e,this._scene=t,this._shadows=i,this._solidBatches=new bt,this._translucentBatches=new bt}Zp.prototype.add=function(e,t){let i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantOutline&&e.outlineColorProperty.isConstant&&j.isConstant(e.distanceDisplayConditionProperty)&&j.isConstant(e.terrainOffsetProperty)){let t=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&t.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e)},Zp.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let e=this.subscriptions.get(t);return u(e)&&(e(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},Zp.prototype.update=function(e){let t,i=!0,n=0,r=this.primitive,o=this.primitives;if(this.createPrimitive){let e=this.geometry.values;if(e.length>0)u(r)&&(u(this.oldPrimitive)?o.remove(r):this.oldPrimitive=r),r=new Sn({show:!1,asynchronous:!0,geometryInstances:e.slice(),appearance:new rn({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),o.add(r),i=!1;else{u(r)&&(o.remove(r),r=void 0);let e=this.oldPrimitive;u(e)&&(o.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=r,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(u(r)&&r.ready){r.show=!0,u(this.oldPrimitive)&&(o.remove(this.oldPrimitive),this.oldPrimitive=void 0);let i=this.updatersWithAttributes.values,a=i.length,s=this.waitingOnCreate;for(t=0;t<a;t++){let o=i[t],a=this.geometry.get(o.id),l=this.attributes.get(a.id.id);if(u(l)||(l=r.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,l)),!o.outlineColorProperty.isConstant||s){let t=o.outlineColorProperty,i=j.getValueOrDefault(t,e,z.WHITE,zdt);z.equals(l._lastColor,i)||(l._lastColor=z.clone(i,l._lastColor),l.color=kt.toValue(i,l.color),(this.translucent&&255===l.color[3]||!this.translucent&&255!==l.color[3])&&(this.itemsToRemove[n++]=o))}let c=o.entity.isShowing&&(o.hasConstantOutline||o.isOutlineVisible(e));c!==(1===l.show[0])&&(l.show=gn.toValue(c,l.show));let d=o.distanceDisplayConditionProperty;if(!j.isConstant(d)){let t=j.getValueOrDefault(d,e,Gdt,Hdt);wt.equals(t,l._lastDistanceDisplayCondition)||(l._lastDistanceDisplayCondition=wt.clone(t,l._lastDistanceDisplayCondition),l.distanceDisplayCondition=Vn.toValue(t,l.distanceDisplayCondition))}let p=o.terrainOffsetProperty;if(!j.isConstant(p)){let t=j.getValueOrDefault(p,e,Wdt,jdt);h.equals(t,l._lastOffset)||(l._lastOffset=h.clone(t,l._lastOffset),l.offset=Zi.toValue(t,l.offset))}}this.updateShows(r),this.waitingOnCreate=!1}else u(r)&&!r.ready&&(i=!1);return this.itemsToRemove.length=n,i},Zp.prototype.updateShows=function(e){let t=this.showsUpdated.values,i=t.length;for(let n=0;n<i;n++){let i=t[n],r=this.geometry.get(i.id),o=this.attributes.get(r.id.id);u(o)||(o=e.getGeometryInstanceAttributes(r.id),this.attributes.set(r.id.id,o));let a=i.entity.isShowing;a!==(1===o.show[0])&&(o.show=gn.toValue(a,o.show),r.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},Zp.prototype.contains=function(e){return this.updaters.contains(e.id)},Zp.prototype.getBoundingSphere=function(e,t){let i=this.primitive;if(!i.ready)return at.PENDING;let n=i.getGeometryInstanceAttributes(e.entity);return!u(n)||!u(n.boundingSphere)||u(n.show)&&0===n.show[0]?at.FAILED:(n.boundingSphere.clone(t),at.DONE)},Zp.prototype.removeAllPrimitives=function(){let e=this.primitives,t=this.primitive;u(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());let i=this.oldPrimitive;u(i)&&(e.remove(i),this.oldPrimitive=void 0)},yE.prototype.add=function(e,t){let i,n,r=t.createOutlineGeometryInstance(e),o=this._scene.clampLineWidth(t.outlineWidth);255===r.attributes.color.value[3]?(i=this._solidBatches,n=i.get(o),u(n)||(n=new Zp(this._primitives,!1,o,this._shadows),i.set(o,n)),n.add(t,r)):(i=this._translucentBatches,n=i.get(o),u(n)||(n=new Zp(this._primitives,!0,o,this._shadows),i.set(o,n)),n.add(t,r))},yE.prototype.remove=function(e){let t,i=this._solidBatches.values,n=i.length;for(t=0;t<n;t++)if(i[t].remove(e))return;let r=this._translucentBatches.values,o=r.length;for(t=0;t<o;t++)if(r[t].remove(e))return},yE.prototype.update=function(e){let t,i,n,r,o,a=this._solidBatches.values,s=a.length,l=this._translucentBatches.values,u=l.length,c=!0,h=!1;do{for(h=!1,i=0;i<s;i++){r=a[i],c=r.update(e),o=r.itemsToRemove;let s=o.length;if(s>0)for(h=!0,t=0;t<s;t++)n=o[t],r.remove(n),this.add(e,n)}for(i=0;i<u;i++){r=l[i],c=r.update(e),o=r.itemsToRemove;let a=o.length;if(a>0)for(h=!0,t=0;t<a;t++)n=o[t],r.remove(n),this.add(e,n)}}while(h);return c},yE.prototype.getBoundingSphere=function(e,t){let i,n=this._solidBatches.values,r=n.length;for(i=0;i<r;i++){let r=n[i];if(r.contains(e))return r.getBoundingSphere(e,t)}let o=this._translucentBatches.values,a=o.length;for(i=0;i<a;i++){let n=o[i];if(n.contains(e))return n.getBoundingSphere(e,t)}return at.FAILED},yE.prototype.removeAllPrimitives=function(){let e,t=this._solidBatches.values,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();let n=this._translucentBatches.values,r=n.length;for(e=0;e<r;e++)n[e].removeAllPrimitives()};var fI=yE,I_e=new z;function qdt(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function Vd(e,t){si.call(this,{entity:e,scene:t,geometryOptions:new qdt(e),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function xE(e,t,i){ri.call(this,e,t,i)}u(Object.create)&&(Vd.prototype=Object.create(si.prototype),Vd.prototype.constructor=Vd),Vd.prototype.createFillGeometryInstance=function(e){let t,i,n=this._entity,r=n.isAvailable(e),o=new gn(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),s=Vn.fromDistanceDisplayCondition(a);if(this._materialProperty instanceof Nt){let n;u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(n=this._materialProperty.color.getValue(e,I_e)),u(n)||(n=z.WHITE),i=kt.fromColor(n),t={show:o,distanceDisplayCondition:s,color:i}}else t={show:o,distanceDisplayCondition:s};return new yt({id:n,geometry:new BO(this._options),attributes:t})},Vd.prototype.createOutlineGeometryInstance=function(e){let t=this._entity,i=t.isAvailable(e),n=j.getValueOrDefault(this._outlineColorProperty,e,z.BLACK,I_e),r=this._distanceDisplayConditionProperty.getValue(e);return new yt({id:t,geometry:new kO(this._options),attributes:{show:new gn(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:kt.fromColor(n),distanceDisplayCondition:Vn.fromDistanceDisplayCondition(r)}})},Vd.prototype._isHidden=function(e,t){return!u(t.positions)||si.prototype._isHidden.call(this,e,t)},Vd.prototype._getIsClosed=function(e){return!1},Vd.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&j.isConstant(t.minimumHeights)&&j.isConstant(t.maximumHeights)&&j.isConstant(t.outlineWidth)&&j.isConstant(t.granularity))},Vd.prototype._setStaticOptions=function(e,t){let i=t.minimumHeights,n=t.maximumHeights,r=t.granularity,o=this._materialProperty instanceof Nt,a=this._options;a.vertexFormat=o?rn.VERTEX_FORMAT:ao.MaterialSupport.TEXTURED.vertexFormat,a.positions=t.positions.getValue(ze.MINIMUM_VALUE,a.positions),a.minimumHeights=u(i)?i.getValue(ze.MINIMUM_VALUE,a.minimumHeights):void 0,a.maximumHeights=u(n)?n.getValue(ze.MINIMUM_VALUE,a.maximumHeights):void 0,a.granularity=u(r)?r.getValue(ze.MINIMUM_VALUE):void 0},Vd.DynamicGeometryUpdater=xE,u(Object.create)&&(xE.prototype=Object.create(ri.prototype),xE.prototype.constructor=xE),xE.prototype._isHidden=function(e,t,i){return!u(this._options.positions)||ri.prototype._isHidden.call(this,e,t,i)},xE.prototype._setOptions=function(e,t,i){let n=this._options;n.positions=j.getValueOrUndefined(t.positions,i,n.positions),n.minimumHeights=j.getValueOrUndefined(t.minimumHeights,i,n.minimumHeights),n.maximumHeights=j.getValueOrUndefined(t.maximumHeights,i,n.maximumHeights),n.granularity=j.getValueOrUndefined(t.granularity,i)};var $U=Vd,Ydt=[],P_e=[wU,MU,PU,GU,WU,jU,qU,YU,XU,$U];function dI(e,t){this.entity=e,this.scene=t;let i=new Array(P_e.length),n=new pe;function r(e){n.raiseEvent(e)}let o=new Pr;for(let n=0;n<i.length;n++){let a=new P_e[n](e,t);o.add(a.geometryChanged,r),i[n]=a}this.updaters=i,this.geometryChanged=n,this.eventHelper=o,this._removeEntitySubscription=e.definitionChanged.addEventListener(dI.prototype._onEntityPropertyChanged,this)}function Sf(e,t,i,n){i=y(i,e.primitives),n=y(n,e.groundPrimitives),this._scene=e,this._primitives=i,this._groundPrimitives=n,this._entityCollection=void 0,this._addedObjects=new bt,this._removedObjects=new bt,this._changedObjects=new bt;let r=yn.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(2*r),this._closedColorBatches=new Array(2*r),this._closedMaterialBatches=new Array(2*r),this._openColorBatches=new Array(2*r),this._openMaterialBatches=new Array(2*r);let o,a=er.supportsMaterialsforEntitiesOnTerrain(e);for(this._supportsMaterialsforEntitiesOnTerrain=a,o=0;o<r;++o)this._outlineBatches[o]=new fI(i,e,o,!1),this._outlineBatches[r+o]=new fI(i,e,o,!0),this._closedColorBatches[o]=new Fd(i,rn,void 0,!0,o,!0),this._closedColorBatches[r+o]=new Fd(i,rn,void 0,!0,o,!1),this._closedMaterialBatches[o]=new kd(i,ao,void 0,!0,o,!0),this._closedMaterialBatches[r+o]=new kd(i,ao,void 0,!0,o,!1),this._openColorBatches[o]=new Fd(i,rn,void 0,!1,o,!0),this._openColorBatches[r+o]=new Fd(i,rn,void 0,!1,o,!1),this._openMaterialBatches[o]=new kd(i,ao,void 0,!1,o,!0),this._openMaterialBatches[r+o]=new kd(i,ao,void 0,!1,o,!1);let s=zn.NUMBER_OF_CLASSIFICATION_TYPES,l=new Array(s),u=[];if(a)for(o=0;o<s;++o)u.push(new ZU(n,o,ao)),l[o]=new uI(n,o);else for(o=0;o<s;++o)l[o]=new uI(n,o);this._groundColorBatches=l,this._groundMaterialBatches=u,this._dynamicBatch=new cE(i,n),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new bt,this._updaterSets=new bt,this._entityCollection=t,t.collectionChanged.addEventListener(Sf.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,Ydt)}dI.prototype._onEntityPropertyChanged=function(e,t,i,n){let r=this.updaters;for(let o=0;o<r.length;o++)r[o]._onEntityPropertyChanged(e,t,i,n)},dI.prototype.forEach=function(e){let t=this.updaters;for(let i=0;i<t.length;i++)e(t[i])},dI.prototype.destroy=function(){this.eventHelper.removeAll();let e=this.updaters;for(let t=0;t<e.length;t++)e[t].destroy();this._removeEntitySubscription(),le(this)},Sf.prototype.update=function(e){let t,i,n,r,o=this._addedObjects,a=o.values,s=this._removedObjects,l=s.values,u=this._changedObjects,c=u.values,h=this;for(t=c.length-1;t>-1;t--)i=c[t],n=i.id,r=this._updaterSets.get(n),r.entity===i?r.forEach((function(t){h._removeUpdater(t),h._insertUpdaterIntoBatch(e,t)})):(l.push(i),a.push(i));for(t=l.length-1;t>-1;t--)i=l[t],n=i.id,r=this._updaterSets.get(n),r.forEach(this._removeUpdater.bind(this)),r.destroy(),this._updaterSets.remove(n),this._subscriptions.get(n)(),this._subscriptions.remove(n);for(t=a.length-1;t>-1;t--)i=a[t],n=i.id,r=new dI(i,this._scene),this._updaterSets.set(n,r),r.forEach((function(t){h._insertUpdaterIntoBatch(e,t)})),this._subscriptions.set(n,r.geometryChanged.addEventListener(Sf._onGeometryChanged,this));o.removeAll(),s.removeAll(),u.removeAll();let d=!0,p=this._batches,f=p.length;for(t=0;t<f;t++)d=p[t].update(e)&&d;return d};var Xdt=[],Kdt=new se;Sf.prototype.getBoundingSphere=function(e,t){let i=Xdt,n=Kdt,r=0,o=at.DONE,a=this._batches,s=a.length,l=e.id,u=this._updaterSets.get(l).updaters;for(let e=0;e<u.length;e++){let t=u[e];for(let e=0;e<s;e++){if(o=a[e].getBoundingSphere(t,n),o===at.PENDING)return at.PENDING;o===at.DONE&&(i[r]=se.clone(n,i[r]),r++)}}return 0===r?at.FAILED:(i.length=r,se.fromBoundingSpheres(i,t),at.DONE)},Sf.prototype.isDestroyed=function(){return!1},Sf.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Sf.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();let e,t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();let n=this._subscriptions.values;for(i=n.length,e=0;e<i;e++)n[e]();this._subscriptions.removeAll();let r=this._updaterSets.values;for(i=r.length,e=0;e<i;e++)r[e].destroy();return this._updaterSets.removeAll(),le(this)},Sf.prototype._removeUpdater=function(e){let t=this._batches,i=t.length;for(let n=0;n<i;n++)t[n].remove(e)},Sf.prototype._insertUpdaterIntoBatch=function(e,t){if(t.isDynamic)return void this._dynamicBatch.add(e,t);let i;(t.outlineEnabled||t.fillEnabled)&&(i=t.shadowsProperty.getValue(e));let n=yn.NUMBER_OF_SHADOW_MODES;if(t.outlineEnabled&&(u(t.terrainOffsetProperty)?this._outlineBatches[n+i].add(e,t):this._outlineBatches[i].add(e,t)),t.fillEnabled)if(t.onTerrain){let i=t.classificationTypeProperty.getValue(e);t.fillMaterialProperty instanceof Nt?this._groundColorBatches[i].add(e,t):this._groundMaterialBatches[i].add(e,t)}else t.isClosed?t.fillMaterialProperty instanceof Nt?u(t.terrainOffsetProperty)?this._closedColorBatches[n+i].add(e,t):this._closedColorBatches[i].add(e,t):u(t.terrainOffsetProperty)?this._closedMaterialBatches[n+i].add(e,t):this._closedMaterialBatches[i].add(e,t):t.fillMaterialProperty instanceof Nt?u(t.terrainOffsetProperty)?this._openColorBatches[n+i].add(e,t):this._openColorBatches[i].add(e,t):u(t.terrainOffsetProperty)?this._openMaterialBatches[n+i].add(e,t):this._openMaterialBatches[i].add(e,t)},Sf._onGeometryChanged=function(e){let t=this._removedObjects,i=this._changedObjects,n=e.entity,r=n.id;!u(t.get(r))&&!u(i.get(r))&&i.set(r,n)},Sf.prototype._onCollectionChanged=function(e,t,i){let n,r,o,a=this._addedObjects,s=this._removedObjects,l=this._changedObjects;for(n=i.length-1;n>-1;n--)o=i[n],r=o.id,a.remove(r)||(s.set(r,o),l.remove(r));for(n=t.length-1;n>-1;n--)o=t[n],r=o.id,s.remove(r)?l.set(r,o):a.set(r,o)};var QU=Sf,Zdt=1,$dt="30px sans-serif",Qdt=zo.FILL,Jdt=z.WHITE,eht=z.BLACK,tht=1,nht=!1,iht=new z(.165,.165,.165,.8),oht=new U(7,5),rht=U.ZERO,sht=h.ZERO,aht=We.NONE,cht=yi.CENTER,lht=On.CENTER,uht=new h,fht=new z,dht=new z,hht=new z,mht=new U,pht=new h,_ht=new U,ght=new Pt,yht=new Pt,xht=new Pt,bht=new wt;function O_e(e){this.entity=e,this.label=void 0,this.index=void 0}function xy(e,t){t.collectionChanged.addEventListener(xy.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new bt,this._onCollectionChanged(t,t.values,[],[])}function iq(e,t,i){u(e)&&(e.label=void 0,i.removeLabel(t))}xy.prototype.update=function(e){let t=this._items.values,i=this._cluster;for(let n=0,r=t.length;n<r;n++){let r,o,a=t[n],s=a.entity,l=s._label,c=a.label,d=s.isShowing&&s.isAvailable(e)&&j.getValueOrDefault(l._show,e,!0);if(d&&(o=j.getValueOrUndefined(s._position,e,uht),r=j.getValueOrUndefined(l._text,e),d=u(o)&&u(r)),!d){iq(a,s,i);continue}j.isConstant(s._position)||(i._clusterDirty=!0);let p=!1,f=j.getValueOrDefault(l._heightReference,e,aht);u(c)||(c=i.getLabel(s),c.id=s,a.label=c,p=h.equals(c.position,o)&&c.heightReference===f),c.show=!0,c.position=o,c.text=r,c.scale=j.getValueOrDefault(l._scale,e,Zdt),c.font=j.getValueOrDefault(l._font,e,$dt),c.style=j.getValueOrDefault(l._style,e,Qdt),c.fillColor=j.getValueOrDefault(l._fillColor,e,Jdt,fht),c.outlineColor=j.getValueOrDefault(l._outlineColor,e,eht,dht),c.outlineWidth=j.getValueOrDefault(l._outlineWidth,e,tht),c.showBackground=j.getValueOrDefault(l._showBackground,e,nht),c.backgroundColor=j.getValueOrDefault(l._backgroundColor,e,iht,hht),c.backgroundPadding=j.getValueOrDefault(l._backgroundPadding,e,oht,mht),c.pixelOffset=j.getValueOrDefault(l._pixelOffset,e,rht,_ht),c.eyeOffset=j.getValueOrDefault(l._eyeOffset,e,sht,pht),c.heightReference=f,c.horizontalOrigin=j.getValueOrDefault(l._horizontalOrigin,e,cht),c.verticalOrigin=j.getValueOrDefault(l._verticalOrigin,e,lht),c.translucencyByDistance=j.getValueOrUndefined(l._translucencyByDistance,e,ght),c.pixelOffsetScaleByDistance=j.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,yht),c.scaleByDistance=j.getValueOrUndefined(l._scaleByDistance,e,xht),c.distanceDisplayCondition=j.getValueOrUndefined(l._distanceDisplayCondition,e,bht),c.disableDepthTestDistance=j.getValueOrUndefined(l._disableDepthTestDistance,e),p&&c._updateClamping()}return!0},xy.prototype.getBoundingSphere=function(e,t){let i=this._items.get(e.id);if(!u(i)||!u(i.label))return at.FAILED;let n=i.label;return t.center=h.clone(y(n._clampedPosition,n.position),t.center),t.radius=0,at.DONE},xy.prototype.isDestroyed=function(){return!1},xy.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(xy.prototype._onCollectionChanged,this);let e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return le(this)},xy.prototype._onCollectionChanged=function(e,t,i,n){let r,o,a=this._items,s=this._cluster;for(r=t.length-1;r>-1;r--)o=t[r],u(o._label)&&u(o._position)&&a.set(o.id,new O_e(o));for(r=n.length-1;r>-1;r--)o=n[r],u(o._label)&&u(o._position)?a.contains(o.id)||a.set(o.id,new O_e(o)):(iq(a.get(o.id),o,s),a.remove(o.id));for(r=i.length-1;r>-1;r--)o=i[r],iq(a.get(o.id),o,s),a.remove(o.id)};var JU=xy,Tht=1,Aht=0,Cht=!0,Eht=!0,Sht=yn.ENABLED,wht=We.NONE,vht=z.RED,Dht=0,Iht=z.WHITE,Pht=xc.HIGHLIGHT,Oht=.5,Rht=new U(1,1),Mht=new L,Lht=new L,R_e=new z,M_e=new Array(4),Nht=new h;function hm(e,t){t.collectionChanged.addEventListener(hm.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._modelHash={},this._entitiesToVisualize=new bt,this._onCollectionChanged(t,t.values,[],[])}async function Fht(e,t,i,n){let r=e._primitives,o=e._modelHash;try{let a=await Hh.fromGltfAsync({url:i,incrementallyLoadTextures:n,scene:e._scene});if(e.isDestroyed()||!u(o[t.id]))return;a.id=t,r.add(a),o[t.id].modelPrimitive=a,a.errorEvent.addEventListener((e=>{u(o[t.id])&&(console.log(e),"TextureError"!==e.name&&a.incrementallyLoadTextures&&(o[t.id].loadFailed=!0))}))}catch(i){if(e.isDestroyed()||!u(o[t.id]))return;console.log(i),o[t.id].loadFailed=!0}}hm.prototype.update=function(e){let t=this._entitiesToVisualize.values,i=this._modelHash,n=this._primitives;for(let r=0,o=t.length;r<o;r++){let o,a,s=t[r],l=s._model,c=i[s.id],d=s.isShowing&&s.isAvailable(e)&&j.getValueOrDefault(l._show,e,!0);if(d&&(a=s.computeModelMatrix(e,Mht),o=ve.createIfNeeded(j.getValueOrUndefined(l._uri,e)),d=u(a)&&u(o)),!d){u(c)&&c.modelPrimitive&&(c.modelPrimitive.show=!1);continue}if(!u(c)||o.url!==c.url){u(c?.modelPrimitive)&&(n.removeAndDestroy(c.modelPrimitive),delete i[s.id]),c={modelPrimitive:void 0,url:o.url,animationsRunning:!1,nodeTransformationsScratch:{},articulationsScratch:{},loadFailed:!1,modelUpdated:!1,awaitingSampleTerrain:!1,clampedBoundingSphere:void 0,sampleTerrainFailed:!1},i[s.id]=c,Fht(this,s,o,j.getValueOrDefault(l._incrementallyLoadTextures,e,Cht))}let p=c.modelPrimitive;if(!u(p))continue;p.show=!0,p.scale=j.getValueOrDefault(l._scale,e,Tht),p.minimumPixelSize=j.getValueOrDefault(l._minimumPixelSize,e,Aht),p.maximumScale=j.getValueOrUndefined(l._maximumScale,e),p.modelMatrix=L.clone(a,p.modelMatrix),p.shadows=j.getValueOrDefault(l._shadows,e,Sht),p.heightReference=j.getValueOrDefault(l._heightReference,e,wht),p.distanceDisplayCondition=j.getValueOrUndefined(l._distanceDisplayCondition,e),p.silhouetteColor=j.getValueOrDefault(l._silhouetteColor,e,vht,R_e),p.silhouetteSize=j.getValueOrDefault(l._silhouetteSize,e,Dht),p.color=j.getValueOrDefault(l._color,e,Iht,R_e),p.colorBlendMode=j.getValueOrDefault(l._colorBlendMode,e,Pht),p.colorBlendAmount=j.getValueOrDefault(l._colorBlendAmount,e,Oht),p.clippingPlanes=j.getValueOrUndefined(l._clippingPlanes,e),p.clampAnimations=j.getValueOrDefault(l._clampAnimations,e,Eht),p.imageBasedLighting.imageBasedLightingFactor=j.getValueOrDefault(l._imageBasedLightingFactor,e,Rht);let f=j.getValueOrUndefined(l._lightColor,e);if(u(f)&&(z.pack(f,M_e,0),f=h.unpack(M_e,0,Nht)),p.lightColor=f,p.customShader=j.getValueOrUndefined(l._customShader,e),i[s.id].modelUpdated=!0,p.ready){let t=j.getValueOrDefault(l._runAnimations,e,!0);c.animationsRunning!==t&&(t?p.activeAnimations.addAll({loop:jl.REPEAT}):p.activeAnimations.removeAll(),c.animationsRunning=t);let i=j.getValueOrUndefined(l._nodeTransformations,e,c.nodeTransformationsScratch);if(u(i)){let e=Object.keys(i);for(let t=0,n=e.length;t<n;++t){let n=e[t],r=i[n];if(!u(r))continue;let o=p.getNode(n);if(!u(o))continue;let a=L.fromTranslationRotationScale(r,Lht);o.matrix=L.multiply(o.originalMatrix,a,a)}}let n=!1,r=j.getValueOrUndefined(l._articulations,e,c.articulationsScratch);if(u(r)){let e=Object.keys(r);for(let t=0,i=e.length;t<i;++t){let i=e[t],o=r[i];u(o)&&(n=!0,p.setArticulationStage(i,o))}}n&&p.applyArticulations()}}return!0},hm.prototype.isDestroyed=function(){return!1},hm.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(hm.prototype._onCollectionChanged,this);let e=this._entitiesToVisualize.values,t=this._modelHash,i=this._primitives;for(let n=e.length-1;n>-1;n--)oq(this,e[n],t,i);return le(this)},hm._sampleTerrainMostDetailed=j_;var bE=new h,L_e=new fe;function oq(e,t,i,n){let r=i[t.id];u(r)&&(n.removeAndDestroy(r.modelPrimitive),delete i[t.id])}function Bht(e,t){let i=t[e.id];u(i)&&(i.nodeTransformationsScratch={},i.articulationsScratch={})}hm.prototype.getBoundingSphere=function(e,t){let i=this._modelHash[e.id];if(!u(i))return at.FAILED;if(i.loadFailed)return at.FAILED;let n=i.modelPrimitive;if(!u(n)||!n.show)return at.PENDING;if(!n.ready||!i.modelUpdated)return at.PENDING;let r=this._scene.globe,o=u(r)?r.terrainProvider:void 0,a=n.heightReference!==We.NONE;if(u(r)&&a){let i=r.ellipsoid,a=n.modelMatrix;bE.x=a[12],bE.y=a[13],bE.z=a[14];let s=i.cartesianToCartographic(bE);if(!u(o.availability)){n.heightReference===We.CLAMP_TO_GROUND&&(s.height=0);let e=i.cartographicToCartesian(s);return se.clone(n.boundingSphere,t),t.center=e,at.DONE}let l=this._modelHash[e.id].clampedBoundingSphere;return this._modelHash[e.id].sampleTerrainFailed?(this._modelHash[e.id].sampleTerrainFailed=!1,at.FAILED):u(l)?(se.clone(l,t),this._modelHash[e.id].clampedBoundingSphere=void 0,at.DONE):(l=new se,this._modelHash[e.id].awaitingSampleTerrain||(fe.clone(s,L_e),this._modelHash[e.id].awaitingSampleTerrain=!0,hm._sampleTerrainMostDetailed(o,[L_e]).then((t=>{if(this.isDestroyed())return;this._modelHash[e.id].awaitingSampleTerrain=!1;let r=t[0];n.heightReference===We.RELATIVE_TO_GROUND&&(r.height+=s.height),i.cartographicToCartesian(r,bE),se.clone(n.boundingSphere,l),l.center=bE,this._modelHash[e.id].clampedBoundingSphere=se.clone(l)})).catch((t=>{this.isDestroyed()||(this._modelHash[e.id].sampleTerrainFailed=!0,this._modelHash[e.id].awaitingSampleTerrain=!1)}))),at.PENDING)}return se.clone(n.boundingSphere,t),at.DONE},hm.prototype._onCollectionChanged=function(e,t,i,n){let r,o,a=this._entitiesToVisualize,s=this._modelHash,l=this._primitives;for(r=t.length-1;r>-1;r--)o=t[r],u(o._model)&&u(o._position)&&a.set(o.id,o);for(r=n.length-1;r>-1;r--)o=n[r],u(o._model)&&u(o._position)?(Bht(o,s),a.set(o.id,o)):(oq(this,o,s,l),a.remove(o.id));for(r=i.length-1;r>-1;r--)o=i[r],oq(this,o,s,l),a.remove(o.id)};var ez=hm;function by(e){this._definitionChanged=new pe,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}Object.defineProperties(by.prototype,{isConstant:{get:function(){return j.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return u(this._value)?this._value.referenceFrame:to.FIXED}}}),by.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,to.FIXED,t)},by.prototype.setValue=function(e){this._value!==e&&(this._value=e,u(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),u(e)&&(this._removeSubscription=e.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},by.prototype.getValueInReferenceFrame=function(e,t,i){if(u(this._value))return i=this._value.getValueInReferenceFrame(e,t,i),u(i)?ie.WGS84.scaleToGeodeticSurface(i,i):void 0},by.prototype.equals=function(e){return this===e||e instanceof by&&this._value===e._value},by.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var $p=by,kht=60,Vht=1,B_e=new Cn,rq=new Cn,sq=new Cn;function N_e(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function Uht(e,t,i,n,r,o,a,s,l){let c,h=s;c=e.getValueInReferenceFrame(t,o,l[h]),u(c)&&(l[h++]=c);let d,p,f,m=!u(r)||J.lessThanOrEquals(r,t)||J.greaterThanOrEquals(r,i),_=0,g=n.length,y=n[_],v=i,b=!1;for(;_<g;){if(!m&&J.greaterThanOrEquals(y,r)&&(c=e.getValueInReferenceFrame(r,o,l[h]),u(c)&&(l[h++]=c),m=!0),J.greaterThan(y,t)&&J.lessThan(y,v)&&!y.equals(r)&&(c=e.getValueInReferenceFrame(y,o,l[h]),u(c)&&(l[h++]=c)),_<g-1){if(a>0&&!b){let e=n[_+1],t=J.secondsDifference(e,y);b=t>a,b&&(d=Math.ceil(t/a),p=0,f=t/Math.max(d,2),d=Math.max(d-1,1))}if(b&&p<d){y=J.addSeconds(y,f,new J),p++;continue}}b=!1,_++,y=n[_]}return c=e.getValueInReferenceFrame(i,o,l[h]),u(c)&&(l[h++]=c),h}function zht(e,t,i,n,r,o,a,s){let l,c=0,h=a,d=t,p=Math.max(o,60),f=!u(n)||J.lessThanOrEquals(n,t)||J.greaterThanOrEquals(n,i);for(;J.lessThan(d,i);)!f&&J.greaterThanOrEquals(d,n)&&(f=!0,l=e.getValueInReferenceFrame(n,r,s[h]),u(l)&&(s[h]=l,h++)),l=e.getValueInReferenceFrame(d,r,s[h]),u(l)&&(s[h]=l,h++),c++,d=J.addSeconds(t,p*c,new J);return l=e.getValueInReferenceFrame(i,r,s[h]),u(l)&&(s[h]=l,h++),h}function Hht(e,t,i,n,r,o,a,s){sq.start=t,sq.stop=i;let l=a,c=e.intervals;for(let t=0;t<c.length;t++){let i=c.get(t);if(!Cn.intersect(i,sq,B_e).isEmpty){let t=i.start;i.isStartIncluded||(t=i.isStopIncluded?i.stop:J.addSeconds(i.start,J.secondsDifference(i.stop,i.start)/2,new J));let n=e.getValueInReferenceFrame(t,r,s[l]);u(n)&&(s[l]=n,l++)}}return l}function Ght(e,t,i,n,r,o,a,s){let l=e.getValueInReferenceFrame(t,r,s[a]);return u(l)&&(s[a++]=l),a}function Wht(e,t,i,n,r,o,a,s){rq.start=t,rq.stop=i;let l=a,u=e.intervals;for(let e=0;e<u.length;e++){let a=u.get(e);if(!Cn.intersect(a,rq,B_e).isEmpty){let e=a.start,u=a.stop,c=t;J.greaterThan(e,c)&&(c=e);let h=i;J.lessThan(u,h)&&(h=u),l=k_e(a.data,c,h,n,r,o,l,s)}}return l}function k_e(e,t,i,n,r,o,a,s){for(;e instanceof my;)e=e.resolvedProperty;if(e instanceof pa){a=Uht(e,t,i,e._property._times,n,r,o,a,s)}else a=e instanceof ma?Wht(e,t,i,n,r,o,a,s):e instanceof _y?Hht(e,t,i,n,r,o,a,s):e instanceof gl||e instanceof $p&&j.isConstant(e)?Ght(e,t,i,n,r,o,a,s):zht(e,t,i,n,r,o,a,s);return a}function V_e(e,t,i,n,r,o,a){u(a)||(a=[]);let s=k_e(e,t,i,n,r,o,0,a);return a.length=s,a}var F_e=new $;function hI(e,t){this._unusedIndexes=[],this._polylineCollection=new jh,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function Ty(e,t){t.collectionChanged.addEventListener(Ty.prototype._onCollectionChanged,this),this._scene=e,this._updaters={},this._entityCollection=t,this._items=new bt,this._onCollectionChanged(t,t.values,[],[])}hI.prototype.update=function(e){if(this._referenceFrame===to.INERTIAL){let t=Rt.computeIcrfToFixedMatrix(e,F_e);u(t)||(t=Rt.computeTemeToPseudoFixedMatrix(e,F_e)),L.fromRotationTranslation(t,h.ZERO,this._polylineCollection.modelMatrix)}},hI.prototype.updateObject=function(e,t){let i,n,r=t.entity,o=r._path,a=r._position,s=o._show,l=t.polyline,c=r.isShowing&&r.isAvailable(e)&&(!u(s)||s.getValue(e));if(c){let t=j.getValueOrUndefined(o._leadTime,e),a=j.getValueOrUndefined(o._trailTime,e),s=r._availability,l=u(s),h=u(t),d=u(a);if(c=l||h&&d,c){if(d&&(i=J.addSeconds(e,-a,new J)),h&&(n=J.addSeconds(e,t,new J)),l){let e=s.start,t=s.stop;(!d||J.greaterThan(e,i))&&(i=e),(!h||J.lessThan(t,n))&&(n=t)}c=J.lessThan(i,n)}}if(!c)return void(u(l)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,l.show=!1,t.index=void 0));if(!u(l)){let e=this._unusedIndexes;if(e.length>0){let i=e.pop();l=this._polylineCollection.get(i),t.index=i}else t.index=this._polylineCollection.length,l=this._polylineCollection.add();l.id=r,t.polyline=l}let h=j.getValueOrDefault(o._resolution,e,kht);l.show=!0,l.positions=V_e(a,i,n,e,this._referenceFrame,h,l.positions.slice()),l.material=Jo.getValue(e,o._material,l.material),l.width=j.getValueOrDefault(o._width,e,Vht),l.distanceDisplayCondition=j.getValueOrUndefined(o._distanceDisplayCondition,e,l.distanceDisplayCondition)},hI.prototype.removeObject=function(e){let t=e.polyline;u(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},hI.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),le(this)},Ty.prototype.update=function(e){let t=this._updaters;for(let i in t)t.hasOwnProperty(i)&&t[i].update(e);let i=this._items.values;if(0===i.length&&u(this._updaters)&&Object.keys(this._updaters).length>0){for(let e in t)t.hasOwnProperty(e)&&t[e].destroy();this._updaters={}}for(let t=0,n=i.length;t<n;t++){let n=i[t],r=n.entity._position,o=n.updater,a=to.FIXED;this._scene.mode===te.SCENE3D&&(a=r.referenceFrame);let s=this._updaters[a];o===s&&u(s)?s.updateObject(e,n):(u(o)&&o.removeObject(n),u(s)||(s=new hI(this._scene,a),s.update(e),this._updaters[a]=s),n.updater=s,u(s)&&s.updateObject(e,n))}return!0},Ty.prototype.isDestroyed=function(){return!1},Ty.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Ty.prototype._onCollectionChanged,this);let e=this._updaters;for(let t in e)e.hasOwnProperty(t)&&e[t].destroy();return le(this)},Ty.prototype._onCollectionChanged=function(e,t,i,n){let r,o,a,s=this._items;for(r=t.length-1;r>-1;r--)o=t[r],u(o._path)&&u(o._position)&&s.set(o.id,new N_e(o));for(r=n.length-1;r>-1;r--)o=n[r],u(o._path)&&u(o._position)?s.contains(o.id)||s.set(o.id,new N_e(o)):(a=s.get(o.id),u(a)&&(u(a.updater)&&a.updater.removeObject(a),s.remove(o.id)));for(r=i.length-1;r>-1;r--)o=i[r],a=s.get(o.id),u(a)&&(u(a.updater)&&a.updater.removeObject(a),s.remove(o.id))},Ty._subSample=V_e;var tz=Ty,U_e=z.WHITE,z_e=z.BLACK,H_e=0,G_e=1,W_e=0,j_e=new z,jht=new h,q_e=new z,Y_e=new Pt,X_e=new Pt,K_e=new wt;function Z_e(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function Ay(e,t){t.collectionChanged.addEventListener(Ay.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new bt,this._onCollectionChanged(t,t.values,[],[])}function mI(e,t,i){if(u(e)){let n=e.pointPrimitive;if(u(n))return e.pointPrimitive=void 0,void i.removePoint(t);let r=e.billboard;u(r)&&(e.billboard=void 0,i.removeBillboard(t))}}Ay.prototype.update=function(e){let t=this._items.values,i=this._cluster;for(let n=0,r=t.length;n<r;n++){let r,o=t[n],a=o.entity,s=a._point,l=o.pointPrimitive,c=o.billboard,d=j.getValueOrDefault(s._heightReference,e,We.NONE),p=a.isShowing&&a.isAvailable(e)&&j.getValueOrDefault(s._show,e,!0);if(p&&(r=j.getValueOrUndefined(a._position,e,jht),p=u(r)),!p){mI(o,a,i);continue}j.isConstant(a._position)||(i._clusterDirty=!0);let f=!1,m=!1;if(d===We.NONE||u(c)?d===We.NONE&&!u(l)&&(u(c)&&(mI(o,a,i),c=void 0),l=i.getPoint(a),l.id=a,o.pointPrimitive=l):(u(l)&&(mI(o,a,i),l=void 0),c=i.getBillboard(a),c.id=a,c.image=void 0,o.billboard=c,f=!0,m=h.equals(c.position,r)&&c.heightReference===d),u(l))l.show=!0,l.position=r,l.scaleByDistance=j.getValueOrUndefined(s._scaleByDistance,e,Y_e),l.translucencyByDistance=j.getValueOrUndefined(s._translucencyByDistance,e,X_e),l.color=j.getValueOrDefault(s._color,e,U_e,j_e),l.outlineColor=j.getValueOrDefault(s._outlineColor,e,z_e,q_e),l.outlineWidth=j.getValueOrDefault(s._outlineWidth,e,H_e),l.pixelSize=j.getValueOrDefault(s._pixelSize,e,G_e),l.distanceDisplayCondition=j.getValueOrUndefined(s._distanceDisplayCondition,e,K_e),l.disableDepthTestDistance=j.getValueOrDefault(s._disableDepthTestDistance,e,W_e);else if(u(c)){c.show=!0,c.position=r,c.scaleByDistance=j.getValueOrUndefined(s._scaleByDistance,e,Y_e),c.translucencyByDistance=j.getValueOrUndefined(s._translucencyByDistance,e,X_e),c.distanceDisplayCondition=j.getValueOrUndefined(s._distanceDisplayCondition,e,K_e),c.disableDepthTestDistance=j.getValueOrDefault(s._disableDepthTestDistance,e,W_e),c.heightReference=d;let t=j.getValueOrDefault(s._color,e,U_e,j_e),i=j.getValueOrDefault(s._outlineColor,e,z_e,q_e),n=Math.round(j.getValueOrDefault(s._outlineWidth,e,H_e)),a=Math.max(1,Math.round(j.getValueOrDefault(s._pixelSize,e,G_e)));if(n>0?(c.scale=1,f=f||n!==o.outlineWidth||a!==o.pixelSize||!z.equals(t,o.color)||!z.equals(i,o.outlineColor)):(c.scale=a/50,a=50,f=f||n!==o.outlineWidth||!z.equals(t,o.color)||!z.equals(i,o.outlineColor)),f){o.color=z.clone(t,o.color),o.outlineColor=z.clone(i,o.outlineColor),o.pixelSize=a,o.outlineWidth=n;let e=t.alpha,r=t.toCssColorString(),s=i.toCssColorString(),l=JSON.stringify([r,a,s,n]);c.setImage(l,OA(e,r,s,n,a))}m&&c._updateClamping()}}return!0},Ay.prototype.getBoundingSphere=function(e,t){let i=this._items.get(e.id);if(!u(i)||!u(i.pointPrimitive)&&!u(i.billboard))return at.FAILED;if(u(i.pointPrimitive))t.center=h.clone(i.pointPrimitive.position,t.center);else{let e=i.billboard;if(!u(e._clampedPosition))return at.PENDING;t.center=h.clone(e._clampedPosition,t.center)}return t.radius=0,at.DONE},Ay.prototype.isDestroyed=function(){return!1},Ay.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(Ay.prototype._onCollectionChanged,this);let e=this._entityCollection.values;for(let t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return le(this)},Ay.prototype._onCollectionChanged=function(e,t,i,n){let r,o,a=this._items,s=this._cluster;for(r=t.length-1;r>-1;r--)o=t[r],u(o._point)&&u(o._position)&&a.set(o.id,new Z_e(o));for(r=n.length-1;r>-1;r--)o=n[r],u(o._point)&&u(o._position)?a.contains(o.id)||a.set(o.id,new Z_e(o)):(mI(a.get(o.id),o,s),a.remove(o.id));for(r=i.length-1;r>-1;r--)o=i[r],mI(a.get(o.id),o,s),a.remove(o.id)};var nz=Ay,qht=new Zn(0),iz={},$_e=new z,Yht=new Nt(z.WHITE),Xht=new Zn(!0),Kht=new Zn(yn.DISABLED),Zht=new Zn(new wt),$ht=new Zn(zn.BOTH);function Qht(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function Jht(){this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function Ud(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(Ud.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new pe,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new Qht,this._groundGeometryOptions=new Jht,this._id=`polyline-${e.id}`,this._clampToGround=!1,this._supportsPolylinesOnTerrain=er.supportsPolylinesOnTerrain(t),this._zIndex=0,this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}Object.defineProperties(Ud.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!u(this._entity.availability)&&j.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},arcType:{get:function(){return this._arcType}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}}),Ud.prototype.isOutlineVisible=function(e){return!1},Ud.prototype.isFilled=function(e){let t=this._entity,i=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e);return y(i,!1)},Ud.prototype.createFillGeometryInstance=function(e){let t,i=this._entity,n=i.isAvailable(e),r=new gn(n&&i.isShowing&&this._showProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),a={show:r,distanceDisplayCondition:Vn.fromDistanceDisplayCondition(o)};return this._materialProperty instanceof Nt&&(u(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,$_e)),u(t)||(t=z.WHITE),a.color=kt.fromColor(t)),this.clampToGround?new yt({id:i,geometry:new AT(this._groundGeometryOptions),attributes:a}):(u(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof Nt&&(u(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||n)&&(t=this._depthFailMaterialProperty.color.getValue(e,$_e)),u(t)||(t=z.WHITE),a.depthFailColor=kt.fromColor(t)),new yt({id:i,geometry:new V_(this._geometryOptions),attributes:a}))},Ud.prototype.createOutlineGeometryInstance=function(e){},Ud.prototype.isDestroyed=function(){return!1},Ud.prototype.destroy=function(){this._entitySubscription(),le(this)},Ud.prototype._onEntityPropertyChanged=function(e,t,i,n){if("availability"!==t&&"polyline"!==t)return;let r=this._entity.polyline;if(!u(r))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));let o=r.positions,a=r.show;if(u(a)&&a.isConstant&&!a.getValue(ze.MINIMUM_VALUE)||!u(o))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));let s=r.zIndex,l=y(r.material,Yht),c=l instanceof Nt;this._materialProperty=l,this._depthFailMaterialProperty=r.depthFailMaterial,this._showProperty=y(a,Xht),this._shadowsProperty=y(r.shadows,Kht),this._distanceDisplayConditionProperty=y(r.distanceDisplayCondition,Zht),this._classificationTypeProperty=y(r.classificationType,$ht),this._fillEnabled=!0,this._zIndex=y(s,qht);let h=r.width,d=r.arcType,p=r.clampToGround,f=r.granularity;if(o.isConstant&&j.isConstant(h)&&j.isConstant(d)&&j.isConstant(f)&&j.isConstant(p)&&j.isConstant(s)){let e,t=this._geometryOptions,i=o.getValue(ze.MINIMUM_VALUE,t.positions);if(!u(i)||i.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));e=c&&(!u(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof Nt)?qr.VERTEX_FORMAT:fa.VERTEX_FORMAT,t.vertexFormat=e,t.positions=i,t.width=u(h)?h.getValue(ze.MINIMUM_VALUE):void 0,t.arcType=u(d)?d.getValue(ze.MINIMUM_VALUE):void 0,t.granularity=u(f)?f.getValue(ze.MINIMUM_VALUE):void 0;let n=this._groundGeometryOptions;n.positions=i,n.width=t.width,n.arcType=t.arcType,n.granularity=t.granularity,this._clampToGround=!!u(p)&&p.getValue(ze.MINIMUM_VALUE),!this._clampToGround&&u(s)&&It("Entity polylines must have clampToGround: true when using zIndex.  zIndex will be ignored."),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))},Ud.prototype.createDynamicUpdater=function(e,t){return new pI(e,t,this)};var TE={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function pI(e,t,i){this._line=void 0,this._primitives=e,this._groundPrimitives=t,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=i,this._positions=[]}function Q_e(e){if(u(e._line))return e._line;let t=e._geometryUpdater._scene.id,i=iz[t],n=e._primitives;!u(i)||i.isDestroyed()?(i=new jh,iz[t]=i,n.add(i)):n.contains(i)||n.add(i);let r=i.add();return r.id=e._geometryUpdater._entity,e._line=r,r}pI.prototype.update=function(e){let t=this._geometryUpdater,i=t._entity,n=i.polyline,r=n.positions,o=j.getValueOrUndefined(r,e,this._positions);t._clampToGround=j.getValueOrDefault(n._clampToGround,e,!1),t._groundGeometryOptions.positions=o,t._groundGeometryOptions.width=j.getValueOrDefault(n._width,e,1),t._groundGeometryOptions.arcType=j.getValueOrDefault(n._arcType,e,Yt.GEODESIC),t._groundGeometryOptions.granularity=j.getValueOrDefault(n._granularity,e,9999);let a=this._groundPrimitives;if(u(this._groundPolylinePrimitive)&&(a.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),t.clampToGround){if(!i.isShowing||!i.isAvailable(e)||!j.getValueOrDefault(n._show,e,!0)||!u(o)||o.length<2)return;let r,s=t.fillMaterialProperty;if(s instanceof Nt)r=new qr;else{let t=Jo.getValue(e,s,this._material);r=new fa({material:t,translucent:t.isTranslucent()}),this._material=t}return this._groundPolylinePrimitive=a.add(new $h({geometryInstances:t.createFillGeometryInstance(e),appearance:r,classificationType:t.classificationTypeProperty.getValue(e),asynchronous:!1}),j.getValueOrUndefined(t.zIndex,e)),void(u(this._line)&&(this._line.show=!1))}let s=Q_e(this);if(!i.isShowing||!i.isAvailable(e)||!j.getValueOrDefault(n._show,e,!0))return void(s.show=!1);if(!u(o)||o.length<2)return void(s.show=!1);let l=Yt.GEODESIC;l=j.getValueOrDefault(n._arcType,e,l);let c=t._scene.globe;l!==Yt.NONE&&u(c)&&(TE.ellipsoid=c.ellipsoid,TE.positions=o,TE.granularity=j.getValueOrUndefined(n._granularity,e),TE.height=Mi.extractHeights(o,c.ellipsoid),o=l===Yt.GEODESIC?Mi.generateCartesianArc(TE):Mi.generateCartesianRhumbArc(TE)),s.show=!0,s.positions=o.slice(),s.material=Jo.getValue(e,t.fillMaterialProperty,s.material),s.width=j.getValueOrDefault(n._width,e,1),s.distanceDisplayCondition=j.getValueOrUndefined(n._distanceDisplayCondition,e,s.distanceDisplayCondition)},pI.prototype.getBoundingSphere=function(e){if(this._geometryUpdater.clampToGround){let t=this._groundPolylinePrimitive;if(u(t)&&t.show&&t.ready){let i=t.getGeometryInstanceAttributes(this._geometryUpdater._entity);if(u(i)&&u(i.boundingSphere))return se.clone(i.boundingSphere,e),at.DONE}return u(t)&&!t.ready?at.PENDING:at.DONE}{let t=Q_e(this);if(t.show&&t.positions.length>0)return se.fromPoints(t.positions,e),at.DONE}return at.FAILED},pI.prototype.isDestroyed=function(){return!1},pI.prototype.destroy=function(){let e=this._geometryUpdater._scene.id,t=iz[e];u(t)&&(t.remove(this._line),0===t.length&&(this._primitives.removeAndDestroy(t),delete iz[e])),u(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),le(this)};var oz=Ud,emt=new z,tmt=new wt,nmt=new wt;function zd(e,t,i,n,r){let o;o=i instanceof Nt?qr:fa,this.orderedGroundPrimitives=e,this.classificationType=t,this.appearanceType=o,this.materialProperty=i,this.updaters=new bt,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new bt,this.material=void 0,this.updatersWithAttributes=new bt,this.attributes=new bt,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(zd.prototype.onMaterialChanged,this),this.subscriptions=new bt,this.showsUpdated=new bt,this.zIndex=n,this._asynchronous=r}function AE(e,t,i){this._items=[],this._orderedGroundPrimitives=e,this._classificationType=t,this._asynchronous=y(i,!0)}zd.prototype.onMaterialChanged=function(){this.invalidated=!0},zd.prototype.isMaterial=function(e){let t=this.materialProperty,i=e.fillMaterialProperty;return i===t||i instanceof Nt&&t instanceof Nt||u(t)&&t.equals(i)},zd.prototype.add=function(e,t,i){let n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,i),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&j.isConstant(t.distanceDisplayConditionProperty)){let e=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener((function(i,n,r,o){"isShowing"===n&&e.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},zd.prototype.remove=function(e){let t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);let e=this.subscriptions.get(t);return u(e)&&(e(),this.subscriptions.remove(t)),!0}return!1},zd.prototype.update=function(e){let t,i=!0,n=this.primitive,r=this.orderedGroundPrimitives,o=this.geometry.values;if(this.createPrimitive){if(o.length>0)u(n)&&(u(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),n=new $h({show:!1,asynchronous:this._asynchronous,geometryInstances:o.slice(),appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===fa&&(this.material=Jo.getValue(e,this.materialProperty,this.material),n.appearance.material=this.material),r.add(n,this.zIndex),i=!1;else{u(n)&&(r.remove(n),n=void 0);let e=this.oldPrimitive;u(e)&&(r.remove(e),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(u(n)&&n.ready){n.show=!0,u(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===fa&&(this.material=Jo.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material);let i=this.updatersWithAttributes.values,o=i.length;for(t=0;t<o;t++){let r=i[t],o=r.entity,a=this.geometry.get(r.id),s=this.attributes.get(a.id.id);if(u(s)||(s=n.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,s)),!r.fillMaterialProperty.isConstant){let t=r.fillMaterialProperty.color,i=j.getValueOrDefault(t,e,z.WHITE,emt);z.equals(s._lastColor,i)||(s._lastColor=z.clone(i,s._lastColor),s.color=kt.toValue(i,s.color))}let l=o.isShowing&&(r.hasConstantFill||r.isFilled(e));l!==(1===s.show[0])&&(s.show=gn.toValue(l,s.show));let c=r.distanceDisplayConditionProperty;if(!j.isConstant(c)){let t=j.getValueOrDefault(c,e,nmt,tmt);wt.equals(t,s._lastDistanceDisplayCondition)||(s._lastDistanceDisplayCondition=wt.clone(t,s._lastDistanceDisplayCondition),s.distanceDisplayCondition=Vn.toValue(t,s.distanceDisplayCondition))}}this.updateShows(n)}else u(n)&&!n.ready&&(i=!1);return i},zd.prototype.updateShows=function(e){let t=this.showsUpdated.values,i=t.length;for(let n=0;n<i;n++){let i=t[n],r=i.entity,o=this.geometry.get(i.id),a=this.attributes.get(o.id.id);u(a)||(a=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,a));let s=r.isShowing;s!==(1===a.show[0])&&(a.show=gn.toValue(s,a.show),o.attributes.show.value[0]=a.show[0])}this.showsUpdated.removeAll()},zd.prototype.contains=function(e){return this.updaters.contains(e.id)},zd.prototype.getBoundingSphere=function(e,t){let i=this.primitive;if(!i.ready)return at.PENDING;let n=i.getGeometryInstanceAttributes(e.entity);return!u(n)||!u(n.boundingSphere)||u(n.show)&&0===n.show[0]?at.FAILED:(n.boundingSphere.clone(t),at.DONE)},zd.prototype.destroy=function(){let e=this.primitive,t=this.orderedGroundPrimitives;u(e)&&t.remove(e);let i=this.oldPrimitive;u(i)&&t.remove(i),this.removeMaterialSubscription()},AE.prototype.add=function(e,t){let i=this._items,n=i.length,r=t.createFillGeometryInstance(e),o=j.getValueOrDefault(t.zIndex,0);for(let a=0;a<n;++a){let n=i[a];if(n.isMaterial(t)&&n.zIndex===o)return void n.add(e,t,r)}let a=new zd(this._orderedGroundPrimitives,this._classificationType,t.fillMaterialProperty,o,this._asynchronous);a.add(e,t,r),i.push(a)},AE.prototype.remove=function(e){let t=this._items;for(let i=t.length-1;i>=0;i--){let n=t[i];if(n.remove(e)){0===n.updaters.length&&(t.splice(i,1),n.destroy());break}}},AE.prototype.update=function(e){let t,i=this._items;for(t=i.length-1;t>=0;t--){let n=i[t];if(n.invalidated){i.splice(t,1);let r=n.updaters.values,o=r.length;for(let t=0;t<o;t++)this.add(e,r[t]);n.destroy()}}let n=!0;for(t=0;t<i.length;t++)n=i[t].update(e)&&n;return n},AE.prototype.getBoundingSphere=function(e,t){let i=this._items,n=i.length;for(let r=0;r<n;r++){let n=i[r];if(n.contains(e))return n.getBoundingSphere(e,t)}return at.FAILED},AE.prototype.removeAllPrimitives=function(){let e=this._items,t=e.length;for(let i=0;i<t;i++)e[i].destroy();this._items.length=0};var rz=AE,imt=[];function J_e(e,t){let i=e._batches,n=i.length;for(let e=0;e<n;e++)i[e].remove(t)}function ege(e,t,i){if(i.isDynamic)return void e._dynamicBatch.add(t,i);if(i.clampToGround&&i.fillEnabled){let n=i.classificationTypeProperty.getValue(t);return void e._groundBatches[n].add(t,i)}let n;i.fillEnabled&&(n=i.shadowsProperty.getValue(t));let r,o=0;u(i.depthFailMaterialProperty)&&(o=i.depthFailMaterialProperty instanceof Nt?1:2),u(n)&&(r=n+o*yn.NUMBER_OF_SHADOW_MODES),i.fillEnabled&&(i.fillMaterialProperty instanceof Nt?e._colorBatches[r].add(t,i):e._materialBatches[r].add(t,i))}function mm(e,t,i,n){n=y(n,e.groundPrimitives),i=y(i,e.primitives),this._scene=e,this._primitives=i,this._entityCollection=void 0,this._addedObjects=new bt,this._removedObjects=new bt,this._changedObjects=new bt;let r,o=yn.NUMBER_OF_SHADOW_MODES;for(this._colorBatches=new Array(3*o),this._materialBatches=new Array(3*o),r=0;r<o;++r)this._colorBatches[r]=new Fd(i,qr,void 0,!1,r),this._materialBatches[r]=new kd(i,fa,void 0,!1,r),this._colorBatches[r+o]=new Fd(i,qr,qr,!1,r),this._materialBatches[r+o]=new kd(i,fa,qr,!1,r),this._colorBatches[r+2*o]=new Fd(i,qr,fa,!1,r),this._materialBatches[r+2*o]=new kd(i,fa,fa,!1,r);this._dynamicBatch=new cE(i,n);let a=zn.NUMBER_OF_CLASSIFICATION_TYPES;for(this._groundBatches=new Array(a),r=0;r<a;++r)this._groundBatches[r]=new rz(n,r);this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatches),this._subscriptions=new bt,this._updaters=new bt,this._entityCollection=t,t.collectionChanged.addEventListener(mm.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,imt)}mm.prototype.update=function(e){let t,i,n,r,o=this._addedObjects,a=o.values,s=this._removedObjects,l=s.values,u=this._changedObjects,c=u.values;for(t=c.length-1;t>-1;t--)i=c[t],n=i.id,r=this._updaters.get(n),r.entity===i?(J_e(this,r),ege(this,e,r)):(l.push(i),a.push(i));for(t=l.length-1;t>-1;t--)i=l[t],n=i.id,r=this._updaters.get(n),J_e(this,r),r.destroy(),this._updaters.remove(n),this._subscriptions.get(n)(),this._subscriptions.remove(n);for(t=a.length-1;t>-1;t--)i=a[t],n=i.id,r=new oz(i,this._scene),this._updaters.set(n,r),ege(this,e,r),this._subscriptions.set(n,r.geometryChanged.addEventListener(mm._onGeometryChanged,this));o.removeAll(),s.removeAll(),u.removeAll();let h=!0,d=this._batches,p=d.length;for(t=0;t<p;t++)h=d[t].update(e)&&h;return h};var omt=[],rmt=new se;mm.prototype.getBoundingSphere=function(e,t){let i=omt,n=rmt,r=0,o=at.DONE,a=this._batches,s=a.length,l=this._updaters.get(e.id);for(let e=0;e<s;e++){if(o=a[e].getBoundingSphere(l,n),o===at.PENDING)return at.PENDING;o===at.DONE&&(i[r]=se.clone(n,i[r]),r++)}return 0===r?at.FAILED:(i.length=r,se.fromBoundingSpheres(i,t),at.DONE)},mm.prototype.isDestroyed=function(){return!1},mm.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(mm.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();let e,t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();let n=this._subscriptions.values;for(i=n.length,e=0;e<i;e++)n[e]();return this._subscriptions.removeAll(),le(this)},mm._onGeometryChanged=function(e){let t=this._removedObjects,i=this._changedObjects,n=e.entity,r=n.id;!u(t.get(r))&&!u(i.get(r))&&i.set(r,n)},mm.prototype._onCollectionChanged=function(e,t,i){let n,r,o,a=this._addedObjects,s=this._removedObjects,l=this._changedObjects;for(n=i.length-1;n>-1;n--)o=i[n],r=o.id,a.remove(r)||(s.set(r,o),l.remove(r));for(n=t.length-1;n>-1;n--)o=t[n],r=o.id,s.remove(r)?l.set(r,o):a.set(r,o)};var sz=mm;function wf(e){pl.initializeTerrainHeights(),$h.initializeTerrainHeights();let t=e.scene,i=e.dataSourceCollection;this._eventHelper=new Pr,this._eventHelper.add(i.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(i.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(i.dataSourceMoved,this._onDataSourceMoved,this),this._eventHelper.add(t.postRender,this._postRender,this),this._dataSourceCollection=i,this._scene=t,this._visualizersCallback=y(e.visualizersCallback,wf.defaultVisualizersCallback);let n=!1,r=new tu,o=new tu;i.length>0&&(t.primitives.add(r),t.groundPrimitives.add(o),n=!0),this._primitives=r,this._groundPrimitives=o;for(let e=0,t=i.length;e<t;e++)this._onDataSourceAdded(i,i.get(e));let a,s,l=new RU;if(this._onDataSourceAdded(void 0,l),this._defaultDataSource=l,!n){let e=this,n=function(){t.primitives.add(r),t.groundPrimitives.add(o),a(),s(),e._removeDefaultDataSourceListener=void 0,e._removeDataSourceCollectionListener=void 0};a=l.entities.collectionChanged.addEventListener(n),s=i.dataSourceAdded.addEventListener(n)}this._removeDefaultDataSourceListener=a,this._removeDataSourceCollectionListener=s,this._ready=!1}wf.defaultVisualizersCallback=function(e,t,i){let n=i.entities;return[new EU(t,n),new QU(e,n,i._primitives,i._groundPrimitives),new JU(t,n),new ez(e,n),new vU(e,n),new nz(t,n),new tz(e,n),new sz(e,n,i._primitives,i._groundPrimitives)]},Object.defineProperties(wf.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),wf.prototype.isDestroyed=function(){return!1},wf.prototype.destroy=function(){this._eventHelper.removeAll();let e=this._dataSourceCollection;for(let t=0,i=e.length;t<i;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),u(this._removeDefaultDataSourceListener)?(this._removeDefaultDataSourceListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),le(this)},wf.prototype.update=function(e){if(!li.initialized)return this._ready=!1,!1;let t,i,n,r,o=!0,a=this._dataSourceCollection,s=a.length;for(t=0;t<s;t++){let s=a.get(t);for(u(s.update)&&(o=s.update(e)&&o),n=s._visualizers,r=n.length,i=0;i<r;i++)o=n[i].update(e)&&o}for(n=this._defaultDataSource._visualizers,r=n.length,i=0;i<r;i++)o=n[i].update(e)&&o;return this._ready=o,o},wf.prototype._postRender=function(){let e=this._scene.frameState,t=this._dataSourceCollection,i=t.length;for(let n=0;n<i;n++){let i=t.get(n),r=i.credit;u(r)&&e.creditDisplay.addCreditToNextFrame(r);let o=i._resourceCredits;if(u(o)){let t=o.length;for(let i=0;i<t;i++)e.creditDisplay.addCreditToNextFrame(o[i])}}};var smt=[],amt=new se;wf.prototype.getBoundingSphere=function(e,t,i){if(!this._ready)return at.PENDING;let n,r,o=this._defaultDataSource;if(!o.entities.contains(e)){o=void 0;let t=this._dataSourceCollection;for(r=t.length,n=0;n<r;n++){let i=t.get(n);if(i.entities.contains(e)){o=i;break}}}if(!u(o))return at.FAILED;let a=smt,s=amt,l=0,c=at.DONE,h=o._visualizers,d=h.length;for(n=0;n<d;n++){let i=h[n];if(u(i.getBoundingSphere)){if(c=h[n].getBoundingSphere(e,s),!t&&c===at.PENDING)return at.PENDING;c===at.DONE&&(a[l]=se.clone(s,a[l]),l++)}}return 0===l?at.FAILED:(a.length=l,se.fromBoundingSpheres(a,i),at.DONE)},wf.prototype._onDataSourceAdded=function(e,t){let i=this._scene,n=this._primitives,r=this._groundPrimitives,o=n.add(new tu),a=r.add(new Yk);t._primitives=o,t._groundPrimitives=a;let s=t.clustering;s._initialize(i),o.add(s),t._visualizers=this._visualizersCallback(i,s,t)},wf.prototype._onDataSourceRemoved=function(e,t){let i=this._primitives,n=this._groundPrimitives,r=t._primitives,o=t._groundPrimitives,a=t.clustering;r.remove(a);let s=t._visualizers,l=s.length;for(let e=0;e<l;e++)s[e].destroy();i.remove(r),n.remove(o),t._visualizers=void 0},wf.prototype._onDataSourceMoved=function(e,t,i){let n=this._primitives,r=this._groundPrimitives,o=e._primitives,a=e._groundPrimitives;t===i+1?(n.raise(o),r.raise(a)):t===i-1?(n.lower(o),r.lower(a)):0===t?(n.lowerToBottom(o),r.lowerToBottom(a),n.raise(o),r.raise(a)):(n.raiseToTop(o),r.raiseToTop(a))};var az=wf,tge=new $,nge=new $,ige=new $,cmt=new L,cz=new h,oge=new h,aq=new h,cq=new h,rge=new h,sge=new h,CE=new J,lmt=1.25;function umt(e,t,i,n,r,o,a){let s=e.scene.mode,l=r.getValue(o,e._lastCartesian);if(u(l)){let i,c,d,p,f,m,_=!1,g=!1;if(s===te.SCENE3D){J.addSeconds(o,.001,CE);let e=r.getValue(CE,cz);if(u(e)||(J.addSeconds(o,-.001,CE),e=r.getValue(CE,cz),g=!0),u(e)){let t,n=Rt.computeFixedToIcrfMatrix(o,tge),r=Rt.computeFixedToIcrfMatrix(CE,nge);u(n)&&u(r)?t=$.transpose(n,ige):(t=Rt.computeTemeToPseudoFixedMatrix(o,ige),n=$.transpose(t,tge),r=Rt.computeTemeToPseudoFixedMatrix(CE,nge),$.transpose(r,r));let s=$.multiplyByVector(n,l,rge),p=$.multiplyByVector(r,e,sge);h.subtract(s,p,cq);let f=1e3*h.magnitude(cq),m=P.GRAVITATIONALPARAMETER,y=-m/(f*f-2*m/h.magnitude(s));y<0||y>lmt*a.maximumRadius?(i=oge,h.normalize(l,i),h.negate(i,i),d=h.clone(h.UNIT_Z,aq),c=h.cross(d,i,cz),h.magnitude(c)>P.EPSILON7&&(h.normalize(i,i),h.normalize(c,c),d=h.cross(i,c,aq),h.normalize(d,d),_=!0)):h.equalsEpsilon(l,e,P.EPSILON7)||(d=oge,h.normalize(s,d),h.normalize(p,p),c=h.cross(d,p,aq),g&&(c=h.multiplyByScalar(c,-1,c)),h.equalsEpsilon(c,h.ZERO,P.EPSILON7)||(i=h.cross(c,d,cz),$.multiplyByVector(t,i,i),$.multiplyByVector(t,c,c),$.multiplyByVector(t,d,d),h.normalize(i,i),h.normalize(c,c),h.normalize(d,d),_=!0))}}u(e.boundingSphere)&&(l=e.boundingSphere.center),n&&(p=h.clone(t.position,cq),f=h.clone(t.direction,rge),m=h.clone(t.up,sge));let y=cmt;_?(y[0]=i.x,y[1]=i.y,y[2]=i.z,y[3]=0,y[4]=c.x,y[5]=c.y,y[6]=c.z,y[7]=0,y[8]=d.x,y[9]=d.y,y[10]=d.z,y[11]=0,y[12]=l.x,y[13]=l.y,y[14]=l.z,y[15]=0):Rt.eastNorthUpToFixedFrame(l,a,y),t._setTransform(y),n&&(h.clone(p,t.position),h.clone(f,t.direction),h.clone(m,t.up),h.cross(f,m,t.right))}if(i){let i=s===te.SCENE2D||h.equals(e._offset3D,h.ZERO)?void 0:e._offset3D;t.lookAtTransform(t.transform,i)}}function _I(e,t,i){this.entity=e,this.scene=t,this.ellipsoid=y(i,ie.WGS84),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new h,this._defaultOffset3D=void 0,this._offset3D=new h}Object.defineProperties(_I,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(e){this._defaultOffset3D=h.clone(e,new h)}}}),_I.defaultOffset3D=new h(-14e3,3500,3500);var lz=new qf,fmt=new h;_I.prototype.update=function(e,t){let i=this.scene,n=this.ellipsoid,r=i.mode;if(r===te.MORPHING)return;let o=this.entity,a=o.position;if(!u(a))return;let s=o!==this._lastEntity,l=r!==this._mode,c=i.camera,d=s||l,p=!0;if(s){let i=o.viewFrom,r=u(i);if(!r&&u(t)){lz.pitch=-P.PI_OVER_FOUR,lz.range=0;let i=a.getValue(e,fmt);if(u(i)){let e=2-1/Math.max(1,h.magnitude(i)/n.maximumRadius);lz.pitch*=e}c.viewBoundingSphere(t,lz),this.boundingSphere=t,d=!1,p=!1}else(!r||!u(i.getValue(e,this._offset3D)))&&h.clone(_I._defaultOffset3D,this._offset3D)}else!l&&this._mode!==te.SCENE2D&&h.clone(c.position,this._offset3D);this._lastEntity=o,this._mode=r,umt(this,c,d,p,a,e,n)};var uz=_I;function gz(e){return yz(e.map((([e,t])=>new Array(e).fill(t,0,e))))}function yz(e){return e.reduce(((e,t)=>e.concat(Array.isArray(t)?yz(t):t)),[])}var age=[0,1,2,3].concat(...gz([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function nr(){let e=this;function t(e,t){let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1}e.build_tree=function(i){let n,r,o,a=e.dyn_tree,s=e.stat_desc.static_tree,l=e.stat_desc.elems,u=-1;for(i.heap_len=0,i.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(i.heap[++i.heap_len]=u=n,i.depth[n]=0):a[2*n+1]=0;for(;i.heap_len<2;)o=i.heap[++i.heap_len]=u<2?++u:0,a[2*o]=1,i.depth[o]=0,i.opt_len--,s&&(i.static_len-=s[2*o+1]);for(e.max_code=u,n=Math.floor(i.heap_len/2);n>=1;n--)i.pqdownheap(a,n);o=l;do{n=i.heap[1],i.heap[1]=i.heap[i.heap_len--],i.pqdownheap(a,1),r=i.heap[1],i.heap[--i.heap_max]=n,i.heap[--i.heap_max]=r,a[2*o]=a[2*n]+a[2*r],i.depth[o]=Math.max(i.depth[n],i.depth[r])+1,a[2*n+1]=a[2*r+1]=o,i.heap[1]=o++,i.pqdownheap(a,1)}while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],function(t){let i,n,r,o,a,s,l=e.dyn_tree,u=e.stat_desc.static_tree,c=e.stat_desc.extra_bits,h=e.stat_desc.extra_base,d=e.stat_desc.max_length,p=0;for(o=0;o<=15;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<573;i++)n=t.heap[i],o=l[2*l[2*n+1]+1]+1,o>d&&(o=d,p++),l[2*n+1]=o,!(n>e.max_code)&&(t.bl_count[o]++,a=0,n>=h&&(a=c[n-h]),s=l[2*n],t.opt_len+=s*(o+a),u&&(t.static_len+=s*(u[2*n+1]+a)));if(0!==p){do{for(o=d-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[d]--,p-=2}while(p>0);for(o=d;0!==o;o--)for(n=t.bl_count[o];0!==n;)r=t.heap[--i],!(r>e.max_code)&&(l[2*r+1]!=o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),n--)}}(i),function(e,i,n){let r,o,a,s=[],l=0;for(r=1;r<=15;r++)s[r]=l=l+n[r-1]<<1;for(o=0;o<=i;o++)a=e[2*o+1],0!==a&&(e[2*o]=t(s[a]++,a))}(a,e.max_code,i.bl_count)}}function _a(e,t,i,n,r){let o=this;o.static_tree=e,o.extra_bits=t,o.extra_base=i,o.elems=n,o.max_length=r}nr._length_code=[0,1,2,3,4,5,6,7].concat(...gz([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),nr.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],nr.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],nr.d_code=function(e){return e<256?age[e]:age[256+(e>>>7)]},nr.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],nr.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],nr.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],nr.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var dmt=[12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227],hmt=gz([[144,8],[112,9],[24,7],[8,8]]);_a.static_ltree=yz(dmt.map(((e,t)=>[e,hmt[t]])));var mmt=[0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23],pmt=gz([[30,5]]);_a.static_dtree=yz(mmt.map(((e,t)=>[e,pmt[t]]))),_a.static_l_desc=new _a(_a.static_ltree,nr.extra_lbits,257,286,15),_a.static_d_desc=new _a(_a.static_dtree,nr.extra_dbits,0,30,15),_a.static_bl_desc=new _a(null,nr.extra_blbits,0,19,7);var _mt=9,gmt=8;function pm(e,t,i,n,r){let o=this;o.good_length=e,o.max_lazy=t,o.nice_length=i,o.max_chain=n,o.func=r}var lge=0,pz=1,Jx=2,Hd=[new pm(0,0,0,0,lge),new pm(4,4,8,4,pz),new pm(4,5,16,8,pz),new pm(4,6,32,32,pz),new pm(4,4,16,16,Jx),new pm(8,16,32,32,Jx),new pm(8,16,128,128,Jx),new pm(8,32,128,256,Jx),new pm(32,128,258,1024,Jx),new pm(32,258,258,4096,Jx)],fz=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],vf=0,dz=1,gI=2,hz=3,ymt=32,lq=42,mz=113,yI=666,uq=8,xmt=0,fq=1,bmt=2,fr=3,_z=258,mu=_z+fr+1;function cge(e,t,i,n){let r=e[2*t],o=e[2*i];return r<o||r==o&&n[t]<=n[i]}function Tmt(){let e,t,i,n,r,o,a,s,l,u,c,h,d,p,f,m,_,g,y,v,b,A,T,E,C,x,S,w,I,P,D,O,L,R,N,M,F,B,z,U=this,k=new nr,V=new nr,H=new nr;function G(){let e;for(e=0;e<286;e++)D[2*e]=0;for(e=0;e<30;e++)O[2*e]=0;for(e=0;e<19;e++)L[2*e]=0;D[512]=1,U.opt_len=U.static_len=0,N=M=0}function j(e,t){let i,n=-1,r=e[1],o=0,a=7,s=4;0===r&&(a=138,s=3),e[2*(t+1)+1]=65535;for(let l=0;l<=t;l++)i=r,r=e[2*(l+1)+1],!(++o<a&&i==r)&&(o<s?L[2*i]+=o:0!==i?(i!=n&&L[2*i]++,L[32]++):o<=10?L[34]++:L[36]++,o=0,n=i,0===r?(a=138,s=3):i==r?(a=6,s=3):(a=7,s=4))}function W(e){U.pending_buf[U.pending++]=e}function q(e){W(255&e),W(e>>>8&255)}function Y(e,t){let i,n=t;z>16-n?(i=e,B|=i<<z&65535,q(B),B=i>>>16-z,z+=n-16):(B|=e<<z&65535,z+=n)}function X(e,t){let i=2*e;Y(65535&t[i],65535&t[i+1])}function $(e,t){let i,n,r=-1,o=e[1],a=0,s=7,l=4;for(0===o&&(s=138,l=3),i=0;i<=t;i++)if(n=o,o=e[2*(i+1)+1],!(++a<s&&n==o)){if(a<l)do{X(n,L)}while(0!=--a);else 0!==n?(n!=r&&(X(n,L),a--),X(16,L),Y(a-3,2)):a<=10?(X(17,L),Y(a-3,3)):(X(18,L),Y(a-11,7));a=0,r=n,0===o?(s=138,l=3):n==o?(s=6,l=3):(s=7,l=4)}}function K(){16==z?(q(B),B=0,z=0):z>=8&&(W(255&B),B>>>=8,z-=8)}function J(e,t){let i,n,r;if(U.dist_buf[N]=e,U.lc_buf[N]=255&t,N++,0===e?D[2*t]++:(M++,e--,D[2*(nr._length_code[t]+256+1)]++,O[2*nr.d_code(e)]++),!(8191&N)&&S>2){for(i=8*N,n=b-_,r=0;r<30;r++)i+=O[2*r]*(5+nr.extra_dbits[r]);if(i>>>=3,M<Math.floor(N/2)&&i<Math.floor(n/2))return!0}return N==R-1}function Q(e,t){let i,n,r,o,a=0;if(0!==N)do{i=U.dist_buf[a],n=U.lc_buf[a],a++,0===i?X(n,e):(r=nr._length_code[n],X(r+256+1,e),o=nr.extra_lbits[r],0!==o&&(n-=nr.base_length[r],Y(n,o)),i--,r=nr.d_code(i),X(r,t),o=nr.extra_dbits[r],0!==o&&(i-=nr.base_dist[r],Y(i,o)))}while(a<N);X(256,e),F=e[513]}function Z(){z>8?q(B):z>0&&W(255&B),B=0,z=0}function ee(e,t,i){Y((xmt<<1)+(i?1:0),3),function(e,t,i){Z(),F=8,i&&(q(t),q(~t)),U.pending_buf.set(s.subarray(e,e+t),U.pending),U.pending+=t}(e,t,!0)}function te(e,t,i){let n,r,o=0;S>0?(k.build_tree(U),V.build_tree(U),o=function(){let e;for(j(D,k.max_code),j(O,V.max_code),H.build_tree(U),e=18;e>=3&&0===L[2*nr.bl_order[e]+1];e--);return U.opt_len+=3*(e+1)+5+5+4,e}(),n=U.opt_len+3+7>>>3,r=U.static_len+3+7>>>3,r<=n&&(n=r)):n=r=t+5,t+4<=n&&-1!=e?ee(e,t,i):r==n?(Y((fq<<1)+(i?1:0),3),Q(_a.static_ltree,_a.static_dtree)):(Y((bmt<<1)+(i?1:0),3),function(e,t,i){let n;for(Y(e-257,5),Y(t-1,5),Y(i-4,4),n=0;n<i;n++)Y(L[2*nr.bl_order[n]+1],3);$(D,e-1),$(O,t-1)}(k.max_code+1,V.max_code+1,o+1),Q(D,O)),G(),i&&Z()}function ie(t){te(_>=0?_:-1,b-_,t),_=b,e.flush_pending()}function ne(){let t,i,n,o;do{if(o=l-T-b,0===o&&0===b&&0===T)o=r;else if(-1==o)o--;else if(b>=r+r-mu){s.set(s.subarray(r,r+r),0),A-=r,b-=r,_-=r,t=d,n=t;do{i=65535&c[--n],c[n]=i>=r?i-r:0}while(0!=--t);t=r,n=t;do{i=65535&u[--n],u[n]=i>=r?i-r:0}while(0!=--t);o+=r}if(0===e.avail_in)return;t=e.read_buf(s,b+T,o),T+=t,T>=fr&&(h=255&s[b],h=(h<<m^255&s[b+1])&f)}while(T<mu&&0!==e.avail_in)}function re(e){let t,i,n=C,o=b,l=E,c=b>r-mu?b-(r-mu):0,h=P,d=a,p=b+_z,f=s[o+l-1],m=s[o+l];E>=I&&(n>>=2),h>T&&(h=T);do{if(t=e,s[t+l]==m&&s[t+l-1]==f&&s[t]==s[o]&&s[++t]==s[o+1]){o+=2,t++;do{}while(s[++o]==s[++t]&&s[++o]==s[++t]&&s[++o]==s[++t]&&s[++o]==s[++t]&&s[++o]==s[++t]&&s[++o]==s[++t]&&s[++o]==s[++t]&&s[++o]==s[++t]&&o<p);if(i=_z-(p-o),o=p-_z,i>l){if(A=e,l=i,i>=h)break;f=s[o+l-1],m=s[o+l]}}}while((e=65535&u[e&d])>c&&0!=--n);return l<=T?l:T}function oe(e){return e.total_in=e.total_out=0,e.msg=null,U.pending=0,U.pending_out=0,t=mz,n=0,k.dyn_tree=D,k.stat_desc=_a.static_l_desc,V.dyn_tree=O,V.stat_desc=_a.static_d_desc,H.dyn_tree=L,H.stat_desc=_a.static_bl_desc,B=0,z=0,F=8,G(),function(){l=2*r,c[d-1]=0;for(let e=0;e<d-1;e++)c[e]=0;x=Hd[S].max_lazy,I=Hd[S].good_length,P=Hd[S].nice_length,C=Hd[S].max_chain,b=0,_=0,T=0,g=E=fr-1,v=0,h=0}(),0}U.depth=[],U.bl_count=[],U.heap=[],D=[],O=[],L=[],U.pqdownheap=function(e,t){let i=U.heap,n=i[t],r=t<<1;for(;r<=U.heap_len&&(r<U.heap_len&&cge(e,i[r+1],i[r],U.depth)&&r++,!cge(e,n,i[r],U.depth));)i[t]=i[r],t=r,r<<=1;i[t]=n},U.deflateInit=function(e,t,n,l,h,_){return l||(l=uq),h||(h=gmt),_||(_=0),e.msg=null,-1==t&&(t=6),h<1||h>_mt||l!=uq||n<9||n>15||t<0||t>9||_<0||_>2?-2:(e.dstate=U,o=n,r=1<<o,a=r-1,p=h+7,d=1<<p,f=d-1,m=Math.floor((p+fr-1)/fr),s=new Uint8Array(2*r),u=[],c=[],R=1<<h+6,U.pending_buf=new Uint8Array(4*R),i=4*R,U.dist_buf=new Uint16Array(R),U.lc_buf=new Uint8Array(R),S=t,w=_,oe(e))},U.deflateEnd=function(){return t!=lq&&t!=mz&&t!=yI?-2:(U.lc_buf=null,U.dist_buf=null,U.pending_buf=null,c=null,u=null,s=null,U.dstate=null,t==mz?-3:0)},U.deflateParams=function(e,t,i){let n=0;return-1==t&&(t=6),t<0||t>9||i<0||i>2?-2:(Hd[S].func!=Hd[t].func&&0!==e.total_in&&(n=e.deflate(1)),S!=t&&(S=t,x=Hd[S].max_lazy,I=Hd[S].good_length,P=Hd[S].nice_length,C=Hd[S].max_chain),w=i,n)},U.deflateSetDictionary=function(e,i,n){let o,l=n,d=0;if(!i||t!=lq)return-2;if(l<fr)return 0;for(l>r-mu&&(l=r-mu,d=n-l),s.set(i.subarray(d,d+l),0),b=l,_=l,h=255&s[0],h=(h<<m^255&s[1])&f,o=0;o<=l-fr;o++)h=(h<<m^255&s[o+(fr-1)])&f,u[o&a]=c[h],c[h]=o;return 0},U.deflate=function(l,p){let C,I,P,D,O;if(p>4||p<0)return-2;if(!l.next_out||!l.next_in&&0!==l.avail_in||t==yI&&4!=p)return l.msg=fz[4],-2;if(0===l.avail_out)return l.msg=fz[7],-5;if(e=l,D=n,n=p,t==lq&&(I=uq+(o-8<<4)<<8,P=(S-1&255)>>1,P>3&&(P=3),I|=P<<6,0!==b&&(I|=ymt),I+=31-I%31,t=mz,function(e){W(e>>8&255),W(255&e)}(I)),0!==U.pending){if(e.flush_pending(),0===e.avail_out)return n=-1,0}else if(0===e.avail_in&&p<=D&&4!=p)return e.msg=fz[7],-5;if(t==yI&&0!==e.avail_in)return l.msg=fz[7],-5;if(0!==e.avail_in||0!==T||0!=p&&t!=yI){switch(O=-1,Hd[S].func){case lge:O=function(t){let n,o=65535;for(o>i-5&&(o=i-5);;){if(T<=1){if(ne(),0===T&&0==t)return vf;if(0===T)break}if(b+=T,T=0,n=_+o,(0===b||b>=n)&&(T=b-n,b=n,ie(!1),0===e.avail_out)||b-_>=r-mu&&(ie(!1),0===e.avail_out))return vf}return ie(4==t),0===e.avail_out?4==t?gI:vf:4==t?hz:dz}(p);break;case pz:O=function(t){let i,n=0;for(;;){if(T<mu){if(ne(),T<mu&&0==t)return vf;if(0===T)break}if(T>=fr&&(h=(h<<m^255&s[b+(fr-1)])&f,n=65535&c[h],u[b&a]=c[h],c[h]=b),0!==n&&(b-n&65535)<=r-mu&&2!=w&&(g=re(n)),g>=fr)if(i=J(b-A,g-fr),T-=g,g<=x&&T>=fr){g--;do{b++,h=(h<<m^255&s[b+(fr-1)])&f,n=65535&c[h],u[b&a]=c[h],c[h]=b}while(0!=--g);b++}else b+=g,g=0,h=255&s[b],h=(h<<m^255&s[b+1])&f;else i=J(0,255&s[b]),T--,b++;if(i&&(ie(!1),0===e.avail_out))return vf}return ie(4==t),0===e.avail_out?4==t?gI:vf:4==t?hz:dz}(p);break;case Jx:O=function(t){let i,n,o=0;for(;;){if(T<mu){if(ne(),T<mu&&0==t)return vf;if(0===T)break}if(T>=fr&&(h=(h<<m^255&s[b+(fr-1)])&f,o=65535&c[h],u[b&a]=c[h],c[h]=b),E=g,y=A,g=fr-1,0!==o&&E<x&&(b-o&65535)<=r-mu&&(2!=w&&(g=re(o)),g<=5&&(1==w||g==fr&&b-A>4096)&&(g=fr-1)),E>=fr&&g<=E){n=b+T-fr,i=J(b-1-y,E-fr),T-=E-1,E-=2;do{++b<=n&&(h=(h<<m^255&s[b+(fr-1)])&f,o=65535&c[h],u[b&a]=c[h],c[h]=b)}while(0!=--E);if(v=0,g=fr-1,b++,i&&(ie(!1),0===e.avail_out))return vf}else if(0!==v){if(i=J(0,255&s[b-1]),i&&ie(!1),b++,T--,0===e.avail_out)return vf}else v=1,b++,T--}return 0!==v&&(i=J(0,255&s[b-1]),v=0),ie(4==t),0===e.avail_out?4==t?gI:vf:4==t?hz:dz}(p)}if((O==gI||O==hz)&&(t=yI),O==vf||O==gI)return 0===e.avail_out&&(n=-1),0;if(O==dz){if(1==p)Y(fq<<1,3),X(256,_a.static_ltree),K(),1+F+10-z<9&&(Y(fq<<1,3),X(256,_a.static_ltree),K()),F=7;else if(ee(0,0,!1),3==p)for(C=0;C<d;C++)c[C]=0;if(e.flush_pending(),0===e.avail_out)return n=-1,0}}return 4!=p?0:1}}function uge(){let e=this;e.next_in_index=0,e.next_out_index=0,e.avail_in=0,e.total_in=0,e.avail_out=0,e.total_out=0}function Amt(e){let t=new uge,i=Cmt(e&&e.chunkSize?e.chunkSize:65536),n=new Uint8Array(i),r=e?e.level:-1;typeof r>"u"&&(r=-1),t.deflateInit(r),t.next_out=n,this.append=function(e,r){let o,a,s=0,l=0,u=0,c=[];if(e.length){t.next_in_index=0,t.next_in=e,t.avail_in=e.length;do{if(t.next_out_index=0,t.avail_out=i,o=t.deflate(0),0!=o)throw new Error("deflating: "+t.msg);t.next_out_index&&(t.next_out_index==i?c.push(new Uint8Array(n)):c.push(n.slice(0,t.next_out_index))),u+=t.next_out_index,r&&t.next_in_index>0&&t.next_in_index!=s&&(r(t.next_in_index),s=t.next_in_index)}while(t.avail_in>0||0===t.avail_out);return c.length>1?(a=new Uint8Array(u),c.forEach((function(e){a.set(e,l),l+=e.length}))):a=c[0]||new Uint8Array(0),a}},this.flush=function(){let e,r,o=0,a=0,s=[];do{if(t.next_out_index=0,t.avail_out=i,e=t.deflate(4),1!=e&&0!=e)throw new Error("deflating: "+t.msg);i-t.avail_out>0&&s.push(n.slice(0,t.next_out_index)),a+=t.next_out_index}while(t.avail_in>0||0===t.avail_out);return t.deflateEnd(),r=new Uint8Array(a),s.forEach((function(e){r.set(e,o),o+=e.length})),r}}function Cmt(e){return e+5*(Math.floor(e/16383)+1)}uge.prototype={deflateInit:function(e,t){let i=this;return i.dstate=new Tmt,t||(t=15),i.dstate.deflateInit(i,e,t)},deflate:function(e){let t=this;return t.dstate?t.dstate.deflate(t,e):-2},deflateEnd:function(){let e=this;if(!e.dstate)return-2;let t=e.dstate.deflateEnd();return e.dstate=null,t},deflateParams:function(e,t){let i=this;return i.dstate?i.dstate.deflateParams(i,e,t):-2},deflateSetDictionary:function(e,t){let i=this;return i.dstate?i.dstate.deflateSetDictionary(i,e,t):-2},read_buf:function(e,t,i){let n=this,r=n.avail_in;return r>i&&(r=i),0===r?0:(n.avail_in-=r,e.set(n.next_in.subarray(n.next_in_index,n.next_in_index+r),t),n.next_in_index+=r,n.total_in+=r,r)},flush_pending:function(){let e=this,t=e.dstate.pending;t>e.avail_out&&(t=e.avail_out),0!==t&&(e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out,e.dstate.pending_out+t),e.next_out_index),e.next_out_index+=t,e.dstate.pending_out+=t,e.total_out+=t,e.avail_out-=t,e.dstate.pending-=t,0===e.dstate.pending&&(e.dstate.pending_out=0))}};var fge=Amt,pu=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Oge=1440,Emt=0,Smt=4,wmt=9,vmt=5,Dmt=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Imt=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Pmt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Omt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Rmt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Mmt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Cy=15;function pq(){let e,t,i,n,r,o;function a(e,t,a,s,l,u,c,h,d,p,f){let m,_,g,y,v,b,A,T,E,C,x,S,w,I,P;C=0,v=a;do{i[e[t+C]]++,C++,v--}while(0!==v);if(i[0]==a)return c[0]=-1,h[0]=0,0;for(T=h[0],b=1;b<=Cy&&0===i[b];b++);for(A=b,T<b&&(T=b),v=Cy;0!==v&&0===i[v];v--);for(g=v,T>v&&(T=v),h[0]=T,I=1<<b;b<v;b++,I<<=1)if((I-=i[b])<0)return-3;if((I-=i[v])<0)return-3;for(i[v]+=I,o[1]=b=0,C=1,w=2;0!=--v;)o[w]=b+=i[C],w++,C++;v=0,C=0;do{0!==(b=e[t+C])&&(f[o[b]++]=v),C++}while(++v<a);for(a=o[g],o[0]=v=0,C=0,y=-1,S=-T,r[0]=0,x=0,P=0;A<=g;A++)for(m=i[A];0!=m--;){for(;A>S+T;){if(y++,S+=T,P=g-S,P=P>T?T:P,(_=1<<(b=A-S))>m+1&&(_-=m+1,w=A,b<P))for(;++b<P&&!((_<<=1)<=i[++w]);)_-=i[w];if(P=1<<b,p[0]+P>Oge)return-3;r[y]=x=p[0],p[0]+=P,0!==y?(o[y]=v,n[0]=b,n[1]=T,b=v>>>S-T,n[2]=x-r[y-1]-b,d.set(n,3*(r[y-1]+b))):c[0]=x}for(n[1]=A-S,C>=a?n[0]=192:f[C]<s?(n[0]=f[C]<256?0:96,n[2]=f[C++]):(n[0]=u[f[C]-s]+16+64,n[2]=l[f[C++]-s]),_=1<<A-S,b=v>>>S;b<P;b+=_)d.set(n,3*(x+b));for(b=1<<A-1;v&b;b>>>=1)v^=b;for(v^=b,E=(1<<S)-1;(v&E)!=o[y];)y--,S-=T,E=(1<<S)-1}return 0!==I&&1!=g?-5:0}function s(a){let s;for(e||(e=[],t=[],i=new Int32Array(Cy+1),n=[],r=new Int32Array(Cy),o=new Int32Array(Cy+1)),t.length<a&&(t=[]),s=0;s<a;s++)t[s]=0;for(s=0;s<Cy+1;s++)i[s]=0;for(s=0;s<3;s++)n[s]=0;r.set(i.subarray(0,Cy),0),o.set(i.subarray(0,Cy+1),0)}this.inflate_trees_bits=function(i,n,r,o,l){let u;return s(19),e[0]=0,u=a(i,0,19,19,null,null,r,n,o,e,t),-3==u?l.msg="oversubscribed dynamic bit lengths tree":(-5==u||0===n[0])&&(l.msg="incomplete dynamic bit lengths tree",u=-3),u},this.inflate_trees_dynamic=function(i,n,r,o,l,u,c,h,d){let p;return s(288),e[0]=0,p=a(r,0,i,257,Pmt,Omt,u,o,h,e,t),0!=p||0===o[0]?(-3==p?d.msg="oversubscribed literal/length tree":-4!=p&&(d.msg="incomplete literal/length tree",p=-3),p):(s(288),p=a(r,i,n,0,Rmt,Mmt,c,l,h,e,t),0!=p||0===l[0]&&i>257?(-3==p?d.msg="oversubscribed distance tree":-5==p?(d.msg="incomplete distance tree",p=-3):-4!=p&&(d.msg="empty distance tree with lengths",p=-3),p):0)}}pq.inflate_trees_fixed=function(e,t,i,n){return e[0]=wmt,t[0]=vmt,i[0]=Dmt,n[0]=Imt,0};var xz=0,dge=1,hge=2,mge=3,pge=4,_ge=5,gge=6,dq=7,yge=8,bz=9;function Lmt(){let e,t,i,n,r=this,o=0,a=0,s=0,l=0,u=0,c=0,h=0,d=0,p=0,f=0;function m(e,t,i,n,r,o,a,s){let l,u,c,h,d,p,f,m,_,g,y,v,b,A,T,E;f=s.next_in_index,m=s.avail_in,d=a.bitb,p=a.bitk,_=a.write,g=_<a.read?a.read-_-1:a.end-_,y=pu[e],v=pu[t];do{for(;p<20;)m--,d|=(255&s.read_byte(f++))<<p,p+=8;if(l=d&y,u=i,c=n,E=3*(c+l),0!==(h=u[E]))for(;;){if(d>>=u[E+1],p-=u[E+1],16&h){for(h&=15,b=u[E+2]+(d&pu[h]),d>>=h,p-=h;p<15;)m--,d|=(255&s.read_byte(f++))<<p,p+=8;for(l=d&v,u=r,c=o,E=3*(c+l),h=u[E];;){if(d>>=u[E+1],p-=u[E+1],16&h){for(h&=15;p<h;)m--,d|=(255&s.read_byte(f++))<<p,p+=8;if(A=u[E+2]+(d&pu[h]),d>>=h,p-=h,g-=b,_>=A)T=_-A,_-T>0&&2>_-T?(a.win[_++]=a.win[T++],a.win[_++]=a.win[T++],b-=2):(a.win.set(a.win.subarray(T,T+2),_),_+=2,T+=2,b-=2);else{T=_-A;do{T+=a.end}while(T<0);if(h=a.end-T,b>h){if(b-=h,_-T>0&&h>_-T)do{a.win[_++]=a.win[T++]}while(0!=--h);else a.win.set(a.win.subarray(T,T+h),_),_+=h,T+=h,h=0;T=0}}if(_-T>0&&b>_-T)do{a.win[_++]=a.win[T++]}while(0!=--b);else a.win.set(a.win.subarray(T,T+b),_),_+=b,T+=b,b=0;break}if(64&h)return s.msg="invalid distance code",b=s.avail_in-m,b=p>>3<b?p>>3:b,m+=b,f-=b,p-=b<<3,a.bitb=d,a.bitk=p,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=_,-3;l+=u[E+2],l+=d&pu[h],E=3*(c+l),h=u[E]}break}if(64&h)return 32&h?(b=s.avail_in-m,b=p>>3<b?p>>3:b,m+=b,f-=b,p-=b<<3,a.bitb=d,a.bitk=p,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=_,1):(s.msg="invalid literal/length code",b=s.avail_in-m,b=p>>3<b?p>>3:b,m+=b,f-=b,p-=b<<3,a.bitb=d,a.bitk=p,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=_,-3);if(l+=u[E+2],l+=d&pu[h],E=3*(c+l),0===(h=u[E])){d>>=u[E+1],p-=u[E+1],a.win[_++]=u[E+2],g--;break}}else d>>=u[E+1],p-=u[E+1],a.win[_++]=u[E+2],g--}while(g>=258&&m>=10);return b=s.avail_in-m,b=p>>3<b?p>>3:b,m+=b,f-=b,p-=b<<3,a.bitb=d,a.bitk=p,s.avail_in=m,s.total_in+=f-s.next_in_index,s.next_in_index=f,a.write=_,0}r.init=function(r,o,a,s,l,u){e=xz,h=r,d=o,i=a,p=s,n=l,f=u,t=null},r.proc=function(r,_,g){let y,v,b,A,T,E,C,x=0,S=0,w=0;for(w=_.next_in_index,A=_.avail_in,x=r.bitb,S=r.bitk,T=r.write,E=T<r.read?r.read-T-1:r.end-T;;)switch(e){case xz:if(E>=258&&A>=10&&(r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,g=m(h,d,i,p,n,f,r,_),w=_.next_in_index,A=_.avail_in,x=r.bitb,S=r.bitk,T=r.write,E=T<r.read?r.read-T-1:r.end-T,0!=g)){e=1==g?dq:bz;break}s=h,t=i,a=p,e=dge;case dge:for(y=s;S<y;){if(0===A)return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);g=0,A--,x|=(255&_.read_byte(w++))<<S,S+=8}if(v=3*(a+(x&pu[y])),x>>>=t[v+1],S-=t[v+1],b=t[v],0===b){l=t[v+2],e=gge;break}if(16&b){u=15&b,o=t[v+2],e=hge;break}if(!(64&b)){s=b,a=v/3+t[v+2];break}if(32&b){e=dq;break}return e=bz,_.msg="invalid literal/length code",g=-3,r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);case hge:for(y=u;S<y;){if(0===A)return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);g=0,A--,x|=(255&_.read_byte(w++))<<S,S+=8}o+=x&pu[y],x>>=y,S-=y,s=d,t=n,a=f,e=mge;case mge:for(y=s;S<y;){if(0===A)return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);g=0,A--,x|=(255&_.read_byte(w++))<<S,S+=8}if(v=3*(a+(x&pu[y])),x>>=t[v+1],S-=t[v+1],b=t[v],16&b){u=15&b,c=t[v+2],e=pge;break}if(!(64&b)){s=b,a=v/3+t[v+2];break}return e=bz,_.msg="invalid distance code",g=-3,r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);case pge:for(y=u;S<y;){if(0===A)return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);g=0,A--,x|=(255&_.read_byte(w++))<<S,S+=8}c+=x&pu[y],x>>=y,S-=y,e=_ge;case _ge:for(C=T-c;C<0;)C+=r.end;for(;0!==o;){if(0===E&&(T==r.end&&0!==r.read&&(T=0,E=T<r.read?r.read-T-1:r.end-T),0===E&&(r.write=T,g=r.inflate_flush(_,g),T=r.write,E=T<r.read?r.read-T-1:r.end-T,T==r.end&&0!==r.read&&(T=0,E=T<r.read?r.read-T-1:r.end-T),0===E)))return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);r.win[T++]=r.win[C++],E--,C==r.end&&(C=0),o--}e=xz;break;case gge:if(0===E&&(T==r.end&&0!==r.read&&(T=0,E=T<r.read?r.read-T-1:r.end-T),0===E&&(r.write=T,g=r.inflate_flush(_,g),T=r.write,E=T<r.read?r.read-T-1:r.end-T,T==r.end&&0!==r.read&&(T=0,E=T<r.read?r.read-T-1:r.end-T),0===E)))return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);g=0,r.win[T++]=l,E--,e=xz;break;case dq:if(S>7&&(S-=8,A++,w--),r.write=T,g=r.inflate_flush(_,g),T=r.write,E=T<r.read?r.read-T-1:r.end-T,r.read!=r.write)return r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);e=yge;case yge:return g=1,r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);case bz:return g=-3,r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g);default:return g=-2,r.bitb=x,r.bitk=S,_.avail_in=A,_.total_in+=w-_.next_in_index,_.next_in_index=w,r.write=T,r.inflate_flush(_,g)}},r.free=function(){}}var xge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],EE=0,hq=1,bge=2,Tge=3,Age=4,Cge=5,Tz=6,Az=7,Ege=8,eb=9;function Nmt(e,t){let i,n=this,r=EE,o=0,a=0,s=0,l=[0],u=[0],c=new Lmt,h=0,d=new Int32Array(3*Oge),p=new pq;n.bitk=0,n.bitb=0,n.win=new Uint8Array(t),n.end=t,n.read=0,n.write=0,n.reset=function(e,t){t&&(t[0]=0),r==Tz&&c.free(e),r=EE,n.bitk=0,n.bitb=0,n.read=n.write=0},n.reset(e,null),n.inflate_flush=function(e,t){let i,r,o;return r=e.next_out_index,o=n.read,i=(o<=n.write?n.write:n.end)-o,i>e.avail_out&&(i=e.avail_out),0!==i&&-5==t&&(t=0),e.avail_out-=i,e.total_out+=i,e.next_out.set(n.win.subarray(o,o+i),r),r+=i,o+=i,o==n.end&&(o=0,n.write==n.end&&(n.write=0),i=n.write-o,i>e.avail_out&&(i=e.avail_out),0!==i&&-5==t&&(t=0),e.avail_out-=i,e.total_out+=i,e.next_out.set(n.win.subarray(o,o+i),r),r+=i,o+=i),e.next_out_index=r,n.read=o,t},n.proc=function(e,t){let f,m,_,g,y,v,b,A;for(g=e.next_in_index,y=e.avail_in,m=n.bitb,_=n.bitk,v=n.write,b=v<n.read?n.read-v-1:n.end-v;;){let T,E,C,x,S,w,I,P;switch(r){case EE:for(;_<3;){if(0===y)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<_,_+=8}switch(f=7&m,h=1&f,f>>>1){case 0:m>>>=3,_-=3,f=7&_,m>>>=f,_-=f,r=hq;break;case 1:T=[],E=[],C=[[]],x=[[]],pq.inflate_trees_fixed(T,E,C,x),c.init(T[0],E[0],C[0],0,x[0],0),m>>>=3,_-=3,r=Tz;break;case 2:m>>>=3,_-=3,r=Tge;break;case 3:return m>>>=3,_-=3,r=eb,e.msg="invalid block type",t=-3,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t)}break;case hq:for(;_<32;){if(0===y)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<_,_+=8}if((~m>>>16&65535)!=(65535&m))return r=eb,e.msg="invalid stored block lengths",t=-3,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);o=65535&m,m=_=0,r=0!==o?bge:0!==h?Az:EE;break;case bge:if(0===y||0===b&&(v==n.end&&0!==n.read&&(v=0,b=v<n.read?n.read-v-1:n.end-v),0===b&&(n.write=v,t=n.inflate_flush(e,t),v=n.write,b=v<n.read?n.read-v-1:n.end-v,v==n.end&&0!==n.read&&(v=0,b=v<n.read?n.read-v-1:n.end-v),0===b)))return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);if(t=0,f=o,f>y&&(f=y),f>b&&(f=b),n.win.set(e.read_buf(g,f),v),g+=f,y-=f,v+=f,b-=f,0!=(o-=f))break;r=0!==h?Az:EE;break;case Tge:for(;_<14;){if(0===y)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<_,_+=8}if(a=f=16383&m,(31&f)>29||(f>>5&31)>29)return r=eb,e.msg="too many length or distance symbols",t=-3,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);if(f=258+(31&f)+(f>>5&31),!i||i.length<f)i=[];else for(A=0;A<f;A++)i[A]=0;m>>>=14,_-=14,s=0,r=Age;case Age:for(;s<4+(a>>>10);){for(;_<3;){if(0===y)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<_,_+=8}i[xge[s++]]=7&m,m>>>=3,_-=3}for(;s<19;)i[xge[s++]]=0;if(l[0]=7,f=p.inflate_trees_bits(i,l,u,d,e),0!=f)return-3==(t=f)&&(i=null,r=eb),n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);s=0,r=Cge;case Cge:for(;f=a,!(s>=258+(31&f)+(f>>5&31));){let o,c;for(f=l[0];_<f;){if(0===y)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<_,_+=8}if(f=d[3*(u[0]+(m&pu[f]))+1],c=d[3*(u[0]+(m&pu[f]))+2],c<16)m>>>=f,_-=f,i[s++]=c;else{for(A=18==c?7:c-14,o=18==c?11:3;_<f+A;){if(0===y)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);t=0,y--,m|=(255&e.read_byte(g++))<<_,_+=8}if(m>>>=f,_-=f,o+=m&pu[A],m>>>=A,_-=A,A=s,f=a,A+o>258+(31&f)+(f>>5&31)||16==c&&A<1)return i=null,r=eb,e.msg="invalid bit length repeat",t=-3,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);c=16==c?i[A-1]:0;do{i[A++]=c}while(0!=--o);s=A}}if(u[0]=-1,S=[],w=[],I=[],P=[],S[0]=9,w[0]=6,f=a,f=p.inflate_trees_dynamic(257+(31&f),1+(f>>5&31),i,S,w,I,P,d,e),0!=f)return-3==f&&(i=null,r=eb),t=f,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);c.init(S[0],w[0],d,I[0],d,P[0]),r=Tz;case Tz:if(n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,1!=(t=c.proc(n,e,t)))return n.inflate_flush(e,t);if(t=0,c.free(e),g=e.next_in_index,y=e.avail_in,m=n.bitb,_=n.bitk,v=n.write,b=v<n.read?n.read-v-1:n.end-v,0===h){r=EE;break}r=Az;case Az:if(n.write=v,t=n.inflate_flush(e,t),v=n.write,b=v<n.read?n.read-v-1:n.end-v,n.read!=n.write)return n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);r=Ege;case Ege:return t=1,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);case eb:return t=-3,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t);default:return t=-2,n.bitb=m,n.bitk=_,e.avail_in=y,e.total_in+=g-e.next_in_index,e.next_in_index=g,n.write=v,n.inflate_flush(e,t)}}},n.free=function(e){n.reset(e,null),n.win=null,d=null},n.set_dictionary=function(e,t,i){n.win.set(e.subarray(t,t+i),0),n.read=n.write=i},n.sync_point=function(){return r==hq?1:0}}var Fmt=32,Bmt=8,kmt=0,Sge=1,wge=2,vge=3,Dge=4,Ige=5,mq=6,xI=7,Pge=12,Ey=13,Vmt=[0,0,255,255];function Umt(){let e=this;function t(e){return e&&e.istate?(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=xI,e.istate.blocks.reset(e,null),0):-2}e.mode=0,e.method=0,e.was=[0],e.need=0,e.marker=0,e.wbits=0,e.inflateEnd=function(t){return e.blocks&&e.blocks.free(t),e.blocks=null,0},e.inflateInit=function(i,n){return i.msg=null,e.blocks=null,n<8||n>15?(e.inflateEnd(i),-2):(e.wbits=n,i.istate.blocks=new Nmt(i,1<<n),t(i),0)},e.inflate=function(e,t){let i,n;if(!e||!e.istate||!e.next_in)return-2;let r=e.istate;for(t=t==Smt?-5:0,i=-5;;)switch(r.mode){case kmt:if(0===e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,(15&(r.method=e.read_byte(e.next_in_index++)))!=Bmt){r.mode=Ey,e.msg="unknown compression method",r.marker=5;break}if(8+(r.method>>4)>r.wbits){r.mode=Ey,e.msg="invalid win size",r.marker=5;break}r.mode=Sge;case Sge:if(0===e.avail_in)return i;if(i=t,e.avail_in--,e.total_in++,n=255&e.read_byte(e.next_in_index++),((r.method<<8)+n)%31!=0){r.mode=Ey,e.msg="incorrect header check",r.marker=5;break}if(!(n&Fmt)){r.mode=xI;break}r.mode=wge;case wge:if(0===e.avail_in)return i;i=t,e.avail_in--,e.total_in++,r.need=(255&e.read_byte(e.next_in_index++))<<24&4278190080,r.mode=vge;case vge:if(0===e.avail_in)return i;i=t,e.avail_in--,e.total_in++,r.need+=(255&e.read_byte(e.next_in_index++))<<16&16711680,r.mode=Dge;case Dge:if(0===e.avail_in)return i;i=t,e.avail_in--,e.total_in++,r.need+=(255&e.read_byte(e.next_in_index++))<<8&65280,r.mode=Ige;case Ige:return 0===e.avail_in?i:(i=t,e.avail_in--,e.total_in++,r.need+=255&e.read_byte(e.next_in_index++),r.mode=mq,2);case mq:return r.mode=Ey,e.msg="need dictionary",r.marker=0,-2;case xI:if(i=r.blocks.proc(e,i),-3==i){r.mode=Ey,r.marker=0;break}if(0==i&&(i=t),1!=i)return i;i=t,r.blocks.reset(e,r.was),r.mode=Pge;case Pge:return e.avail_in=0,1;case Ey:return-3;default:return-2}},e.inflateSetDictionary=function(e,t,i){let n=0,r=i;if(!e||!e.istate||e.istate.mode!=mq)return-2;let o=e.istate;return r>=1<<o.wbits&&(r=(1<<o.wbits)-1,n=i-r),o.blocks.set_dictionary(t,n,r),o.mode=xI,0},e.inflateSync=function(e){let i,n,r,o,a;if(!e||!e.istate)return-2;let s=e.istate;if(s.mode!=Ey&&(s.mode=Ey,s.marker=0),0===(i=e.avail_in))return-5;for(n=e.next_in_index,r=s.marker;0!==i&&r<4;)e.read_byte(n)==Vmt[r]?r++:r=0!==e.read_byte(n)?0:4-r,n++,i--;return e.total_in+=n-e.next_in_index,e.next_in_index=n,e.avail_in=i,s.marker=r,4!=r?-3:(o=e.total_in,a=e.total_out,t(e),e.total_in=o,e.total_out=a,s.mode=xI,0)},e.inflateSyncPoint=function(e){return e&&e.istate&&e.istate.blocks?e.istate.blocks.sync_point():-2}}function Rge(){}function zmt(e){let t=new Rge,i=e&&e.chunkSize?Math.floor(2*e.chunkSize):131072,n=Emt,r=new Uint8Array(i),o=!1;t.inflateInit(),t.next_out=r,this.append=function(e,a){let s,l,u=[],c=0,h=0,d=0;if(0!==e.length){t.next_in_index=0,t.next_in=e,t.avail_in=e.length;do{if(t.next_out_index=0,t.avail_out=i,0===t.avail_in&&!o&&(t.next_in_index=0,o=!0),s=t.inflate(n),o&&-5===s){if(0!==t.avail_in)throw new Error("inflating: bad input")}else if(0!==s&&1!==s)throw new Error("inflating: "+t.msg);if((o||1===s)&&t.avail_in===e.length)throw new Error("inflating: bad input");t.next_out_index&&(t.next_out_index===i?u.push(new Uint8Array(r)):u.push(r.slice(0,t.next_out_index))),d+=t.next_out_index,a&&t.next_in_index>0&&t.next_in_index!=c&&(a(t.next_in_index),c=t.next_in_index)}while(t.avail_in>0||0===t.avail_out);return u.length>1?(l=new Uint8Array(d),u.forEach((function(e){l.set(e,h),h+=e.length}))):l=u[0]||new Uint8Array(0),l}},this.flush=function(){t.inflateEnd()}}Rge.prototype={inflateInit:function(e){let t=this;return t.istate=new Umt,e||(e=15),t.istate.inflateInit(t,e)},inflate:function(e){let t=this;return t.istate?t.istate.inflate(t,e):-2},inflateEnd:function(){let e=this;if(!e.istate)return-2;let t=e.istate.inflateEnd(e);return e.istate=null,t},inflateSync:function(){let e=this;return e.istate?e.istate.inflateSync(e):-2},inflateSetDictionary:function(e,t){let i=this;return i.istate?i.istate.inflateSetDictionary(i,e,t):-2},read_byte:function(e){return this.next_in[e]},read_buf:function(e,t){return this.next_in.subarray(e,e+t)}};var Mge=zmt,Hmt={chunkSize:524288,maxWorkers:typeof navigator<"u"&&navigator.hardwareConcurrency||2,terminateWorkerTimeout:5e3,useWebWorkers:!0,workerScripts:void 0},xl=Object.assign({},Hmt);function Cz(){return xl}function SE(e){if(void 0!==e.baseURL&&(xl.baseURL=e.baseURL),void 0!==e.chunkSize&&(xl.chunkSize=e.chunkSize),void 0!==e.maxWorkers&&(xl.maxWorkers=e.maxWorkers),void 0!==e.terminateWorkerTimeout&&(xl.terminateWorkerTimeout=e.terminateWorkerTimeout),void 0!==e.useWebWorkers&&(xl.useWebWorkers=e.useWebWorkers),void 0!==e.Deflate&&(xl.Deflate=e.Deflate),void 0!==e.Inflate&&(xl.Inflate=e.Inflate),void 0!==e.workerScripts){if(e.workerScripts.deflate){if(!Array.isArray(e.workerScripts.deflate))throw new Error("workerScripts.deflate must be an array");xl.workerScripts||(xl.workerScripts={}),xl.workerScripts.deflate=e.workerScripts.deflate}if(e.workerScripts.inflate){if(!Array.isArray(e.workerScripts.inflate))throw new Error("workerScripts.inflate must be an array");xl.workerScripts||(xl.workerScripts={}),xl.workerScripts.inflate=e.workerScripts.inflate}}}var Lge=[];for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)1&t?t=t>>>1^3988292384:t>>>=1;Lge[e]=t}var _q=class{constructor(e){this.crc=e||-1}append(e){let t=0|this.crc;for(let i=0,n=0|e.length;i<n;i++)t=t>>>8^Lge[255&(t^e[i])];this.crc=t}get(){return~this.crc}},Sy=_q,bI=Gmt;function Gmt(e){if(typeof TextEncoder>"u"){e=unescape(encodeURIComponent(e));let t=new Uint8Array(e.length);for(let i=0;i<t.length;i++)t[i]=e.charCodeAt(i);return t}return(new TextEncoder).encode(e)}var Rc={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);let i=e[e.length-1],n=Rc.getPartial(i);return 32===n?e.concat(t):Rc._shiftRight(t,n,0|i,e.slice(0,e.length-1))},bitLength(e){let t=e.length;if(0===t)return 0;let i=e[t-1];return 32*(t-1)+Rc.getPartial(i)},clamp(e,t){if(32*e.length<t)return e;let i=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,i>0&&t&&(e[i-1]=Rc.partial(t,e[i-1]&2147483648>>t-1,1)),e},partial:(e,t,i)=>32===e?t:(i?0|t:t<<32-e)+1099511627776*e,getPartial:e=>Math.round(e/1099511627776)||32,_shiftRight(e,t,i,n){for(void 0===n&&(n=[]);t>=32;t-=32)n.push(i),i=0;if(0===t)return n.concat(e);for(let r=0;r<e.length;r++)n.push(i|e[r]>>>t),i=e[r]<<32-t;let r=e.length?e[e.length-1]:0,o=Rc.getPartial(r);return n.push(Rc.partial(t+o&31,t+o>32?i:n.pop(),1)),n}},TI={bytes:{fromBits(e){let t,i=Rc.bitLength(e)/8,n=new Uint8Array(i);for(let r=0;r<i;r++)3&r||(t=e[r/4]),n[r]=t>>>24,t<<=8;return n},toBits(e){let t,i=[],n=0;for(t=0;t<e.length;t++)n=n<<8|e[t],3==(3&t)&&(i.push(n),n=0);return 3&t&&i.push(Rc.partial(8*(3&t),n)),i}}},gq={sha1:function(e){e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()}};gq.sha1.prototype={blockSize:512,reset:function(){let e=this;return e._h=this._init.slice(0),e._buffer=[],e._length=0,e},update:function(e){let t=this;"string"==typeof e&&(e=TI.utf8String.toBits(e));let i=t._buffer=Rc.concat(t._buffer,e),n=t._length,r=t._length=n+Rc.bitLength(e);if(r>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");let o=new Uint32Array(i),a=0;for(let e=t.blockSize+n-(t.blockSize+n&t.blockSize-1);e<=r;e+=t.blockSize)t._block(o.subarray(16*a,16*(a+1))),a+=1;return i.splice(0,16*a),t},finalize:function(){let e=this,t=e._buffer,i=e._h;t=Rc.concat(t,[Rc.partial(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(Math.floor(e._length/4294967296)),t.push(0|e._length);t.length;)e._block(t.splice(0,16));return e.reset(),i},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(e,t,i,n){return e<=19?t&i|~t&n:e<=39?t^i^n:e<=59?t&i|t&n|i&n:e<=79?t^i^n:void 0},_S:function(e,t){return t<<e|t>>>32-e},_block:function(e){let t=this,i=t._h,n=Array(80);for(let t=0;t<16;t++)n[t]=e[t];let r=i[0],o=i[1],a=i[2],s=i[3],l=i[4];for(let e=0;e<=79;e++){e>=16&&(n[e]=t._S(1,n[e-3]^n[e-8]^n[e-14]^n[e-16]));let i=t._S(5,r)+t._f(e,o,a,s)+l+n[e]+t._key[Math.floor(e/20)]|0;l=s,s=a,a=t._S(30,o),o=r,r=i}i[0]=i[0]+r|0,i[1]=i[1]+o|0,i[2]=i[2]+a|0,i[3]=i[3]+s|0,i[4]=i[4]+l|0}};var yq={aes:class{constructor(e){let t=this;t._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],t._tables[0][0][0]||t._precompute();let i,n,r,o=t._tables[0][4],a=t._tables[1],s=e.length,l=1;if(4!==s&&6!==s&&8!==s)throw new Error("invalid aes key size");for(t._key=[n=e.slice(0),r=[]],i=s;i<4*s+28;i++){let e=n[i-1];(i%s==0||8===s&&i%s==4)&&(e=o[e>>>24]<<24^o[e>>16&255]<<16^o[e>>8&255]<<8^o[255&e],i%s==0&&(e=e<<8^e>>>24^l<<24,l=l<<1^283*(l>>7))),n[i]=n[i-s]^e}for(let e=0;i;e++,i--){let t=n[3&e?i:i-4];r[e]=i<=4||e<4?t:a[0][o[t>>>24]]^a[1][o[t>>16&255]]^a[2][o[t>>8&255]]^a[3][o[255&t]]}}encrypt(e){return this._crypt(e,0)}decrypt(e){return this._crypt(e,1)}_precompute(){let e,t,i,n,r=this._tables[0],o=this._tables[1],a=r[4],s=o[4],l=[],u=[];for(let e=0;e<256;e++)u[(l[e]=e<<1^283*(e>>7))^e]=e;for(let c=e=0;!a[c];c^=t||1,e=u[e]||1){let u=e^e<<1^e<<2^e<<3^e<<4;u=u>>8^255&u^99,a[c]=u,s[u]=c,n=l[i=l[t=l[c]]];let h=16843009*n^65537*i^257*t^16843008*c,d=257*l[u]^16843008*u;for(let e=0;e<4;e++)r[e][c]=d=d<<24^d>>>8,o[e][u]=h=h<<24^h>>>8}for(let e=0;e<5;e++)r[e]=r[e].slice(0),o[e]=o[e].slice(0)}_crypt(e,t){if(4!==e.length)throw new Error("invalid aes block size");let i,n,r,o=this._key[t],a=o.length/4-2,s=[0,0,0,0],l=this._tables[t],u=l[0],c=l[1],h=l[2],d=l[3],p=l[4],f=e[0]^o[0],m=e[t?3:1]^o[1],_=e[2]^o[2],g=e[t?1:3]^o[3],y=4;for(let e=0;e<a;e++)i=u[f>>>24]^c[m>>16&255]^h[_>>8&255]^d[255&g]^o[y],n=u[m>>>24]^c[_>>16&255]^h[g>>8&255]^d[255&f]^o[y+1],r=u[_>>>24]^c[g>>16&255]^h[f>>8&255]^d[255&m]^o[y+2],g=u[g>>>24]^c[f>>16&255]^h[m>>8&255]^d[255&_]^o[y+3],y+=4,f=i,m=n,_=r;for(let e=0;e<4;e++)s[t?3&-e:e]=p[f>>>24]<<24^p[m>>16&255]<<16^p[_>>8&255]<<8^p[255&g]^o[y++],i=f,f=m,m=_,_=g,g=i;return s}}},Nge={getRandomValues(e){let t=new Uint32Array(e.buffer),i=e=>{let t=987654321,i=4294967295;return function(){return t=36969*(65535&t)+(t>>16)&i,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let n,r=0;r<e.length;r+=4){let e=i(4294967296*(n||Math.random()));n=987654071*e(),t[r/4]=4294967296*e()|0}return e}},xq={ctrGladman:class{constructor(e,t){this._prf=e,this._initIv=t,this._iv=t}reset(){this._iv=this._initIv}update(e){return this.calculate(this._prf,e,this._iv)}incWord(e){if(255==(e>>24&255)){let t=e>>16&255,i=e>>8&255,n=255&e;255===t?(t=0,255===i?(i=0,255===n?n=0:++n):++i):++t,e=0,e+=t<<16,e+=i<<8,e+=n}else e+=1<<24;return e}incCounter(e){0===(e[0]=this.incWord(e[0]))&&(e[1]=this.incWord(e[1]))}calculate(e,t,i){let n;if(!(n=t.length))return[];let r=Rc.bitLength(t);for(let r=0;r<n;r+=4){this.incCounter(i);let n=e.encrypt(i);t[r]^=n[0],t[r+1]^=n[1],t[r+2]^=n[2],t[r+3]^=n[3]}return Rc.clamp(t,r)}}},wE={importKey:e=>new wE.hmacSha1(TI.bytes.toBits(e)),pbkdf2(e,t,i,n){if(i=i||1e4,n<0||i<0)throw new Error("invalid params to pbkdf2");let r,o,a,s,l,u=1+(n>>5)<<2,c=new ArrayBuffer(u),h=new DataView(c),d=0,p=Rc;for(t=TI.bytes.toBits(t),l=1;d<(u||1);l++){for(r=o=e.encrypt(p.concat(t,[l])),a=1;a<i;a++)for(o=e.encrypt(o),s=0;s<o.length;s++)r[s]^=o[s];for(a=0;d<(u||1)&&a<r.length;a++)h.setInt32(d,r[a]),d+=4}return c.slice(0,n/8)},hmacSha1:class{constructor(e){let t=this,i=t._hash=gq.sha1,n=[[],[]],r=i.prototype.blockSize/32;t._baseHash=[new i,new i],e.length>r&&(e=i.hash(e));for(let t=0;t<r;t++)n[0][t]=909522486^e[t],n[1][t]=1549556828^e[t];t._baseHash[0].update(n[0]),t._baseHash[1].update(n[1]),t._resultHash=new i(t._baseHash[0])}reset(){let e=this;e._resultHash=new e._hash(e._baseHash[0]),e._updated=!1}update(e){this._updated=!0,this._resultHash.update(e)}digest(){let e=this,t=e._resultHash.finalize(),i=new e._hash(e._baseHash[1]).update(t).finalize();return e.reset(),i}encrypt(e){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},DE="Invalid pasword",vE=16,Wmt="raw",Fge={name:"PBKDF2"},jmt={name:"HMAC"},qmt="SHA-1",Ymt=Object.assign({hash:jmt},Fge),Bge=Object.assign({iterations:1e3,hash:{name:qmt}},Fge),Xmt=["deriveBits"],CI=[8,12,16],AI=[16,24,32],wy=10,kge=[0,0,0,0],wz=typeof crypto<"u",Vge=wz&&typeof crypto.subtle<"u",_m=TI.bytes,Uge=yq.aes,zge=xq.ctrGladman,Hge=wE.hmacSha1,Ez=class{constructor(e,t,i){Object.assign(this,{password:e,signed:t,strength:i-1,pendingInput:new Uint8Array(0)})}async append(e){let t=this;if(t.password){let i=_u(e,0,CI[t.strength]+2);await Kmt(t,i,t.password),t.password=null,t.aesCtrGladman=new zge(new Uge(t.keys.key),Array.from(kge)),t.hmac=new Hge(t.keys.authentication),e=_u(e,CI[t.strength]+2)}return Gge(t,e,new Uint8Array(e.length-wy-(e.length-wy)%vE),0,wy,!0)}flush(){let e=this,t=e.pendingInput,i=_u(t,0,t.length-wy),n=_u(t,t.length-wy),r=new Uint8Array(0);if(i.length){let t=_m.toBits(i);e.hmac.update(t);let n=e.aesCtrGladman.update(t);r=_m.fromBits(n)}let o=!0;if(e.signed){let t=_u(_m.fromBits(e.hmac.digest()),0,wy);for(let e=0;e<wy;e++)t[e]!=n[e]&&(o=!1)}return{valid:o,data:r}}},Sz=class{constructor(e,t){Object.assign(this,{password:e,strength:t-1,pendingInput:new Uint8Array(0)})}async append(e){let t=this,i=new Uint8Array(0);t.password&&(i=await Zmt(t,t.password),t.password=null,t.aesCtrGladman=new zge(new Uge(t.keys.key),Array.from(kge)),t.hmac=new Hge(t.keys.authentication));let n=new Uint8Array(i.length+e.length-e.length%vE);return n.set(i,0),Gge(t,e,n,i.length,0)}flush(){let e=this,t=new Uint8Array(0);if(e.pendingInput.length){let i=e.aesCtrGladman.update(_m.toBits(e.pendingInput));e.hmac.update(i),t=_m.fromBits(i)}let i=_u(_m.fromBits(e.hmac.digest()),0,wy);return{data:bq(t,i),signature:i}}};function Gge(e,t,i,n,r,o){let a,s=t.length-r;for(e.pendingInput.length&&(t=bq(e.pendingInput,t),i=ept(i,s-s%vE)),a=0;a<=s-vE;a+=vE){let r=_m.toBits(_u(t,a,a+vE));o&&e.hmac.update(r);let s=e.aesCtrGladman.update(r);o||e.hmac.update(s),i.set(_m.fromBits(s),a+n)}return e.pendingInput=_u(t,a),i}async function Kmt(e,t,i){await Wge(e,i,_u(t,0,CI[e.strength]));let n=_u(t,CI[e.strength]),r=e.keys.passwordVerification;if(r[0]!=n[0]||r[1]!=n[1])throw new Error(DE)}async function Zmt(e,t){let i=$mt(new Uint8Array(CI[e.strength]));return await Wge(e,t,i),bq(i,e.keys.passwordVerification)}async function Wge(e,t,i){let n=bI(t),r=await Qmt(Wmt,n,Ymt,!1,Xmt),o=await Jmt(Object.assign({salt:i},Bge),r,8*(2*AI[e.strength]+2)),a=new Uint8Array(o);e.keys={key:_m.toBits(_u(a,0,AI[e.strength])),authentication:_m.toBits(_u(a,AI[e.strength],2*AI[e.strength])),passwordVerification:_u(a,2*AI[e.strength])}}function $mt(e){return wz&&"function"==typeof crypto.getRandomValues?crypto.getRandomValues(e):Nge.getRandomValues(e)}function Qmt(e,t,i,n,r){return wz&&Vge&&"function"==typeof crypto.subtle.importKey?crypto.subtle.importKey(e,t,i,n,r):wE.importKey(t)}async function Jmt(e,t,i){return wz&&Vge&&"function"==typeof crypto.subtle.deriveBits?await crypto.subtle.deriveBits(e,t,i):wE.pbkdf2(t,e.salt,Bge.iterations,i)}function bq(e,t){let i=e;return e.length+t.length&&(i=new Uint8Array(e.length+t.length),i.set(e,0),i.set(t,e.length)),i}function ept(e,t){if(t&&t>e.length){let i=e;(e=new Uint8Array(t)).set(i,0)}return e}function _u(e,t,i){return e.subarray(t,i)}var IE=12,vz=class{constructor(e,t){Object.assign(this,{password:e,passwordVerification:t}),Xge(this,e)}append(e){let t=this;if(t.password){let i=jge(t,e.subarray(0,IE));if(t.password=null,i[IE-1]!=t.passwordVerification)throw new Error(DE);e=e.subarray(IE)}return jge(t,e)}flush(){return{valid:!0,data:new Uint8Array(0)}}},Dz=class{constructor(e,t){Object.assign(this,{password:e,passwordVerification:t}),Xge(this,e)}append(e){let t,i,n=this;if(n.password){n.password=null;let r=crypto.getRandomValues(new Uint8Array(IE));r[IE-1]=n.passwordVerification,t=new Uint8Array(e.length+r.length),t.set(qge(n,r),0),i=IE}else t=new Uint8Array(e.length),i=0;return t.set(qge(n,e),i),t}flush(){return{data:new Uint8Array(0)}}};function jge(e,t){let i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=Kge(e)^t[n],Tq(e,i[n]);return i}function qge(e,t){let i=new Uint8Array(t.length);for(let n=0;n<t.length;n++)i[n]=Kge(e)^t[n],Tq(e,t[n]);return i}function Xge(e,t){e.keys=[305419896,591751049,878082192],e.crcKey0=new Sy(e.keys[0]),e.crcKey2=new Sy(e.keys[2]);for(let i=0;i<t.length;i++)Tq(e,t.charCodeAt(i))}function Tq(e,t){e.crcKey0.append([t]),e.keys[0]=~e.crcKey0.get(),e.keys[1]=Yge(e.keys[1]+Zge(e.keys[0])),e.keys[1]=Yge(Math.imul(e.keys[1],134775813)+1),e.crcKey2.append([e.keys[1]>>>24]),e.keys[2]=~e.crcKey2.get()}function Kge(e){let t=2|e.keys[2];return Zge(Math.imul(t,1^t)>>>8)}function Zge(e){return 255&e}function Yge(e){return 4294967295&e}var Pz="deflate",Oz="inflate",Iz="Invalid signature",Aq=class{constructor(e,{signature:t,password:i,signed:n,compressed:r,zipCrypto:o,passwordVerification:a,encryptionStrength:s},{chunkSize:l}){let u=!!i;Object.assign(this,{signature:t,encrypted:u,signed:n,compressed:r,inflate:r&&new e({chunkSize:l}),crc32:n&&new Sy,zipCrypto:o,decrypt:u&&o?new vz(i,a):new Ez(i,n,s)})}async append(e){let t=this;return t.encrypted&&e.length&&(e=await t.decrypt.append(e)),t.compressed&&e.length&&(e=await t.inflate.append(e)),(!t.encrypted||t.zipCrypto)&&t.signed&&e.length&&t.crc32.append(e),e}async flush(){let e,t=this,i=new Uint8Array(0);if(t.encrypted){let e=t.decrypt.flush();if(!e.valid)throw new Error(Iz);i=e.data}if((!t.encrypted||t.zipCrypto)&&t.signed){let i=new DataView(new Uint8Array(4).buffer);if(e=t.crc32.get(),i.setUint32(0,e),t.signature!=i.getUint32(0,!1))throw new Error(Iz)}return t.compressed&&(i=await t.inflate.append(i)||new Uint8Array(0),await t.inflate.flush()),{data:i,signature:e}}},Cq=class{constructor(e,{encrypted:t,signed:i,compressed:n,level:r,zipCrypto:o,password:a,passwordVerification:s,encryptionStrength:l},{chunkSize:u}){Object.assign(this,{encrypted:t,signed:i,compressed:n,deflate:n&&new e({level:r||5,chunkSize:u}),crc32:i&&new Sy,zipCrypto:o,encrypt:t&&o?new Dz(a,s):new Sz(a,l)})}async append(e){let t=this,i=e;return t.compressed&&e.length&&(i=await t.deflate.append(e)),t.encrypted&&i.length&&(i=await t.encrypt.append(i)),(!t.encrypted||t.zipCrypto)&&t.signed&&e.length&&t.crc32.append(e),i}async flush(){let e,t=this,i=new Uint8Array(0);if(t.compressed&&(i=await t.deflate.flush()||new Uint8Array(0)),t.encrypted){i=await t.encrypt.append(i);let n=t.encrypt.flush();e=n.signature;let r=new Uint8Array(i.length+n.data.length);r.set(i,0),r.set(n.data,i.length),i=r}return(!t.encrypted||t.zipCrypto)&&t.signed&&(e=t.crc32.get()),{data:i,signature:e}}};function $ge(e,t,i){return t.codecType.startsWith(Pz)?new Cq(e,t,i):t.codecType.startsWith(Oz)?new Aq(e,t,i):void 0}var Qge="init",Jge="append",Eq="flush",tpt="message",eye=!0,Rz=(e,t,i,n,r,o,a)=>(Object.assign(e,{busy:!0,codecConstructor:t,options:Object.assign({},i),scripts:a,terminate(){e.worker&&!e.busy&&(e.worker.terminate(),e.interface=null)},onTaskFinished(){e.busy=!1,r(e)}}),o?ipt(e,n):npt(e,n));function npt(e,t){let i=$ge(e.codecConstructor,e.options,t);return{async append(t){try{return await i.append(t)}catch(t){throw e.onTaskFinished(),t}},async flush(){try{return await i.flush()}finally{e.onTaskFinished()}},abort(){e.onTaskFinished()}}}function ipt(e,t){let i,n={type:"module"};if(!e.interface){if(eye)try{e.worker=r({},t.baseURL)}catch{eye=!1,e.worker=r(n,t.baseURL)}else e.worker=r(n,t.baseURL);e.worker.addEventListener(tpt,(function(t){let n=t.data;if(i){let t=n.error,r=n.type;if(t){let n=new Error(t.message);n.stack=t.stack,i.reject(n),i=null,e.onTaskFinished()}else if(r==Qge||r==Eq||r==Jge){let t=n.data;r==Eq?(i.resolve({data:new Uint8Array(t),signature:n.signature}),i=null,e.onTaskFinished()):i.resolve(t&&new Uint8Array(t))}}}),!1),e.interface={append:e=>o({type:Jge,data:e}),flush:()=>o({type:Eq}),abort(){e.onTaskFinished()}}}return e.interface;function r(t,i){let n,r;n=e.scripts[0],"function"==typeof n&&(n=n());try{r=new URL(n,i)}catch{r=n}return new Worker(r,t)}async function o(n){if(!i){let i=e.options,n=e.scripts.slice(1);await a({scripts:n,type:Qge,options:i,config:{chunkSize:t.chunkSize}})}return a(n)}function a(t){let n=e.worker,r=new Promise(((e,t)=>i={resolve:e,reject:t}));try{if(t.data)try{t.data=t.data.buffer,n.postMessage(t,[t.data])}catch{n.postMessage(t)}else n.postMessage(t)}catch(t){i.reject(t),i=null,e.onTaskFinished()}return r}}var tb=[],Sq=[];function Mz(e,t,i){let n=!(!t.compressed&&!t.signed&&!t.encrypted)&&(t.useWebWorkers||void 0===t.useWebWorkers&&i.useWebWorkers),r=n&&i.workerScripts?i.workerScripts[t.codecType]:[];if(tb.length<i.maxWorkers){let a={};return tb.push(a),Rz(a,e,t,i,o,n,r)}{let a=tb.find((e=>!e.busy));return a?(tye(a),Rz(a,e,t,i,o,n,r)):new Promise((i=>Sq.push({resolve:i,codecConstructor:e,options:t,webWorker:n,scripts:r})))}function o(e){if(Sq.length){let[{resolve:t,codecConstructor:n,options:r,webWorker:a,scripts:s}]=Sq.splice(0,1);t(Rz(e,n,r,i,o,a,s))}else e.worker?(tye(e),Number.isFinite(i.terminateWorkerTimeout)&&i.terminateWorkerTimeout>=0&&(e.terminateTimeout=setTimeout((()=>{tb=tb.filter((t=>t!=e)),e.terminate()}),i.terminateWorkerTimeout))):tb=tb.filter((t=>t!=e))}}function tye(e){e.terminateTimeout&&(clearTimeout(e.terminateTimeout),e.terminateTimeout=null)}var iye="Abort error";async function Lz(e,t,i,n,r,o,a){let s=Math.max(o.chunkSize,64);return async function o(l=0,u=0){let c=a.signal,h=r();if(l<h){wq(c,e);let r=await t.readUint8Array(l+n,Math.min(s,h-l)),d=r.length;wq(c,e);let p=await e.append(r);if(wq(c,e),u+=await nye(i,p),a.onprogress)try{a.onprogress(l+d,h)}catch{}return o(l+s,u)}{let t=await e.flush();return u+=await nye(i,t.data),{signature:t.signature,length:u}}}()}function wq(e,t){if(e&&e.aborted)throw t.abort(),new Error(iye)}async function nye(e,t){return t.length&&await e.writeUint8Array(t),t.length}var vq="text/plain",Nz=class{constructor(){this.size=0}init(){this.initialized=!0}},Fz=class extends Nz{},EI=class extends Nz{writeUint8Array(e){this.size+=e.length}},Bz=class extends Fz{constructor(e){super(),this.blobReader=new nb(new Blob([e],{type:vq}))}init(){super.init(),this.blobReader.init(),this.size=this.blobReader.size}readUint8Array(e,t){return this.blobReader.readUint8Array(e,t)}},kz=class extends EI{constructor(e){super(),this.encoding=e,this.blob=new Blob([],{type:vq})}writeUint8Array(e){super.writeUint8Array(e),this.blob=new Blob([this.blob,e.buffer],{type:vq})}getData(){if(this.blob.text)return this.blob.text();{let e=new FileReader;return new Promise(((t,i)=>{e.onload=e=>t(e.target.result),e.onerror=()=>i(e.error),e.readAsText(this.blob,this.encoding)}))}}},Vz=class extends EI{constructor(e){super(),this.data="data:"+(e||"")+";base64,",this.pending=[]}writeUint8Array(e){super.writeUint8Array(e);let t=0,i=this.pending,n=this.pending.length;for(this.pending="",t=0;t<3*Math.floor((n+e.length)/3)-n;t++)i+=String.fromCharCode(e[t]);for(;t<e.length;t++)this.pending+=String.fromCharCode(e[t]);i.length>2?this.data+=btoa(i):this.pending=i}getData(){return this.data+btoa(this.pending)}},nb=class extends Fz{constructor(e){super(),this.blob=e,this.size=e.size}async readUint8Array(e,t){if(this.blob.arrayBuffer)return new Uint8Array(await this.blob.slice(e,e+t).arrayBuffer());{let i=new FileReader;return new Promise(((n,r)=>{i.onload=e=>n(new Uint8Array(e.target.result)),i.onerror=()=>r(i.error),i.readAsArrayBuffer(this.blob.slice(e,e+t))}))}}},PE=class extends EI{constructor(e){super(),this.contentType=e,this.arrayBuffersMaxlength=8,oye(this)}writeUint8Array(e){super.writeUint8Array(e),this.arrayBuffers.length==this.arrayBuffersMaxlength&&rye(this),this.arrayBuffers.push(e.buffer)}getData(){return this.blob||(this.arrayBuffers.length&&rye(this),this.blob=this.pendingBlob,oye(this)),this.blob}};function oye(e){e.pendingBlob=new Blob([],{type:e.contentType}),e.arrayBuffers=[]}function rye(e){e.pendingBlob=new Blob([e.pendingBlob,...e.arrayBuffers],{type:e.contentType}),e.arrayBuffers=[]}var OE="/",Dq=new Date(2107,11,31),Iq=new Date(1980,0,1),opt="\0 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ ".split(""),sye=e=>{let t="";for(let i=0;i<e.length;i++)t+=opt[e[i]];return t},Uz=rpt;function rpt(e,t){if(t&&"cp437"==t.trim().toLowerCase())return sye(e);if(typeof TextDecoder>"u"){let t=new FileReader;return new Promise(((i,n)=>{t.onload=e=>i(e.target.result),t.onerror=()=>n(t.error),t.readAsText(new Blob([e]))}))}return new TextDecoder(t).decode(e)}var spt=["filename","rawFilename","directory","encrypted","compressedSize","uncompressedSize","lastModDate","rawLastModDate","comment","rawComment","signature","extraField","rawExtraField","bitFlag","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","filenameUTF8","commentUTF8","offset","zip64","compressionMethod","extraFieldNTFS","lastAccessDate","creationDate","extraFieldExtendedTimestamp","version","versionMadeBy","msDosCompatible","internalFileAttribute","externalFileAttribute"],Qp=class{constructor(e){spt.forEach((t=>this[t]=e[t]))}},Rq="File format is not recognized",upt="End of central directory not found",fpt="End of Zip64 central directory not found",dpt="End of Zip64 central directory locator not found",hpt="Central directory header not found",mpt="Local file header not found",ppt="Zip64 extra field not found",_pt="File contains encrypted entry",gpt="Encryption method not supported",aye="Compression method not supported",cye="utf-8",lye="cp437",uye=["uncompressedSize","compressedSize","offset"],Kz=class{constructor(e,t={}){Object.assign(this,{reader:e,options:t,config:Cz()})}async*getEntriesGenerator(e={}){let t=this,i=t.reader;if(i.initialized||await i.init(),i.size<22)throw new Error(Rq);let n=await Apt(i,101010256,i.size,22,1048560);if(!n)throw new Error(upt);let r=Qa(n),o=Zs(r,12),a=Zs(r,16),s=gu(r,8),l=0;if(4294967295==a||4294967295==o||65535==s){let e=Qa(await vy(i,n.offset-20,20));if(117853008!=Zs(e,0))throw new Error(fpt);a=zz(e,8);let t=await vy(i,a,56),r=Qa(t),u=n.offset-20-56;if(101075792!=Zs(r,0)&&a!=u){let e=a;a=u,l=a-e,t=await vy(i,a,56),r=Qa(t)}if(101075792!=Zs(r,0))throw new Error(dpt);s=zz(r,32),o=zz(r,40),a-=o}if(a<0||a>=i.size)throw new Error(Rq);let u=0,c=await vy(i,a,o),h=Qa(c);if(o){let e=n.offset-o;if(33639248!=Zs(h,u)&&a!=e){let t=a;a=e,l=a-t,c=await vy(i,a,o),h=Qa(c)}}if(a<0||a>=i.size)throw new Error(Rq);for(let n=0;n<s;n++){let r=new Lq(i,t.config,t.options);if(33639248!=Zs(h,u))throw new Error(hpt);dye(r,h,u+6);let o=!!r.bitFlag.languageEncodingFlag,a=u+46,d=a+r.filenameLength,p=d+r.extraFieldLength,f=gu(h,u+4),m=0==(0&f);Object.assign(r,{versionMadeBy:f,msDosCompatible:m,compressedSize:0,uncompressedSize:0,commentLength:gu(h,u+32),directory:m&&16==(16&ME(h,u+38)),offset:Zs(h,u+42)+l,internalFileAttribute:Zs(h,u+34),externalFileAttribute:Zs(h,u+38),rawFilename:c.subarray(a,d),filenameUTF8:o,commentUTF8:o,rawExtraField:c.subarray(d,p)});let _=p+r.commentLength;r.rawComment=c.subarray(p,_);let g=RE(t,e,"filenameEncoding"),y=RE(t,e,"commentEncoding"),[v,b]=await Promise.all([Uz(r.rawFilename,r.filenameUTF8?cye:g||lye),Uz(r.rawComment,r.commentUTF8?cye:y||lye)]);r.filename=v,r.comment=b,!r.directory&&r.filename.endsWith(OE)&&(r.directory=!0),await hye(r,r,h,u+6);let A=new Qp(r);if(A.getData=(e,t)=>r.getData(e,A,t),u=_,e.onprogress)try{e.onprogress(n+1,s,new Qp(r))}catch{}yield A}return!0}async getEntries(e={}){let t=[],i=this.getEntriesGenerator(e),n=i.next();for(;!(await n).done;)t.push((await n).value),n=i.next();return t}async close(){}},Lq=class{constructor(e,t,i){Object.assign(this,{reader:e,config:t,options:i})}async getData(e,t,i={}){let n=this,{reader:r,offset:o,extraFieldAES:a,compressionMethod:s,config:l,bitFlag:u,signature:c,rawLastModDate:h,compressedSize:d}=n,p=n.localDirectory={};r.initialized||await r.init();let f=await vy(r,o,30),m=Qa(f),_=RE(n,i,"password");if(_=_&&_.length&&_,a&&99!=a.originalCompressionMethod)throw new Error(aye);if(0!=s&&8!=s)throw new Error(aye);if(67324752!=Zs(m,0))throw new Error(mpt);dye(p,m,4),f=await vy(r,o,30+p.filenameLength+p.extraFieldLength),p.rawExtraField=f.subarray(30+p.filenameLength),await hye(n,p,m,4),t.lastAccessDate=p.lastAccessDate,t.creationDate=p.creationDate;let g=n.encrypted&&p.encrypted,y=g&&!a;if(g){if(!y&&void 0===a.strength)throw new Error(gpt);if(!_)throw new Error(_pt)}let v=await Mz(l.Inflate,{codecType:Oz,password:_,zipCrypto:y,encryptionStrength:a&&a.strength,signed:RE(n,i,"checkSignature"),passwordVerification:y&&(u.dataDescriptor?h>>>8&255:c>>>24&255),signature:c,compressed:0!=s,encrypted:g,useWebWorkers:RE(n,i,"useWebWorkers")},l);e.initialized||await e.init();let b=RE(n,i,"signal"),A=o+30+p.filenameLength+p.extraFieldLength;return await Lz(v,r,e,A,(()=>d),l,{onprogress:i.onprogress,signal:b}),e.getData()}};function dye(e,t,i){let n=e.rawBitFlag=gu(t,i+2),r=1==(1&n),o=Zs(t,i+6);Object.assign(e,{encrypted:r,version:gu(t,i),bitFlag:{level:(6&n)>>1,dataDescriptor:8==(8&n),languageEncodingFlag:2048==(2048&n)},rawLastModDate:o,lastModDate:Cpt(o),filenameLength:gu(t,i+22),extraFieldLength:gu(t,i+24)})}async function hye(e,t,i,n){let r=t.rawExtraField,o=t.extraField=new Map,a=Qa(new Uint8Array(r)),s=0;try{for(;s<r.length;){let e=gu(a,s),t=gu(a,s+2);o.set(e,{type:e,data:r.slice(s+4,s+4+t)}),s+=4+t}}catch{}let l=gu(i,n+4);t.signature=Zs(i,n+10),t.uncompressedSize=Zs(i,n+18),t.compressedSize=Zs(i,n+14);let u=o.get(1);u&&(ypt(u,t),t.extraFieldZip64=u);let c=o.get(28789);c&&(await fye(c,"filename","rawFilename",t,e),t.extraFieldUnicodePath=c);let h=o.get(25461);h&&(await fye(h,"comment","rawComment",t,e),t.extraFieldUnicodeComment=h);let d=o.get(39169);d?(xpt(d,t,l),t.extraFieldAES=d):t.compressionMethod=l;let p=o.get(10);p&&(bpt(p,t),t.extraFieldNTFS=p);let f=o.get(21589);f&&(Tpt(f,t),t.extraFieldExtendedTimestamp=f)}function ypt(e,t){t.zip64=!0;let i=Qa(e.data);e.values=[];for(let t=0;t<Math.floor(e.data.length/8);t++)e.values.push(zz(i,0+8*t));let n=uye.filter((e=>4294967295==t[e]));for(let t=0;t<n.length;t++)e[n[t]]=e.values[t];uye.forEach((i=>{if(4294967295==t[i]){if(void 0===e[i])throw new Error(ppt);t[i]=e[i]}}))}async function fye(e,t,i,n,r){let o=Qa(e.data);e.version=ME(o,0),e.signature=Zs(o,1);let a=new Sy;a.append(r[i]);let s=Qa(new Uint8Array(4));s.setUint32(0,a.get(),!0),e[t]=await Uz(e.data.subarray(5)),e.valid=!r.bitFlag.languageEncodingFlag&&e.signature==Zs(s,0),e.valid&&(n[t]=e[t],n[t+"UTF8"]=!0)}function xpt(e,t,i){let n=Qa(e.data);e.vendorVersion=ME(n,0),e.vendorId=ME(n,2);let r=ME(n,4);e.strength=r,e.originalCompressionMethod=i,t.compressionMethod=e.compressionMethod=gu(n,5)}function bpt(e,t){let i,n=Qa(e.data),r=4;try{for(;r<e.data.length&&!i;){let t=gu(n,r),o=gu(n,r+2);1==t&&(i=e.data.slice(r+4,r+4+o)),r+=4+o}}catch{}try{if(i&&24==i.length){let n=Qa(i),r=n.getBigUint64(0,!0),o=n.getBigUint64(8,!0),a=n.getBigUint64(16,!0);Object.assign(e,{rawLastModDate:r,rawLastAccessDate:o,rawCreationDate:a});let s={lastModDate:Mq(r),lastAccessDate:Mq(o),creationDate:Mq(a)};Object.assign(e,s),Object.assign(t,s)}}catch{}}function Tpt(e,t){let i=Qa(e.data),n=ME(i,0),r=[],o=[];1==(1&n)&&(r.push("lastModDate"),o.push("rawLastModDate")),2==(2&n)&&(r.push("lastAccessDate"),o.push("rawLastAccessDate")),4==(4&n)&&(r.push("creationDate"),o.push("rawCreationDate"));let a=1;r.forEach(((n,r)=>{if(e.data.length>=a+4){let s=Zs(i,a);t[n]=e[n]=new Date(1e3*s);let l=o[r];e[l]=s}a+=4}))}async function Apt(e,t,i,n,r){let o=new Uint8Array(4);Ept(Qa(o),0,t);let a=n+r;return await s(n)||await s(Math.min(a,i));async function s(t){let r=i-t,a=await vy(e,r,t);for(let e=a.length-n;e>=0;e--)if(a[e]==o[0]&&a[e+1]==o[1]&&a[e+2]==o[2]&&a[e+3]==o[3])return{offset:r+e,buffer:a.slice(e,e+n).buffer}}}function RE(e,t,i){return void 0===t[i]?e.options[i]:t[i]}function Cpt(e){let t=(4294901760&e)>>16,i=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&i)>>11,(2016&i)>>5,2*(31&i),0)}catch{}}function Mq(e){return new Date(Number(e/BigInt(1e4)-BigInt(116444736e5)))}function ME(e,t){return e.getUint8(t)}function gu(e,t){return e.getUint16(t,!0)}function Zs(e,t){return e.getUint32(t,!0)}function zz(e,t){return Number(e.getBigUint64(t,!0))}function Ept(e,t,i){e.setUint32(t,i,!0)}function Qa(e){return new DataView(e.buffer)}function vy(e,t,i){return e.readUint8Array(t,i)}var Ipt="File already exists",Ppt="Zip file comment exceeds 64KB",Opt="File entry comment exceeds 64KB",Rpt="File entry name exceeds 64KB",_ye="Version exceeds 65535",Mpt="The strength must equal 1, 2, or 3",Lpt="Extra field type exceeds 65535",Npt="Extra field data exceeds 64KB",qq="Zip64 is not supported",gye=new Uint8Array([7,0,2,0,65,69,3,0,0]),yye=24,Wq=0,Qz=class{constructor(e,t={}){Object.assign(this,{writer:e,options:t,config:Cz(),files:new Map,offset:e.size,pendingCompressedSize:0,pendingEntries:[],pendingAddFileCalls:new Set})}async add(e="",t,i={}){let n=this;if(!(Wq<n.config.maxWorkers))return new Promise(((r,o)=>n.pendingEntries.push({name:e,reader:t,options:i,resolve:r,reject:o})));{let r;Wq++;try{return r=Fpt(n,e,t,i),this.pendingAddFileCalls.add(r),await r}finally{this.pendingAddFileCalls.delete(r),Wq--;let e=n.pendingEntries.shift();e&&n.add(e.name,e.reader,e.options).then(e.resolve).catch(e.reject)}}}async close(e=new Uint8Array(0),t={}){for(;this.pendingAddFileCalls.size;)await Promise.all(Array.from(this.pendingAddFileCalls));return await Vpt(this,e,t),this.writer.getData()}};async function Fpt(e,t,i,n){if(t=t.trim(),n.directory&&!t.endsWith(OE)?t+=OE:n.directory=t.endsWith(OE),e.files.has(t))throw new Error(Ipt);let r=bI(t);if(r.length>65535)throw new Error(Rpt);let o=n.comment||"",a=bI(o);if(a.length>65535)throw new Error(Opt);let s=e.options.version||n.version||0;if(s>65535)throw new Error(_ye);let l=e.options.versionMadeBy||n.versionMadeBy||20;if(l>65535)throw new Error(_ye);let u=ga(e,n,"lastModDate")||new Date,c=ga(e,n,"lastAccessDate"),h=ga(e,n,"creationDate"),d=ga(e,n,"password"),p=ga(e,n,"encryptionStrength")||3,f=ga(e,n,"zipCrypto");if(void 0!==d&&void 0!==p&&(p<1||p>3))throw new Error(Mpt);let m=new Uint8Array(0),_=n.extraField;if(_){let e=0,t=0;_.forEach((t=>e+=4+t.length)),m=new Uint8Array(e),_.forEach(((e,i)=>{if(i>65535)throw new Error(Lpt);if(e.length>65535)throw new Error(Npt);Qs(m,new Uint16Array([i]),t),Qs(m,new Uint16Array([e.length]),t+2),Qs(m,e,t+4),t+=4+e.length}))}let g=ga(e,n,"extendedTimestamp");void 0===g&&(g=!0);let y=0,v=ga(e,n,"keepOrder");void 0===v&&(v=!0);let b=0,A=ga(e,n,"msDosCompatible");void 0===A&&(A=!0);let T=ga(e,n,"internalFileAttribute")||0,E=ga(e,n,"externalFileAttribute")||0;i&&(i.initialized||await i.init(),b=i.size,y=zpt(b));let C=n.zip64||e.options.zip64||!1;if(e.offset+e.pendingCompressedSize>=4294967295||b>=4294967295||y>=4294967295){if(!1===n.zip64||!1===e.options.zip64||!v)throw new Error(qq);C=!0}e.pendingCompressedSize+=y,await Promise.resolve();let x=ga(e,n,"level"),S=ga(e,n,"useWebWorkers"),w=ga(e,n,"bufferedWrite"),I=ga(e,n,"dataDescriptor"),P=ga(e,n,"dataDescriptorSignature"),D=ga(e,n,"signal");void 0===I&&(I=!0),I&&void 0===P&&(P=!1);let O=await Bpt(e,t,i,Object.assign({},n,{rawFilename:r,rawComment:a,version:s,versionMadeBy:l,lastModDate:u,lastAccessDate:c,creationDate:h,rawExtraField:m,zip64:C,password:d,level:x,useWebWorkers:S,encryptionStrength:p,extendedTimestamp:g,zipCrypto:f,bufferedWrite:w,keepOrder:v,dataDescriptor:I,dataDescriptorSignature:P,signal:D,msDosCompatible:A,internalFileAttribute:T,externalFileAttribute:E}));return y&&(e.pendingCompressedSize-=y),Object.assign(O,{name:t,comment:o,extraField:_}),new Qp(O)}async function Bpt(e,t,i,n){let r,o,a,s=e.files,l=e.writer,u=Array.from(s.values()).pop(),c={};s.set(t,c);try{let h,d,p;if(n.keepOrder&&(h=u&&u.lock),c.lock=p=new Promise((e=>a=e)),n.bufferedWrite||e.lockWrite||!n.dataDescriptor?(d=new PE,d.init(),r=!0):(e.lockWrite=new Promise((e=>o=e)),l.initialized||await l.init(),d=l),c=await kpt(i,d,e.config,n),c.lock=p,s.set(t,c),c.filename=t,r){let t,i=0,r=d.getData();await Promise.all([e.lockWrite,h]);do{t=Array.from(s.values()).find((e=>e.writingBufferedData)),t&&await t.lock}while(t&&t.lock);if(c.writingBufferedData=!0,!n.dataDescriptor){let e=await xye(r,0,26),t=new DataView(e);(!c.encrypted||n.zipCrypto)&&co(t,14,c.signature),c.zip64?(co(t,18,4294967295),co(t,22,4294967295)):(co(t,18,c.compressedSize),co(t,22,c.uncompressedSize)),await l.writeUint8Array(new Uint8Array(e)),i=26}await Upt(l,r,i),delete c.writingBufferedData}if(c.offset=e.offset,c.zip64){bl(Gd(c.rawExtraFieldZip64),20,BigInt(c.offset))}else if(c.offset>=4294967295)throw new Error(qq);return e.offset+=c.length,c}catch(i){throw(r&&c.writingBufferedData||!r&&c.dataWritten)&&(i.corruptedEntry=e.hasCorruptedEntries=!0,c.uncompressedSize&&(e.offset+=c.uncompressedSize)),s.delete(t),i}finally{a(),o&&o()}}async function kpt(e,t,i,n){let r,o,a,{rawFilename:s,lastAccessDate:l,creationDate:u,password:c,level:h,zip64:d,zipCrypto:p,dataDescriptor:f,dataDescriptorSignature:m,directory:_,version:g,versionMadeBy:y,rawComment:v,rawExtraField:b,useWebWorkers:A,onprogress:T,signal:E,encryptionStrength:C,extendedTimestamp:x,msDosCompatible:S,internalFileAttribute:w,externalFileAttribute:I}=n,P=!(!c||!c.length),D=0!==h&&!_;if(P&&!p){r=new Uint8Array(gye.length+2);let e=Gd(r);Xo(e,0,39169),Qs(r,gye,2),Jz(e,8,C)}else r=new Uint8Array(0);if(x){a=new Uint8Array(9+(l?4:0)+(u?4:0));let e=Gd(a);Xo(e,0,21589),Xo(e,2,a.length-4),Jz(e,4,1+(l?2:0)+(u?4:0)),co(e,5,Math.floor(n.lastModDate.getTime()/1e3)),l&&co(e,9,Math.floor(l.getTime()/1e3)),u&&co(e,13,Math.floor(u.getTime()/1e3));try{o=new Uint8Array(36);let e=Gd(o),t=jq(n.lastModDate);Xo(e,0,10),Xo(e,2,32),Xo(e,8,1),Xo(e,10,24),bl(e,12,t),bl(e,20,jq(l)||t),bl(e,28,jq(u)||t)}catch{o=new Uint8Array(0)}}else o=a=new Uint8Array(0);let O={version:g||20,versionMadeBy:y,zip64:d,directory:!!_,filenameUTF8:!0,rawFilename:s,commentUTF8:!0,rawComment:v,rawExtraFieldZip64:d?new Uint8Array(yye+4):new Uint8Array(0),rawExtraFieldExtendedTimestamp:a,rawExtraFieldNTFS:o,rawExtraFieldAES:r,rawExtraField:b,extendedTimestamp:x,msDosCompatible:S,internalFileAttribute:w,externalFileAttribute:I},L=O.uncompressedSize=0,R=2048;f&&(R|=8);let N=0;D&&(N=8),d&&(O.version=O.version>45?O.version:45),P&&(R|=1,p||(O.version=O.version>51?O.version:51,N=99,D&&(O.rawExtraFieldAES[9]=8))),O.compressionMethod=N;let M=O.headerArray=new Uint8Array(26),F=Gd(M);Xo(F,0,O.version),Xo(F,2,R),Xo(F,4,N);let B,z=new Uint32Array(1),U=Gd(z);B=n.lastModDate<Iq?Iq:n.lastModDate>Dq?Dq:n.lastModDate,Xo(U,0,(B.getHours()<<6|B.getMinutes())<<5|B.getSeconds()/2),Xo(U,2,(B.getFullYear()-1980<<4|B.getMonth()+1)<<5|B.getDate());let k=z[0];co(F,6,k),Xo(F,22,s.length);let V=r.length+a.length+o.length+O.rawExtraField.length;Xo(F,24,V);let H=new Uint8Array(30+s.length+V);co(Gd(H),0,67324752),Qs(H,M,4),Qs(H,s,30),Qs(H,r,30+s.length),Qs(H,a,30+s.length+r.length),Qs(H,o,30+s.length+r.length+a.length),Qs(H,O.rawExtraField,30+s.length+r.length+a.length+o.length);let G,j=0;if(e){let n=await Mz(i.Deflate,{codecType:Pz,level:h,password:c,encryptionStrength:C,zipCrypto:P&&p,passwordVerification:P&&p&&k>>8&255,signed:!0,compressed:D,encrypted:P,useWebWorkers:A},i);await t.writeUint8Array(H),O.dataWritten=!0,G=await Lz(n,e,t,0,(()=>e.size),i,{onprogress:T,signal:E}),L=O.uncompressedSize=e.size,j=G.length}else await t.writeUint8Array(H),O.dataWritten=!0;let W,q=new Uint8Array(0),Y=0;if(f&&(q=new Uint8Array(d?m?24:20:m?16:12),W=Gd(q),m&&(Y=4,co(W,0,134695760))),e){let e=G.signature;if((!P||p)&&void 0!==e&&(co(F,10,e),O.signature=e,f&&co(W,Y,e)),d){let e=Gd(O.rawExtraFieldZip64);Xo(e,0,1),Xo(e,2,yye),co(F,14,4294967295),bl(e,12,BigInt(j)),co(F,18,4294967295),bl(e,4,BigInt(L)),f&&(bl(W,Y+4,BigInt(j)),bl(W,Y+12,BigInt(L)))}else co(F,14,j),co(F,18,L),f&&(co(W,Y+4,j),co(W,Y+8,L))}f&&await t.writeUint8Array(q);let X=H.length+j+q.length;return Object.assign(O,{compressedSize:j,lastModDate:B,rawLastModDate:k,creationDate:u,lastAccessDate:l,encrypted:P,length:X}),O}async function Vpt(e,t,i){let n=e.writer,r=e.files,o=0,a=0,s=e.offset,l=r.size;for(let[,e]of r)a+=46+e.rawFilename.length+e.rawComment.length+e.rawExtraFieldZip64.length+e.rawExtraFieldAES.length+e.rawExtraFieldExtendedTimestamp.length+e.rawExtraFieldNTFS.length+e.rawExtraField.length;let u=i.zip64||e.options.zip64||!1;if(s>=4294967295||a>=4294967295||l>=65535){if(!1===i.zip64||!1===e.options.zip64)throw new Error(qq);u=!0}let c=new Uint8Array(a+(u?98:22)),h=Gd(c);if(t&&t.length){if(!(t.length<=65535))throw new Error(Ppt);Xo(h,o+20,t.length)}for(let[e,t]of Array.from(r.values()).entries()){let n,a,{rawFilename:s,rawExtraFieldZip64:l,rawExtraFieldAES:u,rawExtraField:d,rawComment:p,versionMadeBy:f,headerArray:m,directory:_,zip64:g,msDosCompatible:y,internalFileAttribute:v,externalFileAttribute:b}=t;if(t.extendedTimestamp){a=t.rawExtraFieldNTFS,n=new Uint8Array(9);let e=Gd(n);Xo(e,0,21589),Xo(e,2,n.length-4),Jz(e,4,1),co(e,5,Math.floor(t.lastModDate.getTime()/1e3))}else a=n=new Uint8Array(0);let A=l.length+u.length+n.length+a.length+d.length;if(co(h,o,33639248),Xo(h,o+4,f),Qs(c,m,o+6),Xo(h,o+30,A),Xo(h,o+32,p.length),co(h,o+34,v),b?co(h,o+38,b):_&&y&&Jz(h,o+38,16),co(h,o+42,g?4294967295:t.offset),Qs(c,s,o+46),Qs(c,l,o+46+s.length),Qs(c,u,o+46+s.length+l.length),Qs(c,n,o+46+s.length+l.length+u.length),Qs(c,a,o+46+s.length+l.length+u.length+n.length),Qs(c,d,o+46+s.length+l.length+u.length+n.length+a.length),Qs(c,p,o+46+s.length+A),o+=46+s.length+A+p.length,i.onprogress)try{i.onprogress(e+1,r.size,new Qp(t))}catch{}}u&&(co(h,o,101075792),bl(h,o+4,BigInt(44)),Xo(h,o+12,45),Xo(h,o+14,45),bl(h,o+24,BigInt(l)),bl(h,o+32,BigInt(l)),bl(h,o+40,BigInt(a)),bl(h,o+48,BigInt(s)),co(h,o+56,117853008),bl(h,o+64,BigInt(s)+BigInt(a)),co(h,o+72,1),l=65535,s=4294967295,a=4294967295,o+=76),co(h,o,101010256),Xo(h,o+8,l),Xo(h,o+10,l),co(h,o+12,a),co(h,o+16,s),await n.writeUint8Array(c),t&&t.length&&await n.writeUint8Array(t)}function xye(e,t,i){if(e.arrayBuffer)return t||i?e.slice(t,i).arrayBuffer():e.arrayBuffer();{let n=new FileReader;return new Promise(((r,o)=>{n.onload=e=>r(e.target.result),n.onerror=()=>o(n.error),n.readAsArrayBuffer(t||i?e.slice(t,i):e)}))}}async function Upt(e,t,i=0){await async function n(){if(i<t.size){let r=await xye(t,i,i+536870912);await e.writeUint8Array(new Uint8Array(r)),i+=536870912,await n()}}()}function jq(e){if(e)return(BigInt(e.getTime())+BigInt(116444736e5))*BigInt(1e4)}function ga(e,t,i){return void 0===t[i]?e.options[i]:t[i]}function zpt(e){return e+5*(Math.floor(e/16383)+1)}function Jz(e,t,i){e.setUint8(t,i)}function Xo(e,t,i){e.setUint16(t,i,!0)}function co(e,t,i){e.setUint32(t,i,!0)}function bl(e,t,i){e.setBigUint64(t,i,!0)}function Qs(e,t,i){e.set(t,i)}function Gd(e){return new DataView(e.buffer)}SE({Deflate:fge,Inflate:Mge});var Yq=32,Hpt="http://www.opengis.net/kml/2.2",jd="http://www.google.com/kml/ext/2.2",Gpt="http://www.w3.org/2000/xmlns/";function e4(e){this._files={},this._promises=[],this._count=0,this._modelCallback=e}var Wpt=/^data:image\/([^,;]+)/;function jpt(e,t){return function(i){e._files[t]=i}}function t4(e){this._time=e}function Xq(){this._ids={},this._styles={},this._count=0}function Cye(){this._ids={}}function Kq(e){let t=(e=y(e,y.EMPTY_OBJECT)).entities,i=y(e.kmz,!1),n=Kq._createState(e),r=t.values.filter((function(e){return!u(e.parent)})),o=n.kmlDoc,a=o.documentElement;a.setAttributeNS(Gpt,"xmlns:gx",jd);let s=o.createElement("Document");a.appendChild(s),Sye(n,s,r),n.styleCache.save(s);let l=n.externalFileHandler;return l.promise.then((function(){let e=(new XMLSerializer).serializeToString(n.kmlDoc);return i?qpt(e,l.files):{kml:e,externalFiles:l.files}}))}function qpt(e,t){let i=$t("ThirdParty/Workers/z-worker-pako.js");SE({workerScripts:{deflate:[i,"./pako_deflate.min.js"],inflate:[i,"./pako_inflate.min.js"]}});let n=new PE,r=new Qz(n);return r.add("doc.kml",new Bz(e)).then((function(){let e=Object.keys(t);return Eye(r,e,t,0)})).then((function(){return r.close()})).then((function(e){return{kmz:e}}))}function Eye(e,t,i,n){if(t.length===n)return;let r=t[n];return e.add(r,new nb(i[r])).then((function(){return Eye(e,t,i,n+1)}))}function Sye(e,t,i){let n,r,o,a=e.kmlDoc,s=e.styleCache,l=e.valueGetter,c=e.idManager,h=i.length;for(let d=0;d<h;++d){let h=i[d];n=[],r=[],o=[],Ypt(e,h,r,o),Xpt(e,h.polyline,r,o),Aye(e,h.rectangle,r,o,n),Aye(e,h.polygon,r,o,n),Qpt(e,h,h.model,r,o);let p,f=h.availability;u(f)&&(p=a.createElement("TimeSpan"),J.equals(f.start,ze.MINIMUM_VALUE)||p.appendChild(fn(a,"begin",J.toIso8601(f.start))),J.equals(f.stop,ze.MAXIMUM_VALUE)||p.appendChild(fn(a,"end",J.toIso8601(f.stop))));for(let e=0;e<n.length;++e){let i=n[e];i.setAttribute("id",c.get(h.id)),i.appendChild(fn(a,"name",h.name)),i.appendChild(fn(a,"visibility",h.show)),i.appendChild(fn(a,"description",h.description)),u(p)&&i.appendChild(p),t.appendChild(i)}let m=r.length;if(m>0){let e=a.createElement("Placemark");e.setAttribute("id",c.get(h.id));let i=h.name,n=h.label;if(u(n)){let e=a.createElement("LabelStyle"),t=l.get(n.text);i=u(t)&&t.length>0?t:i;let r=l.getColor(n.fillColor);u(r)&&(e.appendChild(fn(a,"color",r)),e.appendChild(fn(a,"colorMode","normal")));let s=l.get(n.scale);u(s)&&e.appendChild(fn(a,"scale",s)),o.push(e)}e.appendChild(fn(a,"name",i)),e.appendChild(fn(a,"visibility",h.show)),e.appendChild(fn(a,"description",h.description)),u(p)&&e.appendChild(p),t.appendChild(e);let d=o.length;if(d>0){let t=a.createElement("Style");for(let e=0;e<d;++e)t.appendChild(o[e]);e.appendChild(fn(a,"styleUrl",s.get(t)))}if(1===r.length)e.appendChild(r[0]);else if(r.length>1){let t=a.createElement("MultiGeometry");for(let e=0;e<m;++e)t.appendChild(r[e]);e.appendChild(t)}}let _=h._children;if(_.length>0){let i=a.createElement("Folder");i.setAttribute("id",c.get(h.id)),i.appendChild(fn(a,"name",h.name)),i.appendChild(fn(a,"visibility",h.show)),i.appendChild(fn(a,"description",h.description)),t.appendChild(i),Sye(e,i,_)}}}e4.prototype.texture=function(e){let t,i=this;if("string"==typeof e||e instanceof ve){if(!(e=ve.createIfNeeded(e)).isDataUri)return e.url;let n=e.url.match(Wpt);t="texture_"+ ++this._count,u(n)&&(t+=`.${n[1]}`);let r=e.fetchBlob().then((function(e){i._files[t]=e}));return this._promises.push(r),t}if(e instanceof HTMLCanvasElement){t=`texture_${++this._count}.png`;let n=new Promise((n=>{e.toBlob((function(e){i._files[t]=e,n()}))}));return this._promises.push(n),t}return""},e4.prototype.model=function(e,t){let i=this._modelCallback;if(!u(i))throw new ue("Encountered a model entity while exporting to KML, but no model callback was supplied.");let n={},r=i(e,t,n);for(let e in n)if(n.hasOwnProperty(e)){let t=Promise.resolve(n[e]);this._promises.push(t),t.then(jpt(this,e))}return r},Object.defineProperties(e4.prototype,{promise:{get:function(){return Promise.all(this._promises)}},files:{get:function(){return this._files}}}),t4.prototype.get=function(e,t,i){let n;return u(e)&&(n=u(e.getValue)?e.getValue(this._time,i):e),y(n,t)},t4.prototype.getColor=function(e,t){let i=this.get(e,t);if(u(i))return ob(i)},t4.prototype.getMaterialType=function(e){if(u(e))return e.getType(this._time)},Xq.prototype.get=function(e){let t=this._ids,i=e.innerHTML;if(u(t[i]))return t[i];let n="style-"+ ++this._count;return e.setAttribute("id",n),n=`#${n}`,t[i]=n,this._styles[i]=e,n},Xq.prototype.save=function(e){let t=this._styles,i=e.childNodes[0];for(let n in t)t.hasOwnProperty(n)&&e.insertBefore(t[n],i)},Cye.prototype.get=function(e){if(!u(e))return this.get(jn());let t=this._ids;return u(t[e])?`${e.toString()}-${++t[e]}`:(t[e]=0,e)},Kq._createState=function(e){let t=e.entities,i=new Xq,n=t.computeAvailability(),r=u(e.time)?e.time:n.start,o=y(e.defaultAvailability,n),a=y(e.sampleDuration,60);o.start===ze.MINIMUM_VALUE?o.stop===ze.MAXIMUM_VALUE?o=new Cn:J.addSeconds(o.stop,-10*a,o.start):o.stop===ze.MAXIMUM_VALUE&&J.addSeconds(o.start,10*a,o.stop);let s=new e4(e.modelCallback);return{kmlDoc:document.implementation.createDocument(Hpt,"kml"),ellipsoid:y(e.ellipsoid,ie.WGS84),idManager:new Cye,styleCache:i,externalFileHandler:s,time:r,valueGetter:new t4(r),sampleDuration:a,defaultAvailability:new Mr([o])}};var Tl=new h,Mc=new fe,Wd=new J;function Ypt(e,t,i,n){let r=e.kmlDoc,o=e.ellipsoid,a=e.valueGetter,s=y(t.billboard,t.point);if(!u(s)&&!u(t.path))return;let l=t.position;if(!l.isConstant)return void wye(e,t,s,i,n);a.get(l,void 0,Tl);let c=fn(r,"coordinates",ib(Tl,o)),h=r.createElement("Point"),d=r.createElement("altitudeMode");d.appendChild(rb(e,s.heightReference)),h.appendChild(d),h.appendChild(c),i.push(h);let p=s instanceof Sc?Dye(e,s):vye(e,s);n.push(p)}function wye(e,t,i,n,r){let o,a=e.kmlDoc,s=e.ellipsoid,l=e.valueGetter,c=t.position,d=!0;c instanceof ma?(o=c.intervals,d=!1):o=y(t.availability,e.defaultAvailability);let p,f,m,_=i instanceof oy,g=[];for(p=0;p<o.length;++p){let t=o.get(p),n=d?c:t.data,r=a.createElement("altitudeMode");n instanceof $p?(n=n._value,r.appendChild(rb(e,We.CLAMP_TO_GROUND))):u(i)?r.appendChild(rb(e,i.heightReference)):r.appendChild(rb(e,We.NONE));let y=[],v=[];if(n.isConstant){l.get(n,void 0,Tl);let e=fn(a,"coordinates",ib(Tl,s));y.push(J.toIso8601(t.start)),v.push(e),y.push(J.toIso8601(t.stop)),v.push(e)}else if(n instanceof pa)for(m=n._property._times,f=0;f<m.length;++f)y.push(J.toIso8601(m[f])),n.getValueInReferenceFrame(m[f],to.FIXED,Tl),v.push(ib(Tl,s));else if(n instanceof Tf){m=n._times;let e=n._values;for(f=0;f<m.length;++f)y.push(J.toIso8601(m[f])),h.fromArray(e,3*f,Tl),v.push(ib(Tl,s))}else{let i=e.sampleDuration;t.start.clone(Wd),t.isStartIncluded||J.addSeconds(Wd,i,Wd);let r=t.stop;for(;J.lessThan(Wd,r);)n.getValue(Wd,Tl),y.push(J.toIso8601(Wd)),v.push(ib(Tl,s)),J.addSeconds(Wd,i,Wd);t.isStopIncluded&&J.equals(Wd,r)&&(n.getValue(Wd,Tl),y.push(J.toIso8601(Wd)),v.push(ib(Tl,s)))}let b=a.createElementNS(jd,"Track");b.appendChild(r);for(let e=0;e<y.length;++e){let t=fn(a,"when",y[e]),i=fn(a,"coord",v[e],jd);b.appendChild(t),b.appendChild(i)}_&&b.appendChild(Iye(e,i)),g.push(b)}if(1===g.length)n.push(g[0]);else if(g.length>1){let e=a.createElementNS(jd,"MultiTrack");for(p=0;p<g.length;++p)e.appendChild(g[p]);n.push(e)}if(u(i)&&!_){let t=i instanceof Sc?Dye(e,i):vye(e,i);r.push(t)}let v=t.path;if(u(v)){let t=l.get(v.width),i=v.material;if(u(i)||u(t)){let n=a.createElement("LineStyle");u(t)&&n.appendChild(fn(a,"width",t)),Zq(e,i,n),r.push(n)}}}function vye(e,t){let i=e.kmlDoc,n=e.valueGetter,r=i.createElement("IconStyle"),o=n.getColor(t.color);u(o)&&(r.appendChild(fn(i,"color",o)),r.appendChild(fn(i,"colorMode","normal")));let a=n.get(t.pixelSize);return u(a)&&r.appendChild(fn(i,"scale",a/Yq)),r}function Dye(e,t){let i=e.kmlDoc,n=e.valueGetter,r=e.externalFileHandler,o=i.createElement("IconStyle"),a=n.get(t.image);if(u(a)){a=r.texture(a);let e=i.createElement("Icon");e.appendChild(fn(i,"href",a));let s=n.get(t.imageSubRegion);u(s)&&(e.appendChild(fn(i,"x",s.x,jd)),e.appendChild(fn(i,"y",s.y,jd)),e.appendChild(fn(i,"w",s.width,jd)),e.appendChild(fn(i,"h",s.height,jd))),o.appendChild(e)}let s=n.getColor(t.color);u(s)&&(o.appendChild(fn(i,"color",s)),o.appendChild(fn(i,"colorMode","normal")));let l=n.get(t.scale);u(l)&&o.appendChild(fn(i,"scale",l));let c=n.get(t.pixelOffset);if(u(c)){l=y(l,1),U.divideByScalar(c,l,c);let e=n.get(t.width,Yq),r=n.get(t.height,Yq),a=n.get(t.horizontalOrigin,yi.CENTER);a===yi.CENTER?c.x-=.5*e:a===yi.RIGHT&&(c.x-=e);let s=n.get(t.verticalOrigin,On.CENTER);s===On.TOP?c.y+=r:s===On.CENTER&&(c.y+=.5*r);let u=i.createElement("hotSpot");u.setAttribute("x",-c.x),u.setAttribute("y",c.y),u.setAttribute("xunits","pixels"),u.setAttribute("yunits","pixels"),o.appendChild(u)}let d=n.get(t.rotation),p=n.get(t.alignedAxis);return u(d)&&h.equals(h.UNIT_Z,p)&&(d=P.toDegrees(-d),0===d&&(d=360),o.appendChild(fn(i,"heading",d))),o}function Xpt(e,t,i,n){let r=e.kmlDoc,o=e.ellipsoid,a=e.valueGetter;if(!u(t))return;let s,l=r.createElement("LineString"),c=r.createElement("altitudeMode"),h=a.get(t.clampToGround,!1);h?(l.appendChild(fn(r,"tessellate",!0)),s=r.createTextNode("clampToGround")):s=r.createTextNode("absolute"),c.appendChild(s),l.appendChild(c);let d=t.positions,p=fn(r,"coordinates",ib(a.get(d),o));l.appendChild(p);let f=a.get(t.zIndex);h&&u(f)&&l.appendChild(fn(r,"drawOrder",f,jd)),i.push(l);let m=r.createElement("LineStyle"),_=a.get(t.width);u(_)&&m.appendChild(fn(r,"width",_)),Zq(e,t.material,m),n.push(m)}function Kpt(e,t,i){let n=e.kmlDoc,r=e.valueGetter,o=r.get(t.height,0);i>0&&(o=i);let a=t.coordinates,s=r.get(a),l=[],u=[ce.northeast,ce.southeast,ce.southwest,ce.northwest];for(let e=0;e<4;++e)u[e](s,Mc),l.push(`${P.toDegrees(Mc.longitude)},${P.toDegrees(Mc.latitude)},${o}`);let c=fn(n,"coordinates",l.join(" ")),h=n.createElement("outerBoundaryIs"),d=n.createElement("LinearRing");return d.appendChild(c),h.appendChild(d),[h]}function Tye(e,t,i,n){let r=e.kmlDoc,o=e.ellipsoid,a=[],s=t.length;for(let e=0;e<s;++e)fe.fromCartesian(t[e],o,Mc),a.push(`${P.toDegrees(Mc.longitude)},${P.toDegrees(Mc.latitude)},${n?Mc.height:i}`);let l=fn(r,"coordinates",a.join(" ")),u=r.createElement("LinearRing");return u.appendChild(l),u}function Zpt(e,t,i){let n=e.kmlDoc,r=e.valueGetter,o=r.get(t.height,0),a=r.get(t.perPositionHeight,!1);!a&&i>0&&(o=i);let s=[],l=t.hierarchy,c=r.get(l),h=Array.isArray(c)?c:c.positions,d=n.createElement("outerBoundaryIs");d.appendChild(Tye(e,h,o,a)),s.push(d);let p=c.holes;if(u(p)){let t=p.length;for(let i=0;i<t;++i){let t=n.createElement("innerBoundaryIs");t.appendChild(Tye(e,p[i].positions,o,a)),s.push(t)}}return s}function Aye(e,t,i,n,r){let o=e.kmlDoc,a=e.valueGetter;if(!u(t))return;let s=t instanceof am;if(s&&"Image"===a.getMaterialType(t.material))return void $pt(e,t,r);let l=o.createElement("Polygon"),c=a.get(t.extrudedHeight,0);c>0&&l.appendChild(fn(o,"extrude",!0));let h=s?Kpt(e,t,c):Zpt(e,t,c),d=h.length;for(let e=0;e<d;++e)l.appendChild(h[e]);let p=o.createElement("altitudeMode");p.appendChild(rb(e,t.heightReference)),l.appendChild(p),i.push(l);let f=o.createElement("PolyStyle"),m=a.get(t.fill,!1);m&&f.appendChild(fn(o,"fill",m)),Zq(e,t.material,f);let _=a.get(t.outline,!1);if(_){f.appendChild(fn(o,"outline",_));let e=o.createElement("LineStyle"),i=a.get(t.outlineWidth,1);e.appendChild(fn(o,"width",i));let r=a.getColor(t.outlineColor,z.BLACK);e.appendChild(fn(o,"color",r)),e.appendChild(fn(o,"colorMode","normal")),n.push(e)}n.push(f)}function $pt(e,t,i){let n=e.kmlDoc,r=e.valueGetter,o=e.externalFileHandler,a=n.createElement("GroundOverlay"),s=n.createElement("altitudeMode");s.appendChild(rb(e,t.heightReference)),a.appendChild(s);let l=r.get(t.height);u(l)&&a.appendChild(fn(n,"altitude",l));let c=r.get(t.coordinates),h=n.createElement("LatLonBox");h.appendChild(fn(n,"north",P.toDegrees(c.north))),h.appendChild(fn(n,"south",P.toDegrees(c.south))),h.appendChild(fn(n,"east",P.toDegrees(c.east))),h.appendChild(fn(n,"west",P.toDegrees(c.west))),a.appendChild(h);let d=r.get(t.material),p=o.texture(d.image),f=n.createElement("Icon");f.appendChild(fn(n,"href",p)),a.appendChild(f);let m=d.color;u(m)&&a.appendChild(fn(n,"color",ob(d.color))),i.push(a)}function Iye(e,t){let i=e.kmlDoc,n=e.valueGetter,r=e.externalFileHandler,o=i.createElement("Model"),a=n.get(t.scale);if(u(a)){let e=i.createElement("scale");e.appendChild(fn(i,"x",a)),e.appendChild(fn(i,"y",a)),e.appendChild(fn(i,"z",a)),o.appendChild(e)}let s=i.createElement("Link"),l=r.model(t,e.time);return s.appendChild(fn(i,"href",l)),o.appendChild(s),o}function Qpt(e,t,i,n,r){let o=e.kmlDoc,a=e.ellipsoid,s=e.valueGetter;if(!u(i))return;let l=t.position;if(!l.isConstant)return void wye(e,t,i,n,r);let c=Iye(e,i),h=o.createElement("altitudeMode");h.appendChild(rb(e,i.heightReference)),c.appendChild(h),s.get(l,void 0,Tl),fe.fromCartesian(Tl,a,Mc);let d=o.createElement("Location");d.appendChild(fn(o,"longitude",P.toDegrees(Mc.longitude))),d.appendChild(fn(o,"latitude",P.toDegrees(Mc.latitude))),d.appendChild(fn(o,"altitude",Mc.height)),c.appendChild(d),n.push(c)}function Zq(e,t,i){let n=e.kmlDoc,r=e.valueGetter;if(!u(t))return;let o,a,s,l=r.get(t);if(u(l)){switch(r.getMaterialType(t)){case"Image":o=ob(z.WHITE);break;case"Color":case"Grid":case"PolylineGlow":case"PolylineArrow":case"PolylineDash":o=ob(l.color);break;case"PolylineOutline":o=ob(l.color),a=ob(l.outlineColor),s=l.outlineWidth,i.appendChild(fn(n,"outerColor",a,jd)),i.appendChild(fn(n,"outerWidth",s,jd));break;case"Stripe":o=ob(l.oddColor)}u(o)&&(i.appendChild(fn(n,"color",o)),i.appendChild(fn(n,"colorMode","normal")))}}function rb(e,t){let i,n=e.kmlDoc;switch(e.valueGetter.get(t,We.NONE)){case We.NONE:i=n.createTextNode("absolute");break;case We.CLAMP_TO_GROUND:i=n.createTextNode("clampToGround");break;case We.RELATIVE_TO_GROUND:i=n.createTextNode("relativeToGround")}return i}function ib(e,t){Array.isArray(e)||(e=[e]);let i=e.length,n=[];for(let r=0;r<i;++r)fe.fromCartesian(e[r],t,Mc),n.push(`${P.toDegrees(Mc.longitude)},${P.toDegrees(Mc.latitude)},${Mc.height}`);return n.join(" ")}function fn(e,t,i,n){"boolean"==typeof(i=y(i,""))&&(i=i?"1":"0");let r=u(n)?e.createElementNS(n,t):e.createElement(t),o="string"===i&&-1!==i.indexOf("<")?e.createCDATASection(i):e.createTextNode(i);return r.appendChild(o),r}function ob(e){let t="",i=e.toBytes();for(let e=3;e>=0;--e)t+=i[e]<16?`0${i[e].toString(16)}`:i[e].toString(16);return t}var Pye=Kq;function $q(e){return e}function n4(e){if(null==e)return $q;var t,i,n=e.scale[0],r=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=i=0);var l=2,u=e.length,c=new Array(u);for(c[0]=(t+=e[0])*n+o,c[1]=(i+=e[1])*r+a;l<u;)c[l]=e[l],++l;return c}}function Oye(e,t){for(var i,n=e.length,r=n-t;r<--n;)i=e[r],e[r++]=e[n],e[n]=i}function Qq(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return Rye(e,t)}))}:Rye(e,t)}function Rye(e,t){var i=t.id,n=t.bbox,r=null==t.properties?{}:t.properties,o=Jq(e,t);return null==i&&null==n?{type:"Feature",properties:r,geometry:o}:null==n?{type:"Feature",id:i,properties:r,geometry:o}:{type:"Feature",id:i,bbox:n,properties:r,geometry:o}}function Jq(e,t){var i=n4(e.transform),n=e.arcs;function r(e,t){t.length&&t.pop();for(var r=n[e<0?~e:e],o=0,a=r.length;o<a;++o)t.push(i(r[o],o));e<0&&Oye(t,a)}function o(e){return i(e)}function a(e){for(var t=[],i=0,n=e.length;i<n;++i)r(e[i],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=a(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(s)}return function e(t){var i,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(e)};case"Point":i=o(t.coordinates);break;case"MultiPoint":i=t.coordinates.map(o);break;case"LineString":i=a(t.arcs);break;case"MultiLineString":i=t.arcs.map(a);break;case"Polygon":i=l(t.arcs);break;case"MultiPolygon":i=t.arcs.map(l);break;default:return null}return{type:n,coordinates:i}}(t)}function i4(e){return h.fromDegrees(e[0],e[1],e[2])}var eY={"urn:ogc:def:crs:OGC:1.3:CRS84":i4,"EPSG:4326":i4,"urn:ogc:def:crs:EPSG::4326":i4},Mye={},Lye={},tY=48,nY,iY=z.ROYALBLUE,oY=z.YELLOW,rY=2,sY=z.fromBytes(255,255,0,100),aY=!1,i_t={small:24,medium:48,large:64},o_t=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function Nye(e,t){let i="";for(let n in e)if(e.hasOwnProperty(n)){if(n===t||-1!==o_t.indexOf(n))continue;let r=e[n];u(r)&&(i+="object"==typeof r?`<tr><th>${n}</th><td>${Nye(r)}</td></tr>`:`<tr><th>${n}</th><td>${r}</td></tr>`)}return i.length>0&&(i=`<table class="cesium-infoBox-defaultTable"><tbody>${i}</tbody></table>`),i}function r_t(e,t,i){let n;return function(r,o){return u(n)||(n=e(t,i)),n}}function s_t(e,t){return new lm(r_t(Nye,e,t),!0)}function o4(e,t,i){let n=e.id;if(u(n)&&"Feature"===e.type){let e=2,i=n;for(;u(t.getById(i));)i=`${n}_${e}`,e++;n=i}else n=jn();let r=t.getOrCreateEntity(n),o=e.properties;if(u(o)){r.properties=o;let e,t=o.title;if(u(t))r.name=t,e="title";else{let t=Number.MAX_VALUE;for(let i in o)if(o.hasOwnProperty(i)&&o[i]){let n=i.toLowerCase();if(t>1&&"title"===n){t=1,e=i;break}t>2&&"name"===n?(t=2,e=i):t>3&&/title/i.test(i)?(t=3,e=i):t>4&&/name/i.test(i)&&(t=4,e=i)}u(e)&&(r.name=o[e])}let n=o.description;null!==n&&(r.description=u(n)?new Zn(n):i(o,e))}return r}function cY(e,t){let i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=t(e[n]);return i}var Fye={Feature:kye,FeatureCollection:a_t,GeometryCollection:Vye,LineString:Wye,MultiLineString:jye,MultiPoint:Hye,MultiPolygon:Xye,Point:zye,Polygon:Yye,Topology:Kye},Bye={GeometryCollection:Vye,LineString:Wye,MultiLineString:jye,MultiPoint:Hye,MultiPolygon:Xye,Point:zye,Polygon:Yye,Topology:Kye};function kye(e,t,i,n,r){if(null===t.geometry)return void o4(t,e._entityCollection,r.describe);if(!u(t.geometry))throw new ue("feature.geometry is required.");let o=t.geometry.type,a=Bye[o];if(!u(a))throw new ue(`Unknown geometry type: ${o}`);a(e,t,t.geometry,n,r)}function a_t(e,t,i,n,r){let o=t.features;for(let t=0,i=o.length;t<i;t++)kye(e,o[t],void 0,n,r)}function Vye(e,t,i,n,r){let o=i.geometries;for(let i=0,a=o.length;i<a;i++){let a=o[i],s=a.type,l=Bye[s];if(!u(l))throw new ue(`Unknown geometry type: ${s}`);l(e,t,a,n,r)}}function Uye(e,t,i,n,r){let o,a=r.markerSymbol,s=r.markerColor,l=r.markerSize,c=t.properties;if(u(c)){let e=c["marker-color"];u(e)&&(s=z.fromCssColorString(e)),l=y(i_t[c["marker-size"]],l);let t=c["marker-symbol"];u(t)&&(a=t)}o=u(a)?1===a.length?e._pinBuilder.fromText(a.toUpperCase(),s,l):e._pinBuilder.fromMakiIconId(a,s,l):e._pinBuilder.fromColor(s,l);let h=new Sc;h.verticalOrigin=new Zn(On.BOTTOM),2===n.length&&r.clampToGround&&(h.heightReference=We.CLAMP_TO_GROUND);let d=o4(t,e._entityCollection,r.describe);d.billboard=h,d.position=new gl(i(n));let p=Promise.resolve(o).then((function(e){h.image=new Zn(e)})).catch((function(){h.image=new Zn(e._pinBuilder.fromColor(s,l))}));e._promises.push(p)}function zye(e,t,i,n,r){Uye(e,t,n,i.coordinates,r)}function Hye(e,t,i,n,r){let o=i.coordinates;for(let i=0;i<o.length;i++)Uye(e,t,n,o[i],r)}function Gye(e,t,i,n,r){let o=r.strokeMaterialProperty,a=r.strokeWidthProperty,s=t.properties;if(u(s)){let e=s["stroke-width"];u(e)&&(a=new Zn(e));let t,i=s.stroke;u(i)&&(t=z.fromCssColorString(i));let n=s["stroke-opacity"];u(n)&&1!==n&&(u(t)||(t=o.color.getValue().clone()),t.alpha=n),u(t)&&(o=new Nt(t))}let l=o4(t,e._entityCollection,r.describe),c=new wc;l.polyline=c,c.clampToGround=r.clampToGround,c.material=o,c.width=a,c.positions=new Zn(cY(n,i)),c.arcType=Yt.RHUMB}function Wye(e,t,i,n,r){Gye(e,t,n,i.coordinates,r)}function jye(e,t,i,n,r){let o=i.coordinates;for(let i=0;i<o.length;i++)Gye(e,t,n,o[i],r)}function qye(e,t,i,n,r){if(0===n.length||0===n[0].length)return;let o=r.strokeMaterialProperty.color,a=r.fillMaterialProperty,s=r.strokeWidthProperty,l=t.properties;if(u(l)){let e=l["stroke-width"];u(e)&&(s=new Zn(e));let t,i=l.stroke;u(i)&&(t=z.fromCssColorString(i));let n=l["stroke-opacity"];u(n)&&1!==n&&(u(t)||(t=o.getValue().clone()),t.alpha=n),u(t)&&(o=new Zn(t));let r,c=l.fill,h=a.color.getValue();u(c)&&(r=z.fromCssColorString(c),r.alpha=h.alpha),n=l["fill-opacity"],u(n)&&n!==h.alpha&&(u(r)||(r=h.clone()),r.alpha=n),u(r)&&(a=new Nt(r))}let c=new sm;c.outline=new Zn(!0),c.outlineColor=o,c.outlineWidth=s,c.material=a,c.arcType=Yt.RHUMB;let h=[];for(let e=1,t=n.length;e<t;e++)h.push(new Pa(cY(n[e],i)));let d=n[0];c.hierarchy=new Zn(new Pa(cY(d,i),h)),d[0].length>2?c.perPositionHeight=new Zn(!0):r.clampToGround||(c.height=0),o4(t,e._entityCollection,r.describe).polygon=c}function Yye(e,t,i,n,r){qye(e,t,n,i.coordinates,r)}function Xye(e,t,i,n,r){let o=i.coordinates;for(let i=0;i<o.length;i++)qye(e,t,n,o[i],r)}function Kye(e,t,i,n,r){for(let t in i.objects)if(i.objects.hasOwnProperty(t)){let o=Qq(i,i.objects[t]);(0,Fye[o.type])(e,o,o,n,r)}}function Dy(e){this._name=e,this._changed=new pe,this._error=new pe,this._isLoading=!1,this._loading=new pe,this._entityCollection=new Ks(this),this._promises=[],this._pinBuilder=new F_,this._entityCluster=new bf,this._credit=void 0,this._resourceCredits=[]}function Zye(e,t,i,n){Nr.setLoading(e,!0);let r=(i=y(i,y.EMPTY_OBJECT)).credit;"string"==typeof r&&(r=new xt(r)),e._credit=r;let o=t,a=i.sourceUri;if("string"==typeof t||t instanceof ve){o=(t=ve.createIfNeeded(t)).fetchJson(),a=y(a,t.getUrlComponent());let i=e._resourceCredits,n=t.credits;if(u(n)){let e=n.length;for(let t=0;t<e;t++)i.push(n[t])}}return i={describe:y(i.describe,s_t),markerSize:y(i.markerSize,tY),markerSymbol:y(i.markerSymbol,nY),markerColor:y(i.markerColor,iY),strokeWidthProperty:new Zn(y(i.strokeWidth,rY)),strokeMaterialProperty:new Nt(y(i.stroke,oY)),fillMaterialProperty:new Nt(y(i.fill,sY)),clampToGround:y(i.clampToGround,aY)},Promise.resolve(o).then((function(t){return c_t(e,t,i,a,n)})).catch((function(t){throw Nr.setLoading(e,!1),e._error.raiseEvent(e,t),t}))}function c_t(e,t,i,n,r){let o;u(n)&&(o=P_(n)),u(o)&&e._name!==o&&(e._name=o,e._changed.raiseEvent(e));let a=Fye[t.type];if(!u(a))throw new ue(`Unsupported GeoJSON object type: ${t.type}`);let s=t.crs,l=null!==s?i4:null;if(u(s)){if(!u(s.properties))throw new ue("crs.properties is undefined.");let e=s.properties;if("name"===s.type){if(l=eY[e.name],!u(l))throw new ue(`Unknown crs name: ${e.name}`)}else if("link"===s.type){let t=Mye[e.href];if(u(t)||(t=Lye[e.type]),!u(t))throw new ue(`Unable to resolve crs link: ${JSON.stringify(e)}`);l=t(e)}else{if("EPSG"!==s.type)throw new ue(`Unknown crs type: ${s.type}`);if(l=eY[`EPSG:${e.code}`],!u(l))throw new ue(`Unknown crs EPSG code: ${e.code}`)}}return Promise.resolve(l).then((function(n){return r&&e._entityCollection.removeAll(),null!==n&&a(e,t,t,n,i),Promise.all(e._promises).then((function(){return e._promises.length=0,Nr.setLoading(e,!1),e}))}))}Dy.load=function(e,t){return(new Dy).load(e,t)},Object.defineProperties(Dy,{markerSize:{get:function(){return tY},set:function(e){tY=e}},markerSymbol:{get:function(){return nY},set:function(e){nY=e}},markerColor:{get:function(){return iY},set:function(e){iY=e}},stroke:{get:function(){return oY},set:function(e){oY=e}},strokeWidth:{get:function(){return rY},set:function(e){rY=e}},fill:{get:function(){return sY},set:function(e){sY=e}},clampToGround:{get:function(){return aY},set:function(e){aY=e}},crsNames:{get:function(){return eY}},crsLinkHrefs:{get:function(){return Mye}},crsLinkTypes:{get:function(){return Lye}}}),Object.defineProperties(Dy.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}}}),Dy.prototype.load=function(e,t){return Zye(this,e,t,!0)},Dy.prototype.process=function(e,t){return Zye(this,e,t,!1)},Dy.prototype.update=function(e){return!0};var r4=Dy,$ye="4.0.0";function l_t(e){return void 0===e}function yu(e){return"boolean"==typeof e}function Qye(e,t){for(var i in t)t.hasOwnProperty(i)&&l_t(e[i])&&(e[i]=t[i]);return e}function Jye(e,t,i){var n;return e.length>t&&(null==i?(i="&hellip;",n=3):n=i.length,e=e.substring(0,t-n)+i),e}function Ro(e,t){for(var i=e.length-1;i>=0;i--)e[i]===t&&e.splice(i,1)}function Iy(e,t){for(var i=e.length-1;i>=0;i--)!0===t(e[i])&&e.splice(i,1)}function Py(e){throw new Error("Unhandled case for value: '".concat(e,"'"))}var Oy=/[A-Za-z]/,ws=/[\d]/,xu=/\s/,s4=/['"]/,e0e=/[\x00-\x1F\x7F]/,t0e=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,u_t=/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source,f_t=/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,d_t=t0e+u_t+f_t,n0e=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,Ovi=new RegExp("[".concat(t0e+n0e,"]")),lY=d_t+n0e,qd=new RegExp("[".concat(lY,"]")),a4=function(){function e(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return e.prototype.setTagName=function(e){return this.tagName=e,this},e.prototype.getTagName=function(){return this.tagName||""},e.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},e.prototype.getAttr=function(e){return this.getAttrs()[e]},e.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},e.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},e.prototype.setClass=function(e){return this.setAttr("class",e)},e.prototype.addClass=function(e){for(var t,i=this.getClass(),n=i?i.split(xu):[],r=e.split(xu);t=r.shift();)-1===n.indexOf(t)&&n.push(t);return this.getAttrs().class=n.join(" "),this},e.prototype.removeClass=function(e){for(var t,i=this.getClass(),n=i?i.split(xu):[],r=e.split(xu);n.length&&(t=r.shift());){var o=n.indexOf(t);-1!==o&&n.splice(o,1)}return this.getAttrs().class=n.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},e.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},e.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},e.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+'="'+e[i]+'"');return t.join(" ")},e}();function i0e(e,t,i){var n,r;null==i?(i="&hellip;",r=3,n=8):(r=i.length,n=i.length);var o=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},a=function(e,t){var n=t/2,r=Math.ceil(n),o=-1*Math.floor(n),a="";return o<0&&(a=e.substr(o)),e.substr(0,r)+i+a};if(e.length<=t)return e;var s,l,u,c=t-r,h=(s={},(u=(l=e).match(/^([a-z]+):\/\//i))&&(s.scheme=u[1],l=l.substr(u[0].length)),(u=l.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(s.host=u[1],l=l.substr(u[0].length)),(u=l.match(/^\/(.*?)(?=(\?|#|$))/i))&&(s.path=u[1],l=l.substr(u[0].length)),(u=l.match(/^\?(.*?)(?=(#|$))/i))&&(s.query=u[1],l=l.substr(u[0].length)),(u=l.match(/^#(.*?)$/i))&&(s.fragment=u[1]),s);if(h.query){var d=h.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);d&&(h.query=h.query.substr(0,d[1].length),e=o(h))}if(e.length<=t||(h.host&&(h.host=h.host.replace(/^www\./,""),e=o(h)),e.length<=t))return e;var p="";if(h.host&&(p+=h.host),p.length>=c)return h.host.length==t?(h.host.substr(0,t-r)+i).substr(0,c+n):a(p,c).substr(0,c+n);var f="";if(h.path&&(f+="/"+h.path),h.query&&(f+="?"+h.query),f){if((p+f).length>=c)return(p+f).length==t?(p+f).substr(0,t):(p+a(f,c-p.length)).substr(0,c+n);p+=f}if(h.fragment){var m="#"+h.fragment;if((p+m).length>=c)return(p+m).length==t?(p+m).substr(0,t):(p+a(m,c-p.length)).substr(0,c+n);p+=m}if(h.scheme&&h.host){var _=h.scheme+"://";if((p+_).length<c)return(_+p).substr(0,t)}if(p.length<=t)return p;var g="";return c>0&&(g=p.substr(-1*Math.floor(c/2))),(p.substr(0,Math.ceil(c/2))+i+g).substr(0,c+n)}function o0e(e,t,i){if(e.length<=t)return e;var n,r;null==i?(i="&hellip;",n=8,r=3):(n=i.length,r=i.length);var o=t-r,a="";return o>0&&(a=e.substr(-1*Math.floor(o/2))),(e.substr(0,Math.ceil(o/2))+i+a).substr(0,o+n)}function r0e(e,t,i){return Jye(e,t,i)}var s0e=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new a4({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},i=this.createCssClass(e);return i&&(t.class=i),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var i=[t],n=e.getCssClassSuffixes(),r=0,o=n.length;r<o;r++)i.push(t+"-"+n[r]);return i.join(" ")}return""},e.prototype.processAnchorText=function(e){return e=this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t||!t.length)return e;var i=t.length,n=t.location;return"smart"===n?i0e(e,i):"middle"===n?o0e(e,i):r0e(e,i)},e}(),uY=function(e,t){return(uY=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function gm(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}uY(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var vs=function(){return vs=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},vs.apply(this,arguments)},ym=function(){function e(e){this._=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.type]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}(),h_t="(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermgensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermgensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b||accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi||abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama||abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|||||||||abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|||||||||||||actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo||||||||||||||aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone||||||||||||||||||||||||||aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip||||||||||||||||||||||||||||||||ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||)",a0e=new RegExp("^"+h_t+"$"),m_t=/[\/?#]/,p_t=/[-+&@#/%=~_()|'$*\[\]{}\u2713]/,c0e=/[?!:,.;^]/,fY=/https?:\/\//i,l0e=new RegExp("^"+fY.source,"i"),u0e=new RegExp(c0e.source+"$"),__t=/^(javascript|vbscript):/i,g_t=/^[A-Za-z][-.+A-Za-z0-9]*:(\/\/)?([^:/]*)/,y_t=/^(?:\/\/)?([^/#?:]+)/;function c4(e){return Oy.test(e)}function dY(e){return Oy.test(e)||ws.test(e)||"+"===e||"-"===e||"."===e}function Jp(e){return qd.test(e)}function l4(e){return"_"===e||Jp(e)}function hY(e){return qd.test(e)||p_t.test(e)||c0e.test(e)}function u4(e){return m_t.test(e)}function mY(e){return a0e.test(e.toLowerCase())}function f0e(e){if(__t.test(e))return!1;var t=e.match(g_t);if(!t)return!1;var i=!!t[1],n=t[2];return!!i||!(-1===n.indexOf(".")||!Oy.test(n))}function d0e(e){var t=e.match(y_t);if(!t)return!1;var i=t[0].split(".");return!(i.length<2)&&!!mY(i[i.length-1])}var x_t=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,b_t=/[:/?#]/;function h0e(e){var t=e.split(b_t,1)[0];return x_t.test(t)}var T_t=/^(https?:\/\/)?(www\.)?/i,A_t=/^\/\//,m0e=function(e){function t(t){var i=e.call(this,t)||this;return i.type="url",i.url="",i.urlMatchType="scheme",i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.protocolPrepended=!1,i.urlMatchType=t.urlMatchType,i.url=t.url,i.protocolRelativeMatch=t.protocolRelativeMatch,i.stripPrefix=t.stripPrefix,i.stripTrailingSlash=t.stripTrailingSlash,i.decodePercentEncoding=t.decodePercentEncoding,i}return gm(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&"scheme"!==this.urlMatchType&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=S_t(e)),this.stripPrefix.scheme&&(e=C_t(e)),this.stripPrefix.www&&(e=E_t(e)),this.stripTrailingSlash&&(e=w_t(e)),this.decodePercentEncoding&&(e=v_t(e)),e},t}(ym);function C_t(e){return e.replace(l0e,"")}function E_t(e){return e.replace(T_t,"$1")}function S_t(e){return e.replace(A_t,"")}function w_t(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}function v_t(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch{return t}}var p0e=/^mailto:/i,D_t=new RegExp("[".concat(lY,"!#$%&'*+/=?^_`{|}~-]"));function _0e(e){return qd.test(e)}function f4(e){return D_t.test(e)}function g0e(e){return mY(e.split(".").pop()||"")}var y0e=function(e){function t(t){var i=e.call(this,t)||this;return i.type="email",i.email="",i.email=t.email,i}return gm(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(ym);function pY(e){return"_"===e||qd.test(e)}function x0e(e){return e.length<=140}var b0e=["twitter","facebook","instagram","tiktok"],T0e=function(e){function t(t){var i=e.call(this,t)||this;return i.type="hashtag",i.serviceName="twitter",i.hashtag="",i.serviceName=t.serviceName,i.hashtag=t.hashtag,i}return gm(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;case"tiktok":return"https://www.tiktok.com/tag/"+t;default:throw Py(e),new Error("Invalid hashtag service: ".concat(e))}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&t.push(i),t},t}(ym),I_t={twitter:/^@\w{1,15}$/,instagram:/^@[_\w]{1,30}$/,soundcloud:/^@[-a-z0-9_]{3,25}$/,tiktok:/^@[.\w]{1,23}[\w]$/},P_t=/[-\w.]/;function _Y(e){return P_t.test(e)}function A0e(e,t){return I_t[t].test(e)}var C0e=["twitter","instagram","soundcloud","tiktok"],E0e=function(e){function t(t){var i=e.call(this,t)||this;return i.type="mention",i.serviceName="twitter",i.mention="",i.mention=t.mention,i.serviceName=t.serviceName,i}return gm(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&t.push(i),t},t}(ym),O_t=/[-. ]/,R_t=/[-. ()]/,M_t=/[,;]/,L_t=/(?:(?:(?:(\+)?\d{1,3}[-. ]?)?\(?\d{3}\)?[-. ]?\d{3}[-. ]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-. ]?(?:\d[-. ]?){6,12}\d+))([,;]+[0-9]+#?)*/,N_t=/(0([1-9]-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/,F_t=new RegExp("^".concat(L_t.source,"|").concat(N_t.source,"$"));function gY(e){return O_t.test(e)}function d4(e){return M_t.test(e)}function S0e(e){return("+"===e.charAt(0)||R_t.test(e))&&F_t.test(e)}var w0e=function(e){function t(t){var i=e.call(this,t)||this;return i.type="phone",i.number="",i.plusSign=!1,i.number=t.number,i.plusSign=t.plusSign,i}return gm(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(ym);function I0e(e,t){for(var i=t.tagBuilder,n=t.stripPrefix,r=t.stripTrailingSlash,o=t.decodePercentEncoding,a=t.hashtagServiceName,s=t.mentionServiceName,l=[],u=e.length,c=[],h=0;h<u;h++){var d=e.charAt(h);if(0===c.length)g(d);else for(var p=c.length-1;p>=0;p--){var f=c[p];switch(f.state){case 11:m=f,"/"===d?m.state=12:Ro(c,m);break;case 12:E(f,d);break;case 0:y(f,d);break;case 1:v(f,d);break;case 2:b(f,d);break;case 3:A(f,d);break;case 4:T(f,d);break;case 5:C(f,d);break;case 6:x(f,d);break;case 7:S(f,d);break;case 13:w(f,d);break;case 14:I(f,d);break;case 8:P(f,d);break;case 9:D(f,d);break;case 10:O(f,d);break;case 15:L(f,d);break;case 16:R(f,d);break;case 17:N(f,d);break;case 18:M(f,d);break;case 19:F(f,d);break;case 20:B(f,d);break;case 21:z(f,d);break;case 22:U(f,d);break;case 23:k(f,d);break;case 24:V(f,d);break;case 25:H(f,d);break;case 26:G(f,d);break;case 27:j(f,d);break;case 28:W(f,d);break;case 29:q(f,d);break;case 30:Y(f,d);break;case 31:X(f,d);break;case 32:K(f,d);break;case 33:J(f,d);break;case 34:Q(f,d);break;case 35:Z(f,d);break;case 36:ee(f,d);break;case 37:$(f,d);break;case 38:te(f,d);break;case 39:ie(f,d);break;case 40:ne(f,d);break;case 41:re(f,d);break;default:Py(f.state)}}}for(var m,_=c.length-1;_>=0;_--)c.forEach((function(e){return oe(e)}));return l;function g(e){if("#"===e)c.push(z_t(h,28));else if("@"===e)c.push(H_t(h,30));else if("/"===e)c.push(xY(h,11));else if("+"===e)c.push(bY(h,37));else if("("===e)c.push(bY(h,32));else{if(ws.test(e)&&(c.push(bY(h,38)),c.push(V_t(h,13))),_0e(e)){var t="m"===e.toLowerCase()?15:22;c.push(U_t(h,t))}c4(e)&&c.push(yY(h,0)),qd.test(e)&&c.push(xY(h,5))}}function y(e,t){":"===t?e.state=2:"-"===t?e.state=1:dY(t)||Ro(c,e)}function v(e,t){"-"===t||("/"===t?(Ro(c,e),c.push(xY(h,11))):dY(t)?e.state=0:Ro(c,e))}function b(e,t){"/"===t?e.state=3:"."===t?Ro(c,e):Jp(t)?(e.state=5,c4(t)&&c.push(yY(h,0))):Ro(c,e)}function A(e,t){"/"===t?e.state=4:hY(t)?(e.state=10,e.acceptStateReached=!0):oe(e)}function T(e,t){"/"===t?e.state=10:Jp(t)?(e.state=5,e.acceptStateReached=!0):Ro(c,e)}function E(e,t){Jp(t)?e.state=5:Ro(c,e)}function C(e,t){"."===t?e.state=7:"-"===t?e.state=6:":"===t?e.state=8:u4(t)?e.state=10:l4(t)||oe(e)}function x(e,t){"-"===t||("."===t?oe(e):Jp(t)?e.state=5:oe(e))}function S(e,t){"."===t?oe(e):Jp(t)?(e.state=5,e.acceptStateReached=!0):oe(e)}function w(e,t){"."===t?e.state=14:":"===t?e.state=8:ws.test(t)||(u4(t)?e.state=10:qd.test(t)?Ro(c,e):oe(e))}function I(e,t){ws.test(t)?(e.octetsEncountered++,4===e.octetsEncountered&&(e.acceptStateReached=!0),e.state=13):oe(e)}function P(e,t){ws.test(t)?e.state=9:oe(e)}function D(e,t){ws.test(t)||(u4(t)?e.state=10:oe(e))}function O(e,t){hY(t)||oe(e)}function L(e,t){"a"===t.toLowerCase()?e.state=16:U(e,t)}function R(e,t){"i"===t.toLowerCase()?e.state=17:U(e,t)}function N(e,t){"l"===t.toLowerCase()?e.state=18:U(e,t)}function M(e,t){"t"===t.toLowerCase()?e.state=19:U(e,t)}function F(e,t){"o"===t.toLowerCase()?e.state=20:U(e,t)}function B(e,t){":"===t.toLowerCase()?e.state=21:U(e,t)}function z(e,t){f4(t)?e.state=22:Ro(c,e)}function U(e,t){"."===t?e.state=23:"@"===t?e.state=24:f4(t)?e.state=22:Ro(c,e)}function k(e,t){"."===t||"@"===t?Ro(c,e):f4(t)?e.state=22:Ro(c,e)}function V(e,t){Jp(t)?e.state=25:Ro(c,e)}function H(e,t){"."===t?e.state=27:"-"===t?e.state=26:l4(t)||oe(e)}function G(e,t){"-"===t||"."===t?oe(e):l4(t)?e.state=25:oe(e)}function j(e,t){"."===t||"-"===t?oe(e):Jp(t)?(e.state=25,e.acceptStateReached=!0):oe(e)}function W(e,t){pY(t)?(e.state=29,e.acceptStateReached=!0):Ro(c,e)}function q(e,t){pY(t)||oe(e)}function Y(e,t){_Y(t)?(e.state=31,e.acceptStateReached=!0):Ro(c,e)}function X(e,t){_Y(t)||(qd.test(t)?Ro(c,e):oe(e))}function $(e,t){ws.test(t)?e.state=38:(Ro(c,e),g(t))}function K(e,t){ws.test(t)?e.state=33:Ro(c,e),g(t)}function J(e,t){ws.test(t)?e.state=34:Ro(c,e)}function Q(e,t){ws.test(t)?e.state=35:Ro(c,e)}function Z(e,t){")"===t?e.state=36:Ro(c,e)}function ee(e,t){ws.test(t)?e.state=38:gY(t)?e.state=39:Ro(c,e)}function te(e,t){e.acceptStateReached=!0,d4(t)?e.state=40:"#"===t?e.state=41:ws.test(t)||("("===t?e.state=32:gY(t)?e.state=39:(oe(e),c4(t)&&c.push(yY(h,0))))}function ie(e,t){ws.test(t)?e.state=38:"("===t?e.state=32:(oe(e),g(t))}function ne(e,t){d4(t)||("#"===t?e.state=41:ws.test(t)?e.state=38:oe(e))}function re(e,t){d4(t)?e.state=40:ws.test(t)?Ro(c,e):oe(e)}function oe(t){if(Ro(c,t),t.acceptStateReached){var u=t.startIdx,d=e.slice(t.startIdx,h);if(d=k_t(d),"url"===t.type){if("@"===e.charAt(t.startIdx-1))return;var p=t.matchType;if("scheme"===p){var f=fY.exec(d);if(f&&(u+=f.index,d=d.slice(f.index)),!f0e(d))return}else if("tld"===p){if(!d0e(d))return}else if("ipV4"===p){if(!h0e(d))return}else Py(p);l.push(new m0e({tagBuilder:i,matchedText:d,offset:u,urlMatchType:p,url:d,protocolRelativeMatch:"//"===d.slice(0,2),stripPrefix:n,stripTrailingSlash:r,decodePercentEncoding:o}))}else if("email"===t.type)g0e(d)&&l.push(new y0e({tagBuilder:i,matchedText:d,offset:u,email:d.replace(p0e,"")}));else if("hashtag"===t.type)x0e(d)&&l.push(new T0e({tagBuilder:i,matchedText:d,offset:u,serviceName:a,hashtag:d.slice(1)}));else if("mention"===t.type)A0e(d,s)&&l.push(new E0e({tagBuilder:i,matchedText:d,offset:u,serviceName:s,mention:d.slice(1)}));else if("phone"===t.type){if(S0e(d=d.replace(/ +$/g,""))){var m=d.replace(/[^0-9,;#]/g,"");l.push(new w0e({tagBuilder:i,matchedText:d,offset:u,number:m,plusSign:"+"===d.charAt(0)}))}}else Py(t)}}}var B_t=/[\(\{\[]/,v0e=/[\)\}\]]/,D0e={")":"(","}":"{","]":"["};function k_t(e){for(var t={"(":0,"{":0,"[":0},i=0;i<e.length;i++){var n=e.charAt(i);B_t.test(n)?t[n]++:v0e.test(n)&&t[D0e[n]]--}for(var r,o=e.length-1;o>=0;)if(r=e.charAt(o),v0e.test(r)){var a=D0e[r];if(!(t[a]<0))break;t[a]++,o--}else{if(!u0e.test(r))break;o--}return e.slice(0,o+1)}function yY(e,t){return{type:"url",startIdx:e,state:t,acceptStateReached:!1,matchType:"scheme"}}function xY(e,t){return{type:"url",startIdx:e,state:t,acceptStateReached:!1,matchType:"tld"}}function V_t(e,t){return{type:"url",startIdx:e,state:t,acceptStateReached:!1,matchType:"ipV4",octetsEncountered:1}}function U_t(e,t){return{type:"email",startIdx:e,state:t,acceptStateReached:!1}}function z_t(e,t){return{type:"hashtag",startIdx:e,state:t,acceptStateReached:!1}}function H_t(e,t){return{type:"mention",startIdx:e,state:t,acceptStateReached:!1}}function bY(e,t){return{type:"phone",startIdx:e,state:t,acceptStateReached:!1}}function P0e(e,t){for(var i=t.onOpenTag,n=t.onCloseTag,r=t.onText,o=t.onComment,a=t.onDoctype,s=new xm,l=0,u=e.length,c=0,h=0,d=s;l<u;){var p=e.charAt(l);switch(c){case 0:"<"===p&&M();break;case 1:f(p);break;case 2:_(p);break;case 3:m(p);break;case 4:g(p);break;case 5:y(p);break;case 6:v(p);break;case 7:b(p);break;case 8:A(p);break;case 9:T(p);break;case 10:E(p);break;case 11:C(p);break;case 12:x(p);break;case 13:S(p);break;case 14:w(p);break;case 15:I(p);break;case 16:P(p);break;case 17:D(p);break;case 18:O(p);break;case 19:L(p);break;case 20:R(p);break;default:Py(c)}l++}function f(e){"!"===e?c=13:"/"===e?(c=2,d=new xm(vs(vs({},d),{isClosing:!0}))):"<"===e?M():Oy.test(e)?(c=3,d=new xm(vs(vs({},d),{isOpening:!0}))):(c=0,d=s)}function m(e){xu.test(e)?(d=new xm(vs(vs({},d),{name:B()})),c=4):"<"===e?M():"/"===e?(d=new xm(vs(vs({},d),{name:B()})),c=12):">"===e?(d=new xm(vs(vs({},d),{name:B()})),F()):!Oy.test(e)&&!ws.test(e)&&":"!==e&&N()}function _(e){">"===e?N():Oy.test(e)?c=3:N()}function g(e){xu.test(e)||("/"===e?c=12:">"===e?F():"<"===e?M():"="===e||s4.test(e)||e0e.test(e)?N():c=5)}function y(e){xu.test(e)?c=6:"/"===e?c=12:"="===e?c=7:">"===e?F():"<"===e?M():s4.test(e)&&N()}function v(e){xu.test(e)||("/"===e?c=12:"="===e?c=7:">"===e?F():"<"===e?M():s4.test(e)?N():c=5)}function b(e){xu.test(e)||('"'===e?c=8:"'"===e?c=9:/[>=`]/.test(e)?N():"<"===e?M():c=10)}function A(e){'"'===e&&(c=11)}function T(e){"'"===e&&(c=11)}function E(e){xu.test(e)?c=4:">"===e?F():"<"===e&&M()}function C(e){xu.test(e)?c=4:"/"===e?c=12:">"===e?F():"<"===e?M():(c=4,l--)}function x(e){">"===e?(d=new xm(vs(vs({},d),{isClosing:!0})),F()):c=4}function S(t){"--"===e.substr(l,2)?(l+=2,d=new xm(vs(vs({},d),{type:"comment"})),c=14):"DOCTYPE"===e.substr(l,7).toUpperCase()?(l+=7,d=new xm(vs(vs({},d),{type:"doctype"})),c=20):N()}function w(e){"-"===e?c=15:">"===e?N():c=16}function I(e){"-"===e?c=18:">"===e?N():c=16}function P(e){"-"===e&&(c=17)}function D(e){c="-"===e?18:16}function O(e){">"===e?F():"!"===e?c=19:"-"===e||(c=16)}function L(e){"-"===e?c=17:">"===e?F():c=16}function R(e){">"===e?F():"<"===e&&M()}function N(){c=0,d=s}function M(){c=1,d=new xm({idx:l})}function F(){var t=e.slice(h,d.idx);t&&r(t,h),"comment"===d.type?o(d.idx):"doctype"===d.type?a(d.idx):(d.isOpening&&i(d.name,d.idx),d.isClosing&&n(d.name,d.idx)),N(),h=l+1}function B(){var t=d.idx+(d.isClosing?2:1);return e.slice(t,l).toLowerCase()}h<l&&function(){var t=e.slice(h,l);r(t,h),h=l+1}()}var xm=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing},G_t=function(){function e(t){void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.tagBuilder=null,this.urls=W_t(t.urls),this.email=yu(t.email)?t.email:this.email,this.phone=yu(t.phone)?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow=yu(t.newWindow)?t.newWindow:this.newWindow,this.stripPrefix=j_t(t.stripPrefix),this.stripTrailingSlash=yu(t.stripTrailingSlash)?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding=yu(t.decodePercentEncoding)?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var i=this.mention;if(!1!==i&&-1===C0e.indexOf(i))throw new Error("invalid `mention` cfg '".concat(i,"' - see docs"));var n=this.hashtag;if(!1!==n&&-1===b0e.indexOf(n))throw new Error("invalid `hashtag` cfg '".concat(n,"' - see docs"));this.truncate=q_t(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,i){return new e(i).link(t)},e.parse=function(t,i){return new e(i).parse(t)},e.prototype.parse=function(e){var t=this,i=["a","style","script"],n=0,r=[];return P0e(e,{onOpenTag:function(e){i.indexOf(e)>=0&&n++},onText:function(e,i){if(0===n){var o=e.split(/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),a=i;o.forEach((function(e,i){if(i%2==0){var n=t.parseText(e,a);r.push.apply(r,n)}a+=e.length}))}},onCloseTag:function(e){i.indexOf(e)>=0&&(n=Math.max(n-1,0))},onComment:function(e){},onDoctype:function(e){}}),r=this.compactMatches(r),r=this.removeUnwantedMatches(r)},e.prototype.compactMatches=function(e){e.sort((function(e,t){return e.getOffset()-t.getOffset()}));for(var t=0;t<e.length-1;){var i=e[t],n=i.getOffset(),r=i.getMatchedText().length,o=n+r;if(t+1<e.length){if(e[t+1].getOffset()===n){var a=e[t+1].getMatchedText().length>r?t:t+1;e.splice(a,1);continue}if(e[t+1].getOffset()<o){e.splice(t+1,1);continue}}t++}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||Iy(e,(function(e){return"hashtag"===e.getType()})),this.email||Iy(e,(function(e){return"email"===e.getType()})),this.phone||Iy(e,(function(e){return"phone"===e.getType()})),this.mention||Iy(e,(function(e){return"mention"===e.getType()})),this.urls.schemeMatches||Iy(e,(function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()})),this.urls.tldMatches||Iy(e,(function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()})),this.urls.ipV4Matches||Iy(e,(function(e){return"url"===e.getType()&&"ipV4"===e.getUrlMatchType()})),e},e.prototype.parseText=function(e,t){void 0===t&&(t=0),t=t||0;for(var i=I0e(e,{tagBuilder:this.getTagBuilder(),stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding,hashtagServiceName:this.hashtag,mentionServiceName:this.mention||"twitter"}),n=0,r=i.length;n<r;n++)i[n].setOffset(t+i[n].getOffset());return i},e.prototype.link=function(e){if(!e)return"";this.sanitizeHtml&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var t=this.parse(e),i=[],n=0,r=0,o=t.length;r<o;r++){var a=t[r];i.push(e.substring(n,a.getOffset())),i.push(this.createMatchReturnVal(a)),n=a.getOffset()+a.getMatchedText().length}return i.push(e.substring(n)),i.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof a4?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new s0e({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version=$ye,e}(),O0e=G_t;function W_t(e){return null==e&&(e=!0),yu(e)?{schemeMatches:e,tldMatches:e,ipV4Matches:e}:{schemeMatches:!yu(e.schemeMatches)||e.schemeMatches,tldMatches:!yu(e.tldMatches)||e.tldMatches,ipV4Matches:!yu(e.ipV4Matches)||e.ipV4Matches}}function j_t(e){return null==e&&(e=!0),yu(e)?{scheme:e,www:e}:{scheme:!yu(e.scheme)||e.scheme,www:!yu(e.www)||e.www}}function q_t(e){return"number"==typeof e?{length:e,location:"end"}:Qye(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})}var h4=O0e,U0e;typeof DOMParser<"u"&&(U0e=new DOMParser);var Y_t=new h4({stripPrefix:!1,email:!1,replaceFn:function(e,t){return"scheme"===t.urlMatchType||"www"===t.urlMatchType}}),m4=32,R0e=2414016,M0e=1,L0e=16093e3,N0e=.1,X_t=[null,void 0,"http://www.topografix.com/GPX/1/1"],xo={gpx:X_t};function K_t(e){return new Promise(((t,i)=>{let n=new FileReader;n.addEventListener("load",(function(){t(n.result)})),n.addEventListener("error",(function(){i(n.error)})),n.readAsText(e)}))}function TY(e,t){let i=vI(e,"id");return i=u(i)?i:jn(),t.getOrCreateEntity(i)}function AY(e){let t=F0e(e,"lon"),i=F0e(e,"lat"),n=SI(e,"ele",xo.gpx);return h.fromDegrees(t,i,n)}function F0e(e,t){if(!u(e))return;let i=e.getAttribute(t);if(null!==i){let e=parseFloat(i);return isNaN(e)?void 0:e}}function vI(e,t){if(!u(e))return;let i=e.getAttribute(t);return null!==i?i:void 0}function Ry(e,t,i){if(!u(e))return;let n=e.childNodes,r=n.length;for(let e=0;e<r;e++){let r=n[e];if(r.localName===t&&-1!==i.indexOf(r.namespaceURI))return r}}function CY(e,t,i){if(!u(e))return;let n=[],r=e.getElementsByTagName(t),o=r.length;for(let e=0;e<o;e++){let o=r[e];o.localName===t&&-1!==i.indexOf(o.namespaceURI)&&n.push(o)}return n}function SI(e,t,i){let n=Ry(e,t,i);if(u(n)){let e=parseFloat(n.textContent);return isNaN(e)?void 0:e}}function Al(e,t,i){let n=Ry(e,t,i);if(u(n))return n.textContent.trim()}function z0e(e){let t=new Sc;return t.width=m4,t.height=m4,t.scaleByDistance=new Pt(R0e,M0e,L0e,N0e),t.pixelOffsetScaleByDistance=new Pt(R0e,M0e,L0e,N0e),t.verticalOrigin=new Zn(On.BOTTOM),t.image=e,t}function Z_t(){let e=new rm;return e.translucencyByDistance=new Pt(3e6,1,5e6,0),e.pixelOffset=new U(17,0),e.horizontalOrigin=yi.LEFT,e.font="16px sans-serif",e.style=zo.FILL_AND_OUTLINE,e}function H0e(e){let t=new wc;return t.width=4,t.material=new Kx,t.material.color=u(e)?e:z.RED,t.material.outlineWidth=2,t.material.outlineColor=z.BLACK,t}var B0e={time:{text:"Time",tag:"time"},comment:{text:"Comment",tag:"cmt"},description:{text:"Description",tag:"desc"},source:{text:"Source",tag:"src"},number:{text:"GPS track/route number",tag:"number"},type:{text:"Type",tag:"type"}},wI;function EY(e,t){let i,n="",r=Object.keys(B0e),o=r.length;for(i=0;i<o;i++){let t=r[i],o=B0e[t];o.value=y(Al(e,o.tag,xo.gpx),""),u(o.value)&&""!==o.value&&(n=`${n}<p>${o.text}: ${o.value}</p>`)}if(!u(n)||""===n)return;n=Y_t.link(n),wI.innerHTML=n;let a=wI.querySelectorAll("a");for(i=0;i<a.length;i++)a[i].setAttribute("target","_blank");let s=z.WHITE,l=z.BLACK,c='<div class="cesium-infoBox-description-lighter" style="';return c+="overflow:auto;",c+="word-wrap:break-word;",c+=`background-color:${s.toCssColorString()};`,c+=`color:${l.toCssColorString()};`,c+='">',c+=`${wI.innerHTML}</div>`,wI.innerHTML="",c}function G0e(e,t,i,n){let r=AY(t),o=TY(t,i);o.position=r;let a=u(n.waypointImage)?n.waypointImage:e._pinBuilder.fromMakiIconId("marker",z.RED,m4);o.billboard=z0e(a);let s=Al(t,"name",xo.gpx);o.name=s,o.label=Z_t(),o.label.text=s,o.description=EY(t,o),n.clampToGround&&(o.billboard.heightReference=We.CLAMP_TO_GROUND,o.label.heightReference=We.CLAMP_TO_GROUND)}function $_t(e,t,i,n){let r=TY(t,i);r.description=EY(t,r);let o=CY(t,"rtept",xo.gpx),a=new Array(o.length);for(let t=0;t<o.length;t++)G0e(e,o[t],i,n),a[t]=AY(o[t]);r.polyline=H0e(n.routeColor),n.clampToGround&&(r.polyline.clampToGround=!0),r.polyline.positions=a}function Q_t(e,t,i,n){let r=TY(t,i);r.description=EY(t,r);let o,a=CY(t,"trkseg",xo.gpx),s=[],l=[],c=!0,h=new pa;for(let e=0;e<a.length;e++)o=J_t(a[e]),s=s.concat(o.positions),o.times.length>0?(l=l.concat(o.times),h.addSamples(l,s),c=c&&!0):c=!1;if(c){let t=u(n.waypointImage)?n.waypointImage:e._pinBuilder.fromMakiIconId("marker",z.RED,m4);r.billboard=z0e(t),r.position=h,n.clampToGround&&(r.billboard.heightReference=We.CLAMP_TO_GROUND),r.availability=new Mr,r.availability.addInterval(new Cn({start:l[0],stop:l[l.length-1]}))}r.polyline=H0e(n.trackColor),r.polyline.positions=s,n.clampToGround&&(r.polyline.clampToGround=!0)}function J_t(e){let t,i={positions:[],times:[]},n=CY(e,"trkpt",xo.gpx);for(let e=0;e<n.length;e++){let r=AY(n[e]);i.positions.push(r),t=Al(n[e],"time",xo.gpx),u(t)&&i.times.push(J.fromIso8601(t))}return i}function egt(e){let t=Ry(e,"metadata",xo.gpx);if(u(t)){let e={name:Al(t,"name",xo.gpx),desc:Al(t,"desc",xo.gpx),author:tgt(t),copyright:igt(t),link:W0e(t),time:Al(t,"time",xo.gpx),keywords:Al(t,"keywords",xo.gpx),bounds:ogt(t)};if(u(e.name)||u(e.desc)||u(e.author)||u(e.copyright)||u(e.link)||u(e.time)||u(e.keywords)||u(e.bounds))return e}}function tgt(e){let t=Ry(e,"author",xo.gpx);if(u(t)){let e={name:Al(t,"name",xo.gpx),email:ngt(t),link:W0e(t)};if(u(e.name)||u(e.email)||u(e.link))return e}}function ngt(e){let t=Ry(e,"email",xo.gpx);if(u(t)){return`${Al(t,"id",xo.gpx)}@${Al(t,"domain",xo.gpx)}`}}function W0e(e){let t=Ry(e,"link",xo.gpx);if(u(t)){let e={href:vI(t,"href"),text:Al(t,"text",xo.gpx),mimeType:Al(t,"type",xo.gpx)};if(u(e.href)||u(e.text)||u(e.mimeType))return e}}function igt(e){let t=Ry(e,"copyright",xo.gpx);if(u(t)){let e={author:vI(t,"author"),year:Al(t,"year",xo.gpx),license:Al(t,"license",xo.gpx)};if(u(e.author)||u(e.year)||u(e.license))return e}}function ogt(e){let t=Ry(e,"bounds",xo.gpx);if(u(t)){let e={minLat:SI(t,"minlat",xo.gpx),maxLat:SI(t,"maxlat",xo.gpx),minLon:SI(t,"minlon",xo.gpx),maxLon:SI(t,"maxlon",xo.gpx)};if(u(e.minLat)||u(e.maxLat)||u(e.minLon)||u(e.maxLon))return e}}typeof document<"u"&&(wI=document.createElement("div"));var k0e={wpt:G0e,rte:$_t,trk:Q_t};function rgt(e,t,i,n){let r=Object.keys(k0e),o=r.length;for(let a=0;a<o;a++){let o=r[a],s=k0e[o],l=t.childNodes,u=l.length;for(let t=0;t<u;t++){let r=l[t];r.localName===o&&-1!==xo.gpx.indexOf(r.namespaceURI)&&s(e,r,i,n)}}}function V0e(e,t,i){let n=e._entityCollection;n.removeAll();let r,o=t.documentElement,a=vI(o,"version"),s=vI(o,"creator"),l=egt(o);u(l)&&(r=l.name),"gpx"===o.localName?rgt(e,o,n,i):console.log(`GPX - Unsupported node: ${o.localName}`);let c,h=n.computeAvailability(),d=h.start,p=h.stop,f=J.equals(d,ze.MINIMUM_VALUE),m=J.equals(p,ze.MAXIMUM_VALUE);if(!f||!m){let e;f&&(e=new Date,e.setHours(0,0,0,0),d=J.fromDate(e)),m&&(e=new Date,e.setHours(24,0,0,0),p=J.fromDate(e)),c=new um,c.startTime=d,c.stopTime=p,c.currentTime=J.clone(d),c.clockRange=Dr.LOOP_STOP,c.clockStep=ho.SYSTEM_CLOCK_MULTIPLIER,c.multiplier=Math.round(Math.min(Math.max(J.secondsDifference(p,d)/60,1),31556900))}let _=!1;return e._name!==r&&(e._name=r,_=!0),e._creator!==s&&(e._creator=s,_=!0),sgt(e._metadata,l)&&(e._metadata=l,_=!0),e._version!==a&&(e._version=a,_=!0),c!==e._clock&&(_=!0,e._clock=c),_&&e._changed.raiseEvent(e),Nr.setLoading(e,!1),e}function sgt(e,t){return!(!u(e)&&!u(t))&&(!u(e)||!u(t)||(e.name!==t.name||e.dec!==t.desc||e.src!==t.src||e.author!==t.author||e.copyright!==t.copyright||e.link!==t.link||e.time!==t.time||e.bounds!==t.bounds))}function agt(e,t,i,n){n=y(n,y.EMPTY_OBJECT);let r=i;if("string"==typeof i||i instanceof ve){r=(i=ve.createIfNeeded(i)).fetchBlob();let t=e._resourceCredits,n=i.credits;if(u(n)){let e=n.length;for(let i=0;i<e;i++)t.push(n[i])}}return Promise.resolve(r).then((function(t){return t instanceof Blob?K_t(t).then((function(t){let i,r;try{i=U0e.parseFromString(t,"application/xml")}catch(e){r=e.toString()}if(u(r)||i.body||"parsererror"===i.documentElement.tagName){let e=u(r)?r:i.documentElement.firstChild.nodeValue;throw e||(e=i.body.innerText),new ue(e)}return V0e(e,i,n)})):V0e(e,t,n)})).catch((function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)}))}function LE(){this._changed=new pe,this._error=new pe,this._loading=new pe,this._clock=void 0,this._entityCollection=new Ks(this),this._entityCluster=new bf,this._name=void 0,this._version=void 0,this._creator=void 0,this._metadata=void 0,this._isLoading=!1,this._pinBuilder=new F_}LE.load=function(e,t){return(new LE).load(e,t)},Object.defineProperties(LE.prototype,{name:{get:function(){return this._name}},version:{get:function(){return this._version}},creator:{get:function(){return this._creator}},metadata:{get:function(){return this._metadata}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}}),LE.prototype.update=function(e){return!0},LE.prototype.load=function(e,t){if(!u(e))throw new de("data is required.");t=y(t,y.EMPTY_OBJECT),Nr.setLoading(this,!0);let i=this._name,n=this;return agt(this,this._entityCollection,e,t).then((function(){let e,t=n._entityCollection.computeAvailability(),r=t.start,o=t.stop,a=J.equals(r,ze.MINIMUM_VALUE),s=J.equals(o,ze.MAXIMUM_VALUE);if(!a||!s){let t;a&&(t=new Date,t.setHours(0,0,0,0),r=J.fromDate(t)),s&&(t=new Date,t.setHours(24,0,0,0),o=J.fromDate(t)),e=new um,e.startTime=r,e.stopTime=o,e.currentTime=J.clone(r),e.clockRange=Dr.LOOP_STOP,e.clockStep=ho.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(J.secondsDifference(o,r)/60,1),31556900))}let l=!1;return e!==n._clock&&(n._clock=e,l=!0),i!==n._name&&(l=!0),l&&n._changed.raiseEvent(n),Nr.setLoading(n,!1),n})).catch((function(e){return Nr.setLoading(n,!1),n._error.raiseEvent(n,e),console.log(e),Promise.reject(e)}))};var p4=LE;function cgt(e,t){this.position=e,this.headingPitchRoll=t}var _4=cgt,DI=or(Sl(),1);function lgt(e,t){this.position=e,this.headingPitchRange=t}var g4=lgt;function y4(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new pe,this.tourEnd=new pe,this.entryStart=new pe,this.entryEnd=new pe,this._activeEntries=[]}function j0e(e){for(let t=e.pop();void 0!==t;t=e.pop())t.stop()}function q0e(e,t,i){let n=this.playlist[this.playlistIndex];if(n){let r=ugt.bind(this,e,t,i);if(this._activeEntries.push(n),this.entryStart.raiseEvent(n),n.blocking)n.play(r,e.scene.camera,t);else{let o=this;n.play((function(){o.entryEnd.raiseEvent(n);let e=o._activeEntries.indexOf(n);e>=0&&o._activeEntries.splice(e,1)})),r(e,t,i)}}else u(i)&&i(!1)}function ugt(e,t,i,n){let r=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(r,n),n)i(n);else{let n=this._activeEntries.indexOf(r);n>=0&&this._activeEntries.splice(n,1),this.playlistIndex++,q0e.call(this,e,t,i)}}y4.prototype.addPlaylistEntry=function(e){this.playlist.push(e)},y4.prototype.play=function(e,t){this.tourStart.raiseEvent();let i=this;q0e.call(this,e,t,(function(e){i.playlistIndex=0,e||j0e(i._activeEntries),i.tourEnd.raiseEvent(e)}))},y4.prototype.stop=function(){j0e(this._activeEntries)};var x4=y4;function b4(e,t,i){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=i,this.flyToMode=t}b4.prototype.play=function(e,t,i){if(this.activeCamera=t,u(e)&&null!==e){let t=this;this.activeCallback=function(i){delete t.activeCallback,delete t.activeCamera,e(!u(i)&&i)}}let n=this.getCameraOptions(i);if(this.view.headingPitchRoll)t.flyTo(n);else if(this.view.headingPitchRange){let e=new se(this.view.position);t.flyToBoundingSphere(e,n)}},b4.prototype.stop=function(){u(this.activeCamera)&&this.activeCamera.cancelFlight(),u(this.activeCallback)&&this.activeCallback(!0)},b4.prototype.getCameraOptions=function(e){let t={duration:this.duration};return u(this.activeCallback)&&(t.complete=this.activeCallback),"smooth"===this.flyToMode&&(t.easingFunction=Ir.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),u(e)&&(t=gt(t,e)),t};var T4=b4;function SY(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}SY.prototype.play=function(e){let t=this;this.activeCallback=e,this.timeout=setTimeout((function(){delete t.activeCallback,e(!1)}),1e3*this.duration)},SY.prototype.stop=function(){clearTimeout(this.timeout),u(this.activeCallback)&&this.activeCallback(!0)};var A4=SY,nxe={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){let t=e.toLowerCase();return t=Cb(t),nxe[t]}},RY;typeof DOMParser<"u"&&(RY=new DOMParser);var fgt=new h4({stripPrefix:!1,email:!1,replaceFn:function(e){return"scheme"===e.urlMatchType||"www"===e.urlMatchType}}),My=32,Y0e=2414016,X0e=1,K0e=16093e3,Z0e=.1,$0e=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],Q0e=["http://www.google.com/kml/ext/2.2"],dgt=["http://www.w3.org/2005/Atom"],Oe={kml:$0e,gx:Q0e,atom:dgt,kmlgx:$0e.concat(Q0e)},MY={Document:dxe,Folder:Ogt,Placemark:Rgt,NetworkLink:zgt,GroundOverlay:kgt,PhotoOverlay:pxe,ScreenOverlay:Bgt,Tour:Lgt};function bm(e){this._dataSource=e,this._deferred=wl(),this._stack=[],this._promises=[],this._timeoutSet=!1,this._used=!1,this._started=0,this._timeThreshold=1e3}function hgt(e){let t=e.slice(0,Math.min(4,e.size)),i=wl(),n=new FileReader;return n.addEventListener("load",(function(){i.resolve(1347093252===new DataView(n.result).getUint32(0,!1))})),n.addEventListener("error",(function(){i.reject(n.error)})),n.readAsArrayBuffer(t),i.promise}function mgt(e){let t=wl(),i=new FileReader;return i.addEventListener("load",(function(){t.resolve(i.result)})),i.addEventListener("error",(function(){t.reject(i.error)})),i.readAsText(e),t.promise}function ixe(e){let t,i,n,r,o={xsi:"http://www.w3.org/2001/XMLSchema-instance"};for(let a in o)o.hasOwnProperty(a)&&(n=RegExp(`[< ]${a}:`),r=`xmlns:${a}=`,n.test(e)&&-1===e.indexOf(r)&&(u(t)||(t=e.substr(0,e.indexOf("<kml")+4),i=e.substr(t.length)),t+=` ${r}"${o[a]}"`));return u(t)&&(e=t+i),e}function oxe(e){let t,i,n,r=e.indexOf("xmlns:"),o=e.indexOf(">",r);for(;-1!==r&&r<o;)t=e.slice(r,e.indexOf('"',r)),i=r,r=e.indexOf(t,r+1),-1!==r?(n=e.indexOf('"',e.indexOf('"',r)+1),r=(e=e.slice(0,r-1)+e.slice(n+1,e.length)).indexOf("xmlns:",i-1)):r=e.indexOf("xmlns:",i+1);return e}function pgt(e,t){return Promise.resolve(e.getData(new kz)).then((function(e){e=oxe(e=ixe(e)),t.kml=RY.parseFromString(e,"application/xml")}))}function wY(e,t){let i=y(nxe.detectFromFilename(e.filename),"application/octet-stream");return Promise.resolve(e.getData(new Vz(i))).then((function(i){t[e.filename]=i}))}function bu(e,t,i,n){let r=n.keys,o=new DI.default("."),a=e.querySelectorAll(t);for(let e=0;e<a.length;e++){let s=a[e],l=s.getAttribute(i);if(u(l)){let e=new DI.default(l).absoluteTo(o).toString(),a=r.indexOf(e);if(-1!==a){let e=r[a];s.setAttribute(i,n[e]),"a"===t&&null===s.getAttribute("download")&&s.setAttribute("download",e)}}}}function Tu(e,t,i,n){let r=e.querySelectorAll(t);for(let e=0;e<r.length;e++){let t=r[e],o=LY(t.getAttribute(i),n);u(o)&&t.setAttribute(i,o.url)}}function rxe(e,t,i){let n=us(e,"id");n=u(n)&&0!==n.length?n:jn(),u(i)&&(n=i+n);let r=t.getById(n);return u(r)&&(n=jn(),u(i)&&(n=i+n)),r=t.add(new er({id:n})),u(r.kml)||(r.addProperty("kml"),r.kml=new jgt),r}function II(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function w4(e,t){if(!u(e))return h.fromDegrees(0,0,0,t);let i=e.match(/[^\s,\n]+/g);if(!u(i))return h.fromDegrees(0,0,0,t);let n=parseFloat(i[0]),r=parseFloat(i[1]),o=parseFloat(i[2]);return n=isNaN(n)?0:n,r=isNaN(r)?0:r,o=isNaN(o)?0:o,h.fromDegrees(n,r,o,t)}function C4(e,t){if(!u(e))return;let i=e.textContent.match(/[^\s\n]+/g);if(!u(i))return;let n=i.length,r=new Array(n),o=0;for(let e=0;e<n;e++)r[o++]=w4(i[e],t);return r}function Ly(e,t){if(!u(e))return;let i=e.getAttribute(t);if(null!==i){let e=parseFloat(i);return isNaN(e)?void 0:e}}function us(e,t){if(!u(e))return;let i=e.getAttribute(t);return null!==i?i:void 0}function vi(e,t,i){if(!u(e))return;let n=e.childNodes,r=n.length;for(let e=0;e<r;e++){let r=n[e];if(r.localName===t&&-1!==i.indexOf(r.namespaceURI))return r}}function J0e(e,t,i){if(!u(e))return;let n=[],r=e.getElementsByTagNameNS("*",t),o=r.length;for(let e=0;e<o;e++){let o=r[e];o.localName===t&&-1!==i.indexOf(o.namespaceURI)&&n.push(o)}return n}function Yd(e,t,i){if(!u(e))return[];let n=[],r=e.childNodes,o=r.length;for(let e=0;e<o;e++){let o=r[e];o.localName===t&&-1!==i.indexOf(o.namespaceURI)&&n.push(o)}return n}function $n(e,t,i){let n=vi(e,t,i);if(u(n)){let e=parseFloat(n.textContent);return isNaN(e)?void 0:e}}function wn(e,t,i){let n=vi(e,t,i);if(u(n))return n.textContent.trim()}function Xd(e,t,i){let n=vi(e,t,i);if(u(n)){let e=n.textContent.trim();return"1"===e||/^true$/i.test(e)}}function LY(e,t,i){if(!u(e))return;let n;if(u(i)){let r=i[e=e.replace(/\\/g,"/")];if(u(r))n=new ve({url:r});else{let o=new DI.default(t.getUrlComponent());r=i[new DI.default(e).absoluteTo(o)],u(r)&&(n=new ve({url:r}))}}return u(n)||(n=t.getDerivedResource({url:e})),n}Object.defineProperties(bm.prototype,{dataSource:{get:function(){return this._dataSource}}}),bm.prototype.addNodes=function(e,t){this._stack.push({nodes:e,index:0,processingData:t}),this._used=!0},bm.prototype.addPromise=function(e){this._promises.push(e)},bm.prototype.wait=function(){let e=this._deferred;return this._used||e.resolve(),Promise.all([e.promise,Promise.all(this._promises)])},bm.prototype.process=function(){let e=1===this._stack.length;return e&&(this._started=Au._getTimestamp()),this._process(e)},bm.prototype._giveUpTime=function(){if(this._timeoutSet)return;this._timeoutSet=!0,this._timeThreshold=50;let e=this;setTimeout((function(){e._timeoutSet=!1,e._started=Au._getTimestamp(),e._process(!0)}),0)},bm.prototype._nextNode=function(){let e=this._stack,t=e[e.length-1],i=t.index,n=t.nodes;if(i!==n.length)return++t.index,n[i]},bm.prototype._pop=function(){let e=this._stack;return e.pop(),0!==e.length||(this._deferred.resolve(),!1)},bm.prototype._process=function(e){let t=this.dataSource,i=this._stack[this._stack.length-1].processingData,n=this._nextNode();for(;u(n);){let e=MY[n.localName];if(u(e)&&(-1!==Oe.kml.indexOf(n.namespaceURI)||-1!==Oe.gx.indexOf(n.namespaceURI))&&(e(t,n,i,this),this._timeoutSet||Au._getTimestamp()>this._started+this._timeThreshold))return void this._giveUpTime();n=this._nextNode()}this._pop()&&e&&this._process(!0)};var Cl={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function PY(e,t){if(!u(e)||/^\s*$/gm.test(e))return;"#"===e[0]&&(e=e.substring(1));let i=parseInt(e.substring(0,2),16)/255,n=parseInt(e.substring(2,4),16)/255,r=parseInt(e.substring(4,6),16)/255,o=parseInt(e.substring(6,8),16)/255;return t?(o>0?(Cl.maximumRed=o,Cl.red=void 0):(Cl.maximumRed=void 0,Cl.red=0),r>0?(Cl.maximumGreen=r,Cl.green=void 0):(Cl.maximumGreen=void 0,Cl.green=0),n>0?(Cl.maximumBlue=n,Cl.blue=void 0):(Cl.maximumBlue=void 0,Cl.blue=0),Cl.alpha=i,z.fromRandom(Cl)):new z(o,r,n,i)}function sb(e,t,i){let n=wn(e,t,i);if(u(n))return PY(n,"random"===wn(e,"colorMode",i))}function _gt(e){let t=vi(e,"TimeStamp",Oe.kmlgx),i=wn(t,"when",Oe.kmlgx);if(!u(t)||!u(i)||0===i.length)return;let n=J.fromIso8601(i),r=new Mr;return r.addInterval(new Cn({start:n,stop:ze.MAXIMUM_VALUE})),r}function ggt(e){let t=vi(e,"TimeSpan",Oe.kmlgx);if(!u(t))return;let i,n=vi(t,"begin",Oe.kmlgx),r=u(n)?J.fromIso8601(n.textContent):void 0,o=vi(t,"end",Oe.kmlgx),a=u(o)?J.fromIso8601(o.textContent):void 0;if(u(r)&&u(a)){if(J.lessThan(a,r)){let e=r;r=a,a=e}i=new Mr,i.addInterval(new Cn({start:r,stop:a}))}else u(r)?(i=new Mr,i.addInterval(new Cn({start:r,stop:ze.MAXIMUM_VALUE}))):u(a)&&(i=new Mr,i.addInterval(new Cn({start:ze.MINIMUM_VALUE,stop:a})));return i}function sxe(){let e=new Sc;return e.width=My,e.height=My,e.scaleByDistance=new Pt(Y0e,X0e,K0e,Z0e),e.pixelOffsetScaleByDistance=new Pt(Y0e,X0e,K0e,Z0e),e}function NY(){let e=new sm;return e.outline=!0,e.outlineColor=z.WHITE,e}function axe(){let e=new rm;return e.translucencyByDistance=new Pt(3e6,1,5e6,0),e.pixelOffset=new U(17,0),e.horizontalOrigin=yi.LEFT,e.font="16px sans-serif",e.style=zo.FILL_AND_OUTLINE,e}function FY(e,t,i,n,r){let o=wn(e,"href",Oe.kml);if(!u(o)||0===o.length)return;if(0===o.indexOf("root://icons/palette-")){let t=o.charAt(21),i=y($n(e,"x",Oe.gx),0),n=y($n(e,"y",Oe.gx),0);i=Math.min(i/32,7),n=7-Math.min(n/32,7),o=`https://maps.google.com/mapfiles/kml/pal${t}/icon${8*n+i}.png`}let a=LY(o,i,n);if(r){let i=wn(e,"refreshMode",Oe.kml),n=wn(e,"viewRefreshMode",Oe.kml);"onInterval"===i||"onExpire"===i?It(`kml-refreshMode-${i}`,`KML - Unsupported Icon refreshMode: ${i}`):("onStop"===n||"onRegion"===n)&&It(`kml-refreshMode-${n}`,`KML - Unsupported Icon viewRefreshMode: ${n}`);let r=y(wn(e,"viewBoundScale",Oe.kml),1),o="onStop"===n?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",s=y(wn(e,"viewFormat",Oe.kml),o),l=wn(e,"httpQuery",Oe.kml);u(s)&&a.setQueryParameters(wu(S4(s))),u(l)&&a.setQueryParameters(wu(S4(l)));let c=t._ellipsoid;return kY(a,t.camera,t.canvas,r,t._lastCameraView.bbox,c),a}return a}function ygt(e,t,i,n,r){let o=$n(t,"scale",Oe.kml),a=$n(t,"heading",Oe.kml),s=sb(t,"color",Oe.kml),l=vi(t,"Icon",Oe.kml),c=FY(l,e,n,r,!1);u(l)&&!u(c)&&(c=!1);let d,p,f=$n(l,"x",Oe.gx),m=$n(l,"y",Oe.gx),_=$n(l,"w",Oe.gx),g=$n(l,"h",Oe.gx),v=vi(t,"hotSpot",Oe.kml),b=Ly(v,"x"),A=Ly(v,"y"),T=us(v,"xunits"),E=us(v,"yunits"),C=i.billboard;u(C)||(C=sxe(),i.billboard=C),C.image=c,C.scale=o,C.color=s,(u(f)||u(m)||u(_)||u(g))&&(C.imageSubRegion=new qe(f,m,_,g)),u(a)&&0!==a&&(C.rotation=P.toRadians(-a),C.alignedAxis=h.UNIT_Z),o=y(o,1),u(b)&&("pixels"===T?d=-b*o:"insetPixels"===T?d=(b-My)*o:"fraction"===T&&(d=-b*My*o),d+=.5*My*o),u(A)&&("pixels"===E?p=A*o:"insetPixels"===E?p=(-A+My)*o:"fraction"===E&&(p=A*My*o),p-=.5*My*o),(u(d)||u(p))&&(C.pixelOffset=new U(d,p))}function E4(e,t,i,n,r){for(let o=0,a=t.childNodes.length;o<a;o++){let a=t.childNodes.item(o);if("IconStyle"===a.localName)ygt(e,a,i,n,r);else if("LabelStyle"===a.localName){let e=i.label;u(e)||(e=axe(),i.label=e),e.scale=y($n(a,"scale",Oe.kml),e.scale),e.fillColor=y(sb(a,"color",Oe.kml),e.fillColor),e.text=i.name}else if("LineStyle"===a.localName){let e=i.polyline;u(e)||(e=new wc,i.polyline=e),e.width=$n(a,"width",Oe.kml),e.material=sb(a,"color",Oe.kml),u(sb(a,"outerColor",Oe.gx))&&It("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),u($n(a,"outerWidth",Oe.gx))&&It("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),u($n(a,"physicalWidth",Oe.gx))&&It("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),u(Xd(a,"labelVisibility",Oe.gx))&&It("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===a.localName){let e=i.polygon;u(e)||(e=NY(),i.polygon=e),e.material=y(sb(a,"color",Oe.kml),e.material),e.fill=y(Xd(a,"fill",Oe.kml),e.fill),e.outline=y(Xd(a,"outline",Oe.kml),e.outline)}else if("BalloonStyle"===a.localName){let e=y(PY(wn(a,"bgColor",Oe.kml)),z.WHITE),t=y(PY(wn(a,"textColor",Oe.kml)),z.BLACK),n=wn(a,"text",Oe.kml);i.addProperty("balloonStyle"),i.balloonStyle={bgColor:e,textColor:t,text:n}}else if("ListStyle"===a.localName){let e=wn(a,"listItemType",Oe.kml);("radioFolder"===e||"checkOffOnly"===e)&&It(`kml-listStyle-${e}`,`KML - Unsupported ListStyle with listItemType: ${e}`)}}}function xgt(e,t,i,n,r){let o,a=new er,s=-1,l=t.childNodes,c=l.length;for(let e=0;e<c;e++){let t=l[e];("Style"===t.localName||"StyleMap"===t.localName)&&(s=e)}if(-1!==s){let t=l[s];if("Style"===t.localName)E4(e,t,a,n,r);else{let s=Yd(t,"Pair",Oe.kml);for(let t=0;t<s.length;t++){let l=s[t],c=wn(l,"key",Oe.kml);if("normal"===c){let t=wn(l,"styleUrl",Oe.kml);if(u(t))o=i.getById(t),u(o)||(o=i.getById(`#${t}`)),u(o)&&a.merge(o);else{E4(e,vi(l,"Style",Oe.kml),a,n,r)}}else It(`kml-styleMap-${c}`,`KML - Unsupported StyleMap key: ${c}`)}}}let h=wn(t,"styleUrl",Oe.kml);if(u(h)){let e=h;if("#"!==h[0]&&-1!==h.indexOf("#")){let t=h.split("#"),i=t[0];e=`${n.getDerivedResource({url:i}).getUrlComponent()}#${t[1]}`}o=i.getById(e),u(o)||(o=i.getById(`#${e}`)),u(o)&&a.merge(o)}return a}function bgt(e,t,i){return t.fetchXML().then((function(n){return cxe(e,n,i,t,!0)}))}function cxe(e,t,i,n,r,o){let a,s,l,c,h=J0e(t,"Style",Oe.kml);if(u(h)){let t=h.length;for(a=0;a<t;a++)c=h[a],s=us(c,"id"),u(s)&&(s=`#${s}`,r&&u(n)&&(s=n.getUrlComponent()+s),u(i.getById(s))||(l=new er({id:s}),i.add(l),E4(e,c,l,n,o)))}let d=J0e(t,"StyleMap",Oe.kml);if(u(d)){let t=d.length;for(a=0;a<t;a++){let t=d[a];if(s=us(t,"id"),u(s)){let a=Yd(t,"Pair",Oe.kml);for(let t=0;t<a.length;t++){let h=a[t],d=wn(h,"key",Oe.kml);if("normal"===d){if(s=`#${s}`,r&&u(n)&&(s=n.getUrlComponent()+s),!u(i.getById(s))){l=i.getOrCreateEntity(s);let t=wn(h,"styleUrl",Oe.kml);if(u(t)){"#"!==t[0]&&(t=`#${t}`),r&&u(n)&&(t=n.getUrlComponent()+t);let e=i.getById(t);u(e)&&l.merge(e)}else c=vi(h,"Style",Oe.kml),E4(e,c,l,n,o)}}else It(`kml-styleMap-${d}`,`KML - Unsupported StyleMap key: ${d}`)}}}}let p=[],f=t.getElementsByTagName("styleUrl"),m=f.length;for(a=0;a<m;a++){let t=f[a].textContent;if("#"!==t[0]){let r=t.split("#");if(2===r.length){let t=r[0],o=n.getDerivedResource({url:t});p.push(bgt(e,o,i))}}}return p}function BY(e,t,i){let n=new my(e,t.id,["position"]),r=new $p(t.position);t.polyline=u(i.polyline)?i.polyline.clone():new wc,t.polyline.positions=new dy([n,r])}function lxe(e,t){return!u(e)&&!u(t)||"clampToGround"===e?We.CLAMP_TO_GROUND:"relativeToGround"===e?We.RELATIVE_TO_GROUND:"absolute"===e?We.NONE:"clampToSeaFloor"===t?(It("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),We.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?(It("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),We.RELATIVE_TO_GROUND):(u(e)?It("kml-altitudeMode-unknown",`KML - Unknown <kml:altitudeMode>:${e}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`):It("kml-gx:altitudeMode-unknown",`KML - Unknown <gx:altitudeMode>:${t}, using <kml:altitudeMode>:CLAMP_TO_GROUND.`),We.CLAMP_TO_GROUND)}function Tgt(e,t,i){return"relativeToSeaFloor"===i||"absolute"===t||"relativeToGround"===t?e:((u(t)&&"clampToGround"!==t||u(i)&&"clampToSeaFloor"!==i)&&It("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${y(t,i)}`),new $p(e))}function Agt(e,t,i,n){if(!u(e))return;if("relativeToSeaFloor"===i||"absolute"===t||"relativeToGround"===t)return e;(u(t)&&"clampToGround"!==t||u(i)&&"clampToSeaFloor"!==i)&&It("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${y(t,i)}`);let r=e.length;for(let t=0;t<r;t++){let i=e[t];n.scaleToGeodeticSurface(i,i)}return e}function v4(e,t,i,n){let r=t.label;u(r)||(r=u(i.label)?i.label.clone():axe(),t.label=r),r.text=t.name;let o=t.billboard;u(o)||(o=u(i.billboard)?i.billboard.clone():sxe(),t.billboard=o),u(o.image)?o.image.getValue()||(o.image=void 0):o.image=e._pinBuilder.fromColor(z.YELLOW,64);let a=1;u(o.scale)&&(a=o.scale.getValue(),0!==a?r.pixelOffset=new U(16*a+1,0):(r.pixelOffset=void 0,r.horizontalOrigin=void 0)),u(n)&&e._clampToGround&&(o.heightReference=n,r.heightReference=n)}function uxe(e,t){let i=e.path;u(i)||(i=new ry,i.leadTime=0,e.path=i);let n=t.polyline;u(n)&&(i.material=n.material,i.width=n.width)}function Cgt(e,t,i,n,r){let o=wn(i,"coordinates",Oe.kml),a=wn(i,"altitudeMode",Oe.kml),s=wn(i,"altitudeMode",Oe.gx),l=Xd(i,"extrude",Oe.kml),u=w4(o,e._ellipsoid);return n.position=u,v4(e,n,r,lxe(a,s)),l&&II(a,s)&&BY(t,n,r),!0}function exe(e,t,i,n,r){let o=vi(i,"coordinates",Oe.kml),a=wn(i,"altitudeMode",Oe.kml),s=wn(i,"altitudeMode",Oe.gx),l=Xd(i,"extrude",Oe.kml),c=Xd(i,"tessellate",Oe.kml),h=II(a,s),d=$n(i,"drawOrder",Oe.gx),p=e._ellipsoid,f=C4(o,p),m=r.polyline;if(h&&l){let e=new sy;n.wall=e,e.positions=f;let t=r.polygon;u(t)&&(e.fill=t.fill,e.material=t.material),e.outline=!0,u(m)?(e.outlineColor=u(m.material)?m.material.color:z.WHITE,e.outlineWidth=m.width):u(t)&&(e.outlineColor=u(t.material)?t.material.color:z.WHITE)}else if(e._clampToGround&&!h&&c){let e=new wc;e.clampToGround=!0,n.polyline=e,e.positions=f,u(m)?(e.material=u(m.material)?m.material.color.getValue(ze.MINIMUM_VALUE):z.WHITE,e.width=y(m.width,1)):(e.material=z.WHITE,e.width=1),e.zIndex=d}else u(d)&&It("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),e._clampToGround&&!c&&It("kml-line-tesselate","Ignoring clampToGround for KML lines without the tessellate flag."),m=u(m)?m.clone():new wc,n.polyline=m,m.positions=Agt(f,a,s,p),(!c||h)&&(m.arcType=Yt.NONE);return!0}function Egt(e,t,i,n,r){let o=vi(i,"outerBoundaryIs",Oe.kml),a=vi(o,"LinearRing",Oe.kml),s=vi(a,"coordinates",Oe.kml),l=e._ellipsoid,c=C4(s,l),h=Xd(i,"extrude",Oe.kml),d=II(wn(i,"altitudeMode",Oe.kml),wn(i,"altitudeMode",Oe.gx)),p=u(r.polygon)?r.polygon.clone():NY(),f=r.polyline;if(u(f)&&(p.outlineColor=u(f.material)?f.material.color:z.WHITE,p.outlineWidth=f.width),n.polygon=p,d?(p.perPositionHeight=!0,p.extrudedHeight=h?0:void 0):e._clampToGround||(p.height=0),u(c)){let e=new Pa(c),t=Yd(i,"innerBoundaryIs",Oe.kml);for(let i=0;i<t.length;i++){a=Yd(t[i],"LinearRing",Oe.kml);for(let t=0;t<a.length;t++)s=vi(a[t],"coordinates",Oe.kml),c=C4(s,l),u(c)&&e.holes.push(new Pa(c))}p.hierarchy=e}return!0}function Sgt(e,t,i,n,r){let o=wn(i,"altitudeMode",Oe.kml),a=wn(i,"altitudeMode",Oe.gx),s=Yd(i,"coord",Oe.gx),l=Yd(i,"angles",Oe.gx),u=Yd(i,"when",Oe.kml),c=Xd(i,"extrude",Oe.kml),h=II(o,a),d=e._ellipsoid;l.length>0&&It("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");let p=Math.min(s.length,u.length),f=[],m=[];for(let e=0;e<p;e++){let t=w4(s[e].textContent,d);f.push(t),m.push(J.fromIso8601(u[e].textContent))}let _=new pa;return _.addSamples(m,f),n.position=_,v4(e,n,r,lxe(o,a)),uxe(n,r),n.availability=new Mr,u.length>0&&n.availability.addInterval(new Cn({start:m[0],stop:m[m.length-1]})),h&&c&&BY(t,n,r),!0}function txe(e,t,i,n,r,o,a,s,l){let u=e[0],c=e[e.length-1],h=new pa;h.addSamples(e,t),i.intervals.addInterval(new Cn({start:u,stop:c,isStartIncluded:l,isStopIncluded:l,data:Tgt(h,a,s)})),n.addInterval(new Cn({start:u,stop:c,isStartIncluded:l,isStopIncluded:l})),r.intervals.addInterval(new Cn({start:u,stop:c,isStartIncluded:l,isStopIncluded:l,data:o}))}function wgt(e,t,i,n,r){let o,a,s,l=Xd(i,"interpolate",Oe.gx),c=Yd(i,"Track",Oe.gx),h=!1,d=new gy,p=new Mr,f=new ma,m=e._ellipsoid;for(let e=0,t=c.length;e<t;e++){let t=c[e],i=Yd(t,"when",Oe.kml),n=Yd(t,"coord",Oe.gx),r=wn(t,"altitudeMode",Oe.kml),_=wn(t,"altitudeMode",Oe.gx),g=II(r,_),y=Xd(t,"extrude",Oe.kml),v=Math.min(n.length,i.length),b=[];o=[];for(let e=0;e<v;e++){let t=w4(n[e].textContent,m);b.push(t),o.push(J.fromIso8601(i[e].textContent))}l&&(u(a)&&txe([a,o[0]],[s,b[0]],f,p,d,!1,"absolute",void 0,!1),a=o[v-1],s=b[b.length-1]),txe(o,b,f,p,d,g&&y,r,_,!0),h=h||g&&y}return n.availability=p,n.position=f,v4(e,n,r),uxe(n,r),h&&(BY(t,n,r),n.polyline.show=d),!0}var fxe={Point:Cgt,LineString:exe,LinearRing:exe,Polygon:Egt,Track:Sgt,MultiTrack:wgt,MultiGeometry:vgt,Model:Dgt},lo;function vgt(e,t,i,n,r,o){let a=i.childNodes,s=!1;for(let i=0,l=a.length;i<l;i++){let l=a.item(i),c=fxe[l.localName];if(u(c)){let i=rxe(l,t,o);i.parent=n,i.name=n.name,i.availability=n.availability,i.description=n.description,i.kml=n.kml,c(e,t,l,i,r)&&(s=!0)}}return s}function Dgt(e,t,i,n,r){return It("kml-unsupportedGeometry",`KML - Unsupported geometry: ${i.localName}`),!1}function Igt(e,t){let i=vi(e,"ExtendedData",Oe.kml);if(!u(i))return;u(vi(i,"SchemaData",Oe.kml))&&It("kml-schemaData","KML - SchemaData is unsupported"),u(us(i,"xmlns:prefix"))&&It("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");let n={},r=Yd(i,"Data",Oe.kml);if(u(r)){let e=r.length;for(let t=0;t<e;t++){let e=r[t],i=us(e,"name");u(i)&&(n[i]={displayName:wn(e,"displayName",Oe.kml),value:wn(e,"value",Oe.kml)})}}t.kml.extendedData=n}function Pgt(e,t,i,n,r){let o,a,s,l,c=t.kml,h=c.extendedData,d=wn(e,"description",Oe.kml),p=y(t.balloonStyle,i.balloonStyle),f=z.WHITE,m=z.BLACK,_=d;if(u(p)&&(f=y(p.bgColor,z.WHITE),m=y(p.textColor,z.BLACK),_=y(p.text,d)),u(_)){if(_=_.replace("$[name]",y(t.name,"")),_=_.replace("$[description]",y(d,"")),_=_.replace("$[address]",y(c.address,"")),_=_.replace("$[Snippet]",y(c.snippet,"")),_=_.replace("$[id]",t.id),_=_.replace("$[geDirections]",""),u(h)){let e=_.match(/\$\[.+?\]/g);if(null!==e)for(o=0;o<e.length;o++){let t=e[o],i=t.substr(2,t.length-3),n=/\/displayName$/.test(i);i=i.replace(/\/displayName$/,""),l=h[i],u(l)&&(l=n?l.displayName:l.value),u(l)&&(_=_.replace(t,y(l,"")))}}}else if(u(h)&&(s=Object.keys(h),s.length>0)){for(_='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',o=0;o<s.length;o++)a=s[o],l=h[a],_+=`<tr><th>${y(l.displayName,a)}</th><td>${y(l.value,"")}</td></tr>`;_+="</tbody></table>"}if(!u(_))return;_=fgt.link(_),lo.innerHTML=_;let g=lo.querySelectorAll("a");for(o=0;o<g.length;o++)g[o].setAttribute("target","_blank");u(n)&&n.keys.length>1&&(bu(lo,"a","href",n),bu(lo,"link","href",n),bu(lo,"area","href",n),bu(lo,"img","src",n),bu(lo,"iframe","src",n),bu(lo,"video","src",n),bu(lo,"audio","src",n),bu(lo,"source","src",n),bu(lo,"track","src",n),bu(lo,"input","src",n),bu(lo,"embed","src",n),bu(lo,"script","src",n),bu(lo,"video","poster",n)),Tu(lo,"a","href",r),Tu(lo,"link","href",r),Tu(lo,"area","href",r),Tu(lo,"img","src",r),Tu(lo,"iframe","src",r),Tu(lo,"video","src",r),Tu(lo,"audio","src",r),Tu(lo,"source","src",r),Tu(lo,"track","src",r),Tu(lo,"input","src",r),Tu(lo,"embed","src",r),Tu(lo,"script","src",r),Tu(lo,"video","poster",r);let v='<div class="cesium-infoBox-description-lighter" style="';v+="overflow:auto;",v+="word-wrap:break-word;",v+=`background-color:${f.toCssColorString()};`,v+=`color:${m.toCssColorString()};`,v+='">',v+=`${lo.innerHTML}</div>`,lo.innerHTML="",t.description=v}function D4(e,t,i){let n=i.entityCollection,r=i.parentEntity,o=i.sourceResource,a=i.uriResolver,s=rxe(t,n,i.context),l=s.kml,c=xgt(e,t,i.styleCollection,o,a),h=wn(t,"name",Oe.kml);s.name=h,s.parent=r;let d=ggt(t);u(d)||(d=_gt(t)),s.availability=d,UY(s);let p=Xd(t,"visibility",Oe.kml);s.show=function e(t){return!t||t.show&&e(t.parent)}(r)&&y(p,!0);let f=vi(t,"author",Oe.atom),m=l.author;m.name=wn(f,"name",Oe.atom),m.uri=wn(f,"uri",Oe.atom),m.email=wn(f,"email",Oe.atom);let _=vi(t,"link",Oe.atom),g=l.link;g.href=us(_,"href"),g.hreflang=us(_,"hreflang"),g.rel=us(_,"rel"),g.type=us(_,"type"),g.title=us(_,"title"),g.length=us(_,"length"),l.address=wn(t,"address",Oe.kml),l.phoneNumber=wn(t,"phoneNumber",Oe.kml),l.snippet=wn(t,"Snippet",Oe.kml),Igt(t,s),Pgt(t,s,c,a,o);let v=e._ellipsoid;return mxe(t,s,v),hxe(t,s,v),u(vi(t,"Region",Oe.kml))&&It("kml-region","KML - Placemark Regions are unsupported"),{entity:s,styleEntity:c}}function dxe(e,t,i,n){n.addNodes(t.childNodes,i),n.process()}function Ogt(e,t,i,n){let r=D4(e,t,i),o=Ge(i);o.parentEntity=r.entity,dxe(e,t,o,n)}function Rgt(e,t,i,n){let r=D4(e,t,i),o=r.entity,a=r.styleEntity,s=!1,l=t.childNodes;for(let t=0,n=l.length;t<n&&!s;t++){let n=l.item(t),r=fxe[n.localName];u(r)&&(r(e,i.entityCollection,n,o,a,o.id),s=!0)}s||(o.merge(a),v4(e,o,a))}typeof document<"u"&&(lo=document.createElement("div"));var Mgt={FlyTo:Fgt,Wait:Ngt,SoundCue:vY,AnimatedUpdate:vY,TourControl:vY};function Lgt(e,t,i,n){let r=wn(t,"name",Oe.kml),o=us(t,"id"),a=new x4(r,o),s=vi(t,"Playlist",Oe.gx);if(s){let t=e._ellipsoid,i=s.childNodes;for(let e=0;e<i.length;e++){let n=i[e];if(n.localName){let e=Mgt[n.localName];e?e(a,n,t):console.log(`Unknown KML Tour playlist entry type ${n.localName}`)}}}e._kmlTours.push(a)}function vY(e,t){It(`KML Tour unsupported node ${t.localName}`)}function Ngt(e,t){let i=$n(t,"duration",Oe.gx);e.addPlaylistEntry(new A4(i))}function Fgt(e,t,i){let n=$n(t,"duration",Oe.gx),r=wn(t,"flyToMode",Oe.gx),o={kml:{}};mxe(t,o,i),hxe(t,o,i);let a=o.kml.lookAt||o.kml.camera,s=new T4(n,r,a);e.addPlaylistEntry(s)}function hxe(e,t,i){let n=vi(e,"Camera",Oe.kml);if(u(n)){let e=y($n(n,"longitude",Oe.kml),0),r=y($n(n,"latitude",Oe.kml),0),o=y($n(n,"altitude",Oe.kml),0),a=y($n(n,"heading",Oe.kml),0),s=y($n(n,"tilt",Oe.kml),0),l=y($n(n,"roll",Oe.kml),0),u=h.fromDegrees(e,r,o,i),c=oc.fromDegrees(a,s-90,l);t.kml.camera=new _4(u,c)}}function mxe(e,t,i){let n=vi(e,"LookAt",Oe.kml);if(u(n)){let e=y($n(n,"longitude",Oe.kml),0),r=y($n(n,"latitude",Oe.kml),0),o=y($n(n,"altitude",Oe.kml),0),a=$n(n,"heading",Oe.kml),s=$n(n,"tilt",Oe.kml),l=y($n(n,"range",Oe.kml),0);s=P.toRadians(y(s,0)),a=P.toRadians(y(a,0));let u=new qf(a,s-P.PI_OVER_TWO,l),c=h.fromDegrees(e,r,o,i);t.kml.lookAt=new g4(c,u)}}function Bgt(e,t,i,n){let r=i.screenOverlayContainer;if(!u(r))return;let o=i.sourceResource,a=i.uriResolver,s=FY(vi(t,"Icon",Oe.kml),e,o,a,!1);if(!u(s))return;let l=document.createElement("img");e._screenOverlays.push(l),l.src=s.url,l.onload=function(){let e,i,n,r,o,a,s=["position: absolute"],c=vi(t,"screenXY",Oe.kml),h=vi(t,"overlayXY",Oe.kml),d=vi(t,"size",Oe.kml);u(d)&&(e=Ly(d,"x"),i=Ly(d,"y"),n=us(d,"xunits"),r=us(d,"yunits"),u(e)&&-1!==e&&0!==e&&("fraction"===n?o=`width: ${Math.floor(100*e)}%`:"pixels"===n&&(o=`width: ${e}px`),s.push(o)),u(i)&&-1!==i&&0!==i&&("fraction"===r?a=`height: ${Math.floor(100*i)}%`:"pixels"===r&&(a=`height: ${i}px`),s.push(a))),l.style=s.join(";");let p=0,f=l.height;u(h)&&(e=Ly(h,"x"),i=Ly(h,"y"),n=us(h,"xunits"),r=us(h,"yunits"),u(e)&&("fraction"===n?p=e*l.width:("pixels"===n||"insetPixels"===n)&&(p=e)),u(i)&&("fraction"===r?f=i*l.height:("pixels"===r||"insetPixels"===r)&&(f=i))),u(c)&&(e=Ly(c,"x"),i=Ly(c,"y"),n=us(c,"xunits"),r=us(c,"yunits"),u(e)&&("fraction"===n?o=`left: calc(${Math.floor(100*e)}% - ${p}px)`:"pixels"===n?o=`left: ${e-p}px`:"insetPixels"===n&&(o=`right: ${e-p}px`),s.push(o)),u(i)&&("fraction"===r?a=`bottom: calc(${Math.floor(100*i)}% - ${f}px)`:"pixels"===r?a=`bottom: ${i-f}px`:"insetPixels"===r&&(a=`top: ${i-f}px`),s.push(a))),l.style=s.join(";")},r.appendChild(l)}function kgt(e,t,i,n){let r,o=D4(e,t,i).entity,a=!1,s=e._ellipsoid,l=C4(vi(t,"LatLonQuad",Oe.gx),s),c=$n(t,"drawOrder",Oe.kml);if(u(l))r=NY(),r.hierarchy=new Pa(l),r.zIndex=c,o.polygon=r,a=!0;else{r=new am,r.zIndex=c,o.rectangle=r;let e=vi(t,"LatLonBox",Oe.kml);if(u(e)){let t=$n(e,"west",Oe.kml),i=$n(e,"south",Oe.kml),n=$n(e,"east",Oe.kml),o=$n(e,"north",Oe.kml);u(t)&&(t=P.negativePiToPi(P.toRadians(t))),u(i)&&(i=P.clampToLatitudeRange(P.toRadians(i))),u(n)&&(n=P.negativePiToPi(P.toRadians(n))),u(o)&&(o=P.clampToLatitudeRange(P.toRadians(o))),r.coordinates=new ce(t,i,n,o);let a=$n(e,"rotation",Oe.kml);if(u(a)){let e=P.toRadians(a);r.rotation=e,r.stRotation=e}}}let h=vi(t,"Icon",Oe.kml),d=FY(h,e,i.sourceResource,i.uriResolver,!0);if(u(d)){a&&It("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");let e=$n(h,"x",Oe.gx),i=$n(h,"y",Oe.gx),n=$n(h,"w",Oe.gx),o=$n(h,"h",Oe.gx);(u(e)||u(i)||u(n)||u(o))&&It("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),r.material=d,r.material.color=sb(t,"color",Oe.kml),r.material.transparent=!0}else r.material=sb(t,"color",Oe.kml);let p=wn(t,"altitudeMode",Oe.kml);u(p)?"absolute"===p?(r.height=$n(t,"altitude",Oe.kml),r.zIndex=void 0):"clampToGround"!==p&&It("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${p}`):(p=wn(t,"altitudeMode",Oe.gx),"relativeToSeaFloor"===p?(It("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),r.height=$n(t,"altitude",Oe.kml),r.zIndex=void 0):"clampToSeaFloor"===p?It("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):u(p)&&It("kml-altitudeMode-unknown",`KML - Unknown altitudeMode: ${p}`))}function pxe(e,t,i,n){e._unsupportedNode.raiseEvent(e,i.parentEntity,t,i.entityCollection,i.styleCollection,i.sourceResource,i.uriResolver),It(`kml-unsupportedFeature-${t.nodeName}`,`KML - Unsupported feature: ${t.nodeName}`)}var Ny={INTERVAL:0,EXPIRE:1,STOP:2};function S4(e){if(!u(e)||0===e.length)return"";let t=e[0];return("&"===t||"?"===t)&&(e=e.substring(1)),e}var Vgt=new ce,NE=new fe,DY=new U,Ugt=new h;function kY(e,t,i,n,r,o){function a(e){return e<-P.PI_OVER_TWO?-P.PI_OVER_TWO:e>P.PI_OVER_TWO?P.PI_OVER_TWO:e}function s(e){return e>P.PI?e-P.TWO_PI:e<-P.PI?e+P.TWO_PI:e}let l=vb(e.queryParameters);if(l=l.replace(/%5B/g,"[").replace(/%5D/g,"]"),u(t)&&t._mode!==te.MORPHING){let e,c;if(r=y(r,Vgt),u(i)&&(DY.x=.5*i.clientWidth,DY.y=.5*i.clientHeight,e=t.pickEllipsoid(DY,o,Ugt)),u(e)?c=o.cartesianToCartographic(e,NE):(c=ce.center(r,NE),e=o.cartographicToCartesian(c)),u(n)&&!P.equalsEpsilon(n,1,P.EPSILON9)){let e=r.width*n*.5,t=r.height*n*.5;r=new ce(s(c.longitude-e),a(c.latitude-t),s(c.longitude+e),a(c.latitude+t))}l=l.replace("[bboxWest]",P.toDegrees(r.west).toString()),l=l.replace("[bboxSouth]",P.toDegrees(r.south).toString()),l=l.replace("[bboxEast]",P.toDegrees(r.east).toString()),l=l.replace("[bboxNorth]",P.toDegrees(r.north).toString());let d=P.toDegrees(c.longitude).toString(),p=P.toDegrees(c.latitude).toString();l=l.replace("[lookatLon]",d),l=l.replace("[lookatLat]",p),l=l.replace("[lookatTilt]",P.toDegrees(t.pitch).toString()),l=l.replace("[lookatHeading]",P.toDegrees(t.heading).toString()),l=l.replace("[lookatRange]",h.distance(t.positionWC,e)),l=l.replace("[lookatTerrainLon]",d),l=l.replace("[lookatTerrainLat]",p),l=l.replace("[lookatTerrainAlt]",c.height.toString()),o.cartesianToCartographic(t.positionWC,NE),l=l.replace("[cameraLon]",P.toDegrees(NE.longitude).toString()),l=l.replace("[cameraLat]",P.toDegrees(NE.latitude).toString()),l=l.replace("[cameraAlt]",P.toDegrees(NE.height).toString());let f=t.frustum,m=f.aspectRatio,_="",g="";if(u(m)){let e=P.toDegrees(f.fov);m>1?(_=e,g=e/m):(g=e,_=e*m)}l=l.replace("[horizFov]",_.toString()),l=l.replace("[vertFov]",g.toString())}else l=l.replace("[bboxWest]","-180"),l=l.replace("[bboxSouth]","-90"),l=l.replace("[bboxEast]","180"),l=l.replace("[bboxNorth]","90"),l=l.replace("[lookatLon]",""),l=l.replace("[lookatLat]",""),l=l.replace("[lookatRange]",""),l=l.replace("[lookatTilt]",""),l=l.replace("[lookatHeading]",""),l=l.replace("[lookatTerrainLon]",""),l=l.replace("[lookatTerrainLat]",""),l=l.replace("[lookatTerrainAlt]",""),l=l.replace("[cameraLon]",""),l=l.replace("[cameraLat]",""),l=l.replace("[cameraAlt]",""),l=l.replace("[horizFov]",""),l=l.replace("[vertFov]","");u(i)?(l=l.replace("[horizPixels]",i.clientWidth),l=l.replace("[vertPixels]",i.clientHeight)):(l=l.replace("[horizPixels]",""),l=l.replace("[vertPixels]","")),l=l.replace("[terrainEnabled]","1"),l=l.replace("[clientVersion]","1"),l=l.replace("[kmlVersion]","2.2"),l=l.replace("[clientName]","Cesium"),l=l.replace("[language]","English"),e.setQueryParameters(wu(l))}function zgt(e,t,i,n){let r=D4(e,t,i).entity,o=i.sourceResource,a=i.uriResolver,s=vi(t,"Link",Oe.kml);if(u(s)||(s=vi(t,"Url",Oe.kml)),u(s)){let t,l,c=wn(s,"href",Oe.kml);if(u(c)){let h=c;if(c=LY(c,o,i.uriResolver),/^data:/.test(c.getUrlComponent()))/\.kmz/i.test(o.getUrlComponent())||(h=o.getDerivedResource({url:h}));else{if(h=c.clone(),t=wn(s,"viewRefreshMode",Oe.kml),"onRegion"===t)return void It("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion");l=y(wn(s,"viewBoundScale",Oe.kml),1);let i="onStop"===t?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",n=y(wn(s,"viewFormat",Oe.kml),i),r=wn(s,"httpQuery",Oe.kml);u(n)&&c.setQueryParameters(wu(S4(n))),u(r)&&c.setQueryParameters(wu(S4(r)));let o=e._ellipsoid;kY(c,e.camera,e.canvas,l,e._lastCameraView.bbox,o)}let d={sourceUri:h,uriResolver:a,context:r.id,screenOverlayContainer:i.screenOverlayContainer},p=new Ks,f=VY(e,p,c,d).then((function(i){let n=e._entityCollection,o=p.values;n.suspendEvents();for(let e=0;e<o.length;e++){let t=o[e];u(t.parent)||(t.parent=r,UY(t)),n.add(t)}n.resumeEvents();let a=wn(s,"refreshMode",Oe.kml),h=y($n(s,"refreshInterval",Oe.kml),0);if("onInterval"===a&&h>0||"onExpire"===a||"onStop"===t){let t=vi(i,"NetworkLinkControl",Oe.kml),n=u(t),o=J.now(),d={id:jn(),href:c,cookie:{},lastUpdated:o,updating:!1,entity:r,viewBoundScale:l,needsUpdate:!1,cameraUpdateTime:o},p=0;if(n&&(d.cookie=wu(y(wn(t,"cookie",Oe.kml),"")),p=y($n(t,"minRefreshPeriod",Oe.kml),0)),"onInterval"===a)n&&(h=Math.max(p,h)),d.refreshMode=Ny.INTERVAL,d.time=h;else if("onExpire"===a){let e;if(n&&(e=wn(t,"expires",Oe.kml)),u(e))try{let t=J.fromIso8601(e),i=J.secondsDifference(t,o);i>0&&i<p&&J.addSeconds(o,p,t),d.refreshMode=Ny.EXPIRE,d.time=t}catch{It("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else It("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else u(e.camera)?(d.refreshMode=Ny.STOP,d.time=y($n(s,"viewRefreshTime",Oe.kml),0)):It("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires the `camera` property to be defined.");u(d.refreshMode)&&e._networkLinks.set(d.id,d)}})).catch((function(t){It(`An error occured during loading ${c.url}`),e._error.raiseEvent(e,t)}));n.addPromise(f)}}}function Hgt(e,t,i,n){let r=MY[t.localName];return u(r)?r(e,t,i,n):pxe(e,t,i,n)}function OY(e,t,i,n,r,o,a){t.removeAll();let s=i.documentElement,l=wn("Document"===s.localName?s:vi(s,"Document",Oe.kml),"name",Oe.kml);u(l)||(l=P_(n.getUrlComponent())),u(e._name)||(e._name=l);let c=new Au._DeferredLoading(e),h=new Ks(e);return Promise.all(cxe(e,i,h,n,!1,r)).then((function(){let s=i.documentElement;if("kml"===s.localName){let e=s.childNodes;for(let t=0;t<e.length;t++){let i=e[t];if(u(MY[i.localName])){s=i;break}}}let l={parentEntity:void 0,entityCollection:t,styleCollection:h,sourceResource:n,uriResolver:r,context:a,screenOverlayContainer:o};return t.suspendEvents(),Hgt(e,s,l,c),t.resumeEvents(),c.wait().then((function(){return i.documentElement}))}))}function Ggt(e,t,i,n,r){let o=$t("ThirdParty/Workers/z-worker-pako.js");SE({workerScripts:{deflate:[o,"./pako_deflate.min.js"],inflate:[o,"./pako_inflate.min.js"]}});let a=new Kz(new nb(i));return Promise.resolve(a.getEntries()).then((function(i){let o,s=[],l={};for(let e=0;e<i.length;e++){let t=i[e];t.directory||(!/\.kml$/i.test(t.filename)||u(o)&&/\//i.test(t.filename)?s.push(wY(t,l)):(u(o)&&s.push(wY(o,l)),o=t))}return u(o)&&s.push(pgt(o,l)),Promise.all(s).then((function(){if(a.close(),!u(l.kml))throw new ue("KMZ file does not contain a KML document.");return l.keys=Object.keys(l),OY(e,t,l.kml,n,l,r)}))}))}function VY(e,t,i,n){let r=(n=y(n,y.EMPTY_OBJECT)).sourceUri,o=n.uriResolver,a=n.context,s=n.screenOverlayContainer,l=i;if("string"==typeof i||i instanceof ve){l=(i=ve.createIfNeeded(i)).fetchBlob(),r=y(r,i.clone());let t=e._resourceCredits,n=i.credits;if(u(n)){let e=n.length;for(let i=0;i<e;i++)t.push(n[i])}}else r=y(r,ve.DEFAULT.clone());return r=ve.createIfNeeded(r),u(s)&&(s=In(s)),Promise.resolve(l).then((function(i){return i instanceof Blob?hgt(i).then((function(n){return n?Ggt(e,t,i,r,s):mgt(i).then((function(i){let n,l;i=oxe(i=ixe(i));try{n=RY.parseFromString(i,"application/xml")}catch(e){l=e.toString()}if(u(l)||n.body||"parsererror"===n.documentElement.tagName){let e=u(l)?l:n.documentElement.firstChild.nodeValue;throw e||(e=n.body.innerText),new ue(e)}return OY(e,t,n,r,o,s,a)}))})):OY(e,t,i,r,o,s,a)})).catch((function(t){return e._error.raiseEvent(e,t),console.log(t),Promise.reject(t)}))}function Au(e){let t=(e=y(e,y.EMPTY_OBJECT)).camera,i=e.canvas;this._changed=new pe,this._error=new pe,this._loading=new pe,this._refresh=new pe,this._unsupportedNode=new pe,this._clock=void 0,this._entityCollection=new Ks(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new F_,this._networkLinks=new bt,this._entityCluster=new bf,this.canvas=i,this.camera=t,this._lastCameraView={position:u(t)?h.clone(t.positionWC):void 0,direction:u(t)?h.clone(t.directionWC):void 0,up:u(t)?h.clone(t.upWC):void 0,bbox:u(t)?t.computeViewRectangle():ce.clone(ce.MAX_VALUE)},this._ellipsoid=y(e.ellipsoid,ie.WGS84);let n=e.credit;"string"==typeof n&&(n=new xt(n)),this._credit=n,this._resourceCredits=[],this._kmlTours=[],this._screenOverlays=[]}function UY(e){let t=e.parent;if(u(t)){let i=t.availability;if(u(i)){let t=e.availability;u(t)?t.intersect(i):e.availability=i}}}function Wgt(e,t,i,n,r){return function(o){if(!n.contains(t.id))return;let a=!1,s=vi(o,"NetworkLinkControl",Oe.kml),l=0;if(u(s)){if(u(vi(s,"Update",Oe.kml)))return It("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),t.updating=!1,void n.remove(t.id);t.cookie=wu(y(wn(s,"cookie",Oe.kml),"")),l=y($n(s,"minRefreshPeriod",Oe.kml),0)}let c=J.now(),h=t.refreshMode;if(h===Ny.INTERVAL)u(s)&&(t.time=Math.max(l,t.time));else if(h===Ny.EXPIRE){let e;if(u(s)&&(e=wn(s,"expires",Oe.kml)),u(e))try{let i=J.fromIso8601(e),n=J.secondsDifference(i,c);n>0&&n<l&&J.addSeconds(c,l,i),t.time=i}catch{It("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),a=!0}else It("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),a=!0}let d=t.entity,p=e._entityCollection,f=i.values;function m(e){p.remove(e);let t=e._children,i=t.length;for(let e=0;e<i;++e)m(t[e])}p.suspendEvents();let _,g=p.values.slice();for(_=0;_<g.length;++_){let e=g[_];e.parent===d&&(e.parent=void 0,m(e))}for(p.resumeEvents(),p.suspendEvents(),_=0;_<f.length;_++){let e=f[_];u(e.parent)||(e.parent=d,UY(e)),p.add(e)}p.resumeEvents(),a?n.remove(t.id):t.lastUpdated=c;let v=p.computeAvailability(),b=v.start,A=v.stop,T=J.equals(b,ze.MINIMUM_VALUE),E=J.equals(A,ze.MAXIMUM_VALUE);if(!T||!E){let t=e._clock;(t.startTime!==b||t.stopTime!==A)&&(t.startTime=b,t.stopTime=A,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,r.getUrlComponent(!0))}}Au.load=function(e,t){return new Au(t=y(t,y.EMPTY_OBJECT)).load(e,t)},Object.defineProperties(Au.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}},credit:{get:function(){return this._credit}},kmlTours:{get:function(){return this._kmlTours}}}),Au.prototype.load=function(e,t){t=y(t,y.EMPTY_OBJECT),Nr.setLoading(this,!0);let i=this._name;this._name=void 0,this._clampToGround=y(t.clampToGround,!1);let n=this;return VY(this,this._entityCollection,e,t).then((function(){let e,t=n._entityCollection.computeAvailability(),r=t.start,o=t.stop,a=J.equals(r,ze.MINIMUM_VALUE),s=J.equals(o,ze.MAXIMUM_VALUE);if(!a||!s){let t;a&&(t=new Date,t.setHours(0,0,0,0),r=J.fromDate(t)),s&&(t=new Date,t.setHours(24,0,0,0),o=J.fromDate(t)),e=new um,e.startTime=r,e.stopTime=o,e.currentTime=J.clone(r),e.clockRange=Dr.LOOP_STOP,e.clockStep=ho.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(J.secondsDifference(o,r)/60,1),31556900))}let l=!1;return e!==n._clock&&(n._clock=e,l=!0),i!==n._name&&(l=!0),l&&n._changed.raiseEvent(n),Nr.setLoading(n,!1),n})).catch((function(e){return Nr.setLoading(n,!1),n._error.raiseEvent(n,e),console.log(e),Promise.reject(e)}))},Au.prototype.destroy=function(){for(;this._screenOverlays.length>0;)this._screenOverlays.pop().remove()};var IY=new bt;function jgt(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}Au.prototype.update=function(e){let t=this._networkLinks;if(0===t.length)return!0;let i=J.now(),n=this;function r(e){let t=e._children,i=t.length;for(let e=0;e<i;++e){let i=t[e];IY.set(i.id,i),r(i)}}IY.removeAll();let o=!1,a=this._lastCameraView,s=this.camera;u(s)&&!(s.positionWC.equalsEpsilon(a.position,P.EPSILON7)&&s.directionWC.equalsEpsilon(a.direction,P.EPSILON7)&&s.upWC.equalsEpsilon(a.up,P.EPSILON7))&&(a.position=h.clone(s.positionWC),a.direction=h.clone(s.directionWC),a.up=h.clone(s.upWC),a.bbox=s.computeViewRectangle(),o=!0);let l=new bt,c=!1;return t.values.forEach((function(e){let t=e.entity;if(!IY.contains(t.id)){if(!e.updating){let s=!1;if(e.refreshMode===Ny.INTERVAL?J.secondsDifference(i,e.lastUpdated)>e.time&&(s=!0):e.refreshMode===Ny.EXPIRE?J.greaterThan(i,e.time)&&(s=!0):e.refreshMode===Ny.STOP&&(o&&(e.needsUpdate=!0,e.cameraUpdateTime=i),e.needsUpdate&&J.secondsDifference(i,e.cameraUpdateTime)>=e.time&&(s=!0)),s){r(t),e.updating=!0;let i=new Ks,o=e.href.clone();o.setQueryParameters(e.cookie);let s=y(n._ellipsoid,ie.WGS84);kY(o,n.camera,n.canvas,e.viewBoundScale,a.bbox,s),VY(n,i,o,{context:t.id}).then(Wgt(n,e,i,l,o)).catch((function(t){let i=`NetworkLink ${e.href} refresh failed: ${t}`;console.log(i),n._error.raiseEvent(n,i)})),c=!0}}l.set(e.id,e)}})),c&&(this._networkLinks=l,this._changed.raiseEvent(this)),!0},Au._DeferredLoading=bm,Au._getTimestamp=_i;var I4=Au;function PI(){de.throwInstantiationError()}PI.prototype.update=de.throwInstantiationError,PI.prototype.getBoundingSphere=de.throwInstantiationError,PI.prototype.isDestroyed=de.throwInstantiationError,PI.prototype.destroy=de.throwInstantiationError;var _xe=PI;function qgt(e){e=y(e,y.EMPTY_OBJECT),this.typedArray=e.typedArray,this.width=e.width,this.height=e.height,this.pixelFormat=y(e.pixelFormat,rt.RGBA),this.pixelDatatype=y(e.pixelDatatype,Ye.UNSIGNED_BYTE);let t=e.url;"string"==typeof t&&(t=ve.createIfNeeded(t)),this.resource=t;let i=y(e.repeat,!0)?vn.REPEAT:vn.CLAMP_TO_EDGE;this.sampler=new un({wrapS:i,wrapT:i,minificationFilter:e.minificationFilter,magnificationFilter:e.magnificationFilter,maximumAnisotropy:e.maximumAnisotropy})}var gxe=qgt,Ygt={FLOAT:"float",VEC2:"vec2",VEC3:"vec3",VEC4:"vec4",MAT2:"mat2",MAT3:"mat2",MAT4:"mat4"},yxe=Object.freeze(Ygt),xxe="uniform sampler2D u_depthTexture;\n\nin vec2 v_textureCoordinates;\n\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window);\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    out_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n";function Xgt(e){return self.onmessage=async function({data:t}){let i=[],n={id:t.id,result:void 0,error:void 0};self.CESIUM_BASE_URL=t.baseUrl;try{let r=await e(t.parameters,i);n.result=r}catch(e){e instanceof Error?n.error={name:e.name,message:e.message,stack:e.stack}:n.error=e}t.canTransferArrayBuffer||(i.length=0);try{postMessage(n,i)}catch(e){n.result=void 0,n.error=`postMessage failed with error: ${Om(e)}\n  with responseMessage: ${JSON.stringify(n)}`,postMessage(n)}},self.onmessageerror=function(e){postMessage({id:e.data?.id,error:`postMessage failed with error: ${JSON.stringify(e)}`})},self}var bxe=Xgt,OI;globalThis.CESIUM_VERSION="1.111",typeof ko<"u"&&(OI=ko),function(e){var t=this||(0,eval)("this"),i=t.document,n=t.navigator,r=t.jQuery,o=t.JSON;r||typeof jQuery>"u"||(r=jQuery),function(a,s){function l(e,t){return(null===e||typeof e in A)&&e===t}function u(t,i){var n;return function(){n||(n=b.a.setTimeout((function(){n=e,t()}),i))}}function c(e,t){var i;return function(){clearTimeout(i),i=b.a.setTimeout(e,t)}}function h(e,t){t&&"change"!==t?"beforeChange"===t?this.pc(e):this.gb(e,t):this.qc(e)}function d(e,t){null!==t&&t.s&&t.s()}function p(e,t){var i=this.qd,n=i[S];n.ra||(this.Qb&&this.mb[t]?(i.uc(t,e,this.mb[t]),this.mb[t]=null,--this.Qb):n.I[t]||i.uc(t,e,n.J?{da:e}:i.$c(e)),e.Ja&&e.gd())}var f,m,_,g,y,v,b=typeof a<"u"?a:{};b.b=function(e,t){for(var i=e.split("."),n=b,r=0;r<i.length-1;r++)n=n[i[r]];n[i[i.length-1]]=t},b.L=function(e,t,i){e[t]=i},b.version="3.5.1",b.b("version",b.version),b.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},b.a=function(){function a(e,t){for(var i in e)c.call(e,i)&&t(i,e[i])}function s(e,t){if(t)for(var i in t)c.call(t,i)&&(e[i]=t[i]);return e}function l(e,t){return e.__proto__=t,e}function u(e,t,i,n){var r=e[t].match(y)||[];b.a.D(i.match(y),(function(e){b.a.Na(r,e,n)})),e[t]=r.join(" ")}var c=Object.prototype.hasOwnProperty,h={__proto__:[]}instanceof Array,d="function"==typeof Symbol,p={},f={};p[n&&/Firefox\/2/i.test(n.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],p.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),a(p,(function(e,t){if(t.length)for(var i=0,n=t.length;i<n;i++)f[t[i]]=e}));var m,_={propertychange:!0},g=i&&function(){for(var t=3,n=i.createElement("div"),r=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",r[0];);return 4<t?t:e}(),y=/\S+/g;return{Jc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],D:function(e,t,i){for(var n=0,r=e.length;n<r;n++)t.call(i,e[n],n,e)},A:"function"==typeof Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t)}:function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},Lb:function(t,i,n){for(var r=0,o=t.length;r<o;r++)if(i.call(n,t[r],r,t))return t[r];return e},Pa:function(e,t){var i=b.a.A(e,t);0<i?e.splice(i,1):0===i&&e.shift()},wc:function(e){var t=[];return e&&b.a.D(e,(function(e){0>b.a.A(t,e)&&t.push(e)})),t},Mb:function(e,t,i){var n=[];if(e)for(var r=0,o=e.length;r<o;r++)n.push(t.call(i,e[r],r));return n},jb:function(e,t,i){var n=[];if(e)for(var r=0,o=e.length;r<o;r++)t.call(i,e[r],r)&&n.push(e[r]);return n},Nb:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var i=0,n=t.length;i<n;i++)e.push(t[i]);return e},Na:function(e,t,i){var n=b.a.A(b.a.bc(e),t);0>n?i&&e.push(t):i||e.splice(n,1)},Ba:h,extend:s,setPrototypeOf:l,Ab:h?l:s,P:a,Ga:function(e,t,i){if(!e)return e;var n,r={};for(n in e)c.call(e,n)&&(r[n]=t.call(i,e[n],n,e));return r},Tb:function(e){for(;e.firstChild;)b.removeNode(e.firstChild)},Yb:function(e){for(var t=((e=b.a.la(e))[0]&&e[0].ownerDocument||i).createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(b.oa(e[n]));return t},Ca:function(e,t){for(var i=0,n=e.length,r=[];i<n;i++){var o=e[i].cloneNode(!0);r.push(t?b.oa(o):o)}return r},va:function(e,t){if(b.a.Tb(e),t)for(var i=0,n=t.length;i<n;i++)e.appendChild(t[i])},Xc:function(e,t){var i=e.nodeType?[e]:e;if(0<i.length){for(var n=i[0],r=n.parentNode,o=0,a=t.length;o<a;o++)r.insertBefore(t[o],n);for(o=0,a=i.length;o<a;o++)b.removeNode(i[o])}},Ua:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var i=e[0],n=e[e.length-1];for(e.length=0;i!==n;)e.push(i),i=i.nextSibling;e.push(n)}}return e},Zc:function(e,t){7>g?e.setAttribute("selected",t):e.selected=t},Db:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Ud:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},vd:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(1!==e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},Sb:function(e){return b.a.vd(e,e.ownerDocument.documentElement)},kd:function(e){return!!b.a.Lb(e,b.a.Sb)},R:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Ac:function(e){return b.onError?function(){try{return e.apply(this,arguments)}catch(e){throw b.onError&&b.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(b.a.Ac(e),t)},Gc:function(e){setTimeout((function(){throw b.onError&&b.onError(e),e}),0)},B:function(e,t,i){var n=b.a.Ac(i);if(i=_[t],b.options.useOnlyNativeEvents||i||!r)if(i||"function"!=typeof e.addEventListener){if(!(typeof e.attachEvent<"u"))throw Error("Browser doesn't support addEventListener or attachEvent");var o=function(t){n.call(e,t)},a="on"+t;e.attachEvent(a,o),b.a.K.za(e,(function(){e.detachEvent(a,o)}))}else e.addEventListener(t,n,!1);else m||(m="function"==typeof r(e).on?"on":"bind"),r(e)[m](t,n)},Fb:function(e,n){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var o;if(o=!("input"!==b.a.R(e)||!e.type||"click"!=n.toLowerCase()||"checkbox"!=(o=e.type)&&"radio"!=o),b.options.useOnlyNativeEvents||!r||o)if("function"==typeof i.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(o=i.createEvent(f[n]||"HTMLEvents")).initEvent(n,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(o)}else if(o&&e.click)e.click();else{if(!(typeof e.fireEvent<"u"))throw Error("Browser doesn't support triggering events");e.fireEvent("on"+n)}else r(e).trigger(n)},f:function(e){return b.O(e)?e():e},bc:function(e){return b.O(e)?e.v():e},Eb:function(e,t,i){var n;t&&("object"==typeof e.classList?(n=e.classList[i?"add":"remove"],b.a.D(t.match(y),(function(t){n.call(e.classList,t)}))):"string"==typeof e.className.baseVal?u(e.className,"baseVal",t,i):u(e,"className",t,i))},Bb:function(t,i){var n=b.a.f(i);(null===n||n===e)&&(n="");var r=b.h.firstChild(t);!r||3!=r.nodeType||b.h.nextSibling(r)?b.h.va(t,[t.ownerDocument.createTextNode(n)]):r.data=n,b.a.Ad(t)},Yc:function(e,t){if(e.name=t,7>=g)try{var n=e.name.replace(/[&<>'"]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}));e.mergeAttributes(i.createElement("<input name='"+n+"'/>"),!1)}catch{}},Ad:function(e){9<=g&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},wd:function(e){if(g){var t=e.style.width;e.style.width=0,e.style.width=t}},Pd:function(e,t){e=b.a.f(e),t=b.a.f(t);for(var i=[],n=e;n<=t;n++)i.push(n);return i},la:function(e){for(var t=[],i=0,n=e.length;i<n;i++)t.push(e[i]);return t},Da:function(e){return d?Symbol(e):e},Zd:6===g,$d:7===g,W:g,Lc:function(e,t){for(var i=b.a.la(e.getElementsByTagName("input")).concat(b.a.la(e.getElementsByTagName("textarea"))),n="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},r=[],o=i.length-1;0<=o;o--)n(i[o])&&r.push(i[o]);return r},Nd:function(e){return"string"==typeof e&&(e=b.a.Db(e))?o&&o.parse?o.parse(e):new Function("return "+e)():null},hc:function(e,t,i){if(!o||!o.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return o.stringify(b.a.f(e),t,i)},Od:function(e,t,n){var r=(n=n||{}).params||{},o=n.includeFields||this.Jc,s=e;if("object"==typeof e&&"form"===b.a.R(e)){s=e.action;for(var l=o.length-1;0<=l;l--)for(var u=b.a.Lc(e,o[l]),c=u.length-1;0<=c;c--)r[u[c].name]=u[c].value}t=b.a.f(t);var h=i.createElement("form");for(var d in h.style.display="none",h.action=s,h.method="post",t)(e=i.createElement("input")).type="hidden",e.name=d,e.value=b.a.hc(b.a.f(t[d])),h.appendChild(e);a(r,(function(e,t){var n=i.createElement("input");n.type="hidden",n.name=e,n.value=t,h.appendChild(n)})),i.body.appendChild(h),n.submitter?n.submitter(h):h.submit(),setTimeout((function(){h.parentNode.removeChild(h)}),0)}}}(),b.b("utils",b.a),b.b("utils.arrayForEach",b.a.D),b.b("utils.arrayFirst",b.a.Lb),b.b("utils.arrayFilter",b.a.jb),b.b("utils.arrayGetDistinctValues",b.a.wc),b.b("utils.arrayIndexOf",b.a.A),b.b("utils.arrayMap",b.a.Mb),b.b("utils.arrayPushAll",b.a.Nb),b.b("utils.arrayRemoveItem",b.a.Pa),b.b("utils.cloneNodes",b.a.Ca),b.b("utils.createSymbolOrString",b.a.Da),b.b("utils.extend",b.a.extend),b.b("utils.fieldsIncludedWithJsonPost",b.a.Jc),b.b("utils.getFormFields",b.a.Lc),b.b("utils.objectMap",b.a.Ga),b.b("utils.peekObservable",b.a.bc),b.b("utils.postJson",b.a.Od),b.b("utils.parseJson",b.a.Nd),b.b("utils.registerEventHandler",b.a.B),b.b("utils.stringifyJson",b.a.hc),b.b("utils.range",b.a.Pd),b.b("utils.toggleDomNodeCssClass",b.a.Eb),b.b("utils.triggerEvent",b.a.Fb),b.b("utils.unwrapObservable",b.a.f),b.b("utils.objectForEach",b.a.P),b.b("utils.addOrRemoveItem",b.a.Na),b.b("utils.setTextContent",b.a.Bb),b.b("unwrap",b.a.f),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var i=Array.prototype.slice.call(arguments,1);return function(){var n=i.slice(0);return n.push.apply(n,arguments),t.apply(e,n)}}),b.a.g=new function(){var t,i,n=0,r="__ko__"+(new Date).getTime(),o={};return b.a.W?(t=function(t,i){var a=t[r];if(!a||"null"===a||!o[a]){if(!i)return e;a=t[r]="ko"+n++,o[a]={}}return o[a]},i=function(e){var t=e[r];return!!t&&(delete o[t],e[r]=null,!0)}):(t=function(e,t){var i=e[r];return!i&&t&&(i=e[r]={}),i},i=function(e){return!!e[r]&&(delete e[r],!0)}),{get:function(e,i){var n=t(e,!1);return n&&n[i]},set:function(i,n,r){(i=t(i,r!==e))&&(i[n]=r)},Ub:function(e,i,n){return(e=t(e,!0))[i]||(e[i]=n)},clear:i,Z:function(){return n+++r}}},b.b("utils.domData",b.a.g),b.b("utils.domData.clear",b.a.g.clear),b.a.K=new function(){function t(t,i){var n=b.a.g.get(t,o);return n===e&&i&&(n=[],b.a.g.set(t,o,n)),n}function i(e){if(i=t(e,!1))for(var i=i.slice(0),r=0;r<i.length;r++)i[r](e);b.a.g.clear(e),b.a.K.cleanExternalData(e),s[e.nodeType]&&n(e.childNodes,!0)}function n(e,t){for(var n,r=[],o=0;o<e.length;o++)if((!t||8===e[o].nodeType)&&(i(r[r.length]=n=e[o]),e[o]!==n))for(;o--&&-1==b.a.A(r,e[o]););}var o=b.a.g.Z(),a={1:!0,8:!0,9:!0},s={1:!0,9:!0};return{za:function(e,i){if("function"!=typeof i)throw Error("Callback must be a function");t(e,!0).push(i)},yb:function(i,n){var r=t(i,!1);r&&(b.a.Pa(r,n),0==r.length&&b.a.g.set(i,o,e))},oa:function(e){return b.u.G((function(){a[e.nodeType]&&(i(e),s[e.nodeType]&&n(e.getElementsByTagName("*")))})),e},removeNode:function(e){b.oa(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){r&&"function"==typeof r.cleanData&&r.cleanData([e])}}},b.oa=b.a.K.oa,b.removeNode=b.a.K.removeNode,b.b("cleanNode",b.oa),b.b("removeNode",b.removeNode),b.b("utils.domNodeDisposal",b.a.K),b.b("utils.domNodeDisposal.addDisposeCallback",b.a.K.za),b.b("utils.domNodeDisposal.removeDisposeCallback",b.a.K.yb),f=[0,"",""],y={thead:m=[1,"<table>","</table>"],tbody:m,tfoot:m,tr:[2,"<table><tbody>","</tbody></table>"],td:_=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:_,option:g=[1,"<select multiple='multiple'>","</select>"],optgroup:g},v=8>=b.a.W,b.a.ua=function(e,n){var o;if(r){if(r.parseHTML)o=r.parseHTML(e,n)||[];else if((o=r.clean([e],n))&&o[0]){for(var a=o[0];a.parentNode&&11!==a.parentNode.nodeType;)a=a.parentNode;a.parentNode&&a.parentNode.removeChild(a)}}else{(o=n)||(o=i),a=o.parentWindow||o.defaultView||t;var s,l=b.a.Db(e).toLowerCase(),u=o.createElement("div");for(s=(l=l.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&y[l[1]]||f,l=s[0],s="ignored<div>"+s[1]+e+s[2]+"</div>","function"==typeof a.innerShiv?u.appendChild(a.innerShiv(s)):(v&&o.body.appendChild(u),u.innerHTML=s,v&&u.parentNode.removeChild(u));l--;)u=u.lastChild;o=b.a.la(u.lastChild.childNodes)}return o},b.a.Md=function(e,t){var i=b.a.ua(e,t);return i.length&&i[0].parentElement||b.a.Yb(i)},b.a.fc=function(t,i){if(b.a.Tb(t),null!==(i=b.a.f(i))&&i!==e)if("string"!=typeof i&&(i=i.toString()),r)r(t).html(i);else for(var n=b.a.ua(i,t.ownerDocument),o=0;o<n.length;o++)t.appendChild(n[o])},b.b("utils.parseHtmlFragment",b.a.ua),b.b("utils.setHtml",b.a.fc),b.aa=function(){function t(e,i){if(e)if(8==e.nodeType)null!=(n=b.aa.Uc(e.nodeValue))&&i.push({ud:e,Kd:n});else if(1==e.nodeType)for(var n=0,r=e.childNodes,o=r.length;n<o;n++)t(r[n],i)}var i={};return{Xb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return i[t]=e,"\x3c!--[ko_memo:"+t+"]--\x3e"},bd:function(t,n){var r=i[t];if(r===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return r.apply(null,n||[]),!0}finally{delete i[t]}},cd:function(e,i){var n=[];t(e,n);for(var r=0,o=n.length;r<o;r++){var a=n[r].ud,s=[a];i&&b.a.Nb(s,i),b.aa.bd(n[r].Kd,s),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},Uc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),b.b("memoization",b.aa),b.b("memoization.memoize",b.aa.Xb),b.b("memoization.unmemoize",b.aa.bd),b.b("memoization.parseMemoText",b.aa.Uc),b.b("memoization.unmemoizeDomNodeAndDescendants",b.aa.cd),b.na=function(){function e(){if(l)for(var e,t=l,i=0;c<l;)if(e=s[c++]){if(c>t){if(5e3<=++i){c=l,b.a.Gc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=l}try{e()}catch(e){b.a.Gc(e)}}}function n(){e(),c=l=s.length=0}var r,o,a,s=[],l=0,u=1,c=0;return t.MutationObserver?(o=n,a=i.createElement("div"),new MutationObserver(o).observe(a,{attributes:!0}),r=function(){a.classList.toggle("foo")}):r=i&&"onreadystatechange"in i.createElement("script")?function(e){var t=i.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,i.documentElement.removeChild(t),t=null,e()},i.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},{scheduler:r,zb:function(e){return l||b.na.scheduler(n),s[l++]=e,u++},cancel:function(e){(e-=u-l)>=c&&e<l&&(s[e]=null)},resetForTesting:function(){var e=l-c;return c=l=s.length=0,e},Sd:e}}(),b.b("tasks",b.na),b.b("tasks.schedule",b.na.zb),b.b("tasks.runEarly",b.na.Sd),b.Ta={throttle:function(e,t){e.throttleEvaluation=t;var i=null;return b.$({read:e,write:function(n){clearTimeout(i),i=b.a.setTimeout((function(){e(n)}),t)}})},rateLimit:function(e,t){var i,n,r;"number"==typeof t?i=t:(i=t.timeout,n=t.method),e.Hb=!1,r="function"==typeof n?n:"notifyWhenChangesStop"==n?c:u,e.ub((function(e){return r(e,i,t)}))},deferred:function(t,i){if(!0!==i)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");t.Hb||(t.Hb=!0,t.ub((function(i){var n,r=!1;return function(){if(!r){b.na.cancel(n),n=b.na.zb(i);try{r=!0,t.notifySubscribers(e,"dirty")}finally{r=!1}}}})))},notify:function(e,t){e.equalityComparer="always"==t?null:l}};var A={undefined:1,boolean:1,number:1,string:1};b.b("extenders",b.Ta),b.ic=function(e,t,i){this.da=e,this.lc=t,this.mc=i,this.Ib=!1,this.fb=this.Jb=null,b.L(this,"dispose",this.s),b.L(this,"disposeWhenNodeIsRemoved",this.l)},b.ic.prototype.s=function(){this.Ib||(this.fb&&b.a.K.yb(this.Jb,this.fb),this.Ib=!0,this.mc(),this.da=this.lc=this.mc=this.Jb=this.fb=null)},b.ic.prototype.l=function(e){this.Jb=e,b.a.K.za(e,this.fb=this.s.bind(this))},b.T=function(){b.a.Ab(this,T),T.qb(this)};var T={qb:function(e){e.U={change:[]},e.sc=1},subscribe:function(e,t,i){var n=this;i=i||"change";var r=new b.ic(n,t?e.bind(t):e,(function(){b.a.Pa(n.U[i],r),n.hb&&n.hb(i)}));return n.Qa&&n.Qa(i),n.U[i]||(n.U[i]=[]),n.U[i].push(r),r},notifySubscribers:function(e,t){if("change"===(t=t||"change")&&this.Gb(),this.Wa(t)){var i="change"===t&&this.ed||this.U[t].slice(0);try{b.u.xc();for(var n,r=0;n=i[r];++r)n.Ib||n.lc(e)}finally{b.u.end()}}},ob:function(){return this.sc},Dd:function(e){return this.ob()!==e},Gb:function(){++this.sc},ub:function(e){var t,i,n,r,o,a=this,s=b.O(a);a.gb||(a.gb=a.notifySubscribers,a.notifySubscribers=h);var l=e((function(){a.Ja=!1,s&&r===a&&(r=a.nc?a.nc():a());var e=i||o&&a.sb(n,r);o=i=t=!1,e&&a.gb(n=r)}));a.qc=function(e,i){i&&a.Ja||(o=!i),a.ed=a.U.change.slice(0),a.Ja=t=!0,r=e,l()},a.pc=function(e){t||(n=e,a.gb(e,"beforeChange"))},a.rc=function(){o=!0},a.gd=function(){a.sb(n,a.v(!0))&&(i=!0)}},Wa:function(e){return this.U[e]&&this.U[e].length},Bd:function(e){if(e)return this.U[e]&&this.U[e].length||0;var t=0;return b.a.P(this.U,(function(e,i){"dirty"!==e&&(t+=i.length)})),t},sb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},toString:function(){return"[object Object]"},extend:function(e){var t=this;return e&&b.a.P(e,(function(e,i){var n=b.Ta[e];"function"==typeof n&&(t=n(t,i)||t)})),t}};b.L(T,"init",T.qb),b.L(T,"subscribe",T.subscribe),b.L(T,"extend",T.extend),b.L(T,"getSubscriptionsCount",T.Bd),b.a.Ba&&b.a.setPrototypeOf(T,Function.prototype),b.T.fn=T,b.Qc=function(e){return null!=e&&"function"==typeof e.subscribe&&"function"==typeof e.notifySubscribers},b.b("subscribable",b.T),b.b("isSubscribable",b.Qc),b.S=b.u=function(){function e(e){n.push(i),i=e}function t(){i=n.pop()}var i,n=[],r=0;return{xc:e,end:t,cc:function(e){if(i){if(!b.Qc(e))throw Error("Only subscribable things can act as dependencies");i.od.call(i.pd,e,e.fd||(e.fd=++r))}},G:function(i,n,r){try{return e(),i.apply(n,r||[])}finally{t()}},qa:function(){if(i)return i.o.qa()},Va:function(){if(i)return i.o.Va()},Ya:function(){if(i)return i.Ya},o:function(){if(i)return i.o}}}(),b.b("computedContext",b.S),b.b("computedContext.getDependenciesCount",b.S.qa),b.b("computedContext.getDependencies",b.S.Va),b.b("computedContext.isInitial",b.S.Ya),b.b("computedContext.registerDependency",b.S.cc),b.b("ignoreDependencies",b.Yd=b.u.G);var E=b.a.Da("_latestValue");b.ta=function(e){function t(){return 0<arguments.length?(t.sb(t[E],arguments[0])&&(t.ya(),t[E]=arguments[0],t.xa()),this):(b.u.cc(t),t[E])}return t[E]=e,b.a.Ba||b.a.extend(t,b.T.fn),b.T.fn.qb(t),b.a.Ab(t,C),b.options.deferUpdates&&b.Ta.deferred(t,!0),t};var C={equalityComparer:l,v:function(){return this[E]},xa:function(){this.notifySubscribers(this[E],"spectate"),this.notifySubscribers(this[E])},ya:function(){this.notifySubscribers(this[E],"beforeChange")}};b.a.Ba&&b.a.setPrototypeOf(C,b.T.fn);var x=b.ta.Ma="__ko_proto__";C[x]=b.ta,b.O=function(e){if((e="function"==typeof e&&e[x])&&e!==C[x]&&e!==b.o.fn[x])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!e},b.Za=function(e){return"function"==typeof e&&(e[x]===C[x]||e[x]===b.o.fn[x]&&e.Nc)},b.b("observable",b.ta),b.b("isObservable",b.O),b.b("isWriteableObservable",b.Za),b.b("isWritableObservable",b.Za),b.b("observable.fn",C),b.L(C,"peek",C.v),b.L(C,"valueHasMutated",C.xa),b.L(C,"valueWillMutate",C.ya),b.Ha=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=b.ta(e),b.a.Ab(e,b.Ha.fn),e.extend({trackArrayChanges:!0})},b.Ha.fn={remove:function(e){for(var t=this.v(),i=[],n="function"!=typeof e||b.O(e)?function(t){return t===e}:e,r=0;r<t.length;r++){var o=t[r];if(n(o)){if(0===i.length&&this.ya(),t[r]!==o)throw Error("Array modified during remove; cannot remove item");i.push(o),t.splice(r,1),r--}}return i.length&&this.xa(),i},removeAll:function(t){if(t===e){var i=this.v(),n=i.slice(0);return this.ya(),i.splice(0,i.length),this.xa(),n}return t?this.remove((function(e){return 0<=b.a.A(t,e)})):[]},destroy:function(e){var t=this.v(),i="function"!=typeof e||b.O(e)?function(t){return t===e}:e;this.ya();for(var n=t.length-1;0<=n;n--){var r=t[n];i(r)&&(r._destroy=!0)}this.xa()},destroyAll:function(t){return t===e?this.destroy((function(){return!0})):t?this.destroy((function(e){return 0<=b.a.A(t,e)})):[]},indexOf:function(e){var t=this();return b.a.A(t,e)},replace:function(e,t){var i=this.indexOf(e);0<=i&&(this.ya(),this.v()[i]=t,this.xa())},sorted:function(e){var t=this().slice(0);return e?t.sort(e):t.sort()},reversed:function(){return this().slice(0).reverse()}},b.a.Ba&&b.a.setPrototypeOf(b.Ha.fn,b.ta.fn),b.a.D("pop push reverse shift sort splice unshift".split(" "),(function(e){b.Ha.fn[e]=function(){var t=this.v();this.ya(),this.zc(t,e,arguments);var i=t[e].apply(t,arguments);return this.xa(),i===t?this:i}})),b.a.D(["slice"],(function(e){b.Ha.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}})),b.Pc=function(e){return b.O(e)&&"function"==typeof e.remove&&"function"==typeof e.push},b.b("observableArray",b.Ha),b.b("isObservableArray",b.Pc),b.Ta.trackArrayChanges=function(t,i){function n(){function e(){if(u){var e,i=[].concat(t.v()||[]);t.Wa("arrayChange")&&((!l||1<u)&&(l=b.a.Pb(a,i,t.Ob)),e=l),a=i,l=null,u=0,e&&e.length&&t.notifySubscribers(e,"arrayChange")}}s?e():(s=!0,o=t.subscribe((function(){++u}),null,"spectate"),a=[].concat(t.v()||[]),l=null,r=t.subscribe(e))}if(t.Ob={},i&&"object"==typeof i&&b.a.extend(t.Ob,i),t.Ob.sparse=!0,!t.zc){var r,o,a,s=!1,l=null,u=0,c=t.Qa,h=t.hb;t.Qa=function(e){c&&c.call(t,e),"arrayChange"===e&&n()},t.hb=function(i){h&&h.call(t,i),"arrayChange"!==i||t.Wa("arrayChange")||(r&&r.s(),o&&o.s(),o=r=null,s=!1,a=e)},t.zc=function(e,t,i){function n(e,t,i){return r[r.length]={status:e,value:t,index:i}}if(s&&!u){var r=[],o=e.length,a=i.length,c=0;switch(t){case"push":c=o;case"unshift":for(t=0;t<a;t++)n("added",i[t],c+t);break;case"pop":c=o-1;case"shift":o&&n("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>i[0]?o+i[0]:i[0]),o),o=1===a?o:Math.min(t+(i[1]||0),o),a=t+a-2,c=Math.max(o,a);for(var h=[],d=[],p=2;t<c;++t,++p)t<o&&d.push(n("deleted",e[t],t)),t<a&&h.push(n("added",i[p],t));b.a.Kc(d,h);break;default:return}l=r}}}};var S=b.a.Da("_state");b.o=b.$=function(t,i,n){function r(){if(0<arguments.length){if("function"!=typeof o)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return o.apply(a.nb,arguments),this}return a.ra||b.u.cc(r),(a.ka||a.J&&r.Xa())&&r.ha(),a.X}if("object"==typeof t?n=t:(n=n||{},t&&(n.read=t)),"function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var o=n.write,a={X:e,sa:!0,ka:!0,rb:!1,jc:!1,ra:!1,wb:!1,J:!1,Wc:n.read,nb:i||n.owner,l:n.disposeWhenNodeIsRemoved||n.l||null,Sa:n.disposeWhen||n.Sa,Rb:null,I:{},V:0,Ic:null};return r[S]=a,r.Nc="function"==typeof o,b.a.Ba||b.a.extend(r,b.T.fn),b.T.fn.qb(r),b.a.Ab(r,w),n.pure?(a.wb=!0,a.J=!0,b.a.extend(r,I)):n.deferEvaluation&&b.a.extend(r,P),b.options.deferUpdates&&b.Ta.deferred(r,!0),a.l&&(a.jc=!0,a.l.nodeType||(a.l=null)),a.J||n.deferEvaluation||r.ha(),a.l&&r.ja()&&b.a.K.za(a.l,a.Rb=function(){r.s()}),r};var w={equalityComparer:l,qa:function(){return this[S].V},Va:function(){var e=[];return b.a.P(this[S].I,(function(t,i){e[i.Ka]=i.da})),e},Vb:function(e){if(!this[S].V)return!1;var t=this.Va();return-1!==b.a.A(t,e)||!!b.a.Lb(t,(function(t){return t.Vb&&t.Vb(e)}))},uc:function(e,t,i){if(this[S].wb&&t===this)throw Error("A 'pure' computed must not be called recursively");this[S].I[e]=i,i.Ka=this[S].V++,i.La=t.ob()},Xa:function(){var e,t,i=this[S].I;for(e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&(t=i[e],this.Ia&&t.da.Ja||t.da.Dd(t.La)))return!0},Jd:function(){this.Ia&&!this[S].rb&&this.Ia(!1)},ja:function(){var e=this[S];return e.ka||0<e.V},Rd:function(){this.Ja?this[S].ka&&(this[S].sa=!0):this.Hc()},$c:function(e){if(e.Hb){var t=e.subscribe(this.Jd,this,"dirty"),i=e.subscribe(this.Rd,this);return{da:e,s:function(){t.s(),i.s()}}}return e.subscribe(this.Hc,this)},Hc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[S].Ic),this[S].Ic=b.a.setTimeout((function(){e.ha(!0)}),t)):e.Ia?e.Ia(!0):e.ha(!0)},ha:function(e){var t=this[S],i=t.Sa,n=!1;if(!t.rb&&!t.ra){if(t.l&&!b.a.Sb(t.l)||i&&i()){if(!t.jc)return void this.s()}else t.jc=!1;t.rb=!0;try{n=this.zd(e)}finally{t.rb=!1}return n}},zd:function(t){var i=this[S],n=!1,r=i.wb?e:!i.V;n={qd:this,mb:i.I,Qb:i.V},b.u.xc({pd:n,od:p,o:this,Ya:r}),i.I={},i.V=0;var o=this.yd(i,n);return i.V?n=this.sb(i.X,o):(this.s(),n=!0),n&&(i.J?this.Gb():this.notifySubscribers(i.X,"beforeChange"),i.X=o,this.notifySubscribers(i.X,"spectate"),!i.J&&t&&this.notifySubscribers(i.X),this.rc&&this.rc()),r&&this.notifySubscribers(i.X,"awake"),n},yd:function(e,t){try{var i=e.Wc;return e.nb?i.call(e.nb):i()}finally{b.u.end(),t.Qb&&!e.J&&b.a.P(t.mb,d),e.sa=e.ka=!1}},v:function(e){var t=this[S];return(t.ka&&(e||!t.V)||t.J&&this.Xa())&&this.ha(),t.X},ub:function(e){b.T.fn.ub.call(this,e),this.nc=function(){return this[S].J||(this[S].sa?this.ha():this[S].ka=!1),this[S].X},this.Ia=function(e){this.pc(this[S].X),this[S].ka=!0,e&&(this[S].sa=!0),this.qc(this,!e)}},s:function(){var t=this[S];!t.J&&t.I&&b.a.P(t.I,(function(e,t){t.s&&t.s()})),t.l&&t.Rb&&b.a.K.yb(t.l,t.Rb),t.I=e,t.V=0,t.ra=!0,t.sa=!1,t.ka=!1,t.J=!1,t.l=e,t.Sa=e,t.Wc=e,this.Nc||(t.nb=e)}},I={Qa:function(e){var t=this,i=t[S];if(!i.ra&&i.J&&"change"==e){if(i.J=!1,i.sa||t.Xa())i.I=null,i.V=0,t.ha()&&t.Gb();else{var n=[];b.a.P(i.I,(function(e,t){n[t.Ka]=e})),b.a.D(n,(function(e,n){var r=i.I[e],o=t.$c(r.da);o.Ka=n,o.La=r.La,i.I[e]=o})),t.Xa()&&t.ha()&&t.Gb()}i.ra||t.notifySubscribers(i.X,"awake")}},hb:function(t){var i=this[S];i.ra||"change"!=t||this.Wa("change")||(b.a.P(i.I,(function(e,t){t.s&&(i.I[e]={da:t.da,Ka:t.Ka,La:t.La},t.s())})),i.J=!0,this.notifySubscribers(e,"asleep"))},ob:function(){var e=this[S];return e.J&&(e.sa||this.Xa())&&this.ha(),b.T.fn.ob.call(this)}},P={Qa:function(e){"change"!=e&&"beforeChange"!=e||this.v()}};b.a.Ba&&b.a.setPrototypeOf(w,b.T.fn);var D=b.ta.Ma;w[D]=b.o,b.Oc=function(e){return"function"==typeof e&&e[D]===w[D]},b.Fd=function(e){return b.Oc(e)&&e[S]&&e[S].wb},b.b("computed",b.o),b.b("dependentObservable",b.o),b.b("isComputed",b.Oc),b.b("isPureComputed",b.Fd),b.b("computed.fn",w),b.L(w,"peek",w.v),b.L(w,"dispose",w.s),b.L(w,"isActive",w.ja),b.L(w,"getDependenciesCount",w.qa),b.L(w,"getDependencies",w.Va),b.xb=function(e,t){return"function"==typeof e?b.o(e,t,{pure:!0}):((e=b.a.extend({},e)).pure=!0,b.o(e,t))},b.b("pureComputed",b.xb),function(){function t(r,o,a){if(a=a||new n,"object"!=typeof(r=o(r))||null===r||r===e||r instanceof RegExp||r instanceof Date||r instanceof String||r instanceof Number||r instanceof Boolean)return r;var s=r instanceof Array?[]:{};return a.save(r,s),i(r,(function(i){var n=o(r[i]);switch(typeof n){case"boolean":case"number":case"string":case"function":s[i]=n;break;case"object":case"undefined":var l=a.get(n);s[i]=l!==e?l:t(n,o,a)}})),s}function i(e,t){if(e instanceof Array){for(var i=0;i<e.length;i++)t(i);"function"==typeof e.toJSON&&t("toJSON")}else for(i in e)t(i)}function n(){this.keys=[],this.values=[]}b.ad=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(e,(function(e){for(var t=0;b.O(e)&&10>t;t++)e=e();return e}))},b.toJSON=function(e,t,i){return e=b.ad(e),b.a.hc(e,t,i)},n.prototype={constructor:n,save:function(e,t){var i=b.a.A(this.keys,e);0<=i?this.values[i]=t:(this.keys.push(e),this.values.push(t))},get:function(t){return 0<=(t=b.a.A(this.keys,t))?this.values[t]:e}}}(),b.b("toJS",b.ad),b.b("toJSON",b.toJSON),b.Wd=function(e,t,i){function n(t){var n=b.xb(e,i).extend({ma:"always"}),r=n.subscribe((function(e){e&&(r.s(),t(e))}));return n.notifySubscribers(n.v()),r}return"function"!=typeof Promise||t?n(t.bind(i)):new Promise(n)},b.b("when",b.Wd),b.w={M:function(t){switch(b.a.R(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?b.a.g.get(t,b.c.options.$b):7>=b.a.W?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?b.w.M(t.options[t.selectedIndex]):e;default:return t.value}},cb:function(t,i,n){switch(b.a.R(t)){case"option":"string"==typeof i?(b.a.g.set(t,b.c.options.$b,e),"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__,t.value=i):(b.a.g.set(t,b.c.options.$b,i),t.__ko__hasDomDataOptionValue__=!0,t.value="number"==typeof i?i:"");break;case"select":(""===i||null===i)&&(i=e);for(var r,o=-1,a=0,s=t.options.length;a<s;++a)if((r=b.w.M(t.options[a]))==i||""===r&&i===e){o=a;break}(n||0<=o||i===e&&1<t.size)&&(t.selectedIndex=o,6===b.a.W&&b.a.setTimeout((function(){t.selectedIndex=o}),0));break;default:(null===i||i===e)&&(i=""),t.value=i}}},b.b("selectExtensions",b.w),b.b("selectExtensions.readValue",b.w.M),b.b("selectExtensions.writeValue",b.w.cb),b.m=function(){function e(e){123===(e=b.a.Db(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,i=[],a=(e+="\n,").match(n),s=[],l=0;if(1<a.length){for(var u,c=0;u=a[c];++c){var h=u.charCodeAt(0);if(44===h){if(0>=l){i.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=l=0,s=[];continue}}else if(58===h){if(!l&&!t&&1===s.length){t=s.pop();continue}}else{if(47===h&&1<u.length&&(47===u.charCodeAt(1)||42===u.charCodeAt(1)))continue;47===h&&c&&1<u.length?(h=a[c-1].match(r))&&!o[h[0]]&&(a=(e=e.substr(e.indexOf(u)+1)).match(n),c=-1,u="/"):40===h||123===h||91===h?++l:41===h||125===h||93===h?--l:t||s.length||34!==h&&39!==h||(u=u.slice(1,-1))}s.push(u)}if(0<l)throw Error("Unbalanced parentheses, braces, or brackets")}return i}var t=["true","false","null","undefined"],i=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,n=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),r=/[\])"'A-Za-z0-9_$]+$/,o={in:1,return:1,typeof:1},a={};return{Ra:[],wa:a,ac:e,vb:function(n,r){function o(e,n){var r;if(!c){var h=b.getBindingHandler(e);if(h&&h.preprocess&&!(n=h.preprocess(n,e,o)))return;(h=a[e])&&(r=n,0<=b.a.A(t,r)?r=!1:(h=r.match(i),r=null!==h&&(h[1]?"Object("+h[1]+")"+h[2]:r)),h=r),h&&l.push("'"+("string"==typeof a[e]?a[e]:e)+"':function(_z){"+r+"=_z}")}u&&(n="function(){return "+n+" }"),s.push("'"+e+"':"+n)}var s=[],l=[],u=(r=r||{}).valueAccessors,c=r.bindingParams,h="string"==typeof n?e(n):n;return b.a.D(h,(function(e){o(e.key||e.unknown,e.value)})),l.length&&o("_ko_property_writers","{"+l.join(",")+" }"),s.join(",")},Id:function(e,t){for(var i=0;i<e.length;i++)if(e[i].key==t)return!0;return!1},eb:function(e,t,i,n,r){e&&b.O(e)?!b.Za(e)||r&&e.v()===n||e(n):(e=t.get("_ko_property_writers"))&&e[i]&&e[i](n)}}}(),b.b("expressionRewriting",b.m),b.b("expressionRewriting.bindingRewriteValidators",b.m.Ra),b.b("expressionRewriting.parseObjectLiteral",b.m.ac),b.b("expressionRewriting.preProcessBindings",b.m.vb),b.b("expressionRewriting._twoWayBindings",b.m.wa),b.b("jsonExpressionRewriting",b.m),b.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",b.m.vb),function(){function e(e){return 8==e.nodeType&&a.test(o?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(o?e.text:e.nodeValue)}function n(i,n){for(var r=i,o=1,a=[];r=r.nextSibling;){if(t(r)&&(b.a.g.set(r,u,!0),0==--o))return a;a.push(r),e(r)&&o++}if(!n)throw Error("Cannot find closing comment tag to match: "+i.nodeValue);return null}function r(e,t){var i=n(e,t);return i?0<i.length?i[i.length-1].nextSibling:e.nextSibling:null}var o=i&&"\x3c!--test--\x3e"===i.createComment("test").text,a=o?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=o?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0},u="__ko_matchedEndComment__";b.h={ea:{},childNodes:function(t){return e(t)?n(t):t.childNodes},Ea:function(t){if(e(t))for(var i=0,n=(t=b.h.childNodes(t)).length;i<n;i++)b.removeNode(t[i]);else b.a.Tb(t)},va:function(t,i){if(e(t)){b.h.Ea(t);for(var n=t.nextSibling,r=0,o=i.length;r<o;r++)n.parentNode.insertBefore(i[r],n)}else b.a.va(t,i)},Vc:function(t,i){var n;e(t)?(n=t.nextSibling,t=t.parentNode):n=t.firstChild,n?i!==n&&t.insertBefore(i,n):t.appendChild(i)},Wb:function(t,i,n){n?(n=n.nextSibling,e(t)&&(t=t.parentNode),n?i!==n&&t.insertBefore(i,n):t.appendChild(i)):b.h.Vc(t,i)},firstChild:function(i){if(e(i))return!i.nextSibling||t(i.nextSibling)?null:i.nextSibling;if(i.firstChild&&t(i.firstChild))throw Error("Found invalid end comment, as the first child of "+i);return i.firstChild},nextSibling:function(i){if(e(i)&&(i=r(i)),i.nextSibling&&t(i.nextSibling)){var n=i.nextSibling;if(t(n)&&!b.a.g.get(n,u))throw Error("Found end comment without a matching opening comment, as child of "+i);return null}return i.nextSibling},Cd:e,Vd:function(e){return(e=(o?e.text:e.nodeValue).match(a))?e[1]:null},Sc:function(i){if(l[b.a.R(i)]){var n=i.firstChild;if(n)do{if(1===n.nodeType){var o,a=null;if(o=n.firstChild)do{if(a)a.push(o);else if(e(o)){var s=r(o,!0);s?o=s:a=[o]}else t(o)&&(a=[o])}while(o=o.nextSibling);if(o=a)for(a=n.nextSibling,s=0;s<o.length;s++)a?i.insertBefore(o[s],a):i.appendChild(o[s])}}while(n=n.nextSibling)}}}}(),b.b("virtualElements",b.h),b.b("virtualElements.allowedBindings",b.h.ea),b.b("virtualElements.emptyNode",b.h.Ea),b.b("virtualElements.insertAfter",b.h.Wb),b.b("virtualElements.prepend",b.h.Vc),b.b("virtualElements.setDomNodeChildren",b.h.va),b.ga=function(){this.nd={}},b.a.extend(b.ga.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||b.j.getComponentNameForNode(e);case 8:return b.h.Cd(e);default:return!1}},getBindings:function(e,t){var i=(i=this.getBindingsString(e,t))?this.parseBindingsString(i,t,e):null;return b.j.tc(i,e,t,!1)},getBindingAccessors:function(e,t){var i=(i=this.getBindingsString(e,t))?this.parseBindingsString(i,t,e,{valueAccessors:!0}):null;return b.j.tc(i,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return b.h.Vd(e);default:return null}},parseBindingsString:function(e,t,i,n){try{var r,o=this.nd,a=e+(n&&n.valueAccessors||"");if(!(r=o[a])){var s,l="with($context){with($data||{}){return{"+b.m.vb(e,n)+"}}}";s=new Function("$context","$element",l),r=o[a]=s}return r(t,i)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),b.ga.instance=new b.ga,b.b("bindingProvider",b.ga),function(){function n(e){var t=(e=b.a.g.get(e,T))&&e.N;t&&(e.N=null,t.Tc())}function o(e,t,i){this.node=e,this.yc=t,this.kb=[],this.H=!1,t.N||b.a.K.za(e,n),i&&i.N&&(i.N.kb.push(e),this.Kb=i)}function a(e){return function(){return e}}function s(e){return e()}function l(e){return b.a.Ga(b.u.G(e),(function(t,i){return function(){return e()[i]}}))}function u(e,t,i){return"function"==typeof e?l(e.bind(null,t,i)):b.a.Ga(e,a)}function c(e,t){return l(this.getBindings.bind(this,e,t))}function h(e,t){var i=b.h.firstChild(t);if(i){var n,r=b.ga.instance,o=r.preprocessNode;if(o){for(;n=i;)i=b.h.nextSibling(n),o.call(r,n);i=b.h.firstChild(t)}for(;n=i;)i=b.h.nextSibling(n),d(e,n)}b.i.ma(t,b.i.H)}function d(e,t){var i=e,n=1===t.nodeType;n&&b.h.Sc(t),(n||b.ga.instance.nodeHasBindings(t))&&(i=f(t,null,e).bindingContextForDescendants),i&&!v[b.a.R(t)]&&h(i,t)}function p(e){var t=[],i={},n=[];return b.a.P(e,(function r(o){if(!i[o]){var a=b.getBindingHandler(o);a&&(a.after&&(n.push(o),b.a.D(a.after,(function(t){if(e[t]){if(-1!==b.a.A(n,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+n.join(", "));r(t)}})),n.length--),t.push({key:o,Mc:a})),i[o]=!0}})),t}function f(t,i,n){var r,o=b.a.g.Ub(t,T,{}),a=o.hd;if(!i){if(a)throw Error("You cannot apply bindings multiple times to the same element.");o.hd=!0}if(a||(o.context=n),o.Zb||(o.Zb={}),i&&"function"!=typeof i)r=i;else{var l=b.ga.instance,u=l.getBindingAccessors||c,h=b.$((function(){return(r=i?i(n,t):u.call(l,t,n))&&(n[_]&&n[_](),n[y]&&n[y]()),r}),null,{l:t});r&&h.ja()||(h=null)}var d,f=n;if(r){var m=function(){return b.a.Ga(h?h():r,s)},g=h?function(e){return function(){return s(h()[e])}}:function(e){return r[e]};m.get=function(e){return r[e]&&s(g(e))},m.has=function(e){return e in r},b.i.H in r&&b.i.subscribe(t,b.i.H,(function(){var e=(0,r[b.i.H])();if(e){var i=b.h.childNodes(t);i.length&&e(i,b.Ec(i[0]))}})),b.i.pa in r&&(f=b.i.Cb(t,n),b.i.subscribe(t,b.i.pa,(function(){var e=(0,r[b.i.pa])();e&&b.h.firstChild(t)&&e(t)}))),o=p(r),b.a.D(o,(function(i){var n=i.Mc.init,o=i.Mc.update,a=i.key;if(8===t.nodeType&&!b.h.ea[a])throw Error("The binding '"+a+"' cannot be used with virtual elements");try{"function"==typeof n&&b.u.G((function(){var i=n(t,g(a),m,f.$data,f);if(i&&i.controlsDescendantBindings){if(d!==e)throw Error("Multiple bindings ("+d+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");d=a}})),"function"==typeof o&&b.$((function(){o(t,g(a),m,f.$data,f)}),null,{l:t})}catch(e){throw e.message='Unable to process binding "'+a+": "+r[a]+'"\nMessage: '+e.message,e}}))}return{shouldBindDescendants:o=d===e,bindingContextForDescendants:o&&f}}function m(t,i){return t&&t instanceof b.fa?t:new b.fa(t,e,e,i)}var _=b.a.Da("_subscribable"),g=b.a.Da("_ancestorBindingInfo"),y=b.a.Da("_dataDependency");b.c={};var v={script:!0,textarea:!0,template:!0};b.getBindingHandler=function(e){return b.c[e]};var A={};b.fa=function(t,i,n,r,o){function a(){var e=h?c():c,t=b.a.f(e);return i?(b.a.extend(l,i),g in i&&(l[g]=i[g])):(l.$parents=[],l.$root=t,l.ko=b),l[_]=s,u?t=l.$data:(l.$rawData=e,l.$data=t),n&&(l[n]=t),r&&r(l,i,t),i&&i[_]&&!b.S.o().Vb(i[_])&&i[_](),d&&(l[y]=d),l.$data}var s,l=this,u=t===A,c=u?e:t,h="function"==typeof c&&!b.O(c),d=o&&o.dataDependency;o&&o.exportDependencies?a():((s=b.xb(a)).v(),s.ja()?s.equalityComparer=null:l[_]=e)},b.fa.prototype.createChildContext=function(e,t,i,n){if(!n&&t&&"object"==typeof t&&(t=(n=t).as,i=n.extend),t&&n&&n.noChildContext){var r="function"==typeof e&&!b.O(e);return new b.fa(A,this,null,(function(n){i&&i(n),n[t]=r?e():e}),n)}return new b.fa(e,this,t,(function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),i&&i(e)}),n)},b.fa.prototype.extend=function(e,t){return new b.fa(A,this,null,(function(t){b.a.extend(t,"function"==typeof e?e(t):e)}),t)};var T=b.a.g.Z();o.prototype.Tc=function(){this.Kb&&this.Kb.N&&this.Kb.N.sd(this.node)},o.prototype.sd=function(e){b.a.Pa(this.kb,e),!this.kb.length&&this.H&&this.Cc()},o.prototype.Cc=function(){this.H=!0,this.yc.N&&!this.kb.length&&(this.yc.N=null,b.a.K.yb(this.node,n),b.i.ma(this.node,b.i.pa),this.Tc())},b.i={H:"childrenComplete",pa:"descendantsComplete",subscribe:function(e,t,i,n,r){var o=b.a.g.Ub(e,T,{});return o.Fa||(o.Fa=new b.T),r&&r.notifyImmediately&&o.Zb[t]&&b.u.G(i,n,[e]),o.Fa.subscribe(i,n,t)},ma:function(t,i){var n=b.a.g.get(t,T);if(n&&(n.Zb[i]=!0,n.Fa&&n.Fa.notifySubscribers(t,i),i==b.i.H))if(n.N)n.N.Cc();else if(n.N===e&&n.Fa&&n.Fa.Wa(b.i.pa))throw Error("descendantsComplete event not supported for bindings on this node")},Cb:function(e,t){var i=b.a.g.Ub(e,T,{});return i.N||(i.N=new o(e,i,t[g])),t[g]==i?t:t.extend((function(e){e[g]=i}))}},b.Td=function(e){return(e=b.a.g.get(e,T))&&e.context},b.ib=function(e,t,i){return 1===e.nodeType&&b.h.Sc(e),f(e,t,m(i))},b.ld=function(e,t,i){return i=m(i),b.ib(e,u(t,i,e),i)},b.Oa=function(e,t){1!==t.nodeType&&8!==t.nodeType||h(m(e),t)},b.vc=function(e,n,o){if(!r&&t.jQuery&&(r=t.jQuery),2>arguments.length){if(!(n=i.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!n||1!==n.nodeType&&8!==n.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");d(m(e,o),n)},b.Dc=function(t){return!t||1!==t.nodeType&&8!==t.nodeType?e:b.Td(t)},b.Ec=function(t){return(t=b.Dc(t))?t.$data:e},b.b("bindingHandlers",b.c),b.b("bindingEvent",b.i),b.b("bindingEvent.subscribe",b.i.subscribe),b.b("bindingEvent.startPossiblyAsyncContentBinding",b.i.Cb),b.b("applyBindings",b.vc),b.b("applyBindingsToDescendants",b.Oa),b.b("applyBindingAccessorsToNode",b.ib),b.b("applyBindingsToNode",b.ld),b.b("contextFor",b.Dc),b.b("dataFor",b.Ec)}(),function(e){function t(t,n){var a,s=Object.prototype.hasOwnProperty.call(r,t)?r[t]:e;s?s.subscribe(n):((s=r[t]=new b.T).subscribe(n),i(t,(function(e,i){var n=!(!i||!i.synchronous);o[t]={definition:e,Gd:n},delete r[t],a||n?s.notifySubscribers(e):b.na.zb((function(){s.notifySubscribers(e)}))})),a=!0)}function i(e,t){n("getConfig",[e],(function(i){i?n("loadComponent",[e,i],(function(e){t(e,i)})):t(null,null)}))}function n(t,i,r,o){o||(o=b.j.loaders.slice(0));var a=o.shift();if(a){var s=a[t];if(s){var l=!1;if(s.apply(a,i.concat((function(e){l?r(null):null!==e?r(e):n(t,i,r,o)})))!==e&&(l=!0,!a.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else n(t,i,r,o)}else r(null)}var r={},o={};b.j={get:function(i,n){var r=Object.prototype.hasOwnProperty.call(o,i)?o[i]:e;r?r.Gd?b.u.G((function(){n(r.definition)})):b.na.zb((function(){n(r.definition)})):t(i,n)},Bc:function(e){delete o[e]},oc:n},b.j.loaders=[],b.b("components",b.j),b.b("components.get",b.j.get),b.b("components.clearCachedDefinition",b.j.Bc)}(),function(){function e(e,t,i,n){function r(){0==--s&&n(o)}var o={},s=2,l=i.template;i=i.viewModel,l?a(t,l,(function(t){b.j.oc("loadTemplate",[e,t],(function(e){o.template=e,r()}))})):r(),i?a(t,i,(function(t){b.j.oc("loadViewModel",[e,t],(function(e){o[c]=e,r()}))})):r()}function n(e,t,i){if("function"==typeof t)i((function(e){return new t(e)}));else if("function"==typeof t[c])i(t[c]);else if("instance"in t){var r=t.instance;i((function(){return r}))}else"viewModel"in t?n(e,t.viewModel,i):e("Unknown viewModel value: "+t)}function r(e){switch(b.a.R(e)){case"script":return b.a.ua(e.text);case"textarea":return b.a.ua(e.value);case"template":if(o(e.content))return b.a.Ca(e.content.childNodes)}return b.a.Ca(e.childNodes)}function o(e){return t.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function a(e,i,n){"string"==typeof i.require?s||t.require?(s||t.require)([i.require],(function(e){e&&"object"==typeof e&&e.Xd&&e.default&&(e=e.default),n(e)})):e("Uses require, but no AMD loader is present"):n(i)}function l(e){return function(t){throw Error("Component '"+e+"': "+t)}}var u={};b.j.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(b.j.tb(e))throw Error("Component "+e+" is already registered");u[e]=t},b.j.tb=function(e){return Object.prototype.hasOwnProperty.call(u,e)},b.j.unregister=function(e){delete u[e],b.j.Bc(e)},b.j.Fc={getConfig:function(e,t){t(b.j.tb(e)?u[e]:null)},loadComponent:function(t,i,n){var r=l(t);a(r,i,(function(i){e(t,r,i,n)}))},loadTemplate:function(e,n,a){if(e=l(e),"string"==typeof n)a(b.a.ua(n));else if(n instanceof Array)a(n);else if(o(n))a(b.a.la(n.childNodes));else if(n.element)if(n=n.element,t.HTMLElement?n instanceof HTMLElement:n&&n.tagName&&1===n.nodeType)a(r(n));else if("string"==typeof n){var s=i.getElementById(n);s?a(r(s)):e("Cannot find element with ID "+n)}else e("Unknown element type: "+n);else e("Unknown template value: "+n)},loadViewModel:function(e,t,i){n(l(e),t,i)}};var c="createViewModel";b.b("components.register",b.j.register),b.b("components.isRegistered",b.j.tb),b.b("components.unregister",b.j.unregister),b.b("components.defaultLoader",b.j.Fc),b.j.loaders.push(b.j.Fc),b.j.dd=u}(),function(){function e(e,i){if(n=e.getAttribute("params")){var n=t.parseBindingsString(n,i,e,{valueAccessors:!0,bindingParams:!0}),r=(n=b.a.Ga(n,(function(t){return b.o(t,null,{l:e})})),b.a.Ga(n,(function(t){var i=t.v();return t.ja()?b.o({read:function(){return b.a.f(t())},write:b.Za(i)&&function(e){t()(e)},l:e}):i})));return Object.prototype.hasOwnProperty.call(r,"$raw")||(r.$raw=n),r}return{$raw:{}}}b.j.getComponentNameForNode=function(e){var t=b.a.R(e);if(b.j.tb(t)&&(-1!=t.indexOf("-")||""+e=="[object HTMLUnknownElement]"||8>=b.a.W&&e.tagName===t))return t},b.j.tc=function(t,i,n,r){if(1===i.nodeType){var o=b.j.getComponentNameForNode(i);if(o){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var a={name:o,params:e(i,n)};t.component=r?function(){return a}:a}}return t};var t=new b.ga;9>b.a.W&&(b.j.register=function(e){return function(t){return e.apply(this,arguments)}}(b.j.register),i.createDocumentFragment=function(e){return function(){var t,i=e(),n=b.j.dd;for(t in n);return i}}(i.createDocumentFragment))}(),function(){function e(e,t,i){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=b.a.Ca(t),b.h.va(i,e)}function t(e,t,i){var n=e.createViewModel;return n?n.call(e,t,i):t}var i=0;b.c.component={init:function(n,r,o,a,s){function l(){var e=u&&u.dispose;"function"==typeof e&&e.call(u),h&&h.s(),c=u=h=null}var u,c,h,d=b.a.la(b.h.childNodes(n));return b.h.Ea(n),b.a.K.za(n,l),b.o((function(){var o,a,p=b.a.f(r());if("string"==typeof p?o=p:(o=b.a.f(p.name),a=b.a.f(p.params)),!o)throw Error("No component name specified");var f=b.i.Cb(n,s),m=c=++i;b.j.get(o,(function(i){if(c===m){if(l(),!i)throw Error("Unknown component '"+o+"'");e(o,i,n);var r=t(i,a,{element:n,templateNodes:d});i=f.createChildContext(r,{extend:function(e){e.$component=r,e.$componentTemplateNodes=d}}),r&&r.koDescendantsComplete&&(h=b.i.subscribe(n,b.i.pa,r.koDescendantsComplete,r)),u=r,b.Oa(i,n)}}))}),null,{l:n}),{controlsDescendantBindings:!0}}},b.h.ea.component=!0}();var O={class:"className",for:"htmlFor"};b.c.attr={update:function(t,i){var n=b.a.f(i())||{};b.a.P(n,(function(i,n){n=b.a.f(n);var r=i.indexOf(":"),o=(r="lookupNamespaceURI"in t&&0<r&&t.lookupNamespaceURI(i.substr(0,r)),!1===n||null===n||n===e);o?r?t.removeAttributeNS(r,i):t.removeAttribute(i):n=n.toString(),8>=b.a.W&&i in O?(i=O[i],o?t.removeAttribute(i):t[i]=n):o||(r?t.setAttributeNS(r,i,n):t.setAttribute(i,n)),"name"===i&&b.a.Yc(t,o?"":n)}))}},b.c.checked={after:["value","attr"],init:function(t,i,n){function r(){var r=t.checked,o=a();if(!b.S.Ya()&&(r||!l&&!b.S.qa())){var u=b.u.G(i);if(c){var d=h?u.v():u,f=p;p=o,f!==o?r&&(b.a.Na(d,o,!0),b.a.Na(d,f,!1)):b.a.Na(d,o,r),h&&b.Za(u)&&u(d)}else s&&(o===e?o=r:r||(o=e)),b.m.eb(u,n,"checked",o,!0)}}function o(){var n=b.a.f(i()),r=a();c?(t.checked=0<=b.a.A(n,r),p=r):t.checked=s&&r===e?!!n:a()===n}var a=b.xb((function(){return n.has("checkedValue")?b.a.f(n.get("checkedValue")):d?n.has("value")?b.a.f(n.get("value")):t.value:void 0})),s="checkbox"==t.type,l="radio"==t.type;if(s||l){var u=i(),c=s&&b.a.f(u)instanceof Array,h=!(c&&u.push&&u.splice),d=l||c,p=c?a():e;l&&!t.name&&b.c.uniqueName.init(t,(function(){return!0})),b.o(r,null,{l:t}),b.a.B(t,"click",r),b.o(o,null,{l:t}),u=e}}},b.m.wa.checked=!0,b.c.checkedValue={update:function(e,t){e.value=b.a.f(t())}},b.c.class={update:function(e,t){var i=b.a.Db(b.a.f(t()));b.a.Eb(e,e.__ko__cssValue,!1),e.__ko__cssValue=i,b.a.Eb(e,i,!0)}},b.c.css={update:function(e,t){var i=b.a.f(t());null!==i&&"object"==typeof i?b.a.P(i,(function(t,i){i=b.a.f(i),b.a.Eb(e,t,i)})):b.c.class.update(e,t)}},b.c.enable={update:function(e,t){var i=b.a.f(t());i&&e.disabled?e.removeAttribute("disabled"):i||e.disabled||(e.disabled=!0)}},b.c.disable={update:function(e,t){b.c.enable.update(e,(function(){return!b.a.f(t())}))}},b.c.event={init:function(e,t,i,n,r){var o=t()||{};b.a.P(o,(function(o){"string"==typeof o&&b.a.B(e,o,(function(e){var a,s=t()[o];if(s){try{var l=b.a.la(arguments);n=r.$data,l.unshift(n),a=s.apply(n,l)}finally{!0!==a&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===i.get(o+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}}))}))}},b.c.foreach={Rc:function(e){return function(){var t=e(),i=b.a.bc(t);return i&&"number"!=typeof i.length?(b.a.f(t),{foreach:i.data,as:i.as,noChildContext:i.noChildContext,includeDestroyed:i.includeDestroyed,afterAdd:i.afterAdd,beforeRemove:i.beforeRemove,afterRender:i.afterRender,beforeMove:i.beforeMove,afterMove:i.afterMove,templateEngine:b.ba.Ma}):{foreach:t,templateEngine:b.ba.Ma}}},init:function(e,t){return b.c.template.init(e,b.c.foreach.Rc(t))},update:function(e,t,i,n,r){return b.c.template.update(e,b.c.foreach.Rc(t),i,n,r)}},b.m.Ra.foreach=!1,b.h.ea.foreach=!0,b.c.hasfocus={init:function(e,t,i){function n(n){e.__ko_hasfocusUpdating=!0;var r=e.ownerDocument;if("activeElement"in r){var o;try{o=r.activeElement}catch{o=r.body}n=o===e}r=t(),b.m.eb(r,i,"hasfocus",n,!0),e.__ko_hasfocusLastValue=n,e.__ko_hasfocusUpdating=!1}var r=n.bind(null,!0),o=n.bind(null,!1);b.a.B(e,"focus",r),b.a.B(e,"focusin",r),b.a.B(e,"blur",o),b.a.B(e,"focusout",o),e.__ko_hasfocusLastValue=!1},update:function(e,t){var i=!!b.a.f(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===i||(i?e.focus():e.blur(),!i&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),b.u.G(b.a.Fb,null,[e,i?"focusin":"focusout"]))}},b.m.wa.hasfocus=!0,b.c.hasFocus=b.c.hasfocus,b.m.wa.hasFocus="hasfocus",b.c.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){b.a.fc(e,t())}},function(){function e(e,t,i){b.c[e]={init:function(e,n,r,o,a){var s,l,u,c,h,d={};if(t){o=r.get("as");var p=r.get("noChildContext");d={as:o,noChildContext:p,exportDependencies:h=!(o&&p)}}return c=(u="render"==r.get("completeOn"))||r.has(b.i.pa),b.o((function(){var r,o=b.a.f(n()),p=!i!=!o,f=!l;(h||p!==s)&&(c&&(a=b.i.Cb(e,a)),p&&((!t||h)&&(d.dataDependency=b.S.o()),r=t?a.createChildContext("function"==typeof o?o:n,d):b.S.qa()?a.extend(null,d):a),f&&b.S.qa()&&(l=b.a.Ca(b.h.childNodes(e),!0)),p?(f||b.h.va(e,b.a.Ca(l)),b.Oa(r,e)):(b.h.Ea(e),u||b.i.ma(e,b.i.H)),s=p)}),null,{l:e}),{controlsDescendantBindings:!0}}},b.m.Ra[e]=!1,b.h.ea[e]=!0}e("if"),e("ifnot",!1,!0),e("with",!0)}(),b.c.let={init:function(e,t,i,n,r){return t=r.extend(t),b.Oa(t,e),{controlsDescendantBindings:!0}}},b.h.ea.let=!0;var L={};b.c.options={init:function(e){if("select"!==b.a.R(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(t,i,n){function r(){return b.a.jb(t.options,(function(e){return e.selected}))}function o(e,t,i){var n=typeof t;return"function"==n?t(e):"string"==n?e[t]:i}function a(e,i){if(f&&c)b.i.ma(t,b.i.H);else if(p.length){var n=0<=b.a.A(p,b.w.M(i[0]));b.a.Zc(i[0],n),f&&!n&&b.u.G(b.a.Fb,null,[t,"change"])}}var s=t.multiple,l=0!=t.length&&s?t.scrollTop:null,u=b.a.f(i()),c=n.get("valueAllowUnset")&&n.has("value"),h=n.get("optionsIncludeDestroyed");i={};var d,p=[];c||(s?p=b.a.Mb(r(),b.w.M):0<=t.selectedIndex&&p.push(b.w.M(t.options[t.selectedIndex]))),u&&(typeof u.length>"u"&&(u=[u]),d=b.a.jb(u,(function(t){return h||t===e||null===t||!b.a.f(t._destroy)})),n.has("optionsCaption")&&null!==(u=b.a.f(n.get("optionsCaption")))&&u!==e&&d.unshift(L));var f=!1;i.beforeRemove=function(e){t.removeChild(e)},u=a,n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(u=function(t,i){a(0,i),b.u.G(n.get("optionsAfterRender"),null,[i[0],t!==L?t:e])}),b.a.ec(t,d,(function(i,r,a){return a.length&&(p=!c&&a[0].selected?[b.w.M(a[0])]:[],f=!0),r=t.ownerDocument.createElement("option"),i===L?(b.a.Bb(r,n.get("optionsCaption")),b.w.cb(r,e)):(a=o(i,n.get("optionsValue"),i),b.w.cb(r,b.a.f(a)),i=o(i,n.get("optionsText"),a),b.a.Bb(r,i)),[r]}),i,u),c||(s?p.length&&r().length<p.length:p.length&&0<=t.selectedIndex?b.w.M(t.options[t.selectedIndex])!==p[0]:p.length||0<=t.selectedIndex)&&b.u.G(b.a.Fb,null,[t,"change"]),(c||b.S.Ya())&&b.i.ma(t,b.i.H),b.a.wd(t),l&&20<Math.abs(l-t.scrollTop)&&(t.scrollTop=l)}},b.c.options.$b=b.a.g.Z(),b.c.selectedOptions={init:function(e,t,i){function n(){var n=t(),r=[];b.a.D(e.getElementsByTagName("option"),(function(e){e.selected&&r.push(b.w.M(e))})),b.m.eb(n,i,"selectedOptions",r)}function r(){var i=b.a.f(t()),n=e.scrollTop;i&&"number"==typeof i.length&&b.a.D(e.getElementsByTagName("option"),(function(e){var t=0<=b.a.A(i,b.w.M(e));e.selected!=t&&b.a.Zc(e,t)})),e.scrollTop=n}if("select"!=b.a.R(e))throw Error("selectedOptions binding applies only to SELECT elements");var o;b.i.subscribe(e,b.i.H,(function(){o?n():(b.a.B(e,"change",n),o=b.o(r,null,{l:e}))}),null,{notifyImmediately:!0})},update:function(){}},b.m.wa.selectedOptions=!0,b.c.style={update:function(t,i){var n=b.a.f(i()||{});b.a.P(n,(function(i,n){if((null===(n=b.a.f(n))||n===e||!1===n)&&(n=""),r)r(t).css(i,n);else if(/^--/.test(i))t.style.setProperty(i,n);else{i=i.replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}));var o=t.style[i];t.style[i]=n,n===o||t.style[i]!=o||isNaN(n)||(t.style[i]=n+"px")}}))}},b.c.submit={init:function(e,t,i,n,r){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");b.a.B(e,"submit",(function(i){var n,o=t();try{n=o.call(r.$data,e)}finally{!0!==n&&(i.preventDefault?i.preventDefault():i.returnValue=!1)}}))}},b.c.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){b.a.Bb(e,t())}},b.h.ea.text=!0,function(){if(t&&t.navigator){var i,n,r,o,a,s=function(e){if(e)return parseFloat(e[1])},l=t.navigator.userAgent;(i=t.opera&&t.opera.version&&parseInt(t.opera.version()))||(a=s(l.match(/Edge\/([^ ]+)$/)))||s(l.match(/Chrome\/([^ ]+)/))||(n=s(l.match(/Version\/([^ ]+) Safari/)))||(r=s(l.match(/Firefox\/([^ ]+)/)))||(o=b.a.W||s(l.match(/MSIE ([^ ]+)/)))||(o=s(l.match(/rv:([^ )]+)/)))}if(8<=o&&10>o)var u=b.a.g.Z(),c=b.a.g.Z(),h=function(e){var t=this.activeElement;(t=t&&b.a.g.get(t,c))&&t(e)},d=function(e,t){var i=e.ownerDocument;b.a.g.get(i,u)||(b.a.g.set(i,u,!0),b.a.B(i,"selectionchange",h)),b.a.g.set(e,c,t)};b.c.textInput={init:function(t,s,l){function u(e,i){b.a.B(t,e,i)}function c(){var i=b.a.f(s());(null===i||i===e)&&(i=""),m!==e&&i===m?b.a.setTimeout(c,4):t.value!==i&&(y=!0,t.value=i,y=!1,_=t.value)}function h(){f||(m=t.value,f=b.a.setTimeout(p,4))}function p(){clearTimeout(f),m=f=e;var i=t.value;_!==i&&(_=i,b.m.eb(s(),l,"textInput",i))}var f,m,_=t.value,g=9==b.a.W?h:p,y=!1;o&&u("keypress",p),11>o&&u("propertychange",(function(e){y||"value"!==e.propertyName||g(e)})),8==o&&(u("keyup",p),u("keydown",p)),d&&(d(t,g),u("dragend",h)),(!o||9<=o)&&u("input",g),5>n&&"textarea"===b.a.R(t)?(u("keydown",h),u("paste",h),u("cut",h)):11>i?u("keydown",h):4>r?(u("DOMAutoComplete",p),u("dragdrop",p),u("drop",p)):a&&"number"===t.type&&u("keydown",h),u("change",p),u("blur",p),b.o(c,null,{l:t})}},b.m.wa.textInput=!0,b.c.textinput={preprocess:function(e,t,i){i("textInput",e)}}}(),b.c.uniqueName={init:function(e,t){if(t()){var i="ko_unique_"+ ++b.c.uniqueName.rd;b.a.Yc(e,i)}}},b.c.uniqueName.rd=0,b.c.using={init:function(e,t,i,n,r){var o;return i.has("as")&&(o={as:i.get("as"),noChildContext:i.get("noChildContext")}),t=r.createChildContext(t,o),b.Oa(t,e),{controlsDescendantBindings:!0}}},b.h.ea.using=!0,b.c.value={init:function(t,i,n){var r=b.a.R(t),o="input"==r;if(!o||"checkbox"!=t.type&&"radio"!=t.type){var a=[],s=n.get("valueUpdate"),l=!1,u=null;s&&(a="string"==typeof s?[s]:b.a.wc(s),b.a.Pa(a,"change"));var c,h,d=function(){u=null,l=!1;var e=i(),r=b.w.M(t);b.m.eb(e,n,"value",r)};!b.a.W||!o||"text"!=t.type||"off"==t.autocomplete||t.form&&"off"==t.form.autocomplete||-1!=b.a.A(a,"propertychange")||(b.a.B(t,"propertychange",(function(){l=!0})),b.a.B(t,"focus",(function(){l=!1})),b.a.B(t,"blur",(function(){l&&d()}))),b.a.D(a,(function(e){var i=d;b.a.Ud(e,"after")&&(i=function(){u=b.w.M(t),b.a.setTimeout(d,0)},e=e.substring(5)),b.a.B(t,e,i)})),c=o&&"file"==t.type?function(){var n=b.a.f(i());null===n||n===e||""===n?t.value="":b.u.G(d)}:function(){var o=b.a.f(i()),a=b.w.M(t);null!==u&&o===u?b.a.setTimeout(c,0):(o!==a||a===e)&&("select"===r?(a=n.get("valueAllowUnset"),b.w.cb(t,o,a),a||o===b.w.M(t)||b.u.G(d)):b.w.cb(t,o))},"select"===r?b.i.subscribe(t,b.i.H,(function(){h?n.get("valueAllowUnset")?c():d():(b.a.B(t,"change",d),h=b.o(c,null,{l:t}))}),null,{notifyImmediately:!0}):(b.a.B(t,"change",d),b.o(c,null,{l:t}))}else b.ib(t,{checkedValue:i})},update:function(){}},b.m.wa.value=!0,b.c.visible={update:function(e,t){var i=b.a.f(t()),n="none"!=e.style.display;i&&!n?e.style.display="":!i&&n&&(e.style.display="none")}},b.c.hidden={update:function(e,t){b.c.visible.update(e,(function(){return!b.a.f(t())}))}},function(e){b.c[e]={init:function(t,i,n,r,o){return b.c.event.init.call(this,t,(function(){var t={};return t[e]=i(),t}),n,r,o)}}}("click"),b.ca=function(){},b.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},b.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},b.ca.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||i).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new b.C.F(n)}if(1==e.nodeType||8==e.nodeType)return new b.C.ia(e);throw Error("Unknown template type: "+e)},b.ca.prototype.renderTemplate=function(e,t,i,n){return e=this.makeTemplateSource(e,n),this.renderTemplateSource(e,t,i,n)},b.ca.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},b.ca.prototype.rewriteTemplate=function(e,t,i){t=t((e=this.makeTemplateSource(e,i)).text()),e.text(t),e.data("isRewritten",!0)},b.b("templateEngine",b.ca),b.kc=function(){function e(e,t,i,n){e=b.m.ac(e);for(var r=b.m.Ra,o=0;o<e.length;o++){var a=e[o].key;if(Object.prototype.hasOwnProperty.call(r,a)){var s=r[a];if("function"==typeof s){if(a=s(e[o].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return i="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+b.m.vb(e,{valueAccessors:!0})+" } })()},'"+i.toLowerCase()+"')",n.createJavaScriptEvaluatorBlock(i)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{xd:function(e,t,i){t.isTemplateRewritten(e,i)||t.rewriteTemplate(e,(function(e){return b.kc.Ld(e,t)}),i)},Ld:function(n,r){return n.replace(t,(function(t,i,n,o,a){return e(a,i,n,r)})).replace(i,(function(t,i){return e(i,"\x3c!-- ko --\x3e","#comment",r)}))},md:function(e,t){return b.aa.Xb((function(i,n){var r=i.nextSibling;r&&r.nodeName.toLowerCase()===t&&b.ib(r,e,n)}))}}}(),b.b("__tr_ambtns",b.kc.md),function(){b.C={},b.C.F=function(e){if(this.F=e){var t=b.a.R(e);this.ab="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},b.C.F.prototype.text=function(){var e=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.F[e];var t=arguments[0];"innerHTML"===e?b.a.fc(this.F,t):this.F[e]=t};var t=b.a.g.Z()+"_";b.C.F.prototype.data=function(e){if(1===arguments.length)return b.a.g.get(this.F,t+e);b.a.g.set(this.F,t+e,arguments[1])};var i=b.a.g.Z();b.C.F.prototype.nodes=function(){var t=this.F;if(0==arguments.length){var n=b.a.g.get(t,i)||{},r=n.lb||(3===this.ab?t.content:4===this.ab?t:e);if(!r||n.jd){var o=this.text();o&&o!==n.bb&&(r=b.a.Md(o,t.ownerDocument),b.a.g.set(t,i,{lb:r,bb:o,jd:!0}))}return r}n=arguments[0],this.ab!==e&&this.text(""),b.a.g.set(t,i,{lb:n})},b.C.ia=function(e){this.F=e},b.C.ia.prototype=new b.C.F,b.C.ia.prototype.constructor=b.C.ia,b.C.ia.prototype.text=function(){if(0==arguments.length){var t=b.a.g.get(this.F,i)||{};return t.bb===e&&t.lb&&(t.bb=t.lb.innerHTML),t.bb}b.a.g.set(this.F,i,{bb:arguments[0]})},b.b("templateSources",b.C),b.b("templateSources.domElement",b.C.F),b.b("templateSources.anonymousTemplate",b.C.ia)}(),function(){function t(e,t,i){var n;for(t=b.h.nextSibling(t);e&&(n=e)!==t;)i(n,e=b.h.nextSibling(n))}function i(e,i){if(e.length){var n=e[0],r=e[e.length-1],o=n.parentNode,a=b.ga.instance,s=a.preprocessNode;if(s){if(t(n,r,(function(e,t){var i=e.previousSibling,o=s.call(a,e);o&&(e===n&&(n=o[0]||t),e===r&&(r=o[o.length-1]||i))})),e.length=0,!n)return;n===r?e.push(n):(e.push(n,r),b.a.Ua(e,o))}t(n,r,(function(e){1!==e.nodeType&&8!==e.nodeType||b.vc(i,e)})),t(n,r,(function(e){1!==e.nodeType&&8!==e.nodeType||b.aa.cd(e,[i])})),b.a.Ua(e,o)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,t,r,o,s){s=s||{};var l=(e&&n(e)||r||{}).ownerDocument,u=s.templateEngine||a;if(b.kc.xd(r,u,l),"number"!=typeof(r=u.renderTemplate(r,o,s,l)).length||0<r.length&&"number"!=typeof r[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(l=!1,t){case"replaceChildren":b.h.va(e,r),l=!0;break;case"replaceNode":b.a.Xc(e,r),l=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}return l&&(i(r,o),s.afterRender&&b.u.G(s.afterRender,null,[r,o[s.as||"$data"]]),"replaceChildren"==t&&b.i.ma(e,b.i.H)),r}function o(e,t,i){return b.O(e)?e():"function"==typeof e?e(t,i):e}var a;b.gc=function(t){if(t!=e&&!(t instanceof b.ca))throw Error("templateEngine must inherit from ko.templateEngine");a=t},b.dc=function(t,i,s,l,u){if(((s=s||{}).templateEngine||a)==e)throw Error("Set a template engine before calling renderTemplate");if(u=u||"replaceChildren",l){var c=n(l);return b.$((function(){var e=i&&i instanceof b.fa?i:new b.fa(i,null,null,null,{exportDependencies:!0}),a=o(t,e.$data,e);e=r(l,u,a,e,s),"replaceNode"==u&&(c=n(l=e))}),null,{Sa:function(){return!c||!b.a.Sb(c)},l:c&&"replaceNode"==u?c.parentNode:c})}return b.aa.Xb((function(e){b.dc(t,i,s,e,"replaceNode")}))},b.Qd=function(t,n,a,s,l){function u(e,t){b.u.G(b.a.ec,null,[s,e,h,a,c,t]),b.i.ma(s,b.i.H)}function c(e,t){i(t,d),a.afterRender&&a.afterRender(t,e),d=null}function h(e,i){d=l.createChildContext(e,{as:p,noChildContext:a.noChildContext,extend:function(e){e.$index=i,p&&(e[p+"Index"]=i)}});var n=o(t,e,d);return r(s,"ignoreTargetNode",n,d,a)}var d,p=a.as,f=!1===a.includeDestroyed||b.options.foreachHidesDestroyed&&!a.includeDestroyed;if(f||a.beforeRemove||!b.Pc(n))return b.$((function(){var t=b.a.f(n)||[];typeof t.length>"u"&&(t=[t]),f&&(t=b.a.jb(t,(function(t){return t===e||null===t||!b.a.f(t._destroy)}))),u(t)}),null,{l:s});u(n.v());var m=n.subscribe((function(e){u(n(),e)}),null,"arrayChange");return m.l(s),m};var s=b.a.g.Z(),l=b.a.g.Z();b.c.template={init:function(e,t){var i=b.a.f(t());if("string"==typeof i||"name"in i)b.h.Ea(e);else if("nodes"in i){if(i=i.nodes||[],b.O(i))throw Error('The "nodes" option must be a plain, non-observable array.');var n=i[0]&&i[0].parentNode;n&&b.a.g.get(n,l)||(n=b.a.Yb(i),b.a.g.set(n,l,!0)),new b.C.ia(e).nodes(n)}else{if(!(0<(i=b.h.childNodes(e)).length))throw Error("Anonymous template defined, but no template content was provided");n=b.a.Yb(i),new b.C.ia(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(t,i,n,r,o){var a=i();n=!0,r=null,"string"==typeof(i=b.a.f(a))?i={}:(a="name"in i?i.name:t,"if"in i&&(n=b.a.f(i.if)),n&&"ifnot"in i&&(n=!b.a.f(i.ifnot)),n&&!a&&(n=!1)),"foreach"in i?r=b.Qd(a,n&&i.foreach||[],i,t,o):n?(n=o,"data"in i&&(n=o.createChildContext(i.data,{as:i.as,noChildContext:i.noChildContext,exportDependencies:!0})),r=b.dc(a,n,i,t)):b.h.Ea(t),o=r,(i=b.a.g.get(t,s))&&"function"==typeof i.s&&i.s(),b.a.g.set(t,s,!o||o.ja&&!o.ja()?e:o)}},b.m.Ra.template=function(e){return 1==(e=b.m.ac(e)).length&&e[0].unknown||b.m.Id(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},b.h.ea.template=!0}(),b.b("setTemplateEngine",b.gc),b.b("renderTemplate",b.dc),b.a.Kc=function(e,t,i){var n,r,o,a,s;if(e.length&&t.length)for(n=r=0;(!i||n<i)&&(a=e[r]);++r){for(o=0;s=t[o];++o)if(a.value===s.value){a.moved=s.index,s.moved=a.index,t.splice(o,1),n=o=0;break}n+=o}},b.a.Pb=function(){function e(e,t,i,n,r){var o,a,s,l,u,c=Math.min,h=Math.max,d=[],p=e.length,f=t.length,m=f-p||1,_=p+f+1;for(o=0;o<=p;o++)for(l=s,d.push(s=[]),u=c(f,o+m),a=h(0,o-1);a<=u;a++)s[a]=a?o?e[o-1]===t[a-1]?l[a-1]:c(l[a]||_,s[a-1]||_)+1:a+1:o+1;for(c=[],h=[],m=[],o=p,a=f;o||a;)f=d[o][a]-1,a&&f===d[o][a-1]?h.push(c[c.length]={status:i,value:t[--a],index:a}):o&&f===d[o-1][a]?m.push(c[c.length]={status:n,value:e[--o],index:o}):(--a,--o,r.sparse||c.push({status:"retained",value:t[a]}));return b.a.Kc(m,h,!r.dontLimitMoves&&10*p),c.reverse()}return function(t,i,n){return n="boolean"==typeof n?{dontLimitMoves:n}:n||{},i=i||[],(t=t||[]).length<i.length?e(t,i,"added","deleted",n):e(i,t,"deleted","added",n)}}(),b.b("utils.compareArrays",b.a.Pb),function(){function t(t,i,n,r,o){var a=[],s=b.$((function(){var e=i(n,o,b.a.Ua(a,t))||[];0<a.length&&(b.a.Xc(a,e),r&&b.u.G(r,null,[n,e,o])),a.length=0,b.a.Nb(a,e)}),null,{l:t,Sa:function(){return!b.a.kd(a)}});return{Y:a,$:s.ja()?s:e}}var i=b.a.g.Z(),n=b.a.g.Z();b.a.ec=function(r,o,a,s,l,u){function c(e){p={Aa:e,pb:b.ta(T++)},v.push(p),y||w.push(p)}function h(e){p=g[e],T!==p.pb.v()&&S.push(p),p.pb(T++),b.a.Ua(p.Y,r),v.push(p)}function d(e,t){if(e)for(var i=0,n=t.length;i<n;i++)b.a.D(t[i].Y,(function(n){e(n,i,t[i].Aa)}))}typeof(o=o||[]).length>"u"&&(o=[o]),s=s||{};var p,f,m,_,g=b.a.g.get(r,i),y=!g,v=[],A=0,T=0,E=[],C=[],x=[],S=[],w=[],I=0;if(y)b.a.D(o,c);else{if(!u||g&&g._countWaitingForRemove){var P=b.a.Mb(g,(function(e){return e.Aa}));u=b.a.Pb(P,o,{dontLimitMoves:s.dontLimitMoves,sparse:!0})}var D,O,L;for(P=0;D=u[P];P++)switch(O=D.moved,L=D.index,D.status){case"deleted":for(;A<L;)h(A++);O===e&&((p=g[A]).$&&(p.$.s(),p.$=e),b.a.Ua(p.Y,r).length&&(s.beforeRemove&&(v.push(p),I++,p.Aa===n?p=null:x.push(p)),p&&E.push.apply(E,p.Y))),A++;break;case"added":for(;T<L;)h(A++);O!==e?(C.push(v.length),h(O)):c(D.value)}for(;T<o.length;)h(A++);v._countWaitingForRemove=I}b.a.g.set(r,i,v),d(s.beforeMove,S),b.a.D(E,s.beforeRemove?b.oa:b.removeNode);try{_=r.ownerDocument.activeElement}catch{}if(C.length)for(;(P=C.shift())!=e;){for(p=v[P],f=e;P;)if((m=v[--P].Y)&&m.length){f=m[m.length-1];break}for(o=0;A=p.Y[o];f=A,o++)b.h.Wb(r,A,f)}for(P=0;p=v[P];P++){for(p.Y||b.a.extend(p,t(r,a,p.Aa,l,p.pb)),o=0;A=p.Y[o];f=A,o++)b.h.Wb(r,A,f);!p.Ed&&l&&(l(p.Aa,p.Y,p.pb),p.Ed=!0,f=p.Y[p.Y.length-1])}for(_&&r.ownerDocument.activeElement!=_&&_.focus(),d(s.beforeRemove,x),P=0;P<x.length;++P)x[P].Aa=n;d(s.afterMove,S),d(s.afterAdd,w)}}(),b.b("utils.setDomNodeChildrenFromArrayMapping",b.a.ec),b.ba=function(){this.allowTemplateRewriting=!1},b.ba.prototype=new b.ca,b.ba.prototype.constructor=b.ba,b.ba.prototype.renderTemplateSource=function(e,t,i,n){return(t=9>b.a.W||!e.nodes?null:e.nodes())?b.a.la(t.cloneNode(!0).childNodes):(e=e.text(),b.a.ua(e,n))},b.ba.Ma=new b.ba,b.gc(b.ba.Ma),b.b("nativeTemplateEngine",b.ba),function(){b.$a=function(){var e=this.Hd=function(){if(!r||!r.tmpl)return 0;try{if(0<=r.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch{}return 1}();this.renderTemplateSource=function(t,n,o,a){if(a=a||i,o=o||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=t.data("precompiled");return s||(s=t.text()||"",s=r.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s)),t=[n.$data],n=r.extend({koBindingContext:n},o.templateOptions),(n=r.tmpl(s,t,n)).appendTo(a.createElement("div")),r.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){i.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(r.tmpl.tag.ko_code={open:"__.push($1 || '');"},r.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},b.$a.prototype=new b.ca,b.$a.prototype.constructor=b.$a;var e=new b.$a;0<e.Hd&&b.gc(e),b.b("jqueryTmplTemplateEngine",b.$a)}()}(t.ko={})}();var Kgt=ko;typeof window<"u"?(ko=window.ko,typeof OI<"u"?window.ko=OI:delete window.ko):(ko=__webpack_require__.g.ko,typeof OI<"u"?__webpack_require__.g.ko=OI:delete __webpack_require__.g.ko);var FE=Kgt,zY="__knockoutObservables",HY="__knockoutSubscribable";
/**
 * @license
 * Knockout ES5 plugin - https://github.com/SteveSanderson/knockout-es5
 * Copyright (c) Steve Sanderson
 * MIT license
 */function Txe(e,t){if(!e)throw new Error("When calling ko.track, you must pass an object as the first parameter.");var i=this,n=Axe(e,!0);return(t=t||Object.getOwnPropertyNames(e)).forEach((function(t){if(t!==zY&&t!==HY&&!(t in n)){var r=e[t],o=r instanceof Array,a=i.isObservable(r)?r:o?i.observableArray(r):i.observable(r);Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:a,set:i.isWriteableObservable(a)?a:void 0}),n[t]=a,o&&$gt(i,a)}})),e}function Axe(e,t){var i=e[zY];return!i&&t&&(i={},Object.defineProperty(e,zY,{value:i})),i}function Zgt(e,t,i){var n={owner:e,deferEvaluation:!0};if("function"==typeof i)n.read=i;else{if("value"in i)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if("function"!=typeof i.get)throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');n.read=i.get,n.write=i.set}return e[t]=this.computed(n),Txe.call(this,e,[t]),e}function $gt(e,t){var i=null;e.computed((function(){i&&(i.dispose(),i=null);var n=t();n instanceof Array&&(i=Qgt(e,t,n))}))}function Qgt(e,t,i){return Jgt(e,i).subscribe(t)}function Jgt(e,t){var i=t[HY];if(!i){i=new e.subscribable,Object.defineProperty(t,HY,{value:i});var n={};eyt(t,i,n),tyt(e,t,i,n)}return i}function eyt(e,t,i){["pop","push","reverse","shift","sort","splice","unshift"].forEach((function(n){var r=e[n];e[n]=function(){var e=r.apply(this,arguments);return!0!==i.pause&&t.notifySubscribers(this),e}}))}function tyt(e,t,i,n){["remove","removeAll","destroy","destroyAll","replace"].forEach((function(r){Object.defineProperty(t,r,{enumerable:!1,value:function(){var o;n.pause=!0;try{o=e.observableArray.fn[r].apply(e.observableArray(t),arguments)}finally{n.pause=!1}return i.notifySubscribers(t),o}})}))}function Cxe(e,t){if(!e)return null;var i=Axe(e,!1);return i&&i[t]||null}function nyt(e,t){var i=Cxe(e,t);i&&i.valueHasMutated()}function iyt(e){e.track=Txe,e.getObservable=Cxe,e.valueHasMutated=nyt,e.defineProperty=Zgt}var P4={attachToKo:iyt},Exe="http://www.w3.org/2000/svg",Sxe="cesium-svgPath-svg",oyt={register:function(e){e.bindingHandlers.cesiumSvgPath={init:function(t,i){let n=document.createElementNS(Exe,"svg:svg");n.setAttribute("class",Sxe);let r=document.createElementNS(Exe,"path");return n.appendChild(r),e.virtualElements.setDomNodeChildren(t,[n]),e.computed({read:function(){let t=e.unwrap(i());r.setAttribute("d",e.unwrap(t.path));let o=e.unwrap(t.width),a=e.unwrap(t.height);n.setAttribute("width",o),n.setAttribute("height",a),n.setAttribute("viewBox",`0 0 ${o} ${a}`),t.css&&n.setAttribute("class",`${Sxe} ${e.unwrap(t.css)}`)},disposeWhenNodeIsRemoved:t}),{controlsDescendantBindings:!0}}},e.virtualElements.allowedBindings.cesiumSvgPath=!0}},O4=oyt;P4.attachToKo(FE),O4.register(FE);var Te=FE;function RI(e){u(e)||(e=new ph),this._clock=e,this._eventHelper=new Pr,this._eventHelper.add(e.onTick,this.synchronize,this),this.systemTime=Te.observable(J.now()),this.systemTime.equalityComparer=J.equals,this.startTime=Te.observable(e.startTime),this.startTime.equalityComparer=J.equals,this.startTime.subscribe((function(t){e.startTime=t,this.synchronize()}),this),this.stopTime=Te.observable(e.stopTime),this.stopTime.equalityComparer=J.equals,this.stopTime.subscribe((function(t){e.stopTime=t,this.synchronize()}),this),this.currentTime=Te.observable(e.currentTime),this.currentTime.equalityComparer=J.equals,this.currentTime.subscribe((function(t){e.currentTime=t,this.synchronize()}),this),this.multiplier=Te.observable(e.multiplier),this.multiplier.subscribe((function(t){e.multiplier=t,this.synchronize()}),this),this.clockStep=Te.observable(e.clockStep),this.clockStep.subscribe((function(t){e.clockStep=t,this.synchronize()}),this),this.clockRange=Te.observable(e.clockRange),this.clockRange.subscribe((function(t){e.clockRange=t,this.synchronize()}),this),this.canAnimate=Te.observable(e.canAnimate),this.canAnimate.subscribe((function(t){e.canAnimate=t,this.synchronize()}),this),this.shouldAnimate=Te.observable(e.shouldAnimate),this.shouldAnimate.subscribe((function(t){e.shouldAnimate=t,this.synchronize()}),this),Te.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}Object.defineProperties(RI.prototype,{clock:{get:function(){return this._clock}}}),RI.prototype.synchronize=function(){let e=this._clock;this.systemTime=J.now(),this.startTime=e.startTime,this.stopTime=e.stopTime,this.currentTime=e.currentTime,this.multiplier=e.multiplier,this.clockStep=e.clockStep,this.clockRange=e.clockRange,this.canAnimate=e.canAnimate,this.shouldAnimate=e.shouldAnimate},RI.prototype.isDestroyed=function(){return!1},RI.prototype.destroy=function(){this._eventHelper.removeAll(),le(this)};var R4=RI;function ryt(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,de.throwInstantiationError()}var wxe=ryt;function syt(e,t){t=y(t,!0);let i=new pe,n=new pe;function r(){let t,r={args:arguments,cancel:!1};return i.raiseEvent(r),r.cancel||(t=e.apply(null,arguments),n.raiseEvent(t)),t}return r.canExecute=t,Te.track(r,["canExecute"]),Object.defineProperties(r,{beforeExecute:{value:i},afterExecute:{value:n}}),r}var En=syt,MI={createCheckbox:function(e,t,i){let n=document.createElement("div"),r=document.createElement("label"),o=document.createElement("input");o.type="checkbox";let a=`checked: ${t}`;return u(i)&&(a+=`, enable: ${i}`),o.setAttribute("data-bind",a),r.appendChild(o),r.appendChild(document.createTextNode(e)),n.appendChild(r),n},createSection:function(e,t,i,n){let r=document.createElement("div");r.className="cesium-cesiumInspector-section",r.setAttribute("data-bind",`css: { "cesium-cesiumInspector-section-collapsed": !${i} }`),e.appendChild(r);let o=document.createElement("h3");o.className="cesium-cesiumInspector-sectionHeader",o.appendChild(document.createTextNode(t)),o.setAttribute("data-bind",`click: ${n}`),r.appendChild(o);let a=document.createElement("div");return a.className="cesium-cesiumInspector-sectionContent",r.appendChild(a),a},createRangeInput:function(e,t,i,n,r,o){o=y(o,t);let a=document.createElement("input");a.setAttribute("data-bind",`value: ${o}`),a.type="number";let s=document.createElement("input");s.type="range",s.min=i,s.max=n,s.step=y(r,"any"),s.setAttribute("data-bind",`valueUpdate: "input", value: ${t}`);let l=document.createElement("div");l.appendChild(s);let u=document.createElement("div");return u.className="cesium-cesiumInspector-slider",u.appendChild(document.createTextNode(e)),u.appendChild(a),u.appendChild(l),u},createButton:function(e,t,i){let n=document.createElement("button");n.type="button",n.textContent=e,n.className="cesium-cesiumInspector-pickButton";let r=`click: ${t}`;return u(i)&&(r+=`, css: {"cesium-cesiumInspector-pickButtonHighlight" : ${i}}`),n.setAttribute("data-bind",r),n}},Ja=MI;function ayt(e,t,i,n,r){return i.call(n,e[t]),Te.getObservable(e,t).subscribe(i,n,r)}var ya=ayt;function vxe(e,t){this._command=e,t=y(t,y.EMPTY_OBJECT),this.toggled=y(t.toggled,!1),this.tooltip=y(t.tooltip,""),Te.track(this,["toggled","tooltip"])}Object.defineProperties(vxe.prototype,{command:{get:function(){return this._command}}});var ab=vxe,cb="http://www.w3.org/2000/svg",Pxe="http://www.w3.org/1999/xlink",M4,LI=z.fromCssColorString("rgba(247,250,255,0.384)"),L4=z.fromCssColorString("rgba(143,191,255,0.216)"),GY=z.fromCssColorString("rgba(153,197,255,0.098)"),N4=z.fromCssColorString("rgba(255,255,255,0.086)"),cyt=z.fromCssColorString("rgba(255,255,255,0.267)"),lyt=z.fromCssColorString("rgba(255,255,255,0)"),Dxe=z.fromCssColorString("rgba(66,67,68,0.3)"),Ixe=z.fromCssColorString("rgba(0,0,0,0.5)");function Fy(e){return z.fromCssColorString(window.getComputedStyle(e).getPropertyValue("color"))}var NI={animation_pathReset:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},animation_pathPause:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},animation_pathPlay:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},animation_pathPlayReverse:{tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},animation_pathLoop:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},animation_pathClock:{tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},animation_pathWingButton:{tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},animation_pathPointer:{tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},animation_pathSwooshFX:{tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}};function Kd(e){let t=document.createElementNS(cb,e.tagName);for(let i in e)if(e.hasOwnProperty(i)&&"tagName"!==i)if("children"===i){let i=e.children.length;for(let n=0;n<i;++n)t.appendChild(Kd(e.children[n]))}else 0===i.indexOf("xlink:")?t.setAttributeNS(Pxe,i.substring(6),e[i]):"textContent"===i?t.textContent=e[i]:t.setAttribute(i,e[i]);return t}function WY(e,t,i){let n=document.createElementNS(cb,"text");n.setAttribute("x",e),n.setAttribute("y",t),n.setAttribute("class","cesium-animation-svgText");let r=document.createElementNS(cb,"tspan");return r.textContent=i,n.appendChild(r),n}function uyt(e,t,i){e.setAttribute("transform",`translate(100,100) rotate(${i})`),t.setAttribute("transform",`rotate(${i})`)}var F4=new z;function Fr(e,t){let i=t.alpha,n=1-i;return F4.red=e.red*n+t.red*i,F4.green=e.green*n+t.green*i,F4.blue=e.blue*n+t.blue*i,F4.toCssColorString()}function jY(e,t,i){let n=NI[i];return Kd({tagName:"g",class:"cesium-animation-rectButton",transform:`translate(${e},${t})`,children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{class:"cesium-animation-buttonPath",id:i,tagName:n.tagName,transform:n.transform,d:n.d},{tagName:"title",textContent:""}]})}function fyt(e,t,i){let n=NI[i],r=NI.animation_pathWingButton;return Kd({tagName:"g",class:"cesium-animation-rectButton",transform:`translate(${e},${t})`,children:[{class:"cesium-animation-buttonGlow",id:"animation_pathWingButton",tagName:r.tagName,d:r.d},{class:"cesium-animation-buttonMain",id:"animation_pathWingButton",tagName:r.tagName,d:r.d},{class:"cesium-animation-buttonPath",id:i,tagName:n.tagName,transform:n.transform,d:n.d},{tagName:"title",textContent:""}]})}function dyt(e,t){let i=e._viewModel,n=i.shuttleRingDragging;if(!n||M4===e)if("mousedown"===t.type||n&&"mousemove"===t.type||"touchstart"===t.type&&1===t.touches.length||n&&"touchmove"===t.type&&1===t.touches.length){let r,o,a=e._centerX,s=e._centerY,l=e._svgNode.getBoundingClientRect();if("touchstart"===t.type||"touchmove"===t.type?(r=t.touches[0].clientX,o=t.touches[0].clientY):(r=t.clientX,o=t.clientY),!n&&(r>l.right||r<l.left||o<l.top||o>l.bottom))return;let u=e._shuttleRingPointer.getBoundingClientRect(),c=r-a-l.left,h=o-s-l.top,d=180*Math.atan2(h,c)/Math.PI+90;d>180&&(d-=360);let p=i.shuttleRingAngle;n||r<u.right&&r>u.left&&o>u.top&&o<u.bottom?(M4=e,i.shuttleRingDragging=!0,i.shuttleRingAngle=d):d<p?i.slower():d>p&&i.faster(),t.preventDefault()}else e===M4&&(M4=void 0),i.shuttleRingDragging=!1}function e_(e,t){this._viewModel=t,this.svgElement=e,this._enabled=void 0,this._toggled=void 0;let i=this;this._clickFunction=function(){let e=i._viewModel.command;e.canExecute&&e()},e.addEventListener("click",this._clickFunction,!0),this._subscriptions=[ya(t,"toggled",this.setToggled,this),ya(t,"tooltip",this.setTooltip,this),ya(t.command,"canExecute",this.setEnabled,this)]}function BE(e,t){e=In(e),this._viewModel=t,this._container=e,this._centerX=0,this._centerY=0,this._defsElement=void 0,this._svgNode=void 0,this._topG=void 0,this._lastHeight=void 0,this._lastWidth=void 0;let i=e.ownerDocument,n=document.createElement("style");n.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }",i.head.insertBefore(n,i.head.childNodes[0]);let r=document.createElement("div");r.className="cesium-animation-theme",r.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>',this._theme=r,this._themeNormal=r.childNodes[0],this._themeHover=r.childNodes[1],this._themeSelect=r.childNodes[2],this._themeDisabled=r.childNodes[3],this._themeKnob=r.childNodes[4],this._themePointer=r.childNodes[5],this._themeSwoosh=r.childNodes[6],this._themeSwooshHover=r.childNodes[7];let o=document.createElementNS(cb,"svg:svg");this._svgNode=o,o.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",Pxe);let a=document.createElementNS(cb,"g");this._topG=a,this._realtimeSVG=new e_(fyt(3,4,"animation_pathClock"),t.playRealtimeViewModel),this._playReverseSVG=new e_(jY(44,99,"animation_pathPlayReverse"),t.playReverseViewModel),this._playForwardSVG=new e_(jY(124,99,"animation_pathPlay"),t.playForwardViewModel),this._pauseSVG=new e_(jY(84,99,"animation_pathPause"),t.pauseViewModel);let s=document.createElementNS(cb,"g");s.appendChild(this._realtimeSVG.svgElement),s.appendChild(this._playReverseSVG.svgElement),s.appendChild(this._playForwardSVG.svgElement),s.appendChild(this._pauseSVG.svgElement);let l=Kd({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=l;let u=NI.animation_pathSwooshFX,c=NI.animation_pathPointer,h=Kd({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:u.tagName,transform:"translate(100,97) scale(-1,1)",id:"animation_pathSwooshFX",d:u.d},{tagName:u.tagName,transform:"translate(100,97)",id:"animation_pathSwooshFX",d:u.d},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=h,this._shuttleRingPointer=Kd({class:"cesium-animation-shuttleRingPointer",id:"animation_pathPointer",tagName:c.tagName,d:c.d});let d=Kd({tagName:"g",transform:"translate(100,100)"});this._knobOuter=Kd({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});let p=Kd({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:61});this._knobDate=WY(0,-24,""),this._knobTime=WY(0,-7,""),this._knobStatus=WY(0,-41,"");let f=Kd({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:61}),m=document.createElementNS(cb,"g");m.setAttribute("class","cesium-animation-shuttleRingG"),e.appendChild(r),a.appendChild(m),a.appendChild(d),a.appendChild(s),m.appendChild(l),m.appendChild(h),m.appendChild(this._shuttleRingPointer),d.appendChild(this._knobOuter),d.appendChild(p),d.appendChild(this._knobDate),d.appendChild(this._knobTime),d.appendChild(this._knobStatus),d.appendChild(f),o.appendChild(a),e.appendChild(o);let _=this;function g(e){dyt(_,e)}this._mouseCallback=g,l.addEventListener("mousedown",g,!0),l.addEventListener("touchstart",g,!0),h.addEventListener("mousedown",g,!0),h.addEventListener("touchstart",g,!0),i.addEventListener("mousemove",g,!0),i.addEventListener("touchmove",g,!0),i.addEventListener("mouseup",g,!0),i.addEventListener("touchend",g,!0),i.addEventListener("touchcancel",g,!0),this._shuttleRingPointer.addEventListener("mousedown",g,!0),this._shuttleRingPointer.addEventListener("touchstart",g,!0),this._knobOuter.addEventListener("mousedown",g,!0),this._knobOuter.addEventListener("touchstart",g,!0);let y,v=this._knobTime.childNodes[0],b=this._knobDate.childNodes[0],A=this._knobStatus.childNodes[0];this._subscriptions=[ya(t.pauseViewModel,"toggled",(function(e){y!==e&&(y=e,y?_._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer"):_._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer"))})),ya(t,"shuttleRingAngle",(function(e){uyt(_._shuttleRingPointer,_._knobOuter,e)})),ya(t,"dateLabel",(function(e){b.textContent!==e&&(b.textContent=e)})),ya(t,"timeLabel",(function(e){v.textContent!==e&&(v.textContent=e)})),ya(t,"multiplierLabel",(function(e){A.textContent!==e&&(A.textContent=e)}))],this.applyThemeChanges(),this.resize()}e_.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,!0);let e=this._subscriptions;for(let t=0,i=e.length;t<i;t++)e[t].dispose();le(this)},e_.prototype.isDestroyed=function(){return!1},e_.prototype.setEnabled=function(e){if(this._enabled!==e){if(this._enabled=e,!e)return void this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");if(this._toggled)return void this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");this.svgElement.setAttribute("class","cesium-animation-rectButton")}},e_.prototype.setToggled=function(e){this._toggled!==e&&(this._toggled=e,this._enabled&&(e?this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled"):this.svgElement.setAttribute("class","cesium-animation-rectButton")))},e_.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e},Object.defineProperties(BE.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),BE.prototype.isDestroyed=function(){return!1},BE.prototype.destroy=function(){u(this._observer)&&(this._observer.disconnect(),this._observer=void 0);let e=this._container.ownerDocument,t=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",t,!0),this._shuttleRingBackPanel.removeEventListener("touchstart",t,!0),this._shuttleRingSwooshG.removeEventListener("mousedown",t,!0),this._shuttleRingSwooshG.removeEventListener("touchstart",t,!0),e.removeEventListener("mousemove",t,!0),e.removeEventListener("touchmove",t,!0),e.removeEventListener("mouseup",t,!0),e.removeEventListener("touchend",t,!0),e.removeEventListener("touchcancel",t,!0),this._shuttleRingPointer.removeEventListener("mousedown",t,!0),this._shuttleRingPointer.removeEventListener("touchstart",t,!0),this._knobOuter.removeEventListener("mousedown",t,!0),this._knobOuter.removeEventListener("touchstart",t,!0),this._container.removeChild(this._svgNode),this._container.removeChild(this._theme),this._realtimeSVG.destroy(),this._playReverseSVG.destroy(),this._playForwardSVG.destroy(),this._pauseSVG.destroy();let i=this._subscriptions;for(let e=0,t=i.length;e<t;e++)i[e].dispose();return le(this)},BE.prototype.resize=function(){let e=this._container.clientWidth,t=this._container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight)return;let i=this._svgNode,n=200,r=132,o=e,a=t;0===e&&0===t?(o=n,a=r):0===e?(a=t,o=n*(t/r)):0===t&&(o=e,a=r*(e/n));let s=o/n,l=a/r;i.style.cssText=`width: ${o}px; height: ${a}px; position: absolute; bottom: 0; left: 0; overflow: hidden;`,i.setAttribute("width",o),i.setAttribute("height",a),i.setAttribute("viewBox",`0 0 ${o} ${a}`),this._topG.setAttribute("transform",`scale(${s},${l})`),this._centerX=Math.max(1,100*s),this._centerY=Math.max(1,100*l),this._lastHeight=e,this._lastWidth=t},BE.prototype.applyThemeChanges=function(){let e=this._container.ownerDocument;if(!e.body.contains(this._container)){if(u(this._observer))return;let t=this;return t._observer=new MutationObserver((function(){e.body.contains(t._container)&&(t._observer.disconnect(),t._observer=void 0,t.applyThemeChanges())})),void t._observer.observe(e,{childList:!0,subtree:!0})}let t=Fy(this._themeNormal),i=Fy(this._themeHover),n=Fy(this._themeSelect),r=Fy(this._themeDisabled),o=Fy(this._themeKnob),a=Fy(this._themePointer),s=Fy(this._themeSwoosh),l=Fy(this._themeSwooshHover),c=Kd({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":Fr(t,LI)},{tagName:"stop",offset:"12%","stop-color":Fr(t,L4)},{tagName:"stop",offset:"46%","stop-color":Fr(t,GY)},{tagName:"stop",offset:"81%","stop-color":Fr(t,N4)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":Fr(i,LI)},{tagName:"stop",offset:"12%","stop-color":Fr(i,L4)},{tagName:"stop",offset:"46%","stop-color":Fr(i,GY)},{tagName:"stop",offset:"81%","stop-color":Fr(i,N4)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":Fr(n,LI)},{tagName:"stop",offset:"12%","stop-color":Fr(n,L4)},{tagName:"stop",offset:"46%","stop-color":Fr(n,GY)},{tagName:"stop",offset:"81%","stop-color":Fr(n,N4)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":Fr(r,cyt)},{tagName:"stop",offset:"75%","stop-color":Fr(r,lyt)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":s.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":l.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":l.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":Fr(a,Ixe)},{tagName:"stop",offset:"100%","stop-color":Fr(a,Ixe)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":Fr(o,LI)},{tagName:"stop",offset:"60%","stop-color":Fr(o,Dxe)},{tagName:"stop",offset:"85%","stop-color":Fr(o,L4)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":Fr(o,Dxe)},{tagName:"stop",offset:"60%","stop-color":Fr(o,LI)},{tagName:"stop",offset:"85%","stop-color":Fr(o,N4)}]}]});u(this._defsElement)?this._svgNode.replaceChild(c,this._defsElement):this._svgNode.appendChild(c),this._defsElement=c};var B4=BE,hyt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],By=15,kE=105;function Oxe(e,t){return e-t}function qY(e,t){let i=Eo(t,e,Oxe);return i<0?~i:i}function myt(e,t){if(Math.abs(e)<=By)return e/By;let i,n,r=By,o=kE;return e>0?(i=Math.log(t[t.length-1]),n=(i-0)/(o-r),Math.exp(0+n*(e-r))):(i=Math.log(-t[0]),n=(i-0)/(o-r),-Math.exp(0+n*(Math.abs(e)-r)))}function pyt(e,t,i){if(i.clockStep===ho.SYSTEM_CLOCK)return By;if(Math.abs(e)<=1)return e*By;let n=t[t.length-1];e>n?e=n:e<-n&&(e=-n);let r,o,a=By,s=kE;return e>0?(r=Math.log(n),o=(r-0)/(s-a),(Math.log(e)-0)/o+a):(r=Math.log(-t[0]),o=(r-0)/(s-a),-((Math.log(Math.abs(e))-0)/o+a))}function If(e){let t=this;this._clockViewModel=e,this._allShuttleRingTicks=[],this._dateFormatter=If.defaultDateFormatter,this._timeFormatter=If.defaultTimeFormatter,this.shuttleRingDragging=!1,this.snapToTicks=!1,Te.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]),this._sortedFilteredPositiveTicks=[],this.setShuttleRingTicks(If.defaultTicks),this.timeLabel=void 0,Te.defineProperty(this,"timeLabel",(function(){return t._timeFormatter(t._clockViewModel.currentTime,t)})),this.dateLabel=void 0,Te.defineProperty(this,"dateLabel",(function(){return t._dateFormatter(t._clockViewModel.currentTime,t)})),this.multiplierLabel=void 0,Te.defineProperty(this,"multiplierLabel",(function(){let e=t._clockViewModel;if(e.clockStep===ho.SYSTEM_CLOCK)return"Today";let i=e.multiplier;return i%1==0?`${i.toFixed(0)}x`:`${i.toFixed(3).replace(/0{0,3}$/,"")}x`})),this.shuttleRingAngle=void 0,Te.defineProperty(this,"shuttleRingAngle",{get:function(){return pyt(e.multiplier,t._allShuttleRingTicks,e)},set:function(e){e=Math.max(Math.min(e,kE),-kE);let i=t._allShuttleRingTicks,n=t._clockViewModel;if(n.clockStep=ho.SYSTEM_CLOCK_MULTIPLIER,Math.abs(e)===kE)return void(n.multiplier=e>0?i[i.length-1]:i[0]);let r=myt(e,i);if(t.snapToTicks)r=i[qY(r,i)];else if(0!==r){let e=Math.abs(r);if(e>100){let t=e.toFixed(0).length-2,i=Math.pow(10,t);r=Math.round(r/i)*i|0}else e>By?r=Math.round(r):e>1?r=+r.toFixed(1):e>0&&(r=+r.toFixed(2))}n.multiplier=r}}),this._canAnimate=void 0,Te.defineProperty(this,"_canAnimate",(function(){let e=t._clockViewModel,i=e.clockRange;if(t.shuttleRingDragging||i===Dr.UNBOUNDED)return!0;let n=e.multiplier,r=e.currentTime,o=e.startTime,a=!1;if(i===Dr.LOOP_STOP)a=J.greaterThan(r,o)||r.equals(o)&&n>0;else{let t=e.stopTime;a=J.greaterThan(r,o)&&J.lessThan(r,t)||r.equals(o)&&n>0||r.equals(t)&&n<0}return a||(e.shouldAnimate=!1),a})),this._isSystemTimeAvailable=void 0,Te.defineProperty(this,"_isSystemTimeAvailable",(function(){let e=t._clockViewModel;if(e.clockRange===Dr.UNBOUNDED)return!0;let i=e.systemTime;return J.greaterThanOrEquals(i,e.startTime)&&J.lessThanOrEquals(i,e.stopTime)})),this._isAnimating=void 0,Te.defineProperty(this,"_isAnimating",(function(){return t._clockViewModel.shouldAnimate&&(t._canAnimate||t.shuttleRingDragging)}));let i=En((function(){let e=t._clockViewModel;e.shouldAnimate?e.shouldAnimate=!1:t._canAnimate&&(e.shouldAnimate=!0)}));this._pauseViewModel=new ab(i,{toggled:Te.computed((function(){return!t._isAnimating})),tooltip:"Pause"});let n=En((function(){let e=t._clockViewModel,i=e.multiplier;i>0&&(e.multiplier=-i),e.shouldAnimate=!0}));this._playReverseViewModel=new ab(n,{toggled:Te.computed((function(){return t._isAnimating&&e.multiplier<0})),tooltip:"Play Reverse"});let r=En((function(){let e=t._clockViewModel,i=e.multiplier;i<0&&(e.multiplier=-i),e.shouldAnimate=!0}));this._playForwardViewModel=new ab(r,{toggled:Te.computed((function(){return t._isAnimating&&e.multiplier>0&&e.clockStep!==ho.SYSTEM_CLOCK})),tooltip:"Play Forward"});let o=En((function(){t._clockViewModel.clockStep=ho.SYSTEM_CLOCK}),Te.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new ab(o,{toggled:Te.computed((function(){return e.clockStep===ho.SYSTEM_CLOCK})),tooltip:Te.computed((function(){return t._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"}))}),this._slower=En((function(){let e=t._clockViewModel,i=t._allShuttleRingTicks,n=qY(e.multiplier,i)-1;n>=0&&(e.multiplier=i[n])})),this._faster=En((function(){let e=t._clockViewModel,i=t._allShuttleRingTicks,n=qY(e.multiplier,i)+1;n<i.length&&(e.multiplier=i[n])}))}If.defaultDateFormatter=function(e,t){let i=J.toGregorianDate(e);return`${hyt[i.month-1]} ${i.day} ${i.year}`},If.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800],If.defaultTimeFormatter=function(e,t){let i=J.toGregorianDate(e),n=Math.round(i.millisecond);return Math.abs(t._clockViewModel.multiplier)<1?`${i.hour.toString().padStart(2,"0")}:${i.minute.toString().padStart(2,"0")}:${i.second.toString().padStart(2,"0")}.${n.toString().padStart(3,"0")}`:`${i.hour.toString().padStart(2,"0")}:${i.minute.toString().padStart(2,"0")}:${i.second.toString().padStart(2,"0")} UTC`},If.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)},If.prototype.setShuttleRingTicks=function(e){let t,i,n,r={},o=this._sortedFilteredPositiveTicks;for(o.length=0,t=0,i=e.length;t<i;++t)n=e[t],r.hasOwnProperty(n)||(r[n]=!0,o.push(n));o.sort(Oxe);let a=[];for(i=o.length,t=i-1;t>=0;--t)n=o[t],0!==n&&a.push(-n);Array.prototype.push.apply(a,o),this._allShuttleRingTicks=a},Object.defineProperties(If.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){this._timeFormatter=e}}}),If._maxShuttleRingAngle=kE,If._realtimeShuttleRingAngle=By;var k4=If;function V4(e,t){u(t)||(t=document.body),t=In(t);let i=this,n=Te.observable(hr.fullscreen),r=Te.observable(hr.enabled),o=t.ownerDocument;this.isFullscreen=void 0,Te.defineProperty(this,"isFullscreen",{get:function(){return n()}}),this.isFullscreenEnabled=void 0,Te.defineProperty(this,"isFullscreenEnabled",{get:function(){return r()},set:function(e){r(e&&hr.enabled)}}),this.tooltip=void 0,Te.defineProperty(this,"tooltip",(function(){return this.isFullscreenEnabled?n()?"Exit full screen":"Full screen":"Full screen unavailable"})),this._command=En((function(){hr.fullscreen?hr.exitFullscreen():hr.requestFullscreen(i._fullscreenElement)}),Te.getObservable(this,"isFullscreenEnabled")),this._fullscreenElement=y(In(e),o.body),this._callback=function(){n(hr.fullscreen)},o.addEventListener(hr.changeEventName,this._callback)}Object.defineProperties(V4.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){this._fullscreenElement=e}},command:{get:function(){return this._command}}}),V4.prototype.isDestroyed=function(){return!1},V4.prototype.destroy=function(){document.removeEventListener(hr.changeEventName,this._callback),le(this)};var U4=V4,_yt="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z",gyt="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";function z4(e,t){e=In(e);let i=new U4(t,e);i._exitFullScreenPath=gyt,i._enterFullScreenPath=_yt;let n=document.createElement("button");n.type="button",n.className="cesium-button cesium-fullscreenButton",n.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }"),e.appendChild(n),Te.applyBindings(i,n),this._container=e,this._viewModel=i,this._element=n}Object.defineProperties(z4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),z4.prototype.isDestroyed=function(){return!1},z4.prototype.destroy=function(){return this._viewModel.destroy(),Te.cleanNode(this._element),this._container.removeChild(this._element),le(this)};var H4=z4,Rxe=1e3;function Pf(e){u(e.geocoderServices)?this._geocoderServices=e.geocoderServices:this._geocoderServices=[new nO({scene:e.scene})],this._viewContainer=e.container,this._scene=e.scene,this._flightDuration=e.flightDuration,this._searchText="",this._isSearchInProgress=!1,this._wasGeocodeCancelled=!1,this._previousCredits=[],this._complete=new pe,this._suggestions=[],this._selectedSuggestion=void 0,this._showSuggestions=!0,this._handleArrowDown=Lxe,this._handleArrowUp=Mxe;let t=this;this._suggestionsVisible=Te.pureComputed((function(){let e=Te.getObservable(t,"_suggestions")().length>0,i=Te.getObservable(t,"_showSuggestions")();return e&&i})),this._searchCommand=En((function(e){return e=y(e,y0.SEARCH),t._focusTextbox=!1,u(t._selectedSuggestion)?(t.activateSuggestion(t._selectedSuggestion),!1):(t.hideSuggestions(),t.isSearchInProgress?void Cyt(t):Tyt(t,t._geocoderServices,e))})),this.deselectSuggestion=function(){t._selectedSuggestion=void 0},this.handleKeyDown=function(e,t){let i="ArrowDown"===t.key||"Down"===t.key||40===t.keyCode,n="ArrowUp"===t.key||"Up"===t.key||38===t.keyCode;return(i||n)&&t.preventDefault(),!0},this.handleKeyUp=function(e,i){let n="ArrowDown"===i.key||"Down"===i.key||40===i.keyCode,r="ArrowUp"===i.key||"Up"===i.key||38===i.keyCode,o="Enter"===i.key||13===i.keyCode;return r?Mxe(t):n?Lxe(t):o&&t._searchCommand(),!0},this.activateSuggestion=function(e){t.hideSuggestions(),t._searchText=e.displayName;let i=e.destination;Bxe(t),t.destinationFound(t,i)},this.hideSuggestions=function(){t._showSuggestions=!1,t._selectedSuggestion=void 0},this.showSuggestions=function(){t._showSuggestions=!0},this.handleMouseover=function(e,i){e!==t._selectedSuggestion&&(t._selectedSuggestion=e)},this.keepExpanded=!1,this.autoComplete=y(e.autocomplete,!0),this.destinationFound=y(e.destinationFound,Pf.flyToDestination),this._focusTextbox=!1,Te.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);let i=Te.getObservable(this,"_searchText");i.extend({rateLimit:{timeout:500}}),this._suggestionSubscription=i.subscribe((function(){Pf._updateSearchSuggestions(t)})),this.isSearchInProgress=void 0,Te.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}}),this.searchText=void 0,Te.defineProperty(this,"searchText",{get:function(){return this.isSearchInProgress?"Searching...":this._searchText},set:function(e){this._searchText=e}}),this.flightDuration=void 0,Te.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(e){this._flightDuration=e}})}function Mxe(e){if(0===e._suggestions.length)return;let t=e._suggestions.indexOf(e._selectedSuggestion);if(-1===t||0===t)return void(e._selectedSuggestion=void 0);let i=t-1;e._selectedSuggestion=e._suggestions[i],Pf._adjustSuggestionsScroll(e,i)}function Lxe(e){if(0===e._suggestions.length)return;let t=e._suggestions.length,i=(e._suggestions.indexOf(e._selectedSuggestion)+1)%t;e._selectedSuggestion=e._suggestions[i],Pf._adjustSuggestionsScroll(e,i)}function yyt(e,t){let i=u(t)?t.availability:void 0;return u(i)?j_(t,[e]).then((function(t){return(e=t[0]).height+=Rxe,e})):(e.height+=Rxe,Promise.resolve(e))}function xyt(e,t){let i,n=e._scene,r=n.mapProjection.ellipsoid,o=n.camera,a=n.terrainProvider,s=t;return t instanceof ce?P.equalsEpsilon(t.south,t.north,P.EPSILON7)&&P.equalsEpsilon(t.east,t.west,P.EPSILON7)?t=ce.center(t):i=tC(t,n):t=r.cartesianToCartographic(t),u(i)||(i=yyt(t,a)),i.then((function(e){s=r.cartographicToCartesian(e)})).finally((function(){o.flyTo({destination:s,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:L.IDENTITY})}))}async function byt(e,t,i){try{return{state:"fulfilled",value:await e.geocode(t,i),credits:e.credit}}catch(e){return{state:"rejected",reason:e}}}async function Tyt(e,t,i){let n,r,o=e._searchText;if(Fxe(o))return void e.showSuggestions();for(e._isSearchInProgress=!0,e._wasGeocodeCancelled=!1,n=0;n<t.length;n++){if(e._wasGeocodeCancelled)return;if(r=await byt(t[n],o,i),u(r)&&"fulfilled"===r.state&&r.value.length>0)break}if(e._wasGeocodeCancelled)return;e._isSearchInProgress=!1,XY(e);let a=r.value;if("fulfilled"===r.state&&u(a)&&a.length>0){e._searchText=a[0].displayName,e.destinationFound(e,a[0].destination);let i=Nxe(e,PS.getCreditsFromResult(a[0]));u(i)||YY(e,t[n].credit)}else e._searchText=`${o} (not found)`}function YY(e,t){u(t)&&!e._scene.isDestroyed()&&!e._scene.frameState.creditDisplay.isDestroyed()&&(e._scene.frameState.creditDisplay.addStaticCredit(t),e._previousCredits.push(t))}function Nxe(e,t){return u(t)&&t.forEach((t=>YY(e,t))),t}function XY(e){!e._scene.isDestroyed()&&!e._scene.frameState.creditDisplay.isDestroyed()&&e._previousCredits.forEach((t=>{e._scene.frameState.creditDisplay.removeStaticCredit(t)})),e._previousCredits.length=0}function Ayt(e,t){let i=In(e._viewContainer),n=i.getElementsByClassName("search-results")[0],r=i.getElementsByTagName("li")[t];if(0===t)return void(n.scrollTop=0);let o=r.offsetTop;o+r.clientHeight>n.clientHeight?n.scrollTop=o+r.clientHeight:o<n.scrollTop&&(n.scrollTop=o)}function Cyt(e){e._isSearchInProgress&&(e._isSearchInProgress=!1,e._wasGeocodeCancelled=!0)}function Fxe(e){return/^\s*$/.test(e)}function Bxe(e){Te.getObservable(e,"_suggestions").removeAll()}async function Eyt(e){if(!e.autoComplete)return;let t=e._searchText;if(Bxe(e),XY(e),!Fxe(t))for(let i of e._geocoderServices){let n=await i.geocode(t,y0.AUTOCOMPLETE);if(e._suggestions=e._suggestions.concat(n),n.length>0){let t=!0;n.forEach((i=>{let n=PS.getCreditsFromResult(i);t=t&&!u(n),Nxe(e,n)})),t&&YY(e,i.credit)}if(e._suggestions.length>=5)return}}Object.defineProperties(Pf.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}}),Pf.prototype.destroy=function(){this._suggestionSubscription.dispose()},Pf.flyToDestination=xyt,Pf._updateSearchSuggestions=Eyt,Pf._adjustSuggestionsScroll=Ayt,Pf.prototype.isDestroyed=function(){return!1},Pf.prototype.destroy=function(){return XY(this),le(this)};var G4=Pf,Syt="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z",wyt="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";function W4(e){let t=In(e.container),i=new G4(e);i._startSearchPath=Syt,i._stopSearchPath=wyt;let n=document.createElement("form");n.setAttribute("data-bind","submit: search");let r=document.createElement("input");r.type="search",r.className="cesium-geocoder-input",r.setAttribute("placeholder","Enter an address or landmark..."),r.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox'),this._onTextBoxFocus=function(){setTimeout((function(){r.select()}),0)},r.addEventListener("focus",this._onTextBoxFocus,!1),n.appendChild(r),this._textBox=r;let o=document.createElement("span");o.className="cesium-geocoder-searchButton",o.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }"),n.appendChild(o),t.appendChild(n);let a=document.createElement("div");a.className="search-results",a.setAttribute("data-bind","visible: _suggestionsVisible");let s=document.createElement("ul");s.setAttribute("data-bind","foreach: _suggestions");let l=document.createElement("li");s.appendChild(l),l.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }"),a.appendChild(s),t.appendChild(a),Te.applyBindings(i,n),Te.applyBindings(i,a),this._container=t,this._searchSuggestionsContainer=a,this._viewModel=i,this._form=n,this._onInputBegin=function(e){let n=e.target;"function"==typeof e.composedPath&&(n=e.composedPath()[0]),t.contains(n)||(i._focusTextbox=!1,i.hideSuggestions())},this._onInputEnd=function(e){i._focusTextbox=!0,i.showSuggestions()},Bt.supportsPointerEvents()?(document.addEventListener("pointerdown",this._onInputBegin,!0),t.addEventListener("pointerup",this._onInputEnd,!0),t.addEventListener("pointercancel",this._onInputEnd,!0)):(document.addEventListener("mousedown",this._onInputBegin,!0),t.addEventListener("mouseup",this._onInputEnd,!0),document.addEventListener("touchstart",this._onInputBegin,!0),t.addEventListener("touchend",this._onInputEnd,!0),t.addEventListener("touchcancel",this._onInputEnd,!0))}Object.defineProperties(W4.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}}),W4.prototype.isDestroyed=function(){return!1},W4.prototype.destroy=function(){let e=this._container;return Bt.supportsPointerEvents()?(document.removeEventListener("pointerdown",this._onInputBegin,!0),e.removeEventListener("pointerup",this._onInputEnd,!0)):(document.removeEventListener("mousedown",this._onInputBegin,!0),e.removeEventListener("mouseup",this._onInputEnd,!0),document.removeEventListener("touchstart",this._onInputBegin,!0),e.removeEventListener("touchend",this._onInputEnd,!0)),this._viewModel.destroy(),Te.cleanNode(this._form),Te.cleanNode(this._searchSuggestionsContainer),e.removeChild(this._form),e.removeChild(this._searchSuggestionsContainer),this._textBox.removeEventListener("focus",this._onTextBoxFocus,!1),le(this)};var j4=W4;function kxe(e,t){this._scene=e,this._duration=t;let i=this;this._command=En((function(){i._scene.camera.flyHome(i._duration)})),this.tooltip="View Home",Te.track(this,["tooltip"])}Object.defineProperties(kxe.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(e){this._duration=e}}});var q4=kxe;function Y4(e,t,i){e=In(e);let n=new q4(t,i);n._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button cesium-home-button",r.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }"),e.appendChild(r),Te.applyBindings(n,r),this._container=e,this._viewModel=n,this._element=r}Object.defineProperties(Y4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),Y4.prototype.isDestroyed=function(){return!1},Y4.prototype.destroy=function(){return Te.cleanNode(this._element),this._container.removeChild(this._element),le(this)};var X4=Y4,vyt="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z",Dyt="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";function KY(){this._cameraClicked=new pe,this._closeClicked=new pe,this.maxHeight=500,this.enableCamera=!1,this.isCameraTracking=!1,this.showInfo=!1,this.titleText="",this.description="",Te.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]),this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>',this.cameraIconPath=void 0,Te.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?Dyt:vyt}}),Te.defineProperty(this,"_bodyless",{get:function(){return!u(this.description)||0===this.description.length}})}KY.prototype.maxHeightOffset=function(e){return this.maxHeight-e+"px"},Object.defineProperties(KY.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}});var K4=KY;function Z4(e){e=In(e);let t=document.createElement("div");t.className="cesium-infoBox",t.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(t);let i=document.createElement("div");i.className="cesium-infoBox-title",i.setAttribute("data-bind","text: titleText"),t.appendChild(i);let n=document.createElement("button");n.type="button",n.className="cesium-button cesium-infoBox-camera",n.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),t.appendChild(n);let r=document.createElement("button");r.type="button",r.className="cesium-infoBox-close",r.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),r.innerHTML="&times;",t.appendChild(r);let o=document.createElement("iframe");o.className="cesium-infoBox-iframe",o.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),o.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),o.setAttribute("allowfullscreen",!0),t.appendChild(o);let a=new K4;Te.applyBindings(a,t),this._container=e,this._element=t,this._frame=o,this._viewModel=a,this._descriptionSubscription=void 0;let s=this;o.addEventListener("load",(function(){let e=o.contentDocument,i=e.createElement("link");i.href=$t("Widgets/InfoBox/InfoBoxDescription.css"),i.rel="stylesheet",i.type="text/css";let n=e.createElement("div");n.className="cesium-infoBox-description",e.head.appendChild(i),e.body.appendChild(n),s._descriptionSubscription=ya(a,"description",(function(e){o.style.height="5px",n.innerHTML=e;let i=null,r=n.firstElementChild;if(null!==r&&1===n.childNodes.length){let e=window.getComputedStyle(r);if(null!==e){let t=e["background-color"],n=z.fromCssColorString(t);u(n)&&0!==n.alpha&&(i=e["background-color"])}}t.style["background-color"]=i;let a=n.getBoundingClientRect().height;o.style.height=`${a}px`}))})),o.setAttribute("src","about:blank")}Object.defineProperties(Z4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}}),Z4.prototype.isDestroyed=function(){return!1},Z4.prototype.destroy=function(){let e=this._container;return Te.cleanNode(this._element),e.removeChild(this._element),u(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),le(this)};var $4=Z4;function Vxe(){this.showInstructions=!1;let e=this;this._command=En((function(){e.showInstructions=!e.showInstructions})),this._showClick=En((function(){e._touch=!1})),this._showTouch=En((function(){e._touch=!0})),this._touch=!1,this.tooltip="Navigation Instructions",Te.track(this,["tooltip","showInstructions","_touch"])}Object.defineProperties(Vxe.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}});var Q4=Vxe;function J4(e){let t=In(e.container),i=new Q4,n=y(e.instructionsInitiallyVisible,!1);i.showInstructions=n,i._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";let r=document.createElement("span");r.className="cesium-navigationHelpButton-wrapper",t.appendChild(r);let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-navigation-help-button",o.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }"),r.appendChild(o);let a=document.createElement("div");a.className="cesium-navigation-help",a.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}'),r.appendChild(a);let s=document.createElement("button");s.type="button",s.className="cesium-navigation-button cesium-navigation-button-left",s.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');let l=document.createElement("img");l.src=$t("Widgets/Images/NavigationHelp/Mouse.svg"),l.className="cesium-navigation-button-icon",l.style.width="25px",l.style.height="25px",s.appendChild(l),s.appendChild(document.createTextNode("Mouse"));let u=document.createElement("button");u.type="button",u.className="cesium-navigation-button cesium-navigation-button-right",u.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');let c=document.createElement("img");c.src=$t("Widgets/Images/NavigationHelp/Touch.svg"),c.className="cesium-navigation-button-icon",c.style.width="25px",c.style.height="25px",u.appendChild(c),u.appendChild(document.createTextNode("Touch")),a.appendChild(s),a.appendChild(u);let h=document.createElement("div");h.className="cesium-click-navigation-help cesium-navigation-help-instructions",h.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}'),h.innerHTML=`            <table>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/MouseLeft.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/MouseRight.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/MouseMiddle.svg")}" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>`,a.appendChild(h);let d=document.createElement("div");d.className="cesium-touch-navigation-help cesium-navigation-help-instructions",d.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}'),d.innerHTML=`            <table>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/TouchDrag.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/TouchZoom.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/TouchTilt.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="${$t("Widgets/Images/NavigationHelp/TouchRotate.svg")}" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>`,a.appendChild(d),Te.applyBindings(i,r),this._container=t,this._viewModel=i,this._wrapper=r,this._closeInstructions=function(e){r.contains(e.target)||(i.showInstructions=!1)},Bt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeInstructions,!0):(document.addEventListener("mousedown",this._closeInstructions,!0),document.addEventListener("touchstart",this._closeInstructions,!0))}Object.defineProperties(J4.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),J4.prototype.isDestroyed=function(){return!1},J4.prototype.destroy=function(){return Bt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeInstructions,!0):(document.removeEventListener("mousedown",this._closeInstructions,!0),document.removeEventListener("touchstart",this._closeInstructions,!0)),Te.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),le(this)};var e8=J4;function ZY(e){this._scene=e.scene,this.lowFrameRateMessage=y(e.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers."),this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,Te.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);let t=this;this._dismissMessage=En((function(){t.showingLowFrameRateMessage=!1,t.lowFrameRateMessageDismissed=!0}));let i=V3.fromScene(e.scene);this._unsubscribeLowFrameRate=i.lowFrameRate.addEventListener((function(){t.lowFrameRateMessageDismissed||(t.showingLowFrameRateMessage=!0)})),this._unsubscribeNominalFrameRate=i.nominalFrameRate.addEventListener((function(){t.showingLowFrameRateMessage=!1}))}Object.defineProperties(ZY.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}}),ZY.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),le(this)};var t8=ZY;function n8(e){let t=In(e.container),i=new t8(e),n=document.createElement("div");n.className="cesium-performance-watchdog-message-area",n.setAttribute("data-bind","visible: showingLowFrameRateMessage");let r=document.createElement("button");r.setAttribute("type","button"),r.className="cesium-performance-watchdog-message-dismiss",r.innerHTML="&times;",r.setAttribute("data-bind","click: dismissMessage"),n.appendChild(r);let o=document.createElement("div");o.className="cesium-performance-watchdog-message",o.setAttribute("data-bind","html: lowFrameRateMessage"),n.appendChild(o),t.appendChild(n),Te.applyBindings(i,n),this._container=t,this._viewModel=i,this._element=n}Object.defineProperties(n8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),n8.prototype.isDestroyed=function(){return!1},n8.prototype.destroy=function(){return this._viewModel.destroy(),Te.cleanNode(this._element),this._container.removeChild(this._element),le(this)};var i8=n8;function o8(e){this._scene=e,this._orthographic=e.camera.frustum instanceof Qt,this._flightInProgress=!1,this.dropDownVisible=!1,this.tooltipPerspective="Perspective Projection",this.tooltipOrthographic="Orthographic Projection",this.selectedTooltip=void 0,this.sceneMode=e.mode,Te.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);let t=this;Te.defineProperty(this,"selectedTooltip",(function(){return t._orthographic?t.tooltipOrthographic:t.tooltipPerspective})),this._toggleDropDown=En((function(){t.sceneMode===te.SCENE2D||t._flightInProgress||(t.dropDownVisible=!t.dropDownVisible)})),this._eventHelper=new Pr,this._eventHelper.add(e.morphComplete,(function(e,i,n,r){t.sceneMode=n,t._orthographic=n===te.SCENE2D||t._scene.camera.frustum instanceof Qt})),this._eventHelper.add(e.preRender,(function(){t._flightInProgress=u(e.camera._currentFlight)})),this._switchToPerspective=En((function(){t.sceneMode!==te.SCENE2D&&(t._scene.camera.switchToPerspectiveFrustum(),t._orthographic=!1,t.dropDownVisible=!1)})),this._switchToOrthographic=En((function(){t.sceneMode!==te.SCENE2D&&(t._scene.camera.switchToOrthographicFrustum(),t._orthographic=!0,t.dropDownVisible=!1)})),this._sceneMode=te}Object.defineProperties(o8.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}}),o8.prototype.isDestroyed=function(){return!1},o8.prototype.destroy=function(){this._eventHelper.removeAll(),le(this)};var r8=o8,Iyt="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z",Pyt="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";function s8(e,t){e=In(e);let i=new r8(t);i._perspectivePath=Iyt,i._orthographicPath=Pyt;let n=document.createElement("span");n.className="cesium-projectionPicker-wrapper cesium-toolbar-button",e.appendChild(n);let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button",r.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),r.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --\x3e\x3c!-- /ko --\x3e',n.appendChild(r);let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",o.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }'),n.appendChild(o);let a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }'),n.appendChild(a),Te.applyBindings(i,n),this._viewModel=i,this._container=e,this._wrapper=n,this._closeDropDown=function(e){n.contains(e.target)||(i.dropDownVisible=!1)},Bt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(s8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s8.prototype.isDestroyed=function(){return!1},s8.prototype.destroy=function(){return this._viewModel.destroy(),Bt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),Te.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),le(this)};var a8=s8;function c8(e,t){this._scene=e;let i=this;this._eventHelper=new Pr,this._eventHelper.add(e.morphStart,(function(e,t,n,r){i.sceneMode=n,i.dropDownVisible=!1})),this._duration=y(t,2),this.sceneMode=e.mode,this.dropDownVisible=!1,this.tooltip2D="2D",this.tooltip3D="3D",this.tooltipColumbusView="Columbus View",Te.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]),this.selectedTooltip=void 0,Te.defineProperty(this,"selectedTooltip",(function(){let e=i.sceneMode;return e===te.SCENE2D?i.tooltip2D:e===te.SCENE3D?i.tooltip3D:i.tooltipColumbusView})),this._toggleDropDown=En((function(){i.dropDownVisible=!i.dropDownVisible})),this._morphTo2D=En((function(){e.morphTo2D(i._duration)})),this._morphTo3D=En((function(){e.morphTo3D(i._duration)})),this._morphToColumbusView=En((function(){e.morphToColumbusView(i._duration)})),this._sceneMode=te}Object.defineProperties(c8.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}}),c8.prototype.isDestroyed=function(){return!1},c8.prototype.destroy=function(){this._eventHelper.removeAll(),le(this)};var l8=c8,Oyt="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z",Ryt="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z",Myt="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";function u8(e,t,i){e=In(e);let n=new l8(t,i);n._globePath=Oyt,n._flatMapPath=Ryt,n._columbusViewPath=Myt;let r=document.createElement("span");r.className="cesium-sceneModePicker-wrapper cesium-toolbar-button",e.appendChild(r);let o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button",o.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),o.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --\x3e\x3c!-- /ko --\x3e',r.appendChild(o);let a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }'),r.appendChild(a);let s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",s.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }'),r.appendChild(s);let l=document.createElement("button");l.type="button",l.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",l.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }'),r.appendChild(l),Te.applyBindings(n,r),this._viewModel=n,this._container=e,this._wrapper=r,this._closeDropDown=function(e){r.contains(e.target)||(n.dropDownVisible=!1)},Bt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(u8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),u8.prototype.isDestroyed=function(){return!1},u8.prototype.destroy=function(){return this._viewModel.destroy(),Bt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),Te.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),le(this)};var f8=u8,Lyt=new U,d8="-1000px";function FI(e,t,i){this._scene=e,this._screenPositionX=d8,this._screenPositionY=d8,this._tweens=e.tweens,this._container=y(i,document.body),this._selectionIndicatorElement=t,this._scale=1,this.position=void 0,this.showSelection=!1,Te.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]),this.isVisible=void 0,Te.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&u(this.position)}}),Te.defineProperty(this,"_transform",{get:function(){return`scale(${this._scale})`}}),this.computeScreenSpacePosition=function(t,i){return $i.wgs84ToWindowCoordinates(e,t,i)}}FI.prototype.update=function(){if(this.showSelection&&u(this.position)){let e=this.computeScreenSpacePosition(this.position,Lyt);if(u(e)){let t=this._container,i=t.parentNode.clientWidth,n=t.parentNode.clientHeight,r=this._selectionIndicatorElement.clientWidth,o=.5*r;e.x=Math.min(Math.max(e.x,-r),i+r)-o,e.y=Math.min(Math.max(e.y,-r),n+r)-o,this._screenPositionX=`${Math.floor(e.x+.25)}px`,this._screenPositionY=`${Math.floor(e.y+.25)}px`}else this._screenPositionX=d8,this._screenPositionY=d8}},FI.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:Ir.EXPONENTIAL_OUT})},FI.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:Ir.EXPONENTIAL_OUT})},Object.defineProperties(FI.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}});var h8=FI;function m8(e,t){e=In(e),this._container=e;let i=document.createElement("div");i.className="cesium-selection-wrapper",i.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }'),e.appendChild(i),this._element=i;let n="http://www.w3.org/2000/svg",r=document.createElementNS(n,"svg:svg");r.setAttribute("width",160),r.setAttribute("height",160),r.setAttribute("viewBox","0 0 160 160");let o=document.createElementNS(n,"g");o.setAttribute("transform","translate(80,80)"),r.appendChild(o);let a=document.createElementNS(n,"path");a.setAttribute("data-bind","attr: { transform: _transform }"),a.setAttribute("d","M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z"),o.appendChild(a),i.appendChild(r);let s=new h8(t,this._element,this._container);this._viewModel=s,Te.applyBindings(this._viewModel,this._element)}Object.defineProperties(m8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),m8.prototype.isDestroyed=function(){return!1},m8.prototype.destroy=function(){let e=this._container;return Te.cleanNode(this._element),e.removeChild(this._element),le(this)};var p8=m8;function lb(e,t,i){this._color=e,this._height=t,this._base=y(i,0)}lb.prototype.getHeight=function(){return this._height},lb.prototype.getBase=function(){return this._base},lb.prototype.getStartTime=function(){return this._start},lb.prototype.getStopTime=function(){return this._stop},lb.prototype.setRange=function(e,t){this._start=e,this._stop=t},lb.prototype.render=function(e){let t="";if(this._start&&this._stop&&this._color){let i=J.secondsDifference(this._start,e.epochJulian),n=Math.round(e.timeBarWidth*e.getAlpha(i)),r=J.secondsDifference(this._stop,e.epochJulian),o=Math.round(e.timeBarWidth*e.getAlpha(r))-n;n<0&&(o+=n,n=0),n+o>e.timeBarWidth&&(o=e.timeBarWidth-n),o>0&&(t=`<span class="cesium-timeline-highlight" style="left: ${n.toString()}px; width: ${o.toString()}px; bottom: ${this._base.toString()}px; height: ${this._height}px; background-color: ${this._color};"></span>`)}return t};var _8=lb;function Uxe(e,t,i,n){this.interval=e,this.height=t,this.color=i||new z(.5,.5,.5,1),this.backgroundColor=n||new z(0,0,0,0)}Uxe.prototype.render=function(e,t){let i=this.interval.start,n=this.interval.stop,r=t.startJulian,o=J.addSeconds(t.startJulian,t.duration,new J);if(J.lessThan(i,r)&&J.greaterThan(n,o))e.fillStyle=this.color.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height);else if(J.lessThanOrEquals(i,o)&&J.greaterThanOrEquals(n,r)){let r,o,a;for(r=0;r<t.timeBarWidth;++r){let e=J.addSeconds(t.startJulian,r/t.timeBarWidth*t.duration,new J);!u(o)&&J.greaterThanOrEquals(e,i)?o=r:!u(a)&&J.greaterThanOrEquals(e,n)&&(a=r)}e.fillStyle=this.backgroundColor.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height),u(o)&&(u(a)||(a=t.timeBarWidth),e.fillStyle=this.color.toCssColorString(),e.fillRect(o,t.y,Math.max(a-o,1),this.height))}};var g8=Uxe,$Y=1e12,Of={none:0,scrub:1,slide:2,zoom:3,touchOnly:4},Lc={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4},ky=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6],Nyt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Nc(e,t){let i=(e=In(e)).ownerDocument;this.container=e;let n=i.createElement("div");n.className="cesium-timeline-main",e.appendChild(n),this._topDiv=n,this._endJulian=void 0,this._epochJulian=void 0,this._lastXPos=void 0,this._scrubElement=void 0,this._startJulian=void 0,this._timeBarSecondsSpan=void 0,this._clock=t,this._scrubJulian=t.currentTime,this._mainTicSpan=-1,this._mouseMode=Of.none,this._touchMode=Lc.none,this._touchState={centerX:0,spanX:0},this._mouseX=0,this._timelineDrag=0,this._timelineDragLocation=void 0,this._lastHeight=void 0,this._lastWidth=void 0,this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer"><canvas class="cesium-timeline-tracks" width="10" height="1"></canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>',this._timeBarEle=this._topDiv.childNodes[0],this._trackContainer=this._topDiv.childNodes[1],this._trackListEle=this._topDiv.childNodes[1].childNodes[0],this._needleEle=this._topDiv.childNodes[2],this._rulerEle=this._topDiv.childNodes[3],this._context=this._trackListEle.getContext("2d"),this._trackList=[],this._highlightRanges=[],this.zoomTo(t.startTime,t.stopTime),this._onMouseDown=Fyt(this),this._onMouseUp=Byt(this),this._onMouseMove=kyt(this),this._onMouseWheel=Vyt(this),this._onTouchStart=Uyt(this),this._onTouchMove=Hyt(this),this._onTouchEnd=zyt(this);let r=this._timeBarEle;i.addEventListener("mouseup",this._onMouseUp,!1),i.addEventListener("mousemove",this._onMouseMove,!1),r.addEventListener("mousedown",this._onMouseDown,!1),r.addEventListener("DOMMouseScroll",this._onMouseWheel,!1),r.addEventListener("mousewheel",this._onMouseWheel,!1),r.addEventListener("touchstart",this._onTouchStart,!1),r.addEventListener("touchmove",this._onTouchMove,!1),r.addEventListener("touchend",this._onTouchEnd,!1),r.addEventListener("touchcancel",this._onTouchEnd,!1),this._topDiv.oncontextmenu=function(){return!1},t.onTick.addEventListener(this.updateFromClock,this),this.updateFromClock()}function QY(e){return e<10?`0${e.toString()}`:e.toString()}function Fyt(e){return function(t){e._mouseMode!==Of.touchOnly&&(0===t.button?(e._mouseMode=Of.scrub,e._scrubElement&&(e._scrubElement.style.backgroundPosition="-16px 0"),e._onMouseMove(t)):(e._mouseX=t.clientX,2===t.button?e._mouseMode=Of.zoom:e._mouseMode=Of.slide)),t.preventDefault()}}function Byt(e){return function(t){e._mouseMode=Of.none,e._scrubElement&&(e._scrubElement.style.backgroundPosition="0 0"),e._timelineDrag=0,e._timelineDragLocation=void 0}}function kyt(e){return function(t){let i;if(e._mouseMode===Of.scrub){t.preventDefault();let i=t.clientX-e._topDiv.getBoundingClientRect().left;i<0?(e._timelineDragLocation=0,e._timelineDrag=-.01*e._timeBarSecondsSpan):i>e._topDiv.clientWidth?(e._timelineDragLocation=e._topDiv.clientWidth,e._timelineDrag=.01*e._timeBarSecondsSpan):(e._timelineDragLocation=void 0,e._setTimeBarTime(i,i*e._timeBarSecondsSpan/e._topDiv.clientWidth))}else if(e._mouseMode===Of.slide){if(i=e._mouseX-t.clientX,e._mouseX=t.clientX,0!==i){let t=i*e._timeBarSecondsSpan/e._topDiv.clientWidth;e.zoomTo(J.addSeconds(e._startJulian,t,new J),J.addSeconds(e._endJulian,t,new J))}}else e._mouseMode===Of.zoom&&(i=e._mouseX-t.clientX,e._mouseX=t.clientX,0!==i&&e.zoomFrom(Math.pow(1.01,i)))}}function Vyt(e){return function(t){let i=t.wheelDeltaY||t.wheelDelta||-t.detail;i/=$Y=Math.max(Math.min(Math.abs(i),$Y),1),e.zoomFrom(Math.pow(1.05,-i))}}function Uyt(e){return function(t){let i,n,r=t.touches.length,o=e._topDiv.getBoundingClientRect().left;t.preventDefault(),e._mouseMode=Of.touchOnly,1===r?(i=J.secondsDifference(e._scrubJulian,e._startJulian),n=Math.round(i*e._topDiv.clientWidth/e._timeBarSecondsSpan+o),Math.abs(t.touches[0].clientX-n)<50?(e._touchMode=Lc.scrub,e._scrubElement&&(e._scrubElement.style.backgroundPosition=1===r?"-16px 0":"0 0")):(e._touchMode=Lc.singleTap,e._touchState.centerX=t.touches[0].clientX-o)):2===r?(e._touchMode=Lc.slideZoom,e._touchState.centerX=.5*(t.touches[0].clientX+t.touches[1].clientX)-o,e._touchState.spanX=Math.abs(t.touches[0].clientX-t.touches[1].clientX)):e._touchMode=Lc.ignore}}function zyt(e){return function(t){let i=t.touches.length,n=e._topDiv.getBoundingClientRect().left;e._touchMode===Lc.singleTap?(e._touchMode=Lc.scrub,e._onTouchMove(t)):e._touchMode===Lc.scrub&&e._onTouchMove(t),e._mouseMode=Of.touchOnly,1!==i?e._touchMode=i>0?Lc.ignore:Lc.none:e._touchMode===Lc.slideZoom&&(e._touchState.centerX=t.touches[0].clientX-n),e._scrubElement&&(e._scrubElement.style.backgroundPosition="0 0")}}function Hyt(e){return function(t){let i,n,r,o,a,s,l=1,c=e._topDiv.getBoundingClientRect().left;e._touchMode===Lc.singleTap&&(e._touchMode=Lc.slideZoom),e._mouseMode=Of.touchOnly,e._touchMode===Lc.scrub?(t.preventDefault(),1===t.changedTouches.length&&(n=t.changedTouches[0].clientX-c,n>=0&&n<=e._topDiv.clientWidth&&e._setTimeBarTime(n,n*e._timeBarSecondsSpan/e._topDiv.clientWidth))):e._touchMode===Lc.slideZoom&&(r=t.touches.length,2===r?(o=.5*(t.touches[0].clientX+t.touches[1].clientX)-c,a=Math.abs(t.touches[0].clientX-t.touches[1].clientX)):1===r&&(o=t.touches[0].clientX-c,a=0),u(o)&&(a>0&&e._touchState.spanX>0?(l=e._touchState.spanX/a,s=J.addSeconds(e._startJulian,(e._touchState.centerX*e._timeBarSecondsSpan-o*e._timeBarSecondsSpan*l)/e._topDiv.clientWidth,new J)):(i=e._touchState.centerX-o,s=J.addSeconds(e._startJulian,i*e._timeBarSecondsSpan/e._topDiv.clientWidth,new J)),e.zoomTo(s,J.addSeconds(s,e._timeBarSecondsSpan*l,new J)),e._touchState.centerX=o,e._touchState.spanX=a))}}Nc.prototype.addEventListener=function(e,t,i){this._topDiv.addEventListener(e,t,i)},Nc.prototype.removeEventListener=function(e,t,i){this._topDiv.removeEventListener(e,t,i)},Nc.prototype.isDestroyed=function(){return!1},Nc.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this);let e=this.container.ownerDocument;e.removeEventListener("mouseup",this._onMouseUp,!1),e.removeEventListener("mousemove",this._onMouseMove,!1);let t=this._timeBarEle;t.removeEventListener("mousedown",this._onMouseDown,!1),t.removeEventListener("DOMMouseScroll",this._onMouseWheel,!1),t.removeEventListener("mousewheel",this._onMouseWheel,!1),t.removeEventListener("touchstart",this._onTouchStart,!1),t.removeEventListener("touchmove",this._onTouchMove,!1),t.removeEventListener("touchend",this._onTouchEnd,!1),t.removeEventListener("touchcancel",this._onTouchEnd,!1),this.container.removeChild(this._topDiv),le(this)},Nc.prototype.addHighlightRange=function(e,t,i){let n=new _8(e,t,i);return this._highlightRanges.push(n),this.resize(),n},Nc.prototype.addTrack=function(e,t,i,n){let r=new g8(e,t,i,n);return this._trackList.push(r),this._lastHeight=void 0,this.resize(),r},Nc.prototype.zoomTo=function(e,t){if(this._startJulian=e,this._endJulian=t,this._timeBarSecondsSpan=J.secondsDifference(t,e),this._clock&&this._clock.clockRange!==Dr.UNBOUNDED){let e=this._clock.startTime,t=this._clock.stopTime,i=J.secondsDifference(t,e),n=J.secondsDifference(e,this._startJulian),r=J.secondsDifference(t,this._endJulian);this._timeBarSecondsSpan>=i?(this._timeBarSecondsSpan=i,this._startJulian=this._clock.startTime,this._endJulian=this._clock.stopTime):n>0?(this._endJulian=J.addSeconds(this._endJulian,n,new J),this._startJulian=e,this._timeBarSecondsSpan=J.secondsDifference(this._endJulian,this._startJulian)):r<0&&(this._startJulian=J.addSeconds(this._startJulian,r,new J),this._endJulian=t,this._timeBarSecondsSpan=J.secondsDifference(this._endJulian,this._startJulian))}this._makeTics();let i=document.createEvent("Event");i.initEvent("setzoom",!0,!0),i.startJulian=this._startJulian,i.endJulian=this._endJulian,i.epochJulian=this._epochJulian,i.totalSpan=this._timeBarSecondsSpan,i.mainTicSpan=this._mainTicSpan,this._topDiv.dispatchEvent(i)},Nc.prototype.zoomFrom=function(e){let t=J.secondsDifference(this._scrubJulian,this._startJulian);e>1||t<0||t>this._timeBarSecondsSpan?t=.5*this._timeBarSecondsSpan:t+=t-.5*this._timeBarSecondsSpan;let i=this._timeBarSecondsSpan-t;this.zoomTo(J.addSeconds(this._startJulian,t-t*e,new J),J.addSeconds(this._endJulian,i*e-i,new J))},Nc.prototype.makeLabel=function(e){let t=J.toGregorianDate(e),i=t.millisecond,n=" UTC";if(i>0&&this._timeBarSecondsSpan<3600){for(n=Math.floor(i).toString();n.length<3;)n=`0${n}`;n=`.${n}`}return`${Nyt[t.month-1]} ${t.day} ${t.year} ${QY(t.hour)}:${QY(t.minute)}:${QY(t.second)}${n}`},Nc.prototype.smallestTicInPixels=7,Nc.prototype._makeTics=function(){let e,t=this._timeBarEle,i=J.secondsDifference(this._scrubJulian,this._startJulian),n=Math.round(i*this._topDiv.clientWidth/this._timeBarSecondsSpan),r=n-8,o=this;this._needleEle.style.left=`${n.toString()}px`;let a="",s=.01,l=31536e6,u=1e-10,c=0,h=this._timeBarSecondsSpan;h<s?(h=s,this._timeBarSecondsSpan=s,this._endJulian=J.addSeconds(this._startJulian,s,new J)):h>l&&(h=l,this._timeBarSecondsSpan=l,this._endJulian=J.addSeconds(this._startJulian,l,new J));let d=this._timeBarEle.clientWidth;d<10&&(d=10);let p,f=this._startJulian,m=Math.min(h/d*1e-5,.4),_=J.toGregorianDate(f);p=h>31536e4?J.fromDate(new Date(Date.UTC(100*Math.floor(_.year/100),0))):h>31536e3?J.fromDate(new Date(Date.UTC(10*Math.floor(_.year/10),0))):h>86400?J.fromDate(new Date(Date.UTC(_.year,0))):J.fromDate(new Date(Date.UTC(_.year,_.month,_.day)));let g=J.secondsDifference(this._startJulian,J.addSeconds(p,m,new J)),y=g+h;function v(e){return Math.floor(g/e)*e}function b(e,t){return Math.ceil(e/t+.5)*t}function A(e){return(e-g)/h}function T(e,t){return e-t*Math.round(e/t)}this._epochJulian=p,this._rulerEle.innerHTML=this.makeLabel(J.addSeconds(this._endJulian,-s,new J));let E=this._rulerEle.offsetWidth+20;E<30&&(E=180);let C=c;c-=u;let x={startTime:g,startJulian:f,epochJulian:p,duration:h,timeBarWidth:d,getAlpha:A};this._highlightRanges.forEach((function(e){a+=e.render(x)}));let S=0,w=0,I=0,P=E/d;P>1&&(P=1),P*=this._timeBarSecondsSpan;let D,O=-1,L=-1,R=ky.length;for(D=0;D<R;++D){let e=ky[D];if(++O,S=e,e>P&&e>c)break;L<0&&d*(e/this._timeBarSecondsSpan)>=this.smallestTicInPixels&&(L=O)}if(O>0){for(;O>0;)if(--O,Math.abs(T(S,ky[O]))<1e-5){ky[O]>=c&&(w=ky[O]);break}if(L>=0)for(;L<O;){if(Math.abs(T(w,ky[L]))<1e-5&&ky[L]>=c){I=ky[L];break}++L}}c=C,c>u&&I<1e-5&&Math.abs(c-S)>u&&(I=c,c<=S+u&&(w=0));let N,M=-999999;if(d*(I/this._timeBarSecondsSpan)>=3)for(e=v(I);e<=y;e=b(e,I))a+=`<span class="cesium-timeline-ticTiny" style="left: ${Math.round(d*A(e)).toString()}px;"></span>`;if(d*(w/this._timeBarSecondsSpan)>=3)for(e=v(w);e<=y;e=b(e,w))a+=`<span class="cesium-timeline-ticSub" style="left: ${Math.round(d*A(e)).toString()}px;"></span>`;if(d*(S/this._timeBarSecondsSpan)>=2){this._mainTicSpan=S,y+=S,e=v(S);let t=J.computeTaiMinusUtc(p);for(;e<=y;){let i=J.addSeconds(f,e-g,new J);if(S>2.1){let n=J.computeTaiMinusUtc(i);Math.abs(n-t)>.1&&(e+=n-t,i=J.addSeconds(f,e-g,new J))}let n=Math.round(d*A(e)),r=this.makeLabel(i);this._rulerEle.innerHTML=r,N=this._rulerEle.offsetWidth,N<10&&(N=E);let o=n-(N/2-1);o>M?(M=o+N+5,a+=`<span class="cesium-timeline-ticMain" style="left: ${n.toString()}px;"></span><span class="cesium-timeline-ticLabel" style="left: ${o.toString()}px;">${r}</span>`):a+=`<span class="cesium-timeline-ticSub" style="left: ${n.toString()}px;"></span>`,e=b(e,S)}}else this._mainTicSpan=-1;a+=`<span class="cesium-timeline-icon16" style="left:${r}px;bottom:0;background-position: 0 0;"></span>`,t.innerHTML=a,this._scrubElement=t.lastChild,this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height),x.y=0,this._trackList.forEach((function(e){e.render(o._context,x),x.y+=e.height}))},Nc.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;let e=this._scrubElement;if(u(this._scrubElement)){let t=J.secondsDifference(this._scrubJulian,this._startJulian),i=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan);this._lastXPos!==i&&(this._lastXPos=i,e.style.left=i-8+"px",this._needleEle.style.left=`${i}px`)}u(this._timelineDragLocation)&&(this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth),this.zoomTo(J.addSeconds(this._startJulian,this._timelineDrag,new J),J.addSeconds(this._endJulian,this._timelineDrag,new J)))},Nc.prototype._setTimeBarTime=function(e,t){if(e=Math.round(e),this._scrubJulian=J.addSeconds(this._startJulian,t,new J),this._scrubElement){let t=e-8;this._scrubElement.style.left=`${t.toString()}px`,this._needleEle.style.left=`${e.toString()}px`}let i=document.createEvent("Event");i.initEvent("settime",!0,!0),i.clientX=e,i.timeSeconds=t,i.timeJulian=this._scrubJulian,i.clock=this._clock,this._topDiv.dispatchEvent(i)},Nc.prototype.resize=function(){let e=this.container.clientWidth,t=this.container.clientHeight;if(e===this._lastWidth&&t===this._lastHeight)return;this._trackContainer.style.height=`${t}px`;let i=1;this._trackList.forEach((function(e){i+=e.height})),this._trackListEle.style.height=`${i.toString()}px`,this._trackListEle.width=this._trackListEle.clientWidth,this._trackListEle.height=i,this._makeTics(),this._lastXPos=void 0,this._lastWidth=e,this._lastHeight=t};var y8=Nc;function zxe(e){let t=(e=y(e,y.EMPTY_OBJECT)).globe,i=y(e.imageryProviderViewModels,[]),n=y(e.terrainProviderViewModels,[]);this._globe=t,this.imageryProviderViewModels=i.slice(0),this.terrainProviderViewModels=n.slice(0),this.dropDownVisible=!1,Te.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]);let r=Te.getObservable(this,"imageryProviderViewModels"),o=Te.pureComputed((function(){let e,t=r(),i={};for(e=0;e<t.length;e++){let n=t[e],r=n.category;u(i[r])?i[r].push(n):i[r]=[n]}let n=Object.keys(i),o=[];for(e=0;e<n.length;e++){let t=n[e];o.push({name:t,providers:i[t]})}return o}));this._imageryProviders=o;let a=Te.getObservable(this,"terrainProviderViewModels"),s=Te.pureComputed((function(){let e,t=a(),i={};for(e=0;e<t.length;e++){let n=t[e],r=n.category;u(i[r])?i[r].push(n):i[r]=[n]}let n=Object.keys(i),r=[];for(e=0;e<n.length;e++){let t=n[e];r.push({name:t,providers:i[t]})}return r}));this._terrainProviders=s,this.buttonTooltip=void 0,Te.defineProperty(this,"buttonTooltip",(function(){let e=this.selectedImagery,t=this.selectedTerrain,i=u(e)?e.name:void 0,n=u(t)?t.name:void 0;return u(i)&&u(n)?`${i}\n${n}`:u(i)?i:n})),this.buttonImageUrl=void 0,Te.defineProperty(this,"buttonImageUrl",(function(){let e=this.selectedImagery;if(u(e))return e.iconUrl})),this.selectedImagery=void 0;let l=Te.observable();this._currentImageryLayers=[],Te.defineProperty(this,"selectedImagery",{get:function(){return l()},set:function(e){if(l()===e)return void(this.dropDownVisible=!1);let t,i=this._currentImageryLayers,n=i.length,r=this._globe.imageryLayers,o=!1;for(t=0;t<n;t++){let e=r.length;for(let n=0;n<e;n++){let e=r.get(n);if(e===i[t]){r.remove(e),o=!0;break}}}if(u(e)){let i=e.creationCommand();if(Array.isArray(i)){let e=i.length;for(this._currentImageryLayers=[],t=e-1;t>=0;t--){let e=la.fromProviderAsync(i[t]);r.add(e,0),this._currentImageryLayers.push(e)}}else{this._currentImageryLayers=[];let t=la.fromProviderAsync(i);if(t.name=e.name,o)r.add(t,0);else{let e=r.get(0);u(e)&&r.remove(e),r.add(t,0)}this._currentImageryLayers.push(t)}}l(e),this.dropDownVisible=!1}}),this.selectedTerrain=void 0;let c=Te.observable();Te.defineProperty(this,"selectedTerrain",{get:function(){return c()},set:function(e){if(c()===e)return void(this.dropDownVisible=!1);let t;if(u(e)&&(t=e.creationCommand()),u(t)&&!u(t.then))this._globe.depthTestAgainstTerrain=!(t instanceof Wm),this._globe.terrainProvider=t;else if(u(t)){let e=!1,i=this._globe.terrainProviderChanged.addEventListener((()=>{e=!0,i()})),n=new _U(t).readyEvent.addEventListener((t=>{e||(this._globe.depthTestAgainstTerrain=!(t instanceof Wm),this._globe.terrainProvider=t,n())}))}c(e),this.dropDownVisible=!1}});let h=this;this._toggleDropDown=En((function(){h.dropDownVisible=!h.dropDownVisible})),this.selectedImagery=y(e.selectedImageryProviderViewModel,i[0]),this.selectedTerrain=y(e.selectedTerrainProviderViewModel,n[0])}Object.defineProperties(zxe.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}});var x8=zxe;function b8(e,t){e=In(e);let i=new x8(t),n=document.createElement("button");n.type="button",n.className="cesium-button cesium-toolbar-button",n.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown"),e.appendChild(n);let r=document.createElement("img");r.setAttribute("draggable","false"),r.className="cesium-baseLayerPicker-selected",r.setAttribute("data-bind","attr: { src: buttonImageUrl }, visible: !!buttonImageUrl"),n.appendChild(r);let o=document.createElement("div");o.className="cesium-baseLayerPicker-dropDown",o.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }'),e.appendChild(o);let a=document.createElement("div");a.className="cesium-baseLayerPicker-sectionTitle",a.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0"),a.innerHTML="Imagery",o.appendChild(a);let s=document.createElement("div");s.className="cesium-baseLayerPicker-section",s.setAttribute("data-bind","foreach: _imageryProviders"),o.appendChild(s);let l=document.createElement("div");l.className="cesium-baseLayerPicker-category",s.appendChild(l);let u=document.createElement("div");u.className="cesium-baseLayerPicker-categoryTitle",u.setAttribute("data-bind","text: name"),l.appendChild(u);let c=document.createElement("div");c.className="cesium-baseLayerPicker-choices",c.setAttribute("data-bind","foreach: providers"),l.appendChild(c);let h=document.createElement("div");h.className="cesium-baseLayerPicker-item",h.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedImagery = $data; }'),c.appendChild(h);let d=document.createElement("img");d.className="cesium-baseLayerPicker-itemIcon",d.setAttribute("data-bind","attr: { src: iconUrl }"),d.setAttribute("draggable","false"),h.appendChild(d);let p=document.createElement("div");p.className="cesium-baseLayerPicker-itemLabel",p.setAttribute("data-bind","text: name"),h.appendChild(p);let f=document.createElement("div");f.className="cesium-baseLayerPicker-sectionTitle",f.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0"),f.innerHTML="Terrain",o.appendChild(f);let m=document.createElement("div");m.className="cesium-baseLayerPicker-section",m.setAttribute("data-bind","foreach: _terrainProviders"),o.appendChild(m);let _=document.createElement("div");_.className="cesium-baseLayerPicker-category",m.appendChild(_);let g=document.createElement("div");g.className="cesium-baseLayerPicker-categoryTitle",g.setAttribute("data-bind","text: name"),_.appendChild(g);let y=document.createElement("div");y.className="cesium-baseLayerPicker-choices",y.setAttribute("data-bind","foreach: providers"),_.appendChild(y);let v=document.createElement("div");v.className="cesium-baseLayerPicker-item",v.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedTerrain = $data; }'),y.appendChild(v);let b=document.createElement("img");b.className="cesium-baseLayerPicker-itemIcon",b.setAttribute("data-bind","attr: { src: iconUrl }"),b.setAttribute("draggable","false"),v.appendChild(b);let A=document.createElement("div");A.className="cesium-baseLayerPicker-itemLabel",A.setAttribute("data-bind","text: name"),v.appendChild(A),Te.applyBindings(i,n),Te.applyBindings(i,o),this._viewModel=i,this._container=e,this._element=n,this._dropPanel=o,this._closeDropDown=function(e){n.contains(e.target)||o.contains(e.target)||(i.dropDownVisible=!1)},Bt.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object.defineProperties(b8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),b8.prototype.isDestroyed=function(){return!1},b8.prototype.destroy=function(){return Bt.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),Te.cleanNode(this._element),Te.cleanNode(this._dropPanel),this._container.removeChild(this._element),this._container.removeChild(this._dropPanel),le(this)};var T8=b8;function Hxe(e){let t=e.creationFunction;u(t.canExecute)||(t=En(t)),this._creationCommand=t,this.name=e.name,this.tooltip=e.tooltip,this.iconUrl=e.iconUrl,this._category=y(e.category,""),Te.track(this,["name","tooltip","iconUrl"])}Object.defineProperties(Hxe.prototype,{creationCommand:{get:function(){return this._creationCommand}},category:{get:function(){return this._category}}});var Yr=Hxe;function Gyt(){let e=[],t=devicePixelRatio>=2;return e.push(new Yr({name:"Bing Maps Aerial",iconUrl:$t("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return zg({style:Ug.AERIAL})}})),e.push(new Yr({name:"Bing Maps Aerial with Labels",iconUrl:$t("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with labels, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return zg({style:Ug.AERIAL_WITH_LABELS})}})),e.push(new Yr({name:"Bing Maps Roads",iconUrl:$t("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return zg({style:Ug.ROAD})}})),e.push(new Yr({name:"ArcGIS World Imagery",iconUrl:$t("Widgets/Images/ImageryProviders/ArcGisMapServiceWorldImagery.png"),tooltip:"ArcGIS World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide. The map includes 15m TerraColor imagery at small and mid-scales (~1:591M down to ~1:288k) for the world. The map features Maxar imagery at 0.3m resolution for select metropolitan areas around the world, 0.5m resolution across the United States and parts of Western Europe, and 1m resolution imagery across the rest of the world. In addition to commercial sources, the World Imagery map features high-resolution aerial photography contributed by the GIS User Community. This imagery ranges from 0.3m to 0.03m resolution (down to ~1:280 nin select communities). For more information on this map, including the terms of use, visit us online at \nhttps://www.arcgis.com/home/item.html?id=10df2279f9684e4a9f6a7f08febac2a9",category:"Other",creationFunction:function(){return $_.fromBasemapType(wh.SATELLITE,{enablePickFeatures:!1})}})),e.push(new Yr({name:"ArcGIS World Hillshade",iconUrl:$t("Widgets/Images/ImageryProviders/ArcGisMapServiceWorldHillshade.png"),tooltip:"ArcGIS World Hillshade map portrays elevation as an artistic hillshade. This map is designed to be used as a backdrop for topographical, soil, hydro, landcover or other outdoor recreational maps. The map was compiled from a variety of sources from several data providers. The basemap has global coverage down to a scale of ~1:72k. In select areas of the United States and Europe, coverage is available down to ~1:9k. For more information on this map, including the terms of use, visit us online at \nhttps://www.arcgis.com/home/item.html?id=1b243539f4514b6ba35e7d995890db1d",category:"Other",creationFunction:function(){return $_.fromBasemapType(wh.HILLSHADE,{enablePickFeatures:!1})}})),e.push(new Yr({name:"Esri World Ocean",iconUrl:$t("Widgets/Images/ImageryProviders/ArcGisMapServiceWorldOcean.png"),tooltip:"ArcGIS World Ocean map is designed to be used as a base map by marine GIS professionals and as a reference map by anyone interested in ocean data.  The base map features marine bathymetry. Land features include inland waters and roads overlaid on land cover and shaded relief imagery. The map was compiled from a variety of best available sources from several data providers, including General Bathymetric Chart of the Oceans GEBCO_08 Grid, National Oceanic and Atmospheric Administration (NOAA), and National Geographic, Garmin, HERE, Geonames.org, and Esri, and various other contributors. The base map currently provides coverage for the world down to a scale of ~1:577k, and coverage down to 1:72k in US coastal areas, and various other areas. Coverage down to ~ 1:9k is available limited areas based on regional hydrographic survey data. The base map was designed and developed by Esri. For more information on this map, including our terms of use, visit us online at \nhttps://www.arcgis.com/home/item.html?id=1e126e7520f9466c9ca28b8f28b5e500",category:"Other",creationFunction:function(){return $_.fromBasemapType(wh.OCEANS,{enablePickFeatures:!1})}})),e.push(new Yr({name:"OpenStreetMap",iconUrl:$t("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.\nhttp://www.openstreetmap.org",category:"Other",creationFunction:function(){return new Yg({url:"https://tile.openstreetmap.org/"})}})),e.push(new Yr({name:"Stadia x Stamen Watercolor",iconUrl:$t("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Based on the original basemaps created for the Knight Foundation and reminiscent of hand drawn maps, the watercolor maps from Stamen Design apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.\nhttps://docs.stadiamaps.com/map-styles/stamen-watercolor/",category:"Other",creationFunction:function(){return new Yg({url:"https://tiles.stadiamaps.com/tiles/stamen_watercolor/",fileExtension:"jpg",credit:'&copy; <a href="https://stamen.com/" target="_blank">Stamen Design</a>\n           &copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>\n           &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>\n           &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>'})}})),e.push(new Yr({name:"Stadia x Stamen Toner",iconUrl:$t("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"Based on the original basemaps created for the Knight Foundation and the most popular of the excellent styles from Stamen Design, these high-contrast B+W (black and white) maps are the perfect backdrop for your colorful and eye-catching overlays.\nhttps://docs.stadiamaps.com/map-styles/stamen-toner/",category:"Other",creationFunction:function(){return new Yg({url:"https://tiles.stadiamaps.com/tiles/stamen_toner/",retinaTiles:t,credit:'&copy; <a href="https://stamen.com/" target="_blank">Stamen Design</a>\n            &copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>\n            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>\n            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>'})}})),e.push(new Yr({name:"Stadia Alidade Smooth",iconUrl:$t("Widgets/Images/ImageryProviders/stadiaAlidadeSmooth.png"),tooltip:"Stadia's custom Alidade Smooth style is designed for maps that use a lot of markers or overlays. It features a muted color scheme and fewer points of interest to allow your added data to shine.\nhttps://docs.stadiamaps.com/map-styles/alidade-smooth/",category:"Other",creationFunction:function(){return new Yg({url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/",retinaTiles:t,credit:'&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>\n            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>\n            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>'})}})),e.push(new Yr({name:"Stadia Alidade Smooth Dark",iconUrl:$t("Widgets/Images/ImageryProviders/stadiaAlidadeSmoothDark.png"),tooltip:"Stadia Alidade Smooth Dark, like its lighter cousin, is also designed to stay out of the way. It just flips the dark mode switch on the color scheme. With the lights out, your data can now literally shine.\nhttps://docs.stadiamaps.com/map-styles/alidade-smooth-dark/",category:"Other",creationFunction:function(){return new Yg({url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/",retinaTiles:t,credit:'&copy; <a href="https://www.stadiamaps.com/" target="_blank">Stadia Maps</a>\n            &copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>\n            &copy; <a href="https://www.openstreetmap.org/about/" target="_blank">OpenStreetMap contributors</a>'})}})),e.push(new Yr({name:"Sentinel-2",iconUrl:$t("Widgets/Images/ImageryProviders/sentinel-2.png"),tooltip:"Sentinel-2 cloudless by EOX IT Services GmbH (Contains modified Copernicus Sentinel data 2016 and 2017).",category:"Cesium ion",creationFunction:function(){return Vg.fromAssetId(3954)}})),e.push(new Yr({name:"Blue Marble",iconUrl:$t("Widgets/Images/ImageryProviders/blueMarble.png"),tooltip:"Blue Marble Next Generation July, 2004 imagery from NASA.",category:"Cesium ion",creationFunction:function(){return Vg.fromAssetId(3845)}})),e.push(new Yr({name:"Earth at night",iconUrl:$t("Widgets/Images/ImageryProviders/earthAtNight.png"),tooltip:"The Earth at night, also known as The Black Marble, is a 500 meter resolution global composite imagery layer released by NASA.",category:"Cesium ion",creationFunction:function(){return Vg.fromAssetId(3812)}})),e.push(new Yr({name:"Natural EarthII",iconUrl:$t("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast.\nhttp://www.naturalearthdata.com/",category:"Cesium ion",creationFunction:function(){return hx.fromUrl($t("Assets/Textures/NaturalEarthII"))}})),e}var A8=Gyt;function Wyt(){let e=[];return e.push(new Yr({name:"WGS84 Ellipsoid",iconUrl:$t("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",category:"Cesium ion",creationFunction:function(){return new Wm}})),e.push(new Yr({name:"Cesium World Terrain",iconUrl:$t("Widgets/Images/TerrainProviders/CesiumWorldTerrain.png"),tooltip:"High-resolution global terrain tileset curated from several datasources and hosted by Cesium ion",category:"Cesium ion",creationFunction:function(){return uT({requestWaterMask:!0,requestVertexNormals:!0})}})),e}var C8=Wyt,Yxe=or(qxe(),1);function Yyt(e){let t=!1,i=window.screen;return u(i)&&(u(i.lockOrientation)?t=i.lockOrientation(e):u(i.mozLockOrientation)?t=i.mozLockOrientation(e):u(i.msLockOrientation)?t=i.msLockOrientation(e):u(i.orientation&&i.orientation.lock)&&(t=i.orientation.lock(e))),t}function Xxe(){let e=window.screen;u(e)&&(u(e.unlockOrientation)?e.unlockOrientation():u(e.mozUnlockOrientation)?e.mozUnlockOrientation():u(e.msUnlockOrientation)?e.msUnlockOrientation():u(e.orientation&&e.orientation.unlock)&&e.orientation.unlock())}function Xyt(e,t,i,n){n()||(i()?(t.useWebVR=!1,e._locked&&(Xxe(),e._locked=!1),e._noSleep.disable(),hr.exitFullscreen(),i(!1)):(hr.fullscreen||hr.requestFullscreen(e._vrElement),e._noSleep.enable(),e._locked||(e._locked=Yyt("landscape")),t.useWebVR=!0,i(!0)))}function E8(e,t){let i=this,n=Te.observable(hr.enabled),r=Te.observable(!1);this.isVRMode=void 0,Te.defineProperty(this,"isVRMode",{get:function(){return r()}}),this.isVREnabled=void 0,Te.defineProperty(this,"isVREnabled",{get:function(){return n()},set:function(e){n(e&&hr.enabled)}}),this.tooltip=void 0,Te.defineProperty(this,"tooltip",(function(){return n()?r()?"Exit VR mode":"Enter VR mode":"VR mode is unavailable"}));let o=Te.observable(!1);this._isOrthographic=void 0,Te.defineProperty(this,"_isOrthographic",{get:function(){return o()}}),this._eventHelper=new Pr,this._eventHelper.add(e.preRender,(function(){o(e.camera.frustum instanceof Qt)})),this._locked=!1,this._noSleep=new Yxe.default,this._command=En((function(){Xyt(i,e,r,o)}),Te.getObservable(this,"isVREnabled")),this._vrElement=y(In(t),document.body),this._callback=function(){!hr.fullscreen&&r()&&(e.useWebVR=!1,i._locked&&(Xxe(),i._locked=!1),i._noSleep.disable(),r(!1))},document.addEventListener(hr.changeEventName,this._callback)}Object.defineProperties(E8.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){this._vrElement=e}},command:{get:function(){return this._command}}}),E8.prototype.isDestroyed=function(){return!1},E8.prototype.destroy=function(){this._eventHelper.removeAll(),document.removeEventListener(hr.changeEventName,this._callback),le(this)};var S8=E8,Kyt="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z",Zyt="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";function w8(e,t,i){e=In(e);let n=new S8(t,i);n._exitVRPath=Zyt,n._enterVRPath=Kyt;let r=document.createElement("button");r.type="button",r.className="cesium-button cesium-vrButton",r.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }'),e.appendChild(r),Te.applyBindings(n,r),this._container=e,this._viewModel=n,this._element=r}Object.defineProperties(w8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),w8.prototype.isDestroyed=function(){return!1},w8.prototype.destroy=function(){return this._viewModel.destroy(),Te.cleanNode(this._element),this._container.removeChild(this._element),le(this)};var v8=w8,Vy=new se;function $xe(e){let t=e.clock;t.currentTime=e.timeJulian,t.shouldAnimate=!1}function $yt(e){let t=e.getPropertyIds(),i="";return t.forEach((function(t){let n=e.getProperty(t);u(n)&&(i+=`<tr><th>${t}</th><td>${n}</td></tr>`)})),i.length>0&&(i=`<table class="cesium-infoBox-defaultTable"><tbody>${i}</tbody></table>`),i}function Qyt(e){let t,i=[],n=e.getPropertyIds();for(t=0;t<n.length;t++){let r=n[t];/^name$/i.test(r)?i[0]=e.getProperty(r):/name/i.test(r)?i[1]=e.getProperty(r):/^title$/i.test(r)?i[2]=e.getProperty(r):/^(id|identifier)$/i.test(r)?i[3]=e.getProperty(r):/element/i.test(r)?i[4]=e.getProperty(r):/(id|identifier)$/i.test(r)&&(i[5]=e.getProperty(r))}let r=i.length;for(t=0;t<r;t++){let e=i[t];if(u(e)&&""!==e)return e}return"Unnamed Feature"}function Kxe(e,t){let i=e.scene.pick(t.position);if(u(i)){let e=y(i.id,i.primitive.id);if(e instanceof er)return e;if(i instanceof Fs)return new er({name:Qyt(i),description:$yt(i),feature:i})}if(u(e.scene.globe))return t0t(e,t.position)}var Jyt=new J;function Qxe(e,t,i){if(u(i)){let n=i.clock;if(u(n)&&(n.getValue(t),u(e))){let t=n.startTime,i=n.stopTime;J.equals(t,i)&&(i=J.addSeconds(t,P.EPSILON2,Jyt)),e.updateFromClock(),e.zoomTo(t,i)}}}var e0t=new h;function t0t(e,t){let i=e.scene,n=i.camera.getPickRay(t),r=i.imageryLayers.pickImageryLayerFeatures(n,i);if(!u(r))return;let o=new er({id:"Loading...",description:"Loading feature information..."});return r.then((function(t){if(e.selectedEntity!==o)return;if(!u(t)||0===t.length)return void(e.selectedEntity=Zxe());let i=t[0],n=new er({id:i.name,description:i.description});if(u(i.position)){let t=e.scene.globe.ellipsoid.cartographicToCartesian(i.position,e0t);n.position=new gl(t)}e.selectedEntity=n}),(function(){e.selectedEntity===o&&(e.selectedEntity=Zxe())})),o}function Zxe(){return new er({id:"None",description:"No features found."})}function n0t(e,t){let i=e._geocoder,n=e._homeButton,r=e._sceneModePicker,o=e._projectionPicker,a=e._baseLayerPicker,s=e._animation,l=e._timeline,c=e._fullscreenButton,h=e._infoBox,d=e._selectionIndicator,p=t?"hidden":"visible";if(u(i)&&(i.container.style.visibility=p),u(n)&&(n.container.style.visibility=p),u(r)&&(r.container.style.visibility=p),u(o)&&(o.container.style.visibility=p),u(a)&&(a.container.style.visibility=p),u(s)&&(s.container.style.visibility=p),u(l)&&(l.container.style.visibility=p),u(c)&&c.viewModel.isFullscreenEnabled&&(c.container.style.visibility=p),u(h)&&(h.container.style.visibility=p),u(d)&&(d.container.style.visibility=p),e._container){let i=t||!u(c)?0:c.container.clientWidth;e._vrButton.container.style.right=`${i}px`,e.forceResize()}}function Di(e,t){e=In(e),t=y(t,y.EMPTY_OBJECT);let i=!(u(t.globe)&&!1===t.globe||u(t.baseLayerPicker)&&!1===t.baseLayerPicker),n=this,r=document.createElement("div");r.className="cesium-viewer",e.appendChild(r);let o=document.createElement("div");o.className="cesium-viewer-cesiumWidgetContainer",r.appendChild(o);let a=document.createElement("div");a.className="cesium-viewer-bottom",r.appendChild(a);let s,l,c=y(t.scene3DOnly,!1),h=!1;u(t.clockViewModel)?(l=t.clockViewModel,s=l.clock):(s=new ph,l=new R4(s),h=!0),u(t.shouldAnimate)&&(s.shouldAnimate=t.shouldAnimate);let d=new CU(o,{baseLayer:!(i||u(t.baseLayer)||u(t.imageryProvider))&&void 0,clock:s,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,useBrowserRecommendedResolution:t.useBrowserRecommendedResolution,creditContainer:u(t.creditContainer)?t.creditContainer:a,creditViewport:t.creditViewport,scene3DOnly:c,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D,blurActiveElementOnCanvasFocus:t.blurActiveElementOnCanvasFocus,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange,depthPlaneEllipsoidOffset:t.depthPlaneEllipsoidOffset,msaaSamples:t.msaaSamples}),p=t.dataSources,f=!1;u(p)||(p=new HU,f=!0);let m,_,g=d.scene,v=new az({scene:g,dataSourceCollection:p}),b=new Pr;if(b.add(s.onTick,Di.prototype._onTick,this),b.add(g.morphStart,Di.prototype._clearTrackedObject,this),!u(t.selectionIndicator)||!1!==t.selectionIndicator){let e=document.createElement("div");e.className="cesium-viewer-selectionIndicatorContainer",r.appendChild(e),m=new p8(e,g)}if(!u(t.infoBox)||!1!==t.infoBox){let e=document.createElement("div");e.className="cesium-viewer-infoBoxContainer",r.appendChild(e),_=new $4(e);let t=_.viewModel;b.add(t.cameraClicked,Di.prototype._onInfoBoxCameraClicked,this),b.add(t.closeClicked,Di.prototype._onInfoBoxClockClicked,this)}let A,T,E,C,x,S,w,I,P,D,O,L,R,N,M,F=document.createElement("div");if(F.className="cesium-viewer-toolbar",r.appendChild(F),!u(t.geocoder)||!1!==t.geocoder){let e,i=document.createElement("div");i.className="cesium-viewer-geocoderContainer",F.appendChild(i),u(t.geocoder)&&"boolean"!=typeof t.geocoder&&(e=Array.isArray(t.geocoder)?t.geocoder:[t.geocoder]),A=new j4({container:i,geocoderServices:e,scene:g}),b.add(A.viewModel.search.beforeExecute,Di.prototype._clearObjects,this)}if((!u(t.homeButton)||!1!==t.homeButton)&&(T=new X4(F,g),u(A)&&b.add(T.viewModel.command.afterExecute,(function(){let e=A.viewModel;e.searchText="",e.isSearchInProgress&&e.search()})),b.add(T.viewModel.command.beforeExecute,Di.prototype._clearTrackedObject,this)),!c&&(!u(t.sceneModePicker)||!1!==t.sceneModePicker)&&(E=new f8(F,g)),t.projectionPicker&&(C=new a8(F,g)),i){let e=y(t.imageryProviderViewModels,A8()),i=y(t.terrainProviderViewModels,C8());x=new T8(F,{globe:g.globe,imageryProviderViewModels:e,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:i,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel}),S=F.getElementsByClassName("cesium-baseLayerPicker-dropDown")[0]}if(u(t.baseLayer)&&!1!==t.baseLayer&&(i&&(x.viewModel.selectedImagery=void 0),g.imageryLayers.removeAll(),g.imageryLayers.add(t.baseLayer)),u(t.terrainProvider)&&(i&&(x.viewModel.selectedTerrain=void 0),g.terrainProvider=t.terrainProvider),u(t.terrain)&&(i&&(x.viewModel.selectedTerrain=void 0,g.globe.depthTestAgainstTerrain=!0),g.setTerrain(t.terrain)),!u(t.navigationHelpButton)||!1!==t.navigationHelpButton){let e=!0;try{if(u(window.localStorage)){let t=window.localStorage.getItem("cesium-hasSeenNavHelp");u(t)&&t?e=!1:window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}catch{}w=new e8({container:F,instructionsInitiallyVisible:y(t.navigationInstructionsInitiallyVisible,e)})}if(!u(t.animation)||!1!==t.animation){let e=document.createElement("div");e.className="cesium-viewer-animationContainer",r.appendChild(e),I=new B4(e,new k4(l))}if(!u(t.timeline)||!1!==t.timeline){let e=document.createElement("div");e.className="cesium-viewer-timelineContainer",r.appendChild(e),P=new y8(e,s),P.addEventListener("settime",$xe,!1),P.zoomTo(s.startTime,s.stopTime)}if((!u(t.fullscreenButton)||!1!==t.fullscreenButton)&&(L=document.createElement("div"),L.className="cesium-viewer-fullscreenContainer",r.appendChild(L),D=new H4(L,t.fullscreenElement),O=ya(D.viewModel,"isFullscreenEnabled",(function(e){L.style.display=e?"block":"none",u(P)&&(P.container.style.right=`${L.clientWidth}px`,P.resize())}))),t.vrButton){let e=document.createElement("div");e.className="cesium-viewer-vrContainer",r.appendChild(e),R=new v8(e,g,t.fullScreenElement),N=ya(R.viewModel,"isVREnabled",(function(t){e.style.display=t?"block":"none",u(D)&&(e.style.right=`${L.clientWidth}px`),u(P)&&(P.container.style.right=`${e.clientWidth}px`,P.resize())})),M=ya(R.viewModel,"isVRMode",(function(e){n0t(n,e)}))}this._baseLayerPickerDropDown=S,this._fullscreenSubscription=O,this._vrSubscription=N,this._vrModeSubscription=M,this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=y(t.automaticallyTrackDataSourceClocks,!0),this._container=e,this._bottomContainer=a,this._element=r,this._cesiumWidget=d,this._selectionIndicator=m,this._infoBox=_,this._dataSourceCollection=p,this._destroyDataSourceCollection=f,this._dataSourceDisplay=v,this._clockViewModel=l,this._destroyClockViewModel=h,this._toolbar=F,this._homeButton=T,this._sceneModePicker=E,this._projectionPicker=C,this._baseLayerPicker=x,this._navigationHelpButton=w,this._animation=I,this._timeline=P,this._fullscreenButton=D,this._vrButton=R,this._geocoder=A,this._eventHelper=b,this._lastWidth=0,this._lastHeight=0,this._allowDataSourcesToSuspendAnimation=!0,this._entityView=void 0,this._enableInfoOrSelection=u(_)||u(m),this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._selectedEntity=void 0,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,this._selectedEntityChanged=new pe,this._trackedEntityChanged=new pe,Te.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]),b.add(p.dataSourceAdded,Di.prototype._onDataSourceAdded,this),b.add(p.dataSourceRemoved,Di.prototype._onDataSourceRemoved,this),b.add(g.postUpdate,Di.prototype.resize,this),b.add(g.postRender,Di.prototype._postRender,this);let B=p.length;for(let e=0;e<B;e++)this._dataSourceAdded(p,p.get(e));this._dataSourceAdded(void 0,v.defaultDataSource),b.add(p.dataSourceAdded,Di.prototype._dataSourceAdded,this),b.add(p.dataSourceRemoved,Di.prototype._dataSourceRemoved,this),d.screenSpaceEventHandler.setInputAction((function(e){n.selectedEntity=Kxe(n,e)}),_n.LEFT_CLICK),d.screenSpaceEventHandler.setInputAction((function(e){let t=Kxe(n,e);u(t)?j.getValueOrUndefined(t.position,n.clock.currentTime)?n.trackedEntity=t:n.zoomTo(t):u(n.trackedEntity)&&(n.trackedEntity=void 0)}),_n.LEFT_DOUBLE_CLICK)}function Jxe(e,t,i,n){nX(e);let r=new Promise((t=>{e._completeZoom=function(e){t(e)}}));return e._zoomPromise=r,e._zoomIsFlight=n,e._zoomOptions=i,Promise.resolve(t).then((function(t){if(e._zoomPromise===r){if(t instanceof la){let i;return i=u(t.imageryProvider)?Promise.resolve(t.getImageryRectangle()):new Promise((e=>{let i=t.readyEvent.addEventListener((()=>{i(),e(t.getImageryRectangle())}))})),void i.then((function(t){return tC(t,e.scene)})).then((function(t){e._zoomPromise===r&&(e._zoomTarget=t)}))}if(t instanceof ca||t instanceof AD||t instanceof vD)return void(e._zoomTarget=t);if(t.isLoading&&u(t.loadingEvent)){let i=t.loadingEvent.addEventListener((function(){i(),e._zoomPromise===r&&(e._zoomTarget=t.entities.values.slice(0))}));return}if(Array.isArray(t))return void(e._zoomTarget=t.slice(0));t=y(t.values,t),u(t.entities)&&(t=t.entities.values),Array.isArray(t)?e._zoomTarget=t.slice(0):e._zoomTarget=[t]}})),e.scene.requestRender(),r}function BI(e){e._zoomPromise=void 0,e._zoomTarget=void 0,e._zoomOptions=void 0}function nX(e){let t=e._zoomPromise;u(t)&&(BI(e),e._completeZoom(!1))}function i0t(e){let t=e._zoomTarget;if(!u(t)||e.scene.mode===te.MORPHING)return;let i,n=e.scene,r=n.camera,o=y(e._zoomOptions,{});function a(n){u(o.offset)||(o.offset=new qf(0,-.5,n.radius)),i={offset:o.offset,duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)}},e._zoomIsFlight?r.flyToBoundingSphere(t.boundingSphere,i):(r.viewBoundingSphere(n,o.offset),r.lookAtTransform(L.IDENTITY),e._completeZoom(!0)),BI(e)}if(t instanceof AD){if(u(t.boundingSphere))return void a(t.boundingSphere);let e=t.frameChanged.addEventListener((function(t){a(t.boundingSphere),e()}));return}if(t instanceof ca||t instanceof vD)return void a(t.boundingSphere);if(t instanceof fe)return i={destination:n.mapProjection.ellipsoid.cartographicToCartesian(t),duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)}},e._zoomIsFlight?r.flyTo(i):(r.setView(i),e._completeZoom(!0)),void BI(e);let s=t,l=[];for(let t=0,i=s.length;t<i;t++){let i=e._dataSourceDisplay.getBoundingSphere(s[t],!1,Vy);if(i===at.PENDING)return;i!==at.FAILED&&l.push(se.clone(Vy))}if(0===l.length)return void nX(e);e.trackedEntity=void 0;let c=se.fromBoundingSpheres(l);e._zoomIsFlight?(BI(e),r.flyToBoundingSphere(c,{duration:o.duration,maximumHeight:o.maximumHeight,complete:function(){e._completeZoom(!0)},cancel:function(){e._completeZoom(!1)},offset:o.offset})):(r.viewBoundingSphere(c,o.offset),r.lookAtTransform(L.IDENTITY),BI(e),e._completeZoom(!0))}function o0t(e){if(!e._needTrackedEntityUpdate)return;let t=e._trackedEntity,i=e.clock.currentTime,n=j.getValueOrUndefined(t.position,i);if(!u(n))return;let r=e.scene,o=e._dataSourceDisplay.getBoundingSphere(t,!1,Vy);if(o===at.PENDING)return;let a=r.mode;(a===te.COLUMBUS_VIEW||a===te.SCENE2D)&&(r.screenSpaceCameraController.enableTranslate=!1),(a===te.COLUMBUS_VIEW||a===te.SCENE3D)&&(r.screenSpaceCameraController.enableTilt=!1);let s=o!==at.FAILED?Vy:void 0;e._entityView=new uz(t,r,r.mapProjection.ellipsoid),e._entityView.update(i,s),e._needTrackedEntityUpdate=!1}Object.defineProperties(Di.prototype,{container:{get:function(){return this._container}},creditDisplay:{get:function(){return this._cesiumWidget.creditDisplay}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},postProcessStages:{get:function(){return this.scene.postProcessStages}},clock:{get:function(){return this._clockViewModel.clock}},clockViewModel:{get:function(){return this._clockViewModel}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e}},useBrowserRecommendedResolution:{get:function(){return this._cesiumWidget.useBrowserRecommendedResolution},set:function(e){this._cesiumWidget.useBrowserRecommendedResolution=e}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e,nX(this);let t=this.scene,i=t.mode;u(e)&&u(e.position)?this._needTrackedEntityUpdate=!0:(this._needTrackedEntityUpdate=!1,(i===te.COLUMBUS_VIEW||i===te.SCENE2D)&&(t.screenSpaceCameraController.enableTranslate=!0),(i===te.COLUMBUS_VIEW||i===te.SCENE3D)&&(t.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,this.camera.lookAtTransform(L.IDENTITY)),this._trackedEntityChanged.raiseEvent(e),this.scene.requestRender()}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;let t=u(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;u(e)?u(t)&&t.animateAppear():u(t)&&t.animateDepart(),this._selectedEntityChanged.raiseEvent(e)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){this._clockTrackedDataSource!==e&&(this._clockTrackedDataSource=e,Qxe(this._timeline,this.clock,e))}}}),Di.prototype.extend=function(e,t){e(this,t)},Di.prototype.resize=function(){let e=this._cesiumWidget,t=this._container,i=t.clientWidth,n=t.clientHeight,r=u(this._animation),o=u(this._timeline);if(e.resize(),i===this._lastWidth&&n===this._lastHeight)return;let a=n-125,s=this._baseLayerPickerDropDown;if(u(s)&&(s.style.maxHeight=`${a}px`),u(this._geocoder)){this._geocoder.searchSuggestionsContainer.style.maxHeight=`${a}px`}u(this._infoBox)&&(this._infoBox.viewModel.maxHeight=a);let l,c=this._timeline,h=0,d=0,p=0;if(r&&"hidden"!==window.getComputedStyle(this._animation.container).visibility){let e=this._lastWidth;l=this._animation.container,i>900?(h=169,e<=900&&(l.style.width="169px",l.style.height="112px",this._animation.resize())):i>=600?(h=136,(e<600||e>900)&&(l.style.width="136px",l.style.height="90px",this._animation.resize())):(h=106,(e>600||0===e)&&(l.style.width="106px",l.style.height="70px",this._animation.resize())),d=h+5}if(o&&"hidden"!==window.getComputedStyle(this._timeline.container).visibility){let e=this._fullscreenButton,t=this._vrButton,i=c.container,n=i.style;p=i.clientHeight+3,n.left=`${h}px`;let r=0;u(e)&&(r+=e.container.clientWidth),u(t)&&(r+=t.container.clientWidth),n.right=`${r}px`,c.resize()}this._bottomContainer.style.left=`${d}px`,this._bottomContainer.style.bottom=`${p}px`,this._lastWidth=i,this._lastHeight=n},Di.prototype.forceResize=function(){this._lastWidth=0,this.resize()},Di.prototype.render=function(){this._cesiumWidget.render()},Di.prototype.isDestroyed=function(){return!1},Di.prototype.destroy=function(){let e;this.screenSpaceEventHandler.removeInputAction(_n.LEFT_CLICK),this.screenSpaceEventHandler.removeInputAction(_n.LEFT_DOUBLE_CLICK);let t=this.dataSources,i=t.length;for(e=0;e<i;e++)this._dataSourceRemoved(t,t.get(e));return this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._container.removeChild(this._element),this._element.removeChild(this._toolbar),this._eventHelper.removeAll(),u(this._geocoder)&&(this._geocoder=this._geocoder.destroy()),u(this._homeButton)&&(this._homeButton=this._homeButton.destroy()),u(this._sceneModePicker)&&(this._sceneModePicker=this._sceneModePicker.destroy()),u(this._projectionPicker)&&(this._projectionPicker=this._projectionPicker.destroy()),u(this._baseLayerPicker)&&(this._baseLayerPicker=this._baseLayerPicker.destroy()),u(this._animation)&&(this._element.removeChild(this._animation.container),this._animation=this._animation.destroy()),u(this._timeline)&&(this._timeline.removeEventListener("settime",$xe,!1),this._element.removeChild(this._timeline.container),this._timeline=this._timeline.destroy()),u(this._fullscreenButton)&&(this._fullscreenSubscription.dispose(),this._element.removeChild(this._fullscreenButton.container),this._fullscreenButton=this._fullscreenButton.destroy()),u(this._vrButton)&&(this._vrSubscription.dispose(),this._vrModeSubscription.dispose(),this._element.removeChild(this._vrButton.container),this._vrButton=this._vrButton.destroy()),u(this._infoBox)&&(this._element.removeChild(this._infoBox.container),this._infoBox=this._infoBox.destroy()),u(this._selectionIndicator)&&(this._element.removeChild(this._selectionIndicator.container),this._selectionIndicator=this._selectionIndicator.destroy()),this._destroyClockViewModel&&(this._clockViewModel=this._clockViewModel.destroy()),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),this._cesiumWidget=this._cesiumWidget.destroy(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),le(this)},Di.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(Di.prototype._onEntityCollectionChanged,this)},Di.prototype._dataSourceRemoved=function(e,t){let i=t.entities;i.collectionChanged.removeEventListener(Di.prototype._onEntityCollectionChanged,this),u(this.trackedEntity)&&i.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0),u(this.selectedEntity)&&i.getById(this.selectedEntity.id)===this.selectedEntity&&(this.selectedEntity=void 0)},Di.prototype._onTick=function(e){let t=e.currentTime,i=this._dataSourceDisplay.update(t);this._allowDataSourcesToSuspendAnimation&&(this._clockViewModel.canAnimate=i);let n=this._entityView;if(u(n)){let e=this._trackedEntity;this._dataSourceDisplay.getBoundingSphere(e,!1,Vy)===at.DONE&&n.update(t,Vy)}let r,o=!1,a=this.selectedEntity,s=u(a)&&this._enableInfoOrSelection;s&&a.isShowing&&a.isAvailable(t)&&(this._dataSourceDisplay.getBoundingSphere(a,!0,Vy)!==at.FAILED?r=Vy.center:u(a.position)&&(r=a.position.getValue(t,r)),o=u(r));let l=u(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;u(l)&&(l.position=h.clone(r,l.position),l.showSelection=s&&o,l.update());let c=u(this._infoBox)?this._infoBox.viewModel:void 0;u(c)&&(c.showInfo=s,c.enableCamera=o,c.isCameraTracking=this.trackedEntity===this.selectedEntity,s?(c.titleText=y(a.name,a.id),c.description=j.getValueOrDefault(a.description,t,"")):(c.titleText="",c.description=""))},Di.prototype._onEntityCollectionChanged=function(e,t,i){let n=i.length;for(let e=0;e<n;e++){let t=i[e];this.trackedEntity===t&&(this.trackedEntity=void 0),this.selectedEntity===t&&(this.selectedEntity=void 0)}},Di.prototype._onInfoBoxCameraClicked=function(e){if(e.isCameraTracking&&this.trackedEntity===this.selectedEntity)this.trackedEntity=void 0;else{let e=this.selectedEntity.position;u(e)?this.trackedEntity=this.selectedEntity:this.zoomTo(this.selectedEntity)}},Di.prototype._clearTrackedObject=function(){this.trackedEntity=void 0},Di.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=void 0},Di.prototype._clearObjects=function(){this.trackedEntity=void 0,this.selectedEntity=void 0},Di.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&Qxe(this.timeline,this.clock,e)},Di.prototype._onDataSourceAdded=function(e,t){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=t);let i=t.entities.id,n=this._eventHelper.add(t.changedEvent,Di.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[i]=n},Di.prototype._onDataSourceRemoved=function(e,t){let i=this.clockTrackedDataSource===t,n=t.entities.id;if(this._dataSourceChangedListeners[n](),this._dataSourceChangedListeners[n]=void 0,i){let t=e.length;this._automaticallyTrackDataSourceClocks&&t>0?this.clockTrackedDataSource=e.get(t-1):this.clockTrackedDataSource=void 0}},Di.prototype.zoomTo=function(e,t){return Jxe(this,e,{offset:t},!1)},Di.prototype.flyTo=function(e,t){return Jxe(this,e,t,!0)},Di.prototype._postRender=function(){i0t(this),o0t(this)};var ebe=Di;function r0t(e){return function(t){let i=e._scene.pick(t.position);u(i)&&i.primitive instanceof ca&&(e.tileset=i.primitive),e.pickActive=!1}}function nbe(e,t){t?e._eventHandler.setInputAction((function(t){let i=e._scene.pick(t.endPosition);u(i)&&i.primitive instanceof ca&&(e.tileset=i.primitive)}),_n.MOUSE_MOVE):(e._eventHandler.removeInputAction(_n.MOUSE_MOVE),e.picking=e.picking)}var s0t={maximumFractionDigits:3};function kI(e){let t=e/1048576;return t<1?t.toLocaleString(void 0,s0t):Math.round(t).toLocaleString()}function VI(e,t){if(!u(e))return"";let i=t?e._statisticsPerPass[Io.PICK]:e._statisticsPerPass[Io.RENDER],n='<ul class="cesium-cesiumInspector-statistics">';return n+=`<li><strong>Visited: </strong>${i.visited.toLocaleString()}</li><li><strong>Selected: </strong>${i.selected.toLocaleString()}</li><li><strong>Commands: </strong>${i.numberOfCommands.toLocaleString()}</li>`,n+="</ul>",t||(n+='<ul class="cesium-cesiumInspector-statistics">',n+=`<li><strong>Requests: </strong>${i.numberOfPendingRequests.toLocaleString()}</li><li><strong>Attempted: </strong>${i.numberOfAttemptedRequests.toLocaleString()}</li><li><strong>Processing: </strong>${i.numberOfTilesProcessing.toLocaleString()}</li><li><strong>Content Ready: </strong>${i.numberOfTilesWithContentReady.toLocaleString()}</li><li><strong>Total: </strong>${i.numberOfTilesTotal.toLocaleString()}</li>`,n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+=`<li><strong>Features Selected: </strong>${i.numberOfFeaturesSelected.toLocaleString()}</li><li><strong>Features Loaded: </strong>${i.numberOfFeaturesLoaded.toLocaleString()}</li><li><strong>Points Selected: </strong>${i.numberOfPointsSelected.toLocaleString()}</li><li><strong>Points Loaded: </strong>${i.numberOfPointsLoaded.toLocaleString()}</li><li><strong>Triangles Selected: </strong>${i.numberOfTrianglesSelected.toLocaleString()}</li>`,n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+=`<li><strong>Tiles styled: </strong>${i.numberOfTilesStyled.toLocaleString()}</li><li><strong>Features styled: </strong>${i.numberOfFeaturesStyled.toLocaleString()}</li>`,n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+=`<li><strong>Children Union Culled: </strong>${i.numberOfTilesCulledWithChildrenUnion.toLocaleString()}</li>`,n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+=`<li><strong>Geometry Memory (MB): </strong>${kI(i.geometryByteLength)}</li><li><strong>Texture Memory (MB): </strong>${kI(i.texturesByteLength)}</li><li><strong>Batch Table Memory (MB): </strong>${kI(i.batchTableByteLength)}</li>`,n+="</ul>"),n}function ibe(){let e=Gi.statistics;return`\n  <ul class="cesium-cesiumInspector-statistics">\n    <li><strong>Geometry Memory (MB): </strong>${kI(e.geometryByteLength)}</li>\n    <li><strong>Texture Memory (MB): </strong>${kI(e.texturesByteLength)}</li>\n  </ul>\n  `}var a0t=[{text:"Highlight",value:Vl.HIGHLIGHT},{text:"Replace",value:Vl.REPLACE},{text:"Mix",value:Vl.MIX}],tbe=new z(1,1,0,.4),c0t=new z,D8=new z;function Js(e,t){let i=this,n=e.canvas;this._eventHandler=new Hu(n),this._scene=e,this._performanceContainer=t,this._canvas=n,this._performanceDisplay=new Xg({container:t}),this._statisticsText="",this._pickStatisticsText="",this._resourceCacheStatisticsText="",this._editorError="",this.performance=!1,this.showStatistics=!0,this.showPickStatistics=!0,this.showResourceCacheStatistics=!1,this.inspectorVisible=!0,this.tilesetVisible=!1,this.displayVisible=!1,this.updateVisible=!1,this.loggingVisible=!1,this.styleVisible=!1,this.tileDebugLabelsVisible=!1,this.optimizationVisible=!1,this.styleString="{}",this.hasEnabledWireframe=!1,this._tileset=void 0,this._feature=void 0,this._tile=void 0,Te.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_resourceCacheStatisticsText","_editorError","showPickStatistics","showStatistics","showResourceCacheStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile","_tileset","hasEnabledWireframe"]),this._properties=Te.observable({}),this.properties=[],Te.defineProperty(this,"properties",(function(){let e=[],t=i._properties();for(let i in t)t.hasOwnProperty(i)&&e.push(i);return e}));let r=Te.observable();Te.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return r()},set:function(e){r(e),u(i._tileset)&&(i._tileset.dynamicScreenSpaceError=e)}}),this.dynamicScreenSpaceError=!1;let o=Te.observable();Te.defineProperty(this,"colorBlendMode",{get:function(){return o()},set:function(e){o(e),u(i._tileset)&&(i._tileset.colorBlendMode=e,i._scene.requestRender())}}),this.colorBlendMode=Vl.HIGHLIGHT;let a=Te.observable(),s=Te.observable();Te.defineProperty(this,"picking",{get:function(){return s()},set:function(t){s(t),t?i._eventHandler.setInputAction((function(t){let n=e.pick(t.endPosition);if(n instanceof Fs?(i.feature=n,i.tile=n.content.tile):u(n)&&u(n.content)?(i.feature=void 0,i.tile=n.content.tile):(i.feature=void 0,i.tile=void 0),u(i._tileset)){if(a&&u(n)&&u(n.content)){let r;e.pickPositionSupported&&(r=e.pickPosition(t.endPosition),u(r)&&(i._tileset.debugPickPosition=r)),i._tileset.debugPickedTile=n.content.tile}else i._tileset.debugPickedTile=void 0;i._scene.requestRender()}}),_n.MOUSE_MOVE):(i.feature=void 0,i.tile=void 0,i._eventHandler.removeInputAction(_n.MOUSE_MOVE))}}),this.picking=!0;let l=Te.observable();Te.defineProperty(this,"colorize",{get:function(){return l()},set:function(e){l(e),u(i._tileset)&&(i._tileset.debugColorizeTiles=e,i._scene.requestRender())}}),this.colorize=!1;let c=Te.observable();Te.defineProperty(this,"wireframe",{get:function(){return c()},set:function(e){c(e),u(i._tileset)&&(i._tileset.debugWireframe=e,i._scene.requestRender())}}),this.wireframe=!1;let h=Te.observable();Te.defineProperty(this,"showBoundingVolumes",{get:function(){return h()},set:function(e){h(e),u(i._tileset)&&(i._tileset.debugShowBoundingVolume=e,i._scene.requestRender())}}),this.showBoundingVolumes=!1;let d=Te.observable();Te.defineProperty(this,"showContentBoundingVolumes",{get:function(){return d()},set:function(e){d(e),u(i._tileset)&&(i._tileset.debugShowContentBoundingVolume=e,i._scene.requestRender())}}),this.showContentBoundingVolumes=!1;let p=Te.observable();Te.defineProperty(this,"showRequestVolumes",{get:function(){return p()},set:function(e){p(e),u(i._tileset)&&(i._tileset.debugShowViewerRequestVolume=e,i._scene.requestRender())}}),this.showRequestVolumes=!1;let f=Te.observable();Te.defineProperty(this,"freezeFrame",{get:function(){return f()},set:function(e){f(e),u(i._tileset)&&(i._tileset.debugFreezeFrame=e,i._scene.debugShowFrustumPlanes=e,i._scene.requestRender())}}),this.freezeFrame=!1,Te.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return a()},set:function(e){a(e),u(i._tileset)&&(i._tileset.debugPickedTileLabelOnly=e,i._scene.requestRender())}}),this.showOnlyPickedTileDebugLabel=!1;let m=Te.observable();Te.defineProperty(this,"showGeometricError",{get:function(){return m()},set:function(e){m(e),u(i._tileset)&&(i._tileset.debugShowGeometricError=e,i._scene.requestRender())}}),this.showGeometricError=!1;let _=Te.observable();Te.defineProperty(this,"showRenderingStatistics",{get:function(){return _()},set:function(e){_(e),u(i._tileset)&&(i._tileset.debugShowRenderingStatistics=e,i._scene.requestRender())}}),this.showRenderingStatistics=!1;let g=Te.observable();Te.defineProperty(this,"showMemoryUsage",{get:function(){return g()},set:function(e){g(e),u(i._tileset)&&(i._tileset.debugShowMemoryUsage=e,i._scene.requestRender())}}),this.showMemoryUsage=!1;let y=Te.observable();Te.defineProperty(this,"showUrl",{get:function(){return y()},set:function(e){y(e),u(i._tileset)&&(i._tileset.debugShowUrl=e,i._scene.requestRender())}}),this.showUrl=!1;let v=Te.observable();Te.defineProperty(this,"maximumScreenSpaceError",{get:function(){return v()},set:function(e){e=Number(e),isNaN(e)||(v(e),u(i._tileset)&&(i._tileset.maximumScreenSpaceError=e))}}),this.maximumScreenSpaceError=16;let b=Te.observable();Te.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return b()},set:function(e){e=Number(e),isNaN(e)||(b(e),u(i._tileset)&&(i._tileset.dynamicScreenSpaceErrorDensity=e))}}),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorDensitySliderValue=void 0,Te.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(b(),1/6)},set:function(e){b(Math.pow(e,6))}});let A=Te.observable();Te.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return A()},set:function(e){e=Number(e),isNaN(e)||(A(e),u(i._tileset)&&(i._tileset.dynamicScreenSpaceErrorFactor=e))}}),this.dynamicScreenSpaceErrorFactor=4;let T=r0t(this),E=Te.observable();Te.defineProperty(this,"pickActive",{get:function(){return E()},set:function(e){E(e),e?i._eventHandler.setInputAction(T,_n.LEFT_CLICK):i._eventHandler.removeInputAction(_n.LEFT_CLICK)}});let C=Te.observable();Te.defineProperty(this,"pointCloudShading",{get:function(){return C()},set:function(e){C(e),u(i._tileset)&&(i._tileset.pointCloudShading.attenuation=e)}}),this.pointCloudShading=!1;let x=Te.observable();Te.defineProperty(this,"geometricErrorScale",{get:function(){return x()},set:function(e){e=Number(e),isNaN(e)||(x(e),u(i._tileset)&&(i._tileset.pointCloudShading.geometricErrorScale=e))}}),this.geometricErrorScale=1;let S=Te.observable();Te.defineProperty(this,"maximumAttenuation",{get:function(){return S()},set:function(e){e=Number(e),isNaN(e)||(S(e),u(i._tileset)&&(i._tileset.pointCloudShading.maximumAttenuation=0===e?void 0:e))}}),this.maximumAttenuation=0;let w=Te.observable();Te.defineProperty(this,"baseResolution",{get:function(){return w()},set:function(e){e=Number(e),isNaN(e)||(w(e),u(i._tileset)&&(i._tileset.pointCloudShading.baseResolution=0===e?void 0:e))}}),this.baseResolution=0;let I=Te.observable();Te.defineProperty(this,"eyeDomeLighting",{get:function(){return I()},set:function(e){I(e),u(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLighting=e)}}),this.eyeDomeLighting=!1;let P=Te.observable();Te.defineProperty(this,"eyeDomeLightingStrength",{get:function(){return P()},set:function(e){e=Number(e),isNaN(e)||(P(e),u(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLightingStrength=e))}}),this.eyeDomeLightingStrength=1;let D=Te.observable();Te.defineProperty(this,"eyeDomeLightingRadius",{get:function(){return D()},set:function(e){e=Number(e),isNaN(e)||(D(e),u(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLightingRadius=e))}}),this.eyeDomeLightingRadius=1,this.pickActive=!1;let O=Te.observable();Te.defineProperty(this,"skipLevelOfDetail",{get:function(){return O()},set:function(e){O(e),u(i._tileset)&&(i._tileset.skipLevelOfDetail=e)}}),this.skipLevelOfDetail=!0;let L=Te.observable();Te.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return L()},set:function(e){e=Number(e),isNaN(e)||(L(e),u(i._tileset)&&(i._tileset.skipScreenSpaceErrorFactor=e))}}),this.skipScreenSpaceErrorFactor=16;let R=Te.observable();Te.defineProperty(this,"baseScreenSpaceError",{get:function(){return R()},set:function(e){e=Number(e),isNaN(e)||(R(e),u(i._tileset)&&(i._tileset.baseScreenSpaceError=e))}}),this.baseScreenSpaceError=1024;let N=Te.observable();Te.defineProperty(this,"skipLevels",{get:function(){return N()},set:function(e){e=Number(e),isNaN(e)||(N(e),u(i._tileset)&&(i._tileset.skipLevels=e))}}),this.skipLevels=1;let M=Te.observable();Te.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return M()},set:function(e){M(e),u(i._tileset)&&(i._tileset.immediatelyLoadDesiredLevelOfDetail=e)}}),this.immediatelyLoadDesiredLevelOfDetail=!1;let F=Te.observable();Te.defineProperty(this,"loadSiblings",{get:function(){return F()},set:function(e){F(e),u(i._tileset)&&(i._tileset.loadSiblings=e)}}),this.loadSiblings=!1,this._style=void 0,this._shouldStyle=!1,this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl","pointCloudShading","geometricErrorScale","maximumAttenuation","baseResolution","eyeDomeLighting","eyeDomeLightingStrength","eyeDomeLightingRadius"],this._removePostRenderEvent=e.postRender.addEventListener((function(){i._update()})),u(this._tileset)||nbe(this,!0)}function iX(e){if(!u(e))return!1;if(e.featuresLength>0)return!0;let t=e.innerContents;if(u(t)){let e=t.length;for(let i=0;i<e;++i)if(!iX(t[i]))return!1;return!0}return!1}Object.defineProperties(Js.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},resourceCacheStatisticsText:{get:function(){return this._resourceCacheStatisticsText}},colorBlendModes:{get:function(){return a0t}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(e){if(this._tileset=e,this._style=void 0,this.styleString="{}",this.feature=void 0,this.tile=void 0,u(e)){this._properties(e.properties);let t=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"],i=t.length;for(let e=0;e<i;++e){let i=t[e];this[i]=this[i]}this.maximumScreenSpaceError=e.maximumScreenSpaceError,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor,this.colorBlendMode=e.colorBlendMode,this.skipLevelOfDetail=e.skipLevelOfDetail,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor,this.baseScreenSpaceError=e.baseScreenSpaceError,this.skipLevels=e.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=e.loadSiblings,this.hasEnabledWireframe=e._enableDebugWireframe;let n=e.pointCloudShading;this.pointCloudShading=n.attenuation,this.geometricErrorScale=n.geometricErrorScale,this.maximumAttenuation=n.maximumAttenuation?n.maximumAttenuation:0,this.baseResolution=n.baseResolution?n.baseResolution:0,this.eyeDomeLighting=n.eyeDomeLighting,this.eyeDomeLightingStrength=n.eyeDomeLightingStrength,this.eyeDomeLightingRadius=n.eyeDomeLightingRadius,this._scene.requestRender()}else this._properties({});this._statisticsText=VI(e,!1),this._pickStatisticsText=VI(e,!0),this._resourceCacheStatisticsText=ibe(),nbe(this,!1)}},feature:{get:function(){return this._feature},set:function(e){if(this._feature===e)return;let t=this._feature;u(t)&&!t.content.isDestroyed()&&(!this.colorize&&u(this._style)?t.color=u(this._style.color)?this._style.color.evaluateColor(t,c0t):z.WHITE:t.color=D8,this._scene.requestRender()),u(e)&&(z.clone(e.color,D8),e.color=tbe,this._scene.requestRender()),this._feature=e}},tile:{get:function(){return this._tile},set:function(e){if(this._tile===e)return;let t=this._tile;u(t)&&!t.isDestroyed()&&!iX(t.content)&&(t.color=D8,this._scene.requestRender()),u(e)&&!iX(e.content)&&(z.clone(e.color,D8),e.color=tbe,this._scene.requestRender()),this._tile=e}}}),Js.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive},Js.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible},Js.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible},Js.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible},Js.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible},Js.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible},Js.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible},Js.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible},Js.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible},Js.prototype.trimTilesCache=function(){u(this._tileset)&&this._tileset.trimLoadedTiles()},Js.prototype.compileStyle=function(){let e=this._tileset;if(u(e)&&this.styleString!==JSON.stringify(e.style)){this._editorError="";try{0===this.styleString.length&&(this.styleString="{}"),this._style=new QA(JSON.parse(this.styleString)),this._shouldStyle=!0,this._scene.requestRender()}catch(e){this._editorError=e.toString()}this.feature=this._feature,this.tile=this._tile}},Js.prototype.styleEditorKeyPress=function(e,t){if(9===t.keyCode){t.preventDefault();let e,i=t.target,n=i.selectionStart,r=i.selectionEnd,o=r,a=i.value.slice(n,r).split("\n"),s=a.length;if(t.shiftKey)for(e=0;e<s;++e)" "===a[e][0]&&(" "===a[e][1]?(a[e]=a[e].substr(2),o-=2):(a[e]=a[e].substr(1),o-=1));else for(e=0;e<s;++e)a[e]=`  ${a[e]}`,o+=2;let l=a.join("\n");i.value=i.value.slice(0,n)+l+i.value.slice(r),i.selectionStart=n!==r?n:o,i.selectionEnd=o}else t.ctrlKey&&(10===t.keyCode||13===t.keyCode)&&this.compileStyle();return!0},Js.prototype._update=function(){let e=this._tileset;if(this.performance&&this._performanceDisplay.update(),u(e)){if(e.isDestroyed())return this.tile=void 0,this.feature=void 0,void(this.tileset=void 0);let t=e.style;this._style!==e.style&&(this._shouldStyle?(e.style=this._style,this._shouldStyle=!1):(this._style=t,this.styleString=JSON.stringify(t.style,null,"  ")))}this.showStatistics&&(this._statisticsText=VI(e,!1),this._pickStatisticsText=VI(e,!0),this._resourceCacheStatisticsText=ibe())},Js.prototype.isDestroyed=function(){return!1},Js.prototype.destroy=function(){this._eventHandler.destroy(),this._removePostRenderEvent();let e=this;return this._definedProperties.forEach((function(t){Te.getObservable(e,t).dispose()})),le(this)},Js.getStatistics=VI;var I8=Js;function P8(e,t){e=In(e);let i=document.createElement("div"),n=document.createElement("div");n.setAttribute("data-bind","visible: performance");let r=new I8(t,n);this._viewModel=r,this._container=e,this._element=i;let o=document.createElement("div");o.textContent="3D Tiles Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleInspector"),i.appendChild(o),i.className="cesium-cesiumInspector cesium-3DTilesInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(i);let a=document.createElement("div");a.className="cesium-cesiumInspector-dropDown",i.appendChild(a);let s=Ja.createSection,l=Ja.createCheckbox,u=Ja.createRangeInput,c=Ja.createButton,h=s(a,"Tileset","tilesetVisible","toggleTileset"),d=s(a,"Display","displayVisible","toggleDisplay"),p=s(a,"Update","updateVisible","toggleUpdate"),f=s(a,"Logging","loggingVisible","toggleLogging"),m=s(a,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),_=s(a,"Style","styleVisible","toggleStyle"),g=s(a,"Optimization","optimizationVisible","toggleOptimization"),y=document.createElement("div");y.className="field-group";let v=document.createElement("label");v.className="field-label",v.appendChild(document.createTextNode("Properties: "));let b=document.createElement("div");b.setAttribute("data-bind","text: properties"),y.appendChild(v),y.appendChild(b),h.appendChild(y),h.appendChild(c("Pick Tileset","togglePickTileset","pickActive")),h.appendChild(c("Trim Tiles Cache","trimTilesCache")),h.appendChild(l("Enable Picking","picking")),d.appendChild(l("Colorize","colorize"));let A=d.appendChild(l("Wireframe","wireframe","_tileset === undefined || hasEnabledWireframe")),T=document.createElement("p");T.setAttribute("data-bind","visible: _tileset !== undefined && !hasEnabledWireframe"),T.setAttribute("class","cesium-3DTilesInspector-disabledElementsInfo"),T.innerText="Set enableDebugWireframe to true in the tileset constructor to enable this option.",A.appendChild(T),d.appendChild(l("Bounding Volumes","showBoundingVolumes")),d.appendChild(l("Content Volumes","showContentBoundingVolumes")),d.appendChild(l("Request Volumes","showRequestVolumes")),d.appendChild(l("Point Cloud Shading","pointCloudShading"));let E=document.createElement("div");E.setAttribute("data-bind","visible: pointCloudShading"),E.appendChild(u("Geometric Error Scale","geometricErrorScale",0,2,.01)),E.appendChild(u("Maximum Attenuation","maximumAttenuation",0,32,1)),E.appendChild(u("Base Resolution","baseResolution",0,1,.01)),E.appendChild(l("Eye Dome Lighting (EDL)","eyeDomeLighting")),d.appendChild(E);let C=document.createElement("div");C.setAttribute("data-bind","visible: eyeDomeLighting"),C.appendChild(u("EDL Strength","eyeDomeLightingStrength",0,2,.1)),C.appendChild(u("EDL Radius","eyeDomeLightingRadius",0,4,.1)),E.appendChild(C),p.appendChild(l("Freeze Frame","freezeFrame")),p.appendChild(l("Dynamic Screen Space Error","dynamicScreenSpaceError"));let x=document.createElement("div");x.appendChild(u("Maximum Screen Space Error","maximumScreenSpaceError",0,128,1)),p.appendChild(x);let S=document.createElement("div");S.setAttribute("data-bind","visible: dynamicScreenSpaceError"),S.appendChild(u("Screen Space Error Density","dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"dynamicScreenSpaceErrorDensity")),S.appendChild(u("Screen Space Error Factor","dynamicScreenSpaceErrorFactor",1,10,.1)),p.appendChild(S),f.appendChild(l("Performance","performance")),f.appendChild(n),f.appendChild(l("Statistics","showStatistics"));let w=document.createElement("div");w.className="cesium-3dTilesInspector-statistics",w.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),f.appendChild(w),f.appendChild(l("Pick Statistics","showPickStatistics"));let I=document.createElement("div");I.className="cesium-3dTilesInspector-statistics",I.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),f.appendChild(I),f.appendChild(l("Resource Cache Statistics","showResourceCacheStatistics"));let P=document.createElement("div");P.className="cesium-3dTilesInspector-statistics",P.setAttribute("data-bind","html: resourceCacheStatisticsText, visible: showResourceCacheStatistics"),f.appendChild(P);let D=document.createElement("div");_.appendChild(D),D.appendChild(document.createTextNode("Color Blend Mode: "));let O=document.createElement("select");O.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),D.appendChild(O);let L=document.createElement("textarea");L.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),D.className="cesium-cesiumInspector-styleEditor",D.appendChild(L);let R=c("Compile (Ctrl+Enter)","compileStyle");D.appendChild(R);let N=document.createElement("div");N.className="cesium-cesiumInspector-error",N.setAttribute("data-bind","text: editorError"),D.appendChild(N),m.appendChild(l("Show Picked Only","showOnlyPickedTileDebugLabel")),m.appendChild(l("Geometric Error","showGeometricError")),m.appendChild(l("Rendering Statistics","showRenderingStatistics")),m.appendChild(l("Memory Usage (MB)","showMemoryUsage")),m.appendChild(l("Url","showUrl")),g.appendChild(l("Skip Tile LODs","skipLevelOfDetail"));let M=document.createElement("div");M.appendChild(u("Skip SSE Factor","skipScreenSpaceErrorFactor",1,50,1)),g.appendChild(M);let F=document.createElement("div");F.appendChild(u("SSE before skipping LOD","baseScreenSpaceError",0,4096,1)),g.appendChild(F);let B=document.createElement("div");B.appendChild(u("Min. levels to skip","skipLevels",0,10,1)),g.appendChild(B),g.appendChild(l("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),g.appendChild(l("Load siblings of visible tiles","loadSiblings")),Te.applyBindings(r,i)}Object.defineProperties(P8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),P8.prototype.isDestroyed=function(){return!1},P8.prototype.destroy=function(){return Te.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),le(this)};var O8=P8;function l0t(e){let t=document.createElement("div");t.className="cesium-viewer-cesium3DTilesInspectorContainer",e.container.appendChild(t);let i=new O8(t,e.scene);Object.defineProperties(e,{cesium3DTilesInspector:{get:function(){return i}}})}var obe=l0t;function u0t(e){let t;if(u(e)){t="Command Statistics";let i=e.commandsInFrustums;for(let e in i)if(i.hasOwnProperty(e)){let n,r=parseInt(e,10);if(7===r)n="1, 2 and 3";else{let e=[];for(let t=2;t>=0;t--){let i=Math.pow(2,t);r>=i&&(e.push(t+1),r-=i)}n=e.reverse().join(" and ")}t+=`<br>&nbsp;&nbsp;&nbsp;&nbsp;${i[e]} in frustum ${n}`}t+=`<br>Total: ${e.totalCommands}`}return t}function oX(e,t,i){let n=Math.min(i,t);return n=Math.max(n,e),n}var f0t=new Tn,d0t=new h;function UI(e,t){let i=this,n=e.canvas,r=new Hu(n);this._eventHandler=r,this._scene=e,this._canvas=n,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=t;let o,a=this._scene.globe;function s(e){let t=i._scene.pick({x:e.position.x,y:e.position.y});u(t)&&(i.primitive=u(t.collection)?t.collection:t.primitive),i._scene.requestRender(),i.pickPrimitiveActive=!1}function l(e){let t,n=a.ellipsoid,r=i._scene.camera.getPickRay(e.position,f0t),o=a.pick(r,i._scene,d0t);if(u(o)){let e=n.cartesianToCartographic(o),i=a._surface.tileProvider._tilesToRenderByTextureCount;for(let n=0;!t&&n<i.length;++n){let r=i[n];if(u(r))for(let i=0;!t&&i<r.length;++i){let n=r[i];ce.contains(n.rectangle,e)&&(t=n)}}}i.tile=t,i.pickTileActive=!1}a.depthTestAgainstTerrain=!0,this.frustums=!1,this.frustumPlanes=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText=!1,this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPrimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.depthFrustumText="",Te.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]),this._toggleDropDown=En((function(){i.dropDownVisible=!i.dropDownVisible})),this._toggleGeneral=En((function(){i.generalVisible=!i.generalVisible})),this._togglePrimitives=En((function(){i.primitivesVisible=!i.primitivesVisible})),this._toggleTerrain=En((function(){i.terrainVisible=!i.terrainVisible})),this._frustumsSubscription=Te.getObservable(this,"frustums").subscribe((function(e){i._scene.debugShowFrustums=e,i._scene.requestRender()})),this._frustumPlanesSubscription=Te.getObservable(this,"frustumPlanes").subscribe((function(e){i._scene.debugShowFrustumPlanes=e,i._scene.requestRender()})),this._performanceSubscription=Te.getObservable(this,"performance").subscribe((function(e){e?i._performanceDisplay=new Xg({container:i._performanceContainer}):i._performanceContainer.innerHTML=""})),this._showPrimitiveBoundingSphere=En((function(){return i._primitive.debugShowBoundingVolume=i.primitiveBoundingSphere,i._scene.requestRender(),!0})),this._primitiveBoundingSphereSubscription=Te.getObservable(this,"primitiveBoundingSphere").subscribe((function(){i._showPrimitiveBoundingSphere()})),this._showPrimitiveReferenceFrame=En((function(){if(i.primitiveReferenceFrame){let e=i._primitive.modelMatrix;i._modelMatrixPrimitive=new w3({modelMatrix:e}),i._scene.primitives.add(i._modelMatrixPrimitive)}else u(i._modelMatrixPrimitive)&&(i._scene.primitives.remove(i._modelMatrixPrimitive),i._modelMatrixPrimitive=void 0);return i._scene.requestRender(),!0})),this._primitiveReferenceFrameSubscription=Te.getObservable(this,"primitiveReferenceFrame").subscribe((function(){i._showPrimitiveReferenceFrame()})),this._doFilterPrimitive=En((function(){return i.filterPrimitive?i._scene.debugCommandFilter=function(e){return!(!u(i._modelMatrixPrimitive)||e.owner!==i._modelMatrixPrimitive._primitive)||!!u(i._primitive)&&(e.owner===i._primitive||e.owner===i._primitive._billboardCollection||e.owner.primitive===i._primitive)}:i._scene.debugCommandFilter=void 0,!0})),this._filterPrimitiveSubscription=Te.getObservable(this,"filterPrimitive").subscribe((function(){i._doFilterPrimitive(),i._scene.requestRender()})),this._wireframeSubscription=Te.getObservable(this,"wireframe").subscribe((function(e){a._surface.tileProvider._debug.wireframe=e,i._scene.requestRender()})),this._depthFrustumSubscription=Te.getObservable(this,"depthFrustum").subscribe((function(e){i._scene.debugShowDepthFrustum=e,i._scene.requestRender()})),this._incrementDepthFrustum=En((function(){let e=i.depthFrustum+1;return i.depthFrustum=oX(1,i._numberOfFrustums,e),i._scene.requestRender(),!0})),this._decrementDepthFrustum=En((function(){let e=i.depthFrustum-1;return i.depthFrustum=oX(1,i._numberOfFrustums,e),i._scene.requestRender(),!0})),this._suspendUpdatesSubscription=Te.getObservable(this,"suspendUpdates").subscribe((function(e){a._surface._debug.suspendLodUpdate=e,e||(i.filterTile=!1)})),this._showTileCoordinates=En((function(){return i.tileCoordinates&&!u(o)?o=e.imageryLayers.addImageryProvider(new gU({tilingScheme:e.terrainProvider.tilingScheme})):!i.tileCoordinates&&u(o)&&(e.imageryLayers.remove(o),o=void 0),!0})),this._tileCoordinatesSubscription=Te.getObservable(this,"tileCoordinates").subscribe((function(){i._showTileCoordinates(),i._scene.requestRender()})),this._tileBoundingSphereSubscription=Te.getObservable(this,"tileBoundingSphere").subscribe((function(){i._showTileBoundingSphere(),i._scene.requestRender()})),this._showTileBoundingSphere=En((function(){return i.tileBoundingSphere?a._surface.tileProvider._debug.boundingSphereTile=i._tile:a._surface.tileProvider._debug.boundingSphereTile=void 0,i._scene.requestRender(),!0})),this._doFilterTile=En((function(){return i.filterTile?(i.suspendUpdates=!0,a._surface._tilesToRender=[],u(i._tile)&&i._tile.renderable&&a._surface._tilesToRender.push(i._tile)):i.suspendUpdates=!1,!0})),this._filterTileSubscription=Te.getObservable(this,"filterTile").subscribe((function(){i.doFilterTile(),i._scene.requestRender()})),this._pickPrimitive=En((function(){i.pickPrimitiveActive=!i.pickPrimitiveActive})),this._pickPrimitiveActiveSubscription=Te.getObservable(this,"pickPrimitiveActive").subscribe((function(e){e?r.setInputAction(s,_n.LEFT_CLICK):r.removeInputAction(_n.LEFT_CLICK)})),this._pickTile=En((function(){i.pickTileActive=!i.pickTileActive})),this._pickTileActiveSubscription=Te.getObservable(this,"pickTileActive").subscribe((function(e){e?r.setInputAction(l,_n.LEFT_CLICK):r.removeInputAction(_n.LEFT_CLICK)})),this._removePostRenderEvent=e.postRender.addEventListener((function(){i._update()}))}Object.defineProperties(UI.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){let e=this;return En((function(){e.tile=e.tile.parent}))}},selectNW:{get:function(){let e=this;return En((function(){e.tile=e.tile.northwestChild}))}},selectNE:{get:function(){let e=this;return En((function(){e.tile=e.tile.northeastChild}))}},selectSW:{get:function(){let e=this;return En((function(){e.tile=e.tile.southwestChild}))}},selectSE:{get:function(){let e=this;return En((function(){e.tile=e.tile.southeastChild}))}},primitive:{get:function(){return this._primitive},set:function(e){let t=this._primitive;e!==t&&(this.hasPickedPrimitive=!0,u(t)&&(t.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,u(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),this._primitive=e,e.show=!1,setTimeout((function(){e.show=!0}),50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())}},tile:{get:function(){return this._tile},set:function(e){if(u(e)){if(this.hasPickedTile=!0,e!==this._tile){this.tileText=`L: ${e.level} X: ${e.x} Y: ${e.y}`,this.tileText+=`<br>SW corner: ${e.rectangle.west}, ${e.rectangle.south}`,this.tileText+=`<br>NE corner: ${e.rectangle.east}, ${e.rectangle.north}`;let t=e.data;u(t)&&u(t.tileBoundingRegion)?this.tileText+=`<br>Min: ${t.tileBoundingRegion.minimumHeight} Max: ${t.tileBoundingRegion.maximumHeight}`:this.tileText+="<br>(Tile is not loaded)"}this._tile=e,this.showTileBoundingSphere(),this.doFilterTile()}else this.hasPickedTile=!1,this._tile=void 0}}}),UI.prototype._update=function(){this.frustums&&(this.frustumStatisticText=u0t(this._scene.debugFrustumStatistics));let e=this._scene.numberOfFrustums;this._numberOfFrustums=e,this.depthFrustum=oX(1,e,this.depthFrustum),this.depthFrustumText=`${this.depthFrustum} of ${e}`,this.performance&&this._performanceDisplay.update(),this.primitiveReferenceFrame&&(this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix),this.shaderCacheText=`Cached shaders: ${this._scene.context.shaderCache.numberOfShaders}`},UI.prototype.isDestroyed=function(){return!1},UI.prototype.destroy=function(){return this._eventHandler.destroy(),this._removePostRenderEvent(),this._frustumsSubscription.dispose(),this._frustumPlanesSubscription.dispose(),this._performanceSubscription.dispose(),this._primitiveBoundingSphereSubscription.dispose(),this._primitiveReferenceFrameSubscription.dispose(),this._filterPrimitiveSubscription.dispose(),this._wireframeSubscription.dispose(),this._depthFrustumSubscription.dispose(),this._suspendUpdatesSubscription.dispose(),this._tileCoordinatesSubscription.dispose(),this._tileBoundingSphereSubscription.dispose(),this._filterTileSubscription.dispose(),this._pickPrimitiveActiveSubscription.dispose(),this._pickTileActiveSubscription.dispose(),le(this)};var R8=UI;function M8(e,t){e=In(e);let i=document.createElement("div"),n=new R8(t,i);this._viewModel=n,this._container=e;let r=document.createElement("div");this._element=r;let o=document.createElement("div");o.textContent="Cesium Inspector",o.className="cesium-cesiumInspector-button",o.setAttribute("data-bind","click: toggleDropDown"),r.appendChild(o),r.className="cesium-cesiumInspector",r.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),e.appendChild(this._element);let a=document.createElement("div");a.className="cesium-cesiumInspector-dropDown",r.appendChild(a);let s=Ja.createSection,l=Ja.createCheckbox,u=s(a,"General","generalVisible","toggleGeneral"),c=l("Show Frustums","frustums"),h=document.createElement("div");h.className="cesium-cesiumInspector-frustumStatistics",h.setAttribute("data-bind","visible: frustums, html: frustumStatisticText"),c.appendChild(h),u.appendChild(c),u.appendChild(l("Show Frustum Planes","frustumPlanes")),u.appendChild(l("Performance Display","performance")),i.className="cesium-cesiumInspector-performanceDisplay",u.appendChild(i);let d=document.createElement("div");d.className="cesium-cesiumInspector-shaderCache",d.setAttribute("data-bind","html: shaderCacheText"),u.appendChild(d);let p=document.createElement("div");u.appendChild(p);let f=document.createElement("span");f.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),p.appendChild(f);let m=document.createElement("span");m.setAttribute("data-bind","text: depthFrustumText"),p.appendChild(m);let _=document.createElement("input");_.type="button",_.value="-",_.className="cesium-cesiumInspector-pickButton",_.setAttribute("data-bind","click: decrementDepthFrustum"),p.appendChild(_);let g=document.createElement("input");g.type="button",g.value="+",g.className="cesium-cesiumInspector-pickButton",g.setAttribute("data-bind","click: incrementDepthFrustum"),p.appendChild(g);let y=s(a,"Primitives","primitivesVisible","togglePrimitives"),v=document.createElement("div");v.className="cesium-cesiumInspector-pickSection",y.appendChild(v);let b=document.createElement("input");b.type="button",b.value="Pick a primitive",b.className="cesium-cesiumInspector-pickButton",b.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');let A=document.createElement("div");A.className="cesium-cesiumInspector-center",A.appendChild(b),v.appendChild(A),v.appendChild(l("Show bounding sphere","primitiveBoundingSphere","hasPickedPrimitive")),v.appendChild(l("Show reference frame","primitiveReferenceFrame","hasPickedPrimitive")),this._primitiveOnly=l("Show only selected","filterPrimitive","hasPickedPrimitive"),v.appendChild(this._primitiveOnly);let T=s(a,"Terrain","terrainVisible","toggleTerrain"),E=document.createElement("div");E.className="cesium-cesiumInspector-pickSection",T.appendChild(E);let C=document.createElement("input");C.type="button",C.value="Pick a tile",C.className="cesium-cesiumInspector-pickButton",C.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),A=document.createElement("div"),A.appendChild(C),A.className="cesium-cesiumInspector-center",E.appendChild(A);let x=document.createElement("div");E.appendChild(x);let S=document.createElement("input");S.type="button",S.value="Parent",S.className="cesium-cesiumInspector-pickButton",S.setAttribute("data-bind","click: selectParent");let w=document.createElement("input");w.type="button",w.value="NW",w.className="cesium-cesiumInspector-pickButton",w.setAttribute("data-bind","click: selectNW");let I=document.createElement("input");I.type="button",I.value="NE",I.className="cesium-cesiumInspector-pickButton",I.setAttribute("data-bind","click: selectNE");let P=document.createElement("input");P.type="button",P.value="SW",P.className="cesium-cesiumInspector-pickButton",P.setAttribute("data-bind","click: selectSW");let D=document.createElement("input");D.type="button",D.value="SE",D.className="cesium-cesiumInspector-pickButton",D.setAttribute("data-bind","click: selectSE");let O=document.createElement("div");O.className="cesium-cesiumInspector-tileText",x.className="cesium-cesiumInspector-frustumStatistics",x.appendChild(O),x.setAttribute("data-bind","visible: hasPickedTile"),O.setAttribute("data-bind","html: tileText");let L=document.createElement("div");L.className="cesium-cesiumInspector-relativeText",L.textContent="Select relative:",x.appendChild(L);let R=document.createElement("table"),N=document.createElement("tr"),M=document.createElement("tr"),F=document.createElement("td");F.appendChild(S);let B=document.createElement("td");B.appendChild(w);let z=document.createElement("td");z.appendChild(I),N.appendChild(F),N.appendChild(B),N.appendChild(z);let U=document.createElement("td"),k=document.createElement("td");k.appendChild(P);let V=document.createElement("td");V.appendChild(D),M.appendChild(U),M.appendChild(k),M.appendChild(V),R.appendChild(N),R.appendChild(M),x.appendChild(R),E.appendChild(l("Show bounding volume","tileBoundingSphere","hasPickedTile")),E.appendChild(l("Show only selected","filterTile","hasPickedTile")),T.appendChild(l("Wireframe","wireframe")),T.appendChild(l("Suspend LOD update","suspendUpdates")),T.appendChild(l("Show tile coordinates","tileCoordinates")),Te.applyBindings(n,this._element)}Object.defineProperties(M8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),M8.prototype.isDestroyed=function(){return!1},M8.prototype.destroy=function(){return Te.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),le(this)};var L8=M8;function h0t(e){let t=document.createElement("div");t.className="cesium-viewer-cesiumInspectorContainer",e.container.appendChild(t);let i=new L8(t,e.scene);Object.defineProperties(e,{cesiumInspector:{get:function(){return i}}})}var rbe=h0t;function m0t(e,t){t=y(t,y.EMPTY_OBJECT);let i=!0,n=y(t.flyToOnDrop,!0),r=new pe,o=y(t.clearOnDrop,!0),a=y(t.dropTarget,e.container),s=y(t.clampToGround,!0),l=t.proxy;function u(t){ub(t),o&&(e.entities.removeAll(),e.dataSources.removeAll());let i=t.dataTransfer.files,n=i.length;for(let t=0;t<n;t++){let n=i[t],r=new FileReader;r.onload=p0t(e,n,l,s),r.onerror=_0t(e,n),r.readAsText(n)}}a=In(a),Object.defineProperties(e,{dropTarget:{get:function(){return a},set:function(e){sbe(a,u),a=e,rX(a,u)}},dropEnabled:{get:function(){return i},set:function(e){e!==i&&(e?rX(a,u):sbe(a,u),i=e)}},dropError:{get:function(){return r}},clearOnDrop:{get:function(){return o},set:function(e){o=e}},flyToOnDrop:{get:function(){return n},set:function(e){n=e}},proxy:{get:function(){return l},set:function(e){l=e}},clampToGround:{get:function(){return s},set:function(e){s=e}}}),rX(a,u),e.destroy=VO(e,e.destroy,(function(){e.dropEnabled=!1})),e._handleDrop=u}function ub(e){e.stopPropagation(),e.preventDefault()}function sbe(e,t){let i=e;u(i)&&(i.removeEventListener("drop",t,!1),i.removeEventListener("dragenter",ub,!1),i.removeEventListener("dragover",ub,!1),i.removeEventListener("dragexit",ub,!1))}function rX(e,t){e.addEventListener("drop",t,!1),e.addEventListener("dragenter",ub,!1),e.addEventListener("dragover",ub,!1),e.addEventListener("dragexit",ub,!1)}function p0t(e,t,i,n){let r=e.scene;return function(o){let a=t.name;try{let s;if(/\.czml$/i.test(a))s=UU.load(JSON.parse(o.target.result),{sourceUri:a});else if(/\.geojson$/i.test(a)||/\.json$/i.test(a)||/\.topojson$/i.test(a))s=r4.load(JSON.parse(o.target.result),{sourceUri:a,clampToGround:n});else if(/\.(kml|kmz)$/i.test(a))s=I4.load(t,{sourceUri:a,proxy:i,camera:r.camera,canvas:r.canvas,clampToGround:n,screenOverlayContainer:e.container});else{if(!/\.gpx$/i.test(a))return void e.dropError.raiseEvent(e,a,`Unrecognized file: ${a}`);s=p4.load(t,{sourceUri:a,proxy:i})}u(s)&&e.dataSources.add(s).then((function(t){e.flyToOnDrop&&e.flyTo(t)})).catch((function(t){e.dropError.raiseEvent(e,a,t)}))}catch(t){e.dropError.raiseEvent(e,a,t)}}}function _0t(e,t){return function(i){e.dropError.raiseEvent(e,t.name,i.target.error)}}var abe=m0t;function g0t(e,t){t=y(t,y.EMPTY_OBJECT);let i=new i8({scene:e.scene,container:e.bottomContainer,lowFrameRateMessage:t.lowFrameRateMessage});Object.defineProperties(e,{performanceWatchdog:{get:function(){return i}}})}var cbe=g0t;function lbe(e){let t,i=e.split("\n");for(t=0;t<i.length&&!i[t].match(/\S/);t++);if(t===i.length)return"";let n="",r=/^\s*/,o=i[t].match(r)[0].length;for(let e=t;e<i.length;e++){let t=i[e];t.match(r)[0].length>=o&&(t=t.slice(o)),n+=`${t}\n`}return n}function Rf(e){this._scene=e,this._voxelPrimitive=void 0,this._customShaderCompilationRemoveCallback=void 0,this._definedProperties=[],this._getPrimitiveFunctions=[],this._modelMatrixReady=!1;let t=this;function i(i){let{name:n,initialValue:r}=i;t._definedProperties.push(n);let o=i.setPrimitiveFunction;!0===o&&(o=function(e){t._voxelPrimitive[n]=e});let a=i.getPrimitiveFunction;!0===a&&(a=function(){t[n]=t._voxelPrimitive[n]}),u(a)&&t._getPrimitiveFunctions.push(a);let s=Te.observable();return Te.defineProperty(t,n,{get:function(){return s()},set:function(i){"number"==typeof r&&"string"==typeof i&&(i=Number(i),isNaN(i)&&(i=r)),"boolean"==typeof r&&"number"==typeof i&&(i=1===i),s(i),u(o)&&u(t._voxelPrimitive)&&(o(i),e.requestRender())}}),t[n]=r,s}function n(e,i){return function(n){let r=t._voxelPrimitive[e].clone();r[i]=n,t._voxelPrimitive[e]=r}}i({name:"inspectorVisible",initialValue:!0}),i({name:"displayVisible",initialValue:!1}),i({name:"transformVisible",initialValue:!1}),i({name:"boundsVisible",initialValue:!1}),i({name:"clippingVisible",initialValue:!1}),i({name:"shaderVisible",initialValue:!1}),i({name:"shaderString",initialValue:"",getPrimitiveFunction:function(){let e=t._voxelPrimitive.customShader.fragmentShaderText;t.shaderString=lbe(e)}}),i({name:"shaderCompilationMessage",initialValue:""}),i({name:"shaderCompilationSuccess",initialValue:!0}),i({name:"depthTest",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"show",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"disableUpdate",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"debugDraw",initialValue:!1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"jitter",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"nearestSampling",initialValue:!0,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"screenSpaceError",initialValue:4,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"stepSize",initialValue:1,setPrimitiveFunction:!0,getPrimitiveFunction:!0}),i({name:"shapeIsBox",getPrimitiveFunction:function(){let e=t._voxelPrimitive.shape;t.shapeIsBox=e===ji.BOX}}),i({name:"shapeIsEllipsoid",getPrimitiveFunction:function(){let e=t._voxelPrimitive.shape;t.shapeIsEllipsoid=e===ji.ELLIPSOID}}),i({name:"shapeIsCylinder",getPrimitiveFunction:function(){let e=t._voxelPrimitive.shape;t.shapeIsCylinder=e===ji.CYLINDER}}),i({name:"boundsBoxMaxX",initialValue:0,setPrimitiveFunction:n("maxBounds","x"),getPrimitiveFunction:function(){t.boundsBoxMaxX=t._voxelPrimitive.maxBounds.x}}),i({name:"boundsBoxMinX",initialValue:0,setPrimitiveFunction:n("minBounds","x"),getPrimitiveFunction:function(){t.boundsBoxMinX=t._voxelPrimitive.minBounds.x}}),i({name:"boundsBoxMaxY",initialValue:0,setPrimitiveFunction:n("maxBounds","y"),getPrimitiveFunction:function(){t.boundsBoxMaxY=t._voxelPrimitive.maxBounds.y}}),i({name:"boundsBoxMinY",initialValue:0,setPrimitiveFunction:n("minBounds","y"),getPrimitiveFunction:function(){t.boundsBoxMinY=t._voxelPrimitive.minBounds.y}}),i({name:"boundsBoxMaxZ",initialValue:0,setPrimitiveFunction:n("maxBounds","z"),getPrimitiveFunction:function(){t.boundsBoxMaxZ=t._voxelPrimitive.maxBounds.z}}),i({name:"boundsBoxMinZ",initialValue:0,setPrimitiveFunction:n("minBounds","z"),getPrimitiveFunction:function(){t.boundsBoxMinZ=t._voxelPrimitive.minBounds.z}}),i({name:"boundsEllipsoidMaxLongitude",initialValue:0,setPrimitiveFunction:n("maxBounds","x"),getPrimitiveFunction:function(){t.boundsEllipsoidMaxLongitude=t._voxelPrimitive.maxBounds.x}}),i({name:"boundsEllipsoidMinLongitude",initialValue:0,setPrimitiveFunction:n("minBounds","x"),getPrimitiveFunction:function(){t.boundsEllipsoidMinLongitude=t._voxelPrimitive.minBounds.x}}),i({name:"boundsEllipsoidMaxLatitude",initialValue:0,setPrimitiveFunction:n("maxBounds","y"),getPrimitiveFunction:function(){t.boundsEllipsoidMaxLatitude=t._voxelPrimitive.maxBounds.y}}),i({name:"boundsEllipsoidMinLatitude",initialValue:0,setPrimitiveFunction:n("minBounds","y"),getPrimitiveFunction:function(){t.boundsEllipsoidMinLatitude=t._voxelPrimitive.minBounds.y}}),i({name:"boundsEllipsoidMaxHeight",initialValue:0,setPrimitiveFunction:n("maxBounds","z"),getPrimitiveFunction:function(){t.boundsEllipsoidMaxHeight=t._voxelPrimitive.maxBounds.z}}),i({name:"boundsEllipsoidMinHeight",initialValue:0,setPrimitiveFunction:n("minBounds","z"),getPrimitiveFunction:function(){t.boundsEllipsoidMinHeight=t._voxelPrimitive.minBounds.z}}),i({name:"boundsCylinderMaxRadius",initialValue:0,setPrimitiveFunction:n("maxBounds","x"),getPrimitiveFunction:function(){t.boundsCylinderMaxRadius=t._voxelPrimitive.maxBounds.x}}),i({name:"boundsCylinderMinRadius",initialValue:0,setPrimitiveFunction:n("minBounds","x"),getPrimitiveFunction:function(){t.boundsCylinderMinRadius=t._voxelPrimitive.minBounds.x}}),i({name:"boundsCylinderMaxHeight",initialValue:0,setPrimitiveFunction:n("maxBounds","y"),getPrimitiveFunction:function(){t.boundsCylinderMaxHeight=t._voxelPrimitive.maxBounds.y}}),i({name:"boundsCylinderMinHeight",initialValue:0,setPrimitiveFunction:n("minBounds","y"),getPrimitiveFunction:function(){t.boundsCylinderMinHeight=t._voxelPrimitive.minBounds.y}}),i({name:"boundsCylinderMaxAngle",initialValue:0,setPrimitiveFunction:n("maxBounds","z"),getPrimitiveFunction:function(){t.boundsCylinderMaxAngle=t._voxelPrimitive.maxBounds.z}}),i({name:"boundsCylinderMinAngle",initialValue:0,setPrimitiveFunction:n("minBounds","z"),getPrimitiveFunction:function(){t.boundsCylinderMinAngle=t._voxelPrimitive.minBounds.z}}),i({name:"clippingBoxMaxX",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingBoxMaxX=t._voxelPrimitive.maxClippingBounds.x}}),i({name:"clippingBoxMinX",initialValue:0,setPrimitiveFunction:n("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingBoxMinX=t._voxelPrimitive.minClippingBounds.x}}),i({name:"clippingBoxMaxY",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingBoxMaxY=t._voxelPrimitive.maxClippingBounds.y}}),i({name:"clippingBoxMinY",initialValue:0,setPrimitiveFunction:n("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingBoxMinY=t._voxelPrimitive.minClippingBounds.y}}),i({name:"clippingBoxMaxZ",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingBoxMaxZ=t._voxelPrimitive.maxClippingBounds.z}}),i({name:"clippingBoxMinZ",initialValue:0,setPrimitiveFunction:n("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingBoxMinZ=t._voxelPrimitive.minClippingBounds.z}}),i({name:"clippingEllipsoidMaxLongitude",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxLongitude=t._voxelPrimitive.maxClippingBounds.x}}),i({name:"clippingEllipsoidMinLongitude",initialValue:0,setPrimitiveFunction:n("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingEllipsoidMinLongitude=t._voxelPrimitive.minClippingBounds.x}}),i({name:"clippingEllipsoidMaxLatitude",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxLatitude=t._voxelPrimitive.maxClippingBounds.y}}),i({name:"clippingEllipsoidMinLatitude",initialValue:0,setPrimitiveFunction:n("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingEllipsoidMinLatitude=t._voxelPrimitive.minClippingBounds.y}}),i({name:"clippingEllipsoidMaxHeight",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingEllipsoidMaxHeight=t._voxelPrimitive.maxClippingBounds.z}}),i({name:"clippingEllipsoidMinHeight",initialValue:0,setPrimitiveFunction:n("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingEllipsoidMinHeight=t._voxelPrimitive.minClippingBounds.z}}),i({name:"clippingCylinderMaxRadius",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","x"),getPrimitiveFunction:function(){t.clippingCylinderMaxRadius=t._voxelPrimitive.maxClippingBounds.x}}),i({name:"clippingCylinderMinRadius",initialValue:0,setPrimitiveFunction:n("minClippingBounds","x"),getPrimitiveFunction:function(){t.clippingCylinderMinRadius=t._voxelPrimitive.minClippingBounds.x}}),i({name:"clippingCylinderMaxHeight",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","y"),getPrimitiveFunction:function(){t.clippingCylinderMaxHeight=t._voxelPrimitive.maxClippingBounds.y}}),i({name:"clippingCylinderMinHeight",initialValue:0,setPrimitiveFunction:n("minClippingBounds","y"),getPrimitiveFunction:function(){t.clippingCylinderMinHeight=t._voxelPrimitive.minClippingBounds.y}}),i({name:"clippingCylinderMaxAngle",initialValue:0,setPrimitiveFunction:n("maxClippingBounds","z"),getPrimitiveFunction:function(){t.clippingCylinderMaxAngle=t._voxelPrimitive.maxClippingBounds.z}}),i({name:"clippingCylinderMinAngle",initialValue:0,setPrimitiveFunction:n("minClippingBounds","z"),getPrimitiveFunction:function(){t.clippingCylinderMinAngle=t._voxelPrimitive.minClippingBounds.z}}),i({name:"translationX",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)},getPrimitiveFunction:function(){t.translationX=L.getTranslation(t._voxelPrimitive.modelMatrix,new h).x}}),i({name:"translationY",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)},getPrimitiveFunction:function(){t.translationY=L.getTranslation(t._voxelPrimitive.modelMatrix,new h).y}}),i({name:"translationZ",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)},getPrimitiveFunction:function(){t.translationZ=L.getTranslation(t._voxelPrimitive.modelMatrix,new h).z}}),i({name:"scaleX",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)},getPrimitiveFunction:function(){t.scaleX=L.getScale(t._voxelPrimitive.modelMatrix,new h).x}}),i({name:"scaleY",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)},getPrimitiveFunction:function(){t.scaleY=L.getScale(t._voxelPrimitive.modelMatrix,new h).y}}),i({name:"scaleZ",initialValue:1,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)},getPrimitiveFunction:function(){t.scaleZ=L.getScale(t._voxelPrimitive.modelMatrix,new h).z}}),i({name:"angleX",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)}}),i({name:"angleY",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)}}),i({name:"angleZ",initialValue:0,setPrimitiveFunction:function(){t._modelMatrixReady&&Tm(t)}})}var y0t=new h,x0t=new h,b0t=new oc,T0t=new $;function Tm(e){let t=h.fromElements(e.translationX,e.translationY,e.translationZ,y0t),i=h.fromElements(e.scaleX,e.scaleY,e.scaleZ,x0t),n=b0t;n.heading=e.angleX,n.pitch=e.angleY,n.roll=e.angleZ;let r=$.fromHeadingPitchRoll(n,T0t),o=$.multiplyByScale(r,i,r);e._voxelPrimitive.modelMatrix=L.fromRotationTranslation(o,t,e._voxelPrimitive.modelMatrix)}Object.defineProperties(Rf.prototype,{scene:{get:function(){return this._scene}},voxelPrimitive:{get:function(){return this._voxelPrimitive},set:function(e){if(u(this._customShaderCompilationRemoveCallback)&&this._customShaderCompilationRemoveCallback(),u(e)){this._voxelPrimitive=e;let t=this;t._customShaderCompilationRemoveCallback=t._voxelPrimitive.customShaderCompilationEvent.addEventListener((function(e){let i=t._voxelPrimitive.customShader.fragmentShaderText;t.shaderString=lbe(i),u(e)?(t.shaderCompilationMessage=e.message,t.shaderCompilationSuccess=!1):(t.shaderCompilationMessage="Shader compiled successfully!",t.shaderCompilationSuccess=!0)})),t._modelMatrixReady=!1;for(let e=0;e<t._getPrimitiveFunctions.length;e++)t._getPrimitiveFunctions[e]();t._modelMatrixReady=!0,Tm(t)}}}}),Rf.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible},Rf.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible},Rf.prototype.toggleTransform=function(){this.transformVisible=!this.transformVisible},Rf.prototype.toggleBounds=function(){this.boundsVisible=!this.boundsVisible},Rf.prototype.toggleClipping=function(){this.clippingVisible=!this.clippingVisible},Rf.prototype.toggleShader=function(){this.shaderVisible=!this.shaderVisible},Rf.prototype.compileShader=function(){u(this._voxelPrimitive)&&(this._voxelPrimitive.customShader=new PC({fragmentShaderText:this.shaderString,uniforms:this._voxelPrimitive.customShader.uniforms}))},Rf.prototype.shaderEditorKeyPress=function(e,t){if(9===t.keyCode){t.preventDefault();let e,i=t.target,n=i.selectionStart,r=i.selectionEnd,o=r,a=i.value.slice(n,r).split("\n"),s=a.length;if(t.shiftKey)for(e=0;e<s;++e)" "===a[e][0]&&(" "===a[e][1]?(a[e]=a[e].substr(2),o-=2):(a[e]=a[e].substr(1),o-=1));else for(e=0;e<s;++e)a[e]=`  ${a[e]}`,o+=2;let l=a.join("\n");i.value=i.value.slice(0,n)+l+i.value.slice(r),i.selectionStart=n!==r?n:o,i.selectionEnd=o}else t.ctrlKey&&(10===t.keyCode||13===t.keyCode)&&this.compileShader();return!0},Rf.prototype.isDestroyed=function(){return!1},Rf.prototype.destroy=function(){let e=this;return this._definedProperties.forEach((function(t){Te.getObservable(e,t).dispose()})),le(this)};var N8=Rf;function F8(e,t){e=In(e);let i=document.createElement("div"),n=new N8(t);this._viewModel=n,this._container=e,this._element=i;let r=document.createElement("div");r.textContent="Voxel Inspector",r.className="cesium-cesiumInspector-button",r.setAttribute("data-bind","click: toggleInspector"),i.appendChild(r),i.className="cesium-cesiumInspector cesium-VoxelInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(i);let o=document.createElement("div");o.className="cesium-cesiumInspector-dropDown",i.appendChild(o);let a=Ja.createSection,s=Ja.createCheckbox,l=Ja.createRangeInput,u=Ja.createButton,c=a(o,"Display","displayVisible","toggleDisplay"),d=a(o,"Transform","transformVisible","toggleTransform"),p=a(o,"Bounds","boundsVisible","toggleBounds"),f=a(o,"Clipping","clippingVisible","toggleClipping"),m=a(o,"Shader","shaderVisible","toggleShader");c.appendChild(s("Depth Test","depthTest")),c.appendChild(s("Show","show")),c.appendChild(s("Disable Update","disableUpdate")),c.appendChild(s("Debug Draw","debugDraw")),c.appendChild(s("Jitter","jitter")),c.appendChild(s("Nearest Sampling","nearestSampling")),c.appendChild(l("Screen Space Error","screenSpaceError",0,128)),c.appendChild(l("Step Size","stepSize",0,2));let _=10,g=P.PI;d.appendChild(l("Translation X","translationX",-_,10)),d.appendChild(l("Translation Y","translationY",-_,10)),d.appendChild(l("Translation Z","translationZ",-_,10)),d.appendChild(l("Scale X","scaleX",0,10)),d.appendChild(l("Scale Y","scaleY",0,10)),d.appendChild(l("Scale Z","scaleZ",0,10)),d.appendChild(l("Heading","angleX",-g,+g)),d.appendChild(l("Pitch","angleY",-g,+g)),d.appendChild(l("Roll","angleZ",-g,+g));let y=ji.getMinBounds(ji.BOX),v=ji.getMaxBounds(ji.BOX),b=h.fromElements(ji.getMinBounds(ji.ELLIPSOID).x,ji.getMinBounds(ji.ELLIPSOID).y,-ie.WGS84.maximumRadius,new h),A=h.fromElements(ji.getMaxBounds(ji.ELLIPSOID).x,ji.getMaxBounds(ji.ELLIPSOID).y,1e7,new h),T=ji.getMinBounds(ji.CYLINDER),E=ji.getMaxBounds(ji.CYLINDER);VE("Max X","Min X","Max Y","Min Y","Max Z","Min Z","boundsBoxMaxX","boundsBoxMinX","boundsBoxMaxY","boundsBoxMinY","boundsBoxMaxZ","boundsBoxMinZ",y,v,"shapeIsBox",p),VE("Max Longitude","Min Longitude","Max Latitude","Min Latitude","Max Height","Min Height","boundsEllipsoidMaxLongitude","boundsEllipsoidMinLongitude","boundsEllipsoidMaxLatitude","boundsEllipsoidMinLatitude","boundsEllipsoidMaxHeight","boundsEllipsoidMinHeight",b,A,"shapeIsEllipsoid",p),VE("Max Radius","Min Radius","Max Height","Min Height","Max Angle","Min Angle","boundsCylinderMaxRadius","boundsCylinderMinRadius","boundsCylinderMaxHeight","boundsCylinderMinHeight","boundsCylinderMaxAngle","boundsCylinderMinAngle",T,E,"shapeIsCylinder",p),VE("Max X","Min X","Max Y","Min Y","Max Z","Min Z","clippingBoxMaxX","clippingBoxMinX","clippingBoxMaxY","clippingBoxMinY","clippingBoxMaxZ","clippingBoxMinZ",y,v,"shapeIsBox",f),VE("Max Longitude","Min Longitude","Max Latitude","Min Latitude","Max Height","Min Height","clippingEllipsoidMaxLongitude","clippingEllipsoidMinLongitude","clippingEllipsoidMaxLatitude","clippingEllipsoidMinLatitude","clippingEllipsoidMaxHeight","clippingEllipsoidMinHeight",b,A,"shapeIsEllipsoid",f),VE("Max Radius","Min Radius","Max Height","Min Height","Max Angle","Min Angle","clippingCylinderMaxRadius","clippingCylinderMinRadius","clippingCylinderMaxHeight","clippingCylinderMinHeight","clippingCylinderMaxAngle","clippingCylinderMinAngle",T,E,"shapeIsCylinder",f);let C=document.createElement("div");m.appendChild(C);let x=document.createElement("textarea");x.setAttribute("data-bind","textInput: shaderString, event: { keydown: shaderEditorKeyPress }"),C.className="cesium-cesiumInspector-styleEditor",C.appendChild(x);let S=u("Compile (Ctrl+Enter)","compileShader");C.appendChild(S);let w=document.createElement("label");w.style.display="block",w.setAttribute("data-bind","text: shaderCompilationMessage, style: {color: shaderCompilationSuccess ? 'green' : 'red'}"),C.appendChild(w),Te.applyBindings(n,i)}function VE(e,t,i,n,r,o,a,s,l,u,c,h,d,p,f,m){let _=Ja.createRangeInput,g=d,y=p,v=m.appendChild(document.createElement("div"));v.setAttribute("data-bind",`if: ${f}`),v.appendChild(_(e,a,g.x,y.x)),v.appendChild(_(t,s,g.x,y.x)),v.appendChild(_(i,l,g.y,y.y)),v.appendChild(_(n,u,g.y,y.y)),v.appendChild(_(r,c,g.z,y.z)),v.appendChild(_(o,h,g.z,y.z))}Object.defineProperties(F8.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),F8.prototype.isDestroyed=function(){return!1},F8.prototype.destroy=function(){return Te.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),le(this)};var B8=F8;function A0t(e){let t=document.createElement("div");t.className="cesium-viewer-voxelInspectorContainer",e.container.appendChild(t);let i=new B8(t,e.scene);Object.defineProperties(e,{voxelInspector:{get:function(){return i}}})}var ube=A0t;globalThis.CESIUM_VERSION="1.111";var jXi="1.111"},1580:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1580,e.exports=t},9282:(e,t,i)=>{"use strict";var n=i(4155),r=i(5108);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(r=n.key,a=void 0,a=function(e,t){if("object"!==o(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(r,"string"),"symbol"===o(a)?a:String(a)),n)}var r,a}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var l,u,c=i(2136).codes,h=c.ERR_AMBIGUOUS_ARGUMENT,d=c.ERR_INVALID_ARG_TYPE,p=c.ERR_INVALID_ARG_VALUE,f=c.ERR_INVALID_RETURN_VALUE,m=c.ERR_MISSING_ARGS,_=i(5961),g=i(9539).inspect,y=i(9539).types,v=y.isPromise,b=y.isRegExp,A=i(8162)(),T=i(5624)(),E=i(1924)("RegExp.prototype.test");new Map;function C(){var e=i(9158);l=e.isDeepEqual,u=e.isDeepStrictEqual}var x=!1,S=e.exports=D,w={};function I(e){if(e.message instanceof Error)throw e.message;throw new _(e)}function P(e,t,i,n){if(!i){var r=!1;if(0===t)r=!0,n="No value argument passed to `assert.ok()`";else if(n instanceof Error)throw n;var o=new _({actual:i,expected:!0,message:n,operator:"==",stackStartFn:e});throw o.generatedMessage=r,o}}function D(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];P.apply(void 0,[D,t.length].concat(t))}S.fail=function e(t,i,o,a,s){var l,u=arguments.length;if(0===u)l="Failed";else if(1===u)o=t,t=void 0;else{if(!1===x)x=!0,(n.emitWarning?n.emitWarning:r.warn.bind(r))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094");2===u&&(a="!=")}if(o instanceof Error)throw o;var c={actual:t,expected:i,operator:void 0===a?"fail":a,stackStartFn:s||e};void 0!==o&&(c.message=o);var h=new _(c);throw l&&(h.message=l,h.generatedMessage=!0),h},S.AssertionError=_,S.ok=D,S.equal=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");t!=i&&I({actual:t,expected:i,message:n,operator:"==",stackStartFn:e})},S.notEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");t==i&&I({actual:t,expected:i,message:n,operator:"!=",stackStartFn:e})},S.deepEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");void 0===l&&C(),l(t,i)||I({actual:t,expected:i,message:n,operator:"deepEqual",stackStartFn:e})},S.notDeepEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");void 0===l&&C(),l(t,i)&&I({actual:t,expected:i,message:n,operator:"notDeepEqual",stackStartFn:e})},S.deepStrictEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");void 0===l&&C(),u(t,i)||I({actual:t,expected:i,message:n,operator:"deepStrictEqual",stackStartFn:e})},S.notDeepStrictEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");void 0===l&&C();u(t,i)&&I({actual:t,expected:i,message:n,operator:"notDeepStrictEqual",stackStartFn:e})},S.strictEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");T(t,i)||I({actual:t,expected:i,message:n,operator:"strictEqual",stackStartFn:e})},S.notStrictEqual=function e(t,i,n){if(arguments.length<2)throw new m("actual","expected");T(t,i)&&I({actual:t,expected:i,message:n,operator:"notStrictEqual",stackStartFn:e})};var O=s((function e(t,i,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i.forEach((function(e){e in t&&(void 0!==n&&"string"==typeof n[e]&&b(t[e])&&E(t[e],n[e])?r[e]=n[e]:r[e]=t[e])}))}));function L(e,t,i,n){if("function"!=typeof t){if(b(t))return E(t,e);if(2===arguments.length)throw new d("expected",["Function","RegExp"],t);if("object"!==o(e)||null===e){var r=new _({actual:e,expected:t,message:i,operator:"deepStrictEqual",stackStartFn:n});throw r.operator=n.name,r}var a=Object.keys(t);if(t instanceof Error)a.push("name","message");else if(0===a.length)throw new p("error",t,"may not be an empty object");return void 0===l&&C(),a.forEach((function(r){"string"==typeof e[r]&&b(t[r])&&E(t[r],e[r])||function(e,t,i,n,r,o){if(!(i in e)||!u(e[i],t[i])){if(!n){var a=new O(e,r),s=new O(t,r,e),l=new _({actual:a,expected:s,operator:"deepStrictEqual",stackStartFn:o});throw l.actual=e,l.expected=t,l.operator=o.name,l}I({actual:e,expected:t,message:n,operator:o.name,stackStartFn:o})}}(e,t,r,i,a,n)})),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function R(e){if("function"!=typeof e)throw new d("fn","Function",e);try{e()}catch(e){return e}return w}function N(e){return v(e)||null!==e&&"object"===o(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function M(e){return Promise.resolve().then((function(){var t;if("function"==typeof e){if(!N(t=e()))throw new f("instance of Promise","promiseFn",t)}else{if(!N(e))throw new d("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((function(){return t})).then((function(){return w})).catch((function(e){return e}))}))}function F(e,t,i,n){if("string"==typeof i){if(4===arguments.length)throw new d("error",["Object","Error","Function","RegExp"],i);if("object"===o(t)&&null!==t){if(t.message===i)throw new h("error/message",'The error message "'.concat(t.message,'" is identical to the message.'))}else if(t===i)throw new h("error/message",'The error "'.concat(t,'" is identical to the message.'));n=i,i=void 0}else if(null!=i&&"object"!==o(i)&&"function"!=typeof i)throw new d("error",["Object","Error","Function","RegExp"],i);if(t===w){var r="";i&&i.name&&(r+=" (".concat(i.name,")")),r+=n?": ".concat(n):".";var a="rejects"===e.name?"rejection":"exception";I({actual:void 0,expected:i,operator:e.name,message:"Missing expected ".concat(a).concat(r),stackStartFn:e})}if(i&&!L(t,i,n,e))throw t}function B(e,t,i,n){if(t!==w){if("string"==typeof i&&(n=i,i=void 0),!i||L(t,i)){var r=n?": ".concat(n):".",o="doesNotReject"===e.name?"rejection":"exception";I({actual:t,expected:i,operator:e.name,message:"Got unwanted ".concat(o).concat(r,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function z(e,t,i,n,r){if(!b(t))throw new d("regexp","RegExp",t);var a="match"===r;if("string"!=typeof e||E(t,e)!==a){if(i instanceof Error)throw i;var s=!i;i=i||("string"!=typeof e?'The "string" argument must be of type string. Received type '+"".concat(o(e)," (").concat(g(e),")"):(a?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(g(t),". Input:\n\n").concat(g(e),"\n"));var l=new _({actual:e,expected:t,message:i,operator:r,stackStartFn:n});throw l.generatedMessage=s,l}}function U(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];P.apply(void 0,[U,t.length].concat(t))}S.throws=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];F.apply(void 0,[e,R(t)].concat(n))},S.rejects=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return M(t).then((function(t){return F.apply(void 0,[e,t].concat(n))}))},S.doesNotThrow=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];B.apply(void 0,[e,R(t)].concat(n))},S.doesNotReject=function e(t){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return M(t).then((function(t){return B.apply(void 0,[e,t].concat(n))}))},S.ifError=function e(t){if(null!=t){var i="ifError got unwanted exception: ";"object"===o(t)&&"string"==typeof t.message?0===t.message.length&&t.constructor?i+=t.constructor.name:i+=t.message:i+=g(t);var n=new _({actual:t,expected:null,operator:"ifError",message:i,stackStartFn:e}),r=t.stack;if("string"==typeof r){var a=r.split("\n");a.shift();for(var s=n.stack.split("\n"),l=0;l<a.length;l++){var u=s.indexOf(a[l]);if(-1!==u){s=s.slice(0,u);break}}n.stack="".concat(s.join("\n"),"\n").concat(a.join("\n"))}throw n}},S.match=function e(t,i,n){z(t,i,n,e,"match")},S.doesNotMatch=function e(t,i,n){z(t,i,n,e,"doesNotMatch")},S.strict=A(U,S,{equal:S.strictEqual,deepEqual:S.deepStrictEqual,notEqual:S.notStrictEqual,notDeepEqual:S.notDeepStrictEqual}),S.strict.strict=S.strict},5961:(e,t,i)=>{"use strict";var n=i(4155);function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function a(e,t,i){return(t=l(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_(t)?t:String(t)}function u(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){var t="function"==typeof Map?new Map:void 0;return h=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return d(e,arguments,m(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)},h(e)}function d(e,t,i){return d=p()?Reflect.construct.bind():function(e,t,i){var n=[null];n.push.apply(n,t);var r=new(Function.bind.apply(e,n));return i&&f(r,i.prototype),r},d.apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}var g=i(9539).inspect,y=i(2136).codes.ERR_INVALID_ARG_TYPE;function v(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}var b="",A="",T="",E="",C={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function x(e){var t=Object.keys(e),i=Object.create(Object.getPrototypeOf(e));return t.forEach((function(t){i[t]=e[t]})),Object.defineProperty(i,"message",{value:e.message}),i}function S(e){return g(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function w(e,t,i){var r="",o="",a=0,s="",l=!1,u=S(e),c=u.split("\n"),h=S(t).split("\n"),d=0,p="";if("strictEqual"===i&&"object"===_(e)&&"object"===_(t)&&null!==e&&null!==t&&(i="strictEqualObject"),1===c.length&&1===h.length&&c[0]!==h[0]){var f=c[0].length+h[0].length;if(f<=10){if(!("object"===_(e)&&null!==e||"object"===_(t)&&null!==t||0===e&&0===t))return"".concat(C[i],"\n\n")+"".concat(c[0]," !== ").concat(h[0],"\n")}else if("strictEqualObject"!==i){if(f<(n.stderr&&n.stderr.isTTY?n.stderr.columns:80)){for(;c[0][d]===h[0][d];)d++;d>2&&(p="\n  ".concat(function(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var i=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,i-e.length)}(" ",d),"^"),d=0)}}}for(var m=c[c.length-1],g=h[h.length-1];m===g&&(d++<2?s="\n  ".concat(m).concat(s):r=m,c.pop(),h.pop(),0!==c.length&&0!==h.length);)m=c[c.length-1],g=h[h.length-1];var y=Math.max(c.length,h.length);if(0===y){var x=u.split("\n");if(x.length>30)for(x[26]="".concat(b,"...").concat(E);x.length>27;)x.pop();return"".concat(C.notIdentical,"\n\n").concat(x.join("\n"),"\n")}d>3&&(s="\n".concat(b,"...").concat(E).concat(s),l=!0),""!==r&&(s="\n  ".concat(r).concat(s),r="");var w=0,I=C[i]+"\n".concat(A,"+ actual").concat(E," ").concat(T,"- expected").concat(E),P=" ".concat(b,"...").concat(E," Lines skipped");for(d=0;d<y;d++){var D=d-a;if(c.length<d+1)D>1&&d>2&&(D>4?(o+="\n".concat(b,"...").concat(E),l=!0):D>3&&(o+="\n  ".concat(h[d-2]),w++),o+="\n  ".concat(h[d-1]),w++),a=d,r+="\n".concat(T,"-").concat(E," ").concat(h[d]),w++;else if(h.length<d+1)D>1&&d>2&&(D>4?(o+="\n".concat(b,"...").concat(E),l=!0):D>3&&(o+="\n  ".concat(c[d-2]),w++),o+="\n  ".concat(c[d-1]),w++),a=d,o+="\n".concat(A,"+").concat(E," ").concat(c[d]),w++;else{var O=h[d],L=c[d],R=L!==O&&(!v(L,",")||L.slice(0,-1)!==O);R&&v(O,",")&&O.slice(0,-1)===L&&(R=!1,L+=","),R?(D>1&&d>2&&(D>4?(o+="\n".concat(b,"...").concat(E),l=!0):D>3&&(o+="\n  ".concat(c[d-2]),w++),o+="\n  ".concat(c[d-1]),w++),a=d,o+="\n".concat(A,"+").concat(E," ").concat(L),r+="\n".concat(T,"-").concat(E," ").concat(O),w+=2):(o+=r,r="",1!==D&&0!==d||(o+="\n  ".concat(L),w++))}if(w>20&&d<y-2)return"".concat(I).concat(P,"\n").concat(o,"\n").concat(b,"...").concat(E).concat(r,"\n")+"".concat(b,"...").concat(E)}return"".concat(I).concat(l?P:"","\n").concat(o).concat(r).concat(s).concat(p)}var I=function(e,t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(v,e);var i,r,a,l,h,d=(i=v,r=p(),function(){var e,t=m(i);if(r){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function v(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),"object"!==_(e)||null===e)throw new y("options","Object",e);var i=e.message,r=e.operator,o=e.stackStartFn,a=e.actual,s=e.expected,l=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=i)t=d.call(this,String(i));else if(n.stderr&&n.stderr.isTTY&&(n.stderr&&n.stderr.getColorDepth&&1!==n.stderr.getColorDepth()?(b="[34m",A="[32m",E="[39m",T="[31m"):(b="",A="",E="",T="")),"object"===_(a)&&null!==a&&"object"===_(s)&&null!==s&&"stack"in a&&a instanceof Error&&"stack"in s&&s instanceof Error&&(a=x(a),s=x(s)),"deepStrictEqual"===r||"strictEqual"===r)t=d.call(this,w(a,s,r));else if("notDeepStrictEqual"===r||"notStrictEqual"===r){var h=C[r],p=S(a).split("\n");if("notStrictEqual"===r&&"object"===_(a)&&null!==a&&(h=C.notStrictEqualObject),p.length>30)for(p[26]="".concat(b,"...").concat(E);p.length>27;)p.pop();t=1===p.length?d.call(this,"".concat(h," ").concat(p[0])):d.call(this,"".concat(h,"\n\n").concat(p.join("\n"),"\n"))}else{var f=S(a),m="",g=C[r];"notDeepEqual"===r||"notEqual"===r?(f="".concat(C[r],"\n\n").concat(f)).length>1024&&(f="".concat(f.slice(0,1021),"...")):(m="".concat(S(s)),f.length>512&&(f="".concat(f.slice(0,509),"...")),m.length>512&&(m="".concat(m.slice(0,509),"...")),"deepEqual"===r||"equal"===r?f="".concat(g,"\n\n").concat(f,"\n\nshould equal\n\n"):m=" ".concat(r," ").concat(m)),t=d.call(this,"".concat(f).concat(m))}return Error.stackTraceLimit=l,t.generatedMessage=!i,Object.defineProperty(c(t),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),t.code="ERR_ASSERTION",t.actual=a,t.expected=s,t.operator=r,Error.captureStackTrace&&Error.captureStackTrace(c(t),o),t.stack,t.name="AssertionError",u(t)}return a=v,(l=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:t,value:function(e,t){return g(this,o(o({},t),{},{customInspect:!1,depth:0}))}}])&&s(a.prototype,l),h&&s(a,h),Object.defineProperty(a,"prototype",{writable:!1}),v}(h(Error),g.custom);e.exports=I},2136:(e,t,i)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,a=void 0,a=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===n(a)?a:String(a)),r)}var o,a}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,r=s(e);if(t){var o=s(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,i)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var l,u,c={};function h(e,t,i){i||(i=Error);var n=function(i){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(c,i);var n,s,l,u=a(c);function c(i,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),o=u.call(this,function(e,i,n){return"string"==typeof t?t:t(e,i,n)}(i,n,r)),o.code=e,o}return n=c,s&&r(n.prototype,s),l&&r(n,l),Object.defineProperty(n,"prototype",{writable:!1}),n}(i);c[e]=n}function d(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return String(e)})),i>2?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}h("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),h("ERR_INVALID_ARG_TYPE",(function(e,t,r){var o,a,s,u;if(void 0===l&&(l=i(9282)),l("string"==typeof e,"'name' must be a string"),"string"==typeof t&&(a="not ",t.substr(!s||s<0?0:+s,a.length)===a)?(o="must not be",t=t.replace(/^not /,"")):o="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))u="The ".concat(e," ").concat(o," ").concat(d(t,"type"));else{var c=function(e,t,i){return"number"!=typeof i&&(i=0),!(i+t.length>e.length)&&-1!==e.indexOf(t,i)}(e,".")?"property":"argument";u='The "'.concat(e,'" ').concat(c," ").concat(o," ").concat(d(t,"type"))}return u+=". Received type ".concat(n(r))}),TypeError),h("ERR_INVALID_ARG_VALUE",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===u&&(u=i(9539));var r=u.inspect(t);return r.length>128&&(r="".concat(r.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(n,". Received ").concat(r)}),TypeError,RangeError),h("ERR_INVALID_RETURN_VALUE",(function(e,t,i){var r;return r=i&&i.constructor&&i.constructor.name?"instance of ".concat(i.constructor.name):"type ".concat(n(i)),"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(r,".")}),TypeError),h("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];void 0===l&&(l=i(9282)),l(t.length>0,"At least one arg needs to be specified");var r="The ",o=t.length;switch(t=t.map((function(e){return'"'.concat(e,'"')})),o){case 1:r+="".concat(t[0]," argument");break;case 2:r+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:r+=t.slice(0,o-1).join(", "),r+=", and ".concat(t[o-1]," arguments")}return"".concat(r," must be specified")}),TypeError),e.exports.codes=c},9158:(e,t,i)=>{"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,o,a,s=[],l=!0,u=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,r=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var a=void 0!==/a/g.flags,s=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},l=function(e){var t=[];return e.forEach((function(e,i){return t.push([i,e])})),t},u=Object.is?Object.is:i(609),c=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},h=Number.isNaN?Number.isNaN:i(360);function d(e){return e.call.bind(e)}var p=d(Object.prototype.hasOwnProperty),f=d(Object.prototype.propertyIsEnumerable),m=d(Object.prototype.toString),_=i(9539).types,g=_.isAnyArrayBuffer,y=_.isArrayBufferView,v=_.isDate,b=_.isMap,A=_.isRegExp,T=_.isSet,E=_.isNativeError,C=_.isBoxedPrimitive,x=_.isNumberObject,S=_.isStringObject,w=_.isBooleanObject,I=_.isBigIntObject,P=_.isSymbolObject,D=_.isFloat32Array,O=_.isFloat64Array;function L(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var i=e.charCodeAt(t);if(i<48||i>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function R(e){return Object.keys(e).filter(L).concat(c(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function N(e,t){if(e===t)return 0;for(var i=e.length,n=t.length,r=0,o=Math.min(i,n);r<o;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0}var M=0,F=1,B=2,z=3;function U(e,t,i,n){if(e===t)return 0!==e||(!i||u(e,t));if(i){if("object"!==o(e))return"number"==typeof e&&h(e)&&h(t);if("object"!==o(t)||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==o(e))return(null===t||"object"!==o(t))&&e==t;if(null===t||"object"!==o(t))return!1}var r,s,l,c,d=m(e);if(d!==m(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var p=R(e),f=R(t);return p.length===f.length&&V(e,t,i,n,F,p)}if("[object Object]"===d&&(!b(e)&&b(t)||!T(e)&&T(t)))return!1;if(v(e)){if(!v(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(A(e)){if(!A(t)||(l=e,c=t,!(a?l.source===c.source&&l.flags===c.flags:RegExp.prototype.toString.call(l)===RegExp.prototype.toString.call(c))))return!1}else if(E(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(y(e)){if(i||!D(e)&&!O(e)){if(!function(e,t){return e.byteLength===t.byteLength&&0===N(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var i=0;i<e.byteLength;i++)if(e[i]!==t[i])return!1;return!0}(e,t))return!1;var _=R(e),L=R(t);return _.length===L.length&&V(e,t,i,n,M,_)}if(T(e))return!(!T(t)||e.size!==t.size)&&V(e,t,i,n,B);if(b(e))return!(!b(t)||e.size!==t.size)&&V(e,t,i,n,z);if(g(e)){if(s=t,(r=e).byteLength!==s.byteLength||0!==N(new Uint8Array(r),new Uint8Array(s)))return!1}else if(C(e)&&!function(e,t){return x(e)?x(t)&&u(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):S(e)?S(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):w(e)?w(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):I(e)?I(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):P(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}(e,t))return!1}return V(e,t,i,n,M)}function k(e,t){return t.filter((function(t){return f(e,t)}))}function V(e,t,i,r,a,u){if(5===arguments.length){u=Object.keys(e);var h=Object.keys(t);if(u.length!==h.length)return!1}for(var d=0;d<u.length;d++)if(!p(t,u[d]))return!1;if(i&&5===arguments.length){var m=c(e);if(0!==m.length){var _=0;for(d=0;d<m.length;d++){var g=m[d];if(f(e,g)){if(!f(t,g))return!1;u.push(g),_++}else if(f(t,g))return!1}var y=c(t);if(m.length!==y.length&&k(t,y).length!==_)return!1}else{var v=c(t);if(0!==v.length&&0!==k(t,v).length)return!1}}if(0===u.length&&(a===M||a===F&&0===e.length||0===e.size))return!0;if(void 0===r)r={val1:new Map,val2:new Map,position:0};else{var b=r.val1.get(e);if(void 0!==b){var A=r.val2.get(t);if(void 0!==A)return b===A}r.position++}r.val1.set(e,r.position),r.val2.set(t,r.position);var T=function(e,t,i,r,a,u){var c=0;if(u===B){if(!function(e,t,i,n){for(var r=null,a=s(e),l=0;l<a.length;l++){var u=a[l];if("object"===o(u)&&null!==u)null===r&&(r=new Set),r.add(u);else if(!t.has(u)){if(i)return!1;if(!j(e,t,u))return!1;null===r&&(r=new Set),r.add(u)}}if(null!==r){for(var c=s(t),h=0;h<c.length;h++){var d=c[h];if("object"===o(d)&&null!==d){if(!H(r,d,i,n))return!1}else if(!i&&!e.has(d)&&!H(r,d,i,n))return!1}return 0===r.size}return!0}(e,t,i,a))return!1}else if(u===z){if(!function(e,t,i,r){for(var a=null,s=l(e),u=0;u<s.length;u++){var c=n(s[u],2),h=c[0],d=c[1];if("object"===o(h)&&null!==h)null===a&&(a=new Set),a.add(h);else{var p=t.get(h);if(void 0===p&&!t.has(h)||!U(d,p,i,r)){if(i)return!1;if(!W(e,t,h,d,r))return!1;null===a&&(a=new Set),a.add(h)}}}if(null!==a){for(var f=l(t),m=0;m<f.length;m++){var _=n(f[m],2),g=_[0],y=_[1];if("object"===o(g)&&null!==g){if(!q(a,e,g,y,i,r))return!1}else if(!(i||e.has(g)&&U(e.get(g),y,!1,r)||q(a,e,g,y,!1,r)))return!1}return 0===a.size}return!0}(e,t,i,a))return!1}else if(u===F)for(;c<e.length;c++){if(!p(e,c)){if(p(t,c))return!1;for(var h=Object.keys(e);c<h.length;c++){var d=h[c];if(!p(t,d)||!U(e[d],t[d],i,a))return!1}return h.length===Object.keys(t).length}if(!p(t,c)||!U(e[c],t[c],i,a))return!1}for(c=0;c<r.length;c++){var f=r[c];if(!U(e[f],t[f],i,a))return!1}return!0}(e,t,i,u,r,a);return r.val1.delete(e),r.val2.delete(t),T}function H(e,t,i,n){for(var r=s(e),o=0;o<r.length;o++){var a=r[o];if(U(t,a,i,n))return e.delete(a),!0}return!1}function G(e){switch(o(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(h(e))return!1}return!0}function j(e,t,i){var n=G(i);return null!=n?n:t.has(n)&&!e.has(n)}function W(e,t,i,n,r){var o=G(i);if(null!=o)return o;var a=t.get(o);return!(void 0===a&&!t.has(o)||!U(n,a,!1,r))&&(!e.has(o)&&U(n,a,!1,r))}function q(e,t,i,n,r,o){for(var a=s(e),l=0;l<a.length;l++){var u=a[l];if(U(i,u,r,o)&&U(n,t.get(u),r,o))return e.delete(u),!0}return!1}e.exports={isDeepEqual:function(e,t){return U(e,t,false)},isDeepStrictEqual:function(e,t){return U(e,t,true)}}},6314:(e,t,i)=>{"use strict";var n=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],r="undefined"==typeof globalThis?i.g:globalThis;e.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof r[n[t]]&&(e[e.length]=n[t]);return e}},9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,o=s(e),a=o[0],l=o[1],u=new r(function(e,t,i){return 3*(t+i)/4-i}(0,a,l)),c=0,h=l>0?a-4:a;for(i=0;i<h;i+=4)t=n[e.charCodeAt(i)]<<18|n[e.charCodeAt(i+1)]<<12|n[e.charCodeAt(i+2)]<<6|n[e.charCodeAt(i+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===l&&(t=n[e.charCodeAt(i)]<<2|n[e.charCodeAt(i+1)]>>4,u[c++]=255&t);1===l&&(t=n[e.charCodeAt(i)]<<10|n[e.charCodeAt(i+1)]<<4|n[e.charCodeAt(i+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],a=16383,s=0,u=n-r;s<u;s+=a)o.push(l(e,s,s+a>u?u:s+a));1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)i[a]=o[a],n[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function l(e,t,n){for(var r,o,a=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},8764:(e,t,i)=>{"use strict";var n=i(5108);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const r=i(9742),o=i(645),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50;const s=2147483647;function l(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,i){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return c(e,t,i)}function c(e,t,i){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const i=0|_(e,t);let n=l(i);const r=n.write(e,t);r!==i&&(n=n.slice(0,r));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return p(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return f(e,t,i);if("undefined"!=typeof SharedArrayBuffer&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return f(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,i);const r=function(e){if(u.isBuffer(e)){const t=0|m(e.length),i=l(t);return 0===i.length||e.copy(i,0,0,t),i}if(void 0!==e.length)return"number"!=typeof e.length||J(e.length)?l(0):p(e);if("Buffer"===e.type&&Array.isArray(e.data))return p(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),l(e<0?0:0|m(e))}function p(e){const t=e.length<0?0:0|m(e.length),i=l(t);for(let n=0;n<t;n+=1)i[n]=255&e[n];return i}function f(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i),Object.setPrototypeOf(n,u.prototype),n}function m(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function _(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const i=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;let r=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return X(e).length;default:if(r)return n?-1:Y(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,i){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,i);case"utf8":case"utf-8":return w(this,t,i);case"ascii":return P(this,t,i);case"latin1":case"binary":return D(this,t,i);case"base64":return S(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,i){const n=e[t];e[t]=e[i],e[i]=n}function v(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),J(i=+i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:b(e,t,i,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):b(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,i,n,r){let o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,i/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){let n=-1;for(o=i;o<s;o++)if(u(e,o)===u(t,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===l)return n*a}else-1!==n&&(o-=o-n),n=-1}else for(i+l>s&&(i=s-l),o=i;o>=0;o--){let i=!0;for(let n=0;n<l;n++)if(u(e,o+n)!==u(t,n)){i=!1;break}if(i)return o}return-1}function A(e,t,i,n){i=Number(i)||0;const r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;const o=t.length;let a;for(n>o/2&&(n=o/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(J(n))return a;e[i+a]=n}return a}function T(e,t,i,n){return $(Y(t,e.length-i),e,i,n)}function E(e,t,i,n){return $(function(e){const t=[];for(let i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function C(e,t,i,n){return $(X(t),e,i,n)}function x(e,t,i,n){return $(function(e,t){let i,n,r;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)i=e.charCodeAt(a),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(t,e.length-i),e,i,n)}function S(e,t,i){return 0===t&&i===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,i))}function w(e,t,i){i=Math.min(e.length,i);const n=[];let r=t;for(;r<i;){const t=e[r];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(r+a<=i){let i,n,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:i=e[r+1],128==(192&i)&&(l=(31&t)<<6|63&i,l>127&&(o=l));break;case 3:i=e[r+1],n=e[r+2],128==(192&i)&&128==(192&n)&&(l=(15&t)<<12|(63&i)<<6|63&n,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:i=e[r+1],n=e[r+2],s=e[r+3],128==(192&i)&&128==(192&n)&&128==(192&s)&&(l=(15&t)<<18|(63&i)<<12|(63&n)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),r+=a}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=I));return i}(n)}t.kMaxLength=s,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||void 0===n||"function"!=typeof n.error||n.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,i){return c(e,t,i)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,i){return function(e,t,i){return h(e),e<=0?l(e):void 0!==t?"string"==typeof i?l(e).fill(t,i):l(e).fill(t):l(e)}(e,t,i)},u.allocUnsafe=function(e){return d(e)},u.allocUnsafeSlow=function(e){return d(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(K(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let r=0,o=Math.min(i,n);r<o;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const n=u.allocUnsafe(t);let r=0;for(i=0;i<e.length;++i){let t=e[i];if(K(t,Uint8Array))r+t.length>n.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(n,r)):Uint8Array.prototype.set.call(n,t,r);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,r)}r+=t.length}return n},u.byteLength=_,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?w(this,0,e):g.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const i=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(e+=" ... "),"<Buffer "+e+">"},a&&(u.prototype[a]=u.prototype.inspect),u.prototype.compare=function(e,t,i,n,r){if(K(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;let o=(r>>>=0)-(n>>>=0),a=(i>>>=0)-(t>>>=0);const s=Math.min(o,a),l=this.slice(n,r),c=e.slice(t,i);for(let e=0;e<s;++e)if(l[e]!==c[e]){o=l[e],a=c[e];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},u.prototype.indexOf=function(e,t,i){return v(this,e,t,i,!0)},u.prototype.lastIndexOf=function(e,t,i){return v(this,e,t,i,!1)},u.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}const r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return A(this,e,t,i);case"utf8":case"utf-8":return T(this,e,t,i);case"ascii":case"latin1":case"binary":return E(this,e,t,i);case"base64":return C(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function P(e,t,i){let n="";i=Math.min(e.length,i);for(let r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function D(e,t,i){let n="";i=Math.min(e.length,i);for(let r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function O(e,t,i){const n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);let r="";for(let n=t;n<i;++n)r+=Q[e[n]];return r}function L(e,t,i){const n=e.slice(t,i);let r="";for(let e=0;e<n.length-1;e+=2)r+=String.fromCharCode(n[e]+256*n[e+1]);return r}function R(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,i,n,r,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function M(e,t,i,n,r){G(t,n,r,e,i,7);let o=Number(t&BigInt(4294967295));e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o,o>>=8,e[i++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[i++]=a,a>>=8,e[i++]=a,a>>=8,e[i++]=a,a>>=8,e[i++]=a,i}function F(e,t,i,n,r){G(t,n,r,e,i,7);let o=Number(t&BigInt(4294967295));e[i+7]=o,o>>=8,e[i+6]=o,o>>=8,e[i+5]=o,o>>=8,e[i+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[i+3]=a,a>>=8,e[i+2]=a,a>>=8,e[i+1]=a,a>>=8,e[i]=a,i+8}function B(e,t,i,n,r,o){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function z(e,t,i,n,r){return t=+t,i>>>=0,r||B(e,0,i,4),o.write(e,t,i,n,23,4),i+4}function U(e,t,i,n,r){return t=+t,i>>>=0,r||B(e,0,i,8),o.write(e,t,i,n,52,8),i+8}u.prototype.slice=function(e,t){const i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let n=this[e],r=1,o=0;for(;++o<t&&(r*=256);)n+=this[e+o]*r;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let n=this[e+--t],r=1;for(;t>0&&(r*=256);)n+=this[e+--t]*r;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=Z((function(e){j(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||W(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,r=this[++e]+256*this[++e]+65536*this[++e]+i*2**24;return BigInt(n)+(BigInt(r)<<BigInt(32))})),u.prototype.readBigUInt64BE=Z((function(e){j(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||W(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],r=this[++e]*2**24+65536*this[++e]+256*this[++e]+i;return(BigInt(n)<<BigInt(32))+BigInt(r)})),u.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let n=this[e],r=1,o=0;for(;++o<t&&(r*=256);)n+=this[e+o]*r;return r*=128,n>=r&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||R(e,t,this.length);let n=t,r=1,o=this[e+--n];for(;n>0&&(r*=256);)o+=this[e+--n]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},u.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=Z((function(e){j(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||W(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=Z((function(e){j(e>>>=0,"offset");const t=this[e],i=this[e+7];void 0!==t&&void 0!==i||W(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+i)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),o.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),o.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),o.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),o.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t>>>=0,i>>>=0,!n){N(this,e,t,i,Math.pow(2,8*i)-1,0)}let r=1,o=0;for(this[t]=255&e;++o<i&&(r*=256);)this[t+o]=e/r&255;return t+i},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t>>>=0,i>>>=0,!n){N(this,e,t,i,Math.pow(2,8*i)-1,0)}let r=i-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+i},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=Z((function(e,t=0){return M(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=Z((function(e,t=0){return F(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*i-1);N(this,e,t,i,n-1,-n)}let r=0,o=1,a=0;for(this[t]=255&e;++r<i&&(o*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/o>>0)-a&255;return t+i},u.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*i-1);N(this,e,t,i,n-1,-n)}let r=i-1,o=1,a=0;for(this[t+r]=255&e;--r>=0&&(o*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/o>>0)-a&255;return t+i},u.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=Z((function(e,t=0){return M(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=Z((function(e,t=0){return F(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,i){return z(this,e,t,!0,i)},u.prototype.writeFloatBE=function(e,t,i){return z(this,e,t,!1,i)},u.prototype.writeDoubleLE=function(e,t,i){return U(this,e,t,!0,i)},u.prototype.writeDoubleBE=function(e,t,i){return U(this,e,t,!1,i)},u.prototype.copy=function(e,t,i,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);const r=n-i;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),r},u.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;let r;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(r=t;r<i;++r)this[r]=e;else{const o=u.isBuffer(e)?e:u.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(r=0;r<i-t;++r)this[r+t]=o[r%a]}return this};const k={};function V(e,t,i){k[e]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function H(e){let t="",i=e.length;const n="-"===e[0]?1:0;for(;i>=n+4;i-=3)t=`_${e.slice(i-3,i)}${t}`;return`${e.slice(0,i)}${t}`}function G(e,t,i,n,r,o){if(e>i||e<t){const n="bigint"==typeof t?"n":"";let r;throw r=o>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${t}${n} and <= ${i}${n}`,new k.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,i){j(t,"offset"),void 0!==e[t]&&void 0!==e[t+i]||W(t,e.length-(i+1))}(n,r,o)}function j(e,t){if("number"!=typeof e)throw new k.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,i){if(Math.floor(e)!==e)throw j(e,i),new k.ERR_OUT_OF_RANGE(i||"offset","an integer",e);if(t<0)throw new k.ERR_BUFFER_OUT_OF_BOUNDS;throw new k.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${t}`,e)}V("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),V("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),V("ERR_OUT_OF_RANGE",(function(e,t,i){let n=`The value of "${e}" is out of range.`,r=i;return Number.isInteger(i)&&Math.abs(i)>2**32?r=H(String(i)):"bigint"==typeof i&&(r=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(r=H(r)),r+="n"),n+=` It must be ${t}. Received ${r}`,n}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function Y(e,t){let i;t=t||1/0;const n=e.length;let r=null;const o=[];for(let a=0;a<n;++a){if(i=e.charCodeAt(a),i>55295&&i<57344){if(!r){if(i>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function X(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,i,n){let r;for(r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let i=0;i<16;++i){const n=16*i;for(let r=0;r<16;++r)t[n+r]=e[i]+e[r]}return t}();function Z(e){return"undefined"==typeof BigInt?ee:e}function ee(){throw new Error("BigInt not supported")}},1924:(e,t,i)=>{"use strict";var n=i(210),r=i(5559),o=r(n("String.prototype.indexOf"));e.exports=function(e,t){var i=n(e,!!t);return"function"==typeof i&&o(e,".prototype.")>-1?r(i):i}},5559:(e,t,i)=>{"use strict";var n=i(8612),r=i(210),o=r("%Function.prototype.apply%"),a=r("%Function.prototype.call%"),s=r("%Reflect.apply%",!0)||n.call(a,o),l=r("%Object.getOwnPropertyDescriptor%",!0),u=r("%Object.defineProperty%",!0),c=r("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var t=s(n,a,arguments);l&&u&&(l(t,"length").configurable&&u(t,"length",{value:1+c(0,e.length-(arguments.length-1))}));return t};var h=function(){return s(n,o,arguments)};u?u(e.exports,"apply",{value:h}):e.exports.apply=h},5108:(e,t,i)=>{var n=i(9539),r=i(9282);function o(){return(new Date).getTime()}var a,s=Array.prototype.slice,l={};a=void 0!==i.g&&i.g.console?i.g.console:"undefined"!=typeof window&&window.console?window.console:{};for(var u=[[function(){},"log"],[function(){a.log.apply(a,arguments)},"info"],[function(){a.log.apply(a,arguments)},"warn"],[function(){a.warn.apply(a,arguments)},"error"],[function(e){l[e]=o()},"time"],[function(e){var t=l[e];if(!t)throw new Error("No such label: "+e);delete l[e];var i=o()-t;a.log(e+": "+i+"ms")},"timeEnd"],[function(){var e=new Error;e.name="Trace",e.message=n.format.apply(null,arguments),a.error(e.stack)},"trace"],[function(e){a.log(n.inspect(e)+"\n")},"dir"],[function(e){if(!e){var t=s.call(arguments,1);r.ok(!1,n.format.apply(null,t))}},"assert"]],c=0;c<u.length;c++){var h=u[c],d=h[0],p=h[1];a[p]||(a[p]=d)}e.exports=a},2296:(e,t,i)=>{"use strict";var n=i(1044)(),r=i(210),o=n&&r("%Object.defineProperty%",!0),a=r("%SyntaxError%"),s=r("%TypeError%"),l=i(7296);e.exports=function(e,t,i){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new s("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new s("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new s("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new s("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new s("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new s("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,r=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,c=arguments.length>6&&arguments[6],h=!!l&&l(e,t);if(o)o(e,t,{configurable:null===u&&h?h.configurable:!u,enumerable:null===n&&h?h.enumerable:!n,value:i,writable:null===r&&h?h.writable:!r});else{if(!c&&(n||r||u))throw new a("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=i}}},4289:(e,t,i)=>{"use strict";var n=i(2215),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=i(2296),l=i(1044)(),u=function(e,t,i,n){if(t in e)if(!0===n){if(e[t]===i)return}else if("function"!=typeof(r=n)||"[object Function]"!==o.call(r)||!n())return;var r;l?s(e,t,i,!0):s(e,t,i)},c=function(e,t){var i=arguments.length>2?arguments[2]:{},o=n(t);r&&(o=a.call(o,Object.getOwnPropertySymbols(t)));for(var s=0;s<o.length;s+=1)u(e,o[s],t[o[s]],i[o[s]])};c.supportsDescriptors=!!l,e.exports=c},4029:(e,t,i)=>{"use strict";var n=i(5320),r=Object.prototype.toString,o=Object.prototype.hasOwnProperty;e.exports=function(e,t,i){if(!n(t))throw new TypeError("iterator must be a function");var a;arguments.length>=3&&(a=i),"[object Array]"===r.call(e)?function(e,t,i){for(var n=0,r=e.length;n<r;n++)o.call(e,n)&&(null==i?t(e[n],n,e):t.call(i,e[n],n,e))}(e,t,a):"string"==typeof e?function(e,t,i){for(var n=0,r=e.length;n<r;n++)null==i?t(e.charAt(n),n,e):t.call(i,e.charAt(n),n,e)}(e,t,a):function(e,t,i){for(var n in e)o.call(e,n)&&(null==i?t(e[n],n,e):t.call(i,e[n],n,e))}(e,t,a)}},7648:e=>{"use strict";var t=Array.prototype.slice,i=Object.prototype.toString;e.exports=function(e){var n=this;if("function"!=typeof n||"[object Function]"!==i.call(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r,o=t.call(arguments,1),a=Math.max(0,n.length-o.length),s=[],l=0;l<a;l++)s.push("$"+l);if(r=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof r){var i=n.apply(this,o.concat(t.call(arguments)));return Object(i)===i?i:this}return n.apply(e,o.concat(t.call(arguments)))})),n.prototype){var u=function(){};u.prototype=n.prototype,r.prototype=new u,u.prototype=null}return r}},8612:(e,t,i)=>{"use strict";var n=i(7648);e.exports=Function.prototype.bind||n},210:(e,t,i)=>{"use strict";var n,r=SyntaxError,o=Function,a=TypeError,s=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var u=function(){throw new a},c=l?function(){try{return u}catch(e){try{return l(arguments,"callee").get}catch(e){return u}}}():u,h=i(1405)(),d=i(8185)(),p=Object.getPrototypeOf||(d?function(e){return e.__proto__}:null),f={},m="undefined"!=typeof Uint8Array&&p?p(Uint8Array):n,_={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":h&&p?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h&&p?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h&&p?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h&&p?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h&&p?p(""[Symbol.iterator]()):n,"%Symbol%":h?Symbol:n,"%SyntaxError%":r,"%ThrowTypeError%":c,"%TypedArray%":m,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(p)try{null.error}catch(e){var g=p(p(e));_["%Error.prototype%"]=g}var y=function e(t){var i;if("%AsyncFunction%"===t)i=s("async function () {}");else if("%GeneratorFunction%"===t)i=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)i=s("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var r=e("%AsyncGenerator%");r&&p&&(i=p(r.prototype))}return _[t]=i,i},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=i(8612),A=i(7642),T=b.call(Function.call,Array.prototype.concat),E=b.call(Function.apply,Array.prototype.splice),C=b.call(Function.call,String.prototype.replace),x=b.call(Function.call,String.prototype.slice),S=b.call(Function.call,RegExp.prototype.exec),w=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,I=/\\(\\)?/g,P=function(e,t){var i,n=e;if(A(v,n)&&(n="%"+(i=v[n])[0]+"%"),A(_,n)){var o=_[n];if(o===f&&(o=y(n)),void 0===o&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new r("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a('"allowMissing" argument must be a boolean');if(null===S(/^%?[^%]*%?$/,e))throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=function(e){var t=x(e,0,1),i=x(e,-1);if("%"===t&&"%"!==i)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==t)throw new r("invalid intrinsic syntax, expected opening `%`");var n=[];return C(e,w,(function(e,t,i,r){n[n.length]=i?C(r,I,"$1"):t||e})),n}(e),n=i.length>0?i[0]:"",o=P("%"+n+"%",t),s=o.name,u=o.value,c=!1,h=o.alias;h&&(n=h[0],E(i,T([0,1],h)));for(var d=1,p=!0;d<i.length;d+=1){var f=i[d],m=x(f,0,1),g=x(f,-1);if(('"'===m||"'"===m||"`"===m||'"'===g||"'"===g||"`"===g)&&m!==g)throw new r("property names with quotes must have matching quotes");if("constructor"!==f&&p||(c=!0),A(_,s="%"+(n+="."+f)+"%"))u=_[s];else if(null!=u){if(!(f in u)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&d+1>=i.length){var y=l(u,f);u=(p=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[f]}else p=A(u,f),u=u[f];p&&!c&&(_[s]=u)}}return u}},7296:(e,t,i)=>{"use strict";var n=i(210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},1044:(e,t,i)=>{"use strict";var n=i(210)("%Object.defineProperty%",!0),r=function(){if(n)try{return n({},"a",{value:1}),!0}catch(e){return!1}return!1};r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=r},8185:e=>{"use strict";var t={foo:{}},i=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof i)}},1405:(e,t,i)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,r=i(5419);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&r())))}},5419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),i=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(e,t);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},6410:(e,t,i)=>{"use strict";var n=i(5419);e.exports=function(){return n()&&!!Symbol.toStringTag}},7642:(e,t,i)=>{"use strict";var n=i(8612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},645:(e,t)=>{
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,i,n,r){var o,a,s=8*r-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?r-1:0,d=i?-1:1,p=e[t+h];for(h+=d,o=p&(1<<-c)-1,p>>=-c,c+=s;c>0;o=256*o+e[t+h],h+=d,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+e[t+h],h+=d,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=u}return(p?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,i,n,r,o){var a,s,l,u=8*o-r-1,c=(1<<u)-1,h=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(t*l-1)*Math.pow(2,r),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;e[i+p]=255&s,p+=f,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;e[i+p]=255&a,p+=f,a/=256,u-=8);e[i+p-f]|=128*m}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},2584:(e,t,i)=>{"use strict";var n=i(6410)(),r=i(1924)("Object.prototype.toString"),o=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===r(e)},a=function(e){return!!o(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==r(e)&&"[object Function]"===r(e.callee)},s=function(){return o(arguments)}();o.isLegacyArguments=a,e.exports=s?o:a},5320:e=>{"use strict";var t,i,n=Function.prototype.toString,r="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof r&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw i}}),i={},r((function(){throw 42}),null,t)}catch(e){e!==i&&(r=null)}else r=null;var o=/^\s*class\b/,a=function(e){try{var t=n.call(e);return o.test(t)}catch(e){return!1}},s=function(e){try{return!a(e)&&(n.call(e),!0)}catch(e){return!1}},l=Object.prototype.toString,u="function"==typeof Symbol&&!!Symbol.toStringTag,c=!(0 in[,]),h=function(){return!1};if("object"==typeof document){var d=document.all;l.call(d)===l.call(document.all)&&(h=function(e){if((c||!e)&&(void 0===e||"object"==typeof e))try{var t=l.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=r?function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{r(e,null,t)}catch(e){if(e!==i)return!1}return!a(e)&&s(e)}:function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(u)return s(e);if(a(e))return!1;var t=l.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&s(e)}},8662:(e,t,i)=>{"use strict";var n,r=Object.prototype.toString,o=Function.prototype.toString,a=/^\s*(?:function)?\*/,s=i(6410)(),l=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(a.test(o.call(e)))return!0;if(!s)return"[object GeneratorFunction]"===r.call(e);if(!l)return!1;if(void 0===n){var t=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&l(t)}return l(e)===n}},8611:e=>{"use strict";e.exports=function(e){return e!=e}},360:(e,t,i)=>{"use strict";var n=i(5559),r=i(4289),o=i(8611),a=i(9415),s=i(3194),l=n(a(),Number);r(l,{getPolyfill:a,implementation:o,shim:s}),e.exports=l},9415:(e,t,i)=>{"use strict";var n=i(8611);e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:n}},3194:(e,t,i)=>{"use strict";var n=i(4289),r=i(9415);e.exports=function(){var e=r();return n(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}},5692:(e,t,i)=>{"use strict";var n=i(6430);e.exports=function(e){return!!n(e)}},4244:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,i){return 0===e&&0===i?1/e==1/i:e===i||!(!t(e)||!t(i))}},609:(e,t,i)=>{"use strict";var n=i(4289),r=i(5559),o=i(4244),a=i(5624),s=i(2281),l=r(a(),Object);n(l,{getPolyfill:a,implementation:o,shim:s}),e.exports=l},5624:(e,t,i)=>{"use strict";var n=i(4244);e.exports=function(){return"function"==typeof Object.is?Object.is:n}},2281:(e,t,i)=>{"use strict";var n=i(5624),r=i(4289);e.exports=function(){var e=n();return r(Object,{is:e},{is:function(){return Object.is!==e}}),e}},8987:(e,t,i)=>{"use strict";var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=i(1414),s=Object.prototype.propertyIsEnumerable,l=!s.call({toString:null},"toString"),u=s.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(e){var t=e.constructor;return t&&t.prototype===e},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!d["$"+e]&&r.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{h(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,i="[object Function]"===o.call(e),n=a(e),s=t&&"[object String]"===o.call(e),d=[];if(!t&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var f=u&&i;if(s&&e.length>0&&!r.call(e,0))for(var m=0;m<e.length;++m)d.push(String(m));if(n&&e.length>0)for(var _=0;_<e.length;++_)d.push(String(_));else for(var g in e)f&&"prototype"===g||!r.call(e,g)||d.push(String(g));if(l)for(var y=function(e){if("undefined"==typeof window||!p)return h(e);try{return h(e)}catch(e){return!1}}(e),v=0;v<c.length;++v)y&&"constructor"===c[v]||!r.call(e,c[v])||d.push(c[v]);return d}}e.exports=n},2215:(e,t,i)=>{"use strict";var n=Array.prototype.slice,r=i(1414),o=Object.keys,a=o?function(e){return o(e)}:i(8987),s=Object.keys;a.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return r(e)?s(n.call(e)):s(e)})}else Object.keys=a;return Object.keys||a},e.exports=a},1414:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var i=t.call(e),n="[object Arguments]"===i;return n||(n="[object Array]"!==i&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),n}},2837:(e,t,i)=>{"use strict";var n=i(2215),r=i(5419)(),o=i(1924),a=Object,s=o("Array.prototype.push"),l=o("Object.prototype.propertyIsEnumerable"),u=r?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(null==e)throw new TypeError("target must be an object");var i=a(e);if(1===arguments.length)return i;for(var o=1;o<arguments.length;++o){var c=a(arguments[o]),h=n(c),d=r&&(Object.getOwnPropertySymbols||u);if(d)for(var p=d(c),f=0;f<p.length;++f){var m=p[f];l(c,m)&&s(h,m)}for(var _=0;_<h.length;++_){var g=h[_];if(l(c,g)){var y=c[g];i[g]=y}}}return i}},8162:(e,t,i)=>{"use strict";var n=i(2837);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),i={},n=0;n<t.length;++n)i[t[n]]=t[n];var r=Object.assign({},i),o="";for(var a in r)o+=a;return e!==o}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?n:Object.assign:n}},4155:e=>{var t,i,n=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(e){t=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var s,l=[],u=!1,c=-1;function h(){u&&s&&(u=!1,s.length?l=s.concat(l):c=-1,l.length&&d())}function d(){if(!u){var e=a(h);u=!0;for(var t=l.length;t;){for(s=l,l=[];++c<t;)s&&s[c].run();c=-1,t=l.length}s=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new p(e,t)),1!==l.length||u||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},5955:(e,t,i)=>{"use strict";var n=i(2584),r=i(8662),o=i(6430),a=i(5692);function s(e){return e.call.bind(e)}var l="undefined"!=typeof BigInt,u="undefined"!=typeof Symbol,c=s(Object.prototype.toString),h=s(Number.prototype.valueOf),d=s(String.prototype.valueOf),p=s(Boolean.prototype.valueOf);if(l)var f=s(BigInt.prototype.valueOf);if(u)var m=s(Symbol.prototype.valueOf);function _(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function g(e){return"[object Map]"===c(e)}function y(e){return"[object Set]"===c(e)}function v(e){return"[object WeakMap]"===c(e)}function b(e){return"[object WeakSet]"===c(e)}function A(e){return"[object ArrayBuffer]"===c(e)}function T(e){return"undefined"!=typeof ArrayBuffer&&(A.working?A(e):e instanceof ArrayBuffer)}function E(e){return"[object DataView]"===c(e)}function C(e){return"undefined"!=typeof DataView&&(E.working?E(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=r,t.isTypedArray=a,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):a(e)||C(e)},t.isUint8Array=function(e){return"Uint8Array"===o(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===o(e)},t.isUint16Array=function(e){return"Uint16Array"===o(e)},t.isUint32Array=function(e){return"Uint32Array"===o(e)},t.isInt8Array=function(e){return"Int8Array"===o(e)},t.isInt16Array=function(e){return"Int16Array"===o(e)},t.isInt32Array=function(e){return"Int32Array"===o(e)},t.isFloat32Array=function(e){return"Float32Array"===o(e)},t.isFloat64Array=function(e){return"Float64Array"===o(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===o(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===o(e)},g.working="undefined"!=typeof Map&&g(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(g.working?g(e):e instanceof Map)},y.working="undefined"!=typeof Set&&y(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(y.working?y(e):e instanceof Set)},v.working="undefined"!=typeof WeakMap&&v(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(v.working?v(e):e instanceof WeakMap)},b.working="undefined"!=typeof WeakSet&&b(new WeakSet),t.isWeakSet=function(e){return b(e)},A.working="undefined"!=typeof ArrayBuffer&&A(new ArrayBuffer),t.isArrayBuffer=T,E.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&E(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=C;var x="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function S(e){return"[object SharedArrayBuffer]"===c(e)}function w(e){return void 0!==x&&(void 0===S.working&&(S.working=S(new x)),S.working?S(e):e instanceof x)}function I(e){return _(e,h)}function P(e){return _(e,d)}function D(e){return _(e,p)}function O(e){return l&&_(e,f)}function L(e){return u&&_(e,m)}t.isSharedArrayBuffer=w,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===c(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===c(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===c(e)},t.isGeneratorObject=function(e){return"[object Generator]"===c(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===c(e)},t.isNumberObject=I,t.isStringObject=P,t.isBooleanObject=D,t.isBigIntObject=O,t.isSymbolObject=L,t.isBoxedPrimitive=function(e){return I(e)||P(e)||D(e)||O(e)||L(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(T(e)||w(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},9539:(e,t,i)=>{var n=i(4155),r=i(5108),o=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},a=/%[sdj%]/g;t.format=function(e){if(!b(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(c(arguments[i]));return t.join(" ")}i=1;for(var n=arguments,r=n.length,o=String(e).replace(a,(function(e){if("%%"===e)return"%";if(i>=r)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return e}})),s=n[i];i<r;s=n[++i])y(s)||!E(s)?o+=" "+s:o+=" "+c(s);return o},t.deprecate=function(e,i){if(void 0!==n&&!0===n.noDeprecation)return e;if(void 0===n)return function(){return t.deprecate(e,i).apply(this,arguments)};var o=!1;return function(){if(!o){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?r.trace(i):r.error(i),o=!0}return e.apply(this,arguments)}};var s={},l=/^$/;if(n.env.NODE_DEBUG){var u=n.env.NODE_DEBUG;u=u.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),l=new RegExp("^"+u+"$","i")}function c(e,i){var n={seen:[],stylize:d};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(i)?n.showHidden=i:i&&t._extend(n,i),A(n.showHidden)&&(n.showHidden=!1),A(n.depth)&&(n.depth=2),A(n.colors)&&(n.colors=!1),A(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=h),p(n,e,n.depth)}function h(e,t){var i=c.styles[t];return i?"["+c.colors[i][0]+"m"+e+"["+c.colors[i][1]+"m":e}function d(e,t){return e}function p(e,i,n){if(e.customInspect&&i&&S(i.inspect)&&i.inspect!==t.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,e);return b(r)||(r=p(e,r,n)),r}var o=function(e,t){if(A(t))return e.stylize("undefined","undefined");if(b(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if(v(t))return e.stylize(""+t,"number");if(g(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,i);if(o)return o;var a=Object.keys(i),s=function(e){var t={};return e.forEach((function(e,i){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(i)),x(i)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(i);if(0===a.length){if(S(i)){var l=i.name?": "+i.name:"";return e.stylize("[Function"+l+"]","special")}if(T(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(C(i))return e.stylize(Date.prototype.toString.call(i),"date");if(x(i))return f(i)}var u,c="",h=!1,d=["{","}"];(_(i)&&(h=!0,d=["[","]"]),S(i))&&(c=" [Function"+(i.name?": "+i.name:"")+"]");return T(i)&&(c=" "+RegExp.prototype.toString.call(i)),C(i)&&(c=" "+Date.prototype.toUTCString.call(i)),x(i)&&(c=" "+f(i)),0!==a.length||h&&0!=i.length?n<0?T(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special"):(e.seen.push(i),u=h?function(e,t,i,n,r){for(var o=[],a=0,s=t.length;a<s;++a)D(t,String(a))?o.push(m(e,t,i,n,String(a),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(m(e,t,i,n,r,!0))})),o}(e,i,n,s,a):a.map((function(t){return m(e,i,n,s,t,h)})),e.seen.pop(),function(e,t,i){var n=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(u,c,d)):d[0]+c+d[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function m(e,t,i,n,r,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),D(n,r)||(a="["+r+"]"),s||(e.seen.indexOf(l.value)<0?(s=y(i)?p(e,l.value,null):p(e,l.value,i-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),A(a)){if(o&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.slice(1,-1),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function _(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function y(e){return null===e}function v(e){return"number"==typeof e}function b(e){return"string"==typeof e}function A(e){return void 0===e}function T(e){return E(e)&&"[object RegExp]"===w(e)}function E(e){return"object"==typeof e&&null!==e}function C(e){return E(e)&&"[object Date]"===w(e)}function x(e){return E(e)&&("[object Error]"===w(e)||e instanceof Error)}function S(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!s[e])if(l.test(e)){var i=n.pid;s[e]=function(){var n=t.format.apply(t,arguments);r.error("%s %d: %s",e,i,n)}}else s[e]=function(){};return s[e]},t.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=i(5955),t.isArray=_,t.isBoolean=g,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=b,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=A,t.isRegExp=T,t.types.isRegExp=T,t.isObject=E,t.isDate=C,t.types.isDate=C,t.isError=x,t.types.isNativeError=x,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=i(384);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,i;r.log("%s - %s",(e=new Date,i=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":"),[e.getDate(),P[e.getMonth()],i].join(" ")),t.format.apply(t,arguments))},t.inherits=i(5717),t._extend=function(e,t){if(!t||!E(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e};var O="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function L(e,t){if(!e){var i=new Error("Promise was rejected with a falsy value");i.reason=e,e=i}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(O&&e[O]){var t;if("function"!=typeof(t=e[O]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,O,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,i,n=new Promise((function(e,n){t=e,i=n})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(e,n){e?i(e):t(n)}));try{e.apply(this,r)}catch(e){i(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),O&&Object.defineProperty(t,O,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,o(e))},t.promisify.custom=O,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var r=t.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return r.apply(o,arguments)};e.apply(this,t).then((function(e){n.nextTick(a.bind(null,null,e))}),(function(e){n.nextTick(L.bind(null,e,a))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,o(e)),t}},6430:(e,t,i)=>{"use strict";var n=i(4029),r=i(6314),o=i(5559),a=i(1924),s=i(7296),l=a("Object.prototype.toString"),u=i(6410)(),c="undefined"==typeof globalThis?i.g:globalThis,h=r(),d=a("String.prototype.slice"),p=Object.getPrototypeOf,f=a("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},m={__proto__:null};n(h,u&&s&&p?function(e){var t=new c[e];if(Symbol.toStringTag in t){var i=p(t),n=s(i,Symbol.toStringTag);if(!n){var r=p(i);n=s(r,Symbol.toStringTag)}m["$"+e]=o(n.get)}}:function(e){var t=new c[e];m["$"+e]=o(t.slice)});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u){var t=d(l(e),8,-1);return f(h,t)>-1?t:"Object"===t&&function(e){var t=!1;return n(m,(function(i,n){if(!t)try{i(e),t=d(n,1)}catch(e){}})),t}(e)}return s?function(e){var t=!1;return n(m,(function(i,n){if(!t)try{"$"+i(e)===n&&(t=d(n,1))}catch(e){}})),t}(e):null}},8163:(e,t,i)=>{var n="undefined"!=typeof window?window:i.g;n.getScriptSrcPathbase=function(e){var t="./";return-1==e.lastIndexOf("/")||0==e.indexOf("./")?t:t=e.substr(0,e.lastIndexOf("/")+1)},n.getJsFileRuntimePath=function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;++t){var i=e[t].getAttribute("src");if(i&&-1!=i.indexOf("SpatiotemporalPlatform.js"))return SpatiotemporalPlatform.getScriptSrcPathbase(i)}return"./"},i.p="undefined"==typeof document?"":document.currentScript.src?getScriptSrcPathbase(document.currentScript.src):getJsFileRuntimePath()}},__webpack_module_cache__={},leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var i=Object.create(null);__webpack_require__.r(i);var n={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var r=2&t&&e;"object"==typeof r&&!~leafPrototypes.indexOf(r);r=getProto(r))Object.getOwnPropertyNames(r).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,__webpack_require__.d(i,n),i},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,i)=>(__webpack_require__.f[i](e,t),t)),[])),__webpack_require__.u=e=>e+".js",__webpack_require__.miniCssF=e=>{},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="spatiotemporalplatform.iclient.javascript:",__webpack_require__.l=(e,t,i,n)=>{if(inProgress[e])inProgress[e].push(t);else{var r,o;if(void 0!==i)for(var a=document.getElementsByTagName("script"),s=0;s<a.length;s++){var l=a[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==dataWebpackPrefix+i){r=l;break}}r||(o=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack",dataWebpackPrefix+i),r.src=e),inProgress[e]=[t];var u=(t,i)=>{r.onerror=r.onload=null,clearTimeout(c);var n=inProgress[e];if(delete inProgress[e],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach((e=>e(i))),t)return t(i)},c=setTimeout(u.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=u.bind(null,r.onerror),r.onload=u.bind(null,r.onload),o&&document.head.appendChild(r)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="",(()=>{var e={802:0};__webpack_require__.f.j=(t,i)=>{var n=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var r=new Promise(((i,r)=>n=e[t]=[i,r]));i.push(n[2]=r);var o=__webpack_require__.p+__webpack_require__.u(t),a=new Error;__webpack_require__.l(o,(i=>{if(__webpack_require__.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,n[1](a)}}),"chunk-"+t,t)}};var t=(t,i)=>{var n,r,[o,a,s]=i,l=0;if(o.some((t=>0!==e[t]))){for(n in a)__webpack_require__.o(a,n)&&(__webpack_require__.m[n]=a[n]);if(s)s(__webpack_require__)}for(t&&t(i);l<o.length;l++)r=o[l],__webpack_require__.o(e,r)&&e[r]&&e[r][0](),e[r]=0},i=this.webpackChunkspatiotemporalplatform_iclient_javascript=this.webpackChunkspatiotemporalplatform_iclient_javascript||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{SPCesium:()=>R,default:()=>M});__webpack_require__(8163);var e=__webpack_require__(9919);window.Cesium=e;var t=__webpack_require__(5108),i={SOLID:0,DASH:[6,2],DOT:[2,2],DASHDOT:[2,3,8,3],DASHDOTDOT:[2,2,2,2,6,2]};function n(e){e=Cesium.defaultValue(e,{}),this.color=Cesium.defaultValue(e.color,"#FFFFFF"),this.lineWidth=Cesium.defaultValue(e.lineWidth,1),(isNaN(this.lineWidth)||!isFinite(this.lineWidth)||0>=this.lineWidth)&&(t.warn("",this),this.lineWidth=1),this.lineType=Cesium.defaultValue(e.lineType,i.SOLID),this.outline=Cesium.defaultValue(e.outline,!0),this.outlineColor=Cesium.defaultValue(e.outlineColor,"#000000"),this.icon=e.icon,this.textField=e.textField,this.font=e.font,this.classificationField=e.classificationField,this.classificationFieldValue=e.classificationFieldValue}function r(e){Cesium.defined(e)?this._vectorTileStyles=e instanceof Array?e:[e]:this._vectorTileStyles=[]}n.prototype.clone=function(e){return Cesium.defined(e)?(e.color=this.color,e.lineWidth=this.lineWidth,e.lineType=this.lineType,e.outline=this.outline,e.outlineColor=this.outlineColor,e.textField=this.textField,e.icon=this.icon,e.font=this.font,e.classificationField=this.classificationField,e.classificationFieldValue=this.classificationFieldValue,e):new n({color:this.color,lineWidth:this.lineWidth,lineType:this.lineType,outline:this.outline,outlineColor:this.outlineColor,textField:this.textField,icon:this.icon,font:this.font,classificationField:this.classificationField,classificationFieldValue:this.classificationFieldValue})},n.prototype.updatefromObject=function(e){Cesium.defined(e)&&(this.color=e.color,this.lineWidth=e.lineWidth,this.lineType=e.lineType,this.outline=e.outline,this.outlineColor=e.outlineColor,this.textField=e.textField,this.icon=e.icon,this.font=e.font,this.classificationField=e.classificationField,this.classificationFieldValue=e.classificationFieldValue)},Object.defineProperties(r.prototype,{vectorTileStyles:{get:function(){return this._vectorTileStyles}}}),r.prototype.clone=function(e){Cesium.defined(e)||(e=new r);for(var t=e.length=0;t<this._vectorTileStyles.length;++t)e.push(this._vectorTileStyles[t].clone());return e},r.prototype.toJson=function(){var e={};e.asset={version:"1.0.0"};for(var t=[],i=0;i<this._vectorTileStyles.length;++i){var n=this._vectorTileStyles[i];t.push(n.clone())}return e.styles=t,e},r.prototype.fromJson=function(e){e.asset.version,this._vectorTileStyles.length=0;for(var t=e.styles,i=0;i<t.length;++i){var r=t[i],o=new n({color:r.color,lineWidth:r.lineWidth,lineType:r.lineType,outline:r.outline,outlineColor:r.outlineColor,textField:r.textField,icon:r.icon,font:r.font,classificationField:r.classificationField,classificationFieldValue:r.classificationFieldValue});this._vectorTileStyles.push(o)}},r.prototype.updatefromObject=function(e,t){e>=this._vectorTileStyles.length||this._vectorTileStyles[e].updatefromObject(t)},r.VectorTileLineType=i,r.VectorTileStyle=n;const o=r;var a=__webpack_require__(5108);const s=SpatiotemporalPlatform.utils;function l(e){if(!Cesium.defined(ol))throw new Cesium.DeveloperError("Openlayers lib is required.");if(e=Cesium.defaultValue(e,Cesium.defaultValue.EMPTY_OBJECT),!Cesium.defined(e.viewer))throw new Cesium.DeveloperError("options.viewer is required.");if(!Cesium.defined(e.url))throw new Cesium.DeveloperError("options.url is required.");var t=this;this._viewer=e.viewer,this._url=e.url,this._tileUrlTemplate=e.tileUrlTemplate,this._proxy=e.proxy,this._key=e.key,this.name=e.name,this.type="VectorTileImageryProvider",this.defaultAlpha=Cesium.defaultValue(e.defaultAlpha,1),this._errorEvent=new Cesium.Event,this._errorEvent.addEventListener((function(e){a.error("An error occurred in "+t.constructor.name+": "+t._url+" "+Cesium.formatError(e.message))})),this._treatPointRenderingAsCesiumEntity=Cesium.defaultValue(e.treatPointRenderingAsCesiumEntity,!1),this._pointGeometry=!1,this._dataSource=void 0,this._needFresh=!1,this._vectorTileStyleCollection=e.vectorTileStyleCollection,this._selectedVectorTileStyleCollection=e.selectedVectorTileStyleCollection,this._flashVectorTileStyle=new o.VectorTileStyle({color:"rgba(255, 255, 0, 1)",lineWidth:"1",lineType:o.VectorTileLineType.DASHDOTDOT,outline:!1,outlineColor:"rgba(255, 0, 0, 1)",classificationField:void 0,classificationFieldValue:void 0}),this._styleFunc=this.createStyleFunc(this._vectorTileStyleCollection,!1),this._selectedStyleFunc=this.createStyleFunc(this._selectedVectorTileStyleCollection,!0),this._tilingScheme=Cesium.defaultValue(e.tilingScheme,new Cesium.WebMercatorTilingScheme({ellipsoid:e.ellipsoid})),this._tileWidth=Cesium.defaultValue(e.tileWidth,512),this._tileHeight=Cesium.defaultValue(e.tileHeight,512),this._subdomains=e.subdomains,s.isArray(this._subdomains)?this._subdomains=this._subdomains.slice():Cesium.defined(this._subdomains)&&0<this._subdomains.length?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"],this._mvtParser=new ol.format.MVT,this._pixelRatio=1.25,this._replays=["Default","Image","Polygon","LineString","Text"],this._featuresCache={},this.enablePickFeatures=Cesium.defaultValue(e.enablePickFeatures,!0),this._selectedId=-1,this._vectorLayers=[],this._hidingLayerName=[],this._layerOrder=[],this._viewer.selectedEntityChanged.addEventListener(l.prototype._onSelectedEntityChanged,this)}function u(e,t,i){return JSON.stringify([e,t,i])}function c(e,t){for(var i in e._featuresCache)for(var n=e._featuresCache[i],r=0;r<n.length;++r)if(n[r].getId()===t)return n[r]}function h(e,t,i){for(var n=!1,r=2;r<i.length;r+=2){var o=i[r-2],a=i[r-1],s=i[r],l=i[r+1];t<a!=t<l&&e<(s-o)*(t-a)/(l-a)+o&&(n=!n)}return n}function d(e,t,i,n){for(var r=0,o=0,a=0,s=2;s<i.length;s+=2){var l=i[s-2],u=i[s-1],c=i[s],h=i[s+1];if(p(e,t,l,u,c,h)&&(a=c-l,0==(o=u-h)&&0===a?r=(e-l)*(e-l)+(t-u)*(t-u):(r=o*e+a*t-(o*l+a*u),r*=r,r/=o*o+a*a),r<=n))return!0}return!1}function p(e,t,i,n,r,o){if(i===r&&n===o)return!0;var a=(e-i)*(e-i)+(t-n)*(t-n),s=(e-r)*(e-r)+(t-o)*(t-o),l=(r-i)*(r-i)+(o-n)*(o-n);return!(s+l<a||a+l<s)}function f(e,t){var i=function(i){for(var n=i.data.imagery,r=0;r<n.length;++r){var o=n[r],a=Cesium.defined(o.loadingImagery)?o.loadingImagery:o.readyImagery;if(a.imageryLayer._imageryProvider===e)if(Cesium.defined(t)){for(var s=u(a.x,a.y,a.level),l=0;l<t.length;++l)if(t[l]===s){m(i,o);break}}else m(i,o)}};e._viewer.scene.globe&&e._viewer.scene.globe._surface.forEachLoadedTile((function(e){i(e)})),e._viewer.scene.globeVector&&e._viewer.scene.globeVector._surface.forEachLoadedTile((function(e){i(e)}))}function m(e,t){var i=Cesium.defined(t.loadingImagery)?t.loadingImagery:t.readyImagery;Cesium.ImageryState.READY===i.state?(e.state=Cesium.QuadtreeTileLoadState.LOADING,Cesium.defined(t.loadingImagery)||(t.loadingImagery=t.readyImagery,t.loadingImagery.addReference()),t.loadingImagery.state=Cesium.ImageryState.UNLOADED):i.imageryLayer.imageryProvider._needFresh=!0}l.prototype._onSelectedEntityChanged=function(e){if(this.enablePickFeatures&&this._pointGeometry){var t=this._selectedId;if(Cesium.defined(e)&&e.vtp===this?this._selectedId=e.id:this._selectedId=-1,-1!==t){let e=c(this,t);if(Cesium.defined(e)){let t=this._dataSource.entities.getById(e.getId());if(Cesium.defined(t)){let i=this.createStylePointGeometry(!1,e);t.point=i.point,t.billboard=i.billboard,t.label=i.label}}}if(-1!==this._selectedId&&e.vtp===this){let e=c(this,this._selectedId);if(Cesium.defined(e)){let t=this._dataSource.entities.getById(e.getId());if(Cesium.defined(t)){let i=this.createStylePointGeometry(!0,e);t.point=i.point,t.billboard=i.billboard,t.label=i.label}}}}};l.prototype.createStyleFunc=function(e,t){Cesium.defined(e)||(e=new o(t?[new o.VectorTileStyle({color:"#0000FF"})]:[new o.VectorTileStyle])),e instanceof o||(e=new o([e]));var i=e.vectorTileStyles;0===i.length&&i.push(new o.VectorTileStyle);var n=document.createElement("canvas"),r=n.getContext("2d");const l=window.devicePixelRatio;(u=r.createLinearGradient(0,0,512*l,0)).addColorStop(0,"red"),u.addColorStop(1/6,"orange"),u.addColorStop(2/6,"yellow"),u.addColorStop(.5,"green"),u.addColorStop(4/6,"aqua"),u.addColorStop(5/6,"blue"),u.addColorStop(1,"purple");var u,c,h,d,p=(n.width=8*l,n.height=8*l,r.fillStyle="white",r.fillRect(0,0,n.width,n.height),r.fillStyle="rgba(102, 0, 102, 0.5)",r.beginPath(),r.arc(4*l,4*l,3*l,0,2*Math.PI),r.fill(),r.fillStyle="rgb(55, 0, 170)",r.beginPath(),r.arc(4*l,4*l,1.5*l,0,2*Math.PI),r.fill(),r.createPattern(n,"repeat")),f=new ol.style.Fill({color:"#ff0000"}),m=new ol.style.Stroke({color:"#ff0000",lineCap:"round",width:1}),_=(new ol.style.RegularShape({}),new ol.style.Circle({}),new ol.style.Icon({src:"http://localhost:9090/cesium-1.64/Build/CesiumUnminified/Assets/Images/cesium_credit.png"}),new ol.style.Text({text:"",textAlign:"left",fill:f,stroke:m})),g=new ol.style.Style({fill:f}),y=new ol.style.Style({fill:f,stroke:m}),v=new ol.style.Style({stroke:m}),b=new ol.style.Style({stroke:new ol.style.Stroke({color:"#ff0000",width:1})}),A={},T={},E=new ol.style.Style({text:_}),C=new ol.style.Fill({color:this._flashVectorTileStyle.color}),x=new ol.style.Stroke({color:this._flashVectorTileStyle.outlineColor,lineDash:this._flashVectorTileStyle.lineType,width:this._flashVectorTileStyle.lineWidth}),S=new ol.style.Style({fill:C,stroke:x}),w=this,I=0,P=[],D=0;return function(e){var t;for(I=0,h=i.length;I<h&&(t=i[I],Cesium.defined(t.classificationField)&&Cesium.defined(t.classificationFieldValue)&&0!==t.classificationFieldValue.length);++I)if(d=e.get(t.classificationField),s.isArray(t.classificationFieldValue)){if(1===t.classificationFieldValue.length){if(d==t.classificationFieldValue[0])break}else if(d>=t.classificationFieldValue[0]&&d<=t.classificationFieldValue[1])break}else if(d==t.classificationFieldValue)break;if(I>=i.length)return a.error(e),P;if(s.isString(t.color)&&(-1!==t.color.indexOf(".png")||-1!==t.color.indexOf(".jpg"))){var n=document.createElement("img");n.onload=function(){t.color=r.createPattern(n,"repeat"),w._needFresh=!0},n.setAttribute("crossOrigin","anonymous"),n.src=t.color,t.color=p}if(D=0,"Polygon"===(c=e.getGeometry().getType()))f.setColor(t.color),t.outline?(m.setColor(t.outlineColor),m.setWidth(t.lineWidth),t.lineType!==o.VectorTileLineType.SOLID&&m.setLineDash(t.lineType),P[D++]=y):P[D++]=g;else if("LineString"===c||"MultiLineString"===c)m.setColor(t.color),m.setWidth(t.lineWidth),t.lineType!==o.VectorTileLineType.SOLID&&m.setLineDash(t.lineType),P[D++]=v,t.outline&&(b.getStroke().setColor(t.outlineColor),t.lineType!==o.VectorTileLineType.SOLID&&b.getStroke().setLineDash(t.lineType),P[D++]=b);else if("Point"===c||"MultiPoint"===c)if(w._treatPointRenderingAsCesiumEntity)P[D++]=t;else{var l=JSON.stringify(t);if(!Cesium.defined(A[l])){f.setColor(t.color);var u={radius:3,fill:f};t.outline?(m.setColor(t.outlineColor),m.setWidth(t.lineWidth)):(m.setColor("#000000"),m.setWidth(1)),u.stroke=m,A[l]=new ol.style.Style({image:new ol.style.Circle(u)})}P[D++]=A[l];var O=e.get("showProperty");if(O&&0!==O.length&&(_.setText(e.get(O)),P[D++]=E),e.get("clustered")){var L=""+e.get("point_count");Cesium.defined(T[L])||(T[L]=new ol.style.Style({text:new ol.style.Text({text:L,stroke:m})})),P[D++]=T[L]}}else a.error(e);return Cesium.defined(w._flashVectorTileStyle.classificationField)&&w._flashVectorTileStyle.classificationFieldValue===e.get(w._flashVectorTileStyle.classificationField)&&(C.setColor(w._flashVectorTileStyle.color),x.setColor(w._flashVectorTileStyle.outlineColor),x.setLineDash(w._flashVectorTileStyle.lineType),x.setWidth(w._flashVectorTileStyle.lineWidth),P[D++]=S),t._styleExtended&&(P[D++]=new ol.style.Style({fill:new ol.style.Fill({color:t._styleExtended.color}),stroke:new ol.style.Stroke({color:t._styleExtended.outlineColor,lineDash:t._styleExtended.lineType,width:t._styleExtended.lineWidth})})),P.length=D,P}},l.prototype.createStylePointGeometry=function(e,t){var i={};if(!Cesium.defined(t))return i;for(var n=e?this._selectedStyleFunc(t):this._styleFunc(t),r=0;r<n.length;++r){var o=n[r];if(Cesium.defined(o)){var a=Cesium.Color.fromCssColorString(o.color),s=o.outline?Cesium.Color.fromCssColorString(o.outlineColor):void 0;if(Cesium.defined(o.icon)&&0!==o.icon.length&&(i.billboard={image:o.icon,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,width:24,height:24},i.label=void 0,i.point=void 0),Cesium.defined(o.textField)){var l=t.get(o.textField);Cesium.defined(l)&&(i.label={text:l,font:Cesium.defined(o.font)?o.font:"14px sans-serif",fillColor:a,outlineColor:s,outlineWidth:o.lineWidth,style:o.outline?Cesium.LabelStyle.FILL_AND_OUTLINE:Cesium.LabelStyle.FILL,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:Cesium.defined(i.billboard)?new Cesium.Cartesian2(.5*i.billboard.width,0):void 0}),i.point=void 0}Cesium.defined(i.label)||Cesium.defined(i.billboard)||(i.point={pixelSize:8,color:a})}}return i},Object.defineProperties(l.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._pointGeometry?this._maximumLevel:1}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},vectorTileStyleCollection:{get:function(){return this._vectorTileStyleCollection},set:function(e){if(this._vectorTileStyleCollection=e,this._styleFunc=this.createStyleFunc(this._vectorTileStyleCollection,!1),0<this._selectedId){var t=[];for(var i in this._featuresCache)for(var n=this._featuresCache[i],r=0;r<n.length;++r)if(n[r].getId()!==this._selectedId){t.push(i);break}f(this,t)}else f(this)}},selectedVectorTileStyleCollection:{get:function(){return this._selectedVectorTileStyleCollection},set:function(e){if(this._selectedVectorTileStyleCollection=e,this._selectedStyleFunc=this.createStyleFunc(this._selectedVectorTileStyleCollection,!0),0<this._selectedId){var t=[];for(var i in this._featuresCache)for(var n=this._featuresCache[i],r=0;r<n.length;++r)if(n[r].getId()===this._selectedId){t.push(i);break}f(this,t)}}},layerOrder:{get:function(){return this._layerOrder}}});var _=Cesium.ImageryLayer.prototype.isBaseLayer;Cesium.ImageryLayer.prototype.isBaseLayer=function(){return!(this._imageryProvider instanceof l)&&_.apply(this)},l.TRANSFORMED=100;var g=Cesium.TileImagery.prototype.processStateMachine;function y(e){return e.imageryLayer._imageryProvider&&e.imageryLayer._imageryProvider._pointGeometry?function(t,i,n,r,o){for(var a=[],s=12756274/4096/(1<<r),l=0;l<o.length;++l){var u=o[l],c=u.getFlatCoordinates()[0],h=u.getFlatCoordinates()[1];if(!(c<0||4096<c||h<0||4096<h)){var d=t._dataSource.entities.getById(u.getId());if(0!==t._hidingLayerName.length&&u.getProperties()&&-1!==t._hidingLayerName.indexOf(u.getProperties().layer))Cesium.defined(d)&&(d.show=!1);else{var p=t.createStylePointGeometry(u.getId()===t._selectedId,u);if(Cesium.defined(d))d.point=p.point,d.billboard=p.billboard,d.label=p.label,a.push([c/4096,(4096-h)/4096,d]);else{var f=((4096*i+c)*s-6378137)*Math.PI,m=((4096*(1<<r)-(4096*n+h))*s-6378137)*Math.PI,_=t._tilingScheme.projection.unproject(new Cesium.Cartesian3(f,m,0));(d=new Cesium.Entity({id:u.getId(),description:u.getProperties(),position:Cesium.Cartesian3.fromRadians(_.longitude,_.latitude,e.customHeight),point:p.point,billboard:p.billboard,label:p.label,show:!1})).referenceCount=0,d.vtp=e.imageryLayer._imageryProvider,a.push([c/4096,(4096-h)/4096,d])}}}}return a}(e.imageryLayer._imageryProvider,e.x,e.y,e.level,e.image):function(t,i){if(Cesium.defined(i)&&0!==i.length){var n=document.createElement("canvas");n.width=t._tileWidth,n.height=t._tileHeight;for(var r,o,s=n.getContext("2d"),l=Cesium.defined(i.rect)?i.rect:[0,0,4096,4096],u=new ol.render.canvas.ReplayGroup(0,l,8,!0,100),c=0,h=0,d=i.length;h<d;++h)if(r=i[h],0===t._hidingLayerName.length||!r.getProperties()||-1===t._hidingLayerName.indexOf(r.getProperties().layer))for(o=r.getId()===t._selectedId?t._selectedStyleFunc(r):t._styleFunc(r),c=0;c<o.length;++c)ol.renderer.vector.renderFeature_(u,r,o[c],16);u.finish();var p=[t._tileWidth/(l[2]-l[0]),0,0,t._tileHeight/(l[3]-l[1]),-512*l[0]/(l[2]-l[0]),-512*l[1]/(l[3]-l[1])];return u.replay(s,t._pixelRatio,p,0,{},t._replays,!0),n}a.warn(e)}(e.imageryLayer._imageryProvider,e.image)}Cesium.TileImagery.prototype.processStateMachine=function(e,t,i){if(!(this.loadingImagery.imageryLayer._imageryProvider instanceof l))return g.apply(this,[e,t,i]);var n=this.loadingImagery,r=n.imageryLayer;if(r._imageryProvider._treatPointRenderingAsCesiumEntity&&r._imageryProvider&&r._imageryProvider._pointGeometry){var o=e._tilingScheme.ellipsoid.radii.z-t.mapProjection.ellipsoid.radii.z;o>0&&(n.customHeight=o)}if(n.processStateMachine(t,!this.useWebMercatorT,i),n.state===Cesium.ImageryState.READY)return Cesium.defined(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=r._calculateTextureTranslationAndScale(e,this),!0;if(Cesium.defined(this.readyImagery)&&this.readyImagery.level===this.loadingImagery.level)return!1;for(var a,s=n.parent;Cesium.defined(s)&&(s.state!==Cesium.ImageryState.READY||!this.useWebMercatorT&&!Cesium.defined(s.texture));)s.state!==Cesium.ImageryState.FAILED&&s.state!==Cesium.ImageryState.INVALID&&(a=a||s),s=s.parent;return this.readyImagery!==s&&(Cesium.defined(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=s,Cesium.defined(s)&&(s.addReference(),this.textureTranslationAndScale=r._calculateTextureTranslationAndScale(e,this))),(n.state===Cesium.ImageryState.FAILED||n.state===Cesium.ImageryState.INVALID)&&(Cesium.defined(a)?(a.processStateMachine(t,!this.useWebMercatorT,e._priorityFunction),!1):!!(r._imageryProvider&&r._imageryProvider._pointGeometry||n.upSample)||(n.upSample=!0,n.state=Cesium.ImageryState.UNLOADED,!1))};var v=Cesium.Imagery.prototype.processStateMachine;Cesium.Imagery.prototype.processStateMachine=function(e,t,i){if(this.imageryLayer._imageryProvider instanceof l){if(this.state!==Cesium.ImageryState.UNLOADED||i||(this.state=Cesium.ImageryState.TRANSITIONING,this.imageryLayer._imageryProvider.upSample=this.upSample,this.imageryLayer._requestImagery(this),this.imageryLayer._imageryProvider.upSample=void 0),this.state===Cesium.ImageryState.RECEIVED){if(this.state=Cesium.ImageryState.TRANSITIONING,!0){var n=this,r=Cesium.defer();setTimeout((function(){var e=y(n);Cesium.defined(e)?r.resolve(e):r.reject()}),20);var o=r.promise;Promise.resolve(o,(function(e){n.image=e,n.state=l.TRANSFORMED}),(function(e){n.state=Cesium.ImageryState.FAILED}))}else{var a=y(this);Cesium.defined(a)?(this.image=a,this.state=l.TRANSFORMED):this.state=Cesium.ImageryState.FAILED}}if(this.state===l.TRANSFORMED){if(this.imageryLayer._imageryProvider&&this.imageryLayer._imageryProvider._pointGeometry){for(var s=this.imageryLayer._imageryProvider._dataSource.entities,u=0;u<this.image.length;++u){var c=this.image[u][2];++c.referenceCount,Cesium.defined(s.getById(c.id))||s.add(c)}return this.entities=this.image,this.image=void 0,this.textureWebMercator=this.texture=new Cesium.Texture({context:e.context,width:1,height:1}),void(this.state=Cesium.ImageryState.READY)}this.state=Cesium.ImageryState.TRANSITIONING,this.imageryLayer._createTexture(e.context,this)}var h=this.state===Cesium.ImageryState.READY&&t&&!this.texture;if(this.state===Cesium.ImageryState.TEXTURE_LOADED||h){if(this.state=Cesium.ImageryState.TRANSITIONING,t&&!this.rectangle){var d=this.imageryLayer._imageryProvider.tilingScheme;this.rectangle=d.tileXYToRectangle(this.x,this.y,this.level)}this.imageryLayer._reprojectTexture(e,this,t)}}else v.apply(this,[e,t,i])},l.prototype.getTileCredits=function(e,t,i){},l.prototype.requestImage=function(e,t,i,n){this._minimumLevel;var r=this,o=function(e,t){var i=r._layerOrder.indexOf(e.getProperties().layer),n=r._layerOrder.indexOf(t.getProperties().layer);return-1!==i&&-1!==n?i-n:e.getId()-t.getId()},a=function(e){r.layerOrderDefault!==r._layerOrder.join()&&e.sort(o)},s=u(e,t,i);if(Cesium.defined(this._featuresCache[s])){var l=this._featuresCache[s];return a(l),l}var c=function(){var n=function(e,t,i,n){for(var r=e,o=t,a=i;0<a;){var s=n[u(r=r/2|0,o=o/2|0,a-=1)];if(Cesium.defined(s)){var l=Cesium.defined(s.rect)?s.rect:[0,0,4096,4096],c=i-a,h=e-(r<<c),d=t-(o<<c),p=1+h,f=1+d,m=(l[2]-l[0])/(1<<c),_=[l[0]+h*m,l[1]+d*m,l[0]+p*m,l[1]+f*m],g=[];g.rect=_;for(var y=0;y<s.length;y++){var v=s[y];if(Cesium.defined(_))if("Point"===v.getType()){var b=v.getFlatCoordinates();if(!ol.extent.containsXY(_,b[0],b[1]))continue}else{var A=v.getExtent();if(Math.max(_[0],A[0])>=Math.min(_[2],A[2]))continue;if(Math.max(_[1],A[1])>=Math.min(_[3],A[3]))continue}g.push(v)}return g}}}(e,t,i,r._featuresCache);return Cesium.defined(n)&&0!==n.length?(a(n),r._featuresCache[s]=n):Cesium.when.reject()},h=this.upSample||i>this._maximumLevel;if(h)return c();var d=this._resource.getDerivedResource({templateValues:{x:e,y:t,z:i,k:this._key,s:this._subdomains[(e+t+i+1)%this._subdomains.length]},request:n}).fetchArrayBuffer();return Cesium.defined(d)?Promise.resolve(d,(function(e){for(var t=r._mvtParser.readFeatures(e),i=0;i<t.length;++i){var n=t[i];n.getId()||(n.id_=Cesium.defaultValue(n.getProperties().id,n.getProperties().__id__))}return a(t),r._featuresCache[s]=t}),(function(e){return h?c():Cesium.when.reject()})):void 0},l.prototype.pickFeatures=function(e,t,i,n,r){if(this.enablePickFeatures&&!this._pointGeometry){var o=u(e,t,i),s=this._featuresCache[o];if(Cesium.defined(s)){var l=Cesium.defined(s.rect)?s.rect:[0,0,4096,4096],c=i-Math.log(4096/(l[2]-l[0]))/Math.log(2),p=this._tilingScheme.projection.project(new Cesium.Cartographic(n,r,0)),f=12756274/4096/(1<<c),m=(p.x/Math.PI+6378137)/f,_=(p.y/Math.PI+6378137)/f,g=function(e,t,i,n){for(var r=n.length-1;r>=0;--r){var o=n[r];if(0===e._hidingLayerName.length||!o.getProperties()||-1===e._hidingLayerName.indexOf(o.getProperties().layer)){var s=o.getGeometry().getType();if("Polygon"===s||"LineString"===s||"MultiLineString"===s||"MultiPoint"===s||"Point"===s){for(var l=o.getEnds(),u=0,c=0;c<l.length;u=l[c],++c)if("Polygon"===s){if(h(t,i,o.getFlatCoordinates().slice(u,l[c])))return o}else if("LineString"===s||"MultiLineString"===s){let r=o.getId()===e._selectedId?e._selectedStyleFunc(o):e._styleFunc(o);var p=Cesium.defined(r[0])?r[0].getStroke().getWidth():1,f=4096;Cesium.defined(n.rect)&&(f=n.rect[2]-n.rect[0]);var m=(3+.5*p)*f/512;if(d(t,i,o.getFlatCoordinates().slice(u,l[c]),m*m))return o}else if("MultiPoint"===s)a.error("MultiPoint");else if("Point"===s){let n=o.getId()===e._selectedId?e._selectedStyleFunc(o):e._styleFunc(o);var _=3;Cesium.defined(n[0])&&(n[0].getImage()?_=n[0].getImage().getRadius():a.warn("@todo , pick",o));var g=[t-_,i-_,t+_,i+_],y=o.getFlatCoordinates();if(ol.extent.containsXY(g,y[0],y[1]))return o}}else a.error(o)}}}(this,m%4096,(_=4096*(1<<c)-_)%4096,s),y=-1;if(Cesium.defined(g)&&((y=g.getId())||a.error(g)),this._selectedId!==y){this.highLightObject(y);var v=Cesium.defer();return setTimeout((function(){Cesium.defined(g)?v.resolve([{name:y,description:g.getProperties()}]):v.reject()}),0),v.promise}}}},l.prototype.highLightObject=function(e){if(e&&this._selectedId!==e){var t=[];for(var i in this._featuresCache)for(var n=this._featuresCache[i],r=0;r<n.length;++r)if(n[r].getId()===e||n[r].getId()===this._selectedId){t.push(i);break}this._selectedId=e,f(this,t)}},l.prototype.destroy=function(){this._viewer.selectedEntityChanged.removeEventListener(l.prototype._onSelectedEntityChanged,this),Cesium.defined(this._dataSource)&&this._viewer.dataSources.remove(this._dataSource)};var b=Cesium.Imagery.prototype.releaseReference;Cesium.Imagery.prototype.releaseReference=function(){if(1===this.referenceCount){var e=this.imageryLayer._imageryProvider;if(e instanceof l){var t=u(this.x,this.y,this.level);Cesium.defined(e._featuresCache[t])&&delete e._featuresCache[t]}if(Cesium.defined(this.entities))for(var i=0;i<this.entities.length;++i){var n=this.entities[i][2];--n.referenceCount,0===n.referenceCount&&e._dataSource.entities.remove(n)}}return b.apply(this)};var A=Cesium.QuadtreePrimitive.prototype.endFrame;Cesium.QuadtreePrimitive.prototype.endFrame=function(e){for(var t=this._tileProvider._imageryLayers._layers,i=0;i<t.length;++i){var n=t[i].imageryProvider;n&&n._needFresh&&(f(n),n._needFresh=!1)}A.apply(this,[e])};var T=Cesium.GlobeSurfaceTileProvider.prototype.endUpdate;Cesium.GlobeSurfaceTileProvider.prototype.endUpdate=function(e){T.apply(this,[e]);for(var t=this._imageryLayers._layers,i=0;i<t.length;++i){var n=t[i].imageryProvider;n&&n._pointGeometry&&n._updateEntities()}},l.prototype._updateEntities=function(){var e={},t=this,i=function(i){for(var n=i.data.imagery,r=0;r<n.length;++r){var o=n[r];if(Cesium.defined(o.readyImagery)&&Cesium.defined(o.readyImagery.entities))for(var a=o.textureTranslationAndScale,s=1/t._tileWidth/a.z,l=1/t._tileHeight/a.w,u=0;u<o.readyImagery.entities.length;++u){var c=o.readyImagery.entities[u];if(!Cesium.defined(e[c[2].id])){var h=(c[0]-a.x)/a.z,d=(c[1]-a.y)/a.w;0-s<=h&&h<=1+s&&0-l<=d&&d<=1+l&&(e[c[2].id]=!0)}}}};this._viewer.scene.globe&&this._viewer.scene.globe._surface.forEachRenderedTile((function(e){i(e)})),this._viewer.scene.globeVector&&this._viewer.scene.globeVector._surface.forEachRenderedTile((function(e){i(e)}));for(var n=this._dataSource.entities.values,r=0;r<n.length;++r)n[r].show=!!e[n[r].id]},l.prototype.getLayers=function(){return this._vectorLayers},l.prototype.getCenter=function(){return this._center},l.prototype.isValidLayer=function(e){if(!e)return!1;for(var t=0;t<this._vectorLayers.length&&e!==this._vectorLayers[t].layer;++t);return t!==this._vectorLayers.length},l.prototype.isValidObjectId=function(e){if(!e)return!1;var t=[];for(var i in this._featuresCache)for(var n=this._featuresCache[i],r=0;r<n.length;++r)if(n[r].getId()===e){t.push(i);break}return!0},l.prototype.getObjectIdTileNames=function(e){var t=[];if(!e)return t;for(var i in this._featuresCache)for(var n=this._featuresCache[i],r=0;r<n.length;++r)if(n[r].getId()===e){t.push(i);break}return t},l.prototype.freshLayers=function(e,t){var i;e&&!this.isValidLayer(e)||(Cesium.defined(t)&&0===(i=this.getObjectIdTileNames(t)).length||(Cesium.defined(i),this._needFresh=!0))},l.prototype.showHideLayer=function(e,t){if(this.isValidLayer(e)){var i=this._hidingLayerName.indexOf(e);t?-1!==i&&(this._hidingLayerName.splice(i,1),this._needFresh=!0):-1===i&&(this._hidingLayerName.push(e),this._needFresh=!0)}},l.prototype.upDownLayerZIndex=function(e,t){if(!this.isValidLayer(e))return this._layerOrder;var i=this._layerOrder.indexOf(e);return-1===i||(t?s.zIndexUp(this._layerOrder,i,this._layerOrder.length):s.zIndexDown(this._layerOrder,i,this._layerOrder.length),this._needFresh=!0),this._layerOrder},l.prototype.setLayersZIndex=function(e){return this._layerOrder.length!==e.length?(a.error(this._layerOrder),a.error(e),this._layerOrder):(this._layerOrder=e,this._needFresh=!0,this._layerOrder)},l.prototype.getVectorTileStyleFromProperty=function(e,t){for(var i=this.vectorTileStyleCollection.vectorTileStyles,n=0;n<i.length;++n){var r=i[n];if(e===r.classificationField&&t===r.classificationFieldValue)return r}},l.prototype.getIdVectorTileStyle=function(e){if(e)return this.getVectorTileStyleFromProperty("__id__",e)},l.prototype.getLayerVectorTileStyle=function(e){if(e&&this.isValidLayer(e))return this.getVectorTileStyleFromProperty("layer",e)},l.fromUrl=async function(e,t){Cesium.Check.defined("url",e),(t=Cesium.defaultValue(t,Cesium.defaultValue.EMPTY_OBJECT)).url=e;const i=Cesium.Resource.createIfNeeded(e);let n;"json"===i.extension?n=i.getBaseUri(!0):i.isDataUri&&(n="");const r=await l.loadJson(i),o=new l(t);if(o._format=r.format,o._minimumLevel=parseInt(r.minzoom),o._maximumLevel=parseInt(r.maxzoom),o._scale=parseInt(r.scale),r.json){var u=JSON.parse(r.json);o._vectorLayers=u.tilestats.layers}else o._vectorLayers=r.vector_layers;for(var c=0;c<o._vectorLayers.length;++c)o._layerOrder.push(o._vectorLayers[c].layer);o.layerOrderDefault=o._layerOrder.join(),o._treatPointRenderingAsCesiumEntity&&"Point"===o._vectorLayers[0].geometry&&(o._dataSource=new Cesium.CustomDataSource,o._viewer.dataSources.add(o._dataSource),o._pointGeometry=!0);var h=r.center;s.isArray(h)||(h=h.split(",")),o._center=Cesium.Cartesian3.fromDegrees(1*h[0],1*h[1],1*h[2]);var d=r.bounds;s.isArray(d)||(d=d.split(",")),o._rectangle=new Cesium.Rectangle(Cesium.Math.toRadians(1*d[0]),Cesium.Math.toRadians(1*d[1]),Cesium.Math.toRadians(1*d[2]),Cesium.Math.toRadians(1*d[3])),Cesium.Rectangle.validate(o._rectangle),(o._rectangle.width<Cesium.Math.EPSILON9||o._rectangle.height<Cesium.Math.EPSILON9)&&a.error("metadata.bounds ",r,o._url),o._rectangle=Cesium.Rectangle.intersection(o._rectangle,o._tilingScheme.rectangle);var p=o._tileUrlTemplate;return Cesium.defined(p)||(p=i.url.substring(0,i.url.lastIndexOf("/")+1)+"{z}/{x}/{y}."+o._format),o._resource=new Cesium.Resource({url:p,proxy:o._proxy}),o},l.loadJson=function(e){return Cesium.Resource.createIfNeeded(e).fetchJson()};const E=l;var C=__webpack_require__(5108);const x=SpatiotemporalPlatform.utils;var S=[{color:"rgba(255,0,0,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"__id__",classificationFieldValue:1},{color:"rgba(176,237,246,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"__id__",classificationFieldValue:3}],w=[{color:"rgba(55,253,224,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"Join_Count",classificationFieldValue:"48"},{color:"rgba(176,237,246,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"Join_Count",classificationFieldValue:"181"}],I=[{color:"rgba(255,0,0,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"layer",classificationFieldValue:"C2czmlgeoJson"},{color:"rgba(255,127,0,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"layer",classificationFieldValue:""}],P=[{color:"rgba(255,0,0,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"layerType",classificationFieldValue:"C2czmlgeoJson"},{color:"rgba(255,127,0,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0",classificationField:"layerType",classificationFieldValue:"CRczmlgeoJson"}];function D(e){e=Cesium.defaultValue(e,{}),this._defaultStyle=Cesium.defaultValue(e.defaultStyle,{color:"rgba(33,150,243,1)",lineWidth:"1",lineType:0,outline:!1,outlineColor:"#c0c0c0"}),this._globalStyles=[],this._globalStyles=this._globalStyles.concat(S,w,I,P,[this._defaultStyle]),this._projectStyles={};var t=document.createElement("canvas"),i=t.getContext("2d");const n=window.devicePixelRatio;var r;this._canvasPatternStyles={TWO_CIRCLES_ON_WHITE_BACKGROUND:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.fillStyle=e,i.beginPath(),i.arc(4*n,4*n,3*n,0,2*Math.PI),i.fill(),i.fillStyle="rgb(55, 0, 170)",i.beginPath(),i.arc(4*n,4*n,1.5*n,0,2*Math.PI),i.fill(),i.createPattern(t,"repeat")},HORIZONTAL_LINES:function(e,r){return t.width=32*n,t.height=32*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.beginPath(),i.moveTo(0,0),i.lineTo(.25*t.width,0),i.moveTo(.5*t.width,0),i.lineTo(.75*t.width,0),i.moveTo(.25*t.width,.25*t.height),i.lineTo(.5*t.width,.25*t.height),i.moveTo(.75*t.width,.25*t.height),i.lineTo(t.width,.25*t.height),i.moveTo(0,.5*t.height),i.lineTo(.25*t.width,.5*t.height),i.moveTo(.5*t.width,.5*t.height),i.lineTo(.75*t.width,.5*t.height),i.moveTo(.25*t.width,.75*t.height),i.lineTo(.5*t.width,.75*t.height),i.moveTo(.75*t.width,.75*t.height),i.lineTo(t.width,.75*t.height),i.stroke(),i.createPattern(t,"repeat")},VERTICAL_LINES:function(e,r){return t.width=32*n,t.height=32*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.beginPath(),i.moveTo(0,0),i.lineTo(0,.25*t.height),i.moveTo(0,.5*t.height),i.lineTo(0,.75*t.height),i.moveTo(.25*t.width,.25*t.height),i.lineTo(.25*t.width,.5*t.height),i.moveTo(.25*t.width,.75*t.height),i.lineTo(.25*t.width,t.height),i.moveTo(.5*t.width,0),i.lineTo(.5*t.width,.25*t.height),i.moveTo(.5*t.width,.5*t.height),i.lineTo(.5*t.width,.75*t.height),i.moveTo(.75*t.width,.25*t.height),i.lineTo(.75*t.width,.5*t.height),i.moveTo(.75*t.width,.75*t.height),i.lineTo(.75*t.width,t.height),i.stroke(),i.createPattern(t,"repeat")},SQUARE:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.strokeRect(0,0,t.width,t.height),i.createPattern(t,"repeat")},RECTANGLE:function(e,r){return t.width=32*n,t.height=16*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.strokeRect(0,0,.5*t.width,.5*t.height),i.strokeRect(.25*t.width,.5*t.height,.75*t.width,t.height),i.createPattern(t,"repeat")},SLASH:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.beginPath(),i.moveTo(0,0),i.lineTo(t.width,t.height),i.stroke(),i.createPattern(t,"repeat")},BACKSLASH:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.beginPath(),i.moveTo(t.width,0),i.lineTo(0,t.height),i.stroke(),i.createPattern(t,"repeat")},SLASH_BACKSLASH:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.beginPath(),i.moveTo(0,0),i.lineTo(t.width,t.height),i.stroke(),i.strokeStyle="rgb(55, 0, 170)",i.beginPath(),i.moveTo(t.width,0),i.lineTo(0,t.height),i.stroke(),i.createPattern(t,"repeat")},CROSS:function(e,r){return t.width=16*n,t.height=16*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle=e,i.beginPath(),i.moveTo(.25*t.width,.5*t.height),i.lineTo(.75*t.width,.5*t.height),i.stroke(),i.strokeStyle="rgb(55, 0, 170, 1.0)",i.beginPath(),i.moveTo(.5*t.width,.25*t.height),i.lineTo(.5*t.width,.75*t.height),i.stroke(),i.createPattern(t,"repeat")},QUARTER_PERPENDICULAR:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle="rgba(102, 0, 102, 1.0)",i.beginPath(),i.moveTo(0,0),i.lineTo(0,.5*t.height),i.stroke(),i.strokeStyle="rgb(55, 0, 170, 1.0)",i.beginPath(),i.moveTo(0,0),i.lineTo(.5*t.width,0),i.stroke(),i.createPattern(t,"repeat")},STAIRS:function(e,r){return t.width=8*n,t.height=8*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle="rgba(255, 255, 0, 1.0)",i.beginPath(),i.moveTo(.5*t.width,0),i.lineTo(t.width,0),i.moveTo(.5*t.width,0),i.lineTo(.5*t.width,.5*t.height),i.stroke(),i.strokeStyle="rgb(55, 0, 170, 1.0)",i.beginPath(),i.moveTo(0,.5*t.height),i.lineTo(.5*t.width,.5*t.height),i.moveTo(0,.5*t.height),i.lineTo(0,t.height),i.stroke(),i.createPattern(t,"repeat")},STARS:function(e,r){t.width=32*n,t.height=32*n,i.fillStyle=Cesium.defaultValue(r,"rgba(102, 0, 102, 0.0)"),i.fillRect(0,0,t.width,t.height),i.strokeStyle="rgba(255, 255, 0, 1.0)";return function(e,t,i,n,r,o){e.beginPath();for(var a=0;a<5;a++)e.lineTo(Math.cos((18+72*a-o)/180*Math.PI)*i+n,-Math.sin((18+72*a-o)/180*Math.PI)*i+r),e.lineTo(Math.cos((54+72*a-o)/180*Math.PI)*t+n,-Math.sin((54+72*a-o)/180*Math.PI)*t+r);e.closePath(),e.stroke()}(i,16,32,32,32,0),i.createPattern(t,"repeat")}},this._canvasGradientStyles={LINEAR:(r=i.createLinearGradient(0,0,512*n,0),r.addColorStop(0,"red"),r.addColorStop(1/6,"orange"),r.addColorStop(2/6,"yellow"),r.addColorStop(.5,"green"),r.addColorStop(4/6,"aqua"),r.addColorStop(5/6,"blue"),r.addColorStop(1,"purple"),r),CIRCLE:function(){var e=i.createRadialGradient(100,100,100,100,100,0);return e.addColorStop(0,"white"),e.addColorStop(1,"green"),e}()}}Object.defineProperties(D.prototype,{defaultStyle:{get:function(){return this._defaultStyle}},canvasPatternStyles:{get:function(){return this._canvasPatternStyles}},canvasGradientStyles:{get:function(){return this._canvasGradientStyles}}}),D.prototype.add=function(e,t){Cesium.defined(t)?(x.isArray(e)||(e=[e]),this._projectStyles[t]=e):x.isArray(e)?this._globalStyles=e.concat(this._oVtStyle.styles):this._globalStyles.splice(0,0,e)},D.prototype.get=function(e){var t={asset:{version:"1.0.0",name:e},styles:[]};if(Cesium.defined(e))if("global"===e)t.styles=t.styles.concat(this._globalStyles);else{if(!Cesium.defined(this._projectStyles[e]))return C.error("",e),t;t.styles=this._projectStyles[e].concat(this._globalStyles)}else{for(let e in this._projectStyles)t.styles=t.styles.concat(this._projectStyles[e]);t.styles=t.styles.concat(this._globalStyles)}return t};const O=D;var L=__webpack_require__(5108);
/**
* @file Manages api
* @module SpatiotemporalPlatform-iClient-cesium
* @author imygis <imygis@sina.cn>
* @version 0.0
* @copyright imygis <imygis@sina.cn> All Rights Reserved
* @license GPL
* @todo text describing thing to do.
*/if("undefined"==typeof SpatiotemporalPlatform)throw" SpatiotemporalPlatform";SpatiotemporalPlatform.utils;function R(e){this._VERSION="0.0.1",L.log("%cSpatiotemporalPlatform-iClient-cesium %cVERSION: "+this._VERSION+" Cesium.VERSION: "+Cesium.VERSION,"color: red; font: larger bold","color: purple",e),this._cesiumLayers=[],this._addLayerChanged=new Cesium.Event,this._vectorTileStyleMgr=new O,this._globeVectorEnable=!1}Object.defineProperties(R.prototype,{viewer:{get:function(){return this._viewer}},addLayerChanged:{get:function(){return this._addLayerChanged}},vectorTileStyleMgr:{get:function(){return this._vectorTileStyleMgr}},showGlobe:{get:function(){return this._viewer.scene.globe.show},set:function(e){e?this._viewer.scene.globe.show||(this._viewer.scene.globe.show=!0):this._viewer.scene.globe.show&&(this._viewer.scene.globe.show=!1)}},globeCesiumWorldTerrain:{get:function(){return this._globeCesiumWorldTerrain},set:function(e){var t;this._globeCesiumWorldTerrain=e,t=this._globeCesiumWorldTerrain?new Cesium.CesiumTerrainProvider({url:Cesium.IonResource.fromAssetId(1)}):new Cesium.EllipsoidTerrainProvider,this._viewer.scene.globe.terrainProvider=t}},globeVectorHeight:{get:function(){return this._globeVectorHeight},set:function(e){if((e=Cesium.defaultValue(e,100))!==this._globeVectorHeight){this._globeVectorHeight=e;var t=this.globeVectorCesiumWorldTerrain;this.globeVectorCesiumWorldTerrain=!1,this.globeVectorCesiumWorldTerrain=!0,this.globeVectorCesiumWorldTerrain=t}}},globeVectorCesiumWorldTerrain:{get:function(){return this._globeVectorCesiumWorldTerrain},set:function(e){if(e!==this.globeVectorCesiumWorldTerrain){this._globeVectorCesiumWorldTerrain=e;var t,i=new Cesium.Ellipsoid(6378137+this._globeVectorHeight,6378137+this._globeVectorHeight,6356752.314245179+this._globeVectorHeight);t=this._globeVectorCesiumWorldTerrain?new Cesium.CesiumTerrainProvider({url:"http://localhost:9090/DEM",ellipsoid:i}):new Cesium.EllipsoidTerrainProvider({ellipsoid:i}),this._viewer.scene.globeVector.terrainProvider=t}}},globeVectorDebug:{get:function(){return this._viewer.scene.globeVector?this._viewer.scene.globeVector.baseColor.alpha:1},set:function(e){this._viewer.scene.globeVector&&(this._viewer.scene.globeVector.baseColor=new Cesium.Color(1,0,0,e?.5:0))}},globeEnableLighting:{get:function(){return this._viewer.scene.globe.enableLighting},set:function(e){e?this._viewer.scene.globe.enableLighting||(this._viewer.scene.globe.enableLighting=!0):this._viewer.scene.globe.enableLighting&&(this._viewer.scene.globe.enableLighting=!1)}},globeEnableFog:{get:function(){return this._viewer.scene.fog.enabled},set:function(e){e?this._viewer.scene.fog.enabled||(this._viewer.scene.fog.enabled=!0):this._viewer.scene.fog.enabled&&(this._viewer.scene.fog.enabled=!1)}},hueShift:{get:function(){return this._viewer.scene.skyAtmosphere.hueShift},set:function(e){this._viewer.scene.skyAtmosphere.hueShift=e,this._viewer.scene.globe.atmosphereHueShift=e}},saturationShift:{get:function(){return this._viewer.scene.skyAtmosphere.saturationShift},set:function(e){this._viewer.scene.skyAtmosphere.saturationShift=e,this._viewer.scene.globe.atmosphereSaturationShift=e}},brightnessShift:{get:function(){return this._viewer.scene.skyAtmosphere.brightnessShift},set:function(e){this._viewer.scene.skyAtmosphere.brightnessShift=e,this._viewer.scene.globe.atmosphereBrightnessShift=e}},clipCesium3DTilesetType:{get:function(){return this._clipCesium3DTilesetType},set:function(e){this._clipCesium3DTilesetType="NoSection",this.clipLayers(),this._clipCesium3DTilesetType=e,this.clipLayers()}}}),R.prototype.startupViewer=function(e,t){Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzdkNWE4My0zMzA0LTQ2M2UtOTdjYS1lODJlNWU5MDMxZWIiLCJpZCI6MTQ3MzgsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NjYyNjk4MjR9.w471eh-TDmbqYpHQO9yC8Eg7JF-487Ym43JWhMfjoIw";var i={};t.msaaEnable&&(t.webgl2Enable=!0,i.msaa=!0),t.webgl2Enable&&(i.contextOptions={requestWebgl2:!0}),t.globeCesiumWorldTerrain&&(this._globeCesiumWorldTerrain=Cesium.defaultValue(t.globeCesiumWorldTerrain,!1),this._globeCesiumWorldTerrain&&(i.terrainProvider=new Cesium.CesiumTerrainProvider({url:Cesium.IonResource.fromAssetId(1)}))),t.globeVectorEnable&&(i.globeVectorEnable=this._globeVectorEnable=!0,this._globeVectorHeight=Cesium.defaultValue(t.globeVectorHeight,100),i.ellipsoidVector=new Cesium.Ellipsoid(6378137+this._globeVectorHeight,6378137+this._globeVectorHeight,6356752.314245179+this._globeVectorHeight),this._globeVectorCesiumWorldTerrain=Cesium.defaultValue(t.globeVectorCesiumWorldTerrain,!1),this._globeVectorCesiumWorldTerrain&&(i.terrainProviderVector=new Cesium.CesiumTerrainProvider({url:Cesium.IonResource.fromAssetId(1),ellipsoid:i.ellipsoidVector})));var n=new Cesium.Viewer(e,i);this._viewer=n,Cesium.FeatureDetection.supportsImageRenderingPixelated()&&(n.useBrowserRecommendedResolution=!0,n.resolutionScale=window.devicePixelRatio),n.extend(Cesium.viewerCesiumInspectorMixin),n.extend(Cesium.viewerCesium3DTilesInspectorMixin),n.extend(Cesium.viewerDragDropMixin),n.extend(Cesium.viewerPerformanceWatchdogMixin),n.scene.globeVector&&(n.scene.globeVector.depthTestAgainstTerrain=n.scene.globe.depthTestAgainstTerrain);var r=function(e,t){return-(e.imageryLayer._layerIndex-t.imageryLayer._layerIndex)};this._viewer._SortPickImageryLayerFeature=function(e){e.sort(r)},this.enablePickPosition(),this.enablePickObject()},R.prototype.enablePickObject=function(){return void this._viewer.selectedEntityChanged.addEventListener((function(e){Cesium.defined(e)}),this)},R.prototype.enablePickPosition=function(){let e=this,t=this.viewer;if(!t.scene.pickPositionSupported)return void window.alert("This browser does not support pickPosition.");if(Cesium.SceneMode.MORPHING===t.scene.mode)return;let i=new Cesium.ScreenSpaceEventHandler(t.scene.canvas);{let e=document.createElement("div");e.className="cesium-viewer-toolbar",t._container.append(e);let i=document.createElement("div");i.id="_coordinates",i.className="cesium-viewer-toolbar",i.innerHTML="<span id='cd_label' style='font-size:13px;text-align:center;font-family:;color:#edffff;'></span>",e.append(i)}let n=t.entities.add({label:{show:!1,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.TOP,pixelOffset:new Cesium.Cartesian2(15,0)}});i.setInputAction((function(e){var i=t.scene.globe.pick(t.camera.getPickRay(new Cesium.Cartesian2(e.endPosition.x,e.endPosition.y)),t.scene);if(i){var r=t.scene.globe.ellipsoid.cartesianToCartographic(i);if(!r)return;var o=Cesium.Math.toDegrees(r.longitude).toFixed(6),a=Cesium.Math.toDegrees(r.latitude).toFixed(6),s=r.height.toFixed(6);return n.position=i,n.label.show=!0,void(n.label.text="MOUSE_MOVE: Lon: "+o+"\nLat: "+a+"\nAlt: "+s+"")}n.label.show=!1}),Cesium.ScreenSpaceEventType.MOUSE_MOVE);let r=t.entities.add({label:{show:!1,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.TOP,pixelOffset:new Cesium.Cartesian2(30,0)}});i.setInputAction((function(i){var n=t.scene.pickPosition(i.position);if(Cesium.defined(n)){var o=Cesium.Cartographic.fromCartesian(n);e.positionClicked=o;var a=Cesium.Math.toDegrees(o.longitude).toFixed(2),s=Cesium.Math.toDegrees(o.latitude).toFixed(2),l=o.height.toFixed(2);r.position=n,r.label.show=!0,r.label.text="LEFT_CLICK: Lon: "+a+"\nLat: "+s+"\nAlt: "+l+"m","TransverseSection"===e._clipCesium3DTilesetType?e.clipLayers(n,[new Cesium.Plane(new Cesium.Cartesian3(0,0,-1),0)]):"TransverseSectionDouble"===e._clipCesium3DTilesetType?e.clipLayers(n,[new Cesium.Plane(Cesium.Cartesian3.UNIT_Z,10),new Cesium.Plane(new Cesium.Cartesian3(0,0,-1),10)]):"LongitudinalSection"===e._clipCesium3DTilesetType?e.clipLayers(n,[new Cesium.Plane(new Cesium.Cartesian3(-1,0,0),0)]):"LongitudinalSectionDouble"===e._clipCesium3DTilesetType?e.clipLayers(n,[new Cesium.Plane(Cesium.Cartesian3.UNIT_Y,10),new Cesium.Plane(new Cesium.Cartesian3(0,-1,0),10)]):"BoxSection"===e._clipCesium3DTilesetType&&e.clipLayers(n,[new Cesium.Plane(Cesium.Cartesian3.UNIT_X,10),new Cesium.Plane(new Cesium.Cartesian3(-1,0,0),10),new Cesium.Plane(Cesium.Cartesian3.UNIT_Y,0),new Cesium.Plane(new Cesium.Cartesian3(0,-1,0),10),new Cesium.Plane(Cesium.Cartesian3.UNIT_Z,10),new Cesium.Plane(new Cesium.Cartesian3(0,0,-1),10)])}else r.label.show=!1}),Cesium.ScreenSpaceEventType.LEFT_CLICK)},R.prototype.setPosition=function(e){this.viewer.camera.flyTo(e)},R.prototype.getPosition=function(){var e=this._viewer;return{destination:e.scene.camera.positionWC.clone(),orientation:{direction:e.scene.camera.directionWC.clone(),up:e.scene.camera.upWC.clone()}}},R.prototype.locateLayer=function(e){var t=this.viewer,i=function(e){t.flyTo(e)};for(let t=0;t<this._cesiumLayers.length;++t){let n=this._cesiumLayers[t];if(e===n.layerUserDefined.name)return void i(n)}for(let t=0;t<this._cesiumLayers.length;++t){let n=this._cesiumLayers[t];if(n.imageryProvider&&n.imageryProvider.ready&&n.imageryProvider.isValidLayer&&n.imageryProvider.isValidLayer(e))return void i(n)}},R.prototype.loadLayers=async function(e){var t=this._viewer,i=this._layers=Cesium.defaultValue(e.layers,[]);for(let e=0;e<i.length;++e){let c=i[e];if(!c.type||!c.url){L.warn("",c);continue}if(!c.show){L.log("",c);continue}if(!c.url)continue;var n,r;if("primitives"===c.type||"groundPrimitives"===c.type)n=await Cesium.Cesium3DTileset.fromUrl(c.url,{}),"primitives"===c.type?t.scene.primitives.add(n):t.scene.groundPrimitives.add(n);else if("basemap"===c.type||"basemapVector"===c.type)c.options.url=c.url,"basemapVector"!==c.type||this._globeVectorEnable||L.error(" globeVectorEnable"),"WMS"===c.typeSub?n=new Cesium.WebMapServiceImageryProvider(c.options):"WMTS"===c.typeSub?(c.options.tilingScheme=new Cesium.GeographicTilingScheme(c.optionsGeographicTilingScheme),n=new Cesium.WebMapTileServiceImageryProvider(c.options)):L.error(c),"basemap"===c.type?t.scene.globe&&(r=t.scene.globe.imageryLayers.addImageryProvider(n)):t.scene.globeVector&&(r=t.scene.globeVector.imageryLayers.addImageryProvider(n));else if("geojson"===c.type||"topojson"===c.type)n=Cesium.GeoJsonDataSource.load(c.url,{fill:Cesium.Color.PINK.withAlpha(.5),stroke:Cesium.Color.HOTPINK,strokeWidth:3,clampToGround:!0}),c.extrudedHeight?n.then((function(e){t.dataSources.add(e);for(var i=e.entities.values,n={},r=0;r<i.length;r++){var o=i[r],a=o.name,s=n[a];s||(s=Cesium.Color.fromRandom({alpha:1}),n[a]=s),o.polygon.material=s,o.polygon.outline=!1,o.polygon.extrudedHeight=o.properties.__id__/100}})).otherwise((function(e){window.alert(e)})):t.dataSources.add(n);else if("vector"===c.type||"globeVector"===c.type){if("globeVector"===c.type&&!this._globeVectorEnable){L.error(" globeVectorEnable");continue}"globeVector"===c.type&&t.scene.globeVector&&t.scene.globeVector.terrainProvider.tilingScheme.ellipsoid,n=await E.fromUrl(c.url,{viewer:t,treatPointRenderingAsCesiumEntity:c.treatPointRenderingAsCesiumEntity});var a=new o;a.fromJson(this._vectorTileStyleMgr.get(c.styleName)),n.vectorTileStyleCollection=a;var s={color:"rgba(255, 255, 0, 0.5)",lineType:o.VectorTileLineType.SOLID,lineWidth:6,outline:!0,outlineColor:"rgba(255, 0, 0, 0.5)",icon:"",textField:"NAME",font:"bold 16px sans-serif"},l=new o([new o.VectorTileStyle(s)]);n.selectedVectorTileStyleCollection=l,"vector"===c.type?t.scene.globe&&(r=t.scene.globe.imageryLayers.addImageryProvider(n)):t.scene.globeVector&&(r=t.scene.globeVector.imageryLayers.addImageryProvider(n))}else"model"===c.type?(c.model.uri=c.url,n=t.entities.add({position:Cesium.Cartesian3.fromDegrees(c.position[0],c.position[1],c.position[2]),model:c.model})):L.error("",c);if(!n){L.error(c);continue}c.name=c.name?c.name:c.url?c.url:c.options?c.options.url:""+e;var u=r||n;u.layerUserDefined=c,this._cesiumLayers.push(u);let h=n.getLayers?n.getLayers():[{layer:c.name}];h&&this._addLayerChanged.raiseEvent(h),c.locate&&t.zoomTo(u)}},R.prototype.freshLayers=function(e,t){for(var i=0;i<this._cesiumLayers.length;++i){var n=this._cesiumLayers[i].imageryProvider;n&&n.freshLayers&&n.ready&&n.freshLayers(e,t)}},R.prototype.showHideLayer=function(e,t){for(let i=0;i<this._cesiumLayers.length;++i){let n=this._cesiumLayers[i];if(e===n.layerUserDefined.name)return void(n.show=t)}for(let i=0;i<this._cesiumLayers.length;++i){let n=this._cesiumLayers[i];n.imageryProvider&&n.imageryProvider.ready&&n.imageryProvider.showHideLayer&&n.imageryProvider.showHideLayer(e,t)}},R.prototype.upDownLayerZIndex=function(e,t){for(var i=0;i<this._cesiumLayers.length;++i){var n=this._cesiumLayers[i].imageryProvider;n&&n.upDownLayerZIndex&&n.ready&&n.upDownLayerZIndex(e,t)}},R.prototype.setLayerStyle=function(e,t){for(var i=0;i<this._cesiumLayers.length;++i){var n=this._cesiumLayers[i].imageryProvider;if(n&&n.getLayerVectorTileStyle&&n.ready){var r=n.getLayerVectorTileStyle(e);r&&(r.updatefromObject(t),n.freshLayers(e))}}},R.prototype.setLayerExtendedStyle=function(e,t){for(var i=0;i<this._cesiumLayers.length;++i){var n=this._cesiumLayers[i].imageryProvider;if(n&&n.getLayerVectorTileStyle&&n.ready){var r=n.getLayerVectorTileStyle(e);r&&(t?r._styleExtended=new o.VectorTileStyle(t):delete r._styleExtended,n.freshLayers(e))}}},R.prototype.getLayerStyle=function(e){for(var t=this.vectorTileStyleMgr.get().styles,i=0;i<t.length;++i){var n=t[i];if("layer"===n.classificationField&&e===n.classificationFieldValue)return n}};var N=function(e,t,i){var n=0,r=setInterval((function(){(n+=1)>60?(clearInterval(r),e()):t(n%10/10),i()}),100)};R.prototype.isColor=function(e){try{return ol.color.fromString(e),!0}catch(e){return!1}},R.prototype.flashLayers=function(e,t,i){var n=this;var r={color:"rgba(255, 255, 0, 1)",lineWidth:"1",lineType:o.VectorTileLineType.DASHDOTDOT,outline:!1,outlineColor:"rgba(255, 0, 0, 1)"};N((function(){r=void 0}),(function(e){r.color="rgba(255,255,0,"+e+")"}),(function(){n.setLayerExtendedStyle(e,r)}))},R.prototype.flashObject=function(e,t){for(var i=this,n=0;n<i._cesiumLayers.length;++n)i._cesiumLayers[n]._flashVectorTileStyle&&(i._cesiumLayers[n]._flashVectorTileStyle.classificationField="__id__",i._cesiumLayers[n]._flashVectorTileStyle.classificationFieldValue=t);N((function(){for(var e=0;e<i._cesiumLayers.length;++e)i._cesiumLayers[e]._flashVectorTileStyle&&(i._cesiumLayers[e]._flashVectorTileStyle.classificationField=void 0,i._cesiumLayers[e]._flashVectorTileStyle.classificationFieldValue=void 0)}),(function(e){for(var t=0;t<i._cesiumLayers.length;++t)i._cesiumLayers[t]._flashVectorTileStyle&&(i._cesiumLayers[t]._flashVectorTileStyle.color="rgba(255,255,0,"+e+")")}),(function(){i.freshLayers(e,t)}))},R.prototype.clipLayers=function(e,t,i,n){var r=this,o=this._viewer;this.model={type:n,center:e},void 0===i&&e&&(i=Cesium.Transforms.eastNorthUpToFixedFrame(e)),this.model.modelMatrix=i;var a=new Cesium.Matrix4;for(let i=0;i<this._cesiumLayers.length;++i){var s=this._cesiumLayers[i];s instanceof Cesium.Cesium3DTileset&&("NoSection"!==this._clipCesium3DTilesetType?(o.entities.removeAll(),e&&s.readyPromise.then((function(){var e=s._clippingPlanesOriginMatrix,i=Cesium.Matrix4.inverseTransformation(e,a),n=s.clippingPlanes;if(n&&n.modelMatrix)Cesium.Matrix4.multiply(i,r.model.modelMatrix,n.modelMatrix);else{n=new Cesium.ClippingPlaneCollection({modelMatrix:Cesium.Matrix4.multiply(i,r.model.modelMatrix,a),edgeColor:Cesium.Color.RED,edgeWidth:3,planes:t.map((function(e){return Cesium.ClippingPlane.fromPlane(e)})),unionClippingRegions:!0}),s.clippingPlanes=n;for(var l=function(e){return function(){return e}},u=s.boundingSphere,c=u.radius,h=[],d=0;d<n.length;++d){var p=n.get(d),f=o.entities.add({position:u.center,plane:{dimensions:new Cesium.Cartesian2(2.5*c,2.5*c),material:Cesium.Color.WHITE.withAlpha(.1),plane:new Cesium.CallbackProperty(l(p),!1),outline:!0,outlineColor:Cesium.Color.WHITE}});h.push(f)}}}))):s&&s.clippingPlanes&&(s.clippingPlanes.removeAll(),s.clippingPlanes=void 0))}this.viewer.scene.requestRender()},R.fetchJson=function(e){var t=new Cesium.Resource({url:e});return Cesium.when(t.fetchJson())},R.defined=Cesium.defined,R.defineProperties=Cesium.defineProperties,R.Event=Cesium.Event,Object.assign(SpatiotemporalPlatform,{}),"undefined"!=typeof SpatiotemporalPlatform?(window.CESIUM_BASE_URL=SpatiotemporalPlatform.pathRuntimeBase+"Cesium",SpatiotemporalPlatform.SPCesium=R):window.CESIUM_BASE_URL="Cesium";const M=R})(),__webpack_exports__})()));
//# sourceMappingURL=cesium.js.map